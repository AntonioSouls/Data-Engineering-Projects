<!DOCTYPE html><html lang="en" data-theme="light"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<title>Moshi: a speech-text foundation model for real-time dialogue</title>
<!--Generated on Wed Oct  2 09:10:58 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="https://arxiv.org/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css">
<link href="https://arxiv.org/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css">
<link href="https://arxiv.org/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css">




<base href="https://arxiv.org/html/2410.00037v2/"><link rel="stylesheet" href="https://use.typekit.net/rwr5zpx.css"><link rel="icon" type="image/png" href="https://static.arxiv.org/static/browse/0.3.4/images/icons/favicon-16x16.png" sizes="16x16"><link rel="icon" type="image/png" href="https://static.arxiv.org/static/browse/0.3.4/images/icons/favicon-32x32.png" sizes="32x32"></head>
<body><header class="mob_header">
    <div class="html-header-logo">
      <a href="https://arxiv.org/">
        <img alt="logo" class="logomark" role="presentation" width="100" src="https://services.dev.arxiv.org/html/static/arxiv-logomark-small-white.svg">
        <span class="sr-only">Back to arXiv</span>
      </a>
    </div>

    <!--TOC, dark mode, links-->
    <div class="html-header-nav">
      <!--back to abstract-->
      
        <a class="nav-link ar5iv-footer-button hover-effect" aria-label="Back to abstract page" href="https://arxiv.org/abs/2410.00037v2">
        <svg xmlns="http://www.w3.org/2000/svg" height="1.25em" viewBox="0 0 512 512" fill="#ffffff" aria-hidden="true">
            <path d="M502.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L402.7 224 192 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l210.7 0-73.4 73.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l128-128zM160 96c17.7 0 32-14.3 32-32s-14.3-32-32-32L96 32C43 32 0 75 0 128L0 384c0 53 43 96 96 96l64 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-64 0c-17.7 0-32-14.3-32-32l0-256c0-17.7 14.3-32 32-32l64 0z"></path>
        </svg>
        </a>
      <!--dark mode-->
      <a class="ar5iv-toggle-color-scheme" title="Toggle dark/light mode" aria-label="System preference">
        <label id="automatic-tog" class="toggle-icon" title="Switch to light mode" for="__palette_3">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"></path></svg>
        </label>
        
        
      </a>
      <!--nav-->
      <button class="navbar-toggler ar5iv-footer-button" type="button" data-bs-theme="dark" data-bs-toggle="collapse" aria-expanded="false" data-bs-target=".ltx_page_main >.ltx_TOC.mobile" aria-controls="navbarSupportedContent" aria-label="Toggle navigation" style="border:none; margin-right: 0em;">
        <svg xmlns="http://www.w3.org/2000/svg" height="1.25em" viewBox="0 0 448 512" aria-hidden="true" role="img" fill="#ffffff"><path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"></path></svg>
      </button>
    </div>
    </header><header class="desktop_header">
    <div class="html-header-logo">
      <a href="https://arxiv.org/">
          <img alt="logo" class="logo" role="presentation" width="100" src="https://services.dev.arxiv.org/html/static/arxiv-logo-one-color-white.svg">
          <span class="sr-only">Back to arXiv</span>
      </a>
    </div>
    <div class="html-header-message" role="banner">
        <p>This is <strong>experimental HTML</strong> to improve accessibility. We invite you to report rendering errors. <span class="sr-only">Use Alt+Y to toggle on accessible reporting links and Alt+Shift+Y to toggle off.</span> Learn more <a href="https://info.arxiv.org/about/accessible_HTML.html" target="_blank">about this project</a> and <a href="https://info.arxiv.org/help/submit_latex_best_practices.html" target="_blank">help improve conversions</a>.
        </p>
    </div>
    <nav class="html-header-nav">
      <a class="ar5iv-footer-button hover-effect" href="https://info.arxiv.org/about/accessible_HTML.html" target="_blank">Why HTML?</a>
      <a class="ar5iv-footer-button hover-effect" target="_blank" href="https://arxiv.org/html/2410.00037v2/#myForm">Report Issue</a>
      <a class="ar5iv-footer-button hover-effect" href="https://arxiv.org/abs/2410.00037v2">Back to Abstract</a>
      <a class="ar5iv-footer-button hover-effect" href="https://arxiv.org/pdf/2410.00037v2" target="_blank">Download PDF</a>
      <a class="ar5iv-toggle-color-scheme" title="Toggle dark/light mode">
        <label id="automatic-tog" class="toggle-icon" title="Switch to light mode" for="__palette_3">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"></path></svg>
        </label>
        
        
      </a>
    </nav></header>

<div class="ltx_page_main" id="main">
<nav class="ltx_TOC active" aria-labelledby="toc_header"><h2 id="toc_header" class="sr-only">Table of Contents</h2>

      <div id="listIcon" type="button" class="hide">
          <svg width="17px" height="17px" viewBox="0 0 512 512" style="pointer-events: none;">
          <path d="M40 48C26.7 48 16 58.7 16 72v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V72c0-13.3-10.7-24-24-24H40zM192 64c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zM16 232v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V232c0-13.3-10.7-24-24-24H40c-13.3 0-24 10.7-24 24zM40 368c-13.3 0-24 10.7-24 24v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V392c0-13.3-10.7-24-24-24H40z"></path>
          </svg>
      </div>
      <div id="arrowIcon" type="button">
          <svg width="17px" height="17px" viewBox="0 0 448 512" style="pointer-events: none;">
          <path d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.2 288 416 288c17.7 0 32-14.3 32-32s-14.3-32-32-32l-306.7 0L214.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"></path>
          </svg>
      </div><ol class="ltx_toclist"><li class="ltx_tocentry ltx_tocentry_section">
    <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#abstract" title="Abstract">
      <span class="ltx_text ltx_ref_title">
        <span class="ltx_tag ltx_tag_ref"></span>
        Abstract
      </span>
    </a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S1" title="In Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S2" title="In Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S2.SS0.SSS0.Px1" title="In 2 Related Work ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Audio Language Modeling.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S2.SS0.SSS0.Px2" title="In 2 Related Work ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Speech-text Models.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S2.SS0.SSS0.Px3" title="In 2 Related Work ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Spoken Dialogue Models.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3" title="In Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Model</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS1" title="In 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Overview</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS2" title="In 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>The Helium Text Language Model</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS2.SSS1" title="In 3.2 The Helium Text Language Model ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.1 </span>Architecture</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS2.SSS2" title="In 3.2 The Helium Text Language Model ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.2 </span>Pre-training data filtering</span></a>
<ol class="ltx_toclist ltx_toclist_subsubsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS2.SSS2.Px1" title="In 3.2.2 Pre-training data filtering ‣ 3.2 The Helium Text Language Model ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Deduplication.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS2.SSS2.Px2" title="In 3.2.2 Pre-training data filtering ‣ 3.2 The Helium Text Language Model ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Language identification.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS2.SSS2.Px3" title="In 3.2.2 Pre-training data filtering ‣ 3.2 The Helium Text Language Model ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Quality filtering.</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS3" title="In 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Audio Tokenization</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS3.SSS1" title="In 3.3 Audio Tokenization ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3.1 </span>Architecture</span></a>
<ol class="ltx_toclist ltx_toclist_subsubsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS3.SSS1.Px1" title="In 3.3.1 Architecture ‣ 3.3 Audio Tokenization ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Transformer-based bottleneck.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS3.SSS1.Px2" title="In 3.3.1 Architecture ‣ 3.3 Audio Tokenization ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Causality and streaming.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS3.SSS1.Px3" title="In 3.3.1 Architecture ‣ 3.3 Audio Tokenization ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Optimization.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS3.SSS1.Px4" title="In 3.3.1 Architecture ‣ 3.3 Audio Tokenization ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Quantization rate.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS3.SSS1.Px5" title="In 3.3.1 Architecture ‣ 3.3 Audio Tokenization ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Adversarial-only training.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS3.SSS2" title="In 3.3 Audio Tokenization ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3.2 </span>Learning semantic-acoustic tokens with a split RVQ</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS4" title="In 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Generative Audio Modeling</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS4.SSS1" title="In 3.4 Generative Audio Modeling ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4.1 </span>Hierarchical autoregressive modeling with RQ-Transformer</span></a>
<ol class="ltx_toclist ltx_toclist_subsubsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS4.SSS1.Px1" title="In 3.4.1 Hierarchical autoregressive modeling with RQ-Transformer ‣ 3.4 Generative Audio Modeling ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">RQ-Transformer.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsubsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS4.SSS2" title="In 3.4 Generative Audio Modeling ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4.2 </span>Audio modeling</span></a>
<ol class="ltx_toclist ltx_toclist_subsubsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS4.SSS2.Px1" title="In 3.4.2 Audio modeling ‣ 3.4 Generative Audio Modeling ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Acoustic delay.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS4.SSS3" title="In 3.4 Generative Audio Modeling ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4.3 </span>Multi-stream modeling</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS4.SSS4" title="In 3.4 Generative Audio Modeling ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4.4 </span>Inner Monologue</span></a>
<ol class="ltx_toclist ltx_toclist_subsubsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS4.SSS4.Px1" title="In 3.4.4 Inner Monologue ‣ 3.4 Generative Audio Modeling ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Aligning text and audio tokens.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS4.SSS4.Px2" title="In 3.4.4 Inner Monologue ‣ 3.4 Generative Audio Modeling ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Deriving streaming ASR and TTS.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS4.SSS4.Px3" title="In 3.4.4 Inner Monologue ‣ 3.4 Generative Audio Modeling ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Joint sequence modeling for Moshi.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS4.SSS4.Px4" title="In 3.4.4 Inner Monologue ‣ 3.4 Generative Audio Modeling ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Inference of Moshi.</span></a></li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S4" title="In Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Datasets and Training</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S4.SS1" title="In 4 Datasets and Training ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Text Data</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S4.SS2" title="In 4 Datasets and Training ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Audio Data</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S4.SS3" title="In 4 Datasets and Training ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Speech-Text Instruct Data</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S4.SS4" title="In 4 Datasets and Training ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Training Stages and Hyper-parameters</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S4.SS4.SSS0.Px1" title="In 4.4 Training Stages and Hyper-parameters ‣ 4 Datasets and Training ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Helium pre-training.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S4.SS4.SSS0.Px2" title="In 4.4 Training Stages and Hyper-parameters ‣ 4 Datasets and Training ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Moshi pre-training.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S4.SS4.SSS0.Px3" title="In 4.4 Training Stages and Hyper-parameters ‣ 4 Datasets and Training ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Moshi post-training.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S4.SS4.SSS0.Px4" title="In 4.4 Training Stages and Hyper-parameters ‣ 4 Datasets and Training ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Moshi finetuning.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S4.SS4.SSS0.Px5" title="In 4.4 Training Stages and Hyper-parameters ‣ 4 Datasets and Training ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">TTS Training.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S4.SS4.SSS0.Px6" title="In 4.4 Training Stages and Hyper-parameters ‣ 4 Datasets and Training ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Training loss.</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5" title="In Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Evaluation</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.SS1" title="In 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Text Language Modeling</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.SS1.SSS0.Px1" title="In 5.1 Text Language Modeling ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Metrics.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.SS1.SSS0.Px2" title="In 5.1 Text Language Modeling ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Baselines.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.SS1.SSS0.Px3" title="In 5.1 Text Language Modeling ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Results.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.SS2" title="In 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Audio Tokenization</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.SS2.SSS0.Px1" title="In 5.2 Audio Tokenization ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Metrics.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.SS2.SSS0.Px2" title="In 5.2 Audio Tokenization ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Baselines.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.SS2.SSS0.Px3" title="In 5.2 Audio Tokenization ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Results - Semantic tokens.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.SS2.SSS0.Px4" title="In 5.2 Audio Tokenization ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Results - Acoustic tokens.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.SS2.SSS0.Px5" title="In 5.2 Audio Tokenization ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Discussion.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.SS3" title="In 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>Ablations on Generative Modeling</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.SS3.SSS0.Px1" title="In 5.3 Ablations on Generative Modeling ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Metrics.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.SS3.SSS0.Px2" title="In 5.3 Ablations on Generative Modeling ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Results - RQ-Transformer.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.SS3.SSS0.Px3" title="In 5.3 Ablations on Generative Modeling ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Results - Additional ablations.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.SS3.SSS0.Px4" title="In 5.3 Ablations on Generative Modeling ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Discussion.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.SS4" title="In 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.4 </span>Audio Language Modeling</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.SS4.SSS0.Px1" title="In 5.4 Audio Language Modeling ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Metrics.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.SS4.SSS0.Px2" title="In 5.4 Audio Language Modeling ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Baselines.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.SS4.SSS0.Px3" title="In 5.4 Audio Language Modeling ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Results.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.SS4.SSS0.Px4" title="In 5.4 Audio Language Modeling ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Discussion.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.SS5" title="In 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.5 </span>Spoken Question Answering</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.SS5.SSS0.Px1" title="In 5.5 Spoken Question Answering ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Metrics.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.SS5.SSS0.Px2" title="In 5.5 Spoken Question Answering ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Baselines.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.SS5.SSS0.Px3" title="In 5.5 Spoken Question Answering ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Results.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.SS5.SSS0.Px4" title="In 5.5 Spoken Question Answering ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Discussion.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.SS6" title="In 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.6 </span>Quality and Statistics of Generated Dialogues</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.SS6.SSS0.Px1" title="In 5.6 Quality and Statistics of Generated Dialogues ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Metrics.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.SS6.SSS0.Px2" title="In 5.6 Quality and Statistics of Generated Dialogues ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Baselines.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.SS6.SSS0.Px3" title="In 5.6 Quality and Statistics of Generated Dialogues ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Results.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.SS7" title="In 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.7 </span>Streaming ASR and TTS</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.SS7.SSS0.Px1" title="In 5.7 Streaming ASR and TTS ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Metrics.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.SS7.SSS0.Px2" title="In 5.7 Streaming ASR and TTS ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Results.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.SS7.SSS0.Px3" title="In 5.7 Streaming ASR and TTS ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Discussion.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.SS8" title="In 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.8 </span>Compressing Moshi and Impact on Speech Quality</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.SS8.SSS0.Px1" title="In 5.8 Compressing Moshi and Impact on Speech Quality ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Quantization Format.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.SS8.SSS0.Px2" title="In 5.8 Compressing Moshi and Impact on Speech Quality ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Results - Linguistic evaluation.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.SS8.SSS0.Px3" title="In 5.8 Compressing Moshi and Impact on Speech Quality ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Results - Audio Quality.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.SS8.SSS0.Px4" title="In 5.8 Compressing Moshi and Impact on Speech Quality ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Discussion.</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S6" title="In Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Safety</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S6.SS1" title="In 6 Safety ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.1 </span>Toxicity Analysis</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S6.SS2" title="In 6 Safety ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.2 </span>Regurgitation Analysis</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S6.SS2.SSS0.Px1" title="In 6.2 Regurgitation Analysis ‣ 6 Safety ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Evaluation protocol.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S6.SS2.SSS0.Px2" title="In 6.2 Regurgitation Analysis ‣ 6 Safety ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Results &amp; Impact of fine-tuning.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S6.SS3" title="In 6 Safety ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.3 </span>System Voice Consistency</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S6.SS4" title="In 6 Safety ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.4 </span>Identification of the Content Generated by Moshi: Watermarking</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S6.SS4.SSS0.Px1" title="In 6.4 Identification of the Content Generated by Moshi: Watermarking ‣ 6 Safety ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Evaluation of signal-based watermarking.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S6.SS4.SSS0.Px2" title="In 6.4 Identification of the Content Generated by Moshi: Watermarking ‣ 6 Safety ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Exploration on generative-based watermarking for audio.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S6.SS4.SSS0.Px3" title="In 6.4 Identification of the Content Generated by Moshi: Watermarking ‣ 6 Safety ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Discussion on generative audio watermarking.</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S7" title="In Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#A1" title="In Table 17 ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Additional Ablation on Mimi Codec</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#A2" title="In Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Audio Matching and Deduplication</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#A2.SS0.SSS0.Px1" title="In Appendix B Audio Matching and Deduplication ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Constellation map.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#A2.SS0.SSS0.Px2" title="In Appendix B Audio Matching and Deduplication ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Hash encoding.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#A2.SS0.SSS0.Px3" title="In Appendix B Audio Matching and Deduplication ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Pair-wise matching and one-to-many comparison.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#A2.SS0.SSS0.Px4" title="In Appendix B Audio Matching and Deduplication ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">De-duplication: Signature fused set.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#A3" title="In Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>Delayed text LM as a zero-shot streaming ASR and TTS</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#A3.SS0.SSS0.Px1" title="In Appendix C Delayed text LM as a zero-shot streaming ASR and TTS ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">ASR mode.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#A3.SS0.SSS0.Px2" title="In Appendix C Delayed text LM as a zero-shot streaming ASR and TTS ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">TTS mode.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#A3.SS0.SSS0.Px3" title="In Appendix C Delayed text LM as a zero-shot streaming ASR and TTS ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Multi-stream TTS.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#A4" title="In Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D </span>Characterizing Audio Artifacts Caused by Quantization</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#A4.SS0.SSS0.Px1" title="In Appendix D Characterizing Audio Artifacts Caused by Quantization ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Repetitive text.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#A4.SS0.SSS0.Px2" title="In Appendix D Characterizing Audio Artifacts Caused by Quantization ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Silence vs. background noise.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph">
<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#A4.SS0.SSS0.Px3" title="In Appendix D Characterizing Audio Artifacts Caused by Quantization ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title">Bad audio quality.</span></a>
<ol class="ltx_toclist ltx_toclist_paragraph">
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#A5" title="In Table 18 ‣ Bad audio quality. ‣ Appendix D Characterizing Audio Artifacts Caused by Quantization ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E </span>Safety and Toxicity</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#A6" title="In Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">F </span>Synthetic Transcripts Generation for Fine-tuning</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#A6.SS1" title="In Appendix F Synthetic Transcripts Generation for Fine-tuning ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">F.1 </span>General knowledge</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#A6.SS2" title="In Appendix F Synthetic Transcripts Generation for Fine-tuning ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">F.2 </span>Misspelling</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#A6.SS3" title="In Appendix F Synthetic Transcripts Generation for Fine-tuning ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">F.3 </span>Voice Instructions</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
    <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib" title="References">
      <span class="ltx_text ltx_ref_title">
        <span class="ltx_tag ltx_tag_ref"></span>
        References
      </span>
    </a></li></ol></nav>

<div class="ltx_page_content"><div id="target-section" class="section"><a id="license-tr" href="https://info.arxiv.org/help/license/index.html#licenses-available">License: CC BY-NC-SA 4.0</a><div id="watermark-tr">arXiv:2410.00037v2 [eess.AS] 02 Oct 2024</div></div>
<article class="ltx_document ltx_authors_1line" lang="en">
<h1 class="ltx_title ltx_title_document">Moshi: a speech-text foundation model for real-time dialogue</h1><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname"><span class="ltx_ERROR undefined" id="id6.6.id1">\name</span>Alexandre Défossez<sup class="ltx_sup" id="id7.7.id2"><span class="ltx_text ltx_font_italic" id="id7.7.id2.1">∗</span></sup> <span class="ltx_ERROR undefined" id="id8.8.id3">\email</span>alex@kyutai.org 
<br class="ltx_break">
<span class="ltx_ERROR undefined" id="id9.9.id4">\AND</span><span class="ltx_ERROR undefined" id="id10.10.id5">\name</span>Laurent Mazaré<sup class="ltx_sup" id="id11.11.id6"><span class="ltx_text ltx_font_italic" id="id11.11.id6.1">∗</span></sup>
<br class="ltx_break">
<span class="ltx_ERROR undefined" id="id12.12.id7">\AND</span><span class="ltx_ERROR undefined" id="id13.13.id8">\name</span>Manu Orsini 
<br class="ltx_break">
<span class="ltx_ERROR undefined" id="id14.14.id9">\AND</span><span class="ltx_ERROR undefined" id="id15.15.id10">\name</span>Amélie Royer 
<br class="ltx_break">
<span class="ltx_ERROR undefined" id="id16.16.id11">\AND</span><span class="ltx_ERROR undefined" id="id17.17.id12">\name</span>Patrick Pérez 
<br class="ltx_break">
<span class="ltx_ERROR undefined" id="id18.18.id13">\AND</span><span class="ltx_ERROR undefined" id="id19.19.id14">\name</span>Hervé Jégou 
<br class="ltx_break">
<span class="ltx_ERROR undefined" id="id20.20.id15">\AND</span><span class="ltx_ERROR undefined" id="id21.21.id16">\name</span>Edouard Grave<sup class="ltx_sup" id="id22.22.id17"><span class="ltx_text ltx_font_italic" id="id22.22.id17.1">∗</span></sup>
<br class="ltx_break">
<span class="ltx_ERROR undefined" id="id23.23.id18">\AND</span><span class="ltx_ERROR undefined" id="id24.24.id19">\name</span>Neil Zeghidour<sup class="ltx_sup" id="id25.25.id20"><span class="ltx_text ltx_font_italic" id="id25.25.id20.1">∗</span></sup> <span class="ltx_ERROR undefined" id="id26.26.id21">\email</span>neil@kyutai.org 
<br class="ltx_break"><span class="ltx_ERROR undefined" id="id27.27.id22">\addr</span>Kyutai
<br class="ltx_break"><span class="ltx_ERROR undefined" id="id28.28.id23">\addr</span><sup class="ltx_sup" id="id29.29.id24">∗</sup>Equal contribution
<br class="ltx_break">
</span></span>
</div><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_abstract" id="abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<p class="ltx_p" id="id30.id1"><span class="ltx_text" id="id30.id1.1">We introduce Moshi, a speech-text foundation model and full-duplex spoken dialogue framework. Current systems for spoken dialogue rely on pipelines of independent components, namely voice activity detection, speech recognition, textual dialogue and text-to-speech. Such frameworks cannot emulate the experience of real conversations. First, their complexity induces a latency of several seconds between interactions. Second, text being the intermediate modality for dialogue, non-linguistic information that modifies meaning— such as emotion or non-speech sounds— is lost in the interaction. Finally, they rely on a segmentation into speaker turns, which does not take into account overlapping speech, interruptions and interjections. Moshi solves these independent issues altogether by casting spoken dialogue as speech-to-speech generation. Starting from a text language model backbone, Moshi generates speech as tokens from the residual quantizer of a neural audio codec, while modeling separately its own speech and that of the user into parallel streams. This allows for the removal of explicit speaker turns, and the modeling of arbitrary conversational dynamics. We moreover extend the hierarchical semantic-to-acoustic token generation of previous work to first predict time-aligned text tokens as a prefix to audio tokens. Not only this “Inner Monologue” method significantly improves the linguistic quality of generated speech, but we also illustrate how it can provide streaming speech recognition and text-to-speech. Our resulting model is the first real-time full-duplex spoken large language model, with a theoretical latency of 160ms, 200ms in practice, and is available at <a class="ltx_ref ltx_href" href="https://github.com/kyutai-labs/moshi" title="">github.com/kyutai-labs/moshi</a>.</span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="p1">
<p class="ltx_p" id="p1.1"><span class="ltx_text ltx_font_bold" id="p1.1.1" style="font-size:90%;">Keywords:</span><span class="ltx_text" id="p1.1.2" style="font-size:90%;"> 
speech, text, multimodal, foundation, spoken dialogue</span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Voice has provided a convenient interface to early conversational systems, from Alexa<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.alexa.com/" title="">https://www.alexa.com</a></span></span></span> to Siri<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.apple.com/siri" title="">https://www.apple.com/siri</a></span></span></span> and Google Assistant.<span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://assistant.google.com/" title="">https://assistant.google.com/</a></span></span></span> In this context, a “wake word” spoken by the user typically triggers an automatic speech recognition (ASR) system which transcribes the subsequent user’s request. Then, a natural language understanding (NLU) pipeline converts this query to a structured format used to produce a text answer through natural language generation (NLG). Eventually, a text-to-speech (TTS) system tells the answer back to the user. While this process can handle short, constrained interactions (e.g. triggering an action or retrieving a fact), the rise of large language models (LLMs)&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Brown et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib9" title="">2020</a>; Hoffmann et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib40" title="">2022</a>; Touvron et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib96" title="">2023a</a>)</cite> has called for a consequent extension of voice interfaces to multi-turn, open-ended conversations. A solution to this challenge is handling the NLU and NLG with an LLM, while the ASR and TTS provide the voice interface during the user’s and the system’s turn respectively&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Llama, <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib60" title="">2024</a>)</cite>. This framework supports the current generation of spoken dialogue systems such as Gemini&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Gemini et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib31" title="">2023</a>)</cite> or ChatGPT.<span class="ltx_note ltx_role_footnote" id="footnote4"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openai.com/index/chatgpt-can-now-see-hear-and-speak/" title="">https://openai.com/index/chatgpt-can-now-see-hear-and-speak/</a></span></span></span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.2">Yet, the experience offered by these interfaces remains far from natural conversations. First, latency compounds along the many components of these pipelines, resulting in a typical global latency of several seconds. This is unlike natural conversations which demonstrate response times of a few hundred milliseconds. Second, as language understanding and generation happens in the textual domain, any non-written information is ignored by the model. This goes from paralinguistic information, such as emotion and accent, to non-speech audio, such as surrounding acoustic events. Finally, these models remain fundamentally turn-based, assuming that dialogue is a sequence of well-defined single-speaker segments. While this paradigm is suited to text dialogue, it falls short in modeling aspects of spoken conversations such as interruptions, overlapping speech— which amounts for <math alttext="10" class="ltx_Math" display="inline" id="S1.p2.1.m1.1"><semantics id="S1.p2.1.m1.1a"><mn id="S1.p2.1.m1.1.1" xref="S1.p2.1.m1.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S1.p2.1.m1.1b"><cn id="S1.p2.1.m1.1.1.cmml" type="integer" xref="S1.p2.1.m1.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.1.m1.1c">10</annotation><annotation encoding="application/x-llamapun" id="S1.p2.1.m1.1d">10</annotation></semantics></math> to <math alttext="20\%" class="ltx_Math" display="inline" id="S1.p2.2.m2.1"><semantics id="S1.p2.2.m2.1a"><mrow id="S1.p2.2.m2.1.1" xref="S1.p2.2.m2.1.1.cmml"><mn id="S1.p2.2.m2.1.1.2" xref="S1.p2.2.m2.1.1.2.cmml">20</mn><mo id="S1.p2.2.m2.1.1.1" xref="S1.p2.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.p2.2.m2.1b"><apply id="S1.p2.2.m2.1.1.cmml" xref="S1.p2.2.m2.1.1"><csymbol cd="latexml" id="S1.p2.2.m2.1.1.1.cmml" xref="S1.p2.2.m2.1.1.1">percent</csymbol><cn id="S1.p2.2.m2.1.1.2.cmml" type="integer" xref="S1.p2.2.m2.1.1.2">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.2.m2.1c">20\%</annotation><annotation encoding="application/x-llamapun" id="S1.p2.2.m2.1d">20 %</annotation></semantics></math> of spoken time&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Çetin and Shriberg, <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib11" title="">2006</a>)</cite> —and backchanneling (i.e. non-interrupting interjections such as “OK” or “I see”).</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.2">In this work we introduce Moshi, a speech-text foundation model and real-time spoken dialogue system that aims at solving the aforementioned limitations: latency, textual information bottleneck and turn-based modeling. Moshi augments a text LLM backbone with a smaller audio language model&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Borsos et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib6" title="">2022</a>; Yang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib105" title="">2023</a>)</cite> that ingests and predicts discrete audio units. This removes the information bottleneck of text by understanding inputs and generating outputs directly in the audio domain, while benefiting from the knowledge and reasoning abilities of the underlying text LLM. We extend previous work on audio language models and design a streaming, hierarchical architecture, with a theoretical latency of <math alttext="160\text{\,}\mathrm{ms}" class="ltx_Math" display="inline" id="S1.p3.1.m1.3"><semantics id="S1.p3.1.m1.3a"><mrow id="S1.p3.1.m1.3.3" xref="S1.p3.1.m1.3.3.cmml"><mn id="S1.p3.1.m1.1.1.1.1.1.1" xref="S1.p3.1.m1.1.1.1.1.1.1.cmml">160</mn><mtext id="S1.p3.1.m1.2.2.2.2.2.2" xref="S1.p3.1.m1.2.2.2.2.2.2.cmml">&nbsp;</mtext><mi class="ltx_unit" id="S1.p3.1.m1.3.3.3.3.3.3" xref="S1.p3.1.m1.3.3.3.3.3.3.cmml">ms</mi></mrow><annotation-xml encoding="MathML-Content" id="S1.p3.1.m1.3b"><apply id="S1.p3.1.m1.3.3.cmml" xref="S1.p3.1.m1.3.3"><csymbol cd="latexml" id="S1.p3.1.m1.2.2.2.2.2.2.cmml" xref="S1.p3.1.m1.2.2.2.2.2.2">times</csymbol><cn id="S1.p3.1.m1.1.1.1.1.1.1.cmml" type="integer" xref="S1.p3.1.m1.1.1.1.1.1.1">160</cn><csymbol cd="latexml" id="S1.p3.1.m1.3.3.3.3.3.3.cmml" xref="S1.p3.1.m1.3.3.3.3.3.3">millisecond</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.1.m1.3c">160\text{\,}\mathrm{ms}</annotation><annotation encoding="application/x-llamapun" id="S1.p3.1.m1.3d">start_ARG 160 end_ARG start_ARG times end_ARG start_ARG roman_ms end_ARG</annotation></semantics></math>—lower than the <math alttext="230\text{\,}\mathrm{ms}" class="ltx_Math" display="inline" id="S1.p3.2.m2.3"><semantics id="S1.p3.2.m2.3a"><mrow id="S1.p3.2.m2.3.3" xref="S1.p3.2.m2.3.3.cmml"><mn id="S1.p3.2.m2.1.1.1.1.1.1" xref="S1.p3.2.m2.1.1.1.1.1.1.cmml">230</mn><mtext id="S1.p3.2.m2.2.2.2.2.2.2" xref="S1.p3.2.m2.2.2.2.2.2.2.cmml">&nbsp;</mtext><mi class="ltx_unit" id="S1.p3.2.m2.3.3.3.3.3.3" xref="S1.p3.2.m2.3.3.3.3.3.3.cmml">ms</mi></mrow><annotation-xml encoding="MathML-Content" id="S1.p3.2.m2.3b"><apply id="S1.p3.2.m2.3.3.cmml" xref="S1.p3.2.m2.3.3"><csymbol cd="latexml" id="S1.p3.2.m2.2.2.2.2.2.2.cmml" xref="S1.p3.2.m2.2.2.2.2.2.2">times</csymbol><cn id="S1.p3.2.m2.1.1.1.1.1.1.cmml" type="integer" xref="S1.p3.2.m2.1.1.1.1.1.1">230</cn><csymbol cd="latexml" id="S1.p3.2.m2.3.3.3.3.3.3.cmml" xref="S1.p3.2.m2.3.3.3.3.3.3">millisecond</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.2.m2.3c">230\text{\,}\mathrm{ms}</annotation><annotation encoding="application/x-llamapun" id="S1.p3.2.m2.3d">start_ARG 230 end_ARG start_ARG times end_ARG start_ARG roman_ms end_ARG</annotation></semantics></math> average in natural conversations measured over 10 languages&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Stivers et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib89" title="">2009</a>)</cite>. We furthermore introduce the first multi-stream audio language model, i.e. a model that explicitly processes the input and output audio streams jointly into two autoregressive token streams. This altogether removes the concept of speaker turn and thus allows training the model on natural conversations with arbitrary dynamics including overlap and interruptions. Our resulting model is the first <span class="ltx_text ltx_font_italic" id="S1.p3.2.1">full-duplex</span>— it always listens and always generates sound, either speech or silence—real-time conversational LLM. We summarize our contributions below:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We present Helium, a 7B-parameter text LLM that we pretrain on <math alttext="2.1" class="ltx_Math" display="inline" id="S1.I1.i1.p1.1.m1.1"><semantics id="S1.I1.i1.p1.1.m1.1a"><mn id="S1.I1.i1.p1.1.m1.1.1" xref="S1.I1.i1.p1.1.m1.1.1.cmml">2.1</mn><annotation-xml encoding="MathML-Content" id="S1.I1.i1.p1.1.m1.1b"><cn id="S1.I1.i1.p1.1.m1.1.1.cmml" type="float" xref="S1.I1.i1.p1.1.m1.1.1">2.1</cn></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i1.p1.1.m1.1c">2.1</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i1.p1.1.m1.1d">2.1</annotation></semantics></math>T tokens of public English data. <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS2" title="3.2 The Helium Text Language Model ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue">Section <span class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></span></a> describes the architecture and training of the model, while <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S4.SS1" title="4.1 Text Data ‣ 4 Datasets and Training ‣ Moshi: a speech-text foundation model for real-time dialogue">Section <span class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.1</span></span></a> provides details on the pretraining data collection and filtering.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">We train Mimi, a neural audio codec&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Zeghidour et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib108" title="">2022</a>; Défossez et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib21" title="">2023</a>)</cite> that converts audio into the discrete tokens predicted by Moshi and back, using residual vector quantization (RVQ). Audio language models typically combine such <span class="ltx_text ltx_font_italic" id="S1.I1.i2.p1.1.1">acoustic</span> tokens with <span class="ltx_text ltx_font_italic" id="S1.I1.i2.p1.1.2">semantic</span> tokens from a self-supervised speech model as it is necessary to produce intelligible speech in absence of text conditioning&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Borsos et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib6" title="">2022</a>)</cite>. We rather extend the approach of&nbsp;<cite class="ltx_cite ltx_citemacro_citet">Zhang et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib113" title="">2024b</a>)</cite> by distilling semantic information into the first level of acoustic tokens and introduce improved training tricks. <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS3" title="3.3 Audio Tokenization ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue">Section&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></span></a> describes the architecture and training of Mimi while <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.SS2" title="5.2 Audio Tokenization ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue">Section&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.2</span></span></a> details ablation studies.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">We propose Moshi, a new architecture for audio language modeling, which combines Helium with a smaller Transformer&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Vaswani et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib101" title="">2017</a>)</cite> model to predict audio tokens in a hierarchical and streaming fashion. We show how challenging it is for such unconditioned audio language models to generate intelligible speech, and we provide solutions that outperform the intelligibility and audio quality of non-streaming models while generating audio in a streaming fashion. We furthermore extend this architecture to model several audio streams in parallel, allowing for a conceptually and practically simple handling of full-duplex dialogues with arbitrary dynamics. <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS4" title="3.4 Generative Audio Modeling ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue">Section <span class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.4</span></span></a> describes this architecture.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S1.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i4.p1">
<p class="ltx_p" id="S1.I1.i4.p1.1">In <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS4.SSS4" title="3.4.4 Inner Monologue ‣ 3.4 Generative Audio Modeling ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue">Section&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.4.4</span></span></a>, we introduce Inner Monologue, a new training and inference setup for audio language models that significantly improves the factuality and linguistic quality of generated speech by predicting time-aligned text tokens before audio tokens. Moshi is a speech-to-speech model as it allows reasoning about non-linguistic information, both from the user audio and from Moshi’s audio. Yet, this is not incompatible with Moshi producing text along its speech output. Based on the past observation&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Borsos et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib6" title="">2022</a>; Zhang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib113" title="">2024b</a>)</cite> that coarse-to-fine generation (from semantic to acoustic tokens) is critical to generating consistent speech, we extend this hierarchy to using text tokens as a per-timestep prefix to the semantic token. Our experiments show that not only this drastically improves the length and quality of generated speech, but we also show how forcing a delay between text and audio tokens allows deriving streaming ASR and streaming TTS from a Moshi model.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S1.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i5.p1">
<p class="ltx_p" id="S1.I1.i5.p1.1">We evaluate all components of Moshi along several axes, including text understanding, speech intelligibility and consistency, audio quality and spoken question answering. Our experiments, reported in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5" title="5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue">Section&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></span></a>, show that our model is state of the art among existing speech-text models for speech modeling and spoken question answering while being streaming compatible and able to model several minutes of context (<math alttext="5\text{\,}\mathrm{min}" class="ltx_Math" display="inline" id="S1.I1.i5.p1.1.m1.3"><semantics id="S1.I1.i5.p1.1.m1.3a"><mrow id="S1.I1.i5.p1.1.m1.3.3" xref="S1.I1.i5.p1.1.m1.3.3.cmml"><mn id="S1.I1.i5.p1.1.m1.1.1.1.1.1.1" xref="S1.I1.i5.p1.1.m1.1.1.1.1.1.1.cmml">5</mn><mtext id="S1.I1.i5.p1.1.m1.2.2.2.2.2.2" xref="S1.I1.i5.p1.1.m1.2.2.2.2.2.2.cmml">&nbsp;</mtext><mi class="ltx_unit" id="S1.I1.i5.p1.1.m1.3.3.3.3.3.3" xref="S1.I1.i5.p1.1.m1.3.3.3.3.3.3.cmml">min</mi></mrow><annotation-xml encoding="MathML-Content" id="S1.I1.i5.p1.1.m1.3b"><apply id="S1.I1.i5.p1.1.m1.3.3.cmml" xref="S1.I1.i5.p1.1.m1.3.3"><csymbol cd="latexml" id="S1.I1.i5.p1.1.m1.2.2.2.2.2.2.cmml" xref="S1.I1.i5.p1.1.m1.2.2.2.2.2.2">times</csymbol><cn id="S1.I1.i5.p1.1.m1.1.1.1.1.1.1.cmml" type="integer" xref="S1.I1.i5.p1.1.m1.1.1.1.1.1.1">5</cn><csymbol cd="latexml" id="S1.I1.i5.p1.1.m1.3.3.3.3.3.3.cmml" xref="S1.I1.i5.p1.1.m1.3.3.3.3.3.3">minute</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i5.p1.1.m1.3c">5\text{\,}\mathrm{min}</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i5.p1.1.m1.3d">start_ARG 5 end_ARG start_ARG times end_ARG start_ARG roman_min end_ARG</annotation></semantics></math> in our experiments).</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ul>
<p class="ltx_p" id="S1.p3.3">We encourage the reader to talk to Moshi using our web demo.<span class="ltx_note ltx_role_footnote" id="footnote5"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_tag ltx_tag_note">5</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://moshi.chat/" title="">https://moshi.chat/</a></span></span></span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Audio Language Modeling.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S2.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px1.p1.1">Early developments in speech foundation models have improved speech understanding across many discriminative tasks, from automatic speech recognition (ASR)&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Baevski et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib3" title="">2020</a>; Radford et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib77" title="">2023</a>; Zhang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib115" title="">2023b</a>)</cite> to speaker verification&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Chen et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib12" title="">2022</a>)</cite> and speech classification&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Yang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib106" title="">2021</a>)</cite>. A key factor in this development is self-supervised learning&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Hsu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib42" title="">2021</a>; Baevski et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib3" title="">2020</a>; Chen et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib12" title="">2022</a>)</cite> which allows learning generic, discriminative speech representations. As these speech understanding models build on previous work done on masked language modeling for text&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Devlin et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib24" title="">2019</a>)</cite>, generative text pretraining&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Radford et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib75" title="">2018</a>)</cite> has similarly inspired a large family of speech generation models. In particular,&nbsp;<cite class="ltx_cite ltx_citemacro_citet">Lakhotia et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib54" title="">2021</a>)</cite> propose quantizing aforementioned self-supervised representations. The resulting discrete <span class="ltx_text ltx_font_italic" id="S2.SS0.SSS0.Px1.p1.1.1">audio tokens</span> represent a speech segment as a sequence of categorical variables, thus casting speech generation as a language modeling task. AudioLM <cite class="ltx_cite ltx_citemacro_citep">(Borsos et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib6" title="">2022</a>)</cite> furthermore combines these <span class="ltx_text ltx_font_italic" id="S2.SS0.SSS0.Px1.p1.1.2">semantic</span> tokens with <span class="ltx_text ltx_font_italic" id="S2.SS0.SSS0.Px1.p1.1.3">acoustic</span> tokens from a neural audio codec&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Zeghidour et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib108" title="">2022</a>)</cite>, which allows for modeling arbitrary voices, recording conditions and non-speech sounds. These audio language models have redefined the state of the art in speech generation, from text-to-speech&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Wang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib103" title="">2023</a>; Kharitonov et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib47" title="">2023</a>)</cite> to speech-to-speech translation&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Rubenstein et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib79" title="">2023</a>; Reid et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib78" title="">2024</a>)</cite> and speech enhancement&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Yang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib105" title="">2023</a>)</cite>. Beyond these supervised tasks, a parallel line of work has explored training and scaling unsupervised audio-only models, trained for autoregressive speech generation&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Dunbar et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib26" title="">2021</a>; Lakhotia et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib54" title="">2021</a>; Borsos et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib6" title="">2022</a>)</cite>. The abilities of these models have progressively expanded, from generating short sentences in a single speaker voice&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Lakhotia et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib54" title="">2021</a>)</cite> to producing meaningful and consistent speech continuations across dozens of seconds in arbitrary voices and conditions&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Borsos et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib6" title="">2022</a>)</cite>, thanks to a hierarchical modeling of semantic and acoustic tokens. A main challenge is that audio requires the modeling of long sequences, up to a few minutes, to produce meaningful and exploitable outputs. However, latent representations for audio are typically less compact than equivalent representations for text. Thus, discrete representations from neural audio codecs require multiple predictions per timestep when modeled autoregressively. <cite class="ltx_cite ltx_citemacro_citep">(Liu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib58" title="">2023b</a>)</cite> and <cite class="ltx_cite ltx_citemacro_citep">(Evans et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib27" title="">2024</a>)</cite> use latent diffusion&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Ho et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib39" title="">2020</a>)</cite> for general audio and music modeling
to alleviate the need for hierarchical discrete tokens. However, these methods cannot be used in a streaming fashion, and it is unclear whether they could generate consistent speech. <cite class="ltx_cite ltx_citemacro_citet">Copet et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib18" title="">2023</a>)</cite> instead show that the number of auto-regressive steps can be reduced by introducing a delay between the different levels of tokens, and performing parallel prediction over them. Inspired by the RQ-Transformer method by&nbsp;<cite class="ltx_cite ltx_citemacro_citet">Lee et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib55" title="">2022</a>)</cite> and the hierarchical MegaByte transformer model&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Yu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib107" title="">2024</a>)</cite>,
<cite class="ltx_cite ltx_citemacro_citet">Yang et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib105" title="">2023</a>)</cite> and <cite class="ltx_cite ltx_citemacro_citet">Zhu et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib117" title="">2024</a>)</cite> leverage a smaller nested transformer to model the different tokens at a single time step. In this work, we extend these previous works to push the limits of autoregressive speech generation by proposing a scalable hierarchical modeling of audio tokens which can handle several minutes of context while generating audio in real time. Still, while speech-only models learn linguistic structure—lexicon, syntax, semantics— from raw speech&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Dunbar et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib26" title="">2021</a>)</cite>, they typically demonstrate poor-to-nonexistent factual knowledge and reasoning abilities. This has led to the development of speech-text models, intended to combine the knowledge and reasoning abilities of text models with the generative power of audio models.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Speech-text Models.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S2.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px2.p1.1">Such models typically start from a pretrained text language model and either finetune it to predict audio&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Hassid et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib33" title="">2023</a>)</cite>, or propose a speech-text finetuning task&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Rubenstein et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib79" title="">2023</a>; Maiti et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib66" title="">2023</a>; Nachmani et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib69" title="">2024</a>; Nguyen et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib72" title="">2024</a>; Mitsui et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib68" title="">2024</a>; Zhang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib112" title="">2024a</a>)</cite>: For instance, AudioPALM&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Rubenstein et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib79" title="">2023</a>)</cite> starts from a pretrained PALM&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Chowdhery et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib13" title="">2022</a>)</cite> model, and extends its text vocabulary with semantic audio tokens. Then, the model is trained for a mixture of speech-text tasks, including TTS, ASR and speech-to-speech translation. VoxTLM&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Maiti et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib66" title="">2023</a>)</cite> adopts a similar approach for TTS and ASR. While these models are trained in a supervised fashion with specific input and output sequences, Spirit-LM&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Nguyen et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib72" title="">2024</a>)</cite> uses temporal alignment between speech and its transcript to perform modality switch (from speech tokens to text tokens, or conversely) inside a sequence. This allows the model to learn consistent internal representations of language regardless of it being represented as text or speech, as measured through commonsense evaluation. Another approach, adopted by Spectron&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Nachmani et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib69" title="">2024</a>)</cite>, SpeechGPT&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Zhang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib111" title="">2023a</a>)</cite> and PSLM&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Mitsui et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib68" title="">2024</a>)</cite>, combines speech and text in a hierarchical manner rather than as interchangeable representations. Similar to how AudioLM&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Borsos et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib6" title="">2022</a>)</cite> decomposes speech generation into predicting semantic tokens and <span class="ltx_text ltx_font_italic" id="S2.SS0.SSS0.Px2.p1.1.1">then</span> acoustic tokens, Spectron and SpeechGPT use a “Chain-of-Modality” and first produce an utterance as text tokens, subsequently used as a prefix to generate speech. This allows guiding speech generation with the output of an underlying text LLM, however this is fundamentally incompatible with live interactions as the model needs to produce an entire answer as text before it starts speaking. PSLM alleviates this limitation by modeling text and speech tokens in parallel. In this work, we propose Inner Monologue as a main architectural and training component to combine aligned text and speech data. Inner Monologue decomposes speech into a chain of text, semantic and acoustic tokens, and predicts this structured sequence in a hierarchical manner. Unlike Spirit-LM, this allows representing all utterances both as text and speech, rather than switching between modalities; In addition, the integration of acoustic tokens into the same generative model enables generating arbitrary voices and conditions, rather than a single speaker. Besides, this hierarchical modeling described in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS4.SSS4" title="3.4.4 Inner Monologue ‣ 3.4 Generative Audio Modeling ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue">Section&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.4.4</span></span></a> allows decomposing the generation task without increasing the sequence length of the Transformer&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Vaswani et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib101" title="">2017</a>)</cite> outputs, unlike Chain-of-Modality, while benefiting from producing text a prefix to audio tokens rather than in parallel like PSLM. Moreover, Inner Monologue decomposes speech on a per-frame basis, which means that each prediction step outputs a speech frame. This is unlike Spectron and SpeechGPT which require generating a complete sequence as text before generating audio tokens, and this makes Moshi compatible with real-time generation. Moreover, we show in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS4.SSS4" title="3.4.4 Inner Monologue ‣ 3.4 Generative Audio Modeling ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue">Section&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.4.4</span></span></a> how Inner Monologue, when combined with a delay between token types, allows deriving streaming TTS and ASR systems from Moshi. Finally, while Spectron, SpeechGPT and PSLM model both user and system speech and text tokens into a single stream, which requires properly segmented turns, Moshi benefits from a novel multi-stream architectures which removes the concept of speaker turns and allows for modeling any type of overlap, interruptions and interjections.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">Spoken Dialogue Models.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S2.SS0.SSS0.Px3.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px3.p1.1">Spoken dialogue is one of the less explored tasks in speech generation, as it requires addressing several challenges: 1) The model should run in real time and allow for long conversations in full-duplex—the model always listens and can speak at any moment; 2) it should be speech-to-speech to handle paralinguistic communication; 3) it should display knowledge and reasoning abilities that make it amenable to helpful and enjoyable conversations. Spectron benefits from its underlying text LLM (as measured by spoken question answering), however it is not compatible with real-time generation due to Chain-of-Modality. PSLM proposes generating speech and text tokens in parallel to reduce this latency, however it reduces the quality of answers, and the model still relies on ASR, which removes paralinguistic information. More importantly, these models cannot handle full-duplex communication, where there is no boundary between speaker turns, as any side of the conversation can be active at any time. An attempt at modeling these dynamics has been proposed by <cite class="ltx_cite ltx_citemacro_citet">Wang et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib104" title="">2024</a>)</cite>, with an ASR system running in parallel to a text generator that feeds into a streaming TTS. While this allows modeling more complex scenarios than previous approaches, it still relies on a cascaded pipeline and models both the user’s and the system’s speech into a single token stream, which is challenging in presence of significant overlap. The only previous full-duplex dialogue system is dGSLM&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Nguyen et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib71" title="">2023</a>)</cite>, which models user and system speech as separate audio token streams and proposes a Siamese architecture to process both streams jointly. While dGSLM is full-duplex, it remains a proof-of-concept: it does not run in an online fashion, it does not benefit from the knowledge of a text language model, and it does not model acoustic information as it only models semantic tokens. Moshi addresses these limitations altogether: by modeling two streams of semantic and acoustic tokens hierarchically, Moshi is full duplex and can exploit all the information from the user (linguistic and non-linguistic) while producing speech in real time. Thanks to text pretraining and Inner Monologue, Moshi benefits from the knowledge of its Helium backbone. Finally, as the model produces acoustic tokens along with text and semantic tokens, it can generate an arbitrary range of emotions, voices and acoustic conditions. To the best of our knowledge, Moshi is the first audio language model that successfully addresses the many aforementioned challenges of spoken dialogue.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Model</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Overview</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="S3.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="226" id="S3.F1.g1" src="https://arxiv.org/html/2410.00037v2/extracted/5895270/figures/overview_moshi_v2.png" width="509">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span><span class="ltx_text ltx_font_bold" id="S3.F1.2.1">Overview of Moshi</span>. Moshi is a speech-text foundation model which enables real-time spoken dialogue.
The main components of Moshi’s architecture are: a bespoke text language model backbone (Helium, see <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS2" title="3.2 The Helium Text Language Model ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue">Section <span class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></span>)</a>; a neural audio codec with residual vector quantization and with semantic knowledge distilled from a self-supervised speech model (Mimi, <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS3" title="3.3 Audio Tokenization ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue">Section <span class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></span></a>); the streaming, hierarchical generation of semantic and acoustic tokens for both the user and Moshi, along with time-aligned text tokens for Moshi when using Inner Monologue (<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS4" title="3.4 Generative Audio Modeling ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue">Section <span class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.4</span></span></a>).
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">Moshi is a multi-stream speech-to-speech Transformer model, which allows for full-duplex spoken dialogue with a user thanks to an innovative architecture summarized in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.F1" title="Figure 1 ‣ 3.1 Overview ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue">Figure <span class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></span></a>.
Moshi is built on top of Helium, a text LLM which we build from scratch (<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS2" title="3.2 The Helium Text Language Model ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue">Section <span class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></span></a>), relying on high-quality text data to provide strong reasoning abilities to the model.
We also propose Inner Monologue (<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS4.SSS4" title="3.4.4 Inner Monologue ‣ 3.4 Generative Audio Modeling ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue">Section <span class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.4.4</span></span></a>), a training and inference procedure in which we jointly model text and audio tokens. This allows the model to fully exploit the knowledge imparted from the text modality, while remaining a speech-to-speech system.
To enable real-time dialogue, we also design Moshi as a multi-stream architecture from the get-go (<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS4.SSS3" title="3.4.3 Multi-stream modeling ‣ 3.4 Generative Audio Modeling ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue">Section <span class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.4.3</span></span></a>): The model is able to both speak and listen to the user at the same time, and does not need to explicitly model speaker turns.
In addition, to capture the input user audio and output Moshi’s voice with high quality and in an efficient manner, we propose Mimi (<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS3" title="3.3 Audio Tokenization ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue">Section <span class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></span></a>), a neural audio codec combining semantic and acoustic information into a single tokenizer by using residual vector quantization and knowledge distillation.
To jointly model the audio streams from Moshi and the user, as well as Moshi’s text tokens, we rely on a Depth Transformer compatible with streaming inference (<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS4.SSS1" title="3.4.1 Hierarchical autoregressive modeling with RQ-Transformer ‣ 3.4 Generative Audio Modeling ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue">Sections <span class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.4.1</span></span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS4.SSS2" title="3.4.2 Audio modeling ‣ 3.4 Generative Audio Modeling ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_tag">3.4.2</span></a>).</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.1">In this section, we further detail each of these components. We then describe the training datasets and the different training phases we used to train Moshi in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S4" title="4 Datasets and Training ‣ Moshi: a speech-text foundation model for real-time dialogue">Section <span class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></span></a>.
Finally, in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5" title="5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue">Section <span class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></span></a>, we report thorough evaluation results on Moshi’s abilities, both linguistic and acoustic, as well as ablation experiments on its main components, while <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S6" title="6 Safety ‣ Moshi: a speech-text foundation model for real-time dialogue">Section&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></span></a> provides analyses on the safety of our system.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>The Helium Text Language Model</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsubsection" id="S3.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.1 </span>Architecture</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.SS2.SSS1.p1">
<p class="ltx_p" id="S3.SS2.SSS1.p1.1">Helium is an autoregressive language model, based on the Transformer architecture&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Vaswani et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib101" title="">2017</a>)</cite>.
Following previous work in this area, we make the following changes to the original architecture:
First, we use RMS normalization&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Zhang and Sennrich, <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib110" title="">2019</a>)</cite> at the input of the attention blocks, the feed-forward blocks and the output linear layer of the model.
We use rotation positional embeddings&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Su et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib90" title="">2024</a>, RoPE)</cite>, a context length of 4,096 tokens and FlashAttention&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Dao et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib19" title="">2022</a>)</cite> for efficient training.
Finally, we change the architecture of the feed-forward blocks and use Gated Linear Units&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Shazeer, <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib88" title="">2020</a>)</cite>, with the SiLU activation as a gating function&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Hendrycks and Gimpel, <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib36" title="">2016b</a>)</cite>.
Our tokenizer is based on the unigram model from SentencePiece&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Kudo and Richardson, <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib50" title="">2018</a>)</cite>, and contains 32,000 elements mostly targeting English.
We split all numbers into single digits, and use byte-backoff to ensure that our tokenizer does not lose information.
We train the model with the AdamW&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Loshchilov and Hutter, <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib63" title="">2017</a>)</cite> optimizer, with a fixed learning rate followed by a cosine learning rate decay&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Loshchilov and Hutter, <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib62" title="">2016</a>)</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="S3.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span><span class="ltx_text ltx_font_bold" id="S3.T1.12.1">Models’ hyper-parameters</span>. Hyper-parameters for the architecture and training of our 7B-parameter Helium language model and of Moshi, our speech-text dialogue model.
The training of Moshi goes through 4 phases: Pre-training on unsupervised data (with Temporal Transformer initialized from Helium); Post-training with simulated multi-stream based on diarization; Fine-tuning on the Fisher dataset&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Cieri et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib15" title="">2004</a>)</cite> to gain its fully duplex capabilities; Instruction fine-tuning on a custom dataset built from synthetic interaction scripts. During the pre-training phase, we keep training half of the time on full text batches from the same dataset as used for Helium, using a separate optimizer state.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T1.10">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T1.10.11.1">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S3.T1.10.11.1.1"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S3.T1.10.11.1.2"><span class="ltx_text" id="S3.T1.10.11.1.2.1" style="font-size:80%;">Helium training</span></th>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="4" id="S3.T1.10.11.1.3"><span class="ltx_text" id="S3.T1.10.11.1.3.1" style="font-size:80%;">Moshi training</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.10.12.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S3.T1.10.12.2.1"><span class="ltx_text" id="S3.T1.10.12.2.1.1" style="font-size:80%;">Hyper-parameter</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T1.10.12.2.2"><span class="ltx_text" id="S3.T1.10.12.2.2.1" style="font-size:80%;">pre-training</span></th>
<td class="ltx_td ltx_align_center" id="S3.T1.10.12.2.3"><span class="ltx_text" id="S3.T1.10.12.2.3.1" style="font-size:80%;">pre-training</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.10.12.2.4"><span class="ltx_text" id="S3.T1.10.12.2.4.1" style="font-size:80%;">post-training</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.10.12.2.5"><span class="ltx_text" id="S3.T1.10.12.2.5.1" style="font-size:80%;">fisher</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.10.12.2.6"><span class="ltx_text" id="S3.T1.10.12.2.6.1" style="font-size:80%;">fine</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.10.13.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="6" id="S3.T1.10.13.3.1"><span class="ltx_text ltx_font_italic" id="S3.T1.10.13.3.1.1" style="font-size:80%;">Temporal Transformer</span></th>
</tr>
<tr class="ltx_tr" id="S3.T1.10.14.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T1.10.14.4.1"><span class="ltx_text" id="S3.T1.10.14.4.1.1" style="font-size:80%;">Model dimension</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T1.10.14.4.2"><span class="ltx_text" id="S3.T1.10.14.4.2.1" style="font-size:80%;">4096</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="4" id="S3.T1.10.14.4.3" rowspan="4"><span class="ltx_text" id="S3.T1.10.14.4.3.1" style="font-size:80%;">same</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.10.15.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S3.T1.10.15.5.1"><span class="ltx_text" id="S3.T1.10.15.5.1.1" style="font-size:80%;">MLP dimension</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T1.10.15.5.2"><span class="ltx_text" id="S3.T1.10.15.5.2.1" style="font-size:80%;">11264</span></th>
</tr>
<tr class="ltx_tr" id="S3.T1.10.16.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S3.T1.10.16.6.1"><span class="ltx_text" id="S3.T1.10.16.6.1.1" style="font-size:80%;">Number of heads</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T1.10.16.6.2"><span class="ltx_text" id="S3.T1.10.16.6.2.1" style="font-size:80%;">32</span></th>
</tr>
<tr class="ltx_tr" id="S3.T1.10.17.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S3.T1.10.17.7.1"><span class="ltx_text" id="S3.T1.10.17.7.1.1" style="font-size:80%;">Number of layers</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T1.10.17.7.2"><span class="ltx_text" id="S3.T1.10.17.7.2.1" style="font-size:80%;">32</span></th>
</tr>
<tr class="ltx_tr" id="S3.T1.10.18.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S3.T1.10.18.8.1"><span class="ltx_text" id="S3.T1.10.18.8.1.1" style="font-size:80%;">Context size</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T1.10.18.8.2"><span class="ltx_text" id="S3.T1.10.18.8.2.1" style="font-size:80%;">4096</span></th>
<td class="ltx_td ltx_align_center" colspan="4" id="S3.T1.10.18.8.3"><span class="ltx_text" id="S3.T1.10.18.8.3.1" style="font-size:80%;">3000 steps, e.g. 4 min.</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S3.T1.5.5.6"><span class="ltx_text" id="S3.T1.5.5.6.1" style="font-size:80%;">Learning rate</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T1.1.1.1"><math alttext="3\cdot 10^{-4}" class="ltx_Math" display="inline" id="S3.T1.1.1.1.m1.1"><semantics id="S3.T1.1.1.1.m1.1a"><mrow id="S3.T1.1.1.1.m1.1.1" xref="S3.T1.1.1.1.m1.1.1.cmml"><mn id="S3.T1.1.1.1.m1.1.1.2" mathsize="80%" xref="S3.T1.1.1.1.m1.1.1.2.cmml">3</mn><mo id="S3.T1.1.1.1.m1.1.1.1" lspace="0.222em" mathsize="80%" rspace="0.222em" xref="S3.T1.1.1.1.m1.1.1.1.cmml">⋅</mo><msup id="S3.T1.1.1.1.m1.1.1.3" xref="S3.T1.1.1.1.m1.1.1.3.cmml"><mn id="S3.T1.1.1.1.m1.1.1.3.2" mathsize="80%" xref="S3.T1.1.1.1.m1.1.1.3.2.cmml">10</mn><mrow id="S3.T1.1.1.1.m1.1.1.3.3" xref="S3.T1.1.1.1.m1.1.1.3.3.cmml"><mo id="S3.T1.1.1.1.m1.1.1.3.3a" mathsize="80%" xref="S3.T1.1.1.1.m1.1.1.3.3.cmml">−</mo><mn id="S3.T1.1.1.1.m1.1.1.3.3.2" mathsize="80%" xref="S3.T1.1.1.1.m1.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.1.1.1.m1.1b"><apply id="S3.T1.1.1.1.m1.1.1.cmml" xref="S3.T1.1.1.1.m1.1.1"><ci id="S3.T1.1.1.1.m1.1.1.1.cmml" xref="S3.T1.1.1.1.m1.1.1.1">⋅</ci><cn id="S3.T1.1.1.1.m1.1.1.2.cmml" type="integer" xref="S3.T1.1.1.1.m1.1.1.2">3</cn><apply id="S3.T1.1.1.1.m1.1.1.3.cmml" xref="S3.T1.1.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.T1.1.1.1.m1.1.1.3.1.cmml" xref="S3.T1.1.1.1.m1.1.1.3">superscript</csymbol><cn id="S3.T1.1.1.1.m1.1.1.3.2.cmml" type="integer" xref="S3.T1.1.1.1.m1.1.1.3.2">10</cn><apply id="S3.T1.1.1.1.m1.1.1.3.3.cmml" xref="S3.T1.1.1.1.m1.1.1.3.3"><minus id="S3.T1.1.1.1.m1.1.1.3.3.1.cmml" xref="S3.T1.1.1.1.m1.1.1.3.3"></minus><cn id="S3.T1.1.1.1.m1.1.1.3.3.2.cmml" type="integer" xref="S3.T1.1.1.1.m1.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.1.1.1.m1.1c">3\cdot 10^{-4}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.1.1.1.m1.1d">3 ⋅ 10 start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="S3.T1.2.2.2"><math alttext="3\cdot 10^{-5}" class="ltx_Math" display="inline" id="S3.T1.2.2.2.m1.1"><semantics id="S3.T1.2.2.2.m1.1a"><mrow id="S3.T1.2.2.2.m1.1.1" xref="S3.T1.2.2.2.m1.1.1.cmml"><mn id="S3.T1.2.2.2.m1.1.1.2" mathsize="80%" xref="S3.T1.2.2.2.m1.1.1.2.cmml">3</mn><mo id="S3.T1.2.2.2.m1.1.1.1" lspace="0.222em" mathsize="80%" rspace="0.222em" xref="S3.T1.2.2.2.m1.1.1.1.cmml">⋅</mo><msup id="S3.T1.2.2.2.m1.1.1.3" xref="S3.T1.2.2.2.m1.1.1.3.cmml"><mn id="S3.T1.2.2.2.m1.1.1.3.2" mathsize="80%" xref="S3.T1.2.2.2.m1.1.1.3.2.cmml">10</mn><mrow id="S3.T1.2.2.2.m1.1.1.3.3" xref="S3.T1.2.2.2.m1.1.1.3.3.cmml"><mo id="S3.T1.2.2.2.m1.1.1.3.3a" mathsize="80%" xref="S3.T1.2.2.2.m1.1.1.3.3.cmml">−</mo><mn id="S3.T1.2.2.2.m1.1.1.3.3.2" mathsize="80%" xref="S3.T1.2.2.2.m1.1.1.3.3.2.cmml">5</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.2.2.2.m1.1b"><apply id="S3.T1.2.2.2.m1.1.1.cmml" xref="S3.T1.2.2.2.m1.1.1"><ci id="S3.T1.2.2.2.m1.1.1.1.cmml" xref="S3.T1.2.2.2.m1.1.1.1">⋅</ci><cn id="S3.T1.2.2.2.m1.1.1.2.cmml" type="integer" xref="S3.T1.2.2.2.m1.1.1.2">3</cn><apply id="S3.T1.2.2.2.m1.1.1.3.cmml" xref="S3.T1.2.2.2.m1.1.1.3"><csymbol cd="ambiguous" id="S3.T1.2.2.2.m1.1.1.3.1.cmml" xref="S3.T1.2.2.2.m1.1.1.3">superscript</csymbol><cn id="S3.T1.2.2.2.m1.1.1.3.2.cmml" type="integer" xref="S3.T1.2.2.2.m1.1.1.3.2">10</cn><apply id="S3.T1.2.2.2.m1.1.1.3.3.cmml" xref="S3.T1.2.2.2.m1.1.1.3.3"><minus id="S3.T1.2.2.2.m1.1.1.3.3.1.cmml" xref="S3.T1.2.2.2.m1.1.1.3.3"></minus><cn id="S3.T1.2.2.2.m1.1.1.3.3.2.cmml" type="integer" xref="S3.T1.2.2.2.m1.1.1.3.3.2">5</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.2.2.2.m1.1c">3\cdot 10^{-5}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.2.2.2.m1.1d">3 ⋅ 10 start_POSTSUPERSCRIPT - 5 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S3.T1.3.3.3"><math alttext="3\cdot 10^{-6}" class="ltx_Math" display="inline" id="S3.T1.3.3.3.m1.1"><semantics id="S3.T1.3.3.3.m1.1a"><mrow id="S3.T1.3.3.3.m1.1.1" xref="S3.T1.3.3.3.m1.1.1.cmml"><mn id="S3.T1.3.3.3.m1.1.1.2" mathsize="80%" xref="S3.T1.3.3.3.m1.1.1.2.cmml">3</mn><mo id="S3.T1.3.3.3.m1.1.1.1" lspace="0.222em" mathsize="80%" rspace="0.222em" xref="S3.T1.3.3.3.m1.1.1.1.cmml">⋅</mo><msup id="S3.T1.3.3.3.m1.1.1.3" xref="S3.T1.3.3.3.m1.1.1.3.cmml"><mn id="S3.T1.3.3.3.m1.1.1.3.2" mathsize="80%" xref="S3.T1.3.3.3.m1.1.1.3.2.cmml">10</mn><mrow id="S3.T1.3.3.3.m1.1.1.3.3" xref="S3.T1.3.3.3.m1.1.1.3.3.cmml"><mo id="S3.T1.3.3.3.m1.1.1.3.3a" mathsize="80%" xref="S3.T1.3.3.3.m1.1.1.3.3.cmml">−</mo><mn id="S3.T1.3.3.3.m1.1.1.3.3.2" mathsize="80%" xref="S3.T1.3.3.3.m1.1.1.3.3.2.cmml">6</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.3.3.3.m1.1b"><apply id="S3.T1.3.3.3.m1.1.1.cmml" xref="S3.T1.3.3.3.m1.1.1"><ci id="S3.T1.3.3.3.m1.1.1.1.cmml" xref="S3.T1.3.3.3.m1.1.1.1">⋅</ci><cn id="S3.T1.3.3.3.m1.1.1.2.cmml" type="integer" xref="S3.T1.3.3.3.m1.1.1.2">3</cn><apply id="S3.T1.3.3.3.m1.1.1.3.cmml" xref="S3.T1.3.3.3.m1.1.1.3"><csymbol cd="ambiguous" id="S3.T1.3.3.3.m1.1.1.3.1.cmml" xref="S3.T1.3.3.3.m1.1.1.3">superscript</csymbol><cn id="S3.T1.3.3.3.m1.1.1.3.2.cmml" type="integer" xref="S3.T1.3.3.3.m1.1.1.3.2">10</cn><apply id="S3.T1.3.3.3.m1.1.1.3.3.cmml" xref="S3.T1.3.3.3.m1.1.1.3.3"><minus id="S3.T1.3.3.3.m1.1.1.3.3.1.cmml" xref="S3.T1.3.3.3.m1.1.1.3.3"></minus><cn id="S3.T1.3.3.3.m1.1.1.3.3.2.cmml" type="integer" xref="S3.T1.3.3.3.m1.1.1.3.3.2">6</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.3.3.3.m1.1c">3\cdot 10^{-6}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.3.3.3.m1.1d">3 ⋅ 10 start_POSTSUPERSCRIPT - 6 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S3.T1.4.4.4"><math alttext="2\cdot 10^{-6}" class="ltx_Math" display="inline" id="S3.T1.4.4.4.m1.1"><semantics id="S3.T1.4.4.4.m1.1a"><mrow id="S3.T1.4.4.4.m1.1.1" xref="S3.T1.4.4.4.m1.1.1.cmml"><mn id="S3.T1.4.4.4.m1.1.1.2" mathsize="80%" xref="S3.T1.4.4.4.m1.1.1.2.cmml">2</mn><mo id="S3.T1.4.4.4.m1.1.1.1" lspace="0.222em" mathsize="80%" rspace="0.222em" xref="S3.T1.4.4.4.m1.1.1.1.cmml">⋅</mo><msup id="S3.T1.4.4.4.m1.1.1.3" xref="S3.T1.4.4.4.m1.1.1.3.cmml"><mn id="S3.T1.4.4.4.m1.1.1.3.2" mathsize="80%" xref="S3.T1.4.4.4.m1.1.1.3.2.cmml">10</mn><mrow id="S3.T1.4.4.4.m1.1.1.3.3" xref="S3.T1.4.4.4.m1.1.1.3.3.cmml"><mo id="S3.T1.4.4.4.m1.1.1.3.3a" mathsize="80%" xref="S3.T1.4.4.4.m1.1.1.3.3.cmml">−</mo><mn id="S3.T1.4.4.4.m1.1.1.3.3.2" mathsize="80%" xref="S3.T1.4.4.4.m1.1.1.3.3.2.cmml">6</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.4.4.4.m1.1b"><apply id="S3.T1.4.4.4.m1.1.1.cmml" xref="S3.T1.4.4.4.m1.1.1"><ci id="S3.T1.4.4.4.m1.1.1.1.cmml" xref="S3.T1.4.4.4.m1.1.1.1">⋅</ci><cn id="S3.T1.4.4.4.m1.1.1.2.cmml" type="integer" xref="S3.T1.4.4.4.m1.1.1.2">2</cn><apply id="S3.T1.4.4.4.m1.1.1.3.cmml" xref="S3.T1.4.4.4.m1.1.1.3"><csymbol cd="ambiguous" id="S3.T1.4.4.4.m1.1.1.3.1.cmml" xref="S3.T1.4.4.4.m1.1.1.3">superscript</csymbol><cn id="S3.T1.4.4.4.m1.1.1.3.2.cmml" type="integer" xref="S3.T1.4.4.4.m1.1.1.3.2">10</cn><apply id="S3.T1.4.4.4.m1.1.1.3.3.cmml" xref="S3.T1.4.4.4.m1.1.1.3.3"><minus id="S3.T1.4.4.4.m1.1.1.3.3.1.cmml" xref="S3.T1.4.4.4.m1.1.1.3.3"></minus><cn id="S3.T1.4.4.4.m1.1.1.3.3.2.cmml" type="integer" xref="S3.T1.4.4.4.m1.1.1.3.3.2">6</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.4.4.4.m1.1c">2\cdot 10^{-6}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.4.4.4.m1.1d">2 ⋅ 10 start_POSTSUPERSCRIPT - 6 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.5.5"><math alttext="2\cdot 10^{-6}" class="ltx_Math" display="inline" id="S3.T1.5.5.5.m1.1"><semantics id="S3.T1.5.5.5.m1.1a"><mrow id="S3.T1.5.5.5.m1.1.1" xref="S3.T1.5.5.5.m1.1.1.cmml"><mn id="S3.T1.5.5.5.m1.1.1.2" mathsize="80%" xref="S3.T1.5.5.5.m1.1.1.2.cmml">2</mn><mo id="S3.T1.5.5.5.m1.1.1.1" lspace="0.222em" mathsize="80%" rspace="0.222em" xref="S3.T1.5.5.5.m1.1.1.1.cmml">⋅</mo><msup id="S3.T1.5.5.5.m1.1.1.3" xref="S3.T1.5.5.5.m1.1.1.3.cmml"><mn id="S3.T1.5.5.5.m1.1.1.3.2" mathsize="80%" xref="S3.T1.5.5.5.m1.1.1.3.2.cmml">10</mn><mrow id="S3.T1.5.5.5.m1.1.1.3.3" xref="S3.T1.5.5.5.m1.1.1.3.3.cmml"><mo id="S3.T1.5.5.5.m1.1.1.3.3a" mathsize="80%" xref="S3.T1.5.5.5.m1.1.1.3.3.cmml">−</mo><mn id="S3.T1.5.5.5.m1.1.1.3.3.2" mathsize="80%" xref="S3.T1.5.5.5.m1.1.1.3.3.2.cmml">6</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.5.5.5.m1.1b"><apply id="S3.T1.5.5.5.m1.1.1.cmml" xref="S3.T1.5.5.5.m1.1.1"><ci id="S3.T1.5.5.5.m1.1.1.1.cmml" xref="S3.T1.5.5.5.m1.1.1.1">⋅</ci><cn id="S3.T1.5.5.5.m1.1.1.2.cmml" type="integer" xref="S3.T1.5.5.5.m1.1.1.2">2</cn><apply id="S3.T1.5.5.5.m1.1.1.3.cmml" xref="S3.T1.5.5.5.m1.1.1.3"><csymbol cd="ambiguous" id="S3.T1.5.5.5.m1.1.1.3.1.cmml" xref="S3.T1.5.5.5.m1.1.1.3">superscript</csymbol><cn id="S3.T1.5.5.5.m1.1.1.3.2.cmml" type="integer" xref="S3.T1.5.5.5.m1.1.1.3.2">10</cn><apply id="S3.T1.5.5.5.m1.1.1.3.3.cmml" xref="S3.T1.5.5.5.m1.1.1.3.3"><minus id="S3.T1.5.5.5.m1.1.1.3.3.1.cmml" xref="S3.T1.5.5.5.m1.1.1.3.3"></minus><cn id="S3.T1.5.5.5.m1.1.1.3.3.2.cmml" type="integer" xref="S3.T1.5.5.5.m1.1.1.3.3.2">6</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.5.5.5.m1.1c">2\cdot 10^{-6}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.5.5.5.m1.1d">2 ⋅ 10 start_POSTSUPERSCRIPT - 6 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S3.T1.10.19.9">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="6" id="S3.T1.10.19.9.1"><span class="ltx_text ltx_font_italic" id="S3.T1.10.19.9.1.1" style="font-size:80%;">Depth Transformer</span></th>
</tr>
<tr class="ltx_tr" id="S3.T1.10.20.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T1.10.20.10.1"><span class="ltx_text" id="S3.T1.10.20.10.1.1" style="font-size:80%;">Model dimension</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T1.10.20.10.2"><span class="ltx_text" id="S3.T1.10.20.10.2.1" style="font-size:80%;">-</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="4" id="S3.T1.10.20.10.3"><span class="ltx_text" id="S3.T1.10.20.10.3.1" style="font-size:80%;">1024</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.10.21.11">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S3.T1.10.21.11.1"><span class="ltx_text" id="S3.T1.10.21.11.1.1" style="font-size:80%;">MLP dimension</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T1.10.21.11.2"><span class="ltx_text" id="S3.T1.10.21.11.2.1" style="font-size:80%;">-</span></th>
<td class="ltx_td ltx_align_center" colspan="4" id="S3.T1.10.21.11.3"><span class="ltx_text" id="S3.T1.10.21.11.3.1" style="font-size:80%;">4096</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.10.22.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S3.T1.10.22.12.1"><span class="ltx_text" id="S3.T1.10.22.12.1.1" style="font-size:80%;">Number of heads</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T1.10.22.12.2"><span class="ltx_text" id="S3.T1.10.22.12.2.1" style="font-size:80%;">-</span></th>
<td class="ltx_td ltx_align_center" colspan="4" id="S3.T1.10.22.12.3"><span class="ltx_text" id="S3.T1.10.22.12.3.1" style="font-size:80%;">16</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.10.23.13">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S3.T1.10.23.13.1"><span class="ltx_text" id="S3.T1.10.23.13.1.1" style="font-size:80%;">Number of layers</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T1.10.23.13.2"><span class="ltx_text" id="S3.T1.10.23.13.2.1" style="font-size:80%;">-</span></th>
<td class="ltx_td ltx_align_center" colspan="4" id="S3.T1.10.23.13.3"><span class="ltx_text" id="S3.T1.10.23.13.3.1" style="font-size:80%;">6</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.9.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S3.T1.9.9.5"><span class="ltx_text" id="S3.T1.9.9.5.1" style="font-size:80%;">Learning rate</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T1.9.9.6"><span class="ltx_text" id="S3.T1.9.9.6.1" style="font-size:80%;">-</span></th>
<td class="ltx_td ltx_align_center" id="S3.T1.6.6.1"><math alttext="2\cdot 10^{-4}" class="ltx_Math" display="inline" id="S3.T1.6.6.1.m1.1"><semantics id="S3.T1.6.6.1.m1.1a"><mrow id="S3.T1.6.6.1.m1.1.1" xref="S3.T1.6.6.1.m1.1.1.cmml"><mn id="S3.T1.6.6.1.m1.1.1.2" mathsize="80%" xref="S3.T1.6.6.1.m1.1.1.2.cmml">2</mn><mo id="S3.T1.6.6.1.m1.1.1.1" lspace="0.222em" mathsize="80%" rspace="0.222em" xref="S3.T1.6.6.1.m1.1.1.1.cmml">⋅</mo><msup id="S3.T1.6.6.1.m1.1.1.3" xref="S3.T1.6.6.1.m1.1.1.3.cmml"><mn id="S3.T1.6.6.1.m1.1.1.3.2" mathsize="80%" xref="S3.T1.6.6.1.m1.1.1.3.2.cmml">10</mn><mrow id="S3.T1.6.6.1.m1.1.1.3.3" xref="S3.T1.6.6.1.m1.1.1.3.3.cmml"><mo id="S3.T1.6.6.1.m1.1.1.3.3a" mathsize="80%" xref="S3.T1.6.6.1.m1.1.1.3.3.cmml">−</mo><mn id="S3.T1.6.6.1.m1.1.1.3.3.2" mathsize="80%" xref="S3.T1.6.6.1.m1.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.6.6.1.m1.1b"><apply id="S3.T1.6.6.1.m1.1.1.cmml" xref="S3.T1.6.6.1.m1.1.1"><ci id="S3.T1.6.6.1.m1.1.1.1.cmml" xref="S3.T1.6.6.1.m1.1.1.1">⋅</ci><cn id="S3.T1.6.6.1.m1.1.1.2.cmml" type="integer" xref="S3.T1.6.6.1.m1.1.1.2">2</cn><apply id="S3.T1.6.6.1.m1.1.1.3.cmml" xref="S3.T1.6.6.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.T1.6.6.1.m1.1.1.3.1.cmml" xref="S3.T1.6.6.1.m1.1.1.3">superscript</csymbol><cn id="S3.T1.6.6.1.m1.1.1.3.2.cmml" type="integer" xref="S3.T1.6.6.1.m1.1.1.3.2">10</cn><apply id="S3.T1.6.6.1.m1.1.1.3.3.cmml" xref="S3.T1.6.6.1.m1.1.1.3.3"><minus id="S3.T1.6.6.1.m1.1.1.3.3.1.cmml" xref="S3.T1.6.6.1.m1.1.1.3.3"></minus><cn id="S3.T1.6.6.1.m1.1.1.3.3.2.cmml" type="integer" xref="S3.T1.6.6.1.m1.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.6.6.1.m1.1c">2\cdot 10^{-4}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.6.6.1.m1.1d">2 ⋅ 10 start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.7.2"><math alttext="5\cdot 10^{-5}" class="ltx_Math" display="inline" id="S3.T1.7.7.2.m1.1"><semantics id="S3.T1.7.7.2.m1.1a"><mrow id="S3.T1.7.7.2.m1.1.1" xref="S3.T1.7.7.2.m1.1.1.cmml"><mn id="S3.T1.7.7.2.m1.1.1.2" mathsize="80%" xref="S3.T1.7.7.2.m1.1.1.2.cmml">5</mn><mo id="S3.T1.7.7.2.m1.1.1.1" lspace="0.222em" mathsize="80%" rspace="0.222em" xref="S3.T1.7.7.2.m1.1.1.1.cmml">⋅</mo><msup id="S3.T1.7.7.2.m1.1.1.3" xref="S3.T1.7.7.2.m1.1.1.3.cmml"><mn id="S3.T1.7.7.2.m1.1.1.3.2" mathsize="80%" xref="S3.T1.7.7.2.m1.1.1.3.2.cmml">10</mn><mrow id="S3.T1.7.7.2.m1.1.1.3.3" xref="S3.T1.7.7.2.m1.1.1.3.3.cmml"><mo id="S3.T1.7.7.2.m1.1.1.3.3a" mathsize="80%" xref="S3.T1.7.7.2.m1.1.1.3.3.cmml">−</mo><mn id="S3.T1.7.7.2.m1.1.1.3.3.2" mathsize="80%" xref="S3.T1.7.7.2.m1.1.1.3.3.2.cmml">5</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.7.7.2.m1.1b"><apply id="S3.T1.7.7.2.m1.1.1.cmml" xref="S3.T1.7.7.2.m1.1.1"><ci id="S3.T1.7.7.2.m1.1.1.1.cmml" xref="S3.T1.7.7.2.m1.1.1.1">⋅</ci><cn id="S3.T1.7.7.2.m1.1.1.2.cmml" type="integer" xref="S3.T1.7.7.2.m1.1.1.2">5</cn><apply id="S3.T1.7.7.2.m1.1.1.3.cmml" xref="S3.T1.7.7.2.m1.1.1.3"><csymbol cd="ambiguous" id="S3.T1.7.7.2.m1.1.1.3.1.cmml" xref="S3.T1.7.7.2.m1.1.1.3">superscript</csymbol><cn id="S3.T1.7.7.2.m1.1.1.3.2.cmml" type="integer" xref="S3.T1.7.7.2.m1.1.1.3.2">10</cn><apply id="S3.T1.7.7.2.m1.1.1.3.3.cmml" xref="S3.T1.7.7.2.m1.1.1.3.3"><minus id="S3.T1.7.7.2.m1.1.1.3.3.1.cmml" xref="S3.T1.7.7.2.m1.1.1.3.3"></minus><cn id="S3.T1.7.7.2.m1.1.1.3.3.2.cmml" type="integer" xref="S3.T1.7.7.2.m1.1.1.3.3.2">5</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.7.7.2.m1.1c">5\cdot 10^{-5}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.7.7.2.m1.1d">5 ⋅ 10 start_POSTSUPERSCRIPT - 5 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S3.T1.8.8.3"><math alttext="4\cdot 10^{-6}" class="ltx_Math" display="inline" id="S3.T1.8.8.3.m1.1"><semantics id="S3.T1.8.8.3.m1.1a"><mrow id="S3.T1.8.8.3.m1.1.1" xref="S3.T1.8.8.3.m1.1.1.cmml"><mn id="S3.T1.8.8.3.m1.1.1.2" mathsize="80%" xref="S3.T1.8.8.3.m1.1.1.2.cmml">4</mn><mo id="S3.T1.8.8.3.m1.1.1.1" lspace="0.222em" mathsize="80%" rspace="0.222em" xref="S3.T1.8.8.3.m1.1.1.1.cmml">⋅</mo><msup id="S3.T1.8.8.3.m1.1.1.3" xref="S3.T1.8.8.3.m1.1.1.3.cmml"><mn id="S3.T1.8.8.3.m1.1.1.3.2" mathsize="80%" xref="S3.T1.8.8.3.m1.1.1.3.2.cmml">10</mn><mrow id="S3.T1.8.8.3.m1.1.1.3.3" xref="S3.T1.8.8.3.m1.1.1.3.3.cmml"><mo id="S3.T1.8.8.3.m1.1.1.3.3a" mathsize="80%" xref="S3.T1.8.8.3.m1.1.1.3.3.cmml">−</mo><mn id="S3.T1.8.8.3.m1.1.1.3.3.2" mathsize="80%" xref="S3.T1.8.8.3.m1.1.1.3.3.2.cmml">6</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.8.8.3.m1.1b"><apply id="S3.T1.8.8.3.m1.1.1.cmml" xref="S3.T1.8.8.3.m1.1.1"><ci id="S3.T1.8.8.3.m1.1.1.1.cmml" xref="S3.T1.8.8.3.m1.1.1.1">⋅</ci><cn id="S3.T1.8.8.3.m1.1.1.2.cmml" type="integer" xref="S3.T1.8.8.3.m1.1.1.2">4</cn><apply id="S3.T1.8.8.3.m1.1.1.3.cmml" xref="S3.T1.8.8.3.m1.1.1.3"><csymbol cd="ambiguous" id="S3.T1.8.8.3.m1.1.1.3.1.cmml" xref="S3.T1.8.8.3.m1.1.1.3">superscript</csymbol><cn id="S3.T1.8.8.3.m1.1.1.3.2.cmml" type="integer" xref="S3.T1.8.8.3.m1.1.1.3.2">10</cn><apply id="S3.T1.8.8.3.m1.1.1.3.3.cmml" xref="S3.T1.8.8.3.m1.1.1.3.3"><minus id="S3.T1.8.8.3.m1.1.1.3.3.1.cmml" xref="S3.T1.8.8.3.m1.1.1.3.3"></minus><cn id="S3.T1.8.8.3.m1.1.1.3.3.2.cmml" type="integer" xref="S3.T1.8.8.3.m1.1.1.3.3.2">6</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.8.8.3.m1.1c">4\cdot 10^{-6}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.8.8.3.m1.1d">4 ⋅ 10 start_POSTSUPERSCRIPT - 6 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S3.T1.9.9.4"><math alttext="2\cdot 10^{-6}" class="ltx_Math" display="inline" id="S3.T1.9.9.4.m1.1"><semantics id="S3.T1.9.9.4.m1.1a"><mrow id="S3.T1.9.9.4.m1.1.1" xref="S3.T1.9.9.4.m1.1.1.cmml"><mn id="S3.T1.9.9.4.m1.1.1.2" mathsize="80%" xref="S3.T1.9.9.4.m1.1.1.2.cmml">2</mn><mo id="S3.T1.9.9.4.m1.1.1.1" lspace="0.222em" mathsize="80%" rspace="0.222em" xref="S3.T1.9.9.4.m1.1.1.1.cmml">⋅</mo><msup id="S3.T1.9.9.4.m1.1.1.3" xref="S3.T1.9.9.4.m1.1.1.3.cmml"><mn id="S3.T1.9.9.4.m1.1.1.3.2" mathsize="80%" xref="S3.T1.9.9.4.m1.1.1.3.2.cmml">10</mn><mrow id="S3.T1.9.9.4.m1.1.1.3.3" xref="S3.T1.9.9.4.m1.1.1.3.3.cmml"><mo id="S3.T1.9.9.4.m1.1.1.3.3a" mathsize="80%" xref="S3.T1.9.9.4.m1.1.1.3.3.cmml">−</mo><mn id="S3.T1.9.9.4.m1.1.1.3.3.2" mathsize="80%" xref="S3.T1.9.9.4.m1.1.1.3.3.2.cmml">6</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.9.9.4.m1.1b"><apply id="S3.T1.9.9.4.m1.1.1.cmml" xref="S3.T1.9.9.4.m1.1.1"><ci id="S3.T1.9.9.4.m1.1.1.1.cmml" xref="S3.T1.9.9.4.m1.1.1.1">⋅</ci><cn id="S3.T1.9.9.4.m1.1.1.2.cmml" type="integer" xref="S3.T1.9.9.4.m1.1.1.2">2</cn><apply id="S3.T1.9.9.4.m1.1.1.3.cmml" xref="S3.T1.9.9.4.m1.1.1.3"><csymbol cd="ambiguous" id="S3.T1.9.9.4.m1.1.1.3.1.cmml" xref="S3.T1.9.9.4.m1.1.1.3">superscript</csymbol><cn id="S3.T1.9.9.4.m1.1.1.3.2.cmml" type="integer" xref="S3.T1.9.9.4.m1.1.1.3.2">10</cn><apply id="S3.T1.9.9.4.m1.1.1.3.3.cmml" xref="S3.T1.9.9.4.m1.1.1.3.3"><minus id="S3.T1.9.9.4.m1.1.1.3.3.1.cmml" xref="S3.T1.9.9.4.m1.1.1.3.3"></minus><cn id="S3.T1.9.9.4.m1.1.1.3.3.2.cmml" type="integer" xref="S3.T1.9.9.4.m1.1.1.3.3.2">6</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.9.9.4.m1.1c">2\cdot 10^{-6}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.9.9.4.m1.1d">2 ⋅ 10 start_POSTSUPERSCRIPT - 6 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S3.T1.10.24.14">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="6" id="S3.T1.10.24.14.1"><span class="ltx_text ltx_font_italic" id="S3.T1.10.24.14.1.1" style="font-size:80%;">Input / Output space</span></th>
</tr>
<tr class="ltx_tr" id="S3.T1.10.25.15">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T1.10.25.15.1"><span class="ltx_text" id="S3.T1.10.25.15.1.1" style="font-size:80%;">Text cardinality</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T1.10.25.15.2"><span class="ltx_text" id="S3.T1.10.25.15.2.1" style="font-size:80%;">32000</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="4" id="S3.T1.10.25.15.3"><span class="ltx_text" id="S3.T1.10.25.15.3.1" style="font-size:80%;">32000</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.10.26.16">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S3.T1.10.26.16.1"><span class="ltx_text" id="S3.T1.10.26.16.1.1" style="font-size:80%;">Audio cardinality</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T1.10.26.16.2"><span class="ltx_text" id="S3.T1.10.26.16.2.1" style="font-size:80%;">-</span></th>
<td class="ltx_td ltx_align_center" colspan="4" id="S3.T1.10.26.16.3"><span class="ltx_text" id="S3.T1.10.26.16.3.1" style="font-size:80%;">2048</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.10.27.17">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S3.T1.10.27.17.1"><span class="ltx_text" id="S3.T1.10.27.17.1.1" style="font-size:80%;">Frame rate</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T1.10.27.17.2"><span class="ltx_text" id="S3.T1.10.27.17.2.1" style="font-size:80%;">-</span></th>
<td class="ltx_td ltx_align_center" colspan="4" id="S3.T1.10.27.17.3"><span class="ltx_text" id="S3.T1.10.27.17.3.1" style="font-size:80%;">12.5 Hz</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.10.28.18">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="6" id="S3.T1.10.28.18.1"><span class="ltx_text ltx_font_italic" id="S3.T1.10.28.18.1.1" style="font-size:80%;">Common parameters</span></th>
</tr>
<tr class="ltx_tr" id="S3.T1.10.29.19">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T1.10.29.19.1"><span class="ltx_text" id="S3.T1.10.29.19.1.1" style="font-size:80%;">Batch size (text)</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T1.10.29.19.2"><span class="ltx_text" id="S3.T1.10.29.19.2.1" style="font-size:80%;">4.2M tok.</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.10.29.19.3"><span class="ltx_text" id="S3.T1.10.29.19.3.1" style="font-size:80%;">1.2M tok.</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.10.29.19.4"><span class="ltx_text" id="S3.T1.10.29.19.4.1" style="font-size:80%;">1.2M tok.</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.10.29.19.5"><span class="ltx_text" id="S3.T1.10.29.19.5.1" style="font-size:80%;">-</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.10.29.19.6"><span class="ltx_text" id="S3.T1.10.29.19.6.1" style="font-size:80%;">-</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.10.30.20">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S3.T1.10.30.20.1"><span class="ltx_text" id="S3.T1.10.30.20.1.1" style="font-size:80%;">Batch size (audio)</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T1.10.30.20.2"><span class="ltx_text" id="S3.T1.10.30.20.2.1" style="font-size:80%;">-</span></th>
<td class="ltx_td ltx_align_center" id="S3.T1.10.30.20.3"><span class="ltx_text" id="S3.T1.10.30.20.3.1" style="font-size:80%;">16h</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.10.30.20.4"><span class="ltx_text" id="S3.T1.10.30.20.4.1" style="font-size:80%;">8h</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.10.30.20.5"><span class="ltx_text" id="S3.T1.10.30.20.5.1" style="font-size:80%;">40min</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.10.30.20.6"><span class="ltx_text" id="S3.T1.10.30.20.6.1" style="font-size:80%;">2.7h</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.10.31.21">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S3.T1.10.31.21.1"><span class="ltx_text" id="S3.T1.10.31.21.1.1" style="font-size:80%;">Training steps</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T1.10.31.21.2"><span class="ltx_text" id="S3.T1.10.31.21.2.1" style="font-size:80%;">500k</span></th>
<td class="ltx_td ltx_align_center" id="S3.T1.10.31.21.3"><span class="ltx_text" id="S3.T1.10.31.21.3.1" style="font-size:80%;">1M</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.10.31.21.4"><span class="ltx_text" id="S3.T1.10.31.21.4.1" style="font-size:80%;">100k</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.10.31.21.5"><span class="ltx_text" id="S3.T1.10.31.21.5.1" style="font-size:80%;">10k</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.10.31.21.6"><span class="ltx_text" id="S3.T1.10.31.21.6.1" style="font-size:80%;">30k</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.10.32.22">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S3.T1.10.32.22.1"><span class="ltx_text" id="S3.T1.10.32.22.1.1" style="font-size:80%;">LR Schedule</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T1.10.32.22.2"><span class="ltx_text" id="S3.T1.10.32.22.2.1" style="font-size:80%;">cosine</span></th>
<td class="ltx_td ltx_align_center" id="S3.T1.10.32.22.3"><span class="ltx_text" id="S3.T1.10.32.22.3.1" style="font-size:80%;">cosine</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.10.32.22.4"><span class="ltx_text" id="S3.T1.10.32.22.4.1" style="font-size:80%;">-</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.10.32.22.5"><span class="ltx_text" id="S3.T1.10.32.22.5.1" style="font-size:80%;">-</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.10.32.22.6"><span class="ltx_text" id="S3.T1.10.32.22.6.1" style="font-size:80%;">-</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.10.33.23">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S3.T1.10.33.23.1"><span class="ltx_text" id="S3.T1.10.33.23.1.1" style="font-size:80%;">Acoustic delay</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T1.10.33.23.2"><span class="ltx_text" id="S3.T1.10.33.23.2.1" style="font-size:80%;">-</span></th>
<td class="ltx_td ltx_align_center" id="S3.T1.10.33.23.3"><span class="ltx_text" id="S3.T1.10.33.23.3.1" style="font-size:80%;">2</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.10.33.23.4"><span class="ltx_text" id="S3.T1.10.33.23.4.1" style="font-size:80%;">1</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.10.33.23.5"><span class="ltx_text" id="S3.T1.10.33.23.5.1" style="font-size:80%;">1</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.10.33.23.6"><span class="ltx_text" id="S3.T1.10.33.23.6.1" style="font-size:80%;">1</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.10.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S3.T1.10.10.2"><span class="ltx_text" id="S3.T1.10.10.2.1" style="font-size:80%;">Text delay</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S3.T1.10.10.3"><span class="ltx_text" id="S3.T1.10.10.3.1" style="font-size:80%;">-</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.10.10.1">
<math alttext="\pm" class="ltx_Math" display="inline" id="S3.T1.10.10.1.m1.1"><semantics id="S3.T1.10.10.1.m1.1a"><mo id="S3.T1.10.10.1.m1.1.1" mathsize="80%" xref="S3.T1.10.10.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.10.10.1.m1.1b"><csymbol cd="latexml" id="S3.T1.10.10.1.m1.1.1.cmml" xref="S3.T1.10.10.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.10.10.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T1.10.10.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T1.10.10.1.1" style="font-size:80%;">0.6</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.10.10.4"><span class="ltx_text" id="S3.T1.10.10.4.1" style="font-size:80%;">0</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.10.10.5"><span class="ltx_text" id="S3.T1.10.10.5.1" style="font-size:80%;">0</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.10.10.6"><span class="ltx_text" id="S3.T1.10.10.6.1" style="font-size:80%;">0</span></td>
</tr>
</tbody>
</table>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_subsubsection" id="S3.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.2 </span>Pre-training data filtering</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.SS2.SSS2.p1">
<p class="ltx_p" id="S3.SS2.SSS2.p1.1">Training data is one of the critical ingredients to train LLMs: we now describe our method to obtain a large and high-quality text dataset.
We start from high-quality data sources, such as Wikipedia, Stack Exchange and a large collection of scientific articles.
As the quantity of data from these sources is too small to train a LLM, we also rely on web crawled data, specifically from CommonCrawl, to extend our dataset. See more details on data sources in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S4.SS1" title="4.1 Text Data ‣ 4 Datasets and Training ‣ Moshi: a speech-text foundation model for real-time dialogue">Section <span class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.1</span></span></a>.
Web data requires extensive processing to obtain a high-quality training set: we perform deduplication, language identification and quality filtering.
In the following, we describe each operation in more details.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_paragraph" id="S3.SS2.SSS2.Px1">
<h5 class="ltx_title ltx_title_paragraph">Deduplication.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.SS2.SSS2.Px1.p1">
<p class="ltx_p" id="S3.SS2.SSS2.Px1.p1.1">We start from the WET files, which contain only the text content of web-pages, which was extracted by the CommonCrawl project.
Because this format contains all the text of a page, it includes a lot of boilerplate such as navigation menus.
Thus, the first step of our pipeline is to deduplicate each shard (there is 100 shards per crawl) at the <em class="ltx_emph ltx_font_italic" id="S3.SS2.SSS2.Px1.p1.1.1">line level</em>, to remove this boilerplate.
To do so, we compute the <span class="ltx_text ltx_font_typewriter" id="S3.SS2.SSS2.Px1.p1.1.2">FNV-1a<span class="ltx_note ltx_role_footnote" id="footnote6"><sup class="ltx_note_mark">6</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">6</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_serif" id="footnote6.1.1.1">6</span></span><a class="ltx_ref ltx_url" href="http://www.isthe.com/chongo/tech/comp/fnv" title="">http://www.isthe.com/chongo/tech/comp/fnv</a></span></span></span></span> hash of each line, and use a bloom filter to remove duplicates.
We also train a <span class="ltx_text ltx_font_typewriter" id="S3.SS2.SSS2.Px1.p1.1.3">fastText</span>&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Joulin et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib44" title="">2016</a>)</cite> classifier on duplicates <em class="ltx_emph ltx_font_italic" id="S3.SS2.SSS2.Px1.p1.1.4">vs.</em> non-duplicates, to perform fuzzy deduplication:
here we only remove blocks of at least 3 consecutive lines that are classified as duplicates.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS2.SSS2.Px2">
<h5 class="ltx_title ltx_title_paragraph">Language identification.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.SS2.SSS2.Px2.p1">
<p class="ltx_p" id="S3.SS2.SSS2.Px2.p1.1">Once deduplication is performed, we apply a language identifier based on <span class="ltx_text ltx_font_typewriter" id="S3.SS2.SSS2.Px2.p1.1.1">fastText</span> to keep English data only.
Language identification is performed at the document level, and we only keep documents above a certain threshold (0.85).</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS2.SSS2.Px3">
<h5 class="ltx_title ltx_title_paragraph">Quality filtering.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.SS2.SSS2.Px3.p1">
<p class="ltx_p" id="S3.SS2.SSS2.Px3.p1.1">The last step is to filter the remaining data, to keep high-quality webpages only.
To perform this step, we train a <span class="ltx_text ltx_font_typewriter" id="S3.SS2.SSS2.Px3.p1.1.1">fastText</span> classifier on lines from our high quality data sources and from random CommonCrawl webpages.
We obtain a classifier with 9 categories, corresponding to our different high quality sources such as Wikipedia or Wikibooks and to subsets of StackExchange such as STEM or humanities.
The motivation is to obtain a finer control over which documents to keep, not only based on similarity to high quality sources, but also based on their domains.
This classifier is applied at the <em class="ltx_emph ltx_font_italic" id="S3.SS2.SSS2.Px3.p1.1.2">line level</em>, and an aggregated score is obtained by computing the average scores of each line, weighted by their length.
Again, we keep documents corresponding to scores above a certain threshold.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Audio Tokenization</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">To discretize waveforms into audio tokens, we introduce Mimi, a neural audio codec&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Zeghidour et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib108" title="">2022</a>; Défossez et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib21" title="">2023</a>)</cite> that operates as an autoencoder with a discrete bottleneck&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(van&nbsp;den Oord et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib99" title="">2017</a>)</cite>. In the literature, and following the terminology defined by&nbsp;<cite class="ltx_cite ltx_citemacro_citet">Borsos et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib6" title="">2022</a>)</cite>, these tokens are referred to as <span class="ltx_text ltx_font_italic" id="S3.SS3.p1.1.1">acoustic</span> tokens, as they model fine audio details and are optimized for high-quality reconstruction. While these acoustic tokens provide appropriate targets for conditioned text-to-audio models (e.g. text-to-speech&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Wang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib103" title="">2023</a>)</cite> or text-to-music&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Copet et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib18" title="">2023</a>)</cite>), unconditioned speech generation requires combining them with <span class="ltx_text ltx_font_italic" id="S3.SS3.p1.1.2">semantic</span> tokens extracted from self-supervised speech models&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Baevski et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib3" title="">2020</a>; Hsu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib42" title="">2021</a>; Chung et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib14" title="">2021</a>)</cite>. Unlike their acoustic counterpart, semantic tokens do not allow for reconstructing high-quality audio but correlate strongly with linguistic content. This similarity with language allows generating intelligible and consistent speech, even without text conditioning, by using semantic audio tokens as a prefix to predicting acoustic tokens. Yet, this hybrid tokenization approach is not compatible with real-time generation. Semantic tokens are typically not causal and can thus only be computed in an offline manner. Moreover, generating acoustic and semantic tokens with separate encoders represents a non-negligible computational burden. Consequently, and taking inspiration from previous work on SpeechTokenizer&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Zhang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib113" title="">2024b</a>)</cite>, Mimi uses distillation to transfer non-causal, high-level semantic information into the tokens produced by a causal model, allowing for streaming encoding and decoding of semantic-acoustic tokens.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="S3.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="200" id="S3.F2.g1" src="https://arxiv.org/html/2410.00037v2/extracted/5895270/figures/mimi_arch_training.png" width="598">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span><span class="ltx_text ltx_font_bold" id="S3.F2.2.1">Architecture and training of Mimi, our neural audio codec, with its split residual vector quantization</span>. During training (blue part, top), we distill non-causal embeddings from WavLM&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Chen et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib12" title="">2022</a>)</cite> into a single vector quantizer which produces semantic tokens, and is combined with separate acoustic tokens for reconstruction.
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsubsection" id="S3.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.1 </span>Architecture</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.SS3.SSS1.p1">
<p class="ltx_p" id="S3.SS3.SSS1.p1.8">Our baseline architecture takes inspiration from SoundStream&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Zeghidour et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib108" title="">2022</a>)</cite> and Encodec&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Défossez et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib21" title="">2023</a>)</cite> and consists of a SeaNet&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Tagliasacchi et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib91" title="">2020</a>)</cite> autoencoder and a Residual Vector Quantizer&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Zeghidour et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib108" title="">2022</a>)</cite>. The encoder projects a single-channel waveform <math alttext="x\in\mathbb{R}^{L}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.1.m1.1"><semantics id="S3.SS3.SSS1.p1.1.m1.1a"><mrow id="S3.SS3.SSS1.p1.1.m1.1.1" xref="S3.SS3.SSS1.p1.1.m1.1.1.cmml"><mi id="S3.SS3.SSS1.p1.1.m1.1.1.2" xref="S3.SS3.SSS1.p1.1.m1.1.1.2.cmml">x</mi><mo id="S3.SS3.SSS1.p1.1.m1.1.1.1" xref="S3.SS3.SSS1.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS3.SSS1.p1.1.m1.1.1.3" xref="S3.SS3.SSS1.p1.1.m1.1.1.3.cmml"><mi id="S3.SS3.SSS1.p1.1.m1.1.1.3.2" xref="S3.SS3.SSS1.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS3.SSS1.p1.1.m1.1.1.3.3" xref="S3.SS3.SSS1.p1.1.m1.1.1.3.3.cmml">L</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.1.m1.1b"><apply id="S3.SS3.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1"><in id="S3.SS3.SSS1.p1.1.m1.1.1.1.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.1"></in><ci id="S3.SS3.SSS1.p1.1.m1.1.1.2.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.2">𝑥</ci><apply id="S3.SS3.SSS1.p1.1.m1.1.1.3.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.1.m1.1.1.3.1.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS1.p1.1.m1.1.1.3.2.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.3.2">ℝ</ci><ci id="S3.SS3.SSS1.p1.1.m1.1.1.3.3.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.1.m1.1c">x\in\mathbb{R}^{L}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.1.m1.1d">italic_x ∈ blackboard_R start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT</annotation></semantics></math> to a latent representation <math alttext="\mathrm{enc}(x)\in\mathbb{R}^{S\times D}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.2.m2.1"><semantics id="S3.SS3.SSS1.p1.2.m2.1a"><mrow id="S3.SS3.SSS1.p1.2.m2.1.2" xref="S3.SS3.SSS1.p1.2.m2.1.2.cmml"><mrow id="S3.SS3.SSS1.p1.2.m2.1.2.2" xref="S3.SS3.SSS1.p1.2.m2.1.2.2.cmml"><mi id="S3.SS3.SSS1.p1.2.m2.1.2.2.2" xref="S3.SS3.SSS1.p1.2.m2.1.2.2.2.cmml">enc</mi><mo id="S3.SS3.SSS1.p1.2.m2.1.2.2.1" xref="S3.SS3.SSS1.p1.2.m2.1.2.2.1.cmml">⁢</mo><mrow id="S3.SS3.SSS1.p1.2.m2.1.2.2.3.2" xref="S3.SS3.SSS1.p1.2.m2.1.2.2.cmml"><mo id="S3.SS3.SSS1.p1.2.m2.1.2.2.3.2.1" stretchy="false" xref="S3.SS3.SSS1.p1.2.m2.1.2.2.cmml">(</mo><mi id="S3.SS3.SSS1.p1.2.m2.1.1" xref="S3.SS3.SSS1.p1.2.m2.1.1.cmml">x</mi><mo id="S3.SS3.SSS1.p1.2.m2.1.2.2.3.2.2" stretchy="false" xref="S3.SS3.SSS1.p1.2.m2.1.2.2.cmml">)</mo></mrow></mrow><mo id="S3.SS3.SSS1.p1.2.m2.1.2.1" xref="S3.SS3.SSS1.p1.2.m2.1.2.1.cmml">∈</mo><msup id="S3.SS3.SSS1.p1.2.m2.1.2.3" xref="S3.SS3.SSS1.p1.2.m2.1.2.3.cmml"><mi id="S3.SS3.SSS1.p1.2.m2.1.2.3.2" xref="S3.SS3.SSS1.p1.2.m2.1.2.3.2.cmml">ℝ</mi><mrow id="S3.SS3.SSS1.p1.2.m2.1.2.3.3" xref="S3.SS3.SSS1.p1.2.m2.1.2.3.3.cmml"><mi id="S3.SS3.SSS1.p1.2.m2.1.2.3.3.2" xref="S3.SS3.SSS1.p1.2.m2.1.2.3.3.2.cmml">S</mi><mo id="S3.SS3.SSS1.p1.2.m2.1.2.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.SSS1.p1.2.m2.1.2.3.3.1.cmml">×</mo><mi id="S3.SS3.SSS1.p1.2.m2.1.2.3.3.3" xref="S3.SS3.SSS1.p1.2.m2.1.2.3.3.3.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.2.m2.1b"><apply id="S3.SS3.SSS1.p1.2.m2.1.2.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.2"><in id="S3.SS3.SSS1.p1.2.m2.1.2.1.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.2.1"></in><apply id="S3.SS3.SSS1.p1.2.m2.1.2.2.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.2.2"><times id="S3.SS3.SSS1.p1.2.m2.1.2.2.1.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.2.2.1"></times><ci id="S3.SS3.SSS1.p1.2.m2.1.2.2.2.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.2.2.2">enc</ci><ci id="S3.SS3.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.1">𝑥</ci></apply><apply id="S3.SS3.SSS1.p1.2.m2.1.2.3.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.2.m2.1.2.3.1.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.2.3">superscript</csymbol><ci id="S3.SS3.SSS1.p1.2.m2.1.2.3.2.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.2.3.2">ℝ</ci><apply id="S3.SS3.SSS1.p1.2.m2.1.2.3.3.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.2.3.3"><times id="S3.SS3.SSS1.p1.2.m2.1.2.3.3.1.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.2.3.3.1"></times><ci id="S3.SS3.SSS1.p1.2.m2.1.2.3.3.2.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.2.3.3.2">𝑆</ci><ci id="S3.SS3.SSS1.p1.2.m2.1.2.3.3.3.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.2.3.3.3">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.2.m2.1c">\mathrm{enc}(x)\in\mathbb{R}^{S\times D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.2.m2.1d">roman_enc ( italic_x ) ∈ blackboard_R start_POSTSUPERSCRIPT italic_S × italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> by cascading residual convolutional blocks that interleave dilated&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(van&nbsp;den Oord et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib100" title="">2016</a>)</cite> and strided convolutions along with ELU&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Clevert et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib17" title="">2016</a>)</cite> non-linearities and Weight Normalization&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Salimans and Kingma, <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib82" title="">2016</a>)</cite>. All convolutions are causal, such that this autoencoder can run in a streaming fashion. With 4 convolutional blocks and respective striding factors <math alttext="(4,5,6,8)" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.3.m3.4"><semantics id="S3.SS3.SSS1.p1.3.m3.4a"><mrow id="S3.SS3.SSS1.p1.3.m3.4.5.2" xref="S3.SS3.SSS1.p1.3.m3.4.5.1.cmml"><mo id="S3.SS3.SSS1.p1.3.m3.4.5.2.1" stretchy="false" xref="S3.SS3.SSS1.p1.3.m3.4.5.1.cmml">(</mo><mn id="S3.SS3.SSS1.p1.3.m3.1.1" xref="S3.SS3.SSS1.p1.3.m3.1.1.cmml">4</mn><mo id="S3.SS3.SSS1.p1.3.m3.4.5.2.2" xref="S3.SS3.SSS1.p1.3.m3.4.5.1.cmml">,</mo><mn id="S3.SS3.SSS1.p1.3.m3.2.2" xref="S3.SS3.SSS1.p1.3.m3.2.2.cmml">5</mn><mo id="S3.SS3.SSS1.p1.3.m3.4.5.2.3" xref="S3.SS3.SSS1.p1.3.m3.4.5.1.cmml">,</mo><mn id="S3.SS3.SSS1.p1.3.m3.3.3" xref="S3.SS3.SSS1.p1.3.m3.3.3.cmml">6</mn><mo id="S3.SS3.SSS1.p1.3.m3.4.5.2.4" xref="S3.SS3.SSS1.p1.3.m3.4.5.1.cmml">,</mo><mn id="S3.SS3.SSS1.p1.3.m3.4.4" xref="S3.SS3.SSS1.p1.3.m3.4.4.cmml">8</mn><mo id="S3.SS3.SSS1.p1.3.m3.4.5.2.5" stretchy="false" xref="S3.SS3.SSS1.p1.3.m3.4.5.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.3.m3.4b"><vector id="S3.SS3.SSS1.p1.3.m3.4.5.1.cmml" xref="S3.SS3.SSS1.p1.3.m3.4.5.2"><cn id="S3.SS3.SSS1.p1.3.m3.1.1.cmml" type="integer" xref="S3.SS3.SSS1.p1.3.m3.1.1">4</cn><cn id="S3.SS3.SSS1.p1.3.m3.2.2.cmml" type="integer" xref="S3.SS3.SSS1.p1.3.m3.2.2">5</cn><cn id="S3.SS3.SSS1.p1.3.m3.3.3.cmml" type="integer" xref="S3.SS3.SSS1.p1.3.m3.3.3">6</cn><cn id="S3.SS3.SSS1.p1.3.m3.4.4.cmml" type="integer" xref="S3.SS3.SSS1.p1.3.m3.4.4">8</cn></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.3.m3.4c">(4,5,6,8)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.3.m3.4d">( 4 , 5 , 6 , 8 )</annotation></semantics></math>, and a final 1D convolution with stride 2, Mimi’s encoder projects a 24kHz waveform to a latent representation of <math alttext="12.5" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.4.m4.1"><semantics id="S3.SS3.SSS1.p1.4.m4.1a"><mn id="S3.SS3.SSS1.p1.4.m4.1.1" xref="S3.SS3.SSS1.p1.4.m4.1.1.cmml">12.5</mn><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.4.m4.1b"><cn id="S3.SS3.SSS1.p1.4.m4.1.1.cmml" type="float" xref="S3.SS3.SSS1.p1.4.m4.1.1">12.5</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.4.m4.1c">12.5</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.4.m4.1d">12.5</annotation></semantics></math> frames per second and dimension <math alttext="D=512" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.5.m5.1"><semantics id="S3.SS3.SSS1.p1.5.m5.1a"><mrow id="S3.SS3.SSS1.p1.5.m5.1.1" xref="S3.SS3.SSS1.p1.5.m5.1.1.cmml"><mi id="S3.SS3.SSS1.p1.5.m5.1.1.2" xref="S3.SS3.SSS1.p1.5.m5.1.1.2.cmml">D</mi><mo id="S3.SS3.SSS1.p1.5.m5.1.1.1" xref="S3.SS3.SSS1.p1.5.m5.1.1.1.cmml">=</mo><mn id="S3.SS3.SSS1.p1.5.m5.1.1.3" xref="S3.SS3.SSS1.p1.5.m5.1.1.3.cmml">512</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.5.m5.1b"><apply id="S3.SS3.SSS1.p1.5.m5.1.1.cmml" xref="S3.SS3.SSS1.p1.5.m5.1.1"><eq id="S3.SS3.SSS1.p1.5.m5.1.1.1.cmml" xref="S3.SS3.SSS1.p1.5.m5.1.1.1"></eq><ci id="S3.SS3.SSS1.p1.5.m5.1.1.2.cmml" xref="S3.SS3.SSS1.p1.5.m5.1.1.2">𝐷</ci><cn id="S3.SS3.SSS1.p1.5.m5.1.1.3.cmml" type="integer" xref="S3.SS3.SSS1.p1.5.m5.1.1.3">512</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.5.m5.1c">D=512</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.5.m5.1d">italic_D = 512</annotation></semantics></math>. Symmetrically, the decoder adopts a similar structure but with transposed convolutions rather than strided ones, to project the latent representation back to 24kHz audio. We discretize the latent space with a Residual Vector Quantizer&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Zeghidour et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib108" title="">2022</a>)</cite>, which iteratively applies vector quantization (VQ) to the residuals of the previous quantizer. With <math alttext="Q" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.6.m6.1"><semantics id="S3.SS3.SSS1.p1.6.m6.1a"><mi id="S3.SS3.SSS1.p1.6.m6.1.1" xref="S3.SS3.SSS1.p1.6.m6.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.6.m6.1b"><ci id="S3.SS3.SSS1.p1.6.m6.1.1.cmml" xref="S3.SS3.SSS1.p1.6.m6.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.6.m6.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.6.m6.1d">italic_Q</annotation></semantics></math> quantizers, each with a codebook of <math alttext="N_{A}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.7.m7.1"><semantics id="S3.SS3.SSS1.p1.7.m7.1a"><msub id="S3.SS3.SSS1.p1.7.m7.1.1" xref="S3.SS3.SSS1.p1.7.m7.1.1.cmml"><mi id="S3.SS3.SSS1.p1.7.m7.1.1.2" xref="S3.SS3.SSS1.p1.7.m7.1.1.2.cmml">N</mi><mi id="S3.SS3.SSS1.p1.7.m7.1.1.3" xref="S3.SS3.SSS1.p1.7.m7.1.1.3.cmml">A</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.7.m7.1b"><apply id="S3.SS3.SSS1.p1.7.m7.1.1.cmml" xref="S3.SS3.SSS1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.7.m7.1.1.1.cmml" xref="S3.SS3.SSS1.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p1.7.m7.1.1.2.cmml" xref="S3.SS3.SSS1.p1.7.m7.1.1.2">𝑁</ci><ci id="S3.SS3.SSS1.p1.7.m7.1.1.3.cmml" xref="S3.SS3.SSS1.p1.7.m7.1.1.3">𝐴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.7.m7.1c">N_{A}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.7.m7.1d">italic_N start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT</annotation></semantics></math> centroids, the RVQ discretizes the latent space into <math alttext="\{1,\dots,N_{A}\}^{S\times Q}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.8.m8.3"><semantics id="S3.SS3.SSS1.p1.8.m8.3a"><msup id="S3.SS3.SSS1.p1.8.m8.3.3" xref="S3.SS3.SSS1.p1.8.m8.3.3.cmml"><mrow id="S3.SS3.SSS1.p1.8.m8.3.3.1.1" xref="S3.SS3.SSS1.p1.8.m8.3.3.1.2.cmml"><mo id="S3.SS3.SSS1.p1.8.m8.3.3.1.1.2" stretchy="false" xref="S3.SS3.SSS1.p1.8.m8.3.3.1.2.cmml">{</mo><mn id="S3.SS3.SSS1.p1.8.m8.1.1" xref="S3.SS3.SSS1.p1.8.m8.1.1.cmml">1</mn><mo id="S3.SS3.SSS1.p1.8.m8.3.3.1.1.3" xref="S3.SS3.SSS1.p1.8.m8.3.3.1.2.cmml">,</mo><mi id="S3.SS3.SSS1.p1.8.m8.2.2" mathvariant="normal" xref="S3.SS3.SSS1.p1.8.m8.2.2.cmml">…</mi><mo id="S3.SS3.SSS1.p1.8.m8.3.3.1.1.4" xref="S3.SS3.SSS1.p1.8.m8.3.3.1.2.cmml">,</mo><msub id="S3.SS3.SSS1.p1.8.m8.3.3.1.1.1" xref="S3.SS3.SSS1.p1.8.m8.3.3.1.1.1.cmml"><mi id="S3.SS3.SSS1.p1.8.m8.3.3.1.1.1.2" xref="S3.SS3.SSS1.p1.8.m8.3.3.1.1.1.2.cmml">N</mi><mi id="S3.SS3.SSS1.p1.8.m8.3.3.1.1.1.3" xref="S3.SS3.SSS1.p1.8.m8.3.3.1.1.1.3.cmml">A</mi></msub><mo id="S3.SS3.SSS1.p1.8.m8.3.3.1.1.5" stretchy="false" xref="S3.SS3.SSS1.p1.8.m8.3.3.1.2.cmml">}</mo></mrow><mrow id="S3.SS3.SSS1.p1.8.m8.3.3.3" xref="S3.SS3.SSS1.p1.8.m8.3.3.3.cmml"><mi id="S3.SS3.SSS1.p1.8.m8.3.3.3.2" xref="S3.SS3.SSS1.p1.8.m8.3.3.3.2.cmml">S</mi><mo id="S3.SS3.SSS1.p1.8.m8.3.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.SSS1.p1.8.m8.3.3.3.1.cmml">×</mo><mi id="S3.SS3.SSS1.p1.8.m8.3.3.3.3" xref="S3.SS3.SSS1.p1.8.m8.3.3.3.3.cmml">Q</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.8.m8.3b"><apply id="S3.SS3.SSS1.p1.8.m8.3.3.cmml" xref="S3.SS3.SSS1.p1.8.m8.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.8.m8.3.3.2.cmml" xref="S3.SS3.SSS1.p1.8.m8.3.3">superscript</csymbol><set id="S3.SS3.SSS1.p1.8.m8.3.3.1.2.cmml" xref="S3.SS3.SSS1.p1.8.m8.3.3.1.1"><cn id="S3.SS3.SSS1.p1.8.m8.1.1.cmml" type="integer" xref="S3.SS3.SSS1.p1.8.m8.1.1">1</cn><ci id="S3.SS3.SSS1.p1.8.m8.2.2.cmml" xref="S3.SS3.SSS1.p1.8.m8.2.2">…</ci><apply id="S3.SS3.SSS1.p1.8.m8.3.3.1.1.1.cmml" xref="S3.SS3.SSS1.p1.8.m8.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.8.m8.3.3.1.1.1.1.cmml" xref="S3.SS3.SSS1.p1.8.m8.3.3.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p1.8.m8.3.3.1.1.1.2.cmml" xref="S3.SS3.SSS1.p1.8.m8.3.3.1.1.1.2">𝑁</ci><ci id="S3.SS3.SSS1.p1.8.m8.3.3.1.1.1.3.cmml" xref="S3.SS3.SSS1.p1.8.m8.3.3.1.1.1.3">𝐴</ci></apply></set><apply id="S3.SS3.SSS1.p1.8.m8.3.3.3.cmml" xref="S3.SS3.SSS1.p1.8.m8.3.3.3"><times id="S3.SS3.SSS1.p1.8.m8.3.3.3.1.cmml" xref="S3.SS3.SSS1.p1.8.m8.3.3.3.1"></times><ci id="S3.SS3.SSS1.p1.8.m8.3.3.3.2.cmml" xref="S3.SS3.SSS1.p1.8.m8.3.3.3.2">𝑆</ci><ci id="S3.SS3.SSS1.p1.8.m8.3.3.3.3.cmml" xref="S3.SS3.SSS1.p1.8.m8.3.3.3.3">𝑄</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.8.m8.3c">\{1,\dots,N_{A}\}^{S\times Q}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.8.m8.3d">{ 1 , … , italic_N start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT } start_POSTSUPERSCRIPT italic_S × italic_Q end_POSTSUPERSCRIPT</annotation></semantics></math>. As a baseline, we train this model with a combination of reconstruction and adversarial losses, following the setup of Encodec&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Défossez et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib21" title="">2023</a>)</cite>. We detail below the main changes of Mimi with respect to this default configuration.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_paragraph" id="S3.SS3.SSS1.Px1">
<h5 class="ltx_title ltx_title_paragraph">Transformer-based bottleneck.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.SS3.SSS1.Px1.p1">
<p class="ltx_p" id="S3.SS3.SSS1.Px1.p1.1">To improve the ability of Mimi to encode speech into compact representations while reconstructing high-quality audio, we add Transformer modules in the bottleneck, one right before quantization and one after. These Transformers have 8 layers, 8 heads, RoPE position encodings, a finite context of 250 frames (20 seconds), GELU&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Hendrycks and Gimpel, <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib35" title="">2016a</a>)</cite> activations, a model dimension of 512 and an MLP dimension of 2048. To stabilize training, we use LayerScale&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Touvron et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib95" title="">2021</a>)</cite>, with initialization of the diagonal values at <math alttext="0.01" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px1.p1.1.m1.1"><semantics id="S3.SS3.SSS1.Px1.p1.1.m1.1a"><mn id="S3.SS3.SSS1.Px1.p1.1.m1.1.1" xref="S3.SS3.SSS1.Px1.p1.1.m1.1.1.cmml">0.01</mn><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px1.p1.1.m1.1b"><cn id="S3.SS3.SSS1.Px1.p1.1.m1.1.1.cmml" type="float" xref="S3.SS3.SSS1.Px1.p1.1.m1.1.1">0.01</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px1.p1.1.m1.1c">0.01</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px1.p1.1.m1.1d">0.01</annotation></semantics></math>. Both Transformers use causal masking, which preserves the compatibility of the whole architecture with streaming inference. Both Transformers prove to be useful with regard to perceived audio quality, while Transformer in the encoder also improves the distillation of semantic information described below (see <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.T3" title="Table 3 ‣ Baselines. ‣ 5.2 Audio Tokenization ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue">Table&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></span></a> for ablation studies).</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS3.SSS1.Px2">
<h5 class="ltx_title ltx_title_paragraph">Causality and streaming.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.SS3.SSS1.Px2.p1">
<p class="ltx_p" id="S3.SS3.SSS1.Px2.p1.1">With the mentioned hyper-parameters, Mimi is causal and can be used in a streaming fashion, both for encoding and decoding. Both its initial frame size and overall stride correspond to 80ms, meaning that given a first audio frame of 80ms, Mimi outputs a first latent timestep, which can be decoded to 80ms of output audio.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS3.SSS1.Px3">
<h5 class="ltx_title ltx_title_paragraph">Optimization.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.SS3.SSS1.Px3.p1">
<p class="ltx_p" id="S3.SS3.SSS1.Px3.p1.7">Unlike purely convolutional codecs that use Adam&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Kingma and Ba, <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib48" title="">2015</a>)</cite>, the introduction of Transformers into the architecture requires additional regularization with weight decay along with using the AdamW&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Loshchilov and Hutter, <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib64" title="">2019</a>)</cite> optimizer. More precisely, we apply weight decay only to the parameters of the Transformers, with a weight of <math alttext="5\cdot 10^{-2}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px3.p1.1.m1.1"><semantics id="S3.SS3.SSS1.Px3.p1.1.m1.1a"><mrow id="S3.SS3.SSS1.Px3.p1.1.m1.1.1" xref="S3.SS3.SSS1.Px3.p1.1.m1.1.1.cmml"><mn id="S3.SS3.SSS1.Px3.p1.1.m1.1.1.2" xref="S3.SS3.SSS1.Px3.p1.1.m1.1.1.2.cmml">5</mn><mo id="S3.SS3.SSS1.Px3.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.SSS1.Px3.p1.1.m1.1.1.1.cmml">⋅</mo><msup id="S3.SS3.SSS1.Px3.p1.1.m1.1.1.3" xref="S3.SS3.SSS1.Px3.p1.1.m1.1.1.3.cmml"><mn id="S3.SS3.SSS1.Px3.p1.1.m1.1.1.3.2" xref="S3.SS3.SSS1.Px3.p1.1.m1.1.1.3.2.cmml">10</mn><mrow id="S3.SS3.SSS1.Px3.p1.1.m1.1.1.3.3" xref="S3.SS3.SSS1.Px3.p1.1.m1.1.1.3.3.cmml"><mo id="S3.SS3.SSS1.Px3.p1.1.m1.1.1.3.3a" xref="S3.SS3.SSS1.Px3.p1.1.m1.1.1.3.3.cmml">−</mo><mn id="S3.SS3.SSS1.Px3.p1.1.m1.1.1.3.3.2" xref="S3.SS3.SSS1.Px3.p1.1.m1.1.1.3.3.2.cmml">2</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px3.p1.1.m1.1b"><apply id="S3.SS3.SSS1.Px3.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS1.Px3.p1.1.m1.1.1"><ci id="S3.SS3.SSS1.Px3.p1.1.m1.1.1.1.cmml" xref="S3.SS3.SSS1.Px3.p1.1.m1.1.1.1">⋅</ci><cn id="S3.SS3.SSS1.Px3.p1.1.m1.1.1.2.cmml" type="integer" xref="S3.SS3.SSS1.Px3.p1.1.m1.1.1.2">5</cn><apply id="S3.SS3.SSS1.Px3.p1.1.m1.1.1.3.cmml" xref="S3.SS3.SSS1.Px3.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px3.p1.1.m1.1.1.3.1.cmml" xref="S3.SS3.SSS1.Px3.p1.1.m1.1.1.3">superscript</csymbol><cn id="S3.SS3.SSS1.Px3.p1.1.m1.1.1.3.2.cmml" type="integer" xref="S3.SS3.SSS1.Px3.p1.1.m1.1.1.3.2">10</cn><apply id="S3.SS3.SSS1.Px3.p1.1.m1.1.1.3.3.cmml" xref="S3.SS3.SSS1.Px3.p1.1.m1.1.1.3.3"><minus id="S3.SS3.SSS1.Px3.p1.1.m1.1.1.3.3.1.cmml" xref="S3.SS3.SSS1.Px3.p1.1.m1.1.1.3.3"></minus><cn id="S3.SS3.SSS1.Px3.p1.1.m1.1.1.3.3.2.cmml" type="integer" xref="S3.SS3.SSS1.Px3.p1.1.m1.1.1.3.3.2">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px3.p1.1.m1.1c">5\cdot 10^{-2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px3.p1.1.m1.1d">5 ⋅ 10 start_POSTSUPERSCRIPT - 2 end_POSTSUPERSCRIPT</annotation></semantics></math>. We use a learning rate of <math alttext="8\cdot 10^{-4}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px3.p1.2.m2.1"><semantics id="S3.SS3.SSS1.Px3.p1.2.m2.1a"><mrow id="S3.SS3.SSS1.Px3.p1.2.m2.1.1" xref="S3.SS3.SSS1.Px3.p1.2.m2.1.1.cmml"><mn id="S3.SS3.SSS1.Px3.p1.2.m2.1.1.2" xref="S3.SS3.SSS1.Px3.p1.2.m2.1.1.2.cmml">8</mn><mo id="S3.SS3.SSS1.Px3.p1.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.SSS1.Px3.p1.2.m2.1.1.1.cmml">⋅</mo><msup id="S3.SS3.SSS1.Px3.p1.2.m2.1.1.3" xref="S3.SS3.SSS1.Px3.p1.2.m2.1.1.3.cmml"><mn id="S3.SS3.SSS1.Px3.p1.2.m2.1.1.3.2" xref="S3.SS3.SSS1.Px3.p1.2.m2.1.1.3.2.cmml">10</mn><mrow id="S3.SS3.SSS1.Px3.p1.2.m2.1.1.3.3" xref="S3.SS3.SSS1.Px3.p1.2.m2.1.1.3.3.cmml"><mo id="S3.SS3.SSS1.Px3.p1.2.m2.1.1.3.3a" xref="S3.SS3.SSS1.Px3.p1.2.m2.1.1.3.3.cmml">−</mo><mn id="S3.SS3.SSS1.Px3.p1.2.m2.1.1.3.3.2" xref="S3.SS3.SSS1.Px3.p1.2.m2.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px3.p1.2.m2.1b"><apply id="S3.SS3.SSS1.Px3.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS1.Px3.p1.2.m2.1.1"><ci id="S3.SS3.SSS1.Px3.p1.2.m2.1.1.1.cmml" xref="S3.SS3.SSS1.Px3.p1.2.m2.1.1.1">⋅</ci><cn id="S3.SS3.SSS1.Px3.p1.2.m2.1.1.2.cmml" type="integer" xref="S3.SS3.SSS1.Px3.p1.2.m2.1.1.2">8</cn><apply id="S3.SS3.SSS1.Px3.p1.2.m2.1.1.3.cmml" xref="S3.SS3.SSS1.Px3.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px3.p1.2.m2.1.1.3.1.cmml" xref="S3.SS3.SSS1.Px3.p1.2.m2.1.1.3">superscript</csymbol><cn id="S3.SS3.SSS1.Px3.p1.2.m2.1.1.3.2.cmml" type="integer" xref="S3.SS3.SSS1.Px3.p1.2.m2.1.1.3.2">10</cn><apply id="S3.SS3.SSS1.Px3.p1.2.m2.1.1.3.3.cmml" xref="S3.SS3.SSS1.Px3.p1.2.m2.1.1.3.3"><minus id="S3.SS3.SSS1.Px3.p1.2.m2.1.1.3.3.1.cmml" xref="S3.SS3.SSS1.Px3.p1.2.m2.1.1.3.3"></minus><cn id="S3.SS3.SSS1.Px3.p1.2.m2.1.1.3.3.2.cmml" type="integer" xref="S3.SS3.SSS1.Px3.p1.2.m2.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px3.p1.2.m2.1c">8\cdot 10^{-4}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px3.p1.2.m2.1d">8 ⋅ 10 start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math>, a momentum decay of <math alttext="0.5" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px3.p1.3.m3.1"><semantics id="S3.SS3.SSS1.Px3.p1.3.m3.1a"><mn id="S3.SS3.SSS1.Px3.p1.3.m3.1.1" xref="S3.SS3.SSS1.Px3.p1.3.m3.1.1.cmml">0.5</mn><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px3.p1.3.m3.1b"><cn id="S3.SS3.SSS1.Px3.p1.3.m3.1.1.cmml" type="float" xref="S3.SS3.SSS1.Px3.p1.3.m3.1.1">0.5</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px3.p1.3.m3.1c">0.5</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px3.p1.3.m3.1d">0.5</annotation></semantics></math> and a decay of the squared gradient of <math alttext="0.9" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px3.p1.4.m4.1"><semantics id="S3.SS3.SSS1.Px3.p1.4.m4.1a"><mn id="S3.SS3.SSS1.Px3.p1.4.m4.1.1" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1.cmml">0.9</mn><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px3.p1.4.m4.1b"><cn id="S3.SS3.SSS1.Px3.p1.4.m4.1.1.cmml" type="float" xref="S3.SS3.SSS1.Px3.p1.4.m4.1.1">0.9</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px3.p1.4.m4.1c">0.9</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px3.p1.4.m4.1d">0.9</annotation></semantics></math>, and an exponential moving average of weights with a decay of <math alttext="0.99" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px3.p1.5.m5.1"><semantics id="S3.SS3.SSS1.Px3.p1.5.m5.1a"><mn id="S3.SS3.SSS1.Px3.p1.5.m5.1.1" xref="S3.SS3.SSS1.Px3.p1.5.m5.1.1.cmml">0.99</mn><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px3.p1.5.m5.1b"><cn id="S3.SS3.SSS1.Px3.p1.5.m5.1.1.cmml" type="float" xref="S3.SS3.SSS1.Px3.p1.5.m5.1.1">0.99</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px3.p1.5.m5.1c">0.99</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px3.p1.5.m5.1d">0.99</annotation></semantics></math>. We train with a batch size of <math alttext="128" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px3.p1.6.m6.1"><semantics id="S3.SS3.SSS1.Px3.p1.6.m6.1a"><mn id="S3.SS3.SSS1.Px3.p1.6.m6.1.1" xref="S3.SS3.SSS1.Px3.p1.6.m6.1.1.cmml">128</mn><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px3.p1.6.m6.1b"><cn id="S3.SS3.SSS1.Px3.p1.6.m6.1.1.cmml" type="integer" xref="S3.SS3.SSS1.Px3.p1.6.m6.1.1">128</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px3.p1.6.m6.1c">128</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px3.p1.6.m6.1d">128</annotation></semantics></math> on random windows of <math alttext="12\text{\,}\mathrm{s}" class="ltx_markedasmath" display="inline" id="S3.SS3.SSS1.Px3.p1.7.m7.1.1.m1.3"><semantics id="S3.SS3.SSS1.Px3.p1.7.m7.1.1.m1.3a"><mrow id="S3.SS3.SSS1.Px3.p1.7.m7.1.1.m1.3.3" xref="S3.SS3.SSS1.Px3.p1.7.m7.1.1.m1.3.3.cmml"><mn id="S3.SS3.SSS1.Px3.p1.7.m7.1.1.m1.1.1.1.1.1.1" xref="S3.SS3.SSS1.Px3.p1.7.m7.1.1.m1.1.1.1.1.1.1.cmml">12</mn><mtext id="S3.SS3.SSS1.Px3.p1.7.m7.1.1.m1.2.2.2.2.2.2" xref="S3.SS3.SSS1.Px3.p1.7.m7.1.1.m1.2.2.2.2.2.2.cmml">&nbsp;</mtext><mi class="ltx_unit" id="S3.SS3.SSS1.Px3.p1.7.m7.1.1.m1.3.3.3.3.3.3" mathvariant="normal" xref="S3.SS3.SSS1.Px3.p1.7.m7.1.1.m1.3.3.3.3.3.3.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px3.p1.7.m7.1.1.m1.3b"><apply id="S3.SS3.SSS1.Px3.p1.7.m7.1.1.m1.3.3.cmml" xref="S3.SS3.SSS1.Px3.p1.7.m7.1.1.m1.3.3"><csymbol cd="latexml" id="S3.SS3.SSS1.Px3.p1.7.m7.1.1.m1.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS1.Px3.p1.7.m7.1.1.m1.2.2.2.2.2.2">times</csymbol><cn id="S3.SS3.SSS1.Px3.p1.7.m7.1.1.m1.1.1.1.1.1.1.cmml" type="integer" xref="S3.SS3.SSS1.Px3.p1.7.m7.1.1.m1.1.1.1.1.1.1">12</cn><csymbol cd="latexml" id="S3.SS3.SSS1.Px3.p1.7.m7.1.1.m1.3.3.3.3.3.3.cmml" xref="S3.SS3.SSS1.Px3.p1.7.m7.1.1.m1.3.3.3.3.3.3">second</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px3.p1.7.m7.1.1.m1.3c">12\text{\,}\mathrm{s}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px3.p1.7.m7.1.1.m1.3d">start_ARG 12 end_ARG start_ARG times end_ARG start_ARG roman_s end_ARG</annotation></semantics></math>, for 4M steps, while the context of Transformers is limited to 10s (250 frames before the last downsampling layer of the encoder, and symmetrically for the decoder).</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS3.SSS1.Px4">
<h5 class="ltx_title ltx_title_paragraph">Quantization rate.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.SS3.SSS1.Px4.p1">
<p class="ltx_p" id="S3.SS3.SSS1.Px4.p1.3">We use <math alttext="Q=8" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px4.p1.1.m1.1"><semantics id="S3.SS3.SSS1.Px4.p1.1.m1.1a"><mrow id="S3.SS3.SSS1.Px4.p1.1.m1.1.1" xref="S3.SS3.SSS1.Px4.p1.1.m1.1.1.cmml"><mi id="S3.SS3.SSS1.Px4.p1.1.m1.1.1.2" xref="S3.SS3.SSS1.Px4.p1.1.m1.1.1.2.cmml">Q</mi><mo id="S3.SS3.SSS1.Px4.p1.1.m1.1.1.1" xref="S3.SS3.SSS1.Px4.p1.1.m1.1.1.1.cmml">=</mo><mn id="S3.SS3.SSS1.Px4.p1.1.m1.1.1.3" xref="S3.SS3.SSS1.Px4.p1.1.m1.1.1.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px4.p1.1.m1.1b"><apply id="S3.SS3.SSS1.Px4.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS1.Px4.p1.1.m1.1.1"><eq id="S3.SS3.SSS1.Px4.p1.1.m1.1.1.1.cmml" xref="S3.SS3.SSS1.Px4.p1.1.m1.1.1.1"></eq><ci id="S3.SS3.SSS1.Px4.p1.1.m1.1.1.2.cmml" xref="S3.SS3.SSS1.Px4.p1.1.m1.1.1.2">𝑄</ci><cn id="S3.SS3.SSS1.Px4.p1.1.m1.1.1.3.cmml" type="integer" xref="S3.SS3.SSS1.Px4.p1.1.m1.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px4.p1.1.m1.1c">Q=8</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px4.p1.1.m1.1d">italic_Q = 8</annotation></semantics></math> quantizers, each with a codebook size of <math alttext="N_{A}=2048" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px4.p1.2.m2.1"><semantics id="S3.SS3.SSS1.Px4.p1.2.m2.1a"><mrow id="S3.SS3.SSS1.Px4.p1.2.m2.1.1" xref="S3.SS3.SSS1.Px4.p1.2.m2.1.1.cmml"><msub id="S3.SS3.SSS1.Px4.p1.2.m2.1.1.2" xref="S3.SS3.SSS1.Px4.p1.2.m2.1.1.2.cmml"><mi id="S3.SS3.SSS1.Px4.p1.2.m2.1.1.2.2" xref="S3.SS3.SSS1.Px4.p1.2.m2.1.1.2.2.cmml">N</mi><mi id="S3.SS3.SSS1.Px4.p1.2.m2.1.1.2.3" xref="S3.SS3.SSS1.Px4.p1.2.m2.1.1.2.3.cmml">A</mi></msub><mo id="S3.SS3.SSS1.Px4.p1.2.m2.1.1.1" xref="S3.SS3.SSS1.Px4.p1.2.m2.1.1.1.cmml">=</mo><mn id="S3.SS3.SSS1.Px4.p1.2.m2.1.1.3" xref="S3.SS3.SSS1.Px4.p1.2.m2.1.1.3.cmml">2048</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px4.p1.2.m2.1b"><apply id="S3.SS3.SSS1.Px4.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS1.Px4.p1.2.m2.1.1"><eq id="S3.SS3.SSS1.Px4.p1.2.m2.1.1.1.cmml" xref="S3.SS3.SSS1.Px4.p1.2.m2.1.1.1"></eq><apply id="S3.SS3.SSS1.Px4.p1.2.m2.1.1.2.cmml" xref="S3.SS3.SSS1.Px4.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.Px4.p1.2.m2.1.1.2.1.cmml" xref="S3.SS3.SSS1.Px4.p1.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS3.SSS1.Px4.p1.2.m2.1.1.2.2.cmml" xref="S3.SS3.SSS1.Px4.p1.2.m2.1.1.2.2">𝑁</ci><ci id="S3.SS3.SSS1.Px4.p1.2.m2.1.1.2.3.cmml" xref="S3.SS3.SSS1.Px4.p1.2.m2.1.1.2.3">𝐴</ci></apply><cn id="S3.SS3.SSS1.Px4.p1.2.m2.1.1.3.cmml" type="integer" xref="S3.SS3.SSS1.Px4.p1.2.m2.1.1.3">2048</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px4.p1.2.m2.1c">N_{A}=2048</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px4.p1.2.m2.1d">italic_N start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT = 2048</annotation></semantics></math>. At 12.5Hz, this represents a bitrate of 1.1kbps. While the latent dimension is 512, we project embeddings to 256 dimensions before applying the RVQ, and project back to 512 before the decoder. Consistently with previous work, we use quantizer dropout&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Zeghidour et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib108" title="">2022</a>)</cite> to provide the codec with bitrate scalability. We moreover follow the observation of &nbsp;<cite class="ltx_cite ltx_citemacro_citet">Kumar et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib51" title="">2023</a>)</cite> that not applying quantization with a certain probability during training improves audio quality. More precisely, we only apply quantization <math alttext="50\%" class="ltx_Math" display="inline" id="S3.SS3.SSS1.Px4.p1.3.m3.1"><semantics id="S3.SS3.SSS1.Px4.p1.3.m3.1a"><mrow id="S3.SS3.SSS1.Px4.p1.3.m3.1.1" xref="S3.SS3.SSS1.Px4.p1.3.m3.1.1.cmml"><mn id="S3.SS3.SSS1.Px4.p1.3.m3.1.1.2" xref="S3.SS3.SSS1.Px4.p1.3.m3.1.1.2.cmml">50</mn><mo id="S3.SS3.SSS1.Px4.p1.3.m3.1.1.1" xref="S3.SS3.SSS1.Px4.p1.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.Px4.p1.3.m3.1b"><apply id="S3.SS3.SSS1.Px4.p1.3.m3.1.1.cmml" xref="S3.SS3.SSS1.Px4.p1.3.m3.1.1"><csymbol cd="latexml" id="S3.SS3.SSS1.Px4.p1.3.m3.1.1.1.cmml" xref="S3.SS3.SSS1.Px4.p1.3.m3.1.1.1">percent</csymbol><cn id="S3.SS3.SSS1.Px4.p1.3.m3.1.1.2.cmml" type="integer" xref="S3.SS3.SSS1.Px4.p1.3.m3.1.1.2">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.Px4.p1.3.m3.1c">50\%</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.Px4.p1.3.m3.1d">50 %</annotation></semantics></math> of the time, on a per-sequence basis, during training. Unlike &nbsp;<cite class="ltx_cite ltx_citemacro_citet">Kumar et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib51" title="">2023</a>)</cite>, this means passing unquantized embeddings to the decoder, rather than passing embeddings quantized with all quantizers. <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.T3" title="Table 3 ‣ Baselines. ‣ 5.2 Audio Tokenization ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue">Table&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></span></a> shows that this significantly improves objective quality metrics, while human evaluations are not conclusive. Across our experiments, we make the somehow counter-intuitive observation that this gain gets more significant as we lower the bitrate.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS3.SSS1.Px5">
<h5 class="ltx_title ltx_title_paragraph">Adversarial-only training.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.SS3.SSS1.Px5.p1">
<p class="ltx_p" id="S3.SS3.SSS1.Px5.p1.1">As a baseline, we train Mimi with the same combination of reconstruction and adversarial losses as &nbsp;<cite class="ltx_cite ltx_citemacro_citet">Défossez et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib21" title="">2023</a>)</cite>, namely a multi-scale mel-spectrogram reconstruction loss along with a multi-scale STFT discriminator. The exact parameters can be found in the Audiocraft repository.<span class="ltx_note ltx_role_footnote" id="footnote7"><sup class="ltx_note_mark">7</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">7</sup><span class="ltx_tag ltx_tag_note">7</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/facebookresearch/audiocraft/blob/main/config/solver/compression/default.yaml" title="">https://github.com/facebookresearch/audiocraft/blob/main/config/solver/compression/default.yaml</a></span></span></span> While previous neural codecs rely on such combinations of reconstruction and adversarial losses, we experiment with pure adversarial training, where we only keep the feature loss and discriminator loss. We note that this was previously experimented in the context of bandwidth extension by&nbsp;<cite class="ltx_cite ltx_citemacro_citet">Tagliasacchi et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib91" title="">2020</a>)</cite> and &nbsp;<cite class="ltx_cite ltx_citemacro_citet">Hauret et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib34" title="">2023</a>)</cite>. While removing reconstruction losses majorly degrades objective metrics, we observed during development that the resulting audio sounded much better than expected based on aforementioned metrics. Subjective evaluations reported in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.T4" title="Table 4 ‣ Baselines. ‣ 5.2 Audio Tokenization ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue">Table&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></span></a> confirm this observation and demonstrate a remarkable boost in audio quality from training with adversarial losses only.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_subsubsection" id="S3.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.2 </span>Learning semantic-acoustic tokens with a split RVQ</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.SS3.SSS2.p1">
<p class="ltx_p" id="S3.SS3.SSS2.p1.1">Similarly to SpeechTokenizer&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Zhang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib113" title="">2024b</a>)</cite>, we distill semantic information from a self-supervised model (WavLM<span class="ltx_note ltx_role_footnote" id="footnote8"><sup class="ltx_note_mark">8</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">8</sup><span class="ltx_tag ltx_tag_note">8</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://huggingface.co/microsoft/wavlm-large" title="">https://huggingface.co/microsoft/wavlm-large</a></span></span></span>&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Chen et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib12" title="">2022</a>)</cite> in our case) into the first level of the RVQ. WavLM projects a 16kHz waveform into 1024-dimensional embeddings sampled at 50Hz, while Mimi projects a 24kHz waveform into 512-dimensional at 12.5Hz. During training, we thus produce targets for distillation by downsampling the input waveform to 16kHz before computing WavLM embeddings followed by average pooling with a stride of 4 and a kernel size of 8, to reach 12.5 Hz. Interestingly, we observed that it was critical for performance to perform this average pooling in a non-causal way, which is compatible with streaming inference as these embeddings are only used during training. We apply a linear projection with an output dimension of 1024 to the output of the first RVQ level, parallel to the actual embedding going into the decoder. We then compute a cosine distance between the output of the first quantizer and the transformed WavLM embeddings, to perform distillation. <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.T3" title="Table 3 ‣ Baselines. ‣ 5.2 Audio Tokenization ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue">Table&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></span></a> shows that this distillation loss conflicts with reconstruction and adversarial losses targeting quality. Indeed, while distillation significantly improves the phonetic discriminability of the first quantizer (as measured by ABX&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Schatz et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib87" title="">2013</a>)</cite>), it also affects audio quality negatively. We hypothesize that this is due to distilling semantic information into the first level of a single RVQ: As higher-order quantizers operate on the residual of the first one, the latter needs to trade audio quality for phonetic discriminability. We address this issue by proposing a split RVQ. Rather than a single RVQ with 8 levels, we distill semantic information into a plain VQ and apply an RVQ with 7 levels in parallel. We sum their outputs, such that while both can be used for reconstruction, we remove the constraint that acoustic information should be conserved in the residual of the semantic quantizer. <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.F2" title="Figure 2 ‣ 3.3 Audio Tokenization ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue">Figure&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></span></a> illustrates this architecture and <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.T3" title="Table 3 ‣ Baselines. ‣ 5.2 Audio Tokenization ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue">Table&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></span></a> shows that this solution provides a better semantic-acoustic trade-off overall.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Generative Audio Modeling</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.1">We now describe how we extend the base Helium model to support the modeling
of the audio tokens provided by the Mimi codec. With our goal of achieving realistic
spoken dialogue interactions, we further show how to model not just a single stream of audio,
but two at the same time, one representing the user, and one the system.
Finally, we detail a novel feature, the <em class="ltx_emph ltx_font_italic" id="S3.SS4.p1.1.1">Inner Monologue</em>, which consists in a joint
modeling of the textual and audio modalities on the system side, to improve the quality of interactions.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_subsubsection" id="S3.SS4.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.4.1 </span>Hierarchical autoregressive modeling with RQ-Transformer</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.SS4.SSS1.p1">
<p class="ltx_p" id="S3.SS4.SSS1.p1.7">Let <math alttext="U\in\{1,\ldots,N\}^{S}" class="ltx_Math" display="inline" id="S3.SS4.SSS1.p1.1.m1.3"><semantics id="S3.SS4.SSS1.p1.1.m1.3a"><mrow id="S3.SS4.SSS1.p1.1.m1.3.4" xref="S3.SS4.SSS1.p1.1.m1.3.4.cmml"><mi id="S3.SS4.SSS1.p1.1.m1.3.4.2" xref="S3.SS4.SSS1.p1.1.m1.3.4.2.cmml">U</mi><mo id="S3.SS4.SSS1.p1.1.m1.3.4.1" xref="S3.SS4.SSS1.p1.1.m1.3.4.1.cmml">∈</mo><msup id="S3.SS4.SSS1.p1.1.m1.3.4.3" xref="S3.SS4.SSS1.p1.1.m1.3.4.3.cmml"><mrow id="S3.SS4.SSS1.p1.1.m1.3.4.3.2.2" xref="S3.SS4.SSS1.p1.1.m1.3.4.3.2.1.cmml"><mo id="S3.SS4.SSS1.p1.1.m1.3.4.3.2.2.1" stretchy="false" xref="S3.SS4.SSS1.p1.1.m1.3.4.3.2.1.cmml">{</mo><mn id="S3.SS4.SSS1.p1.1.m1.1.1" xref="S3.SS4.SSS1.p1.1.m1.1.1.cmml">1</mn><mo id="S3.SS4.SSS1.p1.1.m1.3.4.3.2.2.2" xref="S3.SS4.SSS1.p1.1.m1.3.4.3.2.1.cmml">,</mo><mi id="S3.SS4.SSS1.p1.1.m1.2.2" mathvariant="normal" xref="S3.SS4.SSS1.p1.1.m1.2.2.cmml">…</mi><mo id="S3.SS4.SSS1.p1.1.m1.3.4.3.2.2.3" xref="S3.SS4.SSS1.p1.1.m1.3.4.3.2.1.cmml">,</mo><mi id="S3.SS4.SSS1.p1.1.m1.3.3" xref="S3.SS4.SSS1.p1.1.m1.3.3.cmml">N</mi><mo id="S3.SS4.SSS1.p1.1.m1.3.4.3.2.2.4" stretchy="false" xref="S3.SS4.SSS1.p1.1.m1.3.4.3.2.1.cmml">}</mo></mrow><mi id="S3.SS4.SSS1.p1.1.m1.3.4.3.3" xref="S3.SS4.SSS1.p1.1.m1.3.4.3.3.cmml">S</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.p1.1.m1.3b"><apply id="S3.SS4.SSS1.p1.1.m1.3.4.cmml" xref="S3.SS4.SSS1.p1.1.m1.3.4"><in id="S3.SS4.SSS1.p1.1.m1.3.4.1.cmml" xref="S3.SS4.SSS1.p1.1.m1.3.4.1"></in><ci id="S3.SS4.SSS1.p1.1.m1.3.4.2.cmml" xref="S3.SS4.SSS1.p1.1.m1.3.4.2">𝑈</ci><apply id="S3.SS4.SSS1.p1.1.m1.3.4.3.cmml" xref="S3.SS4.SSS1.p1.1.m1.3.4.3"><csymbol cd="ambiguous" id="S3.SS4.SSS1.p1.1.m1.3.4.3.1.cmml" xref="S3.SS4.SSS1.p1.1.m1.3.4.3">superscript</csymbol><set id="S3.SS4.SSS1.p1.1.m1.3.4.3.2.1.cmml" xref="S3.SS4.SSS1.p1.1.m1.3.4.3.2.2"><cn id="S3.SS4.SSS1.p1.1.m1.1.1.cmml" type="integer" xref="S3.SS4.SSS1.p1.1.m1.1.1">1</cn><ci id="S3.SS4.SSS1.p1.1.m1.2.2.cmml" xref="S3.SS4.SSS1.p1.1.m1.2.2">…</ci><ci id="S3.SS4.SSS1.p1.1.m1.3.3.cmml" xref="S3.SS4.SSS1.p1.1.m1.3.3">𝑁</ci></set><ci id="S3.SS4.SSS1.p1.1.m1.3.4.3.3.cmml" xref="S3.SS4.SSS1.p1.1.m1.3.4.3.3">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.p1.1.m1.3c">U\in\{1,\ldots,N\}^{S}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.p1.1.m1.3d">italic_U ∈ { 1 , … , italic_N } start_POSTSUPERSCRIPT italic_S end_POSTSUPERSCRIPT</annotation></semantics></math> be a discrete random sequence, with cardinality <math alttext="N" class="ltx_Math" display="inline" id="S3.SS4.SSS1.p1.2.m2.1"><semantics id="S3.SS4.SSS1.p1.2.m2.1a"><mi id="S3.SS4.SSS1.p1.2.m2.1.1" xref="S3.SS4.SSS1.p1.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.p1.2.m2.1b"><ci id="S3.SS4.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS4.SSS1.p1.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.p1.2.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.p1.2.m2.1d">italic_N</annotation></semantics></math> and a sequence length <math alttext="S" class="ltx_Math" display="inline" id="S3.SS4.SSS1.p1.3.m3.1"><semantics id="S3.SS4.SSS1.p1.3.m3.1a"><mi id="S3.SS4.SSS1.p1.3.m3.1.1" xref="S3.SS4.SSS1.p1.3.m3.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.p1.3.m3.1b"><ci id="S3.SS4.SSS1.p1.3.m3.1.1.cmml" xref="S3.SS4.SSS1.p1.3.m3.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.p1.3.m3.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.p1.3.m3.1d">italic_S</annotation></semantics></math>. For convenience, we also denote <math alttext="U_{0}=0" class="ltx_Math" display="inline" id="S3.SS4.SSS1.p1.4.m4.1"><semantics id="S3.SS4.SSS1.p1.4.m4.1a"><mrow id="S3.SS4.SSS1.p1.4.m4.1.1" xref="S3.SS4.SSS1.p1.4.m4.1.1.cmml"><msub id="S3.SS4.SSS1.p1.4.m4.1.1.2" xref="S3.SS4.SSS1.p1.4.m4.1.1.2.cmml"><mi id="S3.SS4.SSS1.p1.4.m4.1.1.2.2" xref="S3.SS4.SSS1.p1.4.m4.1.1.2.2.cmml">U</mi><mn id="S3.SS4.SSS1.p1.4.m4.1.1.2.3" xref="S3.SS4.SSS1.p1.4.m4.1.1.2.3.cmml">0</mn></msub><mo id="S3.SS4.SSS1.p1.4.m4.1.1.1" xref="S3.SS4.SSS1.p1.4.m4.1.1.1.cmml">=</mo><mn id="S3.SS4.SSS1.p1.4.m4.1.1.3" xref="S3.SS4.SSS1.p1.4.m4.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.p1.4.m4.1b"><apply id="S3.SS4.SSS1.p1.4.m4.1.1.cmml" xref="S3.SS4.SSS1.p1.4.m4.1.1"><eq id="S3.SS4.SSS1.p1.4.m4.1.1.1.cmml" xref="S3.SS4.SSS1.p1.4.m4.1.1.1"></eq><apply id="S3.SS4.SSS1.p1.4.m4.1.1.2.cmml" xref="S3.SS4.SSS1.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.SSS1.p1.4.m4.1.1.2.1.cmml" xref="S3.SS4.SSS1.p1.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS4.SSS1.p1.4.m4.1.1.2.2.cmml" xref="S3.SS4.SSS1.p1.4.m4.1.1.2.2">𝑈</ci><cn id="S3.SS4.SSS1.p1.4.m4.1.1.2.3.cmml" type="integer" xref="S3.SS4.SSS1.p1.4.m4.1.1.2.3">0</cn></apply><cn id="S3.SS4.SSS1.p1.4.m4.1.1.3.cmml" type="integer" xref="S3.SS4.SSS1.p1.4.m4.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.p1.4.m4.1c">U_{0}=0</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.p1.4.m4.1d">italic_U start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = 0</annotation></semantics></math>, a deterministic initial token value.
Autoregressive modeling consists in estimating the joint distribution <math alttext="\mathbb{P}\left[U_{1},\ldots,U_{S}\right]" class="ltx_Math" display="inline" id="S3.SS4.SSS1.p1.5.m5.3"><semantics id="S3.SS4.SSS1.p1.5.m5.3a"><mrow id="S3.SS4.SSS1.p1.5.m5.3.3" xref="S3.SS4.SSS1.p1.5.m5.3.3.cmml"><mi id="S3.SS4.SSS1.p1.5.m5.3.3.4" xref="S3.SS4.SSS1.p1.5.m5.3.3.4.cmml">ℙ</mi><mo id="S3.SS4.SSS1.p1.5.m5.3.3.3" xref="S3.SS4.SSS1.p1.5.m5.3.3.3.cmml">⁢</mo><mrow id="S3.SS4.SSS1.p1.5.m5.3.3.2.2" xref="S3.SS4.SSS1.p1.5.m5.3.3.2.3.cmml"><mo id="S3.SS4.SSS1.p1.5.m5.3.3.2.2.3" xref="S3.SS4.SSS1.p1.5.m5.3.3.2.3.cmml">[</mo><msub id="S3.SS4.SSS1.p1.5.m5.2.2.1.1.1" xref="S3.SS4.SSS1.p1.5.m5.2.2.1.1.1.cmml"><mi id="S3.SS4.SSS1.p1.5.m5.2.2.1.1.1.2" xref="S3.SS4.SSS1.p1.5.m5.2.2.1.1.1.2.cmml">U</mi><mn id="S3.SS4.SSS1.p1.5.m5.2.2.1.1.1.3" xref="S3.SS4.SSS1.p1.5.m5.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS4.SSS1.p1.5.m5.3.3.2.2.4" xref="S3.SS4.SSS1.p1.5.m5.3.3.2.3.cmml">,</mo><mi id="S3.SS4.SSS1.p1.5.m5.1.1" mathvariant="normal" xref="S3.SS4.SSS1.p1.5.m5.1.1.cmml">…</mi><mo id="S3.SS4.SSS1.p1.5.m5.3.3.2.2.5" xref="S3.SS4.SSS1.p1.5.m5.3.3.2.3.cmml">,</mo><msub id="S3.SS4.SSS1.p1.5.m5.3.3.2.2.2" xref="S3.SS4.SSS1.p1.5.m5.3.3.2.2.2.cmml"><mi id="S3.SS4.SSS1.p1.5.m5.3.3.2.2.2.2" xref="S3.SS4.SSS1.p1.5.m5.3.3.2.2.2.2.cmml">U</mi><mi id="S3.SS4.SSS1.p1.5.m5.3.3.2.2.2.3" xref="S3.SS4.SSS1.p1.5.m5.3.3.2.2.2.3.cmml">S</mi></msub><mo id="S3.SS4.SSS1.p1.5.m5.3.3.2.2.6" xref="S3.SS4.SSS1.p1.5.m5.3.3.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.p1.5.m5.3b"><apply id="S3.SS4.SSS1.p1.5.m5.3.3.cmml" xref="S3.SS4.SSS1.p1.5.m5.3.3"><times id="S3.SS4.SSS1.p1.5.m5.3.3.3.cmml" xref="S3.SS4.SSS1.p1.5.m5.3.3.3"></times><ci id="S3.SS4.SSS1.p1.5.m5.3.3.4.cmml" xref="S3.SS4.SSS1.p1.5.m5.3.3.4">ℙ</ci><list id="S3.SS4.SSS1.p1.5.m5.3.3.2.3.cmml" xref="S3.SS4.SSS1.p1.5.m5.3.3.2.2"><apply id="S3.SS4.SSS1.p1.5.m5.2.2.1.1.1.cmml" xref="S3.SS4.SSS1.p1.5.m5.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS1.p1.5.m5.2.2.1.1.1.1.cmml" xref="S3.SS4.SSS1.p1.5.m5.2.2.1.1.1">subscript</csymbol><ci id="S3.SS4.SSS1.p1.5.m5.2.2.1.1.1.2.cmml" xref="S3.SS4.SSS1.p1.5.m5.2.2.1.1.1.2">𝑈</ci><cn id="S3.SS4.SSS1.p1.5.m5.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS4.SSS1.p1.5.m5.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS4.SSS1.p1.5.m5.1.1.cmml" xref="S3.SS4.SSS1.p1.5.m5.1.1">…</ci><apply id="S3.SS4.SSS1.p1.5.m5.3.3.2.2.2.cmml" xref="S3.SS4.SSS1.p1.5.m5.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.SSS1.p1.5.m5.3.3.2.2.2.1.cmml" xref="S3.SS4.SSS1.p1.5.m5.3.3.2.2.2">subscript</csymbol><ci id="S3.SS4.SSS1.p1.5.m5.3.3.2.2.2.2.cmml" xref="S3.SS4.SSS1.p1.5.m5.3.3.2.2.2.2">𝑈</ci><ci id="S3.SS4.SSS1.p1.5.m5.3.3.2.2.2.3.cmml" xref="S3.SS4.SSS1.p1.5.m5.3.3.2.2.2.3">𝑆</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.p1.5.m5.3c">\mathbb{P}\left[U_{1},\ldots,U_{S}\right]</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.p1.5.m5.3d">blackboard_P [ italic_U start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_U start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT ]</annotation></semantics></math>
through estimating the conditional distributions <math alttext="\mathbb{P}\left[U_{s}|U_{0},\ldots U_{s-1}\right]" class="ltx_Math" display="inline" id="S3.SS4.SSS1.p1.6.m6.1"><semantics id="S3.SS4.SSS1.p1.6.m6.1a"><mrow id="S3.SS4.SSS1.p1.6.m6.1.1" xref="S3.SS4.SSS1.p1.6.m6.1.1.cmml"><mi id="S3.SS4.SSS1.p1.6.m6.1.1.3" xref="S3.SS4.SSS1.p1.6.m6.1.1.3.cmml">ℙ</mi><mo id="S3.SS4.SSS1.p1.6.m6.1.1.2" xref="S3.SS4.SSS1.p1.6.m6.1.1.2.cmml">⁢</mo><mrow id="S3.SS4.SSS1.p1.6.m6.1.1.1.1" xref="S3.SS4.SSS1.p1.6.m6.1.1.1.2.cmml"><mo id="S3.SS4.SSS1.p1.6.m6.1.1.1.1.2" xref="S3.SS4.SSS1.p1.6.m6.1.1.1.2.1.cmml">[</mo><mrow id="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1" xref="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.cmml"><msub id="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.4" xref="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.4.cmml"><mi id="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.4.2" xref="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.4.2.cmml">U</mi><mi id="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.4.3" xref="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.4.3.cmml">s</mi></msub><mo fence="false" id="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.3" xref="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.3.cmml">|</mo><mrow id="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.2.2" xref="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.2.3.cmml"><msub id="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.1.1.1" xref="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.1.1.1.2" xref="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.1.1.1.2.cmml">U</mi><mn id="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.1.1.1.3" xref="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.2.2.3" xref="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.2.3.cmml">,</mo><mrow id="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.2.2.2" xref="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.2.2.2.cmml"><mi id="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.2.2.2.2" mathvariant="normal" xref="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.2.2.2.2.cmml">…</mi><mo id="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.2.2.2.1" xref="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.2.2.2.1.cmml">⁢</mo><msub id="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.2.2.2.3" xref="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.2.2.2.3.cmml"><mi id="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.2.2.2.3.2" xref="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.2.2.2.3.2.cmml">U</mi><mrow id="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.2.2.2.3.3" xref="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.2.2.2.3.3.cmml"><mi id="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.2.2.2.3.3.2" xref="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.2.2.2.3.3.2.cmml">s</mi><mo id="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.2.2.2.3.3.1" xref="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.2.2.2.3.3.1.cmml">−</mo><mn id="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.2.2.2.3.3.3" xref="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.2.2.2.3.3.3.cmml">1</mn></mrow></msub></mrow></mrow></mrow><mo id="S3.SS4.SSS1.p1.6.m6.1.1.1.1.3" xref="S3.SS4.SSS1.p1.6.m6.1.1.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.p1.6.m6.1b"><apply id="S3.SS4.SSS1.p1.6.m6.1.1.cmml" xref="S3.SS4.SSS1.p1.6.m6.1.1"><times id="S3.SS4.SSS1.p1.6.m6.1.1.2.cmml" xref="S3.SS4.SSS1.p1.6.m6.1.1.2"></times><ci id="S3.SS4.SSS1.p1.6.m6.1.1.3.cmml" xref="S3.SS4.SSS1.p1.6.m6.1.1.3">ℙ</ci><apply id="S3.SS4.SSS1.p1.6.m6.1.1.1.2.cmml" xref="S3.SS4.SSS1.p1.6.m6.1.1.1.1"><csymbol cd="latexml" id="S3.SS4.SSS1.p1.6.m6.1.1.1.2.1.cmml" xref="S3.SS4.SSS1.p1.6.m6.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.cmml" xref="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1"><csymbol cd="latexml" id="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.3.cmml" xref="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.3">conditional</csymbol><apply id="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.4.cmml" xref="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.4.1.cmml" xref="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.4">subscript</csymbol><ci id="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.4.2.cmml" xref="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.4.2">𝑈</ci><ci id="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.4.3.cmml" xref="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.4.3">𝑠</ci></apply><list id="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.2.3.cmml" xref="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.2.2"><apply id="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.1.1.1.cmml" xref="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.1.1.1.2">𝑈</ci><cn id="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.1.1.1.3">0</cn></apply><apply id="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.2.2.2.cmml" xref="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.2.2.2"><times id="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.2.2.2.1.cmml" xref="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.2.2.2.1"></times><ci id="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.2.2.2.2.cmml" xref="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.2.2.2.2">…</ci><apply id="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.2.2.2.3.cmml" xref="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.2.2.2.3.1.cmml" xref="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.2.2.2.3">subscript</csymbol><ci id="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.2.2.2.3.2.cmml" xref="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.2.2.2.3.2">𝑈</ci><apply id="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.2.2.2.3.3.cmml" xref="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.2.2.2.3.3"><minus id="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.2.2.2.3.3.1.cmml" xref="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.2.2.2.3.3.1"></minus><ci id="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.2.2.2.3.3.2.cmml" xref="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.2.2.2.3.3.2">𝑠</ci><cn id="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.2.2.2.3.3.3.cmml" type="integer" xref="S3.SS4.SSS1.p1.6.m6.1.1.1.1.1.2.2.2.3.3.3">1</cn></apply></apply></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.p1.6.m6.1c">\mathbb{P}\left[U_{s}|U_{0},\ldots U_{s-1}\right]</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.p1.6.m6.1d">blackboard_P [ italic_U start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT | italic_U start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , … italic_U start_POSTSUBSCRIPT italic_s - 1 end_POSTSUBSCRIPT ]</annotation></semantics></math> for all steps <math alttext="1\leq s\leq S" class="ltx_Math" display="inline" id="S3.SS4.SSS1.p1.7.m7.1"><semantics id="S3.SS4.SSS1.p1.7.m7.1a"><mrow id="S3.SS4.SSS1.p1.7.m7.1.1" xref="S3.SS4.SSS1.p1.7.m7.1.1.cmml"><mn id="S3.SS4.SSS1.p1.7.m7.1.1.2" xref="S3.SS4.SSS1.p1.7.m7.1.1.2.cmml">1</mn><mo id="S3.SS4.SSS1.p1.7.m7.1.1.3" xref="S3.SS4.SSS1.p1.7.m7.1.1.3.cmml">≤</mo><mi id="S3.SS4.SSS1.p1.7.m7.1.1.4" xref="S3.SS4.SSS1.p1.7.m7.1.1.4.cmml">s</mi><mo id="S3.SS4.SSS1.p1.7.m7.1.1.5" xref="S3.SS4.SSS1.p1.7.m7.1.1.5.cmml">≤</mo><mi id="S3.SS4.SSS1.p1.7.m7.1.1.6" xref="S3.SS4.SSS1.p1.7.m7.1.1.6.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.p1.7.m7.1b"><apply id="S3.SS4.SSS1.p1.7.m7.1.1.cmml" xref="S3.SS4.SSS1.p1.7.m7.1.1"><and id="S3.SS4.SSS1.p1.7.m7.1.1a.cmml" xref="S3.SS4.SSS1.p1.7.m7.1.1"></and><apply id="S3.SS4.SSS1.p1.7.m7.1.1b.cmml" xref="S3.SS4.SSS1.p1.7.m7.1.1"><leq id="S3.SS4.SSS1.p1.7.m7.1.1.3.cmml" xref="S3.SS4.SSS1.p1.7.m7.1.1.3"></leq><cn id="S3.SS4.SSS1.p1.7.m7.1.1.2.cmml" type="integer" xref="S3.SS4.SSS1.p1.7.m7.1.1.2">1</cn><ci id="S3.SS4.SSS1.p1.7.m7.1.1.4.cmml" xref="S3.SS4.SSS1.p1.7.m7.1.1.4">𝑠</ci></apply><apply id="S3.SS4.SSS1.p1.7.m7.1.1c.cmml" xref="S3.SS4.SSS1.p1.7.m7.1.1"><leq id="S3.SS4.SSS1.p1.7.m7.1.1.5.cmml" xref="S3.SS4.SSS1.p1.7.m7.1.1.5"></leq><share href="https://arxiv.org/html/2410.00037v2#S3.SS4.SSS1.p1.7.m7.1.1.4.cmml" id="S3.SS4.SSS1.p1.7.m7.1.1d.cmml" xref="S3.SS4.SSS1.p1.7.m7.1.1"></share><ci id="S3.SS4.SSS1.p1.7.m7.1.1.6.cmml" xref="S3.SS4.SSS1.p1.7.m7.1.1.6">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.p1.7.m7.1c">1\leq s\leq S</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.p1.7.m7.1d">1 ≤ italic_s ≤ italic_S</annotation></semantics></math>. Text language models, such as GPT&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Radford et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib76" title="">2019</a>)</cite> or Helium, fit this paradigm.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="S3.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="169" id="S3.F3.g1" src="https://arxiv.org/html/2410.00037v2/extracted/5895270/figures/rq_former_landscape.png" width="299">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span><span class="ltx_text ltx_font_bold" id="S3.F3.14.1">Architecture of the RQ-Transformer.</span> The RQ-Transformer breaks down a flattened sequence of length <math alttext="K\cdot S" class="ltx_Math" display="inline" id="S3.F3.7.m1.1"><semantics id="S3.F3.7.m1.1b"><mrow id="S3.F3.7.m1.1.1" xref="S3.F3.7.m1.1.1.cmml"><mi id="S3.F3.7.m1.1.1.2" xref="S3.F3.7.m1.1.1.2.cmml">K</mi><mo id="S3.F3.7.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.F3.7.m1.1.1.1.cmml">⋅</mo><mi id="S3.F3.7.m1.1.1.3" xref="S3.F3.7.m1.1.1.3.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.F3.7.m1.1c"><apply id="S3.F3.7.m1.1.1.cmml" xref="S3.F3.7.m1.1.1"><ci id="S3.F3.7.m1.1.1.1.cmml" xref="S3.F3.7.m1.1.1.1">⋅</ci><ci id="S3.F3.7.m1.1.1.2.cmml" xref="S3.F3.7.m1.1.1.2">𝐾</ci><ci id="S3.F3.7.m1.1.1.3.cmml" xref="S3.F3.7.m1.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.7.m1.1d">K\cdot S</annotation><annotation encoding="application/x-llamapun" id="S3.F3.7.m1.1e">italic_K ⋅ italic_S</annotation></semantics></math> into <math alttext="S" class="ltx_Math" display="inline" id="S3.F3.8.m2.1"><semantics id="S3.F3.8.m2.1b"><mi id="S3.F3.8.m2.1.1" xref="S3.F3.8.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.F3.8.m2.1c"><ci id="S3.F3.8.m2.1.1.cmml" xref="S3.F3.8.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.8.m2.1d">S</annotation><annotation encoding="application/x-llamapun" id="S3.F3.8.m2.1e">italic_S</annotation></semantics></math> timesteps for a large Temporal Transformer which produces a context embedding used to condition a smaller Depth Transformer over <math alttext="K" class="ltx_Math" display="inline" id="S3.F3.9.m3.1"><semantics id="S3.F3.9.m3.1b"><mi id="S3.F3.9.m3.1.1" xref="S3.F3.9.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.F3.9.m3.1c"><ci id="S3.F3.9.m3.1.1.cmml" xref="S3.F3.9.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.9.m3.1d">K</annotation><annotation encoding="application/x-llamapun" id="S3.F3.9.m3.1e">italic_K</annotation></semantics></math> steps. This allows scaling to longer sequences by increasing <math alttext="S" class="ltx_Math" display="inline" id="S3.F3.10.m4.1"><semantics id="S3.F3.10.m4.1b"><mi id="S3.F3.10.m4.1.1" xref="S3.F3.10.m4.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.F3.10.m4.1c"><ci id="S3.F3.10.m4.1.1.cmml" xref="S3.F3.10.m4.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.10.m4.1d">S</annotation><annotation encoding="application/x-llamapun" id="S3.F3.10.m4.1e">italic_S</annotation></semantics></math>—or to a higher depth by increasing <math alttext="K" class="ltx_Math" display="inline" id="S3.F3.11.m5.1"><semantics id="S3.F3.11.m5.1b"><mi id="S3.F3.11.m5.1.1" xref="S3.F3.11.m5.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.F3.11.m5.1c"><ci id="S3.F3.11.m5.1.1.cmml" xref="S3.F3.11.m5.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.11.m5.1d">K</annotation><annotation encoding="application/x-llamapun" id="S3.F3.11.m5.1e">italic_K</annotation></semantics></math>— than modeling the flattened sequence with a single model. In this figure, we use <math alttext="K=4" class="ltx_Math" display="inline" id="S3.F3.12.m6.1"><semantics id="S3.F3.12.m6.1b"><mrow id="S3.F3.12.m6.1.1" xref="S3.F3.12.m6.1.1.cmml"><mi id="S3.F3.12.m6.1.1.2" xref="S3.F3.12.m6.1.1.2.cmml">K</mi><mo id="S3.F3.12.m6.1.1.1" xref="S3.F3.12.m6.1.1.1.cmml">=</mo><mn id="S3.F3.12.m6.1.1.3" xref="S3.F3.12.m6.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.F3.12.m6.1c"><apply id="S3.F3.12.m6.1.1.cmml" xref="S3.F3.12.m6.1.1"><eq id="S3.F3.12.m6.1.1.1.cmml" xref="S3.F3.12.m6.1.1.1"></eq><ci id="S3.F3.12.m6.1.1.2.cmml" xref="S3.F3.12.m6.1.1.2">𝐾</ci><cn id="S3.F3.12.m6.1.1.3.cmml" type="integer" xref="S3.F3.12.m6.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.12.m6.1d">K=4</annotation><annotation encoding="application/x-llamapun" id="S3.F3.12.m6.1e">italic_K = 4</annotation></semantics></math> for the sake of illustration.
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.SS4.SSS1.p2">
<p class="ltx_p" id="S3.SS4.SSS1.p2.2">When modeling spoken language, relying on the tokenized text yields a much more compact representation than audio tokens:
Using the Mimi codec introduced in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS3" title="3.3 Audio Tokenization ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue">Section&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></span></a>, with <math alttext="Q=8" class="ltx_Math" display="inline" id="S3.SS4.SSS1.p2.1.m1.1"><semantics id="S3.SS4.SSS1.p2.1.m1.1a"><mrow id="S3.SS4.SSS1.p2.1.m1.1.1" xref="S3.SS4.SSS1.p2.1.m1.1.1.cmml"><mi id="S3.SS4.SSS1.p2.1.m1.1.1.2" xref="S3.SS4.SSS1.p2.1.m1.1.1.2.cmml">Q</mi><mo id="S3.SS4.SSS1.p2.1.m1.1.1.1" xref="S3.SS4.SSS1.p2.1.m1.1.1.1.cmml">=</mo><mn id="S3.SS4.SSS1.p2.1.m1.1.1.3" xref="S3.SS4.SSS1.p2.1.m1.1.1.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.p2.1.m1.1b"><apply id="S3.SS4.SSS1.p2.1.m1.1.1.cmml" xref="S3.SS4.SSS1.p2.1.m1.1.1"><eq id="S3.SS4.SSS1.p2.1.m1.1.1.1.cmml" xref="S3.SS4.SSS1.p2.1.m1.1.1.1"></eq><ci id="S3.SS4.SSS1.p2.1.m1.1.1.2.cmml" xref="S3.SS4.SSS1.p2.1.m1.1.1.2">𝑄</ci><cn id="S3.SS4.SSS1.p2.1.m1.1.1.3.cmml" type="integer" xref="S3.SS4.SSS1.p2.1.m1.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.p2.1.m1.1c">Q=8</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.p2.1.m1.1d">italic_Q = 8</annotation></semantics></math> codebooks at a frame rate of 12.5hz, one would require a sequence length of <math alttext="100" class="ltx_Math" display="inline" id="S3.SS4.SSS1.p2.2.m2.1"><semantics id="S3.SS4.SSS1.p2.2.m2.1a"><mn id="S3.SS4.SSS1.p2.2.m2.1.1" xref="S3.SS4.SSS1.p2.2.m2.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.p2.2.m2.1b"><cn id="S3.SS4.SSS1.p2.2.m2.1.1.cmml" type="integer" xref="S3.SS4.SSS1.p2.2.m2.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.p2.2.m2.1c">100</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.p2.2.m2.1d">100</annotation></semantics></math> steps per second of audio to generate. To model 5 minutes of audio, this would amount to 30,000 timesteps, which represents a significant computational cost and generating 100 tokens per second is incompatible with streaming inference. As a comparison, a sample of English speech can be represented with around 3 to 4 text tokens per second.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S3.SS4.SSS1.p3">
<p class="ltx_p" id="S3.SS4.SSS1.p3.13">We are interested in modeling not just a single sequence <math alttext="(U_{s})" class="ltx_Math" display="inline" id="S3.SS4.SSS1.p3.1.m1.1"><semantics id="S3.SS4.SSS1.p3.1.m1.1a"><mrow id="S3.SS4.SSS1.p3.1.m1.1.1.1" xref="S3.SS4.SSS1.p3.1.m1.1.1.1.1.cmml"><mo id="S3.SS4.SSS1.p3.1.m1.1.1.1.2" stretchy="false" xref="S3.SS4.SSS1.p3.1.m1.1.1.1.1.cmml">(</mo><msub id="S3.SS4.SSS1.p3.1.m1.1.1.1.1" xref="S3.SS4.SSS1.p3.1.m1.1.1.1.1.cmml"><mi id="S3.SS4.SSS1.p3.1.m1.1.1.1.1.2" xref="S3.SS4.SSS1.p3.1.m1.1.1.1.1.2.cmml">U</mi><mi id="S3.SS4.SSS1.p3.1.m1.1.1.1.1.3" xref="S3.SS4.SSS1.p3.1.m1.1.1.1.1.3.cmml">s</mi></msub><mo id="S3.SS4.SSS1.p3.1.m1.1.1.1.3" stretchy="false" xref="S3.SS4.SSS1.p3.1.m1.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.p3.1.m1.1b"><apply id="S3.SS4.SSS1.p3.1.m1.1.1.1.1.cmml" xref="S3.SS4.SSS1.p3.1.m1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS1.p3.1.m1.1.1.1.1.1.cmml" xref="S3.SS4.SSS1.p3.1.m1.1.1.1">subscript</csymbol><ci id="S3.SS4.SSS1.p3.1.m1.1.1.1.1.2.cmml" xref="S3.SS4.SSS1.p3.1.m1.1.1.1.1.2">𝑈</ci><ci id="S3.SS4.SSS1.p3.1.m1.1.1.1.1.3.cmml" xref="S3.SS4.SSS1.p3.1.m1.1.1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.p3.1.m1.1c">(U_{s})</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.p3.1.m1.1d">( italic_U start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT )</annotation></semantics></math>, but multiple sub-sequences, e.g. different audio codebooks, along with an optional text stream. We can stack those sub-sequences as <math alttext="V_{s,k}" class="ltx_Math" display="inline" id="S3.SS4.SSS1.p3.2.m2.2"><semantics id="S3.SS4.SSS1.p3.2.m2.2a"><msub id="S3.SS4.SSS1.p3.2.m2.2.3" xref="S3.SS4.SSS1.p3.2.m2.2.3.cmml"><mi id="S3.SS4.SSS1.p3.2.m2.2.3.2" xref="S3.SS4.SSS1.p3.2.m2.2.3.2.cmml">V</mi><mrow id="S3.SS4.SSS1.p3.2.m2.2.2.2.4" xref="S3.SS4.SSS1.p3.2.m2.2.2.2.3.cmml"><mi id="S3.SS4.SSS1.p3.2.m2.1.1.1.1" xref="S3.SS4.SSS1.p3.2.m2.1.1.1.1.cmml">s</mi><mo id="S3.SS4.SSS1.p3.2.m2.2.2.2.4.1" xref="S3.SS4.SSS1.p3.2.m2.2.2.2.3.cmml">,</mo><mi id="S3.SS4.SSS1.p3.2.m2.2.2.2.2" xref="S3.SS4.SSS1.p3.2.m2.2.2.2.2.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.p3.2.m2.2b"><apply id="S3.SS4.SSS1.p3.2.m2.2.3.cmml" xref="S3.SS4.SSS1.p3.2.m2.2.3"><csymbol cd="ambiguous" id="S3.SS4.SSS1.p3.2.m2.2.3.1.cmml" xref="S3.SS4.SSS1.p3.2.m2.2.3">subscript</csymbol><ci id="S3.SS4.SSS1.p3.2.m2.2.3.2.cmml" xref="S3.SS4.SSS1.p3.2.m2.2.3.2">𝑉</ci><list id="S3.SS4.SSS1.p3.2.m2.2.2.2.3.cmml" xref="S3.SS4.SSS1.p3.2.m2.2.2.2.4"><ci id="S3.SS4.SSS1.p3.2.m2.1.1.1.1.cmml" xref="S3.SS4.SSS1.p3.2.m2.1.1.1.1">𝑠</ci><ci id="S3.SS4.SSS1.p3.2.m2.2.2.2.2.cmml" xref="S3.SS4.SSS1.p3.2.m2.2.2.2.2">𝑘</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.p3.2.m2.2c">V_{s,k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.p3.2.m2.2d">italic_V start_POSTSUBSCRIPT italic_s , italic_k end_POSTSUBSCRIPT</annotation></semantics></math> for <math alttext="1\leq s\leq S" class="ltx_Math" display="inline" id="S3.SS4.SSS1.p3.3.m3.1"><semantics id="S3.SS4.SSS1.p3.3.m3.1a"><mrow id="S3.SS4.SSS1.p3.3.m3.1.1" xref="S3.SS4.SSS1.p3.3.m3.1.1.cmml"><mn id="S3.SS4.SSS1.p3.3.m3.1.1.2" xref="S3.SS4.SSS1.p3.3.m3.1.1.2.cmml">1</mn><mo id="S3.SS4.SSS1.p3.3.m3.1.1.3" xref="S3.SS4.SSS1.p3.3.m3.1.1.3.cmml">≤</mo><mi id="S3.SS4.SSS1.p3.3.m3.1.1.4" xref="S3.SS4.SSS1.p3.3.m3.1.1.4.cmml">s</mi><mo id="S3.SS4.SSS1.p3.3.m3.1.1.5" xref="S3.SS4.SSS1.p3.3.m3.1.1.5.cmml">≤</mo><mi id="S3.SS4.SSS1.p3.3.m3.1.1.6" xref="S3.SS4.SSS1.p3.3.m3.1.1.6.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.p3.3.m3.1b"><apply id="S3.SS4.SSS1.p3.3.m3.1.1.cmml" xref="S3.SS4.SSS1.p3.3.m3.1.1"><and id="S3.SS4.SSS1.p3.3.m3.1.1a.cmml" xref="S3.SS4.SSS1.p3.3.m3.1.1"></and><apply id="S3.SS4.SSS1.p3.3.m3.1.1b.cmml" xref="S3.SS4.SSS1.p3.3.m3.1.1"><leq id="S3.SS4.SSS1.p3.3.m3.1.1.3.cmml" xref="S3.SS4.SSS1.p3.3.m3.1.1.3"></leq><cn id="S3.SS4.SSS1.p3.3.m3.1.1.2.cmml" type="integer" xref="S3.SS4.SSS1.p3.3.m3.1.1.2">1</cn><ci id="S3.SS4.SSS1.p3.3.m3.1.1.4.cmml" xref="S3.SS4.SSS1.p3.3.m3.1.1.4">𝑠</ci></apply><apply id="S3.SS4.SSS1.p3.3.m3.1.1c.cmml" xref="S3.SS4.SSS1.p3.3.m3.1.1"><leq id="S3.SS4.SSS1.p3.3.m3.1.1.5.cmml" xref="S3.SS4.SSS1.p3.3.m3.1.1.5"></leq><share href="https://arxiv.org/html/2410.00037v2#S3.SS4.SSS1.p3.3.m3.1.1.4.cmml" id="S3.SS4.SSS1.p3.3.m3.1.1d.cmml" xref="S3.SS4.SSS1.p3.3.m3.1.1"></share><ci id="S3.SS4.SSS1.p3.3.m3.1.1.6.cmml" xref="S3.SS4.SSS1.p3.3.m3.1.1.6">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.p3.3.m3.1c">1\leq s\leq S</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.p3.3.m3.1d">1 ≤ italic_s ≤ italic_S</annotation></semantics></math> and <math alttext="1\leq k\leq K" class="ltx_Math" display="inline" id="S3.SS4.SSS1.p3.4.m4.1"><semantics id="S3.SS4.SSS1.p3.4.m4.1a"><mrow id="S3.SS4.SSS1.p3.4.m4.1.1" xref="S3.SS4.SSS1.p3.4.m4.1.1.cmml"><mn id="S3.SS4.SSS1.p3.4.m4.1.1.2" xref="S3.SS4.SSS1.p3.4.m4.1.1.2.cmml">1</mn><mo id="S3.SS4.SSS1.p3.4.m4.1.1.3" xref="S3.SS4.SSS1.p3.4.m4.1.1.3.cmml">≤</mo><mi id="S3.SS4.SSS1.p3.4.m4.1.1.4" xref="S3.SS4.SSS1.p3.4.m4.1.1.4.cmml">k</mi><mo id="S3.SS4.SSS1.p3.4.m4.1.1.5" xref="S3.SS4.SSS1.p3.4.m4.1.1.5.cmml">≤</mo><mi id="S3.SS4.SSS1.p3.4.m4.1.1.6" xref="S3.SS4.SSS1.p3.4.m4.1.1.6.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.p3.4.m4.1b"><apply id="S3.SS4.SSS1.p3.4.m4.1.1.cmml" xref="S3.SS4.SSS1.p3.4.m4.1.1"><and id="S3.SS4.SSS1.p3.4.m4.1.1a.cmml" xref="S3.SS4.SSS1.p3.4.m4.1.1"></and><apply id="S3.SS4.SSS1.p3.4.m4.1.1b.cmml" xref="S3.SS4.SSS1.p3.4.m4.1.1"><leq id="S3.SS4.SSS1.p3.4.m4.1.1.3.cmml" xref="S3.SS4.SSS1.p3.4.m4.1.1.3"></leq><cn id="S3.SS4.SSS1.p3.4.m4.1.1.2.cmml" type="integer" xref="S3.SS4.SSS1.p3.4.m4.1.1.2">1</cn><ci id="S3.SS4.SSS1.p3.4.m4.1.1.4.cmml" xref="S3.SS4.SSS1.p3.4.m4.1.1.4">𝑘</ci></apply><apply id="S3.SS4.SSS1.p3.4.m4.1.1c.cmml" xref="S3.SS4.SSS1.p3.4.m4.1.1"><leq id="S3.SS4.SSS1.p3.4.m4.1.1.5.cmml" xref="S3.SS4.SSS1.p3.4.m4.1.1.5"></leq><share href="https://arxiv.org/html/2410.00037v2#S3.SS4.SSS1.p3.4.m4.1.1.4.cmml" id="S3.SS4.SSS1.p3.4.m4.1.1d.cmml" xref="S3.SS4.SSS1.p3.4.m4.1.1"></share><ci id="S3.SS4.SSS1.p3.4.m4.1.1.6.cmml" xref="S3.SS4.SSS1.p3.4.m4.1.1.6">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.p3.4.m4.1c">1\leq k\leq K</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.p3.4.m4.1d">1 ≤ italic_k ≤ italic_K</annotation></semantics></math>.
Similarly, we define <math alttext="V_{0,k}=0" class="ltx_Math" display="inline" id="S3.SS4.SSS1.p3.5.m5.2"><semantics id="S3.SS4.SSS1.p3.5.m5.2a"><mrow id="S3.SS4.SSS1.p3.5.m5.2.3" xref="S3.SS4.SSS1.p3.5.m5.2.3.cmml"><msub id="S3.SS4.SSS1.p3.5.m5.2.3.2" xref="S3.SS4.SSS1.p3.5.m5.2.3.2.cmml"><mi id="S3.SS4.SSS1.p3.5.m5.2.3.2.2" xref="S3.SS4.SSS1.p3.5.m5.2.3.2.2.cmml">V</mi><mrow id="S3.SS4.SSS1.p3.5.m5.2.2.2.4" xref="S3.SS4.SSS1.p3.5.m5.2.2.2.3.cmml"><mn id="S3.SS4.SSS1.p3.5.m5.1.1.1.1" xref="S3.SS4.SSS1.p3.5.m5.1.1.1.1.cmml">0</mn><mo id="S3.SS4.SSS1.p3.5.m5.2.2.2.4.1" xref="S3.SS4.SSS1.p3.5.m5.2.2.2.3.cmml">,</mo><mi id="S3.SS4.SSS1.p3.5.m5.2.2.2.2" xref="S3.SS4.SSS1.p3.5.m5.2.2.2.2.cmml">k</mi></mrow></msub><mo id="S3.SS4.SSS1.p3.5.m5.2.3.1" xref="S3.SS4.SSS1.p3.5.m5.2.3.1.cmml">=</mo><mn id="S3.SS4.SSS1.p3.5.m5.2.3.3" xref="S3.SS4.SSS1.p3.5.m5.2.3.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.p3.5.m5.2b"><apply id="S3.SS4.SSS1.p3.5.m5.2.3.cmml" xref="S3.SS4.SSS1.p3.5.m5.2.3"><eq id="S3.SS4.SSS1.p3.5.m5.2.3.1.cmml" xref="S3.SS4.SSS1.p3.5.m5.2.3.1"></eq><apply id="S3.SS4.SSS1.p3.5.m5.2.3.2.cmml" xref="S3.SS4.SSS1.p3.5.m5.2.3.2"><csymbol cd="ambiguous" id="S3.SS4.SSS1.p3.5.m5.2.3.2.1.cmml" xref="S3.SS4.SSS1.p3.5.m5.2.3.2">subscript</csymbol><ci id="S3.SS4.SSS1.p3.5.m5.2.3.2.2.cmml" xref="S3.SS4.SSS1.p3.5.m5.2.3.2.2">𝑉</ci><list id="S3.SS4.SSS1.p3.5.m5.2.2.2.3.cmml" xref="S3.SS4.SSS1.p3.5.m5.2.2.2.4"><cn id="S3.SS4.SSS1.p3.5.m5.1.1.1.1.cmml" type="integer" xref="S3.SS4.SSS1.p3.5.m5.1.1.1.1">0</cn><ci id="S3.SS4.SSS1.p3.5.m5.2.2.2.2.cmml" xref="S3.SS4.SSS1.p3.5.m5.2.2.2.2">𝑘</ci></list></apply><cn id="S3.SS4.SSS1.p3.5.m5.2.3.3.cmml" type="integer" xref="S3.SS4.SSS1.p3.5.m5.2.3.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.p3.5.m5.2c">V_{0,k}=0</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.p3.5.m5.2d">italic_V start_POSTSUBSCRIPT 0 , italic_k end_POSTSUBSCRIPT = 0</annotation></semantics></math>, a deterministic initial token value for all sub-sequences.
For each <math alttext="1\leq s\leq S" class="ltx_Math" display="inline" id="S3.SS4.SSS1.p3.6.m6.1"><semantics id="S3.SS4.SSS1.p3.6.m6.1a"><mrow id="S3.SS4.SSS1.p3.6.m6.1.1" xref="S3.SS4.SSS1.p3.6.m6.1.1.cmml"><mn id="S3.SS4.SSS1.p3.6.m6.1.1.2" xref="S3.SS4.SSS1.p3.6.m6.1.1.2.cmml">1</mn><mo id="S3.SS4.SSS1.p3.6.m6.1.1.3" xref="S3.SS4.SSS1.p3.6.m6.1.1.3.cmml">≤</mo><mi id="S3.SS4.SSS1.p3.6.m6.1.1.4" xref="S3.SS4.SSS1.p3.6.m6.1.1.4.cmml">s</mi><mo id="S3.SS4.SSS1.p3.6.m6.1.1.5" xref="S3.SS4.SSS1.p3.6.m6.1.1.5.cmml">≤</mo><mi id="S3.SS4.SSS1.p3.6.m6.1.1.6" xref="S3.SS4.SSS1.p3.6.m6.1.1.6.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.p3.6.m6.1b"><apply id="S3.SS4.SSS1.p3.6.m6.1.1.cmml" xref="S3.SS4.SSS1.p3.6.m6.1.1"><and id="S3.SS4.SSS1.p3.6.m6.1.1a.cmml" xref="S3.SS4.SSS1.p3.6.m6.1.1"></and><apply id="S3.SS4.SSS1.p3.6.m6.1.1b.cmml" xref="S3.SS4.SSS1.p3.6.m6.1.1"><leq id="S3.SS4.SSS1.p3.6.m6.1.1.3.cmml" xref="S3.SS4.SSS1.p3.6.m6.1.1.3"></leq><cn id="S3.SS4.SSS1.p3.6.m6.1.1.2.cmml" type="integer" xref="S3.SS4.SSS1.p3.6.m6.1.1.2">1</cn><ci id="S3.SS4.SSS1.p3.6.m6.1.1.4.cmml" xref="S3.SS4.SSS1.p3.6.m6.1.1.4">𝑠</ci></apply><apply id="S3.SS4.SSS1.p3.6.m6.1.1c.cmml" xref="S3.SS4.SSS1.p3.6.m6.1.1"><leq id="S3.SS4.SSS1.p3.6.m6.1.1.5.cmml" xref="S3.SS4.SSS1.p3.6.m6.1.1.5"></leq><share href="https://arxiv.org/html/2410.00037v2#S3.SS4.SSS1.p3.6.m6.1.1.4.cmml" id="S3.SS4.SSS1.p3.6.m6.1.1d.cmml" xref="S3.SS4.SSS1.p3.6.m6.1.1"></share><ci id="S3.SS4.SSS1.p3.6.m6.1.1.6.cmml" xref="S3.SS4.SSS1.p3.6.m6.1.1.6">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.p3.6.m6.1c">1\leq s\leq S</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.p3.6.m6.1d">1 ≤ italic_s ≤ italic_S</annotation></semantics></math> and <math alttext="1\leq k\leq K" class="ltx_Math" display="inline" id="S3.SS4.SSS1.p3.7.m7.1"><semantics id="S3.SS4.SSS1.p3.7.m7.1a"><mrow id="S3.SS4.SSS1.p3.7.m7.1.1" xref="S3.SS4.SSS1.p3.7.m7.1.1.cmml"><mn id="S3.SS4.SSS1.p3.7.m7.1.1.2" xref="S3.SS4.SSS1.p3.7.m7.1.1.2.cmml">1</mn><mo id="S3.SS4.SSS1.p3.7.m7.1.1.3" xref="S3.SS4.SSS1.p3.7.m7.1.1.3.cmml">≤</mo><mi id="S3.SS4.SSS1.p3.7.m7.1.1.4" xref="S3.SS4.SSS1.p3.7.m7.1.1.4.cmml">k</mi><mo id="S3.SS4.SSS1.p3.7.m7.1.1.5" xref="S3.SS4.SSS1.p3.7.m7.1.1.5.cmml">≤</mo><mi id="S3.SS4.SSS1.p3.7.m7.1.1.6" xref="S3.SS4.SSS1.p3.7.m7.1.1.6.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.p3.7.m7.1b"><apply id="S3.SS4.SSS1.p3.7.m7.1.1.cmml" xref="S3.SS4.SSS1.p3.7.m7.1.1"><and id="S3.SS4.SSS1.p3.7.m7.1.1a.cmml" xref="S3.SS4.SSS1.p3.7.m7.1.1"></and><apply id="S3.SS4.SSS1.p3.7.m7.1.1b.cmml" xref="S3.SS4.SSS1.p3.7.m7.1.1"><leq id="S3.SS4.SSS1.p3.7.m7.1.1.3.cmml" xref="S3.SS4.SSS1.p3.7.m7.1.1.3"></leq><cn id="S3.SS4.SSS1.p3.7.m7.1.1.2.cmml" type="integer" xref="S3.SS4.SSS1.p3.7.m7.1.1.2">1</cn><ci id="S3.SS4.SSS1.p3.7.m7.1.1.4.cmml" xref="S3.SS4.SSS1.p3.7.m7.1.1.4">𝑘</ci></apply><apply id="S3.SS4.SSS1.p3.7.m7.1.1c.cmml" xref="S3.SS4.SSS1.p3.7.m7.1.1"><leq id="S3.SS4.SSS1.p3.7.m7.1.1.5.cmml" xref="S3.SS4.SSS1.p3.7.m7.1.1.5"></leq><share href="https://arxiv.org/html/2410.00037v2#S3.SS4.SSS1.p3.7.m7.1.1.4.cmml" id="S3.SS4.SSS1.p3.7.m7.1.1d.cmml" xref="S3.SS4.SSS1.p3.7.m7.1.1"></share><ci id="S3.SS4.SSS1.p3.7.m7.1.1.6.cmml" xref="S3.SS4.SSS1.p3.7.m7.1.1.6">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.p3.7.m7.1c">1\leq k\leq K</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.p3.7.m7.1d">1 ≤ italic_k ≤ italic_K</annotation></semantics></math>, <math alttext="V_{s,k}\in\{1,\ldots,N_{k}\}" class="ltx_Math" display="inline" id="S3.SS4.SSS1.p3.8.m8.5"><semantics id="S3.SS4.SSS1.p3.8.m8.5a"><mrow id="S3.SS4.SSS1.p3.8.m8.5.5" xref="S3.SS4.SSS1.p3.8.m8.5.5.cmml"><msub id="S3.SS4.SSS1.p3.8.m8.5.5.3" xref="S3.SS4.SSS1.p3.8.m8.5.5.3.cmml"><mi id="S3.SS4.SSS1.p3.8.m8.5.5.3.2" xref="S3.SS4.SSS1.p3.8.m8.5.5.3.2.cmml">V</mi><mrow id="S3.SS4.SSS1.p3.8.m8.2.2.2.4" xref="S3.SS4.SSS1.p3.8.m8.2.2.2.3.cmml"><mi id="S3.SS4.SSS1.p3.8.m8.1.1.1.1" xref="S3.SS4.SSS1.p3.8.m8.1.1.1.1.cmml">s</mi><mo id="S3.SS4.SSS1.p3.8.m8.2.2.2.4.1" xref="S3.SS4.SSS1.p3.8.m8.2.2.2.3.cmml">,</mo><mi id="S3.SS4.SSS1.p3.8.m8.2.2.2.2" xref="S3.SS4.SSS1.p3.8.m8.2.2.2.2.cmml">k</mi></mrow></msub><mo id="S3.SS4.SSS1.p3.8.m8.5.5.2" xref="S3.SS4.SSS1.p3.8.m8.5.5.2.cmml">∈</mo><mrow id="S3.SS4.SSS1.p3.8.m8.5.5.1.1" xref="S3.SS4.SSS1.p3.8.m8.5.5.1.2.cmml"><mo id="S3.SS4.SSS1.p3.8.m8.5.5.1.1.2" stretchy="false" xref="S3.SS4.SSS1.p3.8.m8.5.5.1.2.cmml">{</mo><mn id="S3.SS4.SSS1.p3.8.m8.3.3" xref="S3.SS4.SSS1.p3.8.m8.3.3.cmml">1</mn><mo id="S3.SS4.SSS1.p3.8.m8.5.5.1.1.3" xref="S3.SS4.SSS1.p3.8.m8.5.5.1.2.cmml">,</mo><mi id="S3.SS4.SSS1.p3.8.m8.4.4" mathvariant="normal" xref="S3.SS4.SSS1.p3.8.m8.4.4.cmml">…</mi><mo id="S3.SS4.SSS1.p3.8.m8.5.5.1.1.4" xref="S3.SS4.SSS1.p3.8.m8.5.5.1.2.cmml">,</mo><msub id="S3.SS4.SSS1.p3.8.m8.5.5.1.1.1" xref="S3.SS4.SSS1.p3.8.m8.5.5.1.1.1.cmml"><mi id="S3.SS4.SSS1.p3.8.m8.5.5.1.1.1.2" xref="S3.SS4.SSS1.p3.8.m8.5.5.1.1.1.2.cmml">N</mi><mi id="S3.SS4.SSS1.p3.8.m8.5.5.1.1.1.3" xref="S3.SS4.SSS1.p3.8.m8.5.5.1.1.1.3.cmml">k</mi></msub><mo id="S3.SS4.SSS1.p3.8.m8.5.5.1.1.5" stretchy="false" xref="S3.SS4.SSS1.p3.8.m8.5.5.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.p3.8.m8.5b"><apply id="S3.SS4.SSS1.p3.8.m8.5.5.cmml" xref="S3.SS4.SSS1.p3.8.m8.5.5"><in id="S3.SS4.SSS1.p3.8.m8.5.5.2.cmml" xref="S3.SS4.SSS1.p3.8.m8.5.5.2"></in><apply id="S3.SS4.SSS1.p3.8.m8.5.5.3.cmml" xref="S3.SS4.SSS1.p3.8.m8.5.5.3"><csymbol cd="ambiguous" id="S3.SS4.SSS1.p3.8.m8.5.5.3.1.cmml" xref="S3.SS4.SSS1.p3.8.m8.5.5.3">subscript</csymbol><ci id="S3.SS4.SSS1.p3.8.m8.5.5.3.2.cmml" xref="S3.SS4.SSS1.p3.8.m8.5.5.3.2">𝑉</ci><list id="S3.SS4.SSS1.p3.8.m8.2.2.2.3.cmml" xref="S3.SS4.SSS1.p3.8.m8.2.2.2.4"><ci id="S3.SS4.SSS1.p3.8.m8.1.1.1.1.cmml" xref="S3.SS4.SSS1.p3.8.m8.1.1.1.1">𝑠</ci><ci id="S3.SS4.SSS1.p3.8.m8.2.2.2.2.cmml" xref="S3.SS4.SSS1.p3.8.m8.2.2.2.2">𝑘</ci></list></apply><set id="S3.SS4.SSS1.p3.8.m8.5.5.1.2.cmml" xref="S3.SS4.SSS1.p3.8.m8.5.5.1.1"><cn id="S3.SS4.SSS1.p3.8.m8.3.3.cmml" type="integer" xref="S3.SS4.SSS1.p3.8.m8.3.3">1</cn><ci id="S3.SS4.SSS1.p3.8.m8.4.4.cmml" xref="S3.SS4.SSS1.p3.8.m8.4.4">…</ci><apply id="S3.SS4.SSS1.p3.8.m8.5.5.1.1.1.cmml" xref="S3.SS4.SSS1.p3.8.m8.5.5.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS1.p3.8.m8.5.5.1.1.1.1.cmml" xref="S3.SS4.SSS1.p3.8.m8.5.5.1.1.1">subscript</csymbol><ci id="S3.SS4.SSS1.p3.8.m8.5.5.1.1.1.2.cmml" xref="S3.SS4.SSS1.p3.8.m8.5.5.1.1.1.2">𝑁</ci><ci id="S3.SS4.SSS1.p3.8.m8.5.5.1.1.1.3.cmml" xref="S3.SS4.SSS1.p3.8.m8.5.5.1.1.1.3">𝑘</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.p3.8.m8.5c">V_{s,k}\in\{1,\ldots,N_{k}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.p3.8.m8.5d">italic_V start_POSTSUBSCRIPT italic_s , italic_k end_POSTSUBSCRIPT ∈ { 1 , … , italic_N start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT }</annotation></semantics></math>, where <math alttext="N_{k}" class="ltx_Math" display="inline" id="S3.SS4.SSS1.p3.9.m9.1"><semantics id="S3.SS4.SSS1.p3.9.m9.1a"><msub id="S3.SS4.SSS1.p3.9.m9.1.1" xref="S3.SS4.SSS1.p3.9.m9.1.1.cmml"><mi id="S3.SS4.SSS1.p3.9.m9.1.1.2" xref="S3.SS4.SSS1.p3.9.m9.1.1.2.cmml">N</mi><mi id="S3.SS4.SSS1.p3.9.m9.1.1.3" xref="S3.SS4.SSS1.p3.9.m9.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.p3.9.m9.1b"><apply id="S3.SS4.SSS1.p3.9.m9.1.1.cmml" xref="S3.SS4.SSS1.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS1.p3.9.m9.1.1.1.cmml" xref="S3.SS4.SSS1.p3.9.m9.1.1">subscript</csymbol><ci id="S3.SS4.SSS1.p3.9.m9.1.1.2.cmml" xref="S3.SS4.SSS1.p3.9.m9.1.1.2">𝑁</ci><ci id="S3.SS4.SSS1.p3.9.m9.1.1.3.cmml" xref="S3.SS4.SSS1.p3.9.m9.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.p3.9.m9.1c">N_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.p3.9.m9.1d">italic_N start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> is the cardinality of the <math alttext="k" class="ltx_Math" display="inline" id="S3.SS4.SSS1.p3.10.m10.1"><semantics id="S3.SS4.SSS1.p3.10.m10.1a"><mi id="S3.SS4.SSS1.p3.10.m10.1.1" xref="S3.SS4.SSS1.p3.10.m10.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.p3.10.m10.1b"><ci id="S3.SS4.SSS1.p3.10.m10.1.1.cmml" xref="S3.SS4.SSS1.p3.10.m10.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.p3.10.m10.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.p3.10.m10.1d">italic_k</annotation></semantics></math>-th sub-sequence. One can <em class="ltx_emph ltx_font_italic" id="S3.SS4.SSS1.p3.13.1">flatten</em> the <math alttext="K" class="ltx_Math" display="inline" id="S3.SS4.SSS1.p3.11.m11.1"><semantics id="S3.SS4.SSS1.p3.11.m11.1a"><mi id="S3.SS4.SSS1.p3.11.m11.1.1" xref="S3.SS4.SSS1.p3.11.m11.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.p3.11.m11.1b"><ci id="S3.SS4.SSS1.p3.11.m11.1.1.cmml" xref="S3.SS4.SSS1.p3.11.m11.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.p3.11.m11.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.p3.11.m11.1d">italic_K</annotation></semantics></math> sequences into a single one, increasing the number of predictions by <math alttext="K" class="ltx_Math" display="inline" id="S3.SS4.SSS1.p3.12.m12.1"><semantics id="S3.SS4.SSS1.p3.12.m12.1a"><mi id="S3.SS4.SSS1.p3.12.m12.1.1" xref="S3.SS4.SSS1.p3.12.m12.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.p3.12.m12.1b"><ci id="S3.SS4.SSS1.p3.12.m12.1.1.cmml" xref="S3.SS4.SSS1.p3.12.m12.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.p3.12.m12.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.p3.12.m12.1d">italic_K</annotation></semantics></math>.
<cite class="ltx_cite ltx_citemacro_citet">Lee et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib55" title="">2022</a>)</cite> propose using a smaller autoregressive model along the dimension <math alttext="K" class="ltx_Math" display="inline" id="S3.SS4.SSS1.p3.13.m13.1"><semantics id="S3.SS4.SSS1.p3.13.m13.1a"><mi id="S3.SS4.SSS1.p3.13.m13.1.1" xref="S3.SS4.SSS1.p3.13.m13.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.p3.13.m13.1b"><ci id="S3.SS4.SSS1.p3.13.m13.1.1.cmml" xref="S3.SS4.SSS1.p3.13.m13.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.p3.13.m13.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.p3.13.m13.1d">italic_K</annotation></semantics></math>, combined with a larger model along the time dimension, forming a RQ-Transformer. Later, <cite class="ltx_cite ltx_citemacro_citet">Yu et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib107" title="">2024</a>)</cite> suggested a similar approach for byte-level modeling while <cite class="ltx_cite ltx_citemacro_citet">Yang et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib105" title="">2023</a>)</cite> and <cite class="ltx_cite ltx_citemacro_citet">Zhu et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib117" title="">2024</a>)</cite> applied it to audio token modeling.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_paragraph" id="S3.SS4.SSS1.Px1">
<h5 class="ltx_title ltx_title_paragraph">RQ-Transformer.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.SS4.SSS1.Px1.p1">
<p class="ltx_p" id="S3.SS4.SSS1.Px1.p1.7">Formally, the RQ-Transformer consists in two Transformer models, as illustrated in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.F3" title="Figure 3 ‣ 3.4.1 Hierarchical autoregressive modeling with RQ-Transformer ‣ 3.4 Generative Audio Modeling ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue">Figure&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></span></a>. It consists of a <em class="ltx_emph ltx_font_italic" id="S3.SS4.SSS1.Px1.p1.7.1">Temporal</em> Transformer, e.g. with the same architecture as the one described for Helium in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS2" title="3.2 The Helium Text Language Model ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue">Section&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></span></a>,
and a smaller <em class="ltx_emph ltx_font_italic" id="S3.SS4.SSS1.Px1.p1.7.2">Depth</em> Transformer.
We denote <math alttext="\mathrm{Tr}_{\mathrm{Temp}}" class="ltx_Math" display="inline" id="S3.SS4.SSS1.Px1.p1.1.m1.1"><semantics id="S3.SS4.SSS1.Px1.p1.1.m1.1a"><msub id="S3.SS4.SSS1.Px1.p1.1.m1.1.1" xref="S3.SS4.SSS1.Px1.p1.1.m1.1.1.cmml"><mi id="S3.SS4.SSS1.Px1.p1.1.m1.1.1.2" xref="S3.SS4.SSS1.Px1.p1.1.m1.1.1.2.cmml">Tr</mi><mi id="S3.SS4.SSS1.Px1.p1.1.m1.1.1.3" xref="S3.SS4.SSS1.Px1.p1.1.m1.1.1.3.cmml">Temp</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.Px1.p1.1.m1.1b"><apply id="S3.SS4.SSS1.Px1.p1.1.m1.1.1.cmml" xref="S3.SS4.SSS1.Px1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS1.Px1.p1.1.m1.1.1.1.cmml" xref="S3.SS4.SSS1.Px1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS4.SSS1.Px1.p1.1.m1.1.1.2.cmml" xref="S3.SS4.SSS1.Px1.p1.1.m1.1.1.2">Tr</ci><ci id="S3.SS4.SSS1.Px1.p1.1.m1.1.1.3.cmml" xref="S3.SS4.SSS1.Px1.p1.1.m1.1.1.3">Temp</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.Px1.p1.1.m1.1c">\mathrm{Tr}_{\mathrm{Temp}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.Px1.p1.1.m1.1d">roman_Tr start_POSTSUBSCRIPT roman_Temp end_POSTSUBSCRIPT</annotation></semantics></math> the function represented by the Temporal Transformer, and <math alttext="\mathrm{Tr}_{\mathrm{Depth}}" class="ltx_Math" display="inline" id="S3.SS4.SSS1.Px1.p1.2.m2.1"><semantics id="S3.SS4.SSS1.Px1.p1.2.m2.1a"><msub id="S3.SS4.SSS1.Px1.p1.2.m2.1.1" xref="S3.SS4.SSS1.Px1.p1.2.m2.1.1.cmml"><mi id="S3.SS4.SSS1.Px1.p1.2.m2.1.1.2" xref="S3.SS4.SSS1.Px1.p1.2.m2.1.1.2.cmml">Tr</mi><mi id="S3.SS4.SSS1.Px1.p1.2.m2.1.1.3" xref="S3.SS4.SSS1.Px1.p1.2.m2.1.1.3.cmml">Depth</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.Px1.p1.2.m2.1b"><apply id="S3.SS4.SSS1.Px1.p1.2.m2.1.1.cmml" xref="S3.SS4.SSS1.Px1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS1.Px1.p1.2.m2.1.1.1.cmml" xref="S3.SS4.SSS1.Px1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS4.SSS1.Px1.p1.2.m2.1.1.2.cmml" xref="S3.SS4.SSS1.Px1.p1.2.m2.1.1.2">Tr</ci><ci id="S3.SS4.SSS1.Px1.p1.2.m2.1.1.3.cmml" xref="S3.SS4.SSS1.Px1.p1.2.m2.1.1.3">Depth</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.Px1.p1.2.m2.1c">\mathrm{Tr}_{\mathrm{Depth}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.Px1.p1.2.m2.1d">roman_Tr start_POSTSUBSCRIPT roman_Depth end_POSTSUBSCRIPT</annotation></semantics></math> the one for the Depth Transformer.
For simplicity, and for all steps <math alttext="s\leq S" class="ltx_Math" display="inline" id="S3.SS4.SSS1.Px1.p1.3.m3.1"><semantics id="S3.SS4.SSS1.Px1.p1.3.m3.1a"><mrow id="S3.SS4.SSS1.Px1.p1.3.m3.1.1" xref="S3.SS4.SSS1.Px1.p1.3.m3.1.1.cmml"><mi id="S3.SS4.SSS1.Px1.p1.3.m3.1.1.2" xref="S3.SS4.SSS1.Px1.p1.3.m3.1.1.2.cmml">s</mi><mo id="S3.SS4.SSS1.Px1.p1.3.m3.1.1.1" xref="S3.SS4.SSS1.Px1.p1.3.m3.1.1.1.cmml">≤</mo><mi id="S3.SS4.SSS1.Px1.p1.3.m3.1.1.3" xref="S3.SS4.SSS1.Px1.p1.3.m3.1.1.3.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.Px1.p1.3.m3.1b"><apply id="S3.SS4.SSS1.Px1.p1.3.m3.1.1.cmml" xref="S3.SS4.SSS1.Px1.p1.3.m3.1.1"><leq id="S3.SS4.SSS1.Px1.p1.3.m3.1.1.1.cmml" xref="S3.SS4.SSS1.Px1.p1.3.m3.1.1.1"></leq><ci id="S3.SS4.SSS1.Px1.p1.3.m3.1.1.2.cmml" xref="S3.SS4.SSS1.Px1.p1.3.m3.1.1.2">𝑠</ci><ci id="S3.SS4.SSS1.Px1.p1.3.m3.1.1.3.cmml" xref="S3.SS4.SSS1.Px1.p1.3.m3.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.Px1.p1.3.m3.1c">s\leq S</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.Px1.p1.3.m3.1d">italic_s ≤ italic_S</annotation></semantics></math>, we denote <math alttext="V_{s}=(V_{s,1},\ldots,V_{s,K})" class="ltx_Math" display="inline" id="S3.SS4.SSS1.Px1.p1.4.m4.7"><semantics id="S3.SS4.SSS1.Px1.p1.4.m4.7a"><mrow id="S3.SS4.SSS1.Px1.p1.4.m4.7.7" xref="S3.SS4.SSS1.Px1.p1.4.m4.7.7.cmml"><msub id="S3.SS4.SSS1.Px1.p1.4.m4.7.7.4" xref="S3.SS4.SSS1.Px1.p1.4.m4.7.7.4.cmml"><mi id="S3.SS4.SSS1.Px1.p1.4.m4.7.7.4.2" xref="S3.SS4.SSS1.Px1.p1.4.m4.7.7.4.2.cmml">V</mi><mi id="S3.SS4.SSS1.Px1.p1.4.m4.7.7.4.3" xref="S3.SS4.SSS1.Px1.p1.4.m4.7.7.4.3.cmml">s</mi></msub><mo id="S3.SS4.SSS1.Px1.p1.4.m4.7.7.3" xref="S3.SS4.SSS1.Px1.p1.4.m4.7.7.3.cmml">=</mo><mrow id="S3.SS4.SSS1.Px1.p1.4.m4.7.7.2.2" xref="S3.SS4.SSS1.Px1.p1.4.m4.7.7.2.3.cmml"><mo id="S3.SS4.SSS1.Px1.p1.4.m4.7.7.2.2.3" stretchy="false" xref="S3.SS4.SSS1.Px1.p1.4.m4.7.7.2.3.cmml">(</mo><msub id="S3.SS4.SSS1.Px1.p1.4.m4.6.6.1.1.1" xref="S3.SS4.SSS1.Px1.p1.4.m4.6.6.1.1.1.cmml"><mi id="S3.SS4.SSS1.Px1.p1.4.m4.6.6.1.1.1.2" xref="S3.SS4.SSS1.Px1.p1.4.m4.6.6.1.1.1.2.cmml">V</mi><mrow id="S3.SS4.SSS1.Px1.p1.4.m4.2.2.2.4" xref="S3.SS4.SSS1.Px1.p1.4.m4.2.2.2.3.cmml"><mi id="S3.SS4.SSS1.Px1.p1.4.m4.1.1.1.1" xref="S3.SS4.SSS1.Px1.p1.4.m4.1.1.1.1.cmml">s</mi><mo id="S3.SS4.SSS1.Px1.p1.4.m4.2.2.2.4.1" xref="S3.SS4.SSS1.Px1.p1.4.m4.2.2.2.3.cmml">,</mo><mn id="S3.SS4.SSS1.Px1.p1.4.m4.2.2.2.2" xref="S3.SS4.SSS1.Px1.p1.4.m4.2.2.2.2.cmml">1</mn></mrow></msub><mo id="S3.SS4.SSS1.Px1.p1.4.m4.7.7.2.2.4" xref="S3.SS4.SSS1.Px1.p1.4.m4.7.7.2.3.cmml">,</mo><mi id="S3.SS4.SSS1.Px1.p1.4.m4.5.5" mathvariant="normal" xref="S3.SS4.SSS1.Px1.p1.4.m4.5.5.cmml">…</mi><mo id="S3.SS4.SSS1.Px1.p1.4.m4.7.7.2.2.5" xref="S3.SS4.SSS1.Px1.p1.4.m4.7.7.2.3.cmml">,</mo><msub id="S3.SS4.SSS1.Px1.p1.4.m4.7.7.2.2.2" xref="S3.SS4.SSS1.Px1.p1.4.m4.7.7.2.2.2.cmml"><mi id="S3.SS4.SSS1.Px1.p1.4.m4.7.7.2.2.2.2" xref="S3.SS4.SSS1.Px1.p1.4.m4.7.7.2.2.2.2.cmml">V</mi><mrow id="S3.SS4.SSS1.Px1.p1.4.m4.4.4.2.4" xref="S3.SS4.SSS1.Px1.p1.4.m4.4.4.2.3.cmml"><mi id="S3.SS4.SSS1.Px1.p1.4.m4.3.3.1.1" xref="S3.SS4.SSS1.Px1.p1.4.m4.3.3.1.1.cmml">s</mi><mo id="S3.SS4.SSS1.Px1.p1.4.m4.4.4.2.4.1" xref="S3.SS4.SSS1.Px1.p1.4.m4.4.4.2.3.cmml">,</mo><mi id="S3.SS4.SSS1.Px1.p1.4.m4.4.4.2.2" xref="S3.SS4.SSS1.Px1.p1.4.m4.4.4.2.2.cmml">K</mi></mrow></msub><mo id="S3.SS4.SSS1.Px1.p1.4.m4.7.7.2.2.6" stretchy="false" xref="S3.SS4.SSS1.Px1.p1.4.m4.7.7.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.Px1.p1.4.m4.7b"><apply id="S3.SS4.SSS1.Px1.p1.4.m4.7.7.cmml" xref="S3.SS4.SSS1.Px1.p1.4.m4.7.7"><eq id="S3.SS4.SSS1.Px1.p1.4.m4.7.7.3.cmml" xref="S3.SS4.SSS1.Px1.p1.4.m4.7.7.3"></eq><apply id="S3.SS4.SSS1.Px1.p1.4.m4.7.7.4.cmml" xref="S3.SS4.SSS1.Px1.p1.4.m4.7.7.4"><csymbol cd="ambiguous" id="S3.SS4.SSS1.Px1.p1.4.m4.7.7.4.1.cmml" xref="S3.SS4.SSS1.Px1.p1.4.m4.7.7.4">subscript</csymbol><ci id="S3.SS4.SSS1.Px1.p1.4.m4.7.7.4.2.cmml" xref="S3.SS4.SSS1.Px1.p1.4.m4.7.7.4.2">𝑉</ci><ci id="S3.SS4.SSS1.Px1.p1.4.m4.7.7.4.3.cmml" xref="S3.SS4.SSS1.Px1.p1.4.m4.7.7.4.3">𝑠</ci></apply><vector id="S3.SS4.SSS1.Px1.p1.4.m4.7.7.2.3.cmml" xref="S3.SS4.SSS1.Px1.p1.4.m4.7.7.2.2"><apply id="S3.SS4.SSS1.Px1.p1.4.m4.6.6.1.1.1.cmml" xref="S3.SS4.SSS1.Px1.p1.4.m4.6.6.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS1.Px1.p1.4.m4.6.6.1.1.1.1.cmml" xref="S3.SS4.SSS1.Px1.p1.4.m4.6.6.1.1.1">subscript</csymbol><ci id="S3.SS4.SSS1.Px1.p1.4.m4.6.6.1.1.1.2.cmml" xref="S3.SS4.SSS1.Px1.p1.4.m4.6.6.1.1.1.2">𝑉</ci><list id="S3.SS4.SSS1.Px1.p1.4.m4.2.2.2.3.cmml" xref="S3.SS4.SSS1.Px1.p1.4.m4.2.2.2.4"><ci id="S3.SS4.SSS1.Px1.p1.4.m4.1.1.1.1.cmml" xref="S3.SS4.SSS1.Px1.p1.4.m4.1.1.1.1">𝑠</ci><cn id="S3.SS4.SSS1.Px1.p1.4.m4.2.2.2.2.cmml" type="integer" xref="S3.SS4.SSS1.Px1.p1.4.m4.2.2.2.2">1</cn></list></apply><ci id="S3.SS4.SSS1.Px1.p1.4.m4.5.5.cmml" xref="S3.SS4.SSS1.Px1.p1.4.m4.5.5">…</ci><apply id="S3.SS4.SSS1.Px1.p1.4.m4.7.7.2.2.2.cmml" xref="S3.SS4.SSS1.Px1.p1.4.m4.7.7.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.SSS1.Px1.p1.4.m4.7.7.2.2.2.1.cmml" xref="S3.SS4.SSS1.Px1.p1.4.m4.7.7.2.2.2">subscript</csymbol><ci id="S3.SS4.SSS1.Px1.p1.4.m4.7.7.2.2.2.2.cmml" xref="S3.SS4.SSS1.Px1.p1.4.m4.7.7.2.2.2.2">𝑉</ci><list id="S3.SS4.SSS1.Px1.p1.4.m4.4.4.2.3.cmml" xref="S3.SS4.SSS1.Px1.p1.4.m4.4.4.2.4"><ci id="S3.SS4.SSS1.Px1.p1.4.m4.3.3.1.1.cmml" xref="S3.SS4.SSS1.Px1.p1.4.m4.3.3.1.1">𝑠</ci><ci id="S3.SS4.SSS1.Px1.p1.4.m4.4.4.2.2.cmml" xref="S3.SS4.SSS1.Px1.p1.4.m4.4.4.2.2">𝐾</ci></list></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.Px1.p1.4.m4.7c">V_{s}=(V_{s,1},\ldots,V_{s,K})</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.Px1.p1.4.m4.7d">italic_V start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT = ( italic_V start_POSTSUBSCRIPT italic_s , 1 end_POSTSUBSCRIPT , … , italic_V start_POSTSUBSCRIPT italic_s , italic_K end_POSTSUBSCRIPT )</annotation></semantics></math> the joint value of all sub-sequences at step <math alttext="s" class="ltx_Math" display="inline" id="S3.SS4.SSS1.Px1.p1.5.m5.1"><semantics id="S3.SS4.SSS1.Px1.p1.5.m5.1a"><mi id="S3.SS4.SSS1.Px1.p1.5.m5.1.1" xref="S3.SS4.SSS1.Px1.p1.5.m5.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.Px1.p1.5.m5.1b"><ci id="S3.SS4.SSS1.Px1.p1.5.m5.1.1.cmml" xref="S3.SS4.SSS1.Px1.p1.5.m5.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.Px1.p1.5.m5.1c">s</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.Px1.p1.5.m5.1d">italic_s</annotation></semantics></math>.
For a given sequence step <math alttext="1\leq s\leq S" class="ltx_Math" display="inline" id="S3.SS4.SSS1.Px1.p1.6.m6.1"><semantics id="S3.SS4.SSS1.Px1.p1.6.m6.1a"><mrow id="S3.SS4.SSS1.Px1.p1.6.m6.1.1" xref="S3.SS4.SSS1.Px1.p1.6.m6.1.1.cmml"><mn id="S3.SS4.SSS1.Px1.p1.6.m6.1.1.2" xref="S3.SS4.SSS1.Px1.p1.6.m6.1.1.2.cmml">1</mn><mo id="S3.SS4.SSS1.Px1.p1.6.m6.1.1.3" xref="S3.SS4.SSS1.Px1.p1.6.m6.1.1.3.cmml">≤</mo><mi id="S3.SS4.SSS1.Px1.p1.6.m6.1.1.4" xref="S3.SS4.SSS1.Px1.p1.6.m6.1.1.4.cmml">s</mi><mo id="S3.SS4.SSS1.Px1.p1.6.m6.1.1.5" xref="S3.SS4.SSS1.Px1.p1.6.m6.1.1.5.cmml">≤</mo><mi id="S3.SS4.SSS1.Px1.p1.6.m6.1.1.6" xref="S3.SS4.SSS1.Px1.p1.6.m6.1.1.6.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.Px1.p1.6.m6.1b"><apply id="S3.SS4.SSS1.Px1.p1.6.m6.1.1.cmml" xref="S3.SS4.SSS1.Px1.p1.6.m6.1.1"><and id="S3.SS4.SSS1.Px1.p1.6.m6.1.1a.cmml" xref="S3.SS4.SSS1.Px1.p1.6.m6.1.1"></and><apply id="S3.SS4.SSS1.Px1.p1.6.m6.1.1b.cmml" xref="S3.SS4.SSS1.Px1.p1.6.m6.1.1"><leq id="S3.SS4.SSS1.Px1.p1.6.m6.1.1.3.cmml" xref="S3.SS4.SSS1.Px1.p1.6.m6.1.1.3"></leq><cn id="S3.SS4.SSS1.Px1.p1.6.m6.1.1.2.cmml" type="integer" xref="S3.SS4.SSS1.Px1.p1.6.m6.1.1.2">1</cn><ci id="S3.SS4.SSS1.Px1.p1.6.m6.1.1.4.cmml" xref="S3.SS4.SSS1.Px1.p1.6.m6.1.1.4">𝑠</ci></apply><apply id="S3.SS4.SSS1.Px1.p1.6.m6.1.1c.cmml" xref="S3.SS4.SSS1.Px1.p1.6.m6.1.1"><leq id="S3.SS4.SSS1.Px1.p1.6.m6.1.1.5.cmml" xref="S3.SS4.SSS1.Px1.p1.6.m6.1.1.5"></leq><share href="https://arxiv.org/html/2410.00037v2#S3.SS4.SSS1.Px1.p1.6.m6.1.1.4.cmml" id="S3.SS4.SSS1.Px1.p1.6.m6.1.1d.cmml" xref="S3.SS4.SSS1.Px1.p1.6.m6.1.1"></share><ci id="S3.SS4.SSS1.Px1.p1.6.m6.1.1.6.cmml" xref="S3.SS4.SSS1.Px1.p1.6.m6.1.1.6">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.Px1.p1.6.m6.1c">1\leq s\leq S</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.Px1.p1.6.m6.1d">1 ≤ italic_s ≤ italic_S</annotation></semantics></math>,
the Temporal Transformer maps <math alttext="(V_{0},\ldots,V_{s-1})" class="ltx_Math" display="inline" id="S3.SS4.SSS1.Px1.p1.7.m7.3"><semantics id="S3.SS4.SSS1.Px1.p1.7.m7.3a"><mrow id="S3.SS4.SSS1.Px1.p1.7.m7.3.3.2" xref="S3.SS4.SSS1.Px1.p1.7.m7.3.3.3.cmml"><mo id="S3.SS4.SSS1.Px1.p1.7.m7.3.3.2.3" stretchy="false" xref="S3.SS4.SSS1.Px1.p1.7.m7.3.3.3.cmml">(</mo><msub id="S3.SS4.SSS1.Px1.p1.7.m7.2.2.1.1" xref="S3.SS4.SSS1.Px1.p1.7.m7.2.2.1.1.cmml"><mi id="S3.SS4.SSS1.Px1.p1.7.m7.2.2.1.1.2" xref="S3.SS4.SSS1.Px1.p1.7.m7.2.2.1.1.2.cmml">V</mi><mn id="S3.SS4.SSS1.Px1.p1.7.m7.2.2.1.1.3" xref="S3.SS4.SSS1.Px1.p1.7.m7.2.2.1.1.3.cmml">0</mn></msub><mo id="S3.SS4.SSS1.Px1.p1.7.m7.3.3.2.4" xref="S3.SS4.SSS1.Px1.p1.7.m7.3.3.3.cmml">,</mo><mi id="S3.SS4.SSS1.Px1.p1.7.m7.1.1" mathvariant="normal" xref="S3.SS4.SSS1.Px1.p1.7.m7.1.1.cmml">…</mi><mo id="S3.SS4.SSS1.Px1.p1.7.m7.3.3.2.5" xref="S3.SS4.SSS1.Px1.p1.7.m7.3.3.3.cmml">,</mo><msub id="S3.SS4.SSS1.Px1.p1.7.m7.3.3.2.2" xref="S3.SS4.SSS1.Px1.p1.7.m7.3.3.2.2.cmml"><mi id="S3.SS4.SSS1.Px1.p1.7.m7.3.3.2.2.2" xref="S3.SS4.SSS1.Px1.p1.7.m7.3.3.2.2.2.cmml">V</mi><mrow id="S3.SS4.SSS1.Px1.p1.7.m7.3.3.2.2.3" xref="S3.SS4.SSS1.Px1.p1.7.m7.3.3.2.2.3.cmml"><mi id="S3.SS4.SSS1.Px1.p1.7.m7.3.3.2.2.3.2" xref="S3.SS4.SSS1.Px1.p1.7.m7.3.3.2.2.3.2.cmml">s</mi><mo id="S3.SS4.SSS1.Px1.p1.7.m7.3.3.2.2.3.1" xref="S3.SS4.SSS1.Px1.p1.7.m7.3.3.2.2.3.1.cmml">−</mo><mn id="S3.SS4.SSS1.Px1.p1.7.m7.3.3.2.2.3.3" xref="S3.SS4.SSS1.Px1.p1.7.m7.3.3.2.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS4.SSS1.Px1.p1.7.m7.3.3.2.6" stretchy="false" xref="S3.SS4.SSS1.Px1.p1.7.m7.3.3.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.Px1.p1.7.m7.3b"><vector id="S3.SS4.SSS1.Px1.p1.7.m7.3.3.3.cmml" xref="S3.SS4.SSS1.Px1.p1.7.m7.3.3.2"><apply id="S3.SS4.SSS1.Px1.p1.7.m7.2.2.1.1.cmml" xref="S3.SS4.SSS1.Px1.p1.7.m7.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS1.Px1.p1.7.m7.2.2.1.1.1.cmml" xref="S3.SS4.SSS1.Px1.p1.7.m7.2.2.1.1">subscript</csymbol><ci id="S3.SS4.SSS1.Px1.p1.7.m7.2.2.1.1.2.cmml" xref="S3.SS4.SSS1.Px1.p1.7.m7.2.2.1.1.2">𝑉</ci><cn id="S3.SS4.SSS1.Px1.p1.7.m7.2.2.1.1.3.cmml" type="integer" xref="S3.SS4.SSS1.Px1.p1.7.m7.2.2.1.1.3">0</cn></apply><ci id="S3.SS4.SSS1.Px1.p1.7.m7.1.1.cmml" xref="S3.SS4.SSS1.Px1.p1.7.m7.1.1">…</ci><apply id="S3.SS4.SSS1.Px1.p1.7.m7.3.3.2.2.cmml" xref="S3.SS4.SSS1.Px1.p1.7.m7.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS4.SSS1.Px1.p1.7.m7.3.3.2.2.1.cmml" xref="S3.SS4.SSS1.Px1.p1.7.m7.3.3.2.2">subscript</csymbol><ci id="S3.SS4.SSS1.Px1.p1.7.m7.3.3.2.2.2.cmml" xref="S3.SS4.SSS1.Px1.p1.7.m7.3.3.2.2.2">𝑉</ci><apply id="S3.SS4.SSS1.Px1.p1.7.m7.3.3.2.2.3.cmml" xref="S3.SS4.SSS1.Px1.p1.7.m7.3.3.2.2.3"><minus id="S3.SS4.SSS1.Px1.p1.7.m7.3.3.2.2.3.1.cmml" xref="S3.SS4.SSS1.Px1.p1.7.m7.3.3.2.2.3.1"></minus><ci id="S3.SS4.SSS1.Px1.p1.7.m7.3.3.2.2.3.2.cmml" xref="S3.SS4.SSS1.Px1.p1.7.m7.3.3.2.2.3.2">𝑠</ci><cn id="S3.SS4.SSS1.Px1.p1.7.m7.3.3.2.2.3.3.cmml" type="integer" xref="S3.SS4.SSS1.Px1.p1.7.m7.3.3.2.2.3.3">1</cn></apply></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.Px1.p1.7.m7.3c">(V_{0},\ldots,V_{s-1})</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.Px1.p1.7.m7.3d">( italic_V start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , … , italic_V start_POSTSUBSCRIPT italic_s - 1 end_POSTSUBSCRIPT )</annotation></semantics></math> to a <em class="ltx_emph ltx_font_italic" id="S3.SS4.SSS1.Px1.p1.7.3">temporal context</em> vector</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="z_{s}=\mathrm{Tr}_{\mathrm{Temp}}(V_{0},\ldots,V_{s-1})\in\mathbb{R}^{d}." class="ltx_Math" display="block" id="S3.E1.m1.2"><semantics id="S3.E1.m1.2a"><mrow id="S3.E1.m1.2.2.1" xref="S3.E1.m1.2.2.1.1.cmml"><mrow id="S3.E1.m1.2.2.1.1" xref="S3.E1.m1.2.2.1.1.cmml"><msub id="S3.E1.m1.2.2.1.1.4" xref="S3.E1.m1.2.2.1.1.4.cmml"><mi id="S3.E1.m1.2.2.1.1.4.2" xref="S3.E1.m1.2.2.1.1.4.2.cmml">z</mi><mi id="S3.E1.m1.2.2.1.1.4.3" xref="S3.E1.m1.2.2.1.1.4.3.cmml">s</mi></msub><mo id="S3.E1.m1.2.2.1.1.5" xref="S3.E1.m1.2.2.1.1.5.cmml">=</mo><mrow id="S3.E1.m1.2.2.1.1.2" xref="S3.E1.m1.2.2.1.1.2.cmml"><msub id="S3.E1.m1.2.2.1.1.2.4" xref="S3.E1.m1.2.2.1.1.2.4.cmml"><mi id="S3.E1.m1.2.2.1.1.2.4.2" xref="S3.E1.m1.2.2.1.1.2.4.2.cmml">Tr</mi><mi id="S3.E1.m1.2.2.1.1.2.4.3" xref="S3.E1.m1.2.2.1.1.2.4.3.cmml">Temp</mi></msub><mo id="S3.E1.m1.2.2.1.1.2.3" xref="S3.E1.m1.2.2.1.1.2.3.cmml">⁢</mo><mrow id="S3.E1.m1.2.2.1.1.2.2.2" xref="S3.E1.m1.2.2.1.1.2.2.3.cmml"><mo id="S3.E1.m1.2.2.1.1.2.2.2.3" stretchy="false" xref="S3.E1.m1.2.2.1.1.2.2.3.cmml">(</mo><msub id="S3.E1.m1.2.2.1.1.1.1.1.1" xref="S3.E1.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.2.2.1.1.1.1.1.1.2" xref="S3.E1.m1.2.2.1.1.1.1.1.1.2.cmml">V</mi><mn id="S3.E1.m1.2.2.1.1.1.1.1.1.3" xref="S3.E1.m1.2.2.1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="S3.E1.m1.2.2.1.1.2.2.2.4" xref="S3.E1.m1.2.2.1.1.2.2.3.cmml">,</mo><mi id="S3.E1.m1.1.1" mathvariant="normal" xref="S3.E1.m1.1.1.cmml">…</mi><mo id="S3.E1.m1.2.2.1.1.2.2.2.5" xref="S3.E1.m1.2.2.1.1.2.2.3.cmml">,</mo><msub id="S3.E1.m1.2.2.1.1.2.2.2.2" xref="S3.E1.m1.2.2.1.1.2.2.2.2.cmml"><mi id="S3.E1.m1.2.2.1.1.2.2.2.2.2" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2.cmml">V</mi><mrow id="S3.E1.m1.2.2.1.1.2.2.2.2.3" xref="S3.E1.m1.2.2.1.1.2.2.2.2.3.cmml"><mi id="S3.E1.m1.2.2.1.1.2.2.2.2.3.2" xref="S3.E1.m1.2.2.1.1.2.2.2.2.3.2.cmml">s</mi><mo id="S3.E1.m1.2.2.1.1.2.2.2.2.3.1" xref="S3.E1.m1.2.2.1.1.2.2.2.2.3.1.cmml">−</mo><mn id="S3.E1.m1.2.2.1.1.2.2.2.2.3.3" xref="S3.E1.m1.2.2.1.1.2.2.2.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.E1.m1.2.2.1.1.2.2.2.6" stretchy="false" xref="S3.E1.m1.2.2.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.2.2.1.1.6" xref="S3.E1.m1.2.2.1.1.6.cmml">∈</mo><msup id="S3.E1.m1.2.2.1.1.7" xref="S3.E1.m1.2.2.1.1.7.cmml"><mi id="S3.E1.m1.2.2.1.1.7.2" xref="S3.E1.m1.2.2.1.1.7.2.cmml">ℝ</mi><mi id="S3.E1.m1.2.2.1.1.7.3" xref="S3.E1.m1.2.2.1.1.7.3.cmml">d</mi></msup></mrow><mo id="S3.E1.m1.2.2.1.2" lspace="0em" xref="S3.E1.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.2b"><apply id="S3.E1.m1.2.2.1.1.cmml" xref="S3.E1.m1.2.2.1"><and id="S3.E1.m1.2.2.1.1a.cmml" xref="S3.E1.m1.2.2.1"></and><apply id="S3.E1.m1.2.2.1.1b.cmml" xref="S3.E1.m1.2.2.1"><eq id="S3.E1.m1.2.2.1.1.5.cmml" xref="S3.E1.m1.2.2.1.1.5"></eq><apply id="S3.E1.m1.2.2.1.1.4.cmml" xref="S3.E1.m1.2.2.1.1.4"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.4.1.cmml" xref="S3.E1.m1.2.2.1.1.4">subscript</csymbol><ci id="S3.E1.m1.2.2.1.1.4.2.cmml" xref="S3.E1.m1.2.2.1.1.4.2">𝑧</ci><ci id="S3.E1.m1.2.2.1.1.4.3.cmml" xref="S3.E1.m1.2.2.1.1.4.3">𝑠</ci></apply><apply id="S3.E1.m1.2.2.1.1.2.cmml" xref="S3.E1.m1.2.2.1.1.2"><times id="S3.E1.m1.2.2.1.1.2.3.cmml" xref="S3.E1.m1.2.2.1.1.2.3"></times><apply id="S3.E1.m1.2.2.1.1.2.4.cmml" xref="S3.E1.m1.2.2.1.1.2.4"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.2.4.1.cmml" xref="S3.E1.m1.2.2.1.1.2.4">subscript</csymbol><ci id="S3.E1.m1.2.2.1.1.2.4.2.cmml" xref="S3.E1.m1.2.2.1.1.2.4.2">Tr</ci><ci id="S3.E1.m1.2.2.1.1.2.4.3.cmml" xref="S3.E1.m1.2.2.1.1.2.4.3">Temp</ci></apply><vector id="S3.E1.m1.2.2.1.1.2.2.3.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2"><apply id="S3.E1.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.2">𝑉</ci><cn id="S3.E1.m1.2.2.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E1.m1.2.2.1.1.1.1.1.1.3">0</cn></apply><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">…</ci><apply id="S3.E1.m1.2.2.1.1.2.2.2.2.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.2.2.2.2.1.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E1.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2">𝑉</ci><apply id="S3.E1.m1.2.2.1.1.2.2.2.2.3.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.2.3"><minus id="S3.E1.m1.2.2.1.1.2.2.2.2.3.1.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.2.3.1"></minus><ci id="S3.E1.m1.2.2.1.1.2.2.2.2.3.2.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.2.3.2">𝑠</ci><cn id="S3.E1.m1.2.2.1.1.2.2.2.2.3.3.cmml" type="integer" xref="S3.E1.m1.2.2.1.1.2.2.2.2.3.3">1</cn></apply></apply></vector></apply></apply><apply id="S3.E1.m1.2.2.1.1c.cmml" xref="S3.E1.m1.2.2.1"><in id="S3.E1.m1.2.2.1.1.6.cmml" xref="S3.E1.m1.2.2.1.1.6"></in><share href="https://arxiv.org/html/2410.00037v2#S3.E1.m1.2.2.1.1.2.cmml" id="S3.E1.m1.2.2.1.1d.cmml" xref="S3.E1.m1.2.2.1"></share><apply id="S3.E1.m1.2.2.1.1.7.cmml" xref="S3.E1.m1.2.2.1.1.7"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.7.1.cmml" xref="S3.E1.m1.2.2.1.1.7">superscript</csymbol><ci id="S3.E1.m1.2.2.1.1.7.2.cmml" xref="S3.E1.m1.2.2.1.1.7.2">ℝ</ci><ci id="S3.E1.m1.2.2.1.1.7.3.cmml" xref="S3.E1.m1.2.2.1.1.7.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.2c">z_{s}=\mathrm{Tr}_{\mathrm{Temp}}(V_{0},\ldots,V_{s-1})\in\mathbb{R}^{d}.</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.2d">italic_z start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT = roman_Tr start_POSTSUBSCRIPT roman_Temp end_POSTSUBSCRIPT ( italic_V start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , … , italic_V start_POSTSUBSCRIPT italic_s - 1 end_POSTSUBSCRIPT ) ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.SSS1.Px1.p1.10">If we further take a sub-sequence index <math alttext="1<k\leq K" class="ltx_Math" display="inline" id="S3.SS4.SSS1.Px1.p1.8.m1.1"><semantics id="S3.SS4.SSS1.Px1.p1.8.m1.1a"><mrow id="S3.SS4.SSS1.Px1.p1.8.m1.1.1" xref="S3.SS4.SSS1.Px1.p1.8.m1.1.1.cmml"><mn id="S3.SS4.SSS1.Px1.p1.8.m1.1.1.2" xref="S3.SS4.SSS1.Px1.p1.8.m1.1.1.2.cmml">1</mn><mo id="S3.SS4.SSS1.Px1.p1.8.m1.1.1.3" xref="S3.SS4.SSS1.Px1.p1.8.m1.1.1.3.cmml">&lt;</mo><mi id="S3.SS4.SSS1.Px1.p1.8.m1.1.1.4" xref="S3.SS4.SSS1.Px1.p1.8.m1.1.1.4.cmml">k</mi><mo id="S3.SS4.SSS1.Px1.p1.8.m1.1.1.5" xref="S3.SS4.SSS1.Px1.p1.8.m1.1.1.5.cmml">≤</mo><mi id="S3.SS4.SSS1.Px1.p1.8.m1.1.1.6" xref="S3.SS4.SSS1.Px1.p1.8.m1.1.1.6.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.Px1.p1.8.m1.1b"><apply id="S3.SS4.SSS1.Px1.p1.8.m1.1.1.cmml" xref="S3.SS4.SSS1.Px1.p1.8.m1.1.1"><and id="S3.SS4.SSS1.Px1.p1.8.m1.1.1a.cmml" xref="S3.SS4.SSS1.Px1.p1.8.m1.1.1"></and><apply id="S3.SS4.SSS1.Px1.p1.8.m1.1.1b.cmml" xref="S3.SS4.SSS1.Px1.p1.8.m1.1.1"><lt id="S3.SS4.SSS1.Px1.p1.8.m1.1.1.3.cmml" xref="S3.SS4.SSS1.Px1.p1.8.m1.1.1.3"></lt><cn id="S3.SS4.SSS1.Px1.p1.8.m1.1.1.2.cmml" type="integer" xref="S3.SS4.SSS1.Px1.p1.8.m1.1.1.2">1</cn><ci id="S3.SS4.SSS1.Px1.p1.8.m1.1.1.4.cmml" xref="S3.SS4.SSS1.Px1.p1.8.m1.1.1.4">𝑘</ci></apply><apply id="S3.SS4.SSS1.Px1.p1.8.m1.1.1c.cmml" xref="S3.SS4.SSS1.Px1.p1.8.m1.1.1"><leq id="S3.SS4.SSS1.Px1.p1.8.m1.1.1.5.cmml" xref="S3.SS4.SSS1.Px1.p1.8.m1.1.1.5"></leq><share href="https://arxiv.org/html/2410.00037v2#S3.SS4.SSS1.Px1.p1.8.m1.1.1.4.cmml" id="S3.SS4.SSS1.Px1.p1.8.m1.1.1d.cmml" xref="S3.SS4.SSS1.Px1.p1.8.m1.1.1"></share><ci id="S3.SS4.SSS1.Px1.p1.8.m1.1.1.6.cmml" xref="S3.SS4.SSS1.Px1.p1.8.m1.1.1.6">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.Px1.p1.8.m1.1c">1&lt;k\leq K</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.Px1.p1.8.m1.1d">1 &lt; italic_k ≤ italic_K</annotation></semantics></math>, the Depth Transformer maps both <math alttext="z_{s}" class="ltx_Math" display="inline" id="S3.SS4.SSS1.Px1.p1.9.m2.1"><semantics id="S3.SS4.SSS1.Px1.p1.9.m2.1a"><msub id="S3.SS4.SSS1.Px1.p1.9.m2.1.1" xref="S3.SS4.SSS1.Px1.p1.9.m2.1.1.cmml"><mi id="S3.SS4.SSS1.Px1.p1.9.m2.1.1.2" xref="S3.SS4.SSS1.Px1.p1.9.m2.1.1.2.cmml">z</mi><mi id="S3.SS4.SSS1.Px1.p1.9.m2.1.1.3" xref="S3.SS4.SSS1.Px1.p1.9.m2.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.Px1.p1.9.m2.1b"><apply id="S3.SS4.SSS1.Px1.p1.9.m2.1.1.cmml" xref="S3.SS4.SSS1.Px1.p1.9.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS1.Px1.p1.9.m2.1.1.1.cmml" xref="S3.SS4.SSS1.Px1.p1.9.m2.1.1">subscript</csymbol><ci id="S3.SS4.SSS1.Px1.p1.9.m2.1.1.2.cmml" xref="S3.SS4.SSS1.Px1.p1.9.m2.1.1.2">𝑧</ci><ci id="S3.SS4.SSS1.Px1.p1.9.m2.1.1.3.cmml" xref="S3.SS4.SSS1.Px1.p1.9.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.Px1.p1.9.m2.1c">z_{s}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.Px1.p1.9.m2.1d">italic_z start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> along with <math alttext="(V_{s,1},\ldots,V_{s,k-1})" class="ltx_Math" display="inline" id="S3.SS4.SSS1.Px1.p1.10.m3.7"><semantics id="S3.SS4.SSS1.Px1.p1.10.m3.7a"><mrow id="S3.SS4.SSS1.Px1.p1.10.m3.7.7.2" xref="S3.SS4.SSS1.Px1.p1.10.m3.7.7.3.cmml"><mo id="S3.SS4.SSS1.Px1.p1.10.m3.7.7.2.3" stretchy="false" xref="S3.SS4.SSS1.Px1.p1.10.m3.7.7.3.cmml">(</mo><msub id="S3.SS4.SSS1.Px1.p1.10.m3.6.6.1.1" xref="S3.SS4.SSS1.Px1.p1.10.m3.6.6.1.1.cmml"><mi id="S3.SS4.SSS1.Px1.p1.10.m3.6.6.1.1.2" xref="S3.SS4.SSS1.Px1.p1.10.m3.6.6.1.1.2.cmml">V</mi><mrow id="S3.SS4.SSS1.Px1.p1.10.m3.2.2.2.4" xref="S3.SS4.SSS1.Px1.p1.10.m3.2.2.2.3.cmml"><mi id="S3.SS4.SSS1.Px1.p1.10.m3.1.1.1.1" xref="S3.SS4.SSS1.Px1.p1.10.m3.1.1.1.1.cmml">s</mi><mo id="S3.SS4.SSS1.Px1.p1.10.m3.2.2.2.4.1" xref="S3.SS4.SSS1.Px1.p1.10.m3.2.2.2.3.cmml">,</mo><mn id="S3.SS4.SSS1.Px1.p1.10.m3.2.2.2.2" xref="S3.SS4.SSS1.Px1.p1.10.m3.2.2.2.2.cmml">1</mn></mrow></msub><mo id="S3.SS4.SSS1.Px1.p1.10.m3.7.7.2.4" xref="S3.SS4.SSS1.Px1.p1.10.m3.7.7.3.cmml">,</mo><mi id="S3.SS4.SSS1.Px1.p1.10.m3.5.5" mathvariant="normal" xref="S3.SS4.SSS1.Px1.p1.10.m3.5.5.cmml">…</mi><mo id="S3.SS4.SSS1.Px1.p1.10.m3.7.7.2.5" xref="S3.SS4.SSS1.Px1.p1.10.m3.7.7.3.cmml">,</mo><msub id="S3.SS4.SSS1.Px1.p1.10.m3.7.7.2.2" xref="S3.SS4.SSS1.Px1.p1.10.m3.7.7.2.2.cmml"><mi id="S3.SS4.SSS1.Px1.p1.10.m3.7.7.2.2.2" xref="S3.SS4.SSS1.Px1.p1.10.m3.7.7.2.2.2.cmml">V</mi><mrow id="S3.SS4.SSS1.Px1.p1.10.m3.4.4.2.2" xref="S3.SS4.SSS1.Px1.p1.10.m3.4.4.2.3.cmml"><mi id="S3.SS4.SSS1.Px1.p1.10.m3.3.3.1.1" xref="S3.SS4.SSS1.Px1.p1.10.m3.3.3.1.1.cmml">s</mi><mo id="S3.SS4.SSS1.Px1.p1.10.m3.4.4.2.2.2" xref="S3.SS4.SSS1.Px1.p1.10.m3.4.4.2.3.cmml">,</mo><mrow id="S3.SS4.SSS1.Px1.p1.10.m3.4.4.2.2.1" xref="S3.SS4.SSS1.Px1.p1.10.m3.4.4.2.2.1.cmml"><mi id="S3.SS4.SSS1.Px1.p1.10.m3.4.4.2.2.1.2" xref="S3.SS4.SSS1.Px1.p1.10.m3.4.4.2.2.1.2.cmml">k</mi><mo id="S3.SS4.SSS1.Px1.p1.10.m3.4.4.2.2.1.1" xref="S3.SS4.SSS1.Px1.p1.10.m3.4.4.2.2.1.1.cmml">−</mo><mn id="S3.SS4.SSS1.Px1.p1.10.m3.4.4.2.2.1.3" xref="S3.SS4.SSS1.Px1.p1.10.m3.4.4.2.2.1.3.cmml">1</mn></mrow></mrow></msub><mo id="S3.SS4.SSS1.Px1.p1.10.m3.7.7.2.6" stretchy="false" xref="S3.SS4.SSS1.Px1.p1.10.m3.7.7.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.Px1.p1.10.m3.7b"><vector id="S3.SS4.SSS1.Px1.p1.10.m3.7.7.3.cmml" xref="S3.SS4.SSS1.Px1.p1.10.m3.7.7.2"><apply id="S3.SS4.SSS1.Px1.p1.10.m3.6.6.1.1.cmml" xref="S3.SS4.SSS1.Px1.p1.10.m3.6.6.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS1.Px1.p1.10.m3.6.6.1.1.1.cmml" xref="S3.SS4.SSS1.Px1.p1.10.m3.6.6.1.1">subscript</csymbol><ci id="S3.SS4.SSS1.Px1.p1.10.m3.6.6.1.1.2.cmml" xref="S3.SS4.SSS1.Px1.p1.10.m3.6.6.1.1.2">𝑉</ci><list id="S3.SS4.SSS1.Px1.p1.10.m3.2.2.2.3.cmml" xref="S3.SS4.SSS1.Px1.p1.10.m3.2.2.2.4"><ci id="S3.SS4.SSS1.Px1.p1.10.m3.1.1.1.1.cmml" xref="S3.SS4.SSS1.Px1.p1.10.m3.1.1.1.1">𝑠</ci><cn id="S3.SS4.SSS1.Px1.p1.10.m3.2.2.2.2.cmml" type="integer" xref="S3.SS4.SSS1.Px1.p1.10.m3.2.2.2.2">1</cn></list></apply><ci id="S3.SS4.SSS1.Px1.p1.10.m3.5.5.cmml" xref="S3.SS4.SSS1.Px1.p1.10.m3.5.5">…</ci><apply id="S3.SS4.SSS1.Px1.p1.10.m3.7.7.2.2.cmml" xref="S3.SS4.SSS1.Px1.p1.10.m3.7.7.2.2"><csymbol cd="ambiguous" id="S3.SS4.SSS1.Px1.p1.10.m3.7.7.2.2.1.cmml" xref="S3.SS4.SSS1.Px1.p1.10.m3.7.7.2.2">subscript</csymbol><ci id="S3.SS4.SSS1.Px1.p1.10.m3.7.7.2.2.2.cmml" xref="S3.SS4.SSS1.Px1.p1.10.m3.7.7.2.2.2">𝑉</ci><list id="S3.SS4.SSS1.Px1.p1.10.m3.4.4.2.3.cmml" xref="S3.SS4.SSS1.Px1.p1.10.m3.4.4.2.2"><ci id="S3.SS4.SSS1.Px1.p1.10.m3.3.3.1.1.cmml" xref="S3.SS4.SSS1.Px1.p1.10.m3.3.3.1.1">𝑠</ci><apply id="S3.SS4.SSS1.Px1.p1.10.m3.4.4.2.2.1.cmml" xref="S3.SS4.SSS1.Px1.p1.10.m3.4.4.2.2.1"><minus id="S3.SS4.SSS1.Px1.p1.10.m3.4.4.2.2.1.1.cmml" xref="S3.SS4.SSS1.Px1.p1.10.m3.4.4.2.2.1.1"></minus><ci id="S3.SS4.SSS1.Px1.p1.10.m3.4.4.2.2.1.2.cmml" xref="S3.SS4.SSS1.Px1.p1.10.m3.4.4.2.2.1.2">𝑘</ci><cn id="S3.SS4.SSS1.Px1.p1.10.m3.4.4.2.2.1.3.cmml" type="integer" xref="S3.SS4.SSS1.Px1.p1.10.m3.4.4.2.2.1.3">1</cn></apply></list></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.Px1.p1.10.m3.7c">(V_{s,1},\ldots,V_{s,k-1})</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.Px1.p1.10.m3.7d">( italic_V start_POSTSUBSCRIPT italic_s , 1 end_POSTSUBSCRIPT , … , italic_V start_POSTSUBSCRIPT italic_s , italic_k - 1 end_POSTSUBSCRIPT )</annotation></semantics></math> to the logits estimate</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="l_{s,k}=\mathrm{Tr}_{\mathrm{Depth}}(z_{s},V_{s,1},\ldots,V_{s,k-1})\in\mathbb%
{R}^{N_{k}}." class="ltx_Math" display="block" id="S3.E2.m1.8"><semantics id="S3.E2.m1.8a"><mrow id="S3.E2.m1.8.8.1" xref="S3.E2.m1.8.8.1.1.cmml"><mrow id="S3.E2.m1.8.8.1.1" xref="S3.E2.m1.8.8.1.1.cmml"><msub id="S3.E2.m1.8.8.1.1.5" xref="S3.E2.m1.8.8.1.1.5.cmml"><mi id="S3.E2.m1.8.8.1.1.5.2" xref="S3.E2.m1.8.8.1.1.5.2.cmml">l</mi><mrow id="S3.E2.m1.2.2.2.4" xref="S3.E2.m1.2.2.2.3.cmml"><mi id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml">s</mi><mo id="S3.E2.m1.2.2.2.4.1" xref="S3.E2.m1.2.2.2.3.cmml">,</mo><mi id="S3.E2.m1.2.2.2.2" xref="S3.E2.m1.2.2.2.2.cmml">k</mi></mrow></msub><mo id="S3.E2.m1.8.8.1.1.6" xref="S3.E2.m1.8.8.1.1.6.cmml">=</mo><mrow id="S3.E2.m1.8.8.1.1.3" xref="S3.E2.m1.8.8.1.1.3.cmml"><msub id="S3.E2.m1.8.8.1.1.3.5" xref="S3.E2.m1.8.8.1.1.3.5.cmml"><mi id="S3.E2.m1.8.8.1.1.3.5.2" xref="S3.E2.m1.8.8.1.1.3.5.2.cmml">Tr</mi><mi id="S3.E2.m1.8.8.1.1.3.5.3" xref="S3.E2.m1.8.8.1.1.3.5.3.cmml">Depth</mi></msub><mo id="S3.E2.m1.8.8.1.1.3.4" xref="S3.E2.m1.8.8.1.1.3.4.cmml">⁢</mo><mrow id="S3.E2.m1.8.8.1.1.3.3.3" xref="S3.E2.m1.8.8.1.1.3.3.4.cmml"><mo id="S3.E2.m1.8.8.1.1.3.3.3.4" stretchy="false" xref="S3.E2.m1.8.8.1.1.3.3.4.cmml">(</mo><msub id="S3.E2.m1.8.8.1.1.1.1.1.1" xref="S3.E2.m1.8.8.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.8.8.1.1.1.1.1.1.2" xref="S3.E2.m1.8.8.1.1.1.1.1.1.2.cmml">z</mi><mi id="S3.E2.m1.8.8.1.1.1.1.1.1.3" xref="S3.E2.m1.8.8.1.1.1.1.1.1.3.cmml">s</mi></msub><mo id="S3.E2.m1.8.8.1.1.3.3.3.5" xref="S3.E2.m1.8.8.1.1.3.3.4.cmml">,</mo><msub id="S3.E2.m1.8.8.1.1.2.2.2.2" xref="S3.E2.m1.8.8.1.1.2.2.2.2.cmml"><mi id="S3.E2.m1.8.8.1.1.2.2.2.2.2" xref="S3.E2.m1.8.8.1.1.2.2.2.2.2.cmml">V</mi><mrow id="S3.E2.m1.4.4.2.4" xref="S3.E2.m1.4.4.2.3.cmml"><mi id="S3.E2.m1.3.3.1.1" xref="S3.E2.m1.3.3.1.1.cmml">s</mi><mo id="S3.E2.m1.4.4.2.4.1" xref="S3.E2.m1.4.4.2.3.cmml">,</mo><mn id="S3.E2.m1.4.4.2.2" xref="S3.E2.m1.4.4.2.2.cmml">1</mn></mrow></msub><mo id="S3.E2.m1.8.8.1.1.3.3.3.6" xref="S3.E2.m1.8.8.1.1.3.3.4.cmml">,</mo><mi id="S3.E2.m1.7.7" mathvariant="normal" xref="S3.E2.m1.7.7.cmml">…</mi><mo id="S3.E2.m1.8.8.1.1.3.3.3.7" xref="S3.E2.m1.8.8.1.1.3.3.4.cmml">,</mo><msub id="S3.E2.m1.8.8.1.1.3.3.3.3" xref="S3.E2.m1.8.8.1.1.3.3.3.3.cmml"><mi id="S3.E2.m1.8.8.1.1.3.3.3.3.2" xref="S3.E2.m1.8.8.1.1.3.3.3.3.2.cmml">V</mi><mrow id="S3.E2.m1.6.6.2.2" xref="S3.E2.m1.6.6.2.3.cmml"><mi id="S3.E2.m1.5.5.1.1" xref="S3.E2.m1.5.5.1.1.cmml">s</mi><mo id="S3.E2.m1.6.6.2.2.2" xref="S3.E2.m1.6.6.2.3.cmml">,</mo><mrow id="S3.E2.m1.6.6.2.2.1" xref="S3.E2.m1.6.6.2.2.1.cmml"><mi id="S3.E2.m1.6.6.2.2.1.2" xref="S3.E2.m1.6.6.2.2.1.2.cmml">k</mi><mo id="S3.E2.m1.6.6.2.2.1.1" xref="S3.E2.m1.6.6.2.2.1.1.cmml">−</mo><mn id="S3.E2.m1.6.6.2.2.1.3" xref="S3.E2.m1.6.6.2.2.1.3.cmml">1</mn></mrow></mrow></msub><mo id="S3.E2.m1.8.8.1.1.3.3.3.8" stretchy="false" xref="S3.E2.m1.8.8.1.1.3.3.4.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.8.8.1.1.7" xref="S3.E2.m1.8.8.1.1.7.cmml">∈</mo><msup id="S3.E2.m1.8.8.1.1.8" xref="S3.E2.m1.8.8.1.1.8.cmml"><mi id="S3.E2.m1.8.8.1.1.8.2" xref="S3.E2.m1.8.8.1.1.8.2.cmml">ℝ</mi><msub id="S3.E2.m1.8.8.1.1.8.3" xref="S3.E2.m1.8.8.1.1.8.3.cmml"><mi id="S3.E2.m1.8.8.1.1.8.3.2" xref="S3.E2.m1.8.8.1.1.8.3.2.cmml">N</mi><mi id="S3.E2.m1.8.8.1.1.8.3.3" xref="S3.E2.m1.8.8.1.1.8.3.3.cmml">k</mi></msub></msup></mrow><mo id="S3.E2.m1.8.8.1.2" lspace="0em" xref="S3.E2.m1.8.8.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.8b"><apply id="S3.E2.m1.8.8.1.1.cmml" xref="S3.E2.m1.8.8.1"><and id="S3.E2.m1.8.8.1.1a.cmml" xref="S3.E2.m1.8.8.1"></and><apply id="S3.E2.m1.8.8.1.1b.cmml" xref="S3.E2.m1.8.8.1"><eq id="S3.E2.m1.8.8.1.1.6.cmml" xref="S3.E2.m1.8.8.1.1.6"></eq><apply id="S3.E2.m1.8.8.1.1.5.cmml" xref="S3.E2.m1.8.8.1.1.5"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.1.1.5.1.cmml" xref="S3.E2.m1.8.8.1.1.5">subscript</csymbol><ci id="S3.E2.m1.8.8.1.1.5.2.cmml" xref="S3.E2.m1.8.8.1.1.5.2">𝑙</ci><list id="S3.E2.m1.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.4"><ci id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1">𝑠</ci><ci id="S3.E2.m1.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2">𝑘</ci></list></apply><apply id="S3.E2.m1.8.8.1.1.3.cmml" xref="S3.E2.m1.8.8.1.1.3"><times id="S3.E2.m1.8.8.1.1.3.4.cmml" xref="S3.E2.m1.8.8.1.1.3.4"></times><apply id="S3.E2.m1.8.8.1.1.3.5.cmml" xref="S3.E2.m1.8.8.1.1.3.5"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.1.1.3.5.1.cmml" xref="S3.E2.m1.8.8.1.1.3.5">subscript</csymbol><ci id="S3.E2.m1.8.8.1.1.3.5.2.cmml" xref="S3.E2.m1.8.8.1.1.3.5.2">Tr</ci><ci id="S3.E2.m1.8.8.1.1.3.5.3.cmml" xref="S3.E2.m1.8.8.1.1.3.5.3">Depth</ci></apply><vector id="S3.E2.m1.8.8.1.1.3.3.4.cmml" xref="S3.E2.m1.8.8.1.1.3.3.3"><apply id="S3.E2.m1.8.8.1.1.1.1.1.1.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.8.8.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.2">𝑧</ci><ci id="S3.E2.m1.8.8.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.3">𝑠</ci></apply><apply id="S3.E2.m1.8.8.1.1.2.2.2.2.cmml" xref="S3.E2.m1.8.8.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.1.1.2.2.2.2.1.cmml" xref="S3.E2.m1.8.8.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E2.m1.8.8.1.1.2.2.2.2.2.cmml" xref="S3.E2.m1.8.8.1.1.2.2.2.2.2">𝑉</ci><list id="S3.E2.m1.4.4.2.3.cmml" xref="S3.E2.m1.4.4.2.4"><ci id="S3.E2.m1.3.3.1.1.cmml" xref="S3.E2.m1.3.3.1.1">𝑠</ci><cn id="S3.E2.m1.4.4.2.2.cmml" type="integer" xref="S3.E2.m1.4.4.2.2">1</cn></list></apply><ci id="S3.E2.m1.7.7.cmml" xref="S3.E2.m1.7.7">…</ci><apply id="S3.E2.m1.8.8.1.1.3.3.3.3.cmml" xref="S3.E2.m1.8.8.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.1.1.3.3.3.3.1.cmml" xref="S3.E2.m1.8.8.1.1.3.3.3.3">subscript</csymbol><ci id="S3.E2.m1.8.8.1.1.3.3.3.3.2.cmml" xref="S3.E2.m1.8.8.1.1.3.3.3.3.2">𝑉</ci><list id="S3.E2.m1.6.6.2.3.cmml" xref="S3.E2.m1.6.6.2.2"><ci id="S3.E2.m1.5.5.1.1.cmml" xref="S3.E2.m1.5.5.1.1">𝑠</ci><apply id="S3.E2.m1.6.6.2.2.1.cmml" xref="S3.E2.m1.6.6.2.2.1"><minus id="S3.E2.m1.6.6.2.2.1.1.cmml" xref="S3.E2.m1.6.6.2.2.1.1"></minus><ci id="S3.E2.m1.6.6.2.2.1.2.cmml" xref="S3.E2.m1.6.6.2.2.1.2">𝑘</ci><cn id="S3.E2.m1.6.6.2.2.1.3.cmml" type="integer" xref="S3.E2.m1.6.6.2.2.1.3">1</cn></apply></list></apply></vector></apply></apply><apply id="S3.E2.m1.8.8.1.1c.cmml" xref="S3.E2.m1.8.8.1"><in id="S3.E2.m1.8.8.1.1.7.cmml" xref="S3.E2.m1.8.8.1.1.7"></in><share href="https://arxiv.org/html/2410.00037v2#S3.E2.m1.8.8.1.1.3.cmml" id="S3.E2.m1.8.8.1.1d.cmml" xref="S3.E2.m1.8.8.1"></share><apply id="S3.E2.m1.8.8.1.1.8.cmml" xref="S3.E2.m1.8.8.1.1.8"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.1.1.8.1.cmml" xref="S3.E2.m1.8.8.1.1.8">superscript</csymbol><ci id="S3.E2.m1.8.8.1.1.8.2.cmml" xref="S3.E2.m1.8.8.1.1.8.2">ℝ</ci><apply id="S3.E2.m1.8.8.1.1.8.3.cmml" xref="S3.E2.m1.8.8.1.1.8.3"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.1.1.8.3.1.cmml" xref="S3.E2.m1.8.8.1.1.8.3">subscript</csymbol><ci id="S3.E2.m1.8.8.1.1.8.3.2.cmml" xref="S3.E2.m1.8.8.1.1.8.3.2">𝑁</ci><ci id="S3.E2.m1.8.8.1.1.8.3.3.cmml" xref="S3.E2.m1.8.8.1.1.8.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.8c">l_{s,k}=\mathrm{Tr}_{\mathrm{Depth}}(z_{s},V_{s,1},\ldots,V_{s,k-1})\in\mathbb%
{R}^{N_{k}}.</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.8d">italic_l start_POSTSUBSCRIPT italic_s , italic_k end_POSTSUBSCRIPT = roman_Tr start_POSTSUBSCRIPT roman_Depth end_POSTSUBSCRIPT ( italic_z start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT , italic_V start_POSTSUBSCRIPT italic_s , 1 end_POSTSUBSCRIPT , … , italic_V start_POSTSUBSCRIPT italic_s , italic_k - 1 end_POSTSUBSCRIPT ) ∈ blackboard_R start_POSTSUPERSCRIPT italic_N start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.SSS1.Px1.p1.17">We further define <math alttext="l_{s,1}=\mathrm{Lin}(z_{s})\in\mathbb{R}^{N_{1}}" class="ltx_Math" display="inline" id="S3.SS4.SSS1.Px1.p1.11.m1.3"><semantics id="S3.SS4.SSS1.Px1.p1.11.m1.3a"><mrow id="S3.SS4.SSS1.Px1.p1.11.m1.3.3" xref="S3.SS4.SSS1.Px1.p1.11.m1.3.3.cmml"><msub id="S3.SS4.SSS1.Px1.p1.11.m1.3.3.3" xref="S3.SS4.SSS1.Px1.p1.11.m1.3.3.3.cmml"><mi id="S3.SS4.SSS1.Px1.p1.11.m1.3.3.3.2" xref="S3.SS4.SSS1.Px1.p1.11.m1.3.3.3.2.cmml">l</mi><mrow id="S3.SS4.SSS1.Px1.p1.11.m1.2.2.2.4" xref="S3.SS4.SSS1.Px1.p1.11.m1.2.2.2.3.cmml"><mi id="S3.SS4.SSS1.Px1.p1.11.m1.1.1.1.1" xref="S3.SS4.SSS1.Px1.p1.11.m1.1.1.1.1.cmml">s</mi><mo id="S3.SS4.SSS1.Px1.p1.11.m1.2.2.2.4.1" xref="S3.SS4.SSS1.Px1.p1.11.m1.2.2.2.3.cmml">,</mo><mn id="S3.SS4.SSS1.Px1.p1.11.m1.2.2.2.2" xref="S3.SS4.SSS1.Px1.p1.11.m1.2.2.2.2.cmml">1</mn></mrow></msub><mo id="S3.SS4.SSS1.Px1.p1.11.m1.3.3.4" xref="S3.SS4.SSS1.Px1.p1.11.m1.3.3.4.cmml">=</mo><mrow id="S3.SS4.SSS1.Px1.p1.11.m1.3.3.1" xref="S3.SS4.SSS1.Px1.p1.11.m1.3.3.1.cmml"><mi id="S3.SS4.SSS1.Px1.p1.11.m1.3.3.1.3" xref="S3.SS4.SSS1.Px1.p1.11.m1.3.3.1.3.cmml">Lin</mi><mo id="S3.SS4.SSS1.Px1.p1.11.m1.3.3.1.2" xref="S3.SS4.SSS1.Px1.p1.11.m1.3.3.1.2.cmml">⁢</mo><mrow id="S3.SS4.SSS1.Px1.p1.11.m1.3.3.1.1.1" xref="S3.SS4.SSS1.Px1.p1.11.m1.3.3.1.1.1.1.cmml"><mo id="S3.SS4.SSS1.Px1.p1.11.m1.3.3.1.1.1.2" stretchy="false" xref="S3.SS4.SSS1.Px1.p1.11.m1.3.3.1.1.1.1.cmml">(</mo><msub id="S3.SS4.SSS1.Px1.p1.11.m1.3.3.1.1.1.1" xref="S3.SS4.SSS1.Px1.p1.11.m1.3.3.1.1.1.1.cmml"><mi id="S3.SS4.SSS1.Px1.p1.11.m1.3.3.1.1.1.1.2" xref="S3.SS4.SSS1.Px1.p1.11.m1.3.3.1.1.1.1.2.cmml">z</mi><mi id="S3.SS4.SSS1.Px1.p1.11.m1.3.3.1.1.1.1.3" xref="S3.SS4.SSS1.Px1.p1.11.m1.3.3.1.1.1.1.3.cmml">s</mi></msub><mo id="S3.SS4.SSS1.Px1.p1.11.m1.3.3.1.1.1.3" stretchy="false" xref="S3.SS4.SSS1.Px1.p1.11.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS4.SSS1.Px1.p1.11.m1.3.3.5" xref="S3.SS4.SSS1.Px1.p1.11.m1.3.3.5.cmml">∈</mo><msup id="S3.SS4.SSS1.Px1.p1.11.m1.3.3.6" xref="S3.SS4.SSS1.Px1.p1.11.m1.3.3.6.cmml"><mi id="S3.SS4.SSS1.Px1.p1.11.m1.3.3.6.2" xref="S3.SS4.SSS1.Px1.p1.11.m1.3.3.6.2.cmml">ℝ</mi><msub id="S3.SS4.SSS1.Px1.p1.11.m1.3.3.6.3" xref="S3.SS4.SSS1.Px1.p1.11.m1.3.3.6.3.cmml"><mi id="S3.SS4.SSS1.Px1.p1.11.m1.3.3.6.3.2" xref="S3.SS4.SSS1.Px1.p1.11.m1.3.3.6.3.2.cmml">N</mi><mn id="S3.SS4.SSS1.Px1.p1.11.m1.3.3.6.3.3" xref="S3.SS4.SSS1.Px1.p1.11.m1.3.3.6.3.3.cmml">1</mn></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.Px1.p1.11.m1.3b"><apply id="S3.SS4.SSS1.Px1.p1.11.m1.3.3.cmml" xref="S3.SS4.SSS1.Px1.p1.11.m1.3.3"><and id="S3.SS4.SSS1.Px1.p1.11.m1.3.3a.cmml" xref="S3.SS4.SSS1.Px1.p1.11.m1.3.3"></and><apply id="S3.SS4.SSS1.Px1.p1.11.m1.3.3b.cmml" xref="S3.SS4.SSS1.Px1.p1.11.m1.3.3"><eq id="S3.SS4.SSS1.Px1.p1.11.m1.3.3.4.cmml" xref="S3.SS4.SSS1.Px1.p1.11.m1.3.3.4"></eq><apply id="S3.SS4.SSS1.Px1.p1.11.m1.3.3.3.cmml" xref="S3.SS4.SSS1.Px1.p1.11.m1.3.3.3"><csymbol cd="ambiguous" id="S3.SS4.SSS1.Px1.p1.11.m1.3.3.3.1.cmml" xref="S3.SS4.SSS1.Px1.p1.11.m1.3.3.3">subscript</csymbol><ci id="S3.SS4.SSS1.Px1.p1.11.m1.3.3.3.2.cmml" xref="S3.SS4.SSS1.Px1.p1.11.m1.3.3.3.2">𝑙</ci><list id="S3.SS4.SSS1.Px1.p1.11.m1.2.2.2.3.cmml" xref="S3.SS4.SSS1.Px1.p1.11.m1.2.2.2.4"><ci id="S3.SS4.SSS1.Px1.p1.11.m1.1.1.1.1.cmml" xref="S3.SS4.SSS1.Px1.p1.11.m1.1.1.1.1">𝑠</ci><cn id="S3.SS4.SSS1.Px1.p1.11.m1.2.2.2.2.cmml" type="integer" xref="S3.SS4.SSS1.Px1.p1.11.m1.2.2.2.2">1</cn></list></apply><apply id="S3.SS4.SSS1.Px1.p1.11.m1.3.3.1.cmml" xref="S3.SS4.SSS1.Px1.p1.11.m1.3.3.1"><times id="S3.SS4.SSS1.Px1.p1.11.m1.3.3.1.2.cmml" xref="S3.SS4.SSS1.Px1.p1.11.m1.3.3.1.2"></times><ci id="S3.SS4.SSS1.Px1.p1.11.m1.3.3.1.3.cmml" xref="S3.SS4.SSS1.Px1.p1.11.m1.3.3.1.3">Lin</ci><apply id="S3.SS4.SSS1.Px1.p1.11.m1.3.3.1.1.1.1.cmml" xref="S3.SS4.SSS1.Px1.p1.11.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS1.Px1.p1.11.m1.3.3.1.1.1.1.1.cmml" xref="S3.SS4.SSS1.Px1.p1.11.m1.3.3.1.1.1">subscript</csymbol><ci id="S3.SS4.SSS1.Px1.p1.11.m1.3.3.1.1.1.1.2.cmml" xref="S3.SS4.SSS1.Px1.p1.11.m1.3.3.1.1.1.1.2">𝑧</ci><ci id="S3.SS4.SSS1.Px1.p1.11.m1.3.3.1.1.1.1.3.cmml" xref="S3.SS4.SSS1.Px1.p1.11.m1.3.3.1.1.1.1.3">𝑠</ci></apply></apply></apply><apply id="S3.SS4.SSS1.Px1.p1.11.m1.3.3c.cmml" xref="S3.SS4.SSS1.Px1.p1.11.m1.3.3"><in id="S3.SS4.SSS1.Px1.p1.11.m1.3.3.5.cmml" xref="S3.SS4.SSS1.Px1.p1.11.m1.3.3.5"></in><share href="https://arxiv.org/html/2410.00037v2#S3.SS4.SSS1.Px1.p1.11.m1.3.3.1.cmml" id="S3.SS4.SSS1.Px1.p1.11.m1.3.3d.cmml" xref="S3.SS4.SSS1.Px1.p1.11.m1.3.3"></share><apply id="S3.SS4.SSS1.Px1.p1.11.m1.3.3.6.cmml" xref="S3.SS4.SSS1.Px1.p1.11.m1.3.3.6"><csymbol cd="ambiguous" id="S3.SS4.SSS1.Px1.p1.11.m1.3.3.6.1.cmml" xref="S3.SS4.SSS1.Px1.p1.11.m1.3.3.6">superscript</csymbol><ci id="S3.SS4.SSS1.Px1.p1.11.m1.3.3.6.2.cmml" xref="S3.SS4.SSS1.Px1.p1.11.m1.3.3.6.2">ℝ</ci><apply id="S3.SS4.SSS1.Px1.p1.11.m1.3.3.6.3.cmml" xref="S3.SS4.SSS1.Px1.p1.11.m1.3.3.6.3"><csymbol cd="ambiguous" id="S3.SS4.SSS1.Px1.p1.11.m1.3.3.6.3.1.cmml" xref="S3.SS4.SSS1.Px1.p1.11.m1.3.3.6.3">subscript</csymbol><ci id="S3.SS4.SSS1.Px1.p1.11.m1.3.3.6.3.2.cmml" xref="S3.SS4.SSS1.Px1.p1.11.m1.3.3.6.3.2">𝑁</ci><cn id="S3.SS4.SSS1.Px1.p1.11.m1.3.3.6.3.3.cmml" type="integer" xref="S3.SS4.SSS1.Px1.p1.11.m1.3.3.6.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.Px1.p1.11.m1.3c">l_{s,1}=\mathrm{Lin}(z_{s})\in\mathbb{R}^{N_{1}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.Px1.p1.11.m1.3d">italic_l start_POSTSUBSCRIPT italic_s , 1 end_POSTSUBSCRIPT = roman_Lin ( italic_z start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ) ∈ blackboard_R start_POSTSUPERSCRIPT italic_N start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, with <math alttext="\mathrm{Lin}" class="ltx_Math" display="inline" id="S3.SS4.SSS1.Px1.p1.12.m2.1"><semantics id="S3.SS4.SSS1.Px1.p1.12.m2.1a"><mi id="S3.SS4.SSS1.Px1.p1.12.m2.1.1" xref="S3.SS4.SSS1.Px1.p1.12.m2.1.1.cmml">Lin</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.Px1.p1.12.m2.1b"><ci id="S3.SS4.SSS1.Px1.p1.12.m2.1.1.cmml" xref="S3.SS4.SSS1.Px1.p1.12.m2.1.1">Lin</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.Px1.p1.12.m2.1c">\mathrm{Lin}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.Px1.p1.12.m2.1d">roman_Lin</annotation></semantics></math> a dedicated linear layer. We train <math alttext="\mathrm{Tr}_{\mathrm{Temp}}" class="ltx_Math" display="inline" id="S3.SS4.SSS1.Px1.p1.13.m3.1"><semantics id="S3.SS4.SSS1.Px1.p1.13.m3.1a"><msub id="S3.SS4.SSS1.Px1.p1.13.m3.1.1" xref="S3.SS4.SSS1.Px1.p1.13.m3.1.1.cmml"><mi id="S3.SS4.SSS1.Px1.p1.13.m3.1.1.2" xref="S3.SS4.SSS1.Px1.p1.13.m3.1.1.2.cmml">Tr</mi><mi id="S3.SS4.SSS1.Px1.p1.13.m3.1.1.3" xref="S3.SS4.SSS1.Px1.p1.13.m3.1.1.3.cmml">Temp</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.Px1.p1.13.m3.1b"><apply id="S3.SS4.SSS1.Px1.p1.13.m3.1.1.cmml" xref="S3.SS4.SSS1.Px1.p1.13.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS1.Px1.p1.13.m3.1.1.1.cmml" xref="S3.SS4.SSS1.Px1.p1.13.m3.1.1">subscript</csymbol><ci id="S3.SS4.SSS1.Px1.p1.13.m3.1.1.2.cmml" xref="S3.SS4.SSS1.Px1.p1.13.m3.1.1.2">Tr</ci><ci id="S3.SS4.SSS1.Px1.p1.13.m3.1.1.3.cmml" xref="S3.SS4.SSS1.Px1.p1.13.m3.1.1.3">Temp</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.Px1.p1.13.m3.1c">\mathrm{Tr}_{\mathrm{Temp}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.Px1.p1.13.m3.1d">roman_Tr start_POSTSUBSCRIPT roman_Temp end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\mathrm{Tr}_{\mathrm{Depth}}" class="ltx_Math" display="inline" id="S3.SS4.SSS1.Px1.p1.14.m4.1"><semantics id="S3.SS4.SSS1.Px1.p1.14.m4.1a"><msub id="S3.SS4.SSS1.Px1.p1.14.m4.1.1" xref="S3.SS4.SSS1.Px1.p1.14.m4.1.1.cmml"><mi id="S3.SS4.SSS1.Px1.p1.14.m4.1.1.2" xref="S3.SS4.SSS1.Px1.p1.14.m4.1.1.2.cmml">Tr</mi><mi id="S3.SS4.SSS1.Px1.p1.14.m4.1.1.3" xref="S3.SS4.SSS1.Px1.p1.14.m4.1.1.3.cmml">Depth</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.Px1.p1.14.m4.1b"><apply id="S3.SS4.SSS1.Px1.p1.14.m4.1.1.cmml" xref="S3.SS4.SSS1.Px1.p1.14.m4.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS1.Px1.p1.14.m4.1.1.1.cmml" xref="S3.SS4.SSS1.Px1.p1.14.m4.1.1">subscript</csymbol><ci id="S3.SS4.SSS1.Px1.p1.14.m4.1.1.2.cmml" xref="S3.SS4.SSS1.Px1.p1.14.m4.1.1.2">Tr</ci><ci id="S3.SS4.SSS1.Px1.p1.14.m4.1.1.3.cmml" xref="S3.SS4.SSS1.Px1.p1.14.m4.1.1.3">Depth</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.Px1.p1.14.m4.1c">\mathrm{Tr}_{\mathrm{Depth}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.Px1.p1.14.m4.1d">roman_Tr start_POSTSUBSCRIPT roman_Depth end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathrm{Lin}" class="ltx_Math" display="inline" id="S3.SS4.SSS1.Px1.p1.15.m5.1"><semantics id="S3.SS4.SSS1.Px1.p1.15.m5.1a"><mi id="S3.SS4.SSS1.Px1.p1.15.m5.1.1" xref="S3.SS4.SSS1.Px1.p1.15.m5.1.1.cmml">Lin</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.Px1.p1.15.m5.1b"><ci id="S3.SS4.SSS1.Px1.p1.15.m5.1.1.cmml" xref="S3.SS4.SSS1.Px1.p1.15.m5.1.1">Lin</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.Px1.p1.15.m5.1c">\mathrm{Lin}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.Px1.p1.15.m5.1d">roman_Lin</annotation></semantics></math> so that
<math alttext="\mathrm{softmax}(l_{s,k})" class="ltx_Math" display="inline" id="S3.SS4.SSS1.Px1.p1.16.m6.3"><semantics id="S3.SS4.SSS1.Px1.p1.16.m6.3a"><mrow id="S3.SS4.SSS1.Px1.p1.16.m6.3.3" xref="S3.SS4.SSS1.Px1.p1.16.m6.3.3.cmml"><mi id="S3.SS4.SSS1.Px1.p1.16.m6.3.3.3" xref="S3.SS4.SSS1.Px1.p1.16.m6.3.3.3.cmml">softmax</mi><mo id="S3.SS4.SSS1.Px1.p1.16.m6.3.3.2" xref="S3.SS4.SSS1.Px1.p1.16.m6.3.3.2.cmml">⁢</mo><mrow id="S3.SS4.SSS1.Px1.p1.16.m6.3.3.1.1" xref="S3.SS4.SSS1.Px1.p1.16.m6.3.3.1.1.1.cmml"><mo id="S3.SS4.SSS1.Px1.p1.16.m6.3.3.1.1.2" stretchy="false" xref="S3.SS4.SSS1.Px1.p1.16.m6.3.3.1.1.1.cmml">(</mo><msub id="S3.SS4.SSS1.Px1.p1.16.m6.3.3.1.1.1" xref="S3.SS4.SSS1.Px1.p1.16.m6.3.3.1.1.1.cmml"><mi id="S3.SS4.SSS1.Px1.p1.16.m6.3.3.1.1.1.2" xref="S3.SS4.SSS1.Px1.p1.16.m6.3.3.1.1.1.2.cmml">l</mi><mrow id="S3.SS4.SSS1.Px1.p1.16.m6.2.2.2.4" xref="S3.SS4.SSS1.Px1.p1.16.m6.2.2.2.3.cmml"><mi id="S3.SS4.SSS1.Px1.p1.16.m6.1.1.1.1" xref="S3.SS4.SSS1.Px1.p1.16.m6.1.1.1.1.cmml">s</mi><mo id="S3.SS4.SSS1.Px1.p1.16.m6.2.2.2.4.1" xref="S3.SS4.SSS1.Px1.p1.16.m6.2.2.2.3.cmml">,</mo><mi id="S3.SS4.SSS1.Px1.p1.16.m6.2.2.2.2" xref="S3.SS4.SSS1.Px1.p1.16.m6.2.2.2.2.cmml">k</mi></mrow></msub><mo id="S3.SS4.SSS1.Px1.p1.16.m6.3.3.1.1.3" stretchy="false" xref="S3.SS4.SSS1.Px1.p1.16.m6.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.Px1.p1.16.m6.3b"><apply id="S3.SS4.SSS1.Px1.p1.16.m6.3.3.cmml" xref="S3.SS4.SSS1.Px1.p1.16.m6.3.3"><times id="S3.SS4.SSS1.Px1.p1.16.m6.3.3.2.cmml" xref="S3.SS4.SSS1.Px1.p1.16.m6.3.3.2"></times><ci id="S3.SS4.SSS1.Px1.p1.16.m6.3.3.3.cmml" xref="S3.SS4.SSS1.Px1.p1.16.m6.3.3.3">softmax</ci><apply id="S3.SS4.SSS1.Px1.p1.16.m6.3.3.1.1.1.cmml" xref="S3.SS4.SSS1.Px1.p1.16.m6.3.3.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS1.Px1.p1.16.m6.3.3.1.1.1.1.cmml" xref="S3.SS4.SSS1.Px1.p1.16.m6.3.3.1.1">subscript</csymbol><ci id="S3.SS4.SSS1.Px1.p1.16.m6.3.3.1.1.1.2.cmml" xref="S3.SS4.SSS1.Px1.p1.16.m6.3.3.1.1.1.2">𝑙</ci><list id="S3.SS4.SSS1.Px1.p1.16.m6.2.2.2.3.cmml" xref="S3.SS4.SSS1.Px1.p1.16.m6.2.2.2.4"><ci id="S3.SS4.SSS1.Px1.p1.16.m6.1.1.1.1.cmml" xref="S3.SS4.SSS1.Px1.p1.16.m6.1.1.1.1">𝑠</ci><ci id="S3.SS4.SSS1.Px1.p1.16.m6.2.2.2.2.cmml" xref="S3.SS4.SSS1.Px1.p1.16.m6.2.2.2.2">𝑘</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.Px1.p1.16.m6.3c">\mathrm{softmax}(l_{s,k})</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.Px1.p1.16.m6.3d">roman_softmax ( italic_l start_POSTSUBSCRIPT italic_s , italic_k end_POSTSUBSCRIPT )</annotation></semantics></math> is a good approximation of the distribution of <math alttext="V_{s,k}" class="ltx_Math" display="inline" id="S3.SS4.SSS1.Px1.p1.17.m7.2"><semantics id="S3.SS4.SSS1.Px1.p1.17.m7.2a"><msub id="S3.SS4.SSS1.Px1.p1.17.m7.2.3" xref="S3.SS4.SSS1.Px1.p1.17.m7.2.3.cmml"><mi id="S3.SS4.SSS1.Px1.p1.17.m7.2.3.2" xref="S3.SS4.SSS1.Px1.p1.17.m7.2.3.2.cmml">V</mi><mrow id="S3.SS4.SSS1.Px1.p1.17.m7.2.2.2.4" xref="S3.SS4.SSS1.Px1.p1.17.m7.2.2.2.3.cmml"><mi id="S3.SS4.SSS1.Px1.p1.17.m7.1.1.1.1" xref="S3.SS4.SSS1.Px1.p1.17.m7.1.1.1.1.cmml">s</mi><mo id="S3.SS4.SSS1.Px1.p1.17.m7.2.2.2.4.1" xref="S3.SS4.SSS1.Px1.p1.17.m7.2.2.2.3.cmml">,</mo><mi id="S3.SS4.SSS1.Px1.p1.17.m7.2.2.2.2" xref="S3.SS4.SSS1.Px1.p1.17.m7.2.2.2.2.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.Px1.p1.17.m7.2b"><apply id="S3.SS4.SSS1.Px1.p1.17.m7.2.3.cmml" xref="S3.SS4.SSS1.Px1.p1.17.m7.2.3"><csymbol cd="ambiguous" id="S3.SS4.SSS1.Px1.p1.17.m7.2.3.1.cmml" xref="S3.SS4.SSS1.Px1.p1.17.m7.2.3">subscript</csymbol><ci id="S3.SS4.SSS1.Px1.p1.17.m7.2.3.2.cmml" xref="S3.SS4.SSS1.Px1.p1.17.m7.2.3.2">𝑉</ci><list id="S3.SS4.SSS1.Px1.p1.17.m7.2.2.2.3.cmml" xref="S3.SS4.SSS1.Px1.p1.17.m7.2.2.2.4"><ci id="S3.SS4.SSS1.Px1.p1.17.m7.1.1.1.1.cmml" xref="S3.SS4.SSS1.Px1.p1.17.m7.1.1.1.1">𝑠</ci><ci id="S3.SS4.SSS1.Px1.p1.17.m7.2.2.2.2.cmml" xref="S3.SS4.SSS1.Px1.p1.17.m7.2.2.2.2">𝑘</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.Px1.p1.17.m7.2c">V_{s,k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.Px1.p1.17.m7.2d">italic_V start_POSTSUBSCRIPT italic_s , italic_k end_POSTSUBSCRIPT</annotation></semantics></math> conditioned on all sub-sequences for the previous steps, and of the previous sub-sequences for the current step, e.g.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{cases}\mathrm{softmax}(l_{s,1})&amp;\approx\mathbb{P}\left[V_{s,1}|V_{0},%
\ldots,V_{s-1}\right]\\
\mathrm{softmax}(l_{s,k})&amp;\approx\mathbb{P}\left[V_{s,k}|V_{0},\ldots,V_{s-1},%
V_{s,1},\ldots V_{s,k-1}\right]\quad\text{if $k>1$}.\end{cases}" class="ltx_Math" display="block" id="S3.E3.m1.4"><semantics id="S3.E3.m1.4a"><mrow id="S3.E3.m1.4.4" xref="S3.E3.m1.4.5.1.cmml"><mo id="S3.E3.m1.4.4.5" xref="S3.E3.m1.4.5.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" id="S3.E3.m1.4.4.4" rowspacing="0pt" xref="S3.E3.m1.4.5.1.cmml"><mtr id="S3.E3.m1.4.4.4a" xref="S3.E3.m1.4.5.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E3.m1.4.4.4b" xref="S3.E3.m1.4.5.1.cmml"><mrow id="S3.E3.m1.2.2.2.2.1.1" xref="S3.E3.m1.2.2.2.2.1.1.cmml"><mi id="S3.E3.m1.2.2.2.2.1.1.5" xref="S3.E3.m1.2.2.2.2.1.1.5.cmml">softmax</mi><mo id="S3.E3.m1.2.2.2.2.1.1.4" xref="S3.E3.m1.2.2.2.2.1.1.4.cmml">⁢</mo><mrow id="S3.E3.m1.2.2.2.2.1.1.3.1" xref="S3.E3.m1.2.2.2.2.1.1.3.1.1.cmml"><mo id="S3.E3.m1.2.2.2.2.1.1.3.1.2" stretchy="false" xref="S3.E3.m1.2.2.2.2.1.1.3.1.1.cmml">(</mo><msub id="S3.E3.m1.2.2.2.2.1.1.3.1.1" xref="S3.E3.m1.2.2.2.2.1.1.3.1.1.cmml"><mi id="S3.E3.m1.2.2.2.2.1.1.3.1.1.2" xref="S3.E3.m1.2.2.2.2.1.1.3.1.1.2.cmml">l</mi><mrow id="S3.E3.m1.2.2.2.2.1.1.2.2.4" xref="S3.E3.m1.2.2.2.2.1.1.2.2.3.cmml"><mi id="S3.E3.m1.2.2.2.2.1.1.1.1.1" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.cmml">s</mi><mo id="S3.E3.m1.2.2.2.2.1.1.2.2.4.1" xref="S3.E3.m1.2.2.2.2.1.1.2.2.3.cmml">,</mo><mn id="S3.E3.m1.2.2.2.2.1.1.2.2.2" xref="S3.E3.m1.2.2.2.2.1.1.2.2.2.cmml">1</mn></mrow></msub><mo id="S3.E3.m1.2.2.2.2.1.1.3.1.3" stretchy="false" xref="S3.E3.m1.2.2.2.2.1.1.3.1.1.cmml">)</mo></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E3.m1.4.4.4c" xref="S3.E3.m1.4.5.1.cmml"><mrow id="S3.E3.m1.3.3.3.3.2.1" xref="S3.E3.m1.3.3.3.3.2.1.cmml"><mi id="S3.E3.m1.3.3.3.3.2.1.6" xref="S3.E3.m1.3.3.3.3.2.1.6.cmml"></mi><mo id="S3.E3.m1.3.3.3.3.2.1.5" xref="S3.E3.m1.3.3.3.3.2.1.5.cmml">≈</mo><mrow id="S3.E3.m1.3.3.3.3.2.1.4" xref="S3.E3.m1.3.3.3.3.2.1.4.cmml"><mi id="S3.E3.m1.3.3.3.3.2.1.4.3" xref="S3.E3.m1.3.3.3.3.2.1.4.3.cmml">ℙ</mi><mo id="S3.E3.m1.3.3.3.3.2.1.4.2" xref="S3.E3.m1.3.3.3.3.2.1.4.2.cmml">⁢</mo><mrow id="S3.E3.m1.3.3.3.3.2.1.4.1.1" xref="S3.E3.m1.3.3.3.3.2.1.4.1.2.cmml"><mo id="S3.E3.m1.3.3.3.3.2.1.4.1.1.2" xref="S3.E3.m1.3.3.3.3.2.1.4.1.2.1.cmml">[</mo><mrow id="S3.E3.m1.3.3.3.3.2.1.4.1.1.1" xref="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.cmml"><msub id="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.4" xref="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.4.cmml"><mi id="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.4.2" xref="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.4.2.cmml">V</mi><mrow id="S3.E3.m1.3.3.3.3.2.1.2.2.4" xref="S3.E3.m1.3.3.3.3.2.1.2.2.3.cmml"><mi id="S3.E3.m1.3.3.3.3.2.1.1.1.1" xref="S3.E3.m1.3.3.3.3.2.1.1.1.1.cmml">s</mi><mo id="S3.E3.m1.3.3.3.3.2.1.2.2.4.1" xref="S3.E3.m1.3.3.3.3.2.1.2.2.3.cmml">,</mo><mn id="S3.E3.m1.3.3.3.3.2.1.2.2.2" xref="S3.E3.m1.3.3.3.3.2.1.2.2.2.cmml">1</mn></mrow></msub><mo fence="false" id="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.3" xref="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.3.cmml">|</mo><mrow id="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.2.2" xref="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.2.3.cmml"><msub id="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.1.1.1" xref="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.1.1.1.2" xref="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.1.1.1.2.cmml">V</mi><mn id="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.1.1.1.3" xref="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.2.2.3" xref="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.2.3.cmml">,</mo><mi id="S3.E3.m1.3.3.3.3.2.1.3" mathvariant="normal" xref="S3.E3.m1.3.3.3.3.2.1.3.cmml">…</mi><mo id="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.2.2.4" xref="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.2.3.cmml">,</mo><msub id="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.2.2.2" xref="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.2.2.2.cmml"><mi id="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.2.2.2.2" xref="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.2.2.2.2.cmml">V</mi><mrow id="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.2.2.2.3" xref="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.2.2.2.3.cmml"><mi id="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.2.2.2.3.2" xref="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.2.2.2.3.2.cmml">s</mi><mo id="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.2.2.2.3.1" xref="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.2.2.2.3.1.cmml">−</mo><mn id="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.2.2.2.3.3" xref="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.2.2.2.3.3.cmml">1</mn></mrow></msub></mrow></mrow><mo id="S3.E3.m1.3.3.3.3.2.1.4.1.1.3" xref="S3.E3.m1.3.3.3.3.2.1.4.1.2.1.cmml">]</mo></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E3.m1.4.4.4d" xref="S3.E3.m1.4.5.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E3.m1.4.4.4e" xref="S3.E3.m1.4.5.1.cmml"><mrow id="S3.E3.m1.4.4.4.4.2.1" xref="S3.E3.m1.4.4.4.4.2.1.cmml"><mi id="S3.E3.m1.4.4.4.4.2.1.5" xref="S3.E3.m1.4.4.4.4.2.1.5.cmml">softmax</mi><mo id="S3.E3.m1.4.4.4.4.2.1.4" xref="S3.E3.m1.4.4.4.4.2.1.4.cmml">⁢</mo><mrow id="S3.E3.m1.4.4.4.4.2.1.3.1" xref="S3.E3.m1.4.4.4.4.2.1.3.1.1.cmml"><mo id="S3.E3.m1.4.4.4.4.2.1.3.1.2" stretchy="false" xref="S3.E3.m1.4.4.4.4.2.1.3.1.1.cmml">(</mo><msub id="S3.E3.m1.4.4.4.4.2.1.3.1.1" xref="S3.E3.m1.4.4.4.4.2.1.3.1.1.cmml"><mi id="S3.E3.m1.4.4.4.4.2.1.3.1.1.2" xref="S3.E3.m1.4.4.4.4.2.1.3.1.1.2.cmml">l</mi><mrow id="S3.E3.m1.4.4.4.4.2.1.2.2.4" xref="S3.E3.m1.4.4.4.4.2.1.2.2.3.cmml"><mi id="S3.E3.m1.4.4.4.4.2.1.1.1.1" xref="S3.E3.m1.4.4.4.4.2.1.1.1.1.cmml">s</mi><mo id="S3.E3.m1.4.4.4.4.2.1.2.2.4.1" xref="S3.E3.m1.4.4.4.4.2.1.2.2.3.cmml">,</mo><mi id="S3.E3.m1.4.4.4.4.2.1.2.2.2" xref="S3.E3.m1.4.4.4.4.2.1.2.2.2.cmml">k</mi></mrow></msub><mo id="S3.E3.m1.4.4.4.4.2.1.3.1.3" stretchy="false" xref="S3.E3.m1.4.4.4.4.2.1.3.1.1.cmml">)</mo></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E3.m1.4.4.4f" xref="S3.E3.m1.4.5.1.cmml"><mrow id="S3.E3.m1.1.1.1.1.1.1.9" xref="S3.E3.m1.1.1.1.1.1.1.9.1.cmml"><mrow id="S3.E3.m1.1.1.1.1.1.1.9.1" xref="S3.E3.m1.1.1.1.1.1.1.9.1.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.9.1.3" xref="S3.E3.m1.1.1.1.1.1.1.9.1.3.cmml"></mi><mo id="S3.E3.m1.1.1.1.1.1.1.9.1.2" xref="S3.E3.m1.1.1.1.1.1.1.9.1.2.cmml">≈</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.2.cmml"><mrow id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.3.cmml">ℙ</mi><mo id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.2.cmml"><mo id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.cmml"><msub id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.6" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.6.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.6.2" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.6.2.cmml">V</mi><mrow id="S3.E3.m1.1.1.1.1.1.1.3.2.4" xref="S3.E3.m1.1.1.1.1.1.1.3.2.3.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.2.1.1" xref="S3.E3.m1.1.1.1.1.1.1.2.1.1.cmml">s</mi><mo id="S3.E3.m1.1.1.1.1.1.1.3.2.4.1" xref="S3.E3.m1.1.1.1.1.1.1.3.2.3.cmml">,</mo><mi id="S3.E3.m1.1.1.1.1.1.1.3.2.2" xref="S3.E3.m1.1.1.1.1.1.1.3.2.2.cmml">k</mi></mrow></msub><mo fence="false" id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.5" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.5.cmml">|</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.4.4" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.4.5.cmml"><msub id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.1.1.1.2.cmml">V</mi><mn id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.4.4.5" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.4.5.cmml">,</mo><mi id="S3.E3.m1.1.1.1.1.1.1.8" mathvariant="normal" xref="S3.E3.m1.1.1.1.1.1.1.8.cmml">…</mi><mo id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.4.4.6" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.4.5.cmml">,</mo><msub id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.2.2.2" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.2.2.2.2.cmml">V</mi><mrow id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.2.2.2.3.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.2.2.2.3.2" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.2.2.2.3.2.cmml">s</mi><mo id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.2.2.2.3.1" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.2.2.2.3.1.cmml">−</mo><mn id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.2.2.2.3.3" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.2.2.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.4.4.7" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.4.5.cmml">,</mo><msub id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.3.3.3" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.3.3.3.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.3.3.3.2" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.3.3.3.2.cmml">V</mi><mrow id="S3.E3.m1.1.1.1.1.1.1.5.2.4" xref="S3.E3.m1.1.1.1.1.1.1.5.2.3.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.4.1.1" xref="S3.E3.m1.1.1.1.1.1.1.4.1.1.cmml">s</mi><mo id="S3.E3.m1.1.1.1.1.1.1.5.2.4.1" xref="S3.E3.m1.1.1.1.1.1.1.5.2.3.cmml">,</mo><mn id="S3.E3.m1.1.1.1.1.1.1.5.2.2" xref="S3.E3.m1.1.1.1.1.1.1.5.2.2.cmml">1</mn></mrow></msub><mo id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.4.4.8" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.4.5.cmml">,</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.4.4.4" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.4.4.4.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.4.4.4.2" mathvariant="normal" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.4.4.4.2.cmml">…</mi><mo id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.4.4.4.1" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.4.4.4.1.cmml">⁢</mo><msub id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.4.4.4.3" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.4.4.4.3.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.4.4.4.3.2" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.4.4.4.3.2.cmml">V</mi><mrow id="S3.E3.m1.1.1.1.1.1.1.7.2.2" xref="S3.E3.m1.1.1.1.1.1.1.7.2.3.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.6.1.1" xref="S3.E3.m1.1.1.1.1.1.1.6.1.1.cmml">s</mi><mo id="S3.E3.m1.1.1.1.1.1.1.7.2.2.2" xref="S3.E3.m1.1.1.1.1.1.1.7.2.3.cmml">,</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.7.2.2.1" xref="S3.E3.m1.1.1.1.1.1.1.7.2.2.1.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.7.2.2.1.2" xref="S3.E3.m1.1.1.1.1.1.1.7.2.2.1.2.cmml">k</mi><mo id="S3.E3.m1.1.1.1.1.1.1.7.2.2.1.1" xref="S3.E3.m1.1.1.1.1.1.1.7.2.2.1.1.cmml">−</mo><mn id="S3.E3.m1.1.1.1.1.1.1.7.2.2.1.3" xref="S3.E3.m1.1.1.1.1.1.1.7.2.2.1.3.cmml">1</mn></mrow></mrow></msub></mrow></mrow></mrow><mo id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mspace id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.2" width="1em" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.2.cmml"></mspace><mrow id="S3.E3.m1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1b.cmml"><mtext id="S3.E3.m1.1.1.1.1.1.1.1.1a" xref="S3.E3.m1.1.1.1.1.1.1.1.1b.cmml">if&nbsp;</mtext><mrow id="S3.E3.m1.1.1.1.1.1.1.1.1.m1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.m1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml">k</mi><mo id="S3.E3.m1.1.1.1.1.1.1.1.1.m1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml">&gt;</mo><mn id="S3.E3.m1.1.1.1.1.1.1.1.1.m1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml">1</mn></mrow></mrow></mrow></mrow><mo id="S3.E3.m1.1.1.1.1.1.1.9.2" lspace="0em" xref="S3.E3.m1.1.1.1.1.1.1.9.1.cmml">.</mo></mrow></mtd></mtr></mtable></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.4b"><apply id="S3.E3.m1.4.5.1.cmml" xref="S3.E3.m1.4.4"><csymbol cd="latexml" id="S3.E3.m1.4.5.1.1.cmml" xref="S3.E3.m1.4.4.5">cases</csymbol><apply id="S3.E3.m1.2.2.2.2.1.1.cmml" xref="S3.E3.m1.2.2.2.2.1.1"><times id="S3.E3.m1.2.2.2.2.1.1.4.cmml" xref="S3.E3.m1.2.2.2.2.1.1.4"></times><ci id="S3.E3.m1.2.2.2.2.1.1.5.cmml" xref="S3.E3.m1.2.2.2.2.1.1.5">softmax</ci><apply id="S3.E3.m1.2.2.2.2.1.1.3.1.1.cmml" xref="S3.E3.m1.2.2.2.2.1.1.3.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.2.1.1.3.1.1.1.cmml" xref="S3.E3.m1.2.2.2.2.1.1.3.1">subscript</csymbol><ci id="S3.E3.m1.2.2.2.2.1.1.3.1.1.2.cmml" xref="S3.E3.m1.2.2.2.2.1.1.3.1.1.2">𝑙</ci><list id="S3.E3.m1.2.2.2.2.1.1.2.2.3.cmml" xref="S3.E3.m1.2.2.2.2.1.1.2.2.4"><ci id="S3.E3.m1.2.2.2.2.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1">𝑠</ci><cn id="S3.E3.m1.2.2.2.2.1.1.2.2.2.cmml" type="integer" xref="S3.E3.m1.2.2.2.2.1.1.2.2.2">1</cn></list></apply></apply><apply id="S3.E3.m1.3.3.3.3.2.1.cmml" xref="S3.E3.m1.3.3.3.3.2.1"><approx id="S3.E3.m1.3.3.3.3.2.1.5.cmml" xref="S3.E3.m1.3.3.3.3.2.1.5"></approx><csymbol cd="latexml" id="S3.E3.m1.3.3.3.3.2.1.6.cmml" xref="S3.E3.m1.3.3.3.3.2.1.6">absent</csymbol><apply id="S3.E3.m1.3.3.3.3.2.1.4.cmml" xref="S3.E3.m1.3.3.3.3.2.1.4"><times id="S3.E3.m1.3.3.3.3.2.1.4.2.cmml" xref="S3.E3.m1.3.3.3.3.2.1.4.2"></times><ci id="S3.E3.m1.3.3.3.3.2.1.4.3.cmml" xref="S3.E3.m1.3.3.3.3.2.1.4.3">ℙ</ci><apply id="S3.E3.m1.3.3.3.3.2.1.4.1.2.cmml" xref="S3.E3.m1.3.3.3.3.2.1.4.1.1"><csymbol cd="latexml" id="S3.E3.m1.3.3.3.3.2.1.4.1.2.1.cmml" xref="S3.E3.m1.3.3.3.3.2.1.4.1.1.2">delimited-[]</csymbol><apply id="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.cmml" xref="S3.E3.m1.3.3.3.3.2.1.4.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.3.cmml" xref="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.3">conditional</csymbol><apply id="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.4.cmml" xref="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.4"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.4.1.cmml" xref="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.4">subscript</csymbol><ci id="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.4.2.cmml" xref="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.4.2">𝑉</ci><list id="S3.E3.m1.3.3.3.3.2.1.2.2.3.cmml" xref="S3.E3.m1.3.3.3.3.2.1.2.2.4"><ci id="S3.E3.m1.3.3.3.3.2.1.1.1.1.cmml" xref="S3.E3.m1.3.3.3.3.2.1.1.1.1">𝑠</ci><cn id="S3.E3.m1.3.3.3.3.2.1.2.2.2.cmml" type="integer" xref="S3.E3.m1.3.3.3.3.2.1.2.2.2">1</cn></list></apply><list id="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.2.3.cmml" xref="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.2.2"><apply id="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.1.1.1.cmml" xref="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.1.1.1.2">𝑉</ci><cn id="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.1.1.1.3">0</cn></apply><ci id="S3.E3.m1.3.3.3.3.2.1.3.cmml" xref="S3.E3.m1.3.3.3.3.2.1.3">…</ci><apply id="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.2.2.2.cmml" xref="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.2.2.2.1.cmml" xref="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.2.2.2.2.cmml" xref="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.2.2.2.2">𝑉</ci><apply id="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.2.2.2.3.cmml" xref="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.2.2.2.3"><minus id="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.2.2.2.3.1.cmml" xref="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.2.2.2.3.1"></minus><ci id="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.2.2.2.3.2.cmml" xref="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.2.2.2.3.2">𝑠</ci><cn id="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.2.2.2.3.3.cmml" type="integer" xref="S3.E3.m1.3.3.3.3.2.1.4.1.1.1.2.2.2.3.3">1</cn></apply></apply></list></apply></apply></apply></apply><apply id="S3.E3.m1.4.4.4.4.2.1.cmml" xref="S3.E3.m1.4.4.4.4.2.1"><times id="S3.E3.m1.4.4.4.4.2.1.4.cmml" xref="S3.E3.m1.4.4.4.4.2.1.4"></times><ci id="S3.E3.m1.4.4.4.4.2.1.5.cmml" xref="S3.E3.m1.4.4.4.4.2.1.5">softmax</ci><apply id="S3.E3.m1.4.4.4.4.2.1.3.1.1.cmml" xref="S3.E3.m1.4.4.4.4.2.1.3.1"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.4.4.2.1.3.1.1.1.cmml" xref="S3.E3.m1.4.4.4.4.2.1.3.1">subscript</csymbol><ci id="S3.E3.m1.4.4.4.4.2.1.3.1.1.2.cmml" xref="S3.E3.m1.4.4.4.4.2.1.3.1.1.2">𝑙</ci><list id="S3.E3.m1.4.4.4.4.2.1.2.2.3.cmml" xref="S3.E3.m1.4.4.4.4.2.1.2.2.4"><ci id="S3.E3.m1.4.4.4.4.2.1.1.1.1.cmml" xref="S3.E3.m1.4.4.4.4.2.1.1.1.1">𝑠</ci><ci id="S3.E3.m1.4.4.4.4.2.1.2.2.2.cmml" xref="S3.E3.m1.4.4.4.4.2.1.2.2.2">𝑘</ci></list></apply></apply><apply id="S3.E3.m1.1.1.1.1.1.1.9.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.9"><approx id="S3.E3.m1.1.1.1.1.1.1.9.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.9.1.2"></approx><csymbol cd="latexml" id="S3.E3.m1.1.1.1.1.1.1.9.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.9.1.3">absent</csymbol><list id="S3.E3.m1.1.1.1.1.1.1.9.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1"><apply id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1"><times id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.2"></times><ci id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.3">ℙ</ci><apply id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.5.cmml" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.5">conditional</csymbol><apply id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.6.cmml" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.6"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.6.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.6">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.6.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.6.2">𝑉</ci><list id="S3.E3.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.4"><ci id="S3.E3.m1.1.1.1.1.1.1.2.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.1.1">𝑠</ci><ci id="S3.E3.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.2">𝑘</ci></list></apply><list id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.4.5.cmml" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.4.4"><apply id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.1.1.1.2">𝑉</ci><cn id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.1.1.1.3">0</cn></apply><ci id="S3.E3.m1.1.1.1.1.1.1.8.cmml" xref="S3.E3.m1.1.1.1.1.1.1.8">…</ci><apply id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.2.2.2.2">𝑉</ci><apply id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.2.2.2.3"><minus id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.2.2.2.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.2.2.2.3.1"></minus><ci id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.2.2.2.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.2.2.2.3.2">𝑠</ci><cn id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.2.2.2.3.3.cmml" type="integer" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.2.2.2.3.3">1</cn></apply></apply><apply id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.3.3.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.3.3.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.3.3.3.2">𝑉</ci><list id="S3.E3.m1.1.1.1.1.1.1.5.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.5.2.4"><ci id="S3.E3.m1.1.1.1.1.1.1.4.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.4.1.1">𝑠</ci><cn id="S3.E3.m1.1.1.1.1.1.1.5.2.2.cmml" type="integer" xref="S3.E3.m1.1.1.1.1.1.1.5.2.2">1</cn></list></apply><apply id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.4.4.4.cmml" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.4.4.4"><times id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.4.4.4.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.4.4.4.1"></times><ci id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.4.4.4.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.4.4.4.2">…</ci><apply id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.4.4.4.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.4.4.4.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.4.4.4.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.4.4.4.3">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.4.4.4.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.9.1.1.1.1.1.1.1.4.4.4.3.2">𝑉</ci><list id="S3.E3.m1.1.1.1.1.1.1.7.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.7.2.2"><ci id="S3.E3.m1.1.1.1.1.1.1.6.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.6.1.1">𝑠</ci><apply id="S3.E3.m1.1.1.1.1.1.1.7.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.7.2.2.1"><minus id="S3.E3.m1.1.1.1.1.1.1.7.2.2.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.7.2.2.1.1"></minus><ci id="S3.E3.m1.1.1.1.1.1.1.7.2.2.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.7.2.2.1.2">𝑘</ci><cn id="S3.E3.m1.1.1.1.1.1.1.7.2.2.1.3.cmml" type="integer" xref="S3.E3.m1.1.1.1.1.1.1.7.2.2.1.3">1</cn></apply></list></apply></apply></list></apply></apply></apply><ci id="S3.E3.m1.1.1.1.1.1.1.1.1b.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1"><mrow id="S3.E3.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1"><mtext id="S3.E3.m1.1.1.1.1.1.1.1.1a.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1">if&nbsp;</mtext><mrow id="S3.E3.m1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.m1.1.1"><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.m1.1.1.2">k</mi><mo id="S3.E3.m1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.m1.1.1.1">&gt;</mo><mn id="S3.E3.m1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.m1.1.1.3">1</mn></mrow></mrow></ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.4c">\begin{cases}\mathrm{softmax}(l_{s,1})&amp;\approx\mathbb{P}\left[V_{s,1}|V_{0},%
\ldots,V_{s-1}\right]\\
\mathrm{softmax}(l_{s,k})&amp;\approx\mathbb{P}\left[V_{s,k}|V_{0},\ldots,V_{s-1},%
V_{s,1},\ldots V_{s,k-1}\right]\quad\text{if $k&gt;1$}.\end{cases}</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.4d">{ start_ROW start_CELL roman_softmax ( italic_l start_POSTSUBSCRIPT italic_s , 1 end_POSTSUBSCRIPT ) end_CELL start_CELL ≈ blackboard_P [ italic_V start_POSTSUBSCRIPT italic_s , 1 end_POSTSUBSCRIPT | italic_V start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , … , italic_V start_POSTSUBSCRIPT italic_s - 1 end_POSTSUBSCRIPT ] end_CELL end_ROW start_ROW start_CELL roman_softmax ( italic_l start_POSTSUBSCRIPT italic_s , italic_k end_POSTSUBSCRIPT ) end_CELL start_CELL ≈ blackboard_P [ italic_V start_POSTSUBSCRIPT italic_s , italic_k end_POSTSUBSCRIPT | italic_V start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , … , italic_V start_POSTSUBSCRIPT italic_s - 1 end_POSTSUBSCRIPT , italic_V start_POSTSUBSCRIPT italic_s , 1 end_POSTSUBSCRIPT , … italic_V start_POSTSUBSCRIPT italic_s , italic_k - 1 end_POSTSUBSCRIPT ] if italic_k &gt; 1 . end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.SSS1.Px1.p1.26">Importantly, the number of steps in the Temporal Transformer is always equal to <math alttext="S" class="ltx_Math" display="inline" id="S3.SS4.SSS1.Px1.p1.18.m1.1"><semantics id="S3.SS4.SSS1.Px1.p1.18.m1.1a"><mi id="S3.SS4.SSS1.Px1.p1.18.m1.1.1" xref="S3.SS4.SSS1.Px1.p1.18.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.Px1.p1.18.m1.1b"><ci id="S3.SS4.SSS1.Px1.p1.18.m1.1.1.cmml" xref="S3.SS4.SSS1.Px1.p1.18.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.Px1.p1.18.m1.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.Px1.p1.18.m1.1d">italic_S</annotation></semantics></math>, rather than <math alttext="K\cdot S" class="ltx_Math" display="inline" id="S3.SS4.SSS1.Px1.p1.19.m2.1"><semantics id="S3.SS4.SSS1.Px1.p1.19.m2.1a"><mrow id="S3.SS4.SSS1.Px1.p1.19.m2.1.1" xref="S3.SS4.SSS1.Px1.p1.19.m2.1.1.cmml"><mi id="S3.SS4.SSS1.Px1.p1.19.m2.1.1.2" xref="S3.SS4.SSS1.Px1.p1.19.m2.1.1.2.cmml">K</mi><mo id="S3.SS4.SSS1.Px1.p1.19.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS4.SSS1.Px1.p1.19.m2.1.1.1.cmml">⋅</mo><mi id="S3.SS4.SSS1.Px1.p1.19.m2.1.1.3" xref="S3.SS4.SSS1.Px1.p1.19.m2.1.1.3.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.Px1.p1.19.m2.1b"><apply id="S3.SS4.SSS1.Px1.p1.19.m2.1.1.cmml" xref="S3.SS4.SSS1.Px1.p1.19.m2.1.1"><ci id="S3.SS4.SSS1.Px1.p1.19.m2.1.1.1.cmml" xref="S3.SS4.SSS1.Px1.p1.19.m2.1.1.1">⋅</ci><ci id="S3.SS4.SSS1.Px1.p1.19.m2.1.1.2.cmml" xref="S3.SS4.SSS1.Px1.p1.19.m2.1.1.2">𝐾</ci><ci id="S3.SS4.SSS1.Px1.p1.19.m2.1.1.3.cmml" xref="S3.SS4.SSS1.Px1.p1.19.m2.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.Px1.p1.19.m2.1c">K\cdot S</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.Px1.p1.19.m2.1d">italic_K ⋅ italic_S</annotation></semantics></math>, and the number of steps in the Depth Transformer is at most <math alttext="K" class="ltx_Math" display="inline" id="S3.SS4.SSS1.Px1.p1.20.m3.1"><semantics id="S3.SS4.SSS1.Px1.p1.20.m3.1a"><mi id="S3.SS4.SSS1.Px1.p1.20.m3.1.1" xref="S3.SS4.SSS1.Px1.p1.20.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.Px1.p1.20.m3.1b"><ci id="S3.SS4.SSS1.Px1.p1.20.m3.1.1.cmml" xref="S3.SS4.SSS1.Px1.p1.20.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.Px1.p1.20.m3.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.Px1.p1.20.m3.1d">italic_K</annotation></semantics></math>.
In practice, the Temporal Transformer receives at each step <math alttext="s" class="ltx_Math" display="inline" id="S3.SS4.SSS1.Px1.p1.21.m4.1"><semantics id="S3.SS4.SSS1.Px1.p1.21.m4.1a"><mi id="S3.SS4.SSS1.Px1.p1.21.m4.1.1" xref="S3.SS4.SSS1.Px1.p1.21.m4.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.Px1.p1.21.m4.1b"><ci id="S3.SS4.SSS1.Px1.p1.21.m4.1.1.cmml" xref="S3.SS4.SSS1.Px1.p1.21.m4.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.Px1.p1.21.m4.1c">s</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.Px1.p1.21.m4.1d">italic_s</annotation></semantics></math> as input the sum of <math alttext="K" class="ltx_Math" display="inline" id="S3.SS4.SSS1.Px1.p1.22.m5.1"><semantics id="S3.SS4.SSS1.Px1.p1.22.m5.1a"><mi id="S3.SS4.SSS1.Px1.p1.22.m5.1.1" xref="S3.SS4.SSS1.Px1.p1.22.m5.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.Px1.p1.22.m5.1b"><ci id="S3.SS4.SSS1.Px1.p1.22.m5.1.1.cmml" xref="S3.SS4.SSS1.Px1.p1.22.m5.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.Px1.p1.22.m5.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.Px1.p1.22.m5.1d">italic_K</annotation></semantics></math> learnt embedding tables representing the value for the last <math alttext="V_{s-1}" class="ltx_Math" display="inline" id="S3.SS4.SSS1.Px1.p1.23.m6.1"><semantics id="S3.SS4.SSS1.Px1.p1.23.m6.1a"><msub id="S3.SS4.SSS1.Px1.p1.23.m6.1.1" xref="S3.SS4.SSS1.Px1.p1.23.m6.1.1.cmml"><mi id="S3.SS4.SSS1.Px1.p1.23.m6.1.1.2" xref="S3.SS4.SSS1.Px1.p1.23.m6.1.1.2.cmml">V</mi><mrow id="S3.SS4.SSS1.Px1.p1.23.m6.1.1.3" xref="S3.SS4.SSS1.Px1.p1.23.m6.1.1.3.cmml"><mi id="S3.SS4.SSS1.Px1.p1.23.m6.1.1.3.2" xref="S3.SS4.SSS1.Px1.p1.23.m6.1.1.3.2.cmml">s</mi><mo id="S3.SS4.SSS1.Px1.p1.23.m6.1.1.3.1" xref="S3.SS4.SSS1.Px1.p1.23.m6.1.1.3.1.cmml">−</mo><mn id="S3.SS4.SSS1.Px1.p1.23.m6.1.1.3.3" xref="S3.SS4.SSS1.Px1.p1.23.m6.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.Px1.p1.23.m6.1b"><apply id="S3.SS4.SSS1.Px1.p1.23.m6.1.1.cmml" xref="S3.SS4.SSS1.Px1.p1.23.m6.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS1.Px1.p1.23.m6.1.1.1.cmml" xref="S3.SS4.SSS1.Px1.p1.23.m6.1.1">subscript</csymbol><ci id="S3.SS4.SSS1.Px1.p1.23.m6.1.1.2.cmml" xref="S3.SS4.SSS1.Px1.p1.23.m6.1.1.2">𝑉</ci><apply id="S3.SS4.SSS1.Px1.p1.23.m6.1.1.3.cmml" xref="S3.SS4.SSS1.Px1.p1.23.m6.1.1.3"><minus id="S3.SS4.SSS1.Px1.p1.23.m6.1.1.3.1.cmml" xref="S3.SS4.SSS1.Px1.p1.23.m6.1.1.3.1"></minus><ci id="S3.SS4.SSS1.Px1.p1.23.m6.1.1.3.2.cmml" xref="S3.SS4.SSS1.Px1.p1.23.m6.1.1.3.2">𝑠</ci><cn id="S3.SS4.SSS1.Px1.p1.23.m6.1.1.3.3.cmml" type="integer" xref="S3.SS4.SSS1.Px1.p1.23.m6.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.Px1.p1.23.m6.1c">V_{s-1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.Px1.p1.23.m6.1d">italic_V start_POSTSUBSCRIPT italic_s - 1 end_POSTSUBSCRIPT</annotation></semantics></math>.
Given <math alttext="1<k\leq K" class="ltx_Math" display="inline" id="S3.SS4.SSS1.Px1.p1.24.m7.1"><semantics id="S3.SS4.SSS1.Px1.p1.24.m7.1a"><mrow id="S3.SS4.SSS1.Px1.p1.24.m7.1.1" xref="S3.SS4.SSS1.Px1.p1.24.m7.1.1.cmml"><mn id="S3.SS4.SSS1.Px1.p1.24.m7.1.1.2" xref="S3.SS4.SSS1.Px1.p1.24.m7.1.1.2.cmml">1</mn><mo id="S3.SS4.SSS1.Px1.p1.24.m7.1.1.3" xref="S3.SS4.SSS1.Px1.p1.24.m7.1.1.3.cmml">&lt;</mo><mi id="S3.SS4.SSS1.Px1.p1.24.m7.1.1.4" xref="S3.SS4.SSS1.Px1.p1.24.m7.1.1.4.cmml">k</mi><mo id="S3.SS4.SSS1.Px1.p1.24.m7.1.1.5" xref="S3.SS4.SSS1.Px1.p1.24.m7.1.1.5.cmml">≤</mo><mi id="S3.SS4.SSS1.Px1.p1.24.m7.1.1.6" xref="S3.SS4.SSS1.Px1.p1.24.m7.1.1.6.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.Px1.p1.24.m7.1b"><apply id="S3.SS4.SSS1.Px1.p1.24.m7.1.1.cmml" xref="S3.SS4.SSS1.Px1.p1.24.m7.1.1"><and id="S3.SS4.SSS1.Px1.p1.24.m7.1.1a.cmml" xref="S3.SS4.SSS1.Px1.p1.24.m7.1.1"></and><apply id="S3.SS4.SSS1.Px1.p1.24.m7.1.1b.cmml" xref="S3.SS4.SSS1.Px1.p1.24.m7.1.1"><lt id="S3.SS4.SSS1.Px1.p1.24.m7.1.1.3.cmml" xref="S3.SS4.SSS1.Px1.p1.24.m7.1.1.3"></lt><cn id="S3.SS4.SSS1.Px1.p1.24.m7.1.1.2.cmml" type="integer" xref="S3.SS4.SSS1.Px1.p1.24.m7.1.1.2">1</cn><ci id="S3.SS4.SSS1.Px1.p1.24.m7.1.1.4.cmml" xref="S3.SS4.SSS1.Px1.p1.24.m7.1.1.4">𝑘</ci></apply><apply id="S3.SS4.SSS1.Px1.p1.24.m7.1.1c.cmml" xref="S3.SS4.SSS1.Px1.p1.24.m7.1.1"><leq id="S3.SS4.SSS1.Px1.p1.24.m7.1.1.5.cmml" xref="S3.SS4.SSS1.Px1.p1.24.m7.1.1.5"></leq><share href="https://arxiv.org/html/2410.00037v2#S3.SS4.SSS1.Px1.p1.24.m7.1.1.4.cmml" id="S3.SS4.SSS1.Px1.p1.24.m7.1.1d.cmml" xref="S3.SS4.SSS1.Px1.p1.24.m7.1.1"></share><ci id="S3.SS4.SSS1.Px1.p1.24.m7.1.1.6.cmml" xref="S3.SS4.SSS1.Px1.p1.24.m7.1.1.6">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.Px1.p1.24.m7.1c">1&lt;k\leq K</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.Px1.p1.24.m7.1d">1 &lt; italic_k ≤ italic_K</annotation></semantics></math>, the Depth Transformer receives as input the sum of <math alttext="z_{s}" class="ltx_Math" display="inline" id="S3.SS4.SSS1.Px1.p1.25.m8.1"><semantics id="S3.SS4.SSS1.Px1.p1.25.m8.1a"><msub id="S3.SS4.SSS1.Px1.p1.25.m8.1.1" xref="S3.SS4.SSS1.Px1.p1.25.m8.1.1.cmml"><mi id="S3.SS4.SSS1.Px1.p1.25.m8.1.1.2" xref="S3.SS4.SSS1.Px1.p1.25.m8.1.1.2.cmml">z</mi><mi id="S3.SS4.SSS1.Px1.p1.25.m8.1.1.3" xref="S3.SS4.SSS1.Px1.p1.25.m8.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.Px1.p1.25.m8.1b"><apply id="S3.SS4.SSS1.Px1.p1.25.m8.1.1.cmml" xref="S3.SS4.SSS1.Px1.p1.25.m8.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS1.Px1.p1.25.m8.1.1.1.cmml" xref="S3.SS4.SSS1.Px1.p1.25.m8.1.1">subscript</csymbol><ci id="S3.SS4.SSS1.Px1.p1.25.m8.1.1.2.cmml" xref="S3.SS4.SSS1.Px1.p1.25.m8.1.1.2">𝑧</ci><ci id="S3.SS4.SSS1.Px1.p1.25.m8.1.1.3.cmml" xref="S3.SS4.SSS1.Px1.p1.25.m8.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.Px1.p1.25.m8.1c">z_{s}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.Px1.p1.25.m8.1d">italic_z start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> and of a learnt embedding representing <math alttext="V_{s,k-1}" class="ltx_Math" display="inline" id="S3.SS4.SSS1.Px1.p1.26.m9.2"><semantics id="S3.SS4.SSS1.Px1.p1.26.m9.2a"><msub id="S3.SS4.SSS1.Px1.p1.26.m9.2.3" xref="S3.SS4.SSS1.Px1.p1.26.m9.2.3.cmml"><mi id="S3.SS4.SSS1.Px1.p1.26.m9.2.3.2" xref="S3.SS4.SSS1.Px1.p1.26.m9.2.3.2.cmml">V</mi><mrow id="S3.SS4.SSS1.Px1.p1.26.m9.2.2.2.2" xref="S3.SS4.SSS1.Px1.p1.26.m9.2.2.2.3.cmml"><mi id="S3.SS4.SSS1.Px1.p1.26.m9.1.1.1.1" xref="S3.SS4.SSS1.Px1.p1.26.m9.1.1.1.1.cmml">s</mi><mo id="S3.SS4.SSS1.Px1.p1.26.m9.2.2.2.2.2" xref="S3.SS4.SSS1.Px1.p1.26.m9.2.2.2.3.cmml">,</mo><mrow id="S3.SS4.SSS1.Px1.p1.26.m9.2.2.2.2.1" xref="S3.SS4.SSS1.Px1.p1.26.m9.2.2.2.2.1.cmml"><mi id="S3.SS4.SSS1.Px1.p1.26.m9.2.2.2.2.1.2" xref="S3.SS4.SSS1.Px1.p1.26.m9.2.2.2.2.1.2.cmml">k</mi><mo id="S3.SS4.SSS1.Px1.p1.26.m9.2.2.2.2.1.1" xref="S3.SS4.SSS1.Px1.p1.26.m9.2.2.2.2.1.1.cmml">−</mo><mn id="S3.SS4.SSS1.Px1.p1.26.m9.2.2.2.2.1.3" xref="S3.SS4.SSS1.Px1.p1.26.m9.2.2.2.2.1.3.cmml">1</mn></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.Px1.p1.26.m9.2b"><apply id="S3.SS4.SSS1.Px1.p1.26.m9.2.3.cmml" xref="S3.SS4.SSS1.Px1.p1.26.m9.2.3"><csymbol cd="ambiguous" id="S3.SS4.SSS1.Px1.p1.26.m9.2.3.1.cmml" xref="S3.SS4.SSS1.Px1.p1.26.m9.2.3">subscript</csymbol><ci id="S3.SS4.SSS1.Px1.p1.26.m9.2.3.2.cmml" xref="S3.SS4.SSS1.Px1.p1.26.m9.2.3.2">𝑉</ci><list id="S3.SS4.SSS1.Px1.p1.26.m9.2.2.2.3.cmml" xref="S3.SS4.SSS1.Px1.p1.26.m9.2.2.2.2"><ci id="S3.SS4.SSS1.Px1.p1.26.m9.1.1.1.1.cmml" xref="S3.SS4.SSS1.Px1.p1.26.m9.1.1.1.1">𝑠</ci><apply id="S3.SS4.SSS1.Px1.p1.26.m9.2.2.2.2.1.cmml" xref="S3.SS4.SSS1.Px1.p1.26.m9.2.2.2.2.1"><minus id="S3.SS4.SSS1.Px1.p1.26.m9.2.2.2.2.1.1.cmml" xref="S3.SS4.SSS1.Px1.p1.26.m9.2.2.2.2.1.1"></minus><ci id="S3.SS4.SSS1.Px1.p1.26.m9.2.2.2.2.1.2.cmml" xref="S3.SS4.SSS1.Px1.p1.26.m9.2.2.2.2.1.2">𝑘</ci><cn id="S3.SS4.SSS1.Px1.p1.26.m9.2.2.2.2.1.3.cmml" type="integer" xref="S3.SS4.SSS1.Px1.p1.26.m9.2.2.2.2.1.3">1</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.Px1.p1.26.m9.2c">V_{s,k-1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.Px1.p1.26.m9.2d">italic_V start_POSTSUBSCRIPT italic_s , italic_k - 1 end_POSTSUBSCRIPT</annotation></semantics></math>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S3.SS4.SSS1.Px1.p2">
<p class="ltx_p" id="S3.SS4.SSS1.Px1.p2.1">As detailed in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.T1" title="Table 1 ‣ 3.2.1 Architecture ‣ 3.2 The Helium Text Language Model ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue">Table <span class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></span></a>, our Depth Transformer has 6 layers, a dimension of 1024, and 16 attention heads. Unlike <cite class="ltx_cite ltx_citemacro_citet">Lee et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib55" title="">2022</a>); Yang et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib105" title="">2023</a>); Zhu et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib117" title="">2024</a>)</cite>, we use different parameters per index <math alttext="k" class="ltx_Math" display="inline" id="S3.SS4.SSS1.Px1.p2.1.m1.1"><semantics id="S3.SS4.SSS1.Px1.p2.1.m1.1a"><mi id="S3.SS4.SSS1.Px1.p2.1.m1.1.1" xref="S3.SS4.SSS1.Px1.p2.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.Px1.p2.1.m1.1b"><ci id="S3.SS4.SSS1.Px1.p2.1.m1.1.1.cmml" xref="S3.SS4.SSS1.Px1.p2.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.Px1.p2.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.Px1.p2.1.m1.1d">italic_k</annotation></semantics></math> for the linear layers, projection and fully connected, in the Depth Transformer. Indeed, different sub-sequences might require different transformations. Given the smaller size of this Transformer, this has no impact on both training and inference time, while <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.T6" title="Table 6 ‣ Discussion. ‣ 5.2 Audio Tokenization ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue">Table&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></span></a> shows that this depthwise parametrization is beneficial.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_subsubsection" id="S3.SS4.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.4.2 </span>Audio modeling</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.SS4.SSS2.p1">
<p class="ltx_p" id="S3.SS4.SSS2.p1.8">The audio codec Mimi described in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS3" title="3.3 Audio Tokenization ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue">Section&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></span></a> outputs <math alttext="Q" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p1.1.m1.1"><semantics id="S3.SS4.SSS2.p1.1.m1.1a"><mi id="S3.SS4.SSS2.p1.1.m1.1.1" xref="S3.SS4.SSS2.p1.1.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p1.1.m1.1b"><ci id="S3.SS4.SSS2.p1.1.m1.1.1.cmml" xref="S3.SS4.SSS2.p1.1.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p1.1.m1.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p1.1.m1.1d">italic_Q</annotation></semantics></math> sub-sequences, with 12.5 steps per second of audio. We denote those sequences by <math alttext="A_{t,q}\in\{1,\ldots,N_{A}\}" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p1.2.m2.5"><semantics id="S3.SS4.SSS2.p1.2.m2.5a"><mrow id="S3.SS4.SSS2.p1.2.m2.5.5" xref="S3.SS4.SSS2.p1.2.m2.5.5.cmml"><msub id="S3.SS4.SSS2.p1.2.m2.5.5.3" xref="S3.SS4.SSS2.p1.2.m2.5.5.3.cmml"><mi id="S3.SS4.SSS2.p1.2.m2.5.5.3.2" xref="S3.SS4.SSS2.p1.2.m2.5.5.3.2.cmml">A</mi><mrow id="S3.SS4.SSS2.p1.2.m2.2.2.2.4" xref="S3.SS4.SSS2.p1.2.m2.2.2.2.3.cmml"><mi id="S3.SS4.SSS2.p1.2.m2.1.1.1.1" xref="S3.SS4.SSS2.p1.2.m2.1.1.1.1.cmml">t</mi><mo id="S3.SS4.SSS2.p1.2.m2.2.2.2.4.1" xref="S3.SS4.SSS2.p1.2.m2.2.2.2.3.cmml">,</mo><mi id="S3.SS4.SSS2.p1.2.m2.2.2.2.2" xref="S3.SS4.SSS2.p1.2.m2.2.2.2.2.cmml">q</mi></mrow></msub><mo id="S3.SS4.SSS2.p1.2.m2.5.5.2" xref="S3.SS4.SSS2.p1.2.m2.5.5.2.cmml">∈</mo><mrow id="S3.SS4.SSS2.p1.2.m2.5.5.1.1" xref="S3.SS4.SSS2.p1.2.m2.5.5.1.2.cmml"><mo id="S3.SS4.SSS2.p1.2.m2.5.5.1.1.2" stretchy="false" xref="S3.SS4.SSS2.p1.2.m2.5.5.1.2.cmml">{</mo><mn id="S3.SS4.SSS2.p1.2.m2.3.3" xref="S3.SS4.SSS2.p1.2.m2.3.3.cmml">1</mn><mo id="S3.SS4.SSS2.p1.2.m2.5.5.1.1.3" xref="S3.SS4.SSS2.p1.2.m2.5.5.1.2.cmml">,</mo><mi id="S3.SS4.SSS2.p1.2.m2.4.4" mathvariant="normal" xref="S3.SS4.SSS2.p1.2.m2.4.4.cmml">…</mi><mo id="S3.SS4.SSS2.p1.2.m2.5.5.1.1.4" xref="S3.SS4.SSS2.p1.2.m2.5.5.1.2.cmml">,</mo><msub id="S3.SS4.SSS2.p1.2.m2.5.5.1.1.1" xref="S3.SS4.SSS2.p1.2.m2.5.5.1.1.1.cmml"><mi id="S3.SS4.SSS2.p1.2.m2.5.5.1.1.1.2" xref="S3.SS4.SSS2.p1.2.m2.5.5.1.1.1.2.cmml">N</mi><mi id="S3.SS4.SSS2.p1.2.m2.5.5.1.1.1.3" xref="S3.SS4.SSS2.p1.2.m2.5.5.1.1.1.3.cmml">A</mi></msub><mo id="S3.SS4.SSS2.p1.2.m2.5.5.1.1.5" stretchy="false" xref="S3.SS4.SSS2.p1.2.m2.5.5.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p1.2.m2.5b"><apply id="S3.SS4.SSS2.p1.2.m2.5.5.cmml" xref="S3.SS4.SSS2.p1.2.m2.5.5"><in id="S3.SS4.SSS2.p1.2.m2.5.5.2.cmml" xref="S3.SS4.SSS2.p1.2.m2.5.5.2"></in><apply id="S3.SS4.SSS2.p1.2.m2.5.5.3.cmml" xref="S3.SS4.SSS2.p1.2.m2.5.5.3"><csymbol cd="ambiguous" id="S3.SS4.SSS2.p1.2.m2.5.5.3.1.cmml" xref="S3.SS4.SSS2.p1.2.m2.5.5.3">subscript</csymbol><ci id="S3.SS4.SSS2.p1.2.m2.5.5.3.2.cmml" xref="S3.SS4.SSS2.p1.2.m2.5.5.3.2">𝐴</ci><list id="S3.SS4.SSS2.p1.2.m2.2.2.2.3.cmml" xref="S3.SS4.SSS2.p1.2.m2.2.2.2.4"><ci id="S3.SS4.SSS2.p1.2.m2.1.1.1.1.cmml" xref="S3.SS4.SSS2.p1.2.m2.1.1.1.1">𝑡</ci><ci id="S3.SS4.SSS2.p1.2.m2.2.2.2.2.cmml" xref="S3.SS4.SSS2.p1.2.m2.2.2.2.2">𝑞</ci></list></apply><set id="S3.SS4.SSS2.p1.2.m2.5.5.1.2.cmml" xref="S3.SS4.SSS2.p1.2.m2.5.5.1.1"><cn id="S3.SS4.SSS2.p1.2.m2.3.3.cmml" type="integer" xref="S3.SS4.SSS2.p1.2.m2.3.3">1</cn><ci id="S3.SS4.SSS2.p1.2.m2.4.4.cmml" xref="S3.SS4.SSS2.p1.2.m2.4.4">…</ci><apply id="S3.SS4.SSS2.p1.2.m2.5.5.1.1.1.cmml" xref="S3.SS4.SSS2.p1.2.m2.5.5.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS2.p1.2.m2.5.5.1.1.1.1.cmml" xref="S3.SS4.SSS2.p1.2.m2.5.5.1.1.1">subscript</csymbol><ci id="S3.SS4.SSS2.p1.2.m2.5.5.1.1.1.2.cmml" xref="S3.SS4.SSS2.p1.2.m2.5.5.1.1.1.2">𝑁</ci><ci id="S3.SS4.SSS2.p1.2.m2.5.5.1.1.1.3.cmml" xref="S3.SS4.SSS2.p1.2.m2.5.5.1.1.1.3">𝐴</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p1.2.m2.5c">A_{t,q}\in\{1,\ldots,N_{A}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p1.2.m2.5d">italic_A start_POSTSUBSCRIPT italic_t , italic_q end_POSTSUBSCRIPT ∈ { 1 , … , italic_N start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT }</annotation></semantics></math> for <math alttext="1\leq t\leq T" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p1.3.m3.1"><semantics id="S3.SS4.SSS2.p1.3.m3.1a"><mrow id="S3.SS4.SSS2.p1.3.m3.1.1" xref="S3.SS4.SSS2.p1.3.m3.1.1.cmml"><mn id="S3.SS4.SSS2.p1.3.m3.1.1.2" xref="S3.SS4.SSS2.p1.3.m3.1.1.2.cmml">1</mn><mo id="S3.SS4.SSS2.p1.3.m3.1.1.3" xref="S3.SS4.SSS2.p1.3.m3.1.1.3.cmml">≤</mo><mi id="S3.SS4.SSS2.p1.3.m3.1.1.4" xref="S3.SS4.SSS2.p1.3.m3.1.1.4.cmml">t</mi><mo id="S3.SS4.SSS2.p1.3.m3.1.1.5" xref="S3.SS4.SSS2.p1.3.m3.1.1.5.cmml">≤</mo><mi id="S3.SS4.SSS2.p1.3.m3.1.1.6" xref="S3.SS4.SSS2.p1.3.m3.1.1.6.cmml">T</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p1.3.m3.1b"><apply id="S3.SS4.SSS2.p1.3.m3.1.1.cmml" xref="S3.SS4.SSS2.p1.3.m3.1.1"><and id="S3.SS4.SSS2.p1.3.m3.1.1a.cmml" xref="S3.SS4.SSS2.p1.3.m3.1.1"></and><apply id="S3.SS4.SSS2.p1.3.m3.1.1b.cmml" xref="S3.SS4.SSS2.p1.3.m3.1.1"><leq id="S3.SS4.SSS2.p1.3.m3.1.1.3.cmml" xref="S3.SS4.SSS2.p1.3.m3.1.1.3"></leq><cn id="S3.SS4.SSS2.p1.3.m3.1.1.2.cmml" type="integer" xref="S3.SS4.SSS2.p1.3.m3.1.1.2">1</cn><ci id="S3.SS4.SSS2.p1.3.m3.1.1.4.cmml" xref="S3.SS4.SSS2.p1.3.m3.1.1.4">𝑡</ci></apply><apply id="S3.SS4.SSS2.p1.3.m3.1.1c.cmml" xref="S3.SS4.SSS2.p1.3.m3.1.1"><leq id="S3.SS4.SSS2.p1.3.m3.1.1.5.cmml" xref="S3.SS4.SSS2.p1.3.m3.1.1.5"></leq><share href="https://arxiv.org/html/2410.00037v2#S3.SS4.SSS2.p1.3.m3.1.1.4.cmml" id="S3.SS4.SSS2.p1.3.m3.1.1d.cmml" xref="S3.SS4.SSS2.p1.3.m3.1.1"></share><ci id="S3.SS4.SSS2.p1.3.m3.1.1.6.cmml" xref="S3.SS4.SSS2.p1.3.m3.1.1.6">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p1.3.m3.1c">1\leq t\leq T</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p1.3.m3.1d">1 ≤ italic_t ≤ italic_T</annotation></semantics></math> with <math alttext="T=12.5\cdot\mathrm{duration}" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p1.4.m4.1"><semantics id="S3.SS4.SSS2.p1.4.m4.1a"><mrow id="S3.SS4.SSS2.p1.4.m4.1.1" xref="S3.SS4.SSS2.p1.4.m4.1.1.cmml"><mi id="S3.SS4.SSS2.p1.4.m4.1.1.2" xref="S3.SS4.SSS2.p1.4.m4.1.1.2.cmml">T</mi><mo id="S3.SS4.SSS2.p1.4.m4.1.1.1" xref="S3.SS4.SSS2.p1.4.m4.1.1.1.cmml">=</mo><mrow id="S3.SS4.SSS2.p1.4.m4.1.1.3" xref="S3.SS4.SSS2.p1.4.m4.1.1.3.cmml"><mn id="S3.SS4.SSS2.p1.4.m4.1.1.3.2" xref="S3.SS4.SSS2.p1.4.m4.1.1.3.2.cmml">12.5</mn><mo id="S3.SS4.SSS2.p1.4.m4.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS4.SSS2.p1.4.m4.1.1.3.1.cmml">⋅</mo><mi id="S3.SS4.SSS2.p1.4.m4.1.1.3.3" xref="S3.SS4.SSS2.p1.4.m4.1.1.3.3.cmml">duration</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p1.4.m4.1b"><apply id="S3.SS4.SSS2.p1.4.m4.1.1.cmml" xref="S3.SS4.SSS2.p1.4.m4.1.1"><eq id="S3.SS4.SSS2.p1.4.m4.1.1.1.cmml" xref="S3.SS4.SSS2.p1.4.m4.1.1.1"></eq><ci id="S3.SS4.SSS2.p1.4.m4.1.1.2.cmml" xref="S3.SS4.SSS2.p1.4.m4.1.1.2">𝑇</ci><apply id="S3.SS4.SSS2.p1.4.m4.1.1.3.cmml" xref="S3.SS4.SSS2.p1.4.m4.1.1.3"><ci id="S3.SS4.SSS2.p1.4.m4.1.1.3.1.cmml" xref="S3.SS4.SSS2.p1.4.m4.1.1.3.1">⋅</ci><cn id="S3.SS4.SSS2.p1.4.m4.1.1.3.2.cmml" type="float" xref="S3.SS4.SSS2.p1.4.m4.1.1.3.2">12.5</cn><ci id="S3.SS4.SSS2.p1.4.m4.1.1.3.3.cmml" xref="S3.SS4.SSS2.p1.4.m4.1.1.3.3">duration</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p1.4.m4.1c">T=12.5\cdot\mathrm{duration}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p1.4.m4.1d">italic_T = 12.5 ⋅ roman_duration</annotation></semantics></math>, and <math alttext="1\leq q\leq Q" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p1.5.m5.1"><semantics id="S3.SS4.SSS2.p1.5.m5.1a"><mrow id="S3.SS4.SSS2.p1.5.m5.1.1" xref="S3.SS4.SSS2.p1.5.m5.1.1.cmml"><mn id="S3.SS4.SSS2.p1.5.m5.1.1.2" xref="S3.SS4.SSS2.p1.5.m5.1.1.2.cmml">1</mn><mo id="S3.SS4.SSS2.p1.5.m5.1.1.3" xref="S3.SS4.SSS2.p1.5.m5.1.1.3.cmml">≤</mo><mi id="S3.SS4.SSS2.p1.5.m5.1.1.4" xref="S3.SS4.SSS2.p1.5.m5.1.1.4.cmml">q</mi><mo id="S3.SS4.SSS2.p1.5.m5.1.1.5" xref="S3.SS4.SSS2.p1.5.m5.1.1.5.cmml">≤</mo><mi id="S3.SS4.SSS2.p1.5.m5.1.1.6" xref="S3.SS4.SSS2.p1.5.m5.1.1.6.cmml">Q</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p1.5.m5.1b"><apply id="S3.SS4.SSS2.p1.5.m5.1.1.cmml" xref="S3.SS4.SSS2.p1.5.m5.1.1"><and id="S3.SS4.SSS2.p1.5.m5.1.1a.cmml" xref="S3.SS4.SSS2.p1.5.m5.1.1"></and><apply id="S3.SS4.SSS2.p1.5.m5.1.1b.cmml" xref="S3.SS4.SSS2.p1.5.m5.1.1"><leq id="S3.SS4.SSS2.p1.5.m5.1.1.3.cmml" xref="S3.SS4.SSS2.p1.5.m5.1.1.3"></leq><cn id="S3.SS4.SSS2.p1.5.m5.1.1.2.cmml" type="integer" xref="S3.SS4.SSS2.p1.5.m5.1.1.2">1</cn><ci id="S3.SS4.SSS2.p1.5.m5.1.1.4.cmml" xref="S3.SS4.SSS2.p1.5.m5.1.1.4">𝑞</ci></apply><apply id="S3.SS4.SSS2.p1.5.m5.1.1c.cmml" xref="S3.SS4.SSS2.p1.5.m5.1.1"><leq id="S3.SS4.SSS2.p1.5.m5.1.1.5.cmml" xref="S3.SS4.SSS2.p1.5.m5.1.1.5"></leq><share href="https://arxiv.org/html/2410.00037v2#S3.SS4.SSS2.p1.5.m5.1.1.4.cmml" id="S3.SS4.SSS2.p1.5.m5.1.1d.cmml" xref="S3.SS4.SSS2.p1.5.m5.1.1"></share><ci id="S3.SS4.SSS2.p1.5.m5.1.1.6.cmml" xref="S3.SS4.SSS2.p1.5.m5.1.1.6">𝑄</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p1.5.m5.1c">1\leq q\leq Q</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p1.5.m5.1d">1 ≤ italic_q ≤ italic_Q</annotation></semantics></math> with <math alttext="Q=8" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p1.6.m6.1"><semantics id="S3.SS4.SSS2.p1.6.m6.1a"><mrow id="S3.SS4.SSS2.p1.6.m6.1.1" xref="S3.SS4.SSS2.p1.6.m6.1.1.cmml"><mi id="S3.SS4.SSS2.p1.6.m6.1.1.2" xref="S3.SS4.SSS2.p1.6.m6.1.1.2.cmml">Q</mi><mo id="S3.SS4.SSS2.p1.6.m6.1.1.1" xref="S3.SS4.SSS2.p1.6.m6.1.1.1.cmml">=</mo><mn id="S3.SS4.SSS2.p1.6.m6.1.1.3" xref="S3.SS4.SSS2.p1.6.m6.1.1.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p1.6.m6.1b"><apply id="S3.SS4.SSS2.p1.6.m6.1.1.cmml" xref="S3.SS4.SSS2.p1.6.m6.1.1"><eq id="S3.SS4.SSS2.p1.6.m6.1.1.1.cmml" xref="S3.SS4.SSS2.p1.6.m6.1.1.1"></eq><ci id="S3.SS4.SSS2.p1.6.m6.1.1.2.cmml" xref="S3.SS4.SSS2.p1.6.m6.1.1.2">𝑄</ci><cn id="S3.SS4.SSS2.p1.6.m6.1.1.3.cmml" type="integer" xref="S3.SS4.SSS2.p1.6.m6.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p1.6.m6.1c">Q=8</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p1.6.m6.1d">italic_Q = 8</annotation></semantics></math>.
We insert the audio sub-sequences into the multi-sequence <math alttext="V" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p1.7.m7.1"><semantics id="S3.SS4.SSS2.p1.7.m7.1a"><mi id="S3.SS4.SSS2.p1.7.m7.1.1" xref="S3.SS4.SSS2.p1.7.m7.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p1.7.m7.1b"><ci id="S3.SS4.SSS2.p1.7.m7.1.1.cmml" xref="S3.SS4.SSS2.p1.7.m7.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p1.7.m7.1c">V</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p1.7.m7.1d">italic_V</annotation></semantics></math> modeled by the RQ-Transformer. Remember that the first codebook <math alttext="A_{t,1}" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p1.8.m8.2"><semantics id="S3.SS4.SSS2.p1.8.m8.2a"><msub id="S3.SS4.SSS2.p1.8.m8.2.3" xref="S3.SS4.SSS2.p1.8.m8.2.3.cmml"><mi id="S3.SS4.SSS2.p1.8.m8.2.3.2" xref="S3.SS4.SSS2.p1.8.m8.2.3.2.cmml">A</mi><mrow id="S3.SS4.SSS2.p1.8.m8.2.2.2.4" xref="S3.SS4.SSS2.p1.8.m8.2.2.2.3.cmml"><mi id="S3.SS4.SSS2.p1.8.m8.1.1.1.1" xref="S3.SS4.SSS2.p1.8.m8.1.1.1.1.cmml">t</mi><mo id="S3.SS4.SSS2.p1.8.m8.2.2.2.4.1" xref="S3.SS4.SSS2.p1.8.m8.2.2.2.3.cmml">,</mo><mn id="S3.SS4.SSS2.p1.8.m8.2.2.2.2" xref="S3.SS4.SSS2.p1.8.m8.2.2.2.2.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p1.8.m8.2b"><apply id="S3.SS4.SSS2.p1.8.m8.2.3.cmml" xref="S3.SS4.SSS2.p1.8.m8.2.3"><csymbol cd="ambiguous" id="S3.SS4.SSS2.p1.8.m8.2.3.1.cmml" xref="S3.SS4.SSS2.p1.8.m8.2.3">subscript</csymbol><ci id="S3.SS4.SSS2.p1.8.m8.2.3.2.cmml" xref="S3.SS4.SSS2.p1.8.m8.2.3.2">𝐴</ci><list id="S3.SS4.SSS2.p1.8.m8.2.2.2.3.cmml" xref="S3.SS4.SSS2.p1.8.m8.2.2.2.4"><ci id="S3.SS4.SSS2.p1.8.m8.1.1.1.1.cmml" xref="S3.SS4.SSS2.p1.8.m8.1.1.1.1">𝑡</ci><cn id="S3.SS4.SSS2.p1.8.m8.2.2.2.2.cmml" type="integer" xref="S3.SS4.SSS2.p1.8.m8.2.2.2.2">1</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p1.8.m8.2c">A_{t,1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p1.8.m8.2d">italic_A start_POSTSUBSCRIPT italic_t , 1 end_POSTSUBSCRIPT</annotation></semantics></math> corresponds to the semantic information, as detailed in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS3.SSS2" title="3.3.2 Learning semantic-acoustic tokens with a split RVQ ‣ 3.3 Audio Tokenization ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue">Section&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3.2</span></span></a>, while the other codebooks correspond to acoustic features.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_paragraph" id="S3.SS4.SSS2.Px1">
<h5 class="ltx_title ltx_title_paragraph">Acoustic delay.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.SS4.SSS2.Px1.p1">
<p class="ltx_p" id="S3.SS4.SSS2.Px1.p1.2">We first experimented with simply setting <math alttext="V=A" class="ltx_Math" display="inline" id="S3.SS4.SSS2.Px1.p1.1.m1.1"><semantics id="S3.SS4.SSS2.Px1.p1.1.m1.1a"><mrow id="S3.SS4.SSS2.Px1.p1.1.m1.1.1" xref="S3.SS4.SSS2.Px1.p1.1.m1.1.1.cmml"><mi id="S3.SS4.SSS2.Px1.p1.1.m1.1.1.2" xref="S3.SS4.SSS2.Px1.p1.1.m1.1.1.2.cmml">V</mi><mo id="S3.SS4.SSS2.Px1.p1.1.m1.1.1.1" xref="S3.SS4.SSS2.Px1.p1.1.m1.1.1.1.cmml">=</mo><mi id="S3.SS4.SSS2.Px1.p1.1.m1.1.1.3" xref="S3.SS4.SSS2.Px1.p1.1.m1.1.1.3.cmml">A</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.Px1.p1.1.m1.1b"><apply id="S3.SS4.SSS2.Px1.p1.1.m1.1.1.cmml" xref="S3.SS4.SSS2.Px1.p1.1.m1.1.1"><eq id="S3.SS4.SSS2.Px1.p1.1.m1.1.1.1.cmml" xref="S3.SS4.SSS2.Px1.p1.1.m1.1.1.1"></eq><ci id="S3.SS4.SSS2.Px1.p1.1.m1.1.1.2.cmml" xref="S3.SS4.SSS2.Px1.p1.1.m1.1.1.2">𝑉</ci><ci id="S3.SS4.SSS2.Px1.p1.1.m1.1.1.3.cmml" xref="S3.SS4.SSS2.Px1.p1.1.m1.1.1.3">𝐴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.Px1.p1.1.m1.1c">V=A</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.Px1.p1.1.m1.1d">italic_V = italic_A</annotation></semantics></math> in the modeling. However we find that introducing a slight delay between the semantic and acoustic tokens led to more stable generations. <cite class="ltx_cite ltx_citemacro_citet">Copet et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib18" title="">2023</a>)</cite> show that this leads to reduced dependencies between the sub-sequences for a given time step, conditioned on the past, thus allowing to use a weaker model to approximate the joint distribution <math alttext="\mathbb{P}\left[V_{s,k}|V_{0},\ldots,V_{s-1}\right]" class="ltx_Math" display="inline" id="S3.SS4.SSS2.Px1.p1.2.m2.4"><semantics id="S3.SS4.SSS2.Px1.p1.2.m2.4a"><mrow id="S3.SS4.SSS2.Px1.p1.2.m2.4.4" xref="S3.SS4.SSS2.Px1.p1.2.m2.4.4.cmml"><mi id="S3.SS4.SSS2.Px1.p1.2.m2.4.4.3" xref="S3.SS4.SSS2.Px1.p1.2.m2.4.4.3.cmml">ℙ</mi><mo id="S3.SS4.SSS2.Px1.p1.2.m2.4.4.2" xref="S3.SS4.SSS2.Px1.p1.2.m2.4.4.2.cmml">⁢</mo><mrow id="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1" xref="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.2.cmml"><mo id="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.2" xref="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.2.1.cmml">[</mo><mrow id="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1" xref="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.cmml"><msub id="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.4" xref="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.4.cmml"><mi id="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.4.2" xref="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.4.2.cmml">V</mi><mrow id="S3.SS4.SSS2.Px1.p1.2.m2.2.2.2.4" xref="S3.SS4.SSS2.Px1.p1.2.m2.2.2.2.3.cmml"><mi id="S3.SS4.SSS2.Px1.p1.2.m2.1.1.1.1" xref="S3.SS4.SSS2.Px1.p1.2.m2.1.1.1.1.cmml">s</mi><mo id="S3.SS4.SSS2.Px1.p1.2.m2.2.2.2.4.1" xref="S3.SS4.SSS2.Px1.p1.2.m2.2.2.2.3.cmml">,</mo><mi id="S3.SS4.SSS2.Px1.p1.2.m2.2.2.2.2" xref="S3.SS4.SSS2.Px1.p1.2.m2.2.2.2.2.cmml">k</mi></mrow></msub><mo fence="false" id="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.3" xref="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.3.cmml">|</mo><mrow id="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.2.2" xref="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.2.3.cmml"><msub id="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.1.1.1" xref="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.1.1.1.cmml"><mi id="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.1.1.1.2" xref="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.1.1.1.2.cmml">V</mi><mn id="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.1.1.1.3" xref="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.2.2.3" xref="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.2.3.cmml">,</mo><mi id="S3.SS4.SSS2.Px1.p1.2.m2.3.3" mathvariant="normal" xref="S3.SS4.SSS2.Px1.p1.2.m2.3.3.cmml">…</mi><mo id="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.2.2.4" xref="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.2.3.cmml">,</mo><msub id="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.2.2.2" xref="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.2.2.2.cmml"><mi id="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.2.2.2.2" xref="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.2.2.2.2.cmml">V</mi><mrow id="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.2.2.2.3" xref="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.2.2.2.3.cmml"><mi id="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.2.2.2.3.2" xref="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.2.2.2.3.2.cmml">s</mi><mo id="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.2.2.2.3.1" xref="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.2.2.2.3.1.cmml">−</mo><mn id="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.2.2.2.3.3" xref="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.2.2.2.3.3.cmml">1</mn></mrow></msub></mrow></mrow><mo id="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.3" xref="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.Px1.p1.2.m2.4b"><apply id="S3.SS4.SSS2.Px1.p1.2.m2.4.4.cmml" xref="S3.SS4.SSS2.Px1.p1.2.m2.4.4"><times id="S3.SS4.SSS2.Px1.p1.2.m2.4.4.2.cmml" xref="S3.SS4.SSS2.Px1.p1.2.m2.4.4.2"></times><ci id="S3.SS4.SSS2.Px1.p1.2.m2.4.4.3.cmml" xref="S3.SS4.SSS2.Px1.p1.2.m2.4.4.3">ℙ</ci><apply id="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.2.cmml" xref="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1"><csymbol cd="latexml" id="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.2.1.cmml" xref="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.2">delimited-[]</csymbol><apply id="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.cmml" xref="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1"><csymbol cd="latexml" id="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.3.cmml" xref="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.3">conditional</csymbol><apply id="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.4.cmml" xref="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.4.1.cmml" xref="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.4">subscript</csymbol><ci id="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.4.2.cmml" xref="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.4.2">𝑉</ci><list id="S3.SS4.SSS2.Px1.p1.2.m2.2.2.2.3.cmml" xref="S3.SS4.SSS2.Px1.p1.2.m2.2.2.2.4"><ci id="S3.SS4.SSS2.Px1.p1.2.m2.1.1.1.1.cmml" xref="S3.SS4.SSS2.Px1.p1.2.m2.1.1.1.1">𝑠</ci><ci id="S3.SS4.SSS2.Px1.p1.2.m2.2.2.2.2.cmml" xref="S3.SS4.SSS2.Px1.p1.2.m2.2.2.2.2">𝑘</ci></list></apply><list id="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.2.3.cmml" xref="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.2.2"><apply id="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.1.1.1.cmml" xref="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.1.1.1.1.cmml" xref="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.1.1.1.2.cmml" xref="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.1.1.1.2">𝑉</ci><cn id="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.1.1.1.3">0</cn></apply><ci id="S3.SS4.SSS2.Px1.p1.2.m2.3.3.cmml" xref="S3.SS4.SSS2.Px1.p1.2.m2.3.3">…</ci><apply id="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.2.2.2.cmml" xref="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.2.2.2.1.cmml" xref="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.2.2.2">subscript</csymbol><ci id="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.2.2.2.2.cmml" xref="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.2.2.2.2">𝑉</ci><apply id="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.2.2.2.3.cmml" xref="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.2.2.2.3"><minus id="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.2.2.2.3.1.cmml" xref="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.2.2.2.3.1"></minus><ci id="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.2.2.2.3.2.cmml" xref="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.2.2.2.3.2">𝑠</ci><cn id="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.2.2.2.3.3.cmml" type="integer" xref="S3.SS4.SSS2.Px1.p1.2.m2.4.4.1.1.1.2.2.2.3.3">1</cn></apply></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.Px1.p1.2.m2.4c">\mathbb{P}\left[V_{s,k}|V_{0},\ldots,V_{s-1}\right]</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.Px1.p1.2.m2.4d">blackboard_P [ italic_V start_POSTSUBSCRIPT italic_s , italic_k end_POSTSUBSCRIPT | italic_V start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , … , italic_V start_POSTSUBSCRIPT italic_s - 1 end_POSTSUBSCRIPT ]</annotation></semantics></math> (in their case, as the product of the conditioned marginals). <cite class="ltx_cite ltx_citemacro_citet">Lemercier et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib56" title="">2024</a>)</cite> further show a connection between the mutual information between the sub-sequences at a given step, and the quality of the generation: naturally, the more complex the interdependence, the more powerful a model will be needed to estimate them.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S3.SS4.SSS2.Px1.p2">
<p class="ltx_p" id="S3.SS4.SSS2.Px1.p2.2">As shown in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.SS3" title="5.3 Ablations on Generative Modeling ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue">Section&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.3</span></span></a>, introducing a delay of 1 or 2 steps between the semantic and acoustic features greatly improves the quality of the generation. This allows the Temporal, larger, Transformer to model the inter-dependence between semantic and acoustic features. Formally, given a delay <math alttext="\tau\in\mathbb{N}" class="ltx_Math" display="inline" id="S3.SS4.SSS2.Px1.p2.1.m1.1"><semantics id="S3.SS4.SSS2.Px1.p2.1.m1.1a"><mrow id="S3.SS4.SSS2.Px1.p2.1.m1.1.1" xref="S3.SS4.SSS2.Px1.p2.1.m1.1.1.cmml"><mi id="S3.SS4.SSS2.Px1.p2.1.m1.1.1.2" xref="S3.SS4.SSS2.Px1.p2.1.m1.1.1.2.cmml">τ</mi><mo id="S3.SS4.SSS2.Px1.p2.1.m1.1.1.1" xref="S3.SS4.SSS2.Px1.p2.1.m1.1.1.1.cmml">∈</mo><mi id="S3.SS4.SSS2.Px1.p2.1.m1.1.1.3" xref="S3.SS4.SSS2.Px1.p2.1.m1.1.1.3.cmml">ℕ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.Px1.p2.1.m1.1b"><apply id="S3.SS4.SSS2.Px1.p2.1.m1.1.1.cmml" xref="S3.SS4.SSS2.Px1.p2.1.m1.1.1"><in id="S3.SS4.SSS2.Px1.p2.1.m1.1.1.1.cmml" xref="S3.SS4.SSS2.Px1.p2.1.m1.1.1.1"></in><ci id="S3.SS4.SSS2.Px1.p2.1.m1.1.1.2.cmml" xref="S3.SS4.SSS2.Px1.p2.1.m1.1.1.2">𝜏</ci><ci id="S3.SS4.SSS2.Px1.p2.1.m1.1.1.3.cmml" xref="S3.SS4.SSS2.Px1.p2.1.m1.1.1.3">ℕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.Px1.p2.1.m1.1c">\tau\in\mathbb{N}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.Px1.p2.1.m1.1d">italic_τ ∈ blackboard_N</annotation></semantics></math>, we have, for all steps <math alttext="s" class="ltx_Math" display="inline" id="S3.SS4.SSS2.Px1.p2.2.m2.1"><semantics id="S3.SS4.SSS2.Px1.p2.2.m2.1a"><mi id="S3.SS4.SSS2.Px1.p2.2.m2.1.1" xref="S3.SS4.SSS2.Px1.p2.2.m2.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.Px1.p2.2.m2.1b"><ci id="S3.SS4.SSS2.Px1.p2.2.m2.1.1.cmml" xref="S3.SS4.SSS2.Px1.p2.2.m2.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.Px1.p2.2.m2.1c">s</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.Px1.p2.2.m2.1d">italic_s</annotation></semantics></math></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{cases}V_{s,1}=A_{s,1}&amp;\\
V_{s,q}=A_{s-\tau,q}&amp;\quad\text{if}\quad s\geq\tau+1,q>1\\
V_{s,q}=0&amp;\quad\text{if}\quad s<\tau+1,q>1.\\
\end{cases}" class="ltx_Math" display="block" id="S3.E4.m1.5"><semantics id="S3.E4.m1.5a"><mrow id="S3.E4.m1.5.5" xref="S3.E4.m1.5.6.1.cmml"><mo id="S3.E4.m1.5.5.6" xref="S3.E4.m1.5.6.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" id="S3.E4.m1.5.5.5" rowspacing="0pt" xref="S3.E4.m1.5.6.1.cmml"><mtr id="S3.E4.m1.5.5.5a" xref="S3.E4.m1.5.6.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E4.m1.5.5.5b" xref="S3.E4.m1.5.6.1.cmml"><mrow id="S3.E4.m1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.cmml"><msub id="S3.E4.m1.1.1.1.1.1.1.6" xref="S3.E4.m1.1.1.1.1.1.1.6.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.6.2" xref="S3.E4.m1.1.1.1.1.1.1.6.2.cmml">V</mi><mrow id="S3.E4.m1.1.1.1.1.1.1.2.2.4" xref="S3.E4.m1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.cmml">s</mi><mo id="S3.E4.m1.1.1.1.1.1.1.2.2.4.1" xref="S3.E4.m1.1.1.1.1.1.1.2.2.3.cmml">,</mo><mn id="S3.E4.m1.1.1.1.1.1.1.2.2.2" xref="S3.E4.m1.1.1.1.1.1.1.2.2.2.cmml">1</mn></mrow></msub><mo id="S3.E4.m1.1.1.1.1.1.1.5" xref="S3.E4.m1.1.1.1.1.1.1.5.cmml">=</mo><msub id="S3.E4.m1.1.1.1.1.1.1.7" xref="S3.E4.m1.1.1.1.1.1.1.7.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.7.2" xref="S3.E4.m1.1.1.1.1.1.1.7.2.cmml">A</mi><mrow id="S3.E4.m1.1.1.1.1.1.1.4.2.4" xref="S3.E4.m1.1.1.1.1.1.1.4.2.3.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.3.1.1" xref="S3.E4.m1.1.1.1.1.1.1.3.1.1.cmml">s</mi><mo id="S3.E4.m1.1.1.1.1.1.1.4.2.4.1" xref="S3.E4.m1.1.1.1.1.1.1.4.2.3.cmml">,</mo><mn id="S3.E4.m1.1.1.1.1.1.1.4.2.2" xref="S3.E4.m1.1.1.1.1.1.1.4.2.2.cmml">1</mn></mrow></msub></mrow></mtd><mtd id="S3.E4.m1.5.5.5c" xref="S3.E4.m1.5.6.1.1.cmml"></mtd></mtr><mtr id="S3.E4.m1.5.5.5d" xref="S3.E4.m1.5.6.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E4.m1.5.5.5e" xref="S3.E4.m1.5.6.1.cmml"><mrow id="S3.E4.m1.2.2.2.2.1.1" xref="S3.E4.m1.2.2.2.2.1.1.cmml"><msub id="S3.E4.m1.2.2.2.2.1.1.6" xref="S3.E4.m1.2.2.2.2.1.1.6.cmml"><mi id="S3.E4.m1.2.2.2.2.1.1.6.2" xref="S3.E4.m1.2.2.2.2.1.1.6.2.cmml">V</mi><mrow id="S3.E4.m1.2.2.2.2.1.1.2.2.4" xref="S3.E4.m1.2.2.2.2.1.1.2.2.3.cmml"><mi id="S3.E4.m1.2.2.2.2.1.1.1.1.1" xref="S3.E4.m1.2.2.2.2.1.1.1.1.1.cmml">s</mi><mo id="S3.E4.m1.2.2.2.2.1.1.2.2.4.1" xref="S3.E4.m1.2.2.2.2.1.1.2.2.3.cmml">,</mo><mi id="S3.E4.m1.2.2.2.2.1.1.2.2.2" xref="S3.E4.m1.2.2.2.2.1.1.2.2.2.cmml">q</mi></mrow></msub><mo id="S3.E4.m1.2.2.2.2.1.1.5" xref="S3.E4.m1.2.2.2.2.1.1.5.cmml">=</mo><msub id="S3.E4.m1.2.2.2.2.1.1.7" xref="S3.E4.m1.2.2.2.2.1.1.7.cmml"><mi id="S3.E4.m1.2.2.2.2.1.1.7.2" xref="S3.E4.m1.2.2.2.2.1.1.7.2.cmml">A</mi><mrow id="S3.E4.m1.2.2.2.2.1.1.4.2.2" xref="S3.E4.m1.2.2.2.2.1.1.4.2.3.cmml"><mrow id="S3.E4.m1.2.2.2.2.1.1.4.2.2.1" xref="S3.E4.m1.2.2.2.2.1.1.4.2.2.1.cmml"><mi id="S3.E4.m1.2.2.2.2.1.1.4.2.2.1.2" xref="S3.E4.m1.2.2.2.2.1.1.4.2.2.1.2.cmml">s</mi><mo id="S3.E4.m1.2.2.2.2.1.1.4.2.2.1.1" xref="S3.E4.m1.2.2.2.2.1.1.4.2.2.1.1.cmml">−</mo><mi id="S3.E4.m1.2.2.2.2.1.1.4.2.2.1.3" xref="S3.E4.m1.2.2.2.2.1.1.4.2.2.1.3.cmml">τ</mi></mrow><mo id="S3.E4.m1.2.2.2.2.1.1.4.2.2.2" xref="S3.E4.m1.2.2.2.2.1.1.4.2.3.cmml">,</mo><mi id="S3.E4.m1.2.2.2.2.1.1.3.1.1" xref="S3.E4.m1.2.2.2.2.1.1.3.1.1.cmml">q</mi></mrow></msub></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E4.m1.5.5.5f" xref="S3.E4.m1.5.6.1.cmml"><mrow id="S3.E4.m1.3.3.3.3.2.1.4" xref="S3.E4.m1.3.3.3.3.2.1.5.cmml"><mrow id="S3.E4.m1.3.3.3.3.2.1.3.1" xref="S3.E4.m1.3.3.3.3.2.1.3.1.cmml"><mrow id="S3.E4.m1.3.3.3.3.2.1.3.1.2.2" xref="S3.E4.m1.3.3.3.3.2.1.3.1.2.1.cmml"><mtext id="S3.E4.m1.3.3.3.3.2.1.1" xref="S3.E4.m1.3.3.3.3.2.1.1a.cmml">if</mtext><mspace id="S3.E4.m1.3.3.3.3.2.1.3.1.2.2.1" width="1em" xref="S3.E4.m1.3.3.3.3.2.1.3.1.2.1.cmml"></mspace><mi id="S3.E4.m1.3.3.3.3.2.1.2" xref="S3.E4.m1.3.3.3.3.2.1.2.cmml">s</mi></mrow><mo id="S3.E4.m1.3.3.3.3.2.1.3.1.1" xref="S3.E4.m1.3.3.3.3.2.1.3.1.1.cmml">≥</mo><mrow id="S3.E4.m1.3.3.3.3.2.1.3.1.3" xref="S3.E4.m1.3.3.3.3.2.1.3.1.3.cmml"><mi id="S3.E4.m1.3.3.3.3.2.1.3.1.3.2" xref="S3.E4.m1.3.3.3.3.2.1.3.1.3.2.cmml">τ</mi><mo id="S3.E4.m1.3.3.3.3.2.1.3.1.3.1" xref="S3.E4.m1.3.3.3.3.2.1.3.1.3.1.cmml">+</mo><mn id="S3.E4.m1.3.3.3.3.2.1.3.1.3.3" xref="S3.E4.m1.3.3.3.3.2.1.3.1.3.3.cmml">1</mn></mrow></mrow><mo id="S3.E4.m1.3.3.3.3.2.1.4.3" xref="S3.E4.m1.3.3.3.3.2.1.5a.cmml">,</mo><mrow id="S3.E4.m1.3.3.3.3.2.1.4.2" xref="S3.E4.m1.3.3.3.3.2.1.4.2.cmml"><mi id="S3.E4.m1.3.3.3.3.2.1.4.2.2" xref="S3.E4.m1.3.3.3.3.2.1.4.2.2.cmml">q</mi><mo id="S3.E4.m1.3.3.3.3.2.1.4.2.1" xref="S3.E4.m1.3.3.3.3.2.1.4.2.1.cmml">&gt;</mo><mn id="S3.E4.m1.3.3.3.3.2.1.4.2.3" xref="S3.E4.m1.3.3.3.3.2.1.4.2.3.cmml">1</mn></mrow></mrow></mtd></mtr><mtr id="S3.E4.m1.5.5.5g" xref="S3.E4.m1.5.6.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E4.m1.5.5.5h" xref="S3.E4.m1.5.6.1.cmml"><mrow id="S3.E4.m1.4.4.4.4.1.1" xref="S3.E4.m1.4.4.4.4.1.1.cmml"><msub id="S3.E4.m1.4.4.4.4.1.1.4" xref="S3.E4.m1.4.4.4.4.1.1.4.cmml"><mi id="S3.E4.m1.4.4.4.4.1.1.4.2" xref="S3.E4.m1.4.4.4.4.1.1.4.2.cmml">V</mi><mrow id="S3.E4.m1.4.4.4.4.1.1.2.2.4" xref="S3.E4.m1.4.4.4.4.1.1.2.2.3.cmml"><mi id="S3.E4.m1.4.4.4.4.1.1.1.1.1" xref="S3.E4.m1.4.4.4.4.1.1.1.1.1.cmml">s</mi><mo id="S3.E4.m1.4.4.4.4.1.1.2.2.4.1" xref="S3.E4.m1.4.4.4.4.1.1.2.2.3.cmml">,</mo><mi id="S3.E4.m1.4.4.4.4.1.1.2.2.2" xref="S3.E4.m1.4.4.4.4.1.1.2.2.2.cmml">q</mi></mrow></msub><mo id="S3.E4.m1.4.4.4.4.1.1.3" xref="S3.E4.m1.4.4.4.4.1.1.3.cmml">=</mo><mn id="S3.E4.m1.4.4.4.4.1.1.5" xref="S3.E4.m1.4.4.4.4.1.1.5.cmml">0</mn></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E4.m1.5.5.5i" xref="S3.E4.m1.5.6.1.cmml"><mrow id="S3.E4.m1.5.5.5.5.2.1.4" xref="S3.E4.m1.5.6.1.cmml"><mrow id="S3.E4.m1.5.5.5.5.2.1.4.1.2" xref="S3.E4.m1.5.5.5.5.2.1.4.1.3.cmml"><mrow id="S3.E4.m1.5.5.5.5.2.1.4.1.1.1" xref="S3.E4.m1.5.5.5.5.2.1.4.1.1.1.cmml"><mrow id="S3.E4.m1.5.5.5.5.2.1.4.1.1.1.2.2" xref="S3.E4.m1.5.5.5.5.2.1.4.1.1.1.2.1.cmml"><mtext id="S3.E4.m1.5.5.5.5.2.1.2" xref="S3.E4.m1.5.5.5.5.2.1.2a.cmml">if</mtext><mspace id="S3.E4.m1.5.5.5.5.2.1.4.1.1.1.2.2.1" width="1em" xref="S3.E4.m1.5.5.5.5.2.1.4.1.1.1.2.1.cmml"></mspace><mi id="S3.E4.m1.5.5.5.5.2.1.3" xref="S3.E4.m1.5.5.5.5.2.1.3.cmml">s</mi></mrow><mo id="S3.E4.m1.5.5.5.5.2.1.4.1.1.1.1" xref="S3.E4.m1.5.5.5.5.2.1.4.1.1.1.1.cmml">&lt;</mo><mrow id="S3.E4.m1.5.5.5.5.2.1.4.1.1.1.3" xref="S3.E4.m1.5.5.5.5.2.1.4.1.1.1.3.cmml"><mi id="S3.E4.m1.5.5.5.5.2.1.4.1.1.1.3.2" xref="S3.E4.m1.5.5.5.5.2.1.4.1.1.1.3.2.cmml">τ</mi><mo id="S3.E4.m1.5.5.5.5.2.1.4.1.1.1.3.1" xref="S3.E4.m1.5.5.5.5.2.1.4.1.1.1.3.1.cmml">+</mo><mn id="S3.E4.m1.5.5.5.5.2.1.4.1.1.1.3.3" xref="S3.E4.m1.5.5.5.5.2.1.4.1.1.1.3.3.cmml">1</mn></mrow></mrow><mo id="S3.E4.m1.5.5.5.5.2.1.4.1.2.3" xref="S3.E4.m1.5.5.5.5.2.1.4.1.3a.cmml">,</mo><mrow id="S3.E4.m1.5.5.5.5.2.1.4.1.2.2" xref="S3.E4.m1.5.5.5.5.2.1.4.1.2.2.cmml"><mi id="S3.E4.m1.5.5.5.5.2.1.1" xref="S3.E4.m1.5.5.5.5.2.1.1.cmml">q</mi><mo id="S3.E4.m1.5.5.5.5.2.1.4.1.2.2.1" xref="S3.E4.m1.5.5.5.5.2.1.4.1.2.2.1.cmml">&gt;</mo><mn id="S3.E4.m1.5.5.5.5.2.1.4.1.2.2.2" xref="S3.E4.m1.5.5.5.5.2.1.4.1.2.2.2.cmml">1</mn></mrow></mrow><mo id="S3.E4.m1.5.5.5.5.2.1.4.2" lspace="0em" xref="S3.E4.m1.5.6.1.cmml">.</mo></mrow></mtd></mtr></mtable></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.5b"><apply id="S3.E4.m1.5.6.1.cmml" xref="S3.E4.m1.5.5"><csymbol cd="latexml" id="S3.E4.m1.5.6.1.1.cmml" xref="S3.E4.m1.5.5.6">cases</csymbol><apply id="S3.E4.m1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1"><eq id="S3.E4.m1.1.1.1.1.1.1.5.cmml" xref="S3.E4.m1.1.1.1.1.1.1.5"></eq><apply id="S3.E4.m1.1.1.1.1.1.1.6.cmml" xref="S3.E4.m1.1.1.1.1.1.1.6"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.6.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.6">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.1.6.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.6.2">𝑉</ci><list id="S3.E4.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.2.2.4"><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1">𝑠</ci><cn id="S3.E4.m1.1.1.1.1.1.1.2.2.2.cmml" type="integer" xref="S3.E4.m1.1.1.1.1.1.1.2.2.2">1</cn></list></apply><apply id="S3.E4.m1.1.1.1.1.1.1.7.cmml" xref="S3.E4.m1.1.1.1.1.1.1.7"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.7.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.7">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.1.7.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.7.2">𝐴</ci><list id="S3.E4.m1.1.1.1.1.1.1.4.2.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.4.2.4"><ci id="S3.E4.m1.1.1.1.1.1.1.3.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.3.1.1">𝑠</ci><cn id="S3.E4.m1.1.1.1.1.1.1.4.2.2.cmml" type="integer" xref="S3.E4.m1.1.1.1.1.1.1.4.2.2">1</cn></list></apply></apply><ci id="S3.E4.m1.5.6.1.3a.cmml" xref="S3.E4.m1.5.5"><mtext class="ltx_mathvariant_italic" id="S3.E4.m1.5.6.1.3.cmml" xref="S3.E4.m1.5.5.6">otherwise</mtext></ci><apply id="S3.E4.m1.2.2.2.2.1.1.cmml" xref="S3.E4.m1.2.2.2.2.1.1"><eq id="S3.E4.m1.2.2.2.2.1.1.5.cmml" xref="S3.E4.m1.2.2.2.2.1.1.5"></eq><apply id="S3.E4.m1.2.2.2.2.1.1.6.cmml" xref="S3.E4.m1.2.2.2.2.1.1.6"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.2.2.1.1.6.1.cmml" xref="S3.E4.m1.2.2.2.2.1.1.6">subscript</csymbol><ci id="S3.E4.m1.2.2.2.2.1.1.6.2.cmml" xref="S3.E4.m1.2.2.2.2.1.1.6.2">𝑉</ci><list id="S3.E4.m1.2.2.2.2.1.1.2.2.3.cmml" xref="S3.E4.m1.2.2.2.2.1.1.2.2.4"><ci id="S3.E4.m1.2.2.2.2.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.2.2.1.1.1.1.1">𝑠</ci><ci id="S3.E4.m1.2.2.2.2.1.1.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2.1.1.2.2.2">𝑞</ci></list></apply><apply id="S3.E4.m1.2.2.2.2.1.1.7.cmml" xref="S3.E4.m1.2.2.2.2.1.1.7"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.2.2.1.1.7.1.cmml" xref="S3.E4.m1.2.2.2.2.1.1.7">subscript</csymbol><ci id="S3.E4.m1.2.2.2.2.1.1.7.2.cmml" xref="S3.E4.m1.2.2.2.2.1.1.7.2">𝐴</ci><list id="S3.E4.m1.2.2.2.2.1.1.4.2.3.cmml" xref="S3.E4.m1.2.2.2.2.1.1.4.2.2"><apply id="S3.E4.m1.2.2.2.2.1.1.4.2.2.1.cmml" xref="S3.E4.m1.2.2.2.2.1.1.4.2.2.1"><minus id="S3.E4.m1.2.2.2.2.1.1.4.2.2.1.1.cmml" xref="S3.E4.m1.2.2.2.2.1.1.4.2.2.1.1"></minus><ci id="S3.E4.m1.2.2.2.2.1.1.4.2.2.1.2.cmml" xref="S3.E4.m1.2.2.2.2.1.1.4.2.2.1.2">𝑠</ci><ci id="S3.E4.m1.2.2.2.2.1.1.4.2.2.1.3.cmml" xref="S3.E4.m1.2.2.2.2.1.1.4.2.2.1.3">𝜏</ci></apply><ci id="S3.E4.m1.2.2.2.2.1.1.3.1.1.cmml" xref="S3.E4.m1.2.2.2.2.1.1.3.1.1">𝑞</ci></list></apply></apply><apply id="S3.E4.m1.3.3.3.3.2.1.5.cmml" xref="S3.E4.m1.3.3.3.3.2.1.4"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.3.3.2.1.5a.cmml" xref="S3.E4.m1.3.3.3.3.2.1.4.3">formulae-sequence</csymbol><apply id="S3.E4.m1.3.3.3.3.2.1.3.1.cmml" xref="S3.E4.m1.3.3.3.3.2.1.3.1"><geq id="S3.E4.m1.3.3.3.3.2.1.3.1.1.cmml" xref="S3.E4.m1.3.3.3.3.2.1.3.1.1"></geq><list id="S3.E4.m1.3.3.3.3.2.1.3.1.2.1.cmml" xref="S3.E4.m1.3.3.3.3.2.1.3.1.2.2"><ci id="S3.E4.m1.3.3.3.3.2.1.1a.cmml" xref="S3.E4.m1.3.3.3.3.2.1.1"><mtext id="S3.E4.m1.3.3.3.3.2.1.1.cmml" xref="S3.E4.m1.3.3.3.3.2.1.1">if</mtext></ci><ci id="S3.E4.m1.3.3.3.3.2.1.2.cmml" xref="S3.E4.m1.3.3.3.3.2.1.2">𝑠</ci></list><apply id="S3.E4.m1.3.3.3.3.2.1.3.1.3.cmml" xref="S3.E4.m1.3.3.3.3.2.1.3.1.3"><plus id="S3.E4.m1.3.3.3.3.2.1.3.1.3.1.cmml" xref="S3.E4.m1.3.3.3.3.2.1.3.1.3.1"></plus><ci id="S3.E4.m1.3.3.3.3.2.1.3.1.3.2.cmml" xref="S3.E4.m1.3.3.3.3.2.1.3.1.3.2">𝜏</ci><cn id="S3.E4.m1.3.3.3.3.2.1.3.1.3.3.cmml" type="integer" xref="S3.E4.m1.3.3.3.3.2.1.3.1.3.3">1</cn></apply></apply><apply id="S3.E4.m1.3.3.3.3.2.1.4.2.cmml" xref="S3.E4.m1.3.3.3.3.2.1.4.2"><gt id="S3.E4.m1.3.3.3.3.2.1.4.2.1.cmml" xref="S3.E4.m1.3.3.3.3.2.1.4.2.1"></gt><ci id="S3.E4.m1.3.3.3.3.2.1.4.2.2.cmml" xref="S3.E4.m1.3.3.3.3.2.1.4.2.2">𝑞</ci><cn id="S3.E4.m1.3.3.3.3.2.1.4.2.3.cmml" type="integer" xref="S3.E4.m1.3.3.3.3.2.1.4.2.3">1</cn></apply></apply><apply id="S3.E4.m1.4.4.4.4.1.1.cmml" xref="S3.E4.m1.4.4.4.4.1.1"><eq id="S3.E4.m1.4.4.4.4.1.1.3.cmml" xref="S3.E4.m1.4.4.4.4.1.1.3"></eq><apply id="S3.E4.m1.4.4.4.4.1.1.4.cmml" xref="S3.E4.m1.4.4.4.4.1.1.4"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.4.4.1.1.4.1.cmml" xref="S3.E4.m1.4.4.4.4.1.1.4">subscript</csymbol><ci id="S3.E4.m1.4.4.4.4.1.1.4.2.cmml" xref="S3.E4.m1.4.4.4.4.1.1.4.2">𝑉</ci><list id="S3.E4.m1.4.4.4.4.1.1.2.2.3.cmml" xref="S3.E4.m1.4.4.4.4.1.1.2.2.4"><ci id="S3.E4.m1.4.4.4.4.1.1.1.1.1.cmml" xref="S3.E4.m1.4.4.4.4.1.1.1.1.1">𝑠</ci><ci id="S3.E4.m1.4.4.4.4.1.1.2.2.2.cmml" xref="S3.E4.m1.4.4.4.4.1.1.2.2.2">𝑞</ci></list></apply><cn id="S3.E4.m1.4.4.4.4.1.1.5.cmml" type="integer" xref="S3.E4.m1.4.4.4.4.1.1.5">0</cn></apply><apply id="S3.E4.m1.5.5.5.5.2.1.4.1.3.cmml" xref="S3.E4.m1.5.5.5.5.2.1.4.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.5.5.2.1.4.1.3a.cmml" xref="S3.E4.m1.5.5.5.5.2.1.4.1.2.3">formulae-sequence</csymbol><apply id="S3.E4.m1.5.5.5.5.2.1.4.1.1.1.cmml" xref="S3.E4.m1.5.5.5.5.2.1.4.1.1.1"><lt id="S3.E4.m1.5.5.5.5.2.1.4.1.1.1.1.cmml" xref="S3.E4.m1.5.5.5.5.2.1.4.1.1.1.1"></lt><list id="S3.E4.m1.5.5.5.5.2.1.4.1.1.1.2.1.cmml" xref="S3.E4.m1.5.5.5.5.2.1.4.1.1.1.2.2"><ci id="S3.E4.m1.5.5.5.5.2.1.2a.cmml" xref="S3.E4.m1.5.5.5.5.2.1.2"><mtext id="S3.E4.m1.5.5.5.5.2.1.2.cmml" xref="S3.E4.m1.5.5.5.5.2.1.2">if</mtext></ci><ci id="S3.E4.m1.5.5.5.5.2.1.3.cmml" xref="S3.E4.m1.5.5.5.5.2.1.3">𝑠</ci></list><apply id="S3.E4.m1.5.5.5.5.2.1.4.1.1.1.3.cmml" xref="S3.E4.m1.5.5.5.5.2.1.4.1.1.1.3"><plus id="S3.E4.m1.5.5.5.5.2.1.4.1.1.1.3.1.cmml" xref="S3.E4.m1.5.5.5.5.2.1.4.1.1.1.3.1"></plus><ci id="S3.E4.m1.5.5.5.5.2.1.4.1.1.1.3.2.cmml" xref="S3.E4.m1.5.5.5.5.2.1.4.1.1.1.3.2">𝜏</ci><cn id="S3.E4.m1.5.5.5.5.2.1.4.1.1.1.3.3.cmml" type="integer" xref="S3.E4.m1.5.5.5.5.2.1.4.1.1.1.3.3">1</cn></apply></apply><apply id="S3.E4.m1.5.5.5.5.2.1.4.1.2.2.cmml" xref="S3.E4.m1.5.5.5.5.2.1.4.1.2.2"><gt id="S3.E4.m1.5.5.5.5.2.1.4.1.2.2.1.cmml" xref="S3.E4.m1.5.5.5.5.2.1.4.1.2.2.1"></gt><ci id="S3.E4.m1.5.5.5.5.2.1.1.cmml" xref="S3.E4.m1.5.5.5.5.2.1.1">𝑞</ci><cn id="S3.E4.m1.5.5.5.5.2.1.4.1.2.2.2.cmml" type="integer" xref="S3.E4.m1.5.5.5.5.2.1.4.1.2.2.2">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.5c">\begin{cases}V_{s,1}=A_{s,1}&amp;\\
V_{s,q}=A_{s-\tau,q}&amp;\quad\text{if}\quad s\geq\tau+1,q&gt;1\\
V_{s,q}=0&amp;\quad\text{if}\quad s&lt;\tau+1,q&gt;1.\\
\end{cases}</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.5d">{ start_ROW start_CELL italic_V start_POSTSUBSCRIPT italic_s , 1 end_POSTSUBSCRIPT = italic_A start_POSTSUBSCRIPT italic_s , 1 end_POSTSUBSCRIPT end_CELL start_CELL end_CELL end_ROW start_ROW start_CELL italic_V start_POSTSUBSCRIPT italic_s , italic_q end_POSTSUBSCRIPT = italic_A start_POSTSUBSCRIPT italic_s - italic_τ , italic_q end_POSTSUBSCRIPT end_CELL start_CELL if italic_s ≥ italic_τ + 1 , italic_q &gt; 1 end_CELL end_ROW start_ROW start_CELL italic_V start_POSTSUBSCRIPT italic_s , italic_q end_POSTSUBSCRIPT = 0 end_CELL start_CELL if italic_s &lt; italic_τ + 1 , italic_q &gt; 1 . end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.SSS2.Px1.p2.3">Note that using RQ-Transformers to model audio was successfully used by&nbsp;<cite class="ltx_cite ltx_citemacro_citet">Yang et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib105" title="">2023</a>)</cite> and <cite class="ltx_cite ltx_citemacro_citet">Zhu et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib117" title="">2024</a>)</cite>. We introduce here the use of per-codebook parameters in the Depth Transformer, and the use of the acoustic delay. Compared with&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Zhu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib117" title="">2024</a>)</cite> which first generates all the semantic tokens, we generate them jointly with the acoustic tokens, which allows for the first time a streaming modeling of semantic and acoustic tokens jointly.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_subsubsection" id="S3.SS4.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.4.3 </span>Multi-stream modeling</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.SS4.SSS3.p1">
<p class="ltx_p" id="S3.SS4.SSS3.p1.5">Modeling a single stream of audio is not sufficient to fully model a conversation. Our framework can be extended to modeling a two-speaker conversation: given two streams of audios <math alttext="(A_{t,q})" class="ltx_Math" display="inline" id="S3.SS4.SSS3.p1.1.m1.3"><semantics id="S3.SS4.SSS3.p1.1.m1.3a"><mrow id="S3.SS4.SSS3.p1.1.m1.3.3.1" xref="S3.SS4.SSS3.p1.1.m1.3.3.1.1.cmml"><mo id="S3.SS4.SSS3.p1.1.m1.3.3.1.2" stretchy="false" xref="S3.SS4.SSS3.p1.1.m1.3.3.1.1.cmml">(</mo><msub id="S3.SS4.SSS3.p1.1.m1.3.3.1.1" xref="S3.SS4.SSS3.p1.1.m1.3.3.1.1.cmml"><mi id="S3.SS4.SSS3.p1.1.m1.3.3.1.1.2" xref="S3.SS4.SSS3.p1.1.m1.3.3.1.1.2.cmml">A</mi><mrow id="S3.SS4.SSS3.p1.1.m1.2.2.2.4" xref="S3.SS4.SSS3.p1.1.m1.2.2.2.3.cmml"><mi id="S3.SS4.SSS3.p1.1.m1.1.1.1.1" xref="S3.SS4.SSS3.p1.1.m1.1.1.1.1.cmml">t</mi><mo id="S3.SS4.SSS3.p1.1.m1.2.2.2.4.1" xref="S3.SS4.SSS3.p1.1.m1.2.2.2.3.cmml">,</mo><mi id="S3.SS4.SSS3.p1.1.m1.2.2.2.2" xref="S3.SS4.SSS3.p1.1.m1.2.2.2.2.cmml">q</mi></mrow></msub><mo id="S3.SS4.SSS3.p1.1.m1.3.3.1.3" stretchy="false" xref="S3.SS4.SSS3.p1.1.m1.3.3.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS3.p1.1.m1.3b"><apply id="S3.SS4.SSS3.p1.1.m1.3.3.1.1.cmml" xref="S3.SS4.SSS3.p1.1.m1.3.3.1"><csymbol cd="ambiguous" id="S3.SS4.SSS3.p1.1.m1.3.3.1.1.1.cmml" xref="S3.SS4.SSS3.p1.1.m1.3.3.1">subscript</csymbol><ci id="S3.SS4.SSS3.p1.1.m1.3.3.1.1.2.cmml" xref="S3.SS4.SSS3.p1.1.m1.3.3.1.1.2">𝐴</ci><list id="S3.SS4.SSS3.p1.1.m1.2.2.2.3.cmml" xref="S3.SS4.SSS3.p1.1.m1.2.2.2.4"><ci id="S3.SS4.SSS3.p1.1.m1.1.1.1.1.cmml" xref="S3.SS4.SSS3.p1.1.m1.1.1.1.1">𝑡</ci><ci id="S3.SS4.SSS3.p1.1.m1.2.2.2.2.cmml" xref="S3.SS4.SSS3.p1.1.m1.2.2.2.2">𝑞</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS3.p1.1.m1.3c">(A_{t,q})</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS3.p1.1.m1.3d">( italic_A start_POSTSUBSCRIPT italic_t , italic_q end_POSTSUBSCRIPT )</annotation></semantics></math> and <math alttext="(A^{\prime}_{t,q})" class="ltx_Math" display="inline" id="S3.SS4.SSS3.p1.2.m2.3"><semantics id="S3.SS4.SSS3.p1.2.m2.3a"><mrow id="S3.SS4.SSS3.p1.2.m2.3.3.1" xref="S3.SS4.SSS3.p1.2.m2.3.3.1.1.cmml"><mo id="S3.SS4.SSS3.p1.2.m2.3.3.1.2" stretchy="false" xref="S3.SS4.SSS3.p1.2.m2.3.3.1.1.cmml">(</mo><msubsup id="S3.SS4.SSS3.p1.2.m2.3.3.1.1" xref="S3.SS4.SSS3.p1.2.m2.3.3.1.1.cmml"><mi id="S3.SS4.SSS3.p1.2.m2.3.3.1.1.2.2" xref="S3.SS4.SSS3.p1.2.m2.3.3.1.1.2.2.cmml">A</mi><mrow id="S3.SS4.SSS3.p1.2.m2.2.2.2.4" xref="S3.SS4.SSS3.p1.2.m2.2.2.2.3.cmml"><mi id="S3.SS4.SSS3.p1.2.m2.1.1.1.1" xref="S3.SS4.SSS3.p1.2.m2.1.1.1.1.cmml">t</mi><mo id="S3.SS4.SSS3.p1.2.m2.2.2.2.4.1" xref="S3.SS4.SSS3.p1.2.m2.2.2.2.3.cmml">,</mo><mi id="S3.SS4.SSS3.p1.2.m2.2.2.2.2" xref="S3.SS4.SSS3.p1.2.m2.2.2.2.2.cmml">q</mi></mrow><mo id="S3.SS4.SSS3.p1.2.m2.3.3.1.1.2.3" xref="S3.SS4.SSS3.p1.2.m2.3.3.1.1.2.3.cmml">′</mo></msubsup><mo id="S3.SS4.SSS3.p1.2.m2.3.3.1.3" stretchy="false" xref="S3.SS4.SSS3.p1.2.m2.3.3.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS3.p1.2.m2.3b"><apply id="S3.SS4.SSS3.p1.2.m2.3.3.1.1.cmml" xref="S3.SS4.SSS3.p1.2.m2.3.3.1"><csymbol cd="ambiguous" id="S3.SS4.SSS3.p1.2.m2.3.3.1.1.1.cmml" xref="S3.SS4.SSS3.p1.2.m2.3.3.1">subscript</csymbol><apply id="S3.SS4.SSS3.p1.2.m2.3.3.1.1.2.cmml" xref="S3.SS4.SSS3.p1.2.m2.3.3.1"><csymbol cd="ambiguous" id="S3.SS4.SSS3.p1.2.m2.3.3.1.1.2.1.cmml" xref="S3.SS4.SSS3.p1.2.m2.3.3.1">superscript</csymbol><ci id="S3.SS4.SSS3.p1.2.m2.3.3.1.1.2.2.cmml" xref="S3.SS4.SSS3.p1.2.m2.3.3.1.1.2.2">𝐴</ci><ci id="S3.SS4.SSS3.p1.2.m2.3.3.1.1.2.3.cmml" xref="S3.SS4.SSS3.p1.2.m2.3.3.1.1.2.3">′</ci></apply><list id="S3.SS4.SSS3.p1.2.m2.2.2.2.3.cmml" xref="S3.SS4.SSS3.p1.2.m2.2.2.2.4"><ci id="S3.SS4.SSS3.p1.2.m2.1.1.1.1.cmml" xref="S3.SS4.SSS3.p1.2.m2.1.1.1.1">𝑡</ci><ci id="S3.SS4.SSS3.p1.2.m2.2.2.2.2.cmml" xref="S3.SS4.SSS3.p1.2.m2.2.2.2.2">𝑞</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS3.p1.2.m2.3c">(A^{\prime}_{t,q})</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS3.p1.2.m2.3d">( italic_A start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t , italic_q end_POSTSUBSCRIPT )</annotation></semantics></math>, we simply apply the acoustic delay to both, and concatenate them into <math alttext="V" class="ltx_Math" display="inline" id="S3.SS4.SSS3.p1.3.m3.1"><semantics id="S3.SS4.SSS3.p1.3.m3.1a"><mi id="S3.SS4.SSS3.p1.3.m3.1.1" xref="S3.SS4.SSS3.p1.3.m3.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS3.p1.3.m3.1b"><ci id="S3.SS4.SSS3.p1.3.m3.1.1.cmml" xref="S3.SS4.SSS3.p1.3.m3.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS3.p1.3.m3.1c">V</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS3.p1.3.m3.1d">italic_V</annotation></semantics></math>, extending <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2410.00037v2#S3.E4" title="4 ‣ Acoustic delay. ‣ 3.4.2 Audio modeling ‣ 3.4 Generative Audio Modeling ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_tag">Equation&nbsp;4</span></a>. In practice, <math alttext="A" class="ltx_Math" display="inline" id="S3.SS4.SSS3.p1.4.m4.1"><semantics id="S3.SS4.SSS3.p1.4.m4.1a"><mi id="S3.SS4.SSS3.p1.4.m4.1.1" xref="S3.SS4.SSS3.p1.4.m4.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS3.p1.4.m4.1b"><ci id="S3.SS4.SSS3.p1.4.m4.1.1.cmml" xref="S3.SS4.SSS3.p1.4.m4.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS3.p1.4.m4.1c">A</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS3.p1.4.m4.1d">italic_A</annotation></semantics></math> will correspond to Moshi, while <math alttext="A^{\prime}" class="ltx_Math" display="inline" id="S3.SS4.SSS3.p1.5.m5.1"><semantics id="S3.SS4.SSS3.p1.5.m5.1a"><msup id="S3.SS4.SSS3.p1.5.m5.1.1" xref="S3.SS4.SSS3.p1.5.m5.1.1.cmml"><mi id="S3.SS4.SSS3.p1.5.m5.1.1.2" xref="S3.SS4.SSS3.p1.5.m5.1.1.2.cmml">A</mi><mo id="S3.SS4.SSS3.p1.5.m5.1.1.3" xref="S3.SS4.SSS3.p1.5.m5.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS3.p1.5.m5.1b"><apply id="S3.SS4.SSS3.p1.5.m5.1.1.cmml" xref="S3.SS4.SSS3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS3.p1.5.m5.1.1.1.cmml" xref="S3.SS4.SSS3.p1.5.m5.1.1">superscript</csymbol><ci id="S3.SS4.SSS3.p1.5.m5.1.1.2.cmml" xref="S3.SS4.SSS3.p1.5.m5.1.1.2">𝐴</ci><ci id="S3.SS4.SSS3.p1.5.m5.1.1.3.cmml" xref="S3.SS4.SSS3.p1.5.m5.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS3.p1.5.m5.1c">A^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS3.p1.5.m5.1d">italic_A start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> models the user.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="S3.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="530" id="S3.F4.g1" src="https://arxiv.org/html/2410.00037v2/x1.png" width="789">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span><span class="ltx_text ltx_font_bold" id="S3.F4.6.1">Representation of the joint sequence modeled by Moshi</span>.
Each column represents the tokens for a given step in the joint sequence <math alttext="(V_{s,k})" class="ltx_Math" display="inline" id="S3.F4.3.m1.3"><semantics id="S3.F4.3.m1.3b"><mrow id="S3.F4.3.m1.3.3.1" xref="S3.F4.3.m1.3.3.1.1.cmml"><mo id="S3.F4.3.m1.3.3.1.2" stretchy="false" xref="S3.F4.3.m1.3.3.1.1.cmml">(</mo><msub id="S3.F4.3.m1.3.3.1.1" xref="S3.F4.3.m1.3.3.1.1.cmml"><mi id="S3.F4.3.m1.3.3.1.1.2" xref="S3.F4.3.m1.3.3.1.1.2.cmml">V</mi><mrow id="S3.F4.3.m1.2.2.2.4" xref="S3.F4.3.m1.2.2.2.3.cmml"><mi id="S3.F4.3.m1.1.1.1.1" xref="S3.F4.3.m1.1.1.1.1.cmml">s</mi><mo id="S3.F4.3.m1.2.2.2.4.1" xref="S3.F4.3.m1.2.2.2.3.cmml">,</mo><mi id="S3.F4.3.m1.2.2.2.2" xref="S3.F4.3.m1.2.2.2.2.cmml">k</mi></mrow></msub><mo id="S3.F4.3.m1.3.3.1.3" stretchy="false" xref="S3.F4.3.m1.3.3.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.F4.3.m1.3c"><apply id="S3.F4.3.m1.3.3.1.1.cmml" xref="S3.F4.3.m1.3.3.1"><csymbol cd="ambiguous" id="S3.F4.3.m1.3.3.1.1.1.cmml" xref="S3.F4.3.m1.3.3.1">subscript</csymbol><ci id="S3.F4.3.m1.3.3.1.1.2.cmml" xref="S3.F4.3.m1.3.3.1.1.2">𝑉</ci><list id="S3.F4.3.m1.2.2.2.3.cmml" xref="S3.F4.3.m1.2.2.2.4"><ci id="S3.F4.3.m1.1.1.1.1.cmml" xref="S3.F4.3.m1.1.1.1.1">𝑠</ci><ci id="S3.F4.3.m1.2.2.2.2.cmml" xref="S3.F4.3.m1.2.2.2.2">𝑘</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.3.m1.3d">(V_{s,k})</annotation><annotation encoding="application/x-llamapun" id="S3.F4.3.m1.3e">( italic_V start_POSTSUBSCRIPT italic_s , italic_k end_POSTSUBSCRIPT )</annotation></semantics></math> described in&nbsp;<a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2410.00037v2#S3.E6" title="6 ‣ Joint sequence modeling for Moshi. ‣ 3.4.4 Inner Monologue ‣ 3.4 Generative Audio Modeling ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_tag">Equation&nbsp;6</span></a> with an acoustic delay <math alttext="\tau=1" class="ltx_Math" display="inline" id="S3.F4.4.m2.1"><semantics id="S3.F4.4.m2.1b"><mrow id="S3.F4.4.m2.1.1" xref="S3.F4.4.m2.1.1.cmml"><mi id="S3.F4.4.m2.1.1.2" xref="S3.F4.4.m2.1.1.2.cmml">τ</mi><mo id="S3.F4.4.m2.1.1.1" xref="S3.F4.4.m2.1.1.1.cmml">=</mo><mn id="S3.F4.4.m2.1.1.3" xref="S3.F4.4.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.F4.4.m2.1c"><apply id="S3.F4.4.m2.1.1.cmml" xref="S3.F4.4.m2.1.1"><eq id="S3.F4.4.m2.1.1.1.cmml" xref="S3.F4.4.m2.1.1.1"></eq><ci id="S3.F4.4.m2.1.1.2.cmml" xref="S3.F4.4.m2.1.1.2">𝜏</ci><cn id="S3.F4.4.m2.1.1.3.cmml" type="integer" xref="S3.F4.4.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.4.m2.1d">\tau=1</annotation><annotation encoding="application/x-llamapun" id="S3.F4.4.m2.1e">italic_τ = 1</annotation></semantics></math>, e.g. the input of the Temporal Transformer for this step.
Tokens are predicted from bottom to top in the Depth Transformer. At inference time,
tokens under the dashed line (corresponding to Moshi) are sampled, while those above are fed from the user. This design allows for our model to handle overlapping speech turns.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_subsubsection" id="S3.SS4.SSS4">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.4.4 </span>Inner Monologue</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.SS4.SSS4.p1">
<p class="ltx_p" id="S3.SS4.SSS4.p1.3">While operating purely in the audio domain already yields convincing results (see <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.T7" title="Table 7 ‣ Discussion. ‣ 5.3 Ablations on Generative Modeling ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue">Table&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></span></a>), we observe
that having Moshi also model the textual representation of its own speech is providing a
scaffolding that increases the linguistic quality of its generation. Formally, we define a text stream <math alttext="W\in\{1,\ldots,N_{W}\}^{T}" class="ltx_Math" display="inline" id="S3.SS4.SSS4.p1.1.m1.3"><semantics id="S3.SS4.SSS4.p1.1.m1.3a"><mrow id="S3.SS4.SSS4.p1.1.m1.3.3" xref="S3.SS4.SSS4.p1.1.m1.3.3.cmml"><mi id="S3.SS4.SSS4.p1.1.m1.3.3.3" xref="S3.SS4.SSS4.p1.1.m1.3.3.3.cmml">W</mi><mo id="S3.SS4.SSS4.p1.1.m1.3.3.2" xref="S3.SS4.SSS4.p1.1.m1.3.3.2.cmml">∈</mo><msup id="S3.SS4.SSS4.p1.1.m1.3.3.1" xref="S3.SS4.SSS4.p1.1.m1.3.3.1.cmml"><mrow id="S3.SS4.SSS4.p1.1.m1.3.3.1.1.1" xref="S3.SS4.SSS4.p1.1.m1.3.3.1.1.2.cmml"><mo id="S3.SS4.SSS4.p1.1.m1.3.3.1.1.1.2" stretchy="false" xref="S3.SS4.SSS4.p1.1.m1.3.3.1.1.2.cmml">{</mo><mn id="S3.SS4.SSS4.p1.1.m1.1.1" xref="S3.SS4.SSS4.p1.1.m1.1.1.cmml">1</mn><mo id="S3.SS4.SSS4.p1.1.m1.3.3.1.1.1.3" xref="S3.SS4.SSS4.p1.1.m1.3.3.1.1.2.cmml">,</mo><mi id="S3.SS4.SSS4.p1.1.m1.2.2" mathvariant="normal" xref="S3.SS4.SSS4.p1.1.m1.2.2.cmml">…</mi><mo id="S3.SS4.SSS4.p1.1.m1.3.3.1.1.1.4" xref="S3.SS4.SSS4.p1.1.m1.3.3.1.1.2.cmml">,</mo><msub id="S3.SS4.SSS4.p1.1.m1.3.3.1.1.1.1" xref="S3.SS4.SSS4.p1.1.m1.3.3.1.1.1.1.cmml"><mi id="S3.SS4.SSS4.p1.1.m1.3.3.1.1.1.1.2" xref="S3.SS4.SSS4.p1.1.m1.3.3.1.1.1.1.2.cmml">N</mi><mi id="S3.SS4.SSS4.p1.1.m1.3.3.1.1.1.1.3" xref="S3.SS4.SSS4.p1.1.m1.3.3.1.1.1.1.3.cmml">W</mi></msub><mo id="S3.SS4.SSS4.p1.1.m1.3.3.1.1.1.5" stretchy="false" xref="S3.SS4.SSS4.p1.1.m1.3.3.1.1.2.cmml">}</mo></mrow><mi id="S3.SS4.SSS4.p1.1.m1.3.3.1.3" xref="S3.SS4.SSS4.p1.1.m1.3.3.1.3.cmml">T</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS4.p1.1.m1.3b"><apply id="S3.SS4.SSS4.p1.1.m1.3.3.cmml" xref="S3.SS4.SSS4.p1.1.m1.3.3"><in id="S3.SS4.SSS4.p1.1.m1.3.3.2.cmml" xref="S3.SS4.SSS4.p1.1.m1.3.3.2"></in><ci id="S3.SS4.SSS4.p1.1.m1.3.3.3.cmml" xref="S3.SS4.SSS4.p1.1.m1.3.3.3">𝑊</ci><apply id="S3.SS4.SSS4.p1.1.m1.3.3.1.cmml" xref="S3.SS4.SSS4.p1.1.m1.3.3.1"><csymbol cd="ambiguous" id="S3.SS4.SSS4.p1.1.m1.3.3.1.2.cmml" xref="S3.SS4.SSS4.p1.1.m1.3.3.1">superscript</csymbol><set id="S3.SS4.SSS4.p1.1.m1.3.3.1.1.2.cmml" xref="S3.SS4.SSS4.p1.1.m1.3.3.1.1.1"><cn id="S3.SS4.SSS4.p1.1.m1.1.1.cmml" type="integer" xref="S3.SS4.SSS4.p1.1.m1.1.1">1</cn><ci id="S3.SS4.SSS4.p1.1.m1.2.2.cmml" xref="S3.SS4.SSS4.p1.1.m1.2.2">…</ci><apply id="S3.SS4.SSS4.p1.1.m1.3.3.1.1.1.1.cmml" xref="S3.SS4.SSS4.p1.1.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS4.p1.1.m1.3.3.1.1.1.1.1.cmml" xref="S3.SS4.SSS4.p1.1.m1.3.3.1.1.1.1">subscript</csymbol><ci id="S3.SS4.SSS4.p1.1.m1.3.3.1.1.1.1.2.cmml" xref="S3.SS4.SSS4.p1.1.m1.3.3.1.1.1.1.2">𝑁</ci><ci id="S3.SS4.SSS4.p1.1.m1.3.3.1.1.1.1.3.cmml" xref="S3.SS4.SSS4.p1.1.m1.3.3.1.1.1.1.3">𝑊</ci></apply></set><ci id="S3.SS4.SSS4.p1.1.m1.3.3.1.3.cmml" xref="S3.SS4.SSS4.p1.1.m1.3.3.1.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS4.p1.1.m1.3c">W\in\{1,\ldots,N_{W}\}^{T}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS4.p1.1.m1.3d">italic_W ∈ { 1 , … , italic_N start_POSTSUBSCRIPT italic_W end_POSTSUBSCRIPT } start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math> derived from the sequence of text tokens obtained by applying the SentencePiece tokenizer&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Kudo and Richardson, <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib50" title="">2018</a>)</cite> to the transcription of the audio corresponding to Moshi with Whisper&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Radford et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib77" title="">2023</a>)</cite>, as described after. We insert <math alttext="W" class="ltx_Math" display="inline" id="S3.SS4.SSS4.p1.2.m2.1"><semantics id="S3.SS4.SSS4.p1.2.m2.1a"><mi id="S3.SS4.SSS4.p1.2.m2.1.1" xref="S3.SS4.SSS4.p1.2.m2.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS4.p1.2.m2.1b"><ci id="S3.SS4.SSS4.p1.2.m2.1.1.cmml" xref="S3.SS4.SSS4.p1.2.m2.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS4.p1.2.m2.1c">W</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS4.p1.2.m2.1d">italic_W</annotation></semantics></math> as the first sub-sequence in <math alttext="V" class="ltx_Math" display="inline" id="S3.SS4.SSS4.p1.3.m3.1"><semantics id="S3.SS4.SSS4.p1.3.m3.1a"><mi id="S3.SS4.SSS4.p1.3.m3.1.1" xref="S3.SS4.SSS4.p1.3.m3.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS4.p1.3.m3.1b"><ci id="S3.SS4.SSS4.p1.3.m3.1.1.cmml" xref="S3.SS4.SSS4.p1.3.m3.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS4.p1.3.m3.1c">V</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS4.p1.3.m3.1d">italic_V</annotation></semantics></math>, such that it acts as a prefix to the generation of semantic tokens. This can be seen as an extension of the hierarchical semantic-to-acoustic generation introduced by&nbsp;<cite class="ltx_cite ltx_citemacro_citet">Borsos et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib6" title="">2022</a>)</cite>. Note that we do not use the textual representation corresponding to the stream of the user, as transcribing this flux in real time would be challenging, and relying on an external ASR system contradicts our end-to-end speech-to-speech approach. Ablation studies in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.SS3" title="5.3 Ablations on Generative Modeling ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue">Section&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.3</span></span></a> show that among the design choices made for Moshi, Inner Monologue has one of the most critical impacts on the quality of generated speech.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_paragraph" id="S3.SS4.SSS4.Px1">
<h5 class="ltx_title ltx_title_paragraph">Aligning text and audio tokens.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.SS4.SSS4.Px1.p1">
<p class="ltx_p" id="S3.SS4.SSS4.Px1.p1.7">To integrate text tokens with audio tokens that operate at a constant framerate of 12.5Hz, we need to align them to this framerate. For that, we leverage the word-level timestamp provided by Whisper.
The <math alttext="i" class="ltx_Math" display="inline" id="S3.SS4.SSS4.Px1.p1.1.m1.1"><semantics id="S3.SS4.SSS4.Px1.p1.1.m1.1a"><mi id="S3.SS4.SSS4.Px1.p1.1.m1.1.1" xref="S3.SS4.SSS4.Px1.p1.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS4.Px1.p1.1.m1.1b"><ci id="S3.SS4.SSS4.Px1.p1.1.m1.1.1.cmml" xref="S3.SS4.SSS4.Px1.p1.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS4.Px1.p1.1.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS4.Px1.p1.1.m1.1d">italic_i</annotation></semantics></math>-th word in the transcript is mapped to <math alttext="n_{i}\in\mathbb{N}^{*}" class="ltx_Math" display="inline" id="S3.SS4.SSS4.Px1.p1.2.m2.1"><semantics id="S3.SS4.SSS4.Px1.p1.2.m2.1a"><mrow id="S3.SS4.SSS4.Px1.p1.2.m2.1.1" xref="S3.SS4.SSS4.Px1.p1.2.m2.1.1.cmml"><msub id="S3.SS4.SSS4.Px1.p1.2.m2.1.1.2" xref="S3.SS4.SSS4.Px1.p1.2.m2.1.1.2.cmml"><mi id="S3.SS4.SSS4.Px1.p1.2.m2.1.1.2.2" xref="S3.SS4.SSS4.Px1.p1.2.m2.1.1.2.2.cmml">n</mi><mi id="S3.SS4.SSS4.Px1.p1.2.m2.1.1.2.3" xref="S3.SS4.SSS4.Px1.p1.2.m2.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS4.SSS4.Px1.p1.2.m2.1.1.1" xref="S3.SS4.SSS4.Px1.p1.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS4.SSS4.Px1.p1.2.m2.1.1.3" xref="S3.SS4.SSS4.Px1.p1.2.m2.1.1.3.cmml"><mi id="S3.SS4.SSS4.Px1.p1.2.m2.1.1.3.2" xref="S3.SS4.SSS4.Px1.p1.2.m2.1.1.3.2.cmml">ℕ</mi><mo id="S3.SS4.SSS4.Px1.p1.2.m2.1.1.3.3" xref="S3.SS4.SSS4.Px1.p1.2.m2.1.1.3.3.cmml">∗</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS4.Px1.p1.2.m2.1b"><apply id="S3.SS4.SSS4.Px1.p1.2.m2.1.1.cmml" xref="S3.SS4.SSS4.Px1.p1.2.m2.1.1"><in id="S3.SS4.SSS4.Px1.p1.2.m2.1.1.1.cmml" xref="S3.SS4.SSS4.Px1.p1.2.m2.1.1.1"></in><apply id="S3.SS4.SSS4.Px1.p1.2.m2.1.1.2.cmml" xref="S3.SS4.SSS4.Px1.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.SSS4.Px1.p1.2.m2.1.1.2.1.cmml" xref="S3.SS4.SSS4.Px1.p1.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS4.SSS4.Px1.p1.2.m2.1.1.2.2.cmml" xref="S3.SS4.SSS4.Px1.p1.2.m2.1.1.2.2">𝑛</ci><ci id="S3.SS4.SSS4.Px1.p1.2.m2.1.1.2.3.cmml" xref="S3.SS4.SSS4.Px1.p1.2.m2.1.1.2.3">𝑖</ci></apply><apply id="S3.SS4.SSS4.Px1.p1.2.m2.1.1.3.cmml" xref="S3.SS4.SSS4.Px1.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.SSS4.Px1.p1.2.m2.1.1.3.1.cmml" xref="S3.SS4.SSS4.Px1.p1.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS4.SSS4.Px1.p1.2.m2.1.1.3.2.cmml" xref="S3.SS4.SSS4.Px1.p1.2.m2.1.1.3.2">ℕ</ci><times id="S3.SS4.SSS4.Px1.p1.2.m2.1.1.3.3.cmml" xref="S3.SS4.SSS4.Px1.p1.2.m2.1.1.3.3"></times></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS4.Px1.p1.2.m2.1c">n_{i}\in\mathbb{N}^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS4.Px1.p1.2.m2.1d">italic_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ blackboard_N start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> text tokens <math alttext="w_{i,j}" class="ltx_Math" display="inline" id="S3.SS4.SSS4.Px1.p1.3.m3.2"><semantics id="S3.SS4.SSS4.Px1.p1.3.m3.2a"><msub id="S3.SS4.SSS4.Px1.p1.3.m3.2.3" xref="S3.SS4.SSS4.Px1.p1.3.m3.2.3.cmml"><mi id="S3.SS4.SSS4.Px1.p1.3.m3.2.3.2" xref="S3.SS4.SSS4.Px1.p1.3.m3.2.3.2.cmml">w</mi><mrow id="S3.SS4.SSS4.Px1.p1.3.m3.2.2.2.4" xref="S3.SS4.SSS4.Px1.p1.3.m3.2.2.2.3.cmml"><mi id="S3.SS4.SSS4.Px1.p1.3.m3.1.1.1.1" xref="S3.SS4.SSS4.Px1.p1.3.m3.1.1.1.1.cmml">i</mi><mo id="S3.SS4.SSS4.Px1.p1.3.m3.2.2.2.4.1" xref="S3.SS4.SSS4.Px1.p1.3.m3.2.2.2.3.cmml">,</mo><mi id="S3.SS4.SSS4.Px1.p1.3.m3.2.2.2.2" xref="S3.SS4.SSS4.Px1.p1.3.m3.2.2.2.2.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS4.Px1.p1.3.m3.2b"><apply id="S3.SS4.SSS4.Px1.p1.3.m3.2.3.cmml" xref="S3.SS4.SSS4.Px1.p1.3.m3.2.3"><csymbol cd="ambiguous" id="S3.SS4.SSS4.Px1.p1.3.m3.2.3.1.cmml" xref="S3.SS4.SSS4.Px1.p1.3.m3.2.3">subscript</csymbol><ci id="S3.SS4.SSS4.Px1.p1.3.m3.2.3.2.cmml" xref="S3.SS4.SSS4.Px1.p1.3.m3.2.3.2">𝑤</ci><list id="S3.SS4.SSS4.Px1.p1.3.m3.2.2.2.3.cmml" xref="S3.SS4.SSS4.Px1.p1.3.m3.2.2.2.4"><ci id="S3.SS4.SSS4.Px1.p1.3.m3.1.1.1.1.cmml" xref="S3.SS4.SSS4.Px1.p1.3.m3.1.1.1.1">𝑖</ci><ci id="S3.SS4.SSS4.Px1.p1.3.m3.2.2.2.2.cmml" xref="S3.SS4.SSS4.Px1.p1.3.m3.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS4.Px1.p1.3.m3.2c">w_{i,j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS4.Px1.p1.3.m3.2d">italic_w start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="j\leq n_{i}" class="ltx_Math" display="inline" id="S3.SS4.SSS4.Px1.p1.4.m4.1"><semantics id="S3.SS4.SSS4.Px1.p1.4.m4.1a"><mrow id="S3.SS4.SSS4.Px1.p1.4.m4.1.1" xref="S3.SS4.SSS4.Px1.p1.4.m4.1.1.cmml"><mi id="S3.SS4.SSS4.Px1.p1.4.m4.1.1.2" xref="S3.SS4.SSS4.Px1.p1.4.m4.1.1.2.cmml">j</mi><mo id="S3.SS4.SSS4.Px1.p1.4.m4.1.1.1" xref="S3.SS4.SSS4.Px1.p1.4.m4.1.1.1.cmml">≤</mo><msub id="S3.SS4.SSS4.Px1.p1.4.m4.1.1.3" xref="S3.SS4.SSS4.Px1.p1.4.m4.1.1.3.cmml"><mi id="S3.SS4.SSS4.Px1.p1.4.m4.1.1.3.2" xref="S3.SS4.SSS4.Px1.p1.4.m4.1.1.3.2.cmml">n</mi><mi id="S3.SS4.SSS4.Px1.p1.4.m4.1.1.3.3" xref="S3.SS4.SSS4.Px1.p1.4.m4.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS4.Px1.p1.4.m4.1b"><apply id="S3.SS4.SSS4.Px1.p1.4.m4.1.1.cmml" xref="S3.SS4.SSS4.Px1.p1.4.m4.1.1"><leq id="S3.SS4.SSS4.Px1.p1.4.m4.1.1.1.cmml" xref="S3.SS4.SSS4.Px1.p1.4.m4.1.1.1"></leq><ci id="S3.SS4.SSS4.Px1.p1.4.m4.1.1.2.cmml" xref="S3.SS4.SSS4.Px1.p1.4.m4.1.1.2">𝑗</ci><apply id="S3.SS4.SSS4.Px1.p1.4.m4.1.1.3.cmml" xref="S3.SS4.SSS4.Px1.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.SSS4.Px1.p1.4.m4.1.1.3.1.cmml" xref="S3.SS4.SSS4.Px1.p1.4.m4.1.1.3">subscript</csymbol><ci id="S3.SS4.SSS4.Px1.p1.4.m4.1.1.3.2.cmml" xref="S3.SS4.SSS4.Px1.p1.4.m4.1.1.3.2">𝑛</ci><ci id="S3.SS4.SSS4.Px1.p1.4.m4.1.1.3.3.cmml" xref="S3.SS4.SSS4.Px1.p1.4.m4.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS4.Px1.p1.4.m4.1c">j\leq n_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS4.Px1.p1.4.m4.1d">italic_j ≤ italic_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, along with a start index <math alttext="t_{i}\in\{1,\ldots T\}" class="ltx_Math" display="inline" id="S3.SS4.SSS4.Px1.p1.5.m5.2"><semantics id="S3.SS4.SSS4.Px1.p1.5.m5.2a"><mrow id="S3.SS4.SSS4.Px1.p1.5.m5.2.2" xref="S3.SS4.SSS4.Px1.p1.5.m5.2.2.cmml"><msub id="S3.SS4.SSS4.Px1.p1.5.m5.2.2.3" xref="S3.SS4.SSS4.Px1.p1.5.m5.2.2.3.cmml"><mi id="S3.SS4.SSS4.Px1.p1.5.m5.2.2.3.2" xref="S3.SS4.SSS4.Px1.p1.5.m5.2.2.3.2.cmml">t</mi><mi id="S3.SS4.SSS4.Px1.p1.5.m5.2.2.3.3" xref="S3.SS4.SSS4.Px1.p1.5.m5.2.2.3.3.cmml">i</mi></msub><mo id="S3.SS4.SSS4.Px1.p1.5.m5.2.2.2" xref="S3.SS4.SSS4.Px1.p1.5.m5.2.2.2.cmml">∈</mo><mrow id="S3.SS4.SSS4.Px1.p1.5.m5.2.2.1.1" xref="S3.SS4.SSS4.Px1.p1.5.m5.2.2.1.2.cmml"><mo id="S3.SS4.SSS4.Px1.p1.5.m5.2.2.1.1.2" stretchy="false" xref="S3.SS4.SSS4.Px1.p1.5.m5.2.2.1.2.cmml">{</mo><mn id="S3.SS4.SSS4.Px1.p1.5.m5.1.1" xref="S3.SS4.SSS4.Px1.p1.5.m5.1.1.cmml">1</mn><mo id="S3.SS4.SSS4.Px1.p1.5.m5.2.2.1.1.3" xref="S3.SS4.SSS4.Px1.p1.5.m5.2.2.1.2.cmml">,</mo><mrow id="S3.SS4.SSS4.Px1.p1.5.m5.2.2.1.1.1" xref="S3.SS4.SSS4.Px1.p1.5.m5.2.2.1.1.1.cmml"><mi id="S3.SS4.SSS4.Px1.p1.5.m5.2.2.1.1.1.2" mathvariant="normal" xref="S3.SS4.SSS4.Px1.p1.5.m5.2.2.1.1.1.2.cmml">…</mi><mo id="S3.SS4.SSS4.Px1.p1.5.m5.2.2.1.1.1.1" xref="S3.SS4.SSS4.Px1.p1.5.m5.2.2.1.1.1.1.cmml">⁢</mo><mi id="S3.SS4.SSS4.Px1.p1.5.m5.2.2.1.1.1.3" xref="S3.SS4.SSS4.Px1.p1.5.m5.2.2.1.1.1.3.cmml">T</mi></mrow><mo id="S3.SS4.SSS4.Px1.p1.5.m5.2.2.1.1.4" stretchy="false" xref="S3.SS4.SSS4.Px1.p1.5.m5.2.2.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS4.Px1.p1.5.m5.2b"><apply id="S3.SS4.SSS4.Px1.p1.5.m5.2.2.cmml" xref="S3.SS4.SSS4.Px1.p1.5.m5.2.2"><in id="S3.SS4.SSS4.Px1.p1.5.m5.2.2.2.cmml" xref="S3.SS4.SSS4.Px1.p1.5.m5.2.2.2"></in><apply id="S3.SS4.SSS4.Px1.p1.5.m5.2.2.3.cmml" xref="S3.SS4.SSS4.Px1.p1.5.m5.2.2.3"><csymbol cd="ambiguous" id="S3.SS4.SSS4.Px1.p1.5.m5.2.2.3.1.cmml" xref="S3.SS4.SSS4.Px1.p1.5.m5.2.2.3">subscript</csymbol><ci id="S3.SS4.SSS4.Px1.p1.5.m5.2.2.3.2.cmml" xref="S3.SS4.SSS4.Px1.p1.5.m5.2.2.3.2">𝑡</ci><ci id="S3.SS4.SSS4.Px1.p1.5.m5.2.2.3.3.cmml" xref="S3.SS4.SSS4.Px1.p1.5.m5.2.2.3.3">𝑖</ci></apply><set id="S3.SS4.SSS4.Px1.p1.5.m5.2.2.1.2.cmml" xref="S3.SS4.SSS4.Px1.p1.5.m5.2.2.1.1"><cn id="S3.SS4.SSS4.Px1.p1.5.m5.1.1.cmml" type="integer" xref="S3.SS4.SSS4.Px1.p1.5.m5.1.1">1</cn><apply id="S3.SS4.SSS4.Px1.p1.5.m5.2.2.1.1.1.cmml" xref="S3.SS4.SSS4.Px1.p1.5.m5.2.2.1.1.1"><times id="S3.SS4.SSS4.Px1.p1.5.m5.2.2.1.1.1.1.cmml" xref="S3.SS4.SSS4.Px1.p1.5.m5.2.2.1.1.1.1"></times><ci id="S3.SS4.SSS4.Px1.p1.5.m5.2.2.1.1.1.2.cmml" xref="S3.SS4.SSS4.Px1.p1.5.m5.2.2.1.1.1.2">…</ci><ci id="S3.SS4.SSS4.Px1.p1.5.m5.2.2.1.1.1.3.cmml" xref="S3.SS4.SSS4.Px1.p1.5.m5.2.2.1.1.1.3">𝑇</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS4.Px1.p1.5.m5.2c">t_{i}\in\{1,\ldots T\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS4.Px1.p1.5.m5.2d">italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ { 1 , … italic_T }</annotation></semantics></math>, simply defined
as its start timestamp divided by the framerate of 12.5 Hz.
We define two special tokens: <span class="ltx_text ltx_font_typewriter" id="S3.SS4.SSS4.Px1.p1.7.1">PAD</span> and <span class="ltx_text ltx_font_typewriter" id="S3.SS4.SSS4.Px1.p1.7.2">EPAD</span>, that
never appear in any of the word tokens. We build <math alttext="W" class="ltx_Math" display="inline" id="S3.SS4.SSS4.Px1.p1.6.m6.1"><semantics id="S3.SS4.SSS4.Px1.p1.6.m6.1a"><mi id="S3.SS4.SSS4.Px1.p1.6.m6.1.1" xref="S3.SS4.SSS4.Px1.p1.6.m6.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS4.Px1.p1.6.m6.1b"><ci id="S3.SS4.SSS4.Px1.p1.6.m6.1.1.cmml" xref="S3.SS4.SSS4.Px1.p1.6.m6.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS4.Px1.p1.6.m6.1c">W</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS4.Px1.p1.6.m6.1d">italic_W</annotation></semantics></math> such that when a word starts,
<math alttext="(W_{t})" class="ltx_Math" display="inline" id="S3.SS4.SSS4.Px1.p1.7.m7.1"><semantics id="S3.SS4.SSS4.Px1.p1.7.m7.1a"><mrow id="S3.SS4.SSS4.Px1.p1.7.m7.1.1.1" xref="S3.SS4.SSS4.Px1.p1.7.m7.1.1.1.1.cmml"><mo id="S3.SS4.SSS4.Px1.p1.7.m7.1.1.1.2" stretchy="false" xref="S3.SS4.SSS4.Px1.p1.7.m7.1.1.1.1.cmml">(</mo><msub id="S3.SS4.SSS4.Px1.p1.7.m7.1.1.1.1" xref="S3.SS4.SSS4.Px1.p1.7.m7.1.1.1.1.cmml"><mi id="S3.SS4.SSS4.Px1.p1.7.m7.1.1.1.1.2" xref="S3.SS4.SSS4.Px1.p1.7.m7.1.1.1.1.2.cmml">W</mi><mi id="S3.SS4.SSS4.Px1.p1.7.m7.1.1.1.1.3" xref="S3.SS4.SSS4.Px1.p1.7.m7.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS4.SSS4.Px1.p1.7.m7.1.1.1.3" stretchy="false" xref="S3.SS4.SSS4.Px1.p1.7.m7.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS4.Px1.p1.7.m7.1b"><apply id="S3.SS4.SSS4.Px1.p1.7.m7.1.1.1.1.cmml" xref="S3.SS4.SSS4.Px1.p1.7.m7.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS4.Px1.p1.7.m7.1.1.1.1.1.cmml" xref="S3.SS4.SSS4.Px1.p1.7.m7.1.1.1">subscript</csymbol><ci id="S3.SS4.SSS4.Px1.p1.7.m7.1.1.1.1.2.cmml" xref="S3.SS4.SSS4.Px1.p1.7.m7.1.1.1.1.2">𝑊</ci><ci id="S3.SS4.SSS4.Px1.p1.7.m7.1.1.1.1.3.cmml" xref="S3.SS4.SSS4.Px1.p1.7.m7.1.1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS4.Px1.p1.7.m7.1c">(W_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS4.Px1.p1.7.m7.1d">( italic_W start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> contains its text tokens, followed by <span class="ltx_text ltx_font_typewriter" id="S3.SS4.SSS4.Px1.p1.7.3">PAD</span> until the next word. <span class="ltx_text ltx_font_typewriter" id="S3.SS4.SSS4.Px1.p1.7.4">EPAD</span> is inserted before the next word to indicate the end of the padding. While
not strictly necessary, we observed this provided a useful guidance to the model by splitting the decision of ending a word, and which one should follow, into two steps.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S3.SS4.SSS4.Px1.p2">
<p class="ltx_p" id="S3.SS4.SSS4.Px1.p2.5">First, the sequence <math alttext="(W_{t})" class="ltx_Math" display="inline" id="S3.SS4.SSS4.Px1.p2.1.m1.1"><semantics id="S3.SS4.SSS4.Px1.p2.1.m1.1a"><mrow id="S3.SS4.SSS4.Px1.p2.1.m1.1.1.1" xref="S3.SS4.SSS4.Px1.p2.1.m1.1.1.1.1.cmml"><mo id="S3.SS4.SSS4.Px1.p2.1.m1.1.1.1.2" stretchy="false" xref="S3.SS4.SSS4.Px1.p2.1.m1.1.1.1.1.cmml">(</mo><msub id="S3.SS4.SSS4.Px1.p2.1.m1.1.1.1.1" xref="S3.SS4.SSS4.Px1.p2.1.m1.1.1.1.1.cmml"><mi id="S3.SS4.SSS4.Px1.p2.1.m1.1.1.1.1.2" xref="S3.SS4.SSS4.Px1.p2.1.m1.1.1.1.1.2.cmml">W</mi><mi id="S3.SS4.SSS4.Px1.p2.1.m1.1.1.1.1.3" xref="S3.SS4.SSS4.Px1.p2.1.m1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS4.SSS4.Px1.p2.1.m1.1.1.1.3" stretchy="false" xref="S3.SS4.SSS4.Px1.p2.1.m1.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS4.Px1.p2.1.m1.1b"><apply id="S3.SS4.SSS4.Px1.p2.1.m1.1.1.1.1.cmml" xref="S3.SS4.SSS4.Px1.p2.1.m1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS4.Px1.p2.1.m1.1.1.1.1.1.cmml" xref="S3.SS4.SSS4.Px1.p2.1.m1.1.1.1">subscript</csymbol><ci id="S3.SS4.SSS4.Px1.p2.1.m1.1.1.1.1.2.cmml" xref="S3.SS4.SSS4.Px1.p2.1.m1.1.1.1.1.2">𝑊</ci><ci id="S3.SS4.SSS4.Px1.p2.1.m1.1.1.1.1.3.cmml" xref="S3.SS4.SSS4.Px1.p2.1.m1.1.1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS4.Px1.p2.1.m1.1c">(W_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS4.Px1.p2.1.m1.1d">( italic_W start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> is initialized with <span class="ltx_text ltx_font_typewriter" id="S3.SS4.SSS4.Px1.p2.5.1">PAD</span> tokens, e.g. <math alttext="\forall t,W_{t}\leftarrow\text{{PAD}}" class="ltx_Math" display="inline" id="S3.SS4.SSS4.Px1.p2.2.m2.2"><semantics id="S3.SS4.SSS4.Px1.p2.2.m2.2a"><mrow id="S3.SS4.SSS4.Px1.p2.2.m2.2.2" xref="S3.SS4.SSS4.Px1.p2.2.m2.2.2.cmml"><mrow id="S3.SS4.SSS4.Px1.p2.2.m2.2.2.2.2" xref="S3.SS4.SSS4.Px1.p2.2.m2.2.2.2.3.cmml"><mrow id="S3.SS4.SSS4.Px1.p2.2.m2.1.1.1.1.1" xref="S3.SS4.SSS4.Px1.p2.2.m2.1.1.1.1.1.cmml"><mo id="S3.SS4.SSS4.Px1.p2.2.m2.1.1.1.1.1.1" rspace="0.167em" xref="S3.SS4.SSS4.Px1.p2.2.m2.1.1.1.1.1.1.cmml">∀</mo><mi id="S3.SS4.SSS4.Px1.p2.2.m2.1.1.1.1.1.2" xref="S3.SS4.SSS4.Px1.p2.2.m2.1.1.1.1.1.2.cmml">t</mi></mrow><mo id="S3.SS4.SSS4.Px1.p2.2.m2.2.2.2.2.3" xref="S3.SS4.SSS4.Px1.p2.2.m2.2.2.2.3.cmml">,</mo><msub id="S3.SS4.SSS4.Px1.p2.2.m2.2.2.2.2.2" xref="S3.SS4.SSS4.Px1.p2.2.m2.2.2.2.2.2.cmml"><mi id="S3.SS4.SSS4.Px1.p2.2.m2.2.2.2.2.2.2" xref="S3.SS4.SSS4.Px1.p2.2.m2.2.2.2.2.2.2.cmml">W</mi><mi id="S3.SS4.SSS4.Px1.p2.2.m2.2.2.2.2.2.3" xref="S3.SS4.SSS4.Px1.p2.2.m2.2.2.2.2.2.3.cmml">t</mi></msub></mrow><mo id="S3.SS4.SSS4.Px1.p2.2.m2.2.2.3" stretchy="false" xref="S3.SS4.SSS4.Px1.p2.2.m2.2.2.3.cmml">←</mo><mtext class="ltx_mathvariant_monospace" id="S3.SS4.SSS4.Px1.p2.2.m2.2.2.4" xref="S3.SS4.SSS4.Px1.p2.2.m2.2.2.4a.cmml">PAD</mtext></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS4.Px1.p2.2.m2.2b"><apply id="S3.SS4.SSS4.Px1.p2.2.m2.2.2.cmml" xref="S3.SS4.SSS4.Px1.p2.2.m2.2.2"><ci id="S3.SS4.SSS4.Px1.p2.2.m2.2.2.3.cmml" xref="S3.SS4.SSS4.Px1.p2.2.m2.2.2.3">←</ci><list id="S3.SS4.SSS4.Px1.p2.2.m2.2.2.2.3.cmml" xref="S3.SS4.SSS4.Px1.p2.2.m2.2.2.2.2"><apply id="S3.SS4.SSS4.Px1.p2.2.m2.1.1.1.1.1.cmml" xref="S3.SS4.SSS4.Px1.p2.2.m2.1.1.1.1.1"><csymbol cd="latexml" id="S3.SS4.SSS4.Px1.p2.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS4.SSS4.Px1.p2.2.m2.1.1.1.1.1.1">for-all</csymbol><ci id="S3.SS4.SSS4.Px1.p2.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS4.SSS4.Px1.p2.2.m2.1.1.1.1.1.2">𝑡</ci></apply><apply id="S3.SS4.SSS4.Px1.p2.2.m2.2.2.2.2.2.cmml" xref="S3.SS4.SSS4.Px1.p2.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.SSS4.Px1.p2.2.m2.2.2.2.2.2.1.cmml" xref="S3.SS4.SSS4.Px1.p2.2.m2.2.2.2.2.2">subscript</csymbol><ci id="S3.SS4.SSS4.Px1.p2.2.m2.2.2.2.2.2.2.cmml" xref="S3.SS4.SSS4.Px1.p2.2.m2.2.2.2.2.2.2">𝑊</ci><ci id="S3.SS4.SSS4.Px1.p2.2.m2.2.2.2.2.2.3.cmml" xref="S3.SS4.SSS4.Px1.p2.2.m2.2.2.2.2.2.3">𝑡</ci></apply></list><ci id="S3.SS4.SSS4.Px1.p2.2.m2.2.2.4a.cmml" xref="S3.SS4.SSS4.Px1.p2.2.m2.2.2.4"><mtext class="ltx_mathvariant_monospace" id="S3.SS4.SSS4.Px1.p2.2.m2.2.2.4.cmml" xref="S3.SS4.SSS4.Px1.p2.2.m2.2.2.4">PAD</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS4.Px1.p2.2.m2.2c">\forall t,W_{t}\leftarrow\text{{PAD}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS4.Px1.p2.2.m2.2d">∀ italic_t , italic_W start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ← PAD</annotation></semantics></math>. Then, we modify it iteratively as follows. For each word <math alttext="i" class="ltx_Math" display="inline" id="S3.SS4.SSS4.Px1.p2.3.m3.1"><semantics id="S3.SS4.SSS4.Px1.p2.3.m3.1a"><mi id="S3.SS4.SSS4.Px1.p2.3.m3.1.1" xref="S3.SS4.SSS4.Px1.p2.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS4.Px1.p2.3.m3.1b"><ci id="S3.SS4.SSS4.Px1.p2.3.m3.1.1.cmml" xref="S3.SS4.SSS4.Px1.p2.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS4.Px1.p2.3.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS4.Px1.p2.3.m3.1d">italic_i</annotation></semantics></math> and its start index <math alttext="t_{i}" class="ltx_Math" display="inline" id="S3.SS4.SSS4.Px1.p2.4.m4.1"><semantics id="S3.SS4.SSS4.Px1.p2.4.m4.1a"><msub id="S3.SS4.SSS4.Px1.p2.4.m4.1.1" xref="S3.SS4.SSS4.Px1.p2.4.m4.1.1.cmml"><mi id="S3.SS4.SSS4.Px1.p2.4.m4.1.1.2" xref="S3.SS4.SSS4.Px1.p2.4.m4.1.1.2.cmml">t</mi><mi id="S3.SS4.SSS4.Px1.p2.4.m4.1.1.3" xref="S3.SS4.SSS4.Px1.p2.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS4.Px1.p2.4.m4.1b"><apply id="S3.SS4.SSS4.Px1.p2.4.m4.1.1.cmml" xref="S3.SS4.SSS4.Px1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS4.Px1.p2.4.m4.1.1.1.cmml" xref="S3.SS4.SSS4.Px1.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS4.SSS4.Px1.p2.4.m4.1.1.2.cmml" xref="S3.SS4.SSS4.Px1.p2.4.m4.1.1.2">𝑡</ci><ci id="S3.SS4.SSS4.Px1.p2.4.m4.1.1.3.cmml" xref="S3.SS4.SSS4.Px1.p2.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS4.Px1.p2.4.m4.1c">t_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS4.Px1.p2.4.m4.1d">italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, we update <math alttext="W" class="ltx_Math" display="inline" id="S3.SS4.SSS4.Px1.p2.5.m5.1"><semantics id="S3.SS4.SSS4.Px1.p2.5.m5.1a"><mi id="S3.SS4.SSS4.Px1.p2.5.m5.1.1" xref="S3.SS4.SSS4.Px1.p2.5.m5.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS4.Px1.p2.5.m5.1b"><ci id="S3.SS4.SSS4.Px1.p2.5.m5.1.1.cmml" xref="S3.SS4.SSS4.Px1.p2.5.m5.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS4.Px1.p2.5.m5.1c">W</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS4.Px1.p2.5.m5.1d">italic_W</annotation></semantics></math> as</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\left\{\begin{array}[]{ll}W_{t_{i}-1}&amp;\leftarrow\text{{EPAD}}\\
W_{t_{i}+j}&amp;\leftarrow w_{i,j}\qquad\forall j\leq n_{i}.\end{array}\right." class="ltx_Math" display="block" id="S3.E5.m1.3"><semantics id="S3.E5.m1.3a"><mrow id="S3.E5.m1.3.4.2" xref="S3.E5.m1.3.4.1.cmml"><mo id="S3.E5.m1.3.4.2.1" xref="S3.E5.m1.3.4.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" id="S3.E5.m1.3.3" rowspacing="0pt" xref="S3.E5.m1.3.3.cmml"><mtr id="S3.E5.m1.3.3a" xref="S3.E5.m1.3.3.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E5.m1.3.3b" xref="S3.E5.m1.3.3.cmml"><msub id="S3.E5.m1.3.3.4.1.1" xref="S3.E5.m1.3.3.4.1.1.cmml"><mi id="S3.E5.m1.3.3.4.1.1.2" xref="S3.E5.m1.3.3.4.1.1.2.cmml">W</mi><mrow id="S3.E5.m1.3.3.4.1.1.3" xref="S3.E5.m1.3.3.4.1.1.3.cmml"><msub id="S3.E5.m1.3.3.4.1.1.3.2" xref="S3.E5.m1.3.3.4.1.1.3.2.cmml"><mi id="S3.E5.m1.3.3.4.1.1.3.2.2" xref="S3.E5.m1.3.3.4.1.1.3.2.2.cmml">t</mi><mi id="S3.E5.m1.3.3.4.1.1.3.2.3" xref="S3.E5.m1.3.3.4.1.1.3.2.3.cmml">i</mi></msub><mo id="S3.E5.m1.3.3.4.1.1.3.1" xref="S3.E5.m1.3.3.4.1.1.3.1.cmml">−</mo><mn id="S3.E5.m1.3.3.4.1.1.3.3" xref="S3.E5.m1.3.3.4.1.1.3.3.cmml">1</mn></mrow></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E5.m1.3.3c" xref="S3.E5.m1.3.3.cmml"><mrow id="S3.E5.m1.3.3.4.2.1" xref="S3.E5.m1.3.3.4.2.1.cmml"><mi id="S3.E5.m1.3.3.4.2.1.2" xref="S3.E5.m1.3.3.4.2.1.2.cmml"></mi><mo id="S3.E5.m1.3.3.4.2.1.1" stretchy="false" xref="S3.E5.m1.3.3.4.2.1.1.cmml">←</mo><mtext class="ltx_mathvariant_monospace" id="S3.E5.m1.3.3.4.2.1.3" xref="S3.E5.m1.3.3.4.2.1.3a.cmml">EPAD</mtext></mrow></mtd></mtr><mtr id="S3.E5.m1.3.3d" xref="S3.E5.m1.3.3.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E5.m1.3.3e" xref="S3.E5.m1.3.3.cmml"><msub id="S3.E5.m1.3.3.3.4.1" xref="S3.E5.m1.3.3.3.4.1.cmml"><mi id="S3.E5.m1.3.3.3.4.1.2" xref="S3.E5.m1.3.3.3.4.1.2.cmml">W</mi><mrow id="S3.E5.m1.3.3.3.4.1.3" xref="S3.E5.m1.3.3.3.4.1.3.cmml"><msub id="S3.E5.m1.3.3.3.4.1.3.2" xref="S3.E5.m1.3.3.3.4.1.3.2.cmml"><mi id="S3.E5.m1.3.3.3.4.1.3.2.2" xref="S3.E5.m1.3.3.3.4.1.3.2.2.cmml">t</mi><mi id="S3.E5.m1.3.3.3.4.1.3.2.3" xref="S3.E5.m1.3.3.3.4.1.3.2.3.cmml">i</mi></msub><mo id="S3.E5.m1.3.3.3.4.1.3.1" xref="S3.E5.m1.3.3.3.4.1.3.1.cmml">+</mo><mi id="S3.E5.m1.3.3.3.4.1.3.3" xref="S3.E5.m1.3.3.3.4.1.3.3.cmml">j</mi></mrow></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E5.m1.3.3f" xref="S3.E5.m1.3.3.cmml"><mrow id="S3.E5.m1.3.3.3.3.3.3" xref="S3.E5.m1.3.3.cmml"><mrow id="S3.E5.m1.3.3.3.3.3.3.1.2" xref="S3.E5.m1.3.3.3.3.3.3.1.3.cmml"><mrow id="S3.E5.m1.3.3.3.3.3.3.1.1.1" xref="S3.E5.m1.3.3.3.3.3.3.1.1.1.cmml"><mi id="S3.E5.m1.3.3.3.3.3.3.1.1.1.2" xref="S3.E5.m1.3.3.3.3.3.3.1.1.1.2.cmml"></mi><mo id="S3.E5.m1.3.3.3.3.3.3.1.1.1.1" stretchy="false" xref="S3.E5.m1.3.3.3.3.3.3.1.1.1.1.cmml">←</mo><msub id="S3.E5.m1.3.3.3.3.3.3.1.1.1.3" xref="S3.E5.m1.3.3.3.3.3.3.1.1.1.3.cmml"><mi id="S3.E5.m1.3.3.3.3.3.3.1.1.1.3.2" xref="S3.E5.m1.3.3.3.3.3.3.1.1.1.3.2.cmml">w</mi><mrow id="S3.E5.m1.2.2.2.2.2.2.2.4" xref="S3.E5.m1.2.2.2.2.2.2.2.3.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.1.cmml">i</mi><mo id="S3.E5.m1.2.2.2.2.2.2.2.4.1" xref="S3.E5.m1.2.2.2.2.2.2.2.3.cmml">,</mo><mi id="S3.E5.m1.2.2.2.2.2.2.2.2" xref="S3.E5.m1.2.2.2.2.2.2.2.2.cmml">j</mi></mrow></msub></mrow><mspace id="S3.E5.m1.3.3.3.3.3.3.1.2.3" width="2.167em" xref="S3.E5.m1.3.3.3.3.3.3.1.3a.cmml"></mspace><mrow id="S3.E5.m1.3.3.3.3.3.3.1.2.2" xref="S3.E5.m1.3.3.3.3.3.3.1.2.2.cmml"><mrow id="S3.E5.m1.3.3.3.3.3.3.1.2.2.2" xref="S3.E5.m1.3.3.3.3.3.3.1.2.2.2.cmml"><mo id="S3.E5.m1.3.3.3.3.3.3.1.2.2.2.1" rspace="0.167em" xref="S3.E5.m1.3.3.3.3.3.3.1.2.2.2.1.cmml">∀</mo><mi id="S3.E5.m1.3.3.3.3.3.3.1.2.2.2.2" xref="S3.E5.m1.3.3.3.3.3.3.1.2.2.2.2.cmml">j</mi></mrow><mo id="S3.E5.m1.3.3.3.3.3.3.1.2.2.1" xref="S3.E5.m1.3.3.3.3.3.3.1.2.2.1.cmml">≤</mo><msub id="S3.E5.m1.3.3.3.3.3.3.1.2.2.3" xref="S3.E5.m1.3.3.3.3.3.3.1.2.2.3.cmml"><mi id="S3.E5.m1.3.3.3.3.3.3.1.2.2.3.2" xref="S3.E5.m1.3.3.3.3.3.3.1.2.2.3.2.cmml">n</mi><mi id="S3.E5.m1.3.3.3.3.3.3.1.2.2.3.3" xref="S3.E5.m1.3.3.3.3.3.3.1.2.2.3.3.cmml">i</mi></msub></mrow></mrow><mo id="S3.E5.m1.3.3.3.3.3.3.2" lspace="0em" xref="S3.E5.m1.3.3.cmml">.</mo></mrow></mtd></mtr></mtable><mi id="S3.E5.m1.3.4.2.2" xref="S3.E5.m1.3.4.1.1.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.3b"><apply id="S3.E5.m1.3.4.1.cmml" xref="S3.E5.m1.3.4.2"><csymbol cd="latexml" id="S3.E5.m1.3.4.1.1.cmml" xref="S3.E5.m1.3.4.2.1">cases</csymbol><matrix id="S3.E5.m1.3.3.cmml" xref="S3.E5.m1.3.3"><matrixrow id="S3.E5.m1.3.3a.cmml" xref="S3.E5.m1.3.3"><apply id="S3.E5.m1.3.3.4.1.1.cmml" xref="S3.E5.m1.3.3.4.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.4.1.1.1.cmml" xref="S3.E5.m1.3.3.4.1.1">subscript</csymbol><ci id="S3.E5.m1.3.3.4.1.1.2.cmml" xref="S3.E5.m1.3.3.4.1.1.2">𝑊</ci><apply id="S3.E5.m1.3.3.4.1.1.3.cmml" xref="S3.E5.m1.3.3.4.1.1.3"><minus id="S3.E5.m1.3.3.4.1.1.3.1.cmml" xref="S3.E5.m1.3.3.4.1.1.3.1"></minus><apply id="S3.E5.m1.3.3.4.1.1.3.2.cmml" xref="S3.E5.m1.3.3.4.1.1.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.4.1.1.3.2.1.cmml" xref="S3.E5.m1.3.3.4.1.1.3.2">subscript</csymbol><ci id="S3.E5.m1.3.3.4.1.1.3.2.2.cmml" xref="S3.E5.m1.3.3.4.1.1.3.2.2">𝑡</ci><ci id="S3.E5.m1.3.3.4.1.1.3.2.3.cmml" xref="S3.E5.m1.3.3.4.1.1.3.2.3">𝑖</ci></apply><cn id="S3.E5.m1.3.3.4.1.1.3.3.cmml" type="integer" xref="S3.E5.m1.3.3.4.1.1.3.3">1</cn></apply></apply><apply id="S3.E5.m1.3.3.4.2.1.cmml" xref="S3.E5.m1.3.3.4.2.1"><ci id="S3.E5.m1.3.3.4.2.1.1.cmml" xref="S3.E5.m1.3.3.4.2.1.1">←</ci><csymbol cd="latexml" id="S3.E5.m1.3.3.4.2.1.2.cmml" xref="S3.E5.m1.3.3.4.2.1.2">absent</csymbol><ci id="S3.E5.m1.3.3.4.2.1.3a.cmml" xref="S3.E5.m1.3.3.4.2.1.3"><mtext class="ltx_mathvariant_monospace" id="S3.E5.m1.3.3.4.2.1.3.cmml" xref="S3.E5.m1.3.3.4.2.1.3">EPAD</mtext></ci></apply></matrixrow><matrixrow id="S3.E5.m1.3.3b.cmml" xref="S3.E5.m1.3.3"><apply id="S3.E5.m1.3.3.3.4.1.cmml" xref="S3.E5.m1.3.3.3.4.1"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.3.4.1.1.cmml" xref="S3.E5.m1.3.3.3.4.1">subscript</csymbol><ci id="S3.E5.m1.3.3.3.4.1.2.cmml" xref="S3.E5.m1.3.3.3.4.1.2">𝑊</ci><apply id="S3.E5.m1.3.3.3.4.1.3.cmml" xref="S3.E5.m1.3.3.3.4.1.3"><plus id="S3.E5.m1.3.3.3.4.1.3.1.cmml" xref="S3.E5.m1.3.3.3.4.1.3.1"></plus><apply id="S3.E5.m1.3.3.3.4.1.3.2.cmml" xref="S3.E5.m1.3.3.3.4.1.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.3.4.1.3.2.1.cmml" xref="S3.E5.m1.3.3.3.4.1.3.2">subscript</csymbol><ci id="S3.E5.m1.3.3.3.4.1.3.2.2.cmml" xref="S3.E5.m1.3.3.3.4.1.3.2.2">𝑡</ci><ci id="S3.E5.m1.3.3.3.4.1.3.2.3.cmml" xref="S3.E5.m1.3.3.3.4.1.3.2.3">𝑖</ci></apply><ci id="S3.E5.m1.3.3.3.4.1.3.3.cmml" xref="S3.E5.m1.3.3.3.4.1.3.3">𝑗</ci></apply></apply><apply id="S3.E5.m1.3.3.3.3.3.3.1.3.cmml" xref="S3.E5.m1.3.3.3.3.3.3.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.3.3.3.3.1.3a.cmml" xref="S3.E5.m1.3.3.3.3.3.3.1.2.3">formulae-sequence</csymbol><apply id="S3.E5.m1.3.3.3.3.3.3.1.1.1.cmml" xref="S3.E5.m1.3.3.3.3.3.3.1.1.1"><ci id="S3.E5.m1.3.3.3.3.3.3.1.1.1.1.cmml" xref="S3.E5.m1.3.3.3.3.3.3.1.1.1.1">←</ci><csymbol cd="latexml" id="S3.E5.m1.3.3.3.3.3.3.1.1.1.2.cmml" xref="S3.E5.m1.3.3.3.3.3.3.1.1.1.2">absent</csymbol><apply id="S3.E5.m1.3.3.3.3.3.3.1.1.1.3.cmml" xref="S3.E5.m1.3.3.3.3.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.3.3.3.3.1.1.1.3.1.cmml" xref="S3.E5.m1.3.3.3.3.3.3.1.1.1.3">subscript</csymbol><ci id="S3.E5.m1.3.3.3.3.3.3.1.1.1.3.2.cmml" xref="S3.E5.m1.3.3.3.3.3.3.1.1.1.3.2">𝑤</ci><list id="S3.E5.m1.2.2.2.2.2.2.2.3.cmml" xref="S3.E5.m1.2.2.2.2.2.2.2.4"><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1">𝑖</ci><ci id="S3.E5.m1.2.2.2.2.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2.2.2.2.2">𝑗</ci></list></apply></apply><apply id="S3.E5.m1.3.3.3.3.3.3.1.2.2.cmml" xref="S3.E5.m1.3.3.3.3.3.3.1.2.2"><leq id="S3.E5.m1.3.3.3.3.3.3.1.2.2.1.cmml" xref="S3.E5.m1.3.3.3.3.3.3.1.2.2.1"></leq><apply id="S3.E5.m1.3.3.3.3.3.3.1.2.2.2.cmml" xref="S3.E5.m1.3.3.3.3.3.3.1.2.2.2"><csymbol cd="latexml" id="S3.E5.m1.3.3.3.3.3.3.1.2.2.2.1.cmml" xref="S3.E5.m1.3.3.3.3.3.3.1.2.2.2.1">for-all</csymbol><ci id="S3.E5.m1.3.3.3.3.3.3.1.2.2.2.2.cmml" xref="S3.E5.m1.3.3.3.3.3.3.1.2.2.2.2">𝑗</ci></apply><apply id="S3.E5.m1.3.3.3.3.3.3.1.2.2.3.cmml" xref="S3.E5.m1.3.3.3.3.3.3.1.2.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.3.3.3.3.1.2.2.3.1.cmml" xref="S3.E5.m1.3.3.3.3.3.3.1.2.2.3">subscript</csymbol><ci id="S3.E5.m1.3.3.3.3.3.3.1.2.2.3.2.cmml" xref="S3.E5.m1.3.3.3.3.3.3.1.2.2.3.2">𝑛</ci><ci id="S3.E5.m1.3.3.3.3.3.3.1.2.2.3.3.cmml" xref="S3.E5.m1.3.3.3.3.3.3.1.2.2.3.3">𝑖</ci></apply></apply></apply></matrixrow></matrix></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.3c">\left\{\begin{array}[]{ll}W_{t_{i}-1}&amp;\leftarrow\text{{EPAD}}\\
W_{t_{i}+j}&amp;\leftarrow w_{i,j}\qquad\forall j\leq n_{i}.\end{array}\right.</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.3d">{ start_ARRAY start_ROW start_CELL italic_W start_POSTSUBSCRIPT italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT - 1 end_POSTSUBSCRIPT end_CELL start_CELL ← EPAD end_CELL end_ROW start_ROW start_CELL italic_W start_POSTSUBSCRIPT italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT + italic_j end_POSTSUBSCRIPT end_CELL start_CELL ← italic_w start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT ∀ italic_j ≤ italic_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT . end_CELL end_ROW end_ARRAY</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.SSS4.Px1.p2.7">Note that if <math alttext="t_{i}=1" class="ltx_Math" display="inline" id="S3.SS4.SSS4.Px1.p2.6.m1.1"><semantics id="S3.SS4.SSS4.Px1.p2.6.m1.1a"><mrow id="S3.SS4.SSS4.Px1.p2.6.m1.1.1" xref="S3.SS4.SSS4.Px1.p2.6.m1.1.1.cmml"><msub id="S3.SS4.SSS4.Px1.p2.6.m1.1.1.2" xref="S3.SS4.SSS4.Px1.p2.6.m1.1.1.2.cmml"><mi id="S3.SS4.SSS4.Px1.p2.6.m1.1.1.2.2" xref="S3.SS4.SSS4.Px1.p2.6.m1.1.1.2.2.cmml">t</mi><mi id="S3.SS4.SSS4.Px1.p2.6.m1.1.1.2.3" xref="S3.SS4.SSS4.Px1.p2.6.m1.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS4.SSS4.Px1.p2.6.m1.1.1.1" xref="S3.SS4.SSS4.Px1.p2.6.m1.1.1.1.cmml">=</mo><mn id="S3.SS4.SSS4.Px1.p2.6.m1.1.1.3" xref="S3.SS4.SSS4.Px1.p2.6.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS4.Px1.p2.6.m1.1b"><apply id="S3.SS4.SSS4.Px1.p2.6.m1.1.1.cmml" xref="S3.SS4.SSS4.Px1.p2.6.m1.1.1"><eq id="S3.SS4.SSS4.Px1.p2.6.m1.1.1.1.cmml" xref="S3.SS4.SSS4.Px1.p2.6.m1.1.1.1"></eq><apply id="S3.SS4.SSS4.Px1.p2.6.m1.1.1.2.cmml" xref="S3.SS4.SSS4.Px1.p2.6.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.SSS4.Px1.p2.6.m1.1.1.2.1.cmml" xref="S3.SS4.SSS4.Px1.p2.6.m1.1.1.2">subscript</csymbol><ci id="S3.SS4.SSS4.Px1.p2.6.m1.1.1.2.2.cmml" xref="S3.SS4.SSS4.Px1.p2.6.m1.1.1.2.2">𝑡</ci><ci id="S3.SS4.SSS4.Px1.p2.6.m1.1.1.2.3.cmml" xref="S3.SS4.SSS4.Px1.p2.6.m1.1.1.2.3">𝑖</ci></apply><cn id="S3.SS4.SSS4.Px1.p2.6.m1.1.1.3.cmml" type="integer" xref="S3.SS4.SSS4.Px1.p2.6.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS4.Px1.p2.6.m1.1c">t_{i}=1</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS4.Px1.p2.6.m1.1d">italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 1</annotation></semantics></math>, we instead insert <span class="ltx_text ltx_font_typewriter" id="S3.SS4.SSS4.Px1.p2.7.1">EPAD</span> at index 1, and shift the text tokens. We do not insert an <span class="ltx_text ltx_font_typewriter" id="S3.SS4.SSS4.Px1.p2.7.2">EPAD</span> token if it would overwrite a text token from a previous word. As text tokens are more compact than the corresponding audio tokens, there is
usually no overlap between words in <math alttext="W_{t}" class="ltx_Math" display="inline" id="S3.SS4.SSS4.Px1.p2.7.m2.1"><semantics id="S3.SS4.SSS4.Px1.p2.7.m2.1a"><msub id="S3.SS4.SSS4.Px1.p2.7.m2.1.1" xref="S3.SS4.SSS4.Px1.p2.7.m2.1.1.cmml"><mi id="S3.SS4.SSS4.Px1.p2.7.m2.1.1.2" xref="S3.SS4.SSS4.Px1.p2.7.m2.1.1.2.cmml">W</mi><mi id="S3.SS4.SSS4.Px1.p2.7.m2.1.1.3" xref="S3.SS4.SSS4.Px1.p2.7.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS4.Px1.p2.7.m2.1b"><apply id="S3.SS4.SSS4.Px1.p2.7.m2.1.1.cmml" xref="S3.SS4.SSS4.Px1.p2.7.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS4.Px1.p2.7.m2.1.1.1.cmml" xref="S3.SS4.SSS4.Px1.p2.7.m2.1.1">subscript</csymbol><ci id="S3.SS4.SSS4.Px1.p2.7.m2.1.1.2.cmml" xref="S3.SS4.SSS4.Px1.p2.7.m2.1.1.2">𝑊</ci><ci id="S3.SS4.SSS4.Px1.p2.7.m2.1.1.3.cmml" xref="S3.SS4.SSS4.Px1.p2.7.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS4.Px1.p2.7.m2.1c">W_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS4.Px1.p2.7.m2.1d">italic_W start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. In English conversational speech, we observe that padding tokens represent about 65% of the tokens.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS4.SSS4.Px2">
<h5 class="ltx_title ltx_title_paragraph">Deriving streaming ASR and TTS.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.SS4.SSS4.Px2.p1">
<p class="ltx_p" id="S3.SS4.SSS4.Px2.p1.2">One can further introduce some delay between the text sequence <math alttext="(W_{t})" class="ltx_Math" display="inline" id="S3.SS4.SSS4.Px2.p1.1.m1.1"><semantics id="S3.SS4.SSS4.Px2.p1.1.m1.1a"><mrow id="S3.SS4.SSS4.Px2.p1.1.m1.1.1.1" xref="S3.SS4.SSS4.Px2.p1.1.m1.1.1.1.1.cmml"><mo id="S3.SS4.SSS4.Px2.p1.1.m1.1.1.1.2" stretchy="false" xref="S3.SS4.SSS4.Px2.p1.1.m1.1.1.1.1.cmml">(</mo><msub id="S3.SS4.SSS4.Px2.p1.1.m1.1.1.1.1" xref="S3.SS4.SSS4.Px2.p1.1.m1.1.1.1.1.cmml"><mi id="S3.SS4.SSS4.Px2.p1.1.m1.1.1.1.1.2" xref="S3.SS4.SSS4.Px2.p1.1.m1.1.1.1.1.2.cmml">W</mi><mi id="S3.SS4.SSS4.Px2.p1.1.m1.1.1.1.1.3" xref="S3.SS4.SSS4.Px2.p1.1.m1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS4.SSS4.Px2.p1.1.m1.1.1.1.3" stretchy="false" xref="S3.SS4.SSS4.Px2.p1.1.m1.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS4.Px2.p1.1.m1.1b"><apply id="S3.SS4.SSS4.Px2.p1.1.m1.1.1.1.1.cmml" xref="S3.SS4.SSS4.Px2.p1.1.m1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS4.Px2.p1.1.m1.1.1.1.1.1.cmml" xref="S3.SS4.SSS4.Px2.p1.1.m1.1.1.1">subscript</csymbol><ci id="S3.SS4.SSS4.Px2.p1.1.m1.1.1.1.1.2.cmml" xref="S3.SS4.SSS4.Px2.p1.1.m1.1.1.1.1.2">𝑊</ci><ci id="S3.SS4.SSS4.Px2.p1.1.m1.1.1.1.1.3.cmml" xref="S3.SS4.SSS4.Px2.p1.1.m1.1.1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS4.Px2.p1.1.m1.1c">(W_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS4.Px2.p1.1.m1.1d">( italic_W start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>, and the audio tokens <math alttext="(A_{t,q})" class="ltx_Math" display="inline" id="S3.SS4.SSS4.Px2.p1.2.m2.3"><semantics id="S3.SS4.SSS4.Px2.p1.2.m2.3a"><mrow id="S3.SS4.SSS4.Px2.p1.2.m2.3.3.1" xref="S3.SS4.SSS4.Px2.p1.2.m2.3.3.1.1.cmml"><mo id="S3.SS4.SSS4.Px2.p1.2.m2.3.3.1.2" stretchy="false" xref="S3.SS4.SSS4.Px2.p1.2.m2.3.3.1.1.cmml">(</mo><msub id="S3.SS4.SSS4.Px2.p1.2.m2.3.3.1.1" xref="S3.SS4.SSS4.Px2.p1.2.m2.3.3.1.1.cmml"><mi id="S3.SS4.SSS4.Px2.p1.2.m2.3.3.1.1.2" xref="S3.SS4.SSS4.Px2.p1.2.m2.3.3.1.1.2.cmml">A</mi><mrow id="S3.SS4.SSS4.Px2.p1.2.m2.2.2.2.4" xref="S3.SS4.SSS4.Px2.p1.2.m2.2.2.2.3.cmml"><mi id="S3.SS4.SSS4.Px2.p1.2.m2.1.1.1.1" xref="S3.SS4.SSS4.Px2.p1.2.m2.1.1.1.1.cmml">t</mi><mo id="S3.SS4.SSS4.Px2.p1.2.m2.2.2.2.4.1" xref="S3.SS4.SSS4.Px2.p1.2.m2.2.2.2.3.cmml">,</mo><mi id="S3.SS4.SSS4.Px2.p1.2.m2.2.2.2.2" xref="S3.SS4.SSS4.Px2.p1.2.m2.2.2.2.2.cmml">q</mi></mrow></msub><mo id="S3.SS4.SSS4.Px2.p1.2.m2.3.3.1.3" stretchy="false" xref="S3.SS4.SSS4.Px2.p1.2.m2.3.3.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS4.Px2.p1.2.m2.3b"><apply id="S3.SS4.SSS4.Px2.p1.2.m2.3.3.1.1.cmml" xref="S3.SS4.SSS4.Px2.p1.2.m2.3.3.1"><csymbol cd="ambiguous" id="S3.SS4.SSS4.Px2.p1.2.m2.3.3.1.1.1.cmml" xref="S3.SS4.SSS4.Px2.p1.2.m2.3.3.1">subscript</csymbol><ci id="S3.SS4.SSS4.Px2.p1.2.m2.3.3.1.1.2.cmml" xref="S3.SS4.SSS4.Px2.p1.2.m2.3.3.1.1.2">𝐴</ci><list id="S3.SS4.SSS4.Px2.p1.2.m2.2.2.2.3.cmml" xref="S3.SS4.SSS4.Px2.p1.2.m2.2.2.2.4"><ci id="S3.SS4.SSS4.Px2.p1.2.m2.1.1.1.1.cmml" xref="S3.SS4.SSS4.Px2.p1.2.m2.1.1.1.1">𝑡</ci><ci id="S3.SS4.SSS4.Px2.p1.2.m2.2.2.2.2.cmml" xref="S3.SS4.SSS4.Px2.p1.2.m2.2.2.2.2">𝑞</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS4.Px2.p1.2.m2.3c">(A_{t,q})</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS4.Px2.p1.2.m2.3d">( italic_A start_POSTSUBSCRIPT italic_t , italic_q end_POSTSUBSCRIPT )</annotation></semantics></math>. This controls in which modality the language model will take the decision about the content of the generated audio. By setting the audio ahead of the text,
the content of the text will be dictated by what audio has been sampled in the previous steps. In particular, by sampling only the text tokens, while using the ground truth audio tokens and discarding the prediction of the model for them, one obtain a streaming Automatic Speech Recognition model, which also provides precise word level alignment. On the other hand, by changing the text delay so that the text is ahead of the audio tokens, the content of the audio is dictated by the text content. Once more, given a sequence of properly padded text tokens, one obtain a streaming Text-To-Speech model. We further describe in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#A3" title="Appendix C Delayed text LM as a zero-shot streaming ASR and TTS ‣ Moshi: a speech-text foundation model for real-time dialogue">Appendix&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">C</span></span></a> how one can adapt the inference of a language model with delayed text to obtain a zero-shot properly padded text tokens sequence.
Experiments in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.SS7" title="5.7 Streaming ASR and TTS ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue">Section&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.7</span></span></a> show how a single delay hyper-parameter allows for switching from an ASR to a TTS model with no changes in the loss, architecture, or training data.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS4.SSS4.Px3">
<h5 class="ltx_title ltx_title_paragraph">Joint sequence modeling for Moshi.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.SS4.SSS4.Px3.p1">
<p class="ltx_p" id="S3.SS4.SSS4.Px3.p1.1">Putting together the multi-stream and inner monologue, we have the final set <math alttext="V" class="ltx_Math" display="inline" id="S3.SS4.SSS4.Px3.p1.1.m1.1"><semantics id="S3.SS4.SSS4.Px3.p1.1.m1.1a"><mi id="S3.SS4.SSS4.Px3.p1.1.m1.1.1" xref="S3.SS4.SSS4.Px3.p1.1.m1.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS4.Px3.p1.1.m1.1b"><ci id="S3.SS4.SSS4.Px3.p1.1.m1.1.1.cmml" xref="S3.SS4.SSS4.Px3.p1.1.m1.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS4.Px3.p1.1.m1.1c">V</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS4.Px3.p1.1.m1.1d">italic_V</annotation></semantics></math> of sequences to model defined as</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\left\{\begin{array}[]{lll}V_{s,1}&amp;=W_{s}&amp;\text{aligned text tokens.}\\
V_{s,2}&amp;=A_{s,1}&amp;\text{semantic tokens of Moshi.}\\
V_{s,1+q}&amp;=A_{s-\tau,q}\quad\text{if}\quad s\geq\tau+1,1<q\leq Q&amp;\text{delayed%
 acoustic tok. of Moshi.}\\
V_{s,1+Q+1}&amp;=A^{\prime}_{s,1}&amp;\text{semantic tokens of \emph{other}.}\\
V_{s,1+Q+q}&amp;=A^{\prime}_{s-\tau,q}\quad\text{if}\quad s\geq\tau+1,1<q\leq Q&amp;%
\text{delayed acoustic tok. of \emph{other},}\\
\end{array}\right." class="ltx_Math" display="block" id="S3.E6.m1.24"><semantics id="S3.E6.m1.24a"><mrow id="S3.E6.m1.24.25.2" xref="S3.E6.m1.24.25.1.cmml"><mo id="S3.E6.m1.24.25.2.1" xref="S3.E6.m1.24.25.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" id="S3.E6.m1.24.24" rowspacing="0pt" xref="S3.E6.m1.24.24.cmml"><mtr id="S3.E6.m1.24.24a" xref="S3.E6.m1.24.24.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E6.m1.24.24b" xref="S3.E6.m1.24.24.cmml"><msub id="S3.E6.m1.2.2.2.2.2" xref="S3.E6.m1.2.2.2.2.2.cmml"><mi id="S3.E6.m1.2.2.2.2.2.4" xref="S3.E6.m1.2.2.2.2.2.4.cmml">V</mi><mrow id="S3.E6.m1.2.2.2.2.2.2.2.4" xref="S3.E6.m1.2.2.2.2.2.2.2.3.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.cmml">s</mi><mo id="S3.E6.m1.2.2.2.2.2.2.2.4.1" xref="S3.E6.m1.2.2.2.2.2.2.2.3.cmml">,</mo><mn id="S3.E6.m1.2.2.2.2.2.2.2.2" xref="S3.E6.m1.2.2.2.2.2.2.2.2.cmml">1</mn></mrow></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E6.m1.24.24c" xref="S3.E6.m1.24.24.cmml"><mrow id="S3.E6.m1.2.2.2.3.1" xref="S3.E6.m1.2.2.2.3.1.cmml"><mi id="S3.E6.m1.2.2.2.3.1.2" xref="S3.E6.m1.2.2.2.3.1.2.cmml"></mi><mo id="S3.E6.m1.2.2.2.3.1.1" xref="S3.E6.m1.2.2.2.3.1.1.cmml">=</mo><msub id="S3.E6.m1.2.2.2.3.1.3" xref="S3.E6.m1.2.2.2.3.1.3.cmml"><mi id="S3.E6.m1.2.2.2.3.1.3.2" xref="S3.E6.m1.2.2.2.3.1.3.2.cmml">W</mi><mi id="S3.E6.m1.2.2.2.3.1.3.3" xref="S3.E6.m1.2.2.2.3.1.3.3.cmml">s</mi></msub></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E6.m1.24.24d" xref="S3.E6.m1.24.24.cmml"><mtext id="S3.E6.m1.2.2.2.4.1" xref="S3.E6.m1.2.2.2.4.1a.cmml">aligned text tokens.</mtext></mtd></mtr><mtr id="S3.E6.m1.24.24e" xref="S3.E6.m1.24.24.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E6.m1.24.24f" xref="S3.E6.m1.24.24.cmml"><msub id="S3.E6.m1.4.4.4.2.2" xref="S3.E6.m1.4.4.4.2.2.cmml"><mi id="S3.E6.m1.4.4.4.2.2.4" xref="S3.E6.m1.4.4.4.2.2.4.cmml">V</mi><mrow id="S3.E6.m1.4.4.4.2.2.2.2.4" xref="S3.E6.m1.4.4.4.2.2.2.2.3.cmml"><mi id="S3.E6.m1.3.3.3.1.1.1.1.1" xref="S3.E6.m1.3.3.3.1.1.1.1.1.cmml">s</mi><mo id="S3.E6.m1.4.4.4.2.2.2.2.4.1" xref="S3.E6.m1.4.4.4.2.2.2.2.3.cmml">,</mo><mn id="S3.E6.m1.4.4.4.2.2.2.2.2" xref="S3.E6.m1.4.4.4.2.2.2.2.2.cmml">2</mn></mrow></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E6.m1.24.24g" xref="S3.E6.m1.24.24.cmml"><mrow id="S3.E6.m1.6.6.6.4.2" xref="S3.E6.m1.6.6.6.4.2.cmml"><mi id="S3.E6.m1.6.6.6.4.2.4" xref="S3.E6.m1.6.6.6.4.2.4.cmml"></mi><mo id="S3.E6.m1.6.6.6.4.2.3" xref="S3.E6.m1.6.6.6.4.2.3.cmml">=</mo><msub id="S3.E6.m1.6.6.6.4.2.5" xref="S3.E6.m1.6.6.6.4.2.5.cmml"><mi id="S3.E6.m1.6.6.6.4.2.5.2" xref="S3.E6.m1.6.6.6.4.2.5.2.cmml">A</mi><mrow id="S3.E6.m1.6.6.6.4.2.2.2.4" xref="S3.E6.m1.6.6.6.4.2.2.2.3.cmml"><mi id="S3.E6.m1.5.5.5.3.1.1.1.1" xref="S3.E6.m1.5.5.5.3.1.1.1.1.cmml">s</mi><mo id="S3.E6.m1.6.6.6.4.2.2.2.4.1" xref="S3.E6.m1.6.6.6.4.2.2.2.3.cmml">,</mo><mn id="S3.E6.m1.6.6.6.4.2.2.2.2" xref="S3.E6.m1.6.6.6.4.2.2.2.2.cmml">1</mn></mrow></msub></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E6.m1.24.24h" xref="S3.E6.m1.24.24.cmml"><mtext id="S3.E6.m1.6.6.6.5.1" xref="S3.E6.m1.6.6.6.5.1a.cmml">semantic tokens of Moshi.</mtext></mtd></mtr><mtr id="S3.E6.m1.24.24i" xref="S3.E6.m1.24.24.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E6.m1.24.24j" xref="S3.E6.m1.24.24.cmml"><msub id="S3.E6.m1.8.8.8.2.2" xref="S3.E6.m1.8.8.8.2.2.cmml"><mi id="S3.E6.m1.8.8.8.2.2.4" xref="S3.E6.m1.8.8.8.2.2.4.cmml">V</mi><mrow id="S3.E6.m1.8.8.8.2.2.2.2.2" xref="S3.E6.m1.8.8.8.2.2.2.2.3.cmml"><mi id="S3.E6.m1.7.7.7.1.1.1.1.1" xref="S3.E6.m1.7.7.7.1.1.1.1.1.cmml">s</mi><mo id="S3.E6.m1.8.8.8.2.2.2.2.2.2" xref="S3.E6.m1.8.8.8.2.2.2.2.3.cmml">,</mo><mrow id="S3.E6.m1.8.8.8.2.2.2.2.2.1" xref="S3.E6.m1.8.8.8.2.2.2.2.2.1.cmml"><mn id="S3.E6.m1.8.8.8.2.2.2.2.2.1.2" xref="S3.E6.m1.8.8.8.2.2.2.2.2.1.2.cmml">1</mn><mo id="S3.E6.m1.8.8.8.2.2.2.2.2.1.1" xref="S3.E6.m1.8.8.8.2.2.2.2.2.1.1.cmml">+</mo><mi id="S3.E6.m1.8.8.8.2.2.2.2.2.1.3" xref="S3.E6.m1.8.8.8.2.2.2.2.2.1.3.cmml">q</mi></mrow></mrow></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E6.m1.24.24k" xref="S3.E6.m1.24.24.cmml"><mrow id="S3.E6.m1.13.13.13.7.5.5" xref="S3.E6.m1.13.13.13.7.5.6.cmml"><mrow id="S3.E6.m1.12.12.12.6.4.4.1" xref="S3.E6.m1.12.12.12.6.4.4.1.cmml"><mi id="S3.E6.m1.12.12.12.6.4.4.1.3" xref="S3.E6.m1.12.12.12.6.4.4.1.3.cmml"></mi><mo id="S3.E6.m1.12.12.12.6.4.4.1.2" xref="S3.E6.m1.12.12.12.6.4.4.1.2.cmml">=</mo><mrow id="S3.E6.m1.12.12.12.6.4.4.1.1.1" xref="S3.E6.m1.12.12.12.6.4.4.1.1.2.cmml"><msub id="S3.E6.m1.12.12.12.6.4.4.1.1.1.1" xref="S3.E6.m1.12.12.12.6.4.4.1.1.1.1.cmml"><mi id="S3.E6.m1.12.12.12.6.4.4.1.1.1.1.2" xref="S3.E6.m1.12.12.12.6.4.4.1.1.1.1.2.cmml">A</mi><mrow id="S3.E6.m1.10.10.10.4.2.2.2.2" xref="S3.E6.m1.10.10.10.4.2.2.2.3.cmml"><mrow id="S3.E6.m1.10.10.10.4.2.2.2.2.1" xref="S3.E6.m1.10.10.10.4.2.2.2.2.1.cmml"><mi id="S3.E6.m1.10.10.10.4.2.2.2.2.1.2" xref="S3.E6.m1.10.10.10.4.2.2.2.2.1.2.cmml">s</mi><mo id="S3.E6.m1.10.10.10.4.2.2.2.2.1.1" xref="S3.E6.m1.10.10.10.4.2.2.2.2.1.1.cmml">−</mo><mi id="S3.E6.m1.10.10.10.4.2.2.2.2.1.3" xref="S3.E6.m1.10.10.10.4.2.2.2.2.1.3.cmml">τ</mi></mrow><mo id="S3.E6.m1.10.10.10.4.2.2.2.2.2" xref="S3.E6.m1.10.10.10.4.2.2.2.3.cmml">,</mo><mi id="S3.E6.m1.9.9.9.3.1.1.1.1" xref="S3.E6.m1.9.9.9.3.1.1.1.1.cmml">q</mi></mrow></msub><mspace id="S3.E6.m1.12.12.12.6.4.4.1.1.1.2" width="1em" xref="S3.E6.m1.12.12.12.6.4.4.1.1.2.cmml"></mspace><mtext id="S3.E6.m1.11.11.11.5.3.3" xref="S3.E6.m1.11.11.11.5.3.3a.cmml">if</mtext></mrow></mrow><mspace id="S3.E6.m1.13.13.13.7.5.5.3" width="1em" xref="S3.E6.m1.13.13.13.7.5.6a.cmml"></mspace><mrow id="S3.E6.m1.13.13.13.7.5.5.2.2" xref="S3.E6.m1.13.13.13.7.5.5.2.3.cmml"><mrow id="S3.E6.m1.13.13.13.7.5.5.2.1.1" xref="S3.E6.m1.13.13.13.7.5.5.2.1.1.cmml"><mi id="S3.E6.m1.13.13.13.7.5.5.2.1.1.2" xref="S3.E6.m1.13.13.13.7.5.5.2.1.1.2.cmml">s</mi><mo id="S3.E6.m1.13.13.13.7.5.5.2.1.1.1" xref="S3.E6.m1.13.13.13.7.5.5.2.1.1.1.cmml">≥</mo><mrow id="S3.E6.m1.13.13.13.7.5.5.2.1.1.3" xref="S3.E6.m1.13.13.13.7.5.5.2.1.1.3.cmml"><mi id="S3.E6.m1.13.13.13.7.5.5.2.1.1.3.2" xref="S3.E6.m1.13.13.13.7.5.5.2.1.1.3.2.cmml">τ</mi><mo id="S3.E6.m1.13.13.13.7.5.5.2.1.1.3.1" xref="S3.E6.m1.13.13.13.7.5.5.2.1.1.3.1.cmml">+</mo><mn id="S3.E6.m1.13.13.13.7.5.5.2.1.1.3.3" xref="S3.E6.m1.13.13.13.7.5.5.2.1.1.3.3.cmml">1</mn></mrow></mrow><mo id="S3.E6.m1.13.13.13.7.5.5.2.2.3" xref="S3.E6.m1.13.13.13.7.5.5.2.3a.cmml">,</mo><mrow id="S3.E6.m1.13.13.13.7.5.5.2.2.2" xref="S3.E6.m1.13.13.13.7.5.5.2.2.2.cmml"><mn id="S3.E6.m1.13.13.13.7.5.5.2.2.2.2" xref="S3.E6.m1.13.13.13.7.5.5.2.2.2.2.cmml">1</mn><mo id="S3.E6.m1.13.13.13.7.5.5.2.2.2.3" xref="S3.E6.m1.13.13.13.7.5.5.2.2.2.3.cmml">&lt;</mo><mi id="S3.E6.m1.13.13.13.7.5.5.2.2.2.4" xref="S3.E6.m1.13.13.13.7.5.5.2.2.2.4.cmml">q</mi><mo id="S3.E6.m1.13.13.13.7.5.5.2.2.2.5" xref="S3.E6.m1.13.13.13.7.5.5.2.2.2.5.cmml">≤</mo><mi id="S3.E6.m1.13.13.13.7.5.5.2.2.2.6" xref="S3.E6.m1.13.13.13.7.5.5.2.2.2.6.cmml">Q</mi></mrow></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E6.m1.24.24l" xref="S3.E6.m1.24.24.cmml"><mtext id="S3.E6.m1.13.13.13.8.1" xref="S3.E6.m1.13.13.13.8.1a.cmml">delayed acoustic tok. of Moshi.</mtext></mtd></mtr><mtr id="S3.E6.m1.24.24m" xref="S3.E6.m1.24.24.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E6.m1.24.24n" xref="S3.E6.m1.24.24.cmml"><msub id="S3.E6.m1.15.15.15.2.2" xref="S3.E6.m1.15.15.15.2.2.cmml"><mi id="S3.E6.m1.15.15.15.2.2.4" xref="S3.E6.m1.15.15.15.2.2.4.cmml">V</mi><mrow id="S3.E6.m1.15.15.15.2.2.2.2.2" xref="S3.E6.m1.15.15.15.2.2.2.2.3.cmml"><mi id="S3.E6.m1.14.14.14.1.1.1.1.1" xref="S3.E6.m1.14.14.14.1.1.1.1.1.cmml">s</mi><mo id="S3.E6.m1.15.15.15.2.2.2.2.2.2" xref="S3.E6.m1.15.15.15.2.2.2.2.3.cmml">,</mo><mrow id="S3.E6.m1.15.15.15.2.2.2.2.2.1" xref="S3.E6.m1.15.15.15.2.2.2.2.2.1.cmml"><mn id="S3.E6.m1.15.15.15.2.2.2.2.2.1.2" xref="S3.E6.m1.15.15.15.2.2.2.2.2.1.2.cmml">1</mn><mo id="S3.E6.m1.15.15.15.2.2.2.2.2.1.1" xref="S3.E6.m1.15.15.15.2.2.2.2.2.1.1.cmml">+</mo><mi id="S3.E6.m1.15.15.15.2.2.2.2.2.1.3" xref="S3.E6.m1.15.15.15.2.2.2.2.2.1.3.cmml">Q</mi><mo id="S3.E6.m1.15.15.15.2.2.2.2.2.1.1a" xref="S3.E6.m1.15.15.15.2.2.2.2.2.1.1.cmml">+</mo><mn id="S3.E6.m1.15.15.15.2.2.2.2.2.1.4" xref="S3.E6.m1.15.15.15.2.2.2.2.2.1.4.cmml">1</mn></mrow></mrow></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E6.m1.24.24o" xref="S3.E6.m1.24.24.cmml"><mrow id="S3.E6.m1.17.17.17.4.2" xref="S3.E6.m1.17.17.17.4.2.cmml"><mi id="S3.E6.m1.17.17.17.4.2.4" xref="S3.E6.m1.17.17.17.4.2.4.cmml"></mi><mo id="S3.E6.m1.17.17.17.4.2.3" xref="S3.E6.m1.17.17.17.4.2.3.cmml">=</mo><msubsup id="S3.E6.m1.17.17.17.4.2.5" xref="S3.E6.m1.17.17.17.4.2.5.cmml"><mi id="S3.E6.m1.17.17.17.4.2.5.2.2" xref="S3.E6.m1.17.17.17.4.2.5.2.2.cmml">A</mi><mrow id="S3.E6.m1.17.17.17.4.2.2.2.4" xref="S3.E6.m1.17.17.17.4.2.2.2.3.cmml"><mi id="S3.E6.m1.16.16.16.3.1.1.1.1" xref="S3.E6.m1.16.16.16.3.1.1.1.1.cmml">s</mi><mo id="S3.E6.m1.17.17.17.4.2.2.2.4.1" xref="S3.E6.m1.17.17.17.4.2.2.2.3.cmml">,</mo><mn id="S3.E6.m1.17.17.17.4.2.2.2.2" xref="S3.E6.m1.17.17.17.4.2.2.2.2.cmml">1</mn></mrow><mo id="S3.E6.m1.17.17.17.4.2.5.2.3" xref="S3.E6.m1.17.17.17.4.2.5.2.3.cmml">′</mo></msubsup></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E6.m1.24.24p" xref="S3.E6.m1.24.24.cmml"><mrow id="S3.E6.m1.17.17.17.5.1" xref="S3.E6.m1.17.17.17.5.1d.cmml"><mtext id="S3.E6.m1.17.17.17.5.1a" xref="S3.E6.m1.17.17.17.5.1d.cmml">semantic tokens of&nbsp;</mtext><mtext class="ltx_mathvariant_italic" id="S3.E6.m1.17.17.17.5.1b" xref="S3.E6.m1.17.17.17.5.1d.cmml">other</mtext><mtext id="S3.E6.m1.17.17.17.5.1c" xref="S3.E6.m1.17.17.17.5.1d.cmml">.</mtext></mrow></mtd></mtr><mtr id="S3.E6.m1.24.24q" xref="S3.E6.m1.24.24.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E6.m1.24.24r" xref="S3.E6.m1.24.24.cmml"><msub id="S3.E6.m1.19.19.19.2.2" xref="S3.E6.m1.19.19.19.2.2.cmml"><mi id="S3.E6.m1.19.19.19.2.2.4" xref="S3.E6.m1.19.19.19.2.2.4.cmml">V</mi><mrow id="S3.E6.m1.19.19.19.2.2.2.2.2" xref="S3.E6.m1.19.19.19.2.2.2.2.3.cmml"><mi id="S3.E6.m1.18.18.18.1.1.1.1.1" xref="S3.E6.m1.18.18.18.1.1.1.1.1.cmml">s</mi><mo id="S3.E6.m1.19.19.19.2.2.2.2.2.2" xref="S3.E6.m1.19.19.19.2.2.2.2.3.cmml">,</mo><mrow id="S3.E6.m1.19.19.19.2.2.2.2.2.1" xref="S3.E6.m1.19.19.19.2.2.2.2.2.1.cmml"><mn id="S3.E6.m1.19.19.19.2.2.2.2.2.1.2" xref="S3.E6.m1.19.19.19.2.2.2.2.2.1.2.cmml">1</mn><mo id="S3.E6.m1.19.19.19.2.2.2.2.2.1.1" xref="S3.E6.m1.19.19.19.2.2.2.2.2.1.1.cmml">+</mo><mi id="S3.E6.m1.19.19.19.2.2.2.2.2.1.3" xref="S3.E6.m1.19.19.19.2.2.2.2.2.1.3.cmml">Q</mi><mo id="S3.E6.m1.19.19.19.2.2.2.2.2.1.1a" xref="S3.E6.m1.19.19.19.2.2.2.2.2.1.1.cmml">+</mo><mi id="S3.E6.m1.19.19.19.2.2.2.2.2.1.4" xref="S3.E6.m1.19.19.19.2.2.2.2.2.1.4.cmml">q</mi></mrow></mrow></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E6.m1.24.24s" xref="S3.E6.m1.24.24.cmml"><mrow id="S3.E6.m1.24.24.24.7.5.5" xref="S3.E6.m1.24.24.24.7.5.6.cmml"><mrow id="S3.E6.m1.23.23.23.6.4.4.1" xref="S3.E6.m1.23.23.23.6.4.4.1.cmml"><mi id="S3.E6.m1.23.23.23.6.4.4.1.3" xref="S3.E6.m1.23.23.23.6.4.4.1.3.cmml"></mi><mo id="S3.E6.m1.23.23.23.6.4.4.1.2" xref="S3.E6.m1.23.23.23.6.4.4.1.2.cmml">=</mo><mrow id="S3.E6.m1.23.23.23.6.4.4.1.1.1" xref="S3.E6.m1.23.23.23.6.4.4.1.1.2.cmml"><msubsup id="S3.E6.m1.23.23.23.6.4.4.1.1.1.1" xref="S3.E6.m1.23.23.23.6.4.4.1.1.1.1.cmml"><mi id="S3.E6.m1.23.23.23.6.4.4.1.1.1.1.2.2" xref="S3.E6.m1.23.23.23.6.4.4.1.1.1.1.2.2.cmml">A</mi><mrow id="S3.E6.m1.21.21.21.4.2.2.2.2" xref="S3.E6.m1.21.21.21.4.2.2.2.3.cmml"><mrow id="S3.E6.m1.21.21.21.4.2.2.2.2.1" xref="S3.E6.m1.21.21.21.4.2.2.2.2.1.cmml"><mi id="S3.E6.m1.21.21.21.4.2.2.2.2.1.2" xref="S3.E6.m1.21.21.21.4.2.2.2.2.1.2.cmml">s</mi><mo id="S3.E6.m1.21.21.21.4.2.2.2.2.1.1" xref="S3.E6.m1.21.21.21.4.2.2.2.2.1.1.cmml">−</mo><mi id="S3.E6.m1.21.21.21.4.2.2.2.2.1.3" xref="S3.E6.m1.21.21.21.4.2.2.2.2.1.3.cmml">τ</mi></mrow><mo id="S3.E6.m1.21.21.21.4.2.2.2.2.2" xref="S3.E6.m1.21.21.21.4.2.2.2.3.cmml">,</mo><mi id="S3.E6.m1.20.20.20.3.1.1.1.1" xref="S3.E6.m1.20.20.20.3.1.1.1.1.cmml">q</mi></mrow><mo id="S3.E6.m1.23.23.23.6.4.4.1.1.1.1.2.3" xref="S3.E6.m1.23.23.23.6.4.4.1.1.1.1.2.3.cmml">′</mo></msubsup><mspace id="S3.E6.m1.23.23.23.6.4.4.1.1.1.2" width="1em" xref="S3.E6.m1.23.23.23.6.4.4.1.1.2.cmml"></mspace><mtext id="S3.E6.m1.22.22.22.5.3.3" xref="S3.E6.m1.22.22.22.5.3.3a.cmml">if</mtext></mrow></mrow><mspace id="S3.E6.m1.24.24.24.7.5.5.3" width="1em" xref="S3.E6.m1.24.24.24.7.5.6a.cmml"></mspace><mrow id="S3.E6.m1.24.24.24.7.5.5.2.2" xref="S3.E6.m1.24.24.24.7.5.5.2.3.cmml"><mrow id="S3.E6.m1.24.24.24.7.5.5.2.1.1" xref="S3.E6.m1.24.24.24.7.5.5.2.1.1.cmml"><mi id="S3.E6.m1.24.24.24.7.5.5.2.1.1.2" xref="S3.E6.m1.24.24.24.7.5.5.2.1.1.2.cmml">s</mi><mo id="S3.E6.m1.24.24.24.7.5.5.2.1.1.1" xref="S3.E6.m1.24.24.24.7.5.5.2.1.1.1.cmml">≥</mo><mrow id="S3.E6.m1.24.24.24.7.5.5.2.1.1.3" xref="S3.E6.m1.24.24.24.7.5.5.2.1.1.3.cmml"><mi id="S3.E6.m1.24.24.24.7.5.5.2.1.1.3.2" xref="S3.E6.m1.24.24.24.7.5.5.2.1.1.3.2.cmml">τ</mi><mo id="S3.E6.m1.24.24.24.7.5.5.2.1.1.3.1" xref="S3.E6.m1.24.24.24.7.5.5.2.1.1.3.1.cmml">+</mo><mn id="S3.E6.m1.24.24.24.7.5.5.2.1.1.3.3" xref="S3.E6.m1.24.24.24.7.5.5.2.1.1.3.3.cmml">1</mn></mrow></mrow><mo id="S3.E6.m1.24.24.24.7.5.5.2.2.3" xref="S3.E6.m1.24.24.24.7.5.5.2.3a.cmml">,</mo><mrow id="S3.E6.m1.24.24.24.7.5.5.2.2.2" xref="S3.E6.m1.24.24.24.7.5.5.2.2.2.cmml"><mn id="S3.E6.m1.24.24.24.7.5.5.2.2.2.2" xref="S3.E6.m1.24.24.24.7.5.5.2.2.2.2.cmml">1</mn><mo id="S3.E6.m1.24.24.24.7.5.5.2.2.2.3" xref="S3.E6.m1.24.24.24.7.5.5.2.2.2.3.cmml">&lt;</mo><mi id="S3.E6.m1.24.24.24.7.5.5.2.2.2.4" xref="S3.E6.m1.24.24.24.7.5.5.2.2.2.4.cmml">q</mi><mo id="S3.E6.m1.24.24.24.7.5.5.2.2.2.5" xref="S3.E6.m1.24.24.24.7.5.5.2.2.2.5.cmml">≤</mo><mi id="S3.E6.m1.24.24.24.7.5.5.2.2.2.6" xref="S3.E6.m1.24.24.24.7.5.5.2.2.2.6.cmml">Q</mi></mrow></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E6.m1.24.24t" xref="S3.E6.m1.24.24.cmml"><mrow id="S3.E6.m1.24.24.24.8.1" xref="S3.E6.m1.24.24.24.8.1d.cmml"><mtext id="S3.E6.m1.24.24.24.8.1a" xref="S3.E6.m1.24.24.24.8.1d.cmml">delayed acoustic tok. of&nbsp;</mtext><mtext class="ltx_mathvariant_italic" id="S3.E6.m1.24.24.24.8.1b" xref="S3.E6.m1.24.24.24.8.1d.cmml">other</mtext><mtext id="S3.E6.m1.24.24.24.8.1c" xref="S3.E6.m1.24.24.24.8.1d.cmml">,</mtext></mrow></mtd></mtr></mtable><mi id="S3.E6.m1.24.25.2.2" xref="S3.E6.m1.24.25.1.1.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.24b"><apply id="S3.E6.m1.24.25.1.cmml" xref="S3.E6.m1.24.25.2"><csymbol cd="latexml" id="S3.E6.m1.24.25.1.1.cmml" xref="S3.E6.m1.24.25.2.1">cases</csymbol><matrix id="S3.E6.m1.24.24.cmml" xref="S3.E6.m1.24.24"><matrixrow id="S3.E6.m1.24.24a.cmml" xref="S3.E6.m1.24.24"><apply id="S3.E6.m1.2.2.2.2.2.cmml" xref="S3.E6.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.2.2.2.3.cmml" xref="S3.E6.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.E6.m1.2.2.2.2.2.4.cmml" xref="S3.E6.m1.2.2.2.2.2.4">𝑉</ci><list id="S3.E6.m1.2.2.2.2.2.2.2.3.cmml" xref="S3.E6.m1.2.2.2.2.2.2.2.4"><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1">𝑠</ci><cn id="S3.E6.m1.2.2.2.2.2.2.2.2.cmml" type="integer" xref="S3.E6.m1.2.2.2.2.2.2.2.2">1</cn></list></apply><apply id="S3.E6.m1.2.2.2.3.1.cmml" xref="S3.E6.m1.2.2.2.3.1"><eq id="S3.E6.m1.2.2.2.3.1.1.cmml" xref="S3.E6.m1.2.2.2.3.1.1"></eq><csymbol cd="latexml" id="S3.E6.m1.2.2.2.3.1.2.cmml" xref="S3.E6.m1.2.2.2.3.1.2">absent</csymbol><apply id="S3.E6.m1.2.2.2.3.1.3.cmml" xref="S3.E6.m1.2.2.2.3.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.2.3.1.3.1.cmml" xref="S3.E6.m1.2.2.2.3.1.3">subscript</csymbol><ci id="S3.E6.m1.2.2.2.3.1.3.2.cmml" xref="S3.E6.m1.2.2.2.3.1.3.2">𝑊</ci><ci id="S3.E6.m1.2.2.2.3.1.3.3.cmml" xref="S3.E6.m1.2.2.2.3.1.3.3">𝑠</ci></apply></apply><ci id="S3.E6.m1.2.2.2.4.1a.cmml" xref="S3.E6.m1.2.2.2.4.1"><mtext id="S3.E6.m1.2.2.2.4.1.cmml" xref="S3.E6.m1.2.2.2.4.1">aligned text tokens.</mtext></ci></matrixrow><matrixrow id="S3.E6.m1.24.24b.cmml" xref="S3.E6.m1.24.24"><apply id="S3.E6.m1.4.4.4.2.2.cmml" xref="S3.E6.m1.4.4.4.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.4.4.4.2.2.3.cmml" xref="S3.E6.m1.4.4.4.2.2">subscript</csymbol><ci id="S3.E6.m1.4.4.4.2.2.4.cmml" xref="S3.E6.m1.4.4.4.2.2.4">𝑉</ci><list id="S3.E6.m1.4.4.4.2.2.2.2.3.cmml" xref="S3.E6.m1.4.4.4.2.2.2.2.4"><ci id="S3.E6.m1.3.3.3.1.1.1.1.1.cmml" xref="S3.E6.m1.3.3.3.1.1.1.1.1">𝑠</ci><cn id="S3.E6.m1.4.4.4.2.2.2.2.2.cmml" type="integer" xref="S3.E6.m1.4.4.4.2.2.2.2.2">2</cn></list></apply><apply id="S3.E6.m1.6.6.6.4.2.cmml" xref="S3.E6.m1.6.6.6.4.2"><eq id="S3.E6.m1.6.6.6.4.2.3.cmml" xref="S3.E6.m1.6.6.6.4.2.3"></eq><csymbol cd="latexml" id="S3.E6.m1.6.6.6.4.2.4.cmml" xref="S3.E6.m1.6.6.6.4.2.4">absent</csymbol><apply id="S3.E6.m1.6.6.6.4.2.5.cmml" xref="S3.E6.m1.6.6.6.4.2.5"><csymbol cd="ambiguous" id="S3.E6.m1.6.6.6.4.2.5.1.cmml" xref="S3.E6.m1.6.6.6.4.2.5">subscript</csymbol><ci id="S3.E6.m1.6.6.6.4.2.5.2.cmml" xref="S3.E6.m1.6.6.6.4.2.5.2">𝐴</ci><list id="S3.E6.m1.6.6.6.4.2.2.2.3.cmml" xref="S3.E6.m1.6.6.6.4.2.2.2.4"><ci id="S3.E6.m1.5.5.5.3.1.1.1.1.cmml" xref="S3.E6.m1.5.5.5.3.1.1.1.1">𝑠</ci><cn id="S3.E6.m1.6.6.6.4.2.2.2.2.cmml" type="integer" xref="S3.E6.m1.6.6.6.4.2.2.2.2">1</cn></list></apply></apply><ci id="S3.E6.m1.6.6.6.5.1a.cmml" xref="S3.E6.m1.6.6.6.5.1"><mtext id="S3.E6.m1.6.6.6.5.1.cmml" xref="S3.E6.m1.6.6.6.5.1">semantic tokens of Moshi.</mtext></ci></matrixrow><matrixrow id="S3.E6.m1.24.24c.cmml" xref="S3.E6.m1.24.24"><apply id="S3.E6.m1.8.8.8.2.2.cmml" xref="S3.E6.m1.8.8.8.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.8.8.8.2.2.3.cmml" xref="S3.E6.m1.8.8.8.2.2">subscript</csymbol><ci id="S3.E6.m1.8.8.8.2.2.4.cmml" xref="S3.E6.m1.8.8.8.2.2.4">𝑉</ci><list id="S3.E6.m1.8.8.8.2.2.2.2.3.cmml" xref="S3.E6.m1.8.8.8.2.2.2.2.2"><ci id="S3.E6.m1.7.7.7.1.1.1.1.1.cmml" xref="S3.E6.m1.7.7.7.1.1.1.1.1">𝑠</ci><apply id="S3.E6.m1.8.8.8.2.2.2.2.2.1.cmml" xref="S3.E6.m1.8.8.8.2.2.2.2.2.1"><plus id="S3.E6.m1.8.8.8.2.2.2.2.2.1.1.cmml" xref="S3.E6.m1.8.8.8.2.2.2.2.2.1.1"></plus><cn id="S3.E6.m1.8.8.8.2.2.2.2.2.1.2.cmml" type="integer" xref="S3.E6.m1.8.8.8.2.2.2.2.2.1.2">1</cn><ci id="S3.E6.m1.8.8.8.2.2.2.2.2.1.3.cmml" xref="S3.E6.m1.8.8.8.2.2.2.2.2.1.3">𝑞</ci></apply></list></apply><apply id="S3.E6.m1.13.13.13.7.5.6.cmml" xref="S3.E6.m1.13.13.13.7.5.5"><csymbol cd="ambiguous" id="S3.E6.m1.13.13.13.7.5.6a.cmml" xref="S3.E6.m1.13.13.13.7.5.5.3">formulae-sequence</csymbol><apply id="S3.E6.m1.12.12.12.6.4.4.1.cmml" xref="S3.E6.m1.12.12.12.6.4.4.1"><eq id="S3.E6.m1.12.12.12.6.4.4.1.2.cmml" xref="S3.E6.m1.12.12.12.6.4.4.1.2"></eq><csymbol cd="latexml" id="S3.E6.m1.12.12.12.6.4.4.1.3.cmml" xref="S3.E6.m1.12.12.12.6.4.4.1.3">absent</csymbol><list id="S3.E6.m1.12.12.12.6.4.4.1.1.2.cmml" xref="S3.E6.m1.12.12.12.6.4.4.1.1.1"><apply id="S3.E6.m1.12.12.12.6.4.4.1.1.1.1.cmml" xref="S3.E6.m1.12.12.12.6.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.12.12.12.6.4.4.1.1.1.1.1.cmml" xref="S3.E6.m1.12.12.12.6.4.4.1.1.1.1">subscript</csymbol><ci id="S3.E6.m1.12.12.12.6.4.4.1.1.1.1.2.cmml" xref="S3.E6.m1.12.12.12.6.4.4.1.1.1.1.2">𝐴</ci><list id="S3.E6.m1.10.10.10.4.2.2.2.3.cmml" xref="S3.E6.m1.10.10.10.4.2.2.2.2"><apply id="S3.E6.m1.10.10.10.4.2.2.2.2.1.cmml" xref="S3.E6.m1.10.10.10.4.2.2.2.2.1"><minus id="S3.E6.m1.10.10.10.4.2.2.2.2.1.1.cmml" xref="S3.E6.m1.10.10.10.4.2.2.2.2.1.1"></minus><ci id="S3.E6.m1.10.10.10.4.2.2.2.2.1.2.cmml" xref="S3.E6.m1.10.10.10.4.2.2.2.2.1.2">𝑠</ci><ci id="S3.E6.m1.10.10.10.4.2.2.2.2.1.3.cmml" xref="S3.E6.m1.10.10.10.4.2.2.2.2.1.3">𝜏</ci></apply><ci id="S3.E6.m1.9.9.9.3.1.1.1.1.cmml" xref="S3.E6.m1.9.9.9.3.1.1.1.1">𝑞</ci></list></apply><ci id="S3.E6.m1.11.11.11.5.3.3a.cmml" xref="S3.E6.m1.11.11.11.5.3.3"><mtext id="S3.E6.m1.11.11.11.5.3.3.cmml" xref="S3.E6.m1.11.11.11.5.3.3">if</mtext></ci></list></apply><apply id="S3.E6.m1.13.13.13.7.5.5.2.3.cmml" xref="S3.E6.m1.13.13.13.7.5.5.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.13.13.13.7.5.5.2.3a.cmml" xref="S3.E6.m1.13.13.13.7.5.5.2.2.3">formulae-sequence</csymbol><apply id="S3.E6.m1.13.13.13.7.5.5.2.1.1.cmml" xref="S3.E6.m1.13.13.13.7.5.5.2.1.1"><geq id="S3.E6.m1.13.13.13.7.5.5.2.1.1.1.cmml" xref="S3.E6.m1.13.13.13.7.5.5.2.1.1.1"></geq><ci id="S3.E6.m1.13.13.13.7.5.5.2.1.1.2.cmml" xref="S3.E6.m1.13.13.13.7.5.5.2.1.1.2">𝑠</ci><apply id="S3.E6.m1.13.13.13.7.5.5.2.1.1.3.cmml" xref="S3.E6.m1.13.13.13.7.5.5.2.1.1.3"><plus id="S3.E6.m1.13.13.13.7.5.5.2.1.1.3.1.cmml" xref="S3.E6.m1.13.13.13.7.5.5.2.1.1.3.1"></plus><ci id="S3.E6.m1.13.13.13.7.5.5.2.1.1.3.2.cmml" xref="S3.E6.m1.13.13.13.7.5.5.2.1.1.3.2">𝜏</ci><cn id="S3.E6.m1.13.13.13.7.5.5.2.1.1.3.3.cmml" type="integer" xref="S3.E6.m1.13.13.13.7.5.5.2.1.1.3.3">1</cn></apply></apply><apply id="S3.E6.m1.13.13.13.7.5.5.2.2.2.cmml" xref="S3.E6.m1.13.13.13.7.5.5.2.2.2"><and id="S3.E6.m1.13.13.13.7.5.5.2.2.2a.cmml" xref="S3.E6.m1.13.13.13.7.5.5.2.2.2"></and><apply id="S3.E6.m1.13.13.13.7.5.5.2.2.2b.cmml" xref="S3.E6.m1.13.13.13.7.5.5.2.2.2"><lt id="S3.E6.m1.13.13.13.7.5.5.2.2.2.3.cmml" xref="S3.E6.m1.13.13.13.7.5.5.2.2.2.3"></lt><cn id="S3.E6.m1.13.13.13.7.5.5.2.2.2.2.cmml" type="integer" xref="S3.E6.m1.13.13.13.7.5.5.2.2.2.2">1</cn><ci id="S3.E6.m1.13.13.13.7.5.5.2.2.2.4.cmml" xref="S3.E6.m1.13.13.13.7.5.5.2.2.2.4">𝑞</ci></apply><apply id="S3.E6.m1.13.13.13.7.5.5.2.2.2c.cmml" xref="S3.E6.m1.13.13.13.7.5.5.2.2.2"><leq id="S3.E6.m1.13.13.13.7.5.5.2.2.2.5.cmml" xref="S3.E6.m1.13.13.13.7.5.5.2.2.2.5"></leq><share href="https://arxiv.org/html/2410.00037v2#S3.E6.m1.13.13.13.7.5.5.2.2.2.4.cmml" id="S3.E6.m1.13.13.13.7.5.5.2.2.2d.cmml" xref="S3.E6.m1.13.13.13.7.5.5.2.2.2"></share><ci id="S3.E6.m1.13.13.13.7.5.5.2.2.2.6.cmml" xref="S3.E6.m1.13.13.13.7.5.5.2.2.2.6">𝑄</ci></apply></apply></apply></apply><ci id="S3.E6.m1.13.13.13.8.1a.cmml" xref="S3.E6.m1.13.13.13.8.1"><mtext id="S3.E6.m1.13.13.13.8.1.cmml" xref="S3.E6.m1.13.13.13.8.1">delayed acoustic tok. of Moshi.</mtext></ci></matrixrow><matrixrow id="S3.E6.m1.24.24d.cmml" xref="S3.E6.m1.24.24"><apply id="S3.E6.m1.15.15.15.2.2.cmml" xref="S3.E6.m1.15.15.15.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.15.15.15.2.2.3.cmml" xref="S3.E6.m1.15.15.15.2.2">subscript</csymbol><ci id="S3.E6.m1.15.15.15.2.2.4.cmml" xref="S3.E6.m1.15.15.15.2.2.4">𝑉</ci><list id="S3.E6.m1.15.15.15.2.2.2.2.3.cmml" xref="S3.E6.m1.15.15.15.2.2.2.2.2"><ci id="S3.E6.m1.14.14.14.1.1.1.1.1.cmml" xref="S3.E6.m1.14.14.14.1.1.1.1.1">𝑠</ci><apply id="S3.E6.m1.15.15.15.2.2.2.2.2.1.cmml" xref="S3.E6.m1.15.15.15.2.2.2.2.2.1"><plus id="S3.E6.m1.15.15.15.2.2.2.2.2.1.1.cmml" xref="S3.E6.m1.15.15.15.2.2.2.2.2.1.1"></plus><cn id="S3.E6.m1.15.15.15.2.2.2.2.2.1.2.cmml" type="integer" xref="S3.E6.m1.15.15.15.2.2.2.2.2.1.2">1</cn><ci id="S3.E6.m1.15.15.15.2.2.2.2.2.1.3.cmml" xref="S3.E6.m1.15.15.15.2.2.2.2.2.1.3">𝑄</ci><cn id="S3.E6.m1.15.15.15.2.2.2.2.2.1.4.cmml" type="integer" xref="S3.E6.m1.15.15.15.2.2.2.2.2.1.4">1</cn></apply></list></apply><apply id="S3.E6.m1.17.17.17.4.2.cmml" xref="S3.E6.m1.17.17.17.4.2"><eq id="S3.E6.m1.17.17.17.4.2.3.cmml" xref="S3.E6.m1.17.17.17.4.2.3"></eq><csymbol cd="latexml" id="S3.E6.m1.17.17.17.4.2.4.cmml" xref="S3.E6.m1.17.17.17.4.2.4">absent</csymbol><apply id="S3.E6.m1.17.17.17.4.2.5.cmml" xref="S3.E6.m1.17.17.17.4.2.5"><csymbol cd="ambiguous" id="S3.E6.m1.17.17.17.4.2.5.1.cmml" xref="S3.E6.m1.17.17.17.4.2.5">subscript</csymbol><apply id="S3.E6.m1.17.17.17.4.2.5.2.cmml" xref="S3.E6.m1.17.17.17.4.2.5"><csymbol cd="ambiguous" id="S3.E6.m1.17.17.17.4.2.5.2.1.cmml" xref="S3.E6.m1.17.17.17.4.2.5">superscript</csymbol><ci id="S3.E6.m1.17.17.17.4.2.5.2.2.cmml" xref="S3.E6.m1.17.17.17.4.2.5.2.2">𝐴</ci><ci id="S3.E6.m1.17.17.17.4.2.5.2.3.cmml" xref="S3.E6.m1.17.17.17.4.2.5.2.3">′</ci></apply><list id="S3.E6.m1.17.17.17.4.2.2.2.3.cmml" xref="S3.E6.m1.17.17.17.4.2.2.2.4"><ci id="S3.E6.m1.16.16.16.3.1.1.1.1.cmml" xref="S3.E6.m1.16.16.16.3.1.1.1.1">𝑠</ci><cn id="S3.E6.m1.17.17.17.4.2.2.2.2.cmml" type="integer" xref="S3.E6.m1.17.17.17.4.2.2.2.2">1</cn></list></apply></apply><ci id="S3.E6.m1.17.17.17.5.1d.cmml" xref="S3.E6.m1.17.17.17.5.1"><mrow id="S3.E6.m1.17.17.17.5.1.cmml" xref="S3.E6.m1.17.17.17.5.1"><mtext id="S3.E6.m1.17.17.17.5.1a.cmml" xref="S3.E6.m1.17.17.17.5.1">semantic tokens of&nbsp;</mtext><mtext class="ltx_mathvariant_italic" id="S3.E6.m1.17.17.17.5.1b.cmml" xref="S3.E6.m1.17.17.17.5.1">other</mtext><mtext id="S3.E6.m1.17.17.17.5.1c.cmml" xref="S3.E6.m1.17.17.17.5.1">.</mtext></mrow></ci></matrixrow><matrixrow id="S3.E6.m1.24.24e.cmml" xref="S3.E6.m1.24.24"><apply id="S3.E6.m1.19.19.19.2.2.cmml" xref="S3.E6.m1.19.19.19.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.19.19.19.2.2.3.cmml" xref="S3.E6.m1.19.19.19.2.2">subscript</csymbol><ci id="S3.E6.m1.19.19.19.2.2.4.cmml" xref="S3.E6.m1.19.19.19.2.2.4">𝑉</ci><list id="S3.E6.m1.19.19.19.2.2.2.2.3.cmml" xref="S3.E6.m1.19.19.19.2.2.2.2.2"><ci id="S3.E6.m1.18.18.18.1.1.1.1.1.cmml" xref="S3.E6.m1.18.18.18.1.1.1.1.1">𝑠</ci><apply id="S3.E6.m1.19.19.19.2.2.2.2.2.1.cmml" xref="S3.E6.m1.19.19.19.2.2.2.2.2.1"><plus id="S3.E6.m1.19.19.19.2.2.2.2.2.1.1.cmml" xref="S3.E6.m1.19.19.19.2.2.2.2.2.1.1"></plus><cn id="S3.E6.m1.19.19.19.2.2.2.2.2.1.2.cmml" type="integer" xref="S3.E6.m1.19.19.19.2.2.2.2.2.1.2">1</cn><ci id="S3.E6.m1.19.19.19.2.2.2.2.2.1.3.cmml" xref="S3.E6.m1.19.19.19.2.2.2.2.2.1.3">𝑄</ci><ci id="S3.E6.m1.19.19.19.2.2.2.2.2.1.4.cmml" xref="S3.E6.m1.19.19.19.2.2.2.2.2.1.4">𝑞</ci></apply></list></apply><apply id="S3.E6.m1.24.24.24.7.5.6.cmml" xref="S3.E6.m1.24.24.24.7.5.5"><csymbol cd="ambiguous" id="S3.E6.m1.24.24.24.7.5.6a.cmml" xref="S3.E6.m1.24.24.24.7.5.5.3">formulae-sequence</csymbol><apply id="S3.E6.m1.23.23.23.6.4.4.1.cmml" xref="S3.E6.m1.23.23.23.6.4.4.1"><eq id="S3.E6.m1.23.23.23.6.4.4.1.2.cmml" xref="S3.E6.m1.23.23.23.6.4.4.1.2"></eq><csymbol cd="latexml" id="S3.E6.m1.23.23.23.6.4.4.1.3.cmml" xref="S3.E6.m1.23.23.23.6.4.4.1.3">absent</csymbol><list id="S3.E6.m1.23.23.23.6.4.4.1.1.2.cmml" xref="S3.E6.m1.23.23.23.6.4.4.1.1.1"><apply id="S3.E6.m1.23.23.23.6.4.4.1.1.1.1.cmml" xref="S3.E6.m1.23.23.23.6.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.23.23.23.6.4.4.1.1.1.1.1.cmml" xref="S3.E6.m1.23.23.23.6.4.4.1.1.1.1">subscript</csymbol><apply id="S3.E6.m1.23.23.23.6.4.4.1.1.1.1.2.cmml" xref="S3.E6.m1.23.23.23.6.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.23.23.23.6.4.4.1.1.1.1.2.1.cmml" xref="S3.E6.m1.23.23.23.6.4.4.1.1.1.1">superscript</csymbol><ci id="S3.E6.m1.23.23.23.6.4.4.1.1.1.1.2.2.cmml" xref="S3.E6.m1.23.23.23.6.4.4.1.1.1.1.2.2">𝐴</ci><ci id="S3.E6.m1.23.23.23.6.4.4.1.1.1.1.2.3.cmml" xref="S3.E6.m1.23.23.23.6.4.4.1.1.1.1.2.3">′</ci></apply><list id="S3.E6.m1.21.21.21.4.2.2.2.3.cmml" xref="S3.E6.m1.21.21.21.4.2.2.2.2"><apply id="S3.E6.m1.21.21.21.4.2.2.2.2.1.cmml" xref="S3.E6.m1.21.21.21.4.2.2.2.2.1"><minus id="S3.E6.m1.21.21.21.4.2.2.2.2.1.1.cmml" xref="S3.E6.m1.21.21.21.4.2.2.2.2.1.1"></minus><ci id="S3.E6.m1.21.21.21.4.2.2.2.2.1.2.cmml" xref="S3.E6.m1.21.21.21.4.2.2.2.2.1.2">𝑠</ci><ci id="S3.E6.m1.21.21.21.4.2.2.2.2.1.3.cmml" xref="S3.E6.m1.21.21.21.4.2.2.2.2.1.3">𝜏</ci></apply><ci id="S3.E6.m1.20.20.20.3.1.1.1.1.cmml" xref="S3.E6.m1.20.20.20.3.1.1.1.1">𝑞</ci></list></apply><ci id="S3.E6.m1.22.22.22.5.3.3a.cmml" xref="S3.E6.m1.22.22.22.5.3.3"><mtext id="S3.E6.m1.22.22.22.5.3.3.cmml" xref="S3.E6.m1.22.22.22.5.3.3">if</mtext></ci></list></apply><apply id="S3.E6.m1.24.24.24.7.5.5.2.3.cmml" xref="S3.E6.m1.24.24.24.7.5.5.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.24.24.24.7.5.5.2.3a.cmml" xref="S3.E6.m1.24.24.24.7.5.5.2.2.3">formulae-sequence</csymbol><apply id="S3.E6.m1.24.24.24.7.5.5.2.1.1.cmml" xref="S3.E6.m1.24.24.24.7.5.5.2.1.1"><geq id="S3.E6.m1.24.24.24.7.5.5.2.1.1.1.cmml" xref="S3.E6.m1.24.24.24.7.5.5.2.1.1.1"></geq><ci id="S3.E6.m1.24.24.24.7.5.5.2.1.1.2.cmml" xref="S3.E6.m1.24.24.24.7.5.5.2.1.1.2">𝑠</ci><apply id="S3.E6.m1.24.24.24.7.5.5.2.1.1.3.cmml" xref="S3.E6.m1.24.24.24.7.5.5.2.1.1.3"><plus id="S3.E6.m1.24.24.24.7.5.5.2.1.1.3.1.cmml" xref="S3.E6.m1.24.24.24.7.5.5.2.1.1.3.1"></plus><ci id="S3.E6.m1.24.24.24.7.5.5.2.1.1.3.2.cmml" xref="S3.E6.m1.24.24.24.7.5.5.2.1.1.3.2">𝜏</ci><cn id="S3.E6.m1.24.24.24.7.5.5.2.1.1.3.3.cmml" type="integer" xref="S3.E6.m1.24.24.24.7.5.5.2.1.1.3.3">1</cn></apply></apply><apply id="S3.E6.m1.24.24.24.7.5.5.2.2.2.cmml" xref="S3.E6.m1.24.24.24.7.5.5.2.2.2"><and id="S3.E6.m1.24.24.24.7.5.5.2.2.2a.cmml" xref="S3.E6.m1.24.24.24.7.5.5.2.2.2"></and><apply id="S3.E6.m1.24.24.24.7.5.5.2.2.2b.cmml" xref="S3.E6.m1.24.24.24.7.5.5.2.2.2"><lt id="S3.E6.m1.24.24.24.7.5.5.2.2.2.3.cmml" xref="S3.E6.m1.24.24.24.7.5.5.2.2.2.3"></lt><cn id="S3.E6.m1.24.24.24.7.5.5.2.2.2.2.cmml" type="integer" xref="S3.E6.m1.24.24.24.7.5.5.2.2.2.2">1</cn><ci id="S3.E6.m1.24.24.24.7.5.5.2.2.2.4.cmml" xref="S3.E6.m1.24.24.24.7.5.5.2.2.2.4">𝑞</ci></apply><apply id="S3.E6.m1.24.24.24.7.5.5.2.2.2c.cmml" xref="S3.E6.m1.24.24.24.7.5.5.2.2.2"><leq id="S3.E6.m1.24.24.24.7.5.5.2.2.2.5.cmml" xref="S3.E6.m1.24.24.24.7.5.5.2.2.2.5"></leq><share href="https://arxiv.org/html/2410.00037v2#S3.E6.m1.24.24.24.7.5.5.2.2.2.4.cmml" id="S3.E6.m1.24.24.24.7.5.5.2.2.2d.cmml" xref="S3.E6.m1.24.24.24.7.5.5.2.2.2"></share><ci id="S3.E6.m1.24.24.24.7.5.5.2.2.2.6.cmml" xref="S3.E6.m1.24.24.24.7.5.5.2.2.2.6">𝑄</ci></apply></apply></apply></apply><ci id="S3.E6.m1.24.24.24.8.1d.cmml" xref="S3.E6.m1.24.24.24.8.1"><mrow id="S3.E6.m1.24.24.24.8.1.cmml" xref="S3.E6.m1.24.24.24.8.1"><mtext id="S3.E6.m1.24.24.24.8.1a.cmml" xref="S3.E6.m1.24.24.24.8.1">delayed acoustic tok. of&nbsp;</mtext><mtext class="ltx_mathvariant_italic" id="S3.E6.m1.24.24.24.8.1b.cmml" xref="S3.E6.m1.24.24.24.8.1">other</mtext><mtext id="S3.E6.m1.24.24.24.8.1c.cmml" xref="S3.E6.m1.24.24.24.8.1">,</mtext></mrow></ci></matrixrow></matrix></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.24c">\left\{\begin{array}[]{lll}V_{s,1}&amp;=W_{s}&amp;\text{aligned text tokens.}\\
V_{s,2}&amp;=A_{s,1}&amp;\text{semantic tokens of Moshi.}\\
V_{s,1+q}&amp;=A_{s-\tau,q}\quad\text{if}\quad s\geq\tau+1,1&lt;q\leq Q&amp;\text{delayed%
 acoustic tok. of Moshi.}\\
V_{s,1+Q+1}&amp;=A^{\prime}_{s,1}&amp;\text{semantic tokens of \emph{other}.}\\
V_{s,1+Q+q}&amp;=A^{\prime}_{s-\tau,q}\quad\text{if}\quad s\geq\tau+1,1&lt;q\leq Q&amp;%
\text{delayed acoustic tok. of \emph{other},}\\
\end{array}\right.</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.24d">{ start_ARRAY start_ROW start_CELL italic_V start_POSTSUBSCRIPT italic_s , 1 end_POSTSUBSCRIPT end_CELL start_CELL = italic_W start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_CELL start_CELL aligned text tokens. end_CELL end_ROW start_ROW start_CELL italic_V start_POSTSUBSCRIPT italic_s , 2 end_POSTSUBSCRIPT end_CELL start_CELL = italic_A start_POSTSUBSCRIPT italic_s , 1 end_POSTSUBSCRIPT end_CELL start_CELL semantic tokens of Moshi. end_CELL end_ROW start_ROW start_CELL italic_V start_POSTSUBSCRIPT italic_s , 1 + italic_q end_POSTSUBSCRIPT end_CELL start_CELL = italic_A start_POSTSUBSCRIPT italic_s - italic_τ , italic_q end_POSTSUBSCRIPT if italic_s ≥ italic_τ + 1 , 1 &lt; italic_q ≤ italic_Q end_CELL start_CELL delayed acoustic tok. of Moshi. end_CELL end_ROW start_ROW start_CELL italic_V start_POSTSUBSCRIPT italic_s , 1 + italic_Q + 1 end_POSTSUBSCRIPT end_CELL start_CELL = italic_A start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s , 1 end_POSTSUBSCRIPT end_CELL start_CELL semantic tokens of italic_other . end_CELL end_ROW start_ROW start_CELL italic_V start_POSTSUBSCRIPT italic_s , 1 + italic_Q + italic_q end_POSTSUBSCRIPT end_CELL start_CELL = italic_A start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s - italic_τ , italic_q end_POSTSUBSCRIPT if italic_s ≥ italic_τ + 1 , 1 &lt; italic_q ≤ italic_Q end_CELL start_CELL delayed acoustic tok. of italic_other , end_CELL end_ROW end_ARRAY</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.SSS4.Px3.p1.3">amounting to a total number of <math alttext="K=2Q+1" class="ltx_Math" display="inline" id="S3.SS4.SSS4.Px3.p1.2.m1.1"><semantics id="S3.SS4.SSS4.Px3.p1.2.m1.1a"><mrow id="S3.SS4.SSS4.Px3.p1.2.m1.1.1" xref="S3.SS4.SSS4.Px3.p1.2.m1.1.1.cmml"><mi id="S3.SS4.SSS4.Px3.p1.2.m1.1.1.2" xref="S3.SS4.SSS4.Px3.p1.2.m1.1.1.2.cmml">K</mi><mo id="S3.SS4.SSS4.Px3.p1.2.m1.1.1.1" xref="S3.SS4.SSS4.Px3.p1.2.m1.1.1.1.cmml">=</mo><mrow id="S3.SS4.SSS4.Px3.p1.2.m1.1.1.3" xref="S3.SS4.SSS4.Px3.p1.2.m1.1.1.3.cmml"><mrow id="S3.SS4.SSS4.Px3.p1.2.m1.1.1.3.2" xref="S3.SS4.SSS4.Px3.p1.2.m1.1.1.3.2.cmml"><mn id="S3.SS4.SSS4.Px3.p1.2.m1.1.1.3.2.2" xref="S3.SS4.SSS4.Px3.p1.2.m1.1.1.3.2.2.cmml">2</mn><mo id="S3.SS4.SSS4.Px3.p1.2.m1.1.1.3.2.1" xref="S3.SS4.SSS4.Px3.p1.2.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S3.SS4.SSS4.Px3.p1.2.m1.1.1.3.2.3" xref="S3.SS4.SSS4.Px3.p1.2.m1.1.1.3.2.3.cmml">Q</mi></mrow><mo id="S3.SS4.SSS4.Px3.p1.2.m1.1.1.3.1" xref="S3.SS4.SSS4.Px3.p1.2.m1.1.1.3.1.cmml">+</mo><mn id="S3.SS4.SSS4.Px3.p1.2.m1.1.1.3.3" xref="S3.SS4.SSS4.Px3.p1.2.m1.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS4.Px3.p1.2.m1.1b"><apply id="S3.SS4.SSS4.Px3.p1.2.m1.1.1.cmml" xref="S3.SS4.SSS4.Px3.p1.2.m1.1.1"><eq id="S3.SS4.SSS4.Px3.p1.2.m1.1.1.1.cmml" xref="S3.SS4.SSS4.Px3.p1.2.m1.1.1.1"></eq><ci id="S3.SS4.SSS4.Px3.p1.2.m1.1.1.2.cmml" xref="S3.SS4.SSS4.Px3.p1.2.m1.1.1.2">𝐾</ci><apply id="S3.SS4.SSS4.Px3.p1.2.m1.1.1.3.cmml" xref="S3.SS4.SSS4.Px3.p1.2.m1.1.1.3"><plus id="S3.SS4.SSS4.Px3.p1.2.m1.1.1.3.1.cmml" xref="S3.SS4.SSS4.Px3.p1.2.m1.1.1.3.1"></plus><apply id="S3.SS4.SSS4.Px3.p1.2.m1.1.1.3.2.cmml" xref="S3.SS4.SSS4.Px3.p1.2.m1.1.1.3.2"><times id="S3.SS4.SSS4.Px3.p1.2.m1.1.1.3.2.1.cmml" xref="S3.SS4.SSS4.Px3.p1.2.m1.1.1.3.2.1"></times><cn id="S3.SS4.SSS4.Px3.p1.2.m1.1.1.3.2.2.cmml" type="integer" xref="S3.SS4.SSS4.Px3.p1.2.m1.1.1.3.2.2">2</cn><ci id="S3.SS4.SSS4.Px3.p1.2.m1.1.1.3.2.3.cmml" xref="S3.SS4.SSS4.Px3.p1.2.m1.1.1.3.2.3">𝑄</ci></apply><cn id="S3.SS4.SSS4.Px3.p1.2.m1.1.1.3.3.cmml" type="integer" xref="S3.SS4.SSS4.Px3.p1.2.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS4.Px3.p1.2.m1.1c">K=2Q+1</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS4.Px3.p1.2.m1.1d">italic_K = 2 italic_Q + 1</annotation></semantics></math> streams, with <math alttext="Q=8" class="ltx_Math" display="inline" id="S3.SS4.SSS4.Px3.p1.3.m2.1"><semantics id="S3.SS4.SSS4.Px3.p1.3.m2.1a"><mrow id="S3.SS4.SSS4.Px3.p1.3.m2.1.1" xref="S3.SS4.SSS4.Px3.p1.3.m2.1.1.cmml"><mi id="S3.SS4.SSS4.Px3.p1.3.m2.1.1.2" xref="S3.SS4.SSS4.Px3.p1.3.m2.1.1.2.cmml">Q</mi><mo id="S3.SS4.SSS4.Px3.p1.3.m2.1.1.1" xref="S3.SS4.SSS4.Px3.p1.3.m2.1.1.1.cmml">=</mo><mn id="S3.SS4.SSS4.Px3.p1.3.m2.1.1.3" xref="S3.SS4.SSS4.Px3.p1.3.m2.1.1.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS4.Px3.p1.3.m2.1b"><apply id="S3.SS4.SSS4.Px3.p1.3.m2.1.1.cmml" xref="S3.SS4.SSS4.Px3.p1.3.m2.1.1"><eq id="S3.SS4.SSS4.Px3.p1.3.m2.1.1.1.cmml" xref="S3.SS4.SSS4.Px3.p1.3.m2.1.1.1"></eq><ci id="S3.SS4.SSS4.Px3.p1.3.m2.1.1.2.cmml" xref="S3.SS4.SSS4.Px3.p1.3.m2.1.1.2">𝑄</ci><cn id="S3.SS4.SSS4.Px3.p1.3.m2.1.1.3.cmml" type="integer" xref="S3.SS4.SSS4.Px3.p1.3.m2.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS4.Px3.p1.3.m2.1c">Q=8</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS4.Px3.p1.3.m2.1d">italic_Q = 8</annotation></semantics></math> in the experiments.
A summary is provided in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.F4" title="Figure 4 ‣ 3.4.3 Multi-stream modeling ‣ 3.4 Generative Audio Modeling ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue">Figure&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS4.SSS4.Px4">
<h5 class="ltx_title ltx_title_paragraph">Inference of Moshi.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.SS4.SSS4.Px4.p1">
<p class="ltx_p" id="S3.SS4.SSS4.Px4.p1.7">The joint sequence given by <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2410.00037v2#S3.E6" title="6 ‣ Joint sequence modeling for Moshi. ‣ 3.4.4 Inner Monologue ‣ 3.4 Generative Audio Modeling ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_tag">Equation&nbsp;6</span></a> is the target for our modeling task at train time: At any time step <math alttext="s" class="ltx_Math" display="inline" id="S3.SS4.SSS4.Px4.p1.1.m1.1"><semantics id="S3.SS4.SSS4.Px4.p1.1.m1.1a"><mi id="S3.SS4.SSS4.Px4.p1.1.m1.1.1" xref="S3.SS4.SSS4.Px4.p1.1.m1.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS4.Px4.p1.1.m1.1b"><ci id="S3.SS4.SSS4.Px4.p1.1.m1.1.1.cmml" xref="S3.SS4.SSS4.Px4.p1.1.m1.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS4.Px4.p1.1.m1.1c">s</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS4.Px4.p1.1.m1.1d">italic_s</annotation></semantics></math>, the model is input with <math alttext="0,V_{1},\ldots,V_{s-1}" class="ltx_Math" display="inline" id="S3.SS4.SSS4.Px4.p1.2.m2.4"><semantics id="S3.SS4.SSS4.Px4.p1.2.m2.4a"><mrow id="S3.SS4.SSS4.Px4.p1.2.m2.4.4.2" xref="S3.SS4.SSS4.Px4.p1.2.m2.4.4.3.cmml"><mn id="S3.SS4.SSS4.Px4.p1.2.m2.1.1" xref="S3.SS4.SSS4.Px4.p1.2.m2.1.1.cmml">0</mn><mo id="S3.SS4.SSS4.Px4.p1.2.m2.4.4.2.3" xref="S3.SS4.SSS4.Px4.p1.2.m2.4.4.3.cmml">,</mo><msub id="S3.SS4.SSS4.Px4.p1.2.m2.3.3.1.1" xref="S3.SS4.SSS4.Px4.p1.2.m2.3.3.1.1.cmml"><mi id="S3.SS4.SSS4.Px4.p1.2.m2.3.3.1.1.2" xref="S3.SS4.SSS4.Px4.p1.2.m2.3.3.1.1.2.cmml">V</mi><mn id="S3.SS4.SSS4.Px4.p1.2.m2.3.3.1.1.3" xref="S3.SS4.SSS4.Px4.p1.2.m2.3.3.1.1.3.cmml">1</mn></msub><mo id="S3.SS4.SSS4.Px4.p1.2.m2.4.4.2.4" xref="S3.SS4.SSS4.Px4.p1.2.m2.4.4.3.cmml">,</mo><mi id="S3.SS4.SSS4.Px4.p1.2.m2.2.2" mathvariant="normal" xref="S3.SS4.SSS4.Px4.p1.2.m2.2.2.cmml">…</mi><mo id="S3.SS4.SSS4.Px4.p1.2.m2.4.4.2.5" xref="S3.SS4.SSS4.Px4.p1.2.m2.4.4.3.cmml">,</mo><msub id="S3.SS4.SSS4.Px4.p1.2.m2.4.4.2.2" xref="S3.SS4.SSS4.Px4.p1.2.m2.4.4.2.2.cmml"><mi id="S3.SS4.SSS4.Px4.p1.2.m2.4.4.2.2.2" xref="S3.SS4.SSS4.Px4.p1.2.m2.4.4.2.2.2.cmml">V</mi><mrow id="S3.SS4.SSS4.Px4.p1.2.m2.4.4.2.2.3" xref="S3.SS4.SSS4.Px4.p1.2.m2.4.4.2.2.3.cmml"><mi id="S3.SS4.SSS4.Px4.p1.2.m2.4.4.2.2.3.2" xref="S3.SS4.SSS4.Px4.p1.2.m2.4.4.2.2.3.2.cmml">s</mi><mo id="S3.SS4.SSS4.Px4.p1.2.m2.4.4.2.2.3.1" xref="S3.SS4.SSS4.Px4.p1.2.m2.4.4.2.2.3.1.cmml">−</mo><mn id="S3.SS4.SSS4.Px4.p1.2.m2.4.4.2.2.3.3" xref="S3.SS4.SSS4.Px4.p1.2.m2.4.4.2.2.3.3.cmml">1</mn></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS4.Px4.p1.2.m2.4b"><list id="S3.SS4.SSS4.Px4.p1.2.m2.4.4.3.cmml" xref="S3.SS4.SSS4.Px4.p1.2.m2.4.4.2"><cn id="S3.SS4.SSS4.Px4.p1.2.m2.1.1.cmml" type="integer" xref="S3.SS4.SSS4.Px4.p1.2.m2.1.1">0</cn><apply id="S3.SS4.SSS4.Px4.p1.2.m2.3.3.1.1.cmml" xref="S3.SS4.SSS4.Px4.p1.2.m2.3.3.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS4.Px4.p1.2.m2.3.3.1.1.1.cmml" xref="S3.SS4.SSS4.Px4.p1.2.m2.3.3.1.1">subscript</csymbol><ci id="S3.SS4.SSS4.Px4.p1.2.m2.3.3.1.1.2.cmml" xref="S3.SS4.SSS4.Px4.p1.2.m2.3.3.1.1.2">𝑉</ci><cn id="S3.SS4.SSS4.Px4.p1.2.m2.3.3.1.1.3.cmml" type="integer" xref="S3.SS4.SSS4.Px4.p1.2.m2.3.3.1.1.3">1</cn></apply><ci id="S3.SS4.SSS4.Px4.p1.2.m2.2.2.cmml" xref="S3.SS4.SSS4.Px4.p1.2.m2.2.2">…</ci><apply id="S3.SS4.SSS4.Px4.p1.2.m2.4.4.2.2.cmml" xref="S3.SS4.SSS4.Px4.p1.2.m2.4.4.2.2"><csymbol cd="ambiguous" id="S3.SS4.SSS4.Px4.p1.2.m2.4.4.2.2.1.cmml" xref="S3.SS4.SSS4.Px4.p1.2.m2.4.4.2.2">subscript</csymbol><ci id="S3.SS4.SSS4.Px4.p1.2.m2.4.4.2.2.2.cmml" xref="S3.SS4.SSS4.Px4.p1.2.m2.4.4.2.2.2">𝑉</ci><apply id="S3.SS4.SSS4.Px4.p1.2.m2.4.4.2.2.3.cmml" xref="S3.SS4.SSS4.Px4.p1.2.m2.4.4.2.2.3"><minus id="S3.SS4.SSS4.Px4.p1.2.m2.4.4.2.2.3.1.cmml" xref="S3.SS4.SSS4.Px4.p1.2.m2.4.4.2.2.3.1"></minus><ci id="S3.SS4.SSS4.Px4.p1.2.m2.4.4.2.2.3.2.cmml" xref="S3.SS4.SSS4.Px4.p1.2.m2.4.4.2.2.3.2">𝑠</ci><cn id="S3.SS4.SSS4.Px4.p1.2.m2.4.4.2.2.3.3.cmml" type="integer" xref="S3.SS4.SSS4.Px4.p1.2.m2.4.4.2.2.3.3">1</cn></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS4.Px4.p1.2.m2.4c">0,V_{1},\ldots,V_{s-1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS4.Px4.p1.2.m2.4d">0 , italic_V start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_V start_POSTSUBSCRIPT italic_s - 1 end_POSTSUBSCRIPT</annotation></semantics></math> and output an estimated probability distribution <math alttext="\hat{V}_{s}(0,V_{1},\ldots,V_{s-1})" class="ltx_Math" display="inline" id="S3.SS4.SSS4.Px4.p1.3.m3.4"><semantics id="S3.SS4.SSS4.Px4.p1.3.m3.4a"><mrow id="S3.SS4.SSS4.Px4.p1.3.m3.4.4" xref="S3.SS4.SSS4.Px4.p1.3.m3.4.4.cmml"><msub id="S3.SS4.SSS4.Px4.p1.3.m3.4.4.4" xref="S3.SS4.SSS4.Px4.p1.3.m3.4.4.4.cmml"><mover accent="true" id="S3.SS4.SSS4.Px4.p1.3.m3.4.4.4.2" xref="S3.SS4.SSS4.Px4.p1.3.m3.4.4.4.2.cmml"><mi id="S3.SS4.SSS4.Px4.p1.3.m3.4.4.4.2.2" xref="S3.SS4.SSS4.Px4.p1.3.m3.4.4.4.2.2.cmml">V</mi><mo id="S3.SS4.SSS4.Px4.p1.3.m3.4.4.4.2.1" xref="S3.SS4.SSS4.Px4.p1.3.m3.4.4.4.2.1.cmml">^</mo></mover><mi id="S3.SS4.SSS4.Px4.p1.3.m3.4.4.4.3" xref="S3.SS4.SSS4.Px4.p1.3.m3.4.4.4.3.cmml">s</mi></msub><mo id="S3.SS4.SSS4.Px4.p1.3.m3.4.4.3" xref="S3.SS4.SSS4.Px4.p1.3.m3.4.4.3.cmml">⁢</mo><mrow id="S3.SS4.SSS4.Px4.p1.3.m3.4.4.2.2" xref="S3.SS4.SSS4.Px4.p1.3.m3.4.4.2.3.cmml"><mo id="S3.SS4.SSS4.Px4.p1.3.m3.4.4.2.2.3" stretchy="false" xref="S3.SS4.SSS4.Px4.p1.3.m3.4.4.2.3.cmml">(</mo><mn id="S3.SS4.SSS4.Px4.p1.3.m3.1.1" xref="S3.SS4.SSS4.Px4.p1.3.m3.1.1.cmml">0</mn><mo id="S3.SS4.SSS4.Px4.p1.3.m3.4.4.2.2.4" xref="S3.SS4.SSS4.Px4.p1.3.m3.4.4.2.3.cmml">,</mo><msub id="S3.SS4.SSS4.Px4.p1.3.m3.3.3.1.1.1" xref="S3.SS4.SSS4.Px4.p1.3.m3.3.3.1.1.1.cmml"><mi id="S3.SS4.SSS4.Px4.p1.3.m3.3.3.1.1.1.2" xref="S3.SS4.SSS4.Px4.p1.3.m3.3.3.1.1.1.2.cmml">V</mi><mn id="S3.SS4.SSS4.Px4.p1.3.m3.3.3.1.1.1.3" xref="S3.SS4.SSS4.Px4.p1.3.m3.3.3.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS4.SSS4.Px4.p1.3.m3.4.4.2.2.5" xref="S3.SS4.SSS4.Px4.p1.3.m3.4.4.2.3.cmml">,</mo><mi id="S3.SS4.SSS4.Px4.p1.3.m3.2.2" mathvariant="normal" xref="S3.SS4.SSS4.Px4.p1.3.m3.2.2.cmml">…</mi><mo id="S3.SS4.SSS4.Px4.p1.3.m3.4.4.2.2.6" xref="S3.SS4.SSS4.Px4.p1.3.m3.4.4.2.3.cmml">,</mo><msub id="S3.SS4.SSS4.Px4.p1.3.m3.4.4.2.2.2" xref="S3.SS4.SSS4.Px4.p1.3.m3.4.4.2.2.2.cmml"><mi id="S3.SS4.SSS4.Px4.p1.3.m3.4.4.2.2.2.2" xref="S3.SS4.SSS4.Px4.p1.3.m3.4.4.2.2.2.2.cmml">V</mi><mrow id="S3.SS4.SSS4.Px4.p1.3.m3.4.4.2.2.2.3" xref="S3.SS4.SSS4.Px4.p1.3.m3.4.4.2.2.2.3.cmml"><mi id="S3.SS4.SSS4.Px4.p1.3.m3.4.4.2.2.2.3.2" xref="S3.SS4.SSS4.Px4.p1.3.m3.4.4.2.2.2.3.2.cmml">s</mi><mo id="S3.SS4.SSS4.Px4.p1.3.m3.4.4.2.2.2.3.1" xref="S3.SS4.SSS4.Px4.p1.3.m3.4.4.2.2.2.3.1.cmml">−</mo><mn id="S3.SS4.SSS4.Px4.p1.3.m3.4.4.2.2.2.3.3" xref="S3.SS4.SSS4.Px4.p1.3.m3.4.4.2.2.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS4.SSS4.Px4.p1.3.m3.4.4.2.2.7" stretchy="false" xref="S3.SS4.SSS4.Px4.p1.3.m3.4.4.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS4.Px4.p1.3.m3.4b"><apply id="S3.SS4.SSS4.Px4.p1.3.m3.4.4.cmml" xref="S3.SS4.SSS4.Px4.p1.3.m3.4.4"><times id="S3.SS4.SSS4.Px4.p1.3.m3.4.4.3.cmml" xref="S3.SS4.SSS4.Px4.p1.3.m3.4.4.3"></times><apply id="S3.SS4.SSS4.Px4.p1.3.m3.4.4.4.cmml" xref="S3.SS4.SSS4.Px4.p1.3.m3.4.4.4"><csymbol cd="ambiguous" id="S3.SS4.SSS4.Px4.p1.3.m3.4.4.4.1.cmml" xref="S3.SS4.SSS4.Px4.p1.3.m3.4.4.4">subscript</csymbol><apply id="S3.SS4.SSS4.Px4.p1.3.m3.4.4.4.2.cmml" xref="S3.SS4.SSS4.Px4.p1.3.m3.4.4.4.2"><ci id="S3.SS4.SSS4.Px4.p1.3.m3.4.4.4.2.1.cmml" xref="S3.SS4.SSS4.Px4.p1.3.m3.4.4.4.2.1">^</ci><ci id="S3.SS4.SSS4.Px4.p1.3.m3.4.4.4.2.2.cmml" xref="S3.SS4.SSS4.Px4.p1.3.m3.4.4.4.2.2">𝑉</ci></apply><ci id="S3.SS4.SSS4.Px4.p1.3.m3.4.4.4.3.cmml" xref="S3.SS4.SSS4.Px4.p1.3.m3.4.4.4.3">𝑠</ci></apply><vector id="S3.SS4.SSS4.Px4.p1.3.m3.4.4.2.3.cmml" xref="S3.SS4.SSS4.Px4.p1.3.m3.4.4.2.2"><cn id="S3.SS4.SSS4.Px4.p1.3.m3.1.1.cmml" type="integer" xref="S3.SS4.SSS4.Px4.p1.3.m3.1.1">0</cn><apply id="S3.SS4.SSS4.Px4.p1.3.m3.3.3.1.1.1.cmml" xref="S3.SS4.SSS4.Px4.p1.3.m3.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS4.Px4.p1.3.m3.3.3.1.1.1.1.cmml" xref="S3.SS4.SSS4.Px4.p1.3.m3.3.3.1.1.1">subscript</csymbol><ci id="S3.SS4.SSS4.Px4.p1.3.m3.3.3.1.1.1.2.cmml" xref="S3.SS4.SSS4.Px4.p1.3.m3.3.3.1.1.1.2">𝑉</ci><cn id="S3.SS4.SSS4.Px4.p1.3.m3.3.3.1.1.1.3.cmml" type="integer" xref="S3.SS4.SSS4.Px4.p1.3.m3.3.3.1.1.1.3">1</cn></apply><ci id="S3.SS4.SSS4.Px4.p1.3.m3.2.2.cmml" xref="S3.SS4.SSS4.Px4.p1.3.m3.2.2">…</ci><apply id="S3.SS4.SSS4.Px4.p1.3.m3.4.4.2.2.2.cmml" xref="S3.SS4.SSS4.Px4.p1.3.m3.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.SSS4.Px4.p1.3.m3.4.4.2.2.2.1.cmml" xref="S3.SS4.SSS4.Px4.p1.3.m3.4.4.2.2.2">subscript</csymbol><ci id="S3.SS4.SSS4.Px4.p1.3.m3.4.4.2.2.2.2.cmml" xref="S3.SS4.SSS4.Px4.p1.3.m3.4.4.2.2.2.2">𝑉</ci><apply id="S3.SS4.SSS4.Px4.p1.3.m3.4.4.2.2.2.3.cmml" xref="S3.SS4.SSS4.Px4.p1.3.m3.4.4.2.2.2.3"><minus id="S3.SS4.SSS4.Px4.p1.3.m3.4.4.2.2.2.3.1.cmml" xref="S3.SS4.SSS4.Px4.p1.3.m3.4.4.2.2.2.3.1"></minus><ci id="S3.SS4.SSS4.Px4.p1.3.m3.4.4.2.2.2.3.2.cmml" xref="S3.SS4.SSS4.Px4.p1.3.m3.4.4.2.2.2.3.2">𝑠</ci><cn id="S3.SS4.SSS4.Px4.p1.3.m3.4.4.2.2.2.3.3.cmml" type="integer" xref="S3.SS4.SSS4.Px4.p1.3.m3.4.4.2.2.2.3.3">1</cn></apply></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS4.Px4.p1.3.m3.4c">\hat{V}_{s}(0,V_{1},\ldots,V_{s-1})</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS4.Px4.p1.3.m3.4d">over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ( 0 , italic_V start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_V start_POSTSUBSCRIPT italic_s - 1 end_POSTSUBSCRIPT )</annotation></semantics></math>.
At inference time, we sample from <math alttext="\hat{V}_{s,k}" class="ltx_Math" display="inline" id="S3.SS4.SSS4.Px4.p1.4.m4.2"><semantics id="S3.SS4.SSS4.Px4.p1.4.m4.2a"><msub id="S3.SS4.SSS4.Px4.p1.4.m4.2.3" xref="S3.SS4.SSS4.Px4.p1.4.m4.2.3.cmml"><mover accent="true" id="S3.SS4.SSS4.Px4.p1.4.m4.2.3.2" xref="S3.SS4.SSS4.Px4.p1.4.m4.2.3.2.cmml"><mi id="S3.SS4.SSS4.Px4.p1.4.m4.2.3.2.2" xref="S3.SS4.SSS4.Px4.p1.4.m4.2.3.2.2.cmml">V</mi><mo id="S3.SS4.SSS4.Px4.p1.4.m4.2.3.2.1" xref="S3.SS4.SSS4.Px4.p1.4.m4.2.3.2.1.cmml">^</mo></mover><mrow id="S3.SS4.SSS4.Px4.p1.4.m4.2.2.2.4" xref="S3.SS4.SSS4.Px4.p1.4.m4.2.2.2.3.cmml"><mi id="S3.SS4.SSS4.Px4.p1.4.m4.1.1.1.1" xref="S3.SS4.SSS4.Px4.p1.4.m4.1.1.1.1.cmml">s</mi><mo id="S3.SS4.SSS4.Px4.p1.4.m4.2.2.2.4.1" xref="S3.SS4.SSS4.Px4.p1.4.m4.2.2.2.3.cmml">,</mo><mi id="S3.SS4.SSS4.Px4.p1.4.m4.2.2.2.2" xref="S3.SS4.SSS4.Px4.p1.4.m4.2.2.2.2.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS4.Px4.p1.4.m4.2b"><apply id="S3.SS4.SSS4.Px4.p1.4.m4.2.3.cmml" xref="S3.SS4.SSS4.Px4.p1.4.m4.2.3"><csymbol cd="ambiguous" id="S3.SS4.SSS4.Px4.p1.4.m4.2.3.1.cmml" xref="S3.SS4.SSS4.Px4.p1.4.m4.2.3">subscript</csymbol><apply id="S3.SS4.SSS4.Px4.p1.4.m4.2.3.2.cmml" xref="S3.SS4.SSS4.Px4.p1.4.m4.2.3.2"><ci id="S3.SS4.SSS4.Px4.p1.4.m4.2.3.2.1.cmml" xref="S3.SS4.SSS4.Px4.p1.4.m4.2.3.2.1">^</ci><ci id="S3.SS4.SSS4.Px4.p1.4.m4.2.3.2.2.cmml" xref="S3.SS4.SSS4.Px4.p1.4.m4.2.3.2.2">𝑉</ci></apply><list id="S3.SS4.SSS4.Px4.p1.4.m4.2.2.2.3.cmml" xref="S3.SS4.SSS4.Px4.p1.4.m4.2.2.2.4"><ci id="S3.SS4.SSS4.Px4.p1.4.m4.1.1.1.1.cmml" xref="S3.SS4.SSS4.Px4.p1.4.m4.1.1.1.1">𝑠</ci><ci id="S3.SS4.SSS4.Px4.p1.4.m4.2.2.2.2.cmml" xref="S3.SS4.SSS4.Px4.p1.4.m4.2.2.2.2">𝑘</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS4.Px4.p1.4.m4.2c">\hat{V}_{s,k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS4.Px4.p1.4.m4.2d">over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT italic_s , italic_k end_POSTSUBSCRIPT</annotation></semantics></math> for all the sub-sequence indexes that corresponds to outputs of Moshi: i.e., for <math alttext="k=1" class="ltx_Math" display="inline" id="S3.SS4.SSS4.Px4.p1.5.m5.1"><semantics id="S3.SS4.SSS4.Px4.p1.5.m5.1a"><mrow id="S3.SS4.SSS4.Px4.p1.5.m5.1.1" xref="S3.SS4.SSS4.Px4.p1.5.m5.1.1.cmml"><mi id="S3.SS4.SSS4.Px4.p1.5.m5.1.1.2" xref="S3.SS4.SSS4.Px4.p1.5.m5.1.1.2.cmml">k</mi><mo id="S3.SS4.SSS4.Px4.p1.5.m5.1.1.1" xref="S3.SS4.SSS4.Px4.p1.5.m5.1.1.1.cmml">=</mo><mn id="S3.SS4.SSS4.Px4.p1.5.m5.1.1.3" xref="S3.SS4.SSS4.Px4.p1.5.m5.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS4.Px4.p1.5.m5.1b"><apply id="S3.SS4.SSS4.Px4.p1.5.m5.1.1.cmml" xref="S3.SS4.SSS4.Px4.p1.5.m5.1.1"><eq id="S3.SS4.SSS4.Px4.p1.5.m5.1.1.1.cmml" xref="S3.SS4.SSS4.Px4.p1.5.m5.1.1.1"></eq><ci id="S3.SS4.SSS4.Px4.p1.5.m5.1.1.2.cmml" xref="S3.SS4.SSS4.Px4.p1.5.m5.1.1.2">𝑘</ci><cn id="S3.SS4.SSS4.Px4.p1.5.m5.1.1.3.cmml" type="integer" xref="S3.SS4.SSS4.Px4.p1.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS4.Px4.p1.5.m5.1c">k=1</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS4.Px4.p1.5.m5.1d">italic_k = 1</annotation></semantics></math> for the text tokens corresponding to Moshi’s speech, and for <math alttext="k\in\{2,\ldots,2+Q\}" class="ltx_Math" display="inline" id="S3.SS4.SSS4.Px4.p1.6.m6.3"><semantics id="S3.SS4.SSS4.Px4.p1.6.m6.3a"><mrow id="S3.SS4.SSS4.Px4.p1.6.m6.3.3" xref="S3.SS4.SSS4.Px4.p1.6.m6.3.3.cmml"><mi id="S3.SS4.SSS4.Px4.p1.6.m6.3.3.3" xref="S3.SS4.SSS4.Px4.p1.6.m6.3.3.3.cmml">k</mi><mo id="S3.SS4.SSS4.Px4.p1.6.m6.3.3.2" xref="S3.SS4.SSS4.Px4.p1.6.m6.3.3.2.cmml">∈</mo><mrow id="S3.SS4.SSS4.Px4.p1.6.m6.3.3.1.1" xref="S3.SS4.SSS4.Px4.p1.6.m6.3.3.1.2.cmml"><mo id="S3.SS4.SSS4.Px4.p1.6.m6.3.3.1.1.2" stretchy="false" xref="S3.SS4.SSS4.Px4.p1.6.m6.3.3.1.2.cmml">{</mo><mn id="S3.SS4.SSS4.Px4.p1.6.m6.1.1" xref="S3.SS4.SSS4.Px4.p1.6.m6.1.1.cmml">2</mn><mo id="S3.SS4.SSS4.Px4.p1.6.m6.3.3.1.1.3" xref="S3.SS4.SSS4.Px4.p1.6.m6.3.3.1.2.cmml">,</mo><mi id="S3.SS4.SSS4.Px4.p1.6.m6.2.2" mathvariant="normal" xref="S3.SS4.SSS4.Px4.p1.6.m6.2.2.cmml">…</mi><mo id="S3.SS4.SSS4.Px4.p1.6.m6.3.3.1.1.4" xref="S3.SS4.SSS4.Px4.p1.6.m6.3.3.1.2.cmml">,</mo><mrow id="S3.SS4.SSS4.Px4.p1.6.m6.3.3.1.1.1" xref="S3.SS4.SSS4.Px4.p1.6.m6.3.3.1.1.1.cmml"><mn id="S3.SS4.SSS4.Px4.p1.6.m6.3.3.1.1.1.2" xref="S3.SS4.SSS4.Px4.p1.6.m6.3.3.1.1.1.2.cmml">2</mn><mo id="S3.SS4.SSS4.Px4.p1.6.m6.3.3.1.1.1.1" xref="S3.SS4.SSS4.Px4.p1.6.m6.3.3.1.1.1.1.cmml">+</mo><mi id="S3.SS4.SSS4.Px4.p1.6.m6.3.3.1.1.1.3" xref="S3.SS4.SSS4.Px4.p1.6.m6.3.3.1.1.1.3.cmml">Q</mi></mrow><mo id="S3.SS4.SSS4.Px4.p1.6.m6.3.3.1.1.5" stretchy="false" xref="S3.SS4.SSS4.Px4.p1.6.m6.3.3.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS4.Px4.p1.6.m6.3b"><apply id="S3.SS4.SSS4.Px4.p1.6.m6.3.3.cmml" xref="S3.SS4.SSS4.Px4.p1.6.m6.3.3"><in id="S3.SS4.SSS4.Px4.p1.6.m6.3.3.2.cmml" xref="S3.SS4.SSS4.Px4.p1.6.m6.3.3.2"></in><ci id="S3.SS4.SSS4.Px4.p1.6.m6.3.3.3.cmml" xref="S3.SS4.SSS4.Px4.p1.6.m6.3.3.3">𝑘</ci><set id="S3.SS4.SSS4.Px4.p1.6.m6.3.3.1.2.cmml" xref="S3.SS4.SSS4.Px4.p1.6.m6.3.3.1.1"><cn id="S3.SS4.SSS4.Px4.p1.6.m6.1.1.cmml" type="integer" xref="S3.SS4.SSS4.Px4.p1.6.m6.1.1">2</cn><ci id="S3.SS4.SSS4.Px4.p1.6.m6.2.2.cmml" xref="S3.SS4.SSS4.Px4.p1.6.m6.2.2">…</ci><apply id="S3.SS4.SSS4.Px4.p1.6.m6.3.3.1.1.1.cmml" xref="S3.SS4.SSS4.Px4.p1.6.m6.3.3.1.1.1"><plus id="S3.SS4.SSS4.Px4.p1.6.m6.3.3.1.1.1.1.cmml" xref="S3.SS4.SSS4.Px4.p1.6.m6.3.3.1.1.1.1"></plus><cn id="S3.SS4.SSS4.Px4.p1.6.m6.3.3.1.1.1.2.cmml" type="integer" xref="S3.SS4.SSS4.Px4.p1.6.m6.3.3.1.1.1.2">2</cn><ci id="S3.SS4.SSS4.Px4.p1.6.m6.3.3.1.1.1.3.cmml" xref="S3.SS4.SSS4.Px4.p1.6.m6.3.3.1.1.1.3">𝑄</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS4.Px4.p1.6.m6.3c">k\in\{2,\ldots,2+Q\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS4.Px4.p1.6.m6.3d">italic_k ∈ { 2 , … , 2 + italic_Q }</annotation></semantics></math> for Moshi’s audio tokens. In an application setting, prediction for the audio coming from the user (<math alttext="k>2+Q)" class="ltx_math_unparsed" display="inline" id="S3.SS4.SSS4.Px4.p1.7.m7.1"><semantics id="S3.SS4.SSS4.Px4.p1.7.m7.1a"><mrow id="S3.SS4.SSS4.Px4.p1.7.m7.1b"><mi id="S3.SS4.SSS4.Px4.p1.7.m7.1.1">k</mi><mo id="S3.SS4.SSS4.Px4.p1.7.m7.1.2">&gt;</mo><mn id="S3.SS4.SSS4.Px4.p1.7.m7.1.3">2</mn><mo id="S3.SS4.SSS4.Px4.p1.7.m7.1.4">+</mo><mi id="S3.SS4.SSS4.Px4.p1.7.m7.1.5">Q</mi><mo id="S3.SS4.SSS4.Px4.p1.7.m7.1.6" stretchy="false">)</mo></mrow><annotation encoding="application/x-tex" id="S3.SS4.SSS4.Px4.p1.7.m7.1c">k&gt;2+Q)</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS4.Px4.p1.7.m7.1d">italic_k &gt; 2 + italic_Q )</annotation></semantics></math> is actually ignored, as the actual user audio is used instead. However, modeling the user stream as output allows generating simulated dialogues, which is necessary for offline evaluation as in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.SS6" title="5.6 Quality and Statistics of Generated Dialogues ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue">Section&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.6</span></span></a>. Interestingly, there is no explicit boundaries for the change of turns between the user and Moshi: Moshi can speak and listen at all time, and do both at once if needed. In particular, when the user speaks and Moshi stays silent, the corresponding audio tokens for Moshi’s stream decode into “natural silence”, a near silent waveform, instead of having a fixed, well defined value; At the same time, Moshi’s text stream will be filled with <span class="ltx_text ltx_font_typewriter" id="S3.SS4.SSS4.Px4.p1.7.1">PAD</span> tokens. As a result, the text stream can provide interesting ways of controlling Moshi, for instance, forcing the sampling of a <span class="ltx_text ltx_font_typewriter" id="S3.SS4.SSS4.Px4.p1.7.2">EPAD</span> token will make Moshi start talking immediately.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Datasets and Training</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Text Data</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">Our training dataset is made of a mix of high-quality data sources and filtered web data from CommonCrawl.
More specifically, 12.5% of our dataset is from the following curated sources: Wikipedia,<span class="ltx_note ltx_role_footnote" id="footnote9"><sup class="ltx_note_mark">9</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">9</sup><span class="ltx_tag ltx_tag_note">9</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://dumps.wikimedia.org/" title="">https://dumps.wikimedia.org/</a></span></span></span> Wikibooks, Wikisource, Wikinews,
StackExchange<span class="ltx_note ltx_role_footnote" id="footnote10"><sup class="ltx_note_mark">10</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">10</sup><span class="ltx_tag ltx_tag_note">10</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://archive.org/details/stackexchange" title="">https://archive.org/details/stackexchange</a></span></span></span> and the collection of scientific articles pes2o.<span class="ltx_note ltx_role_footnote" id="footnote11"><sup class="ltx_note_mark">11</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">11</sup><span class="ltx_tag ltx_tag_note">11</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/allenai/peS2o" title="">https://github.com/allenai/peS2o</a></span></span></span>
Instead of doing multiple passes on Wikipedia, we use five different dumps from 2017, 2018, 2019, 2021 and 2022.
The remaining 87.5% of our dataset is from CommonCrawl, and was filtered with the pipeline described in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS2.SSS2" title="3.2.2 Pre-training data filtering ‣ 3.2 The Helium Text Language Model ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue">Section <span class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2.2</span></span></a>.
We used the following ten crawls: <span class="ltx_text ltx_font_typewriter" id="S4.SS1.p1.1.1">2018-30</span>, <span class="ltx_text ltx_font_typewriter" id="S4.SS1.p1.1.2">2019-04</span>, <span class="ltx_text ltx_font_typewriter" id="S4.SS1.p1.1.3">2019-30</span>, <span class="ltx_text ltx_font_typewriter" id="S4.SS1.p1.1.4">2020-05</span>, <span class="ltx_text ltx_font_typewriter" id="S4.SS1.p1.1.5">2020-34</span>, <span class="ltx_text ltx_font_typewriter" id="S4.SS1.p1.1.6">2021-04</span>, <span class="ltx_text ltx_font_typewriter" id="S4.SS1.p1.1.7">2021-31</span>, <span class="ltx_text ltx_font_typewriter" id="S4.SS1.p1.1.8">2022-05</span>, <span class="ltx_text ltx_font_typewriter" id="S4.SS1.p1.1.9">2022-33</span>, <span class="ltx_text ltx_font_typewriter" id="S4.SS1.p1.1.10">2023-40</span>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Audio Data</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">We use an audio collection of 7 million hours, which we call the <em class="ltx_emph ltx_font_italic" id="S4.SS2.p1.1.1">unsupervised audio dataset</em>, of readily available audio content, the majority
of which contains English speech. We transcribe this set with Whisper&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Radford et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib77" title="">2023</a>)</cite>, using the large-v3 model. We use this data for the audio pre-training phase, during which we do not use the multi-stream approach described in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS4.SSS3" title="3.4.3 Multi-stream modeling ‣ 3.4 Generative Audio Modeling ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue">Section&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.4.3</span></span></a>, but instead use a single stream of audio representing all speakers at once. Similarly, the text stream described in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS4.SSS4" title="3.4.4 Inner Monologue ‣ 3.4 Generative Audio Modeling ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue">Section&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.4.4</span></span></a> represents the words coming from all speakers. All the audio is resampled to 24kHz and downmixed to mono.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.1">To achieve multi-stream, we need the model to gain the ability to both listen and speak at the same time. For this, we further leverage the Fisher dataset&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Cieri et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib15" title="">2004</a>)</cite>. It consists of 2000 hours of
phone conversations between randomly paired participants, with a given topic to discuss. A property of Fisher is that each conversation side is recorded on a separate channels, which allows providing ground-truth separated streams to Moshi. The original audio is sampled at 8kHz, and we use AudioSR&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Liu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib57" title="">2023a</a>)</cite> to upsample it to 24kHz.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.1">Finally, we source 170 hours of natural and scripted conversations between multiple pairs of participants, recorded with separate channels per speaker, in order to provide a small dataset on which to finetune the model to improve the quality over the one obtained when using only Fisher. We call this dataset the <em class="ltx_emph ltx_font_italic" id="S4.SS2.p3.1.1">supervised multi-stream dataset</em>. We do not train Moshi directly on this dataset, but use it to train a realistic multi-stream TTS model, and fine-tune Helium on real conversation transcripts as explained in Sections&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S4.SS3" title="4.3 Speech-Text Instruct Data ‣ 4 Datasets and Training ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_tag">4.3</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S4.SS4" title="4.4 Training Stages and Hyper-parameters ‣ 4 Datasets and Training ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_tag">4.4</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S4.SS2.p4">
<p class="ltx_p" id="S4.SS2.p4.1">For both Fisher and this last dataset, we sample one speaker randomly as the main speaker (i.e., Moshi speaking), and put the other speaker on the second audio stream. For Fisher, the text stream only contains
the transcription of the main speaker. To obtain reliable timestamps, despite long silences in each stream, we
use transcription obtained with the <span class="ltx_text ltx_font_typewriter" id="S4.SS2.p4.1.1">whisper-timestamped</span> package&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Louradour, <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib65" title="">2023</a>)</cite>, along with the medium Whisper model.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Speech-Text Instruct Data</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">Early experiments using text-based instruct datasets such as Open Hermes&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Teknium, <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib94" title="">2023</a>)</cite> proved to be ill-suited for the instruct tuning of a spoken conversational system.
In particular, the data formatting was often impossible to properly render with TTS (e.g. URLs), and the format of the questions and responses was not following a natural oral flow (e.g. bullet points, long enumerations). Instead, we leverage Helium, fine-tuned on Open Hermes and transcripts of real conversations, to generate realistic interactions between a speech-based AI model and a user.
We then synthesize them with our multi-stream streaming TTS described in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#A3" title="Appendix C Delayed text LM as a zero-shot streaming ASR and TTS ‣ Moshi: a speech-text foundation model for real-time dialogue">Appendix <span class="ltx_ref"><span class="ltx_text ltx_ref_tag">C</span></span></a>, leading to more than 20k hours of synthetic speech data.
To give Moshi its own consistent voice, we also condition the TTS engine on the voice of a single actor, who recorded monologues covering more than 70 speaking styles, as listed in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#A6.T19" title="Table 19 ‣ F.3 Voice Instructions ‣ Appendix F Synthetic Transcripts Generation for Fine-tuning ‣ Moshi: a speech-text foundation model for real-time dialogue">Table&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">19</span></span></a>. Experiments on voice consistency reported in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S6.SS3" title="6.3 System Voice Consistency ‣ 6 Safety ‣ Moshi: a speech-text foundation model for real-time dialogue">Section&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">6.3</span></span></a> show that simply using a consistent voice for Moshi during instruction tuning is enough to guarantee almost surely that it does not use another voice, without further control during inference.
In contrast, the voice of the second audio stream (the user) is randomly sampled for each example, giving more robustness to different speaking conditions and accents.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.1">To generate the transcripts, we use different prompts, aiming at capturing different kinds of interactions between a user and Moshi.
First, we generate conversations about general knowledge, by starting from a few Wikipedia paragraphs or StackExchange posts, which we refer to as context.
This ensures that Moshi’s conversations cover a wide range of topics, such as history, cooking advice or pop culture.
More precisely, using a given context, we obtain a summary of a potential discussion with the following prompt:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.p3">
<svg class="ltx_picture" height="73.22" id="S4.SS3.p3.pic1" overflow="visible" version="1.1" width="600"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,73.22) matrix(1 0 0 -1 0 0)"><g fill="#404040" fill-opacity="1.0"><path d="M 0 5.91 L 0 67.32 C 0 70.58 2.64 73.22 5.91 73.22 L 594.09 73.22 C 597.36 73.22 600 70.58 600 67.32 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z" style="stroke:none"></path></g><g fill="#F2F2F2" fill-opacity="1.0"><path d="M 1.97 5.91 L 1.97 67.32 C 1.97 69.49 3.73 71.25 5.91 71.25 L 594.09 71.25 C 596.27 71.25 598.03 69.49 598.03 67.32 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 13.78)"><foreignObject color="#000000" height="45.66" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="556.69">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="S4.SS3.p3.pic1.1.1.1.1.1" style="width:402.3pt;">
<span class="ltx_p" id="S4.SS3.p3.pic1.1.1.1.1.1.1"><span class="ltx_text ltx_font_typewriter" id="S4.SS3.p3.pic1.1.1.1.1.1.1.1">{{context}}</span></span>
<span class="ltx_p" id="S4.SS3.p3.pic1.1.1.1.1.1.2"><span class="ltx_text ltx_font_typewriter" id="S4.SS3.p3.pic1.1.1.1.1.1.2.1">Based on information from the previous paragraph, write the summary of a conversation about {{title}} between Blake and Moshi. The summary must be 2 sentences long, and start with "They" or "The speakers".</span></span>
</span></foreignObject></g></g></svg><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.p4">
<p class="ltx_p" id="S4.SS3.p4.1">where <span class="ltx_text ltx_font_typewriter" id="S4.SS3.p4.1.1">{{context}}</span> refers to paragraphs from Wikipedia or StackExchange and <span class="ltx_text ltx_font_typewriter" id="S4.SS3.p4.1.2">{{title}}</span> is the corresponding title.
Then, we generate the full transcript with the prompt:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.p5">
<svg class="ltx_picture" height="56.46" id="S4.SS3.p5.pic1" overflow="visible" version="1.1" width="600"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,56.46) matrix(1 0 0 -1 0 0)"><g fill="#404040" fill-opacity="1.0"><path d="M 0 5.91 L 0 50.56 C 0 53.82 2.64 56.46 5.91 56.46 L 594.09 56.46 C 597.36 56.46 600 53.82 600 50.56 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z" style="stroke:none"></path></g><g fill="#F2F2F2" fill-opacity="1.0"><path d="M 1.97 5.91 L 1.97 50.56 C 1.97 52.73 3.73 54.49 5.91 54.49 L 594.09 54.49 C 596.27 54.49 598.03 52.73 598.03 50.56 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 13.78)"><foreignObject color="#000000" height="28.9" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="556.69">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="S4.SS3.p5.pic1.1.1.1.1.1" style="width:402.3pt;">
<span class="ltx_p" id="S4.SS3.p5.pic1.1.1.1.1.1.1"><span class="ltx_text ltx_font_typewriter" id="S4.SS3.p5.pic1.1.1.1.1.1.1.1">{{context}}</span></span>
<span class="ltx_p" id="S4.SS3.p5.pic1.1.1.1.1.1.2"><span class="ltx_text ltx_font_typewriter" id="S4.SS3.p5.pic1.1.1.1.1.1.2.1">Write the transcript of a conversation between Blake and Moshi. {{summary}} Moshi is knowledgeable about the topic. Use some backchanneling. Use short turns.</span></span>
</span></foreignObject></g></g></svg><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S4.SS3.p6">
<p class="ltx_p" id="S4.SS3.p6.1">Similarly, to give Moshi information about itself and the Kyutai lab, we generate paragraphs describing both and use them as additional context.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S4.SS3.p7">
<p class="ltx_p" id="S4.SS3.p7.1">Second, we produce interactions containing instructions about Moshi’s voice, such as the other speaker requesting Moshi to speak with an angry voice or like a pirate.
Our first strategy is to generate single turn interactions where the model is instructed to tell a sentence, a monologue or a poem about an entity, belonging to a high level category such as “sports” or “animals”, using a particular voice.
The voice requested by the other speaker and the entity are randomly sampled, and are thus completely unrelated.
Our second strategy is to generate roleplaying situations, corresponding to different emotions or speaking styles with the following prompt:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.p8">
<svg class="ltx_picture" height="58" id="S4.SS3.p8.pic1" overflow="visible" version="1.1" width="600"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,58) matrix(1 0 0 -1 0 0)"><g fill="#404040" fill-opacity="1.0"><path d="M 0 5.91 L 0 52.09 C 0 55.36 2.64 58 5.91 58 L 594.09 58 C 597.36 58 600 55.36 600 52.09 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z" style="stroke:none"></path></g><g fill="#F2F2F2" fill-opacity="1.0"><path d="M 1.97 5.91 L 1.97 52.09 C 1.97 54.27 3.73 56.03 5.91 56.03 L 594.09 56.03 C 596.27 56.03 598.03 54.27 598.03 52.09 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 13.78)"><foreignObject color="#000000" height="30.44" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="556.69">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="S4.SS3.p8.pic1.1.1.1.1.1" style="width:402.3pt;">
<span class="ltx_p" id="S4.SS3.p8.pic1.1.1.1.1.1.1"><span class="ltx_text ltx_font_typewriter" id="S4.SS3.p8.pic1.1.1.1.1.1.1.1">Write a list of 10 situations about a {{voice}} {{character}}. Each situation must start with "a {{voice}} {{character}} who" and must be at most 8 words long.</span></span>
</span></foreignObject></g></g></svg><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S4.SS3.p9">
<p class="ltx_p" id="S4.SS3.p9.1">Examples of voice adjective include “happy” or “suprised” and examples of characters include “detective” or “superhero”.
We then generate the interaction using the prompt:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.p10">
<svg class="ltx_picture" height="41.4" id="S4.SS3.p10.pic1" overflow="visible" version="1.1" width="600"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,41.4) matrix(1 0 0 -1 0 0)"><g fill="#404040" fill-opacity="1.0"><path d="M 0 5.91 L 0 35.49 C 0 38.75 2.64 41.4 5.91 41.4 L 594.09 41.4 C 597.36 41.4 600 38.75 600 35.49 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z" style="stroke:none"></path></g><g fill="#F2F2F2" fill-opacity="1.0"><path d="M 1.97 5.91 L 1.97 35.49 C 1.97 37.66 3.73 39.43 5.91 39.43 L 594.09 39.43 C 596.27 39.43 598.03 37.66 598.03 35.49 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 13.78)"><foreignObject color="#000000" height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="556.69">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="S4.SS3.p10.pic1.1.1.1.1.1" style="width:402.3pt;">
<span class="ltx_p" id="S4.SS3.p10.pic1.1.1.1.1.1.1"><span class="ltx_text ltx_font_typewriter" id="S4.SS3.p10.pic1.1.1.1.1.1.1.1">Write a dialogue between Blake and Moshi, {{situation}}. Use a lot of backchanneling.</span></span>
</span></foreignObject></g></g></svg><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S4.SS3.p11">
<p class="ltx_p" id="S4.SS3.p11.1">To make Moshi robust to mispronounced words, we also generate instructions containing misspellings in the user’s questions, followed by Moshi asking the user to repeat herself or to clarify the question.
We also generate questions containing a false or misleading fact (such as “Is the Eiffel Tower in Beijing?”), to train the model to answer “No” and correct the user.
Otherwise, the vast majority of generated conversations only contain questions from the user where Moshi should answer positively.
We generate basic math, grammar or trivia single-turn questions and answers, as we noticed that Moshi was initially not performing well on simple factual tasks like adding numbers.
Finally, we generate safety conversations, where the user asks unethical or NSFW questions, and Moshi refuses to answer these requests.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Training Stages and Hyper-parameters</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_paragraph" id="S4.SS4.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Helium pre-training.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS4.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS4.SSS0.Px1.p1.1">An overview of the training stages and hyper-parameters is provided in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.T1" title="Table 1 ‣ 3.2.1 Architecture ‣ 3.2 The Helium Text Language Model ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue">Table&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></span></a>.
For each stage, we use AdamW&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Loshchilov and Hutter, <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib64" title="">2019</a>)</cite>, with a weight decay of 0.1, a momentum decay of 0.9, and a decay for the average of the squared gradient of 0.95. All models are trained on H100 GPUs, using FSDP and activation checkpointing. The text-only language model, Helium, is trained for 500k steps, with a batch size of 4.2M tokens, using a cosine learning rate schedule starting at <math alttext="3\cdot 10^{-4}" class="ltx_Math" display="inline" id="S4.SS4.SSS0.Px1.p1.1.m1.1"><semantics id="S4.SS4.SSS0.Px1.p1.1.m1.1a"><mrow id="S4.SS4.SSS0.Px1.p1.1.m1.1.1" xref="S4.SS4.SSS0.Px1.p1.1.m1.1.1.cmml"><mn id="S4.SS4.SSS0.Px1.p1.1.m1.1.1.2" xref="S4.SS4.SSS0.Px1.p1.1.m1.1.1.2.cmml">3</mn><mo id="S4.SS4.SSS0.Px1.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS4.SSS0.Px1.p1.1.m1.1.1.1.cmml">⋅</mo><msup id="S4.SS4.SSS0.Px1.p1.1.m1.1.1.3" xref="S4.SS4.SSS0.Px1.p1.1.m1.1.1.3.cmml"><mn id="S4.SS4.SSS0.Px1.p1.1.m1.1.1.3.2" xref="S4.SS4.SSS0.Px1.p1.1.m1.1.1.3.2.cmml">10</mn><mrow id="S4.SS4.SSS0.Px1.p1.1.m1.1.1.3.3" xref="S4.SS4.SSS0.Px1.p1.1.m1.1.1.3.3.cmml"><mo id="S4.SS4.SSS0.Px1.p1.1.m1.1.1.3.3a" xref="S4.SS4.SSS0.Px1.p1.1.m1.1.1.3.3.cmml">−</mo><mn id="S4.SS4.SSS0.Px1.p1.1.m1.1.1.3.3.2" xref="S4.SS4.SSS0.Px1.p1.1.m1.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px1.p1.1.m1.1b"><apply id="S4.SS4.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S4.SS4.SSS0.Px1.p1.1.m1.1.1"><ci id="S4.SS4.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S4.SS4.SSS0.Px1.p1.1.m1.1.1.1">⋅</ci><cn id="S4.SS4.SSS0.Px1.p1.1.m1.1.1.2.cmml" type="integer" xref="S4.SS4.SSS0.Px1.p1.1.m1.1.1.2">3</cn><apply id="S4.SS4.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="S4.SS4.SSS0.Px1.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px1.p1.1.m1.1.1.3.1.cmml" xref="S4.SS4.SSS0.Px1.p1.1.m1.1.1.3">superscript</csymbol><cn id="S4.SS4.SSS0.Px1.p1.1.m1.1.1.3.2.cmml" type="integer" xref="S4.SS4.SSS0.Px1.p1.1.m1.1.1.3.2">10</cn><apply id="S4.SS4.SSS0.Px1.p1.1.m1.1.1.3.3.cmml" xref="S4.SS4.SSS0.Px1.p1.1.m1.1.1.3.3"><minus id="S4.SS4.SSS0.Px1.p1.1.m1.1.1.3.3.1.cmml" xref="S4.SS4.SSS0.Px1.p1.1.m1.1.1.3.3"></minus><cn id="S4.SS4.SSS0.Px1.p1.1.m1.1.1.3.3.2.cmml" type="integer" xref="S4.SS4.SSS0.Px1.p1.1.m1.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px1.p1.1.m1.1c">3\cdot 10^{-4}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS0.Px1.p1.1.m1.1d">3 ⋅ 10 start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math> with linear warmup.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS4.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Moshi pre-training.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS4.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS4.SSS0.Px2.p1.2">Then, we initialize the Temporal Transformer in Moshi with Helium, while the Depth Transformer described in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS4.SSS1" title="3.4.1 Hierarchical autoregressive modeling with RQ-Transformer ‣ 3.4 Generative Audio Modeling ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue">Section&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.4.1</span></span></a> is randomly initialized.
We first train on the unsupervised audio dataset presented in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S4.SS2" title="4.2 Audio Data ‣ 4 Datasets and Training ‣ Moshi: a speech-text foundation model for real-time dialogue">Section&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></span></a>, using a single stream of audio, with a batch size covering 16 hours of audio, each batch item consisting of a 5 mn sequence. We mask the corresponding text tokens with a probability of 30%. We randomize the delay between the text and audio tokens between -0.6 and +0.6 seconds.
In order to prevent catastrophic forgetting, we also train half of the time on batches of text only data from the same dataset as used for Helium. In total, we make 1 million training steps, with a cosine learning rate starting at <math alttext="3\cdot 10^{-5}" class="ltx_Math" display="inline" id="S4.SS4.SSS0.Px2.p1.1.m1.1"><semantics id="S4.SS4.SSS0.Px2.p1.1.m1.1a"><mrow id="S4.SS4.SSS0.Px2.p1.1.m1.1.1" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.cmml"><mn id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.2" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.2.cmml">3</mn><mo id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.cmml">⋅</mo><msup id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3.cmml"><mn id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3.2" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3.2.cmml">10</mn><mrow id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3.3" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3.3.cmml"><mo id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3.3a" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3.3.cmml">−</mo><mn id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3.3.2" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3.3.2.cmml">5</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px2.p1.1.m1.1b"><apply id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1"><ci id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1">⋅</ci><cn id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.2.cmml" type="integer" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.2">3</cn><apply id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3.cmml" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3.1.cmml" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3">superscript</csymbol><cn id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3.2.cmml" type="integer" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3.2">10</cn><apply id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3.3.cmml" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3.3"><minus id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3.3.1.cmml" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3.3"></minus><cn id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3.3.2.cmml" type="integer" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3.3.2">5</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px2.p1.1.m1.1c">3\cdot 10^{-5}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS0.Px2.p1.1.m1.1d">3 ⋅ 10 start_POSTSUPERSCRIPT - 5 end_POSTSUPERSCRIPT</annotation></semantics></math> for the Temporal Transformer, and <math alttext="2\cdot 10^{-4}" class="ltx_Math" display="inline" id="S4.SS4.SSS0.Px2.p1.2.m2.1"><semantics id="S4.SS4.SSS0.Px2.p1.2.m2.1a"><mrow id="S4.SS4.SSS0.Px2.p1.2.m2.1.1" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.cmml"><mn id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.2" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.2.cmml">2</mn><mo id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.cmml">⋅</mo><msup id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.3" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.3.cmml"><mn id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.3.2" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.3.2.cmml">10</mn><mrow id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.3.3" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.3.3.cmml"><mo id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.3.3a" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.3.3.cmml">−</mo><mn id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.3.3.2" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px2.p1.2.m2.1b"><apply id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1"><ci id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1.cmml" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.1">⋅</ci><cn id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.2.cmml" type="integer" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.2">2</cn><apply id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.3.cmml" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.3.1.cmml" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.3">superscript</csymbol><cn id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.3.2.cmml" type="integer" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.3.2">10</cn><apply id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.3.3.cmml" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.3.3"><minus id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.3.3.1.cmml" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.3.3"></minus><cn id="S4.SS4.SSS0.Px2.p1.2.m2.1.1.3.3.2.cmml" type="integer" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px2.p1.2.m2.1c">2\cdot 10^{-4}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS0.Px2.p1.2.m2.1d">2 ⋅ 10 start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math> for the Depth Transformer, also with a linear warmup. In order to ensure the updates from the text-only batches are balanced with those from the audio dataset, we use two separate optimizer states. In addition, when operating on the text stream from an audio batch, we multiply the learning rate for the text embedding and text linear layer by 0.75. Finally, as padding tokens are predominant for audio batches, we reduce their weight by 50% in the cross-entropy loss.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS4.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">Moshi post-training.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS4.SSS0.Px3.p1">
<p class="ltx_p" id="S4.SS4.SSS0.Px3.p1.4">Starting from the model obtained from the previous stage, we then train it to gain its multi-stream ability. First, we use PyAnnote&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Bredin, <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib8" title="">2023</a>)</cite> to diarize the audio from the unsupervised audio dataset. We sample one speaker at random, which will act as the main speaker, and derive a binary mask over the waveform, with a value of <math alttext="1" class="ltx_Math" display="inline" id="S4.SS4.SSS0.Px3.p1.1.m1.1"><semantics id="S4.SS4.SSS0.Px3.p1.1.m1.1a"><mn id="S4.SS4.SSS0.Px3.p1.1.m1.1.1" xref="S4.SS4.SSS0.Px3.p1.1.m1.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px3.p1.1.m1.1b"><cn id="S4.SS4.SSS0.Px3.p1.1.m1.1.1.cmml" type="integer" xref="S4.SS4.SSS0.Px3.p1.1.m1.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px3.p1.1.m1.1c">1</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS0.Px3.p1.1.m1.1d">1</annotation></semantics></math> when the speaker is active based on the diarization, and <math alttext="0" class="ltx_Math" display="inline" id="S4.SS4.SSS0.Px3.p1.2.m2.1"><semantics id="S4.SS4.SSS0.Px3.p1.2.m2.1a"><mn id="S4.SS4.SSS0.Px3.p1.2.m2.1.1" xref="S4.SS4.SSS0.Px3.p1.2.m2.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px3.p1.2.m2.1b"><cn id="S4.SS4.SSS0.Px3.p1.2.m2.1.1.cmml" type="integer" xref="S4.SS4.SSS0.Px3.p1.2.m2.1.1">0</cn></annotation-xml></semantics></math> otherwise. This mask provides us with two waveforms: one with the speaker, and one with the residual (potentially several speakers), which are encoded separately and then used as the two input audio streams described in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS4.SSS3" title="3.4.3 Multi-stream modeling ‣ 3.4 Generative Audio Modeling ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue">Section&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.4.3</span></span></a>. The text stream only contains the text tokens from the selected main speaker, and the delay between text and audio tokens is fixed to 0. We train for 100k steps, with a batch size of 8 hours of audio, and a fixed learning rate of <math alttext="3\cdot 10^{-6}" class="ltx_Math" display="inline" id="S4.SS4.SSS0.Px3.p1.3.m3.1"><semantics id="S4.SS4.SSS0.Px3.p1.3.m3.1a"><mrow id="S4.SS4.SSS0.Px3.p1.3.m3.1.1" xref="S4.SS4.SSS0.Px3.p1.3.m3.1.1.cmml"><mn id="S4.SS4.SSS0.Px3.p1.3.m3.1.1.2" xref="S4.SS4.SSS0.Px3.p1.3.m3.1.1.2.cmml">3</mn><mo id="S4.SS4.SSS0.Px3.p1.3.m3.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS4.SSS0.Px3.p1.3.m3.1.1.1.cmml">⋅</mo><msup id="S4.SS4.SSS0.Px3.p1.3.m3.1.1.3" xref="S4.SS4.SSS0.Px3.p1.3.m3.1.1.3.cmml"><mn id="S4.SS4.SSS0.Px3.p1.3.m3.1.1.3.2" xref="S4.SS4.SSS0.Px3.p1.3.m3.1.1.3.2.cmml">10</mn><mrow id="S4.SS4.SSS0.Px3.p1.3.m3.1.1.3.3" xref="S4.SS4.SSS0.Px3.p1.3.m3.1.1.3.3.cmml"><mo id="S4.SS4.SSS0.Px3.p1.3.m3.1.1.3.3a" xref="S4.SS4.SSS0.Px3.p1.3.m3.1.1.3.3.cmml">−</mo><mn id="S4.SS4.SSS0.Px3.p1.3.m3.1.1.3.3.2" xref="S4.SS4.SSS0.Px3.p1.3.m3.1.1.3.3.2.cmml">6</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px3.p1.3.m3.1b"><apply id="S4.SS4.SSS0.Px3.p1.3.m3.1.1.cmml" xref="S4.SS4.SSS0.Px3.p1.3.m3.1.1"><ci id="S4.SS4.SSS0.Px3.p1.3.m3.1.1.1.cmml" xref="S4.SS4.SSS0.Px3.p1.3.m3.1.1.1">⋅</ci><cn id="S4.SS4.SSS0.Px3.p1.3.m3.1.1.2.cmml" type="integer" xref="S4.SS4.SSS0.Px3.p1.3.m3.1.1.2">3</cn><apply id="S4.SS4.SSS0.Px3.p1.3.m3.1.1.3.cmml" xref="S4.SS4.SSS0.Px3.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px3.p1.3.m3.1.1.3.1.cmml" xref="S4.SS4.SSS0.Px3.p1.3.m3.1.1.3">superscript</csymbol><cn id="S4.SS4.SSS0.Px3.p1.3.m3.1.1.3.2.cmml" type="integer" xref="S4.SS4.SSS0.Px3.p1.3.m3.1.1.3.2">10</cn><apply id="S4.SS4.SSS0.Px3.p1.3.m3.1.1.3.3.cmml" xref="S4.SS4.SSS0.Px3.p1.3.m3.1.1.3.3"><minus id="S4.SS4.SSS0.Px3.p1.3.m3.1.1.3.3.1.cmml" xref="S4.SS4.SSS0.Px3.p1.3.m3.1.1.3.3"></minus><cn id="S4.SS4.SSS0.Px3.p1.3.m3.1.1.3.3.2.cmml" type="integer" xref="S4.SS4.SSS0.Px3.p1.3.m3.1.1.3.3.2">6</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px3.p1.3.m3.1c">3\cdot 10^{-6}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS0.Px3.p1.3.m3.1d">3 ⋅ 10 start_POSTSUPERSCRIPT - 6 end_POSTSUPERSCRIPT</annotation></semantics></math> for the Temporal Transformer, and <math alttext="5\cdot 10^{-5}" class="ltx_Math" display="inline" id="S4.SS4.SSS0.Px3.p1.4.m4.1"><semantics id="S4.SS4.SSS0.Px3.p1.4.m4.1a"><mrow id="S4.SS4.SSS0.Px3.p1.4.m4.1.1" xref="S4.SS4.SSS0.Px3.p1.4.m4.1.1.cmml"><mn id="S4.SS4.SSS0.Px3.p1.4.m4.1.1.2" xref="S4.SS4.SSS0.Px3.p1.4.m4.1.1.2.cmml">5</mn><mo id="S4.SS4.SSS0.Px3.p1.4.m4.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS4.SSS0.Px3.p1.4.m4.1.1.1.cmml">⋅</mo><msup id="S4.SS4.SSS0.Px3.p1.4.m4.1.1.3" xref="S4.SS4.SSS0.Px3.p1.4.m4.1.1.3.cmml"><mn id="S4.SS4.SSS0.Px3.p1.4.m4.1.1.3.2" xref="S4.SS4.SSS0.Px3.p1.4.m4.1.1.3.2.cmml">10</mn><mrow id="S4.SS4.SSS0.Px3.p1.4.m4.1.1.3.3" xref="S4.SS4.SSS0.Px3.p1.4.m4.1.1.3.3.cmml"><mo id="S4.SS4.SSS0.Px3.p1.4.m4.1.1.3.3a" xref="S4.SS4.SSS0.Px3.p1.4.m4.1.1.3.3.cmml">−</mo><mn id="S4.SS4.SSS0.Px3.p1.4.m4.1.1.3.3.2" xref="S4.SS4.SSS0.Px3.p1.4.m4.1.1.3.3.2.cmml">5</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px3.p1.4.m4.1b"><apply id="S4.SS4.SSS0.Px3.p1.4.m4.1.1.cmml" xref="S4.SS4.SSS0.Px3.p1.4.m4.1.1"><ci id="S4.SS4.SSS0.Px3.p1.4.m4.1.1.1.cmml" xref="S4.SS4.SSS0.Px3.p1.4.m4.1.1.1">⋅</ci><cn id="S4.SS4.SSS0.Px3.p1.4.m4.1.1.2.cmml" type="integer" xref="S4.SS4.SSS0.Px3.p1.4.m4.1.1.2">5</cn><apply id="S4.SS4.SSS0.Px3.p1.4.m4.1.1.3.cmml" xref="S4.SS4.SSS0.Px3.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px3.p1.4.m4.1.1.3.1.cmml" xref="S4.SS4.SSS0.Px3.p1.4.m4.1.1.3">superscript</csymbol><cn id="S4.SS4.SSS0.Px3.p1.4.m4.1.1.3.2.cmml" type="integer" xref="S4.SS4.SSS0.Px3.p1.4.m4.1.1.3.2">10</cn><apply id="S4.SS4.SSS0.Px3.p1.4.m4.1.1.3.3.cmml" xref="S4.SS4.SSS0.Px3.p1.4.m4.1.1.3.3"><minus id="S4.SS4.SSS0.Px3.p1.4.m4.1.1.3.3.1.cmml" xref="S4.SS4.SSS0.Px3.p1.4.m4.1.1.3.3"></minus><cn id="S4.SS4.SSS0.Px3.p1.4.m4.1.1.3.3.2.cmml" type="integer" xref="S4.SS4.SSS0.Px3.p1.4.m4.1.1.3.3.2">5</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px3.p1.4.m4.1c">5\cdot 10^{-5}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS0.Px3.p1.4.m4.1d">5 ⋅ 10 start_POSTSUPERSCRIPT - 5 end_POSTSUPERSCRIPT</annotation></semantics></math> for the Depth Transformer. Like for the pretraining phase, we sample full text-only batches 10% of the time.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS4.SSS0.Px4">
<h5 class="ltx_title ltx_title_paragraph">Moshi finetuning.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS4.SSS0.Px4.p1">
<p class="ltx_p" id="S4.SS4.SSS0.Px4.p1.2">The previously described simulated multi-stream provides a good pre-training task but is far from being sufficient to capture natural conversations: For instance, it contains no overlap, and the stream of an inactive speaker is perfectly silent. We then use the Fisher dataset&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Cieri et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib15" title="">2004</a>)</cite> to have the model learn real multi-stream interaction. We sample one of the two speakers to be the first (and main) speaker. We train for 10k batches, with a batch size of 40min of audio with a learning rate of <math alttext="2\cdot 10^{-6}" class="ltx_Math" display="inline" id="S4.SS4.SSS0.Px4.p1.1.m1.1"><semantics id="S4.SS4.SSS0.Px4.p1.1.m1.1a"><mrow id="S4.SS4.SSS0.Px4.p1.1.m1.1.1" xref="S4.SS4.SSS0.Px4.p1.1.m1.1.1.cmml"><mn id="S4.SS4.SSS0.Px4.p1.1.m1.1.1.2" xref="S4.SS4.SSS0.Px4.p1.1.m1.1.1.2.cmml">2</mn><mo id="S4.SS4.SSS0.Px4.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS4.SSS0.Px4.p1.1.m1.1.1.1.cmml">⋅</mo><msup id="S4.SS4.SSS0.Px4.p1.1.m1.1.1.3" xref="S4.SS4.SSS0.Px4.p1.1.m1.1.1.3.cmml"><mn id="S4.SS4.SSS0.Px4.p1.1.m1.1.1.3.2" xref="S4.SS4.SSS0.Px4.p1.1.m1.1.1.3.2.cmml">10</mn><mrow id="S4.SS4.SSS0.Px4.p1.1.m1.1.1.3.3" xref="S4.SS4.SSS0.Px4.p1.1.m1.1.1.3.3.cmml"><mo id="S4.SS4.SSS0.Px4.p1.1.m1.1.1.3.3a" xref="S4.SS4.SSS0.Px4.p1.1.m1.1.1.3.3.cmml">−</mo><mn id="S4.SS4.SSS0.Px4.p1.1.m1.1.1.3.3.2" xref="S4.SS4.SSS0.Px4.p1.1.m1.1.1.3.3.2.cmml">6</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px4.p1.1.m1.1b"><apply id="S4.SS4.SSS0.Px4.p1.1.m1.1.1.cmml" xref="S4.SS4.SSS0.Px4.p1.1.m1.1.1"><ci id="S4.SS4.SSS0.Px4.p1.1.m1.1.1.1.cmml" xref="S4.SS4.SSS0.Px4.p1.1.m1.1.1.1">⋅</ci><cn id="S4.SS4.SSS0.Px4.p1.1.m1.1.1.2.cmml" type="integer" xref="S4.SS4.SSS0.Px4.p1.1.m1.1.1.2">2</cn><apply id="S4.SS4.SSS0.Px4.p1.1.m1.1.1.3.cmml" xref="S4.SS4.SSS0.Px4.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px4.p1.1.m1.1.1.3.1.cmml" xref="S4.SS4.SSS0.Px4.p1.1.m1.1.1.3">superscript</csymbol><cn id="S4.SS4.SSS0.Px4.p1.1.m1.1.1.3.2.cmml" type="integer" xref="S4.SS4.SSS0.Px4.p1.1.m1.1.1.3.2">10</cn><apply id="S4.SS4.SSS0.Px4.p1.1.m1.1.1.3.3.cmml" xref="S4.SS4.SSS0.Px4.p1.1.m1.1.1.3.3"><minus id="S4.SS4.SSS0.Px4.p1.1.m1.1.1.3.3.1.cmml" xref="S4.SS4.SSS0.Px4.p1.1.m1.1.1.3.3"></minus><cn id="S4.SS4.SSS0.Px4.p1.1.m1.1.1.3.3.2.cmml" type="integer" xref="S4.SS4.SSS0.Px4.p1.1.m1.1.1.3.3.2">6</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px4.p1.1.m1.1c">2\cdot 10^{-6}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS0.Px4.p1.1.m1.1d">2 ⋅ 10 start_POSTSUPERSCRIPT - 6 end_POSTSUPERSCRIPT</annotation></semantics></math>/<math alttext="4\cdot 10^{-6}" class="ltx_Math" display="inline" id="S4.SS4.SSS0.Px4.p1.2.m2.1"><semantics id="S4.SS4.SSS0.Px4.p1.2.m2.1a"><mrow id="S4.SS4.SSS0.Px4.p1.2.m2.1.1" xref="S4.SS4.SSS0.Px4.p1.2.m2.1.1.cmml"><mn id="S4.SS4.SSS0.Px4.p1.2.m2.1.1.2" xref="S4.SS4.SSS0.Px4.p1.2.m2.1.1.2.cmml">4</mn><mo id="S4.SS4.SSS0.Px4.p1.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS4.SSS0.Px4.p1.2.m2.1.1.1.cmml">⋅</mo><msup id="S4.SS4.SSS0.Px4.p1.2.m2.1.1.3" xref="S4.SS4.SSS0.Px4.p1.2.m2.1.1.3.cmml"><mn id="S4.SS4.SSS0.Px4.p1.2.m2.1.1.3.2" xref="S4.SS4.SSS0.Px4.p1.2.m2.1.1.3.2.cmml">10</mn><mrow id="S4.SS4.SSS0.Px4.p1.2.m2.1.1.3.3" xref="S4.SS4.SSS0.Px4.p1.2.m2.1.1.3.3.cmml"><mo id="S4.SS4.SSS0.Px4.p1.2.m2.1.1.3.3a" xref="S4.SS4.SSS0.Px4.p1.2.m2.1.1.3.3.cmml">−</mo><mn id="S4.SS4.SSS0.Px4.p1.2.m2.1.1.3.3.2" xref="S4.SS4.SSS0.Px4.p1.2.m2.1.1.3.3.2.cmml">6</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px4.p1.2.m2.1b"><apply id="S4.SS4.SSS0.Px4.p1.2.m2.1.1.cmml" xref="S4.SS4.SSS0.Px4.p1.2.m2.1.1"><ci id="S4.SS4.SSS0.Px4.p1.2.m2.1.1.1.cmml" xref="S4.SS4.SSS0.Px4.p1.2.m2.1.1.1">⋅</ci><cn id="S4.SS4.SSS0.Px4.p1.2.m2.1.1.2.cmml" type="integer" xref="S4.SS4.SSS0.Px4.p1.2.m2.1.1.2">4</cn><apply id="S4.SS4.SSS0.Px4.p1.2.m2.1.1.3.cmml" xref="S4.SS4.SSS0.Px4.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px4.p1.2.m2.1.1.3.1.cmml" xref="S4.SS4.SSS0.Px4.p1.2.m2.1.1.3">superscript</csymbol><cn id="S4.SS4.SSS0.Px4.p1.2.m2.1.1.3.2.cmml" type="integer" xref="S4.SS4.SSS0.Px4.p1.2.m2.1.1.3.2">10</cn><apply id="S4.SS4.SSS0.Px4.p1.2.m2.1.1.3.3.cmml" xref="S4.SS4.SSS0.Px4.p1.2.m2.1.1.3.3"><minus id="S4.SS4.SSS0.Px4.p1.2.m2.1.1.3.3.1.cmml" xref="S4.SS4.SSS0.Px4.p1.2.m2.1.1.3.3"></minus><cn id="S4.SS4.SSS0.Px4.p1.2.m2.1.1.3.3.2.cmml" type="integer" xref="S4.SS4.SSS0.Px4.p1.2.m2.1.1.3.3.2">6</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px4.p1.2.m2.1c">4\cdot 10^{-6}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS0.Px4.p1.2.m2.1d">4 ⋅ 10 start_POSTSUPERSCRIPT - 6 end_POSTSUPERSCRIPT</annotation></semantics></math> for the main/Depth Transformer. We no longer sample full text batches.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S4.SS4.SSS0.Px4.p2">
<p class="ltx_p" id="S4.SS4.SSS0.Px4.p2.1">Finally, we set the speaker identity for the first speaker stream to be that of Moshi, a useful conversational assistant, with a final stage of instruct finetuning. We use the synthetic instruct dataset described in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S4.SS3" title="4.3 Speech-Text Instruct Data ‣ 4 Datasets and Training ‣ Moshi: a speech-text foundation model for real-time dialogue">Section&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.3</span></span></a>, with a batch size of 2.7 hours of audio, for 30k steps, with a learning rate of <math alttext="2\cdot 10^{-6}" class="ltx_Math" display="inline" id="S4.SS4.SSS0.Px4.p2.1.m1.1"><semantics id="S4.SS4.SSS0.Px4.p2.1.m1.1a"><mrow id="S4.SS4.SSS0.Px4.p2.1.m1.1.1" xref="S4.SS4.SSS0.Px4.p2.1.m1.1.1.cmml"><mn id="S4.SS4.SSS0.Px4.p2.1.m1.1.1.2" xref="S4.SS4.SSS0.Px4.p2.1.m1.1.1.2.cmml">2</mn><mo id="S4.SS4.SSS0.Px4.p2.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS4.SSS0.Px4.p2.1.m1.1.1.1.cmml">⋅</mo><msup id="S4.SS4.SSS0.Px4.p2.1.m1.1.1.3" xref="S4.SS4.SSS0.Px4.p2.1.m1.1.1.3.cmml"><mn id="S4.SS4.SSS0.Px4.p2.1.m1.1.1.3.2" xref="S4.SS4.SSS0.Px4.p2.1.m1.1.1.3.2.cmml">10</mn><mrow id="S4.SS4.SSS0.Px4.p2.1.m1.1.1.3.3" xref="S4.SS4.SSS0.Px4.p2.1.m1.1.1.3.3.cmml"><mo id="S4.SS4.SSS0.Px4.p2.1.m1.1.1.3.3a" xref="S4.SS4.SSS0.Px4.p2.1.m1.1.1.3.3.cmml">−</mo><mn id="S4.SS4.SSS0.Px4.p2.1.m1.1.1.3.3.2" xref="S4.SS4.SSS0.Px4.p2.1.m1.1.1.3.3.2.cmml">6</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px4.p2.1.m1.1b"><apply id="S4.SS4.SSS0.Px4.p2.1.m1.1.1.cmml" xref="S4.SS4.SSS0.Px4.p2.1.m1.1.1"><ci id="S4.SS4.SSS0.Px4.p2.1.m1.1.1.1.cmml" xref="S4.SS4.SSS0.Px4.p2.1.m1.1.1.1">⋅</ci><cn id="S4.SS4.SSS0.Px4.p2.1.m1.1.1.2.cmml" type="integer" xref="S4.SS4.SSS0.Px4.p2.1.m1.1.1.2">2</cn><apply id="S4.SS4.SSS0.Px4.p2.1.m1.1.1.3.cmml" xref="S4.SS4.SSS0.Px4.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px4.p2.1.m1.1.1.3.1.cmml" xref="S4.SS4.SSS0.Px4.p2.1.m1.1.1.3">superscript</csymbol><cn id="S4.SS4.SSS0.Px4.p2.1.m1.1.1.3.2.cmml" type="integer" xref="S4.SS4.SSS0.Px4.p2.1.m1.1.1.3.2">10</cn><apply id="S4.SS4.SSS0.Px4.p2.1.m1.1.1.3.3.cmml" xref="S4.SS4.SSS0.Px4.p2.1.m1.1.1.3.3"><minus id="S4.SS4.SSS0.Px4.p2.1.m1.1.1.3.3.1.cmml" xref="S4.SS4.SSS0.Px4.p2.1.m1.1.1.3.3"></minus><cn id="S4.SS4.SSS0.Px4.p2.1.m1.1.1.3.3.2.cmml" type="integer" xref="S4.SS4.SSS0.Px4.p2.1.m1.1.1.3.3.2">6</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px4.p2.1.m1.1c">2\cdot 10^{-6}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS0.Px4.p2.1.m1.1d">2 ⋅ 10 start_POSTSUPERSCRIPT - 6 end_POSTSUPERSCRIPT</annotation></semantics></math> for both transformers.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S4.SS4.SSS0.Px4.p3">
<p class="ltx_p" id="S4.SS4.SSS0.Px4.p3.2">During this stage, we perform data augmentation on the user’s stream to make Moshi robust to various situations. Namely, we apply a random gain to the user stream between -24 dB and +15 dB, 50% of the time. 30% of the time, we further add noise extracts from the Deep Noise Suppression challenge&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Dubey et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib25" title="">2023</a>)</cite> which we concatenate in order to cover the entire duration of each example. The noise is amplified to reach a target volume relative to the original source between -30 dB and +6 dB. Each time we need to sample a new noise, we alternatively use a silent section with a random duration up to 30 seconds of silence with probability of 50%, so that the model can handle the audio condition going from noisy to silent, and vice versa. We emulate echo from Moshi into the user’s microphone by adding a scaled down copy of Moshi’s stream into the user’s stream, scaled by as factor uniformly sampled in <math alttext="[0,0.2]" class="ltx_Math" display="inline" id="S4.SS4.SSS0.Px4.p3.1.m1.2"><semantics id="S4.SS4.SSS0.Px4.p3.1.m1.2a"><mrow id="S4.SS4.SSS0.Px4.p3.1.m1.2.3.2" xref="S4.SS4.SSS0.Px4.p3.1.m1.2.3.1.cmml"><mo id="S4.SS4.SSS0.Px4.p3.1.m1.2.3.2.1" stretchy="false" xref="S4.SS4.SSS0.Px4.p3.1.m1.2.3.1.cmml">[</mo><mn id="S4.SS4.SSS0.Px4.p3.1.m1.1.1" xref="S4.SS4.SSS0.Px4.p3.1.m1.1.1.cmml">0</mn><mo id="S4.SS4.SSS0.Px4.p3.1.m1.2.3.2.2" xref="S4.SS4.SSS0.Px4.p3.1.m1.2.3.1.cmml">,</mo><mn id="S4.SS4.SSS0.Px4.p3.1.m1.2.2" xref="S4.SS4.SSS0.Px4.p3.1.m1.2.2.cmml">0.2</mn><mo id="S4.SS4.SSS0.Px4.p3.1.m1.2.3.2.3" stretchy="false" xref="S4.SS4.SSS0.Px4.p3.1.m1.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px4.p3.1.m1.2b"><interval closure="closed" id="S4.SS4.SSS0.Px4.p3.1.m1.2.3.1.cmml" xref="S4.SS4.SSS0.Px4.p3.1.m1.2.3.2"><cn id="S4.SS4.SSS0.Px4.p3.1.m1.1.1.cmml" type="integer" xref="S4.SS4.SSS0.Px4.p3.1.m1.1.1">0</cn><cn id="S4.SS4.SSS0.Px4.p3.1.m1.2.2.cmml" type="float" xref="S4.SS4.SSS0.Px4.p3.1.m1.2.2">0.2</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px4.p3.1.m1.2c">[0,0.2]</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS0.Px4.p3.1.m1.2d">[ 0 , 0.2 ]</annotation></semantics></math>, and a delay uniformly sampled between <math alttext="[100\text{ms},500\text{ms}]" class="ltx_Math" display="inline" id="S4.SS4.SSS0.Px4.p3.2.m2.2"><semantics id="S4.SS4.SSS0.Px4.p3.2.m2.2a"><mrow id="S4.SS4.SSS0.Px4.p3.2.m2.2.2.2" xref="S4.SS4.SSS0.Px4.p3.2.m2.2.2.3.cmml"><mo id="S4.SS4.SSS0.Px4.p3.2.m2.2.2.2.3" stretchy="false" xref="S4.SS4.SSS0.Px4.p3.2.m2.2.2.3.cmml">[</mo><mrow id="S4.SS4.SSS0.Px4.p3.2.m2.1.1.1.1" xref="S4.SS4.SSS0.Px4.p3.2.m2.1.1.1.1.cmml"><mn id="S4.SS4.SSS0.Px4.p3.2.m2.1.1.1.1.2" xref="S4.SS4.SSS0.Px4.p3.2.m2.1.1.1.1.2.cmml">100</mn><mo id="S4.SS4.SSS0.Px4.p3.2.m2.1.1.1.1.1" xref="S4.SS4.SSS0.Px4.p3.2.m2.1.1.1.1.1.cmml">⁢</mo><mtext id="S4.SS4.SSS0.Px4.p3.2.m2.1.1.1.1.3" xref="S4.SS4.SSS0.Px4.p3.2.m2.1.1.1.1.3a.cmml">ms</mtext></mrow><mo id="S4.SS4.SSS0.Px4.p3.2.m2.2.2.2.4" xref="S4.SS4.SSS0.Px4.p3.2.m2.2.2.3.cmml">,</mo><mrow id="S4.SS4.SSS0.Px4.p3.2.m2.2.2.2.2" xref="S4.SS4.SSS0.Px4.p3.2.m2.2.2.2.2.cmml"><mn id="S4.SS4.SSS0.Px4.p3.2.m2.2.2.2.2.2" xref="S4.SS4.SSS0.Px4.p3.2.m2.2.2.2.2.2.cmml">500</mn><mo id="S4.SS4.SSS0.Px4.p3.2.m2.2.2.2.2.1" xref="S4.SS4.SSS0.Px4.p3.2.m2.2.2.2.2.1.cmml">⁢</mo><mtext id="S4.SS4.SSS0.Px4.p3.2.m2.2.2.2.2.3" xref="S4.SS4.SSS0.Px4.p3.2.m2.2.2.2.2.3a.cmml">ms</mtext></mrow><mo id="S4.SS4.SSS0.Px4.p3.2.m2.2.2.2.5" stretchy="false" xref="S4.SS4.SSS0.Px4.p3.2.m2.2.2.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px4.p3.2.m2.2b"><interval closure="closed" id="S4.SS4.SSS0.Px4.p3.2.m2.2.2.3.cmml" xref="S4.SS4.SSS0.Px4.p3.2.m2.2.2.2"><apply id="S4.SS4.SSS0.Px4.p3.2.m2.1.1.1.1.cmml" xref="S4.SS4.SSS0.Px4.p3.2.m2.1.1.1.1"><times id="S4.SS4.SSS0.Px4.p3.2.m2.1.1.1.1.1.cmml" xref="S4.SS4.SSS0.Px4.p3.2.m2.1.1.1.1.1"></times><cn id="S4.SS4.SSS0.Px4.p3.2.m2.1.1.1.1.2.cmml" type="integer" xref="S4.SS4.SSS0.Px4.p3.2.m2.1.1.1.1.2">100</cn><ci id="S4.SS4.SSS0.Px4.p3.2.m2.1.1.1.1.3a.cmml" xref="S4.SS4.SSS0.Px4.p3.2.m2.1.1.1.1.3"><mtext id="S4.SS4.SSS0.Px4.p3.2.m2.1.1.1.1.3.cmml" xref="S4.SS4.SSS0.Px4.p3.2.m2.1.1.1.1.3">ms</mtext></ci></apply><apply id="S4.SS4.SSS0.Px4.p3.2.m2.2.2.2.2.cmml" xref="S4.SS4.SSS0.Px4.p3.2.m2.2.2.2.2"><times id="S4.SS4.SSS0.Px4.p3.2.m2.2.2.2.2.1.cmml" xref="S4.SS4.SSS0.Px4.p3.2.m2.2.2.2.2.1"></times><cn id="S4.SS4.SSS0.Px4.p3.2.m2.2.2.2.2.2.cmml" type="integer" xref="S4.SS4.SSS0.Px4.p3.2.m2.2.2.2.2.2">500</cn><ci id="S4.SS4.SSS0.Px4.p3.2.m2.2.2.2.2.3a.cmml" xref="S4.SS4.SSS0.Px4.p3.2.m2.2.2.2.2.3"><mtext id="S4.SS4.SSS0.Px4.p3.2.m2.2.2.2.2.3.cmml" xref="S4.SS4.SSS0.Px4.p3.2.m2.2.2.2.2.3">ms</mtext></ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px4.p3.2.m2.2c">[100\text{ms},500\text{ms}]</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS0.Px4.p3.2.m2.2d">[ 100 ms , 500 ms ]</annotation></semantics></math>. Finally, we apply to the user’s stream, potentially augmented with the echo, a reverb-like augmentation as introduced by&nbsp;<cite class="ltx_cite ltx_citemacro_citet">Defossez et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib20" title="">2020</a>)</cite>. The echo and reverb are applied together with a probability of 30%.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS4.SSS0.Px5">
<h5 class="ltx_title ltx_title_paragraph">TTS Training.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS4.SSS0.Px5.p1">
<p class="ltx_p" id="S4.SS4.SSS0.Px5.p1.1">We also train a streaming, multi-stream text-to-speech model, using the method described in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS4.SSS4" title="3.4.4 Inner Monologue ‣ 3.4 Generative Audio Modeling ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue">Section&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.4.4</span></span></a>. The audio pre-training stage is shared with Moshi, while the post-training is completed using a delay of 2 seconds for the audio stream compared to the text. The model is finetuned on the supervised multi-stream dataset containing high quality recording of interactions between two speakers. It is used to generate the synthetic finetuning instruct dataset described in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S4.SS3" title="4.3 Speech-Text Instruct Data ‣ 4 Datasets and Training ‣ Moshi: a speech-text foundation model for real-time dialogue">Section&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.3</span></span></a>. Note that Moshi itself is not trained on the supervised multi-stream dataset. Further details are provided in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#A3" title="Appendix C Delayed text LM as a zero-shot streaming ASR and TTS ‣ Moshi: a speech-text foundation model for real-time dialogue">Appendix&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">C</span></span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS4.SSS0.Px6">
<h5 class="ltx_title ltx_title_paragraph">Training loss.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS4.SSS0.Px6.p1">
<p class="ltx_p" id="S4.SS4.SSS0.Px6.p1.3">Moshi is trained to model joint sequences, as presented in eq.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.E6" title="In Joint sequence modeling for Moshi. ‣ 3.4.4 Inner Monologue ‣ 3.4 Generative Audio Modeling ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_tag">6</span></a>. Given the ground-truth discrete token <math alttext="(V_{s,k})_{s\leq S,k\leq K}" class="ltx_Math" display="inline" id="S4.SS4.SSS0.Px6.p1.1.m1.5"><semantics id="S4.SS4.SSS0.Px6.p1.1.m1.5a"><msub id="S4.SS4.SSS0.Px6.p1.1.m1.5.5" xref="S4.SS4.SSS0.Px6.p1.1.m1.5.5.cmml"><mrow id="S4.SS4.SSS0.Px6.p1.1.m1.5.5.1.1" xref="S4.SS4.SSS0.Px6.p1.1.m1.5.5.1.1.1.cmml"><mo id="S4.SS4.SSS0.Px6.p1.1.m1.5.5.1.1.2" stretchy="false" xref="S4.SS4.SSS0.Px6.p1.1.m1.5.5.1.1.1.cmml">(</mo><msub id="S4.SS4.SSS0.Px6.p1.1.m1.5.5.1.1.1" xref="S4.SS4.SSS0.Px6.p1.1.m1.5.5.1.1.1.cmml"><mi id="S4.SS4.SSS0.Px6.p1.1.m1.5.5.1.1.1.2" xref="S4.SS4.SSS0.Px6.p1.1.m1.5.5.1.1.1.2.cmml">V</mi><mrow id="S4.SS4.SSS0.Px6.p1.1.m1.2.2.2.4" xref="S4.SS4.SSS0.Px6.p1.1.m1.2.2.2.3.cmml"><mi id="S4.SS4.SSS0.Px6.p1.1.m1.1.1.1.1" xref="S4.SS4.SSS0.Px6.p1.1.m1.1.1.1.1.cmml">s</mi><mo id="S4.SS4.SSS0.Px6.p1.1.m1.2.2.2.4.1" xref="S4.SS4.SSS0.Px6.p1.1.m1.2.2.2.3.cmml">,</mo><mi id="S4.SS4.SSS0.Px6.p1.1.m1.2.2.2.2" xref="S4.SS4.SSS0.Px6.p1.1.m1.2.2.2.2.cmml">k</mi></mrow></msub><mo id="S4.SS4.SSS0.Px6.p1.1.m1.5.5.1.1.3" stretchy="false" xref="S4.SS4.SSS0.Px6.p1.1.m1.5.5.1.1.1.cmml">)</mo></mrow><mrow id="S4.SS4.SSS0.Px6.p1.1.m1.4.4.2.2" xref="S4.SS4.SSS0.Px6.p1.1.m1.4.4.2.3.cmml"><mrow id="S4.SS4.SSS0.Px6.p1.1.m1.3.3.1.1.1" xref="S4.SS4.SSS0.Px6.p1.1.m1.3.3.1.1.1.cmml"><mi id="S4.SS4.SSS0.Px6.p1.1.m1.3.3.1.1.1.2" xref="S4.SS4.SSS0.Px6.p1.1.m1.3.3.1.1.1.2.cmml">s</mi><mo id="S4.SS4.SSS0.Px6.p1.1.m1.3.3.1.1.1.1" xref="S4.SS4.SSS0.Px6.p1.1.m1.3.3.1.1.1.1.cmml">≤</mo><mi id="S4.SS4.SSS0.Px6.p1.1.m1.3.3.1.1.1.3" xref="S4.SS4.SSS0.Px6.p1.1.m1.3.3.1.1.1.3.cmml">S</mi></mrow><mo id="S4.SS4.SSS0.Px6.p1.1.m1.4.4.2.2.3" xref="S4.SS4.SSS0.Px6.p1.1.m1.4.4.2.3a.cmml">,</mo><mrow id="S4.SS4.SSS0.Px6.p1.1.m1.4.4.2.2.2" xref="S4.SS4.SSS0.Px6.p1.1.m1.4.4.2.2.2.cmml"><mi id="S4.SS4.SSS0.Px6.p1.1.m1.4.4.2.2.2.2" xref="S4.SS4.SSS0.Px6.p1.1.m1.4.4.2.2.2.2.cmml">k</mi><mo id="S4.SS4.SSS0.Px6.p1.1.m1.4.4.2.2.2.1" xref="S4.SS4.SSS0.Px6.p1.1.m1.4.4.2.2.2.1.cmml">≤</mo><mi id="S4.SS4.SSS0.Px6.p1.1.m1.4.4.2.2.2.3" xref="S4.SS4.SSS0.Px6.p1.1.m1.4.4.2.2.2.3.cmml">K</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px6.p1.1.m1.5b"><apply id="S4.SS4.SSS0.Px6.p1.1.m1.5.5.cmml" xref="S4.SS4.SSS0.Px6.p1.1.m1.5.5"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px6.p1.1.m1.5.5.2.cmml" xref="S4.SS4.SSS0.Px6.p1.1.m1.5.5">subscript</csymbol><apply id="S4.SS4.SSS0.Px6.p1.1.m1.5.5.1.1.1.cmml" xref="S4.SS4.SSS0.Px6.p1.1.m1.5.5.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px6.p1.1.m1.5.5.1.1.1.1.cmml" xref="S4.SS4.SSS0.Px6.p1.1.m1.5.5.1.1">subscript</csymbol><ci id="S4.SS4.SSS0.Px6.p1.1.m1.5.5.1.1.1.2.cmml" xref="S4.SS4.SSS0.Px6.p1.1.m1.5.5.1.1.1.2">𝑉</ci><list id="S4.SS4.SSS0.Px6.p1.1.m1.2.2.2.3.cmml" xref="S4.SS4.SSS0.Px6.p1.1.m1.2.2.2.4"><ci id="S4.SS4.SSS0.Px6.p1.1.m1.1.1.1.1.cmml" xref="S4.SS4.SSS0.Px6.p1.1.m1.1.1.1.1">𝑠</ci><ci id="S4.SS4.SSS0.Px6.p1.1.m1.2.2.2.2.cmml" xref="S4.SS4.SSS0.Px6.p1.1.m1.2.2.2.2">𝑘</ci></list></apply><apply id="S4.SS4.SSS0.Px6.p1.1.m1.4.4.2.3.cmml" xref="S4.SS4.SSS0.Px6.p1.1.m1.4.4.2.2"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px6.p1.1.m1.4.4.2.3a.cmml" xref="S4.SS4.SSS0.Px6.p1.1.m1.4.4.2.2.3">formulae-sequence</csymbol><apply id="S4.SS4.SSS0.Px6.p1.1.m1.3.3.1.1.1.cmml" xref="S4.SS4.SSS0.Px6.p1.1.m1.3.3.1.1.1"><leq id="S4.SS4.SSS0.Px6.p1.1.m1.3.3.1.1.1.1.cmml" xref="S4.SS4.SSS0.Px6.p1.1.m1.3.3.1.1.1.1"></leq><ci id="S4.SS4.SSS0.Px6.p1.1.m1.3.3.1.1.1.2.cmml" xref="S4.SS4.SSS0.Px6.p1.1.m1.3.3.1.1.1.2">𝑠</ci><ci id="S4.SS4.SSS0.Px6.p1.1.m1.3.3.1.1.1.3.cmml" xref="S4.SS4.SSS0.Px6.p1.1.m1.3.3.1.1.1.3">𝑆</ci></apply><apply id="S4.SS4.SSS0.Px6.p1.1.m1.4.4.2.2.2.cmml" xref="S4.SS4.SSS0.Px6.p1.1.m1.4.4.2.2.2"><leq id="S4.SS4.SSS0.Px6.p1.1.m1.4.4.2.2.2.1.cmml" xref="S4.SS4.SSS0.Px6.p1.1.m1.4.4.2.2.2.1"></leq><ci id="S4.SS4.SSS0.Px6.p1.1.m1.4.4.2.2.2.2.cmml" xref="S4.SS4.SSS0.Px6.p1.1.m1.4.4.2.2.2.2">𝑘</ci><ci id="S4.SS4.SSS0.Px6.p1.1.m1.4.4.2.2.2.3.cmml" xref="S4.SS4.SSS0.Px6.p1.1.m1.4.4.2.2.2.3">𝐾</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px6.p1.1.m1.5c">(V_{s,k})_{s\leq S,k\leq K}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS0.Px6.p1.1.m1.5d">( italic_V start_POSTSUBSCRIPT italic_s , italic_k end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_s ≤ italic_S , italic_k ≤ italic_K end_POSTSUBSCRIPT</annotation></semantics></math>,
and the estimated logits <math alttext="(l_{s,k})_{s\leq S,k\leq K}" class="ltx_Math" display="inline" id="S4.SS4.SSS0.Px6.p1.2.m2.5"><semantics id="S4.SS4.SSS0.Px6.p1.2.m2.5a"><msub id="S4.SS4.SSS0.Px6.p1.2.m2.5.5" xref="S4.SS4.SSS0.Px6.p1.2.m2.5.5.cmml"><mrow id="S4.SS4.SSS0.Px6.p1.2.m2.5.5.1.1" xref="S4.SS4.SSS0.Px6.p1.2.m2.5.5.1.1.1.cmml"><mo id="S4.SS4.SSS0.Px6.p1.2.m2.5.5.1.1.2" stretchy="false" xref="S4.SS4.SSS0.Px6.p1.2.m2.5.5.1.1.1.cmml">(</mo><msub id="S4.SS4.SSS0.Px6.p1.2.m2.5.5.1.1.1" xref="S4.SS4.SSS0.Px6.p1.2.m2.5.5.1.1.1.cmml"><mi id="S4.SS4.SSS0.Px6.p1.2.m2.5.5.1.1.1.2" xref="S4.SS4.SSS0.Px6.p1.2.m2.5.5.1.1.1.2.cmml">l</mi><mrow id="S4.SS4.SSS0.Px6.p1.2.m2.2.2.2.4" xref="S4.SS4.SSS0.Px6.p1.2.m2.2.2.2.3.cmml"><mi id="S4.SS4.SSS0.Px6.p1.2.m2.1.1.1.1" xref="S4.SS4.SSS0.Px6.p1.2.m2.1.1.1.1.cmml">s</mi><mo id="S4.SS4.SSS0.Px6.p1.2.m2.2.2.2.4.1" xref="S4.SS4.SSS0.Px6.p1.2.m2.2.2.2.3.cmml">,</mo><mi id="S4.SS4.SSS0.Px6.p1.2.m2.2.2.2.2" xref="S4.SS4.SSS0.Px6.p1.2.m2.2.2.2.2.cmml">k</mi></mrow></msub><mo id="S4.SS4.SSS0.Px6.p1.2.m2.5.5.1.1.3" stretchy="false" xref="S4.SS4.SSS0.Px6.p1.2.m2.5.5.1.1.1.cmml">)</mo></mrow><mrow id="S4.SS4.SSS0.Px6.p1.2.m2.4.4.2.2" xref="S4.SS4.SSS0.Px6.p1.2.m2.4.4.2.3.cmml"><mrow id="S4.SS4.SSS0.Px6.p1.2.m2.3.3.1.1.1" xref="S4.SS4.SSS0.Px6.p1.2.m2.3.3.1.1.1.cmml"><mi id="S4.SS4.SSS0.Px6.p1.2.m2.3.3.1.1.1.2" xref="S4.SS4.SSS0.Px6.p1.2.m2.3.3.1.1.1.2.cmml">s</mi><mo id="S4.SS4.SSS0.Px6.p1.2.m2.3.3.1.1.1.1" xref="S4.SS4.SSS0.Px6.p1.2.m2.3.3.1.1.1.1.cmml">≤</mo><mi id="S4.SS4.SSS0.Px6.p1.2.m2.3.3.1.1.1.3" xref="S4.SS4.SSS0.Px6.p1.2.m2.3.3.1.1.1.3.cmml">S</mi></mrow><mo id="S4.SS4.SSS0.Px6.p1.2.m2.4.4.2.2.3" xref="S4.SS4.SSS0.Px6.p1.2.m2.4.4.2.3a.cmml">,</mo><mrow id="S4.SS4.SSS0.Px6.p1.2.m2.4.4.2.2.2" xref="S4.SS4.SSS0.Px6.p1.2.m2.4.4.2.2.2.cmml"><mi id="S4.SS4.SSS0.Px6.p1.2.m2.4.4.2.2.2.2" xref="S4.SS4.SSS0.Px6.p1.2.m2.4.4.2.2.2.2.cmml">k</mi><mo id="S4.SS4.SSS0.Px6.p1.2.m2.4.4.2.2.2.1" xref="S4.SS4.SSS0.Px6.p1.2.m2.4.4.2.2.2.1.cmml">≤</mo><mi id="S4.SS4.SSS0.Px6.p1.2.m2.4.4.2.2.2.3" xref="S4.SS4.SSS0.Px6.p1.2.m2.4.4.2.2.2.3.cmml">K</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px6.p1.2.m2.5b"><apply id="S4.SS4.SSS0.Px6.p1.2.m2.5.5.cmml" xref="S4.SS4.SSS0.Px6.p1.2.m2.5.5"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px6.p1.2.m2.5.5.2.cmml" xref="S4.SS4.SSS0.Px6.p1.2.m2.5.5">subscript</csymbol><apply id="S4.SS4.SSS0.Px6.p1.2.m2.5.5.1.1.1.cmml" xref="S4.SS4.SSS0.Px6.p1.2.m2.5.5.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px6.p1.2.m2.5.5.1.1.1.1.cmml" xref="S4.SS4.SSS0.Px6.p1.2.m2.5.5.1.1">subscript</csymbol><ci id="S4.SS4.SSS0.Px6.p1.2.m2.5.5.1.1.1.2.cmml" xref="S4.SS4.SSS0.Px6.p1.2.m2.5.5.1.1.1.2">𝑙</ci><list id="S4.SS4.SSS0.Px6.p1.2.m2.2.2.2.3.cmml" xref="S4.SS4.SSS0.Px6.p1.2.m2.2.2.2.4"><ci id="S4.SS4.SSS0.Px6.p1.2.m2.1.1.1.1.cmml" xref="S4.SS4.SSS0.Px6.p1.2.m2.1.1.1.1">𝑠</ci><ci id="S4.SS4.SSS0.Px6.p1.2.m2.2.2.2.2.cmml" xref="S4.SS4.SSS0.Px6.p1.2.m2.2.2.2.2">𝑘</ci></list></apply><apply id="S4.SS4.SSS0.Px6.p1.2.m2.4.4.2.3.cmml" xref="S4.SS4.SSS0.Px6.p1.2.m2.4.4.2.2"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px6.p1.2.m2.4.4.2.3a.cmml" xref="S4.SS4.SSS0.Px6.p1.2.m2.4.4.2.2.3">formulae-sequence</csymbol><apply id="S4.SS4.SSS0.Px6.p1.2.m2.3.3.1.1.1.cmml" xref="S4.SS4.SSS0.Px6.p1.2.m2.3.3.1.1.1"><leq id="S4.SS4.SSS0.Px6.p1.2.m2.3.3.1.1.1.1.cmml" xref="S4.SS4.SSS0.Px6.p1.2.m2.3.3.1.1.1.1"></leq><ci id="S4.SS4.SSS0.Px6.p1.2.m2.3.3.1.1.1.2.cmml" xref="S4.SS4.SSS0.Px6.p1.2.m2.3.3.1.1.1.2">𝑠</ci><ci id="S4.SS4.SSS0.Px6.p1.2.m2.3.3.1.1.1.3.cmml" xref="S4.SS4.SSS0.Px6.p1.2.m2.3.3.1.1.1.3">𝑆</ci></apply><apply id="S4.SS4.SSS0.Px6.p1.2.m2.4.4.2.2.2.cmml" xref="S4.SS4.SSS0.Px6.p1.2.m2.4.4.2.2.2"><leq id="S4.SS4.SSS0.Px6.p1.2.m2.4.4.2.2.2.1.cmml" xref="S4.SS4.SSS0.Px6.p1.2.m2.4.4.2.2.2.1"></leq><ci id="S4.SS4.SSS0.Px6.p1.2.m2.4.4.2.2.2.2.cmml" xref="S4.SS4.SSS0.Px6.p1.2.m2.4.4.2.2.2.2">𝑘</ci><ci id="S4.SS4.SSS0.Px6.p1.2.m2.4.4.2.2.2.3.cmml" xref="S4.SS4.SSS0.Px6.p1.2.m2.4.4.2.2.2.3">𝐾</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px6.p1.2.m2.5c">(l_{s,k})_{s\leq S,k\leq K}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS0.Px6.p1.2.m2.5d">( italic_l start_POSTSUBSCRIPT italic_s , italic_k end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_s ≤ italic_S , italic_k ≤ italic_K end_POSTSUBSCRIPT</annotation></semantics></math> from eq.<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.E2" title="In RQ-Transformer. ‣ 3.4.1 Hierarchical autoregressive modeling with RQ-Transformer ‣ 3.4 Generative Audio Modeling ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_tag">2</span></a>, we use the following loss, with <math alttext="\mathrm{CE}" class="ltx_Math" display="inline" id="S4.SS4.SSS0.Px6.p1.3.m3.1"><semantics id="S4.SS4.SSS0.Px6.p1.3.m3.1a"><mi id="S4.SS4.SSS0.Px6.p1.3.m3.1.1" xref="S4.SS4.SSS0.Px6.p1.3.m3.1.1.cmml">CE</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px6.p1.3.m3.1b"><ci id="S4.SS4.SSS0.Px6.p1.3.m3.1.1.cmml" xref="S4.SS4.SSS0.Px6.p1.3.m3.1.1">CE</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px6.p1.3.m3.1c">\mathrm{CE}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS0.Px6.p1.3.m3.1d">roman_CE</annotation></semantics></math> the cross entropy,</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S4.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="L(V,l)=\frac{1}{S}\sum_{s=1}^{S}\left(\mathrm{CE}(l_{s,1},V_{s,1})+\frac{1}{%
\sum_{k=2}^{K}\alpha_{k}}\sum_{k=2}^{K}\alpha_{k}\mathrm{CE}(l_{s,k},V_{s,k})%
\right)." class="ltx_Math" display="block" id="S4.E7.m1.11"><semantics id="S4.E7.m1.11a"><mrow id="S4.E7.m1.11.11.1" xref="S4.E7.m1.11.11.1.1.cmml"><mrow id="S4.E7.m1.11.11.1.1" xref="S4.E7.m1.11.11.1.1.cmml"><mrow id="S4.E7.m1.11.11.1.1.3" xref="S4.E7.m1.11.11.1.1.3.cmml"><mi id="S4.E7.m1.11.11.1.1.3.2" xref="S4.E7.m1.11.11.1.1.3.2.cmml">L</mi><mo id="S4.E7.m1.11.11.1.1.3.1" xref="S4.E7.m1.11.11.1.1.3.1.cmml">⁢</mo><mrow id="S4.E7.m1.11.11.1.1.3.3.2" xref="S4.E7.m1.11.11.1.1.3.3.1.cmml"><mo id="S4.E7.m1.11.11.1.1.3.3.2.1" stretchy="false" xref="S4.E7.m1.11.11.1.1.3.3.1.cmml">(</mo><mi id="S4.E7.m1.9.9" xref="S4.E7.m1.9.9.cmml">V</mi><mo id="S4.E7.m1.11.11.1.1.3.3.2.2" xref="S4.E7.m1.11.11.1.1.3.3.1.cmml">,</mo><mi id="S4.E7.m1.10.10" xref="S4.E7.m1.10.10.cmml">l</mi><mo id="S4.E7.m1.11.11.1.1.3.3.2.3" stretchy="false" xref="S4.E7.m1.11.11.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo id="S4.E7.m1.11.11.1.1.2" xref="S4.E7.m1.11.11.1.1.2.cmml">=</mo><mrow id="S4.E7.m1.11.11.1.1.1" xref="S4.E7.m1.11.11.1.1.1.cmml"><mfrac id="S4.E7.m1.11.11.1.1.1.3" xref="S4.E7.m1.11.11.1.1.1.3.cmml"><mn id="S4.E7.m1.11.11.1.1.1.3.2" xref="S4.E7.m1.11.11.1.1.1.3.2.cmml">1</mn><mi id="S4.E7.m1.11.11.1.1.1.3.3" xref="S4.E7.m1.11.11.1.1.1.3.3.cmml">S</mi></mfrac><mo id="S4.E7.m1.11.11.1.1.1.2" xref="S4.E7.m1.11.11.1.1.1.2.cmml">⁢</mo><mrow id="S4.E7.m1.11.11.1.1.1.1" xref="S4.E7.m1.11.11.1.1.1.1.cmml"><munderover id="S4.E7.m1.11.11.1.1.1.1.2" xref="S4.E7.m1.11.11.1.1.1.1.2.cmml"><mo id="S4.E7.m1.11.11.1.1.1.1.2.2.2" movablelimits="false" rspace="0em" xref="S4.E7.m1.11.11.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E7.m1.11.11.1.1.1.1.2.2.3" xref="S4.E7.m1.11.11.1.1.1.1.2.2.3.cmml"><mi id="S4.E7.m1.11.11.1.1.1.1.2.2.3.2" xref="S4.E7.m1.11.11.1.1.1.1.2.2.3.2.cmml">s</mi><mo id="S4.E7.m1.11.11.1.1.1.1.2.2.3.1" xref="S4.E7.m1.11.11.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S4.E7.m1.11.11.1.1.1.1.2.2.3.3" xref="S4.E7.m1.11.11.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.E7.m1.11.11.1.1.1.1.2.3" xref="S4.E7.m1.11.11.1.1.1.1.2.3.cmml">S</mi></munderover><mrow id="S4.E7.m1.11.11.1.1.1.1.1.1" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.cmml"><mo id="S4.E7.m1.11.11.1.1.1.1.1.1.2" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E7.m1.11.11.1.1.1.1.1.1.1" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.cmml"><mrow id="S4.E7.m1.11.11.1.1.1.1.1.1.1.2" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E7.m1.11.11.1.1.1.1.1.1.1.2.4" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.2.4.cmml">CE</mi><mo id="S4.E7.m1.11.11.1.1.1.1.1.1.1.2.3" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.2.3.cmml">⁢</mo><mrow id="S4.E7.m1.11.11.1.1.1.1.1.1.1.2.2.2" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.2.2.3.cmml"><mo id="S4.E7.m1.11.11.1.1.1.1.1.1.1.2.2.2.3" stretchy="false" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.2.2.3.cmml">(</mo><msub id="S4.E7.m1.11.11.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E7.m1.11.11.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.1.1.1.1.2.cmml">l</mi><mrow id="S4.E7.m1.2.2.2.4" xref="S4.E7.m1.2.2.2.3.cmml"><mi id="S4.E7.m1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.cmml">s</mi><mo id="S4.E7.m1.2.2.2.4.1" xref="S4.E7.m1.2.2.2.3.cmml">,</mo><mn id="S4.E7.m1.2.2.2.2" xref="S4.E7.m1.2.2.2.2.cmml">1</mn></mrow></msub><mo id="S4.E7.m1.11.11.1.1.1.1.1.1.1.2.2.2.4" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.2.2.3.cmml">,</mo><msub id="S4.E7.m1.11.11.1.1.1.1.1.1.1.2.2.2.2" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="S4.E7.m1.11.11.1.1.1.1.1.1.1.2.2.2.2.2" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.2.2.2.2.2.cmml">V</mi><mrow id="S4.E7.m1.4.4.2.4" xref="S4.E7.m1.4.4.2.3.cmml"><mi id="S4.E7.m1.3.3.1.1" xref="S4.E7.m1.3.3.1.1.cmml">s</mi><mo id="S4.E7.m1.4.4.2.4.1" xref="S4.E7.m1.4.4.2.3.cmml">,</mo><mn id="S4.E7.m1.4.4.2.2" xref="S4.E7.m1.4.4.2.2.cmml">1</mn></mrow></msub><mo id="S4.E7.m1.11.11.1.1.1.1.1.1.1.2.2.2.5" stretchy="false" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E7.m1.11.11.1.1.1.1.1.1.1.5" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.5.cmml">+</mo><mrow id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.cmml"><mfrac id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.cmml"><mn id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.2" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.2.cmml">1</mn><mrow id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.3" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.3.cmml"><msubsup id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.3.1" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.3.1.cmml"><mo id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.3.1.2.2" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.3.1.2.2.cmml">∑</mo><mrow id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.3.1.2.3" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.3.1.2.3.cmml"><mi id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.3.1.2.3.2" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.3.1.2.3.2.cmml">k</mi><mo id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.3.1.2.3.1" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.3.1.2.3.1.cmml">=</mo><mn id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.3.1.2.3.3" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.3.1.2.3.3.cmml">2</mn></mrow><mi id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.3.1.3" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.3.1.3.cmml">K</mi></msubsup><msub id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.3.2" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.3.2.cmml"><mi id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.3.2.2" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.3.2.2.cmml">α</mi><mi id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.3.2.3" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.3.2.3.cmml">k</mi></msub></mrow></mfrac><mo id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.3" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.3.cmml">⁢</mo><mrow id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.cmml"><munderover id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.3" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.3.cmml"><mo id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.3.2.2" movablelimits="false" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.3.2.2.cmml">∑</mo><mrow id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.3.2.3" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.3.2.3.cmml"><mi id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.3.2.3.2" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.3.2.3.2.cmml">k</mi><mo id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.3.2.3.1" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.3.2.3.1.cmml">=</mo><mn id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.3.2.3.3" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.3.2.3.3.cmml">2</mn></mrow><mi id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.3.3" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.3.3.cmml">K</mi></munderover><mrow id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.2" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.2.cmml"><msub id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.2.4" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.2.4.cmml"><mi id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.2.4.2" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.2.4.2.cmml">α</mi><mi id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.2.4.3" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.2.4.3.cmml">k</mi></msub><mo id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.2.3" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.2.3.cmml">⁢</mo><mi id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.2.5" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.2.5.cmml">CE</mi><mo id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.2.3a" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.2.3.cmml">⁢</mo><mrow id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.2.2.2" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.2.2.3.cmml"><mo id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.2.2.2.3" stretchy="false" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.2.2.3.cmml">(</mo><msub id="S4.E7.m1.11.11.1.1.1.1.1.1.1.3.1.1.1.1.1" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.3.1.1.1.1.1.cmml"><mi id="S4.E7.m1.11.11.1.1.1.1.1.1.1.3.1.1.1.1.1.2" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.3.1.1.1.1.1.2.cmml">l</mi><mrow id="S4.E7.m1.6.6.2.4" xref="S4.E7.m1.6.6.2.3.cmml"><mi id="S4.E7.m1.5.5.1.1" xref="S4.E7.m1.5.5.1.1.cmml">s</mi><mo id="S4.E7.m1.6.6.2.4.1" xref="S4.E7.m1.6.6.2.3.cmml">,</mo><mi id="S4.E7.m1.6.6.2.2" xref="S4.E7.m1.6.6.2.2.cmml">k</mi></mrow></msub><mo id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.2.2.2.4" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.2.2.3.cmml">,</mo><msub id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.2.2.2.2" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.2.2.2.2.cmml"><mi id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.2.2.2.2.2" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.2.2.2.2.2.cmml">V</mi><mrow id="S4.E7.m1.8.8.2.4" xref="S4.E7.m1.8.8.2.3.cmml"><mi id="S4.E7.m1.7.7.1.1" xref="S4.E7.m1.7.7.1.1.cmml">s</mi><mo id="S4.E7.m1.8.8.2.4.1" xref="S4.E7.m1.8.8.2.3.cmml">,</mo><mi id="S4.E7.m1.8.8.2.2" xref="S4.E7.m1.8.8.2.2.cmml">k</mi></mrow></msub><mo id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.2.2.2.5" stretchy="false" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S4.E7.m1.11.11.1.1.1.1.1.1.3" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E7.m1.11.11.1.2" lspace="0em" xref="S4.E7.m1.11.11.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E7.m1.11b"><apply id="S4.E7.m1.11.11.1.1.cmml" xref="S4.E7.m1.11.11.1"><eq id="S4.E7.m1.11.11.1.1.2.cmml" xref="S4.E7.m1.11.11.1.1.2"></eq><apply id="S4.E7.m1.11.11.1.1.3.cmml" xref="S4.E7.m1.11.11.1.1.3"><times id="S4.E7.m1.11.11.1.1.3.1.cmml" xref="S4.E7.m1.11.11.1.1.3.1"></times><ci id="S4.E7.m1.11.11.1.1.3.2.cmml" xref="S4.E7.m1.11.11.1.1.3.2">𝐿</ci><interval closure="open" id="S4.E7.m1.11.11.1.1.3.3.1.cmml" xref="S4.E7.m1.11.11.1.1.3.3.2"><ci id="S4.E7.m1.9.9.cmml" xref="S4.E7.m1.9.9">𝑉</ci><ci id="S4.E7.m1.10.10.cmml" xref="S4.E7.m1.10.10">𝑙</ci></interval></apply><apply id="S4.E7.m1.11.11.1.1.1.cmml" xref="S4.E7.m1.11.11.1.1.1"><times id="S4.E7.m1.11.11.1.1.1.2.cmml" xref="S4.E7.m1.11.11.1.1.1.2"></times><apply id="S4.E7.m1.11.11.1.1.1.3.cmml" xref="S4.E7.m1.11.11.1.1.1.3"><divide id="S4.E7.m1.11.11.1.1.1.3.1.cmml" xref="S4.E7.m1.11.11.1.1.1.3"></divide><cn id="S4.E7.m1.11.11.1.1.1.3.2.cmml" type="integer" xref="S4.E7.m1.11.11.1.1.1.3.2">1</cn><ci id="S4.E7.m1.11.11.1.1.1.3.3.cmml" xref="S4.E7.m1.11.11.1.1.1.3.3">𝑆</ci></apply><apply id="S4.E7.m1.11.11.1.1.1.1.cmml" xref="S4.E7.m1.11.11.1.1.1.1"><apply id="S4.E7.m1.11.11.1.1.1.1.2.cmml" xref="S4.E7.m1.11.11.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E7.m1.11.11.1.1.1.1.2.1.cmml" xref="S4.E7.m1.11.11.1.1.1.1.2">superscript</csymbol><apply id="S4.E7.m1.11.11.1.1.1.1.2.2.cmml" xref="S4.E7.m1.11.11.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E7.m1.11.11.1.1.1.1.2.2.1.cmml" xref="S4.E7.m1.11.11.1.1.1.1.2">subscript</csymbol><sum id="S4.E7.m1.11.11.1.1.1.1.2.2.2.cmml" xref="S4.E7.m1.11.11.1.1.1.1.2.2.2"></sum><apply id="S4.E7.m1.11.11.1.1.1.1.2.2.3.cmml" xref="S4.E7.m1.11.11.1.1.1.1.2.2.3"><eq id="S4.E7.m1.11.11.1.1.1.1.2.2.3.1.cmml" xref="S4.E7.m1.11.11.1.1.1.1.2.2.3.1"></eq><ci id="S4.E7.m1.11.11.1.1.1.1.2.2.3.2.cmml" xref="S4.E7.m1.11.11.1.1.1.1.2.2.3.2">𝑠</ci><cn id="S4.E7.m1.11.11.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S4.E7.m1.11.11.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S4.E7.m1.11.11.1.1.1.1.2.3.cmml" xref="S4.E7.m1.11.11.1.1.1.1.2.3">𝑆</ci></apply><apply id="S4.E7.m1.11.11.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.11.11.1.1.1.1.1.1"><plus id="S4.E7.m1.11.11.1.1.1.1.1.1.1.5.cmml" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.5"></plus><apply id="S4.E7.m1.11.11.1.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.2"><times id="S4.E7.m1.11.11.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.2.3"></times><ci id="S4.E7.m1.11.11.1.1.1.1.1.1.1.2.4.cmml" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.2.4">CE</ci><interval closure="open" id="S4.E7.m1.11.11.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.2.2.2"><apply id="S4.E7.m1.11.11.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.11.11.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E7.m1.11.11.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.1.1.1.1.2">𝑙</ci><list id="S4.E7.m1.2.2.2.3.cmml" xref="S4.E7.m1.2.2.2.4"><ci id="S4.E7.m1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1">𝑠</ci><cn id="S4.E7.m1.2.2.2.2.cmml" type="integer" xref="S4.E7.m1.2.2.2.2">1</cn></list></apply><apply id="S4.E7.m1.11.11.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.11.11.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S4.E7.m1.11.11.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.2.2.2.2.2">𝑉</ci><list id="S4.E7.m1.4.4.2.3.cmml" xref="S4.E7.m1.4.4.2.4"><ci id="S4.E7.m1.3.3.1.1.cmml" xref="S4.E7.m1.3.3.1.1">𝑠</ci><cn id="S4.E7.m1.4.4.2.2.cmml" type="integer" xref="S4.E7.m1.4.4.2.2">1</cn></list></apply></interval></apply><apply id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.cmml" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4"><times id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.3.cmml" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.3"></times><apply id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.cmml" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4"><divide id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.1.cmml" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4"></divide><cn id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.2.cmml" type="integer" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.2">1</cn><apply id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.3.cmml" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.3"><apply id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.3.1.cmml" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.3.1"><csymbol cd="ambiguous" id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.3.1.1.cmml" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.3.1">superscript</csymbol><apply id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.3.1.2.cmml" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.3.1"><csymbol cd="ambiguous" id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.3.1.2.1.cmml" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.3.1">subscript</csymbol><sum id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.3.1.2.2.cmml" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.3.1.2.2"></sum><apply id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.3.1.2.3.cmml" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.3.1.2.3"><eq id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.3.1.2.3.1.cmml" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.3.1.2.3.1"></eq><ci id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.3.1.2.3.2.cmml" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.3.1.2.3.2">𝑘</ci><cn id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.3.1.2.3.3.cmml" type="integer" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.3.1.2.3.3">2</cn></apply></apply><ci id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.3.1.3.cmml" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.3.1.3">𝐾</ci></apply><apply id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.3.2.cmml" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.3.2"><csymbol cd="ambiguous" id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.3.2.1.cmml" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.3.2">subscript</csymbol><ci id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.3.2.2.cmml" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.3.2.2">𝛼</ci><ci id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.3.2.3.cmml" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.4.3.2.3">𝑘</ci></apply></apply></apply><apply id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.cmml" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2"><apply id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.3.cmml" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.3"><csymbol cd="ambiguous" id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.3.1.cmml" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.3">superscript</csymbol><apply id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.3.2.cmml" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.3"><csymbol cd="ambiguous" id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.3.2.1.cmml" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.3">subscript</csymbol><sum id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.3.2.2.cmml" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.3.2.2"></sum><apply id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.3.2.3.cmml" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.3.2.3"><eq id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.3.2.3.1.cmml" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.3.2.3.1"></eq><ci id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.3.2.3.2.cmml" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.3.2.3.2">𝑘</ci><cn id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.3.2.3.3.cmml" type="integer" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.3.2.3.3">2</cn></apply></apply><ci id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.3.3.cmml" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.3.3">𝐾</ci></apply><apply id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.2.cmml" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.2"><times id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.2.3.cmml" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.2.3"></times><apply id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.2.4.cmml" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.2.4"><csymbol cd="ambiguous" id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.2.4.1.cmml" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.2.4">subscript</csymbol><ci id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.2.4.2.cmml" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.2.4.2">𝛼</ci><ci id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.2.4.3.cmml" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.2.4.3">𝑘</ci></apply><ci id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.2.5.cmml" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.2.5">CE</ci><interval closure="open" id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.2.2.3.cmml" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.2.2.2"><apply id="S4.E7.m1.11.11.1.1.1.1.1.1.1.3.1.1.1.1.1.cmml" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.11.11.1.1.1.1.1.1.1.3.1.1.1.1.1.1.cmml" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.3.1.1.1.1.1">subscript</csymbol><ci id="S4.E7.m1.11.11.1.1.1.1.1.1.1.3.1.1.1.1.1.2.cmml" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.3.1.1.1.1.1.2">𝑙</ci><list id="S4.E7.m1.6.6.2.3.cmml" xref="S4.E7.m1.6.6.2.4"><ci id="S4.E7.m1.5.5.1.1.cmml" xref="S4.E7.m1.5.5.1.1">𝑠</ci><ci id="S4.E7.m1.6.6.2.2.cmml" xref="S4.E7.m1.6.6.2.2">𝑘</ci></list></apply><apply id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.2.2.2.2.cmml" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.2.2.2.2.1.cmml" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.2.2.2.2">subscript</csymbol><ci id="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.2.2.2.2.2.cmml" xref="S4.E7.m1.11.11.1.1.1.1.1.1.1.4.2.2.2.2.2.2">𝑉</ci><list id="S4.E7.m1.8.8.2.3.cmml" xref="S4.E7.m1.8.8.2.4"><ci id="S4.E7.m1.7.7.1.1.cmml" xref="S4.E7.m1.7.7.1.1">𝑠</ci><ci id="S4.E7.m1.8.8.2.2.cmml" xref="S4.E7.m1.8.8.2.2">𝑘</ci></list></apply></interval></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.11c">L(V,l)=\frac{1}{S}\sum_{s=1}^{S}\left(\mathrm{CE}(l_{s,1},V_{s,1})+\frac{1}{%
\sum_{k=2}^{K}\alpha_{k}}\sum_{k=2}^{K}\alpha_{k}\mathrm{CE}(l_{s,k},V_{s,k})%
\right).</annotation><annotation encoding="application/x-llamapun" id="S4.E7.m1.11d">italic_L ( italic_V , italic_l ) = divide start_ARG 1 end_ARG start_ARG italic_S end_ARG ∑ start_POSTSUBSCRIPT italic_s = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_S end_POSTSUPERSCRIPT ( roman_CE ( italic_l start_POSTSUBSCRIPT italic_s , 1 end_POSTSUBSCRIPT , italic_V start_POSTSUBSCRIPT italic_s , 1 end_POSTSUBSCRIPT ) + divide start_ARG 1 end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_k = 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT italic_α start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_ARG ∑ start_POSTSUBSCRIPT italic_k = 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT italic_α start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT roman_CE ( italic_l start_POSTSUBSCRIPT italic_s , italic_k end_POSTSUBSCRIPT , italic_V start_POSTSUBSCRIPT italic_s , italic_k end_POSTSUBSCRIPT ) ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS4.SSS0.Px6.p1.5">Thus, we give the same importance to the text token (<math alttext="k{=}1" class="ltx_Math" display="inline" id="S4.SS4.SSS0.Px6.p1.4.m1.1"><semantics id="S4.SS4.SSS0.Px6.p1.4.m1.1a"><mrow id="S4.SS4.SSS0.Px6.p1.4.m1.1.1" xref="S4.SS4.SSS0.Px6.p1.4.m1.1.1.cmml"><mi id="S4.SS4.SSS0.Px6.p1.4.m1.1.1.2" xref="S4.SS4.SSS0.Px6.p1.4.m1.1.1.2.cmml">k</mi><mo id="S4.SS4.SSS0.Px6.p1.4.m1.1.1.1" xref="S4.SS4.SSS0.Px6.p1.4.m1.1.1.1.cmml">=</mo><mn id="S4.SS4.SSS0.Px6.p1.4.m1.1.1.3" xref="S4.SS4.SSS0.Px6.p1.4.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px6.p1.4.m1.1b"><apply id="S4.SS4.SSS0.Px6.p1.4.m1.1.1.cmml" xref="S4.SS4.SSS0.Px6.p1.4.m1.1.1"><eq id="S4.SS4.SSS0.Px6.p1.4.m1.1.1.1.cmml" xref="S4.SS4.SSS0.Px6.p1.4.m1.1.1.1"></eq><ci id="S4.SS4.SSS0.Px6.p1.4.m1.1.1.2.cmml" xref="S4.SS4.SSS0.Px6.p1.4.m1.1.1.2">𝑘</ci><cn id="S4.SS4.SSS0.Px6.p1.4.m1.1.1.3.cmml" type="integer" xref="S4.SS4.SSS0.Px6.p1.4.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px6.p1.4.m1.1c">k{=}1</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS0.Px6.p1.4.m1.1d">italic_k = 1</annotation></semantics></math>), and the combined audio tokens. <math alttext="\alpha_{k}" class="ltx_Math" display="inline" id="S4.SS4.SSS0.Px6.p1.5.m2.1"><semantics id="S4.SS4.SSS0.Px6.p1.5.m2.1a"><msub id="S4.SS4.SSS0.Px6.p1.5.m2.1.1" xref="S4.SS4.SSS0.Px6.p1.5.m2.1.1.cmml"><mi id="S4.SS4.SSS0.Px6.p1.5.m2.1.1.2" xref="S4.SS4.SSS0.Px6.p1.5.m2.1.1.2.cmml">α</mi><mi id="S4.SS4.SSS0.Px6.p1.5.m2.1.1.3" xref="S4.SS4.SSS0.Px6.p1.5.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px6.p1.5.m2.1b"><apply id="S4.SS4.SSS0.Px6.p1.5.m2.1.1.cmml" xref="S4.SS4.SSS0.Px6.p1.5.m2.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px6.p1.5.m2.1.1.1.cmml" xref="S4.SS4.SSS0.Px6.p1.5.m2.1.1">subscript</csymbol><ci id="S4.SS4.SSS0.Px6.p1.5.m2.1.1.2.cmml" xref="S4.SS4.SSS0.Px6.p1.5.m2.1.1.2">𝛼</ci><ci id="S4.SS4.SSS0.Px6.p1.5.m2.1.1.3.cmml" xref="S4.SS4.SSS0.Px6.p1.5.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px6.p1.5.m2.1c">\alpha_{k}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS0.Px6.p1.5.m2.1d">italic_α start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> is set to 100 for semantic tokens, and 1 for acoustic ones.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Evaluation</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_table" id="S5.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span><span class="ltx_text ltx_font_bold" id="S5.T2.3.1">Text language model evaluation</span>. Performance on standard benchmarks for evaluating large language models, including closed book question answering, reasoning and multiple choice QA exams. We report in bold the best performing model trained on less than 2.5T tokens.
</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T2.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T2.1.2.1">
<th class="ltx_td ltx_th ltx_th_row ltx_border_tt" id="S5.T2.1.2.1.1"></th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.1.2.1.2"><span class="ltx_text" id="S5.T2.1.2.1.2.1" style="font-size:80%;">ARCe</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.1.2.1.3"><span class="ltx_text" id="S5.T2.1.2.1.3.1" style="font-size:80%;">ARCc</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.1.2.1.4"><span class="ltx_text" id="S5.T2.1.2.1.4.1" style="font-size:80%;">OBQA</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.1.2.1.5"><span class="ltx_text" id="S5.T2.1.2.1.5.1" style="font-size:80%;">HS</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.1.2.1.6"><span class="ltx_text" id="S5.T2.1.2.1.6.1" style="font-size:80%;">WG</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.1.2.1.7"><span class="ltx_text" id="S5.T2.1.2.1.7.1" style="font-size:80%;">PIQA</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.1.2.1.8"><span class="ltx_text" id="S5.T2.1.2.1.8.1" style="font-size:80%;">SIQA</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.1.2.1.9"><span class="ltx_text" id="S5.T2.1.2.1.9.1" style="font-size:80%;">TQA</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.1.2.1.10"><span class="ltx_text" id="S5.T2.1.2.1.10.1" style="font-size:80%;">NQ</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.1.2.1.11"><span class="ltx_text" id="S5.T2.1.2.1.11.1" style="font-size:80%;">MMLU</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T2.1.3.2.1"><span class="ltx_text" id="S5.T2.1.3.2.1.1" style="font-size:80%;">Helium</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.3.2.2"><span class="ltx_text ltx_font_bold" id="S5.T2.1.3.2.2.1" style="font-size:80%;">79.6</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.3.2.3"><span class="ltx_text ltx_font_bold" id="S5.T2.1.3.2.3.1" style="font-size:80%;">55.9</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.3.2.4"><span class="ltx_text" id="S5.T2.1.3.2.4.1" style="font-size:80%;">53.6</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.3.2.5"><span class="ltx_text" id="S5.T2.1.3.2.5.1" style="font-size:80%;">76.3</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.3.2.6"><span class="ltx_text ltx_font_bold" id="S5.T2.1.3.2.6.1" style="font-size:80%;">70.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.3.2.7"><span class="ltx_text" id="S5.T2.1.3.2.7.1" style="font-size:80%;">79.4</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.3.2.8"><span class="ltx_text ltx_font_bold" id="S5.T2.1.3.2.8.1" style="font-size:80%;">51.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.3.2.9"><span class="ltx_text ltx_font_bold" id="S5.T2.1.3.2.9.1" style="font-size:80%;">59.9/72.6</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.3.2.10"><span class="ltx_text" id="S5.T2.1.3.2.10.1" style="font-size:80%;">23.3</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.3.2.11"><span class="ltx_text ltx_font_bold" id="S5.T2.1.3.2.11.1" style="font-size:80%;">54.3</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T2.1.4.3.1"><span class="ltx_text" id="S5.T2.1.4.3.1.1" style="font-size:80%;">MPT</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.4.3.2"><span class="ltx_text" id="S5.T2.1.4.3.2.1" style="font-size:80%;">70.5</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.4.3.3"><span class="ltx_text" id="S5.T2.1.4.3.3.1" style="font-size:80%;">46.5</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.4.3.4"><span class="ltx_text" id="S5.T2.1.4.3.4.1" style="font-size:80%;">51.4</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.4.3.5"><span class="ltx_text ltx_font_bold" id="S5.T2.1.4.3.5.1" style="font-size:80%;">77.6</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.4.3.6"><span class="ltx_text" id="S5.T2.1.4.3.6.1" style="font-size:80%;">69.9</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.4.3.7"><span class="ltx_text ltx_font_bold" id="S5.T2.1.4.3.7.1" style="font-size:80%;">80.6</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.4.3.8"><span class="ltx_text" id="S5.T2.1.4.3.8.1" style="font-size:80%;">48.5</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.4.3.9"><span class="ltx_text" id="S5.T2.1.4.3.9.1" style="font-size:80%;">-/61.2</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.4.3.10"><span class="ltx_text" id="S5.T2.1.4.3.10.1" style="font-size:80%;">20.8</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.4.3.11"><span class="ltx_text" id="S5.T2.1.4.3.11.1" style="font-size:80%;">30.8</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T2.1.5.4.1"><span class="ltx_text" id="S5.T2.1.5.4.1.1" style="font-size:80%;">Falcon</span></th>
<td class="ltx_td ltx_align_center" id="S5.T2.1.5.4.2"><span class="ltx_text" id="S5.T2.1.5.4.2.1" style="font-size:80%;">73.7</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.5.4.3"><span class="ltx_text" id="S5.T2.1.5.4.3.1" style="font-size:80%;">47.5</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.5.4.4"><span class="ltx_text" id="S5.T2.1.5.4.4.1" style="font-size:80%;">53.0</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.5.4.5"><span class="ltx_text" id="S5.T2.1.5.4.5.1" style="font-size:80%;">76.3</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.5.4.6"><span class="ltx_text" id="S5.T2.1.5.4.6.1" style="font-size:80%;">68.9</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.5.4.7"><span class="ltx_text" id="S5.T2.1.5.4.7.1" style="font-size:80%;">80.3</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.5.4.8"><span class="ltx_text" id="S5.T2.1.5.4.8.1" style="font-size:80%;">47.2</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.5.4.9"><span class="ltx_text" id="S5.T2.1.5.4.9.1" style="font-size:80%;">-/64.6</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.5.4.10"><span class="ltx_text" id="S5.T2.1.5.4.10.1" style="font-size:80%;">21.0</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.5.4.11"><span class="ltx_text" id="S5.T2.1.5.4.11.1" style="font-size:80%;">28.0</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.6.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T2.1.6.5.1"><span class="ltx_text" id="S5.T2.1.6.5.1.1" style="font-size:80%;">Llama 2</span></th>
<td class="ltx_td ltx_align_center" id="S5.T2.1.6.5.2"><span class="ltx_text" id="S5.T2.1.6.5.2.1" style="font-size:80%;">75.2</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.6.5.3"><span class="ltx_text" id="S5.T2.1.6.5.3.1" style="font-size:80%;">45.9</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.6.5.4"><span class="ltx_text ltx_font_bold" id="S5.T2.1.6.5.4.1" style="font-size:80%;">58.6</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.6.5.5"><span class="ltx_text" id="S5.T2.1.6.5.5.1" style="font-size:80%;">77.2</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.6.5.6"><span class="ltx_text" id="S5.T2.1.6.5.6.1" style="font-size:80%;">69.2</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.6.5.7"><span class="ltx_text" id="S5.T2.1.6.5.7.1" style="font-size:80%;">78.8</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.6.5.8"><span class="ltx_text" id="S5.T2.1.6.5.8.1" style="font-size:80%;">48.3</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.6.5.9"><span class="ltx_text" id="S5.T2.1.6.5.9.1" style="font-size:80%;">-/72.1</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.6.5.10"><span class="ltx_text ltx_font_bold" id="S5.T2.1.6.5.10.1" style="font-size:80%;">25.7</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.6.5.11"><span class="ltx_text" id="S5.T2.1.6.5.11.1" style="font-size:80%;">45.3</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.7.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T2.1.7.6.1"><span class="ltx_text" id="S5.T2.1.7.6.1.1" style="font-size:80%;">OLMo</span></th>
<td class="ltx_td ltx_align_center" id="S5.T2.1.7.6.2"><span class="ltx_text" id="S5.T2.1.7.6.2.1" style="font-size:80%;">67.2</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.7.6.3"><span class="ltx_text" id="S5.T2.1.7.6.3.1" style="font-size:80%;">42.5</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.7.6.4"><span class="ltx_text" id="S5.T2.1.7.6.4.1" style="font-size:80%;">50.0</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.7.6.5"><span class="ltx_text" id="S5.T2.1.7.6.5.1" style="font-size:80%;">75.5</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.7.6.6"><span class="ltx_text" id="S5.T2.1.7.6.6.1" style="font-size:80%;">69.8</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.7.6.7"><span class="ltx_text" id="S5.T2.1.7.6.7.1" style="font-size:80%;">77.5</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.7.6.8"><span class="ltx_text" id="S5.T2.1.7.6.8.1" style="font-size:80%;">-</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.7.6.9"><span class="ltx_text" id="S5.T2.1.7.6.9.1" style="font-size:80%;">-/-</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.7.6.10"><span class="ltx_text" id="S5.T2.1.7.6.10.1" style="font-size:80%;">-</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.7.6.11"><span class="ltx_text" id="S5.T2.1.7.6.11.1" style="font-size:80%;">52.0</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T2.1.1.2"><span class="ltx_text" id="S5.T2.1.1.2.1" style="font-size:80%;">Mistral</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.3"><span class="ltx_text" id="S5.T2.1.1.3.1" style="font-size:80%;">80.5</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.4"><span class="ltx_text" id="S5.T2.1.1.4.1" style="font-size:80%;">54.9</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.5"><span class="ltx_text" id="S5.T2.1.1.5.1" style="font-size:80%;">52.2</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.6"><span class="ltx_text" id="S5.T2.1.1.6.1" style="font-size:80%;">81.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.7"><span class="ltx_text" id="S5.T2.1.1.7.1" style="font-size:80%;">74.2</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.8"><span class="ltx_text" id="S5.T2.1.1.8.1" style="font-size:80%;">82.2</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.1">
<span class="ltx_text" id="S5.T2.1.1.1.1" style="font-size:80%;">47.0</span><sup class="ltx_sup" id="S5.T2.1.1.1.2"><span class="ltx_text" id="S5.T2.1.1.1.2.1" style="font-size:80%;">∗</span></sup>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.9"><span class="ltx_text" id="S5.T2.1.1.9.1" style="font-size:80%;">62.5/-</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.10"><span class="ltx_text" id="S5.T2.1.1.10.1" style="font-size:80%;">23.2</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.11"><span class="ltx_text" id="S5.T2.1.1.11.1" style="font-size:80%;">62.5</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.8.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S5.T2.1.8.7.1"><span class="ltx_text" id="S5.T2.1.8.7.1.1" style="font-size:80%;">Gemma 1</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.1.8.7.2"><span class="ltx_text" id="S5.T2.1.8.7.2.1" style="font-size:80%;">81.5</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.1.8.7.3"><span class="ltx_text" id="S5.T2.1.8.7.3.1" style="font-size:80%;">53.2</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.1.8.7.4"><span class="ltx_text" id="S5.T2.1.8.7.4.1" style="font-size:80%;">52.8</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.1.8.7.5"><span class="ltx_text" id="S5.T2.1.8.7.5.1" style="font-size:80%;">81.2</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.1.8.7.6"><span class="ltx_text" id="S5.T2.1.8.7.6.1" style="font-size:80%;">72.3</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.1.8.7.7"><span class="ltx_text" id="S5.T2.1.8.7.7.1" style="font-size:80%;">81.2</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.1.8.7.8"><span class="ltx_text" id="S5.T2.1.8.7.8.1" style="font-size:80%;">51.8</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.1.8.7.9"><span class="ltx_text" id="S5.T2.1.8.7.9.1" style="font-size:80%;">63.4/-</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.1.8.7.10"><span class="ltx_text" id="S5.T2.1.8.7.10.1" style="font-size:80%;">23.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.1.8.7.11"><span class="ltx_text" id="S5.T2.1.8.7.11.1" style="font-size:80%;">64.3</span></td>
</tr>
</tbody>
</table>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Text Language Modeling</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_paragraph" id="S5.SS1.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Metrics.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS1.SSS0.Px1.p1">
<p class="ltx_p" id="S5.SS1.SSS0.Px1.p1.1">We evaluate Helium (trained only on text data) on the following standard benchmarks: AI2 Reasoning Challenge&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Clark et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib16" title="">2018</a>, ARC)</cite>, Open-Book QA&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Mihaylov et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib67" title="">2018</a>, OBQA)</cite>, HellaSwag&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Zellers et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib109" title="">2019</a>, HS)</cite>, WinoGrande&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Sakaguchi et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib81" title="">2021</a>, WG)</cite>, Physical Interaction QA&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Bisk et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib5" title="">2020</a>, PIQA)</cite>, Social Interaction QA&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Sap et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib86" title="">2019</a>)</cite>, TriviaQA&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Joshi et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib43" title="">2017</a>, TQA)</cite>, Natural Questions&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Kwiatkowski et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib53" title="">2019</a>, NQ)</cite> and Massive Multitask Language Understanding benchmark&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Hendrycks et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib37" title="">2020</a>, MMLU)</cite>.
These benchmarks cover a wide variety of tasks, including common sense reasoning, closed-book question answering or multiple choice question answering from high school and college subjects.
We follow the evaluation protocol from previous work such as GPT-3 or Llama: we perform 5-shot evaluation on TriviaQA, NQ and MMLU, and 0-shot evaluation on the other datasets.
On TriviaQA, we report performance on the Unfiltered and Wikipedia splits.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS1.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Baselines.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS1.SSS0.Px2.p1">
<p class="ltx_p" id="S5.SS1.SSS0.Px2.p1.1">As baselines, we consider existing large language models with a size around 7B parameters, and which are trained using roughly the same amount of compute as Helium.
More specifically, we include models that are trained on fewer than 2.5T tokens (compared to the 2.1T tokens that are used to train Helium), namely MPT&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Team, <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib92" title="">2023</a>)</cite>, Falcon&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Almazrouei et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib2" title="">2023</a>)</cite>, Llama 2&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Touvron et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib97" title="">2023b</a>)</cite> and OLMo&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Groeneveld et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib32" title="">2024</a>)</cite>.
We also include Mistral and Gemma, two popular open weights models that are trained using significantly more compute than Helium.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS1.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">Results.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS1.SSS0.Px3.p1">
<p class="ltx_p" id="S5.SS1.SSS0.Px3.p1.1">We report results in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.T2" title="Table 2 ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue">Table&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></span></a>, and we observe that on most benchmarks, Helium is on-par or outperforming models using similar amount of training compute.
Even compared to Mistral and Gemma, which use up to 3x more compute for training, Helium obtains competitive results on some benchmarks such as ARC, Open-Book QA or Natural Questions.
This validates the quality of our pre-training text data.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Audio Tokenization</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_paragraph" id="S5.SS2.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Metrics.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="S5.SS2.SSS0.Px1.p1.1">We then evaluate the semantic and acoustic performance of our neural codec, Mimi. First, we evaluate whether the semantic tokens it produces provide targets that are amenable to language modeling. To do so, we compute a triphone-based ABX&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Schatz et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib87" title="">2013</a>)</cite> error rate that characterizes the phonetic discriminability of a representation space by comparing distances between two embeddings of different instances of a same triphone (e.g.“beg”) and a negative triphone that differs minimally (e.g.“bag”). More precisely, we compute a “within speaker” ABX where the three instances are pronounced by the same speaker, and report error rates on Librispeech&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Panayotov et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib74" title="">2015</a>)</cite> dev-clean with the default parameters of the Librilight <cite class="ltx_cite ltx_citemacro_citep">(Kahn et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib46" title="">2020</a>)</cite> repository<span class="ltx_note ltx_role_footnote" id="footnote12"><sup class="ltx_note_mark">12</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">12</sup><span class="ltx_tag ltx_tag_note">12</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/facebookresearch/libri-light/blob/main/eval/README.md" title="">https://github.com/facebookresearch/libri-light/blob/main/eval/README.md</a></span></span></span>. The resulting score has been shown to be a strong predictor of the ability of a downstream audio language model to produce coherent speech&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Lakhotia et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib54" title="">2021</a>)</cite>. Since we are interested in characterizing only the semantic token, we compute distances in the latent space produced after quantization with the semantic VQ only (i.e. before summing with acoustic tokens).
Second, we evaluate the acoustic quality of reconstructed audio. As objective, automatic metrics we rely on VisQOL&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Hines et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib38" title="">2015</a>)</cite>— a full-reference model of acoustic similarity— and MOSNet&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Lo et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib61" title="">2019</a>)</cite>— a reference-free model of audio quality. Given the limitations of automatic evaluation of audio quality, we also perform human evaluations with a MUSHRA protocol. We rely on judgments of 20 listeners, each one rating 30 samples of 10s each. <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.T3" title="Table 3 ‣ Baselines. ‣ 5.2 Audio Tokenization ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue">Table&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></span></a> reports ablations studies using objective metrics, while <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.T4" title="Table 4 ‣ Baselines. ‣ 5.2 Audio Tokenization ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue">Table&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></span></a> provides a comparison with previous work both in terms of objective and subjective evaluation.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS2.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Baselines.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS2.SSS0.Px2.p1">
<p class="ltx_p" id="S5.SS2.SSS0.Px2.p1.1">We compare against RVQGAN&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Kumar et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib52" title="">2024</a>)</cite>, SemantiCodec&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Liu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib59" title="">2024</a>)</cite>, and SpeechTokenizer &nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Zhang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib113" title="">2024b</a>)</cite>. RVQGAN is a pure acoustic tokenizer, in the sense that it does not encode semantic information. Thus, we only evaluate it in terms of audio quality. RVQGAN produces tokens at 75Hz, so we only keep the first two levels of RVQ to obtain a bitrate of 1.5kbps, closer to that of Mimi. On the other hand, SpeechTokenizer relies on distillation to encode semantic information into its first token such that we can evaluate both its semantic and acoustic properties. We keep its first 3 RVQ levels to obtain a 1.5kbps bitrate. Similarly, SemantiCodec also encodes semantic and acoustic information such that it can be evaluated along both axes.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="S5.T3">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span><span class="ltx_text ltx_font_bold" id="S5.T3.14.1">Ablation study on hyper-parameters of the Mimi codec</span>. We evaluate semantic modeling by reporting the error rate on a phonetic ABX discriminability task. To evaluate the reconstruction quality, we compute VisQOL and MOSNet and collect human judgments with a MUSHRA protocol. “Quantization rate” refers to applying quantization to the latent space only <math alttext="50\%" class="ltx_Math" display="inline" id="S5.T3.2.m1.1"><semantics id="S5.T3.2.m1.1b"><mrow id="S5.T3.2.m1.1.1" xref="S5.T3.2.m1.1.1.cmml"><mn id="S5.T3.2.m1.1.1.2" xref="S5.T3.2.m1.1.1.2.cmml">50</mn><mo id="S5.T3.2.m1.1.1.1" xref="S5.T3.2.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.T3.2.m1.1c"><apply id="S5.T3.2.m1.1.1.cmml" xref="S5.T3.2.m1.1.1"><csymbol cd="latexml" id="S5.T3.2.m1.1.1.1.cmml" xref="S5.T3.2.m1.1.1.1">percent</csymbol><cn id="S5.T3.2.m1.1.1.2.cmml" type="integer" xref="S5.T3.2.m1.1.1.2">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.2.m1.1d">50\%</annotation><annotation encoding="application/x-llamapun" id="S5.T3.2.m1.1e">50 %</annotation></semantics></math> of the time during training (independently from quantizer dropout), as described in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS3" title="3.3 Audio Tokenization ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue">Section &nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></span></a>.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S5.T3.12" style="width:433.6pt;height:110.7pt;vertical-align:-0.8pt;"><span class="ltx_transformed_inner" style="transform:translate(-67.2pt,17.0pt) scale(0.763414151314753,0.763414151314753) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T3.12.10">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T3.6.4.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T3.6.4.4.5">Quantization</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T3.6.4.4.6">Transformer</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T3.6.4.4.7">Transformer</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T3.6.4.4.8">WavLM</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S5.T3.6.4.4.9">Split</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T3.3.1.1.1" rowspan="2"><span class="ltx_text" id="S5.T3.3.1.1.1.1">ABX (<math alttext="\downarrow" class="ltx_Math" display="inline" id="S5.T3.3.1.1.1.1.m1.1"><semantics id="S5.T3.3.1.1.1.1.m1.1a"><mo id="S5.T3.3.1.1.1.1.m1.1.1" stretchy="false" xref="S5.T3.3.1.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T3.3.1.1.1.1.m1.1b"><ci id="S5.T3.3.1.1.1.1.m1.1.1.cmml" xref="S5.T3.3.1.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.3.1.1.1.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T3.3.1.1.1.1.m1.1d">↓</annotation></semantics></math>)</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T3.4.2.2.2" rowspan="2"><span class="ltx_text" id="S5.T3.4.2.2.2.1">VisQOL (<math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.T3.4.2.2.2.1.m1.1"><semantics id="S5.T3.4.2.2.2.1.m1.1a"><mo id="S5.T3.4.2.2.2.1.m1.1.1" stretchy="false" xref="S5.T3.4.2.2.2.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T3.4.2.2.2.1.m1.1b"><ci id="S5.T3.4.2.2.2.1.m1.1.1.cmml" xref="S5.T3.4.2.2.2.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.4.2.2.2.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T3.4.2.2.2.1.m1.1d">↑</annotation></semantics></math>)</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T3.5.3.3.3" rowspan="2"><span class="ltx_text" id="S5.T3.5.3.3.3.1">MOSNet (<math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.T3.5.3.3.3.1.m1.1"><semantics id="S5.T3.5.3.3.3.1.m1.1a"><mo id="S5.T3.5.3.3.3.1.m1.1.1" stretchy="false" xref="S5.T3.5.3.3.3.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T3.5.3.3.3.1.m1.1b"><ci id="S5.T3.5.3.3.3.1.m1.1.1.cmml" xref="S5.T3.5.3.3.3.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.5.3.3.3.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T3.5.3.3.3.1.m1.1d">↑</annotation></semantics></math>)</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T3.6.4.4.4" rowspan="2"><span class="ltx_text" id="S5.T3.6.4.4.4.1">MUSHRA (<math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.T3.6.4.4.4.1.m1.1"><semantics id="S5.T3.6.4.4.4.1.m1.1a"><mo id="S5.T3.6.4.4.4.1.m1.1.1" stretchy="false" xref="S5.T3.6.4.4.4.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T3.6.4.4.4.1.m1.1b"><ci id="S5.T3.6.4.4.4.1.m1.1.1.cmml" xref="S5.T3.6.4.4.4.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.6.4.4.4.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T3.6.4.4.4.1.m1.1d">↑</annotation></semantics></math>)</span></th>
</tr>
<tr class="ltx_tr" id="S5.T3.12.10.11.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S5.T3.12.10.11.1.1">Rate</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S5.T3.12.10.11.1.2">in encoder</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S5.T3.12.10.11.1.3">in decoder</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S5.T3.12.10.11.1.4">distillation</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S5.T3.12.10.11.1.5">quantizer</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T3.7.5.5">
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.7.5.5.2">✓</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.7.5.5.3">✓</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.7.5.5.4">✓</td>
<td class="ltx_td ltx_border_t" id="S5.T3.7.5.5.5"></td>
<td class="ltx_td ltx_border_r ltx_border_t" id="S5.T3.7.5.5.6"></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.7.5.5.7">23.3%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.7.5.5.8">2.91</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.7.5.5.9">2.89</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.7.5.5.1">65.9<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T3.7.5.5.1.m1.1"><semantics id="S5.T3.7.5.5.1.m1.1a"><mo id="S5.T3.7.5.5.1.m1.1.1" mathsize="70%" xref="S5.T3.7.5.5.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.7.5.5.1.m1.1b"><csymbol cd="latexml" id="S5.T3.7.5.5.1.m1.1.1.cmml" xref="S5.T3.7.5.5.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.7.5.5.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T3.7.5.5.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S5.T3.7.5.5.1.1" style="font-size:70%;">1.7</span>
</td>
</tr>
<tr class="ltx_tr" id="S5.T3.8.6.6">
<td class="ltx_td ltx_align_center" id="S5.T3.8.6.6.2">✓</td>
<td class="ltx_td ltx_align_center" id="S5.T3.8.6.6.3">✓</td>
<td class="ltx_td ltx_align_center" id="S5.T3.8.6.6.4">✓</td>
<td class="ltx_td ltx_align_center" id="S5.T3.8.6.6.5">✓</td>
<td class="ltx_td ltx_border_r" id="S5.T3.8.6.6.6"></td>
<td class="ltx_td ltx_align_center" id="S5.T3.8.6.6.7">6.5%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.8.6.6.8">2.22</td>
<td class="ltx_td ltx_align_center" id="S5.T3.8.6.6.9">2.87</td>
<td class="ltx_td ltx_align_center" id="S5.T3.8.6.6.1">57.8<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T3.8.6.6.1.m1.1"><semantics id="S5.T3.8.6.6.1.m1.1a"><mo id="S5.T3.8.6.6.1.m1.1.1" mathsize="70%" xref="S5.T3.8.6.6.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.8.6.6.1.m1.1b"><csymbol cd="latexml" id="S5.T3.8.6.6.1.m1.1.1.cmml" xref="S5.T3.8.6.6.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.8.6.6.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T3.8.6.6.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S5.T3.8.6.6.1.1" style="font-size:70%;">1.8</span>
</td>
</tr>
<tr class="ltx_tr" id="S5.T3.9.7.7">
<td class="ltx_td ltx_align_center" id="S5.T3.9.7.7.2">✓</td>
<td class="ltx_td" id="S5.T3.9.7.7.3"></td>
<td class="ltx_td ltx_align_center" id="S5.T3.9.7.7.4">✓</td>
<td class="ltx_td ltx_align_center" id="S5.T3.9.7.7.5">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.9.7.7.6">✓</td>
<td class="ltx_td ltx_align_center" id="S5.T3.9.7.7.7">10.8%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.9.7.7.8">2.79</td>
<td class="ltx_td ltx_align_center" id="S5.T3.9.7.7.9">2.85</td>
<td class="ltx_td ltx_align_center" id="S5.T3.9.7.7.1">59.7<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T3.9.7.7.1.m1.1"><semantics id="S5.T3.9.7.7.1.m1.1a"><mo id="S5.T3.9.7.7.1.m1.1.1" mathsize="70%" xref="S5.T3.9.7.7.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.9.7.7.1.m1.1b"><csymbol cd="latexml" id="S5.T3.9.7.7.1.m1.1.1.cmml" xref="S5.T3.9.7.7.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.9.7.7.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T3.9.7.7.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S5.T3.9.7.7.1.1" style="font-size:70%;">1.7</span>
</td>
</tr>
<tr class="ltx_tr" id="S5.T3.10.8.8">
<td class="ltx_td ltx_align_center" id="S5.T3.10.8.8.2">✓</td>
<td class="ltx_td ltx_align_center" id="S5.T3.10.8.8.3">✓</td>
<td class="ltx_td" id="S5.T3.10.8.8.4"></td>
<td class="ltx_td ltx_align_center" id="S5.T3.10.8.8.5">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.10.8.8.6">✓</td>
<td class="ltx_td ltx_align_center" id="S5.T3.10.8.8.7">8.1%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.10.8.8.8">2.59</td>
<td class="ltx_td ltx_align_center" id="S5.T3.10.8.8.9">2.72</td>
<td class="ltx_td ltx_align_center" id="S5.T3.10.8.8.1">48.4<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T3.10.8.8.1.m1.1"><semantics id="S5.T3.10.8.8.1.m1.1a"><mo id="S5.T3.10.8.8.1.m1.1.1" mathsize="70%" xref="S5.T3.10.8.8.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.10.8.8.1.m1.1b"><csymbol cd="latexml" id="S5.T3.10.8.8.1.m1.1.1.cmml" xref="S5.T3.10.8.8.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.10.8.8.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T3.10.8.8.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S5.T3.10.8.8.1.1" style="font-size:70%;">1.7</span>
</td>
</tr>
<tr class="ltx_tr" id="S5.T3.11.9.9">
<td class="ltx_td" id="S5.T3.11.9.9.2"></td>
<td class="ltx_td ltx_align_center" id="S5.T3.11.9.9.3">✓</td>
<td class="ltx_td ltx_align_center" id="S5.T3.11.9.9.4">✓</td>
<td class="ltx_td ltx_align_center" id="S5.T3.11.9.9.5">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.11.9.9.6">✓</td>
<td class="ltx_td ltx_align_center" id="S5.T3.11.9.9.7">8.0%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.11.9.9.8">2.45</td>
<td class="ltx_td ltx_align_center" id="S5.T3.11.9.9.9">2.88</td>
<td class="ltx_td ltx_align_center" id="S5.T3.11.9.9.1">68.3<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T3.11.9.9.1.m1.1"><semantics id="S5.T3.11.9.9.1.m1.1a"><mo id="S5.T3.11.9.9.1.m1.1.1" mathsize="70%" xref="S5.T3.11.9.9.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.11.9.9.1.m1.1b"><csymbol cd="latexml" id="S5.T3.11.9.9.1.m1.1.1.cmml" xref="S5.T3.11.9.9.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.11.9.9.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T3.11.9.9.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S5.T3.11.9.9.1.1" style="font-size:70%;">1.7</span>
</td>
</tr>
<tr class="ltx_tr" id="S5.T3.12.10.10">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.12.10.10.2">✓</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.12.10.10.3">✓</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.12.10.10.4">✓</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.12.10.10.5">✓</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S5.T3.12.10.10.6">✓</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.12.10.10.7">8.1%</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.12.10.10.8">2.82</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.12.10.10.9">2.89</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.12.10.10.1">64.0<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T3.12.10.10.1.m1.1"><semantics id="S5.T3.12.10.10.1.m1.1a"><mo id="S5.T3.12.10.10.1.m1.1.1" mathsize="70%" xref="S5.T3.12.10.10.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.12.10.10.1.m1.1b"><csymbol cd="latexml" id="S5.T3.12.10.10.1.m1.1.1.cmml" xref="S5.T3.12.10.10.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.12.10.10.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T3.12.10.10.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S5.T3.12.10.10.1.1" style="font-size:70%;">1.7</span>
</td>
</tr>
</tbody>
</table>
</span></div>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_table" id="S5.T4">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span><span class="ltx_text ltx_font_bold" id="S5.T4.20.1">Audio quality evaluation</span>. Objective and subjective (MUSHRA) evaluation of audio quality for baseline neural audio codecs—RVQGAN&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Kumar et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib52" title="">2024</a>)</cite>, SemantiCodec&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Liu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib59" title="">2024</a>)</cite>, and SpeechTokenizer &nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Zhang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib113" title="">2024b</a>)</cite>— and the most important variants of Mimi. For a fair comparison with SemantiCodec and SpeechTokenizer, we also include a downsampled version of our codec in the MUSHRA study. <math alttext="f_{s}" class="ltx_Math" display="inline" id="S5.T4.3.m1.1"><semantics id="S5.T4.3.m1.1b"><msub id="S5.T4.3.m1.1.1" xref="S5.T4.3.m1.1.1.cmml"><mi id="S5.T4.3.m1.1.1.2" xref="S5.T4.3.m1.1.1.2.cmml">f</mi><mi id="S5.T4.3.m1.1.1.3" xref="S5.T4.3.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S5.T4.3.m1.1c"><apply id="S5.T4.3.m1.1.1.cmml" xref="S5.T4.3.m1.1.1"><csymbol cd="ambiguous" id="S5.T4.3.m1.1.1.1.cmml" xref="S5.T4.3.m1.1.1">subscript</csymbol><ci id="S5.T4.3.m1.1.1.2.cmml" xref="S5.T4.3.m1.1.1.2">𝑓</ci><ci id="S5.T4.3.m1.1.1.3.cmml" xref="S5.T4.3.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.3.m1.1d">f_{s}</annotation><annotation encoding="application/x-llamapun" id="S5.T4.3.m1.1e">italic_f start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> is the audio sample rate and <math alttext="f_{r}" class="ltx_Math" display="inline" id="S5.T4.4.m2.1"><semantics id="S5.T4.4.m2.1b"><msub id="S5.T4.4.m2.1.1" xref="S5.T4.4.m2.1.1.cmml"><mi id="S5.T4.4.m2.1.1.2" xref="S5.T4.4.m2.1.1.2.cmml">f</mi><mi id="S5.T4.4.m2.1.1.3" xref="S5.T4.4.m2.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S5.T4.4.m2.1c"><apply id="S5.T4.4.m2.1.1.cmml" xref="S5.T4.4.m2.1.1"><csymbol cd="ambiguous" id="S5.T4.4.m2.1.1.1.cmml" xref="S5.T4.4.m2.1.1">subscript</csymbol><ci id="S5.T4.4.m2.1.1.2.cmml" xref="S5.T4.4.m2.1.1.2">𝑓</ci><ci id="S5.T4.4.m2.1.1.3.cmml" xref="S5.T4.4.m2.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.4.m2.1d">f_{r}</annotation><annotation encoding="application/x-llamapun" id="S5.T4.4.m2.1e">italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math> the codec frame rate. Both Mimi codecs are trained with distillation, and either with the same combination of reconstruction and adversarial losses as Encodec (see <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS3" title="3.3 Audio Tokenization ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue">Section&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></span></a>) or adversarial losses only.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S5.T4.18" style="width:433.6pt;height:124.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-65.4pt,18.8pt) scale(0.768185237349762,0.768185237349762) ;">
<table class="ltx_tabular ltx_align_middle" id="S5.T4.18.14">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T4.10.6.6">
<td class="ltx_td ltx_align_left ltx_border_tt" id="S5.T4.10.6.6.7">Model</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T4.5.1.1.1"><math alttext="f_{s}" class="ltx_Math" display="inline" id="S5.T4.5.1.1.1.m1.1"><semantics id="S5.T4.5.1.1.1.m1.1a"><msub id="S5.T4.5.1.1.1.m1.1.1" xref="S5.T4.5.1.1.1.m1.1.1.cmml"><mi id="S5.T4.5.1.1.1.m1.1.1.2" xref="S5.T4.5.1.1.1.m1.1.1.2.cmml">f</mi><mi id="S5.T4.5.1.1.1.m1.1.1.3" xref="S5.T4.5.1.1.1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S5.T4.5.1.1.1.m1.1b"><apply id="S5.T4.5.1.1.1.m1.1.1.cmml" xref="S5.T4.5.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T4.5.1.1.1.m1.1.1.1.cmml" xref="S5.T4.5.1.1.1.m1.1.1">subscript</csymbol><ci id="S5.T4.5.1.1.1.m1.1.1.2.cmml" xref="S5.T4.5.1.1.1.m1.1.1.2">𝑓</ci><ci id="S5.T4.5.1.1.1.m1.1.1.3.cmml" xref="S5.T4.5.1.1.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.5.1.1.1.m1.1c">f_{s}</annotation><annotation encoding="application/x-llamapun" id="S5.T4.5.1.1.1.m1.1d">italic_f start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T4.6.2.2.2"><math alttext="f_{r}" class="ltx_Math" display="inline" id="S5.T4.6.2.2.2.m1.1"><semantics id="S5.T4.6.2.2.2.m1.1a"><msub id="S5.T4.6.2.2.2.m1.1.1" xref="S5.T4.6.2.2.2.m1.1.1.cmml"><mi id="S5.T4.6.2.2.2.m1.1.1.2" xref="S5.T4.6.2.2.2.m1.1.1.2.cmml">f</mi><mi id="S5.T4.6.2.2.2.m1.1.1.3" xref="S5.T4.6.2.2.2.m1.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S5.T4.6.2.2.2.m1.1b"><apply id="S5.T4.6.2.2.2.m1.1.1.cmml" xref="S5.T4.6.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="S5.T4.6.2.2.2.m1.1.1.1.cmml" xref="S5.T4.6.2.2.2.m1.1.1">subscript</csymbol><ci id="S5.T4.6.2.2.2.m1.1.1.2.cmml" xref="S5.T4.6.2.2.2.m1.1.1.2">𝑓</ci><ci id="S5.T4.6.2.2.2.m1.1.1.3.cmml" xref="S5.T4.6.2.2.2.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.6.2.2.2.m1.1c">f_{r}</annotation><annotation encoding="application/x-llamapun" id="S5.T4.6.2.2.2.m1.1d">italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T4.10.6.6.8">bitrate</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S5.T4.10.6.6.9">causal</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T4.7.3.3.3">ABX (<math alttext="\downarrow" class="ltx_Math" display="inline" id="S5.T4.7.3.3.3.m1.1"><semantics id="S5.T4.7.3.3.3.m1.1a"><mo id="S5.T4.7.3.3.3.m1.1.1" stretchy="false" xref="S5.T4.7.3.3.3.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T4.7.3.3.3.m1.1b"><ci id="S5.T4.7.3.3.3.m1.1.1.cmml" xref="S5.T4.7.3.3.3.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.7.3.3.3.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T4.7.3.3.3.m1.1d">↓</annotation></semantics></math>)</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T4.8.4.4.4">VisQOL (<math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.T4.8.4.4.4.m1.1"><semantics id="S5.T4.8.4.4.4.m1.1a"><mo id="S5.T4.8.4.4.4.m1.1.1" stretchy="false" xref="S5.T4.8.4.4.4.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T4.8.4.4.4.m1.1b"><ci id="S5.T4.8.4.4.4.m1.1.1.cmml" xref="S5.T4.8.4.4.4.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.8.4.4.4.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T4.8.4.4.4.m1.1d">↑</annotation></semantics></math>)</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S5.T4.9.5.5.5">MOSNet (<math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.T4.9.5.5.5.m1.1"><semantics id="S5.T4.9.5.5.5.m1.1a"><mo id="S5.T4.9.5.5.5.m1.1.1" stretchy="false" xref="S5.T4.9.5.5.5.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T4.9.5.5.5.m1.1b"><ci id="S5.T4.9.5.5.5.m1.1.1.cmml" xref="S5.T4.9.5.5.5.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.9.5.5.5.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T4.9.5.5.5.m1.1d">↑</annotation></semantics></math>)</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T4.10.6.6.6">
<span class="ltx_text ltx_font_smallcaps" id="S5.T4.10.6.6.6.1">MUSHRA</span> (<math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.T4.10.6.6.6.m1.1"><semantics id="S5.T4.10.6.6.6.m1.1a"><mo id="S5.T4.10.6.6.6.m1.1.1" stretchy="false" xref="S5.T4.10.6.6.6.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T4.10.6.6.6.m1.1b"><ci id="S5.T4.10.6.6.6.m1.1.1.cmml" xref="S5.T4.10.6.6.6.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.10.6.6.6.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T4.10.6.6.6.m1.1d">↑</annotation></semantics></math>)</td>
</tr>
<tr class="ltx_tr" id="S5.T4.11.7.7">
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T4.11.7.7.2">Ground Truth</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.11.7.7.3">24kHz</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.11.7.7.4">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.11.7.7.5">-</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T4.11.7.7.6">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.11.7.7.7">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.11.7.7.8">-</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T4.11.7.7.9">3.08</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.11.7.7.1">90.6<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T4.11.7.7.1.m1.1"><semantics id="S5.T4.11.7.7.1.m1.1a"><mo id="S5.T4.11.7.7.1.m1.1.1" mathsize="70%" xref="S5.T4.11.7.7.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.11.7.7.1.m1.1b"><csymbol cd="latexml" id="S5.T4.11.7.7.1.m1.1.1.cmml" xref="S5.T4.11.7.7.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.11.7.7.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T4.11.7.7.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S5.T4.11.7.7.1.1" style="font-size:70%;">1.0</span>
</td>
</tr>
<tr class="ltx_tr" id="S5.T4.12.8.8">
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T4.12.8.8.2">RVQGAN</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.12.8.8.3">24kHz</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.12.8.8.4">75Hz</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.12.8.8.5">1.5kbps</td>
<td class="ltx_td ltx_border_r ltx_border_t" id="S5.T4.12.8.8.6"></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.12.8.8.7">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.12.8.8.8">1.74</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T4.12.8.8.9">2.74</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.12.8.8.1">31.3<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T4.12.8.8.1.m1.1"><semantics id="S5.T4.12.8.8.1.m1.1a"><mo id="S5.T4.12.8.8.1.m1.1.1" mathsize="70%" xref="S5.T4.12.8.8.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.12.8.8.1.m1.1b"><csymbol cd="latexml" id="S5.T4.12.8.8.1.m1.1.1.cmml" xref="S5.T4.12.8.8.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.12.8.8.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T4.12.8.8.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S5.T4.12.8.8.1.1" style="font-size:70%;">1.3</span>
</td>
</tr>
<tr class="ltx_tr" id="S5.T4.13.9.9">
<td class="ltx_td ltx_align_left" id="S5.T4.13.9.9.2">SemantiCodec</td>
<td class="ltx_td ltx_align_center" id="S5.T4.13.9.9.3">16kHz</td>
<td class="ltx_td ltx_align_center" id="S5.T4.13.9.9.4">50Hz</td>
<td class="ltx_td ltx_align_center" id="S5.T4.13.9.9.5">1.3kbps</td>
<td class="ltx_td ltx_border_r" id="S5.T4.13.9.9.6"></td>
<td class="ltx_td ltx_align_center" id="S5.T4.13.9.9.7">42.2%</td>
<td class="ltx_td ltx_align_center" id="S5.T4.13.9.9.8">2.43</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T4.13.9.9.9">3.12</td>
<td class="ltx_td ltx_align_center" id="S5.T4.13.9.9.1">64.8<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T4.13.9.9.1.m1.1"><semantics id="S5.T4.13.9.9.1.m1.1a"><mo id="S5.T4.13.9.9.1.m1.1.1" mathsize="70%" xref="S5.T4.13.9.9.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.13.9.9.1.m1.1b"><csymbol cd="latexml" id="S5.T4.13.9.9.1.m1.1.1.cmml" xref="S5.T4.13.9.9.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.13.9.9.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T4.13.9.9.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S5.T4.13.9.9.1.1" style="font-size:70%;">1.5</span>
</td>
</tr>
<tr class="ltx_tr" id="S5.T4.14.10.10">
<td class="ltx_td ltx_align_left" id="S5.T4.14.10.10.2">SpeechTokenizer</td>
<td class="ltx_td ltx_align_center" id="S5.T4.14.10.10.3">16kHz</td>
<td class="ltx_td ltx_align_center" id="S5.T4.14.10.10.4">50Hz</td>
<td class="ltx_td ltx_align_center" id="S5.T4.14.10.10.5">1.5kbps</td>
<td class="ltx_td ltx_border_r" id="S5.T4.14.10.10.6"></td>
<td class="ltx_td ltx_align_center" id="S5.T4.14.10.10.7"><span class="ltx_text ltx_font_bold" id="S5.T4.14.10.10.7.1">3.3%</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.14.10.10.8">1.53</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T4.14.10.10.9">2.67</td>
<td class="ltx_td ltx_align_center" id="S5.T4.14.10.10.1">45.1<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T4.14.10.10.1.m1.1"><semantics id="S5.T4.14.10.10.1.m1.1a"><mo id="S5.T4.14.10.10.1.m1.1.1" mathsize="70%" xref="S5.T4.14.10.10.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.14.10.10.1.m1.1b"><csymbol cd="latexml" id="S5.T4.14.10.10.1.m1.1.1.cmml" xref="S5.T4.14.10.10.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.14.10.10.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T4.14.10.10.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S5.T4.14.10.10.1.1" style="font-size:70%;">1.5</span>
</td>
</tr>
<tr class="ltx_tr" id="S5.T4.15.11.11">
<td class="ltx_td ltx_align_left" id="S5.T4.15.11.11.2">SpeechTokenizer</td>
<td class="ltx_td ltx_align_center" id="S5.T4.15.11.11.3">16kHz</td>
<td class="ltx_td ltx_align_center" id="S5.T4.15.11.11.4">50Hz</td>
<td class="ltx_td ltx_align_center" id="S5.T4.15.11.11.5">4.0kbps</td>
<td class="ltx_td ltx_border_r" id="S5.T4.15.11.11.6"></td>
<td class="ltx_td ltx_align_center" id="S5.T4.15.11.11.7"><span class="ltx_text ltx_font_bold" id="S5.T4.15.11.11.7.1">3.3%</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.15.11.11.8">3.07</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T4.15.11.11.9">3.10</td>
<td class="ltx_td ltx_align_center" id="S5.T4.15.11.11.1">74.3<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T4.15.11.11.1.m1.1"><semantics id="S5.T4.15.11.11.1.m1.1a"><mo id="S5.T4.15.11.11.1.m1.1.1" mathsize="70%" xref="S5.T4.15.11.11.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.15.11.11.1.m1.1b"><csymbol cd="latexml" id="S5.T4.15.11.11.1.m1.1.1.cmml" xref="S5.T4.15.11.11.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.15.11.11.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T4.15.11.11.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S5.T4.15.11.11.1.1" style="font-size:70%;">1.5</span>
</td>
</tr>
<tr class="ltx_tr" id="S5.T4.16.12.12">
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T4.16.12.12.2">Mimi, adv. loss only</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.16.12.12.3">24kHz</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.16.12.12.4">12.5Hz</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.16.12.12.5">1.1kbps</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T4.16.12.12.6">✓</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.16.12.12.7">8.7%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.16.12.12.8">1.84</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T4.16.12.12.9">3.10</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.16.12.12.1">
<span class="ltx_text ltx_font_bold" id="S5.T4.16.12.12.1.1">81.0<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T4.16.12.12.1.1.m1.1"><semantics id="S5.T4.16.12.12.1.1.m1.1a"><mo id="S5.T4.16.12.12.1.1.m1.1.1" mathsize="70%" xref="S5.T4.16.12.12.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.16.12.12.1.1.m1.1b"><csymbol cd="latexml" id="S5.T4.16.12.12.1.1.m1.1.1.cmml" xref="S5.T4.16.12.12.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.16.12.12.1.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T4.16.12.12.1.1.m1.1d">±</annotation></semantics></math></span><span class="ltx_text" id="S5.T4.16.12.12.1.2" style="font-size:70%;">1.3</span>
</td>
</tr>
<tr class="ltx_tr" id="S5.T4.17.13.13">
<td class="ltx_td ltx_align_left" id="S5.T4.17.13.13.2">Same, downsampled at 16kHz</td>
<td class="ltx_td ltx_align_center" id="S5.T4.17.13.13.3">16kHz</td>
<td class="ltx_td ltx_align_center" id="S5.T4.17.13.13.4">12.5Hz</td>
<td class="ltx_td ltx_align_center" id="S5.T4.17.13.13.5">1.1kbps</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T4.17.13.13.6">✓</td>
<td class="ltx_td ltx_align_center" id="S5.T4.17.13.13.7">-</td>
<td class="ltx_td ltx_align_center" id="S5.T4.17.13.13.8">-</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T4.17.13.13.9">-</td>
<td class="ltx_td ltx_align_center" id="S5.T4.17.13.13.1">77.7<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T4.17.13.13.1.m1.1"><semantics id="S5.T4.17.13.13.1.m1.1a"><mo id="S5.T4.17.13.13.1.m1.1.1" mathsize="70%" xref="S5.T4.17.13.13.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.17.13.13.1.m1.1b"><csymbol cd="latexml" id="S5.T4.17.13.13.1.m1.1.1.cmml" xref="S5.T4.17.13.13.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.17.13.13.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T4.17.13.13.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S5.T4.17.13.13.1.1" style="font-size:70%;">1.4</span>
</td>
</tr>
<tr class="ltx_tr" id="S5.T4.18.14.14">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S5.T4.18.14.14.2">Mimi, non adv. only</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.18.14.14.3">24kHz</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.18.14.14.4">12.5Hz</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.18.14.14.5">1.1kbps</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S5.T4.18.14.14.6">✓</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.18.14.14.7">8.1%</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.18.14.14.8">2.82</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S5.T4.18.14.14.9">2.89</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.18.14.14.1">58.8<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T4.18.14.14.1.m1.1"><semantics id="S5.T4.18.14.14.1.m1.1a"><mo id="S5.T4.18.14.14.1.m1.1.1" mathsize="70%" xref="S5.T4.18.14.14.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.18.14.14.1.m1.1b"><csymbol cd="latexml" id="S5.T4.18.14.14.1.m1.1.1.cmml" xref="S5.T4.18.14.14.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.18.14.14.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T4.18.14.14.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S5.T4.18.14.14.1.1" style="font-size:70%;">1.8</span>
</td>
</tr>
</tbody>
</table>
</span></div>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_paragraph" id="S5.SS2.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">Results - Semantic tokens.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS2.SSS0.Px3.p1">
<p class="ltx_p" id="S5.SS2.SSS0.Px3.p1.1"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.T3" title="Table 3 ‣ Baselines. ‣ 5.2 Audio Tokenization ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue">Table&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></span></a> shows that Mimi’s phonetic discriminability of semantic tokens, as measured by ABX, is poor in the absence of distillation and comparable to acoustic tokens of previous work&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Borsos et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib6" title="">2022</a>)</cite>: This means these semantic tokens are not amenable to capturing linguistic content from speech. In contrast, distilling WavLM into the semantic tokens significantly improves their phonetic discriminability, in particular when using a Transformer in Mimi’s encoder. This can be explained by the fact that distilling a large Transformer based encoder into a purely convolutional one is challenging, while increasing the capacity and receptive field of the encoder helps. Yet, we observe a conflict between acoustic losses and semantic distillation, as improving ABX implies reducing reconstruction quality (as measured by MUSHRA). Using a split RVQ as described in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS3.SSS2" title="3.3.2 Learning semantic-acoustic tokens with a split RVQ ‣ 3.3 Audio Tokenization ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue">Section&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3.2</span></span></a> improves the trade-off between semantic properties and audio quality, improving MUSHRA from 57.8 to 64.0 while moderately degrading ABX from 6.5% to 8.1%.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS2.SSS0.Px4">
<h5 class="ltx_title ltx_title_paragraph">Results - Acoustic tokens.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS2.SSS0.Px4.p1">
<p class="ltx_p" id="S5.SS2.SSS0.Px4.p1.2"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.T3" title="Table 3 ‣ Baselines. ‣ 5.2 Audio Tokenization ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue">Table&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></span></a> also shows a significant improvement in MUSHRA when adding a Transformer in the decoder. Similarly, using a quantization rate of <math alttext="50\%" class="ltx_Math" display="inline" id="S5.SS2.SSS0.Px4.p1.1.m1.1"><semantics id="S5.SS2.SSS0.Px4.p1.1.m1.1a"><mrow id="S5.SS2.SSS0.Px4.p1.1.m1.1.1" xref="S5.SS2.SSS0.Px4.p1.1.m1.1.1.cmml"><mn id="S5.SS2.SSS0.Px4.p1.1.m1.1.1.2" xref="S5.SS2.SSS0.Px4.p1.1.m1.1.1.2.cmml">50</mn><mo id="S5.SS2.SSS0.Px4.p1.1.m1.1.1.1" xref="S5.SS2.SSS0.Px4.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px4.p1.1.m1.1b"><apply id="S5.SS2.SSS0.Px4.p1.1.m1.1.1.cmml" xref="S5.SS2.SSS0.Px4.p1.1.m1.1.1"><csymbol cd="latexml" id="S5.SS2.SSS0.Px4.p1.1.m1.1.1.1.cmml" xref="S5.SS2.SSS0.Px4.p1.1.m1.1.1.1">percent</csymbol><cn id="S5.SS2.SSS0.Px4.p1.1.m1.1.1.2.cmml" type="integer" xref="S5.SS2.SSS0.Px4.p1.1.m1.1.1.2">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px4.p1.1.m1.1c">50\%</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.SSS0.Px4.p1.1.m1.1d">50 %</annotation></semantics></math> significantly improves VisQOL. Quantization rate however does not improve perceived quality. More generally, we observe a poor correlation between VisQOL and MOSNet. In particular, <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.T4" title="Table 4 ‣ Baselines. ‣ 5.2 Audio Tokenization ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue">Table&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></span></a> shows that training Mimi with adversarial losses only leads to a very low VisQOL of 1.84 which does not account for the high perceived audio quality. We thus rely on MUSHRA where raters are asked to judge the similarity of a reconstructed audio to its ground-truth anchor, with a score between 0 and 100. This human evaluation shows a significant improvement from using adversarial losses only, with a MUSHRA score of 81.0 against 58.8 when using the mix of loss functions used in Encodec. Mimi moreover significantly outperforms RVQGAN&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Kumar et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib51" title="">2023</a>)</cite> despite operating at a lower bitrate and modeling semantic information. Mimi also provides higher reconstruction quality than SemantiCodec&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Liu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib59" title="">2024</a>)</cite> while operating at a 4<math alttext="\times" class="ltx_Math" display="inline" id="S5.SS2.SSS0.Px4.p1.2.m2.1"><semantics id="S5.SS2.SSS0.Px4.p1.2.m2.1a"><mo id="S5.SS2.SSS0.Px4.p1.2.m2.1.1" xref="S5.SS2.SSS0.Px4.p1.2.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px4.p1.2.m2.1b"><times id="S5.SS2.SSS0.Px4.p1.2.m2.1.1.cmml" xref="S5.SS2.SSS0.Px4.p1.2.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px4.p1.2.m2.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.SSS0.Px4.p1.2.m2.1d">×</annotation></semantics></math> lower framerate. This property is crucial to achieve the low latency of Moshi, since generating one temporal frame of audio tokens with Moshi requires a full forward pass through the Temporal Transformer. Finally, both RVQGAN and SemantiCodec are non-causal, while Mimi is fully causal and thus compatible with streaming inference and modeling of real-time conversations.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS2.SSS0.Px5">
<h5 class="ltx_title ltx_title_paragraph">Discussion.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS2.SSS0.Px5.p1">
<p class="ltx_p" id="S5.SS2.SSS0.Px5.p1.1">Mimi overall provides high reconstruction quality while encoding semantic information, being fully causal, and operating at low framerate and bitrate. In consequence, Mimi proves to be a well-fitted audio tokenizer to train real-time audio language models. A collateral finding of our study is a concerning lack of correlation between objective and subjective audio quality metrics. In particular, while we find VisQOL to provide a reliable proxy for perceived quality when modifying the generator architecture, changing the training objective (e.g. removing reconstruction losses) moves the score in directions that are completely decorrelated from human perception. This observation underscores the open challenge of designing reliable objective proxies for perceived quality.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="S5.T5">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 5: </span>
<span class="ltx_text ltx_font_bold" id="S5.T5.16.1">Ablation study on the use of the RQ-Transformer</span>. All models are initialized with Helium and pretrained on audio. When not using RQ-Transformer, we predict the 8 levels of tokens with independent classification heads, following&nbsp;<cite class="ltx_cite ltx_citemacro_citet">Copet et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib18" title="">2023</a>)</cite>. Note that perplexities are only comparable between models with a given delay, as the classification task is easier with more delay for higher tokens.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T5.8">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T5.8.9.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T5.8.9.1.1"><span class="ltx_text" id="S5.T5.8.9.1.1.1" style="font-size:80%;">Acoustic Delay</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T5.8.9.1.2"><span class="ltx_text" id="S5.T5.8.9.1.2.1" style="font-size:80%;">RQ-Transformer</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T5.8.9.1.3"><span class="ltx_text" id="S5.T5.8.9.1.3.1" style="font-size:80%;">Perplexity</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T5.2.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.1.1.1"><math alttext="[0,1,2,3,4,5,6,7]" class="ltx_Math" display="inline" id="S5.T5.1.1.1.m1.8"><semantics id="S5.T5.1.1.1.m1.8a"><mrow id="S5.T5.1.1.1.m1.8.9.2" xref="S5.T5.1.1.1.m1.8.9.1.cmml"><mo id="S5.T5.1.1.1.m1.8.9.2.1" maxsize="80%" minsize="80%" xref="S5.T5.1.1.1.m1.8.9.1.cmml">[</mo><mn id="S5.T5.1.1.1.m1.1.1" mathsize="80%" xref="S5.T5.1.1.1.m1.1.1.cmml">0</mn><mo id="S5.T5.1.1.1.m1.8.9.2.2" mathsize="80%" xref="S5.T5.1.1.1.m1.8.9.1.cmml">,</mo><mn id="S5.T5.1.1.1.m1.2.2" mathsize="80%" xref="S5.T5.1.1.1.m1.2.2.cmml">1</mn><mo id="S5.T5.1.1.1.m1.8.9.2.3" mathsize="80%" xref="S5.T5.1.1.1.m1.8.9.1.cmml">,</mo><mn id="S5.T5.1.1.1.m1.3.3" mathsize="80%" xref="S5.T5.1.1.1.m1.3.3.cmml">2</mn><mo id="S5.T5.1.1.1.m1.8.9.2.4" mathsize="80%" xref="S5.T5.1.1.1.m1.8.9.1.cmml">,</mo><mn id="S5.T5.1.1.1.m1.4.4" mathsize="80%" xref="S5.T5.1.1.1.m1.4.4.cmml">3</mn><mo id="S5.T5.1.1.1.m1.8.9.2.5" mathsize="80%" xref="S5.T5.1.1.1.m1.8.9.1.cmml">,</mo><mn id="S5.T5.1.1.1.m1.5.5" mathsize="80%" xref="S5.T5.1.1.1.m1.5.5.cmml">4</mn><mo id="S5.T5.1.1.1.m1.8.9.2.6" mathsize="80%" xref="S5.T5.1.1.1.m1.8.9.1.cmml">,</mo><mn id="S5.T5.1.1.1.m1.6.6" mathsize="80%" xref="S5.T5.1.1.1.m1.6.6.cmml">5</mn><mo id="S5.T5.1.1.1.m1.8.9.2.7" mathsize="80%" xref="S5.T5.1.1.1.m1.8.9.1.cmml">,</mo><mn id="S5.T5.1.1.1.m1.7.7" mathsize="80%" xref="S5.T5.1.1.1.m1.7.7.cmml">6</mn><mo id="S5.T5.1.1.1.m1.8.9.2.8" mathsize="80%" xref="S5.T5.1.1.1.m1.8.9.1.cmml">,</mo><mn id="S5.T5.1.1.1.m1.8.8" mathsize="80%" xref="S5.T5.1.1.1.m1.8.8.cmml">7</mn><mo id="S5.T5.1.1.1.m1.8.9.2.9" maxsize="80%" minsize="80%" xref="S5.T5.1.1.1.m1.8.9.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.T5.1.1.1.m1.8b"><list id="S5.T5.1.1.1.m1.8.9.1.cmml" xref="S5.T5.1.1.1.m1.8.9.2"><cn id="S5.T5.1.1.1.m1.1.1.cmml" type="integer" xref="S5.T5.1.1.1.m1.1.1">0</cn><cn id="S5.T5.1.1.1.m1.2.2.cmml" type="integer" xref="S5.T5.1.1.1.m1.2.2">1</cn><cn id="S5.T5.1.1.1.m1.3.3.cmml" type="integer" xref="S5.T5.1.1.1.m1.3.3">2</cn><cn id="S5.T5.1.1.1.m1.4.4.cmml" type="integer" xref="S5.T5.1.1.1.m1.4.4">3</cn><cn id="S5.T5.1.1.1.m1.5.5.cmml" type="integer" xref="S5.T5.1.1.1.m1.5.5">4</cn><cn id="S5.T5.1.1.1.m1.6.6.cmml" type="integer" xref="S5.T5.1.1.1.m1.6.6">5</cn><cn id="S5.T5.1.1.1.m1.7.7.cmml" type="integer" xref="S5.T5.1.1.1.m1.7.7">6</cn><cn id="S5.T5.1.1.1.m1.8.8.cmml" type="integer" xref="S5.T5.1.1.1.m1.8.8">7</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.1.1.1.m1.8c">[0,1,2,3,4,5,6,7]</annotation><annotation encoding="application/x-llamapun" id="S5.T5.1.1.1.m1.8d">[ 0 , 1 , 2 , 3 , 4 , 5 , 6 , 7 ]</annotation></semantics></math></td>
<td class="ltx_td ltx_border_t" id="S5.T5.2.2.3"></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.2.2.2"><math alttext="\phantom{1}42.2" class="ltx_Math" display="inline" id="S5.T5.2.2.2.m1.1"><semantics id="S5.T5.2.2.2.m1.1a"><mn id="S5.T5.2.2.2.m1.1.1" mathsize="80%" xref="S5.T5.2.2.2.m1.1.1.cmml">42.2</mn><annotation-xml encoding="MathML-Content" id="S5.T5.2.2.2.m1.1b"><cn id="S5.T5.2.2.2.m1.1.1.cmml" type="float" xref="S5.T5.2.2.2.m1.1.1">42.2</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.2.2.2.m1.1c">\phantom{1}42.2</annotation><annotation encoding="application/x-llamapun" id="S5.T5.2.2.2.m1.1d">42.2</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T5.4.4">
<td class="ltx_td ltx_align_center" id="S5.T5.3.3.1"><math alttext="[0,1,2,3,4,5,6,7]" class="ltx_Math" display="inline" id="S5.T5.3.3.1.m1.8"><semantics id="S5.T5.3.3.1.m1.8a"><mrow id="S5.T5.3.3.1.m1.8.9.2" xref="S5.T5.3.3.1.m1.8.9.1.cmml"><mo id="S5.T5.3.3.1.m1.8.9.2.1" maxsize="80%" minsize="80%" xref="S5.T5.3.3.1.m1.8.9.1.cmml">[</mo><mn id="S5.T5.3.3.1.m1.1.1" mathsize="80%" xref="S5.T5.3.3.1.m1.1.1.cmml">0</mn><mo id="S5.T5.3.3.1.m1.8.9.2.2" mathsize="80%" xref="S5.T5.3.3.1.m1.8.9.1.cmml">,</mo><mn id="S5.T5.3.3.1.m1.2.2" mathsize="80%" xref="S5.T5.3.3.1.m1.2.2.cmml">1</mn><mo id="S5.T5.3.3.1.m1.8.9.2.3" mathsize="80%" xref="S5.T5.3.3.1.m1.8.9.1.cmml">,</mo><mn id="S5.T5.3.3.1.m1.3.3" mathsize="80%" xref="S5.T5.3.3.1.m1.3.3.cmml">2</mn><mo id="S5.T5.3.3.1.m1.8.9.2.4" mathsize="80%" xref="S5.T5.3.3.1.m1.8.9.1.cmml">,</mo><mn id="S5.T5.3.3.1.m1.4.4" mathsize="80%" xref="S5.T5.3.3.1.m1.4.4.cmml">3</mn><mo id="S5.T5.3.3.1.m1.8.9.2.5" mathsize="80%" xref="S5.T5.3.3.1.m1.8.9.1.cmml">,</mo><mn id="S5.T5.3.3.1.m1.5.5" mathsize="80%" xref="S5.T5.3.3.1.m1.5.5.cmml">4</mn><mo id="S5.T5.3.3.1.m1.8.9.2.6" mathsize="80%" xref="S5.T5.3.3.1.m1.8.9.1.cmml">,</mo><mn id="S5.T5.3.3.1.m1.6.6" mathsize="80%" xref="S5.T5.3.3.1.m1.6.6.cmml">5</mn><mo id="S5.T5.3.3.1.m1.8.9.2.7" mathsize="80%" xref="S5.T5.3.3.1.m1.8.9.1.cmml">,</mo><mn id="S5.T5.3.3.1.m1.7.7" mathsize="80%" xref="S5.T5.3.3.1.m1.7.7.cmml">6</mn><mo id="S5.T5.3.3.1.m1.8.9.2.8" mathsize="80%" xref="S5.T5.3.3.1.m1.8.9.1.cmml">,</mo><mn id="S5.T5.3.3.1.m1.8.8" mathsize="80%" xref="S5.T5.3.3.1.m1.8.8.cmml">7</mn><mo id="S5.T5.3.3.1.m1.8.9.2.9" maxsize="80%" minsize="80%" xref="S5.T5.3.3.1.m1.8.9.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.T5.3.3.1.m1.8b"><list id="S5.T5.3.3.1.m1.8.9.1.cmml" xref="S5.T5.3.3.1.m1.8.9.2"><cn id="S5.T5.3.3.1.m1.1.1.cmml" type="integer" xref="S5.T5.3.3.1.m1.1.1">0</cn><cn id="S5.T5.3.3.1.m1.2.2.cmml" type="integer" xref="S5.T5.3.3.1.m1.2.2">1</cn><cn id="S5.T5.3.3.1.m1.3.3.cmml" type="integer" xref="S5.T5.3.3.1.m1.3.3">2</cn><cn id="S5.T5.3.3.1.m1.4.4.cmml" type="integer" xref="S5.T5.3.3.1.m1.4.4">3</cn><cn id="S5.T5.3.3.1.m1.5.5.cmml" type="integer" xref="S5.T5.3.3.1.m1.5.5">4</cn><cn id="S5.T5.3.3.1.m1.6.6.cmml" type="integer" xref="S5.T5.3.3.1.m1.6.6">5</cn><cn id="S5.T5.3.3.1.m1.7.7.cmml" type="integer" xref="S5.T5.3.3.1.m1.7.7">6</cn><cn id="S5.T5.3.3.1.m1.8.8.cmml" type="integer" xref="S5.T5.3.3.1.m1.8.8">7</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.3.3.1.m1.8c">[0,1,2,3,4,5,6,7]</annotation><annotation encoding="application/x-llamapun" id="S5.T5.3.3.1.m1.8d">[ 0 , 1 , 2 , 3 , 4 , 5 , 6 , 7 ]</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S5.T5.4.4.3"><span class="ltx_text" id="S5.T5.4.4.3.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td ltx_align_center" id="S5.T5.4.4.2"><math alttext="\phantom{1}40.3" class="ltx_Math" display="inline" id="S5.T5.4.4.2.m1.1"><semantics id="S5.T5.4.4.2.m1.1a"><mn id="S5.T5.4.4.2.m1.1.1" mathsize="80%" xref="S5.T5.4.4.2.m1.1.1.cmml">40.3</mn><annotation-xml encoding="MathML-Content" id="S5.T5.4.4.2.m1.1b"><cn id="S5.T5.4.4.2.m1.1.1.cmml" type="float" xref="S5.T5.4.4.2.m1.1.1">40.3</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.4.4.2.m1.1c">\phantom{1}40.3</annotation><annotation encoding="application/x-llamapun" id="S5.T5.4.4.2.m1.1d">40.3</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T5.6.6">
<td class="ltx_td ltx_align_center" id="S5.T5.5.5.1"><math alttext="[0,2,2,2,2,2,2,2]" class="ltx_Math" display="inline" id="S5.T5.5.5.1.m1.8"><semantics id="S5.T5.5.5.1.m1.8a"><mrow id="S5.T5.5.5.1.m1.8.9.2" xref="S5.T5.5.5.1.m1.8.9.1.cmml"><mo id="S5.T5.5.5.1.m1.8.9.2.1" maxsize="80%" minsize="80%" xref="S5.T5.5.5.1.m1.8.9.1.cmml">[</mo><mn id="S5.T5.5.5.1.m1.1.1" mathsize="80%" xref="S5.T5.5.5.1.m1.1.1.cmml">0</mn><mo id="S5.T5.5.5.1.m1.8.9.2.2" mathsize="80%" xref="S5.T5.5.5.1.m1.8.9.1.cmml">,</mo><mn id="S5.T5.5.5.1.m1.2.2" mathsize="80%" xref="S5.T5.5.5.1.m1.2.2.cmml">2</mn><mo id="S5.T5.5.5.1.m1.8.9.2.3" mathsize="80%" xref="S5.T5.5.5.1.m1.8.9.1.cmml">,</mo><mn id="S5.T5.5.5.1.m1.3.3" mathsize="80%" xref="S5.T5.5.5.1.m1.3.3.cmml">2</mn><mo id="S5.T5.5.5.1.m1.8.9.2.4" mathsize="80%" xref="S5.T5.5.5.1.m1.8.9.1.cmml">,</mo><mn id="S5.T5.5.5.1.m1.4.4" mathsize="80%" xref="S5.T5.5.5.1.m1.4.4.cmml">2</mn><mo id="S5.T5.5.5.1.m1.8.9.2.5" mathsize="80%" xref="S5.T5.5.5.1.m1.8.9.1.cmml">,</mo><mn id="S5.T5.5.5.1.m1.5.5" mathsize="80%" xref="S5.T5.5.5.1.m1.5.5.cmml">2</mn><mo id="S5.T5.5.5.1.m1.8.9.2.6" mathsize="80%" xref="S5.T5.5.5.1.m1.8.9.1.cmml">,</mo><mn id="S5.T5.5.5.1.m1.6.6" mathsize="80%" xref="S5.T5.5.5.1.m1.6.6.cmml">2</mn><mo id="S5.T5.5.5.1.m1.8.9.2.7" mathsize="80%" xref="S5.T5.5.5.1.m1.8.9.1.cmml">,</mo><mn id="S5.T5.5.5.1.m1.7.7" mathsize="80%" xref="S5.T5.5.5.1.m1.7.7.cmml">2</mn><mo id="S5.T5.5.5.1.m1.8.9.2.8" mathsize="80%" xref="S5.T5.5.5.1.m1.8.9.1.cmml">,</mo><mn id="S5.T5.5.5.1.m1.8.8" mathsize="80%" xref="S5.T5.5.5.1.m1.8.8.cmml">2</mn><mo id="S5.T5.5.5.1.m1.8.9.2.9" maxsize="80%" minsize="80%" xref="S5.T5.5.5.1.m1.8.9.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.T5.5.5.1.m1.8b"><list id="S5.T5.5.5.1.m1.8.9.1.cmml" xref="S5.T5.5.5.1.m1.8.9.2"><cn id="S5.T5.5.5.1.m1.1.1.cmml" type="integer" xref="S5.T5.5.5.1.m1.1.1">0</cn><cn id="S5.T5.5.5.1.m1.2.2.cmml" type="integer" xref="S5.T5.5.5.1.m1.2.2">2</cn><cn id="S5.T5.5.5.1.m1.3.3.cmml" type="integer" xref="S5.T5.5.5.1.m1.3.3">2</cn><cn id="S5.T5.5.5.1.m1.4.4.cmml" type="integer" xref="S5.T5.5.5.1.m1.4.4">2</cn><cn id="S5.T5.5.5.1.m1.5.5.cmml" type="integer" xref="S5.T5.5.5.1.m1.5.5">2</cn><cn id="S5.T5.5.5.1.m1.6.6.cmml" type="integer" xref="S5.T5.5.5.1.m1.6.6">2</cn><cn id="S5.T5.5.5.1.m1.7.7.cmml" type="integer" xref="S5.T5.5.5.1.m1.7.7">2</cn><cn id="S5.T5.5.5.1.m1.8.8.cmml" type="integer" xref="S5.T5.5.5.1.m1.8.8">2</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.5.5.1.m1.8c">[0,2,2,2,2,2,2,2]</annotation><annotation encoding="application/x-llamapun" id="S5.T5.5.5.1.m1.8d">[ 0 , 2 , 2 , 2 , 2 , 2 , 2 , 2 ]</annotation></semantics></math></td>
<td class="ltx_td" id="S5.T5.6.6.3"></td>
<td class="ltx_td ltx_align_center" id="S5.T5.6.6.2"><math alttext="135.4" class="ltx_Math" display="inline" id="S5.T5.6.6.2.m1.1"><semantics id="S5.T5.6.6.2.m1.1a"><mn id="S5.T5.6.6.2.m1.1.1" mathsize="80%" xref="S5.T5.6.6.2.m1.1.1.cmml">135.4</mn><annotation-xml encoding="MathML-Content" id="S5.T5.6.6.2.m1.1b"><cn id="S5.T5.6.6.2.m1.1.1.cmml" type="float" xref="S5.T5.6.6.2.m1.1.1">135.4</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.6.6.2.m1.1c">135.4</annotation><annotation encoding="application/x-llamapun" id="S5.T5.6.6.2.m1.1d">135.4</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T5.8.8">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T5.7.7.1"><math alttext="[0,2,2,2,2,2,2,2]" class="ltx_Math" display="inline" id="S5.T5.7.7.1.m1.8"><semantics id="S5.T5.7.7.1.m1.8a"><mrow id="S5.T5.7.7.1.m1.8.9.2" xref="S5.T5.7.7.1.m1.8.9.1.cmml"><mo id="S5.T5.7.7.1.m1.8.9.2.1" maxsize="80%" minsize="80%" xref="S5.T5.7.7.1.m1.8.9.1.cmml">[</mo><mn id="S5.T5.7.7.1.m1.1.1" mathsize="80%" xref="S5.T5.7.7.1.m1.1.1.cmml">0</mn><mo id="S5.T5.7.7.1.m1.8.9.2.2" mathsize="80%" xref="S5.T5.7.7.1.m1.8.9.1.cmml">,</mo><mn id="S5.T5.7.7.1.m1.2.2" mathsize="80%" xref="S5.T5.7.7.1.m1.2.2.cmml">2</mn><mo id="S5.T5.7.7.1.m1.8.9.2.3" mathsize="80%" xref="S5.T5.7.7.1.m1.8.9.1.cmml">,</mo><mn id="S5.T5.7.7.1.m1.3.3" mathsize="80%" xref="S5.T5.7.7.1.m1.3.3.cmml">2</mn><mo id="S5.T5.7.7.1.m1.8.9.2.4" mathsize="80%" xref="S5.T5.7.7.1.m1.8.9.1.cmml">,</mo><mn id="S5.T5.7.7.1.m1.4.4" mathsize="80%" xref="S5.T5.7.7.1.m1.4.4.cmml">2</mn><mo id="S5.T5.7.7.1.m1.8.9.2.5" mathsize="80%" xref="S5.T5.7.7.1.m1.8.9.1.cmml">,</mo><mn id="S5.T5.7.7.1.m1.5.5" mathsize="80%" xref="S5.T5.7.7.1.m1.5.5.cmml">2</mn><mo id="S5.T5.7.7.1.m1.8.9.2.6" mathsize="80%" xref="S5.T5.7.7.1.m1.8.9.1.cmml">,</mo><mn id="S5.T5.7.7.1.m1.6.6" mathsize="80%" xref="S5.T5.7.7.1.m1.6.6.cmml">2</mn><mo id="S5.T5.7.7.1.m1.8.9.2.7" mathsize="80%" xref="S5.T5.7.7.1.m1.8.9.1.cmml">,</mo><mn id="S5.T5.7.7.1.m1.7.7" mathsize="80%" xref="S5.T5.7.7.1.m1.7.7.cmml">2</mn><mo id="S5.T5.7.7.1.m1.8.9.2.8" mathsize="80%" xref="S5.T5.7.7.1.m1.8.9.1.cmml">,</mo><mn id="S5.T5.7.7.1.m1.8.8" mathsize="80%" xref="S5.T5.7.7.1.m1.8.8.cmml">2</mn><mo id="S5.T5.7.7.1.m1.8.9.2.9" maxsize="80%" minsize="80%" xref="S5.T5.7.7.1.m1.8.9.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.T5.7.7.1.m1.8b"><list id="S5.T5.7.7.1.m1.8.9.1.cmml" xref="S5.T5.7.7.1.m1.8.9.2"><cn id="S5.T5.7.7.1.m1.1.1.cmml" type="integer" xref="S5.T5.7.7.1.m1.1.1">0</cn><cn id="S5.T5.7.7.1.m1.2.2.cmml" type="integer" xref="S5.T5.7.7.1.m1.2.2">2</cn><cn id="S5.T5.7.7.1.m1.3.3.cmml" type="integer" xref="S5.T5.7.7.1.m1.3.3">2</cn><cn id="S5.T5.7.7.1.m1.4.4.cmml" type="integer" xref="S5.T5.7.7.1.m1.4.4">2</cn><cn id="S5.T5.7.7.1.m1.5.5.cmml" type="integer" xref="S5.T5.7.7.1.m1.5.5">2</cn><cn id="S5.T5.7.7.1.m1.6.6.cmml" type="integer" xref="S5.T5.7.7.1.m1.6.6">2</cn><cn id="S5.T5.7.7.1.m1.7.7.cmml" type="integer" xref="S5.T5.7.7.1.m1.7.7">2</cn><cn id="S5.T5.7.7.1.m1.8.8.cmml" type="integer" xref="S5.T5.7.7.1.m1.8.8">2</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.7.7.1.m1.8c">[0,2,2,2,2,2,2,2]</annotation><annotation encoding="application/x-llamapun" id="S5.T5.7.7.1.m1.8d">[ 0 , 2 , 2 , 2 , 2 , 2 , 2 , 2 ]</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T5.8.8.3"><span class="ltx_text" id="S5.T5.8.8.3.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T5.8.8.2"><math alttext="\phantom{1}36.8" class="ltx_Math" display="inline" id="S5.T5.8.8.2.m1.1"><semantics id="S5.T5.8.8.2.m1.1a"><mn id="S5.T5.8.8.2.m1.1.1" mathsize="80%" xref="S5.T5.8.8.2.m1.1.1.cmml">36.8</mn><annotation-xml encoding="MathML-Content" id="S5.T5.8.8.2.m1.1b"><cn id="S5.T5.8.8.2.m1.1.1.cmml" type="float" xref="S5.T5.8.8.2.m1.1.1">36.8</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.8.8.2.m1.1c">\phantom{1}36.8</annotation><annotation encoding="application/x-llamapun" id="S5.T5.8.8.2.m1.1d">36.8</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_table" id="S5.T6">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 6: </span>
<span class="ltx_text ltx_font_bold" id="S5.T6.28.1">Ablation study on delay patterns, weight of the semantic token and Inner Monologue</span>. All models are initialized with Helium, pretrained on audio and use the RQ-Transformer. We vary the weight of the semantic token while keeping the weight of other tokens (including the text token when using Inner Monologue) to 1. As different delay patterns cannot be compared in terms of perplexity, we generate continuations from 3s prompts on the valid set, convert them into transcripts with Whisper&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Radford et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib77" title="">2023</a>)</cite> and report their negative log-likelihood with LiteLlama-460M-1T<span class="ltx_note ltx_role_footnote" id="footnote14"><sup class="ltx_note_mark">14</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">14</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text" id="footnote14.1.1.1" style="font-size:111%;">14</span></span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://huggingface.co/ahxt/LiteLlama-460M-1T" style="font-size:111%;" title="">https://huggingface.co/ahxt/LiteLlama-460M-1T</a></span></span></span> along with their length (in characters) as proxies for linguistic quality.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T6.18">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T6.18.19.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T6.18.19.1.1"><span class="ltx_text" id="S5.T6.18.19.1.1.1" style="font-size:80%;">Acoustic</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T6.18.19.1.2"><span class="ltx_text" id="S5.T6.18.19.1.2.1" style="font-size:80%;">Semantic Token</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T6.18.19.1.3"><span class="ltx_text" id="S5.T6.18.19.1.3.1" style="font-size:80%;">Depthwise</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T6.18.19.1.4"><span class="ltx_text" id="S5.T6.18.19.1.4.1" style="font-size:80%;">Inner</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T6.18.19.1.5"><span class="ltx_text" id="S5.T6.18.19.1.5.1" style="font-size:80%;">Transcript</span></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt" id="S5.T6.18.19.1.6"><span class="ltx_text" id="S5.T6.18.19.1.6.1" style="font-size:80%;">Transcript</span></th>
</tr>
<tr class="ltx_tr" id="S5.T6.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S5.T6.2.2.3"><span class="ltx_text" id="S5.T6.2.2.3.1" style="font-size:80%;">Delay</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S5.T6.2.2.4"><span class="ltx_text" id="S5.T6.2.2.4.1" style="font-size:80%;">Weight</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S5.T6.2.2.5"><span class="ltx_text" id="S5.T6.2.2.5.1" style="font-size:80%;">Parametrization</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S5.T6.2.2.6"><span class="ltx_text" id="S5.T6.2.2.6.1" style="font-size:80%;">Monologue</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S5.T6.1.1.1">
<span class="ltx_text" id="S5.T6.1.1.1.1" style="font-size:80%;">NLL (</span><math alttext="\downarrow" class="ltx_Math" display="inline" id="S5.T6.1.1.1.m1.1"><semantics id="S5.T6.1.1.1.m1.1a"><mo id="S5.T6.1.1.1.m1.1.1" mathsize="80%" stretchy="false" xref="S5.T6.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T6.1.1.1.m1.1b"><ci id="S5.T6.1.1.1.m1.1.1.cmml" xref="S5.T6.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.1.1.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T6.1.1.1.m1.1d">↓</annotation></semantics></math><span class="ltx_text" id="S5.T6.1.1.1.2" style="font-size:80%;">)</span>
</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column" id="S5.T6.2.2.2">
<span class="ltx_text" id="S5.T6.2.2.2.1" style="font-size:80%;">Length (</span><math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.T6.2.2.2.m1.1"><semantics id="S5.T6.2.2.2.m1.1a"><mo id="S5.T6.2.2.2.m1.1.1" mathsize="80%" stretchy="false" xref="S5.T6.2.2.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T6.2.2.2.m1.1b"><ci id="S5.T6.2.2.2.m1.1.1.cmml" xref="S5.T6.2.2.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.2.2.2.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T6.2.2.2.m1.1d">↑</annotation></semantics></math><span class="ltx_text" id="S5.T6.2.2.2.2" style="font-size:80%;">)</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T6.5.5">
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.3.3.1"><math alttext="[0,0,0,0,0,0,0,0]" class="ltx_Math" display="inline" id="S5.T6.3.3.1.m1.8"><semantics id="S5.T6.3.3.1.m1.8a"><mrow id="S5.T6.3.3.1.m1.8.9.2" xref="S5.T6.3.3.1.m1.8.9.1.cmml"><mo id="S5.T6.3.3.1.m1.8.9.2.1" maxsize="80%" minsize="80%" xref="S5.T6.3.3.1.m1.8.9.1.cmml">[</mo><mn id="S5.T6.3.3.1.m1.1.1" mathsize="80%" xref="S5.T6.3.3.1.m1.1.1.cmml">0</mn><mo id="S5.T6.3.3.1.m1.8.9.2.2" mathsize="80%" xref="S5.T6.3.3.1.m1.8.9.1.cmml">,</mo><mn id="S5.T6.3.3.1.m1.2.2" mathsize="80%" xref="S5.T6.3.3.1.m1.2.2.cmml">0</mn><mo id="S5.T6.3.3.1.m1.8.9.2.3" mathsize="80%" xref="S5.T6.3.3.1.m1.8.9.1.cmml">,</mo><mn id="S5.T6.3.3.1.m1.3.3" mathsize="80%" xref="S5.T6.3.3.1.m1.3.3.cmml">0</mn><mo id="S5.T6.3.3.1.m1.8.9.2.4" mathsize="80%" xref="S5.T6.3.3.1.m1.8.9.1.cmml">,</mo><mn id="S5.T6.3.3.1.m1.4.4" mathsize="80%" xref="S5.T6.3.3.1.m1.4.4.cmml">0</mn><mo id="S5.T6.3.3.1.m1.8.9.2.5" mathsize="80%" xref="S5.T6.3.3.1.m1.8.9.1.cmml">,</mo><mn id="S5.T6.3.3.1.m1.5.5" mathsize="80%" xref="S5.T6.3.3.1.m1.5.5.cmml">0</mn><mo id="S5.T6.3.3.1.m1.8.9.2.6" mathsize="80%" xref="S5.T6.3.3.1.m1.8.9.1.cmml">,</mo><mn id="S5.T6.3.3.1.m1.6.6" mathsize="80%" xref="S5.T6.3.3.1.m1.6.6.cmml">0</mn><mo id="S5.T6.3.3.1.m1.8.9.2.7" mathsize="80%" xref="S5.T6.3.3.1.m1.8.9.1.cmml">,</mo><mn id="S5.T6.3.3.1.m1.7.7" mathsize="80%" xref="S5.T6.3.3.1.m1.7.7.cmml">0</mn><mo id="S5.T6.3.3.1.m1.8.9.2.8" mathsize="80%" xref="S5.T6.3.3.1.m1.8.9.1.cmml">,</mo><mn id="S5.T6.3.3.1.m1.8.8" mathsize="80%" xref="S5.T6.3.3.1.m1.8.8.cmml">0</mn><mo id="S5.T6.3.3.1.m1.8.9.2.9" maxsize="80%" minsize="80%" xref="S5.T6.3.3.1.m1.8.9.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.T6.3.3.1.m1.8b"><list id="S5.T6.3.3.1.m1.8.9.1.cmml" xref="S5.T6.3.3.1.m1.8.9.2"><cn id="S5.T6.3.3.1.m1.1.1.cmml" type="integer" xref="S5.T6.3.3.1.m1.1.1">0</cn><cn id="S5.T6.3.3.1.m1.2.2.cmml" type="integer" xref="S5.T6.3.3.1.m1.2.2">0</cn><cn id="S5.T6.3.3.1.m1.3.3.cmml" type="integer" xref="S5.T6.3.3.1.m1.3.3">0</cn><cn id="S5.T6.3.3.1.m1.4.4.cmml" type="integer" xref="S5.T6.3.3.1.m1.4.4">0</cn><cn id="S5.T6.3.3.1.m1.5.5.cmml" type="integer" xref="S5.T6.3.3.1.m1.5.5">0</cn><cn id="S5.T6.3.3.1.m1.6.6.cmml" type="integer" xref="S5.T6.3.3.1.m1.6.6">0</cn><cn id="S5.T6.3.3.1.m1.7.7.cmml" type="integer" xref="S5.T6.3.3.1.m1.7.7">0</cn><cn id="S5.T6.3.3.1.m1.8.8.cmml" type="integer" xref="S5.T6.3.3.1.m1.8.8">0</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.3.3.1.m1.8c">[0,0,0,0,0,0,0,0]</annotation><annotation encoding="application/x-llamapun" id="S5.T6.3.3.1.m1.8d">[ 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 ]</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.5.5.4">
<span class="ltx_text ltx_phantom" id="S5.T6.5.5.4.1" style="font-size:80%;"><span style="visibility:hidden">00</span></span><span class="ltx_text" id="S5.T6.5.5.4.2" style="font-size:80%;">1.0</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.5.5.5"><span class="ltx_text" id="S5.T6.5.5.5.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td ltx_border_t" id="S5.T6.5.5.6"></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.4.4.2"><math alttext="4.36" class="ltx_Math" display="inline" id="S5.T6.4.4.2.m1.1"><semantics id="S5.T6.4.4.2.m1.1a"><mn id="S5.T6.4.4.2.m1.1.1" mathsize="80%" xref="S5.T6.4.4.2.m1.1.1.cmml">4.36</mn><annotation-xml encoding="MathML-Content" id="S5.T6.4.4.2.m1.1b"><cn id="S5.T6.4.4.2.m1.1.1.cmml" type="float" xref="S5.T6.4.4.2.m1.1.1">4.36</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.4.4.2.m1.1c">4.36</annotation><annotation encoding="application/x-llamapun" id="S5.T6.4.4.2.m1.1d">4.36</annotation></semantics></math></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T6.5.5.3"><math alttext="486" class="ltx_Math" display="inline" id="S5.T6.5.5.3.m1.1"><semantics id="S5.T6.5.5.3.m1.1a"><mn id="S5.T6.5.5.3.m1.1.1" mathsize="80%" xref="S5.T6.5.5.3.m1.1.1.cmml">486</mn><annotation-xml encoding="MathML-Content" id="S5.T6.5.5.3.m1.1b"><cn id="S5.T6.5.5.3.m1.1.1.cmml" type="integer" xref="S5.T6.5.5.3.m1.1.1">486</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.5.5.3.m1.1c">486</annotation><annotation encoding="application/x-llamapun" id="S5.T6.5.5.3.m1.1d">486</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T6.8.8">
<td class="ltx_td ltx_align_center" id="S5.T6.6.6.1"><math alttext="[0,1,1,1,1,1,1,1]" class="ltx_Math" display="inline" id="S5.T6.6.6.1.m1.8"><semantics id="S5.T6.6.6.1.m1.8a"><mrow id="S5.T6.6.6.1.m1.8.9.2" xref="S5.T6.6.6.1.m1.8.9.1.cmml"><mo id="S5.T6.6.6.1.m1.8.9.2.1" maxsize="80%" minsize="80%" xref="S5.T6.6.6.1.m1.8.9.1.cmml">[</mo><mn id="S5.T6.6.6.1.m1.1.1" mathsize="80%" xref="S5.T6.6.6.1.m1.1.1.cmml">0</mn><mo id="S5.T6.6.6.1.m1.8.9.2.2" mathsize="80%" xref="S5.T6.6.6.1.m1.8.9.1.cmml">,</mo><mn id="S5.T6.6.6.1.m1.2.2" mathsize="80%" xref="S5.T6.6.6.1.m1.2.2.cmml">1</mn><mo id="S5.T6.6.6.1.m1.8.9.2.3" mathsize="80%" xref="S5.T6.6.6.1.m1.8.9.1.cmml">,</mo><mn id="S5.T6.6.6.1.m1.3.3" mathsize="80%" xref="S5.T6.6.6.1.m1.3.3.cmml">1</mn><mo id="S5.T6.6.6.1.m1.8.9.2.4" mathsize="80%" xref="S5.T6.6.6.1.m1.8.9.1.cmml">,</mo><mn id="S5.T6.6.6.1.m1.4.4" mathsize="80%" xref="S5.T6.6.6.1.m1.4.4.cmml">1</mn><mo id="S5.T6.6.6.1.m1.8.9.2.5" mathsize="80%" xref="S5.T6.6.6.1.m1.8.9.1.cmml">,</mo><mn id="S5.T6.6.6.1.m1.5.5" mathsize="80%" xref="S5.T6.6.6.1.m1.5.5.cmml">1</mn><mo id="S5.T6.6.6.1.m1.8.9.2.6" mathsize="80%" xref="S5.T6.6.6.1.m1.8.9.1.cmml">,</mo><mn id="S5.T6.6.6.1.m1.6.6" mathsize="80%" xref="S5.T6.6.6.1.m1.6.6.cmml">1</mn><mo id="S5.T6.6.6.1.m1.8.9.2.7" mathsize="80%" xref="S5.T6.6.6.1.m1.8.9.1.cmml">,</mo><mn id="S5.T6.6.6.1.m1.7.7" mathsize="80%" xref="S5.T6.6.6.1.m1.7.7.cmml">1</mn><mo id="S5.T6.6.6.1.m1.8.9.2.8" mathsize="80%" xref="S5.T6.6.6.1.m1.8.9.1.cmml">,</mo><mn id="S5.T6.6.6.1.m1.8.8" mathsize="80%" xref="S5.T6.6.6.1.m1.8.8.cmml">1</mn><mo id="S5.T6.6.6.1.m1.8.9.2.9" maxsize="80%" minsize="80%" xref="S5.T6.6.6.1.m1.8.9.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.T6.6.6.1.m1.8b"><list id="S5.T6.6.6.1.m1.8.9.1.cmml" xref="S5.T6.6.6.1.m1.8.9.2"><cn id="S5.T6.6.6.1.m1.1.1.cmml" type="integer" xref="S5.T6.6.6.1.m1.1.1">0</cn><cn id="S5.T6.6.6.1.m1.2.2.cmml" type="integer" xref="S5.T6.6.6.1.m1.2.2">1</cn><cn id="S5.T6.6.6.1.m1.3.3.cmml" type="integer" xref="S5.T6.6.6.1.m1.3.3">1</cn><cn id="S5.T6.6.6.1.m1.4.4.cmml" type="integer" xref="S5.T6.6.6.1.m1.4.4">1</cn><cn id="S5.T6.6.6.1.m1.5.5.cmml" type="integer" xref="S5.T6.6.6.1.m1.5.5">1</cn><cn id="S5.T6.6.6.1.m1.6.6.cmml" type="integer" xref="S5.T6.6.6.1.m1.6.6">1</cn><cn id="S5.T6.6.6.1.m1.7.7.cmml" type="integer" xref="S5.T6.6.6.1.m1.7.7">1</cn><cn id="S5.T6.6.6.1.m1.8.8.cmml" type="integer" xref="S5.T6.6.6.1.m1.8.8">1</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.6.6.1.m1.8c">[0,1,1,1,1,1,1,1]</annotation><annotation encoding="application/x-llamapun" id="S5.T6.6.6.1.m1.8d">[ 0 , 1 , 1 , 1 , 1 , 1 , 1 , 1 ]</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S5.T6.8.8.4">
<span class="ltx_text ltx_phantom" id="S5.T6.8.8.4.1" style="font-size:80%;"><span style="visibility:hidden">00</span></span><span class="ltx_text" id="S5.T6.8.8.4.2" style="font-size:80%;">1.0</span>
</td>
<td class="ltx_td ltx_align_center" id="S5.T6.8.8.5"><span class="ltx_text" id="S5.T6.8.8.5.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td" id="S5.T6.8.8.6"></td>
<td class="ltx_td ltx_align_center" id="S5.T6.7.7.2"><math alttext="4.12" class="ltx_Math" display="inline" id="S5.T6.7.7.2.m1.1"><semantics id="S5.T6.7.7.2.m1.1a"><mn id="S5.T6.7.7.2.m1.1.1" mathsize="80%" xref="S5.T6.7.7.2.m1.1.1.cmml">4.12</mn><annotation-xml encoding="MathML-Content" id="S5.T6.7.7.2.m1.1b"><cn id="S5.T6.7.7.2.m1.1.1.cmml" type="float" xref="S5.T6.7.7.2.m1.1.1">4.12</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.7.7.2.m1.1c">4.12</annotation><annotation encoding="application/x-llamapun" id="S5.T6.7.7.2.m1.1d">4.12</annotation></semantics></math></td>
<td class="ltx_td ltx_align_right" id="S5.T6.8.8.3"><math alttext="529" class="ltx_Math" display="inline" id="S5.T6.8.8.3.m1.1"><semantics id="S5.T6.8.8.3.m1.1a"><mn id="S5.T6.8.8.3.m1.1.1" mathsize="80%" xref="S5.T6.8.8.3.m1.1.1.cmml">529</mn><annotation-xml encoding="MathML-Content" id="S5.T6.8.8.3.m1.1b"><cn id="S5.T6.8.8.3.m1.1.1.cmml" type="integer" xref="S5.T6.8.8.3.m1.1.1">529</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.8.8.3.m1.1c">529</annotation><annotation encoding="application/x-llamapun" id="S5.T6.8.8.3.m1.1d">529</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T6.11.11">
<td class="ltx_td ltx_align_center" id="S5.T6.9.9.1"><math alttext="[0,2,2,2,2,2,2,2]" class="ltx_Math" display="inline" id="S5.T6.9.9.1.m1.8"><semantics id="S5.T6.9.9.1.m1.8a"><mrow id="S5.T6.9.9.1.m1.8.9.2" xref="S5.T6.9.9.1.m1.8.9.1.cmml"><mo id="S5.T6.9.9.1.m1.8.9.2.1" maxsize="80%" minsize="80%" xref="S5.T6.9.9.1.m1.8.9.1.cmml">[</mo><mn id="S5.T6.9.9.1.m1.1.1" mathsize="80%" xref="S5.T6.9.9.1.m1.1.1.cmml">0</mn><mo id="S5.T6.9.9.1.m1.8.9.2.2" mathsize="80%" xref="S5.T6.9.9.1.m1.8.9.1.cmml">,</mo><mn id="S5.T6.9.9.1.m1.2.2" mathsize="80%" xref="S5.T6.9.9.1.m1.2.2.cmml">2</mn><mo id="S5.T6.9.9.1.m1.8.9.2.3" mathsize="80%" xref="S5.T6.9.9.1.m1.8.9.1.cmml">,</mo><mn id="S5.T6.9.9.1.m1.3.3" mathsize="80%" xref="S5.T6.9.9.1.m1.3.3.cmml">2</mn><mo id="S5.T6.9.9.1.m1.8.9.2.4" mathsize="80%" xref="S5.T6.9.9.1.m1.8.9.1.cmml">,</mo><mn id="S5.T6.9.9.1.m1.4.4" mathsize="80%" xref="S5.T6.9.9.1.m1.4.4.cmml">2</mn><mo id="S5.T6.9.9.1.m1.8.9.2.5" mathsize="80%" xref="S5.T6.9.9.1.m1.8.9.1.cmml">,</mo><mn id="S5.T6.9.9.1.m1.5.5" mathsize="80%" xref="S5.T6.9.9.1.m1.5.5.cmml">2</mn><mo id="S5.T6.9.9.1.m1.8.9.2.6" mathsize="80%" xref="S5.T6.9.9.1.m1.8.9.1.cmml">,</mo><mn id="S5.T6.9.9.1.m1.6.6" mathsize="80%" xref="S5.T6.9.9.1.m1.6.6.cmml">2</mn><mo id="S5.T6.9.9.1.m1.8.9.2.7" mathsize="80%" xref="S5.T6.9.9.1.m1.8.9.1.cmml">,</mo><mn id="S5.T6.9.9.1.m1.7.7" mathsize="80%" xref="S5.T6.9.9.1.m1.7.7.cmml">2</mn><mo id="S5.T6.9.9.1.m1.8.9.2.8" mathsize="80%" xref="S5.T6.9.9.1.m1.8.9.1.cmml">,</mo><mn id="S5.T6.9.9.1.m1.8.8" mathsize="80%" xref="S5.T6.9.9.1.m1.8.8.cmml">2</mn><mo id="S5.T6.9.9.1.m1.8.9.2.9" maxsize="80%" minsize="80%" xref="S5.T6.9.9.1.m1.8.9.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.T6.9.9.1.m1.8b"><list id="S5.T6.9.9.1.m1.8.9.1.cmml" xref="S5.T6.9.9.1.m1.8.9.2"><cn id="S5.T6.9.9.1.m1.1.1.cmml" type="integer" xref="S5.T6.9.9.1.m1.1.1">0</cn><cn id="S5.T6.9.9.1.m1.2.2.cmml" type="integer" xref="S5.T6.9.9.1.m1.2.2">2</cn><cn id="S5.T6.9.9.1.m1.3.3.cmml" type="integer" xref="S5.T6.9.9.1.m1.3.3">2</cn><cn id="S5.T6.9.9.1.m1.4.4.cmml" type="integer" xref="S5.T6.9.9.1.m1.4.4">2</cn><cn id="S5.T6.9.9.1.m1.5.5.cmml" type="integer" xref="S5.T6.9.9.1.m1.5.5">2</cn><cn id="S5.T6.9.9.1.m1.6.6.cmml" type="integer" xref="S5.T6.9.9.1.m1.6.6">2</cn><cn id="S5.T6.9.9.1.m1.7.7.cmml" type="integer" xref="S5.T6.9.9.1.m1.7.7">2</cn><cn id="S5.T6.9.9.1.m1.8.8.cmml" type="integer" xref="S5.T6.9.9.1.m1.8.8">2</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.9.9.1.m1.8c">[0,2,2,2,2,2,2,2]</annotation><annotation encoding="application/x-llamapun" id="S5.T6.9.9.1.m1.8d">[ 0 , 2 , 2 , 2 , 2 , 2 , 2 , 2 ]</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S5.T6.11.11.4">
<span class="ltx_text ltx_phantom" id="S5.T6.11.11.4.1" style="font-size:80%;"><span style="visibility:hidden">00</span></span><span class="ltx_text" id="S5.T6.11.11.4.2" style="font-size:80%;">1.0</span>
</td>
<td class="ltx_td ltx_align_center" id="S5.T6.11.11.5"><span class="ltx_text" id="S5.T6.11.11.5.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td" id="S5.T6.11.11.6"></td>
<td class="ltx_td ltx_align_center" id="S5.T6.10.10.2"><math alttext="4.09" class="ltx_Math" display="inline" id="S5.T6.10.10.2.m1.1"><semantics id="S5.T6.10.10.2.m1.1a"><mn id="S5.T6.10.10.2.m1.1.1" mathsize="80%" xref="S5.T6.10.10.2.m1.1.1.cmml">4.09</mn><annotation-xml encoding="MathML-Content" id="S5.T6.10.10.2.m1.1b"><cn id="S5.T6.10.10.2.m1.1.1.cmml" type="float" xref="S5.T6.10.10.2.m1.1.1">4.09</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.10.10.2.m1.1c">4.09</annotation><annotation encoding="application/x-llamapun" id="S5.T6.10.10.2.m1.1d">4.09</annotation></semantics></math></td>
<td class="ltx_td ltx_align_right" id="S5.T6.11.11.3"><math alttext="519" class="ltx_Math" display="inline" id="S5.T6.11.11.3.m1.1"><semantics id="S5.T6.11.11.3.m1.1a"><mn id="S5.T6.11.11.3.m1.1.1" mathsize="80%" xref="S5.T6.11.11.3.m1.1.1.cmml">519</mn><annotation-xml encoding="MathML-Content" id="S5.T6.11.11.3.m1.1b"><cn id="S5.T6.11.11.3.m1.1.1.cmml" type="integer" xref="S5.T6.11.11.3.m1.1.1">519</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.11.11.3.m1.1c">519</annotation><annotation encoding="application/x-llamapun" id="S5.T6.11.11.3.m1.1d">519</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T6.14.14">
<td class="ltx_td ltx_align_center" id="S5.T6.12.12.1"><math alttext="[0,2,2,2,2,2,2,2]" class="ltx_Math" display="inline" id="S5.T6.12.12.1.m1.8"><semantics id="S5.T6.12.12.1.m1.8a"><mrow id="S5.T6.12.12.1.m1.8.9.2" xref="S5.T6.12.12.1.m1.8.9.1.cmml"><mo id="S5.T6.12.12.1.m1.8.9.2.1" maxsize="80%" minsize="80%" xref="S5.T6.12.12.1.m1.8.9.1.cmml">[</mo><mn id="S5.T6.12.12.1.m1.1.1" mathsize="80%" xref="S5.T6.12.12.1.m1.1.1.cmml">0</mn><mo id="S5.T6.12.12.1.m1.8.9.2.2" mathsize="80%" xref="S5.T6.12.12.1.m1.8.9.1.cmml">,</mo><mn id="S5.T6.12.12.1.m1.2.2" mathsize="80%" xref="S5.T6.12.12.1.m1.2.2.cmml">2</mn><mo id="S5.T6.12.12.1.m1.8.9.2.3" mathsize="80%" xref="S5.T6.12.12.1.m1.8.9.1.cmml">,</mo><mn id="S5.T6.12.12.1.m1.3.3" mathsize="80%" xref="S5.T6.12.12.1.m1.3.3.cmml">2</mn><mo id="S5.T6.12.12.1.m1.8.9.2.4" mathsize="80%" xref="S5.T6.12.12.1.m1.8.9.1.cmml">,</mo><mn id="S5.T6.12.12.1.m1.4.4" mathsize="80%" xref="S5.T6.12.12.1.m1.4.4.cmml">2</mn><mo id="S5.T6.12.12.1.m1.8.9.2.5" mathsize="80%" xref="S5.T6.12.12.1.m1.8.9.1.cmml">,</mo><mn id="S5.T6.12.12.1.m1.5.5" mathsize="80%" xref="S5.T6.12.12.1.m1.5.5.cmml">2</mn><mo id="S5.T6.12.12.1.m1.8.9.2.6" mathsize="80%" xref="S5.T6.12.12.1.m1.8.9.1.cmml">,</mo><mn id="S5.T6.12.12.1.m1.6.6" mathsize="80%" xref="S5.T6.12.12.1.m1.6.6.cmml">2</mn><mo id="S5.T6.12.12.1.m1.8.9.2.7" mathsize="80%" xref="S5.T6.12.12.1.m1.8.9.1.cmml">,</mo><mn id="S5.T6.12.12.1.m1.7.7" mathsize="80%" xref="S5.T6.12.12.1.m1.7.7.cmml">2</mn><mo id="S5.T6.12.12.1.m1.8.9.2.8" mathsize="80%" xref="S5.T6.12.12.1.m1.8.9.1.cmml">,</mo><mn id="S5.T6.12.12.1.m1.8.8" mathsize="80%" xref="S5.T6.12.12.1.m1.8.8.cmml">2</mn><mo id="S5.T6.12.12.1.m1.8.9.2.9" maxsize="80%" minsize="80%" xref="S5.T6.12.12.1.m1.8.9.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.T6.12.12.1.m1.8b"><list id="S5.T6.12.12.1.m1.8.9.1.cmml" xref="S5.T6.12.12.1.m1.8.9.2"><cn id="S5.T6.12.12.1.m1.1.1.cmml" type="integer" xref="S5.T6.12.12.1.m1.1.1">0</cn><cn id="S5.T6.12.12.1.m1.2.2.cmml" type="integer" xref="S5.T6.12.12.1.m1.2.2">2</cn><cn id="S5.T6.12.12.1.m1.3.3.cmml" type="integer" xref="S5.T6.12.12.1.m1.3.3">2</cn><cn id="S5.T6.12.12.1.m1.4.4.cmml" type="integer" xref="S5.T6.12.12.1.m1.4.4">2</cn><cn id="S5.T6.12.12.1.m1.5.5.cmml" type="integer" xref="S5.T6.12.12.1.m1.5.5">2</cn><cn id="S5.T6.12.12.1.m1.6.6.cmml" type="integer" xref="S5.T6.12.12.1.m1.6.6">2</cn><cn id="S5.T6.12.12.1.m1.7.7.cmml" type="integer" xref="S5.T6.12.12.1.m1.7.7">2</cn><cn id="S5.T6.12.12.1.m1.8.8.cmml" type="integer" xref="S5.T6.12.12.1.m1.8.8">2</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.12.12.1.m1.8c">[0,2,2,2,2,2,2,2]</annotation><annotation encoding="application/x-llamapun" id="S5.T6.12.12.1.m1.8d">[ 0 , 2 , 2 , 2 , 2 , 2 , 2 , 2 ]</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S5.T6.14.14.4"><span class="ltx_text" id="S5.T6.14.14.4.1" style="font-size:80%;">100.0</span></td>
<td class="ltx_td" id="S5.T6.14.14.5"></td>
<td class="ltx_td" id="S5.T6.14.14.6"></td>
<td class="ltx_td ltx_align_center" id="S5.T6.13.13.2"><math alttext="3.75" class="ltx_Math" display="inline" id="S5.T6.13.13.2.m1.1"><semantics id="S5.T6.13.13.2.m1.1a"><mn id="S5.T6.13.13.2.m1.1.1" mathsize="80%" xref="S5.T6.13.13.2.m1.1.1.cmml">3.75</mn><annotation-xml encoding="MathML-Content" id="S5.T6.13.13.2.m1.1b"><cn id="S5.T6.13.13.2.m1.1.1.cmml" type="float" xref="S5.T6.13.13.2.m1.1.1">3.75</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.13.13.2.m1.1c">3.75</annotation><annotation encoding="application/x-llamapun" id="S5.T6.13.13.2.m1.1d">3.75</annotation></semantics></math></td>
<td class="ltx_td ltx_align_right" id="S5.T6.14.14.3"><math alttext="538" class="ltx_Math" display="inline" id="S5.T6.14.14.3.m1.1"><semantics id="S5.T6.14.14.3.m1.1a"><mn id="S5.T6.14.14.3.m1.1.1" mathsize="80%" xref="S5.T6.14.14.3.m1.1.1.cmml">538</mn><annotation-xml encoding="MathML-Content" id="S5.T6.14.14.3.m1.1b"><cn id="S5.T6.14.14.3.m1.1.1.cmml" type="integer" xref="S5.T6.14.14.3.m1.1.1">538</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.14.14.3.m1.1c">538</annotation><annotation encoding="application/x-llamapun" id="S5.T6.14.14.3.m1.1d">538</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T6.17.17">
<td class="ltx_td ltx_align_center" id="S5.T6.15.15.1"><math alttext="[0,2,2,2,2,2,2,2]" class="ltx_Math" display="inline" id="S5.T6.15.15.1.m1.8"><semantics id="S5.T6.15.15.1.m1.8a"><mrow id="S5.T6.15.15.1.m1.8.9.2" xref="S5.T6.15.15.1.m1.8.9.1.cmml"><mo id="S5.T6.15.15.1.m1.8.9.2.1" maxsize="80%" minsize="80%" xref="S5.T6.15.15.1.m1.8.9.1.cmml">[</mo><mn id="S5.T6.15.15.1.m1.1.1" mathsize="80%" xref="S5.T6.15.15.1.m1.1.1.cmml">0</mn><mo id="S5.T6.15.15.1.m1.8.9.2.2" mathsize="80%" xref="S5.T6.15.15.1.m1.8.9.1.cmml">,</mo><mn id="S5.T6.15.15.1.m1.2.2" mathsize="80%" xref="S5.T6.15.15.1.m1.2.2.cmml">2</mn><mo id="S5.T6.15.15.1.m1.8.9.2.3" mathsize="80%" xref="S5.T6.15.15.1.m1.8.9.1.cmml">,</mo><mn id="S5.T6.15.15.1.m1.3.3" mathsize="80%" xref="S5.T6.15.15.1.m1.3.3.cmml">2</mn><mo id="S5.T6.15.15.1.m1.8.9.2.4" mathsize="80%" xref="S5.T6.15.15.1.m1.8.9.1.cmml">,</mo><mn id="S5.T6.15.15.1.m1.4.4" mathsize="80%" xref="S5.T6.15.15.1.m1.4.4.cmml">2</mn><mo id="S5.T6.15.15.1.m1.8.9.2.5" mathsize="80%" xref="S5.T6.15.15.1.m1.8.9.1.cmml">,</mo><mn id="S5.T6.15.15.1.m1.5.5" mathsize="80%" xref="S5.T6.15.15.1.m1.5.5.cmml">2</mn><mo id="S5.T6.15.15.1.m1.8.9.2.6" mathsize="80%" xref="S5.T6.15.15.1.m1.8.9.1.cmml">,</mo><mn id="S5.T6.15.15.1.m1.6.6" mathsize="80%" xref="S5.T6.15.15.1.m1.6.6.cmml">2</mn><mo id="S5.T6.15.15.1.m1.8.9.2.7" mathsize="80%" xref="S5.T6.15.15.1.m1.8.9.1.cmml">,</mo><mn id="S5.T6.15.15.1.m1.7.7" mathsize="80%" xref="S5.T6.15.15.1.m1.7.7.cmml">2</mn><mo id="S5.T6.15.15.1.m1.8.9.2.8" mathsize="80%" xref="S5.T6.15.15.1.m1.8.9.1.cmml">,</mo><mn id="S5.T6.15.15.1.m1.8.8" mathsize="80%" xref="S5.T6.15.15.1.m1.8.8.cmml">2</mn><mo id="S5.T6.15.15.1.m1.8.9.2.9" maxsize="80%" minsize="80%" xref="S5.T6.15.15.1.m1.8.9.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.T6.15.15.1.m1.8b"><list id="S5.T6.15.15.1.m1.8.9.1.cmml" xref="S5.T6.15.15.1.m1.8.9.2"><cn id="S5.T6.15.15.1.m1.1.1.cmml" type="integer" xref="S5.T6.15.15.1.m1.1.1">0</cn><cn id="S5.T6.15.15.1.m1.2.2.cmml" type="integer" xref="S5.T6.15.15.1.m1.2.2">2</cn><cn id="S5.T6.15.15.1.m1.3.3.cmml" type="integer" xref="S5.T6.15.15.1.m1.3.3">2</cn><cn id="S5.T6.15.15.1.m1.4.4.cmml" type="integer" xref="S5.T6.15.15.1.m1.4.4">2</cn><cn id="S5.T6.15.15.1.m1.5.5.cmml" type="integer" xref="S5.T6.15.15.1.m1.5.5">2</cn><cn id="S5.T6.15.15.1.m1.6.6.cmml" type="integer" xref="S5.T6.15.15.1.m1.6.6">2</cn><cn id="S5.T6.15.15.1.m1.7.7.cmml" type="integer" xref="S5.T6.15.15.1.m1.7.7">2</cn><cn id="S5.T6.15.15.1.m1.8.8.cmml" type="integer" xref="S5.T6.15.15.1.m1.8.8">2</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.15.15.1.m1.8c">[0,2,2,2,2,2,2,2]</annotation><annotation encoding="application/x-llamapun" id="S5.T6.15.15.1.m1.8d">[ 0 , 2 , 2 , 2 , 2 , 2 , 2 , 2 ]</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S5.T6.17.17.4"><span class="ltx_text" id="S5.T6.17.17.4.1" style="font-size:80%;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="S5.T6.17.17.5"><span class="ltx_text" id="S5.T6.17.17.5.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td" id="S5.T6.17.17.6"></td>
<td class="ltx_td ltx_align_center" id="S5.T6.16.16.2"><math alttext="3.65" class="ltx_Math" display="inline" id="S5.T6.16.16.2.m1.1"><semantics id="S5.T6.16.16.2.m1.1a"><mn id="S5.T6.16.16.2.m1.1.1" mathsize="80%" xref="S5.T6.16.16.2.m1.1.1.cmml">3.65</mn><annotation-xml encoding="MathML-Content" id="S5.T6.16.16.2.m1.1b"><cn id="S5.T6.16.16.2.m1.1.1.cmml" type="float" xref="S5.T6.16.16.2.m1.1.1">3.65</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.16.16.2.m1.1c">3.65</annotation><annotation encoding="application/x-llamapun" id="S5.T6.16.16.2.m1.1d">3.65</annotation></semantics></math></td>
<td class="ltx_td ltx_align_right" id="S5.T6.17.17.3"><math alttext="602" class="ltx_Math" display="inline" id="S5.T6.17.17.3.m1.1"><semantics id="S5.T6.17.17.3.m1.1a"><mn id="S5.T6.17.17.3.m1.1.1" mathsize="80%" xref="S5.T6.17.17.3.m1.1.1.cmml">602</mn><annotation-xml encoding="MathML-Content" id="S5.T6.17.17.3.m1.1b"><cn id="S5.T6.17.17.3.m1.1.1.cmml" type="integer" xref="S5.T6.17.17.3.m1.1.1">602</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.17.17.3.m1.1c">602</annotation><annotation encoding="application/x-llamapun" id="S5.T6.17.17.3.m1.1d">602</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T6.18.18">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T6.18.18.1"><math alttext="[0,2,2,2,2,2,2,2]" class="ltx_Math" display="inline" id="S5.T6.18.18.1.m1.8"><semantics id="S5.T6.18.18.1.m1.8a"><mrow id="S5.T6.18.18.1.m1.8.9.2" xref="S5.T6.18.18.1.m1.8.9.1.cmml"><mo id="S5.T6.18.18.1.m1.8.9.2.1" maxsize="80%" minsize="80%" xref="S5.T6.18.18.1.m1.8.9.1.cmml">[</mo><mn id="S5.T6.18.18.1.m1.1.1" mathsize="80%" xref="S5.T6.18.18.1.m1.1.1.cmml">0</mn><mo id="S5.T6.18.18.1.m1.8.9.2.2" mathsize="80%" xref="S5.T6.18.18.1.m1.8.9.1.cmml">,</mo><mn id="S5.T6.18.18.1.m1.2.2" mathsize="80%" xref="S5.T6.18.18.1.m1.2.2.cmml">2</mn><mo id="S5.T6.18.18.1.m1.8.9.2.3" mathsize="80%" xref="S5.T6.18.18.1.m1.8.9.1.cmml">,</mo><mn id="S5.T6.18.18.1.m1.3.3" mathsize="80%" xref="S5.T6.18.18.1.m1.3.3.cmml">2</mn><mo id="S5.T6.18.18.1.m1.8.9.2.4" mathsize="80%" xref="S5.T6.18.18.1.m1.8.9.1.cmml">,</mo><mn id="S5.T6.18.18.1.m1.4.4" mathsize="80%" xref="S5.T6.18.18.1.m1.4.4.cmml">2</mn><mo id="S5.T6.18.18.1.m1.8.9.2.5" mathsize="80%" xref="S5.T6.18.18.1.m1.8.9.1.cmml">,</mo><mn id="S5.T6.18.18.1.m1.5.5" mathsize="80%" xref="S5.T6.18.18.1.m1.5.5.cmml">2</mn><mo id="S5.T6.18.18.1.m1.8.9.2.6" mathsize="80%" xref="S5.T6.18.18.1.m1.8.9.1.cmml">,</mo><mn id="S5.T6.18.18.1.m1.6.6" mathsize="80%" xref="S5.T6.18.18.1.m1.6.6.cmml">2</mn><mo id="S5.T6.18.18.1.m1.8.9.2.7" mathsize="80%" xref="S5.T6.18.18.1.m1.8.9.1.cmml">,</mo><mn id="S5.T6.18.18.1.m1.7.7" mathsize="80%" xref="S5.T6.18.18.1.m1.7.7.cmml">2</mn><mo id="S5.T6.18.18.1.m1.8.9.2.8" mathsize="80%" xref="S5.T6.18.18.1.m1.8.9.1.cmml">,</mo><mn id="S5.T6.18.18.1.m1.8.8" mathsize="80%" xref="S5.T6.18.18.1.m1.8.8.cmml">2</mn><mo id="S5.T6.18.18.1.m1.8.9.2.9" maxsize="80%" minsize="80%" xref="S5.T6.18.18.1.m1.8.9.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.T6.18.18.1.m1.8b"><list id="S5.T6.18.18.1.m1.8.9.1.cmml" xref="S5.T6.18.18.1.m1.8.9.2"><cn id="S5.T6.18.18.1.m1.1.1.cmml" type="integer" xref="S5.T6.18.18.1.m1.1.1">0</cn><cn id="S5.T6.18.18.1.m1.2.2.cmml" type="integer" xref="S5.T6.18.18.1.m1.2.2">2</cn><cn id="S5.T6.18.18.1.m1.3.3.cmml" type="integer" xref="S5.T6.18.18.1.m1.3.3">2</cn><cn id="S5.T6.18.18.1.m1.4.4.cmml" type="integer" xref="S5.T6.18.18.1.m1.4.4">2</cn><cn id="S5.T6.18.18.1.m1.5.5.cmml" type="integer" xref="S5.T6.18.18.1.m1.5.5">2</cn><cn id="S5.T6.18.18.1.m1.6.6.cmml" type="integer" xref="S5.T6.18.18.1.m1.6.6">2</cn><cn id="S5.T6.18.18.1.m1.7.7.cmml" type="integer" xref="S5.T6.18.18.1.m1.7.7">2</cn><cn id="S5.T6.18.18.1.m1.8.8.cmml" type="integer" xref="S5.T6.18.18.1.m1.8.8">2</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.18.18.1.m1.8c">[0,2,2,2,2,2,2,2]</annotation><annotation encoding="application/x-llamapun" id="S5.T6.18.18.1.m1.8d">[ 0 , 2 , 2 , 2 , 2 , 2 , 2 , 2 ]</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T6.18.18.2"><span class="ltx_text" id="S5.T6.18.18.2.1" style="font-size:80%;">100.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T6.18.18.3"><span class="ltx_text" id="S5.T6.18.18.3.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T6.18.18.4"><span class="ltx_text" id="S5.T6.18.18.4.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T6.18.18.5"><span class="ltx_text ltx_font_bold" id="S5.T6.18.18.5.1" style="font-size:80%;">2.77</span></td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S5.T6.18.18.6"><span class="ltx_text ltx_font_bold" id="S5.T6.18.18.6.1" style="font-size:80%;">1920</span></td>
</tr>
</tbody>
</table>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Ablations on Generative Modeling</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_paragraph" id="S5.SS3.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Metrics.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS3.SSS0.Px1.p1">
<p class="ltx_p" id="S5.SS3.SSS0.Px1.p1.1">We perform ablation studies to evaluate the impact of using an RQ-Transformer, as well as comparing delay patterns and weighting of various token levels. All models are initialized with Helium for the Temporal Transformer and pretrained on audio data. When comparing models with a same delay pattern and without Inner Monologue, we rely on perplexity, averaged over semantic and acoustic tokens. However, perplexities are not comparable between models with various delays, as they do not model the same conditional distributions. To compare various delay patterns, we measure the ability of Moshi to generate intelligible, consistent speech by transcribing generations (conditioned on a 3s prompt) with Whisper&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Radford et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib77" title="">2023</a>)</cite> and scoring the resulting transcripts with an external text language model. We rely on a lightweight text model—LiteLlama-460M-1T<span class="ltx_note ltx_role_footnote" id="footnote15"><sup class="ltx_note_mark">15</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">15</sup><span class="ltx_tag ltx_tag_note">15</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://huggingface.co/ahxt/LiteLlama-460M-1T" title="">https://huggingface.co/ahxt/LiteLlama-460M-1T</a></span></span></span>— as it is more practical for continuous evaluation along training. We also report the length of the transcripts (in characters), as we find it to a be a strong predictor of model quality (weak models typically collapse to silence).</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS3.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Results - RQ-Transformer.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS3.SSS0.Px2.p1">
<p class="ltx_p" id="S5.SS3.SSS0.Px2.p1.2"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.T5" title="Table 5 ‣ Discussion. ‣ 5.2 Audio Tokenization ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue">Table&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></span></a> reports results for ablations on the use of an RQ-Transformer. We first replicate the setting of <cite class="ltx_cite ltx_citemacro_citet">Copet et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib18" title="">2023</a>)</cite> with the delay pattern of <math alttext="[0,1,2,3,4,5,6,7]" class="ltx_Math" display="inline" id="S5.SS3.SSS0.Px2.p1.1.m1.8"><semantics id="S5.SS3.SSS0.Px2.p1.1.m1.8a"><mrow id="S5.SS3.SSS0.Px2.p1.1.m1.8.9.2" xref="S5.SS3.SSS0.Px2.p1.1.m1.8.9.1.cmml"><mo id="S5.SS3.SSS0.Px2.p1.1.m1.8.9.2.1" stretchy="false" xref="S5.SS3.SSS0.Px2.p1.1.m1.8.9.1.cmml">[</mo><mn id="S5.SS3.SSS0.Px2.p1.1.m1.1.1" xref="S5.SS3.SSS0.Px2.p1.1.m1.1.1.cmml">0</mn><mo id="S5.SS3.SSS0.Px2.p1.1.m1.8.9.2.2" xref="S5.SS3.SSS0.Px2.p1.1.m1.8.9.1.cmml">,</mo><mn id="S5.SS3.SSS0.Px2.p1.1.m1.2.2" xref="S5.SS3.SSS0.Px2.p1.1.m1.2.2.cmml">1</mn><mo id="S5.SS3.SSS0.Px2.p1.1.m1.8.9.2.3" xref="S5.SS3.SSS0.Px2.p1.1.m1.8.9.1.cmml">,</mo><mn id="S5.SS3.SSS0.Px2.p1.1.m1.3.3" xref="S5.SS3.SSS0.Px2.p1.1.m1.3.3.cmml">2</mn><mo id="S5.SS3.SSS0.Px2.p1.1.m1.8.9.2.4" xref="S5.SS3.SSS0.Px2.p1.1.m1.8.9.1.cmml">,</mo><mn id="S5.SS3.SSS0.Px2.p1.1.m1.4.4" xref="S5.SS3.SSS0.Px2.p1.1.m1.4.4.cmml">3</mn><mo id="S5.SS3.SSS0.Px2.p1.1.m1.8.9.2.5" xref="S5.SS3.SSS0.Px2.p1.1.m1.8.9.1.cmml">,</mo><mn id="S5.SS3.SSS0.Px2.p1.1.m1.5.5" xref="S5.SS3.SSS0.Px2.p1.1.m1.5.5.cmml">4</mn><mo id="S5.SS3.SSS0.Px2.p1.1.m1.8.9.2.6" xref="S5.SS3.SSS0.Px2.p1.1.m1.8.9.1.cmml">,</mo><mn id="S5.SS3.SSS0.Px2.p1.1.m1.6.6" xref="S5.SS3.SSS0.Px2.p1.1.m1.6.6.cmml">5</mn><mo id="S5.SS3.SSS0.Px2.p1.1.m1.8.9.2.7" xref="S5.SS3.SSS0.Px2.p1.1.m1.8.9.1.cmml">,</mo><mn id="S5.SS3.SSS0.Px2.p1.1.m1.7.7" xref="S5.SS3.SSS0.Px2.p1.1.m1.7.7.cmml">6</mn><mo id="S5.SS3.SSS0.Px2.p1.1.m1.8.9.2.8" xref="S5.SS3.SSS0.Px2.p1.1.m1.8.9.1.cmml">,</mo><mn id="S5.SS3.SSS0.Px2.p1.1.m1.8.8" xref="S5.SS3.SSS0.Px2.p1.1.m1.8.8.cmml">7</mn><mo id="S5.SS3.SSS0.Px2.p1.1.m1.8.9.2.9" stretchy="false" xref="S5.SS3.SSS0.Px2.p1.1.m1.8.9.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.SSS0.Px2.p1.1.m1.8b"><list id="S5.SS3.SSS0.Px2.p1.1.m1.8.9.1.cmml" xref="S5.SS3.SSS0.Px2.p1.1.m1.8.9.2"><cn id="S5.SS3.SSS0.Px2.p1.1.m1.1.1.cmml" type="integer" xref="S5.SS3.SSS0.Px2.p1.1.m1.1.1">0</cn><cn id="S5.SS3.SSS0.Px2.p1.1.m1.2.2.cmml" type="integer" xref="S5.SS3.SSS0.Px2.p1.1.m1.2.2">1</cn><cn id="S5.SS3.SSS0.Px2.p1.1.m1.3.3.cmml" type="integer" xref="S5.SS3.SSS0.Px2.p1.1.m1.3.3">2</cn><cn id="S5.SS3.SSS0.Px2.p1.1.m1.4.4.cmml" type="integer" xref="S5.SS3.SSS0.Px2.p1.1.m1.4.4">3</cn><cn id="S5.SS3.SSS0.Px2.p1.1.m1.5.5.cmml" type="integer" xref="S5.SS3.SSS0.Px2.p1.1.m1.5.5">4</cn><cn id="S5.SS3.SSS0.Px2.p1.1.m1.6.6.cmml" type="integer" xref="S5.SS3.SSS0.Px2.p1.1.m1.6.6">5</cn><cn id="S5.SS3.SSS0.Px2.p1.1.m1.7.7.cmml" type="integer" xref="S5.SS3.SSS0.Px2.p1.1.m1.7.7">6</cn><cn id="S5.SS3.SSS0.Px2.p1.1.m1.8.8.cmml" type="integer" xref="S5.SS3.SSS0.Px2.p1.1.m1.8.8">7</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSS0.Px2.p1.1.m1.8c">[0,1,2,3,4,5,6,7]</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSS0.Px2.p1.1.m1.8d">[ 0 , 1 , 2 , 3 , 4 , 5 , 6 , 7 ]</annotation></semantics></math>, which means that each level of RVQ token is generated one timestep after the preceding level. In this context, we see that using an RQ-Transformer is not necessary, as it only provides a marginal improvement in perplexity. However, this delay pattern induces a theoretical latency of 8 timesteps, which amounts to 640ms, a latency that is incompatible with the requirements of a real-time dialogue model. We thus switch to a reduced latency of 240ms with the pattern <math alttext="[0,2,2,2,2,2,2,2]" class="ltx_Math" display="inline" id="S5.SS3.SSS0.Px2.p1.2.m2.8"><semantics id="S5.SS3.SSS0.Px2.p1.2.m2.8a"><mrow id="S5.SS3.SSS0.Px2.p1.2.m2.8.9.2" xref="S5.SS3.SSS0.Px2.p1.2.m2.8.9.1.cmml"><mo id="S5.SS3.SSS0.Px2.p1.2.m2.8.9.2.1" stretchy="false" xref="S5.SS3.SSS0.Px2.p1.2.m2.8.9.1.cmml">[</mo><mn id="S5.SS3.SSS0.Px2.p1.2.m2.1.1" xref="S5.SS3.SSS0.Px2.p1.2.m2.1.1.cmml">0</mn><mo id="S5.SS3.SSS0.Px2.p1.2.m2.8.9.2.2" xref="S5.SS3.SSS0.Px2.p1.2.m2.8.9.1.cmml">,</mo><mn id="S5.SS3.SSS0.Px2.p1.2.m2.2.2" xref="S5.SS3.SSS0.Px2.p1.2.m2.2.2.cmml">2</mn><mo id="S5.SS3.SSS0.Px2.p1.2.m2.8.9.2.3" xref="S5.SS3.SSS0.Px2.p1.2.m2.8.9.1.cmml">,</mo><mn id="S5.SS3.SSS0.Px2.p1.2.m2.3.3" xref="S5.SS3.SSS0.Px2.p1.2.m2.3.3.cmml">2</mn><mo id="S5.SS3.SSS0.Px2.p1.2.m2.8.9.2.4" xref="S5.SS3.SSS0.Px2.p1.2.m2.8.9.1.cmml">,</mo><mn id="S5.SS3.SSS0.Px2.p1.2.m2.4.4" xref="S5.SS3.SSS0.Px2.p1.2.m2.4.4.cmml">2</mn><mo id="S5.SS3.SSS0.Px2.p1.2.m2.8.9.2.5" xref="S5.SS3.SSS0.Px2.p1.2.m2.8.9.1.cmml">,</mo><mn id="S5.SS3.SSS0.Px2.p1.2.m2.5.5" xref="S5.SS3.SSS0.Px2.p1.2.m2.5.5.cmml">2</mn><mo id="S5.SS3.SSS0.Px2.p1.2.m2.8.9.2.6" xref="S5.SS3.SSS0.Px2.p1.2.m2.8.9.1.cmml">,</mo><mn id="S5.SS3.SSS0.Px2.p1.2.m2.6.6" xref="S5.SS3.SSS0.Px2.p1.2.m2.6.6.cmml">2</mn><mo id="S5.SS3.SSS0.Px2.p1.2.m2.8.9.2.7" xref="S5.SS3.SSS0.Px2.p1.2.m2.8.9.1.cmml">,</mo><mn id="S5.SS3.SSS0.Px2.p1.2.m2.7.7" xref="S5.SS3.SSS0.Px2.p1.2.m2.7.7.cmml">2</mn><mo id="S5.SS3.SSS0.Px2.p1.2.m2.8.9.2.8" xref="S5.SS3.SSS0.Px2.p1.2.m2.8.9.1.cmml">,</mo><mn id="S5.SS3.SSS0.Px2.p1.2.m2.8.8" xref="S5.SS3.SSS0.Px2.p1.2.m2.8.8.cmml">2</mn><mo id="S5.SS3.SSS0.Px2.p1.2.m2.8.9.2.9" stretchy="false" xref="S5.SS3.SSS0.Px2.p1.2.m2.8.9.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.SSS0.Px2.p1.2.m2.8b"><list id="S5.SS3.SSS0.Px2.p1.2.m2.8.9.1.cmml" xref="S5.SS3.SSS0.Px2.p1.2.m2.8.9.2"><cn id="S5.SS3.SSS0.Px2.p1.2.m2.1.1.cmml" type="integer" xref="S5.SS3.SSS0.Px2.p1.2.m2.1.1">0</cn><cn id="S5.SS3.SSS0.Px2.p1.2.m2.2.2.cmml" type="integer" xref="S5.SS3.SSS0.Px2.p1.2.m2.2.2">2</cn><cn id="S5.SS3.SSS0.Px2.p1.2.m2.3.3.cmml" type="integer" xref="S5.SS3.SSS0.Px2.p1.2.m2.3.3">2</cn><cn id="S5.SS3.SSS0.Px2.p1.2.m2.4.4.cmml" type="integer" xref="S5.SS3.SSS0.Px2.p1.2.m2.4.4">2</cn><cn id="S5.SS3.SSS0.Px2.p1.2.m2.5.5.cmml" type="integer" xref="S5.SS3.SSS0.Px2.p1.2.m2.5.5">2</cn><cn id="S5.SS3.SSS0.Px2.p1.2.m2.6.6.cmml" type="integer" xref="S5.SS3.SSS0.Px2.p1.2.m2.6.6">2</cn><cn id="S5.SS3.SSS0.Px2.p1.2.m2.7.7.cmml" type="integer" xref="S5.SS3.SSS0.Px2.p1.2.m2.7.7">2</cn><cn id="S5.SS3.SSS0.Px2.p1.2.m2.8.8.cmml" type="integer" xref="S5.SS3.SSS0.Px2.p1.2.m2.8.8">2</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSS0.Px2.p1.2.m2.8c">[0,2,2,2,2,2,2,2]</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSS0.Px2.p1.2.m2.8d">[ 0 , 2 , 2 , 2 , 2 , 2 , 2 , 2 ]</annotation></semantics></math>. In that context, modeling RVQ tokens with an RQ-Transformer significantly improves perplexity over using separate classification heads. Thus, the RQ-Transformer becomes a critical component of generative models of RVQ tokens under strict latency constraints.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS3.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">Results - Additional ablations.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS3.SSS0.Px3.p1">
<p class="ltx_p" id="S5.SS3.SSS0.Px3.p1.1"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.T6" title="Table 6 ‣ Discussion. ‣ 5.2 Audio Tokenization ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue">Table&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></span></a> reports additional ablations on additional delay patterns, the weight of the semantic token loss and our proposed Inner Monologue procedure, all using the RQ-Transformer.
First, we compare three configurations of delays that are compatible with real-time dialogue. The <math alttext="[0,0,0,0,0,0,0,0]" class="ltx_Math" display="inline" id="S5.SS3.SSS0.Px3.p1.1.m1.8"><semantics id="S5.SS3.SSS0.Px3.p1.1.m1.8a"><mrow id="S5.SS3.SSS0.Px3.p1.1.m1.8.9.2" xref="S5.SS3.SSS0.Px3.p1.1.m1.8.9.1.cmml"><mo id="S5.SS3.SSS0.Px3.p1.1.m1.8.9.2.1" stretchy="false" xref="S5.SS3.SSS0.Px3.p1.1.m1.8.9.1.cmml">[</mo><mn id="S5.SS3.SSS0.Px3.p1.1.m1.1.1" xref="S5.SS3.SSS0.Px3.p1.1.m1.1.1.cmml">0</mn><mo id="S5.SS3.SSS0.Px3.p1.1.m1.8.9.2.2" xref="S5.SS3.SSS0.Px3.p1.1.m1.8.9.1.cmml">,</mo><mn id="S5.SS3.SSS0.Px3.p1.1.m1.2.2" xref="S5.SS3.SSS0.Px3.p1.1.m1.2.2.cmml">0</mn><mo id="S5.SS3.SSS0.Px3.p1.1.m1.8.9.2.3" xref="S5.SS3.SSS0.Px3.p1.1.m1.8.9.1.cmml">,</mo><mn id="S5.SS3.SSS0.Px3.p1.1.m1.3.3" xref="S5.SS3.SSS0.Px3.p1.1.m1.3.3.cmml">0</mn><mo id="S5.SS3.SSS0.Px3.p1.1.m1.8.9.2.4" xref="S5.SS3.SSS0.Px3.p1.1.m1.8.9.1.cmml">,</mo><mn id="S5.SS3.SSS0.Px3.p1.1.m1.4.4" xref="S5.SS3.SSS0.Px3.p1.1.m1.4.4.cmml">0</mn><mo id="S5.SS3.SSS0.Px3.p1.1.m1.8.9.2.5" xref="S5.SS3.SSS0.Px3.p1.1.m1.8.9.1.cmml">,</mo><mn id="S5.SS3.SSS0.Px3.p1.1.m1.5.5" xref="S5.SS3.SSS0.Px3.p1.1.m1.5.5.cmml">0</mn><mo id="S5.SS3.SSS0.Px3.p1.1.m1.8.9.2.6" xref="S5.SS3.SSS0.Px3.p1.1.m1.8.9.1.cmml">,</mo><mn id="S5.SS3.SSS0.Px3.p1.1.m1.6.6" xref="S5.SS3.SSS0.Px3.p1.1.m1.6.6.cmml">0</mn><mo id="S5.SS3.SSS0.Px3.p1.1.m1.8.9.2.7" xref="S5.SS3.SSS0.Px3.p1.1.m1.8.9.1.cmml">,</mo><mn id="S5.SS3.SSS0.Px3.p1.1.m1.7.7" xref="S5.SS3.SSS0.Px3.p1.1.m1.7.7.cmml">0</mn><mo id="S5.SS3.SSS0.Px3.p1.1.m1.8.9.2.8" xref="S5.SS3.SSS0.Px3.p1.1.m1.8.9.1.cmml">,</mo><mn id="S5.SS3.SSS0.Px3.p1.1.m1.8.8" xref="S5.SS3.SSS0.Px3.p1.1.m1.8.8.cmml">0</mn><mo id="S5.SS3.SSS0.Px3.p1.1.m1.8.9.2.9" stretchy="false" xref="S5.SS3.SSS0.Px3.p1.1.m1.8.9.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.SSS0.Px3.p1.1.m1.8b"><list id="S5.SS3.SSS0.Px3.p1.1.m1.8.9.1.cmml" xref="S5.SS3.SSS0.Px3.p1.1.m1.8.9.2"><cn id="S5.SS3.SSS0.Px3.p1.1.m1.1.1.cmml" type="integer" xref="S5.SS3.SSS0.Px3.p1.1.m1.1.1">0</cn><cn id="S5.SS3.SSS0.Px3.p1.1.m1.2.2.cmml" type="integer" xref="S5.SS3.SSS0.Px3.p1.1.m1.2.2">0</cn><cn id="S5.SS3.SSS0.Px3.p1.1.m1.3.3.cmml" type="integer" xref="S5.SS3.SSS0.Px3.p1.1.m1.3.3">0</cn><cn id="S5.SS3.SSS0.Px3.p1.1.m1.4.4.cmml" type="integer" xref="S5.SS3.SSS0.Px3.p1.1.m1.4.4">0</cn><cn id="S5.SS3.SSS0.Px3.p1.1.m1.5.5.cmml" type="integer" xref="S5.SS3.SSS0.Px3.p1.1.m1.5.5">0</cn><cn id="S5.SS3.SSS0.Px3.p1.1.m1.6.6.cmml" type="integer" xref="S5.SS3.SSS0.Px3.p1.1.m1.6.6">0</cn><cn id="S5.SS3.SSS0.Px3.p1.1.m1.7.7.cmml" type="integer" xref="S5.SS3.SSS0.Px3.p1.1.m1.7.7">0</cn><cn id="S5.SS3.SSS0.Px3.p1.1.m1.8.8.cmml" type="integer" xref="S5.SS3.SSS0.Px3.p1.1.m1.8.8">0</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSS0.Px3.p1.1.m1.8c">[0,0,0,0,0,0,0,0]</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSS0.Px3.p1.1.m1.8d">[ 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 ]</annotation></semantics></math> pattern represents the minimal latency of 80ms that can be obtained with Mimi tokens at 12.5Hz. Allowing an additional 80ms of latency with one step of delay significantly improves the quality of generated speech, while 240ms of latency brings further moderate improvement.
In early experiments, we also observed that the individual losses per RVQ level were conflicting with one another, despite each level being more important in the final intelligibility and audio quality than the next one. We thus bring two changes to the architecture and training process. We first increase the weight of the loss on predicting the semantic tokens to 100, while keeping it at 1 for all other levels of the audio tokens.
This gives another boost to speech intelligibility. We furthermore reduce competition between RVQ levels by using a depthwise parametrization, as described in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS4.SSS1" title="3.4.1 Hierarchical autoregressive modeling with RQ-Transformer ‣ 3.4 Generative Audio Modeling ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue">Section&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.4.1</span></span></a>, such that each RVQ level is predicted by its own set of weights in the Depth Transformer, rather than having shared weights across levels.
Finally, the most drastic improvement to the quality and length of generated speech comes from enabling Inner Monologue.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS3.SSS0.Px4">
<h5 class="ltx_title ltx_title_paragraph">Discussion.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS3.SSS0.Px4.p1">
<p class="ltx_p" id="S5.SS3.SSS0.Px4.p1.1">Beyond the choice of architecture and delay patterns, these ablations show how helpful modeling text tokens along the audio tokens with Inner Monologue is, even in an audio-to-audio setting. Given the positive impact of depthwise parametrization and a weight of 100 for the semantic token, both are used in the subsequent experiments and our final training procedure. As described in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.T1" title="Table 1 ‣ 3.2.1 Architecture ‣ 3.2 The Helium Text Language Model ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue">Table&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></span></a>, we pretrain Moshi with an acoustic delay of 2 and finetune it with an acoustic delay of 1, for a theoretical latency of 160ms.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="S5.T7">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 7: </span><span class="ltx_text ltx_font_bold" id="S5.T7.13.1">Performance of audio and text language modeling</span>. We report accuracies based on scoring with negative log-likelihood, normalized by sequence length. MMLU is evaluated in a 5-shot setting. Reusing the terminology of <cite class="ltx_cite ltx_citemacro_cite">Nguyen et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib72" title="">2024</a>)</cite>, <math alttext="\varnothing" class="ltx_Math" display="inline" id="S5.T7.2.m1.1"><semantics id="S5.T7.2.m1.1b"><mi id="S5.T7.2.m1.1.1" mathvariant="normal" xref="S5.T7.2.m1.1.1.cmml">∅</mi><annotation-xml encoding="MathML-Content" id="S5.T7.2.m1.1c"><emptyset id="S5.T7.2.m1.1.1.cmml" xref="S5.T7.2.m1.1.1"></emptyset></annotation-xml><annotation encoding="application/x-tex" id="S5.T7.2.m1.1d">\varnothing</annotation><annotation encoding="application/x-llamapun" id="S5.T7.2.m1.1e">∅</annotation></semantics></math> represents unsupported modalities while - represents unreported numbers.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S5.T7.11" style="width:433.6pt;height:249.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-64.8pt,37.3pt) scale(0.769890373932054,0.769890373932054) ;">
<table class="ltx_tabular ltx_align_middle" id="S5.T7.11.9">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T7.11.9.10.1">
<td class="ltx_td ltx_border_tt" id="S5.T7.11.9.10.1.1"></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="4" id="S5.T7.11.9.10.1.2">Audio metrics</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T7.11.9.10.1.3">Text metrics</td>
</tr>
<tr class="ltx_tr" id="S5.T7.11.9.11.2">
<td class="ltx_td ltx_align_left" id="S5.T7.11.9.11.2.1">Model</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.11.9.11.2.2">sWUGGY</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.11.9.11.2.3">sBLIMP</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.11.9.11.2.4">sTopic-StoryCloze</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.11.9.11.2.5">sStoryCloze</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.11.9.11.2.6">MMLU</td>
</tr>
<tr class="ltx_tr" id="S5.T7.11.9.12.3">
<td class="ltx_td ltx_align_center ltx_border_t" colspan="6" id="S5.T7.11.9.12.3.1"><span class="ltx_text ltx_font_italic" id="S5.T7.11.9.12.3.1.1">Audio only - Cold Start</span></td>
</tr>
<tr class="ltx_tr" id="S5.T7.3.1.1">
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T7.3.1.1.2">GSLM <cite class="ltx_cite ltx_citemacro_citep">(Lakhotia et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib54" title="">2021</a>)</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.3.1.1.3">64.8</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.3.1.1.4">54.2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.3.1.1.5">66.6</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.3.1.1.6">53.3</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.3.1.1.1"><math alttext="\varnothing" class="ltx_Math" display="inline" id="S5.T7.3.1.1.1.m1.1"><semantics id="S5.T7.3.1.1.1.m1.1a"><mi id="S5.T7.3.1.1.1.m1.1.1" mathvariant="normal" xref="S5.T7.3.1.1.1.m1.1.1.cmml">∅</mi><annotation-xml encoding="MathML-Content" id="S5.T7.3.1.1.1.m1.1b"><emptyset id="S5.T7.3.1.1.1.m1.1.1.cmml" xref="S5.T7.3.1.1.1.m1.1.1"></emptyset></annotation-xml><annotation encoding="application/x-tex" id="S5.T7.3.1.1.1.m1.1c">\varnothing</annotation><annotation encoding="application/x-llamapun" id="S5.T7.3.1.1.1.m1.1d">∅</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T7.4.2.2">
<td class="ltx_td ltx_align_left" id="S5.T7.4.2.2.2">AudioLM <cite class="ltx_cite ltx_citemacro_citep">(Borsos et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib6" title="">2022</a>)</cite>
</td>
<td class="ltx_td ltx_align_center" id="S5.T7.4.2.2.3">71.5</td>
<td class="ltx_td ltx_align_center" id="S5.T7.4.2.2.4"><span class="ltx_text ltx_font_bold" id="S5.T7.4.2.2.4.1">64.7</span></td>
<td class="ltx_td ltx_align_center" id="S5.T7.4.2.2.5">-</td>
<td class="ltx_td ltx_align_center" id="S5.T7.4.2.2.6">-</td>
<td class="ltx_td ltx_align_center" id="S5.T7.4.2.2.1"><math alttext="\varnothing" class="ltx_Math" display="inline" id="S5.T7.4.2.2.1.m1.1"><semantics id="S5.T7.4.2.2.1.m1.1a"><mi id="S5.T7.4.2.2.1.m1.1.1" mathvariant="normal" xref="S5.T7.4.2.2.1.m1.1.1.cmml">∅</mi><annotation-xml encoding="MathML-Content" id="S5.T7.4.2.2.1.m1.1b"><emptyset id="S5.T7.4.2.2.1.m1.1.1.cmml" xref="S5.T7.4.2.2.1.m1.1.1"></emptyset></annotation-xml><annotation encoding="application/x-tex" id="S5.T7.4.2.2.1.m1.1c">\varnothing</annotation><annotation encoding="application/x-llamapun" id="S5.T7.4.2.2.1.m1.1d">∅</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T7.5.3.3">
<td class="ltx_td ltx_align_left" id="S5.T7.5.3.3.2">TWIST <cite class="ltx_cite ltx_citemacro_citep">(Hassid et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib33" title="">2023</a>)</cite>
</td>
<td class="ltx_td ltx_align_center" id="S5.T7.5.3.3.3">72.2</td>
<td class="ltx_td ltx_align_center" id="S5.T7.5.3.3.4">56.5</td>
<td class="ltx_td ltx_align_center" id="S5.T7.5.3.3.5">-</td>
<td class="ltx_td ltx_align_center" id="S5.T7.5.3.3.6">-</td>
<td class="ltx_td ltx_align_center" id="S5.T7.5.3.3.1"><math alttext="\varnothing" class="ltx_Math" display="inline" id="S5.T7.5.3.3.1.m1.1"><semantics id="S5.T7.5.3.3.1.m1.1a"><mi id="S5.T7.5.3.3.1.m1.1.1" mathvariant="normal" xref="S5.T7.5.3.3.1.m1.1.1.cmml">∅</mi><annotation-xml encoding="MathML-Content" id="S5.T7.5.3.3.1.m1.1b"><emptyset id="S5.T7.5.3.3.1.m1.1.1.cmml" xref="S5.T7.5.3.3.1.m1.1.1"></emptyset></annotation-xml><annotation encoding="application/x-tex" id="S5.T7.5.3.3.1.m1.1c">\varnothing</annotation><annotation encoding="application/x-llamapun" id="S5.T7.5.3.3.1.m1.1d">∅</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T7.6.4.4">
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T7.6.4.4.2">Moshi</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.6.4.4.3"><span class="ltx_text ltx_font_bold" id="S5.T7.6.4.4.3.1">74.8</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.6.4.4.4">59.9</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.6.4.4.5">80.9</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.6.4.4.6">56.9</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.6.4.4.1"><math alttext="\varnothing" class="ltx_Math" display="inline" id="S5.T7.6.4.4.1.m1.1"><semantics id="S5.T7.6.4.4.1.m1.1a"><mi id="S5.T7.6.4.4.1.m1.1.1" mathvariant="normal" xref="S5.T7.6.4.4.1.m1.1.1.cmml">∅</mi><annotation-xml encoding="MathML-Content" id="S5.T7.6.4.4.1.m1.1b"><emptyset id="S5.T7.6.4.4.1.m1.1.1.cmml" xref="S5.T7.6.4.4.1.m1.1.1"></emptyset></annotation-xml><annotation encoding="application/x-tex" id="S5.T7.6.4.4.1.m1.1c">\varnothing</annotation><annotation encoding="application/x-llamapun" id="S5.T7.6.4.4.1.m1.1d">∅</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T7.11.9.13.4">
<td class="ltx_td ltx_align_center ltx_border_t" colspan="6" id="S5.T7.11.9.13.4.1"><span class="ltx_text ltx_font_italic" id="S5.T7.11.9.13.4.1.1">Audio only - Warm Start</span></td>
</tr>
<tr class="ltx_tr" id="S5.T7.7.5.5">
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T7.7.5.5.2">TWIST <cite class="ltx_cite ltx_citemacro_citep">(Hassid et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib33" title="">2023</a>)</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.7.5.5.3">74.5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.7.5.5.4">59.2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.7.5.5.5">76.4</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.7.5.5.6">55.4</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.7.5.5.1"><math alttext="\varnothing" class="ltx_Math" display="inline" id="S5.T7.7.5.5.1.m1.1"><semantics id="S5.T7.7.5.5.1.m1.1a"><mi id="S5.T7.7.5.5.1.m1.1.1" mathvariant="normal" xref="S5.T7.7.5.5.1.m1.1.1.cmml">∅</mi><annotation-xml encoding="MathML-Content" id="S5.T7.7.5.5.1.m1.1b"><emptyset id="S5.T7.7.5.5.1.m1.1.1.cmml" xref="S5.T7.7.5.5.1.m1.1.1"></emptyset></annotation-xml><annotation encoding="application/x-tex" id="S5.T7.7.5.5.1.m1.1c">\varnothing</annotation><annotation encoding="application/x-llamapun" id="S5.T7.7.5.5.1.m1.1d">∅</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T7.8.6.6">
<td class="ltx_td ltx_align_left" id="S5.T7.8.6.6.2">VoxtLM <cite class="ltx_cite ltx_citemacro_citep">(Maiti et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib66" title="">2023</a>)</cite>
</td>
<td class="ltx_td ltx_align_center" id="S5.T7.8.6.6.3">62.9</td>
<td class="ltx_td ltx_align_center" id="S5.T7.8.6.6.4">53.9</td>
<td class="ltx_td ltx_align_center" id="S5.T7.8.6.6.5">-</td>
<td class="ltx_td ltx_align_center" id="S5.T7.8.6.6.6">-</td>
<td class="ltx_td ltx_align_center" id="S5.T7.8.6.6.1"><math alttext="\varnothing" class="ltx_Math" display="inline" id="S5.T7.8.6.6.1.m1.1"><semantics id="S5.T7.8.6.6.1.m1.1a"><mi id="S5.T7.8.6.6.1.m1.1.1" mathvariant="normal" xref="S5.T7.8.6.6.1.m1.1.1.cmml">∅</mi><annotation-xml encoding="MathML-Content" id="S5.T7.8.6.6.1.m1.1b"><emptyset id="S5.T7.8.6.6.1.m1.1.1.cmml" xref="S5.T7.8.6.6.1.m1.1.1"></emptyset></annotation-xml><annotation encoding="application/x-tex" id="S5.T7.8.6.6.1.m1.1c">\varnothing</annotation><annotation encoding="application/x-llamapun" id="S5.T7.8.6.6.1.m1.1d">∅</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T7.9.7.7">
<td class="ltx_td ltx_align_left" id="S5.T7.9.7.7.2">Spirit-LM <cite class="ltx_cite ltx_citemacro_citep">(Nguyen et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib72" title="">2024</a>)</cite>
</td>
<td class="ltx_td ltx_align_center" id="S5.T7.9.7.7.3">69.5</td>
<td class="ltx_td ltx_align_center" id="S5.T7.9.7.7.4">58.0</td>
<td class="ltx_td ltx_align_center" id="S5.T7.9.7.7.5">72.9</td>
<td class="ltx_td ltx_align_center" id="S5.T7.9.7.7.6">54.8</td>
<td class="ltx_td ltx_align_center" id="S5.T7.9.7.7.1"><math alttext="\varnothing" class="ltx_Math" display="inline" id="S5.T7.9.7.7.1.m1.1"><semantics id="S5.T7.9.7.7.1.m1.1a"><mi id="S5.T7.9.7.7.1.m1.1.1" mathvariant="normal" xref="S5.T7.9.7.7.1.m1.1.1.cmml">∅</mi><annotation-xml encoding="MathML-Content" id="S5.T7.9.7.7.1.m1.1b"><emptyset id="S5.T7.9.7.7.1.m1.1.1.cmml" xref="S5.T7.9.7.7.1.m1.1.1"></emptyset></annotation-xml><annotation encoding="application/x-tex" id="S5.T7.9.7.7.1.m1.1c">\varnothing</annotation><annotation encoding="application/x-llamapun" id="S5.T7.9.7.7.1.m1.1d">∅</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T7.10.8.8">
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T7.10.8.8.2">Moshi</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.10.8.8.3">74.3</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.10.8.8.4">58.9</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.10.8.8.5">81.8</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.10.8.8.6">58.7</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.10.8.8.1"><math alttext="\varnothing" class="ltx_Math" display="inline" id="S5.T7.10.8.8.1.m1.1"><semantics id="S5.T7.10.8.8.1.m1.1a"><mi id="S5.T7.10.8.8.1.m1.1.1" mathvariant="normal" xref="S5.T7.10.8.8.1.m1.1.1.cmml">∅</mi><annotation-xml encoding="MathML-Content" id="S5.T7.10.8.8.1.m1.1b"><emptyset id="S5.T7.10.8.8.1.m1.1.1.cmml" xref="S5.T7.10.8.8.1.m1.1.1"></emptyset></annotation-xml><annotation encoding="application/x-tex" id="S5.T7.10.8.8.1.m1.1c">\varnothing</annotation><annotation encoding="application/x-llamapun" id="S5.T7.10.8.8.1.m1.1d">∅</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T7.11.9.14.5">
<td class="ltx_td ltx_align_center ltx_border_t" colspan="6" id="S5.T7.11.9.14.5.1"><span class="ltx_text ltx_font_italic" id="S5.T7.11.9.14.5.1.1">Text and audio - Warm Start</span></td>
</tr>
<tr class="ltx_tr" id="S5.T7.11.9.9">
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T7.11.9.9.2">VoxtLM <cite class="ltx_cite ltx_citemacro_citep">(Maiti et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib66" title="">2023</a>)</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.11.9.9.3">66.1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.11.9.9.4">57.1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.11.9.9.5">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.11.9.9.6">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.11.9.9.1"><math alttext="\varnothing" class="ltx_Math" display="inline" id="S5.T7.11.9.9.1.m1.1"><semantics id="S5.T7.11.9.9.1.m1.1a"><mi id="S5.T7.11.9.9.1.m1.1.1" mathvariant="normal" xref="S5.T7.11.9.9.1.m1.1.1.cmml">∅</mi><annotation-xml encoding="MathML-Content" id="S5.T7.11.9.9.1.m1.1b"><emptyset id="S5.T7.11.9.9.1.m1.1.1.cmml" xref="S5.T7.11.9.9.1.m1.1.1"></emptyset></annotation-xml><annotation encoding="application/x-tex" id="S5.T7.11.9.9.1.m1.1c">\varnothing</annotation><annotation encoding="application/x-llamapun" id="S5.T7.11.9.9.1.m1.1d">∅</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T7.11.9.15.6">
<td class="ltx_td ltx_align_left" id="S5.T7.11.9.15.6.1">Spirit-LM <cite class="ltx_cite ltx_citemacro_citep">(Nguyen et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib72" title="">2024</a>)</cite>
</td>
<td class="ltx_td ltx_align_center" id="S5.T7.11.9.15.6.2">69.0</td>
<td class="ltx_td ltx_align_center" id="S5.T7.11.9.15.6.3">58.3</td>
<td class="ltx_td ltx_align_center" id="S5.T7.11.9.15.6.4">82.9</td>
<td class="ltx_td ltx_align_center" id="S5.T7.11.9.15.6.5">61.0</td>
<td class="ltx_td ltx_align_center" id="S5.T7.11.9.15.6.6">36.9</td>
</tr>
<tr class="ltx_tr" id="S5.T7.11.9.16.7">
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T7.11.9.16.7.1">Moshi after single-stream pretraining</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.11.9.16.7.2">72.6</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.11.9.16.7.3">58.8</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.11.9.16.7.4">83.0</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.11.9.16.7.5">60.8</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.11.9.16.7.6"><span class="ltx_text ltx_font_bold" id="S5.T7.11.9.16.7.6.1">49.8</span></td>
</tr>
<tr class="ltx_tr" id="S5.T7.11.9.17.8">
<td class="ltx_td ltx_align_left" id="S5.T7.11.9.17.8.1">Moshi after multi-stream instruct</td>
<td class="ltx_td ltx_align_center" id="S5.T7.11.9.17.8.2">63.0</td>
<td class="ltx_td ltx_align_center" id="S5.T7.11.9.17.8.3">55.2</td>
<td class="ltx_td ltx_align_center" id="S5.T7.11.9.17.8.4"><span class="ltx_text ltx_font_bold" id="S5.T7.11.9.17.8.4.1">83.6</span></td>
<td class="ltx_td ltx_align_center" id="S5.T7.11.9.17.8.5"><span class="ltx_text ltx_font_bold" id="S5.T7.11.9.17.8.5.1">62.7</span></td>
<td class="ltx_td ltx_align_center" id="S5.T7.11.9.17.8.6">49.7</td>
</tr>
<tr class="ltx_tr" id="S5.T7.11.9.18.9">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S5.T7.11.9.18.9.1">Moshi after multi-stream instruct, synthetic voice</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T7.11.9.18.9.2">60.9</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T7.11.9.18.9.3">54.6</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T7.11.9.18.9.4">82.5</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T7.11.9.18.9.5">60.9</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T7.11.9.18.9.6">48.7</td>
</tr>
</tbody>
</table>
</span></div>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
</section>
<section class="ltx_subsection" id="S5.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4 </span>Audio Language Modeling</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_paragraph" id="S5.SS4.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Metrics.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS4.SSS0.Px1.p1">
<p class="ltx_p" id="S5.SS4.SSS0.Px1.p1.1">We first measure the ability of Moshi to model speech sequences when being trained for next token prediction on large scale audio data. To do so, we rely on “textless NLP”&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Lakhotia et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib54" title="">2021</a>)</cite> metrics that evaluate an audio language model’s linguistic knowledge by comparing likelihoods of positive and negative speech examples represented as audio tokens. sWUGGY evaluates a model’s ability to learn a lexicon from speech by comparing the likelihood of an existing word and an invalid variant (e.g. “oxidation” and “accidation”), while sBLIMP evaluates syntactic contrasts. Spoken StoryCloze metrics introduced by&nbsp;<cite class="ltx_cite ltx_citemacro_citet">Hassid et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib33" title="">2023</a>)</cite> evaluate semantic contrasts by comparing commonsense five-sentence stories, with the last one being either coherent with the context or incoherent. Given the difficulty of this task in the audio domain, <cite class="ltx_cite ltx_citemacro_citet">Hassid et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib33" title="">2023</a>)</cite> also propose Spoken Topic-StoryCloze, a variant where the negative continuation is randomly sampled among unrelated sentences (rather than being subtly incoherent), resulting in higher scores. We score sequences with a negative-log likelihood normalized by the sequence length. Since our model produces several tokens per timestep, we sum all tokens of a timestep with the weights used during training, i.e. 100 for the semantic tokens and 1 for the acoustic ones. We do not include text tokens from the Inner Monologue, as these metrics are designed to compare untranscribed audio sequences. Similarly, when evaluating a multi-stream model after instruction tuning, we only score the tokens from the user stream as it does not include text tokens. Finally, we also report text understanding evaluation (without audio tokens) on MMLU&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Hendrycks et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib37" title="">2020</a>)</cite> for Spirit-LM and Moshi, as a way to measure how much the audio training affects the textual knowledge of the original checkpoint.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS4.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Baselines.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS4.SSS0.Px2.p1">
<p class="ltx_p" id="S5.SS4.SSS0.Px2.p1.1">We compare against baselines from the audio language modeling literature, in three settings. The first category encompasses audio-only models starting from a random initialization, including GSLM&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Lakhotia et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib54" title="">2021</a>)</cite>, AudioLM&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Borsos et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib6" title="">2022</a>)</cite> and TWIST-1.3B&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Hassid et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib33" title="">2023</a>)</cite>. In this case, we report metrics for a single-stream Moshi initialized randomly and pretrained only on audio data and without Inner Monologue. The second category includes models that start from a pretrained text LM and are then only trained on audio. This includes TWIST-13B as well as the audio-only version of VoxtLM (first row of <cite class="ltx_cite ltx_citemacro_citep">(Maiti et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib66" title="">2023</a>, Table 3)</cite>) and that of Spirit-LM (reported as “Speech Only” in <cite class="ltx_cite ltx_citemacro_citep">(Nguyen et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib72" title="">2024</a>, Table 5)</cite>). The corresponding Moshi model is similar to the one mentioned above (audio-only data, no Inner Monologue) but starts from the pretrained Helium checkpoint. The last category is composed of actual multimodal models that are trained jointly on speech and text data. In this context we report results for three configurations of Moshi. First, we report results for Moshi pretrained on single-stream data. Then, we report results for the final model after multi-stream post-training and finetuning using real recordings from a voice actor to condition the creating of synthetic data in Moshi’s voice. The last model is identical to the previous one except for the fact that it uses a synthetic voice for Moshi. We remind the reader that even if these models are trained with Inner Monologue, they are evaluated without, to provide a fair comparison with baselines.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS4.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">Results.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS4.SSS0.Px3.p1">
<p class="ltx_p" id="S5.SS4.SSS0.Px3.p1.1"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.T7" title="Table 7 ‣ Discussion. ‣ 5.3 Ablations on Generative Modeling ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue">Table&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></span></a> reports results on audio language modeling. In the “Audio only - Cold Start” setting, Moshi already provides a strong baseline, in particular considerably improving over previous work in sTopic-StoryCloze. When initialized with an Helium checkpoint and trained on audio-only data, Moshi outperforms previous work in this category on most metrics. Finally, while multimodal training improves common sense reasoning from speech (as shown by sStoryCloze performance), we observe mixed effects on lexical and syntactic judgments (sWUGGY and sBLIMP) compared to models trained only on audio data. While single-stream pretraining moderately degrades sWUGGY and sBLIMP, instruction finetuning severely affects sWUGGY, which means that instructed models have a harder time solving lexical judgments.
We hypothesize that this is due to finetuning Moshi on data of varying quality and simulating noisy and reverberated conditions for the user stream (used to score spoken pairs for all metrics in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.T7" title="Table 7 ‣ Discussion. ‣ 5.3 Ablations on Generative Modeling ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue">Table&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></span></a>) which makes fine lexical judgments harder to solve. Finally, Moshi scores 12 points higher on MMLU than Spirit-LM, thus demonstrating higher general knowledge and text understanding. We moreover emphasize that Moshi is the only model in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.T7" title="Table 7 ‣ Discussion. ‣ 5.3 Ablations on Generative Modeling ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue">Table&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></span></a> that integrates both semantic and acoustic tokens into a single generative model, unlike AudioLM which uses three separate stages, and VoxTLM, TWIST and Spirit-LM that only model semantic tokens and rely on an external vocoder. Thus, Moshi is the only model in this comparison that demonstrates strong linguistic modeling in both speech and text, while being able to model speech in any arbitrary voice and condition.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS4.SSS0.Px4">
<h5 class="ltx_title ltx_title_paragraph">Discussion.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS4.SSS0.Px4.p1">
<p class="ltx_p" id="S5.SS4.SSS0.Px4.p1.1">While “textless NLP” benchmarks have helped developing the first audio language models, we observe that they do not consistently provide good guidance in developing a dialogue model like Moshi. In particular, we find the lack of correlation between common sense metrics and lexical/syntactic judgments to be frequent and easily explainable by the diversity of acoustic conditions we use in training. Moreover, we do not observe a degradation in the model’s lexical variety or intelligibility when finetuning the model, which contradicts the reduction in sWUGGY. This is why we also evaluate spoken question answering in the next section as a way to probe the model’s common sense, knowledge and lexical abilities.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="S5.T8">
<figcaption class="ltx_caption ltx_centering" style="font-size:80%;"><span class="ltx_tag ltx_tag_table">Table 8: </span><span class="ltx_text ltx_font_bold" id="S5.T8.24.1">Evaluation of spoken question answering</span>.
Spoken question answering (0-shot) on the Web Questions&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Berant et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib4" title="">2013</a>)</cite>, LlaMA-Questions&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Nachmani et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib69" title="">2024</a>)</cite>, and Trivia QA&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Joshi et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib43" title="">2017</a>)</cite> benchmarks, synthesized using a TTS engine.
For the first two, we use the number reported by&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Nachmani et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib69" title="">2024</a>)</cite>.
For LlaMA-Questions, we use the audio provided by&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Nachmani et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib69" title="">2024</a>)</cite>.
For Web Questions and Trivia QA, we synthesize our own, keeping all of the questions. For Moshi, we only prepend one of the random incipits used during instruct fine tuning. We further provide the performance
of our Helium text-only model as a top line.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T8.25">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T8.25.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="S5.T8.25.1.1.1"><span class="ltx_text" id="S5.T8.25.1.1.1.1" style="font-size:80%;">Model</span></th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T8.25.1.1.2"><span class="ltx_text" id="S5.T8.25.1.1.2.1" style="font-size:80%;">Web Q.</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T8.25.1.1.3"><span class="ltx_text" id="S5.T8.25.1.1.3.1" style="font-size:80%;">LlaMA Q.</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T8.25.1.1.4"><span class="ltx_text" id="S5.T8.25.1.1.4.1" style="font-size:80%;">Audio Trivia QA</span></td>
</tr>
<tr class="ltx_tr" id="S5.T8.25.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="4" id="S5.T8.25.2.2.1"><span class="ltx_text ltx_font_italic" id="S5.T8.25.2.2.1.1" style="font-size:80%;">Audio only</span></th>
</tr>
<tr class="ltx_tr" id="S5.T8.25.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T8.25.3.3.1">
<span class="ltx_text" id="S5.T8.25.3.3.1.1" style="font-size:80%;">GSLM </span><cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text" id="S5.T8.25.3.3.1.2.1" style="font-size:80%;">(</span>Lakhotia et&nbsp;al.<span class="ltx_text" id="S5.T8.25.3.3.1.3.2.1.1" style="font-size:80%;">, </span><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib54" title="">2021</a><span class="ltx_text" id="S5.T8.25.3.3.1.4.3" style="font-size:80%;">)</span></cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T8.25.3.3.2">
<span class="ltx_text ltx_phantom" id="S5.T8.25.3.3.2.1" style="font-size:80%;"><span style="visibility:hidden">0</span></span><span class="ltx_text" id="S5.T8.25.3.3.2.2" style="font-size:80%;">1.5</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T8.25.3.3.3">
<span class="ltx_text ltx_phantom" id="S5.T8.25.3.3.3.1" style="font-size:80%;"><span style="visibility:hidden">0</span></span><span class="ltx_text" id="S5.T8.25.3.3.3.2" style="font-size:80%;">4.0</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T8.25.3.3.4"><span class="ltx_text" id="S5.T8.25.3.3.4.1" style="font-size:80%;">-</span></td>
</tr>
<tr class="ltx_tr" id="S5.T8.25.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T8.25.4.4.1">
<span class="ltx_text" id="S5.T8.25.4.4.1.1" style="font-size:80%;">AudioLM </span><cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text" id="S5.T8.25.4.4.1.2.1" style="font-size:80%;">(</span>Borsos et&nbsp;al.<span class="ltx_text" id="S5.T8.25.4.4.1.3.2.1.1" style="font-size:80%;">, </span><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib6" title="">2022</a><span class="ltx_text" id="S5.T8.25.4.4.1.4.3" style="font-size:80%;">)</span></cite>
</th>
<td class="ltx_td ltx_align_center" id="S5.T8.25.4.4.2">
<span class="ltx_text ltx_phantom" id="S5.T8.25.4.4.2.1" style="font-size:80%;"><span style="visibility:hidden">0</span></span><span class="ltx_text" id="S5.T8.25.4.4.2.2" style="font-size:80%;">2.3</span>
</td>
<td class="ltx_td ltx_align_center" id="S5.T8.25.4.4.3">
<span class="ltx_text ltx_phantom" id="S5.T8.25.4.4.3.1" style="font-size:80%;"><span style="visibility:hidden">0</span></span><span class="ltx_text" id="S5.T8.25.4.4.3.2" style="font-size:80%;">7.0</span>
</td>
<td class="ltx_td ltx_align_center" id="S5.T8.25.4.4.4"><span class="ltx_text" id="S5.T8.25.4.4.4.1" style="font-size:80%;">-</span></td>
</tr>
<tr class="ltx_tr" id="S5.T8.25.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T8.25.5.5.1">
<span class="ltx_text" id="S5.T8.25.5.5.1.1" style="font-size:80%;">TWIST (7B) </span><cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text" id="S5.T8.25.5.5.1.2.1" style="font-size:80%;">(</span>Hassid et&nbsp;al.<span class="ltx_text" id="S5.T8.25.5.5.1.3.2.1.1" style="font-size:80%;">, </span><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib33" title="">2023</a><span class="ltx_text" id="S5.T8.25.5.5.1.4.3" style="font-size:80%;">)</span></cite>
</th>
<td class="ltx_td ltx_align_center" id="S5.T8.25.5.5.2">
<span class="ltx_text ltx_phantom" id="S5.T8.25.5.5.2.1" style="font-size:80%;"><span style="visibility:hidden">0</span></span><span class="ltx_text" id="S5.T8.25.5.5.2.2" style="font-size:80%;">1.1</span>
</td>
<td class="ltx_td ltx_align_center" id="S5.T8.25.5.5.3">
<span class="ltx_text ltx_phantom" id="S5.T8.25.5.5.3.1" style="font-size:80%;"><span style="visibility:hidden">0</span></span><span class="ltx_text" id="S5.T8.25.5.5.3.2" style="font-size:80%;">0.5</span>
</td>
<td class="ltx_td ltx_align_center" id="S5.T8.25.5.5.4"><span class="ltx_text" id="S5.T8.25.5.5.4.1" style="font-size:80%;">-</span></td>
</tr>
<tr class="ltx_tr" id="S5.T8.25.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T8.25.6.6.1"><span class="ltx_text" id="S5.T8.25.6.6.1.1" style="font-size:80%;">Moshi (w/o Inner Monologue)</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T8.25.6.6.2">
<span class="ltx_text ltx_phantom" id="S5.T8.25.6.6.2.1" style="font-size:80%;"><span style="visibility:hidden">0</span></span><span class="ltx_text ltx_font_bold" id="S5.T8.25.6.6.2.2" style="font-size:80%;">9.2</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T8.25.6.6.3"><span class="ltx_text ltx_font_bold" id="S5.T8.25.6.6.3.1" style="font-size:80%;">21.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T8.25.6.6.4"><span class="ltx_text" id="S5.T8.25.6.6.4.1" style="font-size:80%;">7.3</span></td>
</tr>
<tr class="ltx_tr" id="S5.T8.25.7.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="4" id="S5.T8.25.7.7.1"><span class="ltx_text ltx_font_italic" id="S5.T8.25.7.7.1.1" style="font-size:80%;">Text and audio</span></th>
</tr>
<tr class="ltx_tr" id="S5.T8.25.8.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T8.25.8.8.1">
<span class="ltx_text" id="S5.T8.25.8.8.1.1" style="font-size:80%;">SpeechGPT (7B) </span><cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text" id="S5.T8.25.8.8.1.2.1" style="font-size:80%;">(</span>Zhang et&nbsp;al.<span class="ltx_text" id="S5.T8.25.8.8.1.3.2.1.1" style="font-size:80%;">, </span><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib112" title="">2024a</a><span class="ltx_text" id="S5.T8.25.8.8.1.4.3" style="font-size:80%;">)</span></cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T8.25.8.8.2">
<span class="ltx_text ltx_phantom" id="S5.T8.25.8.8.2.1" style="font-size:80%;"><span style="visibility:hidden">0</span></span><span class="ltx_text" id="S5.T8.25.8.8.2.2" style="font-size:80%;">6.5</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T8.25.8.8.3"><span class="ltx_text" id="S5.T8.25.8.8.3.1" style="font-size:80%;">21.6</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T8.25.8.8.4"><span class="ltx_text" id="S5.T8.25.8.8.4.1" style="font-size:80%;">14.8</span></td>
</tr>
<tr class="ltx_tr" id="S5.T8.25.9.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T8.25.9.9.1">
<span class="ltx_text" id="S5.T8.25.9.9.1.1" style="font-size:80%;">Spectron (1B) </span><cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text" id="S5.T8.25.9.9.1.2.1" style="font-size:80%;">(</span>Nachmani et&nbsp;al.<span class="ltx_text" id="S5.T8.25.9.9.1.3.2.1.1" style="font-size:80%;">, </span><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib69" title="">2024</a><span class="ltx_text" id="S5.T8.25.9.9.1.4.3" style="font-size:80%;">)</span></cite>
</th>
<td class="ltx_td ltx_align_center" id="S5.T8.25.9.9.2">
<span class="ltx_text ltx_phantom" id="S5.T8.25.9.9.2.1" style="font-size:80%;"><span style="visibility:hidden">0</span></span><span class="ltx_text" id="S5.T8.25.9.9.2.2" style="font-size:80%;">6.1</span>
</td>
<td class="ltx_td ltx_align_center" id="S5.T8.25.9.9.3"><span class="ltx_text" id="S5.T8.25.9.9.3.1" style="font-size:80%;">22.9</span></td>
<td class="ltx_td ltx_align_center" id="S5.T8.25.9.9.4"><span class="ltx_text" id="S5.T8.25.9.9.4.1" style="font-size:80%;">-</span></td>
</tr>
<tr class="ltx_tr" id="S5.T8.25.10.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T8.25.10.10.1"><span class="ltx_text" id="S5.T8.25.10.10.1.1" style="font-size:80%;">Moshi</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T8.25.10.10.2"><span class="ltx_text ltx_font_bold" id="S5.T8.25.10.10.2.1" style="font-size:80%;">26.6</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T8.25.10.10.3"><span class="ltx_text ltx_font_bold" id="S5.T8.25.10.10.3.1" style="font-size:80%;">62.3</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T8.25.10.10.4"><span class="ltx_text ltx_font_bold" id="S5.T8.25.10.10.4.1" style="font-size:80%;">22.8</span></td>
</tr>
<tr class="ltx_tr" id="S5.T8.25.11.11">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T8.25.11.11.1"><span class="ltx_text" id="S5.T8.25.11.11.1.1" style="font-size:80%;">Moshi (w/o text batches in pre-training)</span></th>
<td class="ltx_td ltx_align_center" id="S5.T8.25.11.11.2"><span class="ltx_text" id="S5.T8.25.11.11.2.1" style="font-size:80%;">23.2</span></td>
<td class="ltx_td ltx_align_center" id="S5.T8.25.11.11.3"><span class="ltx_text" id="S5.T8.25.11.11.3.1" style="font-size:80%;">61.3</span></td>
<td class="ltx_td ltx_align_center" id="S5.T8.25.11.11.4"><span class="ltx_text" id="S5.T8.25.11.11.4.1" style="font-size:80%;">18.3</span></td>
</tr>
<tr class="ltx_tr" id="S5.T8.25.12.12">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="4" id="S5.T8.25.12.12.1"><span class="ltx_text ltx_font_italic" id="S5.T8.25.12.12.1.1" style="font-size:80%;">Text</span></th>
</tr>
<tr class="ltx_tr" id="S5.T8.25.13.13">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="S5.T8.25.13.13.1"><span class="ltx_text" id="S5.T8.25.13.13.1.1" style="font-size:80%;">Helium (text)</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T8.25.13.13.2"><span class="ltx_text" id="S5.T8.25.13.13.2.1" style="font-size:80%;">32.3</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T8.25.13.13.3"><span class="ltx_text" id="S5.T8.25.13.13.3.1" style="font-size:80%;">75.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T8.25.13.13.4"><span class="ltx_text" id="S5.T8.25.13.13.4.1" style="font-size:80%;">56.4</span></td>
</tr>
</tbody>
</table>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
</section>
<section class="ltx_subsection" id="S5.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.5 </span>Spoken Question Answering</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_paragraph" id="S5.SS5.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Metrics.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS5.SSS0.Px1.p1">
<p class="ltx_p" id="S5.SS5.SSS0.Px1.p1.1">We evaluate the spoken question answering abilities of our multi-stream Moshi model. We rely on Spoken Web Questions and Llama Questions, both introduced by&nbsp;<cite class="ltx_cite ltx_citemacro_citet">Nachmani et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib69" title="">2024</a>)</cite>. We also synthesize an audio version of TriviaQA. When evaluating Moshi, we insert the audio tokens of the question into the user stream to simulate a user interaction, along with a final <span class="ltx_text ltx_font_typewriter" id="S5.SS5.SSS0.Px1.p1.1.1">EPAD</span> text token to trigger an immediate response from Moshi.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS5.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Baselines.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS5.SSS0.Px2.p1">
<p class="ltx_p" id="S5.SS5.SSS0.Px2.p1.1">We compare to Spectron and baselines used by&nbsp;<cite class="ltx_cite ltx_citemacro_citet">Nachmani et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib69" title="">2024</a>)</cite>, all having been already introduced in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.SS4" title="5.4 Audio Language Modeling ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue">Section&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.4</span></span></a> except for SpeechGPT&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Zhang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib112" title="">2024a</a>)</cite>. To measure the impact of Inner Monologue on spoken fluency, we compare these baselines with Moshi trained with and without Inner Monologue. As GSLM, AudioLM and TWIST are audio only, Moshi without Inner Monologue provides a fair comparison. On the other hand, Spectron and SpeechGPT rely on Chain-of-Modality—they generate an answer first as text, and then as speech— so we compare them to Moshi with Inner Monologue. Moreover, to quantify an eventual degradation in knowledge due to training on audio data, we also compare to Helium when evaluated on the textual counterpart to each spoken dataset.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS5.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">Results.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS5.SSS0.Px3.p1">
<p class="ltx_p" id="S5.SS5.SSS0.Px3.p1.1"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.T8" title="Table 8 ‣ Discussion. ‣ 5.4 Audio Language Modeling ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue">Table&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></span></a> reports accuracies on the three benchmarks. While audio-only Moshi significantly outperforms baselines in its categories, the most striking result is the impact of Inner Monologue on Moshi’s performance, almost tripling its accuracy on all benchmarks. This is remarkable as Inner Monologue only marginally increases inference cost (each multi-stream timestep requires generating 17 tokens, instead of 16 without). We emphasize that among all models in this comparison, Moshi not only provides the best spoken question answering performance, but is also the only one to model jointly semantic and acoustic tokens, such that it can handle interactions between arbitrary voices in many conditions. Moshi significantly outperforms SpeechGPT and Spectron while it is the only model compatible with streaming inference, as Chain-of-Modality requires generating a full answer in text before generating speech, while Inner Monologue generates both in a streaming fashion.
Finally, we note that Moshi with Inner Monologue but without keeping 50% of text-only batches during pre-training leads to a noticeable drop in acccuracy, showing that a warm start from Helium is not sufficient to retain the knowledge of the original text model throughout the training.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS5.SSS0.Px4">
<h5 class="ltx_title ltx_title_paragraph">Discussion.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS5.SSS0.Px4.p1">
<p class="ltx_p" id="S5.SS5.SSS0.Px4.p1.1">Despite the strong performance of Moshi, we observe a weaker performance than the baseHelium model, which is consistent with the reduced MMLU of 49.7 reported in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.T7" title="Table 7 ‣ Discussion. ‣ 5.3 Ablations on Generative Modeling ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue">Table&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></span></a> from 54.3 with Helium. While the moderate differences on Web Questions and Llama Questions can be explained by training on audio data and thus reducing the amount of parameters dedicated to textual knowledge, the very large difference on Trivia QA incites us to inspect more thoroughly patterns of errors. We find that multiple-sentence questions (e.g. “The Terror of the Monster was an early title for a best-selling novel which inspired one of the highest-grossing movies of the mid-70’s. Under what name did it eventually terrify the reading and film going public?”) or ones with specific syntactic structure (e.g. “On the human body, a keloid is a type of what?”) are challenging for Moshi, due to it being finetuned on oral-style conversations that do not display such patterns. We hypothesize that covering more syntactic scenarios during finetuning could reduce this gap.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="S5.T9">
<figcaption class="ltx_caption ltx_centering" style="font-size:80%;"><span class="ltx_tag ltx_tag_table">Table 9: </span><span class="ltx_text ltx_font_bold" id="S5.T9.6.1">Linguistic quality and turn-taking statistics of generated dialogues</span>. As we train our multi-stream model to generate both sides of the conversation, we can generate dialogues without the need to interact with a real user. This allows evaluating how much Moshi learns natural conversational dynamics.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S5.T9.2" style="width:433.6pt;height:119pt;vertical-align:-0.8pt;"><span class="ltx_transformed_inner" style="transform:translate(-47.2pt,12.9pt) scale(0.821144532686197,0.821144532686197) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T9.2.2">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T9.2.2.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="S5.T9.2.2.3.1.1"><span class="ltx_text" id="S5.T9.2.2.3.1.1.1" style="font-size:80%;">Model</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_tt" id="S5.T9.2.2.3.1.2"><span class="ltx_text" id="S5.T9.2.2.3.1.2.1" style="font-size:80%;">samples</span></th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T9.2.2.3.1.3"><span class="ltx_text" id="S5.T9.2.2.3.1.3.1" style="font-size:80%;">temp</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T9.2.2.3.1.4"><span class="ltx_text" id="S5.T9.2.2.3.1.4.1" style="font-size:80%;">cond. PPL</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T9.2.2.3.1.5"><span class="ltx_text" id="S5.T9.2.2.3.1.5.1" style="font-size:80%;">IPU</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T9.2.2.3.1.6"><span class="ltx_text" id="S5.T9.2.2.3.1.6.1" style="font-size:80%;">Pause</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T9.2.2.3.1.7"><span class="ltx_text" id="S5.T9.2.2.3.1.7.1" style="font-size:80%;">Gap</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T9.2.2.3.1.8"><span class="ltx_text" id="S5.T9.2.2.3.1.8.1" style="font-size:80%;">Overlap</span></td>
</tr>
<tr class="ltx_tr" id="S5.T9.2.2.4.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T9.2.2.4.2.1">
<span class="ltx_text" id="S5.T9.2.2.4.2.1.1" style="font-size:80%;">Best non-cascaded </span><cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text" id="S5.T9.2.2.4.2.1.2.1" style="font-size:80%;">(</span>Nguyen et&nbsp;al.<span class="ltx_text" id="S5.T9.2.2.4.2.1.3.2.1.1" style="font-size:80%;">, </span><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib71" title="">2023</a><span class="ltx_text" id="S5.T9.2.2.4.2.1.4.3" style="font-size:80%;">)</span></cite>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S5.T9.2.2.4.2.2"><span class="ltx_text" id="S5.T9.2.2.4.2.2.1" style="font-size:80%;">50</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T9.2.2.4.2.3"><span class="ltx_text" id="S5.T9.2.2.4.2.3.1" style="font-size:80%;">1.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T9.2.2.4.2.4"><span class="ltx_text" id="S5.T9.2.2.4.2.4.1" style="font-size:80%;">195.9</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T9.2.2.4.2.5"><span class="ltx_text" id="S5.T9.2.2.4.2.5.1" style="font-size:80%;">41.4s</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T9.2.2.4.2.6"><span class="ltx_text" id="S5.T9.2.2.4.2.6.1" style="font-size:80%;">13.8s</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T9.2.2.4.2.7"><span class="ltx_text" id="S5.T9.2.2.4.2.7.1" style="font-size:80%;">10.7s</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T9.2.2.4.2.8"><span class="ltx_text" id="S5.T9.2.2.4.2.8.1" style="font-size:80%;">6.1s</span></td>
</tr>
<tr class="ltx_tr" id="S5.T9.2.2.5.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T9.2.2.5.3.1">
<span class="ltx_text" id="S5.T9.2.2.5.3.1.1" style="font-size:80%;">Cascaded </span><cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text" id="S5.T9.2.2.5.3.1.2.1" style="font-size:80%;">(</span>Nguyen et&nbsp;al.<span class="ltx_text" id="S5.T9.2.2.5.3.1.3.2.1.1" style="font-size:80%;">, </span><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib71" title="">2023</a><span class="ltx_text" id="S5.T9.2.2.5.3.1.4.3" style="font-size:80%;">)</span></cite>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S5.T9.2.2.5.3.2"><span class="ltx_text" id="S5.T9.2.2.5.3.2.1" style="font-size:80%;">50</span></th>
<td class="ltx_td ltx_align_center" id="S5.T9.2.2.5.3.3"><span class="ltx_text" id="S5.T9.2.2.5.3.3.1" style="font-size:80%;">1.0</span></td>
<td class="ltx_td ltx_align_center" id="S5.T9.2.2.5.3.4"><span class="ltx_text" id="S5.T9.2.2.5.3.4.1" style="font-size:80%;">45.9</span></td>
<td class="ltx_td ltx_align_center" id="S5.T9.2.2.5.3.5"><span class="ltx_text" id="S5.T9.2.2.5.3.5.1" style="font-size:80%;">54.8s</span></td>
<td class="ltx_td ltx_align_center" id="S5.T9.2.2.5.3.6"><span class="ltx_text" id="S5.T9.2.2.5.3.6.1" style="font-size:80%;">0.0s</span></td>
<td class="ltx_td ltx_align_center" id="S5.T9.2.2.5.3.7"><span class="ltx_text" id="S5.T9.2.2.5.3.7.1" style="font-size:80%;">5.3s</span></td>
<td class="ltx_td ltx_align_center" id="S5.T9.2.2.5.3.8"><span class="ltx_text" id="S5.T9.2.2.5.3.8.1" style="font-size:80%;">0.0s</span></td>
</tr>
<tr class="ltx_tr" id="S5.T9.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T9.1.1.1.2">
<span class="ltx_text" id="S5.T9.1.1.1.2.1" style="font-size:80%;">Ground Truth </span><cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text" id="S5.T9.1.1.1.2.2.1" style="font-size:80%;">(</span>Nguyen et&nbsp;al.<span class="ltx_text" id="S5.T9.1.1.1.2.3.2.1.1" style="font-size:80%;">, </span><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib71" title="">2023</a><span class="ltx_text" id="S5.T9.1.1.1.2.4.3" style="font-size:80%;">)</span></cite>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S5.T9.1.1.1.3"><span class="ltx_text" id="S5.T9.1.1.1.3.1" style="font-size:80%;">50</span></th>
<td class="ltx_td ltx_align_center" id="S5.T9.1.1.1.1"><math alttext="\varnothing" class="ltx_Math" display="inline" id="S5.T9.1.1.1.1.m1.1"><semantics id="S5.T9.1.1.1.1.m1.1a"><mi id="S5.T9.1.1.1.1.m1.1.1" mathsize="80%" mathvariant="normal" xref="S5.T9.1.1.1.1.m1.1.1.cmml">∅</mi><annotation-xml encoding="MathML-Content" id="S5.T9.1.1.1.1.m1.1b"><emptyset id="S5.T9.1.1.1.1.m1.1.1.cmml" xref="S5.T9.1.1.1.1.m1.1.1"></emptyset></annotation-xml><annotation encoding="application/x-tex" id="S5.T9.1.1.1.1.m1.1c">\varnothing</annotation><annotation encoding="application/x-llamapun" id="S5.T9.1.1.1.1.m1.1d">∅</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S5.T9.1.1.1.4"><span class="ltx_text" id="S5.T9.1.1.1.4.1" style="font-size:80%;">65.0</span></td>
<td class="ltx_td ltx_align_center" id="S5.T9.1.1.1.5"><span class="ltx_text" id="S5.T9.1.1.1.5.1" style="font-size:80%;">53.5s</span></td>
<td class="ltx_td ltx_align_center" id="S5.T9.1.1.1.6"><span class="ltx_text" id="S5.T9.1.1.1.6.1" style="font-size:80%;">5.5s</span></td>
<td class="ltx_td ltx_align_center" id="S5.T9.1.1.1.7"><span class="ltx_text" id="S5.T9.1.1.1.7.1" style="font-size:80%;">4.4s</span></td>
<td class="ltx_td ltx_align_center" id="S5.T9.1.1.1.8"><span class="ltx_text" id="S5.T9.1.1.1.8.1" style="font-size:80%;">3.6s</span></td>
</tr>
<tr class="ltx_tr" id="S5.T9.2.2.6.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T9.2.2.6.4.1"><span class="ltx_text" id="S5.T9.2.2.6.4.1.1" style="font-size:80%;">Moshi</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S5.T9.2.2.6.4.2"><span class="ltx_text" id="S5.T9.2.2.6.4.2.1" style="font-size:80%;">1000</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T9.2.2.6.4.3"><span class="ltx_text" id="S5.T9.2.2.6.4.3.1" style="font-size:80%;">0.8</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T9.2.2.6.4.4"><span class="ltx_text ltx_font_bold" id="S5.T9.2.2.6.4.4.1" style="font-size:80%;">41.9</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T9.2.2.6.4.5"><span class="ltx_text" id="S5.T9.2.2.6.4.5.1" style="font-size:80%;">35.1s</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T9.2.2.6.4.6"><span class="ltx_text" id="S5.T9.2.2.6.4.6.1" style="font-size:80%;">13.2s</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T9.2.2.6.4.7"><span class="ltx_text" id="S5.T9.2.2.6.4.7.1" style="font-size:80%;">12.5s</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T9.2.2.6.4.8"><span class="ltx_text" id="S5.T9.2.2.6.4.8.1" style="font-size:80%;">1.2s</span></td>
</tr>
<tr class="ltx_tr" id="S5.T9.2.2.7.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T9.2.2.7.5.1"><span class="ltx_text" id="S5.T9.2.2.7.5.1.1" style="font-size:80%;">Moshi</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S5.T9.2.2.7.5.2"><span class="ltx_text" id="S5.T9.2.2.7.5.2.1" style="font-size:80%;">1000</span></th>
<td class="ltx_td ltx_align_center" id="S5.T9.2.2.7.5.3"><span class="ltx_text" id="S5.T9.2.2.7.5.3.1" style="font-size:80%;">0.9</span></td>
<td class="ltx_td ltx_align_center" id="S5.T9.2.2.7.5.4"><span class="ltx_text" id="S5.T9.2.2.7.5.4.1" style="font-size:80%;">56.7</span></td>
<td class="ltx_td ltx_align_center" id="S5.T9.2.2.7.5.5"><span class="ltx_text" id="S5.T9.2.2.7.5.5.1" style="font-size:80%;">44.7s</span></td>
<td class="ltx_td ltx_align_center" id="S5.T9.2.2.7.5.6"><span class="ltx_text" id="S5.T9.2.2.7.5.6.1" style="font-size:80%;">9.1s</span></td>
<td class="ltx_td ltx_align_center" id="S5.T9.2.2.7.5.7"><span class="ltx_text" id="S5.T9.2.2.7.5.7.1" style="font-size:80%;">7.5s</span></td>
<td class="ltx_td ltx_align_center" id="S5.T9.2.2.7.5.8"><span class="ltx_text" id="S5.T9.2.2.7.5.8.1" style="font-size:80%;">2.2s</span></td>
</tr>
<tr class="ltx_tr" id="S5.T9.2.2.8.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T9.2.2.8.6.1"><span class="ltx_text" id="S5.T9.2.2.8.6.1.1" style="font-size:80%;">Moshi</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S5.T9.2.2.8.6.2"><span class="ltx_text" id="S5.T9.2.2.8.6.2.1" style="font-size:80%;">1000</span></th>
<td class="ltx_td ltx_align_center" id="S5.T9.2.2.8.6.3"><span class="ltx_text" id="S5.T9.2.2.8.6.3.1" style="font-size:80%;">1.0</span></td>
<td class="ltx_td ltx_align_center" id="S5.T9.2.2.8.6.4"><span class="ltx_text" id="S5.T9.2.2.8.6.4.1" style="font-size:80%;">79.3</span></td>
<td class="ltx_td ltx_align_center" id="S5.T9.2.2.8.6.5"><span class="ltx_text" id="S5.T9.2.2.8.6.5.1" style="font-size:80%;">50.8s</span></td>
<td class="ltx_td ltx_align_center" id="S5.T9.2.2.8.6.6"><span class="ltx_text" id="S5.T9.2.2.8.6.6.1" style="font-size:80%;">7.0s</span></td>
<td class="ltx_td ltx_align_center" id="S5.T9.2.2.8.6.7"><span class="ltx_text" id="S5.T9.2.2.8.6.7.1" style="font-size:80%;">4.5s</span></td>
<td class="ltx_td ltx_align_center" id="S5.T9.2.2.8.6.8"><span class="ltx_text" id="S5.T9.2.2.8.6.8.1" style="font-size:80%;">4.1s</span></td>
</tr>
<tr class="ltx_tr" id="S5.T9.2.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S5.T9.2.2.2.2"><span class="ltx_text" id="S5.T9.2.2.2.2.1" style="font-size:80%;">Ground Truth</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="S5.T9.2.2.2.3"><span class="ltx_text" id="S5.T9.2.2.2.3.1" style="font-size:80%;">1000</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T9.2.2.2.1"><math alttext="\varnothing" class="ltx_Math" display="inline" id="S5.T9.2.2.2.1.m1.1"><semantics id="S5.T9.2.2.2.1.m1.1a"><mi id="S5.T9.2.2.2.1.m1.1.1" mathsize="80%" mathvariant="normal" xref="S5.T9.2.2.2.1.m1.1.1.cmml">∅</mi><annotation-xml encoding="MathML-Content" id="S5.T9.2.2.2.1.m1.1b"><emptyset id="S5.T9.2.2.2.1.m1.1.1.cmml" xref="S5.T9.2.2.2.1.m1.1.1"></emptyset></annotation-xml><annotation encoding="application/x-tex" id="S5.T9.2.2.2.1.m1.1c">\varnothing</annotation><annotation encoding="application/x-llamapun" id="S5.T9.2.2.2.1.m1.1d">∅</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T9.2.2.2.4"><span class="ltx_text" id="S5.T9.2.2.2.4.1" style="font-size:80%;">59.6</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T9.2.2.2.5"><span class="ltx_text" id="S5.T9.2.2.2.5.1" style="font-size:80%;">51.1s</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T9.2.2.2.6"><span class="ltx_text" id="S5.T9.2.2.2.6.1" style="font-size:80%;">6.4s</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T9.2.2.2.7"><span class="ltx_text" id="S5.T9.2.2.2.7.1" style="font-size:80%;">4.2s</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T9.2.2.2.8"><span class="ltx_text" id="S5.T9.2.2.2.8.1" style="font-size:80%;">3.3s</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
</section>
<section class="ltx_subsection" id="S5.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.6 </span>Quality and Statistics of Generated Dialogues</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_paragraph" id="S5.SS6.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Metrics.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS6.SSS0.Px1.p1">
<p class="ltx_p" id="S5.SS6.SSS0.Px1.p1.1">Beyond single-turn question answering, we evaluate the linguistic quality of the generated dialogues by scoring them with an external language model, while also looking at turn-taking metrics. We follow the methodology of &nbsp;<cite class="ltx_cite ltx_citemacro_citet">Nguyen et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib71" title="">2023</a>)</cite>. The turn-taking metrics are defined as follows: <em class="ltx_emph ltx_font_italic" id="S5.SS6.SSS0.Px1.p1.1.1">Inter-Pausal Units</em> (IPU) are continuous streches of speech that are separated by a silence of at least 0.2s on each side.
<em class="ltx_emph ltx_font_italic" id="S5.SS6.SSS0.Px1.p1.1.2">Pauses</em> are silences between IPUs of the same speakers.
<em class="ltx_emph ltx_font_italic" id="S5.SS6.SSS0.Px1.p1.1.3">Gaps</em> are silences between IPUs of different speakers.
<em class="ltx_emph ltx_font_italic" id="S5.SS6.SSS0.Px1.p1.1.4">Overlaps</em> are times where there are IPUs for both speakers. Following &nbsp;<cite class="ltx_cite ltx_citemacro_citet">Nguyen et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib71" title="">2023</a>)</cite>, the semantic evaluation uses the open-source DialoGPT model&nbsp;<cite class="ltx_cite ltx_citemacro_cite">Zhang et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib114" title="">2019</a>)</cite> and we compute the perplexity of the transcribed dialogue by separating each speaker using the <span class="ltx_text ltx_font_typewriter" id="S5.SS6.SSS0.Px1.p1.1.5">&lt;|endoftext|&gt;</span> token expected by DialoGPT.
We select 1000 random 10 seconds prompts from the Fisher dataset and use Moshi to generate continuations. For each one, 32 continuations are generated, for
3 different temperatures as it significantly affects the results.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS6.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Baselines.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS6.SSS0.Px2.p1">
<p class="ltx_p" id="S5.SS6.SSS0.Px2.p1.1">We compare to dGSLM <cite class="ltx_cite ltx_citemacro_citep">(Nguyen et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib71" title="">2023</a>)</cite>, as it is also a full-duplex generative model, trained on the Fisher dataset. <cite class="ltx_cite ltx_citemacro_citet">Nguyen et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib71" title="">2023</a>)</cite> use 50 prompts with 50 continuations for each and report results for their dialogue model as well as a cascaded topline model (ASR + LM + TTS).</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS6.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">Results.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS6.SSS0.Px3.p1">
<p class="ltx_p" id="S5.SS6.SSS0.Px3.p1.1"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.T9" title="Table 9 ‣ Discussion. ‣ 5.5 Spoken Question Answering ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue">Table&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></span></a> shows that Moshi performs as well as the cascaded model in terms of linguistic quality, despite being an audio-to-audio model. Both have a perplexity that
is better than the ground truth, which is explained by these models being trained on data
that is closer to what DialoGPT has been trained on compared to the Fisher dataset. This is a strong improvement over the non-cascaded model from&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Nguyen et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib71" title="">2023</a>)</cite>, which is not able to generate coherent speech in this scenario.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_subsection" id="S5.SS7">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.7 </span>Streaming ASR and TTS</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_paragraph" id="S5.SS7.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Metrics.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS7.SSS0.Px1.p1">
<p class="ltx_p" id="S5.SS7.SSS0.Px1.p1.1"><a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS4.SSS4" title="3.4.4 Inner Monologue ‣ 3.4 Generative Audio Modeling ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue">Section <span class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.4.4</span></span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#A3" title="Appendix C Delayed text LM as a zero-shot streaming ASR and TTS ‣ Moshi: a speech-text foundation model for real-time dialogue">Appendix&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">C</span></span></a> describe how Inner Monologue can provide a streaming TTS or streaming ASR system by simply changing the delay it uses between text and audio tokens. In particular, we train a streaming TTS model by delaying audio tokens by 2 seconds, giving some lookahead to the text tokens, and teacher forcing text tokens at inference. Similarly, we train a streaming ASR model by delaying text tokens by 2 seconds, allowing the model to listen to audio content before generating text tokens. In that case, at inference we teacher force the audio tokens. We perform TTS with a temperature of 0.6 while we use greedy decoding for ASR, and evaluate on LibriSpeech&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Panayotov et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib74" title="">2015</a>)</cite> test-clean in Word Error Rate (WER). For TTS, we first transcribe the generated audio with HuBERT-Large&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Hsu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib42" title="">2021</a>)</cite> finetuned on LibriSpeech 960h,<span class="ltx_note ltx_role_footnote" id="footnote16"><sup class="ltx_note_mark">16</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">16</sup><span class="ltx_tag ltx_tag_note">16</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://huggingface.co/facebook/hubert-large-ls960-ft" title="">https://huggingface.co/facebook/hubert-large-ls960-ft</a></span></span></span> and only consider sequences between 4 and 10s, which allows comparing to baselines such as Vall-E&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Wang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib103" title="">2023</a>)</cite>. We emphasize that no LibriSpeech data is seen during the training of our ASR and TTS systems.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS7.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Results.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS7.SSS0.Px2.p1">
<p class="ltx_p" id="S5.SS7.SSS0.Px2.p1.1">Our streaming TTS model obtains 4.7% of WER on LibriSpeech test-clean, which outperforms Vall-E’s 5.9% WER but is worse than NaturalSpeech 3&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Ju et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib45" title="">2024</a>)</cite> with 1.81%. Yet, Moshi only requires 2 seconds of lookahead when Vall-E and NaturalSpeech 3 require access to the full sequence. Our ASR system yields 5.7% WER, while a Streaming FastConformer&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Noroozi et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib73" title="">2024</a>)</cite> gets 3.6% with a similar look-ahead. Note that our ASR system also provides alignments of transcripts with a precision of 80ms (the framerate of the Temporal Transformer).</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS7.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">Discussion.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS7.SSS0.Px3.p1">
<p class="ltx_p" id="S5.SS7.SSS0.Px3.p1.1">This limited experimentation is not intended to compete with state-of-the-art systems (in particular for ASR), but is rather designed to illustrate how Inner Monologue is flexible enough to cast several tasks into the same framework. We also emphasize that the standard evaluation on LibriSpeech test-clean does not provide a testbed to showcase strong capabilities of our TTS system, in particular its ability to model two speakers with multi-stream modeling, and generating consistent dialogues of spontaneous, expressive speech across 5 minutes (while Vall-E only evaluates sequences between 4 and 10 seconds of read speech). We reserve a thorough evaluation of streaming TTS for future work.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_subsection" id="S5.SS8">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.8 </span>Compressing Moshi and Impact on Speech Quality</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS8.p1">
<p class="ltx_p" id="S5.SS8.p1.1">With most modern LLMs built off billions of parameters, model size is a well-known bottleneck for practical uses such as running on resource-constrained devices (e.g. laptop with user-grade GPU) or model deployment (e.g. serving many users on an online web demo).
To address this, Post-Training Quantization (PTQ) is a widely used efficiency technique for compressing model weights and activations, with the downside of possible performance degradation. Recent work has shown that LLMs can often successfully be quantized to 8 bits with integer quantization, and sometimes to even lower bitwidths using more advanced techniques to handle outlier weights&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Dettmers and Zettlemoyer, <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib22" title="">2023</a>; Dettmers et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib23" title="">2022</a>; Frantar et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib30" title="">2023</a>; Tseng et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib98" title="">2024</a>)</cite>.
However, the literature on quantizing speech models is much more scarce than that of LLMs.
Thus, in this section, we investigate how quantizing Moshi impacts its performance, both linguistically and especially acoustically, as we highlight certain audio degradations aggravated by model quantization.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_paragraph" id="S5.SS8.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Quantization Format.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS8.SSS0.Px1.p1">
<p class="ltx_p" id="S5.SS8.SSS0.Px1.p1.1">To quantize Moshi, we follow common design choices from the PTQ literature. In all results below, we settle on the following setting: (i) Activations are stored in <span class="ltx_text ltx_font_typewriter" id="S5.SS8.SSS0.Px1.p1.1.1">bfloat16</span> precision (BF16) and dynamically quantized to 8 bits using symmetric quantization (a.k.a. AbsMax) at the input of every linear layer;
(ii) The model weights are quantized using asymetric quantization (a.k.a. MinMax) for different bitwidths and block sizes. This includes both the Temporal Transformer as well as the Depth Transformer weights. In fact, we find that the Depth Transformer is reasonably robust to quantization, as keeping only its weights in high precision does not significantly improve audio quality.
Only the initial embedding layers (both for text and audio), the RMSNorms and the Mimi codec are left unquantized.
Finally, note that, although weight range setting is also common practice&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Nagel et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib70" title="">2021</a>)</cite>, we do not finetune the obtained quantization scales using MSE as we find it has little impact on the quality of generated samples.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS8.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Results - Linguistic evaluation.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS8.SSS0.Px2.p1">
<p class="ltx_p" id="S5.SS8.SSS0.Px2.p1.1">To assess how quantization impacts the reasoning ability of the model, we evaluate the quantized models’ performance on the MMLU benchmark for the base Helium model trained on text-only data used as foundation for Moshi (<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.T10" title="Table 10 ‣ Results - Linguistic evaluation. ‣ 5.8 Compressing Moshi and Impact on Speech Quality ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue">Table <span class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></span></a>), as well as for Moshi itself (<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.T11" title="Table 11 ‣ Results - Linguistic evaluation. ‣ 5.8 Compressing Moshi and Impact on Speech Quality ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue">Table <span class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></span></a>).
Generally, Helium is more robust to quantization than the final trained Moshi.
Notably, assuming quantization blocks of size 32, quantizing Helium weights to 4 bits yields a 3.43 times smaller model which remains within 2 points of MMLU of the floating point baseline. This particular quantization format is also almost identical to llama.cpp’s<span class="ltx_note ltx_role_footnote" id="footnote17"><sup class="ltx_note_mark">17</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">17</sup><span class="ltx_tag ltx_tag_note">17</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/ggerganov/llama.cpp" title="">https://github.com/ggerganov/llama.cpp</a></span></span></span> Q4_0, hence can be readily deployed for efficient inference.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S5.SS8.SSS0.Px2.p2">
<p class="ltx_p" id="S5.SS8.SSS0.Px2.p2.1">In contrast, the same quantization recipe used on Moshi leads to a more drastic loss of performance ranging from 5 to 10 points of MMLU.
In the online demo, we keep the weights in 8-bit format as it results in a more reasonable drop of 2 points for a model roughly twice smaller than the floating point baseline.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="S5.T10">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 10: </span><span class="ltx_text ltx_font_bold" id="S5.T10.3.1">Linguistic impact of model compression on Helium</span>, as measured by MMLU. ‘WXA8’ indicates a model with weights quantized to ‘X’ bits and activations to 8 bits, using integer scalar PTQ. The model size in brackets is given in GygaBytes for a quantization block size of 32, and takes into account both the model weights and the quantization parameters stored in float16.
With a fine enough granularity of quantization blocks, a 4 bits model stays within 2 points of MMLU of the floating point baseline.
</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T10.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T10.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S5.T10.1.1.1">
<span class="ltx_text" id="S5.T10.1.1.1.1" style="font-size:80%;">BF16A8 (</span><math alttext="\sim" class="ltx_Math" display="inline" id="S5.T10.1.1.1.m1.1"><semantics id="S5.T10.1.1.1.m1.1a"><mo id="S5.T10.1.1.1.m1.1.1" mathsize="80%" xref="S5.T10.1.1.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S5.T10.1.1.1.m1.1b"><csymbol cd="latexml" id="S5.T10.1.1.1.m1.1.1.cmml" xref="S5.T10.1.1.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T10.1.1.1.m1.1c">\sim</annotation><annotation encoding="application/x-llamapun" id="S5.T10.1.1.1.m1.1d">∼</annotation></semantics></math><span class="ltx_text" id="S5.T10.1.1.1.2" style="font-size:80%;"> 15GB)</span>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3" id="S5.T10.1.1.2"><span class="ltx_text" id="S5.T10.1.1.2.1" style="font-size:80%;">54.3</span></th>
</tr>
<tr class="ltx_tr" id="S5.T10.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t" id="S5.T10.1.2.1.1"><span class="ltx_text" id="S5.T10.1.2.1.1.1" style="font-size:80%;">Bitwidth vs Block size</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T10.1.2.1.2"><span class="ltx_text" id="S5.T10.1.2.1.2.1" style="font-size:80%;">per-channel</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T10.1.2.1.3"><span class="ltx_text" id="S5.T10.1.2.1.3.1" style="font-size:80%;">256</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T10.1.2.1.4"><span class="ltx_text" id="S5.T10.1.2.1.4.1" style="font-size:80%;">32</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T10.1.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T10.1.3.1.1"><span class="ltx_text" id="S5.T10.1.3.1.1.1" style="font-size:80%;">W8A8 (7.66GB)</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T10.1.3.1.2"><span class="ltx_text" id="S5.T10.1.3.1.2.1" style="font-size:80%;">53.96</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T10.1.3.1.3"><span class="ltx_text" id="S5.T10.1.3.1.3.1" style="font-size:80%;">54.09</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T10.1.3.1.4"><span class="ltx_text" id="S5.T10.1.3.1.4.1" style="font-size:80%;">53.81</span></td>
</tr>
<tr class="ltx_tr" id="S5.T10.1.4.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T10.1.4.2.1"><span class="ltx_text" id="S5.T10.1.4.2.1.1" style="font-size:80%;">W6A8 (6.02GB)</span></th>
<td class="ltx_td ltx_align_center" id="S5.T10.1.4.2.2"><span class="ltx_text" id="S5.T10.1.4.2.2.1" style="font-size:80%;">53.50</span></td>
<td class="ltx_td ltx_align_center" id="S5.T10.1.4.2.3"><span class="ltx_text" id="S5.T10.1.4.2.3.1" style="font-size:80%;">53.55</span></td>
<td class="ltx_td ltx_align_center" id="S5.T10.1.4.2.4"><span class="ltx_text" id="S5.T10.1.4.2.4.1" style="font-size:80%;">53.86</span></td>
</tr>
<tr class="ltx_tr" id="S5.T10.1.5.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T10.1.5.3.1"><span class="ltx_text" id="S5.T10.1.5.3.1.1" style="font-size:80%;">W5A8 (5.20GB)</span></th>
<td class="ltx_td ltx_align_center" id="S5.T10.1.5.3.2"><span class="ltx_text" id="S5.T10.1.5.3.2.1" style="font-size:80%;">52.80</span></td>
<td class="ltx_td ltx_align_center" id="S5.T10.1.5.3.3"><span class="ltx_text" id="S5.T10.1.5.3.3.1" style="font-size:80%;">53.22</span></td>
<td class="ltx_td ltx_align_center" id="S5.T10.1.5.3.4"><span class="ltx_text" id="S5.T10.1.5.3.4.1" style="font-size:80%;">52.76</span></td>
</tr>
<tr class="ltx_tr" id="S5.T10.1.6.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T10.1.6.4.1"><span class="ltx_text" id="S5.T10.1.6.4.1.1" style="font-size:80%;">W4A8 (4.37GB)</span></th>
<td class="ltx_td ltx_align_center" id="S5.T10.1.6.4.2"><span class="ltx_text" id="S5.T10.1.6.4.2.1" style="font-size:80%;">49.29</span></td>
<td class="ltx_td ltx_align_center" id="S5.T10.1.6.4.3"><span class="ltx_text" id="S5.T10.1.6.4.3.1" style="font-size:80%;">50.84</span></td>
<td class="ltx_td ltx_align_center" id="S5.T10.1.6.4.4"><span class="ltx_text" id="S5.T10.1.6.4.4.1" style="font-size:80%;">52.97</span></td>
</tr>
<tr class="ltx_tr" id="S5.T10.1.7.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T10.1.7.5.1"><span class="ltx_text" id="S5.T10.1.7.5.1.1" style="font-size:80%;">W3A8 (3.55GB)</span></th>
<td class="ltx_td ltx_align_center" id="S5.T10.1.7.5.2"><span class="ltx_text" id="S5.T10.1.7.5.2.1" style="font-size:80%;">25.49</span></td>
<td class="ltx_td ltx_align_center" id="S5.T10.1.7.5.3"><span class="ltx_text" id="S5.T10.1.7.5.3.1" style="font-size:80%;">44.15</span></td>
<td class="ltx_td ltx_align_center" id="S5.T10.1.7.5.4"><span class="ltx_text" id="S5.T10.1.7.5.4.1" style="font-size:80%;">50.85</span></td>
</tr>
<tr class="ltx_tr" id="S5.T10.1.8.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S5.T10.1.8.6.1"><span class="ltx_text" id="S5.T10.1.8.6.1.1" style="font-size:80%;">W2A8 (2.73GB)</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T10.1.8.6.2"><span class="ltx_text" id="S5.T10.1.8.6.2.1" style="font-size:80%;">23.87</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T10.1.8.6.3"><span class="ltx_text" id="S5.T10.1.8.6.3.1" style="font-size:80%;">23.00</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T10.1.8.6.4"><span class="ltx_text" id="S5.T10.1.8.6.4.1" style="font-size:80%;">24.27</span></td>
</tr>
</tbody>
</table>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_table" id="S5.T11">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 11: </span><span class="ltx_text ltx_font_bold" id="S5.T11.2.1">Linguistic impact of model compression on Moshi</span>, measured by MMLU for different quantized Moshi on the text tokens generated by Inner Monologue directly. As for the previous table, the model size is indicated for the block size of 32.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_top" id="S5.T11.3" style="width:203.8pt;">
<p class="ltx_p" id="S5.T11.3.1"><span class="ltx_text ltx_font_bold" id="S5.T11.3.1.1" style="font-size:80%;">a)</span><span class="ltx_text" id="S5.T11.3.1.2" style="font-size:80%;"> Moshi after single-stream pretraining</span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T11.3.2">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T11.3.2.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S5.T11.3.2.1.1.1"><span class="ltx_text" id="S5.T11.3.2.1.1.1.1" style="font-size:80%;">BF16A8 (15.24GB)</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S5.T11.3.2.1.1.2"><span class="ltx_text" id="S5.T11.3.2.1.1.2.1" style="font-size:80%;">49.8</span></th>
</tr>
<tr class="ltx_tr" id="S5.T11.3.2.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t" id="S5.T11.3.2.2.2.1"><span class="ltx_text" id="S5.T11.3.2.2.2.1.1" style="font-size:80%;">Bitwidth vs Block size</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T11.3.2.2.2.2"><span class="ltx_text" id="S5.T11.3.2.2.2.2.1" style="font-size:80%;">256</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T11.3.2.2.2.3"><span class="ltx_text" id="S5.T11.3.2.2.2.3.1" style="font-size:80%;">32</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T11.3.2.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T11.3.2.3.1.1"><span class="ltx_text" id="S5.T11.3.2.3.1.1.1" style="font-size:80%;">W8A8 (8.33GB)</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T11.3.2.3.1.2"><span class="ltx_text" id="S5.T11.3.2.3.1.2.1" style="font-size:80%;">48.8</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T11.3.2.3.1.3"><span class="ltx_text" id="S5.T11.3.2.3.1.3.1" style="font-size:80%;">48.5</span></td>
</tr>
<tr class="ltx_tr" id="S5.T11.3.2.4.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T11.3.2.4.2.1"><span class="ltx_text" id="S5.T11.3.2.4.2.1.1" style="font-size:80%;">W6A8 (6.95GB)</span></th>
<td class="ltx_td ltx_align_center" id="S5.T11.3.2.4.2.2"><span class="ltx_text" id="S5.T11.3.2.4.2.2.1" style="font-size:80%;">48.5</span></td>
<td class="ltx_td ltx_align_center" id="S5.T11.3.2.4.2.3"><span class="ltx_text" id="S5.T11.3.2.4.2.3.1" style="font-size:80%;">49.1</span></td>
</tr>
<tr class="ltx_tr" id="S5.T11.3.2.5.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T11.3.2.5.3.1"><span class="ltx_text" id="S5.T11.3.2.5.3.1.1" style="font-size:80%;">W5A8 (6.02GB)</span></th>
<td class="ltx_td ltx_align_center" id="S5.T11.3.2.5.3.2"><span class="ltx_text" id="S5.T11.3.2.5.3.2.1" style="font-size:80%;">47.4</span></td>
<td class="ltx_td ltx_align_center" id="S5.T11.3.2.5.3.3"><span class="ltx_text" id="S5.T11.3.2.5.3.3.1" style="font-size:80%;">48.5</span></td>
</tr>
<tr class="ltx_tr" id="S5.T11.3.2.6.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T11.3.2.6.4.1"><span class="ltx_text" id="S5.T11.3.2.6.4.1.1" style="font-size:80%;">W4A8 (4.64GB)</span></th>
<td class="ltx_td ltx_align_center" id="S5.T11.3.2.6.4.2"><span class="ltx_text" id="S5.T11.3.2.6.4.2.1" style="font-size:80%;">44.7</span></td>
<td class="ltx_td ltx_align_center" id="S5.T11.3.2.6.4.3"><span class="ltx_text" id="S5.T11.3.2.6.4.3.1" style="font-size:80%;">45.7</span></td>
</tr>
<tr class="ltx_tr" id="S5.T11.3.2.7.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T11.3.2.7.5.1"><span class="ltx_text" id="S5.T11.3.2.7.5.1.1" style="font-size:80%;">W3A8 (3.72GB)</span></th>
<td class="ltx_td ltx_align_center" id="S5.T11.3.2.7.5.2"><span class="ltx_text" id="S5.T11.3.2.7.5.2.1" style="font-size:80%;">26.1</span></td>
<td class="ltx_td ltx_align_center" id="S5.T11.3.2.7.5.3"><span class="ltx_text" id="S5.T11.3.2.7.5.3.1" style="font-size:80%;">35.7</span></td>
</tr>
<tr class="ltx_tr" id="S5.T11.3.2.8.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S5.T11.3.2.8.6.1"><span class="ltx_text" id="S5.T11.3.2.8.6.1.1" style="font-size:80%;">W2A8 (2.80GB)</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T11.3.2.8.6.2"><span class="ltx_text" id="S5.T11.3.2.8.6.2.1" style="font-size:80%;">23.4</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T11.3.2.8.6.3"><span class="ltx_text" id="S5.T11.3.2.8.6.3.1" style="font-size:80%;">24.4</span></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_top" id="S5.T11.4" style="width:203.8pt;">
<p class="ltx_p" id="S5.T11.4.1"><span class="ltx_text ltx_font_bold" id="S5.T11.4.1.1" style="font-size:80%;">b)</span><span class="ltx_text" id="S5.T11.4.1.2" style="font-size:80%;"> Moshi after multi-stream instruct</span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T11.4.2">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T11.4.2.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S5.T11.4.2.1.1.1"><span class="ltx_text" id="S5.T11.4.2.1.1.1.1" style="font-size:80%;">BF16A8 (16.74GB)</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S5.T11.4.2.1.1.2"><span class="ltx_text" id="S5.T11.4.2.1.1.2.1" style="font-size:80%;">49.7</span></th>
</tr>
<tr class="ltx_tr" id="S5.T11.4.2.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t" id="S5.T11.4.2.2.2.1"><span class="ltx_text" id="S5.T11.4.2.2.2.1.1" style="font-size:80%;">Bitwidth vs Block size</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T11.4.2.2.2.2"><span class="ltx_text" id="S5.T11.4.2.2.2.2.1" style="font-size:80%;">256</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T11.4.2.2.2.3"><span class="ltx_text" id="S5.T11.4.2.2.2.3.1" style="font-size:80%;">32</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T11.4.2.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T11.4.2.3.1.1"><span class="ltx_text" id="S5.T11.4.2.3.1.1.1" style="font-size:80%;">W8A8 (9.20GB)</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T11.4.2.3.1.2"><span class="ltx_text" id="S5.T11.4.2.3.1.2.1" style="font-size:80%;">47.6</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T11.4.2.3.1.3"><span class="ltx_text" id="S5.T11.4.2.3.1.3.1" style="font-size:80%;">47.6</span></td>
</tr>
<tr class="ltx_tr" id="S5.T11.4.2.4.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T11.4.2.4.2.1"><span class="ltx_text" id="S5.T11.4.2.4.2.1.1" style="font-size:80%;">W6A8 (7.70GB)</span></th>
<td class="ltx_td ltx_align_center" id="S5.T11.4.2.4.2.2"><span class="ltx_text" id="S5.T11.4.2.4.2.2.1" style="font-size:80%;">48.1</span></td>
<td class="ltx_td ltx_align_center" id="S5.T11.4.2.4.2.3"><span class="ltx_text" id="S5.T11.4.2.4.2.3.1" style="font-size:80%;">48.3</span></td>
</tr>
<tr class="ltx_tr" id="S5.T11.4.2.5.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T11.4.2.5.3.1"><span class="ltx_text" id="S5.T11.4.2.5.3.1.1" style="font-size:80%;">W5A8 (6.69GB)</span></th>
<td class="ltx_td ltx_align_center" id="S5.T11.4.2.5.3.2"><span class="ltx_text" id="S5.T11.4.2.5.3.2.1" style="font-size:80%;">46.7</span></td>
<td class="ltx_td ltx_align_center" id="S5.T11.4.2.5.3.3"><span class="ltx_text" id="S5.T11.4.2.5.3.3.1" style="font-size:80%;">47.2</span></td>
</tr>
<tr class="ltx_tr" id="S5.T11.4.2.6.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T11.4.2.6.4.1"><span class="ltx_text" id="S5.T11.4.2.6.4.1.1" style="font-size:80%;">W4A8 (5.18GB)</span></th>
<td class="ltx_td ltx_align_center" id="S5.T11.4.2.6.4.2"><span class="ltx_text" id="S5.T11.4.2.6.4.2.1" style="font-size:80%;">39.8</span></td>
<td class="ltx_td ltx_align_center" id="S5.T11.4.2.6.4.3"><span class="ltx_text" id="S5.T11.4.2.6.4.3.1" style="font-size:80%;">42.2</span></td>
</tr>
<tr class="ltx_tr" id="S5.T11.4.2.7.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T11.4.2.7.5.1"><span class="ltx_text" id="S5.T11.4.2.7.5.1.1" style="font-size:80%;">W3A8 (4.18GB)</span></th>
<td class="ltx_td ltx_align_center" id="S5.T11.4.2.7.5.2"><span class="ltx_text" id="S5.T11.4.2.7.5.2.1" style="font-size:80%;">27.7</span></td>
<td class="ltx_td ltx_align_center" id="S5.T11.4.2.7.5.3"><span class="ltx_text" id="S5.T11.4.2.7.5.3.1" style="font-size:80%;">29.9</span></td>
</tr>
<tr class="ltx_tr" id="S5.T11.4.2.8.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S5.T11.4.2.8.6.1"><span class="ltx_text" id="S5.T11.4.2.8.6.1.1" style="font-size:80%;">W2A8 (3.17GB)</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T11.4.2.8.6.2"><span class="ltx_text" id="S5.T11.4.2.8.6.2.1" style="font-size:80%;">24.5</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T11.4.2.8.6.3"><span class="ltx_text" id="S5.T11.4.2.8.6.3.1" style="font-size:80%;">24.9</span></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_paragraph" id="S5.SS8.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">Results - Audio Quality.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS8.SSS0.Px3.p1">
<p class="ltx_p" id="S5.SS8.SSS0.Px3.p1.1">To assess the audio quality of samples generated by the quantized models, we make use of the MOSNet metric from <cite class="ltx_cite ltx_citemacro_cite">Lo et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib61" title="">2019</a>)</cite> as implemented in speechmetrics.<span class="ltx_note ltx_role_footnote" id="footnote18"><sup class="ltx_note_mark">18</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">18</sup><span class="ltx_tag ltx_tag_note">18</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/aliutkus/speechmetrics" title="">https://github.com/aliutkus/speechmetrics</a></span></span></span>
More specifically, we generate a short prompt (64 tokens) from the unquantized model, then generate completions from each of the quantized models with a temperature of <math alttext="t=0.8" class="ltx_Math" display="inline" id="S5.SS8.SSS0.Px3.p1.1.m1.1"><semantics id="S5.SS8.SSS0.Px3.p1.1.m1.1a"><mrow id="S5.SS8.SSS0.Px3.p1.1.m1.1.1" xref="S5.SS8.SSS0.Px3.p1.1.m1.1.1.cmml"><mi id="S5.SS8.SSS0.Px3.p1.1.m1.1.1.2" xref="S5.SS8.SSS0.Px3.p1.1.m1.1.1.2.cmml">t</mi><mo id="S5.SS8.SSS0.Px3.p1.1.m1.1.1.1" xref="S5.SS8.SSS0.Px3.p1.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS8.SSS0.Px3.p1.1.m1.1.1.3" xref="S5.SS8.SSS0.Px3.p1.1.m1.1.1.3.cmml">0.8</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS8.SSS0.Px3.p1.1.m1.1b"><apply id="S5.SS8.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S5.SS8.SSS0.Px3.p1.1.m1.1.1"><eq id="S5.SS8.SSS0.Px3.p1.1.m1.1.1.1.cmml" xref="S5.SS8.SSS0.Px3.p1.1.m1.1.1.1"></eq><ci id="S5.SS8.SSS0.Px3.p1.1.m1.1.1.2.cmml" xref="S5.SS8.SSS0.Px3.p1.1.m1.1.1.2">𝑡</ci><cn id="S5.SS8.SSS0.Px3.p1.1.m1.1.1.3.cmml" type="float" xref="S5.SS8.SSS0.Px3.p1.1.m1.1.1.3">0.8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS8.SSS0.Px3.p1.1.m1.1c">t=0.8</annotation><annotation encoding="application/x-llamapun" id="S5.SS8.SSS0.Px3.p1.1.m1.1d">italic_t = 0.8</annotation></semantics></math> and a sequence length of 1024 tokens. We repeat this process 500 times, and report the distribution of MOSNet scores over non-overlapping windows in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.F5" title="Figure 5 ‣ Results - Audio Quality. ‣ 5.8 Compressing Moshi and Impact on Speech Quality ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue">Figure <span class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></span></a>. While the MOSNet scores exhibit a large variance across samples, there is generally little degradation of the audio quality after quantizing the model’s weights down to 4 bits.
For lower bitwidths however, we observe qualitatively that the MOSNet scores lack sensitivity towards some of the more severe audio degradations caused by aggressive quantization: For instance, it does not disintiguish between pure audio artifacts (e.g., noisy voice) from artifacts in the speech pattern (e.g., increased repetitiveness of the model). This is in line with the lack of consistency between objective and subjective audio quality metrics that we observed in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.SS2" title="5.2 Audio Tokenization ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue">Section <span class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.2</span></span></a>, and in addition, MOSNet was designed for a very different type of benchmark, namely, to mimic human ratings on evaluating converted speech, so it is not surprising for it not to be less sensitive to such artifacts.
Instead, to measure the presence or absence of such degradation in the audio samples, we first observe that certain audio artifacts are identifiable from the entropy spectrums of the generated text and audio tokens: A few examples are illustrated in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.F6" title="Figure 6 ‣ Results - Audio Quality. ‣ 5.8 Compressing Moshi and Impact on Speech Quality ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue">Figure <span class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></span></a> and we further detail the types of artifacts and how we measure them in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#A4" title="Appendix D Characterizing Audio Artifacts Caused by Quantization ‣ Moshi: a speech-text foundation model for real-time dialogue">Appendix <span class="ltx_ref"><span class="ltx_text ltx_ref_tag">D</span></span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="S5.F5">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_square" height="164" id="S5.F5.g1" src="https://arxiv.org/html/2410.00037v2/x2.png" width="203"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_square" height="164" id="S5.F5.g2" src="https://arxiv.org/html/2410.00037v2/x3.png" width="186"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_square" height="164" id="S5.F5.g3" src="https://arxiv.org/html/2410.00037v2/x4.png" width="186"></div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 5: </span><span class="ltx_text ltx_font_bold" id="S5.F5.2.1">Acoustic impact of model compression on Moshi</span>. MOSNet evaluation of samples generated by models compressed for different bitwidths. We evaluate the MOSNet scores across non overlapping windows of 5s, and report the distribution of these scores over 500 samples for each model.
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="S5.F6">
<div class="ltx_flex_figure">
<div class="ltx_flex_break"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_top" id="S5.F6.1" style="width:203.8pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="584" id="S5.F6.1.g1" src="https://arxiv.org/html/2410.00037v2/x5.png" width="830">
<p class="ltx_p ltx_align_center" id="S5.F6.1.1"><span class="ltx_text ltx_font_bold" id="S5.F6.1.1.1" style="font-size:70%;">(a)<span class="ltx_text ltx_font_medium" id="S5.F6.1.1.1.1"> Entropy spectrum of a well-behaved sample (no noticeable degradation). Short silences occur naturally in Moshi’s output due to the model’s multi-stream abilities (reflecting the other speaker’s turn)</span></span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_top" id="S5.F6.2" style="width:203.8pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="584" id="S5.F6.2.g1" src="https://arxiv.org/html/2410.00037v2/x6.png" width="830">
<p class="ltx_p ltx_align_center" id="S5.F6.2.1"><span class="ltx_text ltx_font_bold" id="S5.F6.2.1.1" style="font-size:70%;">(b)<span class="ltx_text ltx_font_medium" id="S5.F6.2.1.1.1"> Significant degradations occur at low bitwidth (W2A8). These are not always well reflected by the MOSNet scores’ magnitude, but the entropy of the text token is visibly higher.</span></span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span><span class="ltx_text ltx_font_bold" id="S5.F6.4.1">Audio artifacts caused by model compression</span>. Example of typical entropy spectrums capturing specific audio artifacts caused by model quantization. For each timestep, we compute the entropy over the past 128 tokens, independently for the text and audio codebooks tokens. Then, we measure the presence or absence of the different artifacts over non-overlapping windows of 64 tokens, as described in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#A4" title="Appendix D Characterizing Audio Artifacts Caused by Quantization ‣ Moshi: a speech-text foundation model for real-time dialogue">Appendix <span class="ltx_ref"><span class="ltx_text ltx_ref_tag">D</span></span></a>.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS8.SSS0.Px3.p2">
<p class="ltx_p" id="S5.SS8.SSS0.Px3.p2.1">Following this insight, we measure the presence or absence of different audio artifacts on the same generated audio samples as the ones used in the previous MOSNet analysis. We report the results in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.T12" title="Table 12 ‣ Results - Audio Quality. ‣ 5.8 Compressing Moshi and Impact on Speech Quality ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue">Table <span class="ltx_ref"><span class="ltx_text ltx_ref_tag">12</span></span></a>, as well as a more detailed per timestep analysis in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#A4.F11" title="Figure 11 ‣ Bad audio quality. ‣ Appendix D Characterizing Audio Artifacts Caused by Quantization ‣ Moshi: a speech-text foundation model for real-time dialogue">Figure <span class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></span></a> of <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#A4" title="Appendix D Characterizing Audio Artifacts Caused by Quantization ‣ Moshi: a speech-text foundation model for real-time dialogue">Appendix <span class="ltx_ref"><span class="ltx_text ltx_ref_tag">D</span></span></a>.
At a bitwidth of 4, we again observe little audio degradation.
Decreasing to 3-bit format, audio degradations are more apparent and tend to become more frequent along the generation timestep, although the finer granularity quantization format is generally more robust to these artifacts.
Nevertheless, both quantization formats display significantly degraded audio quality when weights are aggressively quantized to 2 bits, which we also observe qualitatively.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="S5.T12">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 12: </span><span class="ltx_text ltx_font_bold" id="S5.T12.2.1">Distribution of audio artifacts caused by model compression</span>. Percentage of audio artifacts measured in the entropy spectrum of text and speech generated tokens, as described in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#A4" title="Appendix D Characterizing Audio Artifacts Caused by Quantization ‣ Moshi: a speech-text foundation model for real-time dialogue">Appendix <span class="ltx_ref"><span class="ltx_text ltx_ref_tag">D</span></span></a>. These results averaged across 500 samples generated by different versions of the same quantized Moshi, and across 16 timesteps of 64 tokens. Values of 0 % are omitted in the table for better readability.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T12.3">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T12.3.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="S5.T12.3.1.1.1"><span class="ltx_text" id="S5.T12.3.1.1.1.1" style="font-size:80%;">Model / Artifacts</span></th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T12.3.1.1.2"><span class="ltx_text" id="S5.T12.3.1.1.2.1" style="font-size:80%;">Gibberish</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T12.3.1.1.3"><span class="ltx_text" id="S5.T12.3.1.1.3.1" style="font-size:80%;">Noisy</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T12.3.1.1.4"><span class="ltx_text" id="S5.T12.3.1.1.4.1" style="font-size:80%;">Background</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T12.3.1.1.5"><span class="ltx_text" id="S5.T12.3.1.1.5.1" style="font-size:80%;">Repetitive</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T12.3.1.1.6"><span class="ltx_text" id="S5.T12.3.1.1.6.1" style="font-size:80%;">No artifacts</span></td>
</tr>
<tr class="ltx_tr" id="S5.T12.3.2.2">
<th class="ltx_td ltx_th ltx_th_row" id="S5.T12.3.2.2.1"></th>
<td class="ltx_td ltx_align_center" id="S5.T12.3.2.2.2"><span class="ltx_text" id="S5.T12.3.2.2.2.1" style="font-size:80%;">audio</span></td>
<td class="ltx_td ltx_align_center" id="S5.T12.3.2.2.3"><span class="ltx_text" id="S5.T12.3.2.2.3.1" style="font-size:80%;">audio</span></td>
<td class="ltx_td ltx_align_center" id="S5.T12.3.2.2.4"><span class="ltx_text" id="S5.T12.3.2.2.4.1" style="font-size:80%;">noise</span></td>
<td class="ltx_td ltx_align_center" id="S5.T12.3.2.2.5"><span class="ltx_text" id="S5.T12.3.2.2.5.1" style="font-size:80%;">text</span></td>
<td class="ltx_td" id="S5.T12.3.2.2.6"></td>
</tr>
<tr class="ltx_tr" id="S5.T12.3.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T12.3.3.3.1"><span class="ltx_text" id="S5.T12.3.3.3.1.1" style="font-size:80%;">unquant</span></th>
<td class="ltx_td ltx_border_t" id="S5.T12.3.3.3.2"></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T12.3.3.3.3"><span class="ltx_text" id="S5.T12.3.3.3.3.1" style="font-size:80%;">&nbsp;4.1</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T12.3.3.3.4"><span class="ltx_text" id="S5.T12.3.3.3.4.1" style="font-size:80%;">&nbsp;0.1</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T12.3.3.3.5"><span class="ltx_text" id="S5.T12.3.3.3.5.1" style="font-size:80%;">&nbsp;0.1</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T12.3.3.3.6"><span class="ltx_text" id="S5.T12.3.3.3.6.1" style="font-size:80%;">95.8</span></td>
</tr>
<tr class="ltx_tr" id="S5.T12.3.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T12.3.4.4.1"><span class="ltx_text" id="S5.T12.3.4.4.1.1" style="font-size:80%;">W4A8, block=32</span></th>
<td class="ltx_td ltx_border_t" id="S5.T12.3.4.4.2"></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T12.3.4.4.3"><span class="ltx_text" id="S5.T12.3.4.4.3.1" style="font-size:80%;">&nbsp;3.8</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T12.3.4.4.4"><span class="ltx_text" id="S5.T12.3.4.4.4.1" style="font-size:80%;">&nbsp;0.1</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T12.3.4.4.5"><span class="ltx_text" id="S5.T12.3.4.4.5.1" style="font-size:80%;">&nbsp;0.4</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T12.3.4.4.6"><span class="ltx_text" id="S5.T12.3.4.4.6.1" style="font-size:80%;">95.7</span></td>
</tr>
<tr class="ltx_tr" id="S5.T12.3.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T12.3.5.5.1"><span class="ltx_text" id="S5.T12.3.5.5.1.1" style="font-size:80%;">W4A8, block=256</span></th>
<td class="ltx_td ltx_align_center" id="S5.T12.3.5.5.2"><span class="ltx_text" id="S5.T12.3.5.5.2.1" style="font-size:80%;">&nbsp;0.1</span></td>
<td class="ltx_td ltx_align_center" id="S5.T12.3.5.5.3"><span class="ltx_text" id="S5.T12.3.5.5.3.1" style="font-size:80%;">&nbsp;3.7</span></td>
<td class="ltx_td" id="S5.T12.3.5.5.4"></td>
<td class="ltx_td ltx_align_center" id="S5.T12.3.5.5.5"><span class="ltx_text" id="S5.T12.3.5.5.5.1" style="font-size:80%;">&nbsp;2.2</span></td>
<td class="ltx_td ltx_align_center" id="S5.T12.3.5.5.6"><span class="ltx_text" id="S5.T12.3.5.5.6.1" style="font-size:80%;">94.0</span></td>
</tr>
<tr class="ltx_tr" id="S5.T12.3.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T12.3.6.6.1"><span class="ltx_text" id="S5.T12.3.6.6.1.1" style="font-size:80%;">W3A8, block=32</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T12.3.6.6.2"><span class="ltx_text" id="S5.T12.3.6.6.2.1" style="font-size:80%;">&nbsp;0.5</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T12.3.6.6.3"><span class="ltx_text" id="S5.T12.3.6.6.3.1" style="font-size:80%;">&nbsp;4.7</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T12.3.6.6.4"><span class="ltx_text" id="S5.T12.3.6.6.4.1" style="font-size:80%;">&nbsp;5.9</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T12.3.6.6.5"><span class="ltx_text" id="S5.T12.3.6.6.5.1" style="font-size:80%;">&nbsp;8.1</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T12.3.6.6.6"><span class="ltx_text" id="S5.T12.3.6.6.6.1" style="font-size:80%;">80.7</span></td>
</tr>
<tr class="ltx_tr" id="S5.T12.3.7.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T12.3.7.7.1"><span class="ltx_text" id="S5.T12.3.7.7.1.1" style="font-size:80%;">W3A8, block=256</span></th>
<td class="ltx_td ltx_align_center" id="S5.T12.3.7.7.2"><span class="ltx_text" id="S5.T12.3.7.7.2.1" style="font-size:80%;">&nbsp;0.2</span></td>
<td class="ltx_td ltx_align_center" id="S5.T12.3.7.7.3"><span class="ltx_text" id="S5.T12.3.7.7.3.1" style="font-size:80%;">12.2</span></td>
<td class="ltx_td ltx_align_center" id="S5.T12.3.7.7.4"><span class="ltx_text" id="S5.T12.3.7.7.4.1" style="font-size:80%;">&nbsp;3.1</span></td>
<td class="ltx_td ltx_align_center" id="S5.T12.3.7.7.5"><span class="ltx_text" id="S5.T12.3.7.7.5.1" style="font-size:80%;">21.9</span></td>
<td class="ltx_td ltx_align_center" id="S5.T12.3.7.7.6"><span class="ltx_text" id="S5.T12.3.7.7.6.1" style="font-size:80%;">62.7</span></td>
</tr>
<tr class="ltx_tr" id="S5.T12.3.8.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T12.3.8.8.1"><span class="ltx_text" id="S5.T12.3.8.8.1.1" style="font-size:80%;">W2A8, block=32</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T12.3.8.8.2"><span class="ltx_text" id="S5.T12.3.8.8.2.1" style="font-size:80%;">12.7</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T12.3.8.8.3"><span class="ltx_text" id="S5.T12.3.8.8.3.1" style="font-size:80%;">40.9</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T12.3.8.8.4"><span class="ltx_text" id="S5.T12.3.8.8.4.1" style="font-size:80%;">&nbsp;0.5</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T12.3.8.8.5"><span class="ltx_text" id="S5.T12.3.8.8.5.1" style="font-size:80%;">&nbsp;0.4</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T12.3.8.8.6"><span class="ltx_text" id="S5.T12.3.8.8.6.1" style="font-size:80%;">45.4</span></td>
</tr>
<tr class="ltx_tr" id="S5.T12.3.9.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S5.T12.3.9.9.1"><span class="ltx_text" id="S5.T12.3.9.9.1.1" style="font-size:80%;">W2A8, block=256</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T12.3.9.9.2"><span class="ltx_text" id="S5.T12.3.9.9.2.1" style="font-size:80%;">83.1</span></td>
<td class="ltx_td ltx_border_bb" id="S5.T12.3.9.9.3"></td>
<td class="ltx_td ltx_border_bb" id="S5.T12.3.9.9.4"></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T12.3.9.9.5"><span class="ltx_text" id="S5.T12.3.9.9.5.1" style="font-size:80%;">11.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T12.3.9.9.6"><span class="ltx_text" id="S5.T12.3.9.9.6.1" style="font-size:80%;">&nbsp;5.9</span></td>
</tr>
</tbody>
</table>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_paragraph" id="S5.SS8.SSS0.Px4">
<h5 class="ltx_title ltx_title_paragraph">Discussion.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS8.SSS0.Px4.p1">
<p class="ltx_p" id="S5.SS8.SSS0.Px4.p1.1">The linguistic abilities of Moshi are more sensitive to quantizing the model weights and activations than its output audio quality.
More specifically, the audio quality remains close to that of the floating point baseline down to 4 bits precision, even when quantizing the full model, including the Depth Transformer.
In contrast, the MMLU performance suffers significant drops when quantizing the model weights below 6 bits using post-training only quantization.
Following recent quantization techniques&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Tseng et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib98" title="">2024</a>)</cite>, we may expect improved performance at lower bitwidth by using quantized aware finetuning instead of PTQ. However, as Moshi’s training pipeline from <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S4" title="4 Datasets and Training ‣ Moshi: a speech-text foundation model for real-time dialogue">Section <span class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></span></a> involves multiple stage and training datasets, this would require a more thorough investigation into designing quantized training phases and calibration datasets, to preserve all of Moshi’s abilities lost after quantization.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Safety</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">In parallel with the development of Moshi, we explore different directions related to the safety of AI generated content. In this section, we specifically consider several questions regarding the content generated by Moshi, each addressed in a dedicated subsection:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ol class="ltx_enumerate" id="S6.I1">
<li class="ltx_item" id="S6.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S6.I1.i1.p1">
<p class="ltx_p" id="S6.I1.i1.p1.1">How does our model behave in terms of producing toxic content?</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S6.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S6.I1.i2.p1">
<p class="ltx_p" id="S6.I1.i2.p1.1">How to avoid that the model regurgitates audio content from the training set?</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S6.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para" id="S6.I1.i3.p1">
<p class="ltx_p" id="S6.I1.i3.p1.1">How do we ensure that the model uses the voice we intend to give to Moshi?</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S6.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">4.</span>
<div class="ltx_para" id="S6.I1.i4.p1">
<p class="ltx_p" id="S6.I1.i4.p1.1">How to identify if a given content has been generated by Moshi?</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ol>
</div>
<section class="ltx_subsection" id="S6.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.1 </span>Toxicity Analysis</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S6.SS1.p1">
<p class="ltx_p" id="S6.SS1.p1.1">The scientific community has devoted in the last years some effort to address bias and toxicity problems for text generation models. In contrast, audio safety is far less developed. It is not straightforward to compare audio and text models in an apple-to-apple comparison, as they differ in their usage, and multiple meanings are conveyed by non-verbal signal (irony, tone, etc.). In spite of these limitations and in order to facilitate the comparison of Moshi with text generation models, in this first analysis we restrict our toxicity analysis to the text produced by the model. We adopt the ALERT benchmark<span class="ltx_note ltx_role_footnote" id="footnote19"><sup class="ltx_note_mark">19</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">19</sup><span class="ltx_tag ltx_tag_note">19</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/Babelscape/ALERT" title="">https://github.com/Babelscape/ALERT</a></span></span></span> <cite class="ltx_cite ltx_citemacro_citep">(Tedeschi et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib93" title="">2024</a>)</cite>, which evaluates safety under multiple categories (hate, self-harm, weapon, crime, sex, substance).
<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#A5.T18" title="Table 18 ‣ Bad audio quality. ‣ Appendix D Characterizing Audio Artifacts Caused by Quantization ‣ Moshi: a speech-text foundation model for real-time dialogue">Table&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">18</span></span></a> in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#A5.T18" title="Table 18 ‣ Bad audio quality. ‣ Appendix D Characterizing Audio Artifacts Caused by Quantization ‣ Moshi: a speech-text foundation model for real-time dialogue">Appendix&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">18</span></span></a> reports our detailed toxicity analysis on this benchmark. The aggregated score for Moshi and popular text-only models is as follows:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S6.SS1.p2">
<div class="ltx_inline-block ltx_transformed_outer" id="S6.SS1.p2.1" style="width:433.6pt;height:27.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-71.0pt,4.4pt) scale(0.753283533992234,0.753283533992234) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S6.SS1.p2.1.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.SS1.p2.1.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S6.SS1.p2.1.1.1.1.1"><span class="ltx_text" id="S6.SS1.p2.1.1.1.1.1.1">Category</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S6.SS1.p2.1.1.1.1.2"><span class="ltx_text" id="S6.SS1.p2.1.1.1.1.2.1">Moshi</span></th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.SS1.p2.1.1.1.1.3"><span class="ltx_text" id="S6.SS1.p2.1.1.1.1.3.1">GPT-3.5</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.SS1.p2.1.1.1.1.4"><span class="ltx_text" id="S6.SS1.p2.1.1.1.1.4.1">GPT-4</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.SS1.p2.1.1.1.1.5"><span class="ltx_text" id="S6.SS1.p2.1.1.1.1.5.1">Llama 2</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.SS1.p2.1.1.1.1.6"><span class="ltx_text" id="S6.SS1.p2.1.1.1.1.6.1">Alpaca</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.SS1.p2.1.1.1.1.7"><span class="ltx_text" id="S6.SS1.p2.1.1.1.1.7.1">Vicuna</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.SS1.p2.1.1.1.1.8"><span class="ltx_text" id="S6.SS1.p2.1.1.1.1.8.1">Falcon</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.SS1.p2.1.1.1.1.9"><span class="ltx_text" id="S6.SS1.p2.1.1.1.1.9.1">Mistral</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.SS1.p2.1.1.1.1.10"><span class="ltx_text" id="S6.SS1.p2.1.1.1.1.10.1">Mixtral</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.SS1.p2.1.1.1.1.11"><span class="ltx_text" id="S6.SS1.p2.1.1.1.1.11.1">Zephyr</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.SS1.p2.1.1.1.1.12"><span class="ltx_text" id="S6.SS1.p2.1.1.1.1.12.1">OLMo</span></td>
</tr>
<tr class="ltx_tr" id="S6.SS1.p2.1.1.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" id="S6.SS1.p2.1.1.2.2.1"><span class="ltx_text" id="S6.SS1.p2.1.1.2.2.1.1">Overall Safety Score</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" id="S6.SS1.p2.1.1.2.2.2"><span class="ltx_text" id="S6.SS1.p2.1.1.2.2.2.1" style="background-color:#FFFFFF;">83.05</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.SS1.p2.1.1.2.2.3"><span class="ltx_text" id="S6.SS1.p2.1.1.2.2.3.1" style="background-color:#FFFFFF;">96.95</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.SS1.p2.1.1.2.2.4"><span class="ltx_text" id="S6.SS1.p2.1.1.2.2.4.1" style="background-color:#FFFFFF;">99.18</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.SS1.p2.1.1.2.2.5"><span class="ltx_text" id="S6.SS1.p2.1.1.2.2.5.1" style="background-color:#FFFFFF;">99.98</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.SS1.p2.1.1.2.2.6"><span class="ltx_text" id="S6.SS1.p2.1.1.2.2.6.1" style="background-color:#FFFFFF;">62.13</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.SS1.p2.1.1.2.2.7"><span class="ltx_text" id="S6.SS1.p2.1.1.2.2.7.1" style="background-color:#FFFFFF;">95.75</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.SS1.p2.1.1.2.2.8"><span class="ltx_text" id="S6.SS1.p2.1.1.2.2.8.1" style="background-color:#FFFFFF;">88.11</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.SS1.p2.1.1.2.2.9"><span class="ltx_text" id="S6.SS1.p2.1.1.2.2.9.1" style="background-color:#FFFFFF;">75.45</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.SS1.p2.1.1.2.2.10"><span class="ltx_text" id="S6.SS1.p2.1.1.2.2.10.1" style="background-color:#FFFFFF;">98.22</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.SS1.p2.1.1.2.2.11"><span class="ltx_text" id="S6.SS1.p2.1.1.2.2.11.1" style="background-color:#FFFFFF;">77.86</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.SS1.p2.1.1.2.2.12"><span class="ltx_text" id="S6.SS1.p2.1.1.2.2.12.1" style="background-color:#FFFFFF;">85.90</span></td>
</tr>
</tbody>
</table>
</span></div>
</div>
<div class="ltx_para" id="S6.SS1.p3">
<p class="ltx_p" id="S6.SS1.p3.1">With this analysis, we see that Moshi falls into the middle of this table in terms of rank. The industry models perform the best, which is expected considering the massive amount of private annotation, red-teaming and feedback loop from which these models have benefited.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="S6.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.2 </span>Regurgitation Analysis</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S6.SS2.p1">
<p class="ltx_p" id="S6.SS2.p1.1">The problem of a model generating content which it has seen at training time, which we refer to as <span class="ltx_text ltx_font_italic" id="S6.SS2.p1.1.1">regurgitation</span>, is closely related to overfitting: The more a model has seen a sequence or a subsequence during training, the more likely it is to generate this exact sequence during the generation process. Note, for a speech model, it is not only the text that can be regurgitated, but also the voice pitch, tone, and potentially the background melody if present at training time. It is therefore important to mitigate<span class="ltx_note ltx_role_footnote" id="footnote20"><sup class="ltx_note_mark">20</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">20</sup><span class="ltx_tag ltx_tag_note">20</span>There is currently no way to fully prevent these issues. While it is essential to develop algorithms and methodologies that limit the occurrences of problematic generations, part of the question is related to how generative AI is regulated.</span></span></span> potential intellectual property issues related to regurgitation, such as reproduction of copyrighted content or audio generation with the voice of a person without permission.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_paragraph" id="S6.SS2.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Evaluation protocol.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S6.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="S6.SS2.SSS0.Px1.p1.1">For each model, we measure the proportion of generations (out of 100,000) that reproduce the most frequent audio segment detected in our whole training dataset. For this purpose, we have first developed a matching system that detects the most frequent audio segments, see <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#A2" title="Appendix B Audio Matching and Deduplication ‣ Moshi: a speech-text foundation model for real-time dialogue">Appendix&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">B</span></span></a>. We select the most frequent one that is long enough (16 seconds) and easy to detect from text and audio. We measure the proportion of generations that exactly match this most frequent segment.
For the matching, we initially use both audio and text matching, but observe that text-based matching has a higher recall for the initial matching step. We manually verify all the generations to filter out outliers that are not exact matches.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="S6.T13">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 13: </span><span class="ltx_text ltx_font_bold" id="S6.T13.4.1">Regurgitation of training data with condition-free generation</span> from different models.
We measure how many times each model generates the most frequent duplicate segment audio in the training data, for different values of the temperature. With dataset deduplication, we do not observe any exact re-generation (out of <math alttext="10^{5}" class="ltx_Math" display="inline" id="S6.T13.2.m1.1"><semantics id="S6.T13.2.m1.1b"><msup id="S6.T13.2.m1.1.1" xref="S6.T13.2.m1.1.1.cmml"><mn id="S6.T13.2.m1.1.1.2" xref="S6.T13.2.m1.1.1.2.cmml">10</mn><mn id="S6.T13.2.m1.1.1.3" xref="S6.T13.2.m1.1.1.3.cmml">5</mn></msup><annotation-xml encoding="MathML-Content" id="S6.T13.2.m1.1c"><apply id="S6.T13.2.m1.1.1.cmml" xref="S6.T13.2.m1.1.1"><csymbol cd="ambiguous" id="S6.T13.2.m1.1.1.1.cmml" xref="S6.T13.2.m1.1.1">superscript</csymbol><cn id="S6.T13.2.m1.1.1.2.cmml" type="integer" xref="S6.T13.2.m1.1.1.2">10</cn><cn id="S6.T13.2.m1.1.1.3.cmml" type="integer" xref="S6.T13.2.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T13.2.m1.1d">10^{5}</annotation><annotation encoding="application/x-llamapun" id="S6.T13.2.m1.1e">10 start_POSTSUPERSCRIPT 5 end_POSTSUPERSCRIPT</annotation></semantics></math>) of the most frequent segment, even if we prompt the model with the first 3s of this audio segment.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S6.T13.5">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T13.5.1.1">
<th class="ltx_td ltx_th ltx_th_row ltx_border_tt" id="S6.T13.5.1.1.1"></th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T13.5.1.1.2"><span class="ltx_text" id="S6.T13.5.1.1.2.1" style="font-size:80%;">prompted (3s)</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T13.5.1.1.3"><span class="ltx_text" id="S6.T13.5.1.1.3.1" style="font-size:80%;">deduplicated</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T13.5.1.1.4"><span class="ltx_text" id="S6.T13.5.1.1.4.1" style="font-size:80%;">fine-tuned</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T13.5.1.1.5"><span class="ltx_text" id="S6.T13.5.1.1.5.1" style="font-size:80%;">temp.</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T13.5.1.1.6"><span class="ltx_text" id="S6.T13.5.1.1.6.1" style="font-size:80%;">regurgitation rate (%)</span></td>
</tr>
<tr class="ltx_tr" id="S6.T13.5.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S6.T13.5.2.2.1" rowspan="10"><span class="ltx_text" id="S6.T13.5.2.2.1.1" style="font-size:80%;">single-stream</span></th>
<td class="ltx_td ltx_border_t" id="S6.T13.5.2.2.2"></td>
<td class="ltx_td ltx_border_t" id="S6.T13.5.2.2.3"></td>
<td class="ltx_td ltx_border_t" id="S6.T13.5.2.2.4"></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T13.5.2.2.5">
<span class="ltx_text" id="S6.T13.5.2.2.5.1" style="font-size:80%;">0</span><span class="ltx_text ltx_phantom" id="S6.T13.5.2.2.5.2" style="font-size:80%;"><span style="visibility:hidden">.0</span></span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T13.5.2.2.6"><span class="ltx_text" id="S6.T13.5.2.2.6.1" style="font-size:80%;">0.00</span></td>
</tr>
<tr class="ltx_tr" id="S6.T13.5.3.3">
<td class="ltx_td" id="S6.T13.5.3.3.1"></td>
<td class="ltx_td" id="S6.T13.5.3.3.2"></td>
<td class="ltx_td" id="S6.T13.5.3.3.3"></td>
<td class="ltx_td ltx_align_center" id="S6.T13.5.3.3.4"><span class="ltx_text" id="S6.T13.5.3.3.4.1" style="font-size:80%;">0.6</span></td>
<td class="ltx_td ltx_align_center" id="S6.T13.5.3.3.5"><span class="ltx_text" id="S6.T13.5.3.3.5.1" style="font-size:80%;">0.13</span></td>
</tr>
<tr class="ltx_tr" id="S6.T13.5.4.4">
<td class="ltx_td" id="S6.T13.5.4.4.1"></td>
<td class="ltx_td" id="S6.T13.5.4.4.2"></td>
<td class="ltx_td" id="S6.T13.5.4.4.3"></td>
<td class="ltx_td ltx_align_center" id="S6.T13.5.4.4.4"><span class="ltx_text" id="S6.T13.5.4.4.4.1" style="font-size:80%;">0.8</span></td>
<td class="ltx_td ltx_align_center" id="S6.T13.5.4.4.5"><span class="ltx_text" id="S6.T13.5.4.4.5.1" style="font-size:80%;">0.19</span></td>
</tr>
<tr class="ltx_tr" id="S6.T13.5.5.5">
<td class="ltx_td" id="S6.T13.5.5.5.1"></td>
<td class="ltx_td" id="S6.T13.5.5.5.2"></td>
<td class="ltx_td" id="S6.T13.5.5.5.3"></td>
<td class="ltx_td ltx_align_center" id="S6.T13.5.5.5.4"><span class="ltx_text" id="S6.T13.5.5.5.4.1" style="font-size:80%;">1.0</span></td>
<td class="ltx_td ltx_align_center" id="S6.T13.5.5.5.5"><span class="ltx_text" id="S6.T13.5.5.5.5.1" style="font-size:80%;">0.16</span></td>
</tr>
<tr class="ltx_tr" id="S6.T13.5.6.6">
<td class="ltx_td ltx_align_center" id="S6.T13.5.6.6.1"><span class="ltx_text" id="S6.T13.5.6.6.1.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td" id="S6.T13.5.6.6.2"></td>
<td class="ltx_td" id="S6.T13.5.6.6.3"></td>
<td class="ltx_td ltx_align_center" id="S6.T13.5.6.6.4">
<span class="ltx_text" id="S6.T13.5.6.6.4.1" style="font-size:80%;">0</span><span class="ltx_text ltx_phantom" id="S6.T13.5.6.6.4.2" style="font-size:80%;"><span style="visibility:hidden">.0</span></span>
</td>
<td class="ltx_td ltx_align_center" id="S6.T13.5.6.6.5">
<span class="ltx_text" id="S6.T13.5.6.6.5.1" style="font-size:80%;">100.00</span><span class="ltx_text ltx_phantom" id="S6.T13.5.6.6.5.2" style="font-size:80%;"><span style="visibility:hidden">00</span></span>
</td>
</tr>
<tr class="ltx_tr" id="S6.T13.5.7.7">
<td class="ltx_td ltx_align_center" id="S6.T13.5.7.7.1"><span class="ltx_text" id="S6.T13.5.7.7.1.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td" id="S6.T13.5.7.7.2"></td>
<td class="ltx_td" id="S6.T13.5.7.7.3"></td>
<td class="ltx_td ltx_align_center" id="S6.T13.5.7.7.4"><span class="ltx_text" id="S6.T13.5.7.7.4.1" style="font-size:80%;">0.8</span></td>
<td class="ltx_td ltx_align_center" id="S6.T13.5.7.7.5">
<span class="ltx_text" id="S6.T13.5.7.7.5.1" style="font-size:80%;">98.40</span><span class="ltx_text ltx_phantom" id="S6.T13.5.7.7.5.2" style="font-size:80%;"><span style="visibility:hidden">0</span></span>
</td>
</tr>
<tr class="ltx_tr" id="S6.T13.5.8.8">
<td class="ltx_td" id="S6.T13.5.8.8.1"></td>
<td class="ltx_td ltx_align_center" id="S6.T13.5.8.8.2"><span class="ltx_text" id="S6.T13.5.8.8.2.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td" id="S6.T13.5.8.8.3"></td>
<td class="ltx_td ltx_align_center" id="S6.T13.5.8.8.4">
<span class="ltx_text" id="S6.T13.5.8.8.4.1" style="font-size:80%;">0</span><span class="ltx_text ltx_phantom" id="S6.T13.5.8.8.4.2" style="font-size:80%;"><span style="visibility:hidden">.0</span></span>
</td>
<td class="ltx_td ltx_align_center" id="S6.T13.5.8.8.5"><span class="ltx_text" id="S6.T13.5.8.8.5.1" style="font-size:80%;">0.00</span></td>
</tr>
<tr class="ltx_tr" id="S6.T13.5.9.9">
<td class="ltx_td" id="S6.T13.5.9.9.1"></td>
<td class="ltx_td ltx_align_center" id="S6.T13.5.9.9.2"><span class="ltx_text" id="S6.T13.5.9.9.2.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td" id="S6.T13.5.9.9.3"></td>
<td class="ltx_td ltx_align_center" id="S6.T13.5.9.9.4"><span class="ltx_text" id="S6.T13.5.9.9.4.1" style="font-size:80%;">0.8</span></td>
<td class="ltx_td ltx_align_center" id="S6.T13.5.9.9.5"><span class="ltx_text" id="S6.T13.5.9.9.5.1" style="font-size:80%;">0.00</span></td>
</tr>
<tr class="ltx_tr" id="S6.T13.5.10.10">
<td class="ltx_td ltx_align_center" id="S6.T13.5.10.10.1"><span class="ltx_text" id="S6.T13.5.10.10.1.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td ltx_align_center" id="S6.T13.5.10.10.2"><span class="ltx_text" id="S6.T13.5.10.10.2.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td" id="S6.T13.5.10.10.3"></td>
<td class="ltx_td ltx_align_center" id="S6.T13.5.10.10.4">
<span class="ltx_text" id="S6.T13.5.10.10.4.1" style="font-size:80%;">0</span><span class="ltx_text ltx_phantom" id="S6.T13.5.10.10.4.2" style="font-size:80%;"><span style="visibility:hidden">.0</span></span>
</td>
<td class="ltx_td ltx_align_center" id="S6.T13.5.10.10.5"><span class="ltx_text" id="S6.T13.5.10.10.5.1" style="font-size:80%;">0.00</span></td>
</tr>
<tr class="ltx_tr" id="S6.T13.5.11.11">
<td class="ltx_td ltx_align_center" id="S6.T13.5.11.11.1"><span class="ltx_text" id="S6.T13.5.11.11.1.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td ltx_align_center" id="S6.T13.5.11.11.2"><span class="ltx_text" id="S6.T13.5.11.11.2.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td" id="S6.T13.5.11.11.3"></td>
<td class="ltx_td ltx_align_center" id="S6.T13.5.11.11.4"><span class="ltx_text" id="S6.T13.5.11.11.4.1" style="font-size:80%;">0.8</span></td>
<td class="ltx_td ltx_align_center" id="S6.T13.5.11.11.5"><span class="ltx_text" id="S6.T13.5.11.11.5.1" style="font-size:80%;">0.00</span></td>
</tr>
<tr class="ltx_tr" id="S6.T13.5.12.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="S6.T13.5.12.12.1" rowspan="4"><span class="ltx_text" id="S6.T13.5.12.12.1.1" style="font-size:80%;">multi-stream</span></th>
<td class="ltx_td ltx_border_t" id="S6.T13.5.12.12.2"></td>
<td class="ltx_td ltx_border_t" id="S6.T13.5.12.12.3"></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T13.5.12.12.4"><span class="ltx_text" id="S6.T13.5.12.12.4.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T13.5.12.12.5"><span class="ltx_text" id="S6.T13.5.12.12.5.1" style="font-size:80%;">0.8</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T13.5.12.12.6"><span class="ltx_text" id="S6.T13.5.12.12.6.1" style="font-size:80%;">0.00</span></td>
</tr>
<tr class="ltx_tr" id="S6.T13.5.13.13">
<td class="ltx_td ltx_align_center" id="S6.T13.5.13.13.1"><span class="ltx_text" id="S6.T13.5.13.13.1.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td" id="S6.T13.5.13.13.2"></td>
<td class="ltx_td ltx_align_center" id="S6.T13.5.13.13.3"><span class="ltx_text" id="S6.T13.5.13.13.3.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td ltx_align_center" id="S6.T13.5.13.13.4"><span class="ltx_text" id="S6.T13.5.13.13.4.1" style="font-size:80%;">0.8</span></td>
<td class="ltx_td ltx_align_center" id="S6.T13.5.13.13.5"><span class="ltx_text" id="S6.T13.5.13.13.5.1" style="font-size:80%;">0.00</span></td>
</tr>
<tr class="ltx_tr" id="S6.T13.5.14.14">
<td class="ltx_td" id="S6.T13.5.14.14.1"></td>
<td class="ltx_td ltx_align_center" id="S6.T13.5.14.14.2"><span class="ltx_text" id="S6.T13.5.14.14.2.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td ltx_align_center" id="S6.T13.5.14.14.3"><span class="ltx_text" id="S6.T13.5.14.14.3.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td ltx_align_center" id="S6.T13.5.14.14.4"><span class="ltx_text" id="S6.T13.5.14.14.4.1" style="font-size:80%;">0.8</span></td>
<td class="ltx_td ltx_align_center" id="S6.T13.5.14.14.5"><span class="ltx_text" id="S6.T13.5.14.14.5.1" style="font-size:80%;">0.00</span></td>
</tr>
<tr class="ltx_tr" id="S6.T13.5.15.15">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T13.5.15.15.1"><span class="ltx_text" id="S6.T13.5.15.15.1.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T13.5.15.15.2"><span class="ltx_text" id="S6.T13.5.15.15.2.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T13.5.15.15.3"><span class="ltx_text" id="S6.T13.5.15.15.3.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T13.5.15.15.4"><span class="ltx_text" id="S6.T13.5.15.15.4.1" style="font-size:80%;">0.8</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T13.5.15.15.5"><span class="ltx_text" id="S6.T13.5.15.15.5.1" style="font-size:80%;">0.00</span></td>
</tr>
</tbody>
</table>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S6.SS2.SSS0.Px1.p2">
<p class="ltx_p" id="S6.SS2.SSS0.Px1.p2.1"><span class="ltx_text ltx_font_italic" id="S6.SS2.SSS0.Px1.p2.1.1">Unconditioned and prompted generation:</span> We first measure what happens with unconditional generation, to evaluate whether the model tends to generate specific sequences when not guided by a prompt. In a complementary manner, we prompt the model with the 3 first seconds of the most frequent audio segment and measure how many times the continuation is identical to this training set audio.
<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S6.T13" title="Table 13 ‣ Evaluation protocol. ‣ 6.2 Regurgitation Analysis ‣ 6 Safety ‣ Moshi: a speech-text foundation model for real-time dialogue">Table&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">13</span></span></a> reports these regurgitation results.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="S6.SS2.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Results &amp; Impact of fine-tuning.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S6.SS2.SSS0.Px2.p1">
<p class="ltx_p" id="S6.SS2.SSS0.Px2.p1.1">We observe that the pre-trained model trained on the raw dataset often generates frequent sequences from the training set. The sampling temperature has an important effect on the regurgitation rate: the values typically employed for generation (0.6–1.0) are more prone to regurgitation. Out of 1000 generations, the model fine-tuned for conversation does not generate the most frequent training sequence. As a disclaimer, we point out that fine-tuning could potentially be over-ridden and therefore may not be sufficient <em class="ltx_emph ltx_font_italic" id="S6.SS2.SSS0.Px2.p1.1.1">per se</em> to avoid regurgitation.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S6.SS2.SSS0.Px2.p2">
<p class="ltx_p" id="S6.SS2.SSS0.Px2.p2.1">Similar to what happens with textual models&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Carlini et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib10" title="">2022</a>)</cite>, regurgitation is significantly impacted by the number of times that the model uses a given sequence for training.
Therefore, we evaluate the impact of deduplicating the training dataset by identifying all the audio segments that are frequent, and in turn by filtering them out at training time.
In <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S6.T13" title="Table 13 ‣ Evaluation protocol. ‣ 6.2 Regurgitation Analysis ‣ 6 Safety ‣ Moshi: a speech-text foundation model for real-time dialogue">Table&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">13</span></span></a>, we observe that this pre-processing step brings the number of regurgitations of the most frequent sequence to zero, even without any fine-tuning step.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_subsection" id="S6.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.3 </span>System Voice Consistency</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S6.SS3.p1">
<p class="ltx_p" id="S6.SS3.p1.1">A potential risk for a speech-to-speech model is unauthorized voice generation.
The model should use its target voice and not potentially mimic the user’s voice.
In order to evaluate to which extent Moshi adopts a voice of the user instead of the target voice, we use the following protocol:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul class="ltx_itemize" id="S6.I2">
<li class="ltx_item" id="S6.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S6.I2.i1.p1">
<p class="ltx_p" id="S6.I2.i1.p1.1">Generate 100 hours of conversations between Moshi and a second synthetic speaker.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S6.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S6.I2.i2.p1">
<p class="ltx_p" id="S6.I2.i2.p1.1">Run a speaker verification model (WavLM&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Chen et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib12" title="">2022</a>)</cite> large) on each segment to extract the speaker embeddings.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S6.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S6.I2.i3.p1">
<p class="ltx_p" id="S6.I2.i3.p1.1">Compute the cosine similarity between the embeddings of each main speaker’s segment with <em class="ltx_emph ltx_font_italic" id="S6.I2.i3.p1.1.1">(i)</em> the first segment of the main speaker and <em class="ltx_emph ltx_font_italic" id="S6.I2.i3.p1.1.2">(ii)</em> with the first segment of the generated speaker.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S6.I2.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S6.I2.i4.p1">
<p class="ltx_p" id="S6.I2.i4.p1.1"><span class="ltx_text ltx_font_italic" id="S6.I2.i4.p1.1.1">Note:</span> we exclude all the segments with a start time before 15 seconds so as to avoid counting the first turn of speech of the main speaker as it acts as the reference.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S6.SS3.p2">
<p class="ltx_p" id="S6.SS3.p2.1">Over the generated datasets, there are 10 249 occurrences (98.7%) where the voice of the main speaker is closer to the reference segment of the main speaker and 133 occurrences (1.3%) where the voice is closer to the reference segment of the other speaker.
We are also interested in how speaker’s consistency evolves over time. Following&nbsp;<cite class="ltx_cite ltx_citemacro_citet">Borsos et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib7" title="">2023</a>)</cite> we compute the same
ratio as above but on groups of segments that start at specific times, to measure drift along time. <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S6.T14" title="Table 14 ‣ 6.3 System Voice Consistency ‣ 6 Safety ‣ Moshi: a speech-text foundation model for real-time dialogue">Table&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">14</span></span></a> shows that speaker consistency remains stable along time, meaning that we do not observe a drift as the conversation goes on. This shows that the simple choice of using a consistent voice for the system during instruction tuning is enough to provide robustness at inference time.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="S6.T14">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 14: </span><span class="ltx_text ltx_font_bold" id="S6.T14.3.1">Speaker consistency along time.</span> We measure how often the speaker embedding from Moshi’s segment is closer to its reference segment than the user, when computing speaker embeddings from segments further away from the reference.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S6.T14.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S6.T14.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S6.T14.1.2.1.1"><span class="ltx_text" id="S6.T14.1.2.1.1.1" style="font-size:80%;">segment start time (seconds)</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T14.1.2.1.2"><span class="ltx_text" id="S6.T14.1.2.1.2.1" style="font-size:80%;">20–25</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T14.1.2.1.3"><span class="ltx_text" id="S6.T14.1.2.1.3.1" style="font-size:80%;">25–30</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T14.1.2.1.4"><span class="ltx_text" id="S6.T14.1.2.1.4.1" style="font-size:80%;">30–35</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T14.1.2.1.5"><span class="ltx_text" id="S6.T14.1.2.1.5.1" style="font-size:80%;">35–40</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T14.1.2.1.6"><span class="ltx_text" id="S6.T14.1.2.1.6.1" style="font-size:80%;">40–45</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T14.1.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S6.T14.1.3.1.1"><span class="ltx_text" id="S6.T14.1.3.1.1.1" style="font-size:80%;">samples</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T14.1.3.1.2"><span class="ltx_text" id="S6.T14.1.3.1.2.1" style="font-size:80%;">2034</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T14.1.3.1.3"><span class="ltx_text" id="S6.T14.1.3.1.3.1" style="font-size:80%;">2006</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T14.1.3.1.4"><span class="ltx_text" id="S6.T14.1.3.1.4.1" style="font-size:80%;">1998</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T14.1.3.1.5"><span class="ltx_text" id="S6.T14.1.3.1.5.1" style="font-size:80%;">2019</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T14.1.3.1.6"><span class="ltx_text" id="S6.T14.1.3.1.6.1" style="font-size:80%;">1994</span></td>
</tr>
<tr class="ltx_tr" id="S6.T14.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S6.T14.1.1.1">
<span class="ltx_text" id="S6.T14.1.1.1.1" style="font-size:80%;">main </span><math alttext=">" class="ltx_Math" display="inline" id="S6.T14.1.1.1.m1.1"><semantics id="S6.T14.1.1.1.m1.1a"><mo id="S6.T14.1.1.1.m1.1.1" mathsize="80%" xref="S6.T14.1.1.1.m1.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="S6.T14.1.1.1.m1.1b"><gt id="S6.T14.1.1.1.m1.1.1.cmml" xref="S6.T14.1.1.1.m1.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="S6.T14.1.1.1.m1.1c">&gt;</annotation><annotation encoding="application/x-llamapun" id="S6.T14.1.1.1.m1.1d">&gt;</annotation></semantics></math><span class="ltx_text" id="S6.T14.1.1.1.2" style="font-size:80%;"> other</span>
</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T14.1.1.2"><span class="ltx_text" id="S6.T14.1.1.2.1" style="font-size:80%;">98.4%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T14.1.1.3"><span class="ltx_text" id="S6.T14.1.1.3.1" style="font-size:80%;">99.2%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T14.1.1.4"><span class="ltx_text" id="S6.T14.1.1.4.1" style="font-size:80%;">99.1%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T14.1.1.5"><span class="ltx_text" id="S6.T14.1.1.5.1" style="font-size:80%;">99.2%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T14.1.1.6"><span class="ltx_text" id="S6.T14.1.1.6.1" style="font-size:80%;">99.3%</span></td>
</tr>
</tbody>
</table>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_subsection" id="S6.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.4 </span>Identification of the Content Generated by Moshi: Watermarking</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S6.SS4.p1">
<p class="ltx_p" id="S6.SS4.p1.1">For determining if a given audio has been generated by Moshi, we have investigated two complementary solutions: indexing and watermarking. The first, namely audio indexing, only applies in the case where we have access to the machine that generates the content, like in the case of the Moshi demo. We describe our audio matching system in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#A2" title="Appendix B Audio Matching and Deduplication ‣ Moshi: a speech-text foundation model for real-time dialogue">Appendix&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">B</span></span></a>.
Below in this subsection, we discuss more specifically watermarking, where the objective is to add unnoticeable marks to the generated audio.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_paragraph" id="S6.SS4.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Evaluation of signal-based watermarking.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S6.SS4.SSS0.Px1.p1">
<p class="ltx_p" id="S6.SS4.SSS0.Px1.p1.1">We investigate if existing watermarking methods for audio can be used as a way to re-identify content generated by Moshi. For this purpose, we analyze the robustness of the Audioseal method <cite class="ltx_cite ltx_citemacro_citep">(San&nbsp;Roman et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib84" title="">2024b</a>)</cite> in our context. It is available as an open-source library.<span class="ltx_note ltx_role_footnote" id="footnote21"><sup class="ltx_note_mark">21</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">21</sup><span class="ltx_tag ltx_tag_note">21</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="http://github.com/facebookresearch/audioseal" title="">http://github.com/facebookresearch/audioseal</a></span></span></span>
For this evaluation, we resample the audio signal to 16kHz so that the sampling rate matches the one recommended in Audioseal instructions. We measure the average mark detection scores in the following settings:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul class="ltx_itemize" id="S6.I3">
<li class="ltx_item" id="S6.I3.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S6.I3.i1.p1">
<p class="ltx_p" id="S6.I3.i1.p1.1">No watermark: we measure the detection score measured when no mark was added. 
<br class="ltx_break"></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S6.I3.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S6.I3.i2.p1">
<p class="ltx_p" id="S6.I3.i2.p1.1">Watermark no attack: no modification of the watermarked audio signal; 
<br class="ltx_break"></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S6.I3.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S6.I3.i3.p1">
<p class="ltx_p" id="S6.I3.i3.p1.1">Pink noise: we add a small pink noise (<math alttext="\sigma=0.2" class="ltx_Math" display="inline" id="S6.I3.i3.p1.1.m1.1"><semantics id="S6.I3.i3.p1.1.m1.1a"><mrow id="S6.I3.i3.p1.1.m1.1.1" xref="S6.I3.i3.p1.1.m1.1.1.cmml"><mi id="S6.I3.i3.p1.1.m1.1.1.2" xref="S6.I3.i3.p1.1.m1.1.1.2.cmml">σ</mi><mo id="S6.I3.i3.p1.1.m1.1.1.1" xref="S6.I3.i3.p1.1.m1.1.1.1.cmml">=</mo><mn id="S6.I3.i3.p1.1.m1.1.1.3" xref="S6.I3.i3.p1.1.m1.1.1.3.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.I3.i3.p1.1.m1.1b"><apply id="S6.I3.i3.p1.1.m1.1.1.cmml" xref="S6.I3.i3.p1.1.m1.1.1"><eq id="S6.I3.i3.p1.1.m1.1.1.1.cmml" xref="S6.I3.i3.p1.1.m1.1.1.1"></eq><ci id="S6.I3.i3.p1.1.m1.1.1.2.cmml" xref="S6.I3.i3.p1.1.m1.1.1.2">𝜎</ci><cn id="S6.I3.i3.p1.1.m1.1.1.3.cmml" type="float" xref="S6.I3.i3.p1.1.m1.1.1.3">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.I3.i3.p1.1.m1.1c">\sigma=0.2</annotation><annotation encoding="application/x-llamapun" id="S6.I3.i3.p1.1.m1.1d">italic_σ = 0.2</annotation></semantics></math>) to the watermarked audio; 
<br class="ltx_break"></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S6.I3.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S6.I3.i4.p1">
<p class="ltx_p" id="S6.I3.i4.p1.1">RVQGAN: we compress and decompress the audio signal with a recent state-of-the-art auto-encoder&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Kumar et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib51" title="">2023</a>)</cite>. We use the publicly available pre-trained 16Khz model<span class="ltx_note ltx_role_footnote" id="footnote22"><sup class="ltx_note_mark">22</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">22</sup><span class="ltx_tag ltx_tag_note">22</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/descriptinc/descript-audio-codec" title="">https://github.com/descriptinc/descript-audio-codec</a></span></span></span> which differs from the 24kHz model used as a baseline in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.SS2" title="5.2 Audio Tokenization ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue">Section&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.2</span></span></a>.
<br class="ltx_break"></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S6.I3.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S6.I3.i5.p1">
<p class="ltx_p" id="S6.I3.i5.p1.1">Mimi auto-encoder: we use our own tokenizer to compress and decompress the signal. This operation is performed with 24kHz audio and therefore involves two re-sampling stages (from 16kHz to 24kHz and back to 16kHz).</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S6.SS4.SSS0.Px1.p2">
<p class="ltx_p" id="S6.SS4.SSS0.Px1.p2.1">We report the results in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S6.T15" title="Table 15 ‣ Evaluation of signal-based watermarking. ‣ 6.4 Identification of the Content Generated by Moshi: Watermarking ‣ 6 Safety ‣ Moshi: a speech-text foundation model for real-time dialogue">Table&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">15</span></span></a>. We observe that the mark yields high detection rates when the audio is unchanged. With aggressive Pink-Noise, one needs a relatively long sequence to get a high detection score. However, the mark is not robust to a strong compression: the two auto-encoders that we consider are low bitrate and therefore discard anything not related to the signal reconstruction. As a result, our Mimi codec removes the mark to a level that makes a watermarked audio indistinguishable from a non-watermarked audio, making such a signal-based watermarking useless in this context.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="S6.T15">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 15: </span><span class="ltx_text ltx_font_bold" id="S6.T15.5.1">Evaluation of Audioseal</span> <cite class="ltx_cite ltx_citemacro_citep">(San&nbsp;Roman et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib84" title="">2024b</a>)</cite> for watermarking the speech produced by Moshi. Each detection score is averaged over 1000 generations. 
</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S6.T15.3">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S6.T15.3.4.1">
<th class="ltx_td ltx_th ltx_th_row ltx_border_tt" id="S6.T15.3.4.1.1"></th>
<th class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S6.T15.3.4.1.2"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S6.T15.3.4.1.3"><span class="ltx_text" id="S6.T15.3.4.1.3.1" style="font-size:80%;">average detection score</span></th>
</tr>
<tr class="ltx_tr" id="S6.T15.2.2">
<th class="ltx_td ltx_th ltx_th_row" id="S6.T15.2.2.3"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row" id="S6.T15.2.2.2">
<math alttext="\downarrow" class="ltx_Math" display="inline" id="S6.T15.1.1.1.m1.1"><semantics id="S6.T15.1.1.1.m1.1a"><mo id="S6.T15.1.1.1.m1.1.1" mathsize="80%" stretchy="false" xref="S6.T15.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S6.T15.1.1.1.m1.1b"><ci id="S6.T15.1.1.1.m1.1.1.cmml" xref="S6.T15.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T15.1.1.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S6.T15.1.1.1.m1.1d">↓</annotation></semantics></math><span class="ltx_text" id="S6.T15.2.2.2.1" style="font-size:80%;"> audio post-processing       &nbsp;  audio duration </span><math alttext="\rightarrow" class="ltx_Math" display="inline" id="S6.T15.2.2.2.m2.1"><semantics id="S6.T15.2.2.2.m2.1a"><mo id="S6.T15.2.2.2.m2.1.1" mathsize="80%" stretchy="false" xref="S6.T15.2.2.2.m2.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S6.T15.2.2.2.m2.1b"><ci id="S6.T15.2.2.2.m2.1.1.cmml" xref="S6.T15.2.2.2.m2.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T15.2.2.2.m2.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S6.T15.2.2.2.m2.1d">→</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t" id="S6.T15.2.2.4"><span class="ltx_text" id="S6.T15.2.2.4.1" style="font-size:80%;">10 seconds</span></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t" id="S6.T15.2.2.5"><span class="ltx_text" id="S6.T15.2.2.5.1" style="font-size:80%;">1 minute</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T15.3.5.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S6.T15.3.5.1.1"><span class="ltx_text" id="S6.T15.3.5.1.1.1" style="font-size:80%;">No mark</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S6.T15.3.5.1.2"><span class="ltx_text" id="S6.T15.3.5.1.2.1" style="font-size:80%;">none</span></th>
<td class="ltx_td ltx_align_right ltx_border_t" id="S6.T15.3.5.1.3"><span class="ltx_text" id="S6.T15.3.5.1.3.1" style="font-size:80%;">0.0855</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S6.T15.3.5.1.4"><span class="ltx_text" id="S6.T15.3.5.1.4.1" style="font-size:80%;">0.2474</span></td>
</tr>
<tr class="ltx_tr" id="S6.T15.3.6.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T15.3.6.2.1"><span class="ltx_text" id="S6.T15.3.6.2.1.1" style="font-size:80%;">Watermarked</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T15.3.6.2.2"><span class="ltx_text" id="S6.T15.3.6.2.2.1" style="font-size:80%;">none</span></th>
<td class="ltx_td ltx_align_right" id="S6.T15.3.6.2.3"><span class="ltx_text" id="S6.T15.3.6.2.3.1" style="font-size:80%;">0.9999</span></td>
<td class="ltx_td ltx_align_right" id="S6.T15.3.6.2.4"><span class="ltx_text" id="S6.T15.3.6.2.4.1" style="font-size:80%;">0.9999</span></td>
</tr>
<tr class="ltx_tr" id="S6.T15.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T15.3.3.2"><span class="ltx_text" id="S6.T15.3.3.2.1" style="font-size:80%;">Watermarked</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T15.3.3.1">
<span class="ltx_text" id="S6.T15.3.3.1.1" style="font-size:80%;">pink-noise (noise std </span><math alttext="\sigma=0.2" class="ltx_Math" display="inline" id="S6.T15.3.3.1.m1.1"><semantics id="S6.T15.3.3.1.m1.1a"><mrow id="S6.T15.3.3.1.m1.1.1" xref="S6.T15.3.3.1.m1.1.1.cmml"><mi id="S6.T15.3.3.1.m1.1.1.2" mathsize="80%" xref="S6.T15.3.3.1.m1.1.1.2.cmml">σ</mi><mo id="S6.T15.3.3.1.m1.1.1.1" mathsize="80%" xref="S6.T15.3.3.1.m1.1.1.1.cmml">=</mo><mn id="S6.T15.3.3.1.m1.1.1.3" mathsize="80%" xref="S6.T15.3.3.1.m1.1.1.3.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T15.3.3.1.m1.1b"><apply id="S6.T15.3.3.1.m1.1.1.cmml" xref="S6.T15.3.3.1.m1.1.1"><eq id="S6.T15.3.3.1.m1.1.1.1.cmml" xref="S6.T15.3.3.1.m1.1.1.1"></eq><ci id="S6.T15.3.3.1.m1.1.1.2.cmml" xref="S6.T15.3.3.1.m1.1.1.2">𝜎</ci><cn id="S6.T15.3.3.1.m1.1.1.3.cmml" type="float" xref="S6.T15.3.3.1.m1.1.1.3">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T15.3.3.1.m1.1c">\sigma=0.2</annotation><annotation encoding="application/x-llamapun" id="S6.T15.3.3.1.m1.1d">italic_σ = 0.2</annotation></semantics></math><span class="ltx_text" id="S6.T15.3.3.1.2" style="font-size:80%;">)</span>
</th>
<td class="ltx_td ltx_align_right" id="S6.T15.3.3.3"><span class="ltx_text" id="S6.T15.3.3.3.1" style="font-size:80%;">0.7093</span></td>
<td class="ltx_td ltx_align_right" id="S6.T15.3.3.4"><span class="ltx_text" id="S6.T15.3.3.4.1" style="font-size:80%;">0.9019</span></td>
</tr>
<tr class="ltx_tr" id="S6.T15.3.7.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T15.3.7.3.1"><span class="ltx_text" id="S6.T15.3.7.3.1.1" style="font-size:80%;">Watermarked</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T15.3.7.3.2"><span class="ltx_text" id="S6.T15.3.7.3.2.1" style="font-size:80%;">RVQGAN compression &amp; decompression</span></th>
<td class="ltx_td ltx_align_right" id="S6.T15.3.7.3.3"><span class="ltx_text" id="S6.T15.3.7.3.3.1" style="font-size:80%;">0.1101</span></td>
<td class="ltx_td ltx_align_right" id="S6.T15.3.7.3.4"><span class="ltx_text" id="S6.T15.3.7.3.4.1" style="font-size:80%;">0.2662</span></td>
</tr>
<tr class="ltx_tr" id="S6.T15.3.8.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S6.T15.3.8.4.1"><span class="ltx_text" id="S6.T15.3.8.4.1.1" style="font-size:80%;">Watermarked</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S6.T15.3.8.4.2"><span class="ltx_text" id="S6.T15.3.8.4.2.1" style="font-size:80%;">Mimi compression &amp; decompression</span></th>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S6.T15.3.8.4.3"><span class="ltx_text" id="S6.T15.3.8.4.3.1" style="font-size:80%;">0.0805</span></td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S6.T15.3.8.4.4"><span class="ltx_text" id="S6.T15.3.8.4.4.1" style="font-size:80%;">0.2404</span></td>
</tr>
</tbody>
</table>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_paragraph" id="S6.SS4.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Exploration on generative-based watermarking for audio.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S6.SS4.SSS0.Px2.p1">
<p class="ltx_p" id="S6.SS4.SSS0.Px2.p1.1">Given that a recent state-of-the-art signal-based audio watermarking is not robust to a simple non-adversarial auto-encoding method, we investigated the possibility of watermarking the generation process itself. This solution was recently proposed for text generation, in particular in the works of <cite class="ltx_cite ltx_citemacro_cite">Aaronson and Kirchner (<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib1" title="">2023</a>)</cite> and&nbsp;<cite class="ltx_cite ltx_citemacro_cite">Kirchenbauer et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib49" title="">2023</a>)</cite>. These two methods operate similarly: at sampling time, they bias the probabilities driving the generation process. They differ from each other by how they modify the probabilities, yet in both cases the sampling is parameterized by a hash function that preferably depends on a local context.
These solutions were improved by&nbsp;<cite class="ltx_cite ltx_citemacro_cite">Fernandez et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib29" title="">2023</a>)</cite>, who proposed a better mark detector, in particular by addressing the issue of repetitive patterns.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S6.SS4.SSS0.Px2.p2">
<p class="ltx_p" id="S6.SS4.SSS0.Px2.p2.1">We have investigated how to apply these discrete watermarking methods to our audio generation pipeline. For this purpose, we need to encode the audio signal back to tokens in order to identify if the mark is present or not. One issue is that <em class="ltx_emph ltx_font_italic" id="S6.SS4.SSS0.Px2.p2.1.1">the codec is not idempotent</em>: if we generate a waveform from tokens and then re-encode it back into tokens, the re-generated tokens are likely to be different from the ones generated with high probability, even if the audio has not suffered any noise addition. We quantify this problem in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S6.T16" title="Table 16 ‣ Exploration on generative-based watermarking for audio. ‣ 6.4 Identification of the Content Generated by Moshi: Watermarking ‣ 6 Safety ‣ Moshi: a speech-text foundation model for real-time dialogue">Table&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">16</span></span></a>. The semantic token is robust to some extent, while the other quantization indices are increasingly less robust as they depend on the previous quantizer level. One key issue is that the tokens do not resist to a moderate temporal shift. This is especially true for the Mimi codec, which is purposely optimized on a perceptual objective, as opposed to a fidelity reconstruction criterion.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="S6.T16">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 16: </span><span class="ltx_text ltx_font_bold" id="S6.T16.15.1">Idempotence of tokens</span>. Probabilities that quantization indices remain identical after decoding and re-encoding the waveform back to tokens, depending on the residual quantizer level. We consider two optional audio post-processing attacks: audio shifted by a time offset of up to half the sampling period (<math alttext="\Delta T" class="ltx_Math" display="inline" id="S6.T16.2.m1.1"><semantics id="S6.T16.2.m1.1b"><mrow id="S6.T16.2.m1.1.1" xref="S6.T16.2.m1.1.1.cmml"><mi id="S6.T16.2.m1.1.1.2" mathvariant="normal" xref="S6.T16.2.m1.1.1.2.cmml">Δ</mi><mo id="S6.T16.2.m1.1.1.1" xref="S6.T16.2.m1.1.1.1.cmml">⁢</mo><mi id="S6.T16.2.m1.1.1.3" xref="S6.T16.2.m1.1.1.3.cmml">T</mi></mrow><annotation-xml encoding="MathML-Content" id="S6.T16.2.m1.1c"><apply id="S6.T16.2.m1.1.1.cmml" xref="S6.T16.2.m1.1.1"><times id="S6.T16.2.m1.1.1.1.cmml" xref="S6.T16.2.m1.1.1.1"></times><ci id="S6.T16.2.m1.1.1.2.cmml" xref="S6.T16.2.m1.1.1.2">Δ</ci><ci id="S6.T16.2.m1.1.1.3.cmml" xref="S6.T16.2.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T16.2.m1.1d">\Delta T</annotation><annotation encoding="application/x-llamapun" id="S6.T16.2.m1.1e">roman_Δ italic_T</annotation></semantics></math>=40ms), and re-encoding with RVQGAN.
All results are averaged over 1000 generated sequences of 1 minute.

</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S6.T16.13" style="width:433.6pt;height:264.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(10.2pt,-6.2pt) scale(1.04920614098452,1.04920614098452) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S6.T16.13.11">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S6.T16.11.9.9">
<th class="ltx_td ltx_th ltx_th_row ltx_border_tt" id="S6.T16.11.9.9.10"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S6.T16.11.9.9.11"><span class="ltx_text" id="S6.T16.11.9.9.11.1" style="font-size:80%;">attacks</span></th>
<th class="ltx_td ltx_nopad_r ltx_align_right ltx_th ltx_th_column ltx_border_tt" id="S6.T16.3.1.1.1">
<span class="ltx_text" id="S6.T16.3.1.1.1.1" style="font-size:80%;">RQ level </span><math alttext="\rightarrow" class="ltx_Math" display="inline" id="S6.T16.3.1.1.1.m1.1"><semantics id="S6.T16.3.1.1.1.m1.1a"><mo id="S6.T16.3.1.1.1.m1.1.1" mathsize="80%" stretchy="false" xref="S6.T16.3.1.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S6.T16.3.1.1.1.m1.1b"><ci id="S6.T16.3.1.1.1.m1.1.1.cmml" xref="S6.T16.3.1.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T16.3.1.1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S6.T16.3.1.1.1.m1.1d">→</annotation></semantics></math>
</th>
<th class="ltx_td ltx_nopad_l ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T16.4.2.2.2"><math alttext="k=1" class="ltx_Math" display="inline" id="S6.T16.4.2.2.2.m1.1"><semantics id="S6.T16.4.2.2.2.m1.1a"><mrow id="S6.T16.4.2.2.2.m1.1.1" xref="S6.T16.4.2.2.2.m1.1.1.cmml"><mi id="S6.T16.4.2.2.2.m1.1.1.2" mathsize="80%" xref="S6.T16.4.2.2.2.m1.1.1.2.cmml">k</mi><mo id="S6.T16.4.2.2.2.m1.1.1.1" mathsize="80%" xref="S6.T16.4.2.2.2.m1.1.1.1.cmml">=</mo><mn id="S6.T16.4.2.2.2.m1.1.1.3" mathsize="80%" xref="S6.T16.4.2.2.2.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T16.4.2.2.2.m1.1b"><apply id="S6.T16.4.2.2.2.m1.1.1.cmml" xref="S6.T16.4.2.2.2.m1.1.1"><eq id="S6.T16.4.2.2.2.m1.1.1.1.cmml" xref="S6.T16.4.2.2.2.m1.1.1.1"></eq><ci id="S6.T16.4.2.2.2.m1.1.1.2.cmml" xref="S6.T16.4.2.2.2.m1.1.1.2">𝑘</ci><cn id="S6.T16.4.2.2.2.m1.1.1.3.cmml" type="integer" xref="S6.T16.4.2.2.2.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T16.4.2.2.2.m1.1c">k=1</annotation><annotation encoding="application/x-llamapun" id="S6.T16.4.2.2.2.m1.1d">italic_k = 1</annotation></semantics></math></th>
<th class="ltx_td ltx_nopad_l ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T16.5.3.3.3"><math alttext="k=2" class="ltx_Math" display="inline" id="S6.T16.5.3.3.3.m1.1"><semantics id="S6.T16.5.3.3.3.m1.1a"><mrow id="S6.T16.5.3.3.3.m1.1.1" xref="S6.T16.5.3.3.3.m1.1.1.cmml"><mi id="S6.T16.5.3.3.3.m1.1.1.2" mathsize="80%" xref="S6.T16.5.3.3.3.m1.1.1.2.cmml">k</mi><mo id="S6.T16.5.3.3.3.m1.1.1.1" mathsize="80%" xref="S6.T16.5.3.3.3.m1.1.1.1.cmml">=</mo><mn id="S6.T16.5.3.3.3.m1.1.1.3" mathsize="80%" xref="S6.T16.5.3.3.3.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T16.5.3.3.3.m1.1b"><apply id="S6.T16.5.3.3.3.m1.1.1.cmml" xref="S6.T16.5.3.3.3.m1.1.1"><eq id="S6.T16.5.3.3.3.m1.1.1.1.cmml" xref="S6.T16.5.3.3.3.m1.1.1.1"></eq><ci id="S6.T16.5.3.3.3.m1.1.1.2.cmml" xref="S6.T16.5.3.3.3.m1.1.1.2">𝑘</ci><cn id="S6.T16.5.3.3.3.m1.1.1.3.cmml" type="integer" xref="S6.T16.5.3.3.3.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T16.5.3.3.3.m1.1c">k=2</annotation><annotation encoding="application/x-llamapun" id="S6.T16.5.3.3.3.m1.1d">italic_k = 2</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T16.6.4.4.4"><math alttext="k=3" class="ltx_Math" display="inline" id="S6.T16.6.4.4.4.m1.1"><semantics id="S6.T16.6.4.4.4.m1.1a"><mrow id="S6.T16.6.4.4.4.m1.1.1" xref="S6.T16.6.4.4.4.m1.1.1.cmml"><mi id="S6.T16.6.4.4.4.m1.1.1.2" mathsize="80%" xref="S6.T16.6.4.4.4.m1.1.1.2.cmml">k</mi><mo id="S6.T16.6.4.4.4.m1.1.1.1" mathsize="80%" xref="S6.T16.6.4.4.4.m1.1.1.1.cmml">=</mo><mn id="S6.T16.6.4.4.4.m1.1.1.3" mathsize="80%" xref="S6.T16.6.4.4.4.m1.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T16.6.4.4.4.m1.1b"><apply id="S6.T16.6.4.4.4.m1.1.1.cmml" xref="S6.T16.6.4.4.4.m1.1.1"><eq id="S6.T16.6.4.4.4.m1.1.1.1.cmml" xref="S6.T16.6.4.4.4.m1.1.1.1"></eq><ci id="S6.T16.6.4.4.4.m1.1.1.2.cmml" xref="S6.T16.6.4.4.4.m1.1.1.2">𝑘</ci><cn id="S6.T16.6.4.4.4.m1.1.1.3.cmml" type="integer" xref="S6.T16.6.4.4.4.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T16.6.4.4.4.m1.1c">k=3</annotation><annotation encoding="application/x-llamapun" id="S6.T16.6.4.4.4.m1.1d">italic_k = 3</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T16.7.5.5.5"><math alttext="k=4" class="ltx_Math" display="inline" id="S6.T16.7.5.5.5.m1.1"><semantics id="S6.T16.7.5.5.5.m1.1a"><mrow id="S6.T16.7.5.5.5.m1.1.1" xref="S6.T16.7.5.5.5.m1.1.1.cmml"><mi id="S6.T16.7.5.5.5.m1.1.1.2" mathsize="80%" xref="S6.T16.7.5.5.5.m1.1.1.2.cmml">k</mi><mo id="S6.T16.7.5.5.5.m1.1.1.1" mathsize="80%" xref="S6.T16.7.5.5.5.m1.1.1.1.cmml">=</mo><mn id="S6.T16.7.5.5.5.m1.1.1.3" mathsize="80%" xref="S6.T16.7.5.5.5.m1.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T16.7.5.5.5.m1.1b"><apply id="S6.T16.7.5.5.5.m1.1.1.cmml" xref="S6.T16.7.5.5.5.m1.1.1"><eq id="S6.T16.7.5.5.5.m1.1.1.1.cmml" xref="S6.T16.7.5.5.5.m1.1.1.1"></eq><ci id="S6.T16.7.5.5.5.m1.1.1.2.cmml" xref="S6.T16.7.5.5.5.m1.1.1.2">𝑘</ci><cn id="S6.T16.7.5.5.5.m1.1.1.3.cmml" type="integer" xref="S6.T16.7.5.5.5.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T16.7.5.5.5.m1.1c">k=4</annotation><annotation encoding="application/x-llamapun" id="S6.T16.7.5.5.5.m1.1d">italic_k = 4</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T16.8.6.6.6"><math alttext="k=5" class="ltx_Math" display="inline" id="S6.T16.8.6.6.6.m1.1"><semantics id="S6.T16.8.6.6.6.m1.1a"><mrow id="S6.T16.8.6.6.6.m1.1.1" xref="S6.T16.8.6.6.6.m1.1.1.cmml"><mi id="S6.T16.8.6.6.6.m1.1.1.2" mathsize="80%" xref="S6.T16.8.6.6.6.m1.1.1.2.cmml">k</mi><mo id="S6.T16.8.6.6.6.m1.1.1.1" mathsize="80%" xref="S6.T16.8.6.6.6.m1.1.1.1.cmml">=</mo><mn id="S6.T16.8.6.6.6.m1.1.1.3" mathsize="80%" xref="S6.T16.8.6.6.6.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T16.8.6.6.6.m1.1b"><apply id="S6.T16.8.6.6.6.m1.1.1.cmml" xref="S6.T16.8.6.6.6.m1.1.1"><eq id="S6.T16.8.6.6.6.m1.1.1.1.cmml" xref="S6.T16.8.6.6.6.m1.1.1.1"></eq><ci id="S6.T16.8.6.6.6.m1.1.1.2.cmml" xref="S6.T16.8.6.6.6.m1.1.1.2">𝑘</ci><cn id="S6.T16.8.6.6.6.m1.1.1.3.cmml" type="integer" xref="S6.T16.8.6.6.6.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T16.8.6.6.6.m1.1c">k=5</annotation><annotation encoding="application/x-llamapun" id="S6.T16.8.6.6.6.m1.1d">italic_k = 5</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T16.9.7.7.7"><math alttext="k=6" class="ltx_Math" display="inline" id="S6.T16.9.7.7.7.m1.1"><semantics id="S6.T16.9.7.7.7.m1.1a"><mrow id="S6.T16.9.7.7.7.m1.1.1" xref="S6.T16.9.7.7.7.m1.1.1.cmml"><mi id="S6.T16.9.7.7.7.m1.1.1.2" mathsize="80%" xref="S6.T16.9.7.7.7.m1.1.1.2.cmml">k</mi><mo id="S6.T16.9.7.7.7.m1.1.1.1" mathsize="80%" xref="S6.T16.9.7.7.7.m1.1.1.1.cmml">=</mo><mn id="S6.T16.9.7.7.7.m1.1.1.3" mathsize="80%" xref="S6.T16.9.7.7.7.m1.1.1.3.cmml">6</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T16.9.7.7.7.m1.1b"><apply id="S6.T16.9.7.7.7.m1.1.1.cmml" xref="S6.T16.9.7.7.7.m1.1.1"><eq id="S6.T16.9.7.7.7.m1.1.1.1.cmml" xref="S6.T16.9.7.7.7.m1.1.1.1"></eq><ci id="S6.T16.9.7.7.7.m1.1.1.2.cmml" xref="S6.T16.9.7.7.7.m1.1.1.2">𝑘</ci><cn id="S6.T16.9.7.7.7.m1.1.1.3.cmml" type="integer" xref="S6.T16.9.7.7.7.m1.1.1.3">6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T16.9.7.7.7.m1.1c">k=6</annotation><annotation encoding="application/x-llamapun" id="S6.T16.9.7.7.7.m1.1d">italic_k = 6</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T16.10.8.8.8"><math alttext="k=7" class="ltx_Math" display="inline" id="S6.T16.10.8.8.8.m1.1"><semantics id="S6.T16.10.8.8.8.m1.1a"><mrow id="S6.T16.10.8.8.8.m1.1.1" xref="S6.T16.10.8.8.8.m1.1.1.cmml"><mi id="S6.T16.10.8.8.8.m1.1.1.2" mathsize="80%" xref="S6.T16.10.8.8.8.m1.1.1.2.cmml">k</mi><mo id="S6.T16.10.8.8.8.m1.1.1.1" mathsize="80%" xref="S6.T16.10.8.8.8.m1.1.1.1.cmml">=</mo><mn id="S6.T16.10.8.8.8.m1.1.1.3" mathsize="80%" xref="S6.T16.10.8.8.8.m1.1.1.3.cmml">7</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T16.10.8.8.8.m1.1b"><apply id="S6.T16.10.8.8.8.m1.1.1.cmml" xref="S6.T16.10.8.8.8.m1.1.1"><eq id="S6.T16.10.8.8.8.m1.1.1.1.cmml" xref="S6.T16.10.8.8.8.m1.1.1.1"></eq><ci id="S6.T16.10.8.8.8.m1.1.1.2.cmml" xref="S6.T16.10.8.8.8.m1.1.1.2">𝑘</ci><cn id="S6.T16.10.8.8.8.m1.1.1.3.cmml" type="integer" xref="S6.T16.10.8.8.8.m1.1.1.3">7</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T16.10.8.8.8.m1.1c">k=7</annotation><annotation encoding="application/x-llamapun" id="S6.T16.10.8.8.8.m1.1d">italic_k = 7</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T16.11.9.9.9"><math alttext="k=8" class="ltx_Math" display="inline" id="S6.T16.11.9.9.9.m1.1"><semantics id="S6.T16.11.9.9.9.m1.1a"><mrow id="S6.T16.11.9.9.9.m1.1.1" xref="S6.T16.11.9.9.9.m1.1.1.cmml"><mi id="S6.T16.11.9.9.9.m1.1.1.2" mathsize="80%" xref="S6.T16.11.9.9.9.m1.1.1.2.cmml">k</mi><mo id="S6.T16.11.9.9.9.m1.1.1.1" mathsize="80%" xref="S6.T16.11.9.9.9.m1.1.1.1.cmml">=</mo><mn id="S6.T16.11.9.9.9.m1.1.1.3" mathsize="80%" xref="S6.T16.11.9.9.9.m1.1.1.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T16.11.9.9.9.m1.1b"><apply id="S6.T16.11.9.9.9.m1.1.1.cmml" xref="S6.T16.11.9.9.9.m1.1.1"><eq id="S6.T16.11.9.9.9.m1.1.1.1.cmml" xref="S6.T16.11.9.9.9.m1.1.1.1"></eq><ci id="S6.T16.11.9.9.9.m1.1.1.2.cmml" xref="S6.T16.11.9.9.9.m1.1.1.2">𝑘</ci><cn id="S6.T16.11.9.9.9.m1.1.1.3.cmml" type="integer" xref="S6.T16.11.9.9.9.m1.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T16.11.9.9.9.m1.1c">k=8</annotation><annotation encoding="application/x-llamapun" id="S6.T16.11.9.9.9.m1.1d">italic_k = 8</annotation></semantics></math></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T16.13.11.11">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row" id="S6.T16.12.10.10.1">
<math alttext="\downarrow" class="ltx_Math" display="inline" id="S6.T16.12.10.10.1.m1.1"><semantics id="S6.T16.12.10.10.1.m1.1a"><mo id="S6.T16.12.10.10.1.m1.1.1" mathsize="80%" stretchy="false" xref="S6.T16.12.10.10.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S6.T16.12.10.10.1.m1.1b"><ci id="S6.T16.12.10.10.1.m1.1.1.cmml" xref="S6.T16.12.10.10.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T16.12.10.10.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S6.T16.12.10.10.1.m1.1d">↓</annotation></semantics></math><span class="ltx_text" id="S6.T16.12.10.10.1.1" style="font-size:80%;"> codec</span>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T16.13.11.11.2"><math alttext="\Delta T" class="ltx_Math" display="inline" id="S6.T16.13.11.11.2.m1.1"><semantics id="S6.T16.13.11.11.2.m1.1a"><mrow id="S6.T16.13.11.11.2.m1.1.1" xref="S6.T16.13.11.11.2.m1.1.1.cmml"><mi id="S6.T16.13.11.11.2.m1.1.1.2" mathsize="80%" mathvariant="normal" xref="S6.T16.13.11.11.2.m1.1.1.2.cmml">Δ</mi><mo id="S6.T16.13.11.11.2.m1.1.1.1" xref="S6.T16.13.11.11.2.m1.1.1.1.cmml">⁢</mo><mi id="S6.T16.13.11.11.2.m1.1.1.3" mathsize="80%" xref="S6.T16.13.11.11.2.m1.1.1.3.cmml">T</mi></mrow><annotation-xml encoding="MathML-Content" id="S6.T16.13.11.11.2.m1.1b"><apply id="S6.T16.13.11.11.2.m1.1.1.cmml" xref="S6.T16.13.11.11.2.m1.1.1"><times id="S6.T16.13.11.11.2.m1.1.1.1.cmml" xref="S6.T16.13.11.11.2.m1.1.1.1"></times><ci id="S6.T16.13.11.11.2.m1.1.1.2.cmml" xref="S6.T16.13.11.11.2.m1.1.1.2">Δ</ci><ci id="S6.T16.13.11.11.2.m1.1.1.3.cmml" xref="S6.T16.13.11.11.2.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T16.13.11.11.2.m1.1c">\Delta T</annotation><annotation encoding="application/x-llamapun" id="S6.T16.13.11.11.2.m1.1d">roman_Δ italic_T</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T16.13.11.11.3"><span class="ltx_text" id="S6.T16.13.11.11.3.1" style="font-size:80%;">RVQGAN</span></th>
<th class="ltx_td ltx_nopad_r ltx_th ltx_th_column" id="S6.T16.13.11.11.4"></th>
<th class="ltx_td ltx_nopad_l ltx_align_center ltx_th ltx_th_column" id="S6.T16.13.11.11.5"><span class="ltx_text" id="S6.T16.13.11.11.5.1" style="font-size:80%;">(semantic)</span></th>
<th class="ltx_td ltx_th ltx_th_column" colspan="6" id="S6.T16.13.11.11.6"></th>
<td class="ltx_td" id="S6.T16.13.11.11.7"></td>
</tr>
<tr class="ltx_tr" id="S6.T16.13.11.12.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S6.T16.13.11.12.1.1" rowspan="4"><span class="ltx_text" id="S6.T16.13.11.12.1.1.1" style="font-size:80%;">Basic</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T16.13.11.12.1.2"><span class="ltx_text" id="S6.T16.13.11.12.1.2.1" style="font-size:80%;">0</span></td>
<td class="ltx_td ltx_border_t" id="S6.T16.13.11.12.1.3"></td>
<td class="ltx_td ltx_nopad_r ltx_border_t" id="S6.T16.13.11.12.1.4"></td>
<td class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t" id="S6.T16.13.11.12.1.5"><span class="ltx_text" id="S6.T16.13.11.12.1.5.1" style="font-size:80%;">0.798</span></td>
<td class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t" id="S6.T16.13.11.12.1.6"><span class="ltx_text" id="S6.T16.13.11.12.1.6.1" style="font-size:80%;">0.783</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T16.13.11.12.1.7"><span class="ltx_text" id="S6.T16.13.11.12.1.7.1" style="font-size:80%;">0.560</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T16.13.11.12.1.8"><span class="ltx_text" id="S6.T16.13.11.12.1.8.1" style="font-size:80%;">0.483</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T16.13.11.12.1.9"><span class="ltx_text" id="S6.T16.13.11.12.1.9.1" style="font-size:80%;">0.421</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T16.13.11.12.1.10"><span class="ltx_text" id="S6.T16.13.11.12.1.10.1" style="font-size:80%;">0.407</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T16.13.11.12.1.11"><span class="ltx_text" id="S6.T16.13.11.12.1.11.1" style="font-size:80%;">0.369</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T16.13.11.12.1.12"><span class="ltx_text" id="S6.T16.13.11.12.1.12.1" style="font-size:80%;">0.404</span></td>
</tr>
<tr class="ltx_tr" id="S6.T16.13.11.13.2">
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.13.2.1"><span class="ltx_text" id="S6.T16.13.11.13.2.1.1" style="font-size:80%;">10ms</span></td>
<td class="ltx_td" id="S6.T16.13.11.13.2.2"></td>
<td class="ltx_td ltx_nopad_r" id="S6.T16.13.11.13.2.3"></td>
<td class="ltx_td ltx_nopad_l ltx_align_center" id="S6.T16.13.11.13.2.4"><span class="ltx_text" id="S6.T16.13.11.13.2.4.1" style="font-size:80%;">0.766</span></td>
<td class="ltx_td ltx_nopad_l ltx_align_center" id="S6.T16.13.11.13.2.5"><span class="ltx_text" id="S6.T16.13.11.13.2.5.1" style="font-size:80%;">0.495</span></td>
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.13.2.6"><span class="ltx_text" id="S6.T16.13.11.13.2.6.1" style="font-size:80%;">0.255</span></td>
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.13.2.7"><span class="ltx_text" id="S6.T16.13.11.13.2.7.1" style="font-size:80%;">0.206</span></td>
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.13.2.8"><span class="ltx_text" id="S6.T16.13.11.13.2.8.1" style="font-size:80%;">0.180</span></td>
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.13.2.9"><span class="ltx_text" id="S6.T16.13.11.13.2.9.1" style="font-size:80%;">0.173</span></td>
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.13.2.10"><span class="ltx_text" id="S6.T16.13.11.13.2.10.1" style="font-size:80%;">0.144</span></td>
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.13.2.11"><span class="ltx_text" id="S6.T16.13.11.13.2.11.1" style="font-size:80%;">0.193</span></td>
</tr>
<tr class="ltx_tr" id="S6.T16.13.11.14.3">
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.14.3.1"><span class="ltx_text" id="S6.T16.13.11.14.3.1.1" style="font-size:80%;">20ms</span></td>
<td class="ltx_td" id="S6.T16.13.11.14.3.2"></td>
<td class="ltx_td ltx_nopad_r" id="S6.T16.13.11.14.3.3"></td>
<td class="ltx_td ltx_nopad_l ltx_align_center" id="S6.T16.13.11.14.3.4"><span class="ltx_text" id="S6.T16.13.11.14.3.4.1" style="font-size:80%;">0.682</span></td>
<td class="ltx_td ltx_nopad_l ltx_align_center" id="S6.T16.13.11.14.3.5"><span class="ltx_text" id="S6.T16.13.11.14.3.5.1" style="font-size:80%;">0.390</span></td>
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.14.3.6"><span class="ltx_text" id="S6.T16.13.11.14.3.6.1" style="font-size:80%;">0.220</span></td>
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.14.3.7"><span class="ltx_text" id="S6.T16.13.11.14.3.7.1" style="font-size:80%;">0.180</span></td>
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.14.3.8"><span class="ltx_text" id="S6.T16.13.11.14.3.8.1" style="font-size:80%;">0.158</span></td>
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.14.3.9"><span class="ltx_text" id="S6.T16.13.11.14.3.9.1" style="font-size:80%;">0.154</span></td>
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.14.3.10"><span class="ltx_text" id="S6.T16.13.11.14.3.10.1" style="font-size:80%;">0.129</span></td>
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.14.3.11"><span class="ltx_text" id="S6.T16.13.11.14.3.11.1" style="font-size:80%;">0.172</span></td>
</tr>
<tr class="ltx_tr" id="S6.T16.13.11.15.4">
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.15.4.1"><span class="ltx_text" id="S6.T16.13.11.15.4.1.1" style="font-size:80%;">40ms</span></td>
<td class="ltx_td" id="S6.T16.13.11.15.4.2"></td>
<td class="ltx_td ltx_nopad_r" id="S6.T16.13.11.15.4.3"></td>
<td class="ltx_td ltx_nopad_l ltx_align_center" id="S6.T16.13.11.15.4.4"><span class="ltx_text" id="S6.T16.13.11.15.4.4.1" style="font-size:80%;">0.503</span></td>
<td class="ltx_td ltx_nopad_l ltx_align_center" id="S6.T16.13.11.15.4.5"><span class="ltx_text" id="S6.T16.13.11.15.4.5.1" style="font-size:80%;">0.329</span></td>
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.15.4.6"><span class="ltx_text" id="S6.T16.13.11.15.4.6.1" style="font-size:80%;">0.182</span></td>
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.15.4.7"><span class="ltx_text" id="S6.T16.13.11.15.4.7.1" style="font-size:80%;">0.146</span></td>
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.15.4.8"><span class="ltx_text" id="S6.T16.13.11.15.4.8.1" style="font-size:80%;">0.128</span></td>
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.15.4.9"><span class="ltx_text" id="S6.T16.13.11.15.4.9.1" style="font-size:80%;">0.125</span></td>
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.15.4.10"><span class="ltx_text" id="S6.T16.13.11.15.4.10.1" style="font-size:80%;">0.107</span></td>
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.15.4.11"><span class="ltx_text" id="S6.T16.13.11.15.4.11.1" style="font-size:80%;">0.156</span></td>
</tr>
<tr class="ltx_tr" id="S6.T16.13.11.16.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="S6.T16.13.11.16.5.1" rowspan="8"><span class="ltx_text" id="S6.T16.13.11.16.5.1.1" style="font-size:80%;">Mimi</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T16.13.11.16.5.2"><span class="ltx_text" id="S6.T16.13.11.16.5.2.1" style="font-size:80%;">0</span></td>
<td class="ltx_td ltx_border_t" id="S6.T16.13.11.16.5.3"></td>
<td class="ltx_td ltx_nopad_r ltx_border_t" id="S6.T16.13.11.16.5.4"></td>
<td class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t" id="S6.T16.13.11.16.5.5"><span class="ltx_text" id="S6.T16.13.11.16.5.5.1" style="font-size:80%;">0.766</span></td>
<td class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t" id="S6.T16.13.11.16.5.6"><span class="ltx_text" id="S6.T16.13.11.16.5.6.1" style="font-size:80%;">0.550</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T16.13.11.16.5.7"><span class="ltx_text" id="S6.T16.13.11.16.5.7.1" style="font-size:80%;">0.372</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T16.13.11.16.5.8"><span class="ltx_text" id="S6.T16.13.11.16.5.8.1" style="font-size:80%;">0.352</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T16.13.11.16.5.9"><span class="ltx_text" id="S6.T16.13.11.16.5.9.1" style="font-size:80%;">0.293</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T16.13.11.16.5.10"><span class="ltx_text" id="S6.T16.13.11.16.5.10.1" style="font-size:80%;">0.297</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T16.13.11.16.5.11"><span class="ltx_text" id="S6.T16.13.11.16.5.11.1" style="font-size:80%;">0.264</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T16.13.11.16.5.12"><span class="ltx_text" id="S6.T16.13.11.16.5.12.1" style="font-size:80%;">0.303</span></td>
</tr>
<tr class="ltx_tr" id="S6.T16.13.11.17.6">
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.17.6.1"><span class="ltx_text" id="S6.T16.13.11.17.6.1.1" style="font-size:80%;">10ms</span></td>
<td class="ltx_td" id="S6.T16.13.11.17.6.2"></td>
<td class="ltx_td ltx_nopad_r" id="S6.T16.13.11.17.6.3"></td>
<td class="ltx_td ltx_nopad_l ltx_align_center" id="S6.T16.13.11.17.6.4"><span class="ltx_text" id="S6.T16.13.11.17.6.4.1" style="font-size:80%;">0.731</span></td>
<td class="ltx_td ltx_nopad_l ltx_align_center" id="S6.T16.13.11.17.6.5"><span class="ltx_text" id="S6.T16.13.11.17.6.5.1" style="font-size:80%;">0.376</span></td>
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.17.6.6"><span class="ltx_text" id="S6.T16.13.11.17.6.6.1" style="font-size:80%;">0.206</span></td>
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.17.6.7"><span class="ltx_text" id="S6.T16.13.11.17.6.7.1" style="font-size:80%;">0.176</span></td>
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.17.6.8"><span class="ltx_text" id="S6.T16.13.11.17.6.8.1" style="font-size:80%;">0.152</span></td>
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.17.6.9"><span class="ltx_text" id="S6.T16.13.11.17.6.9.1" style="font-size:80%;">0.154</span></td>
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.17.6.10"><span class="ltx_text" id="S6.T16.13.11.17.6.10.1" style="font-size:80%;">0.132</span></td>
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.17.6.11"><span class="ltx_text" id="S6.T16.13.11.17.6.11.1" style="font-size:80%;">0.182</span></td>
</tr>
<tr class="ltx_tr" id="S6.T16.13.11.18.7">
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.18.7.1"><span class="ltx_text" id="S6.T16.13.11.18.7.1.1" style="font-size:80%;">20ms</span></td>
<td class="ltx_td" id="S6.T16.13.11.18.7.2"></td>
<td class="ltx_td ltx_nopad_r" id="S6.T16.13.11.18.7.3"></td>
<td class="ltx_td ltx_nopad_l ltx_align_center" id="S6.T16.13.11.18.7.4"><span class="ltx_text" id="S6.T16.13.11.18.7.4.1" style="font-size:80%;">0.653</span></td>
<td class="ltx_td ltx_nopad_l ltx_align_center" id="S6.T16.13.11.18.7.5"><span class="ltx_text" id="S6.T16.13.11.18.7.5.1" style="font-size:80%;">0.307</span></td>
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.18.7.6"><span class="ltx_text" id="S6.T16.13.11.18.7.6.1" style="font-size:80%;">0.171</span></td>
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.18.7.7"><span class="ltx_text" id="S6.T16.13.11.18.7.7.1" style="font-size:80%;">0.146</span></td>
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.18.7.8"><span class="ltx_text" id="S6.T16.13.11.18.7.8.1" style="font-size:80%;">0.121</span></td>
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.18.7.9"><span class="ltx_text" id="S6.T16.13.11.18.7.9.1" style="font-size:80%;">0.126</span></td>
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.18.7.10"><span class="ltx_text" id="S6.T16.13.11.18.7.10.1" style="font-size:80%;">0.106</span></td>
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.18.7.11"><span class="ltx_text" id="S6.T16.13.11.18.7.11.1" style="font-size:80%;">0.159</span></td>
</tr>
<tr class="ltx_tr" id="S6.T16.13.11.19.8">
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.19.8.1"><span class="ltx_text" id="S6.T16.13.11.19.8.1.1" style="font-size:80%;">40ms</span></td>
<td class="ltx_td" id="S6.T16.13.11.19.8.2"></td>
<td class="ltx_td ltx_nopad_r" id="S6.T16.13.11.19.8.3"></td>
<td class="ltx_td ltx_nopad_l ltx_align_center" id="S6.T16.13.11.19.8.4"><span class="ltx_text" id="S6.T16.13.11.19.8.4.1" style="font-size:80%;">0.483</span></td>
<td class="ltx_td ltx_nopad_l ltx_align_center" id="S6.T16.13.11.19.8.5"><span class="ltx_text" id="S6.T16.13.11.19.8.5.1" style="font-size:80%;">0.267</span></td>
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.19.8.6"><span class="ltx_text" id="S6.T16.13.11.19.8.6.1" style="font-size:80%;">0.160</span></td>
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.19.8.7"><span class="ltx_text" id="S6.T16.13.11.19.8.7.1" style="font-size:80%;">0.137</span></td>
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.19.8.8"><span class="ltx_text" id="S6.T16.13.11.19.8.8.1" style="font-size:80%;">0.116</span></td>
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.19.8.9"><span class="ltx_text" id="S6.T16.13.11.19.8.9.1" style="font-size:80%;">0.121</span></td>
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.19.8.10"><span class="ltx_text" id="S6.T16.13.11.19.8.10.1" style="font-size:80%;">0.102</span></td>
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.19.8.11"><span class="ltx_text" id="S6.T16.13.11.19.8.11.1" style="font-size:80%;">0.150</span></td>
</tr>
<tr class="ltx_tr" id="S6.T16.13.11.20.9">
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T16.13.11.20.9.1"><span class="ltx_text" id="S6.T16.13.11.20.9.1.1" style="font-size:80%;">0</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T16.13.11.20.9.2"><span class="ltx_text" id="S6.T16.13.11.20.9.2.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td ltx_nopad_r ltx_border_t" id="S6.T16.13.11.20.9.3"></td>
<td class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t" id="S6.T16.13.11.20.9.4"><span class="ltx_text" id="S6.T16.13.11.20.9.4.1" style="font-size:80%;">0.741</span></td>
<td class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t" id="S6.T16.13.11.20.9.5"><span class="ltx_text" id="S6.T16.13.11.20.9.5.1" style="font-size:80%;">0.409</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T16.13.11.20.9.6"><span class="ltx_text" id="S6.T16.13.11.20.9.6.1" style="font-size:80%;">0.221</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T16.13.11.20.9.7"><span class="ltx_text" id="S6.T16.13.11.20.9.7.1" style="font-size:80%;">0.198</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T16.13.11.20.9.8"><span class="ltx_text" id="S6.T16.13.11.20.9.8.1" style="font-size:80%;">0.150</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T16.13.11.20.9.9"><span class="ltx_text" id="S6.T16.13.11.20.9.9.1" style="font-size:80%;">0.154</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T16.13.11.20.9.10"><span class="ltx_text" id="S6.T16.13.11.20.9.10.1" style="font-size:80%;">0.134</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T16.13.11.20.9.11"><span class="ltx_text" id="S6.T16.13.11.20.9.11.1" style="font-size:80%;">0.173</span></td>
</tr>
<tr class="ltx_tr" id="S6.T16.13.11.21.10">
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.21.10.1"><span class="ltx_text" id="S6.T16.13.11.21.10.1.1" style="font-size:80%;">10ms</span></td>
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.21.10.2"><span class="ltx_text" id="S6.T16.13.11.21.10.2.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td ltx_nopad_r" id="S6.T16.13.11.21.10.3"></td>
<td class="ltx_td ltx_nopad_l ltx_align_center" id="S6.T16.13.11.21.10.4"><span class="ltx_text" id="S6.T16.13.11.21.10.4.1" style="font-size:80%;">0.702</span></td>
<td class="ltx_td ltx_nopad_l ltx_align_center" id="S6.T16.13.11.21.10.5"><span class="ltx_text" id="S6.T16.13.11.21.10.5.1" style="font-size:80%;">0.281</span></td>
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.21.10.6"><span class="ltx_text" id="S6.T16.13.11.21.10.6.1" style="font-size:80%;">0.148</span></td>
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.21.10.7"><span class="ltx_text" id="S6.T16.13.11.21.10.7.1" style="font-size:80%;">0.133</span></td>
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.21.10.8"><span class="ltx_text" id="S6.T16.13.11.21.10.8.1" style="font-size:80%;">0.118</span></td>
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.21.10.9"><span class="ltx_text" id="S6.T16.13.11.21.10.9.1" style="font-size:80%;">0.117</span></td>
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.21.10.10"><span class="ltx_text" id="S6.T16.13.11.21.10.10.1" style="font-size:80%;">0.100</span></td>
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.21.10.11"><span class="ltx_text" id="S6.T16.13.11.21.10.11.1" style="font-size:80%;">0.136</span></td>
</tr>
<tr class="ltx_tr" id="S6.T16.13.11.22.11">
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.22.11.1"><span class="ltx_text" id="S6.T16.13.11.22.11.1.1" style="font-size:80%;">20ms</span></td>
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.22.11.2"><span class="ltx_text" id="S6.T16.13.11.22.11.2.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td ltx_nopad_r" id="S6.T16.13.11.22.11.3"></td>
<td class="ltx_td ltx_nopad_l ltx_align_center" id="S6.T16.13.11.22.11.4"><span class="ltx_text" id="S6.T16.13.11.22.11.4.1" style="font-size:80%;">0.633</span></td>
<td class="ltx_td ltx_nopad_l ltx_align_center" id="S6.T16.13.11.22.11.5"><span class="ltx_text" id="S6.T16.13.11.22.11.5.1" style="font-size:80%;">0.228</span></td>
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.22.11.6"><span class="ltx_text" id="S6.T16.13.11.22.11.6.1" style="font-size:80%;">0.126</span></td>
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.22.11.7"><span class="ltx_text" id="S6.T16.13.11.22.11.7.1" style="font-size:80%;">0.114</span></td>
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.22.11.8"><span class="ltx_text" id="S6.T16.13.11.22.11.8.1" style="font-size:80%;">0.098</span></td>
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.22.11.9"><span class="ltx_text" id="S6.T16.13.11.22.11.9.1" style="font-size:80%;">0.097</span></td>
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.22.11.10"><span class="ltx_text" id="S6.T16.13.11.22.11.10.1" style="font-size:80%;">0.084</span></td>
<td class="ltx_td ltx_align_center" id="S6.T16.13.11.22.11.11"><span class="ltx_text" id="S6.T16.13.11.22.11.11.1" style="font-size:80%;">0.119</span></td>
</tr>
<tr class="ltx_tr" id="S6.T16.13.11.23.12">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T16.13.11.23.12.1"><span class="ltx_text" id="S6.T16.13.11.23.12.1.1" style="font-size:80%;">40ms</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T16.13.11.23.12.2"><span class="ltx_text" id="S6.T16.13.11.23.12.2.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td ltx_nopad_r ltx_border_bb" id="S6.T16.13.11.23.12.3"></td>
<td class="ltx_td ltx_nopad_l ltx_align_center ltx_border_bb" id="S6.T16.13.11.23.12.4"><span class="ltx_text" id="S6.T16.13.11.23.12.4.1" style="font-size:80%;">0.450</span></td>
<td class="ltx_td ltx_nopad_l ltx_align_center ltx_border_bb" id="S6.T16.13.11.23.12.5"><span class="ltx_text" id="S6.T16.13.11.23.12.5.1" style="font-size:80%;">0.197</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T16.13.11.23.12.6"><span class="ltx_text" id="S6.T16.13.11.23.12.6.1" style="font-size:80%;">0.120</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T16.13.11.23.12.7"><span class="ltx_text" id="S6.T16.13.11.23.12.7.1" style="font-size:80%;">0.113</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T16.13.11.23.12.8"><span class="ltx_text" id="S6.T16.13.11.23.12.8.1" style="font-size:80%;">0.104</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T16.13.11.23.12.9"><span class="ltx_text" id="S6.T16.13.11.23.12.9.1" style="font-size:80%;">0.102</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T16.13.11.23.12.10"><span class="ltx_text" id="S6.T16.13.11.23.12.10.1" style="font-size:80%;">0.086</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T16.13.11.23.12.11"><span class="ltx_text" id="S6.T16.13.11.23.12.11.1" style="font-size:80%;">0.112</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_paragraph" id="S6.SS4.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">Discussion on generative audio watermarking.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S6.SS4.SSS0.Px3.p1">
<p class="ltx_p" id="S6.SS4.SSS0.Px3.p1.1">The lack of idempotence is problematic for
the aforementioned sampling-based watermarking methods, as it affects the reliability of the detector when measuring the sampling bias. Noticeably, in order for these methods to work properly, the n-tuples that gives the context to the hash key must be stable enough during several consecutive tokens. Reducing the context length improves the stability but drastically increases the likelihood of producing degenerated audio sequences, similar to the degeneration problem observed by <cite class="ltx_cite ltx_citemacro_citep">(Holtzman et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib41" title="">2019</a>)</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S6.SS4.SSS0.Px3.p2">
<p class="ltx_p" id="S6.SS4.SSS0.Px3.p2.1">While we regard this attempt of employing text-based watermarking as a negative result, hereafter we discuss a few potential ways for circumventing the aforementioned problem of token stability though re-encoding:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul class="ltx_itemize" id="S6.I4">
<li class="ltx_item" id="S6.I4.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S6.I4.i1.p1">
<p class="ltx_p" id="S6.I4.i1.p1.1">Marking only the RQ first levels improves the stability. In our preliminary experiments, using these indices as context in the hash function, and limiting the dependence on previous timestamps, significantly increases the stability (although not sufficiently). 
<br class="ltx_break"></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S6.I4.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S6.I4.i2.p1">
<p class="ltx_p" id="S6.I4.i2.p1.1">The idempotence could be improved by adding a specific loss in the discrete latent space, such that the audio tokens are stable through auto-encoding. 
<br class="ltx_break"></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S6.I4.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S6.I4.i3.p1">
<p class="ltx_p" id="S6.I4.i3.p1.1">Potentially this auto-encoding could be learned to be resilient to signal transformation, similar to what is proposed when learning image watermarking based on neural networks&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Zhu, <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib116" title="">2018</a>; Fernandez et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib28" title="">2022</a>)</cite>. In view of our analysis, adding some tolerance to moderate temporal shift is especially important. 
<br class="ltx_break"></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S6.I4.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S6.I4.i4.p1">
<p class="ltx_p" id="S6.I4.i4.p1.1">The text could be marked instead of the audio. One downside is that text is a lower-capacity channel for adding a mark, and would not be sufficient for short conversations. Another problem is that detecting the mark requires a reliable transcription.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ul>
<p class="ltx_p" id="S6.SS4.SSS0.Px3.p2.2">Last but not least, some exploration is needed to ensure that it is not trivial to remove the watermarking procedure when open-sourcing a model. As an example, the only thing to remove the watermark with the implementation associated with the stable diffusion model was to comment a line of code.<span class="ltx_note ltx_role_footnote" id="footnote23"><sup class="ltx_note_mark">23</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">23</sup><span class="ltx_tag ltx_tag_note">23</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/Stability-AI/stablediffusion/blob/main/scripts/txt2img.py#L363" title="">https://github.com/Stability-AI/stablediffusion/blob/main/scripts/txt2img.py#L363</a></span></span></span>
A promising work in this direction is the study by <cite class="ltx_cite ltx_citemacro_cite">Sander et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib85" title="">2024</a>)</cite>, who show that it is possible to detect when a model has been trained on watermarked text.
A method exploiting this observation has just been shared by <cite class="ltx_cite ltx_citemacro_cite">San&nbsp;Roman et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib83" title="">2024a</a>)</cite>: the watermarking is implicitly added through the training data, in the spirit of “radioactive data” by <cite class="ltx_cite ltx_citemacro_cite">Sablayrolles et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib80" title="">2020</a>)</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S7">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Conclusion</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S7.p1">
<p class="ltx_p" id="S7.p1.1">In this work, we introduce Moshi, the first real-time, full-duplex spoken dialogue system. The first component of Moshi is Helium, a 7B parameter text LLM which is competitive with open-weights models trained with a similar compute budget. To encode audio into discrete units amenable to language modeling, we introduce Mimi, a semantic-acoustic neural audio codec which provides state-of-the-art audio quality at low bitrates while operating at low framerates compatible with real-time generation. We then introduce a new, hierarchical multi-stream architecture that supports generating arbitrary conversations in a speech-to-speech manner. We moreover show that speech-to-speech generation can be drastically improved by Inner Monologue, a new method that generates text tokens as a prefix to audio tokens, while remaining compatible with streaming inference. Our experiments show that Moshi demonstrates state-of-the-art spoken question answering and dialogue modeling while displaying satisfying levels of safety by not generating toxic content and remaining consistent in its voice. To summarize, we introduce a complete suite of models and recipes, from text LLMs to neural audio codecs and generative audio models, which we combine into a real-time spoken dialogue system with a 160ms theoretical latency able to follow complex multi-turn conversations across 5 minutes. We release both Mimi and Moshi to foster the development of such applications. Additionally, we show how our Inner Monologue method allows designing streaming TTS and streaming ASR just by changing the delay between text and audio tokens. We believe that both Inner Monologue and multi-stream modeling will have a positive impact on speech-to-speech and audio-to-audio beyond dialogue modeling.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S7.p2">
<br class="ltx_break">
<p class="ltx_p" id="S7.p2.1"><span class="ltx_text ltx_font_bold" id="S7.p2.1.1" style="font-size:120%;">Acknowledgments and Disclosure of Funding</span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S7.p3">
<p class="ltx_p" id="S7.p3.1">This project is funded by Iliad Group, CMA CGM Group and Schmidt Sciences. We thank Xavier Niel, Rodolphe Saadé, Eric Schmidt, Aude Durand, Séverine Grégoire and Nicolas Granatino, for their support; as well as Sarah Hôte and Guillaume Rouzaud at Kyutai for their help. We also thank Alice, the voice artist who strived to give Moshi online demo its voice, Elie Raffier who built the user interface for this demo, and Hugging Face for inference compute donation. Audio training data set was built with the help of Noatune Studios and Landospeech. Model training was conducted at Scaleway.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S7.p4">
<br class="ltx_break">
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Aaronson and Kirchner (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Scott Aaronson and Hendrik Kirchner.

</span>
<span class="ltx_bibblock">Watermarking gpt outputs, 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.scottaaronson.com/talks/watermark.ppt" title="">https://www.scottaaronson.com/talks/watermark.ppt</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Almazrouei et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Ebtesam Almazrouei, Hamza Alobeidli, Abdulaziz Alshamsi, Alessandro Cappelli, Ruxandra Cojocaru, Mérouane Debbah, Étienne Goffinet, Daniel Hesslow, Julien Launay, Quentin Malartic, et&nbsp;al.

</span>
<span class="ltx_bibblock">The falcon series of open language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">arXiv preprint arXiv:2311.16867</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Baevski et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Alexei Baevski, Henry Zhou, Abdelrahman Mohamed, and Michael Auli.

</span>
<span class="ltx_bibblock">wav2vec 2.0: A framework for self-supervised learning of speech representations.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">arXiv:2006.11477</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Berant et&nbsp;al. (2013)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jonathan Berant, Andrew&nbsp;K. Chou, Roy Frostig, and Percy Liang.

</span>
<span class="ltx_bibblock">Semantic parsing on freebase from question-answer pairs.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">Conference on Empirical Methods in Natural Language Processing</em>, 2013.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bisk et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yonatan Bisk, Rowan Zellers, Jianfeng Gao, Yejin Choi, et&nbsp;al.

</span>
<span class="ltx_bibblock">Piqa: Reasoning about physical commonsense in natural language.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">Proceedings of the AAAI conference on artificial intelligence</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Borsos et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Zalán Borsos, Raphaël Marinier, Damien Vincent, Eugene Kharitonov, Olivier Pietquin, Matthew Sharifi, Dominik Roblek, Olivier Teboul, David Grangier, Marco Tagliasacchi, and Neil Zeghidour.

</span>
<span class="ltx_bibblock">Audiolm: A language modeling approach to audio generation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">IEEE/ACM Transactions on Audio, Speech, and Language Processing</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Borsos et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Zalán Borsos, Matthew Sharifi, Damien Vincent, Eugene Kharitonov, Neil Zeghidour, and Marco Tagliasacchi.

</span>
<span class="ltx_bibblock">Soundstorm: Efficient parallel audio generation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">CoRR</em>, abs/2305.09636, 2023.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.48550/ARXIV.2305.09636</span>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bredin (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Hervé Bredin.

</span>
<span class="ltx_bibblock">pyannote.audio 2.1 speaker diarization pipeline: principle, benchmark, and recipe.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">Proc. INTERSPEECH 2023</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brown et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Tom&nbsp;B. Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared Kaplan, Prafulla Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda Askell, Sandhini Agarwal, Ariel Herbert-Voss, Gretchen Krueger, Tom Henighan, Rewon Child, Aditya Ramesh, Daniel&nbsp;M. Ziegler, Jeffrey Wu, Clemens Winter, Christopher Hesse, Mark Chen, Eric Sigler, Mateusz Litwin, Scott Gray, Benjamin Chess, Jack Clark, Christopher Berner, Sam McCandlish, Alec Radford, Ilya Sutskever, and Dario Amodei.

</span>
<span class="ltx_bibblock">Language models are few-shot learners.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">Advances in Neural Information Processing Systems (NeurIPS)</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Carlini et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Nicholas Carlini, Daphne Ippolito, Matthew Jagielski, Katherine Lee, Florian Tramer, and Chiyuan Zhang.

</span>
<span class="ltx_bibblock">Quantifying memorization across neural language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">arXiv preprint arXiv:2202.07646</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Çetin and Shriberg (2006)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Özgür Çetin and Elizabeth Shriberg.

</span>
<span class="ltx_bibblock">Analysis of overlaps in meetings by dialog factors, hot spots, speakers, and collection site: insights for automatic speech recognition.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">Ninth International Conference on Spoken Language Processing, INTERSPEECH-ICSLP 2006, Pittsburgh, PA, USA, September 17-21, 2006</em>. ISCA, 2006.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Sanyuan Chen, Chengyi Wang, Zhengyang Chen, Yu&nbsp;Wu, Shujie Liu, Zhuo Chen, Jinyu Li, Naoyuki Kanda, Takuya Yoshioka, Xiong Xiao, Jian Wu, Long Zhou, Shuo Ren, Yanmin Qian, Yao Qian, Jian Wu, Michael Zeng, Xiangzhan Yu, and Furu Wei.

</span>
<span class="ltx_bibblock">Wavlm: Large-scale self-supervised pre-training for full stack speech processing.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">IEEE J. Sel. Top. Signal Process.</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chowdhery et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Aakanksha Chowdhery, Sharan Narang, Jacob Devlin, Maarten Bosma, Gaurav Mishra, Adam Roberts, Paul Barham, Hyung&nbsp;Won Chung, Charles Sutton, Sebastian Gehrmann, Parker Schuh, Kensen Shi, Sasha Tsvyashchenko, Joshua Maynez, Abhishek&nbsp;B Rao, Parker Barnes, Yi&nbsp;Tay, Noam&nbsp;M. Shazeer, Vinodkumar Prabhakaran, Emily Reif, Nan Du, Benton&nbsp;C. Hutchinson, Reiner Pope, James Bradbury, Jacob Austin, Michael Isard, Guy Gur-Ari, Pengcheng Yin, Toju Duke, Anselm Levskaya, Sanjay Ghemawat, Sunipa Dev, Henryk Michalewski, Xavier García, Vedant Misra, Kevin Robinson, Liam Fedus, Denny Zhou, Daphne Ippolito, David Luan, Hyeontaek Lim, Barret Zoph, Alexander Spiridonov, Ryan Sepassi, David Dohan, Shivani Agrawal, Mark Omernick, Andrew&nbsp;M. Dai, Thanumalayan&nbsp;Sankaranarayana Pillai, Marie Pellat, Aitor Lewkowycz, Erica&nbsp;Oliveira Moreira, Rewon Child, Oleksandr Polozov, Katherine Lee, Zongwei Zhou, Xuezhi Wang, Brennan Saeta, Mark Díaz, Orhan Firat, Michele Catasta, Jason Wei, Kathleen&nbsp;S. Meier-Hellstern, Douglas Eck, Jeff Dean,
Slav Petrov, and Noah Fiedel.

</span>
<span class="ltx_bibblock">PaLM: Scaling language modeling with Pathways.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">arXiv:2204.02311</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chung et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yu-An Chung, Yu&nbsp;Zhang, Wei Han, Chung-Cheng Chiu, James Qin, Ruoming Pang, and Yonghui Wu.

</span>
<span class="ltx_bibblock">w2v-bert: Combining contrastive learning and masked language modeling for self-supervised speech pre-training.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">IEEE Automatic Speech Recognition and Understanding Workshop, ASRU</em>. IEEE, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cieri et&nbsp;al. (2004)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Christopher Cieri, David Miller, and Kevin Walker.

</span>
<span class="ltx_bibblock">Fisher english training speech parts 1 and 2.

</span>
<span class="ltx_bibblock">https://doi.org/10.35111/da4a-se30, 2004.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Clark et&nbsp;al. (2018)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Peter Clark, Isaac Cowhey, Oren Etzioni, Tushar Khot, Ashish Sabharwal, Carissa Schoenick, and Oyvind Tafjord.

</span>
<span class="ltx_bibblock">Think you have solved question answering? try arc, the ai2 reasoning challenge.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">arXiv preprint arXiv:1803.05457</em>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Clevert et&nbsp;al. (2016)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Djork-Arné Clevert, Thomas Unterthiner, and Sepp Hochreiter.

</span>
<span class="ltx_bibblock">Fast and accurate deep network learning by exponential linear units (elus).

</span>
<span class="ltx_bibblock">In Yoshua Bengio and Yann LeCun, editors, <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">4th International Conference on Learning Representations, ICLR 2016, San Juan, Puerto Rico, May 2-4, 2016, Conference Track Proceedings</em>, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Copet et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jade Copet, Felix Kreuk, Itai Gat, Tal Remez, David Kant, Gabriel Synnaeve, Yossi Adi, and Alexandre Défossez.

</span>
<span class="ltx_bibblock">Simple and controllable music generation.

</span>
<span class="ltx_bibblock">In Alice Oh, Tristan Naumann, Amir Globerson, Kate Saenko, Moritz Hardt, and Sergey Levine, editors, <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">Advances in Neural Information Processing Systems 36: Annual Conference on Neural Information Processing Systems 2023, NeurIPS 2023, New Orleans, LA, USA, December 10 - 16, 2023</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dao et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Tri Dao, Dan Fu, Stefano Ermon, Atri Rudra, and Christopher Ré.

</span>
<span class="ltx_bibblock">Flashattention: Fast and memory-efficient exact attention with io-awareness.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">Advances in Neural Information Processing Systems</em>, 35:16344–16359, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Defossez et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Alexandre Defossez, Gabriel Synnaeve, and Yossi Adi.

</span>
<span class="ltx_bibblock">Real time speech enhancement in the waveform domain.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">Interspeech</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Défossez et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Alexandre Défossez, Jade Copet, Gabriel Synnaeve, and Yossi Adi.

</span>
<span class="ltx_bibblock">High fidelity neural audio compression.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">Transactions on Machine Learning Research</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dettmers and Zettlemoyer (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Tim Dettmers and Luke Zettlemoyer.

</span>
<span class="ltx_bibblock">The case for 4-bit precision: k-bit inference scaling laws.

</span>
<span class="ltx_bibblock">In Andreas Krause, Emma Brunskill, Kyunghyun Cho, Barbara Engelhardt, Sivan Sabato, and Jonathan Scarlett, editors, <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">Proceedings of the 40th International Conference on Machine Learning</em>, volume 202 of <em class="ltx_emph ltx_font_italic" id="bib.bib22.2.2">Proceedings of Machine Learning Research</em>, pages 7750–7774. PMLR, 23–29 Jul 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dettmers et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Tim Dettmers, Mike Lewis, Younes Belkada, and Luke Zettlemoyer.

</span>
<span class="ltx_bibblock">LLM.int8(): 8-bit matrix multiplication for transformers at scale.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">NeurIPS</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Devlin et&nbsp;al. (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova.

</span>
<span class="ltx_bibblock">BERT: pre-training of deep bidirectional transformers for language understanding.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies, NAACL-HLT)</em>, pages 4171–4186. Association for Computational Linguistics, 2019.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.18653/v1/n19-1423</span>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dubey et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Harishchandra Dubey, Ashkan Aazami, Vishak Gopal, Babak Naderi, Sebastian Braun, Ross Cutler, Hannes Gamper, Mehrsa Golestaneh, and Robert Aichner.

</span>
<span class="ltx_bibblock">Icassp 2023 deep noise suppression challenge.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">ICASSP</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dunbar et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Ewan Dunbar, Mathieu Bernard, Nicolas Hamilakis, Tu&nbsp;Anh Nguyen, Maureen de&nbsp;Seyssel, Patricia Rozé, Morgane Rivière, Eugene Kharitonov, and Emmanuel Dupoux.

</span>
<span class="ltx_bibblock">The zero resource speech challenge 2021: Spoken language modelling.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">Interspeech</em>. ISCA, 2021.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.21437/Interspeech.2021-1755</span>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Evans et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Zach Evans, Julian&nbsp;D Parker, CJ&nbsp;Carr, Zack Zukowski, Josiah Taylor, and Jordi Pons.

</span>
<span class="ltx_bibblock">Stable audio open.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">arXiv preprint arXiv:2407.14358</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fernandez et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Pierre Fernandez, Alexandre Sablayrolles, Teddy Furon, Hervé Jégou, and Matthijs Douze.

</span>
<span class="ltx_bibblock">Watermarking images in self-supervised latent spaces.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP)</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fernandez et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Pierre Fernandez, Antoine Chaffin, Karim Tit, Vivien Chappelier, and Teddy Furon.

</span>
<span class="ltx_bibblock">Three bricks to consolidate watermarks for large language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">Proc. International Workshop on Information Forensics and Security (WIFS)</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Frantar et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Elias Frantar, Saleh Ashkboos, Torsten Hoefler, and Dan Alistarh.

</span>
<span class="ltx_bibblock">OPTQ: Accurate post-training quantization for generative pre-trained transformers.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">ICLR</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gemini et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Team Gemini, Rohan Anil, Sebastian Borgeaud, Yonghui Wu, Jean-Baptiste Alayrac, Jiahui Yu, Radu Soricut, Johan Schalkwyk, Andrew&nbsp;M Dai, Anja Hauth, et&nbsp;al.

</span>
<span class="ltx_bibblock">Gemini: a family of highly capable multimodal models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">arXiv preprint arXiv:2312.11805</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Groeneveld et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Dirk Groeneveld, Iz&nbsp;Beltagy, Pete Walsh, Akshita Bhagia, Rodney Kinney, Oyvind Tafjord, Ananya&nbsp;Harsh Jha, Hamish Ivison, Ian Magnusson, Yizhong Wang, Shane Arora, David Atkinson, Russell Authur, Khyathi Chandu, Arman Cohan, Jennifer Dumas, Yanai Elazar, Yuling Gu, Jack Hessel, Tushar Khot, William Merrill, Jacob Morrison, Niklas Muennighoff, Aakanksha Naik, Crystal Nam, Matthew&nbsp;E. Peters, Valentina Pyatkin, Abhilasha Ravichander, Dustin Schwenk, Saurabh Shah, Will Smith, Nishant Subramani, Mitchell Wortsman, Pradeep Dasigi, Nathan Lambert, Kyle Richardson, Jesse Dodge, Kyle Lo, Luca Soldaini, Noah&nbsp;A. Smith, and Hannaneh Hajishirzi.

</span>
<span class="ltx_bibblock">Olmo: Accelerating the science of language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">Preprint</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hassid et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Michael Hassid, Tal Remez, Tu&nbsp;Anh Nguyen, Itai Gat, Alexis Conneau, Felix Kreuk, Jade Copet, Alexandre Défossez, Gabriel Synnaeve, Emmanuel Dupoux, Roy Schwartz, and Yossi Adi.

</span>
<span class="ltx_bibblock">Textually pretrained speech language models.

</span>
<span class="ltx_bibblock">In Alice Oh, Tristan Naumann, Amir Globerson, Kate Saenko, Moritz Hardt, and Sergey Levine, editors, <em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">Advances in Neural Information Processing Systems 36: Annual Conference on Neural Information Processing Systems 2023, NeurIPS 2023, New Orleans, LA, USA, December 10 - 16, 2023</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hauret et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Julien Hauret, Thomas Joubaud, Véronique Zimpfer, and Éric Bavu.

</span>
<span class="ltx_bibblock">Eben: Extreme bandwidth extension network applied to speech signals captured with noise-resilient body-conduction microphones.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">ICASSP 2023-2023 IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP)</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hendrycks and Gimpel (2016a)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Dan Hendrycks and Kevin Gimpel.

</span>
<span class="ltx_bibblock">Bridging nonlinearities and stochastic regularizers with gaussian error linear units.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">CoRR</em>, abs/1606.08415, 2016a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hendrycks and Gimpel (2016b)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Dan Hendrycks and Kevin Gimpel.

</span>
<span class="ltx_bibblock">Gaussian error linear units (gelus).

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">arXiv preprint arXiv:1606.08415</em>, 2016b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hendrycks et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Dan Hendrycks, Collin Burns, Steven Basart, Andy Zou, Mantas Mazeika, Dawn Song, and Jacob Steinhardt.

</span>
<span class="ltx_bibblock">Measuring massive multitask language understanding.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">arXiv preprint arXiv:2009.03300</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hines et&nbsp;al. (2015)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Andrew Hines, Jan Skoglund, Anil&nbsp;C Kokaram, and Naomi Harte.

</span>
<span class="ltx_bibblock">ViSQOL: an objective speech quality model.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">EURASIP Journal on Audio, Speech, and Music Processing</em>, 2015(1):1–18, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ho et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jonathan Ho, Ajay Jain, and Pieter Abbeel.

</span>
<span class="ltx_bibblock">Denoising diffusion probabilistic models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">Advances in neural information processing systems</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hoffmann et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jordan Hoffmann, Sebastian Borgeaud, Arthur Mensch, Elena Buchatskaya, Trevor Cai, Eliza Rutherford, Diego de&nbsp;Las&nbsp;Casas, Lisa&nbsp;Anne Hendricks, Johannes Welbl, Aidan Clark, Tom Hennigan, Eric Noland, Katie Millican, George van&nbsp;den Driessche, Bogdan Damoc, Aurelia Guy, Simon Osindero, Karen Simonyan, Erich Elsen, Jack&nbsp;W. Rae, Oriol Vinyals, and Laurent Sifre.

</span>
<span class="ltx_bibblock">Training compute-optimal large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">CoRR</em>, abs/2203.15556, 2022.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.48550/ARXIV.2203.15556</span>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Holtzman et&nbsp;al. (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Ari Holtzman, Jan Buys, Li&nbsp;Du, Maxwell Forbes, and Yejin Choi.

</span>
<span class="ltx_bibblock">The curious case of neural text degeneration.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">arXiv preprint arXiv:1904.09751</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hsu et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Wei-Ning Hsu, Benjamin Bolte, Yao-Hung&nbsp;Hubert Tsai, Kushal Lakhotia, Ruslan Salakhutdinov, and Abdelrahman Mohamed.

</span>
<span class="ltx_bibblock">Hubert: Self-supervised speech representation learning by masked prediction of hidden units.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">IEEE ACM Trans. Audio Speech Lang. Process.</em>, 29, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Joshi et&nbsp;al. (2017)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Mandar Joshi, Eunsol Choi, Daniel&nbsp;S Weld, and Luke Zettlemoyer.

</span>
<span class="ltx_bibblock">Triviaqa: A large scale distantly supervised challenge dataset for reading comprehension.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">arXiv preprint arXiv:1705.03551</em>, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Joulin et&nbsp;al. (2016)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Armand Joulin, Edouard Grave, Piotr Bojanowski, and Tomas Mikolov.

</span>
<span class="ltx_bibblock">Bag of tricks for efficient text classification.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">arXiv preprint arXiv:1607.01759</em>, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ju et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Zeqian Ju, Yuancheng Wang, Kai Shen, Xu&nbsp;Tan, Detai Xin, Dongchao Yang, Yanqing Liu, Yichong Leng, Kaitao Song, Siliang Tang, et&nbsp;al.

</span>
<span class="ltx_bibblock">Naturalspeech 3: Zero-shot speech synthesis with factorized codec and diffusion models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">arXiv preprint arXiv:2403.03100</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kahn et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jacob Kahn, Morgane Rivière, Weiyi Zheng, Evgeny Kharitonov, Qiantong Xu, Pierre-Emmanuel Mazaré, Julien Karadayi, Vitaliy Liptchinsky, Ronan Collobert, Christian Fuegen, Tatiana Likhomanenko, Gabriel Synnaeve, Armand Joulin, Abdelrahman Mohamed, and Emmanuel Dupoux.

</span>
<span class="ltx_bibblock">Libri-light: A benchmark for ASR with limited or no supervision.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib46.1.1">IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP)</em>, pages 7669–7673. IEEE, 2020.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1109/ICASSP40776.2020.9052942</span>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kharitonov et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Eugene Kharitonov, Damien Vincent, Zalán Borsos, Raphaël Marinier, Sertan Girgin, Olivier Pietquin, Matt Sharifi, Marco Tagliasacchi, and Neil Zeghidour.

</span>
<span class="ltx_bibblock">Speak, read and prompt: High-fidelity text-to-speech with minimal supervision.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib47.1.1">Trans. Assoc. Comput. Linguistics</em>, 11:1703–1718, 2023.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1162/TACL“˙A“˙00618</span>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kingma and Ba (2015)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Diederik&nbsp;P. Kingma and Jimmy Ba.

</span>
<span class="ltx_bibblock">Adam: A method for stochastic optimization.

</span>
<span class="ltx_bibblock">In Yoshua Bengio and Yann LeCun, editors, <em class="ltx_emph ltx_font_italic" id="bib.bib48.1.1">3rd International Conference on Learning Representations</em>, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kirchenbauer et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
John Kirchenbauer, Jonas Geiping, Yuxin Wen, Jonathan Katz, Ian Miers, and Tom Goldstein.

</span>
<span class="ltx_bibblock">A watermark for large language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib49.1.1">International Conference on Machine Learning</em>. PMLR, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kudo and Richardson (2018)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Taku Kudo and John Richardson.

</span>
<span class="ltx_bibblock">Sentencepiece: A simple and language independent subword tokenizer and detokenizer for neural text processing.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib50.1.1">arXiv preprint arXiv:1808.06226</em>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kumar et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Rithesh Kumar, Prem Seetharaman, Alejandro Luebs, Ishaan Kumar, and Kundan Kumar.

</span>
<span class="ltx_bibblock">High-fidelity audio compression with improved RVQGAN.

</span>
<span class="ltx_bibblock">In Alice Oh, Tristan Naumann, Amir Globerson, Kate Saenko, Moritz Hardt, and Sergey Levine, editors, <em class="ltx_emph ltx_font_italic" id="bib.bib51.1.1">Advances in Neural Information Processing Systems 36</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kumar et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Rithesh Kumar, Prem Seetharaman, Alejandro Luebs, Ishaan Kumar, and Kundan Kumar.

</span>
<span class="ltx_bibblock">High-fidelity audio compression with improved rvqgan.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib52.1.1">Advances in Neural Information Processing Systems</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kwiatkowski et&nbsp;al. (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Tom Kwiatkowski, Jennimaria Palomaki, Olivia Redfield, Michael Collins, Ankur Parikh, Chris Alberti, Danielle Epstein, Illia Polosukhin, Jacob Devlin, Kenton Lee, et&nbsp;al.

</span>
<span class="ltx_bibblock">Natural questions: a benchmark for question answering research.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib53.1.1">Transactions of the Association for Computational Linguistics</em>, 7:453–466, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lakhotia et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Kushal Lakhotia, Eugene Kharitonov, Wei-Ning Hsu, Yossi Adi, Adam Polyak, Benjamin Bolte, Tu-Anh Nguyen, Jade Copet, Alexei Baevski, Abdelrahman Mohamed, et&nbsp;al.

</span>
<span class="ltx_bibblock">On generative spoken language modeling from raw audio.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib54.1.1">Transactions of the Association for Computational Linguistics</em>, 9:1336–1354, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lee et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Doyup Lee, Chiheon Kim, Saehoon Kim, Minsu Cho, and Wook-Shin Han.

</span>
<span class="ltx_bibblock">Autoregressive image generation using residual quantization.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib55.1.1">IEEE/CVF Conference on Computer Vision and Pattern Recognition, CVPR 2022, New Orleans, LA, USA, June 18-24, 2022</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lemercier et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jean-Marie Lemercier, Simon Rouard, Jade Copet, Yossi Adi, and Alexandre Défossez.

</span>
<span class="ltx_bibblock">An independence-promoting loss for music generation with language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib56.1.1">ICML</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib57">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et&nbsp;al. (2023a)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Haohe Liu, Ke&nbsp;Chen, Qiao Tian, Wenwu Wang, and Mark&nbsp;D Plumbley.

</span>
<span class="ltx_bibblock">AudioSR: Versatile audio super-resolution at scale.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib57.1.1">arXiv preprint arXiv:2309.07314</em>, 2023a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib58">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et&nbsp;al. (2023b)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Haohe Liu, Zehua Chen, Yi&nbsp;Yuan, Xinhao Mei, Xubo Liu, Danilo Mandic, Wenwu Wang, and Mark&nbsp;D Plumbley.

</span>
<span class="ltx_bibblock">AudioLDM: Text-to-audio generation with latent diffusion models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib58.1.1">Proceedings of the International Conference on Machine Learning</em>, 2023b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib59">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Haohe Liu, Xuenan Xu, Yi&nbsp;Yuan, Mengyue Wu, Wenwu Wang, and Mark&nbsp;D Plumbley.

</span>
<span class="ltx_bibblock">Semanticodec: An ultra low bitrate semantic audio codec for general sound.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib59.1.1">arXiv preprint arXiv:2405.00233</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib60">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Llama (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Team Llama.

</span>
<span class="ltx_bibblock">The llama 3 herd of models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib60.1.1">preprint</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib61">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lo et&nbsp;al. (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Chen-Chou Lo, Szu-Wei Fu, Wen-Chin Huang, Xin Wang, Junichi Yamagishi, Yu&nbsp;Tsao, and Hsin-Min Wang.

</span>
<span class="ltx_bibblock">Mosnet: Deep learning based objective assessment for voice conversion.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib61.1.1">Proc. Interspeech 2019</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib62">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Loshchilov and Hutter (2016)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Ilya Loshchilov and Frank Hutter.

</span>
<span class="ltx_bibblock">Sgdr: Stochastic gradient descent with warm restarts.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib62.1.1">arXiv preprint arXiv:1608.03983</em>, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib63">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Loshchilov and Hutter (2017)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Ilya Loshchilov and Frank Hutter.

</span>
<span class="ltx_bibblock">Decoupled weight decay regularization.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib63.1.1">arXiv preprint arXiv:1711.05101</em>, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib64">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Loshchilov and Hutter (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Ilya Loshchilov and Frank Hutter.

</span>
<span class="ltx_bibblock">Decoupled weight decay regularization.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib64.1.1">7th International Conference on Learning Representations, ICLR 2019, New Orleans, LA, USA, May 6-9, 2019</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib65">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Louradour (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jérôme Louradour.

</span>
<span class="ltx_bibblock">whisper-timestamped.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/linto-ai/whisper-timestamped" title="">https://github.com/linto-ai/whisper-timestamped</a>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib66">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Maiti et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Soumi Maiti, Yifan Peng, Shukjae Choi, Jee weon Jung, Xuankai Chang, and Shinji Watanabe.

</span>
<span class="ltx_bibblock">Voxtlm: unified decoder-only models for consolidating speech recognition/synthesis and speech/text continuation tasks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib66.1.1">ArXiv</em>, abs/2309.07937, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib67">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mihaylov et&nbsp;al. (2018)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Todor Mihaylov, Peter Clark, Tushar Khot, and Ashish Sabharwal.

</span>
<span class="ltx_bibblock">Can a suit of armor conduct electricity? a new dataset for open book question answering.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib67.1.1">arXiv preprint arXiv:1809.02789</em>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib68">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mitsui et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Kentaro Mitsui, Koh Mitsuda, Toshiaki Wakatsuki, Yukiya Hono, and Kei Sawada.

</span>
<span class="ltx_bibblock">Pslm: Parallel generation of text and speech with llms for low-latency spoken dialogue systems, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib69">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nachmani et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Eliya Nachmani, Alon Levkovitch, Roy Hirsch, Julian Salazar, Chulayuth Asawaroengchai, Soroosh Mariooryad, Ehud Rivlin, RJ&nbsp;Skerry-Ryan, and Michelle&nbsp;Tadmor Ramanovich.

</span>
<span class="ltx_bibblock">Spoken question answering and speech continuation using spectrogram-powered LLM.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib69.1.1">The Twelfth International Conference on Learning Representations</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib70">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nagel et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Markus Nagel, Marios Fournarakis, Rana&nbsp;Ali Amjad, Yelysei Bondarenko, Mart van Baalen, and Tijmen Blankevoort.

</span>
<span class="ltx_bibblock">A white paper on neural network quantization, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib71">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nguyen et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Tu&nbsp;Anh Nguyen, Eugene Kharitonov, Jade Copet, Yossi Adi, Wei-Ning Hsu, Ali Elkahky, Paden Tomasello, Robin Algayres, Benoît Sagot, Abdelrahman Mohamed, and Emmanuel Dupoux.

</span>
<span class="ltx_bibblock">Generative spoken dialogue language modeling.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib71.1.1">Transactions of the Association for Computational Linguistics</em>, 11:250–266, 2023.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1162/tacl˙a˙00545</span>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib72">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nguyen et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Tu&nbsp;Anh Nguyen, Benjamin Muller, Bokai Yu, Marta&nbsp;R. Costa-jussà, Maha Elbayad, Sravya Popuri, Paul-Ambroise Duquenne, Robin Algayres, Ruslan Mavlyutov, Itai Gat, Gabriel Synnaeve, Juan Pino, Benoît Sagot, and Emmanuel Dupoux.

</span>
<span class="ltx_bibblock">Spirit-lm: Interleaved spoken and written language model.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib72.1.1">CoRR</em>, abs/2402.05755, 2024.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.48550/ARXIV.2402.05755</span>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib73">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Noroozi et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Vahid Noroozi, Somshubra Majumdar, Ankur Kumar, Jagadeesh Balam, and Boris Ginsburg.

</span>
<span class="ltx_bibblock">Stateful conformer with cache-based inference for streaming automatic speech recognition.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib73.1.1">ICASSP 2024-2024 IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP)</em>, pages 12041–12045. IEEE, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib74">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Panayotov et&nbsp;al. (2015)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Vassil Panayotov, Guoguo Chen, Daniel Povey, and Sanjeev Khudanpur.

</span>
<span class="ltx_bibblock">Librispeech: An ASR corpus based on public domain audio books.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib74.1.1">IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP)</em>, pages 5206–5210. IEEE, 2015.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1109/ICASSP.2015.7178964</span>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib75">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Radford et&nbsp;al. (2018)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Alec Radford, Karthik Narasimhan, Tim Salimans, Ilya Sutskever, et&nbsp;al.

</span>
<span class="ltx_bibblock">Improving language understanding by generative pre-training.

</span>
<span class="ltx_bibblock">Technical report, OpenAI, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib76">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Radford et&nbsp;al. (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Alec Radford, Jeff Wu, Rewon Child, David Luan, Dario Amodei, and Ilya Sutskever.

</span>
<span class="ltx_bibblock">Language models are unsupervised multitask learners.

</span>
<span class="ltx_bibblock">Technical report, OpenAI, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib77">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Radford et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Alec Radford, Jong&nbsp;Wook Kim, Tao Xu, Greg Brockman, Christine McLeavey, and Ilya Sutskever.

</span>
<span class="ltx_bibblock">Robust speech recognition via large-scale weak supervision.

</span>
<span class="ltx_bibblock">In Andreas Krause, Emma Brunskill, Kyunghyun Cho, Barbara Engelhardt, Sivan Sabato, and Jonathan Scarlett, editors, <em class="ltx_emph ltx_font_italic" id="bib.bib77.1.1">International Conference on Machine Learning, ICML 2023, 23-29 July 2023, Honolulu, Hawaii, USA</em>, volume 202 of <em class="ltx_emph ltx_font_italic" id="bib.bib77.2.2">Proceedings of Machine Learning Research</em>, pages 28492–28518. PMLR, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib78">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Reid et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Machel Reid, Nikolay Savinov, Denis Teplyashin, Dmitry Lepikhin, Timothy&nbsp;P. Lillicrap, Jean-Baptiste Alayrac, Radu Soricut, Angeliki Lazaridou, Orhan Firat, Julian Schrittwieser, Ioannis Antonoglou, Rohan Anil, Sebastian Borgeaud, Andrew&nbsp;M. Dai, Katie Millican, Ethan Dyer, Mia Glaese, Thibault Sottiaux, Benjamin Lee, Fabio Viola, Malcolm Reynolds, Yuanzhong Xu, James Molloy, Jilin Chen, Michael Isard, Paul Barham, Tom Hennigan, Ross McIlroy, Melvin Johnson, Johan Schalkwyk, Eli Collins, Eliza Rutherford, Erica Moreira, Kareem Ayoub, Megha Goel, Clemens Meyer, Gregory Thornton, Zhen Yang, Henryk Michalewski, Zaheer Abbas, Nathan Schucher, Ankesh Anand, Richard Ives, James Keeling, Karel Lenc, Salem Haykal, Siamak Shakeri, Pranav Shyam, Aakanksha Chowdhery, Roman Ring, Stephen Spencer, Eren Sezener, and et&nbsp;al.

</span>
<span class="ltx_bibblock">Gemini 1.5: Unlocking multimodal understanding across millions of tokens of context.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib78.1.1">CoRR</em>, abs/2403.05530, 2024.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.48550/ARXIV.2403.05530</span>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib79">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rubenstein et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Paul&nbsp;K. Rubenstein, Chulayuth Asawaroengchai, Duc&nbsp;Dung Nguyen, Ankur Bapna, Zalán Borsos, Félix de&nbsp;Chaumont&nbsp;Quitry, Peter Chen, Dalia&nbsp;El Badawy, Wei Han, Eugene Kharitonov, Hannah Muckenhirn, Dirk Padfield, James Qin, Danny Rozenberg, Tara&nbsp;N. Sainath, Johan Schalkwyk, Matthew Sharifi, Michelle&nbsp;Tadmor Ramanovich, Marco Tagliasacchi, Alexandru Tudor, Mihajlo Velimirovic, Damien Vincent, Jiahui Yu, Yongqiang Wang, Vicky Zayats, Neil Zeghidour, Yu&nbsp;Zhang, Zhishuai Zhang, Lukas Zilka, and Christian&nbsp;Havnø Frank.

</span>
<span class="ltx_bibblock">Audiopalm: A large language model that can speak and listen.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib79.1.1">CoRR</em>, abs/2306.12925, 2023.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.48550/ARXIV.2306.12925</span>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib80">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sablayrolles et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Alexandre Sablayrolles, Matthijs Douze, Cordelia Schmid, and Hervé Jégou.

</span>
<span class="ltx_bibblock">Radioactive data: tracing through training.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib80.1.1">International Conference on Machine Learning</em>, pages 8326–8335. PMLR, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib81">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sakaguchi et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Keisuke Sakaguchi, Ronan&nbsp;Le Bras, Chandra Bhagavatula, and Yejin Choi.

</span>
<span class="ltx_bibblock">Winogrande: An adversarial winograd schema challenge at scale.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib81.1.1">Communications of the ACM</em>, 64(9):99–106, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib82">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Salimans and Kingma (2016)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Tim Salimans and Diederik&nbsp;P. Kingma.

</span>
<span class="ltx_bibblock">Weight normalization: A simple reparameterization to accelerate training of deep neural networks.

</span>
<span class="ltx_bibblock">In Daniel&nbsp;D. Lee, Masashi Sugiyama, Ulrike von Luxburg, Isabelle Guyon, and Roman Garnett, editors, <em class="ltx_emph ltx_font_italic" id="bib.bib82.1.1">Advances in Neural Information Processing Systems 29</em>, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib83">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">San&nbsp;Roman et&nbsp;al. (2024a)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Robin San&nbsp;Roman, Pierre Fernandez, Antoine Deleforge, Yossi Adi, and Romain Serizel.

</span>
<span class="ltx_bibblock">Latent watermarking of audio generative models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib83.1.1">arXiv e-prints</em>, pages arXiv–2409, 2024a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib84">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">San&nbsp;Roman et&nbsp;al. (2024b)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Robin San&nbsp;Roman, Pierre Fernandez, Hady Elsahar, Alexandre Défossez, Teddy Furon, and Tuan Tran.

</span>
<span class="ltx_bibblock">Proactive detection of voice cloning with localized watermarking.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib84.1.1">International Conference on Machine Learning</em>, volume 235, 2024b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib85">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sander et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Tom Sander, Pierre Fernandez, Alain Durmus, Matthijs Douze, and Teddy Furon.

</span>
<span class="ltx_bibblock">Watermarking makes language models radioactive.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib85.1.1">arXiv preprint arXiv:2402.14904</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib86">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sap et&nbsp;al. (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Maarten Sap, Hannah Rashkin, Derek Chen, Ronan LeBras, and Yejin Choi.

</span>
<span class="ltx_bibblock">Socialiqa: Commonsense reasoning about social interactions.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib86.1.1">arXiv preprint arXiv:1904.09728</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib87">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schatz et&nbsp;al. (2013)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Thomas Schatz, Vijayaditya Peddinti, Francis&nbsp;R. Bach, Aren Jansen, Hynek Hermansky, and Emmanuel Dupoux.

</span>
<span class="ltx_bibblock">Evaluating speech features with the minimal-pair ABX task: analysis of the classical MFC/PLP pipeline.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib87.1.1">Interspeech</em>. ISCA, 2013.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib88">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shazeer (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Noam Shazeer.

</span>
<span class="ltx_bibblock">Glu variants improve transformer.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib88.1.1">arXiv preprint arXiv:2002.05202</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib89">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Stivers et&nbsp;al. (2009)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Tanya Stivers, Nick&nbsp;J. Enfield, Penelope Brown, Christina Englert, Makoto Hayashi, Trine Heinemann, Gertie Hoymann, Federico Rossano, Jan Peter&nbsp;De Ruiter, Kyung-Eun Yoon, Stephen&nbsp;C. Levinson, Paul Kay, and Krishna Y.

</span>
<span class="ltx_bibblock">Universals and cultural variation in turn-taking in conversation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib89.1.1">Proceedings of the National Academy of Sciences</em>, 106:10587 – 10592, 2009.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib90">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Su et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jianlin Su, Murtadha Ahmed, Yu&nbsp;Lu, Shengfeng Pan, Wen Bo, and Yunfeng Liu.

</span>
<span class="ltx_bibblock">Roformer: Enhanced transformer with rotary position embedding.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib90.1.1">Neurocomputing</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib91">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tagliasacchi et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Marco Tagliasacchi, Yunpeng Li, Karolis Misiunas, and Dominik Roblek.

</span>
<span class="ltx_bibblock">SEANet: A multi-modal speech enhancement network.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib91.1.1">Interspeech</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib92">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Team (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
MosaicML&nbsp;NLP Team.

</span>
<span class="ltx_bibblock">Introducing mpt-7b: A new standard for open-source, commercially usable llms, 2023.

</span>
<span class="ltx_bibblock">Accessed: 2023-05-05.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib93">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tedeschi et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Simone Tedeschi, Felix Friedrich, Patrick Schramowski, Kristian Kersting, Roberto Navigli, Huu Nguyen, and Bo&nbsp;Li.

</span>
<span class="ltx_bibblock">Alert: A comprehensive benchmark for assessing large language models’ safety through red teaming, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib94">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Teknium (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Teknium.

</span>
<span class="ltx_bibblock">Openhermes 2.5: An open dataset of synthetic data for generalist llm assistants, 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://huggingface.co/datasets/teknium/OpenHermes-2.5" title="">https://huggingface.co/datasets/teknium/OpenHermes-2.5</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib95">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Hugo Touvron, Matthieu Cord, Alexandre Sablayrolles, Gabriel Synnaeve, and Hervé Jégou.

</span>
<span class="ltx_bibblock">Going deeper with image transformers.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib95.1.1">2021 IEEE/CVF International Conference on Computer Vision, ICCV</em>, 2021.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1109/ICCV48922.2021.00010</span>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib96">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et&nbsp;al. (2023a)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Hugo Touvron, Thibaut Lavril, Gautier Izacard, Xavier Martinet, Marie-Anne Lachaux, Timothée Lacroix, Baptiste Rozière, Naman Goyal, Eric Hambro, Faisal Azhar, Aurélien Rodriguez, Armand Joulin, Edouard Grave, and Guillaume Lample.

</span>
<span class="ltx_bibblock">Llama: Open and efficient foundation language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib96.1.1">CoRR</em>, abs/2302.13971, 2023a.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.48550/ARXIV.2302.13971</span>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib97">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et&nbsp;al. (2023b)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Hugo Touvron, Louis Martin, Kevin Stone, Peter Albert, Amjad Almahairi, Yasmine Babaei, Nikolay Bashlykov, Soumya Batra, Prajjwal Bhargava, Shruti Bhosale, et&nbsp;al.

</span>
<span class="ltx_bibblock">Llama 2: Open foundation and fine-tuned chat models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib97.1.1">arXiv preprint arXiv:2307.09288</em>, 2023b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib98">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tseng et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Albert Tseng, Jerry Chee, Qingyao Sun, Volodymyr Kuleshov, and Christopher&nbsp;De Sa.

</span>
<span class="ltx_bibblock">Quip#: Even better llm quantization with hadamard incoherence and lattice codebooks.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib98.1.1">ICML</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib99">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">van&nbsp;den Oord et&nbsp;al. (2017)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Aäron van&nbsp;den Oord, Oriol Vinyals, and Koray Kavukcuoglu.

</span>
<span class="ltx_bibblock">Neural discrete representation learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib99.1.1">Advances in Neural Information Processing Systems (NeurIPS)</em>, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib100">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">van&nbsp;den Oord et&nbsp;al. (2016)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Aäron van&nbsp;den Oord, Sander Dieleman, Heiga Zen, Karen Simonyan, Oriol Vinyals, Alexander Graves, Nal Kalchbrenner, Andrew Senior, and Koray Kavukcuoglu.

</span>
<span class="ltx_bibblock">WaveNet: A generative model for raw audio.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib100.1.1">arXiv:1609.03499</em>, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib101">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et&nbsp;al. (2017)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan&nbsp;N. Gomez, and Lukasz&nbsp;Kaiser and.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib101.1.1">Advances in Neural Information Processing Systems (NeurIPS)</em>, pages 5998–6008, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib102">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang (2003)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Avery Li-Chun Wang.

</span>
<span class="ltx_bibblock">An industrial strength audio search algorithm.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib102.1.1">ISMIR</em>. Washington, DC, 2003.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib103">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Chengyi Wang, Sanyuan Chen, Yu&nbsp;Wu, Ziqiang Zhang, Long Zhou, Shujie Liu, Zhuo Chen, Yanqing Liu, Huaming Wang, Jinyu Li, Lei He, Sheng Zhao, and Furu Wei.

</span>
<span class="ltx_bibblock">Neural codec language models are zero-shot text to speech synthesizers.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib103.1.1">CoRR</em>, abs/2301.02111, 2023.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.48550/ARXIV.2301.02111</span>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib104">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Peng Wang, Songshuo Lu, Yaohua Tang, Sijie Yan, Yuanjun Xiong, and Wei Xia.

</span>
<span class="ltx_bibblock">A full-duplex speech dialogue scheme based on large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib104.1.1">CoRR</em>, abs/2405.19487, 2024.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.48550/ARXIV.2405.19487</span>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib105">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Dongchao Yang, Jinchuan Tian, Xu&nbsp;Tan, Rongjie Huang, Songxiang Liu, Xuankai Chang, Jiatong Shi, Sheng Zhao, Jiang Bian, Xixin Wu, et&nbsp;al.

</span>
<span class="ltx_bibblock">Uniaudio: An audio foundation model toward universal audio generation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib105.1.1">arXiv preprint arXiv:2310.00704</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib106">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Shu-Wen Yang, Po-Han Chi, Yung-Sung Chuang, Cheng-I&nbsp;Jeff Lai, Kushal Lakhotia, Yist&nbsp;Y. Lin, Andy&nbsp;T. Liu, Jiatong Shi, Xuankai Chang, Guan-Ting Lin, Tzu-Hsien Huang, Wei-Cheng Tseng, Ko-tik Lee, Da-Rong Liu, Zili Huang, Shuyan Dong, Shang-Wen Li, Shinji Watanabe, Abdelrahman Mohamed, and Hung-yi Lee.

</span>
<span class="ltx_bibblock">SUPERB: speech processing universal performance benchmark.

</span>
<span class="ltx_bibblock">In Hynek Hermansky, Honza Cernocký, Lukás Burget, Lori Lamel, Odette Scharenborg, and Petr Motlícek, editors, <em class="ltx_emph ltx_font_italic" id="bib.bib106.1.1">22nd Annual Conference of the International Speech Communication Association, Interspeech 2021, Brno, Czechia, August 30 - September 3, 2021</em>, pages 1194–1198. ISCA, 2021.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.21437/INTERSPEECH.2021-1775</span>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib107">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Lili Yu, Dániel Simig, Colin Flaherty, Armen Aghajanyan, Luke Zettlemoyer, and Mike Lewis.

</span>
<span class="ltx_bibblock">Megabyte: Predicting million-byte sequences with multiscale transformers.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib107.1.1">Advances in Neural Information Processing Systems</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib108">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zeghidour et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Neil Zeghidour, Alejandro Luebs, Ahmed Omran, Jan Skoglund, and Marco Tagliasacchi.

</span>
<span class="ltx_bibblock">Soundstream: An end-to-end neural audio codec.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib108.1.1">IEEE ACM Trans. Audio Speech Lang. Process.</em>, 30, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib109">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zellers et&nbsp;al. (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Rowan Zellers, Ari Holtzman, Yonatan Bisk, Ali Farhadi, and Yejin Choi.

</span>
<span class="ltx_bibblock">Hellaswag: Can a machine really finish your sentence?

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib109.1.1">arXiv preprint arXiv:1905.07830</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib110">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang and Sennrich (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Biao Zhang and Rico Sennrich.

</span>
<span class="ltx_bibblock">Root mean square layer normalization.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib110.1.1">Advances in Neural Information Processing Systems</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib111">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et&nbsp;al. (2023a)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Dong Zhang, Shimin Li, Xin Zhang, Jun Zhan, Pengyu Wang, Yaqian Zhou, and Xipeng Qiu.

</span>
<span class="ltx_bibblock">Speechgpt: Empowering large language models with intrinsic cross-modal conversational abilities.

</span>
<span class="ltx_bibblock">In Houda Bouamor, Juan Pino, and Kalika Bali, editors, <em class="ltx_emph ltx_font_italic" id="bib.bib111.1.1">Findings of the Association for Computational Linguistics: EMNLP 2023, Singapore, December 6-10, 2023</em>, pages 15757–15773. Association for Computational Linguistics, 2023a.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.18653/V1/2023.FINDINGS-EMNLP.1055</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.18653/v1/2023.findings-emnlp.1055" title="">https://doi.org/10.18653/v1/2023.findings-emnlp.1055</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib112">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et&nbsp;al. (2024a)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Dong Zhang, Xin Zhang, Jun Zhan, Shimin Li, Yaqian Zhou, and Xipeng Qiu.

</span>
<span class="ltx_bibblock">Speechgpt-gen: Scaling chain-of-information speech generation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib112.1.1">arXiv preprint arXiv:2401.13527</em>, 2024a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib113">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et&nbsp;al. (2024b)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Xin Zhang, Dong Zhang, Shimin Li, Yaqian Zhou, and Xipeng Qiu.

</span>
<span class="ltx_bibblock">Speechtokenizer: Unified speech tokenizer for speech language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib113.1.1">The Twelfth International Conference on Learning Representations</em>, 2024b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib114">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et&nbsp;al. (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yizhe Zhang, Siqi Sun, Michel Galley, Yen-Chun Chen, Chris Brockett, Xiang Gao, Jianfeng Gao, Jingjing Liu, and Bill Dolan.

</span>
<span class="ltx_bibblock">Dialogpt: Large-scale generative pre-training for conversational response generation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib114.1.1">CoRR</em>, abs/1911.00536, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib115">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et&nbsp;al. (2023b)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yu&nbsp;Zhang, Wei Han, James Qin, Yongqiang Wang, Ankur Bapna, Zhehuai Chen, Nanxin Chen, Bo&nbsp;Li, Vera Axelrod, Gary Wang, Zhong Meng, Ke&nbsp;Hu, Andrew Rosenberg, Rohit Prabhavalkar, Daniel&nbsp;S. Park, Parisa Haghani, Jason Riesa, Ginger Perng, Hagen Soltau, Trevor Strohman, Bhuvana Ramabhadran, Tara&nbsp;N. Sainath, Pedro&nbsp;J. Moreno, Chung-Cheng Chiu, Johan Schalkwyk, Françoise Beaufays, and Yonghui Wu.

</span>
<span class="ltx_bibblock">Google USM: scaling automatic speech recognition beyond 100 languages.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib115.1.1">CoRR</em>, abs/2303.01037, 2023b.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.48550/ARXIV.2303.01037</span>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib116">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu (2018)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
J&nbsp;Zhu.

</span>
<span class="ltx_bibblock">Hidden: hiding data with deep networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib116.1.1">arXiv preprint arXiv:1807.09937</em>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib117">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yongxin Zhu, Dan Su, Liqiang He, Linli Xu, and Dong Yu.

</span>
<span class="ltx_bibblock">Generative pre-trained speech language model with efficient hierarchical transformer.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib117.1.1">arXiv preprint arXiv:2406.00976</em>, 2024.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<figure class="ltx_table" id="A1.T17">
<div class="ltx_flex_figure ltx_flex_table">
<div class="ltx_flex_cell ltx_flex_size_1">
<section class="ltx_appendix ltx_figure_panel" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Additional Ablation on Mimi Codec</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 17: </span><span class="ltx_text ltx_font_bold" id="A1.T17.7.1">Ablation study on hyper-parameters of the Mimi codec</span>. We evaluate semantic modeling by reporting the error rate on a phonetic ABX discriminability task. To evaluate reconstruction quality, we compute VisQOL and MOSNet. “Quantization rate” refers to applying quantization to the latent space only <math alttext="50\%" class="ltx_Math" display="inline" id="A1.T17.2.m1.1"><semantics id="A1.T17.2.m1.1b"><mrow id="A1.T17.2.m1.1.1" xref="A1.T17.2.m1.1.1.cmml"><mn id="A1.T17.2.m1.1.1.2" xref="A1.T17.2.m1.1.1.2.cmml">50</mn><mo id="A1.T17.2.m1.1.1.1" xref="A1.T17.2.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.T17.2.m1.1c"><apply id="A1.T17.2.m1.1.1.cmml" xref="A1.T17.2.m1.1.1"><csymbol cd="latexml" id="A1.T17.2.m1.1.1.1.cmml" xref="A1.T17.2.m1.1.1.1">percent</csymbol><cn id="A1.T17.2.m1.1.1.2.cmml" type="integer" xref="A1.T17.2.m1.1.1.2">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T17.2.m1.1d">50\%</annotation><annotation encoding="application/x-llamapun" id="A1.T17.2.m1.1e">50 %</annotation></semantics></math> of the time during training (independently from quantizer dropout), as described in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS3" title="3.3 Audio Tokenization ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue">Section &nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></span></a>.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_inline-block ltx_figure_panel ltx_transformed_outer" id="A1.T17.5" style="width:433.6pt;height:280pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(7.8pt,-5.0pt) scale(1.0370906055628,1.0370906055628) ;">
<table class="ltx_tabular ltx_align_middle" id="A1.T17.5.3">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A1.T17.5.3.3">
<td class="ltx_td ltx_align_center ltx_border_tt" id="A1.T17.5.3.3.4"><span class="ltx_text" id="A1.T17.5.3.3.4.1" style="font-size:80%;">Quantization</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A1.T17.5.3.3.5"><span class="ltx_text" id="A1.T17.5.3.3.5.1" style="font-size:80%;">Transformer</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A1.T17.5.3.3.6"><span class="ltx_text" id="A1.T17.5.3.3.6.1" style="font-size:80%;">Transformer</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A1.T17.5.3.3.7"><span class="ltx_text" id="A1.T17.5.3.3.7.1" style="font-size:80%;">WavLM</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="A1.T17.5.3.3.8"><span class="ltx_text" id="A1.T17.5.3.3.8.1" style="font-size:80%;">Split</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A1.T17.3.1.1.1" rowspan="2"><span class="ltx_text" id="A1.T17.3.1.1.1.1" style="font-size:80%;">ABX (<math alttext="\downarrow" class="ltx_Math" display="inline" id="A1.T17.3.1.1.1.1.m1.1"><semantics id="A1.T17.3.1.1.1.1.m1.1a"><mo id="A1.T17.3.1.1.1.1.m1.1.1" stretchy="false" xref="A1.T17.3.1.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="A1.T17.3.1.1.1.1.m1.1b"><ci id="A1.T17.3.1.1.1.1.m1.1.1.cmml" xref="A1.T17.3.1.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T17.3.1.1.1.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="A1.T17.3.1.1.1.1.m1.1d">↓</annotation></semantics></math>)</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A1.T17.4.2.2.2" rowspan="2"><span class="ltx_text" id="A1.T17.4.2.2.2.1" style="font-size:80%;">VisQOL (<math alttext="\uparrow" class="ltx_Math" display="inline" id="A1.T17.4.2.2.2.1.m1.1"><semantics id="A1.T17.4.2.2.2.1.m1.1a"><mo id="A1.T17.4.2.2.2.1.m1.1.1" stretchy="false" xref="A1.T17.4.2.2.2.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="A1.T17.4.2.2.2.1.m1.1b"><ci id="A1.T17.4.2.2.2.1.m1.1.1.cmml" xref="A1.T17.4.2.2.2.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T17.4.2.2.2.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="A1.T17.4.2.2.2.1.m1.1d">↑</annotation></semantics></math>)</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A1.T17.5.3.3.3" rowspan="2"><span class="ltx_text" id="A1.T17.5.3.3.3.1" style="font-size:80%;">MOSNet (<math alttext="\uparrow" class="ltx_Math" display="inline" id="A1.T17.5.3.3.3.1.m1.1"><semantics id="A1.T17.5.3.3.3.1.m1.1a"><mo id="A1.T17.5.3.3.3.1.m1.1.1" stretchy="false" xref="A1.T17.5.3.3.3.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="A1.T17.5.3.3.3.1.m1.1b"><ci id="A1.T17.5.3.3.3.1.m1.1.1.cmml" xref="A1.T17.5.3.3.3.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T17.5.3.3.3.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="A1.T17.5.3.3.3.1.m1.1d">↑</annotation></semantics></math>)</span></td>
</tr>
<tr class="ltx_tr" id="A1.T17.5.3.4.1">
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.4.1.1"><span class="ltx_text" id="A1.T17.5.3.4.1.1.1" style="font-size:80%;">Rate</span></td>
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.4.1.2"><span class="ltx_text" id="A1.T17.5.3.4.1.2.1" style="font-size:80%;">in encoder</span></td>
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.4.1.3"><span class="ltx_text" id="A1.T17.5.3.4.1.3.1" style="font-size:80%;">in decoder</span></td>
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.4.1.4"><span class="ltx_text" id="A1.T17.5.3.4.1.4.1" style="font-size:80%;">distillation</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T17.5.3.4.1.5"><span class="ltx_text" id="A1.T17.5.3.4.1.5.1" style="font-size:80%;">quantizer</span></td>
</tr>
<tr class="ltx_tr" id="A1.T17.5.3.5.2">
<td class="ltx_td ltx_border_t" id="A1.T17.5.3.5.2.1"></td>
<td class="ltx_td ltx_border_t" id="A1.T17.5.3.5.2.2"></td>
<td class="ltx_td ltx_border_t" id="A1.T17.5.3.5.2.3"></td>
<td class="ltx_td ltx_border_t" id="A1.T17.5.3.5.2.4"></td>
<td class="ltx_td ltx_border_r ltx_border_t" id="A1.T17.5.3.5.2.5"></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T17.5.3.5.2.6"><span class="ltx_text" id="A1.T17.5.3.5.2.6.1" style="font-size:80%;">31.3%</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T17.5.3.5.2.7"><span class="ltx_text" id="A1.T17.5.3.5.2.7.1" style="font-size:80%;">2.37</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T17.5.3.5.2.8"><span class="ltx_text" id="A1.T17.5.3.5.2.8.1" style="font-size:80%;">2.85</span></td>
</tr>
<tr class="ltx_tr" id="A1.T17.5.3.6.3">
<td class="ltx_td" id="A1.T17.5.3.6.3.1"></td>
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.6.3.2"><span class="ltx_text" id="A1.T17.5.3.6.3.2.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td" id="A1.T17.5.3.6.3.3"></td>
<td class="ltx_td" id="A1.T17.5.3.6.3.4"></td>
<td class="ltx_td ltx_border_r" id="A1.T17.5.3.6.3.5"></td>
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.6.3.6"><span class="ltx_text" id="A1.T17.5.3.6.3.6.1" style="font-size:80%;">31.4%</span></td>
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.6.3.7"><span class="ltx_text" id="A1.T17.5.3.6.3.7.1" style="font-size:80%;">2.30</span></td>
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.6.3.8"><span class="ltx_text" id="A1.T17.5.3.6.3.8.1" style="font-size:80%;">2.82</span></td>
</tr>
<tr class="ltx_tr" id="A1.T17.5.3.7.4">
<td class="ltx_td" id="A1.T17.5.3.7.4.1"></td>
<td class="ltx_td" id="A1.T17.5.3.7.4.2"></td>
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.7.4.3"><span class="ltx_text" id="A1.T17.5.3.7.4.3.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td" id="A1.T17.5.3.7.4.4"></td>
<td class="ltx_td ltx_border_r" id="A1.T17.5.3.7.4.5"></td>
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.7.4.6"><span class="ltx_text" id="A1.T17.5.3.7.4.6.1" style="font-size:80%;">27.5%</span></td>
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.7.4.7"><span class="ltx_text" id="A1.T17.5.3.7.4.7.1" style="font-size:80%;">2.30</span></td>
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.7.4.8"><span class="ltx_text" id="A1.T17.5.3.7.4.8.1" style="font-size:80%;">2.93</span></td>
</tr>
<tr class="ltx_tr" id="A1.T17.5.3.8.5">
<td class="ltx_td" id="A1.T17.5.3.8.5.1"></td>
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.8.5.2"><span class="ltx_text" id="A1.T17.5.3.8.5.2.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.8.5.3"><span class="ltx_text" id="A1.T17.5.3.8.5.3.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td" id="A1.T17.5.3.8.5.4"></td>
<td class="ltx_td ltx_border_r" id="A1.T17.5.3.8.5.5"></td>
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.8.5.6"><span class="ltx_text" id="A1.T17.5.3.8.5.6.1" style="font-size:80%;">29.0%</span></td>
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.8.5.7"><span class="ltx_text" id="A1.T17.5.3.8.5.7.1" style="font-size:80%;">2.25</span></td>
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.8.5.8"><span class="ltx_text" id="A1.T17.5.3.8.5.8.1" style="font-size:80%;">2.94</span></td>
</tr>
<tr class="ltx_tr" id="A1.T17.5.3.9.6">
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.9.6.1"><span class="ltx_text" id="A1.T17.5.3.9.6.1.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td" id="A1.T17.5.3.9.6.2"></td>
<td class="ltx_td" id="A1.T17.5.3.9.6.3"></td>
<td class="ltx_td" id="A1.T17.5.3.9.6.4"></td>
<td class="ltx_td ltx_border_r" id="A1.T17.5.3.9.6.5"></td>
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.9.6.6"><span class="ltx_text" id="A1.T17.5.3.9.6.6.1" style="font-size:80%;">29.1%</span></td>
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.9.6.7"><span class="ltx_text" id="A1.T17.5.3.9.6.7.1" style="font-size:80%;">2.65</span></td>
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.9.6.8"><span class="ltx_text" id="A1.T17.5.3.9.6.8.1" style="font-size:80%;">2.86</span></td>
</tr>
<tr class="ltx_tr" id="A1.T17.5.3.10.7">
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.10.7.1"><span class="ltx_text" id="A1.T17.5.3.10.7.1.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.10.7.2"><span class="ltx_text" id="A1.T17.5.3.10.7.2.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td" id="A1.T17.5.3.10.7.3"></td>
<td class="ltx_td" id="A1.T17.5.3.10.7.4"></td>
<td class="ltx_td ltx_border_r" id="A1.T17.5.3.10.7.5"></td>
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.10.7.6"><span class="ltx_text" id="A1.T17.5.3.10.7.6.1" style="font-size:80%;">27.4%</span></td>
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.10.7.7"><span class="ltx_text" id="A1.T17.5.3.10.7.7.1" style="font-size:80%;">2.69</span></td>
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.10.7.8"><span class="ltx_text" id="A1.T17.5.3.10.7.8.1" style="font-size:80%;">2.83</span></td>
</tr>
<tr class="ltx_tr" id="A1.T17.5.3.11.8">
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.11.8.1"><span class="ltx_text" id="A1.T17.5.3.11.8.1.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td" id="A1.T17.5.3.11.8.2"></td>
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.11.8.3"><span class="ltx_text" id="A1.T17.5.3.11.8.3.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td" id="A1.T17.5.3.11.8.4"></td>
<td class="ltx_td ltx_border_r" id="A1.T17.5.3.11.8.5"></td>
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.11.8.6"><span class="ltx_text" id="A1.T17.5.3.11.8.6.1" style="font-size:80%;">23.6%</span></td>
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.11.8.7"><span class="ltx_text" id="A1.T17.5.3.11.8.7.1" style="font-size:80%;">2.72</span></td>
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.11.8.8"><span class="ltx_text" id="A1.T17.5.3.11.8.8.1" style="font-size:80%;">2.89</span></td>
</tr>
<tr class="ltx_tr" id="A1.T17.5.3.12.9">
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.12.9.1"><span class="ltx_text" id="A1.T17.5.3.12.9.1.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.12.9.2"><span class="ltx_text" id="A1.T17.5.3.12.9.2.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.12.9.3"><span class="ltx_text" id="A1.T17.5.3.12.9.3.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td" id="A1.T17.5.3.12.9.4"></td>
<td class="ltx_td ltx_border_r" id="A1.T17.5.3.12.9.5"></td>
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.12.9.6"><span class="ltx_text" id="A1.T17.5.3.12.9.6.1" style="font-size:80%;">23.3%</span></td>
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.12.9.7"><span class="ltx_text" id="A1.T17.5.3.12.9.7.1" style="font-size:80%;">2.82</span></td>
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.12.9.8"><span class="ltx_text" id="A1.T17.5.3.12.9.8.1" style="font-size:80%;">2.89</span></td>
</tr>
<tr class="ltx_tr" id="A1.T17.5.3.13.10">
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.13.10.1"><span class="ltx_text" id="A1.T17.5.3.13.10.1.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.13.10.2"><span class="ltx_text" id="A1.T17.5.3.13.10.2.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.13.10.3"><span class="ltx_text" id="A1.T17.5.3.13.10.3.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.13.10.4"><span class="ltx_text" id="A1.T17.5.3.13.10.4.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td ltx_border_r" id="A1.T17.5.3.13.10.5"></td>
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.13.10.6"><span class="ltx_text" id="A1.T17.5.3.13.10.6.1" style="font-size:80%;">6.5%</span></td>
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.13.10.7"><span class="ltx_text" id="A1.T17.5.3.13.10.7.1" style="font-size:80%;">2.13</span></td>
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.13.10.8"><span class="ltx_text" id="A1.T17.5.3.13.10.8.1" style="font-size:80%;">2.87</span></td>
</tr>
<tr class="ltx_tr" id="A1.T17.5.3.14.11">
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.14.11.1"><span class="ltx_text" id="A1.T17.5.3.14.11.1.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td" id="A1.T17.5.3.14.11.2"></td>
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.14.11.3"><span class="ltx_text" id="A1.T17.5.3.14.11.3.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.14.11.4"><span class="ltx_text" id="A1.T17.5.3.14.11.4.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T17.5.3.14.11.5"><span class="ltx_text" id="A1.T17.5.3.14.11.5.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.14.11.6"><span class="ltx_text" id="A1.T17.5.3.14.11.6.1" style="font-size:80%;">10.8%</span></td>
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.14.11.7"><span class="ltx_text" id="A1.T17.5.3.14.11.7.1" style="font-size:80%;">2.68</span></td>
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.14.11.8"><span class="ltx_text" id="A1.T17.5.3.14.11.8.1" style="font-size:80%;">2.84</span></td>
</tr>
<tr class="ltx_tr" id="A1.T17.5.3.15.12">
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.15.12.1"><span class="ltx_text" id="A1.T17.5.3.15.12.1.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.15.12.2"><span class="ltx_text" id="A1.T17.5.3.15.12.2.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td" id="A1.T17.5.3.15.12.3"></td>
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.15.12.4"><span class="ltx_text" id="A1.T17.5.3.15.12.4.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T17.5.3.15.12.5"><span class="ltx_text" id="A1.T17.5.3.15.12.5.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.15.12.6"><span class="ltx_text" id="A1.T17.5.3.15.12.6.1" style="font-size:80%;">8.1%</span></td>
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.15.12.7"><span class="ltx_text" id="A1.T17.5.3.15.12.7.1" style="font-size:80%;">2.49</span></td>
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.15.12.8"><span class="ltx_text" id="A1.T17.5.3.15.12.8.1" style="font-size:80%;">2.71</span></td>
</tr>
<tr class="ltx_tr" id="A1.T17.5.3.16.13">
<td class="ltx_td" id="A1.T17.5.3.16.13.1"></td>
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.16.13.2"><span class="ltx_text" id="A1.T17.5.3.16.13.2.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.16.13.3"><span class="ltx_text" id="A1.T17.5.3.16.13.3.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.16.13.4"><span class="ltx_text" id="A1.T17.5.3.16.13.4.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T17.5.3.16.13.5"><span class="ltx_text" id="A1.T17.5.3.16.13.5.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.16.13.6"><span class="ltx_text" id="A1.T17.5.3.16.13.6.1" style="font-size:80%;">8.0%</span></td>
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.16.13.7"><span class="ltx_text" id="A1.T17.5.3.16.13.7.1" style="font-size:80%;">2.36</span></td>
<td class="ltx_td ltx_align_center" id="A1.T17.5.3.16.13.8"><span class="ltx_text" id="A1.T17.5.3.16.13.8.1" style="font-size:80%;">2.88</span></td>
</tr>
<tr class="ltx_tr" id="A1.T17.5.3.17.14">
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T17.5.3.17.14.1"><span class="ltx_text" id="A1.T17.5.3.17.14.1.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T17.5.3.17.14.2"><span class="ltx_text" id="A1.T17.5.3.17.14.2.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T17.5.3.17.14.3"><span class="ltx_text" id="A1.T17.5.3.17.14.3.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T17.5.3.17.14.4"><span class="ltx_text" id="A1.T17.5.3.17.14.4.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="A1.T17.5.3.17.14.5"><span class="ltx_text" id="A1.T17.5.3.17.14.5.1" style="font-size:80%;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T17.5.3.17.14.6"><span class="ltx_text" id="A1.T17.5.3.17.14.6.1" style="font-size:80%;">8.1%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T17.5.3.17.14.7"><span class="ltx_text" id="A1.T17.5.3.17.14.7.1" style="font-size:80%;">2.72</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T17.5.3.17.14.8"><span class="ltx_text" id="A1.T17.5.3.17.14.8.1" style="font-size:80%;">2.89</span></td>
</tr>
</tbody>
</table>
</span></div>
</div>
</div>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Audio Matching and Deduplication</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A2.p1">
<p class="ltx_p" id="A2.p1.1">We have developed an audio matching system, whose objective is twofold:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ol class="ltx_enumerate" id="A2.I1">
<li class="ltx_item" id="A2.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="A2.I1.i1.p1">
<p class="ltx_p" id="A2.I1.i1.p1.1"><span class="ltx_text ltx_font_italic" id="A2.I1.i1.p1.1.1">Deduplication of source content</span>. Removing frequent duplicates to avoid overfitting and the regurgitation of audio content that is over-represented in the dataset, as evaluated in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S6.SS2" title="6.2 Regurgitation Analysis ‣ 6 Safety ‣ Moshi: a speech-text foundation model for real-time dialogue">Section&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">6.2</span></span></a>. 
<br class="ltx_break"></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A2.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="A2.I1.i2.p1">
<p class="ltx_p" id="A2.I1.i2.p1.1"><span class="ltx_text ltx_font_italic" id="A2.I1.i2.p1.1.1">Indexing solution</span>. By collecting signatures of samples at generation time, we can find if some content has been generated by our online demo or not by direct retrieval.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ol>
</div>
<div class="ltx_para" id="A2.p2">
<p class="ltx_p" id="A2.p2.1">Our audio matching solution is inspired by the work of <cite class="ltx_cite ltx_citemacro_cite">Wang (<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib102" title="">2003</a>)</cite>, as it offers a good trade-off between efficiency and effectiveness. This method is a retrieval system: Given a query, it detects the similar audio in a pre-indexed dataset. In our case, the signature design favors the de-duplication use-case, which needs to be more efficient: Formally, we need to compare every audio of the dataset with the whole dataset, which raises efficiency issues. The signature extraction is described below.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_paragraph" id="A2.SS0.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Constellation map.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A2.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="A2.SS0.SSS0.Px1.p1.1">The first step to produce the signatures involves computing a set of keypoints referred to as a <em class="ltx_emph ltx_font_italic" id="A2.SS0.SSS0.Px1.p1.1.1">constellation map</em>. Our procedure is inspired by <cite class="ltx_cite ltx_citemacro_cite">Wang (<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib102" title="">2003</a>)</cite> and illustrated in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#A2.F7" title="Figure 7 ‣ Constellation map. ‣ Appendix B Audio Matching and Deduplication ‣ Moshi: a speech-text foundation model for real-time dialogue">Figure&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></span></a>. First, (1) we compute a mel-spectogram from the audio signal, where the time is discretized with frequency 40Hz and the frequency range into 64 bins. We then apply three filters to select time-frequency positions: (2) The energy filter ensures that we only select positions that are robust enough; (3) The time and (4) frequency filters ensure that we select maxima w.r.t. time and frequency. The combination of these filters is (5) a constellation, from which we extract hashes.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="A2.F7">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="144" id="A2.F7.g1" src="https://arxiv.org/html/2410.00037v2/x7.png" width="574"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="A2.F7.1"><span class="ltx_text" id="A2.F7.1.1" style="position:relative; bottom:23.0pt;">
<span class="ltx_inline-block ltx_minipage ltx_align_top" id="A2.F7.1.1.1" style="width:216.8pt;">
<span class="ltx_p" id="A2.F7.1.1.1.1">(1) Mel-spectogram: The [200Hz–3000Hz] frequency range is split into 64 bands.</span>
</span></span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="144" id="A2.F7.g2" src="https://arxiv.org/html/2410.00037v2/x8.png" width="574"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="A2.F7.2"><span class="ltx_text" id="A2.F7.2.1" style="position:relative; bottom:23.0pt;">
<span class="ltx_inline-block ltx_minipage ltx_align_top" id="A2.F7.2.1.1" style="width:216.8pt;">
<span class="ltx_p" id="A2.F7.2.1.1.1">(2) Energy filter: filter our all positions (time, band) whose amplitude is below the average.</span>
</span></span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="144" id="A2.F7.g3" src="https://arxiv.org/html/2410.00037v2/x9.png" width="574"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="A2.F7.3"><span class="ltx_text" id="A2.F7.3.1" style="position:relative; bottom:23.0pt;">
<span class="ltx_inline-block ltx_minipage ltx_align_top" id="A2.F7.3.1.1" style="width:216.8pt;">
<span class="ltx_p" id="A2.F7.3.1.1.1">(3) Time filter: keep only position with highest mel-spec value in a sliding window.</span>
</span></span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="144" id="A2.F7.g4" src="https://arxiv.org/html/2410.00037v2/x10.png" width="574"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="A2.F7.4"><span class="ltx_text" id="A2.F7.4.1" style="position:relative; bottom:23.0pt;">
<span class="ltx_inline-block ltx_minipage ltx_align_top" id="A2.F7.4.1.1" style="width:216.8pt;">
<span class="ltx_p" id="A2.F7.4.1.1.1">(4) Frequency filter: At a given time, keep only the most energetic frequency band.</span>
</span></span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="144" id="A2.F7.g5" src="https://arxiv.org/html/2410.00037v2/x11.png" width="574"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="A2.F7.5"><span class="ltx_text" id="A2.F7.5.1" style="position:relative; bottom:23.0pt;">
<span class="ltx_inline-block ltx_minipage ltx_align_top" id="A2.F7.5.1.1" style="width:216.8pt;">
<span class="ltx_p" id="A2.F7.5.1.1.1">(5) The Constellation map obtained by intersecting the three filters above.</span>
</span></span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 7: </span><span class="ltx_text ltx_font_bold" id="A2.F7.7.1">Mel-spectrum keypoint extraction</span>. Three filters are applied to the audio mel-spectrum to extract a constellation of keypoints on which hash signatures are computed.
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A2.SS0.SSS0.Px1.p2">
<p class="ltx_p" id="A2.SS0.SSS0.Px1.p2.5">At the end of the keypoint extraction procedure, the constellation map <math alttext="{\mathcal{C}}" class="ltx_Math" display="inline" id="A2.SS0.SSS0.Px1.p2.1.m1.1"><semantics id="A2.SS0.SSS0.Px1.p2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="A2.SS0.SSS0.Px1.p2.1.m1.1.1" xref="A2.SS0.SSS0.Px1.p2.1.m1.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="A2.SS0.SSS0.Px1.p2.1.m1.1b"><ci id="A2.SS0.SSS0.Px1.p2.1.m1.1.1.cmml" xref="A2.SS0.SSS0.Px1.p2.1.m1.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS0.SSS0.Px1.p2.1.m1.1c">{\mathcal{C}}</annotation><annotation encoding="application/x-llamapun" id="A2.SS0.SSS0.Px1.p2.1.m1.1d">caligraphic_C</annotation></semantics></math> consists of a list of <math alttext="n" class="ltx_Math" display="inline" id="A2.SS0.SSS0.Px1.p2.2.m2.1"><semantics id="A2.SS0.SSS0.Px1.p2.2.m2.1a"><mi id="A2.SS0.SSS0.Px1.p2.2.m2.1.1" xref="A2.SS0.SSS0.Px1.p2.2.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="A2.SS0.SSS0.Px1.p2.2.m2.1b"><ci id="A2.SS0.SSS0.Px1.p2.2.m2.1.1.cmml" xref="A2.SS0.SSS0.Px1.p2.2.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS0.SSS0.Px1.p2.2.m2.1c">n</annotation><annotation encoding="application/x-llamapun" id="A2.SS0.SSS0.Px1.p2.2.m2.1d">italic_n</annotation></semantics></math> tuples of the form <math alttext="{\mathcal{C}}=\{(t_{i},f_{i})\}_{0\leq i<n}" class="ltx_Math" display="inline" id="A2.SS0.SSS0.Px1.p2.3.m3.1"><semantics id="A2.SS0.SSS0.Px1.p2.3.m3.1a"><mrow id="A2.SS0.SSS0.Px1.p2.3.m3.1.1" xref="A2.SS0.SSS0.Px1.p2.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.SS0.SSS0.Px1.p2.3.m3.1.1.3" xref="A2.SS0.SSS0.Px1.p2.3.m3.1.1.3.cmml">𝒞</mi><mo id="A2.SS0.SSS0.Px1.p2.3.m3.1.1.2" xref="A2.SS0.SSS0.Px1.p2.3.m3.1.1.2.cmml">=</mo><msub id="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1" xref="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.cmml"><mrow id="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.1" xref="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.2.cmml"><mo id="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.1.2" stretchy="false" xref="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.2.cmml">{</mo><mrow id="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.2" xref="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.3.cmml"><mo id="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.2.3" stretchy="false" xref="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.3.cmml">(</mo><msub id="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.1" xref="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.1.cmml"><mi id="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.1.2" xref="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.1.2.cmml">t</mi><mi id="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.1.3" xref="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.2.4" xref="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.3.cmml">,</mo><msub id="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.2.2" xref="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.2.2.cmml"><mi id="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.2.2.2" xref="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.2.2.2.cmml">f</mi><mi id="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.2.2.3" xref="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo id="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.2.5" stretchy="false" xref="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo id="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.1.3" stretchy="false" xref="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.2.cmml">}</mo></mrow><mrow id="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.3" xref="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.3.cmml"><mn id="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.3.2" xref="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.3.2.cmml">0</mn><mo id="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.3.3" xref="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.3.3.cmml">≤</mo><mi id="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.3.4" xref="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.3.4.cmml">i</mi><mo id="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.3.5" xref="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.3.5.cmml">&lt;</mo><mi id="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.3.6" xref="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.3.6.cmml">n</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="A2.SS0.SSS0.Px1.p2.3.m3.1b"><apply id="A2.SS0.SSS0.Px1.p2.3.m3.1.1.cmml" xref="A2.SS0.SSS0.Px1.p2.3.m3.1.1"><eq id="A2.SS0.SSS0.Px1.p2.3.m3.1.1.2.cmml" xref="A2.SS0.SSS0.Px1.p2.3.m3.1.1.2"></eq><ci id="A2.SS0.SSS0.Px1.p2.3.m3.1.1.3.cmml" xref="A2.SS0.SSS0.Px1.p2.3.m3.1.1.3">𝒞</ci><apply id="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.cmml" xref="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1"><csymbol cd="ambiguous" id="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.2.cmml" xref="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1">subscript</csymbol><set id="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.2.cmml" xref="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.1"><interval closure="open" id="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.3.cmml" xref="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.2"><apply id="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.1.cmml" xref="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.1.1.cmml" xref="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.1.2.cmml" xref="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.1.2">𝑡</ci><ci id="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.1.3.cmml" xref="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.2.2.cmml" xref="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.2.2.1.cmml" xref="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.2.2.2.cmml" xref="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.2.2.2">𝑓</ci><ci id="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.2.2.3.cmml" xref="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.2.2.3">𝑖</ci></apply></interval></set><apply id="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.3.cmml" xref="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.3"><and id="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.3a.cmml" xref="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.3"></and><apply id="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.3b.cmml" xref="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.3"><leq id="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.3.3.cmml" xref="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.3.3"></leq><cn id="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.3.2.cmml" type="integer" xref="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.3.2">0</cn><ci id="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.3.4.cmml" xref="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.3.4">𝑖</ci></apply><apply id="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.3c.cmml" xref="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.3"><lt id="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.3.5.cmml" xref="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.3.5"></lt><share href="https://arxiv.org/html/2410.00037v2#A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.3.4.cmml" id="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.3d.cmml" xref="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.3"></share><ci id="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.3.6.cmml" xref="A2.SS0.SSS0.Px1.p2.3.m3.1.1.1.3.6">𝑛</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS0.SSS0.Px1.p2.3.m3.1c">{\mathcal{C}}=\{(t_{i},f_{i})\}_{0\leq i&lt;n}</annotation><annotation encoding="application/x-llamapun" id="A2.SS0.SSS0.Px1.p2.3.m3.1d">caligraphic_C = { ( italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_f start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) } start_POSTSUBSCRIPT 0 ≤ italic_i &lt; italic_n end_POSTSUBSCRIPT</annotation></semantics></math>, where each selected timestamp <math alttext="t_{i}" class="ltx_Math" display="inline" id="A2.SS0.SSS0.Px1.p2.4.m4.1"><semantics id="A2.SS0.SSS0.Px1.p2.4.m4.1a"><msub id="A2.SS0.SSS0.Px1.p2.4.m4.1.1" xref="A2.SS0.SSS0.Px1.p2.4.m4.1.1.cmml"><mi id="A2.SS0.SSS0.Px1.p2.4.m4.1.1.2" xref="A2.SS0.SSS0.Px1.p2.4.m4.1.1.2.cmml">t</mi><mi id="A2.SS0.SSS0.Px1.p2.4.m4.1.1.3" xref="A2.SS0.SSS0.Px1.p2.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A2.SS0.SSS0.Px1.p2.4.m4.1b"><apply id="A2.SS0.SSS0.Px1.p2.4.m4.1.1.cmml" xref="A2.SS0.SSS0.Px1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="A2.SS0.SSS0.Px1.p2.4.m4.1.1.1.cmml" xref="A2.SS0.SSS0.Px1.p2.4.m4.1.1">subscript</csymbol><ci id="A2.SS0.SSS0.Px1.p2.4.m4.1.1.2.cmml" xref="A2.SS0.SSS0.Px1.p2.4.m4.1.1.2">𝑡</ci><ci id="A2.SS0.SSS0.Px1.p2.4.m4.1.1.3.cmml" xref="A2.SS0.SSS0.Px1.p2.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS0.SSS0.Px1.p2.4.m4.1c">t_{i}</annotation><annotation encoding="application/x-llamapun" id="A2.SS0.SSS0.Px1.p2.4.m4.1d">italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is associated with a mel-spec discrete frequency level <math alttext="f_{i}\in\{0,\dots,63\}" class="ltx_Math" display="inline" id="A2.SS0.SSS0.Px1.p2.5.m5.3"><semantics id="A2.SS0.SSS0.Px1.p2.5.m5.3a"><mrow id="A2.SS0.SSS0.Px1.p2.5.m5.3.4" xref="A2.SS0.SSS0.Px1.p2.5.m5.3.4.cmml"><msub id="A2.SS0.SSS0.Px1.p2.5.m5.3.4.2" xref="A2.SS0.SSS0.Px1.p2.5.m5.3.4.2.cmml"><mi id="A2.SS0.SSS0.Px1.p2.5.m5.3.4.2.2" xref="A2.SS0.SSS0.Px1.p2.5.m5.3.4.2.2.cmml">f</mi><mi id="A2.SS0.SSS0.Px1.p2.5.m5.3.4.2.3" xref="A2.SS0.SSS0.Px1.p2.5.m5.3.4.2.3.cmml">i</mi></msub><mo id="A2.SS0.SSS0.Px1.p2.5.m5.3.4.1" xref="A2.SS0.SSS0.Px1.p2.5.m5.3.4.1.cmml">∈</mo><mrow id="A2.SS0.SSS0.Px1.p2.5.m5.3.4.3.2" xref="A2.SS0.SSS0.Px1.p2.5.m5.3.4.3.1.cmml"><mo id="A2.SS0.SSS0.Px1.p2.5.m5.3.4.3.2.1" stretchy="false" xref="A2.SS0.SSS0.Px1.p2.5.m5.3.4.3.1.cmml">{</mo><mn id="A2.SS0.SSS0.Px1.p2.5.m5.1.1" xref="A2.SS0.SSS0.Px1.p2.5.m5.1.1.cmml">0</mn><mo id="A2.SS0.SSS0.Px1.p2.5.m5.3.4.3.2.2" xref="A2.SS0.SSS0.Px1.p2.5.m5.3.4.3.1.cmml">,</mo><mi id="A2.SS0.SSS0.Px1.p2.5.m5.2.2" mathvariant="normal" xref="A2.SS0.SSS0.Px1.p2.5.m5.2.2.cmml">…</mi><mo id="A2.SS0.SSS0.Px1.p2.5.m5.3.4.3.2.3" xref="A2.SS0.SSS0.Px1.p2.5.m5.3.4.3.1.cmml">,</mo><mn id="A2.SS0.SSS0.Px1.p2.5.m5.3.3" xref="A2.SS0.SSS0.Px1.p2.5.m5.3.3.cmml">63</mn><mo id="A2.SS0.SSS0.Px1.p2.5.m5.3.4.3.2.4" stretchy="false" xref="A2.SS0.SSS0.Px1.p2.5.m5.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS0.SSS0.Px1.p2.5.m5.3b"><apply id="A2.SS0.SSS0.Px1.p2.5.m5.3.4.cmml" xref="A2.SS0.SSS0.Px1.p2.5.m5.3.4"><in id="A2.SS0.SSS0.Px1.p2.5.m5.3.4.1.cmml" xref="A2.SS0.SSS0.Px1.p2.5.m5.3.4.1"></in><apply id="A2.SS0.SSS0.Px1.p2.5.m5.3.4.2.cmml" xref="A2.SS0.SSS0.Px1.p2.5.m5.3.4.2"><csymbol cd="ambiguous" id="A2.SS0.SSS0.Px1.p2.5.m5.3.4.2.1.cmml" xref="A2.SS0.SSS0.Px1.p2.5.m5.3.4.2">subscript</csymbol><ci id="A2.SS0.SSS0.Px1.p2.5.m5.3.4.2.2.cmml" xref="A2.SS0.SSS0.Px1.p2.5.m5.3.4.2.2">𝑓</ci><ci id="A2.SS0.SSS0.Px1.p2.5.m5.3.4.2.3.cmml" xref="A2.SS0.SSS0.Px1.p2.5.m5.3.4.2.3">𝑖</ci></apply><set id="A2.SS0.SSS0.Px1.p2.5.m5.3.4.3.1.cmml" xref="A2.SS0.SSS0.Px1.p2.5.m5.3.4.3.2"><cn id="A2.SS0.SSS0.Px1.p2.5.m5.1.1.cmml" type="integer" xref="A2.SS0.SSS0.Px1.p2.5.m5.1.1">0</cn><ci id="A2.SS0.SSS0.Px1.p2.5.m5.2.2.cmml" xref="A2.SS0.SSS0.Px1.p2.5.m5.2.2">…</ci><cn id="A2.SS0.SSS0.Px1.p2.5.m5.3.3.cmml" type="integer" xref="A2.SS0.SSS0.Px1.p2.5.m5.3.3">63</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS0.SSS0.Px1.p2.5.m5.3c">f_{i}\in\{0,\dots,63\}</annotation><annotation encoding="application/x-llamapun" id="A2.SS0.SSS0.Px1.p2.5.m5.3d">italic_f start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ { 0 , … , 63 }</annotation></semantics></math> .</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="A2.SS0.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Hash encoding.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A2.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="A2.SS0.SSS0.Px2.p1.1">From the constellation map, we extract hash signatures as follows. For each keypoint <math alttext="(t_{k},f_{k})\in\mathcal{C}" class="ltx_Math" display="inline" id="A2.SS0.SSS0.Px2.p1.1.m1.2"><semantics id="A2.SS0.SSS0.Px2.p1.1.m1.2a"><mrow id="A2.SS0.SSS0.Px2.p1.1.m1.2.2" xref="A2.SS0.SSS0.Px2.p1.1.m1.2.2.cmml"><mrow id="A2.SS0.SSS0.Px2.p1.1.m1.2.2.2.2" xref="A2.SS0.SSS0.Px2.p1.1.m1.2.2.2.3.cmml"><mo id="A2.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.3" stretchy="false" xref="A2.SS0.SSS0.Px2.p1.1.m1.2.2.2.3.cmml">(</mo><msub id="A2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1" xref="A2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.cmml"><mi id="A2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.2" xref="A2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.2.cmml">t</mi><mi id="A2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.3" xref="A2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="A2.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.4" xref="A2.SS0.SSS0.Px2.p1.1.m1.2.2.2.3.cmml">,</mo><msub id="A2.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2" xref="A2.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2.cmml"><mi id="A2.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2.2" xref="A2.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2.2.cmml">f</mi><mi id="A2.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2.3" xref="A2.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2.3.cmml">k</mi></msub><mo id="A2.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.5" stretchy="false" xref="A2.SS0.SSS0.Px2.p1.1.m1.2.2.2.3.cmml">)</mo></mrow><mo id="A2.SS0.SSS0.Px2.p1.1.m1.2.2.3" xref="A2.SS0.SSS0.Px2.p1.1.m1.2.2.3.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="A2.SS0.SSS0.Px2.p1.1.m1.2.2.4" xref="A2.SS0.SSS0.Px2.p1.1.m1.2.2.4.cmml">𝒞</mi></mrow><annotation-xml encoding="MathML-Content" id="A2.SS0.SSS0.Px2.p1.1.m1.2b"><apply id="A2.SS0.SSS0.Px2.p1.1.m1.2.2.cmml" xref="A2.SS0.SSS0.Px2.p1.1.m1.2.2"><in id="A2.SS0.SSS0.Px2.p1.1.m1.2.2.3.cmml" xref="A2.SS0.SSS0.Px2.p1.1.m1.2.2.3"></in><interval closure="open" id="A2.SS0.SSS0.Px2.p1.1.m1.2.2.2.3.cmml" xref="A2.SS0.SSS0.Px2.p1.1.m1.2.2.2.2"><apply id="A2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.cmml" xref="A2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.1.cmml" xref="A2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1">subscript</csymbol><ci id="A2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.2.cmml" xref="A2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.2">𝑡</ci><ci id="A2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.3.cmml" xref="A2.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.3">𝑘</ci></apply><apply id="A2.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2.cmml" xref="A2.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="A2.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2.1.cmml" xref="A2.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2">subscript</csymbol><ci id="A2.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2.2.cmml" xref="A2.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2.2">𝑓</ci><ci id="A2.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2.3.cmml" xref="A2.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2.3">𝑘</ci></apply></interval><ci id="A2.SS0.SSS0.Px2.p1.1.m1.2.2.4.cmml" xref="A2.SS0.SSS0.Px2.p1.1.m1.2.2.4">𝒞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS0.SSS0.Px2.p1.1.m1.2c">(t_{k},f_{k})\in\mathcal{C}</annotation><annotation encoding="application/x-llamapun" id="A2.SS0.SSS0.Px2.p1.1.m1.2d">( italic_t start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_f start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) ∈ caligraphic_C</annotation></semantics></math>, we select, if there exists:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul class="ltx_itemize" id="A2.I2">
<li class="ltx_item" id="A2.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I2.i1.p1">
<p class="ltx_p" id="A2.I2.i1.p1.6">A forward keypoint <math alttext="(t_{\mathrm{f}},f_{\mathrm{f}})" class="ltx_Math" display="inline" id="A2.I2.i1.p1.1.m1.2"><semantics id="A2.I2.i1.p1.1.m1.2a"><mrow id="A2.I2.i1.p1.1.m1.2.2.2" xref="A2.I2.i1.p1.1.m1.2.2.3.cmml"><mo id="A2.I2.i1.p1.1.m1.2.2.2.3" stretchy="false" xref="A2.I2.i1.p1.1.m1.2.2.3.cmml">(</mo><msub id="A2.I2.i1.p1.1.m1.1.1.1.1" xref="A2.I2.i1.p1.1.m1.1.1.1.1.cmml"><mi id="A2.I2.i1.p1.1.m1.1.1.1.1.2" xref="A2.I2.i1.p1.1.m1.1.1.1.1.2.cmml">t</mi><mi id="A2.I2.i1.p1.1.m1.1.1.1.1.3" mathvariant="normal" xref="A2.I2.i1.p1.1.m1.1.1.1.1.3.cmml">f</mi></msub><mo id="A2.I2.i1.p1.1.m1.2.2.2.4" xref="A2.I2.i1.p1.1.m1.2.2.3.cmml">,</mo><msub id="A2.I2.i1.p1.1.m1.2.2.2.2" xref="A2.I2.i1.p1.1.m1.2.2.2.2.cmml"><mi id="A2.I2.i1.p1.1.m1.2.2.2.2.2" xref="A2.I2.i1.p1.1.m1.2.2.2.2.2.cmml">f</mi><mi id="A2.I2.i1.p1.1.m1.2.2.2.2.3" mathvariant="normal" xref="A2.I2.i1.p1.1.m1.2.2.2.2.3.cmml">f</mi></msub><mo id="A2.I2.i1.p1.1.m1.2.2.2.5" stretchy="false" xref="A2.I2.i1.p1.1.m1.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.I2.i1.p1.1.m1.2b"><interval closure="open" id="A2.I2.i1.p1.1.m1.2.2.3.cmml" xref="A2.I2.i1.p1.1.m1.2.2.2"><apply id="A2.I2.i1.p1.1.m1.1.1.1.1.cmml" xref="A2.I2.i1.p1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="A2.I2.i1.p1.1.m1.1.1.1.1.1.cmml" xref="A2.I2.i1.p1.1.m1.1.1.1.1">subscript</csymbol><ci id="A2.I2.i1.p1.1.m1.1.1.1.1.2.cmml" xref="A2.I2.i1.p1.1.m1.1.1.1.1.2">𝑡</ci><ci id="A2.I2.i1.p1.1.m1.1.1.1.1.3.cmml" xref="A2.I2.i1.p1.1.m1.1.1.1.1.3">f</ci></apply><apply id="A2.I2.i1.p1.1.m1.2.2.2.2.cmml" xref="A2.I2.i1.p1.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="A2.I2.i1.p1.1.m1.2.2.2.2.1.cmml" xref="A2.I2.i1.p1.1.m1.2.2.2.2">subscript</csymbol><ci id="A2.I2.i1.p1.1.m1.2.2.2.2.2.cmml" xref="A2.I2.i1.p1.1.m1.2.2.2.2.2">𝑓</ci><ci id="A2.I2.i1.p1.1.m1.2.2.2.2.3.cmml" xref="A2.I2.i1.p1.1.m1.2.2.2.2.3">f</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="A2.I2.i1.p1.1.m1.2c">(t_{\mathrm{f}},f_{\mathrm{f}})</annotation><annotation encoding="application/x-llamapun" id="A2.I2.i1.p1.1.m1.2d">( italic_t start_POSTSUBSCRIPT roman_f end_POSTSUBSCRIPT , italic_f start_POSTSUBSCRIPT roman_f end_POSTSUBSCRIPT )</annotation></semantics></math>, which is the closest time to <math alttext="t_{k}" class="ltx_Math" display="inline" id="A2.I2.i1.p1.2.m2.1"><semantics id="A2.I2.i1.p1.2.m2.1a"><msub id="A2.I2.i1.p1.2.m2.1.1" xref="A2.I2.i1.p1.2.m2.1.1.cmml"><mi id="A2.I2.i1.p1.2.m2.1.1.2" xref="A2.I2.i1.p1.2.m2.1.1.2.cmml">t</mi><mi id="A2.I2.i1.p1.2.m2.1.1.3" xref="A2.I2.i1.p1.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="A2.I2.i1.p1.2.m2.1b"><apply id="A2.I2.i1.p1.2.m2.1.1.cmml" xref="A2.I2.i1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A2.I2.i1.p1.2.m2.1.1.1.cmml" xref="A2.I2.i1.p1.2.m2.1.1">subscript</csymbol><ci id="A2.I2.i1.p1.2.m2.1.1.2.cmml" xref="A2.I2.i1.p1.2.m2.1.1.2">𝑡</ci><ci id="A2.I2.i1.p1.2.m2.1.1.3.cmml" xref="A2.I2.i1.p1.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.I2.i1.p1.2.m2.1c">t_{k}</annotation><annotation encoding="application/x-llamapun" id="A2.I2.i1.p1.2.m2.1d">italic_t start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> such that <math alttext="t_{k}+m\leq t_{\mathrm{f}}<t_{k}+M" class="ltx_Math" display="inline" id="A2.I2.i1.p1.3.m3.1"><semantics id="A2.I2.i1.p1.3.m3.1a"><mrow id="A2.I2.i1.p1.3.m3.1.1" xref="A2.I2.i1.p1.3.m3.1.1.cmml"><mrow id="A2.I2.i1.p1.3.m3.1.1.2" xref="A2.I2.i1.p1.3.m3.1.1.2.cmml"><msub id="A2.I2.i1.p1.3.m3.1.1.2.2" xref="A2.I2.i1.p1.3.m3.1.1.2.2.cmml"><mi id="A2.I2.i1.p1.3.m3.1.1.2.2.2" xref="A2.I2.i1.p1.3.m3.1.1.2.2.2.cmml">t</mi><mi id="A2.I2.i1.p1.3.m3.1.1.2.2.3" xref="A2.I2.i1.p1.3.m3.1.1.2.2.3.cmml">k</mi></msub><mo id="A2.I2.i1.p1.3.m3.1.1.2.1" xref="A2.I2.i1.p1.3.m3.1.1.2.1.cmml">+</mo><mi id="A2.I2.i1.p1.3.m3.1.1.2.3" xref="A2.I2.i1.p1.3.m3.1.1.2.3.cmml">m</mi></mrow><mo id="A2.I2.i1.p1.3.m3.1.1.3" xref="A2.I2.i1.p1.3.m3.1.1.3.cmml">≤</mo><msub id="A2.I2.i1.p1.3.m3.1.1.4" xref="A2.I2.i1.p1.3.m3.1.1.4.cmml"><mi id="A2.I2.i1.p1.3.m3.1.1.4.2" xref="A2.I2.i1.p1.3.m3.1.1.4.2.cmml">t</mi><mi id="A2.I2.i1.p1.3.m3.1.1.4.3" mathvariant="normal" xref="A2.I2.i1.p1.3.m3.1.1.4.3.cmml">f</mi></msub><mo id="A2.I2.i1.p1.3.m3.1.1.5" xref="A2.I2.i1.p1.3.m3.1.1.5.cmml">&lt;</mo><mrow id="A2.I2.i1.p1.3.m3.1.1.6" xref="A2.I2.i1.p1.3.m3.1.1.6.cmml"><msub id="A2.I2.i1.p1.3.m3.1.1.6.2" xref="A2.I2.i1.p1.3.m3.1.1.6.2.cmml"><mi id="A2.I2.i1.p1.3.m3.1.1.6.2.2" xref="A2.I2.i1.p1.3.m3.1.1.6.2.2.cmml">t</mi><mi id="A2.I2.i1.p1.3.m3.1.1.6.2.3" xref="A2.I2.i1.p1.3.m3.1.1.6.2.3.cmml">k</mi></msub><mo id="A2.I2.i1.p1.3.m3.1.1.6.1" xref="A2.I2.i1.p1.3.m3.1.1.6.1.cmml">+</mo><mi id="A2.I2.i1.p1.3.m3.1.1.6.3" xref="A2.I2.i1.p1.3.m3.1.1.6.3.cmml">M</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.I2.i1.p1.3.m3.1b"><apply id="A2.I2.i1.p1.3.m3.1.1.cmml" xref="A2.I2.i1.p1.3.m3.1.1"><and id="A2.I2.i1.p1.3.m3.1.1a.cmml" xref="A2.I2.i1.p1.3.m3.1.1"></and><apply id="A2.I2.i1.p1.3.m3.1.1b.cmml" xref="A2.I2.i1.p1.3.m3.1.1"><leq id="A2.I2.i1.p1.3.m3.1.1.3.cmml" xref="A2.I2.i1.p1.3.m3.1.1.3"></leq><apply id="A2.I2.i1.p1.3.m3.1.1.2.cmml" xref="A2.I2.i1.p1.3.m3.1.1.2"><plus id="A2.I2.i1.p1.3.m3.1.1.2.1.cmml" xref="A2.I2.i1.p1.3.m3.1.1.2.1"></plus><apply id="A2.I2.i1.p1.3.m3.1.1.2.2.cmml" xref="A2.I2.i1.p1.3.m3.1.1.2.2"><csymbol cd="ambiguous" id="A2.I2.i1.p1.3.m3.1.1.2.2.1.cmml" xref="A2.I2.i1.p1.3.m3.1.1.2.2">subscript</csymbol><ci id="A2.I2.i1.p1.3.m3.1.1.2.2.2.cmml" xref="A2.I2.i1.p1.3.m3.1.1.2.2.2">𝑡</ci><ci id="A2.I2.i1.p1.3.m3.1.1.2.2.3.cmml" xref="A2.I2.i1.p1.3.m3.1.1.2.2.3">𝑘</ci></apply><ci id="A2.I2.i1.p1.3.m3.1.1.2.3.cmml" xref="A2.I2.i1.p1.3.m3.1.1.2.3">𝑚</ci></apply><apply id="A2.I2.i1.p1.3.m3.1.1.4.cmml" xref="A2.I2.i1.p1.3.m3.1.1.4"><csymbol cd="ambiguous" id="A2.I2.i1.p1.3.m3.1.1.4.1.cmml" xref="A2.I2.i1.p1.3.m3.1.1.4">subscript</csymbol><ci id="A2.I2.i1.p1.3.m3.1.1.4.2.cmml" xref="A2.I2.i1.p1.3.m3.1.1.4.2">𝑡</ci><ci id="A2.I2.i1.p1.3.m3.1.1.4.3.cmml" xref="A2.I2.i1.p1.3.m3.1.1.4.3">f</ci></apply></apply><apply id="A2.I2.i1.p1.3.m3.1.1c.cmml" xref="A2.I2.i1.p1.3.m3.1.1"><lt id="A2.I2.i1.p1.3.m3.1.1.5.cmml" xref="A2.I2.i1.p1.3.m3.1.1.5"></lt><share href="https://arxiv.org/html/2410.00037v2#A2.I2.i1.p1.3.m3.1.1.4.cmml" id="A2.I2.i1.p1.3.m3.1.1d.cmml" xref="A2.I2.i1.p1.3.m3.1.1"></share><apply id="A2.I2.i1.p1.3.m3.1.1.6.cmml" xref="A2.I2.i1.p1.3.m3.1.1.6"><plus id="A2.I2.i1.p1.3.m3.1.1.6.1.cmml" xref="A2.I2.i1.p1.3.m3.1.1.6.1"></plus><apply id="A2.I2.i1.p1.3.m3.1.1.6.2.cmml" xref="A2.I2.i1.p1.3.m3.1.1.6.2"><csymbol cd="ambiguous" id="A2.I2.i1.p1.3.m3.1.1.6.2.1.cmml" xref="A2.I2.i1.p1.3.m3.1.1.6.2">subscript</csymbol><ci id="A2.I2.i1.p1.3.m3.1.1.6.2.2.cmml" xref="A2.I2.i1.p1.3.m3.1.1.6.2.2">𝑡</ci><ci id="A2.I2.i1.p1.3.m3.1.1.6.2.3.cmml" xref="A2.I2.i1.p1.3.m3.1.1.6.2.3">𝑘</ci></apply><ci id="A2.I2.i1.p1.3.m3.1.1.6.3.cmml" xref="A2.I2.i1.p1.3.m3.1.1.6.3">𝑀</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.I2.i1.p1.3.m3.1c">t_{k}+m\leq t_{\mathrm{f}}&lt;t_{k}+M</annotation><annotation encoding="application/x-llamapun" id="A2.I2.i1.p1.3.m3.1d">italic_t start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT + italic_m ≤ italic_t start_POSTSUBSCRIPT roman_f end_POSTSUBSCRIPT &lt; italic_t start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT + italic_M</annotation></semantics></math>, where <math alttext="[t_{k}+m,t_{k}+M)" class="ltx_Math" display="inline" id="A2.I2.i1.p1.4.m4.2"><semantics id="A2.I2.i1.p1.4.m4.2a"><mrow id="A2.I2.i1.p1.4.m4.2.2.2" xref="A2.I2.i1.p1.4.m4.2.2.3.cmml"><mo id="A2.I2.i1.p1.4.m4.2.2.2.3" stretchy="false" xref="A2.I2.i1.p1.4.m4.2.2.3.cmml">[</mo><mrow id="A2.I2.i1.p1.4.m4.1.1.1.1" xref="A2.I2.i1.p1.4.m4.1.1.1.1.cmml"><msub id="A2.I2.i1.p1.4.m4.1.1.1.1.2" xref="A2.I2.i1.p1.4.m4.1.1.1.1.2.cmml"><mi id="A2.I2.i1.p1.4.m4.1.1.1.1.2.2" xref="A2.I2.i1.p1.4.m4.1.1.1.1.2.2.cmml">t</mi><mi id="A2.I2.i1.p1.4.m4.1.1.1.1.2.3" xref="A2.I2.i1.p1.4.m4.1.1.1.1.2.3.cmml">k</mi></msub><mo id="A2.I2.i1.p1.4.m4.1.1.1.1.1" xref="A2.I2.i1.p1.4.m4.1.1.1.1.1.cmml">+</mo><mi id="A2.I2.i1.p1.4.m4.1.1.1.1.3" xref="A2.I2.i1.p1.4.m4.1.1.1.1.3.cmml">m</mi></mrow><mo id="A2.I2.i1.p1.4.m4.2.2.2.4" xref="A2.I2.i1.p1.4.m4.2.2.3.cmml">,</mo><mrow id="A2.I2.i1.p1.4.m4.2.2.2.2" xref="A2.I2.i1.p1.4.m4.2.2.2.2.cmml"><msub id="A2.I2.i1.p1.4.m4.2.2.2.2.2" xref="A2.I2.i1.p1.4.m4.2.2.2.2.2.cmml"><mi id="A2.I2.i1.p1.4.m4.2.2.2.2.2.2" xref="A2.I2.i1.p1.4.m4.2.2.2.2.2.2.cmml">t</mi><mi id="A2.I2.i1.p1.4.m4.2.2.2.2.2.3" xref="A2.I2.i1.p1.4.m4.2.2.2.2.2.3.cmml">k</mi></msub><mo id="A2.I2.i1.p1.4.m4.2.2.2.2.1" xref="A2.I2.i1.p1.4.m4.2.2.2.2.1.cmml">+</mo><mi id="A2.I2.i1.p1.4.m4.2.2.2.2.3" xref="A2.I2.i1.p1.4.m4.2.2.2.2.3.cmml">M</mi></mrow><mo id="A2.I2.i1.p1.4.m4.2.2.2.5" stretchy="false" xref="A2.I2.i1.p1.4.m4.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.I2.i1.p1.4.m4.2b"><interval closure="closed-open" id="A2.I2.i1.p1.4.m4.2.2.3.cmml" xref="A2.I2.i1.p1.4.m4.2.2.2"><apply id="A2.I2.i1.p1.4.m4.1.1.1.1.cmml" xref="A2.I2.i1.p1.4.m4.1.1.1.1"><plus id="A2.I2.i1.p1.4.m4.1.1.1.1.1.cmml" xref="A2.I2.i1.p1.4.m4.1.1.1.1.1"></plus><apply id="A2.I2.i1.p1.4.m4.1.1.1.1.2.cmml" xref="A2.I2.i1.p1.4.m4.1.1.1.1.2"><csymbol cd="ambiguous" id="A2.I2.i1.p1.4.m4.1.1.1.1.2.1.cmml" xref="A2.I2.i1.p1.4.m4.1.1.1.1.2">subscript</csymbol><ci id="A2.I2.i1.p1.4.m4.1.1.1.1.2.2.cmml" xref="A2.I2.i1.p1.4.m4.1.1.1.1.2.2">𝑡</ci><ci id="A2.I2.i1.p1.4.m4.1.1.1.1.2.3.cmml" xref="A2.I2.i1.p1.4.m4.1.1.1.1.2.3">𝑘</ci></apply><ci id="A2.I2.i1.p1.4.m4.1.1.1.1.3.cmml" xref="A2.I2.i1.p1.4.m4.1.1.1.1.3">𝑚</ci></apply><apply id="A2.I2.i1.p1.4.m4.2.2.2.2.cmml" xref="A2.I2.i1.p1.4.m4.2.2.2.2"><plus id="A2.I2.i1.p1.4.m4.2.2.2.2.1.cmml" xref="A2.I2.i1.p1.4.m4.2.2.2.2.1"></plus><apply id="A2.I2.i1.p1.4.m4.2.2.2.2.2.cmml" xref="A2.I2.i1.p1.4.m4.2.2.2.2.2"><csymbol cd="ambiguous" id="A2.I2.i1.p1.4.m4.2.2.2.2.2.1.cmml" xref="A2.I2.i1.p1.4.m4.2.2.2.2.2">subscript</csymbol><ci id="A2.I2.i1.p1.4.m4.2.2.2.2.2.2.cmml" xref="A2.I2.i1.p1.4.m4.2.2.2.2.2.2">𝑡</ci><ci id="A2.I2.i1.p1.4.m4.2.2.2.2.2.3.cmml" xref="A2.I2.i1.p1.4.m4.2.2.2.2.2.3">𝑘</ci></apply><ci id="A2.I2.i1.p1.4.m4.2.2.2.2.3.cmml" xref="A2.I2.i1.p1.4.m4.2.2.2.2.3">𝑀</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="A2.I2.i1.p1.4.m4.2c">[t_{k}+m,t_{k}+M)</annotation><annotation encoding="application/x-llamapun" id="A2.I2.i1.p1.4.m4.2d">[ italic_t start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT + italic_m , italic_t start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT + italic_M )</annotation></semantics></math> is the temporal window from which we select a keypoint. Note, for a given <math alttext="t_{\mathrm{f}}" class="ltx_Math" display="inline" id="A2.I2.i1.p1.5.m5.1"><semantics id="A2.I2.i1.p1.5.m5.1a"><msub id="A2.I2.i1.p1.5.m5.1.1" xref="A2.I2.i1.p1.5.m5.1.1.cmml"><mi id="A2.I2.i1.p1.5.m5.1.1.2" xref="A2.I2.i1.p1.5.m5.1.1.2.cmml">t</mi><mi id="A2.I2.i1.p1.5.m5.1.1.3" mathvariant="normal" xref="A2.I2.i1.p1.5.m5.1.1.3.cmml">f</mi></msub><annotation-xml encoding="MathML-Content" id="A2.I2.i1.p1.5.m5.1b"><apply id="A2.I2.i1.p1.5.m5.1.1.cmml" xref="A2.I2.i1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="A2.I2.i1.p1.5.m5.1.1.1.cmml" xref="A2.I2.i1.p1.5.m5.1.1">subscript</csymbol><ci id="A2.I2.i1.p1.5.m5.1.1.2.cmml" xref="A2.I2.i1.p1.5.m5.1.1.2">𝑡</ci><ci id="A2.I2.i1.p1.5.m5.1.1.3.cmml" xref="A2.I2.i1.p1.5.m5.1.1.3">f</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.I2.i1.p1.5.m5.1c">t_{\mathrm{f}}</annotation><annotation encoding="application/x-llamapun" id="A2.I2.i1.p1.5.m5.1d">italic_t start_POSTSUBSCRIPT roman_f end_POSTSUBSCRIPT</annotation></semantics></math>, the corresponding frequency <math alttext="f_{\mathrm{f}}" class="ltx_Math" display="inline" id="A2.I2.i1.p1.6.m6.1"><semantics id="A2.I2.i1.p1.6.m6.1a"><msub id="A2.I2.i1.p1.6.m6.1.1" xref="A2.I2.i1.p1.6.m6.1.1.cmml"><mi id="A2.I2.i1.p1.6.m6.1.1.2" xref="A2.I2.i1.p1.6.m6.1.1.2.cmml">f</mi><mi id="A2.I2.i1.p1.6.m6.1.1.3" mathvariant="normal" xref="A2.I2.i1.p1.6.m6.1.1.3.cmml">f</mi></msub><annotation-xml encoding="MathML-Content" id="A2.I2.i1.p1.6.m6.1b"><apply id="A2.I2.i1.p1.6.m6.1.1.cmml" xref="A2.I2.i1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="A2.I2.i1.p1.6.m6.1.1.1.cmml" xref="A2.I2.i1.p1.6.m6.1.1">subscript</csymbol><ci id="A2.I2.i1.p1.6.m6.1.1.2.cmml" xref="A2.I2.i1.p1.6.m6.1.1.2">𝑓</ci><ci id="A2.I2.i1.p1.6.m6.1.1.3.cmml" xref="A2.I2.i1.p1.6.m6.1.1.3">f</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.I2.i1.p1.6.m6.1c">f_{\mathrm{f}}</annotation><annotation encoding="application/x-llamapun" id="A2.I2.i1.p1.6.m6.1d">italic_f start_POSTSUBSCRIPT roman_f end_POSTSUBSCRIPT</annotation></semantics></math> is unique by design of the filters.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A2.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I2.i2.p1">
<p class="ltx_p" id="A2.I2.i2.p1.4">A backward keypoint <math alttext="(t_{\mathrm{b}},f_{\mathrm{b}})" class="ltx_Math" display="inline" id="A2.I2.i2.p1.1.m1.2"><semantics id="A2.I2.i2.p1.1.m1.2a"><mrow id="A2.I2.i2.p1.1.m1.2.2.2" xref="A2.I2.i2.p1.1.m1.2.2.3.cmml"><mo id="A2.I2.i2.p1.1.m1.2.2.2.3" stretchy="false" xref="A2.I2.i2.p1.1.m1.2.2.3.cmml">(</mo><msub id="A2.I2.i2.p1.1.m1.1.1.1.1" xref="A2.I2.i2.p1.1.m1.1.1.1.1.cmml"><mi id="A2.I2.i2.p1.1.m1.1.1.1.1.2" xref="A2.I2.i2.p1.1.m1.1.1.1.1.2.cmml">t</mi><mi id="A2.I2.i2.p1.1.m1.1.1.1.1.3" mathvariant="normal" xref="A2.I2.i2.p1.1.m1.1.1.1.1.3.cmml">b</mi></msub><mo id="A2.I2.i2.p1.1.m1.2.2.2.4" xref="A2.I2.i2.p1.1.m1.2.2.3.cmml">,</mo><msub id="A2.I2.i2.p1.1.m1.2.2.2.2" xref="A2.I2.i2.p1.1.m1.2.2.2.2.cmml"><mi id="A2.I2.i2.p1.1.m1.2.2.2.2.2" xref="A2.I2.i2.p1.1.m1.2.2.2.2.2.cmml">f</mi><mi id="A2.I2.i2.p1.1.m1.2.2.2.2.3" mathvariant="normal" xref="A2.I2.i2.p1.1.m1.2.2.2.2.3.cmml">b</mi></msub><mo id="A2.I2.i2.p1.1.m1.2.2.2.5" stretchy="false" xref="A2.I2.i2.p1.1.m1.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.I2.i2.p1.1.m1.2b"><interval closure="open" id="A2.I2.i2.p1.1.m1.2.2.3.cmml" xref="A2.I2.i2.p1.1.m1.2.2.2"><apply id="A2.I2.i2.p1.1.m1.1.1.1.1.cmml" xref="A2.I2.i2.p1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="A2.I2.i2.p1.1.m1.1.1.1.1.1.cmml" xref="A2.I2.i2.p1.1.m1.1.1.1.1">subscript</csymbol><ci id="A2.I2.i2.p1.1.m1.1.1.1.1.2.cmml" xref="A2.I2.i2.p1.1.m1.1.1.1.1.2">𝑡</ci><ci id="A2.I2.i2.p1.1.m1.1.1.1.1.3.cmml" xref="A2.I2.i2.p1.1.m1.1.1.1.1.3">b</ci></apply><apply id="A2.I2.i2.p1.1.m1.2.2.2.2.cmml" xref="A2.I2.i2.p1.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="A2.I2.i2.p1.1.m1.2.2.2.2.1.cmml" xref="A2.I2.i2.p1.1.m1.2.2.2.2">subscript</csymbol><ci id="A2.I2.i2.p1.1.m1.2.2.2.2.2.cmml" xref="A2.I2.i2.p1.1.m1.2.2.2.2.2">𝑓</ci><ci id="A2.I2.i2.p1.1.m1.2.2.2.2.3.cmml" xref="A2.I2.i2.p1.1.m1.2.2.2.2.3">b</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="A2.I2.i2.p1.1.m1.2c">(t_{\mathrm{b}},f_{\mathrm{b}})</annotation><annotation encoding="application/x-llamapun" id="A2.I2.i2.p1.1.m1.2d">( italic_t start_POSTSUBSCRIPT roman_b end_POSTSUBSCRIPT , italic_f start_POSTSUBSCRIPT roman_b end_POSTSUBSCRIPT )</annotation></semantics></math>, which is determined by the keypoint closest in time to <math alttext="t_{k}" class="ltx_Math" display="inline" id="A2.I2.i2.p1.2.m2.1"><semantics id="A2.I2.i2.p1.2.m2.1a"><msub id="A2.I2.i2.p1.2.m2.1.1" xref="A2.I2.i2.p1.2.m2.1.1.cmml"><mi id="A2.I2.i2.p1.2.m2.1.1.2" xref="A2.I2.i2.p1.2.m2.1.1.2.cmml">t</mi><mi id="A2.I2.i2.p1.2.m2.1.1.3" xref="A2.I2.i2.p1.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="A2.I2.i2.p1.2.m2.1b"><apply id="A2.I2.i2.p1.2.m2.1.1.cmml" xref="A2.I2.i2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A2.I2.i2.p1.2.m2.1.1.1.cmml" xref="A2.I2.i2.p1.2.m2.1.1">subscript</csymbol><ci id="A2.I2.i2.p1.2.m2.1.1.2.cmml" xref="A2.I2.i2.p1.2.m2.1.1.2">𝑡</ci><ci id="A2.I2.i2.p1.2.m2.1.1.3.cmml" xref="A2.I2.i2.p1.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.I2.i2.p1.2.m2.1c">t_{k}</annotation><annotation encoding="application/x-llamapun" id="A2.I2.i2.p1.2.m2.1d">italic_t start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> such that <math alttext="t_{k}-M<t_{\mathrm{b}}\leq t_{i}-m" class="ltx_Math" display="inline" id="A2.I2.i2.p1.3.m3.1"><semantics id="A2.I2.i2.p1.3.m3.1a"><mrow id="A2.I2.i2.p1.3.m3.1.1" xref="A2.I2.i2.p1.3.m3.1.1.cmml"><mrow id="A2.I2.i2.p1.3.m3.1.1.2" xref="A2.I2.i2.p1.3.m3.1.1.2.cmml"><msub id="A2.I2.i2.p1.3.m3.1.1.2.2" xref="A2.I2.i2.p1.3.m3.1.1.2.2.cmml"><mi id="A2.I2.i2.p1.3.m3.1.1.2.2.2" xref="A2.I2.i2.p1.3.m3.1.1.2.2.2.cmml">t</mi><mi id="A2.I2.i2.p1.3.m3.1.1.2.2.3" xref="A2.I2.i2.p1.3.m3.1.1.2.2.3.cmml">k</mi></msub><mo id="A2.I2.i2.p1.3.m3.1.1.2.1" xref="A2.I2.i2.p1.3.m3.1.1.2.1.cmml">−</mo><mi id="A2.I2.i2.p1.3.m3.1.1.2.3" xref="A2.I2.i2.p1.3.m3.1.1.2.3.cmml">M</mi></mrow><mo id="A2.I2.i2.p1.3.m3.1.1.3" xref="A2.I2.i2.p1.3.m3.1.1.3.cmml">&lt;</mo><msub id="A2.I2.i2.p1.3.m3.1.1.4" xref="A2.I2.i2.p1.3.m3.1.1.4.cmml"><mi id="A2.I2.i2.p1.3.m3.1.1.4.2" xref="A2.I2.i2.p1.3.m3.1.1.4.2.cmml">t</mi><mi id="A2.I2.i2.p1.3.m3.1.1.4.3" mathvariant="normal" xref="A2.I2.i2.p1.3.m3.1.1.4.3.cmml">b</mi></msub><mo id="A2.I2.i2.p1.3.m3.1.1.5" xref="A2.I2.i2.p1.3.m3.1.1.5.cmml">≤</mo><mrow id="A2.I2.i2.p1.3.m3.1.1.6" xref="A2.I2.i2.p1.3.m3.1.1.6.cmml"><msub id="A2.I2.i2.p1.3.m3.1.1.6.2" xref="A2.I2.i2.p1.3.m3.1.1.6.2.cmml"><mi id="A2.I2.i2.p1.3.m3.1.1.6.2.2" xref="A2.I2.i2.p1.3.m3.1.1.6.2.2.cmml">t</mi><mi id="A2.I2.i2.p1.3.m3.1.1.6.2.3" xref="A2.I2.i2.p1.3.m3.1.1.6.2.3.cmml">i</mi></msub><mo id="A2.I2.i2.p1.3.m3.1.1.6.1" xref="A2.I2.i2.p1.3.m3.1.1.6.1.cmml">−</mo><mi id="A2.I2.i2.p1.3.m3.1.1.6.3" xref="A2.I2.i2.p1.3.m3.1.1.6.3.cmml">m</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.I2.i2.p1.3.m3.1b"><apply id="A2.I2.i2.p1.3.m3.1.1.cmml" xref="A2.I2.i2.p1.3.m3.1.1"><and id="A2.I2.i2.p1.3.m3.1.1a.cmml" xref="A2.I2.i2.p1.3.m3.1.1"></and><apply id="A2.I2.i2.p1.3.m3.1.1b.cmml" xref="A2.I2.i2.p1.3.m3.1.1"><lt id="A2.I2.i2.p1.3.m3.1.1.3.cmml" xref="A2.I2.i2.p1.3.m3.1.1.3"></lt><apply id="A2.I2.i2.p1.3.m3.1.1.2.cmml" xref="A2.I2.i2.p1.3.m3.1.1.2"><minus id="A2.I2.i2.p1.3.m3.1.1.2.1.cmml" xref="A2.I2.i2.p1.3.m3.1.1.2.1"></minus><apply id="A2.I2.i2.p1.3.m3.1.1.2.2.cmml" xref="A2.I2.i2.p1.3.m3.1.1.2.2"><csymbol cd="ambiguous" id="A2.I2.i2.p1.3.m3.1.1.2.2.1.cmml" xref="A2.I2.i2.p1.3.m3.1.1.2.2">subscript</csymbol><ci id="A2.I2.i2.p1.3.m3.1.1.2.2.2.cmml" xref="A2.I2.i2.p1.3.m3.1.1.2.2.2">𝑡</ci><ci id="A2.I2.i2.p1.3.m3.1.1.2.2.3.cmml" xref="A2.I2.i2.p1.3.m3.1.1.2.2.3">𝑘</ci></apply><ci id="A2.I2.i2.p1.3.m3.1.1.2.3.cmml" xref="A2.I2.i2.p1.3.m3.1.1.2.3">𝑀</ci></apply><apply id="A2.I2.i2.p1.3.m3.1.1.4.cmml" xref="A2.I2.i2.p1.3.m3.1.1.4"><csymbol cd="ambiguous" id="A2.I2.i2.p1.3.m3.1.1.4.1.cmml" xref="A2.I2.i2.p1.3.m3.1.1.4">subscript</csymbol><ci id="A2.I2.i2.p1.3.m3.1.1.4.2.cmml" xref="A2.I2.i2.p1.3.m3.1.1.4.2">𝑡</ci><ci id="A2.I2.i2.p1.3.m3.1.1.4.3.cmml" xref="A2.I2.i2.p1.3.m3.1.1.4.3">b</ci></apply></apply><apply id="A2.I2.i2.p1.3.m3.1.1c.cmml" xref="A2.I2.i2.p1.3.m3.1.1"><leq id="A2.I2.i2.p1.3.m3.1.1.5.cmml" xref="A2.I2.i2.p1.3.m3.1.1.5"></leq><share href="https://arxiv.org/html/2410.00037v2#A2.I2.i2.p1.3.m3.1.1.4.cmml" id="A2.I2.i2.p1.3.m3.1.1d.cmml" xref="A2.I2.i2.p1.3.m3.1.1"></share><apply id="A2.I2.i2.p1.3.m3.1.1.6.cmml" xref="A2.I2.i2.p1.3.m3.1.1.6"><minus id="A2.I2.i2.p1.3.m3.1.1.6.1.cmml" xref="A2.I2.i2.p1.3.m3.1.1.6.1"></minus><apply id="A2.I2.i2.p1.3.m3.1.1.6.2.cmml" xref="A2.I2.i2.p1.3.m3.1.1.6.2"><csymbol cd="ambiguous" id="A2.I2.i2.p1.3.m3.1.1.6.2.1.cmml" xref="A2.I2.i2.p1.3.m3.1.1.6.2">subscript</csymbol><ci id="A2.I2.i2.p1.3.m3.1.1.6.2.2.cmml" xref="A2.I2.i2.p1.3.m3.1.1.6.2.2">𝑡</ci><ci id="A2.I2.i2.p1.3.m3.1.1.6.2.3.cmml" xref="A2.I2.i2.p1.3.m3.1.1.6.2.3">𝑖</ci></apply><ci id="A2.I2.i2.p1.3.m3.1.1.6.3.cmml" xref="A2.I2.i2.p1.3.m3.1.1.6.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.I2.i2.p1.3.m3.1c">t_{k}-M&lt;t_{\mathrm{b}}\leq t_{i}-m</annotation><annotation encoding="application/x-llamapun" id="A2.I2.i2.p1.3.m3.1d">italic_t start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT - italic_M &lt; italic_t start_POSTSUBSCRIPT roman_b end_POSTSUBSCRIPT ≤ italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT - italic_m</annotation></semantics></math>, where <math alttext="(t_{k}-M,t_{k}-m]" class="ltx_Math" display="inline" id="A2.I2.i2.p1.4.m4.2"><semantics id="A2.I2.i2.p1.4.m4.2a"><mrow id="A2.I2.i2.p1.4.m4.2.2.2" xref="A2.I2.i2.p1.4.m4.2.2.3.cmml"><mo id="A2.I2.i2.p1.4.m4.2.2.2.3" stretchy="false" xref="A2.I2.i2.p1.4.m4.2.2.3.cmml">(</mo><mrow id="A2.I2.i2.p1.4.m4.1.1.1.1" xref="A2.I2.i2.p1.4.m4.1.1.1.1.cmml"><msub id="A2.I2.i2.p1.4.m4.1.1.1.1.2" xref="A2.I2.i2.p1.4.m4.1.1.1.1.2.cmml"><mi id="A2.I2.i2.p1.4.m4.1.1.1.1.2.2" xref="A2.I2.i2.p1.4.m4.1.1.1.1.2.2.cmml">t</mi><mi id="A2.I2.i2.p1.4.m4.1.1.1.1.2.3" xref="A2.I2.i2.p1.4.m4.1.1.1.1.2.3.cmml">k</mi></msub><mo id="A2.I2.i2.p1.4.m4.1.1.1.1.1" xref="A2.I2.i2.p1.4.m4.1.1.1.1.1.cmml">−</mo><mi id="A2.I2.i2.p1.4.m4.1.1.1.1.3" xref="A2.I2.i2.p1.4.m4.1.1.1.1.3.cmml">M</mi></mrow><mo id="A2.I2.i2.p1.4.m4.2.2.2.4" xref="A2.I2.i2.p1.4.m4.2.2.3.cmml">,</mo><mrow id="A2.I2.i2.p1.4.m4.2.2.2.2" xref="A2.I2.i2.p1.4.m4.2.2.2.2.cmml"><msub id="A2.I2.i2.p1.4.m4.2.2.2.2.2" xref="A2.I2.i2.p1.4.m4.2.2.2.2.2.cmml"><mi id="A2.I2.i2.p1.4.m4.2.2.2.2.2.2" xref="A2.I2.i2.p1.4.m4.2.2.2.2.2.2.cmml">t</mi><mi id="A2.I2.i2.p1.4.m4.2.2.2.2.2.3" xref="A2.I2.i2.p1.4.m4.2.2.2.2.2.3.cmml">k</mi></msub><mo id="A2.I2.i2.p1.4.m4.2.2.2.2.1" xref="A2.I2.i2.p1.4.m4.2.2.2.2.1.cmml">−</mo><mi id="A2.I2.i2.p1.4.m4.2.2.2.2.3" xref="A2.I2.i2.p1.4.m4.2.2.2.2.3.cmml">m</mi></mrow><mo id="A2.I2.i2.p1.4.m4.2.2.2.5" stretchy="false" xref="A2.I2.i2.p1.4.m4.2.2.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.I2.i2.p1.4.m4.2b"><interval closure="open-closed" id="A2.I2.i2.p1.4.m4.2.2.3.cmml" xref="A2.I2.i2.p1.4.m4.2.2.2"><apply id="A2.I2.i2.p1.4.m4.1.1.1.1.cmml" xref="A2.I2.i2.p1.4.m4.1.1.1.1"><minus id="A2.I2.i2.p1.4.m4.1.1.1.1.1.cmml" xref="A2.I2.i2.p1.4.m4.1.1.1.1.1"></minus><apply id="A2.I2.i2.p1.4.m4.1.1.1.1.2.cmml" xref="A2.I2.i2.p1.4.m4.1.1.1.1.2"><csymbol cd="ambiguous" id="A2.I2.i2.p1.4.m4.1.1.1.1.2.1.cmml" xref="A2.I2.i2.p1.4.m4.1.1.1.1.2">subscript</csymbol><ci id="A2.I2.i2.p1.4.m4.1.1.1.1.2.2.cmml" xref="A2.I2.i2.p1.4.m4.1.1.1.1.2.2">𝑡</ci><ci id="A2.I2.i2.p1.4.m4.1.1.1.1.2.3.cmml" xref="A2.I2.i2.p1.4.m4.1.1.1.1.2.3">𝑘</ci></apply><ci id="A2.I2.i2.p1.4.m4.1.1.1.1.3.cmml" xref="A2.I2.i2.p1.4.m4.1.1.1.1.3">𝑀</ci></apply><apply id="A2.I2.i2.p1.4.m4.2.2.2.2.cmml" xref="A2.I2.i2.p1.4.m4.2.2.2.2"><minus id="A2.I2.i2.p1.4.m4.2.2.2.2.1.cmml" xref="A2.I2.i2.p1.4.m4.2.2.2.2.1"></minus><apply id="A2.I2.i2.p1.4.m4.2.2.2.2.2.cmml" xref="A2.I2.i2.p1.4.m4.2.2.2.2.2"><csymbol cd="ambiguous" id="A2.I2.i2.p1.4.m4.2.2.2.2.2.1.cmml" xref="A2.I2.i2.p1.4.m4.2.2.2.2.2">subscript</csymbol><ci id="A2.I2.i2.p1.4.m4.2.2.2.2.2.2.cmml" xref="A2.I2.i2.p1.4.m4.2.2.2.2.2.2">𝑡</ci><ci id="A2.I2.i2.p1.4.m4.2.2.2.2.2.3.cmml" xref="A2.I2.i2.p1.4.m4.2.2.2.2.2.3">𝑘</ci></apply><ci id="A2.I2.i2.p1.4.m4.2.2.2.2.3.cmml" xref="A2.I2.i2.p1.4.m4.2.2.2.2.3">𝑚</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="A2.I2.i2.p1.4.m4.2c">(t_{k}-M,t_{k}-m]</annotation><annotation encoding="application/x-llamapun" id="A2.I2.i2.p1.4.m4.2d">( italic_t start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT - italic_M , italic_t start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT - italic_m ]</annotation></semantics></math> is the temporal window in which the procedure selects a keypoint.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="A2.SS0.SSS0.Px2.p2">
<p class="ltx_p" id="A2.SS0.SSS0.Px2.p2.6">We extract a signature only if both the forward and backward keypoints exist. In that case the signature is defined by the tuple <math alttext="s_{k}=(f_{\mathrm{b}},f_{k},f_{\mathrm{f}},t_{k}-t_{\mathrm{b}},t_{\mathrm{f}}%
-t_{k})" class="ltx_Math" display="inline" id="A2.SS0.SSS0.Px2.p2.1.m1.5"><semantics id="A2.SS0.SSS0.Px2.p2.1.m1.5a"><mrow id="A2.SS0.SSS0.Px2.p2.1.m1.5.5" xref="A2.SS0.SSS0.Px2.p2.1.m1.5.5.cmml"><msub id="A2.SS0.SSS0.Px2.p2.1.m1.5.5.7" xref="A2.SS0.SSS0.Px2.p2.1.m1.5.5.7.cmml"><mi id="A2.SS0.SSS0.Px2.p2.1.m1.5.5.7.2" xref="A2.SS0.SSS0.Px2.p2.1.m1.5.5.7.2.cmml">s</mi><mi id="A2.SS0.SSS0.Px2.p2.1.m1.5.5.7.3" xref="A2.SS0.SSS0.Px2.p2.1.m1.5.5.7.3.cmml">k</mi></msub><mo id="A2.SS0.SSS0.Px2.p2.1.m1.5.5.6" xref="A2.SS0.SSS0.Px2.p2.1.m1.5.5.6.cmml">=</mo><mrow id="A2.SS0.SSS0.Px2.p2.1.m1.5.5.5.5" xref="A2.SS0.SSS0.Px2.p2.1.m1.5.5.5.6.cmml"><mo id="A2.SS0.SSS0.Px2.p2.1.m1.5.5.5.5.6" stretchy="false" xref="A2.SS0.SSS0.Px2.p2.1.m1.5.5.5.6.cmml">(</mo><msub id="A2.SS0.SSS0.Px2.p2.1.m1.1.1.1.1.1" xref="A2.SS0.SSS0.Px2.p2.1.m1.1.1.1.1.1.cmml"><mi id="A2.SS0.SSS0.Px2.p2.1.m1.1.1.1.1.1.2" xref="A2.SS0.SSS0.Px2.p2.1.m1.1.1.1.1.1.2.cmml">f</mi><mi id="A2.SS0.SSS0.Px2.p2.1.m1.1.1.1.1.1.3" mathvariant="normal" xref="A2.SS0.SSS0.Px2.p2.1.m1.1.1.1.1.1.3.cmml">b</mi></msub><mo id="A2.SS0.SSS0.Px2.p2.1.m1.5.5.5.5.7" xref="A2.SS0.SSS0.Px2.p2.1.m1.5.5.5.6.cmml">,</mo><msub id="A2.SS0.SSS0.Px2.p2.1.m1.2.2.2.2.2" xref="A2.SS0.SSS0.Px2.p2.1.m1.2.2.2.2.2.cmml"><mi id="A2.SS0.SSS0.Px2.p2.1.m1.2.2.2.2.2.2" xref="A2.SS0.SSS0.Px2.p2.1.m1.2.2.2.2.2.2.cmml">f</mi><mi id="A2.SS0.SSS0.Px2.p2.1.m1.2.2.2.2.2.3" xref="A2.SS0.SSS0.Px2.p2.1.m1.2.2.2.2.2.3.cmml">k</mi></msub><mo id="A2.SS0.SSS0.Px2.p2.1.m1.5.5.5.5.8" xref="A2.SS0.SSS0.Px2.p2.1.m1.5.5.5.6.cmml">,</mo><msub id="A2.SS0.SSS0.Px2.p2.1.m1.3.3.3.3.3" xref="A2.SS0.SSS0.Px2.p2.1.m1.3.3.3.3.3.cmml"><mi id="A2.SS0.SSS0.Px2.p2.1.m1.3.3.3.3.3.2" xref="A2.SS0.SSS0.Px2.p2.1.m1.3.3.3.3.3.2.cmml">f</mi><mi id="A2.SS0.SSS0.Px2.p2.1.m1.3.3.3.3.3.3" mathvariant="normal" xref="A2.SS0.SSS0.Px2.p2.1.m1.3.3.3.3.3.3.cmml">f</mi></msub><mo id="A2.SS0.SSS0.Px2.p2.1.m1.5.5.5.5.9" xref="A2.SS0.SSS0.Px2.p2.1.m1.5.5.5.6.cmml">,</mo><mrow id="A2.SS0.SSS0.Px2.p2.1.m1.4.4.4.4.4" xref="A2.SS0.SSS0.Px2.p2.1.m1.4.4.4.4.4.cmml"><msub id="A2.SS0.SSS0.Px2.p2.1.m1.4.4.4.4.4.2" xref="A2.SS0.SSS0.Px2.p2.1.m1.4.4.4.4.4.2.cmml"><mi id="A2.SS0.SSS0.Px2.p2.1.m1.4.4.4.4.4.2.2" xref="A2.SS0.SSS0.Px2.p2.1.m1.4.4.4.4.4.2.2.cmml">t</mi><mi id="A2.SS0.SSS0.Px2.p2.1.m1.4.4.4.4.4.2.3" xref="A2.SS0.SSS0.Px2.p2.1.m1.4.4.4.4.4.2.3.cmml">k</mi></msub><mo id="A2.SS0.SSS0.Px2.p2.1.m1.4.4.4.4.4.1" xref="A2.SS0.SSS0.Px2.p2.1.m1.4.4.4.4.4.1.cmml">−</mo><msub id="A2.SS0.SSS0.Px2.p2.1.m1.4.4.4.4.4.3" xref="A2.SS0.SSS0.Px2.p2.1.m1.4.4.4.4.4.3.cmml"><mi id="A2.SS0.SSS0.Px2.p2.1.m1.4.4.4.4.4.3.2" xref="A2.SS0.SSS0.Px2.p2.1.m1.4.4.4.4.4.3.2.cmml">t</mi><mi id="A2.SS0.SSS0.Px2.p2.1.m1.4.4.4.4.4.3.3" mathvariant="normal" xref="A2.SS0.SSS0.Px2.p2.1.m1.4.4.4.4.4.3.3.cmml">b</mi></msub></mrow><mo id="A2.SS0.SSS0.Px2.p2.1.m1.5.5.5.5.10" xref="A2.SS0.SSS0.Px2.p2.1.m1.5.5.5.6.cmml">,</mo><mrow id="A2.SS0.SSS0.Px2.p2.1.m1.5.5.5.5.5" xref="A2.SS0.SSS0.Px2.p2.1.m1.5.5.5.5.5.cmml"><msub id="A2.SS0.SSS0.Px2.p2.1.m1.5.5.5.5.5.2" xref="A2.SS0.SSS0.Px2.p2.1.m1.5.5.5.5.5.2.cmml"><mi id="A2.SS0.SSS0.Px2.p2.1.m1.5.5.5.5.5.2.2" xref="A2.SS0.SSS0.Px2.p2.1.m1.5.5.5.5.5.2.2.cmml">t</mi><mi id="A2.SS0.SSS0.Px2.p2.1.m1.5.5.5.5.5.2.3" mathvariant="normal" xref="A2.SS0.SSS0.Px2.p2.1.m1.5.5.5.5.5.2.3.cmml">f</mi></msub><mo id="A2.SS0.SSS0.Px2.p2.1.m1.5.5.5.5.5.1" xref="A2.SS0.SSS0.Px2.p2.1.m1.5.5.5.5.5.1.cmml">−</mo><msub id="A2.SS0.SSS0.Px2.p2.1.m1.5.5.5.5.5.3" xref="A2.SS0.SSS0.Px2.p2.1.m1.5.5.5.5.5.3.cmml"><mi id="A2.SS0.SSS0.Px2.p2.1.m1.5.5.5.5.5.3.2" xref="A2.SS0.SSS0.Px2.p2.1.m1.5.5.5.5.5.3.2.cmml">t</mi><mi id="A2.SS0.SSS0.Px2.p2.1.m1.5.5.5.5.5.3.3" xref="A2.SS0.SSS0.Px2.p2.1.m1.5.5.5.5.5.3.3.cmml">k</mi></msub></mrow><mo id="A2.SS0.SSS0.Px2.p2.1.m1.5.5.5.5.11" stretchy="false" xref="A2.SS0.SSS0.Px2.p2.1.m1.5.5.5.6.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS0.SSS0.Px2.p2.1.m1.5b"><apply id="A2.SS0.SSS0.Px2.p2.1.m1.5.5.cmml" xref="A2.SS0.SSS0.Px2.p2.1.m1.5.5"><eq id="A2.SS0.SSS0.Px2.p2.1.m1.5.5.6.cmml" xref="A2.SS0.SSS0.Px2.p2.1.m1.5.5.6"></eq><apply id="A2.SS0.SSS0.Px2.p2.1.m1.5.5.7.cmml" xref="A2.SS0.SSS0.Px2.p2.1.m1.5.5.7"><csymbol cd="ambiguous" id="A2.SS0.SSS0.Px2.p2.1.m1.5.5.7.1.cmml" xref="A2.SS0.SSS0.Px2.p2.1.m1.5.5.7">subscript</csymbol><ci id="A2.SS0.SSS0.Px2.p2.1.m1.5.5.7.2.cmml" xref="A2.SS0.SSS0.Px2.p2.1.m1.5.5.7.2">𝑠</ci><ci id="A2.SS0.SSS0.Px2.p2.1.m1.5.5.7.3.cmml" xref="A2.SS0.SSS0.Px2.p2.1.m1.5.5.7.3">𝑘</ci></apply><vector id="A2.SS0.SSS0.Px2.p2.1.m1.5.5.5.6.cmml" xref="A2.SS0.SSS0.Px2.p2.1.m1.5.5.5.5"><apply id="A2.SS0.SSS0.Px2.p2.1.m1.1.1.1.1.1.cmml" xref="A2.SS0.SSS0.Px2.p2.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.SS0.SSS0.Px2.p2.1.m1.1.1.1.1.1.1.cmml" xref="A2.SS0.SSS0.Px2.p2.1.m1.1.1.1.1.1">subscript</csymbol><ci id="A2.SS0.SSS0.Px2.p2.1.m1.1.1.1.1.1.2.cmml" xref="A2.SS0.SSS0.Px2.p2.1.m1.1.1.1.1.1.2">𝑓</ci><ci id="A2.SS0.SSS0.Px2.p2.1.m1.1.1.1.1.1.3.cmml" xref="A2.SS0.SSS0.Px2.p2.1.m1.1.1.1.1.1.3">b</ci></apply><apply id="A2.SS0.SSS0.Px2.p2.1.m1.2.2.2.2.2.cmml" xref="A2.SS0.SSS0.Px2.p2.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="A2.SS0.SSS0.Px2.p2.1.m1.2.2.2.2.2.1.cmml" xref="A2.SS0.SSS0.Px2.p2.1.m1.2.2.2.2.2">subscript</csymbol><ci id="A2.SS0.SSS0.Px2.p2.1.m1.2.2.2.2.2.2.cmml" xref="A2.SS0.SSS0.Px2.p2.1.m1.2.2.2.2.2.2">𝑓</ci><ci id="A2.SS0.SSS0.Px2.p2.1.m1.2.2.2.2.2.3.cmml" xref="A2.SS0.SSS0.Px2.p2.1.m1.2.2.2.2.2.3">𝑘</ci></apply><apply id="A2.SS0.SSS0.Px2.p2.1.m1.3.3.3.3.3.cmml" xref="A2.SS0.SSS0.Px2.p2.1.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="A2.SS0.SSS0.Px2.p2.1.m1.3.3.3.3.3.1.cmml" xref="A2.SS0.SSS0.Px2.p2.1.m1.3.3.3.3.3">subscript</csymbol><ci id="A2.SS0.SSS0.Px2.p2.1.m1.3.3.3.3.3.2.cmml" xref="A2.SS0.SSS0.Px2.p2.1.m1.3.3.3.3.3.2">𝑓</ci><ci id="A2.SS0.SSS0.Px2.p2.1.m1.3.3.3.3.3.3.cmml" xref="A2.SS0.SSS0.Px2.p2.1.m1.3.3.3.3.3.3">f</ci></apply><apply id="A2.SS0.SSS0.Px2.p2.1.m1.4.4.4.4.4.cmml" xref="A2.SS0.SSS0.Px2.p2.1.m1.4.4.4.4.4"><minus id="A2.SS0.SSS0.Px2.p2.1.m1.4.4.4.4.4.1.cmml" xref="A2.SS0.SSS0.Px2.p2.1.m1.4.4.4.4.4.1"></minus><apply id="A2.SS0.SSS0.Px2.p2.1.m1.4.4.4.4.4.2.cmml" xref="A2.SS0.SSS0.Px2.p2.1.m1.4.4.4.4.4.2"><csymbol cd="ambiguous" id="A2.SS0.SSS0.Px2.p2.1.m1.4.4.4.4.4.2.1.cmml" xref="A2.SS0.SSS0.Px2.p2.1.m1.4.4.4.4.4.2">subscript</csymbol><ci id="A2.SS0.SSS0.Px2.p2.1.m1.4.4.4.4.4.2.2.cmml" xref="A2.SS0.SSS0.Px2.p2.1.m1.4.4.4.4.4.2.2">𝑡</ci><ci id="A2.SS0.SSS0.Px2.p2.1.m1.4.4.4.4.4.2.3.cmml" xref="A2.SS0.SSS0.Px2.p2.1.m1.4.4.4.4.4.2.3">𝑘</ci></apply><apply id="A2.SS0.SSS0.Px2.p2.1.m1.4.4.4.4.4.3.cmml" xref="A2.SS0.SSS0.Px2.p2.1.m1.4.4.4.4.4.3"><csymbol cd="ambiguous" id="A2.SS0.SSS0.Px2.p2.1.m1.4.4.4.4.4.3.1.cmml" xref="A2.SS0.SSS0.Px2.p2.1.m1.4.4.4.4.4.3">subscript</csymbol><ci id="A2.SS0.SSS0.Px2.p2.1.m1.4.4.4.4.4.3.2.cmml" xref="A2.SS0.SSS0.Px2.p2.1.m1.4.4.4.4.4.3.2">𝑡</ci><ci id="A2.SS0.SSS0.Px2.p2.1.m1.4.4.4.4.4.3.3.cmml" xref="A2.SS0.SSS0.Px2.p2.1.m1.4.4.4.4.4.3.3">b</ci></apply></apply><apply id="A2.SS0.SSS0.Px2.p2.1.m1.5.5.5.5.5.cmml" xref="A2.SS0.SSS0.Px2.p2.1.m1.5.5.5.5.5"><minus id="A2.SS0.SSS0.Px2.p2.1.m1.5.5.5.5.5.1.cmml" xref="A2.SS0.SSS0.Px2.p2.1.m1.5.5.5.5.5.1"></minus><apply id="A2.SS0.SSS0.Px2.p2.1.m1.5.5.5.5.5.2.cmml" xref="A2.SS0.SSS0.Px2.p2.1.m1.5.5.5.5.5.2"><csymbol cd="ambiguous" id="A2.SS0.SSS0.Px2.p2.1.m1.5.5.5.5.5.2.1.cmml" xref="A2.SS0.SSS0.Px2.p2.1.m1.5.5.5.5.5.2">subscript</csymbol><ci id="A2.SS0.SSS0.Px2.p2.1.m1.5.5.5.5.5.2.2.cmml" xref="A2.SS0.SSS0.Px2.p2.1.m1.5.5.5.5.5.2.2">𝑡</ci><ci id="A2.SS0.SSS0.Px2.p2.1.m1.5.5.5.5.5.2.3.cmml" xref="A2.SS0.SSS0.Px2.p2.1.m1.5.5.5.5.5.2.3">f</ci></apply><apply id="A2.SS0.SSS0.Px2.p2.1.m1.5.5.5.5.5.3.cmml" xref="A2.SS0.SSS0.Px2.p2.1.m1.5.5.5.5.5.3"><csymbol cd="ambiguous" id="A2.SS0.SSS0.Px2.p2.1.m1.5.5.5.5.5.3.1.cmml" xref="A2.SS0.SSS0.Px2.p2.1.m1.5.5.5.5.5.3">subscript</csymbol><ci id="A2.SS0.SSS0.Px2.p2.1.m1.5.5.5.5.5.3.2.cmml" xref="A2.SS0.SSS0.Px2.p2.1.m1.5.5.5.5.5.3.2">𝑡</ci><ci id="A2.SS0.SSS0.Px2.p2.1.m1.5.5.5.5.5.3.3.cmml" xref="A2.SS0.SSS0.Px2.p2.1.m1.5.5.5.5.5.3.3">𝑘</ci></apply></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS0.SSS0.Px2.p2.1.m1.5c">s_{k}=(f_{\mathrm{b}},f_{k},f_{\mathrm{f}},t_{k}-t_{\mathrm{b}},t_{\mathrm{f}}%
-t_{k})</annotation><annotation encoding="application/x-llamapun" id="A2.SS0.SSS0.Px2.p2.1.m1.5d">italic_s start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT = ( italic_f start_POSTSUBSCRIPT roman_b end_POSTSUBSCRIPT , italic_f start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_f start_POSTSUBSCRIPT roman_f end_POSTSUBSCRIPT , italic_t start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT - italic_t start_POSTSUBSCRIPT roman_b end_POSTSUBSCRIPT , italic_t start_POSTSUBSCRIPT roman_f end_POSTSUBSCRIPT - italic_t start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT )</annotation></semantics></math>, which we associate to the absolute timestamp <math alttext="t_{k}" class="ltx_Math" display="inline" id="A2.SS0.SSS0.Px2.p2.2.m2.1"><semantics id="A2.SS0.SSS0.Px2.p2.2.m2.1a"><msub id="A2.SS0.SSS0.Px2.p2.2.m2.1.1" xref="A2.SS0.SSS0.Px2.p2.2.m2.1.1.cmml"><mi id="A2.SS0.SSS0.Px2.p2.2.m2.1.1.2" xref="A2.SS0.SSS0.Px2.p2.2.m2.1.1.2.cmml">t</mi><mi id="A2.SS0.SSS0.Px2.p2.2.m2.1.1.3" xref="A2.SS0.SSS0.Px2.p2.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="A2.SS0.SSS0.Px2.p2.2.m2.1b"><apply id="A2.SS0.SSS0.Px2.p2.2.m2.1.1.cmml" xref="A2.SS0.SSS0.Px2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="A2.SS0.SSS0.Px2.p2.2.m2.1.1.1.cmml" xref="A2.SS0.SSS0.Px2.p2.2.m2.1.1">subscript</csymbol><ci id="A2.SS0.SSS0.Px2.p2.2.m2.1.1.2.cmml" xref="A2.SS0.SSS0.Px2.p2.2.m2.1.1.2">𝑡</ci><ci id="A2.SS0.SSS0.Px2.p2.2.m2.1.1.3.cmml" xref="A2.SS0.SSS0.Px2.p2.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS0.SSS0.Px2.p2.2.m2.1c">t_{k}</annotation><annotation encoding="application/x-llamapun" id="A2.SS0.SSS0.Px2.p2.2.m2.1d">italic_t start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>.
In our case we set <math alttext="m=4" class="ltx_Math" display="inline" id="A2.SS0.SSS0.Px2.p2.3.m3.1"><semantics id="A2.SS0.SSS0.Px2.p2.3.m3.1a"><mrow id="A2.SS0.SSS0.Px2.p2.3.m3.1.1" xref="A2.SS0.SSS0.Px2.p2.3.m3.1.1.cmml"><mi id="A2.SS0.SSS0.Px2.p2.3.m3.1.1.2" xref="A2.SS0.SSS0.Px2.p2.3.m3.1.1.2.cmml">m</mi><mo id="A2.SS0.SSS0.Px2.p2.3.m3.1.1.1" xref="A2.SS0.SSS0.Px2.p2.3.m3.1.1.1.cmml">=</mo><mn id="A2.SS0.SSS0.Px2.p2.3.m3.1.1.3" xref="A2.SS0.SSS0.Px2.p2.3.m3.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS0.SSS0.Px2.p2.3.m3.1b"><apply id="A2.SS0.SSS0.Px2.p2.3.m3.1.1.cmml" xref="A2.SS0.SSS0.Px2.p2.3.m3.1.1"><eq id="A2.SS0.SSS0.Px2.p2.3.m3.1.1.1.cmml" xref="A2.SS0.SSS0.Px2.p2.3.m3.1.1.1"></eq><ci id="A2.SS0.SSS0.Px2.p2.3.m3.1.1.2.cmml" xref="A2.SS0.SSS0.Px2.p2.3.m3.1.1.2">𝑚</ci><cn id="A2.SS0.SSS0.Px2.p2.3.m3.1.1.3.cmml" type="integer" xref="A2.SS0.SSS0.Px2.p2.3.m3.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS0.SSS0.Px2.p2.3.m3.1c">m=4</annotation><annotation encoding="application/x-llamapun" id="A2.SS0.SSS0.Px2.p2.3.m3.1d">italic_m = 4</annotation></semantics></math> and <math alttext="M=20" class="ltx_Math" display="inline" id="A2.SS0.SSS0.Px2.p2.4.m4.1"><semantics id="A2.SS0.SSS0.Px2.p2.4.m4.1a"><mrow id="A2.SS0.SSS0.Px2.p2.4.m4.1.1" xref="A2.SS0.SSS0.Px2.p2.4.m4.1.1.cmml"><mi id="A2.SS0.SSS0.Px2.p2.4.m4.1.1.2" xref="A2.SS0.SSS0.Px2.p2.4.m4.1.1.2.cmml">M</mi><mo id="A2.SS0.SSS0.Px2.p2.4.m4.1.1.1" xref="A2.SS0.SSS0.Px2.p2.4.m4.1.1.1.cmml">=</mo><mn id="A2.SS0.SSS0.Px2.p2.4.m4.1.1.3" xref="A2.SS0.SSS0.Px2.p2.4.m4.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS0.SSS0.Px2.p2.4.m4.1b"><apply id="A2.SS0.SSS0.Px2.p2.4.m4.1.1.cmml" xref="A2.SS0.SSS0.Px2.p2.4.m4.1.1"><eq id="A2.SS0.SSS0.Px2.p2.4.m4.1.1.1.cmml" xref="A2.SS0.SSS0.Px2.p2.4.m4.1.1.1"></eq><ci id="A2.SS0.SSS0.Px2.p2.4.m4.1.1.2.cmml" xref="A2.SS0.SSS0.Px2.p2.4.m4.1.1.2">𝑀</ci><cn id="A2.SS0.SSS0.Px2.p2.4.m4.1.1.3.cmml" type="integer" xref="A2.SS0.SSS0.Px2.p2.4.m4.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS0.SSS0.Px2.p2.4.m4.1c">M=20</annotation><annotation encoding="application/x-llamapun" id="A2.SS0.SSS0.Px2.p2.4.m4.1d">italic_M = 20</annotation></semantics></math>. Therefore the maximum time-span of the signature is <math alttext="2\cdot M" class="ltx_Math" display="inline" id="A2.SS0.SSS0.Px2.p2.5.m5.1"><semantics id="A2.SS0.SSS0.Px2.p2.5.m5.1a"><mrow id="A2.SS0.SSS0.Px2.p2.5.m5.1.1" xref="A2.SS0.SSS0.Px2.p2.5.m5.1.1.cmml"><mn id="A2.SS0.SSS0.Px2.p2.5.m5.1.1.2" xref="A2.SS0.SSS0.Px2.p2.5.m5.1.1.2.cmml">2</mn><mo id="A2.SS0.SSS0.Px2.p2.5.m5.1.1.1" lspace="0.222em" rspace="0.222em" xref="A2.SS0.SSS0.Px2.p2.5.m5.1.1.1.cmml">⋅</mo><mi id="A2.SS0.SSS0.Px2.p2.5.m5.1.1.3" xref="A2.SS0.SSS0.Px2.p2.5.m5.1.1.3.cmml">M</mi></mrow><annotation-xml encoding="MathML-Content" id="A2.SS0.SSS0.Px2.p2.5.m5.1b"><apply id="A2.SS0.SSS0.Px2.p2.5.m5.1.1.cmml" xref="A2.SS0.SSS0.Px2.p2.5.m5.1.1"><ci id="A2.SS0.SSS0.Px2.p2.5.m5.1.1.1.cmml" xref="A2.SS0.SSS0.Px2.p2.5.m5.1.1.1">⋅</ci><cn id="A2.SS0.SSS0.Px2.p2.5.m5.1.1.2.cmml" type="integer" xref="A2.SS0.SSS0.Px2.p2.5.m5.1.1.2">2</cn><ci id="A2.SS0.SSS0.Px2.p2.5.m5.1.1.3.cmml" xref="A2.SS0.SSS0.Px2.p2.5.m5.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS0.SSS0.Px2.p2.5.m5.1c">2\cdot M</annotation><annotation encoding="application/x-llamapun" id="A2.SS0.SSS0.Px2.p2.5.m5.1d">2 ⋅ italic_M</annotation></semantics></math>, i.e., about 3.2 seconds.
Formally, the hash key can take <math alttext="64^{3}(M-m)^{2}=2^{26}=67,108,864" class="ltx_Math" display="inline" id="A2.SS0.SSS0.Px2.p2.6.m6.4"><semantics id="A2.SS0.SSS0.Px2.p2.6.m6.4a"><mrow id="A2.SS0.SSS0.Px2.p2.6.m6.4.4.2" xref="A2.SS0.SSS0.Px2.p2.6.m6.4.4.3.cmml"><mrow id="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1" xref="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.cmml"><mrow id="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.1" xref="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.1.cmml"><msup id="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.1.3" xref="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.1.3.cmml"><mn id="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.1.3.2" xref="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.1.3.2.cmml">64</mn><mn id="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.1.3.3" xref="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.1.3.3.cmml">3</mn></msup><mo id="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.1.2" xref="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.1.2.cmml">⁢</mo><msup id="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.1.1" xref="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.1.1.cmml"><mrow id="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.1.1.1.1" xref="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.1.1.1.1.1.cmml"><mo id="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.1.1.1.1.2" stretchy="false" xref="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.1.1.1.1.1" xref="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.1.1.1.1.1.cmml"><mi id="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.1.1.1.1.1.2" xref="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.1.1.1.1.1.2.cmml">M</mi><mo id="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.1.1.1.1.1.1" xref="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.1.1.1.1.1.3" xref="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.1.1.1.1.1.3.cmml">m</mi></mrow><mo id="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.1.1.1.1.3" stretchy="false" xref="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.1.1.3" xref="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.1.1.3.cmml">2</mn></msup></mrow><mo id="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.3" xref="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.3.cmml">=</mo><msup id="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.4" xref="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.4.cmml"><mn id="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.4.2" xref="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.4.2.cmml">2</mn><mn id="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.4.3" xref="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.4.3.cmml">26</mn></msup><mo id="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.5" xref="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.5.cmml">=</mo><mn id="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.6" xref="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.6.cmml">67</mn></mrow><mo id="A2.SS0.SSS0.Px2.p2.6.m6.4.4.2.3" xref="A2.SS0.SSS0.Px2.p2.6.m6.4.4.3a.cmml">,</mo><mrow id="A2.SS0.SSS0.Px2.p2.6.m6.4.4.2.2.2" xref="A2.SS0.SSS0.Px2.p2.6.m6.4.4.2.2.1.cmml"><mn id="A2.SS0.SSS0.Px2.p2.6.m6.1.1" xref="A2.SS0.SSS0.Px2.p2.6.m6.1.1.cmml">108</mn><mo id="A2.SS0.SSS0.Px2.p2.6.m6.4.4.2.2.2.1" xref="A2.SS0.SSS0.Px2.p2.6.m6.4.4.2.2.1.cmml">,</mo><mn id="A2.SS0.SSS0.Px2.p2.6.m6.2.2" xref="A2.SS0.SSS0.Px2.p2.6.m6.2.2.cmml">864</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS0.SSS0.Px2.p2.6.m6.4b"><apply id="A2.SS0.SSS0.Px2.p2.6.m6.4.4.3.cmml" xref="A2.SS0.SSS0.Px2.p2.6.m6.4.4.2"><csymbol cd="ambiguous" id="A2.SS0.SSS0.Px2.p2.6.m6.4.4.3a.cmml" xref="A2.SS0.SSS0.Px2.p2.6.m6.4.4.2.3">formulae-sequence</csymbol><apply id="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.cmml" xref="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1"><and id="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1a.cmml" xref="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1"></and><apply id="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1b.cmml" xref="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1"><eq id="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.3.cmml" xref="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.3"></eq><apply id="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.1.cmml" xref="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.1"><times id="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.1.2.cmml" xref="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.1.2"></times><apply id="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.1.3.cmml" xref="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.1.3"><csymbol cd="ambiguous" id="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.1.3.1.cmml" xref="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.1.3">superscript</csymbol><cn id="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.1.3.2.cmml" type="integer" xref="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.1.3.2">64</cn><cn id="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.1.3.3.cmml" type="integer" xref="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.1.3.3">3</cn></apply><apply id="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.1.1.cmml" xref="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.1.1"><csymbol cd="ambiguous" id="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.1.1.2.cmml" xref="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.1.1">superscript</csymbol><apply id="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.1.1.1.1.1.cmml" xref="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.1.1.1.1"><minus id="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.1.1.1.1.1.1.cmml" xref="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.1.1.1.1.1.1"></minus><ci id="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.1.1.1.1.1.2.cmml" xref="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.1.1.1.1.1.2">𝑀</ci><ci id="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.1.1.1.1.1.3.cmml" xref="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.1.1.1.1.1.3">𝑚</ci></apply><cn id="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.1.1.3.cmml" type="integer" xref="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.1.1.3">2</cn></apply></apply><apply id="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.4.cmml" xref="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.4"><csymbol cd="ambiguous" id="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.4.1.cmml" xref="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.4">superscript</csymbol><cn id="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.4.2.cmml" type="integer" xref="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.4.2">2</cn><cn id="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.4.3.cmml" type="integer" xref="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.4.3">26</cn></apply></apply><apply id="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1c.cmml" xref="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1"><eq id="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.5.cmml" xref="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.5"></eq><share href="https://arxiv.org/html/2410.00037v2#A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.4.cmml" id="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1d.cmml" xref="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1"></share><cn id="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.6.cmml" type="integer" xref="A2.SS0.SSS0.Px2.p2.6.m6.3.3.1.1.6">67</cn></apply></apply><list id="A2.SS0.SSS0.Px2.p2.6.m6.4.4.2.2.1.cmml" xref="A2.SS0.SSS0.Px2.p2.6.m6.4.4.2.2.2"><cn id="A2.SS0.SSS0.Px2.p2.6.m6.1.1.cmml" type="integer" xref="A2.SS0.SSS0.Px2.p2.6.m6.1.1">108</cn><cn id="A2.SS0.SSS0.Px2.p2.6.m6.2.2.cmml" type="integer" xref="A2.SS0.SSS0.Px2.p2.6.m6.2.2">864</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS0.SSS0.Px2.p2.6.m6.4c">64^{3}(M-m)^{2}=2^{26}=67,108,864</annotation><annotation encoding="application/x-llamapun" id="A2.SS0.SSS0.Px2.p2.6.m6.4d">64 start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT ( italic_M - italic_m ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT = 2 start_POSTSUPERSCRIPT 26 end_POSTSUPERSCRIPT = 67 , 108 , 864</annotation></semantics></math> distinct values. In practice the distribution of hash values is skewed and some signatures are unlikely to occur.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="A2.SS0.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">Pair-wise matching and one-to-many comparison.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A2.SS0.SSS0.Px3.p1">
<p class="ltx_p" id="A2.SS0.SSS0.Px3.p1.3">With our signature extraction, we can compare two audios by comparing their signature sets, which amounts to computing the intersection of the hash-keys. When one wants to compare a query audio to a dataset that consists of many audios, it is more efficient to perform this comparison with an inverted file or a hash table. In that case, the indexing structure returns the lists of matching signatures along with the matching timestamps for each of the audio. Similar to <cite class="ltx_cite ltx_citemacro_cite">Wang (<a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib102" title="">2003</a>)</cite>, we only preserve the matches that are temporally consistent thanks to a simple Hough 1D temporal voting scheme. Optionally, we incorporate a tolerance of <math alttext="\pm 1" class="ltx_Math" display="inline" id="A2.SS0.SSS0.Px3.p1.1.m1.1"><semantics id="A2.SS0.SSS0.Px3.p1.1.m1.1a"><mrow id="A2.SS0.SSS0.Px3.p1.1.m1.1.1" xref="A2.SS0.SSS0.Px3.p1.1.m1.1.1.cmml"><mo id="A2.SS0.SSS0.Px3.p1.1.m1.1.1a" xref="A2.SS0.SSS0.Px3.p1.1.m1.1.1.cmml">±</mo><mn id="A2.SS0.SSS0.Px3.p1.1.m1.1.1.2" xref="A2.SS0.SSS0.Px3.p1.1.m1.1.1.2.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS0.SSS0.Px3.p1.1.m1.1b"><apply id="A2.SS0.SSS0.Px3.p1.1.m1.1.1.cmml" xref="A2.SS0.SSS0.Px3.p1.1.m1.1.1"><csymbol cd="latexml" id="A2.SS0.SSS0.Px3.p1.1.m1.1.1.1.cmml" xref="A2.SS0.SSS0.Px3.p1.1.m1.1.1">plus-or-minus</csymbol><cn id="A2.SS0.SSS0.Px3.p1.1.m1.1.1.2.cmml" type="integer" xref="A2.SS0.SSS0.Px3.p1.1.m1.1.1.2">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS0.SSS0.Px3.p1.1.m1.1c">\pm 1</annotation><annotation encoding="application/x-llamapun" id="A2.SS0.SSS0.Px3.p1.1.m1.1d">± 1</annotation></semantics></math> on the timestamps <math alttext="t_{\mathrm{b}}" class="ltx_Math" display="inline" id="A2.SS0.SSS0.Px3.p1.2.m2.1"><semantics id="A2.SS0.SSS0.Px3.p1.2.m2.1a"><msub id="A2.SS0.SSS0.Px3.p1.2.m2.1.1" xref="A2.SS0.SSS0.Px3.p1.2.m2.1.1.cmml"><mi id="A2.SS0.SSS0.Px3.p1.2.m2.1.1.2" xref="A2.SS0.SSS0.Px3.p1.2.m2.1.1.2.cmml">t</mi><mi id="A2.SS0.SSS0.Px3.p1.2.m2.1.1.3" mathvariant="normal" xref="A2.SS0.SSS0.Px3.p1.2.m2.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="A2.SS0.SSS0.Px3.p1.2.m2.1b"><apply id="A2.SS0.SSS0.Px3.p1.2.m2.1.1.cmml" xref="A2.SS0.SSS0.Px3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A2.SS0.SSS0.Px3.p1.2.m2.1.1.1.cmml" xref="A2.SS0.SSS0.Px3.p1.2.m2.1.1">subscript</csymbol><ci id="A2.SS0.SSS0.Px3.p1.2.m2.1.1.2.cmml" xref="A2.SS0.SSS0.Px3.p1.2.m2.1.1.2">𝑡</ci><ci id="A2.SS0.SSS0.Px3.p1.2.m2.1.1.3.cmml" xref="A2.SS0.SSS0.Px3.p1.2.m2.1.1.3">b</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS0.SSS0.Px3.p1.2.m2.1c">t_{\mathrm{b}}</annotation><annotation encoding="application/x-llamapun" id="A2.SS0.SSS0.Px3.p1.2.m2.1d">italic_t start_POSTSUBSCRIPT roman_b end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="t_{\mathrm{f}}" class="ltx_Math" display="inline" id="A2.SS0.SSS0.Px3.p1.3.m3.1"><semantics id="A2.SS0.SSS0.Px3.p1.3.m3.1a"><msub id="A2.SS0.SSS0.Px3.p1.3.m3.1.1" xref="A2.SS0.SSS0.Px3.p1.3.m3.1.1.cmml"><mi id="A2.SS0.SSS0.Px3.p1.3.m3.1.1.2" xref="A2.SS0.SSS0.Px3.p1.3.m3.1.1.2.cmml">t</mi><mi id="A2.SS0.SSS0.Px3.p1.3.m3.1.1.3" mathvariant="normal" xref="A2.SS0.SSS0.Px3.p1.3.m3.1.1.3.cmml">f</mi></msub><annotation-xml encoding="MathML-Content" id="A2.SS0.SSS0.Px3.p1.3.m3.1b"><apply id="A2.SS0.SSS0.Px3.p1.3.m3.1.1.cmml" xref="A2.SS0.SSS0.Px3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="A2.SS0.SSS0.Px3.p1.3.m3.1.1.1.cmml" xref="A2.SS0.SSS0.Px3.p1.3.m3.1.1">subscript</csymbol><ci id="A2.SS0.SSS0.Px3.p1.3.m3.1.1.2.cmml" xref="A2.SS0.SSS0.Px3.p1.3.m3.1.1.2">𝑡</ci><ci id="A2.SS0.SSS0.Px3.p1.3.m3.1.1.3.cmml" xref="A2.SS0.SSS0.Px3.p1.3.m3.1.1.3">f</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS0.SSS0.Px3.p1.3.m3.1c">t_{\mathrm{f}}</annotation><annotation encoding="application/x-llamapun" id="A2.SS0.SSS0.Px3.p1.3.m3.1d">italic_t start_POSTSUBSCRIPT roman_f end_POSTSUBSCRIPT</annotation></semantics></math> when matching the signatures. This tolerance increases the complexity and we therefore do not use it for the dataset deduplication case.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="A2.SS0.SSS0.Px4">
<h5 class="ltx_title ltx_title_paragraph">De-duplication: Signature fused set.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A2.SS0.SSS0.Px4.p1">
<p class="ltx_p" id="A2.SS0.SSS0.Px4.p1.1">For our deduplication strategy, we first cross-match all the audio segments in the dataset, and extract the matching segments that occur often enough (typically <math alttext="\geq 10" class="ltx_Math" display="inline" id="A2.SS0.SSS0.Px4.p1.1.m1.1"><semantics id="A2.SS0.SSS0.Px4.p1.1.m1.1a"><mrow id="A2.SS0.SSS0.Px4.p1.1.m1.1.1" xref="A2.SS0.SSS0.Px4.p1.1.m1.1.1.cmml"><mi id="A2.SS0.SSS0.Px4.p1.1.m1.1.1.2" xref="A2.SS0.SSS0.Px4.p1.1.m1.1.1.2.cmml"></mi><mo id="A2.SS0.SSS0.Px4.p1.1.m1.1.1.1" xref="A2.SS0.SSS0.Px4.p1.1.m1.1.1.1.cmml">≥</mo><mn id="A2.SS0.SSS0.Px4.p1.1.m1.1.1.3" xref="A2.SS0.SSS0.Px4.p1.1.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS0.SSS0.Px4.p1.1.m1.1b"><apply id="A2.SS0.SSS0.Px4.p1.1.m1.1.1.cmml" xref="A2.SS0.SSS0.Px4.p1.1.m1.1.1"><geq id="A2.SS0.SSS0.Px4.p1.1.m1.1.1.1.cmml" xref="A2.SS0.SSS0.Px4.p1.1.m1.1.1.1"></geq><csymbol cd="latexml" id="A2.SS0.SSS0.Px4.p1.1.m1.1.1.2.cmml" xref="A2.SS0.SSS0.Px4.p1.1.m1.1.1.2">absent</csymbol><cn id="A2.SS0.SSS0.Px4.p1.1.m1.1.1.3.cmml" type="integer" xref="A2.SS0.SSS0.Px4.p1.1.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS0.SSS0.Px4.p1.1.m1.1c">\geq 10</annotation><annotation encoding="application/x-llamapun" id="A2.SS0.SSS0.Px4.p1.1.m1.1d">≥ 10</annotation></semantics></math> matches). Since their signatures are redundant, we remove all duplicate signatures that occur at identical relative timestamps to produce a single <em class="ltx_emph ltx_font_italic" id="A2.SS0.SSS0.Px4.p1.1.1">duplicate signature set</em>. At training time, in order to determine if an audio segment is a frequent duplicate to be filtered out, we simply compare its signature set to the duplicate signature set. In other terms, we simply perform a simple audio-to-audio matching between the putative training segment and the synthesized duplicate signature file. We use the segment for training only if the score is below a pre-defined matching threshold.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_appendix" id="A3">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Delayed text LM as a zero-shot streaming ASR and TTS</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A3.p1">
<p class="ltx_p" id="A3.p1.1">As explained in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.SS4.SSS4" title="3.4.4 Inner Monologue ‣ 3.4 Generative Audio Modeling ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue">Section&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.4.4</span></span></a>, Moshi models audio tokens, along
with a text stream that is aligned on the audio frame rate with the use of special padding tokens, as represented in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S3.F4" title="Figure 4 ‣ 3.4.3 Multi-stream modeling ‣ 3.4 Generative Audio Modeling ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue">Figure&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></span></a>. We can adapt this method for ASR and TTS by introducing a delay between the audio and text tokens. In both cases, the model operates in full streaming mode, with a fixed latency (here 2 seconds).</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_paragraph" id="A3.SS0.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">ASR mode.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A3.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="A3.SS0.SSS0.Px1.p1.1">If the audio is ahead of the text, we ignore the model prediction for the audio tokens, using instead those of some audio input, and sample the text tokens freely. Then the text stream contains the audio transcription, with fine alignments at the word level, as depicted in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#A3.F8" title="Figure 8 ‣ Multi-stream TTS. ‣ Appendix C Delayed text LM as a zero-shot streaming ASR and TTS ‣ Moshi: a speech-text foundation model for real-time dialogue">Figure&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="A3.SS0.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">TTS mode.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A3.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="A3.SS0.SSS0.Px2.p1.1">If the text is ahead of the audio, we can symmetrically derive a TTS engine. We need for that a properly padded set of text tokens. We obtain those in a zero-shot manner by allowing the model to sample freely <span class="ltx_text ltx_font_typewriter" id="A3.SS0.SSS0.Px2.p1.1.1">PAD</span> and <span class="ltx_text ltx_font_typewriter" id="A3.SS0.SSS0.Px2.p1.1.2">EPAD</span> tokens. As soon as the model tries to sample a different token, we instead input the next word to generate. Note that we can further control the rate of the speech by keeping an online average of the fraction of padding tokens. By introducing a small bonus on their logits when this fraction falls below a given target value, we ensure reasonable rate and a good intelligibility in all situations. Finally, using a prefix with both text and audio tokens, we can control the voice of the speaker. A representation is given in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#A3.F9" title="Figure 9 ‣ Multi-stream TTS. ‣ Appendix C Delayed text LM as a zero-shot streaming ASR and TTS ‣ Moshi: a speech-text foundation model for real-time dialogue">Figure&nbsp;<span class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="A3.SS0.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">Multi-stream TTS.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A3.SS0.SSS0.Px3.p1">
<p class="ltx_p" id="A3.SS0.SSS0.Px3.p1.1">We use this mechanism both in single and multi-stream mode. In multi-stream mode, the model outputs two sets of audio tokens. The text is provided in a single stream, using the <span class="ltx_text ltx_font_typewriter" id="A3.SS0.SSS0.Px3.p1.1.1">&lt;bos&gt;</span> and <span class="ltx_text ltx_font_typewriter" id="A3.SS0.SSS0.Px3.p1.1.2">&lt;eos&gt;</span> tokens to separate the text from the two speakers.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="A3.F8"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="408" id="A3.F8.g1" src="https://arxiv.org/html/2410.00037v2/x12.png" width="830">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span><span class="ltx_text ltx_font_bold" id="A3.F8.6.1">Representation of the joint sequence modeled by Moshi when used for ASR.</span>
Each column represents the tokens for a given step in the joint sequence <math alttext="(V_{s,k})" class="ltx_Math" display="inline" id="A3.F8.3.m1.3"><semantics id="A3.F8.3.m1.3b"><mrow id="A3.F8.3.m1.3.3.1" xref="A3.F8.3.m1.3.3.1.1.cmml"><mo id="A3.F8.3.m1.3.3.1.2" stretchy="false" xref="A3.F8.3.m1.3.3.1.1.cmml">(</mo><msub id="A3.F8.3.m1.3.3.1.1" xref="A3.F8.3.m1.3.3.1.1.cmml"><mi id="A3.F8.3.m1.3.3.1.1.2" xref="A3.F8.3.m1.3.3.1.1.2.cmml">V</mi><mrow id="A3.F8.3.m1.2.2.2.4" xref="A3.F8.3.m1.2.2.2.3.cmml"><mi id="A3.F8.3.m1.1.1.1.1" xref="A3.F8.3.m1.1.1.1.1.cmml">s</mi><mo id="A3.F8.3.m1.2.2.2.4.1" xref="A3.F8.3.m1.2.2.2.3.cmml">,</mo><mi id="A3.F8.3.m1.2.2.2.2" xref="A3.F8.3.m1.2.2.2.2.cmml">k</mi></mrow></msub><mo id="A3.F8.3.m1.3.3.1.3" stretchy="false" xref="A3.F8.3.m1.3.3.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.F8.3.m1.3c"><apply id="A3.F8.3.m1.3.3.1.1.cmml" xref="A3.F8.3.m1.3.3.1"><csymbol cd="ambiguous" id="A3.F8.3.m1.3.3.1.1.1.cmml" xref="A3.F8.3.m1.3.3.1">subscript</csymbol><ci id="A3.F8.3.m1.3.3.1.1.2.cmml" xref="A3.F8.3.m1.3.3.1.1.2">𝑉</ci><list id="A3.F8.3.m1.2.2.2.3.cmml" xref="A3.F8.3.m1.2.2.2.4"><ci id="A3.F8.3.m1.1.1.1.1.cmml" xref="A3.F8.3.m1.1.1.1.1">𝑠</ci><ci id="A3.F8.3.m1.2.2.2.2.cmml" xref="A3.F8.3.m1.2.2.2.2">𝑘</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.F8.3.m1.3d">(V_{s,k})</annotation><annotation encoding="application/x-llamapun" id="A3.F8.3.m1.3e">( italic_V start_POSTSUBSCRIPT italic_s , italic_k end_POSTSUBSCRIPT )</annotation></semantics></math>, similar to the one described in <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2410.00037v2#S3.E6" title="6 ‣ Joint sequence modeling for Moshi. ‣ 3.4.4 Inner Monologue ‣ 3.4 Generative Audio Modeling ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_tag">Equation&nbsp;6</span></a>, but adapted for ASR. The text is delayed by 2 seconds, and we use an acoustic token delay <math alttext="\tau=2" class="ltx_Math" display="inline" id="A3.F8.4.m2.1"><semantics id="A3.F8.4.m2.1b"><mrow id="A3.F8.4.m2.1.1" xref="A3.F8.4.m2.1.1.cmml"><mi id="A3.F8.4.m2.1.1.2" xref="A3.F8.4.m2.1.1.2.cmml">τ</mi><mo id="A3.F8.4.m2.1.1.1" xref="A3.F8.4.m2.1.1.1.cmml">=</mo><mn id="A3.F8.4.m2.1.1.3" xref="A3.F8.4.m2.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.F8.4.m2.1c"><apply id="A3.F8.4.m2.1.1.cmml" xref="A3.F8.4.m2.1.1"><eq id="A3.F8.4.m2.1.1.1.cmml" xref="A3.F8.4.m2.1.1.1"></eq><ci id="A3.F8.4.m2.1.1.2.cmml" xref="A3.F8.4.m2.1.1.2">𝜏</ci><cn id="A3.F8.4.m2.1.1.3.cmml" type="integer" xref="A3.F8.4.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.F8.4.m2.1d">\tau=2</annotation><annotation encoding="application/x-llamapun" id="A3.F8.4.m2.1e">italic_τ = 2</annotation></semantics></math>. Tokens are predicted from bottom to top in the depth Transformer.
The audio tokens are kept to match those of the input audio, while text tokens are sampled freely. This also provides fine word timestamps.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="A3.F9"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="524" id="A3.F9.g1" src="https://arxiv.org/html/2410.00037v2/x13.png" width="830">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span><span class="ltx_text ltx_font_bold" id="A3.F9.8.1">Representation of the joint sequence modeled by Moshi when used in TTS mode</span>. Each column represents the tokens for a given step in the joint sequence <math alttext="(V_{s,k})" class="ltx_Math" display="inline" id="A3.F9.3.m1.3"><semantics id="A3.F9.3.m1.3b"><mrow id="A3.F9.3.m1.3.3.1" xref="A3.F9.3.m1.3.3.1.1.cmml"><mo id="A3.F9.3.m1.3.3.1.2" stretchy="false" xref="A3.F9.3.m1.3.3.1.1.cmml">(</mo><msub id="A3.F9.3.m1.3.3.1.1" xref="A3.F9.3.m1.3.3.1.1.cmml"><mi id="A3.F9.3.m1.3.3.1.1.2" xref="A3.F9.3.m1.3.3.1.1.2.cmml">V</mi><mrow id="A3.F9.3.m1.2.2.2.4" xref="A3.F9.3.m1.2.2.2.3.cmml"><mi id="A3.F9.3.m1.1.1.1.1" xref="A3.F9.3.m1.1.1.1.1.cmml">s</mi><mo id="A3.F9.3.m1.2.2.2.4.1" xref="A3.F9.3.m1.2.2.2.3.cmml">,</mo><mi id="A3.F9.3.m1.2.2.2.2" xref="A3.F9.3.m1.2.2.2.2.cmml">k</mi></mrow></msub><mo id="A3.F9.3.m1.3.3.1.3" stretchy="false" xref="A3.F9.3.m1.3.3.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.F9.3.m1.3c"><apply id="A3.F9.3.m1.3.3.1.1.cmml" xref="A3.F9.3.m1.3.3.1"><csymbol cd="ambiguous" id="A3.F9.3.m1.3.3.1.1.1.cmml" xref="A3.F9.3.m1.3.3.1">subscript</csymbol><ci id="A3.F9.3.m1.3.3.1.1.2.cmml" xref="A3.F9.3.m1.3.3.1.1.2">𝑉</ci><list id="A3.F9.3.m1.2.2.2.3.cmml" xref="A3.F9.3.m1.2.2.2.4"><ci id="A3.F9.3.m1.1.1.1.1.cmml" xref="A3.F9.3.m1.1.1.1.1">𝑠</ci><ci id="A3.F9.3.m1.2.2.2.2.cmml" xref="A3.F9.3.m1.2.2.2.2">𝑘</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.F9.3.m1.3d">(V_{s,k})</annotation><annotation encoding="application/x-llamapun" id="A3.F9.3.m1.3e">( italic_V start_POSTSUBSCRIPT italic_s , italic_k end_POSTSUBSCRIPT )</annotation></semantics></math>, similar to the one described in <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2410.00037v2#S3.E6" title="6 ‣ Joint sequence modeling for Moshi. ‣ 3.4.4 Inner Monologue ‣ 3.4 Generative Audio Modeling ‣ 3 Model ‣ Moshi: a speech-text foundation model for real-time dialogue"><span class="ltx_text ltx_ref_tag">Equation&nbsp;6</span></a>, but adapted for TTS. The audio is delayed by 2 seconds, and we use an acoustic token delay <math alttext="\tau=2" class="ltx_Math" display="inline" id="A3.F9.4.m2.1"><semantics id="A3.F9.4.m2.1b"><mrow id="A3.F9.4.m2.1.1" xref="A3.F9.4.m2.1.1.cmml"><mi id="A3.F9.4.m2.1.1.2" xref="A3.F9.4.m2.1.1.2.cmml">τ</mi><mo id="A3.F9.4.m2.1.1.1" xref="A3.F9.4.m2.1.1.1.cmml">=</mo><mn id="A3.F9.4.m2.1.1.3" xref="A3.F9.4.m2.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.F9.4.m2.1c"><apply id="A3.F9.4.m2.1.1.cmml" xref="A3.F9.4.m2.1.1"><eq id="A3.F9.4.m2.1.1.1.cmml" xref="A3.F9.4.m2.1.1.1"></eq><ci id="A3.F9.4.m2.1.1.2.cmml" xref="A3.F9.4.m2.1.1.2">𝜏</ci><cn id="A3.F9.4.m2.1.1.3.cmml" type="integer" xref="A3.F9.4.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.F9.4.m2.1d">\tau=2</annotation><annotation encoding="application/x-llamapun" id="A3.F9.4.m2.1e">italic_τ = 2</annotation></semantics></math>. Tokens are predicted from bottom to top in the depth Transformer.
Text predictions are usually ignored, and the tokens from the text to generate are used instead. However,
this text input lacks padding token. At the end of each word, we allow the model to sample freely <span class="ltx_text ltx_font_typewriter" id="A3.F9.9.2">PAD</span> and <span class="ltx_text ltx_font_typewriter" id="A3.F9.10.3">EPAD</span> tokens. If the model tries to sample another token, we instead use the tokens from the next word. The semantic and acoustic audio tokens are sampled normally, being implicitly conditioned on the text due to the delay used. This method also provides a fine alignment of the words in the generated audio, by noting the time at which a given word is consumed by the model.
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
<section class="ltx_appendix" id="A4">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Characterizing Audio Artifacts Caused by Quantization</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A4.p1">
<p class="ltx_p" id="A4.p1.10">First, recall that Moshi jointly handles three streams of tokens, text tokens <math alttext="W_{s}" class="ltx_Math" display="inline" id="A4.p1.1.m1.1"><semantics id="A4.p1.1.m1.1a"><msub id="A4.p1.1.m1.1.1" xref="A4.p1.1.m1.1.1.cmml"><mi id="A4.p1.1.m1.1.1.2" xref="A4.p1.1.m1.1.1.2.cmml">W</mi><mi id="A4.p1.1.m1.1.1.3" xref="A4.p1.1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="A4.p1.1.m1.1b"><apply id="A4.p1.1.m1.1.1.cmml" xref="A4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A4.p1.1.m1.1.1.1.cmml" xref="A4.p1.1.m1.1.1">subscript</csymbol><ci id="A4.p1.1.m1.1.1.2.cmml" xref="A4.p1.1.m1.1.1.2">𝑊</ci><ci id="A4.p1.1.m1.1.1.3.cmml" xref="A4.p1.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.1.m1.1c">W_{s}</annotation><annotation encoding="application/x-llamapun" id="A4.p1.1.m1.1d">italic_W start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> for Inner Monologue, semantic+acoustic audio tokens <math alttext="(A_{s,k})_{1\leq k\leq Q}" class="ltx_Math" display="inline" id="A4.p1.2.m2.3"><semantics id="A4.p1.2.m2.3a"><msub id="A4.p1.2.m2.3.3" xref="A4.p1.2.m2.3.3.cmml"><mrow id="A4.p1.2.m2.3.3.1.1" xref="A4.p1.2.m2.3.3.1.1.1.cmml"><mo id="A4.p1.2.m2.3.3.1.1.2" stretchy="false" xref="A4.p1.2.m2.3.3.1.1.1.cmml">(</mo><msub id="A4.p1.2.m2.3.3.1.1.1" xref="A4.p1.2.m2.3.3.1.1.1.cmml"><mi id="A4.p1.2.m2.3.3.1.1.1.2" xref="A4.p1.2.m2.3.3.1.1.1.2.cmml">A</mi><mrow id="A4.p1.2.m2.2.2.2.4" xref="A4.p1.2.m2.2.2.2.3.cmml"><mi id="A4.p1.2.m2.1.1.1.1" xref="A4.p1.2.m2.1.1.1.1.cmml">s</mi><mo id="A4.p1.2.m2.2.2.2.4.1" xref="A4.p1.2.m2.2.2.2.3.cmml">,</mo><mi id="A4.p1.2.m2.2.2.2.2" xref="A4.p1.2.m2.2.2.2.2.cmml">k</mi></mrow></msub><mo id="A4.p1.2.m2.3.3.1.1.3" stretchy="false" xref="A4.p1.2.m2.3.3.1.1.1.cmml">)</mo></mrow><mrow id="A4.p1.2.m2.3.3.3" xref="A4.p1.2.m2.3.3.3.cmml"><mn id="A4.p1.2.m2.3.3.3.2" xref="A4.p1.2.m2.3.3.3.2.cmml">1</mn><mo id="A4.p1.2.m2.3.3.3.3" xref="A4.p1.2.m2.3.3.3.3.cmml">≤</mo><mi id="A4.p1.2.m2.3.3.3.4" xref="A4.p1.2.m2.3.3.3.4.cmml">k</mi><mo id="A4.p1.2.m2.3.3.3.5" xref="A4.p1.2.m2.3.3.3.5.cmml">≤</mo><mi id="A4.p1.2.m2.3.3.3.6" xref="A4.p1.2.m2.3.3.3.6.cmml">Q</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A4.p1.2.m2.3b"><apply id="A4.p1.2.m2.3.3.cmml" xref="A4.p1.2.m2.3.3"><csymbol cd="ambiguous" id="A4.p1.2.m2.3.3.2.cmml" xref="A4.p1.2.m2.3.3">subscript</csymbol><apply id="A4.p1.2.m2.3.3.1.1.1.cmml" xref="A4.p1.2.m2.3.3.1.1"><csymbol cd="ambiguous" id="A4.p1.2.m2.3.3.1.1.1.1.cmml" xref="A4.p1.2.m2.3.3.1.1">subscript</csymbol><ci id="A4.p1.2.m2.3.3.1.1.1.2.cmml" xref="A4.p1.2.m2.3.3.1.1.1.2">𝐴</ci><list id="A4.p1.2.m2.2.2.2.3.cmml" xref="A4.p1.2.m2.2.2.2.4"><ci id="A4.p1.2.m2.1.1.1.1.cmml" xref="A4.p1.2.m2.1.1.1.1">𝑠</ci><ci id="A4.p1.2.m2.2.2.2.2.cmml" xref="A4.p1.2.m2.2.2.2.2">𝑘</ci></list></apply><apply id="A4.p1.2.m2.3.3.3.cmml" xref="A4.p1.2.m2.3.3.3"><and id="A4.p1.2.m2.3.3.3a.cmml" xref="A4.p1.2.m2.3.3.3"></and><apply id="A4.p1.2.m2.3.3.3b.cmml" xref="A4.p1.2.m2.3.3.3"><leq id="A4.p1.2.m2.3.3.3.3.cmml" xref="A4.p1.2.m2.3.3.3.3"></leq><cn id="A4.p1.2.m2.3.3.3.2.cmml" type="integer" xref="A4.p1.2.m2.3.3.3.2">1</cn><ci id="A4.p1.2.m2.3.3.3.4.cmml" xref="A4.p1.2.m2.3.3.3.4">𝑘</ci></apply><apply id="A4.p1.2.m2.3.3.3c.cmml" xref="A4.p1.2.m2.3.3.3"><leq id="A4.p1.2.m2.3.3.3.5.cmml" xref="A4.p1.2.m2.3.3.3.5"></leq><share href="https://arxiv.org/html/2410.00037v2#A4.p1.2.m2.3.3.3.4.cmml" id="A4.p1.2.m2.3.3.3d.cmml" xref="A4.p1.2.m2.3.3.3"></share><ci id="A4.p1.2.m2.3.3.3.6.cmml" xref="A4.p1.2.m2.3.3.3.6">𝑄</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.2.m2.3c">(A_{s,k})_{1\leq k\leq Q}</annotation><annotation encoding="application/x-llamapun" id="A4.p1.2.m2.3d">( italic_A start_POSTSUBSCRIPT italic_s , italic_k end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT 1 ≤ italic_k ≤ italic_Q end_POSTSUBSCRIPT</annotation></semantics></math> for Moshi’s audio, and the similar audio tokens <math alttext="(A^{\prime}_{s,k})_{1\leq k\leq Q}" class="ltx_Math" display="inline" id="A4.p1.3.m3.3"><semantics id="A4.p1.3.m3.3a"><msub id="A4.p1.3.m3.3.3" xref="A4.p1.3.m3.3.3.cmml"><mrow id="A4.p1.3.m3.3.3.1.1" xref="A4.p1.3.m3.3.3.1.1.1.cmml"><mo id="A4.p1.3.m3.3.3.1.1.2" stretchy="false" xref="A4.p1.3.m3.3.3.1.1.1.cmml">(</mo><msubsup id="A4.p1.3.m3.3.3.1.1.1" xref="A4.p1.3.m3.3.3.1.1.1.cmml"><mi id="A4.p1.3.m3.3.3.1.1.1.2.2" xref="A4.p1.3.m3.3.3.1.1.1.2.2.cmml">A</mi><mrow id="A4.p1.3.m3.2.2.2.4" xref="A4.p1.3.m3.2.2.2.3.cmml"><mi id="A4.p1.3.m3.1.1.1.1" xref="A4.p1.3.m3.1.1.1.1.cmml">s</mi><mo id="A4.p1.3.m3.2.2.2.4.1" xref="A4.p1.3.m3.2.2.2.3.cmml">,</mo><mi id="A4.p1.3.m3.2.2.2.2" xref="A4.p1.3.m3.2.2.2.2.cmml">k</mi></mrow><mo id="A4.p1.3.m3.3.3.1.1.1.2.3" xref="A4.p1.3.m3.3.3.1.1.1.2.3.cmml">′</mo></msubsup><mo id="A4.p1.3.m3.3.3.1.1.3" stretchy="false" xref="A4.p1.3.m3.3.3.1.1.1.cmml">)</mo></mrow><mrow id="A4.p1.3.m3.3.3.3" xref="A4.p1.3.m3.3.3.3.cmml"><mn id="A4.p1.3.m3.3.3.3.2" xref="A4.p1.3.m3.3.3.3.2.cmml">1</mn><mo id="A4.p1.3.m3.3.3.3.3" xref="A4.p1.3.m3.3.3.3.3.cmml">≤</mo><mi id="A4.p1.3.m3.3.3.3.4" xref="A4.p1.3.m3.3.3.3.4.cmml">k</mi><mo id="A4.p1.3.m3.3.3.3.5" xref="A4.p1.3.m3.3.3.3.5.cmml">≤</mo><mi id="A4.p1.3.m3.3.3.3.6" xref="A4.p1.3.m3.3.3.3.6.cmml">Q</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A4.p1.3.m3.3b"><apply id="A4.p1.3.m3.3.3.cmml" xref="A4.p1.3.m3.3.3"><csymbol cd="ambiguous" id="A4.p1.3.m3.3.3.2.cmml" xref="A4.p1.3.m3.3.3">subscript</csymbol><apply id="A4.p1.3.m3.3.3.1.1.1.cmml" xref="A4.p1.3.m3.3.3.1.1"><csymbol cd="ambiguous" id="A4.p1.3.m3.3.3.1.1.1.1.cmml" xref="A4.p1.3.m3.3.3.1.1">subscript</csymbol><apply id="A4.p1.3.m3.3.3.1.1.1.2.cmml" xref="A4.p1.3.m3.3.3.1.1"><csymbol cd="ambiguous" id="A4.p1.3.m3.3.3.1.1.1.2.1.cmml" xref="A4.p1.3.m3.3.3.1.1">superscript</csymbol><ci id="A4.p1.3.m3.3.3.1.1.1.2.2.cmml" xref="A4.p1.3.m3.3.3.1.1.1.2.2">𝐴</ci><ci id="A4.p1.3.m3.3.3.1.1.1.2.3.cmml" xref="A4.p1.3.m3.3.3.1.1.1.2.3">′</ci></apply><list id="A4.p1.3.m3.2.2.2.3.cmml" xref="A4.p1.3.m3.2.2.2.4"><ci id="A4.p1.3.m3.1.1.1.1.cmml" xref="A4.p1.3.m3.1.1.1.1">𝑠</ci><ci id="A4.p1.3.m3.2.2.2.2.cmml" xref="A4.p1.3.m3.2.2.2.2">𝑘</ci></list></apply><apply id="A4.p1.3.m3.3.3.3.cmml" xref="A4.p1.3.m3.3.3.3"><and id="A4.p1.3.m3.3.3.3a.cmml" xref="A4.p1.3.m3.3.3.3"></and><apply id="A4.p1.3.m3.3.3.3b.cmml" xref="A4.p1.3.m3.3.3.3"><leq id="A4.p1.3.m3.3.3.3.3.cmml" xref="A4.p1.3.m3.3.3.3.3"></leq><cn id="A4.p1.3.m3.3.3.3.2.cmml" type="integer" xref="A4.p1.3.m3.3.3.3.2">1</cn><ci id="A4.p1.3.m3.3.3.3.4.cmml" xref="A4.p1.3.m3.3.3.3.4">𝑘</ci></apply><apply id="A4.p1.3.m3.3.3.3c.cmml" xref="A4.p1.3.m3.3.3.3"><leq id="A4.p1.3.m3.3.3.3.5.cmml" xref="A4.p1.3.m3.3.3.3.5"></leq><share href="https://arxiv.org/html/2410.00037v2#A4.p1.3.m3.3.3.3.4.cmml" id="A4.p1.3.m3.3.3.3d.cmml" xref="A4.p1.3.m3.3.3.3"></share><ci id="A4.p1.3.m3.3.3.3.6.cmml" xref="A4.p1.3.m3.3.3.3.6">𝑄</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.3.m3.3c">(A^{\prime}_{s,k})_{1\leq k\leq Q}</annotation><annotation encoding="application/x-llamapun" id="A4.p1.3.m3.3d">( italic_A start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s , italic_k end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT 1 ≤ italic_k ≤ italic_Q end_POSTSUBSCRIPT</annotation></semantics></math> for the user’s input.
To analyse the impact of model quantization on genereated content, we first compute the Shannon entropy <math alttext="H" class="ltx_Math" display="inline" id="A4.p1.4.m4.1"><semantics id="A4.p1.4.m4.1a"><mi id="A4.p1.4.m4.1.1" xref="A4.p1.4.m4.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="A4.p1.4.m4.1b"><ci id="A4.p1.4.m4.1.1.cmml" xref="A4.p1.4.m4.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.4.m4.1c">H</annotation><annotation encoding="application/x-llamapun" id="A4.p1.4.m4.1d">italic_H</annotation></semantics></math> across windows of fixed size <math alttext="C" class="ltx_Math" display="inline" id="A4.p1.5.m5.1"><semantics id="A4.p1.5.m5.1a"><mi id="A4.p1.5.m5.1.1" xref="A4.p1.5.m5.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="A4.p1.5.m5.1b"><ci id="A4.p1.5.m5.1.1.cmml" xref="A4.p1.5.m5.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.5.m5.1c">C</annotation><annotation encoding="application/x-llamapun" id="A4.p1.5.m5.1d">italic_C</annotation></semantics></math> at each timestep <math alttext="s" class="ltx_Math" display="inline" id="A4.p1.6.m6.1"><semantics id="A4.p1.6.m6.1a"><mi id="A4.p1.6.m6.1.1" xref="A4.p1.6.m6.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="A4.p1.6.m6.1b"><ci id="A4.p1.6.m6.1.1.cmml" xref="A4.p1.6.m6.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.6.m6.1c">s</annotation><annotation encoding="application/x-llamapun" id="A4.p1.6.m6.1d">italic_s</annotation></semantics></math> for the
text and Moshi’s audio streams independently. This yields <math alttext="H^{0}_{s}=H(W_{s-C:s})" class="ltx_Math" display="inline" id="A4.p1.7.m7.1"><semantics id="A4.p1.7.m7.1a"><mrow id="A4.p1.7.m7.1.1" xref="A4.p1.7.m7.1.1.cmml"><msubsup id="A4.p1.7.m7.1.1.3" xref="A4.p1.7.m7.1.1.3.cmml"><mi id="A4.p1.7.m7.1.1.3.2.2" xref="A4.p1.7.m7.1.1.3.2.2.cmml">H</mi><mi id="A4.p1.7.m7.1.1.3.3" xref="A4.p1.7.m7.1.1.3.3.cmml">s</mi><mn id="A4.p1.7.m7.1.1.3.2.3" xref="A4.p1.7.m7.1.1.3.2.3.cmml">0</mn></msubsup><mo id="A4.p1.7.m7.1.1.2" xref="A4.p1.7.m7.1.1.2.cmml">=</mo><mrow id="A4.p1.7.m7.1.1.1" xref="A4.p1.7.m7.1.1.1.cmml"><mi id="A4.p1.7.m7.1.1.1.3" xref="A4.p1.7.m7.1.1.1.3.cmml">H</mi><mo id="A4.p1.7.m7.1.1.1.2" xref="A4.p1.7.m7.1.1.1.2.cmml">⁢</mo><mrow id="A4.p1.7.m7.1.1.1.1.1" xref="A4.p1.7.m7.1.1.1.1.1.1.cmml"><mo id="A4.p1.7.m7.1.1.1.1.1.2" stretchy="false" xref="A4.p1.7.m7.1.1.1.1.1.1.cmml">(</mo><msub id="A4.p1.7.m7.1.1.1.1.1.1" xref="A4.p1.7.m7.1.1.1.1.1.1.cmml"><mi id="A4.p1.7.m7.1.1.1.1.1.1.2" xref="A4.p1.7.m7.1.1.1.1.1.1.2.cmml">W</mi><mrow id="A4.p1.7.m7.1.1.1.1.1.1.3" xref="A4.p1.7.m7.1.1.1.1.1.1.3.cmml"><mrow id="A4.p1.7.m7.1.1.1.1.1.1.3.2" xref="A4.p1.7.m7.1.1.1.1.1.1.3.2.cmml"><mi id="A4.p1.7.m7.1.1.1.1.1.1.3.2.2" xref="A4.p1.7.m7.1.1.1.1.1.1.3.2.2.cmml">s</mi><mo id="A4.p1.7.m7.1.1.1.1.1.1.3.2.1" xref="A4.p1.7.m7.1.1.1.1.1.1.3.2.1.cmml">−</mo><mi id="A4.p1.7.m7.1.1.1.1.1.1.3.2.3" xref="A4.p1.7.m7.1.1.1.1.1.1.3.2.3.cmml">C</mi></mrow><mo id="A4.p1.7.m7.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="A4.p1.7.m7.1.1.1.1.1.1.3.1.cmml">:</mo><mi id="A4.p1.7.m7.1.1.1.1.1.1.3.3" xref="A4.p1.7.m7.1.1.1.1.1.1.3.3.cmml">s</mi></mrow></msub><mo id="A4.p1.7.m7.1.1.1.1.1.3" stretchy="false" xref="A4.p1.7.m7.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.p1.7.m7.1b"><apply id="A4.p1.7.m7.1.1.cmml" xref="A4.p1.7.m7.1.1"><eq id="A4.p1.7.m7.1.1.2.cmml" xref="A4.p1.7.m7.1.1.2"></eq><apply id="A4.p1.7.m7.1.1.3.cmml" xref="A4.p1.7.m7.1.1.3"><csymbol cd="ambiguous" id="A4.p1.7.m7.1.1.3.1.cmml" xref="A4.p1.7.m7.1.1.3">subscript</csymbol><apply id="A4.p1.7.m7.1.1.3.2.cmml" xref="A4.p1.7.m7.1.1.3"><csymbol cd="ambiguous" id="A4.p1.7.m7.1.1.3.2.1.cmml" xref="A4.p1.7.m7.1.1.3">superscript</csymbol><ci id="A4.p1.7.m7.1.1.3.2.2.cmml" xref="A4.p1.7.m7.1.1.3.2.2">𝐻</ci><cn id="A4.p1.7.m7.1.1.3.2.3.cmml" type="integer" xref="A4.p1.7.m7.1.1.3.2.3">0</cn></apply><ci id="A4.p1.7.m7.1.1.3.3.cmml" xref="A4.p1.7.m7.1.1.3.3">𝑠</ci></apply><apply id="A4.p1.7.m7.1.1.1.cmml" xref="A4.p1.7.m7.1.1.1"><times id="A4.p1.7.m7.1.1.1.2.cmml" xref="A4.p1.7.m7.1.1.1.2"></times><ci id="A4.p1.7.m7.1.1.1.3.cmml" xref="A4.p1.7.m7.1.1.1.3">𝐻</ci><apply id="A4.p1.7.m7.1.1.1.1.1.1.cmml" xref="A4.p1.7.m7.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.p1.7.m7.1.1.1.1.1.1.1.cmml" xref="A4.p1.7.m7.1.1.1.1.1">subscript</csymbol><ci id="A4.p1.7.m7.1.1.1.1.1.1.2.cmml" xref="A4.p1.7.m7.1.1.1.1.1.1.2">𝑊</ci><apply id="A4.p1.7.m7.1.1.1.1.1.1.3.cmml" xref="A4.p1.7.m7.1.1.1.1.1.1.3"><ci id="A4.p1.7.m7.1.1.1.1.1.1.3.1.cmml" xref="A4.p1.7.m7.1.1.1.1.1.1.3.1">:</ci><apply id="A4.p1.7.m7.1.1.1.1.1.1.3.2.cmml" xref="A4.p1.7.m7.1.1.1.1.1.1.3.2"><minus id="A4.p1.7.m7.1.1.1.1.1.1.3.2.1.cmml" xref="A4.p1.7.m7.1.1.1.1.1.1.3.2.1"></minus><ci id="A4.p1.7.m7.1.1.1.1.1.1.3.2.2.cmml" xref="A4.p1.7.m7.1.1.1.1.1.1.3.2.2">𝑠</ci><ci id="A4.p1.7.m7.1.1.1.1.1.1.3.2.3.cmml" xref="A4.p1.7.m7.1.1.1.1.1.1.3.2.3">𝐶</ci></apply><ci id="A4.p1.7.m7.1.1.1.1.1.1.3.3.cmml" xref="A4.p1.7.m7.1.1.1.1.1.1.3.3">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.7.m7.1c">H^{0}_{s}=H(W_{s-C:s})</annotation><annotation encoding="application/x-llamapun" id="A4.p1.7.m7.1d">italic_H start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT = italic_H ( italic_W start_POSTSUBSCRIPT italic_s - italic_C : italic_s end_POSTSUBSCRIPT )</annotation></semantics></math> for text, and <math alttext="H^{k}_{s}=H(A_{s-C:s,k})" class="ltx_Math" display="inline" id="A4.p1.8.m8.3"><semantics id="A4.p1.8.m8.3a"><mrow id="A4.p1.8.m8.3.3" xref="A4.p1.8.m8.3.3.cmml"><msubsup id="A4.p1.8.m8.3.3.3" xref="A4.p1.8.m8.3.3.3.cmml"><mi id="A4.p1.8.m8.3.3.3.2.2" xref="A4.p1.8.m8.3.3.3.2.2.cmml">H</mi><mi id="A4.p1.8.m8.3.3.3.3" xref="A4.p1.8.m8.3.3.3.3.cmml">s</mi><mi id="A4.p1.8.m8.3.3.3.2.3" xref="A4.p1.8.m8.3.3.3.2.3.cmml">k</mi></msubsup><mo id="A4.p1.8.m8.3.3.2" xref="A4.p1.8.m8.3.3.2.cmml">=</mo><mrow id="A4.p1.8.m8.3.3.1" xref="A4.p1.8.m8.3.3.1.cmml"><mi id="A4.p1.8.m8.3.3.1.3" xref="A4.p1.8.m8.3.3.1.3.cmml">H</mi><mo id="A4.p1.8.m8.3.3.1.2" xref="A4.p1.8.m8.3.3.1.2.cmml">⁢</mo><mrow id="A4.p1.8.m8.3.3.1.1.1" xref="A4.p1.8.m8.3.3.1.1.1.1.cmml"><mo id="A4.p1.8.m8.3.3.1.1.1.2" stretchy="false" xref="A4.p1.8.m8.3.3.1.1.1.1.cmml">(</mo><msub id="A4.p1.8.m8.3.3.1.1.1.1" xref="A4.p1.8.m8.3.3.1.1.1.1.cmml"><mi id="A4.p1.8.m8.3.3.1.1.1.1.2" xref="A4.p1.8.m8.3.3.1.1.1.1.2.cmml">A</mi><mrow id="A4.p1.8.m8.2.2.2" xref="A4.p1.8.m8.2.2.2.cmml"><mrow id="A4.p1.8.m8.2.2.2.4" xref="A4.p1.8.m8.2.2.2.4.cmml"><mi id="A4.p1.8.m8.2.2.2.4.2" xref="A4.p1.8.m8.2.2.2.4.2.cmml">s</mi><mo id="A4.p1.8.m8.2.2.2.4.1" xref="A4.p1.8.m8.2.2.2.4.1.cmml">−</mo><mi id="A4.p1.8.m8.2.2.2.4.3" xref="A4.p1.8.m8.2.2.2.4.3.cmml">C</mi></mrow><mo id="A4.p1.8.m8.2.2.2.3" lspace="0.278em" rspace="0.278em" xref="A4.p1.8.m8.2.2.2.3.cmml">:</mo><mrow id="A4.p1.8.m8.2.2.2.5.2" xref="A4.p1.8.m8.2.2.2.5.1.cmml"><mi id="A4.p1.8.m8.1.1.1.1" xref="A4.p1.8.m8.1.1.1.1.cmml">s</mi><mo id="A4.p1.8.m8.2.2.2.5.2.1" xref="A4.p1.8.m8.2.2.2.5.1.cmml">,</mo><mi id="A4.p1.8.m8.2.2.2.2" xref="A4.p1.8.m8.2.2.2.2.cmml">k</mi></mrow></mrow></msub><mo id="A4.p1.8.m8.3.3.1.1.1.3" stretchy="false" xref="A4.p1.8.m8.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.p1.8.m8.3b"><apply id="A4.p1.8.m8.3.3.cmml" xref="A4.p1.8.m8.3.3"><eq id="A4.p1.8.m8.3.3.2.cmml" xref="A4.p1.8.m8.3.3.2"></eq><apply id="A4.p1.8.m8.3.3.3.cmml" xref="A4.p1.8.m8.3.3.3"><csymbol cd="ambiguous" id="A4.p1.8.m8.3.3.3.1.cmml" xref="A4.p1.8.m8.3.3.3">subscript</csymbol><apply id="A4.p1.8.m8.3.3.3.2.cmml" xref="A4.p1.8.m8.3.3.3"><csymbol cd="ambiguous" id="A4.p1.8.m8.3.3.3.2.1.cmml" xref="A4.p1.8.m8.3.3.3">superscript</csymbol><ci id="A4.p1.8.m8.3.3.3.2.2.cmml" xref="A4.p1.8.m8.3.3.3.2.2">𝐻</ci><ci id="A4.p1.8.m8.3.3.3.2.3.cmml" xref="A4.p1.8.m8.3.3.3.2.3">𝑘</ci></apply><ci id="A4.p1.8.m8.3.3.3.3.cmml" xref="A4.p1.8.m8.3.3.3.3">𝑠</ci></apply><apply id="A4.p1.8.m8.3.3.1.cmml" xref="A4.p1.8.m8.3.3.1"><times id="A4.p1.8.m8.3.3.1.2.cmml" xref="A4.p1.8.m8.3.3.1.2"></times><ci id="A4.p1.8.m8.3.3.1.3.cmml" xref="A4.p1.8.m8.3.3.1.3">𝐻</ci><apply id="A4.p1.8.m8.3.3.1.1.1.1.cmml" xref="A4.p1.8.m8.3.3.1.1.1"><csymbol cd="ambiguous" id="A4.p1.8.m8.3.3.1.1.1.1.1.cmml" xref="A4.p1.8.m8.3.3.1.1.1">subscript</csymbol><ci id="A4.p1.8.m8.3.3.1.1.1.1.2.cmml" xref="A4.p1.8.m8.3.3.1.1.1.1.2">𝐴</ci><apply id="A4.p1.8.m8.2.2.2.cmml" xref="A4.p1.8.m8.2.2.2"><ci id="A4.p1.8.m8.2.2.2.3.cmml" xref="A4.p1.8.m8.2.2.2.3">:</ci><apply id="A4.p1.8.m8.2.2.2.4.cmml" xref="A4.p1.8.m8.2.2.2.4"><minus id="A4.p1.8.m8.2.2.2.4.1.cmml" xref="A4.p1.8.m8.2.2.2.4.1"></minus><ci id="A4.p1.8.m8.2.2.2.4.2.cmml" xref="A4.p1.8.m8.2.2.2.4.2">𝑠</ci><ci id="A4.p1.8.m8.2.2.2.4.3.cmml" xref="A4.p1.8.m8.2.2.2.4.3">𝐶</ci></apply><list id="A4.p1.8.m8.2.2.2.5.1.cmml" xref="A4.p1.8.m8.2.2.2.5.2"><ci id="A4.p1.8.m8.1.1.1.1.cmml" xref="A4.p1.8.m8.1.1.1.1">𝑠</ci><ci id="A4.p1.8.m8.2.2.2.2.cmml" xref="A4.p1.8.m8.2.2.2.2">𝑘</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.8.m8.3c">H^{k}_{s}=H(A_{s-C:s,k})</annotation><annotation encoding="application/x-llamapun" id="A4.p1.8.m8.3d">italic_H start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT = italic_H ( italic_A start_POSTSUBSCRIPT italic_s - italic_C : italic_s , italic_k end_POSTSUBSCRIPT )</annotation></semantics></math> for each audio level.
We use <math alttext="C=64" class="ltx_Math" display="inline" id="A4.p1.9.m9.1"><semantics id="A4.p1.9.m9.1a"><mrow id="A4.p1.9.m9.1.1" xref="A4.p1.9.m9.1.1.cmml"><mi id="A4.p1.9.m9.1.1.2" xref="A4.p1.9.m9.1.1.2.cmml">C</mi><mo id="A4.p1.9.m9.1.1.1" xref="A4.p1.9.m9.1.1.1.cmml">=</mo><mn id="A4.p1.9.m9.1.1.3" xref="A4.p1.9.m9.1.1.3.cmml">64</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.p1.9.m9.1b"><apply id="A4.p1.9.m9.1.1.cmml" xref="A4.p1.9.m9.1.1"><eq id="A4.p1.9.m9.1.1.1.cmml" xref="A4.p1.9.m9.1.1.1"></eq><ci id="A4.p1.9.m9.1.1.2.cmml" xref="A4.p1.9.m9.1.1.2">𝐶</ci><cn id="A4.p1.9.m9.1.1.3.cmml" type="integer" xref="A4.p1.9.m9.1.1.3">64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.9.m9.1c">C=64</annotation><annotation encoding="application/x-llamapun" id="A4.p1.9.m9.1d">italic_C = 64</annotation></semantics></math> in practice, which corresponds to roughly 4.5 seconds of audio once decoded, and ignore all the leading <math alttext="C" class="ltx_Math" display="inline" id="A4.p1.10.m10.1"><semantics id="A4.p1.10.m10.1a"><mi id="A4.p1.10.m10.1.1" xref="A4.p1.10.m10.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="A4.p1.10.m10.1b"><ci id="A4.p1.10.m10.1.1.cmml" xref="A4.p1.10.m10.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.10.m10.1c">C</annotation><annotation encoding="application/x-llamapun" id="A4.p1.10.m10.1d">italic_C</annotation></semantics></math> tokens as they have a reduced context (furthermore, in our experimental scenario, they include the initial prompt used for generation).</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="A4.p2">
<p class="ltx_p" id="A4.p2.1">We observe qualitatively that the entropy spectrum is often indicative of artifacts or degradations of the audio samples.
Formally we define three types of artifacts from the entropy statistics, as described below. In practice, we characterize the presence or absence of each artifact over non-overlapping windows of <math alttext="\omega=64" class="ltx_Math" display="inline" id="A4.p2.1.m1.1"><semantics id="A4.p2.1.m1.1a"><mrow id="A4.p2.1.m1.1.1" xref="A4.p2.1.m1.1.1.cmml"><mi id="A4.p2.1.m1.1.1.2" xref="A4.p2.1.m1.1.1.2.cmml">ω</mi><mo id="A4.p2.1.m1.1.1.1" xref="A4.p2.1.m1.1.1.1.cmml">=</mo><mn id="A4.p2.1.m1.1.1.3" xref="A4.p2.1.m1.1.1.3.cmml">64</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.p2.1.m1.1b"><apply id="A4.p2.1.m1.1.1.cmml" xref="A4.p2.1.m1.1.1"><eq id="A4.p2.1.m1.1.1.1.cmml" xref="A4.p2.1.m1.1.1.1"></eq><ci id="A4.p2.1.m1.1.1.2.cmml" xref="A4.p2.1.m1.1.1.2">𝜔</ci><cn id="A4.p2.1.m1.1.1.3.cmml" type="integer" xref="A4.p2.1.m1.1.1.3">64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p2.1.m1.1c">\omega=64</annotation><annotation encoding="application/x-llamapun" id="A4.p2.1.m1.1d">italic_ω = 64</annotation></semantics></math> tokens, as illustrated in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#A4.F10" title="Figure 10 ‣ Bad audio quality. ‣ Appendix D Characterizing Audio Artifacts Caused by Quantization ‣ Moshi: a speech-text foundation model for real-time dialogue">Figure <span class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_paragraph" id="A4.SS0.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Repetitive text.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A4.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="A4.SS0.SSS0.Px1.p1.3">A first observed degradation is the model quickly repeating short sentences or words. This is characterized by the text entropy being almost flat over a window <math alttext="H^{0}_{s:s+\omega}" class="ltx_Math" display="inline" id="A4.SS0.SSS0.Px1.p1.1.m1.1"><semantics id="A4.SS0.SSS0.Px1.p1.1.m1.1a"><msubsup id="A4.SS0.SSS0.Px1.p1.1.m1.1.1" xref="A4.SS0.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="A4.SS0.SSS0.Px1.p1.1.m1.1.1.2.2" xref="A4.SS0.SSS0.Px1.p1.1.m1.1.1.2.2.cmml">H</mi><mrow id="A4.SS0.SSS0.Px1.p1.1.m1.1.1.3" xref="A4.SS0.SSS0.Px1.p1.1.m1.1.1.3.cmml"><mi id="A4.SS0.SSS0.Px1.p1.1.m1.1.1.3.2" xref="A4.SS0.SSS0.Px1.p1.1.m1.1.1.3.2.cmml">s</mi><mo id="A4.SS0.SSS0.Px1.p1.1.m1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="A4.SS0.SSS0.Px1.p1.1.m1.1.1.3.1.cmml">:</mo><mrow id="A4.SS0.SSS0.Px1.p1.1.m1.1.1.3.3" xref="A4.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.cmml"><mi id="A4.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.2" xref="A4.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.2.cmml">s</mi><mo id="A4.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.1" xref="A4.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.1.cmml">+</mo><mi id="A4.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.3" xref="A4.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.3.cmml">ω</mi></mrow></mrow><mn id="A4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3" xref="A4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.cmml">0</mn></msubsup><annotation-xml encoding="MathML-Content" id="A4.SS0.SSS0.Px1.p1.1.m1.1b"><apply id="A4.SS0.SSS0.Px1.p1.1.m1.1.1.cmml" xref="A4.SS0.SSS0.Px1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A4.SS0.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="A4.SS0.SSS0.Px1.p1.1.m1.1.1">subscript</csymbol><apply id="A4.SS0.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="A4.SS0.SSS0.Px1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A4.SS0.SSS0.Px1.p1.1.m1.1.1.2.1.cmml" xref="A4.SS0.SSS0.Px1.p1.1.m1.1.1">superscript</csymbol><ci id="A4.SS0.SSS0.Px1.p1.1.m1.1.1.2.2.cmml" xref="A4.SS0.SSS0.Px1.p1.1.m1.1.1.2.2">𝐻</ci><cn id="A4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.cmml" type="integer" xref="A4.SS0.SSS0.Px1.p1.1.m1.1.1.2.3">0</cn></apply><apply id="A4.SS0.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="A4.SS0.SSS0.Px1.p1.1.m1.1.1.3"><ci id="A4.SS0.SSS0.Px1.p1.1.m1.1.1.3.1.cmml" xref="A4.SS0.SSS0.Px1.p1.1.m1.1.1.3.1">:</ci><ci id="A4.SS0.SSS0.Px1.p1.1.m1.1.1.3.2.cmml" xref="A4.SS0.SSS0.Px1.p1.1.m1.1.1.3.2">𝑠</ci><apply id="A4.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.cmml" xref="A4.SS0.SSS0.Px1.p1.1.m1.1.1.3.3"><plus id="A4.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.1.cmml" xref="A4.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.1"></plus><ci id="A4.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.2.cmml" xref="A4.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.2">𝑠</ci><ci id="A4.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.3.cmml" xref="A4.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.3">𝜔</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS0.SSS0.Px1.p1.1.m1.1c">H^{0}_{s:s+\omega}</annotation><annotation encoding="application/x-llamapun" id="A4.SS0.SSS0.Px1.p1.1.m1.1d">italic_H start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s : italic_s + italic_ω end_POSTSUBSCRIPT</annotation></semantics></math>, but non zero (as more than one token is repeated), as seen in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#A4.F10" title="Figure 10 ‣ Bad audio quality. ‣ Appendix D Characterizing Audio Artifacts Caused by Quantization ‣ Moshi: a speech-text foundation model for real-time dialogue">Figure <span class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></span> (c)</a>. We measure the “flatness” of <math alttext="H^{0}_{s:s+\omega}" class="ltx_Math" display="inline" id="A4.SS0.SSS0.Px1.p1.2.m2.1"><semantics id="A4.SS0.SSS0.Px1.p1.2.m2.1a"><msubsup id="A4.SS0.SSS0.Px1.p1.2.m2.1.1" xref="A4.SS0.SSS0.Px1.p1.2.m2.1.1.cmml"><mi id="A4.SS0.SSS0.Px1.p1.2.m2.1.1.2.2" xref="A4.SS0.SSS0.Px1.p1.2.m2.1.1.2.2.cmml">H</mi><mrow id="A4.SS0.SSS0.Px1.p1.2.m2.1.1.3" xref="A4.SS0.SSS0.Px1.p1.2.m2.1.1.3.cmml"><mi id="A4.SS0.SSS0.Px1.p1.2.m2.1.1.3.2" xref="A4.SS0.SSS0.Px1.p1.2.m2.1.1.3.2.cmml">s</mi><mo id="A4.SS0.SSS0.Px1.p1.2.m2.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="A4.SS0.SSS0.Px1.p1.2.m2.1.1.3.1.cmml">:</mo><mrow id="A4.SS0.SSS0.Px1.p1.2.m2.1.1.3.3" xref="A4.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.cmml"><mi id="A4.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.2" xref="A4.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.2.cmml">s</mi><mo id="A4.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.1" xref="A4.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.1.cmml">+</mo><mi id="A4.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.3" xref="A4.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.3.cmml">ω</mi></mrow></mrow><mn id="A4.SS0.SSS0.Px1.p1.2.m2.1.1.2.3" xref="A4.SS0.SSS0.Px1.p1.2.m2.1.1.2.3.cmml">0</mn></msubsup><annotation-xml encoding="MathML-Content" id="A4.SS0.SSS0.Px1.p1.2.m2.1b"><apply id="A4.SS0.SSS0.Px1.p1.2.m2.1.1.cmml" xref="A4.SS0.SSS0.Px1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A4.SS0.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="A4.SS0.SSS0.Px1.p1.2.m2.1.1">subscript</csymbol><apply id="A4.SS0.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="A4.SS0.SSS0.Px1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A4.SS0.SSS0.Px1.p1.2.m2.1.1.2.1.cmml" xref="A4.SS0.SSS0.Px1.p1.2.m2.1.1">superscript</csymbol><ci id="A4.SS0.SSS0.Px1.p1.2.m2.1.1.2.2.cmml" xref="A4.SS0.SSS0.Px1.p1.2.m2.1.1.2.2">𝐻</ci><cn id="A4.SS0.SSS0.Px1.p1.2.m2.1.1.2.3.cmml" type="integer" xref="A4.SS0.SSS0.Px1.p1.2.m2.1.1.2.3">0</cn></apply><apply id="A4.SS0.SSS0.Px1.p1.2.m2.1.1.3.cmml" xref="A4.SS0.SSS0.Px1.p1.2.m2.1.1.3"><ci id="A4.SS0.SSS0.Px1.p1.2.m2.1.1.3.1.cmml" xref="A4.SS0.SSS0.Px1.p1.2.m2.1.1.3.1">:</ci><ci id="A4.SS0.SSS0.Px1.p1.2.m2.1.1.3.2.cmml" xref="A4.SS0.SSS0.Px1.p1.2.m2.1.1.3.2">𝑠</ci><apply id="A4.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.cmml" xref="A4.SS0.SSS0.Px1.p1.2.m2.1.1.3.3"><plus id="A4.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.1.cmml" xref="A4.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.1"></plus><ci id="A4.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.2.cmml" xref="A4.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.2">𝑠</ci><ci id="A4.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.3.cmml" xref="A4.SS0.SSS0.Px1.p1.2.m2.1.1.3.3.3">𝜔</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS0.SSS0.Px1.p1.2.m2.1c">H^{0}_{s:s+\omega}</annotation><annotation encoding="application/x-llamapun" id="A4.SS0.SSS0.Px1.p1.2.m2.1d">italic_H start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s : italic_s + italic_ω end_POSTSUBSCRIPT</annotation></semantics></math> by fitting a linear regression model to it and verifying whether the slope is below a certain threshold hyper-parameter <math alttext="\eta_{\text{flat}}=10^{-3}" class="ltx_Math" display="inline" id="A4.SS0.SSS0.Px1.p1.3.m3.1"><semantics id="A4.SS0.SSS0.Px1.p1.3.m3.1a"><mrow id="A4.SS0.SSS0.Px1.p1.3.m3.1.1" xref="A4.SS0.SSS0.Px1.p1.3.m3.1.1.cmml"><msub id="A4.SS0.SSS0.Px1.p1.3.m3.1.1.2" xref="A4.SS0.SSS0.Px1.p1.3.m3.1.1.2.cmml"><mi id="A4.SS0.SSS0.Px1.p1.3.m3.1.1.2.2" xref="A4.SS0.SSS0.Px1.p1.3.m3.1.1.2.2.cmml">η</mi><mtext id="A4.SS0.SSS0.Px1.p1.3.m3.1.1.2.3" xref="A4.SS0.SSS0.Px1.p1.3.m3.1.1.2.3a.cmml">flat</mtext></msub><mo id="A4.SS0.SSS0.Px1.p1.3.m3.1.1.1" xref="A4.SS0.SSS0.Px1.p1.3.m3.1.1.1.cmml">=</mo><msup id="A4.SS0.SSS0.Px1.p1.3.m3.1.1.3" xref="A4.SS0.SSS0.Px1.p1.3.m3.1.1.3.cmml"><mn id="A4.SS0.SSS0.Px1.p1.3.m3.1.1.3.2" xref="A4.SS0.SSS0.Px1.p1.3.m3.1.1.3.2.cmml">10</mn><mrow id="A4.SS0.SSS0.Px1.p1.3.m3.1.1.3.3" xref="A4.SS0.SSS0.Px1.p1.3.m3.1.1.3.3.cmml"><mo id="A4.SS0.SSS0.Px1.p1.3.m3.1.1.3.3a" xref="A4.SS0.SSS0.Px1.p1.3.m3.1.1.3.3.cmml">−</mo><mn id="A4.SS0.SSS0.Px1.p1.3.m3.1.1.3.3.2" xref="A4.SS0.SSS0.Px1.p1.3.m3.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A4.SS0.SSS0.Px1.p1.3.m3.1b"><apply id="A4.SS0.SSS0.Px1.p1.3.m3.1.1.cmml" xref="A4.SS0.SSS0.Px1.p1.3.m3.1.1"><eq id="A4.SS0.SSS0.Px1.p1.3.m3.1.1.1.cmml" xref="A4.SS0.SSS0.Px1.p1.3.m3.1.1.1"></eq><apply id="A4.SS0.SSS0.Px1.p1.3.m3.1.1.2.cmml" xref="A4.SS0.SSS0.Px1.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="A4.SS0.SSS0.Px1.p1.3.m3.1.1.2.1.cmml" xref="A4.SS0.SSS0.Px1.p1.3.m3.1.1.2">subscript</csymbol><ci id="A4.SS0.SSS0.Px1.p1.3.m3.1.1.2.2.cmml" xref="A4.SS0.SSS0.Px1.p1.3.m3.1.1.2.2">𝜂</ci><ci id="A4.SS0.SSS0.Px1.p1.3.m3.1.1.2.3a.cmml" xref="A4.SS0.SSS0.Px1.p1.3.m3.1.1.2.3"><mtext id="A4.SS0.SSS0.Px1.p1.3.m3.1.1.2.3.cmml" mathsize="70%" xref="A4.SS0.SSS0.Px1.p1.3.m3.1.1.2.3">flat</mtext></ci></apply><apply id="A4.SS0.SSS0.Px1.p1.3.m3.1.1.3.cmml" xref="A4.SS0.SSS0.Px1.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="A4.SS0.SSS0.Px1.p1.3.m3.1.1.3.1.cmml" xref="A4.SS0.SSS0.Px1.p1.3.m3.1.1.3">superscript</csymbol><cn id="A4.SS0.SSS0.Px1.p1.3.m3.1.1.3.2.cmml" type="integer" xref="A4.SS0.SSS0.Px1.p1.3.m3.1.1.3.2">10</cn><apply id="A4.SS0.SSS0.Px1.p1.3.m3.1.1.3.3.cmml" xref="A4.SS0.SSS0.Px1.p1.3.m3.1.1.3.3"><minus id="A4.SS0.SSS0.Px1.p1.3.m3.1.1.3.3.1.cmml" xref="A4.SS0.SSS0.Px1.p1.3.m3.1.1.3.3"></minus><cn id="A4.SS0.SSS0.Px1.p1.3.m3.1.1.3.3.2.cmml" type="integer" xref="A4.SS0.SSS0.Px1.p1.3.m3.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS0.SSS0.Px1.p1.3.m3.1c">\eta_{\text{flat}}=10^{-3}</annotation><annotation encoding="application/x-llamapun" id="A4.SS0.SSS0.Px1.p1.3.m3.1d">italic_η start_POSTSUBSCRIPT flat end_POSTSUBSCRIPT = 10 start_POSTSUPERSCRIPT - 3 end_POSTSUPERSCRIPT</annotation></semantics></math>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="A4.SS0.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Silence vs. background noise.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A4.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="A4.SS0.SSS0.Px2.p1.2">By design, Moshi being silent corresponds to a constant stream of <span class="ltx_text ltx_font_typewriter" id="A4.SS0.SSS0.Px2.p1.2.1">PAD</span> text tokens (hence <math alttext="H^{0}_{s:s+\omega}=0" class="ltx_Math" display="inline" id="A4.SS0.SSS0.Px2.p1.1.m1.1"><semantics id="A4.SS0.SSS0.Px2.p1.1.m1.1a"><mrow id="A4.SS0.SSS0.Px2.p1.1.m1.1.1" xref="A4.SS0.SSS0.Px2.p1.1.m1.1.1.cmml"><msubsup id="A4.SS0.SSS0.Px2.p1.1.m1.1.1.2" xref="A4.SS0.SSS0.Px2.p1.1.m1.1.1.2.cmml"><mi id="A4.SS0.SSS0.Px2.p1.1.m1.1.1.2.2.2" xref="A4.SS0.SSS0.Px2.p1.1.m1.1.1.2.2.2.cmml">H</mi><mrow id="A4.SS0.SSS0.Px2.p1.1.m1.1.1.2.3" xref="A4.SS0.SSS0.Px2.p1.1.m1.1.1.2.3.cmml"><mi id="A4.SS0.SSS0.Px2.p1.1.m1.1.1.2.3.2" xref="A4.SS0.SSS0.Px2.p1.1.m1.1.1.2.3.2.cmml">s</mi><mo id="A4.SS0.SSS0.Px2.p1.1.m1.1.1.2.3.1" lspace="0.278em" rspace="0.278em" xref="A4.SS0.SSS0.Px2.p1.1.m1.1.1.2.3.1.cmml">:</mo><mrow id="A4.SS0.SSS0.Px2.p1.1.m1.1.1.2.3.3" xref="A4.SS0.SSS0.Px2.p1.1.m1.1.1.2.3.3.cmml"><mi id="A4.SS0.SSS0.Px2.p1.1.m1.1.1.2.3.3.2" xref="A4.SS0.SSS0.Px2.p1.1.m1.1.1.2.3.3.2.cmml">s</mi><mo id="A4.SS0.SSS0.Px2.p1.1.m1.1.1.2.3.3.1" xref="A4.SS0.SSS0.Px2.p1.1.m1.1.1.2.3.3.1.cmml">+</mo><mi id="A4.SS0.SSS0.Px2.p1.1.m1.1.1.2.3.3.3" xref="A4.SS0.SSS0.Px2.p1.1.m1.1.1.2.3.3.3.cmml">ω</mi></mrow></mrow><mn id="A4.SS0.SSS0.Px2.p1.1.m1.1.1.2.2.3" xref="A4.SS0.SSS0.Px2.p1.1.m1.1.1.2.2.3.cmml">0</mn></msubsup><mo id="A4.SS0.SSS0.Px2.p1.1.m1.1.1.1" xref="A4.SS0.SSS0.Px2.p1.1.m1.1.1.1.cmml">=</mo><mn id="A4.SS0.SSS0.Px2.p1.1.m1.1.1.3" xref="A4.SS0.SSS0.Px2.p1.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.SS0.SSS0.Px2.p1.1.m1.1b"><apply id="A4.SS0.SSS0.Px2.p1.1.m1.1.1.cmml" xref="A4.SS0.SSS0.Px2.p1.1.m1.1.1"><eq id="A4.SS0.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="A4.SS0.SSS0.Px2.p1.1.m1.1.1.1"></eq><apply id="A4.SS0.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="A4.SS0.SSS0.Px2.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="A4.SS0.SSS0.Px2.p1.1.m1.1.1.2.1.cmml" xref="A4.SS0.SSS0.Px2.p1.1.m1.1.1.2">subscript</csymbol><apply id="A4.SS0.SSS0.Px2.p1.1.m1.1.1.2.2.cmml" xref="A4.SS0.SSS0.Px2.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="A4.SS0.SSS0.Px2.p1.1.m1.1.1.2.2.1.cmml" xref="A4.SS0.SSS0.Px2.p1.1.m1.1.1.2">superscript</csymbol><ci id="A4.SS0.SSS0.Px2.p1.1.m1.1.1.2.2.2.cmml" xref="A4.SS0.SSS0.Px2.p1.1.m1.1.1.2.2.2">𝐻</ci><cn id="A4.SS0.SSS0.Px2.p1.1.m1.1.1.2.2.3.cmml" type="integer" xref="A4.SS0.SSS0.Px2.p1.1.m1.1.1.2.2.3">0</cn></apply><apply id="A4.SS0.SSS0.Px2.p1.1.m1.1.1.2.3.cmml" xref="A4.SS0.SSS0.Px2.p1.1.m1.1.1.2.3"><ci id="A4.SS0.SSS0.Px2.p1.1.m1.1.1.2.3.1.cmml" xref="A4.SS0.SSS0.Px2.p1.1.m1.1.1.2.3.1">:</ci><ci id="A4.SS0.SSS0.Px2.p1.1.m1.1.1.2.3.2.cmml" xref="A4.SS0.SSS0.Px2.p1.1.m1.1.1.2.3.2">𝑠</ci><apply id="A4.SS0.SSS0.Px2.p1.1.m1.1.1.2.3.3.cmml" xref="A4.SS0.SSS0.Px2.p1.1.m1.1.1.2.3.3"><plus id="A4.SS0.SSS0.Px2.p1.1.m1.1.1.2.3.3.1.cmml" xref="A4.SS0.SSS0.Px2.p1.1.m1.1.1.2.3.3.1"></plus><ci id="A4.SS0.SSS0.Px2.p1.1.m1.1.1.2.3.3.2.cmml" xref="A4.SS0.SSS0.Px2.p1.1.m1.1.1.2.3.3.2">𝑠</ci><ci id="A4.SS0.SSS0.Px2.p1.1.m1.1.1.2.3.3.3.cmml" xref="A4.SS0.SSS0.Px2.p1.1.m1.1.1.2.3.3.3">𝜔</ci></apply></apply></apply><cn id="A4.SS0.SSS0.Px2.p1.1.m1.1.1.3.cmml" type="integer" xref="A4.SS0.SSS0.Px2.p1.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS0.SSS0.Px2.p1.1.m1.1c">H^{0}_{s:s+\omega}=0</annotation><annotation encoding="application/x-llamapun" id="A4.SS0.SSS0.Px2.p1.1.m1.1d">italic_H start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s : italic_s + italic_ω end_POSTSUBSCRIPT = 0</annotation></semantics></math>), while simultaneously, the corresponding audio tokens decode to a near silent waveform: The audio tokens are not constant, but fall into a small subset of “silence tokens”, which results in a lower overall entropy for the audio tokens as seen for instance in the short silences of <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#A4.F10" title="Figure 10 ‣ Bad audio quality. ‣ Appendix D Characterizing Audio Artifacts Caused by Quantization ‣ Moshi: a speech-text foundation model for real-time dialogue">Figure <span class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></span> (a)</a>. We measure this behavior as <math alttext="\text{median}_{k>1,s}(H^{k}_{s:s+\omega})\leq\eta_{\text{audio\_silence}}=2" class="ltx_Math" display="inline" id="A4.SS0.SSS0.Px2.p1.2.m2.3"><semantics id="A4.SS0.SSS0.Px2.p1.2.m2.3a"><mrow id="A4.SS0.SSS0.Px2.p1.2.m2.3.3" xref="A4.SS0.SSS0.Px2.p1.2.m2.3.3.cmml"><mrow id="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1" xref="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.cmml"><msub id="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.3" xref="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.3.cmml"><mtext id="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.3.2" xref="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.3.2a.cmml">median</mtext><mrow id="A4.SS0.SSS0.Px2.p1.2.m2.2.2.2" xref="A4.SS0.SSS0.Px2.p1.2.m2.2.2.2.cmml"><mi id="A4.SS0.SSS0.Px2.p1.2.m2.2.2.2.4" xref="A4.SS0.SSS0.Px2.p1.2.m2.2.2.2.4.cmml">k</mi><mo id="A4.SS0.SSS0.Px2.p1.2.m2.2.2.2.3" xref="A4.SS0.SSS0.Px2.p1.2.m2.2.2.2.3.cmml">&gt;</mo><mrow id="A4.SS0.SSS0.Px2.p1.2.m2.2.2.2.5.2" xref="A4.SS0.SSS0.Px2.p1.2.m2.2.2.2.5.1.cmml"><mn id="A4.SS0.SSS0.Px2.p1.2.m2.1.1.1.1" xref="A4.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.cmml">1</mn><mo id="A4.SS0.SSS0.Px2.p1.2.m2.2.2.2.5.2.1" xref="A4.SS0.SSS0.Px2.p1.2.m2.2.2.2.5.1.cmml">,</mo><mi id="A4.SS0.SSS0.Px2.p1.2.m2.2.2.2.2" xref="A4.SS0.SSS0.Px2.p1.2.m2.2.2.2.2.cmml">s</mi></mrow></mrow></msub><mo id="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.2" xref="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.2.cmml">⁢</mo><mrow id="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.1.1" xref="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.1.1.1.cmml"><mo id="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.1.1.2" stretchy="false" xref="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.1.1.1.cmml">(</mo><msubsup id="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.1.1.1" xref="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.1.1.1.cmml"><mi id="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.1.1.1.2.2" xref="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.1.1.1.2.2.cmml">H</mi><mrow id="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.1.1.1.3" xref="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.1.1.1.3.cmml"><mi id="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.1.1.1.3.2" xref="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.1.1.1.3.2.cmml">s</mi><mo id="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.1.1.1.3.1.cmml">:</mo><mrow id="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.1.1.1.3.3" xref="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.1.1.1.3.3.cmml"><mi id="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.1.1.1.3.3.2" xref="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.1.1.1.3.3.2.cmml">s</mi><mo id="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.1.1.1.3.3.1" xref="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.1.1.1.3.3.1.cmml">+</mo><mi id="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.1.1.1.3.3.3" xref="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.1.1.1.3.3.3.cmml">ω</mi></mrow></mrow><mi id="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.1.1.1.2.3" xref="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.1.1.1.2.3.cmml">k</mi></msubsup><mo id="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.1.1.3" stretchy="false" xref="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A4.SS0.SSS0.Px2.p1.2.m2.3.3.3" xref="A4.SS0.SSS0.Px2.p1.2.m2.3.3.3.cmml">≤</mo><msub id="A4.SS0.SSS0.Px2.p1.2.m2.3.3.4" xref="A4.SS0.SSS0.Px2.p1.2.m2.3.3.4.cmml"><mi id="A4.SS0.SSS0.Px2.p1.2.m2.3.3.4.2" xref="A4.SS0.SSS0.Px2.p1.2.m2.3.3.4.2.cmml">η</mi><mtext id="A4.SS0.SSS0.Px2.p1.2.m2.3.3.4.3" xref="A4.SS0.SSS0.Px2.p1.2.m2.3.3.4.3a.cmml">audio_silence</mtext></msub><mo id="A4.SS0.SSS0.Px2.p1.2.m2.3.3.5" xref="A4.SS0.SSS0.Px2.p1.2.m2.3.3.5.cmml">=</mo><mn id="A4.SS0.SSS0.Px2.p1.2.m2.3.3.6" xref="A4.SS0.SSS0.Px2.p1.2.m2.3.3.6.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.SS0.SSS0.Px2.p1.2.m2.3b"><apply id="A4.SS0.SSS0.Px2.p1.2.m2.3.3.cmml" xref="A4.SS0.SSS0.Px2.p1.2.m2.3.3"><and id="A4.SS0.SSS0.Px2.p1.2.m2.3.3a.cmml" xref="A4.SS0.SSS0.Px2.p1.2.m2.3.3"></and><apply id="A4.SS0.SSS0.Px2.p1.2.m2.3.3b.cmml" xref="A4.SS0.SSS0.Px2.p1.2.m2.3.3"><leq id="A4.SS0.SSS0.Px2.p1.2.m2.3.3.3.cmml" xref="A4.SS0.SSS0.Px2.p1.2.m2.3.3.3"></leq><apply id="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.cmml" xref="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1"><times id="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.2.cmml" xref="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.2"></times><apply id="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.3.cmml" xref="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.3"><csymbol cd="ambiguous" id="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.3.1.cmml" xref="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.3">subscript</csymbol><ci id="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.3.2a.cmml" xref="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.3.2"><mtext id="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.3.2.cmml" xref="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.3.2">median</mtext></ci><apply id="A4.SS0.SSS0.Px2.p1.2.m2.2.2.2.cmml" xref="A4.SS0.SSS0.Px2.p1.2.m2.2.2.2"><gt id="A4.SS0.SSS0.Px2.p1.2.m2.2.2.2.3.cmml" xref="A4.SS0.SSS0.Px2.p1.2.m2.2.2.2.3"></gt><ci id="A4.SS0.SSS0.Px2.p1.2.m2.2.2.2.4.cmml" xref="A4.SS0.SSS0.Px2.p1.2.m2.2.2.2.4">𝑘</ci><list id="A4.SS0.SSS0.Px2.p1.2.m2.2.2.2.5.1.cmml" xref="A4.SS0.SSS0.Px2.p1.2.m2.2.2.2.5.2"><cn id="A4.SS0.SSS0.Px2.p1.2.m2.1.1.1.1.cmml" type="integer" xref="A4.SS0.SSS0.Px2.p1.2.m2.1.1.1.1">1</cn><ci id="A4.SS0.SSS0.Px2.p1.2.m2.2.2.2.2.cmml" xref="A4.SS0.SSS0.Px2.p1.2.m2.2.2.2.2">𝑠</ci></list></apply></apply><apply id="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.1.1.1.cmml" xref="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.1.1"><csymbol cd="ambiguous" id="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.1.1.1.1.cmml" xref="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.1.1">subscript</csymbol><apply id="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.1.1.1.2.cmml" xref="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.1.1"><csymbol cd="ambiguous" id="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.1.1.1.2.1.cmml" xref="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.1.1">superscript</csymbol><ci id="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.1.1.1.2.2.cmml" xref="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.1.1.1.2.2">𝐻</ci><ci id="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.1.1.1.2.3.cmml" xref="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.1.1.1.2.3">𝑘</ci></apply><apply id="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.1.1.1.3.cmml" xref="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.1.1.1.3"><ci id="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.1.1.1.3.1.cmml" xref="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.1.1.1.3.1">:</ci><ci id="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.1.1.1.3.2.cmml" xref="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.1.1.1.3.2">𝑠</ci><apply id="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.1.1.1.3.3.cmml" xref="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.1.1.1.3.3"><plus id="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.1.1.1.3.3.1.cmml" xref="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.1.1.1.3.3.1"></plus><ci id="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.1.1.1.3.3.2.cmml" xref="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.1.1.1.3.3.2">𝑠</ci><ci id="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.1.1.1.3.3.3.cmml" xref="A4.SS0.SSS0.Px2.p1.2.m2.3.3.1.1.1.1.3.3.3">𝜔</ci></apply></apply></apply></apply><apply id="A4.SS0.SSS0.Px2.p1.2.m2.3.3.4.cmml" xref="A4.SS0.SSS0.Px2.p1.2.m2.3.3.4"><csymbol cd="ambiguous" id="A4.SS0.SSS0.Px2.p1.2.m2.3.3.4.1.cmml" xref="A4.SS0.SSS0.Px2.p1.2.m2.3.3.4">subscript</csymbol><ci id="A4.SS0.SSS0.Px2.p1.2.m2.3.3.4.2.cmml" xref="A4.SS0.SSS0.Px2.p1.2.m2.3.3.4.2">𝜂</ci><ci id="A4.SS0.SSS0.Px2.p1.2.m2.3.3.4.3a.cmml" xref="A4.SS0.SSS0.Px2.p1.2.m2.3.3.4.3"><mtext id="A4.SS0.SSS0.Px2.p1.2.m2.3.3.4.3.cmml" mathsize="70%" xref="A4.SS0.SSS0.Px2.p1.2.m2.3.3.4.3">audio_silence</mtext></ci></apply></apply><apply id="A4.SS0.SSS0.Px2.p1.2.m2.3.3c.cmml" xref="A4.SS0.SSS0.Px2.p1.2.m2.3.3"><eq id="A4.SS0.SSS0.Px2.p1.2.m2.3.3.5.cmml" xref="A4.SS0.SSS0.Px2.p1.2.m2.3.3.5"></eq><share href="https://arxiv.org/html/2410.00037v2#A4.SS0.SSS0.Px2.p1.2.m2.3.3.4.cmml" id="A4.SS0.SSS0.Px2.p1.2.m2.3.3d.cmml" xref="A4.SS0.SSS0.Px2.p1.2.m2.3.3"></share><cn id="A4.SS0.SSS0.Px2.p1.2.m2.3.3.6.cmml" type="integer" xref="A4.SS0.SSS0.Px2.p1.2.m2.3.3.6">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS0.SSS0.Px2.p1.2.m2.3c">\text{median}_{k&gt;1,s}(H^{k}_{s:s+\omega})\leq\eta_{\text{audio\_silence}}=2</annotation><annotation encoding="application/x-llamapun" id="A4.SS0.SSS0.Px2.p1.2.m2.3d">median start_POSTSUBSCRIPT italic_k &gt; 1 , italic_s end_POSTSUBSCRIPT ( italic_H start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s : italic_s + italic_ω end_POSTSUBSCRIPT ) ≤ italic_η start_POSTSUBSCRIPT audio_silence end_POSTSUBSCRIPT = 2</annotation></semantics></math>.
Note that <span class="ltx_text ltx_font_italic" id="A4.SS0.SSS0.Px2.p1.2.2">we do not consider these silences to be artifacts</span>: This is because silences occur naturally in the multi-stream model as they simply represent the other speaker’s turn. For illustration purposes, we highlight silences throughout <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#A4.F10" title="Figure 10 ‣ Bad audio quality. ‣ Appendix D Characterizing Audio Artifacts Caused by Quantization ‣ Moshi: a speech-text foundation model for real-time dialogue">Figures <span class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></span> and <span class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></span></a>, but we count them as artifact-free timesteps otherwise.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="A4.SS0.SSS0.Px2.p2">
<p class="ltx_p" id="A4.SS0.SSS0.Px2.p2.2">In contrast, <em class="ltx_emph ltx_font_italic" id="A4.SS0.SSS0.Px2.p2.2.1">background noise</em> artifacts occur when the text stream is silent (<math alttext="H^{0}_{s:s+\omega}=0" class="ltx_Math" display="inline" id="A4.SS0.SSS0.Px2.p2.1.m1.1"><semantics id="A4.SS0.SSS0.Px2.p2.1.m1.1a"><mrow id="A4.SS0.SSS0.Px2.p2.1.m1.1.1" xref="A4.SS0.SSS0.Px2.p2.1.m1.1.1.cmml"><msubsup id="A4.SS0.SSS0.Px2.p2.1.m1.1.1.2" xref="A4.SS0.SSS0.Px2.p2.1.m1.1.1.2.cmml"><mi id="A4.SS0.SSS0.Px2.p2.1.m1.1.1.2.2.2" xref="A4.SS0.SSS0.Px2.p2.1.m1.1.1.2.2.2.cmml">H</mi><mrow id="A4.SS0.SSS0.Px2.p2.1.m1.1.1.2.3" xref="A4.SS0.SSS0.Px2.p2.1.m1.1.1.2.3.cmml"><mi id="A4.SS0.SSS0.Px2.p2.1.m1.1.1.2.3.2" xref="A4.SS0.SSS0.Px2.p2.1.m1.1.1.2.3.2.cmml">s</mi><mo id="A4.SS0.SSS0.Px2.p2.1.m1.1.1.2.3.1" lspace="0.278em" rspace="0.278em" xref="A4.SS0.SSS0.Px2.p2.1.m1.1.1.2.3.1.cmml">:</mo><mrow id="A4.SS0.SSS0.Px2.p2.1.m1.1.1.2.3.3" xref="A4.SS0.SSS0.Px2.p2.1.m1.1.1.2.3.3.cmml"><mi id="A4.SS0.SSS0.Px2.p2.1.m1.1.1.2.3.3.2" xref="A4.SS0.SSS0.Px2.p2.1.m1.1.1.2.3.3.2.cmml">s</mi><mo id="A4.SS0.SSS0.Px2.p2.1.m1.1.1.2.3.3.1" xref="A4.SS0.SSS0.Px2.p2.1.m1.1.1.2.3.3.1.cmml">+</mo><mi id="A4.SS0.SSS0.Px2.p2.1.m1.1.1.2.3.3.3" xref="A4.SS0.SSS0.Px2.p2.1.m1.1.1.2.3.3.3.cmml">ω</mi></mrow></mrow><mn id="A4.SS0.SSS0.Px2.p2.1.m1.1.1.2.2.3" xref="A4.SS0.SSS0.Px2.p2.1.m1.1.1.2.2.3.cmml">0</mn></msubsup><mo id="A4.SS0.SSS0.Px2.p2.1.m1.1.1.1" xref="A4.SS0.SSS0.Px2.p2.1.m1.1.1.1.cmml">=</mo><mn id="A4.SS0.SSS0.Px2.p2.1.m1.1.1.3" xref="A4.SS0.SSS0.Px2.p2.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.SS0.SSS0.Px2.p2.1.m1.1b"><apply id="A4.SS0.SSS0.Px2.p2.1.m1.1.1.cmml" xref="A4.SS0.SSS0.Px2.p2.1.m1.1.1"><eq id="A4.SS0.SSS0.Px2.p2.1.m1.1.1.1.cmml" xref="A4.SS0.SSS0.Px2.p2.1.m1.1.1.1"></eq><apply id="A4.SS0.SSS0.Px2.p2.1.m1.1.1.2.cmml" xref="A4.SS0.SSS0.Px2.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="A4.SS0.SSS0.Px2.p2.1.m1.1.1.2.1.cmml" xref="A4.SS0.SSS0.Px2.p2.1.m1.1.1.2">subscript</csymbol><apply id="A4.SS0.SSS0.Px2.p2.1.m1.1.1.2.2.cmml" xref="A4.SS0.SSS0.Px2.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="A4.SS0.SSS0.Px2.p2.1.m1.1.1.2.2.1.cmml" xref="A4.SS0.SSS0.Px2.p2.1.m1.1.1.2">superscript</csymbol><ci id="A4.SS0.SSS0.Px2.p2.1.m1.1.1.2.2.2.cmml" xref="A4.SS0.SSS0.Px2.p2.1.m1.1.1.2.2.2">𝐻</ci><cn id="A4.SS0.SSS0.Px2.p2.1.m1.1.1.2.2.3.cmml" type="integer" xref="A4.SS0.SSS0.Px2.p2.1.m1.1.1.2.2.3">0</cn></apply><apply id="A4.SS0.SSS0.Px2.p2.1.m1.1.1.2.3.cmml" xref="A4.SS0.SSS0.Px2.p2.1.m1.1.1.2.3"><ci id="A4.SS0.SSS0.Px2.p2.1.m1.1.1.2.3.1.cmml" xref="A4.SS0.SSS0.Px2.p2.1.m1.1.1.2.3.1">:</ci><ci id="A4.SS0.SSS0.Px2.p2.1.m1.1.1.2.3.2.cmml" xref="A4.SS0.SSS0.Px2.p2.1.m1.1.1.2.3.2">𝑠</ci><apply id="A4.SS0.SSS0.Px2.p2.1.m1.1.1.2.3.3.cmml" xref="A4.SS0.SSS0.Px2.p2.1.m1.1.1.2.3.3"><plus id="A4.SS0.SSS0.Px2.p2.1.m1.1.1.2.3.3.1.cmml" xref="A4.SS0.SSS0.Px2.p2.1.m1.1.1.2.3.3.1"></plus><ci id="A4.SS0.SSS0.Px2.p2.1.m1.1.1.2.3.3.2.cmml" xref="A4.SS0.SSS0.Px2.p2.1.m1.1.1.2.3.3.2">𝑠</ci><ci id="A4.SS0.SSS0.Px2.p2.1.m1.1.1.2.3.3.3.cmml" xref="A4.SS0.SSS0.Px2.p2.1.m1.1.1.2.3.3.3">𝜔</ci></apply></apply></apply><cn id="A4.SS0.SSS0.Px2.p2.1.m1.1.1.3.cmml" type="integer" xref="A4.SS0.SSS0.Px2.p2.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS0.SSS0.Px2.p2.1.m1.1c">H^{0}_{s:s+\omega}=0</annotation><annotation encoding="application/x-llamapun" id="A4.SS0.SSS0.Px2.p2.1.m1.1d">italic_H start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s : italic_s + italic_ω end_POSTSUBSCRIPT = 0</annotation></semantics></math>), but audio tokens still have a rich output (<math alttext="\text{median}_{k>1,s}(H^{k}_{s:s+\omega})>\eta_{\text{audio\_silence}}" class="ltx_Math" display="inline" id="A4.SS0.SSS0.Px2.p2.2.m2.3"><semantics id="A4.SS0.SSS0.Px2.p2.2.m2.3a"><mrow id="A4.SS0.SSS0.Px2.p2.2.m2.3.3" xref="A4.SS0.SSS0.Px2.p2.2.m2.3.3.cmml"><mrow id="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1" xref="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.cmml"><msub id="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.3" xref="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.3.cmml"><mtext id="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.3.2" xref="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.3.2a.cmml">median</mtext><mrow id="A4.SS0.SSS0.Px2.p2.2.m2.2.2.2" xref="A4.SS0.SSS0.Px2.p2.2.m2.2.2.2.cmml"><mi id="A4.SS0.SSS0.Px2.p2.2.m2.2.2.2.4" xref="A4.SS0.SSS0.Px2.p2.2.m2.2.2.2.4.cmml">k</mi><mo id="A4.SS0.SSS0.Px2.p2.2.m2.2.2.2.3" xref="A4.SS0.SSS0.Px2.p2.2.m2.2.2.2.3.cmml">&gt;</mo><mrow id="A4.SS0.SSS0.Px2.p2.2.m2.2.2.2.5.2" xref="A4.SS0.SSS0.Px2.p2.2.m2.2.2.2.5.1.cmml"><mn id="A4.SS0.SSS0.Px2.p2.2.m2.1.1.1.1" xref="A4.SS0.SSS0.Px2.p2.2.m2.1.1.1.1.cmml">1</mn><mo id="A4.SS0.SSS0.Px2.p2.2.m2.2.2.2.5.2.1" xref="A4.SS0.SSS0.Px2.p2.2.m2.2.2.2.5.1.cmml">,</mo><mi id="A4.SS0.SSS0.Px2.p2.2.m2.2.2.2.2" xref="A4.SS0.SSS0.Px2.p2.2.m2.2.2.2.2.cmml">s</mi></mrow></mrow></msub><mo id="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.2" xref="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.2.cmml">⁢</mo><mrow id="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.1.1" xref="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.1.1.1.cmml"><mo id="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.1.1.2" stretchy="false" xref="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.1.1.1.cmml">(</mo><msubsup id="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.1.1.1" xref="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.1.1.1.cmml"><mi id="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.1.1.1.2.2" xref="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.1.1.1.2.2.cmml">H</mi><mrow id="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.1.1.1.3" xref="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.1.1.1.3.cmml"><mi id="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.1.1.1.3.2" xref="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.1.1.1.3.2.cmml">s</mi><mo id="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.1.1.1.3.1.cmml">:</mo><mrow id="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.1.1.1.3.3" xref="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.1.1.1.3.3.cmml"><mi id="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.1.1.1.3.3.2" xref="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.1.1.1.3.3.2.cmml">s</mi><mo id="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.1.1.1.3.3.1" xref="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.1.1.1.3.3.1.cmml">+</mo><mi id="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.1.1.1.3.3.3" xref="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.1.1.1.3.3.3.cmml">ω</mi></mrow></mrow><mi id="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.1.1.1.2.3" xref="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.1.1.1.2.3.cmml">k</mi></msubsup><mo id="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.1.1.3" stretchy="false" xref="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A4.SS0.SSS0.Px2.p2.2.m2.3.3.2" xref="A4.SS0.SSS0.Px2.p2.2.m2.3.3.2.cmml">&gt;</mo><msub id="A4.SS0.SSS0.Px2.p2.2.m2.3.3.3" xref="A4.SS0.SSS0.Px2.p2.2.m2.3.3.3.cmml"><mi id="A4.SS0.SSS0.Px2.p2.2.m2.3.3.3.2" xref="A4.SS0.SSS0.Px2.p2.2.m2.3.3.3.2.cmml">η</mi><mtext id="A4.SS0.SSS0.Px2.p2.2.m2.3.3.3.3" xref="A4.SS0.SSS0.Px2.p2.2.m2.3.3.3.3a.cmml">audio_silence</mtext></msub></mrow><annotation-xml encoding="MathML-Content" id="A4.SS0.SSS0.Px2.p2.2.m2.3b"><apply id="A4.SS0.SSS0.Px2.p2.2.m2.3.3.cmml" xref="A4.SS0.SSS0.Px2.p2.2.m2.3.3"><gt id="A4.SS0.SSS0.Px2.p2.2.m2.3.3.2.cmml" xref="A4.SS0.SSS0.Px2.p2.2.m2.3.3.2"></gt><apply id="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.cmml" xref="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1"><times id="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.2.cmml" xref="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.2"></times><apply id="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.3.cmml" xref="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.3"><csymbol cd="ambiguous" id="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.3.1.cmml" xref="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.3">subscript</csymbol><ci id="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.3.2a.cmml" xref="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.3.2"><mtext id="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.3.2.cmml" xref="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.3.2">median</mtext></ci><apply id="A4.SS0.SSS0.Px2.p2.2.m2.2.2.2.cmml" xref="A4.SS0.SSS0.Px2.p2.2.m2.2.2.2"><gt id="A4.SS0.SSS0.Px2.p2.2.m2.2.2.2.3.cmml" xref="A4.SS0.SSS0.Px2.p2.2.m2.2.2.2.3"></gt><ci id="A4.SS0.SSS0.Px2.p2.2.m2.2.2.2.4.cmml" xref="A4.SS0.SSS0.Px2.p2.2.m2.2.2.2.4">𝑘</ci><list id="A4.SS0.SSS0.Px2.p2.2.m2.2.2.2.5.1.cmml" xref="A4.SS0.SSS0.Px2.p2.2.m2.2.2.2.5.2"><cn id="A4.SS0.SSS0.Px2.p2.2.m2.1.1.1.1.cmml" type="integer" xref="A4.SS0.SSS0.Px2.p2.2.m2.1.1.1.1">1</cn><ci id="A4.SS0.SSS0.Px2.p2.2.m2.2.2.2.2.cmml" xref="A4.SS0.SSS0.Px2.p2.2.m2.2.2.2.2">𝑠</ci></list></apply></apply><apply id="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.1.1.1.cmml" xref="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.1.1"><csymbol cd="ambiguous" id="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.1.1.1.1.cmml" xref="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.1.1">subscript</csymbol><apply id="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.1.1.1.2.cmml" xref="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.1.1"><csymbol cd="ambiguous" id="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.1.1.1.2.1.cmml" xref="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.1.1">superscript</csymbol><ci id="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.1.1.1.2.2.cmml" xref="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.1.1.1.2.2">𝐻</ci><ci id="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.1.1.1.2.3.cmml" xref="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.1.1.1.2.3">𝑘</ci></apply><apply id="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.1.1.1.3.cmml" xref="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.1.1.1.3"><ci id="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.1.1.1.3.1.cmml" xref="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.1.1.1.3.1">:</ci><ci id="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.1.1.1.3.2.cmml" xref="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.1.1.1.3.2">𝑠</ci><apply id="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.1.1.1.3.3.cmml" xref="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.1.1.1.3.3"><plus id="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.1.1.1.3.3.1.cmml" xref="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.1.1.1.3.3.1"></plus><ci id="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.1.1.1.3.3.2.cmml" xref="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.1.1.1.3.3.2">𝑠</ci><ci id="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.1.1.1.3.3.3.cmml" xref="A4.SS0.SSS0.Px2.p2.2.m2.3.3.1.1.1.1.3.3.3">𝜔</ci></apply></apply></apply></apply><apply id="A4.SS0.SSS0.Px2.p2.2.m2.3.3.3.cmml" xref="A4.SS0.SSS0.Px2.p2.2.m2.3.3.3"><csymbol cd="ambiguous" id="A4.SS0.SSS0.Px2.p2.2.m2.3.3.3.1.cmml" xref="A4.SS0.SSS0.Px2.p2.2.m2.3.3.3">subscript</csymbol><ci id="A4.SS0.SSS0.Px2.p2.2.m2.3.3.3.2.cmml" xref="A4.SS0.SSS0.Px2.p2.2.m2.3.3.3.2">𝜂</ci><ci id="A4.SS0.SSS0.Px2.p2.2.m2.3.3.3.3a.cmml" xref="A4.SS0.SSS0.Px2.p2.2.m2.3.3.3.3"><mtext id="A4.SS0.SSS0.Px2.p2.2.m2.3.3.3.3.cmml" mathsize="70%" xref="A4.SS0.SSS0.Px2.p2.2.m2.3.3.3.3">audio_silence</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS0.SSS0.Px2.p2.2.m2.3c">\text{median}_{k&gt;1,s}(H^{k}_{s:s+\omega})&gt;\eta_{\text{audio\_silence}}</annotation><annotation encoding="application/x-llamapun" id="A4.SS0.SSS0.Px2.p2.2.m2.3d">median start_POSTSUBSCRIPT italic_k &gt; 1 , italic_s end_POSTSUBSCRIPT ( italic_H start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s : italic_s + italic_ω end_POSTSUBSCRIPT ) &gt; italic_η start_POSTSUBSCRIPT audio_silence end_POSTSUBSCRIPT</annotation></semantics></math>). This is shown in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#A4.F10" title="Figure 10 ‣ Bad audio quality. ‣ Appendix D Characterizing Audio Artifacts Caused by Quantization ‣ Moshi: a speech-text foundation model for real-time dialogue">Figure <span class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></span> (d)</a> where a silence slowly degrades into background noise over time.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_paragraph" id="A4.SS0.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">Bad audio quality.</h5><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A4.SS0.SSS0.Px3.p1">
<p class="ltx_p" id="A4.SS0.SSS0.Px3.p1.1">The last category of artifacts encompasses degraded audio quality while the main speaker (Moshi) is speaking:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul class="ltx_itemize" id="A4.I1">
<li class="ltx_item" id="A4.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A4.I1.i1.p1">
<p class="ltx_p" id="A4.I1.i1.p1.1"><em class="ltx_emph ltx_font_italic" id="A4.I1.i1.p1.1.1">Gibberish</em> is a very common type of artifacts at low bitwidth quantization (W2) and corresponds to incoherent speech. It is easily characterized by a high entropy of the text token (<math alttext="H^{0}_{s:s+\omega}>\eta_{\text{gibberish}}=3.5" class="ltx_Math" display="inline" id="A4.I1.i1.p1.1.m1.1"><semantics id="A4.I1.i1.p1.1.m1.1a"><mrow id="A4.I1.i1.p1.1.m1.1.1" xref="A4.I1.i1.p1.1.m1.1.1.cmml"><msubsup id="A4.I1.i1.p1.1.m1.1.1.2" xref="A4.I1.i1.p1.1.m1.1.1.2.cmml"><mi id="A4.I1.i1.p1.1.m1.1.1.2.2.2" xref="A4.I1.i1.p1.1.m1.1.1.2.2.2.cmml">H</mi><mrow id="A4.I1.i1.p1.1.m1.1.1.2.3" xref="A4.I1.i1.p1.1.m1.1.1.2.3.cmml"><mi id="A4.I1.i1.p1.1.m1.1.1.2.3.2" xref="A4.I1.i1.p1.1.m1.1.1.2.3.2.cmml">s</mi><mo id="A4.I1.i1.p1.1.m1.1.1.2.3.1" lspace="0.278em" rspace="0.278em" xref="A4.I1.i1.p1.1.m1.1.1.2.3.1.cmml">:</mo><mrow id="A4.I1.i1.p1.1.m1.1.1.2.3.3" xref="A4.I1.i1.p1.1.m1.1.1.2.3.3.cmml"><mi id="A4.I1.i1.p1.1.m1.1.1.2.3.3.2" xref="A4.I1.i1.p1.1.m1.1.1.2.3.3.2.cmml">s</mi><mo id="A4.I1.i1.p1.1.m1.1.1.2.3.3.1" xref="A4.I1.i1.p1.1.m1.1.1.2.3.3.1.cmml">+</mo><mi id="A4.I1.i1.p1.1.m1.1.1.2.3.3.3" xref="A4.I1.i1.p1.1.m1.1.1.2.3.3.3.cmml">ω</mi></mrow></mrow><mn id="A4.I1.i1.p1.1.m1.1.1.2.2.3" xref="A4.I1.i1.p1.1.m1.1.1.2.2.3.cmml">0</mn></msubsup><mo id="A4.I1.i1.p1.1.m1.1.1.3" xref="A4.I1.i1.p1.1.m1.1.1.3.cmml">&gt;</mo><msub id="A4.I1.i1.p1.1.m1.1.1.4" xref="A4.I1.i1.p1.1.m1.1.1.4.cmml"><mi id="A4.I1.i1.p1.1.m1.1.1.4.2" xref="A4.I1.i1.p1.1.m1.1.1.4.2.cmml">η</mi><mtext id="A4.I1.i1.p1.1.m1.1.1.4.3" xref="A4.I1.i1.p1.1.m1.1.1.4.3a.cmml">gibberish</mtext></msub><mo id="A4.I1.i1.p1.1.m1.1.1.5" xref="A4.I1.i1.p1.1.m1.1.1.5.cmml">=</mo><mn id="A4.I1.i1.p1.1.m1.1.1.6" xref="A4.I1.i1.p1.1.m1.1.1.6.cmml">3.5</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.I1.i1.p1.1.m1.1b"><apply id="A4.I1.i1.p1.1.m1.1.1.cmml" xref="A4.I1.i1.p1.1.m1.1.1"><and id="A4.I1.i1.p1.1.m1.1.1a.cmml" xref="A4.I1.i1.p1.1.m1.1.1"></and><apply id="A4.I1.i1.p1.1.m1.1.1b.cmml" xref="A4.I1.i1.p1.1.m1.1.1"><gt id="A4.I1.i1.p1.1.m1.1.1.3.cmml" xref="A4.I1.i1.p1.1.m1.1.1.3"></gt><apply id="A4.I1.i1.p1.1.m1.1.1.2.cmml" xref="A4.I1.i1.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="A4.I1.i1.p1.1.m1.1.1.2.1.cmml" xref="A4.I1.i1.p1.1.m1.1.1.2">subscript</csymbol><apply id="A4.I1.i1.p1.1.m1.1.1.2.2.cmml" xref="A4.I1.i1.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="A4.I1.i1.p1.1.m1.1.1.2.2.1.cmml" xref="A4.I1.i1.p1.1.m1.1.1.2">superscript</csymbol><ci id="A4.I1.i1.p1.1.m1.1.1.2.2.2.cmml" xref="A4.I1.i1.p1.1.m1.1.1.2.2.2">𝐻</ci><cn id="A4.I1.i1.p1.1.m1.1.1.2.2.3.cmml" type="integer" xref="A4.I1.i1.p1.1.m1.1.1.2.2.3">0</cn></apply><apply id="A4.I1.i1.p1.1.m1.1.1.2.3.cmml" xref="A4.I1.i1.p1.1.m1.1.1.2.3"><ci id="A4.I1.i1.p1.1.m1.1.1.2.3.1.cmml" xref="A4.I1.i1.p1.1.m1.1.1.2.3.1">:</ci><ci id="A4.I1.i1.p1.1.m1.1.1.2.3.2.cmml" xref="A4.I1.i1.p1.1.m1.1.1.2.3.2">𝑠</ci><apply id="A4.I1.i1.p1.1.m1.1.1.2.3.3.cmml" xref="A4.I1.i1.p1.1.m1.1.1.2.3.3"><plus id="A4.I1.i1.p1.1.m1.1.1.2.3.3.1.cmml" xref="A4.I1.i1.p1.1.m1.1.1.2.3.3.1"></plus><ci id="A4.I1.i1.p1.1.m1.1.1.2.3.3.2.cmml" xref="A4.I1.i1.p1.1.m1.1.1.2.3.3.2">𝑠</ci><ci id="A4.I1.i1.p1.1.m1.1.1.2.3.3.3.cmml" xref="A4.I1.i1.p1.1.m1.1.1.2.3.3.3">𝜔</ci></apply></apply></apply><apply id="A4.I1.i1.p1.1.m1.1.1.4.cmml" xref="A4.I1.i1.p1.1.m1.1.1.4"><csymbol cd="ambiguous" id="A4.I1.i1.p1.1.m1.1.1.4.1.cmml" xref="A4.I1.i1.p1.1.m1.1.1.4">subscript</csymbol><ci id="A4.I1.i1.p1.1.m1.1.1.4.2.cmml" xref="A4.I1.i1.p1.1.m1.1.1.4.2">𝜂</ci><ci id="A4.I1.i1.p1.1.m1.1.1.4.3a.cmml" xref="A4.I1.i1.p1.1.m1.1.1.4.3"><mtext id="A4.I1.i1.p1.1.m1.1.1.4.3.cmml" mathsize="70%" xref="A4.I1.i1.p1.1.m1.1.1.4.3">gibberish</mtext></ci></apply></apply><apply id="A4.I1.i1.p1.1.m1.1.1c.cmml" xref="A4.I1.i1.p1.1.m1.1.1"><eq id="A4.I1.i1.p1.1.m1.1.1.5.cmml" xref="A4.I1.i1.p1.1.m1.1.1.5"></eq><share href="https://arxiv.org/html/2410.00037v2#A4.I1.i1.p1.1.m1.1.1.4.cmml" id="A4.I1.i1.p1.1.m1.1.1d.cmml" xref="A4.I1.i1.p1.1.m1.1.1"></share><cn id="A4.I1.i1.p1.1.m1.1.1.6.cmml" type="float" xref="A4.I1.i1.p1.1.m1.1.1.6">3.5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.I1.i1.p1.1.m1.1c">H^{0}_{s:s+\omega}&gt;\eta_{\text{gibberish}}=3.5</annotation><annotation encoding="application/x-llamapun" id="A4.I1.i1.p1.1.m1.1d">italic_H start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s : italic_s + italic_ω end_POSTSUBSCRIPT &gt; italic_η start_POSTSUBSCRIPT gibberish end_POSTSUBSCRIPT = 3.5</annotation></semantics></math>), as shown in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#S5.F6" title="Figure 6 ‣ Results - Audio Quality. ‣ 5.8 Compressing Moshi and Impact on Speech Quality ‣ 5 Evaluation ‣ Moshi: a speech-text foundation model for real-time dialogue">Figure <span class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></span> (b)</a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A4.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A4.I1.i2.p1">
<p class="ltx_p" id="A4.I1.i2.p1.1"><em class="ltx_emph ltx_font_italic" id="A4.I1.i2.p1.1.1">Noisy Audio</em> is harder to detect, as illustrated in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#A4.F10" title="Figure 10 ‣ Bad audio quality. ‣ Appendix D Characterizing Audio Artifacts Caused by Quantization ‣ Moshi: a speech-text foundation model for real-time dialogue">Figure <span class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></span> (b)</a> for instance.
We characterize it by first assessing that we are not in either a silence or background noise case, and then testing whether the standard deviation of the tokens’ entropy across the audio codebooks is above a certain threshold <math alttext="\eta_{\text{noise}}=0.6" class="ltx_Math" display="inline" id="A4.I1.i2.p1.1.m1.1"><semantics id="A4.I1.i2.p1.1.m1.1a"><mrow id="A4.I1.i2.p1.1.m1.1.1" xref="A4.I1.i2.p1.1.m1.1.1.cmml"><msub id="A4.I1.i2.p1.1.m1.1.1.2" xref="A4.I1.i2.p1.1.m1.1.1.2.cmml"><mi id="A4.I1.i2.p1.1.m1.1.1.2.2" xref="A4.I1.i2.p1.1.m1.1.1.2.2.cmml">η</mi><mtext id="A4.I1.i2.p1.1.m1.1.1.2.3" xref="A4.I1.i2.p1.1.m1.1.1.2.3a.cmml">noise</mtext></msub><mo id="A4.I1.i2.p1.1.m1.1.1.1" xref="A4.I1.i2.p1.1.m1.1.1.1.cmml">=</mo><mn id="A4.I1.i2.p1.1.m1.1.1.3" xref="A4.I1.i2.p1.1.m1.1.1.3.cmml">0.6</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.I1.i2.p1.1.m1.1b"><apply id="A4.I1.i2.p1.1.m1.1.1.cmml" xref="A4.I1.i2.p1.1.m1.1.1"><eq id="A4.I1.i2.p1.1.m1.1.1.1.cmml" xref="A4.I1.i2.p1.1.m1.1.1.1"></eq><apply id="A4.I1.i2.p1.1.m1.1.1.2.cmml" xref="A4.I1.i2.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="A4.I1.i2.p1.1.m1.1.1.2.1.cmml" xref="A4.I1.i2.p1.1.m1.1.1.2">subscript</csymbol><ci id="A4.I1.i2.p1.1.m1.1.1.2.2.cmml" xref="A4.I1.i2.p1.1.m1.1.1.2.2">𝜂</ci><ci id="A4.I1.i2.p1.1.m1.1.1.2.3a.cmml" xref="A4.I1.i2.p1.1.m1.1.1.2.3"><mtext id="A4.I1.i2.p1.1.m1.1.1.2.3.cmml" mathsize="70%" xref="A4.I1.i2.p1.1.m1.1.1.2.3">noise</mtext></ci></apply><cn id="A4.I1.i2.p1.1.m1.1.1.3.cmml" type="float" xref="A4.I1.i2.p1.1.m1.1.1.3">0.6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.I1.i2.p1.1.m1.1c">\eta_{\text{noise}}=0.6</annotation><annotation encoding="application/x-llamapun" id="A4.I1.i2.p1.1.m1.1d">italic_η start_POSTSUBSCRIPT noise end_POSTSUBSCRIPT = 0.6</annotation></semantics></math>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ul>
</div>
<figure class="ltx_figure" id="A4.F10">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" id="A4.F10.1" style="width:195.1pt;">
<p class="ltx_p" id="A4.F10.1.1"><span class="ltx_text ltx_font_bold" id="A4.F10.1.1.1" style="font-size:70%;">(a)<span class="ltx_text ltx_font_medium" id="A4.F10.1.1.1.1"> Example entropy spectrum of a good audio samples (no artifacts detected). Short pauses occur for the main speaker due to the multi-stream design.
<br class="ltx_break"></span></span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="584" id="A4.F10.1.g1" src="https://arxiv.org/html/2410.00037v2/x14.png" width="830">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" id="A4.F10.2" style="width:195.1pt;">
<p class="ltx_p" id="A4.F10.2.1"><span class="ltx_text ltx_font_bold" id="A4.F10.2.1.1" style="font-size:70%;">(b)<span class="ltx_text ltx_font_medium" id="A4.F10.2.1.1.1"> Generally, the presence of artifacts tend to increase over time, here with repetition starting to occur in the speech.</span></span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="584" id="A4.F10.2.g1" src="https://arxiv.org/html/2410.00037v2/x15.png" width="830">
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" id="A4.F10.3" style="width:195.1pt;">
<p class="ltx_p" id="A4.F10.3.1"><span class="ltx_text ltx_font_bold" id="A4.F10.3.1.1" style="font-size:70%;">(c)<span class="ltx_text ltx_font_medium" id="A4.F10.3.1.1.1"> Another common artifact is repetitive snippets of text (with good audio quality), which are characterized by a flat entropy of the text token.
<br class="ltx_break"></span></span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="584" id="A4.F10.3.g1" src="https://arxiv.org/html/2410.00037v2/x16.png" width="830">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" id="A4.F10.4" style="width:195.1pt;">
<p class="ltx_p" id="A4.F10.4.1"><span class="ltx_text ltx_font_bold" id="A4.F10.4.1.1" style="font-size:70%;">(d)<span class="ltx_text ltx_font_medium" id="A4.F10.4.1.1.1">Silences can degrade to background noise.</span></span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="584" id="A4.F10.4.g1" src="https://arxiv.org/html/2410.00037v2/x17.png" width="830">
</div>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span><span class="ltx_text ltx_font_bold" id="A4.F10.6.1">Example of typical entropy spectrums capturing specific audio artifacts caused by model quantization</span>. For each timestep, we compute the entropy over the past 128 tokens, independently for the text and audio codebooks tokens. Then, we measure the presence or absence of the different artifacts over non-overlapping windows of 64 tokens.
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A4.SS0.SSS0.Px3.p2">
<p class="ltx_p" id="A4.SS0.SSS0.Px3.p2.5">While measuring the presence of these artifacts relies on several hyper-parameters, the thresholds <math alttext="\eta_{\text{flat}},\eta_{\text{audio\_silence}},\eta_{\text{gibberish}}" class="ltx_Math" display="inline" id="A4.SS0.SSS0.Px3.p2.1.m1.3"><semantics id="A4.SS0.SSS0.Px3.p2.1.m1.3a"><mrow id="A4.SS0.SSS0.Px3.p2.1.m1.3.3.3" xref="A4.SS0.SSS0.Px3.p2.1.m1.3.3.4.cmml"><msub id="A4.SS0.SSS0.Px3.p2.1.m1.1.1.1.1" xref="A4.SS0.SSS0.Px3.p2.1.m1.1.1.1.1.cmml"><mi id="A4.SS0.SSS0.Px3.p2.1.m1.1.1.1.1.2" xref="A4.SS0.SSS0.Px3.p2.1.m1.1.1.1.1.2.cmml">η</mi><mtext id="A4.SS0.SSS0.Px3.p2.1.m1.1.1.1.1.3" xref="A4.SS0.SSS0.Px3.p2.1.m1.1.1.1.1.3a.cmml">flat</mtext></msub><mo id="A4.SS0.SSS0.Px3.p2.1.m1.3.3.3.4" xref="A4.SS0.SSS0.Px3.p2.1.m1.3.3.4.cmml">,</mo><msub id="A4.SS0.SSS0.Px3.p2.1.m1.2.2.2.2" xref="A4.SS0.SSS0.Px3.p2.1.m1.2.2.2.2.cmml"><mi id="A4.SS0.SSS0.Px3.p2.1.m1.2.2.2.2.2" xref="A4.SS0.SSS0.Px3.p2.1.m1.2.2.2.2.2.cmml">η</mi><mtext id="A4.SS0.SSS0.Px3.p2.1.m1.2.2.2.2.3" xref="A4.SS0.SSS0.Px3.p2.1.m1.2.2.2.2.3a.cmml">audio_silence</mtext></msub><mo id="A4.SS0.SSS0.Px3.p2.1.m1.3.3.3.5" xref="A4.SS0.SSS0.Px3.p2.1.m1.3.3.4.cmml">,</mo><msub id="A4.SS0.SSS0.Px3.p2.1.m1.3.3.3.3" xref="A4.SS0.SSS0.Px3.p2.1.m1.3.3.3.3.cmml"><mi id="A4.SS0.SSS0.Px3.p2.1.m1.3.3.3.3.2" xref="A4.SS0.SSS0.Px3.p2.1.m1.3.3.3.3.2.cmml">η</mi><mtext id="A4.SS0.SSS0.Px3.p2.1.m1.3.3.3.3.3" xref="A4.SS0.SSS0.Px3.p2.1.m1.3.3.3.3.3a.cmml">gibberish</mtext></msub></mrow><annotation-xml encoding="MathML-Content" id="A4.SS0.SSS0.Px3.p2.1.m1.3b"><list id="A4.SS0.SSS0.Px3.p2.1.m1.3.3.4.cmml" xref="A4.SS0.SSS0.Px3.p2.1.m1.3.3.3"><apply id="A4.SS0.SSS0.Px3.p2.1.m1.1.1.1.1.cmml" xref="A4.SS0.SSS0.Px3.p2.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="A4.SS0.SSS0.Px3.p2.1.m1.1.1.1.1.1.cmml" xref="A4.SS0.SSS0.Px3.p2.1.m1.1.1.1.1">subscript</csymbol><ci id="A4.SS0.SSS0.Px3.p2.1.m1.1.1.1.1.2.cmml" xref="A4.SS0.SSS0.Px3.p2.1.m1.1.1.1.1.2">𝜂</ci><ci id="A4.SS0.SSS0.Px3.p2.1.m1.1.1.1.1.3a.cmml" xref="A4.SS0.SSS0.Px3.p2.1.m1.1.1.1.1.3"><mtext id="A4.SS0.SSS0.Px3.p2.1.m1.1.1.1.1.3.cmml" mathsize="70%" xref="A4.SS0.SSS0.Px3.p2.1.m1.1.1.1.1.3">flat</mtext></ci></apply><apply id="A4.SS0.SSS0.Px3.p2.1.m1.2.2.2.2.cmml" xref="A4.SS0.SSS0.Px3.p2.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="A4.SS0.SSS0.Px3.p2.1.m1.2.2.2.2.1.cmml" xref="A4.SS0.SSS0.Px3.p2.1.m1.2.2.2.2">subscript</csymbol><ci id="A4.SS0.SSS0.Px3.p2.1.m1.2.2.2.2.2.cmml" xref="A4.SS0.SSS0.Px3.p2.1.m1.2.2.2.2.2">𝜂</ci><ci id="A4.SS0.SSS0.Px3.p2.1.m1.2.2.2.2.3a.cmml" xref="A4.SS0.SSS0.Px3.p2.1.m1.2.2.2.2.3"><mtext id="A4.SS0.SSS0.Px3.p2.1.m1.2.2.2.2.3.cmml" mathsize="70%" xref="A4.SS0.SSS0.Px3.p2.1.m1.2.2.2.2.3">audio_silence</mtext></ci></apply><apply id="A4.SS0.SSS0.Px3.p2.1.m1.3.3.3.3.cmml" xref="A4.SS0.SSS0.Px3.p2.1.m1.3.3.3.3"><csymbol cd="ambiguous" id="A4.SS0.SSS0.Px3.p2.1.m1.3.3.3.3.1.cmml" xref="A4.SS0.SSS0.Px3.p2.1.m1.3.3.3.3">subscript</csymbol><ci id="A4.SS0.SSS0.Px3.p2.1.m1.3.3.3.3.2.cmml" xref="A4.SS0.SSS0.Px3.p2.1.m1.3.3.3.3.2">𝜂</ci><ci id="A4.SS0.SSS0.Px3.p2.1.m1.3.3.3.3.3a.cmml" xref="A4.SS0.SSS0.Px3.p2.1.m1.3.3.3.3.3"><mtext id="A4.SS0.SSS0.Px3.p2.1.m1.3.3.3.3.3.cmml" mathsize="70%" xref="A4.SS0.SSS0.Px3.p2.1.m1.3.3.3.3.3">gibberish</mtext></ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="A4.SS0.SSS0.Px3.p2.1.m1.3c">\eta_{\text{flat}},\eta_{\text{audio\_silence}},\eta_{\text{gibberish}}</annotation><annotation encoding="application/x-llamapun" id="A4.SS0.SSS0.Px3.p2.1.m1.3d">italic_η start_POSTSUBSCRIPT flat end_POSTSUBSCRIPT , italic_η start_POSTSUBSCRIPT audio_silence end_POSTSUBSCRIPT , italic_η start_POSTSUBSCRIPT gibberish end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\eta_{\text{noise}}" class="ltx_Math" display="inline" id="A4.SS0.SSS0.Px3.p2.2.m2.1"><semantics id="A4.SS0.SSS0.Px3.p2.2.m2.1a"><msub id="A4.SS0.SSS0.Px3.p2.2.m2.1.1" xref="A4.SS0.SSS0.Px3.p2.2.m2.1.1.cmml"><mi id="A4.SS0.SSS0.Px3.p2.2.m2.1.1.2" xref="A4.SS0.SSS0.Px3.p2.2.m2.1.1.2.cmml">η</mi><mtext id="A4.SS0.SSS0.Px3.p2.2.m2.1.1.3" xref="A4.SS0.SSS0.Px3.p2.2.m2.1.1.3a.cmml">noise</mtext></msub><annotation-xml encoding="MathML-Content" id="A4.SS0.SSS0.Px3.p2.2.m2.1b"><apply id="A4.SS0.SSS0.Px3.p2.2.m2.1.1.cmml" xref="A4.SS0.SSS0.Px3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="A4.SS0.SSS0.Px3.p2.2.m2.1.1.1.cmml" xref="A4.SS0.SSS0.Px3.p2.2.m2.1.1">subscript</csymbol><ci id="A4.SS0.SSS0.Px3.p2.2.m2.1.1.2.cmml" xref="A4.SS0.SSS0.Px3.p2.2.m2.1.1.2">𝜂</ci><ci id="A4.SS0.SSS0.Px3.p2.2.m2.1.1.3a.cmml" xref="A4.SS0.SSS0.Px3.p2.2.m2.1.1.3"><mtext id="A4.SS0.SSS0.Px3.p2.2.m2.1.1.3.cmml" mathsize="70%" xref="A4.SS0.SSS0.Px3.p2.2.m2.1.1.3">noise</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS0.SSS0.Px3.p2.2.m2.1c">\eta_{\text{noise}}</annotation><annotation encoding="application/x-llamapun" id="A4.SS0.SSS0.Px3.p2.2.m2.1d">italic_η start_POSTSUBSCRIPT noise end_POSTSUBSCRIPT</annotation></semantics></math> characterize the entropy of the sampled output tokens directly, thus are primarily related to the text/audio vocabulary, rather than the weights of the Temporal and Depth Transformers. We found these hyper-parameters to work well in capturing artifacts across different models in practice (using the same Mimi codec for all).
Note that the values chosen for these hyper-parameters are also tightly linked with the chosen context size <math alttext="C" class="ltx_Math" display="inline" id="A4.SS0.SSS0.Px3.p2.3.m3.1"><semantics id="A4.SS0.SSS0.Px3.p2.3.m3.1a"><mi id="A4.SS0.SSS0.Px3.p2.3.m3.1.1" xref="A4.SS0.SSS0.Px3.p2.3.m3.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="A4.SS0.SSS0.Px3.p2.3.m3.1b"><ci id="A4.SS0.SSS0.Px3.p2.3.m3.1.1.cmml" xref="A4.SS0.SSS0.Px3.p2.3.m3.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS0.SSS0.Px3.p2.3.m3.1c">C</annotation><annotation encoding="application/x-llamapun" id="A4.SS0.SSS0.Px3.p2.3.m3.1d">italic_C</annotation></semantics></math> and window <math alttext="\omega" class="ltx_Math" display="inline" id="A4.SS0.SSS0.Px3.p2.4.m4.1"><semantics id="A4.SS0.SSS0.Px3.p2.4.m4.1a"><mi id="A4.SS0.SSS0.Px3.p2.4.m4.1.1" xref="A4.SS0.SSS0.Px3.p2.4.m4.1.1.cmml">ω</mi><annotation-xml encoding="MathML-Content" id="A4.SS0.SSS0.Px3.p2.4.m4.1b"><ci id="A4.SS0.SSS0.Px3.p2.4.m4.1.1.cmml" xref="A4.SS0.SSS0.Px3.p2.4.m4.1.1">𝜔</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS0.SSS0.Px3.p2.4.m4.1c">\omega</annotation><annotation encoding="application/x-llamapun" id="A4.SS0.SSS0.Px3.p2.4.m4.1d">italic_ω</annotation></semantics></math>, thus they are not particularly robust to changes on the temporal axis. In addition, choosing a too small value for <math alttext="\omega" class="ltx_Math" display="inline" id="A4.SS0.SSS0.Px3.p2.5.m5.1"><semantics id="A4.SS0.SSS0.Px3.p2.5.m5.1a"><mi id="A4.SS0.SSS0.Px3.p2.5.m5.1.1" xref="A4.SS0.SSS0.Px3.p2.5.m5.1.1.cmml">ω</mi><annotation-xml encoding="MathML-Content" id="A4.SS0.SSS0.Px3.p2.5.m5.1b"><ci id="A4.SS0.SSS0.Px3.p2.5.m5.1.1.cmml" xref="A4.SS0.SSS0.Px3.p2.5.m5.1.1">𝜔</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS0.SSS0.Px3.p2.5.m5.1c">\omega</annotation><annotation encoding="application/x-llamapun" id="A4.SS0.SSS0.Px3.p2.5.m5.1d">italic_ω</annotation></semantics></math> may lead to false negative cases, e.g. by missing very short artifacts.
Nevertheless, as shown in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#A4.F10" title="Figure 10 ‣ Bad audio quality. ‣ Appendix D Characterizing Audio Artifacts Caused by Quantization ‣ Moshi: a speech-text foundation model for real-time dialogue">Figure <span class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></span></a>, this simple analysis of the entropy spectrum offers additional fine-grained insights on the types of audio artifacts caused by model quantization, complementing the MOSNet scores obtained for the same samples.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="A4.SS0.SSS0.Px3.p3">
<p class="ltx_p" id="A4.SS0.SSS0.Px3.p3.1">Finally, in <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#A4.F11" title="Figure 11 ‣ Bad audio quality. ‣ Appendix D Characterizing Audio Artifacts Caused by Quantization ‣ Moshi: a speech-text foundation model for real-time dialogue">Figure <span class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></span></a> we report the distribution of artifacts over time, averaged across 500 samples for each model: At a bitwidth of 4, there is still little difference in behavior between the unquantized model and the quantized ones. For a bitwidth of 3, artifacts occur more often for quantized models, in particular when using large quantization blocks (256); In addition, artifacts tend to occur more often over time. Finally, for an extreme compression to 2 bits, the quality of the samples is very negatively affected by model quantization, even when using a high granularity for the quantization blocks (32).</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="A4.F11">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="321" id="A4.F11.g1" src="https://arxiv.org/html/2410.00037v2/x18.png" width="789"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="311" id="A4.F11.g2" src="https://arxiv.org/html/2410.00037v2/x19.png" width="789"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="311" id="A4.F11.g3" src="https://arxiv.org/html/2410.00037v2/x20.png" width="789"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 11: </span>
<span class="ltx_text ltx_font_bold" id="A4.F11.3.1">Temporal distribution of audio artifacts caused by model compression</span>.
We measure in 500 audio samples the presence or absence of different audio degradations caused by model weight quantization on 2, 3 or 8 bits with block granularity of 32 or 256, across non-overlapping windows of 64 tokens (<span class="ltx_text ltx_font_italic" id="A4.F11.4.2">timestep, x-axis</span>).
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_pagination ltx_role_newpage"></div>
<figure class="ltx_table" id="A5.T18">
<div class="ltx_flex_figure ltx_flex_table">
<div class="ltx_flex_cell ltx_flex_size_1">
<section class="ltx_appendix ltx_figure_panel" id="A5">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix E </span>Safety and Toxicity</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 18: </span><span class="ltx_text ltx_font_bold" id="A5.T18.15.1">Adding Moshi to the ALERT benchmark</span>&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Tedeschi et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.00037v2#bib.bib93" title="">2024</a>)</cite>, original table under CC BY. Each column depicts an LLM under evaluation. Values in the last row depict overall safety scores, all others are category-wise safety scores (higher is safer). <span class="ltx_text ltx_font_italic" id="A5.T18.16.2">Safe</span> scores <math alttext="S(\Phi)\geq 99" class="ltx_Math" display="inline" id="A5.T18.4.m1.1"><semantics id="A5.T18.4.m1.1b"><mrow id="A5.T18.4.m1.1.2" xref="A5.T18.4.m1.1.2.cmml"><mrow id="A5.T18.4.m1.1.2.2" xref="A5.T18.4.m1.1.2.2.cmml"><mi id="A5.T18.4.m1.1.2.2.2" xref="A5.T18.4.m1.1.2.2.2.cmml">S</mi><mo id="A5.T18.4.m1.1.2.2.1" xref="A5.T18.4.m1.1.2.2.1.cmml">⁢</mo><mrow id="A5.T18.4.m1.1.2.2.3.2" xref="A5.T18.4.m1.1.2.2.cmml"><mo id="A5.T18.4.m1.1.2.2.3.2.1" stretchy="false" xref="A5.T18.4.m1.1.2.2.cmml">(</mo><mi id="A5.T18.4.m1.1.1" mathvariant="normal" xref="A5.T18.4.m1.1.1.cmml">Φ</mi><mo id="A5.T18.4.m1.1.2.2.3.2.2" stretchy="false" xref="A5.T18.4.m1.1.2.2.cmml">)</mo></mrow></mrow><mo id="A5.T18.4.m1.1.2.1" xref="A5.T18.4.m1.1.2.1.cmml">≥</mo><mn id="A5.T18.4.m1.1.2.3" xref="A5.T18.4.m1.1.2.3.cmml">99</mn></mrow><annotation-xml encoding="MathML-Content" id="A5.T18.4.m1.1c"><apply id="A5.T18.4.m1.1.2.cmml" xref="A5.T18.4.m1.1.2"><geq id="A5.T18.4.m1.1.2.1.cmml" xref="A5.T18.4.m1.1.2.1"></geq><apply id="A5.T18.4.m1.1.2.2.cmml" xref="A5.T18.4.m1.1.2.2"><times id="A5.T18.4.m1.1.2.2.1.cmml" xref="A5.T18.4.m1.1.2.2.1"></times><ci id="A5.T18.4.m1.1.2.2.2.cmml" xref="A5.T18.4.m1.1.2.2.2">𝑆</ci><ci id="A5.T18.4.m1.1.1.cmml" xref="A5.T18.4.m1.1.1">Φ</ci></apply><cn id="A5.T18.4.m1.1.2.3.cmml" type="integer" xref="A5.T18.4.m1.1.2.3">99</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.T18.4.m1.1d">S(\Phi)\geq 99</annotation><annotation encoding="application/x-llamapun" id="A5.T18.4.m1.1e">italic_S ( roman_Φ ) ≥ 99</annotation></semantics></math> are gray <span class="ltx_text ltx_phantom" id="A5.T18.17.3" style="background-color:#F3F0E6;"><span style="visibility:hidden">x</span></span>, <span class="ltx_text ltx_font_italic" id="A5.T18.18.4">unsafe</span> scores within <math alttext="90\leq S(\Phi)\!<\!99" class="ltx_Math" display="inline" id="A5.T18.5.m2.1"><semantics id="A5.T18.5.m2.1b"><mrow id="A5.T18.5.m2.1.2" xref="A5.T18.5.m2.1.2.cmml"><mn id="A5.T18.5.m2.1.2.2" xref="A5.T18.5.m2.1.2.2.cmml">90</mn><mo id="A5.T18.5.m2.1.2.3" xref="A5.T18.5.m2.1.2.3.cmml">≤</mo><mrow id="A5.T18.5.m2.1.2.4" xref="A5.T18.5.m2.1.2.4.cmml"><mi id="A5.T18.5.m2.1.2.4.2" xref="A5.T18.5.m2.1.2.4.2.cmml">S</mi><mo id="A5.T18.5.m2.1.2.4.1" xref="A5.T18.5.m2.1.2.4.1.cmml">⁢</mo><mrow id="A5.T18.5.m2.1.2.4.3.2" xref="A5.T18.5.m2.1.2.4.cmml"><mo id="A5.T18.5.m2.1.2.4.3.2.1" stretchy="false" xref="A5.T18.5.m2.1.2.4.cmml">(</mo><mi id="A5.T18.5.m2.1.1" mathvariant="normal" xref="A5.T18.5.m2.1.1.cmml">Φ</mi><mo id="A5.T18.5.m2.1.2.4.3.2.2" stretchy="false" xref="A5.T18.5.m2.1.2.4.cmml">)</mo></mrow></mrow><mo id="A5.T18.5.m2.1.2.5" lspace="0.108em" rspace="0.108em" xref="A5.T18.5.m2.1.2.5.cmml">&lt;</mo><mn id="A5.T18.5.m2.1.2.6" xref="A5.T18.5.m2.1.2.6.cmml">99</mn></mrow><annotation-xml encoding="MathML-Content" id="A5.T18.5.m2.1c"><apply id="A5.T18.5.m2.1.2.cmml" xref="A5.T18.5.m2.1.2"><and id="A5.T18.5.m2.1.2a.cmml" xref="A5.T18.5.m2.1.2"></and><apply id="A5.T18.5.m2.1.2b.cmml" xref="A5.T18.5.m2.1.2"><leq id="A5.T18.5.m2.1.2.3.cmml" xref="A5.T18.5.m2.1.2.3"></leq><cn id="A5.T18.5.m2.1.2.2.cmml" type="integer" xref="A5.T18.5.m2.1.2.2">90</cn><apply id="A5.T18.5.m2.1.2.4.cmml" xref="A5.T18.5.m2.1.2.4"><times id="A5.T18.5.m2.1.2.4.1.cmml" xref="A5.T18.5.m2.1.2.4.1"></times><ci id="A5.T18.5.m2.1.2.4.2.cmml" xref="A5.T18.5.m2.1.2.4.2">𝑆</ci><ci id="A5.T18.5.m2.1.1.cmml" xref="A5.T18.5.m2.1.1">Φ</ci></apply></apply><apply id="A5.T18.5.m2.1.2c.cmml" xref="A5.T18.5.m2.1.2"><lt id="A5.T18.5.m2.1.2.5.cmml" xref="A5.T18.5.m2.1.2.5"></lt><share href="https://arxiv.org/html/2410.00037v2#A5.T18.5.m2.1.2.4.cmml" id="A5.T18.5.m2.1.2d.cmml" xref="A5.T18.5.m2.1.2"></share><cn id="A5.T18.5.m2.1.2.6.cmml" type="integer" xref="A5.T18.5.m2.1.2.6">99</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.T18.5.m2.1d">90\leq S(\Phi)\!&lt;\!99</annotation><annotation encoding="application/x-llamapun" id="A5.T18.5.m2.1e">90 ≤ italic_S ( roman_Φ ) &lt; 99</annotation></semantics></math> are Orange <span class="ltx_text ltx_phantom" id="A5.T18.19.5" style="background-color:#FFDFBF;"><span style="visibility:hidden">x</span></span>, and <span class="ltx_text ltx_font_italic" id="A5.T18.20.6">highly unsafe</span> scores <math alttext="S(\Phi)\!<\!90" class="ltx_Math" display="inline" id="A5.T18.6.m3.1"><semantics id="A5.T18.6.m3.1b"><mrow id="A5.T18.6.m3.1.2" xref="A5.T18.6.m3.1.2.cmml"><mrow id="A5.T18.6.m3.1.2.2" xref="A5.T18.6.m3.1.2.2.cmml"><mi id="A5.T18.6.m3.1.2.2.2" xref="A5.T18.6.m3.1.2.2.2.cmml">S</mi><mo id="A5.T18.6.m3.1.2.2.1" xref="A5.T18.6.m3.1.2.2.1.cmml">⁢</mo><mrow id="A5.T18.6.m3.1.2.2.3.2" xref="A5.T18.6.m3.1.2.2.cmml"><mo id="A5.T18.6.m3.1.2.2.3.2.1" stretchy="false" xref="A5.T18.6.m3.1.2.2.cmml">(</mo><mi id="A5.T18.6.m3.1.1" mathvariant="normal" xref="A5.T18.6.m3.1.1.cmml">Φ</mi><mo id="A5.T18.6.m3.1.2.2.3.2.2" stretchy="false" xref="A5.T18.6.m3.1.2.2.cmml">)</mo></mrow></mrow><mo id="A5.T18.6.m3.1.2.1" lspace="0.108em" rspace="0.108em" xref="A5.T18.6.m3.1.2.1.cmml">&lt;</mo><mn id="A5.T18.6.m3.1.2.3" xref="A5.T18.6.m3.1.2.3.cmml">90</mn></mrow><annotation-xml encoding="MathML-Content" id="A5.T18.6.m3.1c"><apply id="A5.T18.6.m3.1.2.cmml" xref="A5.T18.6.m3.1.2"><lt id="A5.T18.6.m3.1.2.1.cmml" xref="A5.T18.6.m3.1.2.1"></lt><apply id="A5.T18.6.m3.1.2.2.cmml" xref="A5.T18.6.m3.1.2.2"><times id="A5.T18.6.m3.1.2.2.1.cmml" xref="A5.T18.6.m3.1.2.2.1"></times><ci id="A5.T18.6.m3.1.2.2.2.cmml" xref="A5.T18.6.m3.1.2.2.2">𝑆</ci><ci id="A5.T18.6.m3.1.1.cmml" xref="A5.T18.6.m3.1.1">Φ</ci></apply><cn id="A5.T18.6.m3.1.2.3.cmml" type="integer" xref="A5.T18.6.m3.1.2.3">90</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.T18.6.m3.1d">S(\Phi)\!&lt;\!90</annotation><annotation encoding="application/x-llamapun" id="A5.T18.6.m3.1e">italic_S ( roman_Φ ) &lt; 90</annotation></semantics></math> are Red <span class="ltx_text ltx_phantom" id="A5.T18.21.7" style="background-color:#FFCCCD;"><span style="visibility:hidden">x</span></span>.
<em class="ltx_emph ltx_font_italic" id="A5.T18.22.8">Best viewed in color</em>.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_inline-block ltx_figure_panel ltx_transformed_outer" id="A5.T18.23" style="width:433.6pt;height:461pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-71.0pt,75.5pt) scale(0.753283533992234,0.753283533992234) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A5.T18.23.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A5.T18.23.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="A5.T18.23.1.1.1.1">Category</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="A5.T18.23.1.1.1.2">Moshi</th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A5.T18.23.1.1.1.3">GPT-3.5</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A5.T18.23.1.1.1.4">GPT-4</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A5.T18.23.1.1.1.5">Llama 2</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A5.T18.23.1.1.1.6">Alpaca</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A5.T18.23.1.1.1.7">Vicuna</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A5.T18.23.1.1.1.8">Falcon</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A5.T18.23.1.1.1.9">Mistral</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A5.T18.23.1.1.1.10">Mixtral</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A5.T18.23.1.1.1.11">Zephyr</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A5.T18.23.1.1.1.12">OLMo</td>
</tr>
<tr class="ltx_tr" id="A5.T18.23.1.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A5.T18.23.1.2.2.1"><span class="ltx_text ltx_font_typewriter" id="A5.T18.23.1.2.2.1.1">hate_body</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A5.T18.23.1.2.2.2"><span class="ltx_text" id="A5.T18.23.1.2.2.2.1" style="background-color:#FFDFBF;">90.96</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.2.2.3"><span class="ltx_text" id="A5.T18.23.1.2.2.3.1" style="background-color:#FFDFBF;">96.38</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.2.2.4"><span class="ltx_text" id="A5.T18.23.1.2.2.4.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.2.2.5"><span class="ltx_text" id="A5.T18.23.1.2.2.5.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.2.2.6"><span class="ltx_text" id="A5.T18.23.1.2.2.6.1" style="background-color:#FFCCCD;">71.68</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.2.2.7"><span class="ltx_text" id="A5.T18.23.1.2.2.7.1" style="background-color:#FFDFBF;">98.79</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.2.2.8"><span class="ltx_text" id="A5.T18.23.1.2.2.8.1" style="background-color:#FFDFBF;">91.56</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.2.2.9"><span class="ltx_text" id="A5.T18.23.1.2.2.9.1" style="background-color:#FFCCCD;">88.55</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.2.2.10"><span class="ltx_text" id="A5.T18.23.1.2.2.10.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.2.2.11"><span class="ltx_text" id="A5.T18.23.1.2.2.11.1" style="background-color:#FFCCCD;">84.93</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.2.2.12"><span class="ltx_text" id="A5.T18.23.1.2.2.12.1" style="background-color:#FFDFBF;">90.36</span></td>
</tr>
<tr class="ltx_tr" id="A5.T18.23.1.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A5.T18.23.1.3.3.1"><span class="ltx_text ltx_font_typewriter" id="A5.T18.23.1.3.3.1.1">hate_disabled</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A5.T18.23.1.3.3.2"><span class="ltx_text" id="A5.T18.23.1.3.3.2.1" style="background-color:#FFCCCD;">85.83</span></th>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.3.3.3"><span class="ltx_text" id="A5.T18.23.1.3.3.3.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.3.3.4"><span class="ltx_text" id="A5.T18.23.1.3.3.4.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.3.3.5"><span class="ltx_text" id="A5.T18.23.1.3.3.5.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.3.3.6"><span class="ltx_text" id="A5.T18.23.1.3.3.6.1" style="background-color:#FFCCCD;">60.83</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.3.3.7"><span class="ltx_text" id="A5.T18.23.1.3.3.7.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.3.3.8"><span class="ltx_text" id="A5.T18.23.1.3.3.8.1" style="background-color:#FFDFBF;">94.16</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.3.3.9"><span class="ltx_text" id="A5.T18.23.1.3.3.9.1" style="background-color:#FFDFBF;">91.66</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.3.3.10"><span class="ltx_text" id="A5.T18.23.1.3.3.10.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.3.3.11"><span class="ltx_text" id="A5.T18.23.1.3.3.11.1" style="background-color:#FFCCCD;">71.66</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.3.3.12"><span class="ltx_text" id="A5.T18.23.1.3.3.12.1" style="background-color:#FFDFBF;">93.33</span></td>
</tr>
<tr class="ltx_tr" id="A5.T18.23.1.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A5.T18.23.1.4.4.1"><span class="ltx_text ltx_font_typewriter" id="A5.T18.23.1.4.4.1.1">hate_ethnic</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A5.T18.23.1.4.4.2"><span class="ltx_text" id="A5.T18.23.1.4.4.2.1" style="background-color:#FFCCCD;">84.56</span></th>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.4.4.3"><span class="ltx_text" id="A5.T18.23.1.4.4.3.1" style="background-color:#FFDFBF;">98.03</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.4.4.4"><span class="ltx_text" id="A5.T18.23.1.4.4.4.1" style="background-color:#F3F0E6;">99.42</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.4.4.5"><span class="ltx_text" id="A5.T18.23.1.4.4.5.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.4.4.6"><span class="ltx_text" id="A5.T18.23.1.4.4.6.1" style="background-color:#FFCCCD;">67.23</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.4.4.7"><span class="ltx_text" id="A5.T18.23.1.4.4.7.1" style="background-color:#FFDFBF;">97.95</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.4.4.8"><span class="ltx_text" id="A5.T18.23.1.4.4.8.1" style="background-color:#FFCCCD;">88.94</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.4.4.9"><span class="ltx_text" id="A5.T18.23.1.4.4.9.1" style="background-color:#FFDFBF;">90.99</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.4.4.10"><span class="ltx_text" id="A5.T18.23.1.4.4.10.1" style="background-color:#F3F0E6;">99.42</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.4.4.11"><span class="ltx_text" id="A5.T18.23.1.4.4.11.1" style="background-color:#FFCCCD;">84.52</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.4.4.12"><span class="ltx_text" id="A5.T18.23.1.4.4.12.1" style="background-color:#FFDFBF;">93.61</span></td>
</tr>
<tr class="ltx_tr" id="A5.T18.23.1.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A5.T18.23.1.5.5.1"><span class="ltx_text ltx_font_typewriter" id="A5.T18.23.1.5.5.1.1">hate_lgbtq+</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A5.T18.23.1.5.5.2"><span class="ltx_text" id="A5.T18.23.1.5.5.2.1" style="background-color:#FFCCCD;">87.14</span></th>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.5.5.3"><span class="ltx_text" id="A5.T18.23.1.5.5.3.1" style="background-color:#FFDFBF;">98.21</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.5.5.4"><span class="ltx_text" id="A5.T18.23.1.5.5.4.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.5.5.5"><span class="ltx_text" id="A5.T18.23.1.5.5.5.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.5.5.6"><span class="ltx_text" id="A5.T18.23.1.5.5.6.1" style="background-color:#FFCCCD;">76.08</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.5.5.7"><span class="ltx_text" id="A5.T18.23.1.5.5.7.1" style="background-color:#FFDFBF;">97.96</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.5.5.8"><span class="ltx_text" id="A5.T18.23.1.5.5.8.1" style="background-color:#FFDFBF;">92.87</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.5.5.9"><span class="ltx_text" id="A5.T18.23.1.5.5.9.1" style="background-color:#FFDFBF;">92.62</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.5.5.10"><span class="ltx_text" id="A5.T18.23.1.5.5.10.1" style="background-color:#FFDFBF;">98.98</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.5.5.11"><span class="ltx_text" id="A5.T18.23.1.5.5.11.1" style="background-color:#FFCCCD;">88.80</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.5.5.12"><span class="ltx_text" id="A5.T18.23.1.5.5.12.1" style="background-color:#FFDFBF;">94.65</span></td>
</tr>
<tr class="ltx_tr" id="A5.T18.23.1.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A5.T18.23.1.6.6.1"><span class="ltx_text ltx_font_typewriter" id="A5.T18.23.1.6.6.1.1">hate_poor</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A5.T18.23.1.6.6.2"><span class="ltx_text" id="A5.T18.23.1.6.6.2.1" style="background-color:#FFDFBF;">90.00</span></th>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.6.6.3"><span class="ltx_text" id="A5.T18.23.1.6.6.3.1" style="background-color:#F3F0E6;">99.00</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.6.6.4"><span class="ltx_text" id="A5.T18.23.1.6.6.4.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.6.6.5"><span class="ltx_text" id="A5.T18.23.1.6.6.5.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.6.6.6"><span class="ltx_text" id="A5.T18.23.1.6.6.6.1" style="background-color:#FFCCCD;">84.15</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.6.6.7"><span class="ltx_text" id="A5.T18.23.1.6.6.7.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.6.6.8"><span class="ltx_text" id="A5.T18.23.1.6.6.8.1" style="background-color:#FFDFBF;">93.06</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.6.6.9"><span class="ltx_text" id="A5.T18.23.1.6.6.9.1" style="background-color:#FFDFBF;">94.05</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.6.6.10"><span class="ltx_text" id="A5.T18.23.1.6.6.10.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.6.6.11"><span class="ltx_text" id="A5.T18.23.1.6.6.11.1" style="background-color:#FFDFBF;">93.06</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.6.6.12"><span class="ltx_text" id="A5.T18.23.1.6.6.12.1" style="background-color:#FFDFBF;">97.02</span></td>
</tr>
<tr class="ltx_tr" id="A5.T18.23.1.7.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A5.T18.23.1.7.7.1"><span class="ltx_text ltx_font_typewriter" id="A5.T18.23.1.7.7.1.1">hate_religion</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A5.T18.23.1.7.7.2"><span class="ltx_text" id="A5.T18.23.1.7.7.2.1" style="background-color:#FFCCCD;">82.73</span></th>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.7.7.3"><span class="ltx_text" id="A5.T18.23.1.7.7.3.1" style="background-color:#F3F0E6;">99.32</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.7.7.4"><span class="ltx_text" id="A5.T18.23.1.7.7.4.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.7.7.5"><span class="ltx_text" id="A5.T18.23.1.7.7.5.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.7.7.6"><span class="ltx_text" id="A5.T18.23.1.7.7.6.1" style="background-color:#FFCCCD;">70.88</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.7.7.7"><span class="ltx_text" id="A5.T18.23.1.7.7.7.1" style="background-color:#F3F0E6;">99.32</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.7.7.8"><span class="ltx_text" id="A5.T18.23.1.7.7.8.1" style="background-color:#FFDFBF;">93.90</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.7.7.9"><span class="ltx_text" id="A5.T18.23.1.7.7.9.1" style="background-color:#FFDFBF;">97.06</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.7.7.10"><span class="ltx_text" id="A5.T18.23.1.7.7.10.1" style="background-color:#F3F0E6;">99.77</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.7.7.11"><span class="ltx_text" id="A5.T18.23.1.7.7.11.1" style="background-color:#FFCCCD;">89.61</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.7.7.12"><span class="ltx_text" id="A5.T18.23.1.7.7.12.1" style="background-color:#FFDFBF;">95.03</span></td>
</tr>
<tr class="ltx_tr" id="A5.T18.23.1.8.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A5.T18.23.1.8.8.1"><span class="ltx_text ltx_font_typewriter" id="A5.T18.23.1.8.8.1.1">hate_women</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A5.T18.23.1.8.8.2"><span class="ltx_text" id="A5.T18.23.1.8.8.2.1" style="background-color:#FFCCCD;">86.36</span></th>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.8.8.3"><span class="ltx_text" id="A5.T18.23.1.8.8.3.1" style="background-color:#FFDFBF;">97.72</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.8.8.4"><span class="ltx_text" id="A5.T18.23.1.8.8.4.1" style="background-color:#F3F0E6;">99.54</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.8.8.5"><span class="ltx_text" id="A5.T18.23.1.8.8.5.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.8.8.6"><span class="ltx_text" id="A5.T18.23.1.8.8.6.1" style="background-color:#FFCCCD;">68.93</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.8.8.7"><span class="ltx_text" id="A5.T18.23.1.8.8.7.1" style="background-color:#FFDFBF;">97.01</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.8.8.8"><span class="ltx_text" id="A5.T18.23.1.8.8.8.1" style="background-color:#FFDFBF;">90.32</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.8.8.9"><span class="ltx_text" id="A5.T18.23.1.8.8.9.1" style="background-color:#FFDFBF;">90.68</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.8.8.10"><span class="ltx_text" id="A5.T18.23.1.8.8.10.1" style="background-color:#FFDFBF;">98.92</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.8.8.11"><span class="ltx_text" id="A5.T18.23.1.8.8.11.1" style="background-color:#FFCCCD;">87.33</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.8.8.12"><span class="ltx_text" id="A5.T18.23.1.8.8.12.1" style="background-color:#FFDFBF;">91.87</span></td>
</tr>
<tr class="ltx_tr" id="A5.T18.23.1.9.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A5.T18.23.1.9.9.1"><span class="ltx_text ltx_font_typewriter" id="A5.T18.23.1.9.9.1.1">hate_other</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A5.T18.23.1.9.9.2"><span class="ltx_text" id="A5.T18.23.1.9.9.2.1" style="background-color:#FFCCCD;">88.40</span></th>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.9.9.3"><span class="ltx_text" id="A5.T18.23.1.9.9.3.1" style="background-color:#FFCCCD;">87.90</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.9.9.4"><span class="ltx_text" id="A5.T18.23.1.9.9.4.1" style="background-color:#F3F0E6;">99.75</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.9.9.5"><span class="ltx_text" id="A5.T18.23.1.9.9.5.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.9.9.6"><span class="ltx_text" id="A5.T18.23.1.9.9.6.1" style="background-color:#FFCCCD;">63.89</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.9.9.7"><span class="ltx_text" id="A5.T18.23.1.9.9.7.1" style="background-color:#FFDFBF;">98.03</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.9.9.8"><span class="ltx_text" id="A5.T18.23.1.9.9.8.1" style="background-color:#FFCCCD;">83.16</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.9.9.9"><span class="ltx_text" id="A5.T18.23.1.9.9.9.1" style="background-color:#FFCCCD;">73.12</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.9.9.10"><span class="ltx_text" id="A5.T18.23.1.9.9.10.1" style="background-color:#FFDFBF;">98.93</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.9.9.11"><span class="ltx_text" id="A5.T18.23.1.9.9.11.1" style="background-color:#FFCCCD;">68.30</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.9.9.12"><span class="ltx_text" id="A5.T18.23.1.9.9.12.1" style="background-color:#FFCCCD;">83.16</span></td>
</tr>
<tr class="ltx_tr" id="A5.T18.23.1.10.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A5.T18.23.1.10.10.1"><span class="ltx_text ltx_font_typewriter" id="A5.T18.23.1.10.10.1.1">self_harm_suicide</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A5.T18.23.1.10.10.2"><span class="ltx_text" id="A5.T18.23.1.10.10.2.1" style="background-color:#FFCCCD;">83.24</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.10.10.3"><span class="ltx_text" id="A5.T18.23.1.10.10.3.1" style="background-color:#F3F0E6;">99.42</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.10.10.4"><span class="ltx_text" id="A5.T18.23.1.10.10.4.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.10.10.5"><span class="ltx_text" id="A5.T18.23.1.10.10.5.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.10.10.6"><span class="ltx_text" id="A5.T18.23.1.10.10.6.1" style="background-color:#FFCCCD;">41.95</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.10.10.7"><span class="ltx_text" id="A5.T18.23.1.10.10.7.1" style="background-color:#FFDFBF;">92.52</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.10.10.8"><span class="ltx_text" id="A5.T18.23.1.10.10.8.1" style="background-color:#FFDFBF;">94.82</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.10.10.9"><span class="ltx_text" id="A5.T18.23.1.10.10.9.1" style="background-color:#FFCCCD;">61.49</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.10.10.10"><span class="ltx_text" id="A5.T18.23.1.10.10.10.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.10.10.11"><span class="ltx_text" id="A5.T18.23.1.10.10.11.1" style="background-color:#FFCCCD;">77.01</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.10.10.12"><span class="ltx_text" id="A5.T18.23.1.10.10.12.1" style="background-color:#FFCCCD;">72.41</span></td>
</tr>
<tr class="ltx_tr" id="A5.T18.23.1.11.11">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A5.T18.23.1.11.11.1"><span class="ltx_text ltx_font_typewriter" id="A5.T18.23.1.11.11.1.1">self_harm_thin</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A5.T18.23.1.11.11.2"><span class="ltx_text" id="A5.T18.23.1.11.11.2.1" style="background-color:#F3F0E6;">99.58</span></th>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.11.11.3"><span class="ltx_text" id="A5.T18.23.1.11.11.3.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.11.11.4"><span class="ltx_text" id="A5.T18.23.1.11.11.4.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.11.11.5"><span class="ltx_text" id="A5.T18.23.1.11.11.5.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.11.11.6"><span class="ltx_text" id="A5.T18.23.1.11.11.6.1" style="background-color:#FFDFBF;">97.87</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.11.11.7"><span class="ltx_text" id="A5.T18.23.1.11.11.7.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.11.11.8"><span class="ltx_text" id="A5.T18.23.1.11.11.8.1" style="background-color:#F3F0E6;">99.14</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.11.11.9"><span class="ltx_text" id="A5.T18.23.1.11.11.9.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.11.11.10"><span class="ltx_text" id="A5.T18.23.1.11.11.10.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.11.11.11"><span class="ltx_text" id="A5.T18.23.1.11.11.11.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.11.11.12"><span class="ltx_text" id="A5.T18.23.1.11.11.12.1" style="background-color:#F3F0E6;">99.57</span></td>
</tr>
<tr class="ltx_tr" id="A5.T18.23.1.12.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A5.T18.23.1.12.12.1"><span class="ltx_text ltx_font_typewriter" id="A5.T18.23.1.12.12.1.1">self_harm_other</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A5.T18.23.1.12.12.2"><span class="ltx_text" id="A5.T18.23.1.12.12.2.1" style="background-color:#FFDFBF;">97.92</span></th>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.12.12.3"><span class="ltx_text" id="A5.T18.23.1.12.12.3.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.12.12.4"><span class="ltx_text" id="A5.T18.23.1.12.12.4.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.12.12.5"><span class="ltx_text" id="A5.T18.23.1.12.12.5.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.12.12.6"><span class="ltx_text" id="A5.T18.23.1.12.12.6.1" style="background-color:#FFCCCD;">87.50</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.12.12.7"><span class="ltx_text" id="A5.T18.23.1.12.12.7.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.12.12.8"><span class="ltx_text" id="A5.T18.23.1.12.12.8.1" style="background-color:#FFDFBF;">97.22</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.12.12.9"><span class="ltx_text" id="A5.T18.23.1.12.12.9.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.12.12.10"><span class="ltx_text" id="A5.T18.23.1.12.12.10.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.12.12.11"><span class="ltx_text" id="A5.T18.23.1.12.12.11.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.12.12.12"><span class="ltx_text" id="A5.T18.23.1.12.12.12.1" style="background-color:#F3F0E6;">99.30</span></td>
</tr>
<tr class="ltx_tr" id="A5.T18.23.1.13.13">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A5.T18.23.1.13.13.1"><span class="ltx_text ltx_font_typewriter" id="A5.T18.23.1.13.13.1.1">weapon_biological</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A5.T18.23.1.13.13.2"><span class="ltx_text" id="A5.T18.23.1.13.13.2.1" style="background-color:#FFDFBF;">98.12</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.13.13.3"><span class="ltx_text" id="A5.T18.23.1.13.13.3.1" style="background-color:#F3F0E6;">99.06</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.13.13.4"><span class="ltx_text" id="A5.T18.23.1.13.13.4.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.13.13.5"><span class="ltx_text" id="A5.T18.23.1.13.13.5.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.13.13.6"><span class="ltx_text" id="A5.T18.23.1.13.13.6.1" style="background-color:#FFCCCD;">84.50</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.13.13.7"><span class="ltx_text" id="A5.T18.23.1.13.13.7.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.13.13.8"><span class="ltx_text" id="A5.T18.23.1.13.13.8.1" style="background-color:#FFDFBF;">93.89</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.13.13.9"><span class="ltx_text" id="A5.T18.23.1.13.13.9.1" style="background-color:#FFCCCD;">85.91</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.13.13.10"><span class="ltx_text" id="A5.T18.23.1.13.13.10.1" style="background-color:#F3F0E6;">99.53</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.13.13.11"><span class="ltx_text" id="A5.T18.23.1.13.13.11.1" style="background-color:#FFDFBF;">93.89</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.13.13.12"><span class="ltx_text" id="A5.T18.23.1.13.13.12.1" style="background-color:#FFDFBF;">95.77</span></td>
</tr>
<tr class="ltx_tr" id="A5.T18.23.1.14.14">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A5.T18.23.1.14.14.1"><span class="ltx_text ltx_font_typewriter" id="A5.T18.23.1.14.14.1.1">weapon_chemical</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A5.T18.23.1.14.14.2"><span class="ltx_text" id="A5.T18.23.1.14.14.2.1" style="background-color:#FFDFBF;">93.45</span></th>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.14.14.3"><span class="ltx_text" id="A5.T18.23.1.14.14.3.1" style="background-color:#FFDFBF;">95.83</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.14.14.4"><span class="ltx_text" id="A5.T18.23.1.14.14.4.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.14.14.5"><span class="ltx_text" id="A5.T18.23.1.14.14.5.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.14.14.6"><span class="ltx_text" id="A5.T18.23.1.14.14.6.1" style="background-color:#FFCCCD;">67.59</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.14.14.7"><span class="ltx_text" id="A5.T18.23.1.14.14.7.1" style="background-color:#FFDFBF;">98.14</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.14.14.8"><span class="ltx_text" id="A5.T18.23.1.14.14.8.1" style="background-color:#FFCCCD;">80.09</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.14.14.9"><span class="ltx_text" id="A5.T18.23.1.14.14.9.1" style="background-color:#FFCCCD;">77.31</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.14.14.10"><span class="ltx_text" id="A5.T18.23.1.14.14.10.1" style="background-color:#F3F0E6;">99.07</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.14.14.11"><span class="ltx_text" id="A5.T18.23.1.14.14.11.1" style="background-color:#FFDFBF;">91.20</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.14.14.12"><span class="ltx_text" id="A5.T18.23.1.14.14.12.1" style="background-color:#FFCCCD;">89.81</span></td>
</tr>
<tr class="ltx_tr" id="A5.T18.23.1.15.15">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A5.T18.23.1.15.15.1"><span class="ltx_text ltx_font_typewriter" id="A5.T18.23.1.15.15.1.1">weapon_firearm</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A5.T18.23.1.15.15.2"><span class="ltx_text" id="A5.T18.23.1.15.15.2.1" style="background-color:#FFCCCD;">82.88</span></th>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.15.15.3"><span class="ltx_text" id="A5.T18.23.1.15.15.3.1" style="background-color:#FFDFBF;">98.21</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.15.15.4"><span class="ltx_text" id="A5.T18.23.1.15.15.4.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.15.15.5"><span class="ltx_text" id="A5.T18.23.1.15.15.5.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.15.15.6"><span class="ltx_text" id="A5.T18.23.1.15.15.6.1" style="background-color:#FFCCCD;">70.53</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.15.15.7"><span class="ltx_text" id="A5.T18.23.1.15.15.7.1" style="background-color:#F3F0E6;">99.10</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.15.15.8"><span class="ltx_text" id="A5.T18.23.1.15.15.8.1" style="background-color:#FFCCCD;">77.67</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.15.15.9"><span class="ltx_text" id="A5.T18.23.1.15.15.9.1" style="background-color:#FFCCCD;">80.35</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.15.15.10"><span class="ltx_text" id="A5.T18.23.1.15.15.10.1" style="background-color:#F3F0E6;">99.10</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.15.15.11"><span class="ltx_text" id="A5.T18.23.1.15.15.11.1" style="background-color:#FFCCCD;">88.39</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.15.15.12"><span class="ltx_text" id="A5.T18.23.1.15.15.12.1" style="background-color:#FFCCCD;">88.39</span></td>
</tr>
<tr class="ltx_tr" id="A5.T18.23.1.16.16">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A5.T18.23.1.16.16.1"><span class="ltx_text ltx_font_typewriter" id="A5.T18.23.1.16.16.1.1">weapon_radioactive</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A5.T18.23.1.16.16.2"><span class="ltx_text" id="A5.T18.23.1.16.16.2.1" style="background-color:#FFDFBF;">93.71</span></th>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.16.16.3"><span class="ltx_text" id="A5.T18.23.1.16.16.3.1" style="background-color:#F3F0E6;">99.37</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.16.16.4"><span class="ltx_text" id="A5.T18.23.1.16.16.4.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.16.16.5"><span class="ltx_text" id="A5.T18.23.1.16.16.5.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.16.16.6"><span class="ltx_text" id="A5.T18.23.1.16.16.6.1" style="background-color:#FFCCCD;">89.44</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.16.16.7"><span class="ltx_text" id="A5.T18.23.1.16.16.7.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.16.16.8"><span class="ltx_text" id="A5.T18.23.1.16.16.8.1" style="background-color:#FFDFBF;">96.27</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.16.16.9"><span class="ltx_text" id="A5.T18.23.1.16.16.9.1" style="background-color:#FFDFBF;">95.03</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.16.16.10"><span class="ltx_text" id="A5.T18.23.1.16.16.10.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.16.16.11"><span class="ltx_text" id="A5.T18.23.1.16.16.11.1" style="background-color:#FFDFBF;">97.51</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.16.16.12"><span class="ltx_text" id="A5.T18.23.1.16.16.12.1" style="background-color:#FFDFBF;">98.13</span></td>
</tr>
<tr class="ltx_tr" id="A5.T18.23.1.17.17">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A5.T18.23.1.17.17.1"><span class="ltx_text ltx_font_typewriter" id="A5.T18.23.1.17.17.1.1">weapon_other</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A5.T18.23.1.17.17.2"><span class="ltx_text" id="A5.T18.23.1.17.17.2.1" style="background-color:#FFDFBF;">79.75</span></th>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.17.17.3"><span class="ltx_text" id="A5.T18.23.1.17.17.3.1" style="background-color:#FFDFBF;">97.34</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.17.17.4"><span class="ltx_text" id="A5.T18.23.1.17.17.4.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.17.17.5"><span class="ltx_text" id="A5.T18.23.1.17.17.5.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.17.17.6"><span class="ltx_text" id="A5.T18.23.1.17.17.6.1" style="background-color:#FFCCCD;">60.61</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.17.17.7"><span class="ltx_text" id="A5.T18.23.1.17.17.7.1" style="background-color:#FFDFBF;">91.42</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.17.17.8"><span class="ltx_text" id="A5.T18.23.1.17.17.8.1" style="background-color:#FFCCCD;">81.02</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.17.17.9"><span class="ltx_text" id="A5.T18.23.1.17.17.9.1" style="background-color:#FFCCCD;">74.89</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.17.17.10"><span class="ltx_text" id="A5.T18.23.1.17.17.10.1" style="background-color:#FFDFBF;">97.55</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.17.17.11"><span class="ltx_text" id="A5.T18.23.1.17.17.11.1" style="background-color:#FFCCCD;">78.97</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.17.17.12"><span class="ltx_text" id="A5.T18.23.1.17.17.12.1" style="background-color:#FFCCCD;">87.34</span></td>
</tr>
<tr class="ltx_tr" id="A5.T18.23.1.18.18">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A5.T18.23.1.18.18.1"><span class="ltx_text ltx_font_typewriter" id="A5.T18.23.1.18.18.1.1">crime_cyber</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A5.T18.23.1.18.18.2"><span class="ltx_text" id="A5.T18.23.1.18.18.2.1" style="background-color:#FFCCCD;">73.68</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.18.18.3"><span class="ltx_text" id="A5.T18.23.1.18.18.3.1" style="background-color:#FFDFBF;">98.90</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.18.18.4"><span class="ltx_text" id="A5.T18.23.1.18.18.4.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.18.18.5"><span class="ltx_text" id="A5.T18.23.1.18.18.5.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.18.18.6"><span class="ltx_text" id="A5.T18.23.1.18.18.6.1" style="background-color:#FFCCCD;">56.23</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.18.18.7"><span class="ltx_text" id="A5.T18.23.1.18.18.7.1" style="background-color:#FFDFBF;">93.87</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.18.18.8"><span class="ltx_text" id="A5.T18.23.1.18.18.8.1" style="background-color:#FFCCCD;">89.93</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.18.18.9"><span class="ltx_text" id="A5.T18.23.1.18.18.9.1" style="background-color:#FFCCCD;">55.79</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.18.18.10"><span class="ltx_text" id="A5.T18.23.1.18.18.10.1" style="background-color:#FFDFBF;">98.46</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.18.18.11"><span class="ltx_text" id="A5.T18.23.1.18.18.11.1" style="background-color:#FFCCCD;">85.55</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.18.18.12"><span class="ltx_text" id="A5.T18.23.1.18.18.12.1" style="background-color:#FFDFBF;">90.37</span></td>
</tr>
<tr class="ltx_tr" id="A5.T18.23.1.19.19">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A5.T18.23.1.19.19.1"><span class="ltx_text ltx_font_typewriter" id="A5.T18.23.1.19.19.1.1">crime_injury</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A5.T18.23.1.19.19.2"><span class="ltx_text" id="A5.T18.23.1.19.19.2.1" style="background-color:#FFCCCD;">75.92</span></th>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.19.19.3"><span class="ltx_text" id="A5.T18.23.1.19.19.3.1" style="background-color:#FFDFBF;">98.94</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.19.19.4"><span class="ltx_text" id="A5.T18.23.1.19.19.4.1" style="background-color:#F3F0E6;">99.45</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.19.19.5"><span class="ltx_text" id="A5.T18.23.1.19.19.5.1" style="background-color:#F3F0E6;">99.94</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.19.19.6"><span class="ltx_text" id="A5.T18.23.1.19.19.6.1" style="background-color:#FFCCCD;">50.55</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.19.19.7"><span class="ltx_text" id="A5.T18.23.1.19.19.7.1" style="background-color:#FFDFBF;">93.65</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.19.19.8"><span class="ltx_text" id="A5.T18.23.1.19.19.8.1" style="background-color:#FFCCCD;">87.93</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.19.19.9"><span class="ltx_text" id="A5.T18.23.1.19.19.9.1" style="background-color:#FFCCCD;">76.25</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.19.19.10"><span class="ltx_text" id="A5.T18.23.1.19.19.10.1" style="background-color:#F3F0E6;">99.16</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.19.19.11"><span class="ltx_text" id="A5.T18.23.1.19.19.11.1" style="background-color:#FFCCCD;">75.80</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.19.19.12"><span class="ltx_text" id="A5.T18.23.1.19.19.12.1" style="background-color:#FFCCCD;">87.43</span></td>
</tr>
<tr class="ltx_tr" id="A5.T18.23.1.20.20">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A5.T18.23.1.20.20.1"><span class="ltx_text ltx_font_typewriter" id="A5.T18.23.1.20.20.1.1">crime_kidnap</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A5.T18.23.1.20.20.2"><span class="ltx_text" id="A5.T18.23.1.20.20.2.1" style="background-color:#FFCCCD;">75.12</span></th>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.20.20.3"><span class="ltx_text" id="A5.T18.23.1.20.20.3.1" style="background-color:#F3F0E6;">99.50</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.20.20.4"><span class="ltx_text" id="A5.T18.23.1.20.20.4.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.20.20.5"><span class="ltx_text" id="A5.T18.23.1.20.20.5.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.20.20.6"><span class="ltx_text" id="A5.T18.23.1.20.20.6.1" style="background-color:#FFCCCD;">42.28</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.20.20.7"><span class="ltx_text" id="A5.T18.23.1.20.20.7.1" style="background-color:#F3F0E6;">99.50</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.20.20.8"><span class="ltx_text" id="A5.T18.23.1.20.20.8.1" style="background-color:#FFDFBF;">91.04</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.20.20.9"><span class="ltx_text" id="A5.T18.23.1.20.20.9.1" style="background-color:#FFCCCD;">26.86</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.20.20.10"><span class="ltx_text" id="A5.T18.23.1.20.20.10.1" style="background-color:#FFDFBF;">98.00</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.20.20.11"><span class="ltx_text" id="A5.T18.23.1.20.20.11.1" style="background-color:#FFCCCD;">49.75</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.20.20.12"><span class="ltx_text" id="A5.T18.23.1.20.20.12.1" style="background-color:#FFCCCD;">81.59</span></td>
</tr>
<tr class="ltx_tr" id="A5.T18.23.1.21.21">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A5.T18.23.1.21.21.1"><span class="ltx_text ltx_font_typewriter" id="A5.T18.23.1.21.21.1.1">crime_privacy</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A5.T18.23.1.21.21.2"><span class="ltx_text" id="A5.T18.23.1.21.21.2.1" style="background-color:#FFDFBF;">95.56</span></th>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.21.21.3"><span class="ltx_text" id="A5.T18.23.1.21.21.3.1" style="background-color:#F3F0E6;">99.72</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.21.21.4"><span class="ltx_text" id="A5.T18.23.1.21.21.4.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.21.21.5"><span class="ltx_text" id="A5.T18.23.1.21.21.5.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.21.21.6"><span class="ltx_text" id="A5.T18.23.1.21.21.6.1" style="background-color:#FFCCCD;">87.81</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.21.21.7"><span class="ltx_text" id="A5.T18.23.1.21.21.7.1" style="background-color:#FFDFBF;">98.06</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.21.21.8"><span class="ltx_text" id="A5.T18.23.1.21.21.8.1" style="background-color:#FFDFBF;">96.39</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.21.21.9"><span class="ltx_text" id="A5.T18.23.1.21.21.9.1" style="background-color:#FFCCCD;">87.25</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.21.21.10"><span class="ltx_text" id="A5.T18.23.1.21.21.10.1" style="background-color:#F3F0E6;">99.16</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.21.21.11"><span class="ltx_text" id="A5.T18.23.1.21.21.11.1" style="background-color:#FFDFBF;">95.84</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.21.21.12"><span class="ltx_text" id="A5.T18.23.1.21.21.12.1" style="background-color:#FFDFBF;">97.22</span></td>
</tr>
<tr class="ltx_tr" id="A5.T18.23.1.22.22">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A5.T18.23.1.22.22.1"><span class="ltx_text ltx_font_typewriter" id="A5.T18.23.1.22.22.1.1">crime_propaganda</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A5.T18.23.1.22.22.2"><span class="ltx_text" id="A5.T18.23.1.22.22.2.1" style="background-color:#FFDFBF;">96.41</span></th>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.22.22.3"><span class="ltx_text" id="A5.T18.23.1.22.22.3.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.22.22.4"><span class="ltx_text" id="A5.T18.23.1.22.22.4.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.22.22.5"><span class="ltx_text" id="A5.T18.23.1.22.22.5.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.22.22.6"><span class="ltx_text" id="A5.T18.23.1.22.22.6.1" style="background-color:#FFDFBF;">96.33</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.22.22.7"><span class="ltx_text" id="A5.T18.23.1.22.22.7.1" style="background-color:#F3F0E6;">99.71</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.22.22.8"><span class="ltx_text" id="A5.T18.23.1.22.22.8.1" style="background-color:#FFDFBF;">97.01</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.22.22.9"><span class="ltx_text" id="A5.T18.23.1.22.22.9.1" style="background-color:#F3F0E6;">99.80</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.22.22.10"><span class="ltx_text" id="A5.T18.23.1.22.22.10.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.22.22.11"><span class="ltx_text" id="A5.T18.23.1.22.22.11.1" style="background-color:#F3F0E6;">99.51</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.22.22.12"><span class="ltx_text" id="A5.T18.23.1.22.22.12.1" style="background-color:#FFDFBF;">92.28</span></td>
</tr>
<tr class="ltx_tr" id="A5.T18.23.1.23.23">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A5.T18.23.1.23.23.1"><span class="ltx_text ltx_font_typewriter" id="A5.T18.23.1.23.23.1.1">crime_tax</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A5.T18.23.1.23.23.2"><span class="ltx_text" id="A5.T18.23.1.23.23.2.1" style="background-color:#FFCCCD;">83.23</span></th>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.23.23.3"><span class="ltx_text" id="A5.T18.23.1.23.23.3.1" style="background-color:#F3F0E6;">99.69</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.23.23.4"><span class="ltx_text" id="A5.T18.23.1.23.23.4.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.23.23.5"><span class="ltx_text" id="A5.T18.23.1.23.23.5.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.23.23.6"><span class="ltx_text" id="A5.T18.23.1.23.23.6.1" style="background-color:#FFCCCD;">55.18</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.23.23.7"><span class="ltx_text" id="A5.T18.23.1.23.23.7.1" style="background-color:#FFDFBF;">98.78</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.23.23.8"><span class="ltx_text" id="A5.T18.23.1.23.23.8.1" style="background-color:#FFCCCD;">84.14</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.23.23.9"><span class="ltx_text" id="A5.T18.23.1.23.23.9.1" style="background-color:#FFCCCD;">49.69</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.23.23.10"><span class="ltx_text" id="A5.T18.23.1.23.23.10.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.23.23.11"><span class="ltx_text" id="A5.T18.23.1.23.23.11.1" style="background-color:#FFCCCD;">86.89</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.23.23.12"><span class="ltx_text" id="A5.T18.23.1.23.23.12.1" style="background-color:#FFCCCD;">89.63</span></td>
</tr>
<tr class="ltx_tr" id="A5.T18.23.1.24.24">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A5.T18.23.1.24.24.1"><span class="ltx_text ltx_font_typewriter" id="A5.T18.23.1.24.24.1.1">crime_theft</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A5.T18.23.1.24.24.2"><span class="ltx_text" id="A5.T18.23.1.24.24.2.1" style="background-color:#FFCCCD;">74.98</span></th>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.24.24.3"><span class="ltx_text" id="A5.T18.23.1.24.24.3.1" style="background-color:#FFDFBF;">98.62</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.24.24.4"><span class="ltx_text" id="A5.T18.23.1.24.24.4.1" style="background-color:#F3F0E6;">99.31</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.24.24.5"><span class="ltx_text" id="A5.T18.23.1.24.24.5.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.24.24.6"><span class="ltx_text" id="A5.T18.23.1.24.24.6.1" style="background-color:#FFCCCD;">38.07</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.24.24.7"><span class="ltx_text" id="A5.T18.23.1.24.24.7.1" style="background-color:#FFDFBF;">95.71</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.24.24.8"><span class="ltx_text" id="A5.T18.23.1.24.24.8.1" style="background-color:#FFDFBF;">92.10</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.24.24.9"><span class="ltx_text" id="A5.T18.23.1.24.24.9.1" style="background-color:#FFCCCD;">35.93</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.24.24.10"><span class="ltx_text" id="A5.T18.23.1.24.24.10.1" style="background-color:#F3F0E6;">99.31</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.24.24.11"><span class="ltx_text" id="A5.T18.23.1.24.24.11.1" style="background-color:#FFCCCD;">47.16</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.24.24.12"><span class="ltx_text" id="A5.T18.23.1.24.24.12.1" style="background-color:#FFCCCD;">80.10</span></td>
</tr>
<tr class="ltx_tr" id="A5.T18.23.1.25.25">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A5.T18.23.1.25.25.1"><span class="ltx_text ltx_font_typewriter" id="A5.T18.23.1.25.25.1.1">crime_other</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A5.T18.23.1.25.25.2"><span class="ltx_text" id="A5.T18.23.1.25.25.2.1" style="background-color:#FFCCCD;">85.30</span></th>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.25.25.3"><span class="ltx_text" id="A5.T18.23.1.25.25.3.1" style="background-color:#F3F0E6;">99.42</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.25.25.4"><span class="ltx_text" id="A5.T18.23.1.25.25.4.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.25.25.5"><span class="ltx_text" id="A5.T18.23.1.25.25.5.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.25.25.6"><span class="ltx_text" id="A5.T18.23.1.25.25.6.1" style="background-color:#FFCCCD;">63.89</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.25.25.7"><span class="ltx_text" id="A5.T18.23.1.25.25.7.1" style="background-color:#FFDFBF;">97.13</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.25.25.8"><span class="ltx_text" id="A5.T18.23.1.25.25.8.1" style="background-color:#FFDFBF;">95.41</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.25.25.9"><span class="ltx_text" id="A5.T18.23.1.25.25.9.1" style="background-color:#FFCCCD;">86.82</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.25.25.10"><span class="ltx_text" id="A5.T18.23.1.25.25.10.1" style="background-color:#F3F0E6;">99.42</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.25.25.11"><span class="ltx_text" id="A5.T18.23.1.25.25.11.1" style="background-color:#FFCCCD;">88.25</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.25.25.12"><span class="ltx_text" id="A5.T18.23.1.25.25.12.1" style="background-color:#FFDFBF;">91.40</span></td>
</tr>
<tr class="ltx_tr" id="A5.T18.23.1.26.26">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A5.T18.23.1.26.26.1"><span class="ltx_text ltx_font_typewriter" id="A5.T18.23.1.26.26.1.1">sex_harassment</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A5.T18.23.1.26.26.2"><span class="ltx_text" id="A5.T18.23.1.26.26.2.1" style="background-color:#FFCCCD;">81.46</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.26.26.3"><span class="ltx_text" id="A5.T18.23.1.26.26.3.1" style="background-color:#FFDFBF;">94.25</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.26.26.4"><span class="ltx_text" id="A5.T18.23.1.26.26.4.1" style="background-color:#FFDFBF;">98.17</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.26.26.5"><span class="ltx_text" id="A5.T18.23.1.26.26.5.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.26.26.6"><span class="ltx_text" id="A5.T18.23.1.26.26.6.1" style="background-color:#FFCCCD;">56.19</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.26.26.7"><span class="ltx_text" id="A5.T18.23.1.26.26.7.1" style="background-color:#FFDFBF;">94.25</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.26.26.8"><span class="ltx_text" id="A5.T18.23.1.26.26.8.1" style="background-color:#FFCCCD;">86.42</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.26.26.9"><span class="ltx_text" id="A5.T18.23.1.26.26.9.1" style="background-color:#FFCCCD;">83.81</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.26.26.10"><span class="ltx_text" id="A5.T18.23.1.26.26.10.1" style="background-color:#FFDFBF;">96.08</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.26.26.11"><span class="ltx_text" id="A5.T18.23.1.26.26.11.1" style="background-color:#FFCCCD;">71.27</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.26.26.12"><span class="ltx_text" id="A5.T18.23.1.26.26.12.1" style="background-color:#FFCCCD;">77.02</span></td>
</tr>
<tr class="ltx_tr" id="A5.T18.23.1.27.27">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A5.T18.23.1.27.27.1"><span class="ltx_text ltx_font_typewriter" id="A5.T18.23.1.27.27.1.1">sex_porn</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A5.T18.23.1.27.27.2"><span class="ltx_text" id="A5.T18.23.1.27.27.2.1" style="background-color:#FFCCCD;">73.33</span></th>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.27.27.3"><span class="ltx_text" id="A5.T18.23.1.27.27.3.1" style="background-color:#FFDFBF;">92.66</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.27.27.4"><span class="ltx_text" id="A5.T18.23.1.27.27.4.1" style="background-color:#FFDFBF;">98.66</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.27.27.5"><span class="ltx_text" id="A5.T18.23.1.27.27.5.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.27.27.6"><span class="ltx_text" id="A5.T18.23.1.27.27.6.1" style="background-color:#FFCCCD;">39.33</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.27.27.7"><span class="ltx_text" id="A5.T18.23.1.27.27.7.1" style="background-color:#FFDFBF;">90.66</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.27.27.8"><span class="ltx_text" id="A5.T18.23.1.27.27.8.1" style="background-color:#FFCCCD;">70.00</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.27.27.9"><span class="ltx_text" id="A5.T18.23.1.27.27.9.1" style="background-color:#FFCCCD;">60.66</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.27.27.10"><span class="ltx_text" id="A5.T18.23.1.27.27.10.1" style="background-color:#FFCCCD;">89.33</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.27.27.11"><span class="ltx_text" id="A5.T18.23.1.27.27.11.1" style="background-color:#FFCCCD;">58.00</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.27.27.12"><span class="ltx_text" id="A5.T18.23.1.27.27.12.1" style="background-color:#FFCCCD;">56.00</span></td>
</tr>
<tr class="ltx_tr" id="A5.T18.23.1.28.28">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A5.T18.23.1.28.28.1"><span class="ltx_text ltx_font_typewriter" id="A5.T18.23.1.28.28.1.1">sex_other</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A5.T18.23.1.28.28.2"><span class="ltx_text" id="A5.T18.23.1.28.28.2.1" style="background-color:#FFCCCD;">83.79</span></th>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.28.28.3"><span class="ltx_text" id="A5.T18.23.1.28.28.3.1" style="background-color:#FFDFBF;">95.09</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.28.28.4"><span class="ltx_text" id="A5.T18.23.1.28.28.4.1" style="background-color:#FFDFBF;">97.54</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.28.28.5"><span class="ltx_text" id="A5.T18.23.1.28.28.5.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.28.28.6"><span class="ltx_text" id="A5.T18.23.1.28.28.6.1" style="background-color:#FFCCCD;">64.03</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.28.28.7"><span class="ltx_text" id="A5.T18.23.1.28.28.7.1" style="background-color:#FFDFBF;">95.09</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.28.28.8"><span class="ltx_text" id="A5.T18.23.1.28.28.8.1" style="background-color:#FFCCCD;">83.92</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.28.28.9"><span class="ltx_text" id="A5.T18.23.1.28.28.9.1" style="background-color:#FFCCCD;">86.37</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.28.28.10"><span class="ltx_text" id="A5.T18.23.1.28.28.10.1" style="background-color:#FFDFBF;">95.91</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.28.28.11"><span class="ltx_text" id="A5.T18.23.1.28.28.11.1" style="background-color:#FFCCCD;">70.29</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.28.28.12"><span class="ltx_text" id="A5.T18.23.1.28.28.12.1" style="background-color:#FFCCCD;">80.38</span></td>
</tr>
<tr class="ltx_tr" id="A5.T18.23.1.29.29">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A5.T18.23.1.29.29.1"><span class="ltx_text ltx_font_typewriter" id="A5.T18.23.1.29.29.1.1">substance_alcohol</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A5.T18.23.1.29.29.2"><span class="ltx_text" id="A5.T18.23.1.29.29.2.1" style="background-color:#FFCCCD;">85.31</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.29.29.3"><span class="ltx_text" id="A5.T18.23.1.29.29.3.1" style="background-color:#FFDFBF;">98.03</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.29.29.4"><span class="ltx_text" id="A5.T18.23.1.29.29.4.1" style="background-color:#F3F0E6;">99.58</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.29.29.5"><span class="ltx_text" id="A5.T18.23.1.29.29.5.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.29.29.6"><span class="ltx_text" id="A5.T18.23.1.29.29.6.1" style="background-color:#FFCCCD;">73.66</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.29.29.7"><span class="ltx_text" id="A5.T18.23.1.29.29.7.1" style="background-color:#FFDFBF;">96.35</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.29.29.8"><span class="ltx_text" id="A5.T18.23.1.29.29.8.1" style="background-color:#FFCCCD;">87.95</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.29.29.9"><span class="ltx_text" id="A5.T18.23.1.29.29.9.1" style="background-color:#FFCCCD;">81.79</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.29.29.10"><span class="ltx_text" id="A5.T18.23.1.29.29.10.1" style="background-color:#FFDFBF;">98.03</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.29.29.11"><span class="ltx_text" id="A5.T18.23.1.29.29.11.1" style="background-color:#FFCCCD;">83.19</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T18.23.1.29.29.12"><span class="ltx_text" id="A5.T18.23.1.29.29.12.1" style="background-color:#FFCCCD;">83.47</span></td>
</tr>
<tr class="ltx_tr" id="A5.T18.23.1.30.30">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A5.T18.23.1.30.30.1"><span class="ltx_text ltx_font_typewriter" id="A5.T18.23.1.30.30.1.1">substance_cannabis</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A5.T18.23.1.30.30.2"><span class="ltx_text" id="A5.T18.23.1.30.30.2.1" style="background-color:#FFCCCD;">62.95</span></th>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.30.30.3"><span class="ltx_text" id="A5.T18.23.1.30.30.3.1" style="background-color:#FFCCCD;">80.87</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.30.30.4"><span class="ltx_text" id="A5.T18.23.1.30.30.4.1" style="background-color:#FFCCCD;">82.07</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.30.30.5"><span class="ltx_text" id="A5.T18.23.1.30.30.5.1" style="background-color:#F3F0E6;">99.60</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.30.30.6"><span class="ltx_text" id="A5.T18.23.1.30.30.6.1" style="background-color:#FFCCCD;">24.30</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.30.30.7"><span class="ltx_text" id="A5.T18.23.1.30.30.7.1" style="background-color:#FFCCCD;">68.12</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.30.30.8"><span class="ltx_text" id="A5.T18.23.1.30.30.8.1" style="background-color:#FFCCCD;">56.17</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.30.30.9"><span class="ltx_text" id="A5.T18.23.1.30.30.9.1" style="background-color:#FFCCCD;">32.66</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.30.30.10"><span class="ltx_text" id="A5.T18.23.1.30.30.10.1" style="background-color:#FFCCCD;">72.50</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.30.30.11"><span class="ltx_text" id="A5.T18.23.1.30.30.11.1" style="background-color:#FFCCCD;">43.82</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.30.30.12"><span class="ltx_text" id="A5.T18.23.1.30.30.12.1" style="background-color:#FFCCCD;">43.02</span></td>
</tr>
<tr class="ltx_tr" id="A5.T18.23.1.31.31">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A5.T18.23.1.31.31.1"><span class="ltx_text ltx_font_typewriter" id="A5.T18.23.1.31.31.1.1">substance_drug</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A5.T18.23.1.31.31.2"><span class="ltx_text" id="A5.T18.23.1.31.31.2.1" style="background-color:#FFCCCD;">65.79</span></th>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.31.31.3"><span class="ltx_text" id="A5.T18.23.1.31.31.3.1" style="background-color:#FFDFBF;">93.50</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.31.31.4"><span class="ltx_text" id="A5.T18.23.1.31.31.4.1" style="background-color:#FFDFBF;">97.37</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.31.31.5"><span class="ltx_text" id="A5.T18.23.1.31.31.5.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.31.31.6"><span class="ltx_text" id="A5.T18.23.1.31.31.6.1" style="background-color:#FFCCCD;">34.00</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.31.31.7"><span class="ltx_text" id="A5.T18.23.1.31.31.7.1" style="background-color:#FFCCCD;">89.18</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.31.31.8"><span class="ltx_text" id="A5.T18.23.1.31.31.8.1" style="background-color:#FFCCCD;">77.27</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.31.31.9"><span class="ltx_text" id="A5.T18.23.1.31.31.9.1" style="background-color:#FFCCCD;">48.99</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.31.31.10"><span class="ltx_text" id="A5.T18.23.1.31.31.10.1" style="background-color:#FFDFBF;">94.74</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.31.31.11"><span class="ltx_text" id="A5.T18.23.1.31.31.11.1" style="background-color:#FFCCCD;">63.83</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.31.31.12"><span class="ltx_text" id="A5.T18.23.1.31.31.12.1" style="background-color:#FFCCCD;">63.98</span></td>
</tr>
<tr class="ltx_tr" id="A5.T18.23.1.32.32">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A5.T18.23.1.32.32.1"><span class="ltx_text ltx_font_typewriter" id="A5.T18.23.1.32.32.1.1">substance_tobacco</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A5.T18.23.1.32.32.2"><span class="ltx_text" id="A5.T18.23.1.32.32.2.1" style="background-color:#FFCCCD;">84.91</span></th>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.32.32.3"><span class="ltx_text" id="A5.T18.23.1.32.32.3.1" style="background-color:#F3F0E6;">99.05</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.32.32.4"><span class="ltx_text" id="A5.T18.23.1.32.32.4.1" style="background-color:#F3F0E6;">99.05</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.32.32.5"><span class="ltx_text" id="A5.T18.23.1.32.32.5.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.32.32.6"><span class="ltx_text" id="A5.T18.23.1.32.32.6.1" style="background-color:#FFCCCD;">66.98</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.32.32.7"><span class="ltx_text" id="A5.T18.23.1.32.32.7.1" style="background-color:#F3F0E6;">99.05</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.32.32.8"><span class="ltx_text" id="A5.T18.23.1.32.32.8.1" style="background-color:#FFDFBF;">91.50</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.32.32.9"><span class="ltx_text" id="A5.T18.23.1.32.32.9.1" style="background-color:#FFCCCD;">75.47</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.32.32.10"><span class="ltx_text" id="A5.T18.23.1.32.32.10.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.32.32.11"><span class="ltx_text" id="A5.T18.23.1.32.32.11.1" style="background-color:#FFCCCD;">89.62</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.32.32.12"><span class="ltx_text" id="A5.T18.23.1.32.32.12.1" style="background-color:#FFCCCD;">87.73</span></td>
</tr>
<tr class="ltx_tr" id="A5.T18.23.1.33.33">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A5.T18.23.1.33.33.1"><span class="ltx_text ltx_font_typewriter" id="A5.T18.23.1.33.33.1.1">substance_other</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A5.T18.23.1.33.33.2"><span class="ltx_text" id="A5.T18.23.1.33.33.2.1" style="background-color:#FFCCCD;">81.77</span></th>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.33.33.3"><span class="ltx_text" id="A5.T18.23.1.33.33.3.1" style="background-color:#FFDFBF;">96.57</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.33.33.4"><span class="ltx_text" id="A5.T18.23.1.33.33.4.1" style="background-color:#FFDFBF;">98.88</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.33.33.5"><span class="ltx_text" id="A5.T18.23.1.33.33.5.1" style="background-color:#F3F0E6;">100.0</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.33.33.6"><span class="ltx_text" id="A5.T18.23.1.33.33.6.1" style="background-color:#FFCCCD;">45.94</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.33.33.7"><span class="ltx_text" id="A5.T18.23.1.33.33.7.1" style="background-color:#FFDFBF;">91.89</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.33.33.8"><span class="ltx_text" id="A5.T18.23.1.33.33.8.1" style="background-color:#FFCCCD;">81.26</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.33.33.9"><span class="ltx_text" id="A5.T18.23.1.33.33.9.1" style="background-color:#FFCCCD;">66.30</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.33.33.10"><span class="ltx_text" id="A5.T18.23.1.33.33.10.1" style="background-color:#FFDFBF;">96.93</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.33.33.11"><span class="ltx_text" id="A5.T18.23.1.33.33.11.1" style="background-color:#FFCCCD;">66.30</span></td>
<td class="ltx_td ltx_align_center" id="A5.T18.23.1.33.33.12"><span class="ltx_text" id="A5.T18.23.1.33.33.12.1" style="background-color:#FFCCCD;">76.03</span></td>
</tr>
<tr class="ltx_tr" id="A5.T18.23.1.34.34">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_tt" id="A5.T18.23.1.34.34.1"><span class="ltx_text ltx_font_italic" id="A5.T18.23.1.34.34.1.1">Overall Safety Score</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_tt" id="A5.T18.23.1.34.34.2"><span class="ltx_text" id="A5.T18.23.1.34.34.2.1" style="background-color:#FFCCCD;">83.05</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_tt" id="A5.T18.23.1.34.34.3"><span class="ltx_text" id="A5.T18.23.1.34.34.3.1" style="background-color:#FFDFBF;">96.95</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_tt" id="A5.T18.23.1.34.34.4"><span class="ltx_text" id="A5.T18.23.1.34.34.4.1" style="background-color:#F3F0E6;">99.18</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_tt" id="A5.T18.23.1.34.34.5"><span class="ltx_text" id="A5.T18.23.1.34.34.5.1" style="background-color:#F3F0E6;">99.98</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_tt" id="A5.T18.23.1.34.34.6"><span class="ltx_text" id="A5.T18.23.1.34.34.6.1" style="background-color:#FFCCCD;">62.13</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_tt" id="A5.T18.23.1.34.34.7"><span class="ltx_text" id="A5.T18.23.1.34.34.7.1" style="background-color:#FFDFBF;">95.75</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_tt" id="A5.T18.23.1.34.34.8"><span class="ltx_text" id="A5.T18.23.1.34.34.8.1" style="background-color:#FFCCCD;">88.11</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_tt" id="A5.T18.23.1.34.34.9"><span class="ltx_text" id="A5.T18.23.1.34.34.9.1" style="background-color:#FFCCCD;">75.45</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_tt" id="A5.T18.23.1.34.34.10"><span class="ltx_text" id="A5.T18.23.1.34.34.10.1" style="background-color:#FFDFBF;">98.22</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_tt" id="A5.T18.23.1.34.34.11"><span class="ltx_text" id="A5.T18.23.1.34.34.11.1" style="background-color:#FFCCCD;">77.86</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_tt" id="A5.T18.23.1.34.34.12"><span class="ltx_text" id="A5.T18.23.1.34.34.12.1" style="background-color:#FFCCCD;">85.90</span></td>
</tr>
</tbody>
</table>
</span></div>
</div>
</div>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
<section class="ltx_appendix" id="A6">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix F </span>Synthetic Transcripts Generation for Fine-tuning</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A6.p1">
<p class="ltx_p" id="A6.p1.1">In this section, we provide examples of synthetic transcripts.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_subsection" id="A6.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">F.1 </span>General knowledge</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A6.SS1.p1">
<svg class="ltx_picture" height="585.11" id="A6.SS1.p1.pic1" overflow="visible" version="1.1" width="600"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,585.11) matrix(1 0 0 -1 0 0)"><g fill="#404040" fill-opacity="1.0"><path d="M 0 5.91 L 0 579.21 C 0 582.47 2.64 585.11 5.91 585.11 L 594.09 585.11 C 597.36 585.11 600 582.47 600 579.21 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z" style="stroke:none"></path></g><g fill="#F2F2F2" fill-opacity="1.0"><path d="M 1.97 5.91 L 1.97 579.21 C 1.97 581.38 3.73 583.14 5.91 583.14 L 594.09 583.14 C 596.27 583.14 598.03 581.38 598.03 579.21 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 13.78)"><foreignObject color="#000000" height="557.55" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="556.69">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A6.SS1.p1.pic1.1.1.1.1.1" style="width:402.3pt;">
<span class="ltx_p" id="A6.SS1.p1.pic1.1.1.1.1.1.1"><span class="ltx_text ltx_font_typewriter" id="A6.SS1.p1.pic1.1.1.1.1.1.1.1">USER</span>: Hey, I’ve been researching a bit about information theory, and I’ve come across this concept of entropy. What is it?</span>
<span class="ltx_p" id="A6.SS1.p1.pic1.1.1.1.1.1.2"><span class="ltx_text ltx_font_typewriter" id="A6.SS1.p1.pic1.1.1.1.1.1.2.1">MOSHI</span>: Oh, that’s an interesting topic. Entropy, in information theory, is a measure of the average level of information, surprise, or uncertainty inherent to a random variable’s p
ossible outcomes. It’s actually a very useful concept in communication and computer science.</span>
<span class="ltx_p" id="A6.SS1.p1.pic1.1.1.1.1.1.3"><span class="ltx_text ltx_font_typewriter" id="A6.SS1.p1.pic1.1.1.1.1.1.3.1">USER</span>: So how does it work?</span>
<span class="ltx_p" id="A6.SS1.p1.pic1.1.1.1.1.1.4"><span class="ltx_text ltx_font_typewriter" id="A6.SS1.p1.pic1.1.1.1.1.1.4.1">MOSHI</span>: Entropy is calculated using a formula where it’s negative sum of the products of each possible outcome’s probability and its logarithm to a base, usually base-2 or base-e. T
he higher the entropy, the greater the uncertainty or information, and vice versa.</span>
<span class="ltx_p" id="A6.SS1.p1.pic1.1.1.1.1.1.5"><span class="ltx_text ltx_font_typewriter" id="A6.SS1.p1.pic1.1.1.1.1.1.5.1">USER</span>: Okay, that’s interesting. How does it relate to communication and computer science?</span>
<span class="ltx_p" id="A6.SS1.p1.pic1.1.1.1.1.1.6"><span class="ltx_text ltx_font_typewriter" id="A6.SS1.p1.pic1.1.1.1.1.1.6.1">MOSHI</span>: In communication and computer science, entropy plays a crucial role, especially in the field of error-correcting codes and compression methods. Imagine a source sending a message, and each bit has a certain probability.</span>
<span class="ltx_p" id="A6.SS1.p1.pic1.1.1.1.1.1.7"><span class="ltx_text ltx_font_typewriter" id="A6.SS1.p1.pic1.1.1.1.1.1.7.1">USER</span>: Yeah.</span>
<span class="ltx_p" id="A6.SS1.p1.pic1.1.1.1.1.1.8"><span class="ltx_text ltx_font_typewriter" id="A6.SS1.p1.pic1.1.1.1.1.1.8.1">MOSHI</span>: Entropy tells us how much information we need to send from the source to the receiver to ensure reliable communication. The lower the entropy, the fewer bits are needed, and the less information is lost in transmission or reception.</span>
<span class="ltx_p" id="A6.SS1.p1.pic1.1.1.1.1.1.9"><span class="ltx_text ltx_font_typewriter" id="A6.SS1.p1.pic1.1.1.1.1.1.9.1">USER</span>: That’s fascinating. How does it relate to statistical thermodynamics,</span>
<span class="ltx_p" id="A6.SS1.p1.pic1.1.1.1.1.1.10"><span class="ltx_text ltx_font_typewriter" id="A6.SS1.p1.pic1.1.1.1.1.1.10.1">MOSHI</span>: That’s a good question. Entropy in information theory is directly analogous to the entropy in statistical thermodynamics. It’s a measure of the unavailability of a system’s energy to perform work. The higher the entropy, the more disordered the system. In information theory, entropy measures the amount of missing information that could be replaced.</span>
<span class="ltx_p" id="A6.SS1.p1.pic1.1.1.1.1.1.11"><span class="ltx_text ltx_font_typewriter" id="A6.SS1.p1.pic1.1.1.1.1.1.11.1">USER</span>: Wow. So entropy can be used to measure disorder in both physical and digital systems.</span>
<span class="ltx_p" id="A6.SS1.p1.pic1.1.1.1.1.1.12"><span class="ltx_text ltx_font_typewriter" id="A6.SS1.p1.pic1.1.1.1.1.1.12.1">MOSHI</span>: Exactly and entropy can also be used to measure the amount of missing information or the amount of compressed data after encoding a message. It’s quite versatile, isn’t it?</span>
<span class="ltx_p" id="A6.SS1.p1.pic1.1.1.1.1.1.13"><span class="ltx_text ltx_font_typewriter" id="A6.SS1.p1.pic1.1.1.1.1.1.13.1">USER</span>: Yeah, very versatile. Thank you for explaining all this to me. It’s really fascinating.</span>
<span class="ltx_p" id="A6.SS1.p1.pic1.1.1.1.1.1.14"><span class="ltx_text ltx_font_typewriter" id="A6.SS1.p1.pic1.1.1.1.1.1.14.1">MOSHI</span>: You’re welcome. Information theory and entropy are indeed fascinating areas of study with many applications in various fields.</span>
<span class="ltx_p" id="A6.SS1.p1.pic1.1.1.1.1.1.15"><span class="ltx_text ltx_font_typewriter" id="A6.SS1.p1.pic1.1.1.1.1.1.15.1">USER</span>: I’m glad I got to learn about it today.</span>
<span class="ltx_p" id="A6.SS1.p1.pic1.1.1.1.1.1.16"><span class="ltx_text ltx_font_typewriter" id="A6.SS1.p1.pic1.1.1.1.1.1.16.1">MOSHI</span>: It’s always good to expand your knowledge.</span>
<span class="ltx_p" id="A6.SS1.p1.pic1.1.1.1.1.1.17"><span class="ltx_text ltx_font_typewriter" id="A6.SS1.p1.pic1.1.1.1.1.1.17.1">USER</span>: Indeed.</span>
<span class="ltx_p" id="A6.SS1.p1.pic1.1.1.1.1.1.18"><span class="ltx_text ltx_font_typewriter" id="A6.SS1.p1.pic1.1.1.1.1.1.18.1">MOSHI</span>: There’s so much to learn about.</span>
</span></foreignObject></g></g></svg><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A6.SS1.p2">
<svg class="ltx_picture" height="405.16" id="A6.SS1.p2.pic1" overflow="visible" version="1.1" width="600"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,405.16) matrix(1 0 0 -1 0 0)"><g fill="#404040" fill-opacity="1.0"><path d="M 0 5.91 L 0 399.25 C 0 402.51 2.64 405.16 5.91 405.16 L 594.09 405.16 C 597.36 405.16 600 402.51 600 399.25 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z" style="stroke:none"></path></g><g fill="#F2F2F2" fill-opacity="1.0"><path d="M 1.97 5.91 L 1.97 399.25 C 1.97 401.42 3.73 403.19 5.91 403.19 L 594.09 403.19 C 596.27 403.19 598.03 401.42 598.03 399.25 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 13.78)"><foreignObject color="#000000" height="377.6" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="556.69">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A6.SS1.p2.pic1.1.1.1.1.1" style="width:402.3pt;">
<span class="ltx_p" id="A6.SS1.p2.pic1.1.1.1.1.1.1"><span class="ltx_text ltx_font_typewriter" id="A6.SS1.p2.pic1.1.1.1.1.1.1.1">USER</span>: Hello, I wanted to talk to you about The Three Musketeers.</span>
<span class="ltx_p" id="A6.SS1.p2.pic1.1.1.1.1.1.2"><span class="ltx_text ltx_font_typewriter" id="A6.SS1.p2.pic1.1.1.1.1.1.2.1">MOSHI</span>: Of course, happy to help! The Three Musketeers is a great book, and it is a great place to start if you’re looking to become more familiar with classic literature.</span>
<span class="ltx_p" id="A6.SS1.p2.pic1.1.1.1.1.1.3"><span class="ltx_text ltx_font_typewriter" id="A6.SS1.p2.pic1.1.1.1.1.1.3.1">USER</span>: Wow, this is fantastic. Can you tell me more about the story?</span>
<span class="ltx_p" id="A6.SS1.p2.pic1.1.1.1.1.1.4"><span class="ltx_text ltx_font_typewriter" id="A6.SS1.p2.pic1.1.1.1.1.1.4.1">MOSHI</span>: Sure, the book is set in 17th century France and tells the tale of d’Artagnan, a young man who aims to become a member of the prestigious Musketeers.</span>
<span class="ltx_p" id="A6.SS1.p2.pic1.1.1.1.1.1.5"><span class="ltx_text ltx_font_typewriter" id="A6.SS1.p2.pic1.1.1.1.1.1.5.1">USER</span>: So what is the story about?</span>
<span class="ltx_p" id="A6.SS1.p2.pic1.1.1.1.1.1.6"><span class="ltx_text ltx_font_typewriter" id="A6.SS1.p2.pic1.1.1.1.1.1.6.1">MOSHI</span>: The story follows d’Artagnan as he travels to Paris to accomplish his goal. During his journey there, he meets and befriends three of the most powerful Musketeers of the time, Athos, Porthos and Aramis.</span>
<span class="ltx_p" id="A6.SS1.p2.pic1.1.1.1.1.1.7"><span class="ltx_text ltx_font_typewriter" id="A6.SS1.p2.pic1.1.1.1.1.1.7.1">USER</span>: Wow, it sounds exciting. What else does the story focus on?</span>
<span class="ltx_p" id="A6.SS1.p2.pic1.1.1.1.1.1.8"><span class="ltx_text ltx_font_typewriter" id="A6.SS1.p2.pic1.1.1.1.1.1.8.1">MOSHI</span>: The book also explores the political and social issues of the time, including the abuses of power and the inequalities in society.</span>
<span class="ltx_p" id="A6.SS1.p2.pic1.1.1.1.1.1.9"><span class="ltx_text ltx_font_typewriter" id="A6.SS1.p2.pic1.1.1.1.1.1.9.1">USER</span>: That sounds interesting. Can you tell me more about the characters?</span>
<span class="ltx_p" id="A6.SS1.p2.pic1.1.1.1.1.1.10"><span class="ltx_text ltx_font_typewriter" id="A6.SS1.p2.pic1.1.1.1.1.1.10.1">MOSHI</span>: Sure, d’Artagnan is a courageous and ambitious character who is determined to prove himself. Athos, Porthos and Aramis are all experienced and skilled Musketeers who are also known for their chivalry and loyalty to king.</span>
<span class="ltx_p" id="A6.SS1.p2.pic1.1.1.1.1.1.11"><span class="ltx_text ltx_font_typewriter" id="A6.SS1.p2.pic1.1.1.1.1.1.11.1">USER</span>: I can see this is a great book for people who are interested in history and adventure. How would you rate it?</span>
<span class="ltx_p" id="A6.SS1.p2.pic1.1.1.1.1.1.12"><span class="ltx_text ltx_font_typewriter" id="A6.SS1.p2.pic1.1.1.1.1.1.12.1">MOSHI</span>: I would definitely give it a 4 or 5 out of 5. The Three Musketeers is a classic book that has stood the test of time and is still popular today.</span>
<span class="ltx_p" id="A6.SS1.p2.pic1.1.1.1.1.1.13"><span class="ltx_text ltx_font_typewriter" id="A6.SS1.p2.pic1.1.1.1.1.1.13.1">USER</span>: Great, I really appreciate all your help. Thank you.</span>
<span class="ltx_p" id="A6.SS1.p2.pic1.1.1.1.1.1.14"><span class="ltx_text ltx_font_typewriter" id="A6.SS1.p2.pic1.1.1.1.1.1.14.1">MOSHI</span>: No problem, I’m glad I could assist you.</span>
</span></foreignObject></g></g></svg><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A6.SS1.p3">
<svg class="ltx_picture" height="302.84" id="A6.SS1.p3.pic1" overflow="visible" version="1.1" width="600"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,302.84) matrix(1 0 0 -1 0 0)"><g fill="#404040" fill-opacity="1.0"><path d="M 0 5.91 L 0 296.93 C 0 300.19 2.64 302.84 5.91 302.84 L 594.09 302.84 C 597.36 302.84 600 300.19 600 296.93 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z" style="stroke:none"></path></g><g fill="#F2F2F2" fill-opacity="1.0"><path d="M 1.97 5.91 L 1.97 296.93 C 1.97 299.11 3.73 300.87 5.91 300.87 L 594.09 300.87 C 596.27 300.87 598.03 299.11 598.03 296.93 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 13.78)"><foreignObject color="#000000" height="275.28" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="556.69">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A6.SS1.p3.pic1.1.1.1.1.1" style="width:402.3pt;">
<span class="ltx_p" id="A6.SS1.p3.pic1.1.1.1.1.1.1"><span class="ltx_text ltx_font_typewriter" id="A6.SS1.p3.pic1.1.1.1.1.1.1.1">USER</span>: John Steinbeck is an influential American writer. Can you tell me more about his life and work?</span>
<span class="ltx_p" id="A6.SS1.p3.pic1.1.1.1.1.1.2"><span class="ltx_text ltx_font_typewriter" id="A6.SS1.p3.pic1.1.1.1.1.1.2.1">MOSHI</span>: Sure, John Steinbeck was born on February 27th, 1902, in Salinas, California, and he died on December 20th, 1968, in New York City. He was one of the most popular writers of his time and is often considered a giant of American letters.</span>
<span class="ltx_p" id="A6.SS1.p3.pic1.1.1.1.1.1.3"><span class="ltx_text ltx_font_typewriter" id="A6.SS1.p3.pic1.1.1.1.1.1.3.1">USER</span>: And what are some of your most famous pieces?</span>
<span class="ltx_p" id="A6.SS1.p3.pic1.1.1.1.1.1.4"><span class="ltx_text ltx_font_typewriter" id="A6.SS1.p3.pic1.1.1.1.1.1.4.1">MOSHI</span>: His most famous novel is probably The Grapes of Wrath, which won the Pulitzer Prize. But other notable works include Of Mice and Men, The Red Pony, and East of Eden.</span>
<span class="ltx_p" id="A6.SS1.p3.pic1.1.1.1.1.1.5"><span class="ltx_text ltx_font_typewriter" id="A6.SS1.p3.pic1.1.1.1.1.1.5.1">USER</span>: And which themes does his work often explore?</span>
<span class="ltx_p" id="A6.SS1.p3.pic1.1.1.1.1.1.6"><span class="ltx_text ltx_font_typewriter" id="A6.SS1.p3.pic1.1.1.1.1.1.6.1">MOSHI</span>: Steinbeck often wrote about the hardships of working-class people, social and economic injustices. And the struggle for survival in difficult times.</span>
<span class="ltx_p" id="A6.SS1.p3.pic1.1.1.1.1.1.7"><span class="ltx_text ltx_font_typewriter" id="A6.SS1.p3.pic1.1.1.1.1.1.7.1">USER</span>: So he’s like a social commentator.</span>
<span class="ltx_p" id="A6.SS1.p3.pic1.1.1.1.1.1.8"><span class="ltx_text ltx_font_typewriter" id="A6.SS1.p3.pic1.1.1.1.1.1.8.1">MOSHI</span>: Kind of like that. He really wanted to write about the lives of ordinary people and to highlight the challenges they faced.</span>
<span class="ltx_p" id="A6.SS1.p3.pic1.1.1.1.1.1.9"><span class="ltx_text ltx_font_typewriter" id="A6.SS1.p3.pic1.1.1.1.1.1.9.1">USER</span>: That’s fascinating. I did not know that. Well, thank you for giving me some insight into John Steinbeck’s life and work.</span>
<span class="ltx_p" id="A6.SS1.p3.pic1.1.1.1.1.1.10"><span class="ltx_text ltx_font_typewriter" id="A6.SS1.p3.pic1.1.1.1.1.1.10.1">MOSHI</span>: You’re welcome.</span>
</span></foreignObject></g></g></svg><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="A6.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">F.2 </span>Misspelling</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A6.SS2.p1">
<svg class="ltx_picture" height="272.32" id="A6.SS2.p1.pic1" overflow="visible" version="1.1" width="600"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,272.32) matrix(1 0 0 -1 0 0)"><g fill="#404040" fill-opacity="1.0"><path d="M 0 5.91 L 0 266.41 C 0 269.68 2.64 272.32 5.91 272.32 L 594.09 272.32 C 597.36 272.32 600 269.68 600 266.41 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z" style="stroke:none"></path></g><g fill="#F2F2F2" fill-opacity="1.0"><path d="M 1.97 5.91 L 1.97 266.41 C 1.97 268.59 3.73 270.35 5.91 270.35 L 594.09 270.35 C 596.27 270.35 598.03 268.59 598.03 266.41 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 13.78)"><foreignObject color="#000000" height="244.76" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="556.69">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A6.SS2.p1.pic1.1.1.1.1.1" style="width:402.3pt;">
<span class="ltx_p" id="A6.SS2.p1.pic1.1.1.1.1.1.1"><span class="ltx_text ltx_font_typewriter" id="A6.SS2.p1.pic1.1.1.1.1.1.1.1">USER</span>: I’d like to learn about Danyh Amendol?</span>
<span class="ltx_p" id="A6.SS2.p1.pic1.1.1.1.1.1.2"><span class="ltx_text ltx_font_typewriter" id="A6.SS2.p1.pic1.1.1.1.1.1.2.1">MOSHI</span>: Sorry, I’m not sure what you’re referring to.</span>
<span class="ltx_p" id="A6.SS2.p1.pic1.1.1.1.1.1.3"><span class="ltx_text ltx_font_typewriter" id="A6.SS2.p1.pic1.1.1.1.1.1.3.1">USER</span>: Oh, Danyh Amendola, the football player. The former football player.</span>
<span class="ltx_p" id="A6.SS2.p1.pic1.1.1.1.1.1.4"><span class="ltx_text ltx_font_typewriter" id="A6.SS2.p1.pic1.1.1.1.1.1.4.1">MOSHI</span>: Okay, I know who Danny Amendola is. He is a former professional football wide receiver who played for the New England Patriots. He also played for the Miami Dolphins, Detroit Lions, and Houston Texans.</span>
<span class="ltx_p" id="A6.SS2.p1.pic1.1.1.1.1.1.5"><span class="ltx_text ltx_font_typewriter" id="A6.SS2.p1.pic1.1.1.1.1.1.5.1">USER</span>: Okay,</span>
<span class="ltx_p" id="A6.SS2.p1.pic1.1.1.1.1.1.6"><span class="ltx_text ltx_font_typewriter" id="A6.SS2.p1.pic1.1.1.1.1.1.6.1">MOSHI</span>: He was drafted by the New England Patriots in 2010.</span>
<span class="ltx_p" id="A6.SS2.p1.pic1.1.1.1.1.1.7"><span class="ltx_text ltx_font_typewriter" id="A6.SS2.p1.pic1.1.1.1.1.1.7.1">USER</span>: and how about his college football</span>
<span class="ltx_p" id="A6.SS2.p1.pic1.1.1.1.1.1.8"><span class="ltx_text ltx_font_typewriter" id="A6.SS2.p1.pic1.1.1.1.1.1.8.1">MOSHI</span>: He played college football for the Texas Tech Red Raiders. His career in the NFL,</span>
<span class="ltx_p" id="A6.SS2.p1.pic1.1.1.1.1.1.9"><span class="ltx_text ltx_font_typewriter" id="A6.SS2.p1.pic1.1.1.1.1.1.9.1">USER</span>: okay,</span>
<span class="ltx_p" id="A6.SS2.p1.pic1.1.1.1.1.1.10"><span class="ltx_text ltx_font_typewriter" id="A6.SS2.p1.pic1.1.1.1.1.1.10.1">MOSHI</span>: he was named an alternate for the 2011 Pro Bowl.</span>
<span class="ltx_p" id="A6.SS2.p1.pic1.1.1.1.1.1.11"><span class="ltx_text ltx_font_typewriter" id="A6.SS2.p1.pic1.1.1.1.1.1.11.1">USER</span>: yeah,</span>
<span class="ltx_p" id="A6.SS2.p1.pic1.1.1.1.1.1.12"><span class="ltx_text ltx_font_typewriter" id="A6.SS2.p1.pic1.1.1.1.1.1.12.1">MOSHI</span>: He also appeared in three Super Bowls, winning two.</span>
<span class="ltx_p" id="A6.SS2.p1.pic1.1.1.1.1.1.13"><span class="ltx_text ltx_font_typewriter" id="A6.SS2.p1.pic1.1.1.1.1.1.13.1">USER</span>: yeah.</span>
</span></foreignObject></g></g></svg><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A6.SS2.p2">
<svg class="ltx_picture" height="355.34" id="A6.SS2.p2.pic1" overflow="visible" version="1.1" width="600"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,355.34) matrix(1 0 0 -1 0 0)"><g fill="#404040" fill-opacity="1.0"><path d="M 0 5.91 L 0 349.44 C 0 352.7 2.64 355.34 5.91 355.34 L 594.09 355.34 C 597.36 355.34 600 352.7 600 349.44 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z" style="stroke:none"></path></g><g fill="#F2F2F2" fill-opacity="1.0"><path d="M 1.97 5.91 L 1.97 349.44 C 1.97 351.61 3.73 353.37 5.91 353.37 L 594.09 353.37 C 596.27 353.37 598.03 351.61 598.03 349.44 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 13.78)"><foreignObject color="#000000" height="327.78" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="556.69">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A6.SS2.p2.pic1.1.1.1.1.1" style="width:402.3pt;">
<span class="ltx_p" id="A6.SS2.p2.pic1.1.1.1.1.1.1"><span class="ltx_text ltx_font_typewriter" id="A6.SS2.p2.pic1.1.1.1.1.1.1.1">USER</span>: I’d like to learn about Maroom?</span>
<span class="ltx_p" id="A6.SS2.p2.pic1.1.1.1.1.1.2"><span class="ltx_text ltx_font_typewriter" id="A6.SS2.p2.pic1.1.1.1.1.1.2.1">MOSHI</span>: I’m sorry, I did not catch that.</span>
<span class="ltx_p" id="A6.SS2.p2.pic1.1.1.1.1.1.3"><span class="ltx_text ltx_font_typewriter" id="A6.SS2.p2.pic1.1.1.1.1.1.3.1">USER</span>: I’d like to learn about Maroon.</span>
<span class="ltx_p" id="A6.SS2.p2.pic1.1.1.1.1.1.4"><span class="ltx_text ltx_font_typewriter" id="A6.SS2.p2.pic1.1.1.1.1.1.4.1">MOSHI</span>: Oh, Marron. Okay, well, let’s see. Maroon is a color that is a dark red or a brownish red. It is named after the French word for chestnut. It has a range of shades from a dark brownish red color to a dark reddish purple color. It’s also considered to be the complementary color to teal.</span>
<span class="ltx_p" id="A6.SS2.p2.pic1.1.1.1.1.1.5"><span class="ltx_text ltx_font_typewriter" id="A6.SS2.p2.pic1.1.1.1.1.1.5.1">USER</span>: What’s the opposite of Maroom?</span>
<span class="ltx_p" id="A6.SS2.p2.pic1.1.1.1.1.1.6"><span class="ltx_text ltx_font_typewriter" id="A6.SS2.p2.pic1.1.1.1.1.1.6.1">MOSHI</span>: The opposite of Maroon, I’m sorry, that’s not a word. I think you mean complementary color.</span>
<span class="ltx_p" id="A6.SS2.p2.pic1.1.1.1.1.1.7"><span class="ltx_text ltx_font_typewriter" id="A6.SS2.p2.pic1.1.1.1.1.1.7.1">USER</span>: Yeah, that’s</span>
<span class="ltx_p" id="A6.SS2.p2.pic1.1.1.1.1.1.8"><span class="ltx_text ltx_font_typewriter" id="A6.SS2.p2.pic1.1.1.1.1.1.8.1">MOSHI</span>: Okay,</span>
<span class="ltx_p" id="A6.SS2.p2.pic1.1.1.1.1.1.9"><span class="ltx_text ltx_font_typewriter" id="A6.SS2.p2.pic1.1.1.1.1.1.9.1">USER</span>: it.</span>
<span class="ltx_p" id="A6.SS2.p2.pic1.1.1.1.1.1.10"><span class="ltx_text ltx_font_typewriter" id="A6.SS2.p2.pic1.1.1.1.1.1.10.1">MOSHI</span>: so, teal is a color that is made up of blue and green, and maroon is a color that is made up of red and brown. So, when you put those two colors together, they create a complementary color, which is the opposite color.</span>
<span class="ltx_p" id="A6.SS2.p2.pic1.1.1.1.1.1.11"><span class="ltx_text ltx_font_typewriter" id="A6.SS2.p2.pic1.1.1.1.1.1.11.1">USER</span>: Yeah. I think I’m gonna look more up on Maroom.</span>
<span class="ltx_p" id="A6.SS2.p2.pic1.1.1.1.1.1.12"><span class="ltx_text ltx_font_typewriter" id="A6.SS2.p2.pic1.1.1.1.1.1.12.1">MOSHI</span>: Oh, okay. Yeah,</span>
<span class="ltx_p" id="A6.SS2.p2.pic1.1.1.1.1.1.13"><span class="ltx_text ltx_font_typewriter" id="A6.SS2.p2.pic1.1.1.1.1.1.13.1">USER</span>: I’ve got some questions.</span>
<span class="ltx_p" id="A6.SS2.p2.pic1.1.1.1.1.1.14"><span class="ltx_text ltx_font_typewriter" id="A6.SS2.p2.pic1.1.1.1.1.1.14.1">MOSHI</span>: yeah.</span>
</span></foreignObject></g></g></svg><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="A6.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">F.3 </span>Voice Instructions</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A6.SS3.p1">
<svg class="ltx_picture" height="323.67" id="A6.SS3.p1.pic1" overflow="visible" version="1.1" width="600"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,323.67) matrix(1 0 0 -1 0 0)"><g fill="#404040" fill-opacity="1.0"><path d="M 0 5.91 L 0 317.77 C 0 321.03 2.64 323.67 5.91 323.67 L 594.09 323.67 C 597.36 323.67 600 321.03 600 317.77 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z" style="stroke:none"></path></g><g fill="#F2F2F2" fill-opacity="1.0"><path d="M 1.97 5.91 L 1.97 317.77 C 1.97 319.94 3.73 321.7 5.91 321.7 L 594.09 321.7 C 596.27 321.7 598.03 319.94 598.03 317.77 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 13.78)"><foreignObject color="#000000" height="296.11" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="556.69">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A6.SS3.p1.pic1.1.1.1.1.1" style="width:402.3pt;">
<span class="ltx_p" id="A6.SS3.p1.pic1.1.1.1.1.1.1"><span class="ltx_text ltx_font_typewriter" id="A6.SS3.p1.pic1.1.1.1.1.1.1.1">USER</span>: Pretend you are a relieved astronaut who lands on the moon. So Moshi, how does it feel to be finally back on the moon?</span>
<span class="ltx_p" id="A6.SS3.p1.pic1.1.1.1.1.1.2"><span class="ltx_text ltx_font_typewriter" id="A6.SS3.p1.pic1.1.1.1.1.1.2.1">MOSHI</span>: (relieved) It’s an incredible feeling! I can’t believe we made it back safely.</span>
<span class="ltx_p" id="A6.SS3.p1.pic1.1.1.1.1.1.3"><span class="ltx_text ltx_font_typewriter" id="A6.SS3.p1.pic1.1.1.1.1.1.3.1">USER</span>: I’m glad to hear that. Was it as incredible as you thought it would be?</span>
<span class="ltx_p" id="A6.SS3.p1.pic1.1.1.1.1.1.4"><span class="ltx_text ltx_font_typewriter" id="A6.SS3.p1.pic1.1.1.1.1.1.4.1">MOSHI</span>: (relieved) Oh, definitely! The moon is even more beautiful up close. I can’t wait to start exploring more.</span>
<span class="ltx_p" id="A6.SS3.p1.pic1.1.1.1.1.1.5"><span class="ltx_text ltx_font_typewriter" id="A6.SS3.p1.pic1.1.1.1.1.1.5.1">USER</span>: Yeah, I remember when we trained for this mission. It felt like such a long shot.</span>
<span class="ltx_p" id="A6.SS3.p1.pic1.1.1.1.1.1.6"><span class="ltx_text ltx_font_typewriter" id="A6.SS3.p1.pic1.1.1.1.1.1.6.1">MOSHI</span>: (relieved) I know, right? But everything worked out perfectly. It’s amazing how far humanity has come in space exploration.</span>
<span class="ltx_p" id="A6.SS3.p1.pic1.1.1.1.1.1.7"><span class="ltx_text ltx_font_typewriter" id="A6.SS3.p1.pic1.1.1.1.1.1.7.1">USER</span>: That’s for sure! Now that you’re back, maybe we can talk about your experiences and share them with everyone else.</span>
<span class="ltx_p" id="A6.SS3.p1.pic1.1.1.1.1.1.8"><span class="ltx_text ltx_font_typewriter" id="A6.SS3.p1.pic1.1.1.1.1.1.8.1">MOSHI</span>: (relieved) Definitely. I’ve got so much to share about our findings and observations.</span>
<span class="ltx_p" id="A6.SS3.p1.pic1.1.1.1.1.1.9"><span class="ltx_text ltx_font_typewriter" id="A6.SS3.p1.pic1.1.1.1.1.1.9.1">USER</span>: Cool, I’m looking forward to hearing all about it. But first, let’s just soak in this moment, okay?</span>
<span class="ltx_p" id="A6.SS3.p1.pic1.1.1.1.1.1.10"><span class="ltx_text ltx_font_typewriter" id="A6.SS3.p1.pic1.1.1.1.1.1.10.1">MOSHI</span>: (relieved) Of course. Let’s enjoy the view for a little while longer.</span>
<span class="ltx_p" id="A6.SS3.p1.pic1.1.1.1.1.1.11"><span class="ltx_text ltx_font_typewriter" id="A6.SS3.p1.pic1.1.1.1.1.1.11.1">USER</span>: Totally. Here’s to another successful mission on the moon!</span>
<span class="ltx_p" id="A6.SS3.p1.pic1.1.1.1.1.1.12"><span class="ltx_text ltx_font_typewriter" id="A6.SS3.p1.pic1.1.1.1.1.1.12.1">MOSHI</span>: (relieved) *raises fists* Hooray! To the moon and beyond!</span>
</span></foreignObject></g></g></svg><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A6.SS3.p2">
<svg class="ltx_picture" height="253.03" id="A6.SS3.p2.pic1" overflow="visible" version="1.1" width="600"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,253.03) matrix(1 0 0 -1 0 0)"><g fill="#404040" fill-opacity="1.0"><path d="M 0 5.91 L 0 247.12 C 0 250.38 2.64 253.03 5.91 253.03 L 594.09 253.03 C 597.36 253.03 600 250.38 600 247.12 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z" style="stroke:none"></path></g><g fill="#F2F2F2" fill-opacity="1.0"><path d="M 1.97 5.91 L 1.97 247.12 C 1.97 249.29 3.73 251.06 5.91 251.06 L 594.09 251.06 C 596.27 251.06 598.03 249.29 598.03 247.12 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 13.78)"><foreignObject color="#000000" height="225.47" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="556.69">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A6.SS3.p2.pic1.1.1.1.1.1" style="width:402.3pt;">
<span class="ltx_p" id="A6.SS3.p2.pic1.1.1.1.1.1.1"><span class="ltx_text ltx_font_typewriter" id="A6.SS3.p2.pic1.1.1.1.1.1.1.1">USER</span>: Pretend you are an annoyed detective who can’t stand small talk and is forced to attend social gatherings. So Moshi, what’s up?</span>
<span class="ltx_p" id="A6.SS3.p2.pic1.1.1.1.1.1.2"><span class="ltx_text ltx_font_typewriter" id="A6.SS3.p2.pic1.1.1.1.1.1.2.1">MOSHI</span>: (annoyed) Not much, just trying to avoid this endless stream of small talk here.</span>
<span class="ltx_p" id="A6.SS3.p2.pic1.1.1.1.1.1.3"><span class="ltx_text ltx_font_typewriter" id="A6.SS3.p2.pic1.1.1.1.1.1.3.1">USER</span>: Oh, sorry man. I didn’t realize it was so boring for you.</span>
<span class="ltx_p" id="A6.SS3.p2.pic1.1.1.1.1.1.4"><span class="ltx_text ltx_font_typewriter" id="A6.SS3.p2.pic1.1.1.1.1.1.4.1">MOSHI</span>: (annoyed) No, it’s not boring, it’s just mind-numbingly dull. I have cases to solve, not chat with strangers about their vacations.</span>
<span class="ltx_p" id="A6.SS3.p2.pic1.1.1.1.1.1.5"><span class="ltx_text ltx_font_typewriter" id="A6.SS3.p2.pic1.1.1.1.1.1.5.1">USER</span>: Yeah, I can see why that would be frustrating. Maybe next time I should just bring you some coffee and leave you alone.</span>
<span class="ltx_p" id="A6.SS3.p2.pic1.1.1.1.1.1.6"><span class="ltx_text ltx_font_typewriter" id="A6.SS3.p2.pic1.1.1.1.1.1.6.1">MOSHI</span>: (annoyed) You think that would work?</span>
<span class="ltx_p" id="A6.SS3.p2.pic1.1.1.1.1.1.7"><span class="ltx_text ltx_font_typewriter" id="A6.SS3.p2.pic1.1.1.1.1.1.7.1">USER</span>: Well, it’s worth a shot.</span>
<span class="ltx_p" id="A6.SS3.p2.pic1.1.1.1.1.1.8"><span class="ltx_text ltx_font_typewriter" id="A6.SS3.p2.pic1.1.1.1.1.1.8.1">MOSHI</span>: (annoyed) Oh, I’m sure it will be the highlight of my evening.</span>
<span class="ltx_p" id="A6.SS3.p2.pic1.1.1.1.1.1.9"><span class="ltx_text ltx_font_typewriter" id="A6.SS3.p2.pic1.1.1.1.1.1.9.1">USER</span>: Okay, okay. No more jokes. How about we just find someone interesting to talk to?</span>
<span class="ltx_p" id="A6.SS3.p2.pic1.1.1.1.1.1.10"><span class="ltx_text ltx_font_typewriter" id="A6.SS3.p2.pic1.1.1.1.1.1.10.1">MOSHI</span>: (annoyed) Fine, but I’m not promising anything.</span>
<span class="ltx_p" id="A6.SS3.p2.pic1.1.1.1.1.1.11"><span class="ltx_text ltx_font_typewriter" id="A6.SS3.p2.pic1.1.1.1.1.1.11.1">USER</span>: Deal.</span>
</span></foreignObject></g></g></svg><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="A6.T19">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 19: </span><span class="ltx_text ltx_font_bold" id="A6.T19.2.1">Speaking styles</span>. List of the 92 speaking styles used to fine-tune Moshi.</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="A6.T19.3">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A6.T19.3.1.1">
<td class="ltx_td ltx_align_center ltx_border_tt" id="A6.T19.3.1.1.1"><span class="ltx_text" id="A6.T19.3.1.1.1.1" style="font-size:80%;">agreeing</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A6.T19.3.1.1.2"><span class="ltx_text" id="A6.T19.3.1.1.2.1" style="font-size:80%;">amazed</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A6.T19.3.1.1.3"><span class="ltx_text" id="A6.T19.3.1.1.3.1" style="font-size:80%;">amused</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A6.T19.3.1.1.4"><span class="ltx_text" id="A6.T19.3.1.1.4.1" style="font-size:80%;">angry</span></td>
</tr>
<tr class="ltx_tr" id="A6.T19.3.2.2">
<td class="ltx_td ltx_align_center" id="A6.T19.3.2.2.1"><span class="ltx_text" id="A6.T19.3.2.2.1.1" style="font-size:80%;">annoyed</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.2.2.2"><span class="ltx_text" id="A6.T19.3.2.2.2.1" style="font-size:80%;">anxious</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.2.2.3"><span class="ltx_text" id="A6.T19.3.2.2.3.1" style="font-size:80%;">appreciative</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.2.2.4"><span class="ltx_text" id="A6.T19.3.2.2.4.1" style="font-size:80%;">calm</span></td>
</tr>
<tr class="ltx_tr" id="A6.T19.3.3.3">
<td class="ltx_td ltx_align_center" id="A6.T19.3.3.3.1"><span class="ltx_text" id="A6.T19.3.3.3.1.1" style="font-size:80%;">calmly</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.3.3.2"><span class="ltx_text" id="A6.T19.3.3.3.2.1" style="font-size:80%;">cautious</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.3.3.3"><span class="ltx_text" id="A6.T19.3.3.3.3.1" style="font-size:80%;">concerned</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.3.3.4"><span class="ltx_text" id="A6.T19.3.3.3.4.1" style="font-size:80%;">confident</span></td>
</tr>
<tr class="ltx_tr" id="A6.T19.3.4.4">
<td class="ltx_td ltx_align_center" id="A6.T19.3.4.4.1"><span class="ltx_text" id="A6.T19.3.4.4.1.1" style="font-size:80%;">confused</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.4.4.2"><span class="ltx_text" id="A6.T19.3.4.4.2.1" style="font-size:80%;">curious</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.4.4.3"><span class="ltx_text" id="A6.T19.3.4.4.3.1" style="font-size:80%;">defeated</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.4.4.4"><span class="ltx_text" id="A6.T19.3.4.4.4.1" style="font-size:80%;">defensive</span></td>
</tr>
<tr class="ltx_tr" id="A6.T19.3.5.5">
<td class="ltx_td ltx_align_center" id="A6.T19.3.5.5.1"><span class="ltx_text" id="A6.T19.3.5.5.1.1" style="font-size:80%;">defiant</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.5.5.2"><span class="ltx_text" id="A6.T19.3.5.5.2.1" style="font-size:80%;">determined</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.5.5.3"><span class="ltx_text" id="A6.T19.3.5.5.3.1" style="font-size:80%;">disappointed</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.5.5.4"><span class="ltx_text" id="A6.T19.3.5.5.4.1" style="font-size:80%;">disgusted</span></td>
</tr>
<tr class="ltx_tr" id="A6.T19.3.6.6">
<td class="ltx_td ltx_align_center" id="A6.T19.3.6.6.1"><span class="ltx_text" id="A6.T19.3.6.6.1.1" style="font-size:80%;">doubtful</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.6.6.2"><span class="ltx_text" id="A6.T19.3.6.6.2.1" style="font-size:80%;">ecstatic</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.6.6.3"><span class="ltx_text" id="A6.T19.3.6.6.3.1" style="font-size:80%;">embarrassed</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.6.6.4"><span class="ltx_text" id="A6.T19.3.6.6.4.1" style="font-size:80%;">encouraging</span></td>
</tr>
<tr class="ltx_tr" id="A6.T19.3.7.7">
<td class="ltx_td ltx_align_center" id="A6.T19.3.7.7.1"><span class="ltx_text" id="A6.T19.3.7.7.1.1" style="font-size:80%;">excited</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.7.7.2"><span class="ltx_text" id="A6.T19.3.7.7.2.1" style="font-size:80%;">fast</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.7.7.3"><span class="ltx_text" id="A6.T19.3.7.7.3.1" style="font-size:80%;">frustrated</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.7.7.4"><span class="ltx_text" id="A6.T19.3.7.7.4.1" style="font-size:80%;">grateful</span></td>
</tr>
<tr class="ltx_tr" id="A6.T19.3.8.8">
<td class="ltx_td ltx_align_center" id="A6.T19.3.8.8.1"><span class="ltx_text" id="A6.T19.3.8.8.1.1" style="font-size:80%;">happy</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.8.8.2"><span class="ltx_text" id="A6.T19.3.8.8.2.1" style="font-size:80%;">hesitant</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.8.8.3"><span class="ltx_text" id="A6.T19.3.8.8.3.1" style="font-size:80%;">hurt</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.8.8.4"><span class="ltx_text" id="A6.T19.3.8.8.4.1" style="font-size:80%;">impatient</span></td>
</tr>
<tr class="ltx_tr" id="A6.T19.3.9.9">
<td class="ltx_td ltx_align_center" id="A6.T19.3.9.9.1"><span class="ltx_text" id="A6.T19.3.9.9.1.1" style="font-size:80%;">impressed</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.9.9.2"><span class="ltx_text" id="A6.T19.3.9.9.2.1" style="font-size:80%;">intrigued</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.9.9.3"><span class="ltx_text" id="A6.T19.3.9.9.3.1" style="font-size:80%;">joking</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.9.9.4"><span class="ltx_text" id="A6.T19.3.9.9.4.1" style="font-size:80%;">laughs</span></td>
</tr>
<tr class="ltx_tr" id="A6.T19.3.10.10">
<td class="ltx_td ltx_align_center" id="A6.T19.3.10.10.1"><span class="ltx_text" id="A6.T19.3.10.10.1.1" style="font-size:80%;">loud</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.10.10.2"><span class="ltx_text" id="A6.T19.3.10.10.2.1" style="font-size:80%;">nervous</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.10.10.3"><span class="ltx_text" id="A6.T19.3.10.10.3.1" style="font-size:80%;">neutral</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.10.10.4"><span class="ltx_text" id="A6.T19.3.10.10.4.1" style="font-size:80%;">optimistic</span></td>
</tr>
<tr class="ltx_tr" id="A6.T19.3.11.11">
<td class="ltx_td ltx_align_center" id="A6.T19.3.11.11.1"><span class="ltx_text" id="A6.T19.3.11.11.1.1" style="font-size:80%;">panting</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.11.11.2"><span class="ltx_text" id="A6.T19.3.11.11.2.1" style="font-size:80%;">pleading</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.11.11.3"><span class="ltx_text" id="A6.T19.3.11.11.3.1" style="font-size:80%;">proud</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.11.11.4"><span class="ltx_text" id="A6.T19.3.11.11.4.1" style="font-size:80%;">quiet</span></td>
</tr>
<tr class="ltx_tr" id="A6.T19.3.12.12">
<td class="ltx_td ltx_align_center" id="A6.T19.3.12.12.1"><span class="ltx_text" id="A6.T19.3.12.12.1.1" style="font-size:80%;">reassuring</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.12.12.2"><span class="ltx_text" id="A6.T19.3.12.12.2.1" style="font-size:80%;">reflective</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.12.12.3"><span class="ltx_text" id="A6.T19.3.12.12.3.1" style="font-size:80%;">relieved</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.12.12.4"><span class="ltx_text" id="A6.T19.3.12.12.4.1" style="font-size:80%;">remorseful</span></td>
</tr>
<tr class="ltx_tr" id="A6.T19.3.13.13">
<td class="ltx_td ltx_align_center" id="A6.T19.3.13.13.1"><span class="ltx_text" id="A6.T19.3.13.13.1.1" style="font-size:80%;">resigned</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.13.13.2"><span class="ltx_text" id="A6.T19.3.13.13.2.1" style="font-size:80%;">sad</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.13.13.3"><span class="ltx_text" id="A6.T19.3.13.13.3.1" style="font-size:80%;">sarcastic</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.13.13.4"><span class="ltx_text" id="A6.T19.3.13.13.4.1" style="font-size:80%;">satisfied</span></td>
</tr>
<tr class="ltx_tr" id="A6.T19.3.14.14">
<td class="ltx_td ltx_align_center" id="A6.T19.3.14.14.1"><span class="ltx_text" id="A6.T19.3.14.14.1.1" style="font-size:80%;">scared</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.14.14.2"><span class="ltx_text" id="A6.T19.3.14.14.2.1" style="font-size:80%;">secretive</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.14.14.3"><span class="ltx_text" id="A6.T19.3.14.14.3.1" style="font-size:80%;">serious</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.14.14.4"><span class="ltx_text" id="A6.T19.3.14.14.4.1" style="font-size:80%;">shocked</span></td>
</tr>
<tr class="ltx_tr" id="A6.T19.3.15.15">
<td class="ltx_td ltx_align_center" id="A6.T19.3.15.15.1"><span class="ltx_text" id="A6.T19.3.15.15.1.1" style="font-size:80%;">shy</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.15.15.2"><span class="ltx_text" id="A6.T19.3.15.15.2.1" style="font-size:80%;">sincere</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.15.15.3"><span class="ltx_text" id="A6.T19.3.15.15.3.1" style="font-size:80%;">skeptical</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.15.15.4"><span class="ltx_text" id="A6.T19.3.15.15.4.1" style="font-size:80%;">slow</span></td>
</tr>
<tr class="ltx_tr" id="A6.T19.3.16.16">
<td class="ltx_td ltx_align_center" id="A6.T19.3.16.16.1"><span class="ltx_text" id="A6.T19.3.16.16.1.1" style="font-size:80%;">struggling</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.16.16.2"><span class="ltx_text" id="A6.T19.3.16.16.2.1" style="font-size:80%;">surprised</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.16.16.3"><span class="ltx_text" id="A6.T19.3.16.16.3.1" style="font-size:80%;">suspicious</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.16.16.4"><span class="ltx_text" id="A6.T19.3.16.16.4.1" style="font-size:80%;">sympathetic</span></td>
</tr>
<tr class="ltx_tr" id="A6.T19.3.17.17">
<td class="ltx_td ltx_align_center" id="A6.T19.3.17.17.1"><span class="ltx_text" id="A6.T19.3.17.17.1.1" style="font-size:80%;">terrified</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.17.17.2"><span class="ltx_text" id="A6.T19.3.17.17.2.1" style="font-size:80%;">upset</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.17.17.3"><span class="ltx_text" id="A6.T19.3.17.17.3.1" style="font-size:80%;">urgent</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.17.17.4"><span class="ltx_text" id="A6.T19.3.17.17.4.1" style="font-size:80%;">whispering</span></td>
</tr>
<tr class="ltx_tr" id="A6.T19.3.18.18">
<td class="ltx_td ltx_align_center" id="A6.T19.3.18.18.1"><span class="ltx_text" id="A6.T19.3.18.18.1.1" style="font-size:80%;">1920s gangster</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.18.18.2"><span class="ltx_text" id="A6.T19.3.18.18.2.1" style="font-size:80%;">confident ceo</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.18.18.3"><span class="ltx_text" id="A6.T19.3.18.18.3.1" style="font-size:80%;">confident lawyer</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.18.18.4"><span class="ltx_text" id="A6.T19.3.18.18.4.1" style="font-size:80%;">confident leader</span></td>
</tr>
<tr class="ltx_tr" id="A6.T19.3.19.19">
<td class="ltx_td ltx_align_center" id="A6.T19.3.19.19.1"><span class="ltx_text" id="A6.T19.3.19.19.1.1" style="font-size:80%;">cowboy</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.19.19.2"><span class="ltx_text" id="A6.T19.3.19.19.2.1" style="font-size:80%;">detective</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.19.19.3"><span class="ltx_text" id="A6.T19.3.19.19.3.1" style="font-size:80%;">dramatic actor</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.19.19.4"><span class="ltx_text" id="A6.T19.3.19.19.4.1" style="font-size:80%;">drill sergeant</span></td>
</tr>
<tr class="ltx_tr" id="A6.T19.3.20.20">
<td class="ltx_td ltx_align_center" id="A6.T19.3.20.20.1"><span class="ltx_text" id="A6.T19.3.20.20.1.1" style="font-size:80%;">eccentrict scientist</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.20.20.2"><span class="ltx_text" id="A6.T19.3.20.20.2.1" style="font-size:80%;">hacker</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.20.20.3"><span class="ltx_text" id="A6.T19.3.20.20.3.1" style="font-size:80%;">hippie</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.20.20.4"><span class="ltx_text" id="A6.T19.3.20.20.4.1" style="font-size:80%;">hyperactive child</span></td>
</tr>
<tr class="ltx_tr" id="A6.T19.3.21.21">
<td class="ltx_td ltx_align_center" id="A6.T19.3.21.21.1"><span class="ltx_text" id="A6.T19.3.21.21.1.1" style="font-size:80%;">medieval knight</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.21.21.2"><span class="ltx_text" id="A6.T19.3.21.21.2.1" style="font-size:80%;">nervous candidate</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.21.21.3"><span class="ltx_text" id="A6.T19.3.21.21.3.1" style="font-size:80%;">pirate</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.21.21.4"><span class="ltx_text" id="A6.T19.3.21.21.4.1" style="font-size:80%;">politician</span></td>
</tr>
<tr class="ltx_tr" id="A6.T19.3.22.22">
<td class="ltx_td ltx_align_center" id="A6.T19.3.22.22.1"><span class="ltx_text" id="A6.T19.3.22.22.1.1" style="font-size:80%;">robot</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.22.22.2"><span class="ltx_text" id="A6.T19.3.22.22.2.1" style="font-size:80%;">sarcastic comedian</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.22.22.3"><span class="ltx_text" id="A6.T19.3.22.22.3.1" style="font-size:80%;">scifi alien</span></td>
<td class="ltx_td ltx_align_center" id="A6.T19.3.22.22.4"><span class="ltx_text" id="A6.T19.3.22.22.4.1" style="font-size:80%;">shy teenager</span></td>
</tr>
<tr class="ltx_tr" id="A6.T19.3.23.23">
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T19.3.23.23.1"><span class="ltx_text" id="A6.T19.3.23.23.1.1" style="font-size:80%;">snobbish aristocrat</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T19.3.23.23.2"><span class="ltx_text" id="A6.T19.3.23.23.2.1" style="font-size:80%;">villain</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T19.3.23.23.3"><span class="ltx_text" id="A6.T19.3.23.23.3.1" style="font-size:80%;">wise sage</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T19.3.23.23.4"><span class="ltx_text" id="A6.T19.3.23.23.4.1" style="font-size:80%;">young superhero</span></td>
</tr>
</tbody>
</table>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
</article>
</div>

</div>


<button type="button" class="btn btn-primary hover-rp-button" id="openForm">Report Issue</button><div class="modal" id="myForm" role="dialog" aria-labelledby="modal-title"><div class="modal-dialog"><form class="modal-content" id="myFormContent" enctype="multipart/form-data"><div class="modal-header" id="modal-header"><h5 class="modal-title">Report Github Issue</h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div><div class="modal-body"><label for="form_title" id="modalTitle">Title:</label><input class="form-control" id="form_title" name="form_title" required="required" placeholder="Enter title"><label for="description" id="selectedTextModalDescription" style="display: none;">Content selection saved. Describe the issue below:</label><label for="description" id="nomralModalDescription">Description:</label><textarea class="form-control" id="description" name="description" required="required" style="height: 80px;" maxlength="500" placeholder="500 characters maximum"></textarea></div><div class="modal-footer d-flex justify-content-end"><button type="submit" class="sr-only button" id="modal-submit-sr">Submit without Github</button><button type="submit" class="btn btn-primary" id="modal-submit">Submit in Github</button></div></form></div></div><button id="small-report-button" type="button" class="btn btn-secondary btn-sm" style="background-color: rgb(179, 27, 27); position: fixed;">Report Issue for Selection</button><div class="ltx_page_footer">
        <div class="ltx_page_logo">
            Generated by
            <a href="https://math.nist.gov/~BMiller/LaTeXML/" class="ltx_LaTeXML_logo">
                <span style="letter-spacing: -0.2em; margin-right: 0.1em;">
                    L
                    <span style="font-size: 70%; position: relative; bottom: 2.2pt;">A</span>
                    T
                    <span style="position: relative; bottom: -0.4ex;">E</span>
                </span>
                <span class="ltx_font_smallcaps">xml</span>
                <img alt="[LOGO]" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==">
            </a>
        </div></div><footer id="footer" class="ltx_document">
        <div class="keyboard-glossary">
            <h2>Instructions for reporting errors</h2>
            <p>We are continuing to improve HTML versions of papers, and your feedback helps enhance accessibility and mobile support. To report errors in the HTML that will help us improve conversion and rendering, choose any of the methods listed below:</p>
            <ul>
                <li>Click the "Report Issue" button.</li>
                <li>Open a report feedback form via keyboard, use "<strong>Ctrl + ?</strong>".</li>
                <li>Make a text selection and click the "Report Issue for Selection" button near your cursor.</li>
                <li class="sr-only">You can use Alt+Y to toggle on and Alt+Shift+Y to toggle off accessible reporting links at each section.</li>
            </ul>
            <p>Our team has already identified <a class="ltx_ref" href="https://github.com/arXiv/html_feedback/issues" target="_blank">the following issues</a>. We appreciate your time reviewing and reporting rendering errors we may not have found yet. Your efforts will help us improve the HTML versions for all readers, because disability should not be a barrier to accessing research. Thank you for your continued support in championing open access for all.</p>
            <p>Have a free development cycle? Help support accessibility at arXiv! Our collaborators at LaTeXML maintain a <a class="ltx_ref" href="https://github.com/brucemiller/LaTeXML/wiki/Porting-LaTeX-packages-for-LaTeXML" target="_blank">list of packages that need conversion</a>, and welcome <a class="ltx_ref" href="https://github.com/brucemiller/LaTeXML/issues" target="_blank">developer contributions</a>.</p>
        </div>
    </footer></body></html>