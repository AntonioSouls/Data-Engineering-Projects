<!DOCTYPE html><html lang="en" data-theme="light"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<title>SELU: Self-Learning Embodied MLLMs in Unknown Environments</title>
<!--Generated on Fri Oct  4 10:39:58 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="https://arxiv.org/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css">
<link href="https://arxiv.org/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css">
<link href="https://arxiv.org/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css">




<base href="https://arxiv.org/html/2410.03303v1/"><link rel="stylesheet" href="https://use.typekit.net/rwr5zpx.css"><link rel="icon" type="image/png" href="https://static.arxiv.org/static/browse/0.3.4/images/icons/favicon-16x16.png" sizes="16x16"><link rel="icon" type="image/png" href="https://static.arxiv.org/static/browse/0.3.4/images/icons/favicon-32x32.png" sizes="32x32"></head>
<body><header class="mob_header">
    <div class="html-header-logo">
      <a href="https://arxiv.org/">
        <img alt="logo" class="logomark" role="presentation" width="100" src="https://services.dev.arxiv.org/html/static/arxiv-logomark-small-white.svg">
        <span class="sr-only">Back to arXiv</span>
      </a>
    </div>

    <!--TOC, dark mode, links-->
    <div class="html-header-nav">
      <!--back to abstract-->
      
        <a class="nav-link ar5iv-footer-button hover-effect" aria-label="Back to abstract page" href="https://arxiv.org/abs/2410.03303v1">
        <svg xmlns="http://www.w3.org/2000/svg" height="1.25em" viewBox="0 0 512 512" fill="#ffffff" aria-hidden="true">
            <path d="M502.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L402.7 224 192 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l210.7 0-73.4 73.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l128-128zM160 96c17.7 0 32-14.3 32-32s-14.3-32-32-32L96 32C43 32 0 75 0 128L0 384c0 53 43 96 96 96l64 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-64 0c-17.7 0-32-14.3-32-32l0-256c0-17.7 14.3-32 32-32l64 0z"></path>
        </svg>
        </a>
      <!--dark mode-->
      <a class="ar5iv-toggle-color-scheme" title="Toggle dark/light mode" aria-label="System preference">
        <label id="automatic-tog" class="toggle-icon" title="Switch to light mode" for="__palette_3">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"></path></svg>
        </label>
        
        
      </a>
      <!--nav-->
      <button class="navbar-toggler ar5iv-footer-button" type="button" data-bs-theme="dark" data-bs-toggle="collapse" aria-expanded="false" data-bs-target=".ltx_page_main >.ltx_TOC.mobile" aria-controls="navbarSupportedContent" aria-label="Toggle navigation" style="border:none; margin-right: 0em;">
        <svg xmlns="http://www.w3.org/2000/svg" height="1.25em" viewBox="0 0 448 512" aria-hidden="true" role="img" fill="#ffffff"><path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"></path></svg>
      </button>
    </div>
    </header><header class="desktop_header">
    <div class="html-header-logo">
      <a href="https://arxiv.org/">
          <img alt="logo" class="logo" role="presentation" width="100" src="https://services.dev.arxiv.org/html/static/arxiv-logo-one-color-white.svg">
          <span class="sr-only">Back to arXiv</span>
      </a>
    </div>
    <div class="html-header-message" role="banner">
        <p>This is <strong>experimental HTML</strong> to improve accessibility. We invite you to report rendering errors. <span class="sr-only">Use Alt+Y to toggle on accessible reporting links and Alt+Shift+Y to toggle off.</span> Learn more <a href="https://info.arxiv.org/about/accessible_HTML.html" target="_blank">about this project</a> and <a href="https://info.arxiv.org/help/submit_latex_best_practices.html" target="_blank">help improve conversions</a>.
        </p>
    </div>
    <nav class="html-header-nav">
      <a class="ar5iv-footer-button hover-effect" href="https://info.arxiv.org/about/accessible_HTML.html" target="_blank">Why HTML?</a>
      <a class="ar5iv-footer-button hover-effect" target="_blank" href="https://arxiv.org/html/2410.03303v1/#myForm">Report Issue</a>
      <a class="ar5iv-footer-button hover-effect" href="https://arxiv.org/abs/2410.03303v1">Back to Abstract</a>
      <a class="ar5iv-footer-button hover-effect" href="https://arxiv.org/pdf/2410.03303v1" target="_blank">Download PDF</a>
      <a class="ar5iv-toggle-color-scheme" title="Toggle dark/light mode">
        <label id="automatic-tog" class="toggle-icon" title="Switch to light mode" for="__palette_3">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"></path></svg>
        </label>
        
        
      </a>
    </nav></header>

<div class="ltx_page_main" id="main">
<nav class="ltx_TOC active" aria-labelledby="toc_header"><h2 id="toc_header" class="sr-only">Table of Contents</h2>

      <div id="listIcon" type="button" class="hide">
          <svg width="17px" height="17px" viewBox="0 0 512 512" style="pointer-events: none;">
          <path d="M40 48C26.7 48 16 58.7 16 72v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V72c0-13.3-10.7-24-24-24H40zM192 64c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zM16 232v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V232c0-13.3-10.7-24-24-24H40c-13.3 0-24 10.7-24 24zM40 368c-13.3 0-24 10.7-24 24v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V392c0-13.3-10.7-24-24-24H40z"></path>
          </svg>
      </div>
      <div id="arrowIcon" type="button">
          <svg width="17px" height="17px" viewBox="0 0 448 512" style="pointer-events: none;">
          <path d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.2 288 416 288c17.7 0 32-14.3 32-32s-14.3-32-32-32l-306.7 0L214.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"></path>
          </svg>
      </div><ol class="ltx_toclist"><li class="ltx_tocentry ltx_tocentry_section">
    <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#abstract" title="Abstract">
      <span class="ltx_text ltx_ref_title">
        <span class="ltx_tag ltx_tag_ref"></span>
        Abstract
      </span>
    </a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#S1" title="In SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#S2" title="In SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#S2.SS1" title="In 2 Related Work ‣ SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>MLLMs with External Feedback</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#S2.SS2" title="In 2 Related Work ‣ SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Self-Improvement in LLMs</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#S3" title="In SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Preliminaries</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#S3.SS1" title="In 3 Preliminaries ‣ SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Actor-Critic in Reinforcement Learning</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#S3.SS2" title="In 3 Preliminaries ‣ SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Actor-Critic for MLLMs</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#S4" title="In SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Method</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#S4.SS1" title="In 4 Method ‣ SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Critic: Self-Asking and Hindsight Relabeling</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#S4.SS2" title="In 4 Method ‣ SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Actor: Critic-Guided Improvement</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#S4.SS3" title="In 4 Method ‣ SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Actor-Critic Coupling Improvement</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#S5" title="In SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#S5.SS1" title="In 5 Experiments ‣ SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Experimental Setup</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#S5.SS2" title="In 5 Experiments ‣ SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>AI2-THOR</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#S5.SS3" title="In 5 Experiments ‣ SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>VirtualHome</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#S5.SS4" title="In 5 Experiments ‣ SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.4 </span>Ablation Study</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#S5.SS5" title="In 5 Experiments ‣ SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.5 </span>Hyperparameter Analysis</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#S6" title="In SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusion and Limitation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#A1" title="In SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Appendix</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#A1.SS1" title="In Appendix A Appendix ‣ SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1 </span>Pseudocode of SELU</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#A1.SS2" title="In Appendix A Appendix ‣ SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2 </span>Implementation Details</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#A1.SS2.SSS1" title="In A.2 Implementation Details ‣ Appendix A Appendix ‣ SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2.1 </span>Environment Details</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#A1.SS2.SSS2" title="In A.2 Implementation Details ‣ Appendix A Appendix ‣ SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2.2 </span>MLLM Details</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#A1.SS3" title="In Appendix A Appendix ‣ SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.3 </span>Visualization of Actor and Critic on LLaVA in AI2-THOR</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#A1.SS4" title="In Appendix A Appendix ‣ SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.4 </span>Prompts for SELU</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
    <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib" title="References">
      <span class="ltx_text ltx_ref_title">
        <span class="ltx_tag ltx_tag_ref"></span>
        References
      </span>
    </a></li></ol></nav>

<div class="ltx_page_content"><div class="package-alerts ltx_document" role="status" aria-label="Conversion errors have been found">
      <button aria-label="Dismiss alert">
          <span aria-hidden="true"><svg role="presentation" width="20" height="20" viewBox="0 0 44 44" aria-hidden="true" focusable="false">
          <path d="M0.549989 4.44999L4.44999 0.549988L43.45 39.55L39.55 43.45L0.549989 4.44999Z"></path>
          <path d="M39.55 0.549988L43.45 4.44999L4.44999 43.45L0.549988 39.55L39.55 0.549988Z"></path>
          </svg></span>
      </button>
      <p>HTML conversions <a href="https://info.dev.arxiv.org/about/accessibility_html_error_messages.html" target="_blank">sometimes display errors</a> due to content that did not convert correctly from the source. This paper uses the following packages that are not yet supported by the HTML conversion tool. Feedback on these issues are not necessary; they are known and are being worked on.</p>
          <ul arial-label="Unsupported packages used in this paper">
              <li>failed: CJK</li>
          </ul>
      <p>Authors: achieve the best HTML results from your LaTeX submissions by following these <a href="https://info.arxiv.org/help/submit_latex_best_practices.html" target="_blank">best practices</a>.</p>
    </div><div id="target-section" class="section"><a id="license-tr" href="https://info.arxiv.org/help/license/index.html#licenses-available">License: arXiv.org perpetual non-exclusive license</a><div id="watermark-tr">arXiv:2410.03303v1 [cs.LG] 04 Oct 2024</div></div>
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">SELU: Self-Learning Embodied MLLMs in Unknown Environments</h1><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Boyu Li<sup class="ltx_sup" id="id13.13.id1"><span class="ltx_text ltx_font_italic" id="id13.13.id1.1">1,2,3</span></sup>, Haobin Jiang<sup class="ltx_sup" id="id14.14.id2"><span class="ltx_text ltx_font_italic" id="id14.14.id2.1">4</span></sup>, &nbsp;Ziluo Ding<sup class="ltx_sup" id="id15.15.id3"><span class="ltx_text ltx_font_italic" id="id15.15.id3.1">3</span></sup>, Xinrun Xu<sup class="ltx_sup" id="id16.16.id4"><span class="ltx_text ltx_font_italic" id="id16.16.id4.1">5,2</span></sup>, Haoran Li<sup class="ltx_sup" id="id17.17.id5"><span class="ltx_text ltx_font_italic" id="id17.17.id5.1">1,2</span></sup>, 
<br class="ltx_break"><span class="ltx_text ltx_font_bold" id="id7.7.2">Dongbin Zhao<sup class="ltx_sup" id="id7.7.2.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="id7.7.2.1.1">1,2</span></sup>, Zongqing Lu<sup class="ltx_sup" id="id7.7.2.2"><span class="ltx_text ltx_font_medium ltx_font_italic" id="id7.7.2.2.1">4</span></sup></span>
<br class="ltx_break"><sup class="ltx_sup" id="id18.18.id6">1</sup>Institute of Automation, Chinese Academy of Sciences 
<br class="ltx_break"><sup class="ltx_sup" id="id19.19.id7">2</sup>School of Artificial Intelligence, University of Chinese Academy of Sciences 
<br class="ltx_break"><sup class="ltx_sup" id="id20.20.id8">3</sup>Beijing Academy of Artificial Intelligence 
<br class="ltx_break"><sup class="ltx_sup" id="id21.21.id9">4</sup>School of Computer Science, Peking University 
<br class="ltx_break"><sup class="ltx_sup" id="id22.22.id10">5</sup>Institute of Software, Chinese Academy of Sciences
</span><span class="ltx_author_notes">Haobin Jiang and Xinrun Xu work as interns at BAAICorrespondence to Zongqing Lu &lt;zongqing.lu@pku.edu.cn&gt;.</span></span>
</div><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_abstract" id="abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<p class="ltx_p" id="id23.id1">Recently, multimodal large language models (MLLMs) have demonstrated strong visual understanding and decision-making capabilities, enabling the exploration of autonomously improving MLLMs in unknown environments. However, external feedback like human or environmental feedback is not always available. To address this challenge, existing methods primarily focus on enhancing the decision-making capabilities of MLLMs through voting and scoring mechanisms, while little effort has been paid to improving the environmental comprehension of MLLMs in unknown environments. To fully unleash the self-learning potential of MLLMs, we propose a novel actor-critic self-learning paradigm, dubbed SELU, inspired by the actor-critic paradigm in reinforcement learning. The critic employs self-asking and hindsight relabeling to extract knowledge from interaction trajectories collected by the actor, thereby augmenting its environmental comprehension. Simultaneously, the actor is improved by the self-feedback provided by the critic, enhancing its decision-making. We evaluate our method in the AI2-THOR and VirtualHome environments, and SELU achieves critic improvements of approximately 28% and 30%, and actor improvements of about 20% and 24% via self-learning.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Multimodal Large Language Models (MLLMs) have demonstrated impressive perceptual and understanding capabilities across various domains, <em class="ltx_emph ltx_font_italic" id="S1.p1.1.1">e.g., </em>web applications <cite class="ltx_cite ltx_citemacro_citep">(Ma et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib28" title="">2024</a>; Tao et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib48" title="">2024</a>; Liu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib26" title="">2024</a>)</cite>, robotics <cite class="ltx_cite ltx_citemacro_citep">(Xiong et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib57" title="">2024</a>; Li et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib22" title="">2024b</a>)</cite>, gaming <cite class="ltx_cite ltx_citemacro_citep">(Li et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib23" title="">2024c</a>; Qi et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib36" title="">2024</a>; Xu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib59" title="">2024</a>)</cite>, and autonomous driving <cite class="ltx_cite ltx_citemacro_citep">(Wen et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib55" title="">2024</a>; Zhang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib62" title="">2024</a>)</cite>. Thanks to their powerful capabilities, many works, <em class="ltx_emph ltx_font_italic" id="S1.p1.1.2">e.g., </em>Jarvis-1 <cite class="ltx_cite ltx_citemacro_citep">(Wang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib53" title="">2023b</a>)</cite>, STEVE-1 <cite class="ltx_cite ltx_citemacro_citep">(Lifshitz et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib24" title="">2023</a>)</cite>, and Cradle <cite class="ltx_cite ltx_citemacro_citep">(Tan et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib45" title="">2024b</a>)</cite>, directly utilize the pre-trained MLLMs to complete various decision-making tasks in different embodied environments.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">However, the generalization ability of existing pre-trained MLLMs cannot meet the needs of all environments. For some uncommon environments, embodied MLLMs often exhibit hallucinations and poor visual understanding <cite class="ltx_cite ltx_citemacro_citep">(Huang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib16" title="">2024</a>; Jiang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib17" title="">2024</a>)</cite>. In more detail, they cannot distinguish left from right and fail to recognize where objects are <cite class="ltx_cite ltx_citemacro_citep">(Tan et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib45" title="">2024b</a>)</cite>. The reason is that MLLMs have not been further grounded with the environments <cite class="ltx_cite ltx_citemacro_citep">(Su et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib42" title="">2022</a>; Sun et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib43" title="">2024</a>)</cite>. Grounding can be realized by fine-tuning on the experiences from interacting with the environments. Based on the evaluation methods, experience can be categorized into three types: human feedback <cite class="ltx_cite ltx_citemacro_citep">(Dai et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib7" title="">2024</a>; Kirk et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib18" title="">2024</a>)</cite>, environmental feedback <cite class="ltx_cite ltx_citemacro_citep">(Tan et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib44" title="">2024a</a>; Wang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib52" title="">2024b</a>)</cite>, and self-feedback <cite class="ltx_cite ltx_citemacro_citep">(Pang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib34" title="">2024</a>; Madaan et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib29" title="">2023</a>)</cite>. The first two types require additional efforts as illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#S1.F1.sf1" title="In Figure 1 ‣ 1 Introduction ‣ SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_tag">1(a)</span></a>. Human feedback necessitates expert annotations, which can be costly and influenced by preferences <cite class="ltx_cite ltx_citemacro_citep">(McAleese et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib31" title="">2024</a>)</cite>. Environmental feedback assumes we can obtain a dynamics model of the environment and build the reward model <cite class="ltx_cite ltx_citemacro_citep">(Sontakke et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib41" title="">2023</a>; Urcelay et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib49" title="">2024</a>)</cite>. Unfortunately, many environments including the real world do not meet such requirements, so these grounding methods are not general. Therefore, we are committed to finding a <span class="ltx_text ltx_font_italic" id="S1.p2.1.1">general way</span> to fill in the remaining gaps.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="S1.F1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S1.F1.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="145" id="S1.F1.sf1.g1" src="https://arxiv.org/html/2410.03303v1/x1.png" width="208">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>External Feedback</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S1.F1.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="147" id="S1.F1.sf2.g1" src="https://arxiv.org/html/2410.03303v1/x2.png" width="208">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Static Self-Feedback</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S1.F1.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="145" id="S1.F1.sf3.g1" src="https://arxiv.org/html/2410.03303v1/x3.png" width="208">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>Our Self-Feedback</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Comparison of our framework with other frameworks in terms of the feedback type. </figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Assuming we are facing an unknown embodied environment and cannot obtain external feedback, we can only rely on the capabilities of the MLLM itself. Some work, see Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#S1.F1.sf2" title="In Figure 1 ‣ 1 Introduction ‣ SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_tag">1(b)</span></a>, utilizes the evaluation (discriminative) ability of the pre-trained model itself <cite class="ltx_cite ltx_citemacro_citep">(Wang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib51" title="">2023a</a>; Huang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib15" title="">2023</a>)</cite> to evaluate its own decision-making, and uses such self-feedback to enhance the model’s decision-making (generative) capabilities.
However, it is easy to see this kind of self-learning is constrained by the static evaluation ability of the model to improve decision-making capability.
Ideally, we hope that self-learning can work similarly to the actor-critic paradigm <cite class="ltx_cite ltx_citemacro_citep">(Konda &amp; Tsitsiklis, <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib20" title="">1999</a>)</cite> in reinforcement learning, where the actor and critic can mutually enhance each other’s performance. If so, the potential for actor enhancement will be greatly expanded. Unlike reinforcement learning, which can obtain external rewards for training, we do not assume that we can get any external feedback. Therefore, we aim to <span class="ltx_text ltx_font_bold" id="S1.p3.1.1">develop a new actor-critic self-learning paradigm for embodied MLLMs in unknown environments.</span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">In this paper, we introduce a novel <span class="ltx_text ltx_font_bold" id="S1.p4.1.1">SE</span>lf-<span class="ltx_text ltx_font_bold" id="S1.p4.1.2">L</span>earning paradigm in <span class="ltx_text ltx_font_bold" id="S1.p4.1.3">U</span>nknown environments, dubbed <span class="ltx_text ltx_font_bold" id="S1.p4.1.4">SELU</span>, as illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#S1.F1.sf3" title="In Figure 1 ‣ 1 Introduction ‣ SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_tag">1(c)</span></a>. Inspired by the actor-critic paradigm in reinforcement learning, our paradigm learns to simultaneously optimize the MLLM’s ability to understand the environment and to make decisions. For the actor module, we fine-tune the model based on the self-feedback from the critic. As the actor gets improved, it can roll-out more successful trajectories to fine-tune the critic. However, without environmental feedback, the critic may provide inaccurate feedback at the beginning of the training phase, which might mislead the overall optimization. Therefore, we adopt self-asking to correct self-feedback and leverage hindsight relabeling to increase sample efficiency by turning the failure trajectory into a successful one. These high-quality and diverse trajectories are deemed to enhance the critic’s comprehension of the environment. Ultimately, the coupling of these two components mutually promotes the improvement of each other, unleashing the full self-learning potential of MLLMs.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">Our key contributions can be summarized as follows:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We propose a self-learning paradigm for embodied MLLMs, SELU, inspired by the actor-critic paradigm in reinforcement learning, which enables MLLMs to self-adapt to unknown environments.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">We leverage self-asking and hindsight relabeling to facilitate the improvement of the critic, which greatly increase the sample efficiency and make the self-learning possible.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">We demonstrate the effectiveness of SELU in the AI2-THOR and VirtualHome environments, achieving critic improvements of approximately 28% and 30%, and actor improvements of about 20% and 24%, respectively.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>MLLMs with External Feedback</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">In recent years, MLLMs has achieved impressive results across various visual benchmarks <cite class="ltx_cite ltx_citemacro_citep">(Mathew et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib30" title="">2021</a>; Tang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib47" title="">2024</a>; Lu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib27" title="">2024</a>)</cite>, demonstrating remarkable perception and decision-making capabilities. However, these models still exhibit flaws and often generate unexpected outputs, such as perceptual hallucinations and unreasonable decisions <cite class="ltx_cite ltx_citemacro_citep">(Yu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib61" title="">2024</a>; Chen et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib4" title="">2024</a>)</cite>. Inspired by reinforcement learning, current approaches use external feedback to correct MLLM’s erroneous outputs through a cycle of interaction, feedback, and correction <cite class="ltx_cite ltx_citemacro_citep">(Pan et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib33" title="">2024</a>; Gero et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib11" title="">2023</a>)</cite>. Generally, there are two sources of external feedback: human preference feedback and environmental feedback. Utilizing manually annotated data to align MLLMs output with expert preferences <cite class="ltx_cite ltx_citemacro_citep">(Kirk et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib18" title="">2024</a>; Zhong et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib64" title="">2024</a>)</cite>, such as DPO <cite class="ltx_cite ltx_citemacro_citep">(Rafailov et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib37" title="">2024</a>)</cite>, PRO <cite class="ltx_cite ltx_citemacro_citep">(Song et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib40" title="">2024</a>)</cite>, etc., has proven to be effective. Environmental feedback is typically derived from designing a reward function <cite class="ltx_cite ltx_citemacro_citep">(Pang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib34" title="">2024</a>; Tan et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib44" title="">2024a</a>)</cite> or pre-training an evaluation model <cite class="ltx_cite ltx_citemacro_citep">(Schick et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib38" title="">2023</a>)</cite>, which often require substantial support from expert data. For instance, <cite class="ltx_cite ltx_citemacro_citet">McAleese et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib31" title="">2024</a>)</cite> first trained a critic model using expert data to score program code bugs, and then applied these scores to train ChatGPT with PPO <cite class="ltx_cite ltx_citemacro_citep">(Schulman et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib39" title="">2017</a>)</cite>, enhancing its debugging capabilities. Compared to existing studies, we focus on the self-learning potential of MLLMs, as external feedback may be not professional enough in unknown environments.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Self-Improvement in LLMs</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">Self-improvement in Large Language Models (LLMs) has gained significant attention, as researchers strive to develop models that can learn and adapt from their own outputs, interactions, and internal feedback mechanisms, without relying on external human-labeled data <cite class="ltx_cite ltx_citemacro_citep">(Yan et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib60" title="">2023</a>; Haluptzok et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib13" title="">2023</a>)</cite>. Early explorations in this area are based on unsupervised learning techniques, where models learn representations from vast datasets without explicit human guidance <cite class="ltx_cite ltx_citemacro_citep">(Winter et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib56" title="">2022</a>; Zhao et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib63" title="">2019</a>)</cite>. Expanded to LLMs, self-improvement goes further by enabling models to critique, refine, and adapt their behavior in a more autonomous manner <cite class="ltx_cite ltx_citemacro_citep">(Tan et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib46" title="">2023</a>; Choi et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib6" title="">2024</a>)</cite>. There are two common self-improvement methods: prompt engineering and fine-tuning. The former is an efficient and intuitive approach for large-scale LLMs, as it allows for the establishment of various chains of thought (CoTs) <cite class="ltx_cite ltx_citemacro_citep">(Wei et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib54" title="">2022</a>)</cite> to address the same problem <cite class="ltx_cite ltx_citemacro_citep">(Huang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib15" title="">2023</a>; Feng et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib10" title="">2023</a>)</cite>. For instance, <cite class="ltx_cite ltx_citemacro_citet">Madaan et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib29" title="">2023</a>)</cite> demonstrated that GPT-3.5 and GPT-4 can enhance the rationality of responses by simultaneously inputting a question and reflecting on previous answers. The latter one is more useful for small-scale LLMs, as the prompt engineering is unstable. <cite class="ltx_cite ltx_citemacro_citet">Wang et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib50" title="">2024a</a>)</cite> developed a fine-tuning dataset by generating negative responses to optimize the LLMs, thereby reducing the occurrence of unreasonable answers. Based on these studies, we choose to use fine-tuning to optimize small-scale MLLMs. However, existing methods overlook the enhancement of MLLM’s environment understanding capabilities. Therefore, we employ an actor-critic framework to facilitate comprehensive self-learning in MLLMs, optimizing both perception and decision-making abilities.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Preliminaries</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Actor-Critic in Reinforcement Learning</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">Actor-critic <cite class="ltx_cite ltx_citemacro_citep">(Konda &amp; Tsitsiklis, <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib20" title="">1999</a>)</cite> is a widely adopted framework in reinforcement learning. The agent consists of two learning modules: an actor and a critic, which are optimized iteratively. The actor selects and executes actions based on current observations. The critic evaluates these observations (and actions) by estimating their values based on reward signals received from the environment, thereby guiding the actor to make improved choices in future. This framework takes advantage of both policy-based learning and value-based learning and is popular nowadays like PPO <cite class="ltx_cite ltx_citemacro_citep">(Schulman et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib39" title="">2017</a>)</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Actor-Critic for MLLMs</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">With the development of MLLMs, the feedback provided to the agent is no longer constrained to scalar values, like rewards; it can now include diverse modalities, such as natural language <cite class="ltx_cite ltx_citemacro_citep">(Dong et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib9" title="">2024</a>)</cite>. This enables the critic gain more specific and informative feedback on the outputs of the actor. Consequently, it can provide more accurate guidance for actor improvement. A prevalent approach in this domain is incorporating human feedback into the critic and building a static evaluation module that can reflect human preference <cite class="ltx_cite ltx_citemacro_citep">(Ouyang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib32" title="">2022</a>; Kirk et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib18" title="">2024</a>)</cite>. Specifically, human annotated data is used to train a critic model <cite class="ltx_cite ltx_citemacro_citep">(McAleese et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib31" title="">2024</a>)</cite> or a reward model <cite class="ltx_cite ltx_citemacro_citep">(Sontakke et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib41" title="">2023</a>; Wang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib52" title="">2024b</a>)</cite> to align the MLLM with human preferences better. More rigorous approaches leverage external evaluation mechanisms, such as tool-interactive learning <cite class="ltx_cite ltx_citemacro_citep">(Gou et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib12" title="">2024</a>; Chen et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib5" title="">2021</a>)</cite>, or external knowledge sources like Wikipedia and the Internet <cite class="ltx_cite ltx_citemacro_citep">(Xu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib58" title="">2023</a>; Li et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib21" title="">2024a</a>)</cite>. However, regardless of whether preference labels or external tools are used, human intervention remains inevitable. To overcome this reliance, methods like self-consistency <cite class="ltx_cite ltx_citemacro_citep">(Wang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib51" title="">2023a</a>; Schick et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib38" title="">2023</a>)</cite> employ a voting mechanism to enable the model to evaluate its own behavior without relying on external information. However, self-consistency lacks a learnable critic module, thus it cannot improve its grounding knowledge of the environment it interacts with. In contrast to previous work, we propose a novel actor-critic based paradigm aimed at achieving self-learning for both the actor MLLM and critic MLLM, enabling them to iteratively improve decision-making and grounding abilities without external human feedback or environmental rewards.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="S3.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="387" id="S3.F2.g1" src="https://arxiv.org/html/2410.03303v1/x4.png" width="813">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>The framework of SELU. (<span class="ltx_text ltx_font_italic" id="S3.F2.3.1">lower</span>) The actor MLLM, represented as a robot, collects trajectories for the given instructions. (<span class="ltx_text ltx_font_italic" id="S3.F2.4.2">upper</span>) The critic MLLM, denoted as a brain, evaluates these trajectories and determines whether they complete the tasks, guiding the update of the actor MLLM. In addition, the critic MLLM implements self-asking and hindsight relabeling to build a dataset for optimizing itself. The whole framework does not require any external feedback, such as environmental rewards or human annotations.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Method</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">The framework of our method is shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#S3.F2" title="Figure 2 ‣ 3.2 Actor-Critic for MLLMs ‣ 3 Preliminaries ‣ SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_tag">2</span></a>. It consists of two components: the actor MLLM and the critic MLLM. The actor MLLM follows instructions and collects trajectories in the environment. The critic MLLM evaluates the collected trajectories and acquires bootstrapped data via self-asking and hindsight relabeling to optimize itself (Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#S4.SS1" title="4.1 Critic: Self-Asking and Hindsight Relabeling ‣ 4 Method ‣ SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_tag">4.1</span></a>). Guided by the success detection results from the critic MLLM, the actor MLLM subsequently improves its decision-making performance in the environment (Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#S4.SS2" title="4.2 Actor: Critic-Guided Improvement ‣ 4 Method ‣ SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_tag">4.2</span></a>). By combining the two processes, we can achieve coupled improvements of the critic MLLM and the actor MLLM (Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#S4.SS3" title="4.3 Actor-Critic Coupling Improvement ‣ 4 Method ‣ SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_tag">4.3</span></a>).</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Critic: Self-Asking and Hindsight Relabeling</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">As introduced in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#S1" title="1 Introduction ‣ SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_tag">1</span></a>, enhancing the interpretation of environmental grounding information is crucial for an MLLM to improve its performance. In our framework, we achieve this objective via self-asking and hindsight relabeling to acquire bootstrapped data for optimizing the critic MLLM.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.3">Specifically, given an instruction <math alttext="I" class="ltx_Math" display="inline" id="S4.SS1.p2.1.m1.1"><semantics id="S4.SS1.p2.1.m1.1a"><mi id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><ci id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">I</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.1.m1.1d">italic_I</annotation></semantics></math>, the actor MLLM collects a trajectory by following this instruction. The critic takes the last frame <math alttext="o_{T}" class="ltx_Math" display="inline" id="S4.SS1.p2.2.m2.1"><semantics id="S4.SS1.p2.2.m2.1a"><msub id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml"><mi id="S4.SS1.p2.2.m2.1.1.2" xref="S4.SS1.p2.2.m2.1.1.2.cmml">o</mi><mi id="S4.SS1.p2.2.m2.1.1.3" xref="S4.SS1.p2.2.m2.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b"><apply id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.2.m2.1.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.p2.2.m2.1.1.2.cmml" xref="S4.SS1.p2.2.m2.1.1.2">𝑜</ci><ci id="S4.SS1.p2.2.m2.1.1.3.cmml" xref="S4.SS1.p2.2.m2.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">o_{T}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.2.m2.1d">italic_o start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT</annotation></semantics></math> of this trajectory as input, using it as the detection frame to determine whether the task depicted by <math alttext="I" class="ltx_Math" display="inline" id="S4.SS1.p2.3.m3.1"><semantics id="S4.SS1.p2.3.m3.1a"><mi id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.1b"><ci id="S4.SS1.p2.3.m3.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.1c">I</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.3.m3.1d">italic_I</annotation></semantics></math> is completed,</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S4.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="l_{d}=M_{c}(I,p_{d},o_{T})," class="ltx_Math" display="block" id="S4.E1.m1.2"><semantics id="S4.E1.m1.2a"><mrow id="S4.E1.m1.2.2.1" xref="S4.E1.m1.2.2.1.1.cmml"><mrow id="S4.E1.m1.2.2.1.1" xref="S4.E1.m1.2.2.1.1.cmml"><msub id="S4.E1.m1.2.2.1.1.4" xref="S4.E1.m1.2.2.1.1.4.cmml"><mi id="S4.E1.m1.2.2.1.1.4.2" xref="S4.E1.m1.2.2.1.1.4.2.cmml">l</mi><mi id="S4.E1.m1.2.2.1.1.4.3" xref="S4.E1.m1.2.2.1.1.4.3.cmml">d</mi></msub><mo id="S4.E1.m1.2.2.1.1.3" xref="S4.E1.m1.2.2.1.1.3.cmml">=</mo><mrow id="S4.E1.m1.2.2.1.1.2" xref="S4.E1.m1.2.2.1.1.2.cmml"><msub id="S4.E1.m1.2.2.1.1.2.4" xref="S4.E1.m1.2.2.1.1.2.4.cmml"><mi id="S4.E1.m1.2.2.1.1.2.4.2" xref="S4.E1.m1.2.2.1.1.2.4.2.cmml">M</mi><mi id="S4.E1.m1.2.2.1.1.2.4.3" xref="S4.E1.m1.2.2.1.1.2.4.3.cmml">c</mi></msub><mo id="S4.E1.m1.2.2.1.1.2.3" xref="S4.E1.m1.2.2.1.1.2.3.cmml">⁢</mo><mrow id="S4.E1.m1.2.2.1.1.2.2.2" xref="S4.E1.m1.2.2.1.1.2.2.3.cmml"><mo id="S4.E1.m1.2.2.1.1.2.2.2.3" stretchy="false" xref="S4.E1.m1.2.2.1.1.2.2.3.cmml">(</mo><mi id="S4.E1.m1.1.1" xref="S4.E1.m1.1.1.cmml">I</mi><mo id="S4.E1.m1.2.2.1.1.2.2.2.4" xref="S4.E1.m1.2.2.1.1.2.2.3.cmml">,</mo><msub id="S4.E1.m1.2.2.1.1.1.1.1.1" xref="S4.E1.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S4.E1.m1.2.2.1.1.1.1.1.1.2" xref="S4.E1.m1.2.2.1.1.1.1.1.1.2.cmml">p</mi><mi id="S4.E1.m1.2.2.1.1.1.1.1.1.3" xref="S4.E1.m1.2.2.1.1.1.1.1.1.3.cmml">d</mi></msub><mo id="S4.E1.m1.2.2.1.1.2.2.2.5" xref="S4.E1.m1.2.2.1.1.2.2.3.cmml">,</mo><msub id="S4.E1.m1.2.2.1.1.2.2.2.2" xref="S4.E1.m1.2.2.1.1.2.2.2.2.cmml"><mi id="S4.E1.m1.2.2.1.1.2.2.2.2.2" xref="S4.E1.m1.2.2.1.1.2.2.2.2.2.cmml">o</mi><mi id="S4.E1.m1.2.2.1.1.2.2.2.2.3" xref="S4.E1.m1.2.2.1.1.2.2.2.2.3.cmml">T</mi></msub><mo id="S4.E1.m1.2.2.1.1.2.2.2.6" stretchy="false" xref="S4.E1.m1.2.2.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E1.m1.2.2.1.2" xref="S4.E1.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E1.m1.2b"><apply id="S4.E1.m1.2.2.1.1.cmml" xref="S4.E1.m1.2.2.1"><eq id="S4.E1.m1.2.2.1.1.3.cmml" xref="S4.E1.m1.2.2.1.1.3"></eq><apply id="S4.E1.m1.2.2.1.1.4.cmml" xref="S4.E1.m1.2.2.1.1.4"><csymbol cd="ambiguous" id="S4.E1.m1.2.2.1.1.4.1.cmml" xref="S4.E1.m1.2.2.1.1.4">subscript</csymbol><ci id="S4.E1.m1.2.2.1.1.4.2.cmml" xref="S4.E1.m1.2.2.1.1.4.2">𝑙</ci><ci id="S4.E1.m1.2.2.1.1.4.3.cmml" xref="S4.E1.m1.2.2.1.1.4.3">𝑑</ci></apply><apply id="S4.E1.m1.2.2.1.1.2.cmml" xref="S4.E1.m1.2.2.1.1.2"><times id="S4.E1.m1.2.2.1.1.2.3.cmml" xref="S4.E1.m1.2.2.1.1.2.3"></times><apply id="S4.E1.m1.2.2.1.1.2.4.cmml" xref="S4.E1.m1.2.2.1.1.2.4"><csymbol cd="ambiguous" id="S4.E1.m1.2.2.1.1.2.4.1.cmml" xref="S4.E1.m1.2.2.1.1.2.4">subscript</csymbol><ci id="S4.E1.m1.2.2.1.1.2.4.2.cmml" xref="S4.E1.m1.2.2.1.1.2.4.2">𝑀</ci><ci id="S4.E1.m1.2.2.1.1.2.4.3.cmml" xref="S4.E1.m1.2.2.1.1.2.4.3">𝑐</ci></apply><vector id="S4.E1.m1.2.2.1.1.2.2.3.cmml" xref="S4.E1.m1.2.2.1.1.2.2.2"><ci id="S4.E1.m1.1.1.cmml" xref="S4.E1.m1.1.1">𝐼</ci><apply id="S4.E1.m1.2.2.1.1.1.1.1.1.cmml" xref="S4.E1.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.2.2.1.1.1.1.1.1.2">𝑝</ci><ci id="S4.E1.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E1.m1.2.2.1.1.1.1.1.1.3">𝑑</ci></apply><apply id="S4.E1.m1.2.2.1.1.2.2.2.2.cmml" xref="S4.E1.m1.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E1.m1.2.2.1.1.2.2.2.2.1.cmml" xref="S4.E1.m1.2.2.1.1.2.2.2.2">subscript</csymbol><ci id="S4.E1.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S4.E1.m1.2.2.1.1.2.2.2.2.2">𝑜</ci><ci id="S4.E1.m1.2.2.1.1.2.2.2.2.3.cmml" xref="S4.E1.m1.2.2.1.1.2.2.2.2.3">𝑇</ci></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E1.m1.2c">l_{d}=M_{c}(I,p_{d},o_{T}),</annotation><annotation encoding="application/x-llamapun" id="S4.E1.m1.2d">italic_l start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT = italic_M start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ( italic_I , italic_p start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.p2.9">where <math alttext="M_{c}" class="ltx_Math" display="inline" id="S4.SS1.p2.4.m1.1"><semantics id="S4.SS1.p2.4.m1.1a"><msub id="S4.SS1.p2.4.m1.1.1" xref="S4.SS1.p2.4.m1.1.1.cmml"><mi id="S4.SS1.p2.4.m1.1.1.2" xref="S4.SS1.p2.4.m1.1.1.2.cmml">M</mi><mi id="S4.SS1.p2.4.m1.1.1.3" xref="S4.SS1.p2.4.m1.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.4.m1.1b"><apply id="S4.SS1.p2.4.m1.1.1.cmml" xref="S4.SS1.p2.4.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.4.m1.1.1.1.cmml" xref="S4.SS1.p2.4.m1.1.1">subscript</csymbol><ci id="S4.SS1.p2.4.m1.1.1.2.cmml" xref="S4.SS1.p2.4.m1.1.1.2">𝑀</ci><ci id="S4.SS1.p2.4.m1.1.1.3.cmml" xref="S4.SS1.p2.4.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.4.m1.1c">M_{c}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.4.m1.1d">italic_M start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> denotes the critic MLLM, <math alttext="l_{d}\in\{``yes&quot;,``no&quot;\}" class="ltx_Math" display="inline" id="S4.SS1.p2.5.m2.2"><semantics id="S4.SS1.p2.5.m2.2a"><mrow id="S4.SS1.p2.5.m2.2.2" xref="S4.SS1.p2.5.m2.2.2.cmml"><msub id="S4.SS1.p2.5.m2.2.2.4" xref="S4.SS1.p2.5.m2.2.2.4.cmml"><mi id="S4.SS1.p2.5.m2.2.2.4.2" xref="S4.SS1.p2.5.m2.2.2.4.2.cmml">l</mi><mi id="S4.SS1.p2.5.m2.2.2.4.3" xref="S4.SS1.p2.5.m2.2.2.4.3.cmml">d</mi></msub><mo id="S4.SS1.p2.5.m2.2.2.3" xref="S4.SS1.p2.5.m2.2.2.3.cmml">∈</mo><mrow id="S4.SS1.p2.5.m2.2.2.2.2" xref="S4.SS1.p2.5.m2.2.2.2.3.cmml"><mo id="S4.SS1.p2.5.m2.2.2.2.2.3" stretchy="false" xref="S4.SS1.p2.5.m2.2.2.2.3.cmml">{</mo><mrow id="S4.SS1.p2.5.m2.1.1.1.1.1" xref="S4.SS1.p2.5.m2.1.1.1.1.1.cmml"><mi id="S4.SS1.p2.5.m2.1.1.1.1.1.2" mathvariant="normal" xref="S4.SS1.p2.5.m2.1.1.1.1.1.2.cmml">`</mi><mo id="S4.SS1.p2.5.m2.1.1.1.1.1.1" xref="S4.SS1.p2.5.m2.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.SS1.p2.5.m2.1.1.1.1.1.3" mathvariant="normal" xref="S4.SS1.p2.5.m2.1.1.1.1.1.3.cmml">`</mi><mo id="S4.SS1.p2.5.m2.1.1.1.1.1.1a" xref="S4.SS1.p2.5.m2.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.SS1.p2.5.m2.1.1.1.1.1.4" xref="S4.SS1.p2.5.m2.1.1.1.1.1.4.cmml">y</mi><mo id="S4.SS1.p2.5.m2.1.1.1.1.1.1b" xref="S4.SS1.p2.5.m2.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.SS1.p2.5.m2.1.1.1.1.1.5" xref="S4.SS1.p2.5.m2.1.1.1.1.1.5.cmml">e</mi><mo id="S4.SS1.p2.5.m2.1.1.1.1.1.1c" xref="S4.SS1.p2.5.m2.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.SS1.p2.5.m2.1.1.1.1.1.6" xref="S4.SS1.p2.5.m2.1.1.1.1.1.6.cmml">s</mi><mo id="S4.SS1.p2.5.m2.1.1.1.1.1.1d" xref="S4.SS1.p2.5.m2.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.SS1.p2.5.m2.1.1.1.1.1.7" mathvariant="normal" xref="S4.SS1.p2.5.m2.1.1.1.1.1.7.cmml">"</mi></mrow><mo id="S4.SS1.p2.5.m2.2.2.2.2.4" xref="S4.SS1.p2.5.m2.2.2.2.3.cmml">,</mo><mrow id="S4.SS1.p2.5.m2.2.2.2.2.2" xref="S4.SS1.p2.5.m2.2.2.2.2.2.cmml"><mi id="S4.SS1.p2.5.m2.2.2.2.2.2.2" mathvariant="normal" xref="S4.SS1.p2.5.m2.2.2.2.2.2.2.cmml">`</mi><mo id="S4.SS1.p2.5.m2.2.2.2.2.2.1" xref="S4.SS1.p2.5.m2.2.2.2.2.2.1.cmml">⁢</mo><mi id="S4.SS1.p2.5.m2.2.2.2.2.2.3" mathvariant="normal" xref="S4.SS1.p2.5.m2.2.2.2.2.2.3.cmml">`</mi><mo id="S4.SS1.p2.5.m2.2.2.2.2.2.1a" xref="S4.SS1.p2.5.m2.2.2.2.2.2.1.cmml">⁢</mo><mi id="S4.SS1.p2.5.m2.2.2.2.2.2.4" xref="S4.SS1.p2.5.m2.2.2.2.2.2.4.cmml">n</mi><mo id="S4.SS1.p2.5.m2.2.2.2.2.2.1b" xref="S4.SS1.p2.5.m2.2.2.2.2.2.1.cmml">⁢</mo><mi id="S4.SS1.p2.5.m2.2.2.2.2.2.5" xref="S4.SS1.p2.5.m2.2.2.2.2.2.5.cmml">o</mi><mo id="S4.SS1.p2.5.m2.2.2.2.2.2.1c" xref="S4.SS1.p2.5.m2.2.2.2.2.2.1.cmml">⁢</mo><mi id="S4.SS1.p2.5.m2.2.2.2.2.2.6" mathvariant="normal" xref="S4.SS1.p2.5.m2.2.2.2.2.2.6.cmml">"</mi></mrow><mo id="S4.SS1.p2.5.m2.2.2.2.2.5" stretchy="false" xref="S4.SS1.p2.5.m2.2.2.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.5.m2.2b"><apply id="S4.SS1.p2.5.m2.2.2.cmml" xref="S4.SS1.p2.5.m2.2.2"><in id="S4.SS1.p2.5.m2.2.2.3.cmml" xref="S4.SS1.p2.5.m2.2.2.3"></in><apply id="S4.SS1.p2.5.m2.2.2.4.cmml" xref="S4.SS1.p2.5.m2.2.2.4"><csymbol cd="ambiguous" id="S4.SS1.p2.5.m2.2.2.4.1.cmml" xref="S4.SS1.p2.5.m2.2.2.4">subscript</csymbol><ci id="S4.SS1.p2.5.m2.2.2.4.2.cmml" xref="S4.SS1.p2.5.m2.2.2.4.2">𝑙</ci><ci id="S4.SS1.p2.5.m2.2.2.4.3.cmml" xref="S4.SS1.p2.5.m2.2.2.4.3">𝑑</ci></apply><set id="S4.SS1.p2.5.m2.2.2.2.3.cmml" xref="S4.SS1.p2.5.m2.2.2.2.2"><apply id="S4.SS1.p2.5.m2.1.1.1.1.1.cmml" xref="S4.SS1.p2.5.m2.1.1.1.1.1"><times id="S4.SS1.p2.5.m2.1.1.1.1.1.1.cmml" xref="S4.SS1.p2.5.m2.1.1.1.1.1.1"></times><ci id="S4.SS1.p2.5.m2.1.1.1.1.1.2.cmml" xref="S4.SS1.p2.5.m2.1.1.1.1.1.2">`</ci><ci id="S4.SS1.p2.5.m2.1.1.1.1.1.3.cmml" xref="S4.SS1.p2.5.m2.1.1.1.1.1.3">`</ci><ci id="S4.SS1.p2.5.m2.1.1.1.1.1.4.cmml" xref="S4.SS1.p2.5.m2.1.1.1.1.1.4">𝑦</ci><ci id="S4.SS1.p2.5.m2.1.1.1.1.1.5.cmml" xref="S4.SS1.p2.5.m2.1.1.1.1.1.5">𝑒</ci><ci id="S4.SS1.p2.5.m2.1.1.1.1.1.6.cmml" xref="S4.SS1.p2.5.m2.1.1.1.1.1.6">𝑠</ci><ci id="S4.SS1.p2.5.m2.1.1.1.1.1.7.cmml" xref="S4.SS1.p2.5.m2.1.1.1.1.1.7">"</ci></apply><apply id="S4.SS1.p2.5.m2.2.2.2.2.2.cmml" xref="S4.SS1.p2.5.m2.2.2.2.2.2"><times id="S4.SS1.p2.5.m2.2.2.2.2.2.1.cmml" xref="S4.SS1.p2.5.m2.2.2.2.2.2.1"></times><ci id="S4.SS1.p2.5.m2.2.2.2.2.2.2.cmml" xref="S4.SS1.p2.5.m2.2.2.2.2.2.2">`</ci><ci id="S4.SS1.p2.5.m2.2.2.2.2.2.3.cmml" xref="S4.SS1.p2.5.m2.2.2.2.2.2.3">`</ci><ci id="S4.SS1.p2.5.m2.2.2.2.2.2.4.cmml" xref="S4.SS1.p2.5.m2.2.2.2.2.2.4">𝑛</ci><ci id="S4.SS1.p2.5.m2.2.2.2.2.2.5.cmml" xref="S4.SS1.p2.5.m2.2.2.2.2.2.5">𝑜</ci><ci id="S4.SS1.p2.5.m2.2.2.2.2.2.6.cmml" xref="S4.SS1.p2.5.m2.2.2.2.2.2.6">"</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.5.m2.2c">l_{d}\in\{``yes",``no"\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.5.m2.2d">italic_l start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT ∈ { ` ` italic_y italic_e italic_s " , ` ` italic_n italic_o " }</annotation></semantics></math> is the result of the success detection, and <math alttext="p_{d}" class="ltx_Math" display="inline" id="S4.SS1.p2.6.m3.1"><semantics id="S4.SS1.p2.6.m3.1a"><msub id="S4.SS1.p2.6.m3.1.1" xref="S4.SS1.p2.6.m3.1.1.cmml"><mi id="S4.SS1.p2.6.m3.1.1.2" xref="S4.SS1.p2.6.m3.1.1.2.cmml">p</mi><mi id="S4.SS1.p2.6.m3.1.1.3" xref="S4.SS1.p2.6.m3.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.6.m3.1b"><apply id="S4.SS1.p2.6.m3.1.1.cmml" xref="S4.SS1.p2.6.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.6.m3.1.1.1.cmml" xref="S4.SS1.p2.6.m3.1.1">subscript</csymbol><ci id="S4.SS1.p2.6.m3.1.1.2.cmml" xref="S4.SS1.p2.6.m3.1.1.2">𝑝</ci><ci id="S4.SS1.p2.6.m3.1.1.3.cmml" xref="S4.SS1.p2.6.m3.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.6.m3.1c">p_{d}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.6.m3.1d">italic_p start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT</annotation></semantics></math> is a prompt for the detection. If the detection result is <math alttext="l_{d}=``yes&quot;" class="ltx_Math" display="inline" id="S4.SS1.p2.7.m4.1"><semantics id="S4.SS1.p2.7.m4.1a"><mrow id="S4.SS1.p2.7.m4.1.1" xref="S4.SS1.p2.7.m4.1.1.cmml"><msub id="S4.SS1.p2.7.m4.1.1.2" xref="S4.SS1.p2.7.m4.1.1.2.cmml"><mi id="S4.SS1.p2.7.m4.1.1.2.2" xref="S4.SS1.p2.7.m4.1.1.2.2.cmml">l</mi><mi id="S4.SS1.p2.7.m4.1.1.2.3" xref="S4.SS1.p2.7.m4.1.1.2.3.cmml">d</mi></msub><mo id="S4.SS1.p2.7.m4.1.1.1" xref="S4.SS1.p2.7.m4.1.1.1.cmml">=</mo><mrow id="S4.SS1.p2.7.m4.1.1.3" xref="S4.SS1.p2.7.m4.1.1.3.cmml"><mi id="S4.SS1.p2.7.m4.1.1.3.2" mathvariant="normal" xref="S4.SS1.p2.7.m4.1.1.3.2.cmml">`</mi><mo id="S4.SS1.p2.7.m4.1.1.3.1" xref="S4.SS1.p2.7.m4.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p2.7.m4.1.1.3.3" mathvariant="normal" xref="S4.SS1.p2.7.m4.1.1.3.3.cmml">`</mi><mo id="S4.SS1.p2.7.m4.1.1.3.1a" xref="S4.SS1.p2.7.m4.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p2.7.m4.1.1.3.4" xref="S4.SS1.p2.7.m4.1.1.3.4.cmml">y</mi><mo id="S4.SS1.p2.7.m4.1.1.3.1b" xref="S4.SS1.p2.7.m4.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p2.7.m4.1.1.3.5" xref="S4.SS1.p2.7.m4.1.1.3.5.cmml">e</mi><mo id="S4.SS1.p2.7.m4.1.1.3.1c" xref="S4.SS1.p2.7.m4.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p2.7.m4.1.1.3.6" xref="S4.SS1.p2.7.m4.1.1.3.6.cmml">s</mi><mo id="S4.SS1.p2.7.m4.1.1.3.1d" xref="S4.SS1.p2.7.m4.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p2.7.m4.1.1.3.7" mathvariant="normal" xref="S4.SS1.p2.7.m4.1.1.3.7.cmml">"</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.7.m4.1b"><apply id="S4.SS1.p2.7.m4.1.1.cmml" xref="S4.SS1.p2.7.m4.1.1"><eq id="S4.SS1.p2.7.m4.1.1.1.cmml" xref="S4.SS1.p2.7.m4.1.1.1"></eq><apply id="S4.SS1.p2.7.m4.1.1.2.cmml" xref="S4.SS1.p2.7.m4.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p2.7.m4.1.1.2.1.cmml" xref="S4.SS1.p2.7.m4.1.1.2">subscript</csymbol><ci id="S4.SS1.p2.7.m4.1.1.2.2.cmml" xref="S4.SS1.p2.7.m4.1.1.2.2">𝑙</ci><ci id="S4.SS1.p2.7.m4.1.1.2.3.cmml" xref="S4.SS1.p2.7.m4.1.1.2.3">𝑑</ci></apply><apply id="S4.SS1.p2.7.m4.1.1.3.cmml" xref="S4.SS1.p2.7.m4.1.1.3"><times id="S4.SS1.p2.7.m4.1.1.3.1.cmml" xref="S4.SS1.p2.7.m4.1.1.3.1"></times><ci id="S4.SS1.p2.7.m4.1.1.3.2.cmml" xref="S4.SS1.p2.7.m4.1.1.3.2">`</ci><ci id="S4.SS1.p2.7.m4.1.1.3.3.cmml" xref="S4.SS1.p2.7.m4.1.1.3.3">`</ci><ci id="S4.SS1.p2.7.m4.1.1.3.4.cmml" xref="S4.SS1.p2.7.m4.1.1.3.4">𝑦</ci><ci id="S4.SS1.p2.7.m4.1.1.3.5.cmml" xref="S4.SS1.p2.7.m4.1.1.3.5">𝑒</ci><ci id="S4.SS1.p2.7.m4.1.1.3.6.cmml" xref="S4.SS1.p2.7.m4.1.1.3.6">𝑠</ci><ci id="S4.SS1.p2.7.m4.1.1.3.7.cmml" xref="S4.SS1.p2.7.m4.1.1.3.7">"</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.7.m4.1c">l_{d}=``yes"</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.7.m4.1d">italic_l start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT = ` ` italic_y italic_e italic_s "</annotation></semantics></math>, we consider this trajectory to be a successful sample for the given instruction and store this trajectory directly into the critic fine-tuning dataset <math alttext="\mathcal{D}_{\rm critic}" class="ltx_Math" display="inline" id="S4.SS1.p2.8.m5.1"><semantics id="S4.SS1.p2.8.m5.1a"><msub id="S4.SS1.p2.8.m5.1.1" xref="S4.SS1.p2.8.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p2.8.m5.1.1.2" xref="S4.SS1.p2.8.m5.1.1.2.cmml">𝒟</mi><mi id="S4.SS1.p2.8.m5.1.1.3" xref="S4.SS1.p2.8.m5.1.1.3.cmml">critic</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.8.m5.1b"><apply id="S4.SS1.p2.8.m5.1.1.cmml" xref="S4.SS1.p2.8.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.8.m5.1.1.1.cmml" xref="S4.SS1.p2.8.m5.1.1">subscript</csymbol><ci id="S4.SS1.p2.8.m5.1.1.2.cmml" xref="S4.SS1.p2.8.m5.1.1.2">𝒟</ci><ci id="S4.SS1.p2.8.m5.1.1.3.cmml" xref="S4.SS1.p2.8.m5.1.1.3">critic</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.8.m5.1c">\mathcal{D}_{\rm critic}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.8.m5.1d">caligraphic_D start_POSTSUBSCRIPT roman_critic end_POSTSUBSCRIPT</annotation></semantics></math> in the format <math alttext="(I,p_{d},o_{T},l_{d})" class="ltx_Math" display="inline" id="S4.SS1.p2.9.m6.4"><semantics id="S4.SS1.p2.9.m6.4a"><mrow id="S4.SS1.p2.9.m6.4.4.3" xref="S4.SS1.p2.9.m6.4.4.4.cmml"><mo id="S4.SS1.p2.9.m6.4.4.3.4" stretchy="false" xref="S4.SS1.p2.9.m6.4.4.4.cmml">(</mo><mi id="S4.SS1.p2.9.m6.1.1" xref="S4.SS1.p2.9.m6.1.1.cmml">I</mi><mo id="S4.SS1.p2.9.m6.4.4.3.5" xref="S4.SS1.p2.9.m6.4.4.4.cmml">,</mo><msub id="S4.SS1.p2.9.m6.2.2.1.1" xref="S4.SS1.p2.9.m6.2.2.1.1.cmml"><mi id="S4.SS1.p2.9.m6.2.2.1.1.2" xref="S4.SS1.p2.9.m6.2.2.1.1.2.cmml">p</mi><mi id="S4.SS1.p2.9.m6.2.2.1.1.3" xref="S4.SS1.p2.9.m6.2.2.1.1.3.cmml">d</mi></msub><mo id="S4.SS1.p2.9.m6.4.4.3.6" xref="S4.SS1.p2.9.m6.4.4.4.cmml">,</mo><msub id="S4.SS1.p2.9.m6.3.3.2.2" xref="S4.SS1.p2.9.m6.3.3.2.2.cmml"><mi id="S4.SS1.p2.9.m6.3.3.2.2.2" xref="S4.SS1.p2.9.m6.3.3.2.2.2.cmml">o</mi><mi id="S4.SS1.p2.9.m6.3.3.2.2.3" xref="S4.SS1.p2.9.m6.3.3.2.2.3.cmml">T</mi></msub><mo id="S4.SS1.p2.9.m6.4.4.3.7" xref="S4.SS1.p2.9.m6.4.4.4.cmml">,</mo><msub id="S4.SS1.p2.9.m6.4.4.3.3" xref="S4.SS1.p2.9.m6.4.4.3.3.cmml"><mi id="S4.SS1.p2.9.m6.4.4.3.3.2" xref="S4.SS1.p2.9.m6.4.4.3.3.2.cmml">l</mi><mi id="S4.SS1.p2.9.m6.4.4.3.3.3" xref="S4.SS1.p2.9.m6.4.4.3.3.3.cmml">d</mi></msub><mo id="S4.SS1.p2.9.m6.4.4.3.8" stretchy="false" xref="S4.SS1.p2.9.m6.4.4.4.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.9.m6.4b"><vector id="S4.SS1.p2.9.m6.4.4.4.cmml" xref="S4.SS1.p2.9.m6.4.4.3"><ci id="S4.SS1.p2.9.m6.1.1.cmml" xref="S4.SS1.p2.9.m6.1.1">𝐼</ci><apply id="S4.SS1.p2.9.m6.2.2.1.1.cmml" xref="S4.SS1.p2.9.m6.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.9.m6.2.2.1.1.1.cmml" xref="S4.SS1.p2.9.m6.2.2.1.1">subscript</csymbol><ci id="S4.SS1.p2.9.m6.2.2.1.1.2.cmml" xref="S4.SS1.p2.9.m6.2.2.1.1.2">𝑝</ci><ci id="S4.SS1.p2.9.m6.2.2.1.1.3.cmml" xref="S4.SS1.p2.9.m6.2.2.1.1.3">𝑑</ci></apply><apply id="S4.SS1.p2.9.m6.3.3.2.2.cmml" xref="S4.SS1.p2.9.m6.3.3.2.2"><csymbol cd="ambiguous" id="S4.SS1.p2.9.m6.3.3.2.2.1.cmml" xref="S4.SS1.p2.9.m6.3.3.2.2">subscript</csymbol><ci id="S4.SS1.p2.9.m6.3.3.2.2.2.cmml" xref="S4.SS1.p2.9.m6.3.3.2.2.2">𝑜</ci><ci id="S4.SS1.p2.9.m6.3.3.2.2.3.cmml" xref="S4.SS1.p2.9.m6.3.3.2.2.3">𝑇</ci></apply><apply id="S4.SS1.p2.9.m6.4.4.3.3.cmml" xref="S4.SS1.p2.9.m6.4.4.3.3"><csymbol cd="ambiguous" id="S4.SS1.p2.9.m6.4.4.3.3.1.cmml" xref="S4.SS1.p2.9.m6.4.4.3.3">subscript</csymbol><ci id="S4.SS1.p2.9.m6.4.4.3.3.2.cmml" xref="S4.SS1.p2.9.m6.4.4.3.3.2">𝑙</ci><ci id="S4.SS1.p2.9.m6.4.4.3.3.3.cmml" xref="S4.SS1.p2.9.m6.4.4.3.3.3">𝑑</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.9.m6.4c">(I,p_{d},o_{T},l_{d})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.9.m6.4d">( italic_I , italic_p start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT , italic_l start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT )</annotation></semantics></math>, as shown by trajectory 1 in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#S3.F2" title="Figure 2 ‣ 3.2 Actor-Critic for MLLMs ‣ 3 Preliminaries ‣ SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_tag">2</span></a>. This trajectory includes environmental grounding information that aligns with the knowledge contained in the critic MLLM.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.2">If the detection result is <math alttext="l_{d}=``no&quot;" class="ltx_Math" display="inline" id="S4.SS1.p3.1.m1.1"><semantics id="S4.SS1.p3.1.m1.1a"><mrow id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml"><msub id="S4.SS1.p3.1.m1.1.1.2" xref="S4.SS1.p3.1.m1.1.1.2.cmml"><mi id="S4.SS1.p3.1.m1.1.1.2.2" xref="S4.SS1.p3.1.m1.1.1.2.2.cmml">l</mi><mi id="S4.SS1.p3.1.m1.1.1.2.3" xref="S4.SS1.p3.1.m1.1.1.2.3.cmml">d</mi></msub><mo id="S4.SS1.p3.1.m1.1.1.1" xref="S4.SS1.p3.1.m1.1.1.1.cmml">=</mo><mrow id="S4.SS1.p3.1.m1.1.1.3" xref="S4.SS1.p3.1.m1.1.1.3.cmml"><mi id="S4.SS1.p3.1.m1.1.1.3.2" mathvariant="normal" xref="S4.SS1.p3.1.m1.1.1.3.2.cmml">`</mi><mo id="S4.SS1.p3.1.m1.1.1.3.1" xref="S4.SS1.p3.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p3.1.m1.1.1.3.3" mathvariant="normal" xref="S4.SS1.p3.1.m1.1.1.3.3.cmml">`</mi><mo id="S4.SS1.p3.1.m1.1.1.3.1a" xref="S4.SS1.p3.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p3.1.m1.1.1.3.4" xref="S4.SS1.p3.1.m1.1.1.3.4.cmml">n</mi><mo id="S4.SS1.p3.1.m1.1.1.3.1b" xref="S4.SS1.p3.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p3.1.m1.1.1.3.5" xref="S4.SS1.p3.1.m1.1.1.3.5.cmml">o</mi><mo id="S4.SS1.p3.1.m1.1.1.3.1c" xref="S4.SS1.p3.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p3.1.m1.1.1.3.6" mathvariant="normal" xref="S4.SS1.p3.1.m1.1.1.3.6.cmml">"</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><apply id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1"><eq id="S4.SS1.p3.1.m1.1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1.1"></eq><apply id="S4.SS1.p3.1.m1.1.1.2.cmml" xref="S4.SS1.p3.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p3.1.m1.1.1.2.1.cmml" xref="S4.SS1.p3.1.m1.1.1.2">subscript</csymbol><ci id="S4.SS1.p3.1.m1.1.1.2.2.cmml" xref="S4.SS1.p3.1.m1.1.1.2.2">𝑙</ci><ci id="S4.SS1.p3.1.m1.1.1.2.3.cmml" xref="S4.SS1.p3.1.m1.1.1.2.3">𝑑</ci></apply><apply id="S4.SS1.p3.1.m1.1.1.3.cmml" xref="S4.SS1.p3.1.m1.1.1.3"><times id="S4.SS1.p3.1.m1.1.1.3.1.cmml" xref="S4.SS1.p3.1.m1.1.1.3.1"></times><ci id="S4.SS1.p3.1.m1.1.1.3.2.cmml" xref="S4.SS1.p3.1.m1.1.1.3.2">`</ci><ci id="S4.SS1.p3.1.m1.1.1.3.3.cmml" xref="S4.SS1.p3.1.m1.1.1.3.3">`</ci><ci id="S4.SS1.p3.1.m1.1.1.3.4.cmml" xref="S4.SS1.p3.1.m1.1.1.3.4">𝑛</ci><ci id="S4.SS1.p3.1.m1.1.1.3.5.cmml" xref="S4.SS1.p3.1.m1.1.1.3.5">𝑜</ci><ci id="S4.SS1.p3.1.m1.1.1.3.6.cmml" xref="S4.SS1.p3.1.m1.1.1.3.6">"</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">l_{d}=``no"</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.1.m1.1d">italic_l start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT = ` ` italic_n italic_o "</annotation></semantics></math>, which means the critic MLLM views this trajectory as a failure for instruction <math alttext="I" class="ltx_Math" display="inline" id="S4.SS1.p3.2.m2.1"><semantics id="S4.SS1.p3.2.m2.1a"><mi id="S4.SS1.p3.2.m2.1.1" xref="S4.SS1.p3.2.m2.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m2.1b"><ci id="S4.SS1.p3.2.m2.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.2.m2.1c">I</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.2.m2.1d">italic_I</annotation></semantics></math>. We first apply <span class="ltx_text ltx_font_bold" id="S4.SS1.p3.2.1">self-asking</span> to examine the state of task-related objects, as the decision made by the critic MLLM might not be precise due to potential hallucinations. The critic MLLM is used to obtain the object states,</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S4.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="l^{\prime}_{d}=M_{c}(l_{s},I),\quad l_{s}=M_{c}(j_{I},p_{s},o_{T})" class="ltx_Math" display="block" id="S4.E2.m1.3"><semantics id="S4.E2.m1.3a"><mrow id="S4.E2.m1.3.3.2" xref="S4.E2.m1.3.3.3.cmml"><mrow id="S4.E2.m1.2.2.1.1" xref="S4.E2.m1.2.2.1.1.cmml"><msubsup id="S4.E2.m1.2.2.1.1.3" xref="S4.E2.m1.2.2.1.1.3.cmml"><mi id="S4.E2.m1.2.2.1.1.3.2.2" xref="S4.E2.m1.2.2.1.1.3.2.2.cmml">l</mi><mi id="S4.E2.m1.2.2.1.1.3.3" xref="S4.E2.m1.2.2.1.1.3.3.cmml">d</mi><mo id="S4.E2.m1.2.2.1.1.3.2.3" xref="S4.E2.m1.2.2.1.1.3.2.3.cmml">′</mo></msubsup><mo id="S4.E2.m1.2.2.1.1.2" xref="S4.E2.m1.2.2.1.1.2.cmml">=</mo><mrow id="S4.E2.m1.2.2.1.1.1" xref="S4.E2.m1.2.2.1.1.1.cmml"><msub id="S4.E2.m1.2.2.1.1.1.3" xref="S4.E2.m1.2.2.1.1.1.3.cmml"><mi id="S4.E2.m1.2.2.1.1.1.3.2" xref="S4.E2.m1.2.2.1.1.1.3.2.cmml">M</mi><mi id="S4.E2.m1.2.2.1.1.1.3.3" xref="S4.E2.m1.2.2.1.1.1.3.3.cmml">c</mi></msub><mo id="S4.E2.m1.2.2.1.1.1.2" xref="S4.E2.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S4.E2.m1.2.2.1.1.1.1.1" xref="S4.E2.m1.2.2.1.1.1.1.2.cmml"><mo id="S4.E2.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="S4.E2.m1.2.2.1.1.1.1.2.cmml">(</mo><msub id="S4.E2.m1.2.2.1.1.1.1.1.1" xref="S4.E2.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S4.E2.m1.2.2.1.1.1.1.1.1.2" xref="S4.E2.m1.2.2.1.1.1.1.1.1.2.cmml">l</mi><mi id="S4.E2.m1.2.2.1.1.1.1.1.1.3" xref="S4.E2.m1.2.2.1.1.1.1.1.1.3.cmml">s</mi></msub><mo id="S4.E2.m1.2.2.1.1.1.1.1.3" xref="S4.E2.m1.2.2.1.1.1.1.2.cmml">,</mo><mi id="S4.E2.m1.1.1" xref="S4.E2.m1.1.1.cmml">I</mi><mo id="S4.E2.m1.2.2.1.1.1.1.1.4" stretchy="false" xref="S4.E2.m1.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E2.m1.3.3.2.3" rspace="1.167em" xref="S4.E2.m1.3.3.3a.cmml">,</mo><mrow id="S4.E2.m1.3.3.2.2" xref="S4.E2.m1.3.3.2.2.cmml"><msub id="S4.E2.m1.3.3.2.2.5" xref="S4.E2.m1.3.3.2.2.5.cmml"><mi id="S4.E2.m1.3.3.2.2.5.2" xref="S4.E2.m1.3.3.2.2.5.2.cmml">l</mi><mi id="S4.E2.m1.3.3.2.2.5.3" xref="S4.E2.m1.3.3.2.2.5.3.cmml">s</mi></msub><mo id="S4.E2.m1.3.3.2.2.4" xref="S4.E2.m1.3.3.2.2.4.cmml">=</mo><mrow id="S4.E2.m1.3.3.2.2.3" xref="S4.E2.m1.3.3.2.2.3.cmml"><msub id="S4.E2.m1.3.3.2.2.3.5" xref="S4.E2.m1.3.3.2.2.3.5.cmml"><mi id="S4.E2.m1.3.3.2.2.3.5.2" xref="S4.E2.m1.3.3.2.2.3.5.2.cmml">M</mi><mi id="S4.E2.m1.3.3.2.2.3.5.3" xref="S4.E2.m1.3.3.2.2.3.5.3.cmml">c</mi></msub><mo id="S4.E2.m1.3.3.2.2.3.4" xref="S4.E2.m1.3.3.2.2.3.4.cmml">⁢</mo><mrow id="S4.E2.m1.3.3.2.2.3.3.3" xref="S4.E2.m1.3.3.2.2.3.3.4.cmml"><mo id="S4.E2.m1.3.3.2.2.3.3.3.4" stretchy="false" xref="S4.E2.m1.3.3.2.2.3.3.4.cmml">(</mo><msub id="S4.E2.m1.3.3.2.2.1.1.1.1" xref="S4.E2.m1.3.3.2.2.1.1.1.1.cmml"><mi id="S4.E2.m1.3.3.2.2.1.1.1.1.2" xref="S4.E2.m1.3.3.2.2.1.1.1.1.2.cmml">j</mi><mi id="S4.E2.m1.3.3.2.2.1.1.1.1.3" xref="S4.E2.m1.3.3.2.2.1.1.1.1.3.cmml">I</mi></msub><mo id="S4.E2.m1.3.3.2.2.3.3.3.5" xref="S4.E2.m1.3.3.2.2.3.3.4.cmml">,</mo><msub id="S4.E2.m1.3.3.2.2.2.2.2.2" xref="S4.E2.m1.3.3.2.2.2.2.2.2.cmml"><mi id="S4.E2.m1.3.3.2.2.2.2.2.2.2" xref="S4.E2.m1.3.3.2.2.2.2.2.2.2.cmml">p</mi><mi id="S4.E2.m1.3.3.2.2.2.2.2.2.3" xref="S4.E2.m1.3.3.2.2.2.2.2.2.3.cmml">s</mi></msub><mo id="S4.E2.m1.3.3.2.2.3.3.3.6" xref="S4.E2.m1.3.3.2.2.3.3.4.cmml">,</mo><msub id="S4.E2.m1.3.3.2.2.3.3.3.3" xref="S4.E2.m1.3.3.2.2.3.3.3.3.cmml"><mi id="S4.E2.m1.3.3.2.2.3.3.3.3.2" xref="S4.E2.m1.3.3.2.2.3.3.3.3.2.cmml">o</mi><mi id="S4.E2.m1.3.3.2.2.3.3.3.3.3" xref="S4.E2.m1.3.3.2.2.3.3.3.3.3.cmml">T</mi></msub><mo id="S4.E2.m1.3.3.2.2.3.3.3.7" stretchy="false" xref="S4.E2.m1.3.3.2.2.3.3.4.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E2.m1.3b"><apply id="S4.E2.m1.3.3.3.cmml" xref="S4.E2.m1.3.3.2"><csymbol cd="ambiguous" id="S4.E2.m1.3.3.3a.cmml" xref="S4.E2.m1.3.3.2.3">formulae-sequence</csymbol><apply id="S4.E2.m1.2.2.1.1.cmml" xref="S4.E2.m1.2.2.1.1"><eq id="S4.E2.m1.2.2.1.1.2.cmml" xref="S4.E2.m1.2.2.1.1.2"></eq><apply id="S4.E2.m1.2.2.1.1.3.cmml" xref="S4.E2.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S4.E2.m1.2.2.1.1.3.1.cmml" xref="S4.E2.m1.2.2.1.1.3">subscript</csymbol><apply id="S4.E2.m1.2.2.1.1.3.2.cmml" xref="S4.E2.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S4.E2.m1.2.2.1.1.3.2.1.cmml" xref="S4.E2.m1.2.2.1.1.3">superscript</csymbol><ci id="S4.E2.m1.2.2.1.1.3.2.2.cmml" xref="S4.E2.m1.2.2.1.1.3.2.2">𝑙</ci><ci id="S4.E2.m1.2.2.1.1.3.2.3.cmml" xref="S4.E2.m1.2.2.1.1.3.2.3">′</ci></apply><ci id="S4.E2.m1.2.2.1.1.3.3.cmml" xref="S4.E2.m1.2.2.1.1.3.3">𝑑</ci></apply><apply id="S4.E2.m1.2.2.1.1.1.cmml" xref="S4.E2.m1.2.2.1.1.1"><times id="S4.E2.m1.2.2.1.1.1.2.cmml" xref="S4.E2.m1.2.2.1.1.1.2"></times><apply id="S4.E2.m1.2.2.1.1.1.3.cmml" xref="S4.E2.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.E2.m1.2.2.1.1.1.3.1.cmml" xref="S4.E2.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S4.E2.m1.2.2.1.1.1.3.2.cmml" xref="S4.E2.m1.2.2.1.1.1.3.2">𝑀</ci><ci id="S4.E2.m1.2.2.1.1.1.3.3.cmml" xref="S4.E2.m1.2.2.1.1.1.3.3">𝑐</ci></apply><interval closure="open" id="S4.E2.m1.2.2.1.1.1.1.2.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1"><apply id="S4.E2.m1.2.2.1.1.1.1.1.1.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E2.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.2">𝑙</ci><ci id="S4.E2.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.3">𝑠</ci></apply><ci id="S4.E2.m1.1.1.cmml" xref="S4.E2.m1.1.1">𝐼</ci></interval></apply></apply><apply id="S4.E2.m1.3.3.2.2.cmml" xref="S4.E2.m1.3.3.2.2"><eq id="S4.E2.m1.3.3.2.2.4.cmml" xref="S4.E2.m1.3.3.2.2.4"></eq><apply id="S4.E2.m1.3.3.2.2.5.cmml" xref="S4.E2.m1.3.3.2.2.5"><csymbol cd="ambiguous" id="S4.E2.m1.3.3.2.2.5.1.cmml" xref="S4.E2.m1.3.3.2.2.5">subscript</csymbol><ci id="S4.E2.m1.3.3.2.2.5.2.cmml" xref="S4.E2.m1.3.3.2.2.5.2">𝑙</ci><ci id="S4.E2.m1.3.3.2.2.5.3.cmml" xref="S4.E2.m1.3.3.2.2.5.3">𝑠</ci></apply><apply id="S4.E2.m1.3.3.2.2.3.cmml" xref="S4.E2.m1.3.3.2.2.3"><times id="S4.E2.m1.3.3.2.2.3.4.cmml" xref="S4.E2.m1.3.3.2.2.3.4"></times><apply id="S4.E2.m1.3.3.2.2.3.5.cmml" xref="S4.E2.m1.3.3.2.2.3.5"><csymbol cd="ambiguous" id="S4.E2.m1.3.3.2.2.3.5.1.cmml" xref="S4.E2.m1.3.3.2.2.3.5">subscript</csymbol><ci id="S4.E2.m1.3.3.2.2.3.5.2.cmml" xref="S4.E2.m1.3.3.2.2.3.5.2">𝑀</ci><ci id="S4.E2.m1.3.3.2.2.3.5.3.cmml" xref="S4.E2.m1.3.3.2.2.3.5.3">𝑐</ci></apply><vector id="S4.E2.m1.3.3.2.2.3.3.4.cmml" xref="S4.E2.m1.3.3.2.2.3.3.3"><apply id="S4.E2.m1.3.3.2.2.1.1.1.1.cmml" xref="S4.E2.m1.3.3.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.3.3.2.2.1.1.1.1.1.cmml" xref="S4.E2.m1.3.3.2.2.1.1.1.1">subscript</csymbol><ci id="S4.E2.m1.3.3.2.2.1.1.1.1.2.cmml" xref="S4.E2.m1.3.3.2.2.1.1.1.1.2">𝑗</ci><ci id="S4.E2.m1.3.3.2.2.1.1.1.1.3.cmml" xref="S4.E2.m1.3.3.2.2.1.1.1.1.3">𝐼</ci></apply><apply id="S4.E2.m1.3.3.2.2.2.2.2.2.cmml" xref="S4.E2.m1.3.3.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E2.m1.3.3.2.2.2.2.2.2.1.cmml" xref="S4.E2.m1.3.3.2.2.2.2.2.2">subscript</csymbol><ci id="S4.E2.m1.3.3.2.2.2.2.2.2.2.cmml" xref="S4.E2.m1.3.3.2.2.2.2.2.2.2">𝑝</ci><ci id="S4.E2.m1.3.3.2.2.2.2.2.2.3.cmml" xref="S4.E2.m1.3.3.2.2.2.2.2.2.3">𝑠</ci></apply><apply id="S4.E2.m1.3.3.2.2.3.3.3.3.cmml" xref="S4.E2.m1.3.3.2.2.3.3.3.3"><csymbol cd="ambiguous" id="S4.E2.m1.3.3.2.2.3.3.3.3.1.cmml" xref="S4.E2.m1.3.3.2.2.3.3.3.3">subscript</csymbol><ci id="S4.E2.m1.3.3.2.2.3.3.3.3.2.cmml" xref="S4.E2.m1.3.3.2.2.3.3.3.3.2">𝑜</ci><ci id="S4.E2.m1.3.3.2.2.3.3.3.3.3.cmml" xref="S4.E2.m1.3.3.2.2.3.3.3.3.3">𝑇</ci></apply></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2.m1.3c">l^{\prime}_{d}=M_{c}(l_{s},I),\quad l_{s}=M_{c}(j_{I},p_{s},o_{T})</annotation><annotation encoding="application/x-llamapun" id="S4.E2.m1.3d">italic_l start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT = italic_M start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ( italic_l start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT , italic_I ) , italic_l start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT = italic_M start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ( italic_j start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT , italic_p start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.p3.13">where <math alttext="j_{I}" class="ltx_Math" display="inline" id="S4.SS1.p3.3.m1.1"><semantics id="S4.SS1.p3.3.m1.1a"><msub id="S4.SS1.p3.3.m1.1.1" xref="S4.SS1.p3.3.m1.1.1.cmml"><mi id="S4.SS1.p3.3.m1.1.1.2" xref="S4.SS1.p3.3.m1.1.1.2.cmml">j</mi><mi id="S4.SS1.p3.3.m1.1.1.3" xref="S4.SS1.p3.3.m1.1.1.3.cmml">I</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.3.m1.1b"><apply id="S4.SS1.p3.3.m1.1.1.cmml" xref="S4.SS1.p3.3.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.3.m1.1.1.1.cmml" xref="S4.SS1.p3.3.m1.1.1">subscript</csymbol><ci id="S4.SS1.p3.3.m1.1.1.2.cmml" xref="S4.SS1.p3.3.m1.1.1.2">𝑗</ci><ci id="S4.SS1.p3.3.m1.1.1.3.cmml" xref="S4.SS1.p3.3.m1.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.3.m1.1c">j_{I}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.3.m1.1d">italic_j start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT</annotation></semantics></math> is the object name extracted from instruction <math alttext="I" class="ltx_Math" display="inline" id="S4.SS1.p3.4.m2.1"><semantics id="S4.SS1.p3.4.m2.1a"><mi id="S4.SS1.p3.4.m2.1.1" xref="S4.SS1.p3.4.m2.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.4.m2.1b"><ci id="S4.SS1.p3.4.m2.1.1.cmml" xref="S4.SS1.p3.4.m2.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.4.m2.1c">I</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.4.m2.1d">italic_I</annotation></semantics></math> by a text-processing function, <math alttext="p_{s}" class="ltx_Math" display="inline" id="S4.SS1.p3.5.m3.1"><semantics id="S4.SS1.p3.5.m3.1a"><msub id="S4.SS1.p3.5.m3.1.1" xref="S4.SS1.p3.5.m3.1.1.cmml"><mi id="S4.SS1.p3.5.m3.1.1.2" xref="S4.SS1.p3.5.m3.1.1.2.cmml">p</mi><mi id="S4.SS1.p3.5.m3.1.1.3" xref="S4.SS1.p3.5.m3.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.5.m3.1b"><apply id="S4.SS1.p3.5.m3.1.1.cmml" xref="S4.SS1.p3.5.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.5.m3.1.1.1.cmml" xref="S4.SS1.p3.5.m3.1.1">subscript</csymbol><ci id="S4.SS1.p3.5.m3.1.1.2.cmml" xref="S4.SS1.p3.5.m3.1.1.2">𝑝</ci><ci id="S4.SS1.p3.5.m3.1.1.3.cmml" xref="S4.SS1.p3.5.m3.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.5.m3.1c">p_{s}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.5.m3.1d">italic_p start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> is the prompt for object state analysis, <math alttext="l_{s}" class="ltx_Math" display="inline" id="S4.SS1.p3.6.m4.1"><semantics id="S4.SS1.p3.6.m4.1a"><msub id="S4.SS1.p3.6.m4.1.1" xref="S4.SS1.p3.6.m4.1.1.cmml"><mi id="S4.SS1.p3.6.m4.1.1.2" xref="S4.SS1.p3.6.m4.1.1.2.cmml">l</mi><mi id="S4.SS1.p3.6.m4.1.1.3" xref="S4.SS1.p3.6.m4.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.6.m4.1b"><apply id="S4.SS1.p3.6.m4.1.1.cmml" xref="S4.SS1.p3.6.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.6.m4.1.1.1.cmml" xref="S4.SS1.p3.6.m4.1.1">subscript</csymbol><ci id="S4.SS1.p3.6.m4.1.1.2.cmml" xref="S4.SS1.p3.6.m4.1.1.2">𝑙</ci><ci id="S4.SS1.p3.6.m4.1.1.3.cmml" xref="S4.SS1.p3.6.m4.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.6.m4.1c">l_{s}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.6.m4.1d">italic_l start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> is the analysis result, and <math alttext="M_{c}" class="ltx_Math" display="inline" id="S4.SS1.p3.7.m5.1"><semantics id="S4.SS1.p3.7.m5.1a"><msub id="S4.SS1.p3.7.m5.1.1" xref="S4.SS1.p3.7.m5.1.1.cmml"><mi id="S4.SS1.p3.7.m5.1.1.2" xref="S4.SS1.p3.7.m5.1.1.2.cmml">M</mi><mi id="S4.SS1.p3.7.m5.1.1.3" xref="S4.SS1.p3.7.m5.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.7.m5.1b"><apply id="S4.SS1.p3.7.m5.1.1.cmml" xref="S4.SS1.p3.7.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.7.m5.1.1.1.cmml" xref="S4.SS1.p3.7.m5.1.1">subscript</csymbol><ci id="S4.SS1.p3.7.m5.1.1.2.cmml" xref="S4.SS1.p3.7.m5.1.1.2">𝑀</ci><ci id="S4.SS1.p3.7.m5.1.1.3.cmml" xref="S4.SS1.p3.7.m5.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.7.m5.1c">M_{c}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.7.m5.1d">italic_M start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> provides a new success detection <math alttext="l^{\prime}_{d}" class="ltx_Math" display="inline" id="S4.SS1.p3.8.m6.1"><semantics id="S4.SS1.p3.8.m6.1a"><msubsup id="S4.SS1.p3.8.m6.1.1" xref="S4.SS1.p3.8.m6.1.1.cmml"><mi id="S4.SS1.p3.8.m6.1.1.2.2" xref="S4.SS1.p3.8.m6.1.1.2.2.cmml">l</mi><mi id="S4.SS1.p3.8.m6.1.1.3" xref="S4.SS1.p3.8.m6.1.1.3.cmml">d</mi><mo id="S4.SS1.p3.8.m6.1.1.2.3" xref="S4.SS1.p3.8.m6.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.8.m6.1b"><apply id="S4.SS1.p3.8.m6.1.1.cmml" xref="S4.SS1.p3.8.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.8.m6.1.1.1.cmml" xref="S4.SS1.p3.8.m6.1.1">subscript</csymbol><apply id="S4.SS1.p3.8.m6.1.1.2.cmml" xref="S4.SS1.p3.8.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.8.m6.1.1.2.1.cmml" xref="S4.SS1.p3.8.m6.1.1">superscript</csymbol><ci id="S4.SS1.p3.8.m6.1.1.2.2.cmml" xref="S4.SS1.p3.8.m6.1.1.2.2">𝑙</ci><ci id="S4.SS1.p3.8.m6.1.1.2.3.cmml" xref="S4.SS1.p3.8.m6.1.1.2.3">′</ci></apply><ci id="S4.SS1.p3.8.m6.1.1.3.cmml" xref="S4.SS1.p3.8.m6.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.8.m6.1c">l^{\prime}_{d}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.8.m6.1d">italic_l start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT</annotation></semantics></math> based on <math alttext="l_{s}" class="ltx_Math" display="inline" id="S4.SS1.p3.9.m7.1"><semantics id="S4.SS1.p3.9.m7.1a"><msub id="S4.SS1.p3.9.m7.1.1" xref="S4.SS1.p3.9.m7.1.1.cmml"><mi id="S4.SS1.p3.9.m7.1.1.2" xref="S4.SS1.p3.9.m7.1.1.2.cmml">l</mi><mi id="S4.SS1.p3.9.m7.1.1.3" xref="S4.SS1.p3.9.m7.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.9.m7.1b"><apply id="S4.SS1.p3.9.m7.1.1.cmml" xref="S4.SS1.p3.9.m7.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.9.m7.1.1.1.cmml" xref="S4.SS1.p3.9.m7.1.1">subscript</csymbol><ci id="S4.SS1.p3.9.m7.1.1.2.cmml" xref="S4.SS1.p3.9.m7.1.1.2">𝑙</ci><ci id="S4.SS1.p3.9.m7.1.1.3.cmml" xref="S4.SS1.p3.9.m7.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.9.m7.1c">l_{s}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.9.m7.1d">italic_l start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="I" class="ltx_Math" display="inline" id="S4.SS1.p3.10.m8.1"><semantics id="S4.SS1.p3.10.m8.1a"><mi id="S4.SS1.p3.10.m8.1.1" xref="S4.SS1.p3.10.m8.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.10.m8.1b"><ci id="S4.SS1.p3.10.m8.1.1.cmml" xref="S4.SS1.p3.10.m8.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.10.m8.1c">I</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.10.m8.1d">italic_I</annotation></semantics></math>. The format is corrected to <math alttext="(I,p_{d},o_{T},l^{\prime}_{d})" class="ltx_Math" display="inline" id="S4.SS1.p3.11.m9.4"><semantics id="S4.SS1.p3.11.m9.4a"><mrow id="S4.SS1.p3.11.m9.4.4.3" xref="S4.SS1.p3.11.m9.4.4.4.cmml"><mo id="S4.SS1.p3.11.m9.4.4.3.4" stretchy="false" xref="S4.SS1.p3.11.m9.4.4.4.cmml">(</mo><mi id="S4.SS1.p3.11.m9.1.1" xref="S4.SS1.p3.11.m9.1.1.cmml">I</mi><mo id="S4.SS1.p3.11.m9.4.4.3.5" xref="S4.SS1.p3.11.m9.4.4.4.cmml">,</mo><msub id="S4.SS1.p3.11.m9.2.2.1.1" xref="S4.SS1.p3.11.m9.2.2.1.1.cmml"><mi id="S4.SS1.p3.11.m9.2.2.1.1.2" xref="S4.SS1.p3.11.m9.2.2.1.1.2.cmml">p</mi><mi id="S4.SS1.p3.11.m9.2.2.1.1.3" xref="S4.SS1.p3.11.m9.2.2.1.1.3.cmml">d</mi></msub><mo id="S4.SS1.p3.11.m9.4.4.3.6" xref="S4.SS1.p3.11.m9.4.4.4.cmml">,</mo><msub id="S4.SS1.p3.11.m9.3.3.2.2" xref="S4.SS1.p3.11.m9.3.3.2.2.cmml"><mi id="S4.SS1.p3.11.m9.3.3.2.2.2" xref="S4.SS1.p3.11.m9.3.3.2.2.2.cmml">o</mi><mi id="S4.SS1.p3.11.m9.3.3.2.2.3" xref="S4.SS1.p3.11.m9.3.3.2.2.3.cmml">T</mi></msub><mo id="S4.SS1.p3.11.m9.4.4.3.7" xref="S4.SS1.p3.11.m9.4.4.4.cmml">,</mo><msubsup id="S4.SS1.p3.11.m9.4.4.3.3" xref="S4.SS1.p3.11.m9.4.4.3.3.cmml"><mi id="S4.SS1.p3.11.m9.4.4.3.3.2.2" xref="S4.SS1.p3.11.m9.4.4.3.3.2.2.cmml">l</mi><mi id="S4.SS1.p3.11.m9.4.4.3.3.3" xref="S4.SS1.p3.11.m9.4.4.3.3.3.cmml">d</mi><mo id="S4.SS1.p3.11.m9.4.4.3.3.2.3" xref="S4.SS1.p3.11.m9.4.4.3.3.2.3.cmml">′</mo></msubsup><mo id="S4.SS1.p3.11.m9.4.4.3.8" stretchy="false" xref="S4.SS1.p3.11.m9.4.4.4.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.11.m9.4b"><vector id="S4.SS1.p3.11.m9.4.4.4.cmml" xref="S4.SS1.p3.11.m9.4.4.3"><ci id="S4.SS1.p3.11.m9.1.1.cmml" xref="S4.SS1.p3.11.m9.1.1">𝐼</ci><apply id="S4.SS1.p3.11.m9.2.2.1.1.cmml" xref="S4.SS1.p3.11.m9.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.11.m9.2.2.1.1.1.cmml" xref="S4.SS1.p3.11.m9.2.2.1.1">subscript</csymbol><ci id="S4.SS1.p3.11.m9.2.2.1.1.2.cmml" xref="S4.SS1.p3.11.m9.2.2.1.1.2">𝑝</ci><ci id="S4.SS1.p3.11.m9.2.2.1.1.3.cmml" xref="S4.SS1.p3.11.m9.2.2.1.1.3">𝑑</ci></apply><apply id="S4.SS1.p3.11.m9.3.3.2.2.cmml" xref="S4.SS1.p3.11.m9.3.3.2.2"><csymbol cd="ambiguous" id="S4.SS1.p3.11.m9.3.3.2.2.1.cmml" xref="S4.SS1.p3.11.m9.3.3.2.2">subscript</csymbol><ci id="S4.SS1.p3.11.m9.3.3.2.2.2.cmml" xref="S4.SS1.p3.11.m9.3.3.2.2.2">𝑜</ci><ci id="S4.SS1.p3.11.m9.3.3.2.2.3.cmml" xref="S4.SS1.p3.11.m9.3.3.2.2.3">𝑇</ci></apply><apply id="S4.SS1.p3.11.m9.4.4.3.3.cmml" xref="S4.SS1.p3.11.m9.4.4.3.3"><csymbol cd="ambiguous" id="S4.SS1.p3.11.m9.4.4.3.3.1.cmml" xref="S4.SS1.p3.11.m9.4.4.3.3">subscript</csymbol><apply id="S4.SS1.p3.11.m9.4.4.3.3.2.cmml" xref="S4.SS1.p3.11.m9.4.4.3.3"><csymbol cd="ambiguous" id="S4.SS1.p3.11.m9.4.4.3.3.2.1.cmml" xref="S4.SS1.p3.11.m9.4.4.3.3">superscript</csymbol><ci id="S4.SS1.p3.11.m9.4.4.3.3.2.2.cmml" xref="S4.SS1.p3.11.m9.4.4.3.3.2.2">𝑙</ci><ci id="S4.SS1.p3.11.m9.4.4.3.3.2.3.cmml" xref="S4.SS1.p3.11.m9.4.4.3.3.2.3">′</ci></apply><ci id="S4.SS1.p3.11.m9.4.4.3.3.3.cmml" xref="S4.SS1.p3.11.m9.4.4.3.3.3">𝑑</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.11.m9.4c">(I,p_{d},o_{T},l^{\prime}_{d})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.11.m9.4d">( italic_I , italic_p start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT , italic_l start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT )</annotation></semantics></math> and will be stored into the critic fine-tuning dataset <math alttext="\mathcal{D}_{\rm critic}" class="ltx_Math" display="inline" id="S4.SS1.p3.12.m10.1"><semantics id="S4.SS1.p3.12.m10.1a"><msub id="S4.SS1.p3.12.m10.1.1" xref="S4.SS1.p3.12.m10.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p3.12.m10.1.1.2" xref="S4.SS1.p3.12.m10.1.1.2.cmml">𝒟</mi><mi id="S4.SS1.p3.12.m10.1.1.3" xref="S4.SS1.p3.12.m10.1.1.3.cmml">critic</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.12.m10.1b"><apply id="S4.SS1.p3.12.m10.1.1.cmml" xref="S4.SS1.p3.12.m10.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.12.m10.1.1.1.cmml" xref="S4.SS1.p3.12.m10.1.1">subscript</csymbol><ci id="S4.SS1.p3.12.m10.1.1.2.cmml" xref="S4.SS1.p3.12.m10.1.1.2">𝒟</ci><ci id="S4.SS1.p3.12.m10.1.1.3.cmml" xref="S4.SS1.p3.12.m10.1.1.3">critic</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.12.m10.1c">\mathcal{D}_{\rm critic}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.12.m10.1d">caligraphic_D start_POSTSUBSCRIPT roman_critic end_POSTSUBSCRIPT</annotation></semantics></math> if <math alttext="l_{d}^{\prime}=``yes&quot;" class="ltx_Math" display="inline" id="S4.SS1.p3.13.m11.1"><semantics id="S4.SS1.p3.13.m11.1a"><mrow id="S4.SS1.p3.13.m11.1.1" xref="S4.SS1.p3.13.m11.1.1.cmml"><msubsup id="S4.SS1.p3.13.m11.1.1.2" xref="S4.SS1.p3.13.m11.1.1.2.cmml"><mi id="S4.SS1.p3.13.m11.1.1.2.2.2" xref="S4.SS1.p3.13.m11.1.1.2.2.2.cmml">l</mi><mi id="S4.SS1.p3.13.m11.1.1.2.2.3" xref="S4.SS1.p3.13.m11.1.1.2.2.3.cmml">d</mi><mo id="S4.SS1.p3.13.m11.1.1.2.3" xref="S4.SS1.p3.13.m11.1.1.2.3.cmml">′</mo></msubsup><mo id="S4.SS1.p3.13.m11.1.1.1" xref="S4.SS1.p3.13.m11.1.1.1.cmml">=</mo><mrow id="S4.SS1.p3.13.m11.1.1.3" xref="S4.SS1.p3.13.m11.1.1.3.cmml"><mi id="S4.SS1.p3.13.m11.1.1.3.2" mathvariant="normal" xref="S4.SS1.p3.13.m11.1.1.3.2.cmml">`</mi><mo id="S4.SS1.p3.13.m11.1.1.3.1" xref="S4.SS1.p3.13.m11.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p3.13.m11.1.1.3.3" mathvariant="normal" xref="S4.SS1.p3.13.m11.1.1.3.3.cmml">`</mi><mo id="S4.SS1.p3.13.m11.1.1.3.1a" xref="S4.SS1.p3.13.m11.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p3.13.m11.1.1.3.4" xref="S4.SS1.p3.13.m11.1.1.3.4.cmml">y</mi><mo id="S4.SS1.p3.13.m11.1.1.3.1b" xref="S4.SS1.p3.13.m11.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p3.13.m11.1.1.3.5" xref="S4.SS1.p3.13.m11.1.1.3.5.cmml">e</mi><mo id="S4.SS1.p3.13.m11.1.1.3.1c" xref="S4.SS1.p3.13.m11.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p3.13.m11.1.1.3.6" xref="S4.SS1.p3.13.m11.1.1.3.6.cmml">s</mi><mo id="S4.SS1.p3.13.m11.1.1.3.1d" xref="S4.SS1.p3.13.m11.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p3.13.m11.1.1.3.7" mathvariant="normal" xref="S4.SS1.p3.13.m11.1.1.3.7.cmml">"</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.13.m11.1b"><apply id="S4.SS1.p3.13.m11.1.1.cmml" xref="S4.SS1.p3.13.m11.1.1"><eq id="S4.SS1.p3.13.m11.1.1.1.cmml" xref="S4.SS1.p3.13.m11.1.1.1"></eq><apply id="S4.SS1.p3.13.m11.1.1.2.cmml" xref="S4.SS1.p3.13.m11.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p3.13.m11.1.1.2.1.cmml" xref="S4.SS1.p3.13.m11.1.1.2">superscript</csymbol><apply id="S4.SS1.p3.13.m11.1.1.2.2.cmml" xref="S4.SS1.p3.13.m11.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p3.13.m11.1.1.2.2.1.cmml" xref="S4.SS1.p3.13.m11.1.1.2">subscript</csymbol><ci id="S4.SS1.p3.13.m11.1.1.2.2.2.cmml" xref="S4.SS1.p3.13.m11.1.1.2.2.2">𝑙</ci><ci id="S4.SS1.p3.13.m11.1.1.2.2.3.cmml" xref="S4.SS1.p3.13.m11.1.1.2.2.3">𝑑</ci></apply><ci id="S4.SS1.p3.13.m11.1.1.2.3.cmml" xref="S4.SS1.p3.13.m11.1.1.2.3">′</ci></apply><apply id="S4.SS1.p3.13.m11.1.1.3.cmml" xref="S4.SS1.p3.13.m11.1.1.3"><times id="S4.SS1.p3.13.m11.1.1.3.1.cmml" xref="S4.SS1.p3.13.m11.1.1.3.1"></times><ci id="S4.SS1.p3.13.m11.1.1.3.2.cmml" xref="S4.SS1.p3.13.m11.1.1.3.2">`</ci><ci id="S4.SS1.p3.13.m11.1.1.3.3.cmml" xref="S4.SS1.p3.13.m11.1.1.3.3">`</ci><ci id="S4.SS1.p3.13.m11.1.1.3.4.cmml" xref="S4.SS1.p3.13.m11.1.1.3.4">𝑦</ci><ci id="S4.SS1.p3.13.m11.1.1.3.5.cmml" xref="S4.SS1.p3.13.m11.1.1.3.5">𝑒</ci><ci id="S4.SS1.p3.13.m11.1.1.3.6.cmml" xref="S4.SS1.p3.13.m11.1.1.3.6">𝑠</ci><ci id="S4.SS1.p3.13.m11.1.1.3.7.cmml" xref="S4.SS1.p3.13.m11.1.1.3.7">"</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.13.m11.1c">l_{d}^{\prime}=``yes"</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.13.m11.1d">italic_l start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = ` ` italic_y italic_e italic_s "</annotation></semantics></math>. For example, in trajectory 2 of Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#S3.F2" title="Figure 2 ‣ 3.2 Actor-Critic for MLLMs ‣ 3 Preliminaries ‣ SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_tag">2</span></a>, the critic MLLM initially misjudged the completion of the “open cabinet" task. However, when prompted to focus on the state of the cabinet, it successfully self-corrected its judgment.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p4">
<p class="ltx_p" id="S4.SS1.p4.13">If the critic MLLM still considers the trajectory as failure, we propose to use <span class="ltx_text ltx_font_bold" id="S4.SS1.p4.13.1">hindsight relabeling</span> to make use of this trajectory, since it might be helpful for learning the environmental grounding of other instructions. Hindsight relabeling is a method that originated in goal-conditioned reinforcement learning <cite class="ltx_cite ltx_citemacro_citep">(Andrychowicz et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib1" title="">2017</a>)</cite>. It is based on a simple principle: if a trajectory does not complete the target task, it can be viewed as having accomplished other tasks or subtasks. For example, as shown in trajectory 3 in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#S3.F2" title="Figure 2 ‣ 3.2 Actor-Critic for MLLMs ‣ 3 Preliminaries ‣ SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_tag">2</span></a>, although it does not complete the task “open cabinet", it successfully completes another task “open drawer". Therefore, we relabel this trajectory with the instruction “open drawer" to help the critic MLLM recognize the completion of the relabeled instruction. We can write this process as,</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S4.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="I^{\prime}=M_{c}(l_{h},a_{I}),\quad l_{h}=M_{c}(a_{I},p_{h},o_{T})" class="ltx_Math" display="block" id="S4.E3.m1.2"><semantics id="S4.E3.m1.2a"><mrow id="S4.E3.m1.2.2.2" xref="S4.E3.m1.2.2.3.cmml"><mrow id="S4.E3.m1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.cmml"><msup id="S4.E3.m1.1.1.1.1.4" xref="S4.E3.m1.1.1.1.1.4.cmml"><mi id="S4.E3.m1.1.1.1.1.4.2" xref="S4.E3.m1.1.1.1.1.4.2.cmml">I</mi><mo id="S4.E3.m1.1.1.1.1.4.3" xref="S4.E3.m1.1.1.1.1.4.3.cmml">′</mo></msup><mo id="S4.E3.m1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.3.cmml">=</mo><mrow id="S4.E3.m1.1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.2.cmml"><msub id="S4.E3.m1.1.1.1.1.2.4" xref="S4.E3.m1.1.1.1.1.2.4.cmml"><mi id="S4.E3.m1.1.1.1.1.2.4.2" xref="S4.E3.m1.1.1.1.1.2.4.2.cmml">M</mi><mi id="S4.E3.m1.1.1.1.1.2.4.3" xref="S4.E3.m1.1.1.1.1.2.4.3.cmml">c</mi></msub><mo id="S4.E3.m1.1.1.1.1.2.3" xref="S4.E3.m1.1.1.1.1.2.3.cmml">⁢</mo><mrow id="S4.E3.m1.1.1.1.1.2.2.2" xref="S4.E3.m1.1.1.1.1.2.2.3.cmml"><mo id="S4.E3.m1.1.1.1.1.2.2.2.3" stretchy="false" xref="S4.E3.m1.1.1.1.1.2.2.3.cmml">(</mo><msub id="S4.E3.m1.1.1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E3.m1.1.1.1.1.1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.cmml">l</mi><mi id="S4.E3.m1.1.1.1.1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.3.cmml">h</mi></msub><mo id="S4.E3.m1.1.1.1.1.2.2.2.4" xref="S4.E3.m1.1.1.1.1.2.2.3.cmml">,</mo><msub id="S4.E3.m1.1.1.1.1.2.2.2.2" xref="S4.E3.m1.1.1.1.1.2.2.2.2.cmml"><mi id="S4.E3.m1.1.1.1.1.2.2.2.2.2" xref="S4.E3.m1.1.1.1.1.2.2.2.2.2.cmml">a</mi><mi id="S4.E3.m1.1.1.1.1.2.2.2.2.3" xref="S4.E3.m1.1.1.1.1.2.2.2.2.3.cmml">I</mi></msub><mo id="S4.E3.m1.1.1.1.1.2.2.2.5" stretchy="false" xref="S4.E3.m1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E3.m1.2.2.2.3" rspace="1.167em" xref="S4.E3.m1.2.2.3a.cmml">,</mo><mrow id="S4.E3.m1.2.2.2.2" xref="S4.E3.m1.2.2.2.2.cmml"><msub id="S4.E3.m1.2.2.2.2.5" xref="S4.E3.m1.2.2.2.2.5.cmml"><mi id="S4.E3.m1.2.2.2.2.5.2" xref="S4.E3.m1.2.2.2.2.5.2.cmml">l</mi><mi id="S4.E3.m1.2.2.2.2.5.3" xref="S4.E3.m1.2.2.2.2.5.3.cmml">h</mi></msub><mo id="S4.E3.m1.2.2.2.2.4" xref="S4.E3.m1.2.2.2.2.4.cmml">=</mo><mrow id="S4.E3.m1.2.2.2.2.3" xref="S4.E3.m1.2.2.2.2.3.cmml"><msub id="S4.E3.m1.2.2.2.2.3.5" xref="S4.E3.m1.2.2.2.2.3.5.cmml"><mi id="S4.E3.m1.2.2.2.2.3.5.2" xref="S4.E3.m1.2.2.2.2.3.5.2.cmml">M</mi><mi id="S4.E3.m1.2.2.2.2.3.5.3" xref="S4.E3.m1.2.2.2.2.3.5.3.cmml">c</mi></msub><mo id="S4.E3.m1.2.2.2.2.3.4" xref="S4.E3.m1.2.2.2.2.3.4.cmml">⁢</mo><mrow id="S4.E3.m1.2.2.2.2.3.3.3" xref="S4.E3.m1.2.2.2.2.3.3.4.cmml"><mo id="S4.E3.m1.2.2.2.2.3.3.3.4" stretchy="false" xref="S4.E3.m1.2.2.2.2.3.3.4.cmml">(</mo><msub id="S4.E3.m1.2.2.2.2.1.1.1.1" xref="S4.E3.m1.2.2.2.2.1.1.1.1.cmml"><mi id="S4.E3.m1.2.2.2.2.1.1.1.1.2" xref="S4.E3.m1.2.2.2.2.1.1.1.1.2.cmml">a</mi><mi id="S4.E3.m1.2.2.2.2.1.1.1.1.3" xref="S4.E3.m1.2.2.2.2.1.1.1.1.3.cmml">I</mi></msub><mo id="S4.E3.m1.2.2.2.2.3.3.3.5" xref="S4.E3.m1.2.2.2.2.3.3.4.cmml">,</mo><msub id="S4.E3.m1.2.2.2.2.2.2.2.2" xref="S4.E3.m1.2.2.2.2.2.2.2.2.cmml"><mi id="S4.E3.m1.2.2.2.2.2.2.2.2.2" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2.cmml">p</mi><mi id="S4.E3.m1.2.2.2.2.2.2.2.2.3" xref="S4.E3.m1.2.2.2.2.2.2.2.2.3.cmml">h</mi></msub><mo id="S4.E3.m1.2.2.2.2.3.3.3.6" xref="S4.E3.m1.2.2.2.2.3.3.4.cmml">,</mo><msub id="S4.E3.m1.2.2.2.2.3.3.3.3" xref="S4.E3.m1.2.2.2.2.3.3.3.3.cmml"><mi id="S4.E3.m1.2.2.2.2.3.3.3.3.2" xref="S4.E3.m1.2.2.2.2.3.3.3.3.2.cmml">o</mi><mi id="S4.E3.m1.2.2.2.2.3.3.3.3.3" xref="S4.E3.m1.2.2.2.2.3.3.3.3.3.cmml">T</mi></msub><mo id="S4.E3.m1.2.2.2.2.3.3.3.7" stretchy="false" xref="S4.E3.m1.2.2.2.2.3.3.4.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E3.m1.2b"><apply id="S4.E3.m1.2.2.3.cmml" xref="S4.E3.m1.2.2.2"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.3a.cmml" xref="S4.E3.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S4.E3.m1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1"><eq id="S4.E3.m1.1.1.1.1.3.cmml" xref="S4.E3.m1.1.1.1.1.3"></eq><apply id="S4.E3.m1.1.1.1.1.4.cmml" xref="S4.E3.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.4.1.cmml" xref="S4.E3.m1.1.1.1.1.4">superscript</csymbol><ci id="S4.E3.m1.1.1.1.1.4.2.cmml" xref="S4.E3.m1.1.1.1.1.4.2">𝐼</ci><ci id="S4.E3.m1.1.1.1.1.4.3.cmml" xref="S4.E3.m1.1.1.1.1.4.3">′</ci></apply><apply id="S4.E3.m1.1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.1.2"><times id="S4.E3.m1.1.1.1.1.2.3.cmml" xref="S4.E3.m1.1.1.1.1.2.3"></times><apply id="S4.E3.m1.1.1.1.1.2.4.cmml" xref="S4.E3.m1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.2.4.1.cmml" xref="S4.E3.m1.1.1.1.1.2.4">subscript</csymbol><ci id="S4.E3.m1.1.1.1.1.2.4.2.cmml" xref="S4.E3.m1.1.1.1.1.2.4.2">𝑀</ci><ci id="S4.E3.m1.1.1.1.1.2.4.3.cmml" xref="S4.E3.m1.1.1.1.1.2.4.3">𝑐</ci></apply><interval closure="open" id="S4.E3.m1.1.1.1.1.2.2.3.cmml" xref="S4.E3.m1.1.1.1.1.2.2.2"><apply id="S4.E3.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2">𝑙</ci><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.3">ℎ</ci></apply><apply id="S4.E3.m1.1.1.1.1.2.2.2.2.cmml" xref="S4.E3.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S4.E3.m1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S4.E3.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S4.E3.m1.1.1.1.1.2.2.2.2.2">𝑎</ci><ci id="S4.E3.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S4.E3.m1.1.1.1.1.2.2.2.2.3">𝐼</ci></apply></interval></apply></apply><apply id="S4.E3.m1.2.2.2.2.cmml" xref="S4.E3.m1.2.2.2.2"><eq id="S4.E3.m1.2.2.2.2.4.cmml" xref="S4.E3.m1.2.2.2.2.4"></eq><apply id="S4.E3.m1.2.2.2.2.5.cmml" xref="S4.E3.m1.2.2.2.2.5"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.2.2.5.1.cmml" xref="S4.E3.m1.2.2.2.2.5">subscript</csymbol><ci id="S4.E3.m1.2.2.2.2.5.2.cmml" xref="S4.E3.m1.2.2.2.2.5.2">𝑙</ci><ci id="S4.E3.m1.2.2.2.2.5.3.cmml" xref="S4.E3.m1.2.2.2.2.5.3">ℎ</ci></apply><apply id="S4.E3.m1.2.2.2.2.3.cmml" xref="S4.E3.m1.2.2.2.2.3"><times id="S4.E3.m1.2.2.2.2.3.4.cmml" xref="S4.E3.m1.2.2.2.2.3.4"></times><apply id="S4.E3.m1.2.2.2.2.3.5.cmml" xref="S4.E3.m1.2.2.2.2.3.5"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.2.2.3.5.1.cmml" xref="S4.E3.m1.2.2.2.2.3.5">subscript</csymbol><ci id="S4.E3.m1.2.2.2.2.3.5.2.cmml" xref="S4.E3.m1.2.2.2.2.3.5.2">𝑀</ci><ci id="S4.E3.m1.2.2.2.2.3.5.3.cmml" xref="S4.E3.m1.2.2.2.2.3.5.3">𝑐</ci></apply><vector id="S4.E3.m1.2.2.2.2.3.3.4.cmml" xref="S4.E3.m1.2.2.2.2.3.3.3"><apply id="S4.E3.m1.2.2.2.2.1.1.1.1.cmml" xref="S4.E3.m1.2.2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.2.2.1.1.1.1.1.cmml" xref="S4.E3.m1.2.2.2.2.1.1.1.1">subscript</csymbol><ci id="S4.E3.m1.2.2.2.2.1.1.1.1.2.cmml" xref="S4.E3.m1.2.2.2.2.1.1.1.1.2">𝑎</ci><ci id="S4.E3.m1.2.2.2.2.1.1.1.1.3.cmml" xref="S4.E3.m1.2.2.2.2.1.1.1.1.3">𝐼</ci></apply><apply id="S4.E3.m1.2.2.2.2.2.2.2.2.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.2.2.2.2.2.2.1.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="S4.E3.m1.2.2.2.2.2.2.2.2.2.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2.2">𝑝</ci><ci id="S4.E3.m1.2.2.2.2.2.2.2.2.3.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2.3">ℎ</ci></apply><apply id="S4.E3.m1.2.2.2.2.3.3.3.3.cmml" xref="S4.E3.m1.2.2.2.2.3.3.3.3"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.2.2.3.3.3.3.1.cmml" xref="S4.E3.m1.2.2.2.2.3.3.3.3">subscript</csymbol><ci id="S4.E3.m1.2.2.2.2.3.3.3.3.2.cmml" xref="S4.E3.m1.2.2.2.2.3.3.3.3.2">𝑜</ci><ci id="S4.E3.m1.2.2.2.2.3.3.3.3.3.cmml" xref="S4.E3.m1.2.2.2.2.3.3.3.3.3">𝑇</ci></apply></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m1.2c">I^{\prime}=M_{c}(l_{h},a_{I}),\quad l_{h}=M_{c}(a_{I},p_{h},o_{T})</annotation><annotation encoding="application/x-llamapun" id="S4.E3.m1.2d">italic_I start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = italic_M start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ( italic_l start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT ) , italic_l start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT = italic_M start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT , italic_p start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.p4.12">where <math alttext="a_{I}" class="ltx_Math" display="inline" id="S4.SS1.p4.1.m1.1"><semantics id="S4.SS1.p4.1.m1.1a"><msub id="S4.SS1.p4.1.m1.1.1" xref="S4.SS1.p4.1.m1.1.1.cmml"><mi id="S4.SS1.p4.1.m1.1.1.2" xref="S4.SS1.p4.1.m1.1.1.2.cmml">a</mi><mi id="S4.SS1.p4.1.m1.1.1.3" xref="S4.SS1.p4.1.m1.1.1.3.cmml">I</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.1.m1.1b"><apply id="S4.SS1.p4.1.m1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p4.1.m1.1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.p4.1.m1.1.1.2.cmml" xref="S4.SS1.p4.1.m1.1.1.2">𝑎</ci><ci id="S4.SS1.p4.1.m1.1.1.3.cmml" xref="S4.SS1.p4.1.m1.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.1.m1.1c">a_{I}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.1.m1.1d">italic_a start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT</annotation></semantics></math> is the verb extracted from the instruction <math alttext="I" class="ltx_Math" display="inline" id="S4.SS1.p4.2.m2.1"><semantics id="S4.SS1.p4.2.m2.1a"><mi id="S4.SS1.p4.2.m2.1.1" xref="S4.SS1.p4.2.m2.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.2.m2.1b"><ci id="S4.SS1.p4.2.m2.1.1.cmml" xref="S4.SS1.p4.2.m2.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.2.m2.1c">I</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.2.m2.1d">italic_I</annotation></semantics></math> by another text-processing function. <math alttext="p_{h}" class="ltx_Math" display="inline" id="S4.SS1.p4.3.m3.1"><semantics id="S4.SS1.p4.3.m3.1a"><msub id="S4.SS1.p4.3.m3.1.1" xref="S4.SS1.p4.3.m3.1.1.cmml"><mi id="S4.SS1.p4.3.m3.1.1.2" xref="S4.SS1.p4.3.m3.1.1.2.cmml">p</mi><mi id="S4.SS1.p4.3.m3.1.1.3" xref="S4.SS1.p4.3.m3.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.3.m3.1b"><apply id="S4.SS1.p4.3.m3.1.1.cmml" xref="S4.SS1.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p4.3.m3.1.1.1.cmml" xref="S4.SS1.p4.3.m3.1.1">subscript</csymbol><ci id="S4.SS1.p4.3.m3.1.1.2.cmml" xref="S4.SS1.p4.3.m3.1.1.2">𝑝</ci><ci id="S4.SS1.p4.3.m3.1.1.3.cmml" xref="S4.SS1.p4.3.m3.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.3.m3.1c">p_{h}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.3.m3.1d">italic_p start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT</annotation></semantics></math> is the prompt for hindsight relabeling, and <math alttext="l_{h}" class="ltx_Math" display="inline" id="S4.SS1.p4.4.m4.1"><semantics id="S4.SS1.p4.4.m4.1a"><msub id="S4.SS1.p4.4.m4.1.1" xref="S4.SS1.p4.4.m4.1.1.cmml"><mi id="S4.SS1.p4.4.m4.1.1.2" xref="S4.SS1.p4.4.m4.1.1.2.cmml">l</mi><mi id="S4.SS1.p4.4.m4.1.1.3" xref="S4.SS1.p4.4.m4.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.4.m4.1b"><apply id="S4.SS1.p4.4.m4.1.1.cmml" xref="S4.SS1.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p4.4.m4.1.1.1.cmml" xref="S4.SS1.p4.4.m4.1.1">subscript</csymbol><ci id="S4.SS1.p4.4.m4.1.1.2.cmml" xref="S4.SS1.p4.4.m4.1.1.2">𝑙</ci><ci id="S4.SS1.p4.4.m4.1.1.3.cmml" xref="S4.SS1.p4.4.m4.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.4.m4.1c">l_{h}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.4.m4.1d">italic_l start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT</annotation></semantics></math> is the output, which is usually an object name or None. <math alttext="M_{c}" class="ltx_Math" display="inline" id="S4.SS1.p4.5.m5.1"><semantics id="S4.SS1.p4.5.m5.1a"><msub id="S4.SS1.p4.5.m5.1.1" xref="S4.SS1.p4.5.m5.1.1.cmml"><mi id="S4.SS1.p4.5.m5.1.1.2" xref="S4.SS1.p4.5.m5.1.1.2.cmml">M</mi><mi id="S4.SS1.p4.5.m5.1.1.3" xref="S4.SS1.p4.5.m5.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.5.m5.1b"><apply id="S4.SS1.p4.5.m5.1.1.cmml" xref="S4.SS1.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p4.5.m5.1.1.1.cmml" xref="S4.SS1.p4.5.m5.1.1">subscript</csymbol><ci id="S4.SS1.p4.5.m5.1.1.2.cmml" xref="S4.SS1.p4.5.m5.1.1.2">𝑀</ci><ci id="S4.SS1.p4.5.m5.1.1.3.cmml" xref="S4.SS1.p4.5.m5.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.5.m5.1c">M_{c}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.5.m5.1d">italic_M start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> checks whether any objects, other than the target object, in the observation <math alttext="o_{T}" class="ltx_Math" display="inline" id="S4.SS1.p4.6.m6.1"><semantics id="S4.SS1.p4.6.m6.1a"><msub id="S4.SS1.p4.6.m6.1.1" xref="S4.SS1.p4.6.m6.1.1.cmml"><mi id="S4.SS1.p4.6.m6.1.1.2" xref="S4.SS1.p4.6.m6.1.1.2.cmml">o</mi><mi id="S4.SS1.p4.6.m6.1.1.3" xref="S4.SS1.p4.6.m6.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.6.m6.1b"><apply id="S4.SS1.p4.6.m6.1.1.cmml" xref="S4.SS1.p4.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.p4.6.m6.1.1.1.cmml" xref="S4.SS1.p4.6.m6.1.1">subscript</csymbol><ci id="S4.SS1.p4.6.m6.1.1.2.cmml" xref="S4.SS1.p4.6.m6.1.1.2">𝑜</ci><ci id="S4.SS1.p4.6.m6.1.1.3.cmml" xref="S4.SS1.p4.6.m6.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.6.m6.1c">o_{T}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.6.m6.1d">italic_o start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT</annotation></semantics></math> have completed the task associated with <math alttext="a_{I}" class="ltx_Math" display="inline" id="S4.SS1.p4.7.m7.1"><semantics id="S4.SS1.p4.7.m7.1a"><msub id="S4.SS1.p4.7.m7.1.1" xref="S4.SS1.p4.7.m7.1.1.cmml"><mi id="S4.SS1.p4.7.m7.1.1.2" xref="S4.SS1.p4.7.m7.1.1.2.cmml">a</mi><mi id="S4.SS1.p4.7.m7.1.1.3" xref="S4.SS1.p4.7.m7.1.1.3.cmml">I</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.7.m7.1b"><apply id="S4.SS1.p4.7.m7.1.1.cmml" xref="S4.SS1.p4.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS1.p4.7.m7.1.1.1.cmml" xref="S4.SS1.p4.7.m7.1.1">subscript</csymbol><ci id="S4.SS1.p4.7.m7.1.1.2.cmml" xref="S4.SS1.p4.7.m7.1.1.2">𝑎</ci><ci id="S4.SS1.p4.7.m7.1.1.3.cmml" xref="S4.SS1.p4.7.m7.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.7.m7.1c">a_{I}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.7.m7.1d">italic_a start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT</annotation></semantics></math>. <math alttext="M_{c}" class="ltx_Math" display="inline" id="S4.SS1.p4.8.m8.1"><semantics id="S4.SS1.p4.8.m8.1a"><msub id="S4.SS1.p4.8.m8.1.1" xref="S4.SS1.p4.8.m8.1.1.cmml"><mi id="S4.SS1.p4.8.m8.1.1.2" xref="S4.SS1.p4.8.m8.1.1.2.cmml">M</mi><mi id="S4.SS1.p4.8.m8.1.1.3" xref="S4.SS1.p4.8.m8.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.8.m8.1b"><apply id="S4.SS1.p4.8.m8.1.1.cmml" xref="S4.SS1.p4.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS1.p4.8.m8.1.1.1.cmml" xref="S4.SS1.p4.8.m8.1.1">subscript</csymbol><ci id="S4.SS1.p4.8.m8.1.1.2.cmml" xref="S4.SS1.p4.8.m8.1.1.2">𝑀</ci><ci id="S4.SS1.p4.8.m8.1.1.3.cmml" xref="S4.SS1.p4.8.m8.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.8.m8.1c">M_{c}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.8.m8.1d">italic_M start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> generates a new instruction <math alttext="I^{\prime}" class="ltx_Math" display="inline" id="S4.SS1.p4.9.m9.1"><semantics id="S4.SS1.p4.9.m9.1a"><msup id="S4.SS1.p4.9.m9.1.1" xref="S4.SS1.p4.9.m9.1.1.cmml"><mi id="S4.SS1.p4.9.m9.1.1.2" xref="S4.SS1.p4.9.m9.1.1.2.cmml">I</mi><mo id="S4.SS1.p4.9.m9.1.1.3" xref="S4.SS1.p4.9.m9.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.9.m9.1b"><apply id="S4.SS1.p4.9.m9.1.1.cmml" xref="S4.SS1.p4.9.m9.1.1"><csymbol cd="ambiguous" id="S4.SS1.p4.9.m9.1.1.1.cmml" xref="S4.SS1.p4.9.m9.1.1">superscript</csymbol><ci id="S4.SS1.p4.9.m9.1.1.2.cmml" xref="S4.SS1.p4.9.m9.1.1.2">𝐼</ci><ci id="S4.SS1.p4.9.m9.1.1.3.cmml" xref="S4.SS1.p4.9.m9.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.9.m9.1c">I^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.9.m9.1d">italic_I start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> if <math alttext="l_{h}" class="ltx_Math" display="inline" id="S4.SS1.p4.10.m10.1"><semantics id="S4.SS1.p4.10.m10.1a"><msub id="S4.SS1.p4.10.m10.1.1" xref="S4.SS1.p4.10.m10.1.1.cmml"><mi id="S4.SS1.p4.10.m10.1.1.2" xref="S4.SS1.p4.10.m10.1.1.2.cmml">l</mi><mi id="S4.SS1.p4.10.m10.1.1.3" xref="S4.SS1.p4.10.m10.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.10.m10.1b"><apply id="S4.SS1.p4.10.m10.1.1.cmml" xref="S4.SS1.p4.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS1.p4.10.m10.1.1.1.cmml" xref="S4.SS1.p4.10.m10.1.1">subscript</csymbol><ci id="S4.SS1.p4.10.m10.1.1.2.cmml" xref="S4.SS1.p4.10.m10.1.1.2">𝑙</ci><ci id="S4.SS1.p4.10.m10.1.1.3.cmml" xref="S4.SS1.p4.10.m10.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.10.m10.1c">l_{h}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.10.m10.1d">italic_l start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT</annotation></semantics></math> is not None. After that, we store the data <math alttext="(I^{\prime},p_{d},o_{T},``yes&quot;)" class="ltx_Math" display="inline" id="S4.SS1.p4.11.m11.4"><semantics id="S4.SS1.p4.11.m11.4a"><mrow id="S4.SS1.p4.11.m11.4.4.4" xref="S4.SS1.p4.11.m11.4.4.5.cmml"><mo id="S4.SS1.p4.11.m11.4.4.4.5" stretchy="false" xref="S4.SS1.p4.11.m11.4.4.5.cmml">(</mo><msup id="S4.SS1.p4.11.m11.1.1.1.1" xref="S4.SS1.p4.11.m11.1.1.1.1.cmml"><mi id="S4.SS1.p4.11.m11.1.1.1.1.2" xref="S4.SS1.p4.11.m11.1.1.1.1.2.cmml">I</mi><mo id="S4.SS1.p4.11.m11.1.1.1.1.3" xref="S4.SS1.p4.11.m11.1.1.1.1.3.cmml">′</mo></msup><mo id="S4.SS1.p4.11.m11.4.4.4.6" xref="S4.SS1.p4.11.m11.4.4.5.cmml">,</mo><msub id="S4.SS1.p4.11.m11.2.2.2.2" xref="S4.SS1.p4.11.m11.2.2.2.2.cmml"><mi id="S4.SS1.p4.11.m11.2.2.2.2.2" xref="S4.SS1.p4.11.m11.2.2.2.2.2.cmml">p</mi><mi id="S4.SS1.p4.11.m11.2.2.2.2.3" xref="S4.SS1.p4.11.m11.2.2.2.2.3.cmml">d</mi></msub><mo id="S4.SS1.p4.11.m11.4.4.4.7" xref="S4.SS1.p4.11.m11.4.4.5.cmml">,</mo><msub id="S4.SS1.p4.11.m11.3.3.3.3" xref="S4.SS1.p4.11.m11.3.3.3.3.cmml"><mi id="S4.SS1.p4.11.m11.3.3.3.3.2" xref="S4.SS1.p4.11.m11.3.3.3.3.2.cmml">o</mi><mi id="S4.SS1.p4.11.m11.3.3.3.3.3" xref="S4.SS1.p4.11.m11.3.3.3.3.3.cmml">T</mi></msub><mo id="S4.SS1.p4.11.m11.4.4.4.8" xref="S4.SS1.p4.11.m11.4.4.5.cmml">,</mo><mrow id="S4.SS1.p4.11.m11.4.4.4.4" xref="S4.SS1.p4.11.m11.4.4.4.4.cmml"><mi id="S4.SS1.p4.11.m11.4.4.4.4.2" mathvariant="normal" xref="S4.SS1.p4.11.m11.4.4.4.4.2.cmml">`</mi><mo id="S4.SS1.p4.11.m11.4.4.4.4.1" xref="S4.SS1.p4.11.m11.4.4.4.4.1.cmml">⁢</mo><mi id="S4.SS1.p4.11.m11.4.4.4.4.3" mathvariant="normal" xref="S4.SS1.p4.11.m11.4.4.4.4.3.cmml">`</mi><mo id="S4.SS1.p4.11.m11.4.4.4.4.1a" xref="S4.SS1.p4.11.m11.4.4.4.4.1.cmml">⁢</mo><mi id="S4.SS1.p4.11.m11.4.4.4.4.4" xref="S4.SS1.p4.11.m11.4.4.4.4.4.cmml">y</mi><mo id="S4.SS1.p4.11.m11.4.4.4.4.1b" xref="S4.SS1.p4.11.m11.4.4.4.4.1.cmml">⁢</mo><mi id="S4.SS1.p4.11.m11.4.4.4.4.5" xref="S4.SS1.p4.11.m11.4.4.4.4.5.cmml">e</mi><mo id="S4.SS1.p4.11.m11.4.4.4.4.1c" xref="S4.SS1.p4.11.m11.4.4.4.4.1.cmml">⁢</mo><mi id="S4.SS1.p4.11.m11.4.4.4.4.6" xref="S4.SS1.p4.11.m11.4.4.4.4.6.cmml">s</mi><mo id="S4.SS1.p4.11.m11.4.4.4.4.1d" xref="S4.SS1.p4.11.m11.4.4.4.4.1.cmml">⁢</mo><mi id="S4.SS1.p4.11.m11.4.4.4.4.7" mathvariant="normal" xref="S4.SS1.p4.11.m11.4.4.4.4.7.cmml">"</mi></mrow><mo id="S4.SS1.p4.11.m11.4.4.4.9" stretchy="false" xref="S4.SS1.p4.11.m11.4.4.5.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.11.m11.4b"><vector id="S4.SS1.p4.11.m11.4.4.5.cmml" xref="S4.SS1.p4.11.m11.4.4.4"><apply id="S4.SS1.p4.11.m11.1.1.1.1.cmml" xref="S4.SS1.p4.11.m11.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p4.11.m11.1.1.1.1.1.cmml" xref="S4.SS1.p4.11.m11.1.1.1.1">superscript</csymbol><ci id="S4.SS1.p4.11.m11.1.1.1.1.2.cmml" xref="S4.SS1.p4.11.m11.1.1.1.1.2">𝐼</ci><ci id="S4.SS1.p4.11.m11.1.1.1.1.3.cmml" xref="S4.SS1.p4.11.m11.1.1.1.1.3">′</ci></apply><apply id="S4.SS1.p4.11.m11.2.2.2.2.cmml" xref="S4.SS1.p4.11.m11.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p4.11.m11.2.2.2.2.1.cmml" xref="S4.SS1.p4.11.m11.2.2.2.2">subscript</csymbol><ci id="S4.SS1.p4.11.m11.2.2.2.2.2.cmml" xref="S4.SS1.p4.11.m11.2.2.2.2.2">𝑝</ci><ci id="S4.SS1.p4.11.m11.2.2.2.2.3.cmml" xref="S4.SS1.p4.11.m11.2.2.2.2.3">𝑑</ci></apply><apply id="S4.SS1.p4.11.m11.3.3.3.3.cmml" xref="S4.SS1.p4.11.m11.3.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.p4.11.m11.3.3.3.3.1.cmml" xref="S4.SS1.p4.11.m11.3.3.3.3">subscript</csymbol><ci id="S4.SS1.p4.11.m11.3.3.3.3.2.cmml" xref="S4.SS1.p4.11.m11.3.3.3.3.2">𝑜</ci><ci id="S4.SS1.p4.11.m11.3.3.3.3.3.cmml" xref="S4.SS1.p4.11.m11.3.3.3.3.3">𝑇</ci></apply><apply id="S4.SS1.p4.11.m11.4.4.4.4.cmml" xref="S4.SS1.p4.11.m11.4.4.4.4"><times id="S4.SS1.p4.11.m11.4.4.4.4.1.cmml" xref="S4.SS1.p4.11.m11.4.4.4.4.1"></times><ci id="S4.SS1.p4.11.m11.4.4.4.4.2.cmml" xref="S4.SS1.p4.11.m11.4.4.4.4.2">`</ci><ci id="S4.SS1.p4.11.m11.4.4.4.4.3.cmml" xref="S4.SS1.p4.11.m11.4.4.4.4.3">`</ci><ci id="S4.SS1.p4.11.m11.4.4.4.4.4.cmml" xref="S4.SS1.p4.11.m11.4.4.4.4.4">𝑦</ci><ci id="S4.SS1.p4.11.m11.4.4.4.4.5.cmml" xref="S4.SS1.p4.11.m11.4.4.4.4.5">𝑒</ci><ci id="S4.SS1.p4.11.m11.4.4.4.4.6.cmml" xref="S4.SS1.p4.11.m11.4.4.4.4.6">𝑠</ci><ci id="S4.SS1.p4.11.m11.4.4.4.4.7.cmml" xref="S4.SS1.p4.11.m11.4.4.4.4.7">"</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.11.m11.4c">(I^{\prime},p_{d},o_{T},``yes")</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.11.m11.4d">( italic_I start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_p start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT , ` ` italic_y italic_e italic_s " )</annotation></semantics></math> into the critic fine-tuning dataset <math alttext="\mathcal{D}_{\rm critic}" class="ltx_Math" display="inline" id="S4.SS1.p4.12.m12.1"><semantics id="S4.SS1.p4.12.m12.1a"><msub id="S4.SS1.p4.12.m12.1.1" xref="S4.SS1.p4.12.m12.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p4.12.m12.1.1.2" xref="S4.SS1.p4.12.m12.1.1.2.cmml">𝒟</mi><mi id="S4.SS1.p4.12.m12.1.1.3" xref="S4.SS1.p4.12.m12.1.1.3.cmml">critic</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.12.m12.1b"><apply id="S4.SS1.p4.12.m12.1.1.cmml" xref="S4.SS1.p4.12.m12.1.1"><csymbol cd="ambiguous" id="S4.SS1.p4.12.m12.1.1.1.cmml" xref="S4.SS1.p4.12.m12.1.1">subscript</csymbol><ci id="S4.SS1.p4.12.m12.1.1.2.cmml" xref="S4.SS1.p4.12.m12.1.1.2">𝒟</ci><ci id="S4.SS1.p4.12.m12.1.1.3.cmml" xref="S4.SS1.p4.12.m12.1.1.3">critic</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.12.m12.1c">\mathcal{D}_{\rm critic}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.12.m12.1d">caligraphic_D start_POSTSUBSCRIPT roman_critic end_POSTSUBSCRIPT</annotation></semantics></math>. Finally, if a failed trajectory proves meaningless after hindsight relabeling, it is considered as not helpful for the MLLM to understand the environment and discarded.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p5">
<p class="ltx_p" id="S4.SS1.p5.1">By applying self-asking and hindsight relabeling, we create a fine-tuning dataset <math alttext="\mathcal{D}_{\rm critic}" class="ltx_Math" display="inline" id="S4.SS1.p5.1.m1.1"><semantics id="S4.SS1.p5.1.m1.1a"><msub id="S4.SS1.p5.1.m1.1.1" xref="S4.SS1.p5.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p5.1.m1.1.1.2" xref="S4.SS1.p5.1.m1.1.1.2.cmml">𝒟</mi><mi id="S4.SS1.p5.1.m1.1.1.3" xref="S4.SS1.p5.1.m1.1.1.3.cmml">critic</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.1.m1.1b"><apply id="S4.SS1.p5.1.m1.1.1.cmml" xref="S4.SS1.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.1.m1.1.1.1.cmml" xref="S4.SS1.p5.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.p5.1.m1.1.1.2.cmml" xref="S4.SS1.p5.1.m1.1.1.2">𝒟</ci><ci id="S4.SS1.p5.1.m1.1.1.3.cmml" xref="S4.SS1.p5.1.m1.1.1.3">critic</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.1.m1.1c">\mathcal{D}_{\rm critic}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p5.1.m1.1d">caligraphic_D start_POSTSUBSCRIPT roman_critic end_POSTSUBSCRIPT</annotation></semantics></math> containing the last frames considered as successful by the critic itself and the last frames relabeled as successful after self-asking and hindsight relabeling.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Actor: Critic-Guided Improvement</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">Recent work has shown that the discriminative ability of an LLM exceeds its generative ability <cite class="ltx_cite ltx_citemacro_citep">(Pang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib34" title="">2024</a>)</cite>. As MLLMs are typically trained the same way as LLMs, we believe that MLLMs’ evaluation abilities would also surpass their generation abilities. For instance, we can easily prompt MLLMs to extract understanding from a given image, but it is challenging to prompt them to choose an appropriate action based on perceived task-relevant information like distance or direction. Our experiment in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#S5.SS2" title="5.2 AI2-THOR ‣ 5 Experiments ‣ SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_tag">5.2</span></a> also supports this conclusion, where the critic module always performs better than the actor. Therefore, we propose using the critic MLLM to guide the improvement of the actor MLLM in the environment without external feedback.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.2">Specifically, the actor MLLM interacts with the environment and collects online trajectories. At each timestep <math alttext="t" class="ltx_Math" display="inline" id="S4.SS2.p2.1.m1.1"><semantics id="S4.SS2.p2.1.m1.1a"><mi id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><ci id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">t</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.1.m1.1d">italic_t</annotation></semantics></math>, the actor generates an action plan <math alttext="l_{a,t}" class="ltx_Math" display="inline" id="S4.SS2.p2.2.m2.2"><semantics id="S4.SS2.p2.2.m2.2a"><msub id="S4.SS2.p2.2.m2.2.3" xref="S4.SS2.p2.2.m2.2.3.cmml"><mi id="S4.SS2.p2.2.m2.2.3.2" xref="S4.SS2.p2.2.m2.2.3.2.cmml">l</mi><mrow id="S4.SS2.p2.2.m2.2.2.2.4" xref="S4.SS2.p2.2.m2.2.2.2.3.cmml"><mi id="S4.SS2.p2.2.m2.1.1.1.1" xref="S4.SS2.p2.2.m2.1.1.1.1.cmml">a</mi><mo id="S4.SS2.p2.2.m2.2.2.2.4.1" xref="S4.SS2.p2.2.m2.2.2.2.3.cmml">,</mo><mi id="S4.SS2.p2.2.m2.2.2.2.2" xref="S4.SS2.p2.2.m2.2.2.2.2.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.2b"><apply id="S4.SS2.p2.2.m2.2.3.cmml" xref="S4.SS2.p2.2.m2.2.3"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.2.3.1.cmml" xref="S4.SS2.p2.2.m2.2.3">subscript</csymbol><ci id="S4.SS2.p2.2.m2.2.3.2.cmml" xref="S4.SS2.p2.2.m2.2.3.2">𝑙</ci><list id="S4.SS2.p2.2.m2.2.2.2.3.cmml" xref="S4.SS2.p2.2.m2.2.2.2.4"><ci id="S4.SS2.p2.2.m2.1.1.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1">𝑎</ci><ci id="S4.SS2.p2.2.m2.2.2.2.2.cmml" xref="S4.SS2.p2.2.m2.2.2.2.2">𝑡</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.2c">l_{a,t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.2.m2.2d">italic_l start_POSTSUBSCRIPT italic_a , italic_t end_POSTSUBSCRIPT</annotation></semantics></math> by,</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S4.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="l_{a,t}=M_{a}(I,p_{a},o_{t})," class="ltx_Math" display="block" id="S4.E4.m1.4"><semantics id="S4.E4.m1.4a"><mrow id="S4.E4.m1.4.4.1" xref="S4.E4.m1.4.4.1.1.cmml"><mrow id="S4.E4.m1.4.4.1.1" xref="S4.E4.m1.4.4.1.1.cmml"><msub id="S4.E4.m1.4.4.1.1.4" xref="S4.E4.m1.4.4.1.1.4.cmml"><mi id="S4.E4.m1.4.4.1.1.4.2" xref="S4.E4.m1.4.4.1.1.4.2.cmml">l</mi><mrow id="S4.E4.m1.2.2.2.4" xref="S4.E4.m1.2.2.2.3.cmml"><mi id="S4.E4.m1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.cmml">a</mi><mo id="S4.E4.m1.2.2.2.4.1" xref="S4.E4.m1.2.2.2.3.cmml">,</mo><mi id="S4.E4.m1.2.2.2.2" xref="S4.E4.m1.2.2.2.2.cmml">t</mi></mrow></msub><mo id="S4.E4.m1.4.4.1.1.3" xref="S4.E4.m1.4.4.1.1.3.cmml">=</mo><mrow id="S4.E4.m1.4.4.1.1.2" xref="S4.E4.m1.4.4.1.1.2.cmml"><msub id="S4.E4.m1.4.4.1.1.2.4" xref="S4.E4.m1.4.4.1.1.2.4.cmml"><mi id="S4.E4.m1.4.4.1.1.2.4.2" xref="S4.E4.m1.4.4.1.1.2.4.2.cmml">M</mi><mi id="S4.E4.m1.4.4.1.1.2.4.3" xref="S4.E4.m1.4.4.1.1.2.4.3.cmml">a</mi></msub><mo id="S4.E4.m1.4.4.1.1.2.3" xref="S4.E4.m1.4.4.1.1.2.3.cmml">⁢</mo><mrow id="S4.E4.m1.4.4.1.1.2.2.2" xref="S4.E4.m1.4.4.1.1.2.2.3.cmml"><mo id="S4.E4.m1.4.4.1.1.2.2.2.3" stretchy="false" xref="S4.E4.m1.4.4.1.1.2.2.3.cmml">(</mo><mi id="S4.E4.m1.3.3" xref="S4.E4.m1.3.3.cmml">I</mi><mo id="S4.E4.m1.4.4.1.1.2.2.2.4" xref="S4.E4.m1.4.4.1.1.2.2.3.cmml">,</mo><msub id="S4.E4.m1.4.4.1.1.1.1.1.1" xref="S4.E4.m1.4.4.1.1.1.1.1.1.cmml"><mi id="S4.E4.m1.4.4.1.1.1.1.1.1.2" xref="S4.E4.m1.4.4.1.1.1.1.1.1.2.cmml">p</mi><mi id="S4.E4.m1.4.4.1.1.1.1.1.1.3" xref="S4.E4.m1.4.4.1.1.1.1.1.1.3.cmml">a</mi></msub><mo id="S4.E4.m1.4.4.1.1.2.2.2.5" xref="S4.E4.m1.4.4.1.1.2.2.3.cmml">,</mo><msub id="S4.E4.m1.4.4.1.1.2.2.2.2" xref="S4.E4.m1.4.4.1.1.2.2.2.2.cmml"><mi id="S4.E4.m1.4.4.1.1.2.2.2.2.2" xref="S4.E4.m1.4.4.1.1.2.2.2.2.2.cmml">o</mi><mi id="S4.E4.m1.4.4.1.1.2.2.2.2.3" xref="S4.E4.m1.4.4.1.1.2.2.2.2.3.cmml">t</mi></msub><mo id="S4.E4.m1.4.4.1.1.2.2.2.6" stretchy="false" xref="S4.E4.m1.4.4.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E4.m1.4.4.1.2" xref="S4.E4.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.m1.4b"><apply id="S4.E4.m1.4.4.1.1.cmml" xref="S4.E4.m1.4.4.1"><eq id="S4.E4.m1.4.4.1.1.3.cmml" xref="S4.E4.m1.4.4.1.1.3"></eq><apply id="S4.E4.m1.4.4.1.1.4.cmml" xref="S4.E4.m1.4.4.1.1.4"><csymbol cd="ambiguous" id="S4.E4.m1.4.4.1.1.4.1.cmml" xref="S4.E4.m1.4.4.1.1.4">subscript</csymbol><ci id="S4.E4.m1.4.4.1.1.4.2.cmml" xref="S4.E4.m1.4.4.1.1.4.2">𝑙</ci><list id="S4.E4.m1.2.2.2.3.cmml" xref="S4.E4.m1.2.2.2.4"><ci id="S4.E4.m1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1">𝑎</ci><ci id="S4.E4.m1.2.2.2.2.cmml" xref="S4.E4.m1.2.2.2.2">𝑡</ci></list></apply><apply id="S4.E4.m1.4.4.1.1.2.cmml" xref="S4.E4.m1.4.4.1.1.2"><times id="S4.E4.m1.4.4.1.1.2.3.cmml" xref="S4.E4.m1.4.4.1.1.2.3"></times><apply id="S4.E4.m1.4.4.1.1.2.4.cmml" xref="S4.E4.m1.4.4.1.1.2.4"><csymbol cd="ambiguous" id="S4.E4.m1.4.4.1.1.2.4.1.cmml" xref="S4.E4.m1.4.4.1.1.2.4">subscript</csymbol><ci id="S4.E4.m1.4.4.1.1.2.4.2.cmml" xref="S4.E4.m1.4.4.1.1.2.4.2">𝑀</ci><ci id="S4.E4.m1.4.4.1.1.2.4.3.cmml" xref="S4.E4.m1.4.4.1.1.2.4.3">𝑎</ci></apply><vector id="S4.E4.m1.4.4.1.1.2.2.3.cmml" xref="S4.E4.m1.4.4.1.1.2.2.2"><ci id="S4.E4.m1.3.3.cmml" xref="S4.E4.m1.3.3">𝐼</ci><apply id="S4.E4.m1.4.4.1.1.1.1.1.1.cmml" xref="S4.E4.m1.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E4.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.4.4.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E4.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.4.4.1.1.1.1.1.1.2">𝑝</ci><ci id="S4.E4.m1.4.4.1.1.1.1.1.1.3.cmml" xref="S4.E4.m1.4.4.1.1.1.1.1.1.3">𝑎</ci></apply><apply id="S4.E4.m1.4.4.1.1.2.2.2.2.cmml" xref="S4.E4.m1.4.4.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E4.m1.4.4.1.1.2.2.2.2.1.cmml" xref="S4.E4.m1.4.4.1.1.2.2.2.2">subscript</csymbol><ci id="S4.E4.m1.4.4.1.1.2.2.2.2.2.cmml" xref="S4.E4.m1.4.4.1.1.2.2.2.2.2">𝑜</ci><ci id="S4.E4.m1.4.4.1.1.2.2.2.2.3.cmml" xref="S4.E4.m1.4.4.1.1.2.2.2.2.3">𝑡</ci></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.4c">l_{a,t}=M_{a}(I,p_{a},o_{t}),</annotation><annotation encoding="application/x-llamapun" id="S4.E4.m1.4d">italic_l start_POSTSUBSCRIPT italic_a , italic_t end_POSTSUBSCRIPT = italic_M start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT ( italic_I , italic_p start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.p2.12">where <math alttext="M_{a}" class="ltx_Math" display="inline" id="S4.SS2.p2.3.m1.1"><semantics id="S4.SS2.p2.3.m1.1a"><msub id="S4.SS2.p2.3.m1.1.1" xref="S4.SS2.p2.3.m1.1.1.cmml"><mi id="S4.SS2.p2.3.m1.1.1.2" xref="S4.SS2.p2.3.m1.1.1.2.cmml">M</mi><mi id="S4.SS2.p2.3.m1.1.1.3" xref="S4.SS2.p2.3.m1.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m1.1b"><apply id="S4.SS2.p2.3.m1.1.1.cmml" xref="S4.SS2.p2.3.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.3.m1.1.1.1.cmml" xref="S4.SS2.p2.3.m1.1.1">subscript</csymbol><ci id="S4.SS2.p2.3.m1.1.1.2.cmml" xref="S4.SS2.p2.3.m1.1.1.2">𝑀</ci><ci id="S4.SS2.p2.3.m1.1.1.3.cmml" xref="S4.SS2.p2.3.m1.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m1.1c">M_{a}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.3.m1.1d">italic_M start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math> represents the actor MLLM, <math alttext="I" class="ltx_Math" display="inline" id="S4.SS2.p2.4.m2.1"><semantics id="S4.SS2.p2.4.m2.1a"><mi id="S4.SS2.p2.4.m2.1.1" xref="S4.SS2.p2.4.m2.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m2.1b"><ci id="S4.SS2.p2.4.m2.1.1.cmml" xref="S4.SS2.p2.4.m2.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m2.1c">I</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.4.m2.1d">italic_I</annotation></semantics></math> is the task instruction, <math alttext="p_{a}" class="ltx_Math" display="inline" id="S4.SS2.p2.5.m3.1"><semantics id="S4.SS2.p2.5.m3.1a"><msub id="S4.SS2.p2.5.m3.1.1" xref="S4.SS2.p2.5.m3.1.1.cmml"><mi id="S4.SS2.p2.5.m3.1.1.2" xref="S4.SS2.p2.5.m3.1.1.2.cmml">p</mi><mi id="S4.SS2.p2.5.m3.1.1.3" xref="S4.SS2.p2.5.m3.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.5.m3.1b"><apply id="S4.SS2.p2.5.m3.1.1.cmml" xref="S4.SS2.p2.5.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m3.1.1.1.cmml" xref="S4.SS2.p2.5.m3.1.1">subscript</csymbol><ci id="S4.SS2.p2.5.m3.1.1.2.cmml" xref="S4.SS2.p2.5.m3.1.1.2">𝑝</ci><ci id="S4.SS2.p2.5.m3.1.1.3.cmml" xref="S4.SS2.p2.5.m3.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.5.m3.1c">p_{a}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.5.m3.1d">italic_p start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math> is the prompt for action plan and <math alttext="o_{t}" class="ltx_Math" display="inline" id="S4.SS2.p2.6.m4.1"><semantics id="S4.SS2.p2.6.m4.1a"><msub id="S4.SS2.p2.6.m4.1.1" xref="S4.SS2.p2.6.m4.1.1.cmml"><mi id="S4.SS2.p2.6.m4.1.1.2" xref="S4.SS2.p2.6.m4.1.1.2.cmml">o</mi><mi id="S4.SS2.p2.6.m4.1.1.3" xref="S4.SS2.p2.6.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.6.m4.1b"><apply id="S4.SS2.p2.6.m4.1.1.cmml" xref="S4.SS2.p2.6.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.6.m4.1.1.1.cmml" xref="S4.SS2.p2.6.m4.1.1">subscript</csymbol><ci id="S4.SS2.p2.6.m4.1.1.2.cmml" xref="S4.SS2.p2.6.m4.1.1.2">𝑜</ci><ci id="S4.SS2.p2.6.m4.1.1.3.cmml" xref="S4.SS2.p2.6.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.6.m4.1c">o_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.6.m4.1d">italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is the current image observation. After collecting a whole trajectory, the critic MLLM determines whether this trajectory completes the instruction <math alttext="I" class="ltx_Math" display="inline" id="S4.SS2.p2.7.m5.1"><semantics id="S4.SS2.p2.7.m5.1a"><mi id="S4.SS2.p2.7.m5.1.1" xref="S4.SS2.p2.7.m5.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.7.m5.1b"><ci id="S4.SS2.p2.7.m5.1.1.cmml" xref="S4.SS2.p2.7.m5.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.7.m5.1c">I</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.7.m5.1d">italic_I</annotation></semantics></math>, as described in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#S4.SS1" title="4.1 Critic: Self-Asking and Hindsight Relabeling ‣ 4 Method ‣ SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_tag">4.1</span></a>. If the answer is yes, we will put the whole trajectory into the actor fine-tuning dataset <math alttext="\mathcal{D}_{\rm actor}" class="ltx_Math" display="inline" id="S4.SS2.p2.8.m6.1"><semantics id="S4.SS2.p2.8.m6.1a"><msub id="S4.SS2.p2.8.m6.1.1" xref="S4.SS2.p2.8.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p2.8.m6.1.1.2" xref="S4.SS2.p2.8.m6.1.1.2.cmml">𝒟</mi><mi id="S4.SS2.p2.8.m6.1.1.3" xref="S4.SS2.p2.8.m6.1.1.3.cmml">actor</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.8.m6.1b"><apply id="S4.SS2.p2.8.m6.1.1.cmml" xref="S4.SS2.p2.8.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.8.m6.1.1.1.cmml" xref="S4.SS2.p2.8.m6.1.1">subscript</csymbol><ci id="S4.SS2.p2.8.m6.1.1.2.cmml" xref="S4.SS2.p2.8.m6.1.1.2">𝒟</ci><ci id="S4.SS2.p2.8.m6.1.1.3.cmml" xref="S4.SS2.p2.8.m6.1.1.3">actor</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.8.m6.1c">\mathcal{D}_{\rm actor}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.8.m6.1d">caligraphic_D start_POSTSUBSCRIPT roman_actor end_POSTSUBSCRIPT</annotation></semantics></math> with a format of <math alttext="\{(I,p_{a},o_{t},l_{a,t})\}_{t=0}^{T}" class="ltx_Math" display="inline" id="S4.SS2.p2.9.m7.4"><semantics id="S4.SS2.p2.9.m7.4a"><msubsup id="S4.SS2.p2.9.m7.4.4" xref="S4.SS2.p2.9.m7.4.4.cmml"><mrow id="S4.SS2.p2.9.m7.4.4.1.1.1" xref="S4.SS2.p2.9.m7.4.4.1.1.2.cmml"><mo id="S4.SS2.p2.9.m7.4.4.1.1.1.2" stretchy="false" xref="S4.SS2.p2.9.m7.4.4.1.1.2.cmml">{</mo><mrow id="S4.SS2.p2.9.m7.4.4.1.1.1.1.3" xref="S4.SS2.p2.9.m7.4.4.1.1.1.1.4.cmml"><mo id="S4.SS2.p2.9.m7.4.4.1.1.1.1.3.4" stretchy="false" xref="S4.SS2.p2.9.m7.4.4.1.1.1.1.4.cmml">(</mo><mi id="S4.SS2.p2.9.m7.3.3" xref="S4.SS2.p2.9.m7.3.3.cmml">I</mi><mo id="S4.SS2.p2.9.m7.4.4.1.1.1.1.3.5" xref="S4.SS2.p2.9.m7.4.4.1.1.1.1.4.cmml">,</mo><msub id="S4.SS2.p2.9.m7.4.4.1.1.1.1.1.1" xref="S4.SS2.p2.9.m7.4.4.1.1.1.1.1.1.cmml"><mi id="S4.SS2.p2.9.m7.4.4.1.1.1.1.1.1.2" xref="S4.SS2.p2.9.m7.4.4.1.1.1.1.1.1.2.cmml">p</mi><mi id="S4.SS2.p2.9.m7.4.4.1.1.1.1.1.1.3" xref="S4.SS2.p2.9.m7.4.4.1.1.1.1.1.1.3.cmml">a</mi></msub><mo id="S4.SS2.p2.9.m7.4.4.1.1.1.1.3.6" xref="S4.SS2.p2.9.m7.4.4.1.1.1.1.4.cmml">,</mo><msub id="S4.SS2.p2.9.m7.4.4.1.1.1.1.2.2" xref="S4.SS2.p2.9.m7.4.4.1.1.1.1.2.2.cmml"><mi id="S4.SS2.p2.9.m7.4.4.1.1.1.1.2.2.2" xref="S4.SS2.p2.9.m7.4.4.1.1.1.1.2.2.2.cmml">o</mi><mi id="S4.SS2.p2.9.m7.4.4.1.1.1.1.2.2.3" xref="S4.SS2.p2.9.m7.4.4.1.1.1.1.2.2.3.cmml">t</mi></msub><mo id="S4.SS2.p2.9.m7.4.4.1.1.1.1.3.7" xref="S4.SS2.p2.9.m7.4.4.1.1.1.1.4.cmml">,</mo><msub id="S4.SS2.p2.9.m7.4.4.1.1.1.1.3.3" xref="S4.SS2.p2.9.m7.4.4.1.1.1.1.3.3.cmml"><mi id="S4.SS2.p2.9.m7.4.4.1.1.1.1.3.3.2" xref="S4.SS2.p2.9.m7.4.4.1.1.1.1.3.3.2.cmml">l</mi><mrow id="S4.SS2.p2.9.m7.2.2.2.4" xref="S4.SS2.p2.9.m7.2.2.2.3.cmml"><mi id="S4.SS2.p2.9.m7.1.1.1.1" xref="S4.SS2.p2.9.m7.1.1.1.1.cmml">a</mi><mo id="S4.SS2.p2.9.m7.2.2.2.4.1" xref="S4.SS2.p2.9.m7.2.2.2.3.cmml">,</mo><mi id="S4.SS2.p2.9.m7.2.2.2.2" xref="S4.SS2.p2.9.m7.2.2.2.2.cmml">t</mi></mrow></msub><mo id="S4.SS2.p2.9.m7.4.4.1.1.1.1.3.8" stretchy="false" xref="S4.SS2.p2.9.m7.4.4.1.1.1.1.4.cmml">)</mo></mrow><mo id="S4.SS2.p2.9.m7.4.4.1.1.1.3" stretchy="false" xref="S4.SS2.p2.9.m7.4.4.1.1.2.cmml">}</mo></mrow><mrow id="S4.SS2.p2.9.m7.4.4.1.3" xref="S4.SS2.p2.9.m7.4.4.1.3.cmml"><mi id="S4.SS2.p2.9.m7.4.4.1.3.2" xref="S4.SS2.p2.9.m7.4.4.1.3.2.cmml">t</mi><mo id="S4.SS2.p2.9.m7.4.4.1.3.1" xref="S4.SS2.p2.9.m7.4.4.1.3.1.cmml">=</mo><mn id="S4.SS2.p2.9.m7.4.4.1.3.3" xref="S4.SS2.p2.9.m7.4.4.1.3.3.cmml">0</mn></mrow><mi id="S4.SS2.p2.9.m7.4.4.3" xref="S4.SS2.p2.9.m7.4.4.3.cmml">T</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.9.m7.4b"><apply id="S4.SS2.p2.9.m7.4.4.cmml" xref="S4.SS2.p2.9.m7.4.4"><csymbol cd="ambiguous" id="S4.SS2.p2.9.m7.4.4.2.cmml" xref="S4.SS2.p2.9.m7.4.4">superscript</csymbol><apply id="S4.SS2.p2.9.m7.4.4.1.cmml" xref="S4.SS2.p2.9.m7.4.4"><csymbol cd="ambiguous" id="S4.SS2.p2.9.m7.4.4.1.2.cmml" xref="S4.SS2.p2.9.m7.4.4">subscript</csymbol><set id="S4.SS2.p2.9.m7.4.4.1.1.2.cmml" xref="S4.SS2.p2.9.m7.4.4.1.1.1"><vector id="S4.SS2.p2.9.m7.4.4.1.1.1.1.4.cmml" xref="S4.SS2.p2.9.m7.4.4.1.1.1.1.3"><ci id="S4.SS2.p2.9.m7.3.3.cmml" xref="S4.SS2.p2.9.m7.3.3">𝐼</ci><apply id="S4.SS2.p2.9.m7.4.4.1.1.1.1.1.1.cmml" xref="S4.SS2.p2.9.m7.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.9.m7.4.4.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p2.9.m7.4.4.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p2.9.m7.4.4.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p2.9.m7.4.4.1.1.1.1.1.1.2">𝑝</ci><ci id="S4.SS2.p2.9.m7.4.4.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p2.9.m7.4.4.1.1.1.1.1.1.3">𝑎</ci></apply><apply id="S4.SS2.p2.9.m7.4.4.1.1.1.1.2.2.cmml" xref="S4.SS2.p2.9.m7.4.4.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p2.9.m7.4.4.1.1.1.1.2.2.1.cmml" xref="S4.SS2.p2.9.m7.4.4.1.1.1.1.2.2">subscript</csymbol><ci id="S4.SS2.p2.9.m7.4.4.1.1.1.1.2.2.2.cmml" xref="S4.SS2.p2.9.m7.4.4.1.1.1.1.2.2.2">𝑜</ci><ci id="S4.SS2.p2.9.m7.4.4.1.1.1.1.2.2.3.cmml" xref="S4.SS2.p2.9.m7.4.4.1.1.1.1.2.2.3">𝑡</ci></apply><apply id="S4.SS2.p2.9.m7.4.4.1.1.1.1.3.3.cmml" xref="S4.SS2.p2.9.m7.4.4.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS2.p2.9.m7.4.4.1.1.1.1.3.3.1.cmml" xref="S4.SS2.p2.9.m7.4.4.1.1.1.1.3.3">subscript</csymbol><ci id="S4.SS2.p2.9.m7.4.4.1.1.1.1.3.3.2.cmml" xref="S4.SS2.p2.9.m7.4.4.1.1.1.1.3.3.2">𝑙</ci><list id="S4.SS2.p2.9.m7.2.2.2.3.cmml" xref="S4.SS2.p2.9.m7.2.2.2.4"><ci id="S4.SS2.p2.9.m7.1.1.1.1.cmml" xref="S4.SS2.p2.9.m7.1.1.1.1">𝑎</ci><ci id="S4.SS2.p2.9.m7.2.2.2.2.cmml" xref="S4.SS2.p2.9.m7.2.2.2.2">𝑡</ci></list></apply></vector></set><apply id="S4.SS2.p2.9.m7.4.4.1.3.cmml" xref="S4.SS2.p2.9.m7.4.4.1.3"><eq id="S4.SS2.p2.9.m7.4.4.1.3.1.cmml" xref="S4.SS2.p2.9.m7.4.4.1.3.1"></eq><ci id="S4.SS2.p2.9.m7.4.4.1.3.2.cmml" xref="S4.SS2.p2.9.m7.4.4.1.3.2">𝑡</ci><cn id="S4.SS2.p2.9.m7.4.4.1.3.3.cmml" type="integer" xref="S4.SS2.p2.9.m7.4.4.1.3.3">0</cn></apply></apply><ci id="S4.SS2.p2.9.m7.4.4.3.cmml" xref="S4.SS2.p2.9.m7.4.4.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.9.m7.4c">\{(I,p_{a},o_{t},l_{a,t})\}_{t=0}^{T}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.9.m7.4d">{ ( italic_I , italic_p start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_l start_POSTSUBSCRIPT italic_a , italic_t end_POSTSUBSCRIPT ) } start_POSTSUBSCRIPT italic_t = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math>. The relabeled successful trajectories after hindsight relabeling are also added into the actor fine-tuning dataset <math alttext="\mathcal{D}_{\rm actor}" class="ltx_Math" display="inline" id="S4.SS2.p2.10.m8.1"><semantics id="S4.SS2.p2.10.m8.1a"><msub id="S4.SS2.p2.10.m8.1.1" xref="S4.SS2.p2.10.m8.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p2.10.m8.1.1.2" xref="S4.SS2.p2.10.m8.1.1.2.cmml">𝒟</mi><mi id="S4.SS2.p2.10.m8.1.1.3" xref="S4.SS2.p2.10.m8.1.1.3.cmml">actor</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.10.m8.1b"><apply id="S4.SS2.p2.10.m8.1.1.cmml" xref="S4.SS2.p2.10.m8.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.10.m8.1.1.1.cmml" xref="S4.SS2.p2.10.m8.1.1">subscript</csymbol><ci id="S4.SS2.p2.10.m8.1.1.2.cmml" xref="S4.SS2.p2.10.m8.1.1.2">𝒟</ci><ci id="S4.SS2.p2.10.m8.1.1.3.cmml" xref="S4.SS2.p2.10.m8.1.1.3">actor</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.10.m8.1c">\mathcal{D}_{\rm actor}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.10.m8.1d">caligraphic_D start_POSTSUBSCRIPT roman_actor end_POSTSUBSCRIPT</annotation></semantics></math>. Since this dataset only contains task completion trajectories, the actor can quickly converge towards completing tasks in the current environment by fine-tuning on the dataset. Note that the actor fine-tuning dataset <math alttext="\mathcal{D}_{\rm actor}" class="ltx_Math" display="inline" id="S4.SS2.p2.11.m9.1"><semantics id="S4.SS2.p2.11.m9.1a"><msub id="S4.SS2.p2.11.m9.1.1" xref="S4.SS2.p2.11.m9.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p2.11.m9.1.1.2" xref="S4.SS2.p2.11.m9.1.1.2.cmml">𝒟</mi><mi id="S4.SS2.p2.11.m9.1.1.3" xref="S4.SS2.p2.11.m9.1.1.3.cmml">actor</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.11.m9.1b"><apply id="S4.SS2.p2.11.m9.1.1.cmml" xref="S4.SS2.p2.11.m9.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.11.m9.1.1.1.cmml" xref="S4.SS2.p2.11.m9.1.1">subscript</csymbol><ci id="S4.SS2.p2.11.m9.1.1.2.cmml" xref="S4.SS2.p2.11.m9.1.1.2">𝒟</ci><ci id="S4.SS2.p2.11.m9.1.1.3.cmml" xref="S4.SS2.p2.11.m9.1.1.3">actor</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.11.m9.1c">\mathcal{D}_{\rm actor}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.11.m9.1d">caligraphic_D start_POSTSUBSCRIPT roman_actor end_POSTSUBSCRIPT</annotation></semantics></math> consists of trajectory data, while the critic fine-tuning dataset <math alttext="\mathcal{D}_{\rm critic}" class="ltx_Math" display="inline" id="S4.SS2.p2.12.m10.1"><semantics id="S4.SS2.p2.12.m10.1a"><msub id="S4.SS2.p2.12.m10.1.1" xref="S4.SS2.p2.12.m10.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p2.12.m10.1.1.2" xref="S4.SS2.p2.12.m10.1.1.2.cmml">𝒟</mi><mi id="S4.SS2.p2.12.m10.1.1.3" xref="S4.SS2.p2.12.m10.1.1.3.cmml">critic</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.12.m10.1b"><apply id="S4.SS2.p2.12.m10.1.1.cmml" xref="S4.SS2.p2.12.m10.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.12.m10.1.1.1.cmml" xref="S4.SS2.p2.12.m10.1.1">subscript</csymbol><ci id="S4.SS2.p2.12.m10.1.1.2.cmml" xref="S4.SS2.p2.12.m10.1.1.2">𝒟</ci><ci id="S4.SS2.p2.12.m10.1.1.3.cmml" xref="S4.SS2.p2.12.m10.1.1.3">critic</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.12.m10.1c">\mathcal{D}_{\rm critic}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.12.m10.1d">caligraphic_D start_POSTSUBSCRIPT roman_critic end_POSTSUBSCRIPT</annotation></semantics></math> only contains the last frames of these trajectories.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Actor-Critic Coupling Improvement</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.2">We employ Supervised Fine-Tuning (SFT) <cite class="ltx_cite ltx_citemacro_citep">(Devlin et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib8" title="">2019</a>; Brown et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib3" title="">2020</a>)</cite> and Low-Rank Adaptation (LoRA) <cite class="ltx_cite ltx_citemacro_citep">(Hu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib14" title="">2022</a>)</cite> to update both the actor and critic MLLMs. Initially, the actor MLLM interacts with the environment to collect online trajectories containing grounding information, as depicted in the lower part of Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#S3.F2" title="Figure 2 ‣ 3.2 Actor-Critic for MLLMs ‣ 3 Preliminaries ‣ SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_tag">2</span></a>. The critic module then evaluates and classifies these trajectories based on the last frame, as shown in the upper part of Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#S3.F2" title="Figure 2 ‣ 3.2 Actor-Critic for MLLMs ‣ 3 Preliminaries ‣ SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_tag">2</span></a>. We select successful trajectories identified by the critic MLLM to create the actor fine-tuning dataset <math alttext="\mathcal{D}_{\rm actor}" class="ltx_Math" display="inline" id="S4.SS3.p1.1.m1.1"><semantics id="S4.SS3.p1.1.m1.1a"><msub id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p1.1.m1.1.1.2" xref="S4.SS3.p1.1.m1.1.1.2.cmml">𝒟</mi><mi id="S4.SS3.p1.1.m1.1.1.3" xref="S4.SS3.p1.1.m1.1.1.3.cmml">actor</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><apply id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.1.m1.1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS3.p1.1.m1.1.1.2.cmml" xref="S4.SS3.p1.1.m1.1.1.2">𝒟</ci><ci id="S4.SS3.p1.1.m1.1.1.3.cmml" xref="S4.SS3.p1.1.m1.1.1.3">actor</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">\mathcal{D}_{\rm actor}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.1.m1.1d">caligraphic_D start_POSTSUBSCRIPT roman_actor end_POSTSUBSCRIPT</annotation></semantics></math>. Subsequently, we utilize the last frame to construct the critic fine-tuning dataset <math alttext="\mathcal{D}_{\rm critic}" class="ltx_Math" display="inline" id="S4.SS3.p1.2.m2.1"><semantics id="S4.SS3.p1.2.m2.1a"><msub id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p1.2.m2.1.1.2" xref="S4.SS3.p1.2.m2.1.1.2.cmml">𝒟</mi><mi id="S4.SS3.p1.2.m2.1.1.3" xref="S4.SS3.p1.2.m2.1.1.3.cmml">critic</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><apply id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.2.m2.1.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS3.p1.2.m2.1.1.2.cmml" xref="S4.SS3.p1.2.m2.1.1.2">𝒟</ci><ci id="S4.SS3.p1.2.m2.1.1.3.cmml" xref="S4.SS3.p1.2.m2.1.1.3">critic</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">\mathcal{D}_{\rm critic}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.2.m2.1d">caligraphic_D start_POSTSUBSCRIPT roman_critic end_POSTSUBSCRIPT</annotation></semantics></math>. The update of the actor and critic can be performed iteratively, and make them both improve step-by-step. A detailed pseudo-code for our algorithm is available in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#A1.SS1" title="A.1 Pseudocode of SELU ‣ Appendix A Appendix ‣ SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_tag">A.1</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiments</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Experimental Setup</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.1"><span class="ltx_text ltx_font_bold" id="S5.SS1.p1.1.1">Environments.</span> In order to simulate embodied MLLM interactions in unknown environments, we select AI2-THOR <cite class="ltx_cite ltx_citemacro_citep">(Kolve et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib19" title="">2022</a>)</cite> and VirtualHome <cite class="ltx_cite ltx_citemacro_citep">(Puig et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib35" title="">2018</a>)</cite> for our experiments. Both environments offer open-ended tasks, various interactive objects, and selectable camera perspectives, facilitating data collection for the actor and critic.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul class="ltx_itemize" id="S5.I1">
<li class="ltx_item" id="S5.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i1.p1">
<p class="ltx_p" id="S5.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i1.p1.1.1">AI2-THOR</span> is an interactive simulation environment designed for embodied AI research. The primary tasks require agents to navigate and interact with household objects. It offers highly realistic 3D environments that simulate kitchens, living rooms, and other indoor settings. AI2-THOR provides locobot and robotic arms as agents and enables agents to perform complex actions like picking up, opening, toggling, and so on.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S5.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S5.I1.i2.p1">
<p class="ltx_p" id="S5.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i2.p1.1.1">VirtualHome</span> is also an embodied simulation platform designed to imitate human activities and tasks in home environments. It offers a rich set of virtual household scenes where agents can perform tasks, such as sitting on a bench in the kitchen or grasping a waterglass in the bedroom. This environment focuses on task completion through multi-step action sequences, making it ideal for testing long-term planning.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ul>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS1.p2">
<p class="ltx_p" id="S5.SS1.p2.1"><span class="ltx_text ltx_font_bold" id="S5.SS1.p2.1.1">Task Selection.</span> Considering the training costs while demonstrating the feasibility of the framework, we focus on three typical task categories in the AI2-THOR environment: pick up, open, and break. Locobot is selected as the agent, as this work does not consider low-level control of robotic arms. To ensure task diversity and feasibility, we first prompt the MLLM to explore the environment and use the explore objects to initialize the instruction list which serves as the task set. We randomly sample 2-3 objects for each type of task.
Considering the training costs, we restrict the maximum step for all tasks to 10.
We apply a similar approach in the VirtualHome environment, selecting "female1" as the agent and primarily testing in grab, open, and sit tasks.
</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS1.p3">
<p class="ltx_p" id="S5.SS1.p3.1"><span class="ltx_text ltx_font_bold" id="S5.SS1.p3.1.1">MLLMs.</span>
To demonstrate the generalization capability of our framework, we conduct experiments using two MLLMs: LLaVA <cite class="ltx_cite ltx_citemacro_citep">(Liu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib25" title="">2023</a>)</cite> and Qwen-VL <cite class="ltx_cite ltx_citemacro_citep">(Bai et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib2" title="">2023</a>)</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul class="ltx_itemize" id="S5.I2">
<li class="ltx_item" id="S5.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I2.i1.p1">
<p class="ltx_p" id="S5.I2.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I2.i1.p1.1.1">LLaVA</span> integrates a visual encoder with a language model to effectively process and respond to multimodal inputs. It has gained prominence as one of the most popular MLLMs due to its simple architecture and lower training data requirements. These features enable LLaVA to generate responses more swiftly, and suitable for inference to investigate self-learning.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S5.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S5.I2.i2.p1">
<p class="ltx_p" id="S5.I2.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I2.i2.p1.1.1">Qwen-VL</span> is the multimodal version of the large model series. Compared to other open-source MLLMs, Qwen-VL is the first model to use a 448x448 resolution image input. Due to its higher resolution, this model exhibits enhanced visual understanding capabilities. We opt for Qwen-VL with the aim of better success detection, thereby facilitating more efficient self-learning of MLLMs.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ul>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS1.p4">
<p class="ltx_p" id="S5.SS1.p4.1"><span class="ltx_text ltx_font_bold" id="S5.SS1.p4.1.1">Baselines.</span>
We compare SELU with five methods to investigate the feasibility of self-learning of MLLMs in embodied environments:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul class="ltx_itemize" id="S5.I3">
<li class="ltx_item" id="S5.I3.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I3.i1.p1">
<p class="ltx_p" id="S5.I3.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I3.i1.p1.1.1">DG</span> refers to the results obtained through direct generation from the initial MLLM without any fine-tuning.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S5.I3.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I3.i2.p1">
<p class="ltx_p" id="S5.I3.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I3.i2.p1.1.1">SC</span> <cite class="ltx_cite ltx_citemacro_citep">(Wang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib51" title="">2023a</a>)</cite> represents an optimization method of MLLMs through self-consistency. Specifically, we employ multiple chains of thought (CoT) to prompt an MLLM to answer the same question, followed by majority voting. In our experiments, we utilize three different CoTs to guide the MLLM, ultimately voting for the most reasonable action.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S5.I3.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I3.i3.p1">
<p class="ltx_p" id="S5.I3.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I3.i3.p1.1.1">LMSI</span> <cite class="ltx_cite ltx_citemacro_citep">(Huang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib15" title="">2023</a>)</cite> is a self-improvement method based on SC. It generates “high-confidence" answers for unlabeled questions to build fine-tuning datasets. This approach enables the LLM to iteratively improve its performance based on the voting mechanism, and we extend this approach to MLLMs.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S5.I3.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I3.i4.p1">
<p class="ltx_p" id="S5.I3.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I3.i4.p1.1.1">Self-Refine</span> <cite class="ltx_cite ltx_citemacro_citep">(Madaan et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#bib.bib29" title="">2023</a>)</cite> involves multiple rounds of self-reflection, followed by self-optimization based on the reflection results. This method focuses on prompt optimization and has been validated for feasibility in large-scale LLMs, such as GPT-4. In our experiments, we reflect 3 rounds to get the final result.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S5.I3.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S5.I3.i5.p1">
<p class="ltx_p" id="S5.I3.i5.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I3.i5.p1.1.1">SELU-One</span> represents the method of using the same MLLM to simultaneously perform actor and critic tasks, and fine-tuning with a combination of actor and critic datasets. This approach aims to investigate the feasibility of utilizing a single MLLM to meet the requirements of our framework.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>AI2-THOR</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1"><span class="ltx_text ltx_font_bold" id="S5.SS2.p1.1.1">LLaVA.</span>
We first demonstrate the effectiveness of SELU in the AI2-THOR environment. After online interactions with the environment and fine-tuning of LLaVA, the critic exhibits an average performance improvement of approximately 27%, while the actor achieves an improvement of around 20% compared to the original model. Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#S5.T1" title="Table 1 ‣ 5.2 AI2-THOR ‣ 5 Experiments ‣ SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_tag">1</span></a> and Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#S5.T2" title="Table 2 ‣ 5.2 AI2-THOR ‣ 5 Experiments ‣ SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_tag">2</span></a> present the accuracy of task success detection and task success rate respectively.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="S5.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Accuracy of task success detection in the AI2-THOR environment.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T1.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T1.1.1.1.1" style="padding-top:1pt;padding-bottom:1pt;">Method</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T1.1.1.1.2" style="padding-top:1pt;padding-bottom:1pt;">Pick up</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T1.1.1.1.3" style="padding-top:1pt;padding-bottom:1pt;">Open</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T1.1.1.1.4" style="padding-top:1pt;padding-bottom:1pt;">Break</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T1.1.1.1.5" style="padding-top:1pt;padding-bottom:1pt;">Avg.</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T1.1.2.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.2.1.1" style="padding-top:1pt;padding-bottom:1pt;">DG</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.2.1.2" style="padding-top:1pt;padding-bottom:1pt;">80.67%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.2.1.3" style="padding-top:1pt;padding-bottom:1pt;">36.50%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.2.1.4" style="padding-top:1pt;padding-bottom:1pt;">50.50%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.2.1.5" style="padding-top:1pt;padding-bottom:1pt;">55.89%</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.3.2">
<td class="ltx_td ltx_align_center" id="S5.T1.1.3.2.1" style="padding-top:1pt;padding-bottom:1pt;">SELU-One</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.3.2.2" style="padding-top:1pt;padding-bottom:1pt;">68.67%</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.3.2.3" style="padding-top:1pt;padding-bottom:1pt;">30.50%</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.3.2.4" style="padding-top:1pt;padding-bottom:1pt;">25.50%</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.3.2.5" style="padding-top:1pt;padding-bottom:1pt;">41.56%</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.4.3">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.1.4.3.1" style="padding-top:1pt;padding-bottom:1pt;">SELU</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.1.4.3.2" style="padding-top:1pt;padding-bottom:1pt;"><span class="ltx_text ltx_font_bold" id="S5.T1.1.4.3.2.1">94.33%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.1.4.3.3" style="padding-top:1pt;padding-bottom:1pt;"><span class="ltx_text ltx_font_bold" id="S5.T1.1.4.3.3.1">67.50%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.1.4.3.4" style="padding-top:1pt;padding-bottom:1pt;"><span class="ltx_text ltx_font_bold" id="S5.T1.1.4.3.4.1">87.50%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.1.4.3.5" style="padding-top:1pt;padding-bottom:1pt;"><span class="ltx_text ltx_font_bold" id="S5.T1.1.4.3.5.1">83.11%</span></td>
</tr>
</tbody>
</table>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_table" id="S5.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Task success rate in the AI2-THOR environment. SC and Self-Refine use prompt engineering to realize self-learning, whereas LMSI and SELU utilize fine-tuning.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T2.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T2.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T2.1.1.1.1" style="padding-top:1pt;padding-bottom:1pt;">Method</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T2.1.1.1.2" style="padding-top:1pt;padding-bottom:1pt;">Pick Up</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T2.1.1.1.3" style="padding-top:1pt;padding-bottom:1pt;">Open</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T2.1.1.1.4" style="padding-top:1pt;padding-bottom:1pt;">Break</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T2.1.1.1.5" style="padding-top:1pt;padding-bottom:1pt;">Avg.</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T2.1.2.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.2.1.1" style="padding-top:1pt;padding-bottom:1pt;">DG</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.2.1.2" style="padding-top:1pt;padding-bottom:1pt;">68.33%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.2.1.3" style="padding-top:1pt;padding-bottom:1pt;">65.00%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.2.1.4" style="padding-top:1pt;padding-bottom:1pt;">15.50%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.2.1.5" style="padding-top:1pt;padding-bottom:1pt;">49.61%</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.3.2">
<td class="ltx_td ltx_align_center" id="S5.T2.1.3.2.1" style="padding-top:1pt;padding-bottom:1pt;">SC</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.3.2.2" style="padding-top:1pt;padding-bottom:1pt;">65.67%</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.3.2.3" style="padding-top:1pt;padding-bottom:1pt;">68.50%</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.3.2.4" style="padding-top:1pt;padding-bottom:1pt;">17.50%</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.3.2.5" style="padding-top:1pt;padding-bottom:1pt;">50.56%</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.4.3">
<td class="ltx_td ltx_align_center" id="S5.T2.1.4.3.1" style="padding-top:1pt;padding-bottom:1pt;">Self-Refine</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.4.3.2" style="padding-top:1pt;padding-bottom:1pt;">69.67%</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.4.3.3" style="padding-top:1pt;padding-bottom:1pt;">70.50%</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.4.3.4" style="padding-top:1pt;padding-bottom:1pt;">14.50%</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.4.3.5" style="padding-top:1pt;padding-bottom:1pt;">51.56%</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.5.4">
<td class="ltx_td ltx_align_center" id="S5.T2.1.5.4.1" style="padding-top:1pt;padding-bottom:1pt;">LMSI</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.5.4.2" style="padding-top:1pt;padding-bottom:1pt;">75.67%</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.5.4.3" style="padding-top:1pt;padding-bottom:1pt;">52.50%</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.5.4.4" style="padding-top:1pt;padding-bottom:1pt;">19.50%</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.5.4.5" style="padding-top:1pt;padding-bottom:1pt;">49.22%</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.6.5">
<td class="ltx_td ltx_align_center" id="S5.T2.1.6.5.1" style="padding-top:1pt;padding-bottom:1pt;">SELU-One</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.6.5.2" style="padding-top:1pt;padding-bottom:1pt;">91.33%</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.6.5.3" style="padding-top:1pt;padding-bottom:1pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.1.6.5.3.1">85.50%</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.6.5.4" style="padding-top:1pt;padding-bottom:1pt;">27.50%</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.6.5.5" style="padding-top:1pt;padding-bottom:1pt;">68.11%</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.7.6">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.1.7.6.1" style="padding-top:1pt;padding-bottom:1pt;">SELU</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.1.7.6.2" style="padding-top:1pt;padding-bottom:1pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.1.7.6.2.1">94.67%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.1.7.6.3" style="padding-top:1pt;padding-bottom:1pt;">83.50%</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.1.7.6.4" style="padding-top:1pt;padding-bottom:1pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.1.7.6.4.1">30.50%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.1.7.6.5" style="padding-top:1pt;padding-bottom:1pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.1.7.6.5.1">69.56%</span></td>
</tr>
</tbody>
</table>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S5.SS2.p2">
<p class="ltx_p" id="S5.SS2.p2.1">In Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#S5.T1" title="Table 1 ‣ 5.2 AI2-THOR ‣ 5 Experiments ‣ SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_tag">1</span></a>, it is evidenced that the unified fine-tuning of the actor and the critic (SELU-One) leads to a decline in success detection, even worse than the original critic. Although SELU-One achieves a task success rate comparable to that of SELU as shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#S5.T2" title="Table 2 ‣ 5.2 AI2-THOR ‣ 5 Experiments ‣ SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_tag">2</span></a>, the compromised critic will result in SELU-One incorrectly analyzing the trajectory in subsequent epochs.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS2.p3">
<p class="ltx_p" id="S5.SS2.p3.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#S5.T2" title="Table 2 ‣ 5.2 AI2-THOR ‣ 5 Experiments ‣ SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_tag">2</span></a> demonstrates that baselines are not suitable for the self-learning of embodied MLLMs. Both prompt-engineering and fine-tuning baselines struggle to improve the decision-making ability of the MLLM. The reason is that the embodied MLLM cannot give a correct task detection with a lack of environmental understanding. As we can see in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#S5.T1" title="Table 1 ‣ 5.2 AI2-THOR ‣ 5 Experiments ‣ SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_tag">1</span></a>, the initial judgment of the MLLM (DG) on tasks is only about 55%. In this case, merely optimizing the prompt to create multiple CoTs for repeated reflection does not help the MLLM gain task achievement details in an unknown environment. Therefore, neither SC nor Self-Refine can substantially enhance the task success rate. For fine-tuning baselines, relying on statistical voting to validate its own behavior even leads to worse performance. For instance, in the Open task, for LMSI the task detection accuracy of 36.5% causes the actor’s performance to drop from 65% to 52.5% after fine-tuning. These results demonstrate the necessity of the critic module in SELU, and optimizing the critic is crucial for enhancing the actor’s performance.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS2.p4">
<p class="ltx_p" id="S5.SS2.p4.1">Notably, in the Open task, we can observe a low accuracy of success detection for SELU; however, it still helps the actor improve. This highlights the role of hindsight relabeling, which will be discussed in detail in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#S5.SS4" title="5.4 Ablation Study ‣ 5 Experiments ‣ SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_tag">5.4</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS2.p5">
<p class="ltx_p" id="S5.SS2.p5.1"><span class="ltx_text ltx_font_bold" id="S5.SS2.p5.1.1">Qwen-VL.</span>
In order to prove that SELU can help different MLLMs achieve self-learning, we select Qwen-VL and test it in the AI2-THOR environment under the same setting. The result is shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#S5.T3" title="Table 3 ‣ 5.2 AI2-THOR ‣ 5 Experiments ‣ SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_tag">3</span></a>, which indicates that SELU can help Qwen-VL improve the task evaluation capability by about 24% and the decision-making performance by approximately 23%.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="S5.T3">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Self-learning performance of SELU on Qwen-VL in the AI2-THOR environment.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T3.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T3.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T3.1.1.1.1" style="padding-top:1pt;padding-bottom:1pt;"><span class="ltx_text" id="S5.T3.1.1.1.1.1">Task</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S5.T3.1.1.1.2" style="padding-top:1pt;padding-bottom:1pt;">Critic</th>
<th class="ltx_td ltx_align_top ltx_th ltx_th_column ltx_border_tt" id="S5.T3.1.1.1.3" style="padding-top:1pt;padding-bottom:1pt;"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S5.T3.1.1.1.4" style="padding-top:1pt;padding-bottom:1pt;">Actor</th>
</tr>
<tr class="ltx_tr" id="S5.T3.1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S5.T3.1.2.2.1" style="padding-top:1pt;padding-bottom:1pt;"><span class="ltx_rule" style="width:0.0pt;height:10.8pt;background:black;display:inline-block;"></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T3.1.2.2.2" style="padding-top:1pt;padding-bottom:1pt;">DG-Qwen-VL</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T3.1.2.2.3" style="padding-top:1pt;padding-bottom:1pt;">SELU-Qwen-VL</th>
<th class="ltx_td ltx_align_top ltx_th ltx_th_column" id="S5.T3.1.2.2.4" style="padding-top:1pt;padding-bottom:1pt;"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T3.1.2.2.5" style="padding-top:1pt;padding-bottom:1pt;">DG-Qwen-VL</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T3.1.2.2.6" style="padding-top:1pt;padding-bottom:1pt;">SELU-Qwen-VL</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T3.1.3.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.3.1.1" style="padding-top:1pt;padding-bottom:1pt;">Pick Up</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.3.1.2" style="padding-top:1pt;padding-bottom:1pt;">73.33%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.3.1.3" style="padding-top:1pt;padding-bottom:1pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.3.1.3.1">95.67%</span></td>
<td class="ltx_td ltx_align_top ltx_border_t" id="S5.T3.1.3.1.4" style="padding-top:1pt;padding-bottom:1pt;"></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.3.1.5" style="padding-top:1pt;padding-bottom:1pt;">57.67%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.3.1.6" style="padding-top:1pt;padding-bottom:1pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.3.1.6.1">95.33%</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.4.2">
<td class="ltx_td ltx_align_center" id="S5.T3.1.4.2.1" style="padding-top:1pt;padding-bottom:1pt;">Open</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.4.2.2" style="padding-top:1pt;padding-bottom:1pt;">51.00%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.4.2.3" style="padding-top:1pt;padding-bottom:1pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.4.2.3.1">81.50%</span></td>
<td class="ltx_td ltx_align_top" id="S5.T3.1.4.2.4" style="padding-top:1pt;padding-bottom:1pt;"></td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.4.2.5" style="padding-top:1pt;padding-bottom:1pt;">46.50%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.4.2.6" style="padding-top:1pt;padding-bottom:1pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.4.2.6.1">68.00%</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.5.3">
<td class="ltx_td ltx_align_center" id="S5.T3.1.5.3.1" style="padding-top:1pt;padding-bottom:1pt;">Break</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.5.3.2" style="padding-top:1pt;padding-bottom:1pt;">63.50%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.5.3.3" style="padding-top:1pt;padding-bottom:1pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.5.3.3.1">83.50%</span></td>
<td class="ltx_td ltx_align_top" id="S5.T3.1.5.3.4" style="padding-top:1pt;padding-bottom:1pt;"></td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.5.3.5" style="padding-top:1pt;padding-bottom:1pt;">12.50%</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.5.3.6" style="padding-top:1pt;padding-bottom:1pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.5.3.6.1">21.50%</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.6.4">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.1.6.4.1" style="padding-top:1pt;padding-bottom:1pt;">Avg.</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.1.6.4.2" style="padding-top:1pt;padding-bottom:1pt;">62.61%</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.1.6.4.3" style="padding-top:1pt;padding-bottom:1pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.6.4.3.1">86.89%</span></td>
<td class="ltx_td ltx_align_top ltx_border_bb" id="S5.T3.1.6.4.4" style="padding-top:1pt;padding-bottom:1pt;"></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.1.6.4.5" style="padding-top:1pt;padding-bottom:1pt;">38.89%</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.1.6.4.6" style="padding-top:1pt;padding-bottom:1pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.6.4.6.1">61.61%</span></td>
</tr>
</tbody>
</table>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>VirtualHome</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.1">We then conduct experiments in the VirtualHome environment, which incorporates a greater variety of items and human agents, thereby enriching the experimental environments to demonstrate the effectiveness of our method. The experimental results are presented in Tables <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#S5.T4" title="Table 4 ‣ 5.3 VirtualHome ‣ 5 Experiments ‣ SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_tag">4</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#S5.T5" title="Table 5 ‣ 5.3 VirtualHome ‣ 5 Experiments ‣ SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_tag">5</span></a>. In this environment, SELU enhances LLaVA task evaluation capability by approximately 30% and improves decision-making performance by around 24%, and it also outperforms baselines. As the environment becomes more complex, the lack of environmental understanding causes SC and Self-Refine to negatively impact the decision-making of the original embodied MLLM, as the performance of SC and Self-Refine are even lower than DG, shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#S5.T5" title="Table 5 ‣ 5.3 VirtualHome ‣ 5 Experiments ‣ SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_tag">5</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="S5.T4">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Accuracy of task success detection in the VirtualHome environment.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T4.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T4.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T4.1.1.1.1" style="padding-top:1pt;padding-bottom:1pt;">Method</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T4.1.1.1.2" style="padding-top:1pt;padding-bottom:1pt;">Grab</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T4.1.1.1.3" style="padding-top:1pt;padding-bottom:1pt;">Open</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T4.1.1.1.4" style="padding-top:1pt;padding-bottom:1pt;">Sit</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T4.1.1.1.5" style="padding-top:1pt;padding-bottom:1pt;">Avg.</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T4.1.2.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.2.1.1" style="padding-top:1pt;padding-bottom:1pt;">DG</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.2.1.2" style="padding-top:1pt;padding-bottom:1pt;">52.67%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.2.1.3" style="padding-top:1pt;padding-bottom:1pt;">35.33%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.2.1.4" style="padding-top:1pt;padding-bottom:1pt;">44.50%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.2.1.5" style="padding-top:1pt;padding-bottom:1pt;">44.17%</td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.3.2">
<td class="ltx_td ltx_align_center" id="S5.T4.1.3.2.1" style="padding-top:1pt;padding-bottom:1pt;">SELU-One</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.3.2.2" style="padding-top:1pt;padding-bottom:1pt;">45.33%</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.3.2.3" style="padding-top:1pt;padding-bottom:1pt;">15.67%</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.3.2.4" style="padding-top:1pt;padding-bottom:1pt;">
<span class="ltx_text ltx_font_bold" id="S5.T4.1.3.2.4.1">48.50</span>%</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.3.2.5" style="padding-top:1pt;padding-bottom:1pt;">36.50%</td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.4.3">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.1.4.3.1" style="padding-top:1pt;padding-bottom:1pt;">SELU</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.1.4.3.2" style="padding-top:1pt;padding-bottom:1pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.1.4.3.2.1">93.67%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.1.4.3.3" style="padding-top:1pt;padding-bottom:1pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.1.4.3.3.1">83.33%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.1.4.3.4" style="padding-top:1pt;padding-bottom:1pt;">47.50%</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.1.4.3.5" style="padding-top:1pt;padding-bottom:1pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.1.4.3.5.1">74.83%</span></td>
</tr>
</tbody>
</table>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_table" id="S5.T5">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span>Task success rate in the VirtualHome environment.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T5.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T5.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T5.1.1.1.1" style="padding-top:1pt;padding-bottom:1pt;">Method</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T5.1.1.1.2" style="padding-top:1pt;padding-bottom:1pt;">Grab</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T5.1.1.1.3" style="padding-top:1pt;padding-bottom:1pt;">Open</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T5.1.1.1.4" style="padding-top:1pt;padding-bottom:1pt;">Sit</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T5.1.1.1.5" style="padding-top:1pt;padding-bottom:1pt;">Avg.</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T5.1.2.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.1.2.1.1" style="padding-top:1pt;padding-bottom:1pt;">DG</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.1.2.1.2" style="padding-top:1pt;padding-bottom:1pt;">65.00%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.1.2.1.3" style="padding-top:1pt;padding-bottom:1pt;">83.33%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.1.2.1.4" style="padding-top:1pt;padding-bottom:1pt;">56.50%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.1.2.1.5" style="padding-top:1pt;padding-bottom:1pt;">68.28%</td>
</tr>
<tr class="ltx_tr" id="S5.T5.1.3.2">
<td class="ltx_td ltx_align_center" id="S5.T5.1.3.2.1" style="padding-top:1pt;padding-bottom:1pt;">SC</td>
<td class="ltx_td ltx_align_center" id="S5.T5.1.3.2.2" style="padding-top:1pt;padding-bottom:1pt;">52.67%</td>
<td class="ltx_td ltx_align_center" id="S5.T5.1.3.2.3" style="padding-top:1pt;padding-bottom:1pt;">81.67%</td>
<td class="ltx_td ltx_align_center" id="S5.T5.1.3.2.4" style="padding-top:1pt;padding-bottom:1pt;">61.50%</td>
<td class="ltx_td ltx_align_center" id="S5.T5.1.3.2.5" style="padding-top:1pt;padding-bottom:1pt;">65.28%</td>
</tr>
<tr class="ltx_tr" id="S5.T5.1.4.3">
<td class="ltx_td ltx_align_center" id="S5.T5.1.4.3.1" style="padding-top:1pt;padding-bottom:1pt;">Self-Refine</td>
<td class="ltx_td ltx_align_center" id="S5.T5.1.4.3.2" style="padding-top:1pt;padding-bottom:1pt;">59.67%</td>
<td class="ltx_td ltx_align_center" id="S5.T5.1.4.3.3" style="padding-top:1pt;padding-bottom:1pt;">74.33%</td>
<td class="ltx_td ltx_align_center" id="S5.T5.1.4.3.4" style="padding-top:1pt;padding-bottom:1pt;">60.50%</td>
<td class="ltx_td ltx_align_center" id="S5.T5.1.4.3.5" style="padding-top:1pt;padding-bottom:1pt;">64.83%</td>
</tr>
<tr class="ltx_tr" id="S5.T5.1.5.4">
<td class="ltx_td ltx_align_center" id="S5.T5.1.5.4.1" style="padding-top:1pt;padding-bottom:1pt;">LMSI</td>
<td class="ltx_td ltx_align_center" id="S5.T5.1.5.4.2" style="padding-top:1pt;padding-bottom:1pt;">35.67%</td>
<td class="ltx_td ltx_align_center" id="S5.T5.1.5.4.3" style="padding-top:1pt;padding-bottom:1pt;">93.67%</td>
<td class="ltx_td ltx_align_center" id="S5.T5.1.5.4.4" style="padding-top:1pt;padding-bottom:1pt;">52.50%</td>
<td class="ltx_td ltx_align_center" id="S5.T5.1.5.4.5" style="padding-top:1pt;padding-bottom:1pt;">60.61%</td>
</tr>
<tr class="ltx_tr" id="S5.T5.1.6.5">
<td class="ltx_td ltx_align_center" id="S5.T5.1.6.5.1" style="padding-top:1pt;padding-bottom:1pt;">SELU-One</td>
<td class="ltx_td ltx_align_center" id="S5.T5.1.6.5.2" style="padding-top:1pt;padding-bottom:1pt;">83.67%</td>
<td class="ltx_td ltx_align_center" id="S5.T5.1.6.5.3" style="padding-top:1pt;padding-bottom:1pt;"><span class="ltx_text ltx_font_bold" id="S5.T5.1.6.5.3.1">98.67%</span></td>
<td class="ltx_td ltx_align_center" id="S5.T5.1.6.5.4" style="padding-top:1pt;padding-bottom:1pt;"><span class="ltx_text ltx_font_bold" id="S5.T5.1.6.5.4.1">94.50%</span></td>
<td class="ltx_td ltx_align_center" id="S5.T5.1.6.5.5" style="padding-top:1pt;padding-bottom:1pt;">92.28%</td>
</tr>
<tr class="ltx_tr" id="S5.T5.1.7.6">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T5.1.7.6.1" style="padding-top:1pt;padding-bottom:1pt;">SELU</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T5.1.7.6.2" style="padding-top:1pt;padding-bottom:1pt;"><span class="ltx_text ltx_font_bold" id="S5.T5.1.7.6.2.1">93.33%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T5.1.7.6.3" style="padding-top:1pt;padding-bottom:1pt;">97.67%</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T5.1.7.6.4" style="padding-top:1pt;padding-bottom:1pt;">93.50%</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T5.1.7.6.5" style="padding-top:1pt;padding-bottom:1pt;"><span class="ltx_text ltx_font_bold" id="S5.T5.1.7.6.5.1">94.83%</span></td>
</tr>
</tbody>
</table>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_subsection" id="S5.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4 </span>Ablation Study</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S5.SS4.p1">
<p class="ltx_p" id="S5.SS4.p1.1">We conduct ablation experiments on the critic module and hindsight relabeling in the AI2-THOR environemnt, and the results are shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#S5.T6" title="Table 6 ‣ 5.4 Ablation Study ‣ 5 Experiments ‣ SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_tag">6</span></a>. SELU w/o HR means that we do not perform hindsight relabeling to reanalyze the trajectory when evaluating the task. SELU w/o critic means that we remove both self-asking and hindsight relabeling and use the data obtained from environment interaction to directly fine-tune the actor. In this case, the evaluation result of the critic is derived from the original MLLM.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="S5.T6">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 6: </span>Ablation study in the AI2-THOR environment.</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S5.T6.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T6.1.1.1">
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T6.1.1.1.1" rowspan="2" style="padding-top:1pt;padding-bottom:1pt;"><span class="ltx_text" id="S5.T6.1.1.1.1.1">Task</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="3" id="S5.T6.1.1.1.2" style="padding-top:1pt;padding-bottom:1pt;">Critic (Success Detection Accuracy)</td>
<td class="ltx_td ltx_align_top ltx_border_tt" id="S5.T6.1.1.1.3" style="padding-top:1pt;padding-bottom:1pt;"></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="3" id="S5.T6.1.1.1.4" style="padding-top:1pt;padding-bottom:1pt;">Actor (Task Success Rate)</td>
</tr>
<tr class="ltx_tr" id="S5.T6.1.2.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.1.2.2.1" style="padding-top:1pt;padding-bottom:1pt;">SELU</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.1.2.2.2" style="padding-top:1pt;padding-bottom:1pt;">w/o HR</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.1.2.2.3" style="padding-top:1pt;padding-bottom:1pt;">w/o critic</td>
<td class="ltx_td ltx_align_top" id="S5.T6.1.2.2.4" style="padding-top:1pt;padding-bottom:1pt;"></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.1.2.2.5" style="padding-top:1pt;padding-bottom:1pt;">SELU</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.1.2.2.6" style="padding-top:1pt;padding-bottom:1pt;">w/o HR</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.1.2.2.7" style="padding-top:1pt;padding-bottom:1pt;">w/o critic</td>
</tr>
<tr class="ltx_tr" id="S5.T6.1.3.3">
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.1.3.3.1" style="padding-top:1pt;padding-bottom:1pt;">Pick Up</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.1.3.3.2" style="padding-top:1pt;padding-bottom:1pt;"><span class="ltx_text ltx_font_bold" id="S5.T6.1.3.3.2.1">94.33%</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.1.3.3.3" style="padding-top:1pt;padding-bottom:1pt;">83.67%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.1.3.3.4" style="padding-top:1pt;padding-bottom:1pt;">80.67%</td>
<td class="ltx_td ltx_align_top ltx_border_t" id="S5.T6.1.3.3.5" style="padding-top:1pt;padding-bottom:1pt;"></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.1.3.3.6" style="padding-top:1pt;padding-bottom:1pt;"><span class="ltx_text ltx_font_bold" id="S5.T6.1.3.3.6.1">94.67%</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.1.3.3.7" style="padding-top:1pt;padding-bottom:1pt;">67.33%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.1.3.3.8" style="padding-top:1pt;padding-bottom:1pt;">56.33%</td>
</tr>
<tr class="ltx_tr" id="S5.T6.1.4.4">
<td class="ltx_td ltx_align_center" id="S5.T6.1.4.4.1" style="padding-top:1pt;padding-bottom:1pt;">Open</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.4.4.2" style="padding-top:1pt;padding-bottom:1pt;"><span class="ltx_text ltx_font_bold" id="S5.T6.1.4.4.2.1">67.50%</span></td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.4.4.3" style="padding-top:1pt;padding-bottom:1pt;">31.50%</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.4.4.4" style="padding-top:1pt;padding-bottom:1pt;">36.67%</td>
<td class="ltx_td ltx_align_top" id="S5.T6.1.4.4.5" style="padding-top:1pt;padding-bottom:1pt;"></td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.4.4.6" style="padding-top:1pt;padding-bottom:1pt;"><span class="ltx_text ltx_font_bold" id="S5.T6.1.4.4.6.1">83.50%</span></td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.4.4.7" style="padding-top:1pt;padding-bottom:1pt;">66.50%</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.4.4.8" style="padding-top:1pt;padding-bottom:1pt;">72.50%</td>
</tr>
<tr class="ltx_tr" id="S5.T6.1.5.5">
<td class="ltx_td ltx_align_center" id="S5.T6.1.5.5.1" style="padding-top:1pt;padding-bottom:1pt;">Break</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.5.5.2" style="padding-top:1pt;padding-bottom:1pt;"><span class="ltx_text ltx_font_bold" id="S5.T6.1.5.5.2.1">87.50%</span></td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.5.5.3" style="padding-top:1pt;padding-bottom:1pt;">83.50%</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.5.5.4" style="padding-top:1pt;padding-bottom:1pt;">50.50%</td>
<td class="ltx_td ltx_align_top" id="S5.T6.1.5.5.5" style="padding-top:1pt;padding-bottom:1pt;"></td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.5.5.6" style="padding-top:1pt;padding-bottom:1pt;"><span class="ltx_text ltx_font_bold" id="S5.T6.1.5.5.6.1">30.50%</span></td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.5.5.7" style="padding-top:1pt;padding-bottom:1pt;">27.50%</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.5.5.8" style="padding-top:1pt;padding-bottom:1pt;">17.50%</td>
</tr>
<tr class="ltx_tr" id="S5.T6.1.6.6">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T6.1.6.6.1" style="padding-top:1pt;padding-bottom:1pt;">Avg.</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T6.1.6.6.2" style="padding-top:1pt;padding-bottom:1pt;"><span class="ltx_text ltx_font_bold" id="S5.T6.1.6.6.2.1">83.11%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T6.1.6.6.3" style="padding-top:1pt;padding-bottom:1pt;">66.22%</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T6.1.6.6.4" style="padding-top:1pt;padding-bottom:1pt;">55.95%</td>
<td class="ltx_td ltx_align_top ltx_border_bb" id="S5.T6.1.6.6.5" style="padding-top:1pt;padding-bottom:1pt;"></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T6.1.6.6.6" style="padding-top:1pt;padding-bottom:1pt;"><span class="ltx_text ltx_font_bold" id="S5.T6.1.6.6.6.1">69.56%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T6.1.6.6.7" style="padding-top:1pt;padding-bottom:1pt;">57.11%</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T6.1.6.6.8" style="padding-top:1pt;padding-bottom:1pt;">48.78%</td>
</tr>
</tbody>
</table>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S5.SS4.p2">
<p class="ltx_p" id="S5.SS4.p2.1">By comparing SELU and SELU w/o critic, we can see the importance of critic clearly. Only by understanding the environment can we achieve the improvement of decision-making in all tasks. By comparing SELU w/o HR and SELU w/o critic, we find that self-asking can correct the critic’s comprehension of the environmental task, but reflection on a single task is not enough. In Open tasks, we find that the lack of hindsight relabeling directly leads to the disappearance for some instructions, which causes the declined performance of success detection and decision-making. We can observe the improvement from SELU w/o HR to SELU. By incorporating hindsight relabeling, we can perform a comprehensive multi-task evaluation for each trajectory, ensuring that the embodied MLLM achieves self-learning on each task. Consequently, self-asking and hindsight relabeling are essential components of the critic.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="S5.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.5 </span>Hyperparameter Analysis</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S5.SS5.p1">
<p class="ltx_p" id="S5.SS5.p1.1"><span class="ltx_text ltx_font_bold" id="S5.SS5.p1.1.1">Online Dataset Size.</span>
Since the MLLMs fine-tuning process is sensitive to the dataset size, we explore the amount of interaction data required to achieve effective learning for embodied tasks. We conduct multiple tests on this variable based on picking up tasks in the AI2-THOR environment. The results are presented in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#S5.F3.sf1" title="In Figure 3 ‣ 5.5 Hyperparameter Analysis ‣ 5 Experiments ‣ SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_tag">3(a)</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS5.p2">
<p class="ltx_p" id="S5.SS5.p2.1">The size of dataset is described by the number of trajectories for a single task. For instance, dataset-10k indicates that 10k trajectories are collected for a specific task, such as picking up an apple, during online interactions. We evaluate the performance through the actor in terms of task success rate. We can see that the performance of dataset-1k is close to that of dataset-10k. For dataset-10k, it takes about two days to collect one epoch data. To balance experimental performance with sampling efficiency, we opt to sample 1k trajectories per task in our experiments.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS5.p3">
<p class="ltx_p" id="S5.SS5.p3.1">Based on this conclusion, we employ a data augmentation method during the actor training process. Since MLLMs tend to prioritize text over images when making decisions, they often focus excessively on the text prompt and overlook image comprehension. To address this issue, we shuffle the action lists in the prompts of training data to provide multiple prompts for the same image. This approach not only increases the dataset size, but also strengthens the connection between the MLLM policy and the observations.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS5.p4">
<p class="ltx_p" id="S5.SS5.p4.1"><span class="ltx_text ltx_font_bold" id="S5.SS5.p4.1.1">Learning Rate.</span>
The learning rate is a critical factor, which prevents us from using the same MLLM for the actor and critic. We test different learning rates for the actor and critic separately on picking up tasks in the AI2-THOR, and the results are shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#S5.F3.sf2" title="In Figure 3 ‣ 5.5 Hyperparameter Analysis ‣ 5 Experiments ‣ SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_tag">3(b)</span></a>. We find that, due to the varying sizes of the fine-tuning datasets, using a uniform learning rate inevitably leads to overfitting or underfitting in one of the components, thereby impacting the overall performance of SELU. Therefore, we ultimately use two MLLMs to construct the SELU framework, ensuring effective self-learning. In our experiments, the learning rate for the critic is set to 2e-6, while that for the actor is set to 2e-5.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="S5.F3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F3.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="200" id="S5.F3.sf1.g1" src="https://arxiv.org/html/2410.03303v1/x5.png" width="249">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Dataset Size</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F3.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="186" id="S5.F3.sf2.g1" src="https://arxiv.org/html/2410.03303v1/x6.png" width="257">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Learning Rate</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F3.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="189" id="S5.F3.sf3.g1" src="https://arxiv.org/html/2410.03303v1/x7.png" width="257">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>Training Iterations</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Hyperparameter study of SELU on picking up tasks in the AI2-THOR environment: (a) explores the size of the interaction dataset required for embodied MLLMs, (b) illustrates why a single MLLM is not suitable for SELU from the perspective of learning rare, and (c) demonstrates that the effect of multiple training iterations.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S5.SS5.p5">
<p class="ltx_p" id="S5.SS5.p5.1"><span class="ltx_text ltx_font_bold" id="S5.SS5.p5.1.1">Training Iterations.</span>
The goal of our framework is to achieve multi-iteration self-learning improvement; therefore, we also evaluate the results of multiple rounds of fine-tuning on picking up tasks in the AI2-THOR environment. The results are presented in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#S5.F3.sf3" title="In Figure 3 ‣ 5.5 Hyperparameter Analysis ‣ 5 Experiments ‣ SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_tag">3(c)</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS5.p6">
<p class="ltx_p" id="S5.SS5.p6.1">Our results indicate that multiple iterations of fine-tuning do not consistently improve SELU’s performance in every iteration. Both the actor and critic exhibit significant performance improvements during the first iteration of fine-tuning, but show fluctuations and minimal growth in the subsequent iterations. We attribute this limitation to the performance of the critic. The critic performs the success detection based on the last frame of the trajectory, making it difficult to compare the quality of successful trajectories. Once the actor reaches a level sufficient to roughly complete the task, we lack the nuanced supervisory signals to guide the actor for further improvement. Consequently, while there is a notable improvement after the first iteration, subsequent enhancements are limited. We also attempt to increase the number of frames for success detection. However, the performance of the small-scale MLLM does not meet our needs.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion and Limitation</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">In this paper, we introduce SELU, a method for MLLMs to achieve self-learning in unknown environments. SELU facilitates interaction with the environment, analyzes interaction trajectories, builds an online dataset, and performs coupled optimization of the actor and critic. We employ self-asking and hindsight relabeling to enhance the critic task evaluation capabilities. Ablation experiments demonstrate that relabeling significantly expands the critic task judgment range. By leveraging the principle that MLLMs possess stronger perceptual abilities than decision-making abilities, we improve the performance of the actor policy. We test SELU in the AI2-THOR and VirtualHome environments, achieving critic improvements of approximately 28% and 30%, and policy improvements of about 20% and 24%, respectively. Additionally, to validate the applicability of SELU across different MLLMs, we evaluate it on Qwen-VL, resulting in a 23% performance enhancement.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S6.p2">
<p class="ltx_p" id="S6.p2.1">One limitation of SELU is the lack of a detailed evaluation of the trajectories that complete the tasks. SELU can help embodied MLLM to self-learn how to accomplish tasks in unknown environments. The next urgent problem to address is how to complete tasks more efficiently and optimize actions more effectively. In future work, we will explore finer-grained critic signals to perform more accurate quality assessments of trajectories, guiding embodied MLLMs to tackle more complex tasks, like long-horizon combination tasks.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Andrychowicz et&nbsp;al. (2017)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Marcin Andrychowicz, Filip Wolski, Alex Ray, Jonas Schneider, Rachel Fong, Peter Welinder, Bob McGrew, Josh Tobin, OpenAI Pieter&nbsp;Abbeel, and Wojciech Zaremba.

</span>
<span class="ltx_bibblock">Hindsight experience replay.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">Advances in neural information processing systems</em>, 30, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bai et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jinze Bai, Shuai Bai, Shusheng Yang, Shijie Wang, Sinan Tan, Peng Wang, Junyang Lin, Chang Zhou, and Jingren Zhou.

</span>
<span class="ltx_bibblock">Qwen-vl: A versatile vision-language model for understanding, localization, text reading, and beyond.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">arXiv preprint arXiv:2308.12966</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brown et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Tom Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared&nbsp;D Kaplan, Prafulla Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda Askell, Sandhini Agarwal, Ariel Herbert-Voss, Gretchen Krueger, Tom Henighan, Rewon Child, Aditya Ramesh, Daniel Ziegler, Jeffrey Wu, Clemens Winter, Chris Hesse, Mark Chen, Eric Sigler, Mateusz Litwin, Scott Gray, Benjamin Chess, Jack Clark, Christopher Berner, Sam McCandlish, Alec Radford, Ilya Sutskever, and Dario Amodei.

</span>
<span class="ltx_bibblock">Language models are few-shot learners.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">Advances in Neural Information Processing Systems</em>, volume&nbsp;33, pp.&nbsp; 1877–1901. Curran Associates, Inc., 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Xiang Chen, Chenxi Wang, Ningyu Zhang, Yida Xue, xiaoyan yang, YUE SHEN, Jinjie GU, and Huajun Chen.

</span>
<span class="ltx_bibblock">Unified hallucination detection for multimodal large language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">ICLR 2024 Workshop on Reliable and Responsible Foundation Models</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Zhiyu Chen, Wenhu Chen, Charese Smiley, Sameena Shah, Iana Borova, Dylan Langdon, Reema Moussa, Matt Beane, Ting-Hao Huang, Bryan Routledge, and William&nbsp;Yang Wang.

</span>
<span class="ltx_bibblock">FinQA: A dataset of numerical reasoning over financial data.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">Proceedings of the 2021 Conference on Empirical Methods in Natural Language Processing</em>, pp.&nbsp; 3697–3711. Association for Computational Linguistics, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Choi et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Wonje Choi, Woo&nbsp;Kyung Kim, Minjong Yoo, and Honguk Woo.

</span>
<span class="ltx_bibblock">Embodied cot distillation from LLM to off-the-shelf agents.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">Forty-first International Conference on Machine Learning</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dai et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Josef Dai, Xuehai Pan, Ruiyang Sun, Jiaming Ji, Xinbo Xu, Mickel Liu, Yizhou Wang, and Yaodong Yang.

</span>
<span class="ltx_bibblock">Safe RLHF: Safe reinforcement learning from human feedback.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">The Twelfth International Conference on Learning Representations</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Devlin et&nbsp;al. (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova.

</span>
<span class="ltx_bibblock">Bert: Pre-training of deep bidirectional transformers for language understanding.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">North American Chapter of the Association for Computational Linguistics</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dong et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yihong Dong, Kangcheng Luo, Xue Jiang, Zhi Jin, and Ge&nbsp;Li.

</span>
<span class="ltx_bibblock">PACE: Improving prompt with actor-critic editing for large language model.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">Findings of the Association for Computational Linguistics ACL 2024</em>, pp.&nbsp; 7304–7323, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Feng et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Guhao Feng, Bohang Zhang, Yuntian Gu, Haotian Ye, Di&nbsp;He, and Liwei Wang.

</span>
<span class="ltx_bibblock">Towards revealing the mystery behind chain of thought: A theoretical perspective.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">Advances in Neural Information Processing Systems</em>, volume&nbsp;36, pp.&nbsp; 70757–70798. Curran Associates, Inc., 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gero et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Zelalem Gero, Chandan Singh, Hao Cheng, Tristan Naumann, Michel Galley, Jianfeng Gao, and Hoifung Poon.

</span>
<span class="ltx_bibblock">Self-verification improves few-shot clinical information extraction.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">ICML 3rd Workshop on Interpretable Machine Learning in Healthcare (IMLH)</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gou et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Zhibin Gou, Zhihong Shao, Yeyun Gong, yelong shen, Yujiu Yang, Nan Duan, and Weizhu Chen.

</span>
<span class="ltx_bibblock">CRITIC: Large language models can self-correct with tool-interactive critiquing.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">The Twelfth International Conference on Learning Representations</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Haluptzok et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Patrick Haluptzok, Matthew Bowers, and Adam&nbsp;Tauman Kalai.

</span>
<span class="ltx_bibblock">Language models can teach themselves to program better.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">The Eleventh International Conference on Learning Representations</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Edward&nbsp;J Hu, yelong shen, Phillip Wallis, Zeyuan Allen-Zhu, Yuanzhi Li, Shean Wang, Lu&nbsp;Wang, and Weizhu Chen.

</span>
<span class="ltx_bibblock">LoRA: Low-rank adaptation of large language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">International Conference on Learning Representations</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jiaxin Huang, Shixiang Gu, Le&nbsp;Hou, Yuexin Wu, Xuezhi Wang, Hongkun Yu, and Jiawei Han.

</span>
<span class="ltx_bibblock">Large language models can self-improve.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Proceedings of the 2023 Conference on Empirical Methods in Natural Language Processing</em>, pp.&nbsp; 1051–1068. Association for Computational Linguistics, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Qidong Huang, Xiaoyi Dong, Pan Zhang, Bin Wang, Conghui He, Jiaqi Wang, Dahua Lin, Weiming Zhang, and Nenghai Yu.

</span>
<span class="ltx_bibblock">Opera: Alleviating hallucination in multi-modal large language models via over-trust penalty and retrospection-allocation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pp.&nbsp; 13418–13427, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Chaoya Jiang, Haiyang Xu, Mengfan Dong, Jiaxing Chen, Wei Ye, Ming Yan, Qinghao Ye, Ji&nbsp;Zhang, Fei Huang, and Shikun Zhang.

</span>
<span class="ltx_bibblock">Hallucination augmented contrastive learning for multimodal large language model.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pp.&nbsp; 27036–27046, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kirk et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Robert Kirk, Ishita Mediratta, Christoforos Nalmpantis, Jelena Luketina, Eric Hambro, Edward Grefenstette, and Roberta Raileanu.

</span>
<span class="ltx_bibblock">Understanding the effects of RLHF on LLM generalisation and diversity.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">The Twelfth International Conference on Learning Representations</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kolve et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Eric Kolve, Roozbeh Mottaghi, Winson Han, Eli VanderBilt, Luca Weihs, Alvaro Herrasti, Matt Deitke, Kiana Ehsani, Daniel Gordon, Yuke Zhu, Aniruddha Kembhavi, Abhinav Gupta, and Ali Farhadi.

</span>
<span class="ltx_bibblock">Ai2-thor: An interactive 3d environment for visual ai, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Konda &amp; Tsitsiklis (1999)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Vijay Konda and John Tsitsiklis.

</span>
<span class="ltx_bibblock">Actor-critic algorithms.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">Advances in neural information processing systems</em>, 12, 1999.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et&nbsp;al. (2024a)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Miaoran Li, Baolin Peng, Michel Galley, Jianfeng Gao, and Zhu Zhang.

</span>
<span class="ltx_bibblock">Self-checker: Plug-and-play modules for fact-checking with large language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">Findings of the Association for Computational Linguistics: NAACL 2024</em>, pp.&nbsp; 163–181. Association for Computational Linguistics, 2024a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et&nbsp;al. (2024b)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Xiaoqi Li, Mingxu Zhang, Yiran Geng, Haoran Geng, Yuxing Long, Yan Shen, Renrui Zhang, Jiaming Liu, and Hao Dong.

</span>
<span class="ltx_bibblock">Manipllm: Embodied multimodal large language model for object-centric robotic manipulation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pp.&nbsp; 18061–18070, 2024b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et&nbsp;al. (2024c)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Zaijing Li, Yuquan Xie, Rui Shao, Gongwei Chen, Dongmei Jiang, and Liqiang Nie.

</span>
<span class="ltx_bibblock">Optimus-1: Hybrid multimodal memory empowered agents excel in long-horizon tasks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">arXiv preprint arXiv:2408.03615</em>, 2024c.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lifshitz et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Shalev Lifshitz, Keiran Paster, Harris Chan, Jimmy Ba, and Sheila&nbsp;A. McIlraith.

</span>
<span class="ltx_bibblock">STEVE-1: A generative model for text-to-behavior in minecraft.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">Thirty-seventh Conference on Neural Information Processing Systems</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Haotian Liu, Chunyuan Li, Qingyang Wu, and Yong&nbsp;Jae Lee.

</span>
<span class="ltx_bibblock">Visual instruction tuning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">Advances in Neural Information Processing Systems</em>, volume&nbsp;36, pp.&nbsp; 34892–34916. Curran Associates, Inc., 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Junpeng Liu, Yifan Song, Bill&nbsp;Yuchen Lin, Wai Lam, Graham Neubig, Yuanzhi Li, and Xiang Yue.

</span>
<span class="ltx_bibblock">Visualwebbench: How far have multimodal LLMs evolved in web page understanding and grounding?

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">First Conference on Language Modeling</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lu et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Pan Lu, Hritik Bansal, Tony Xia, Jiacheng Liu, Chunyuan Li, Hannaneh Hajishirzi, Hao Cheng, Kai-Wei Chang, Michel Galley, and Jianfeng Gao.

</span>
<span class="ltx_bibblock">Mathvista: Evaluating mathematical reasoning of foundation models in visual contexts.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">The Twelfth International Conference on Learning Representations</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ma et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Xinbei Ma, Zhuosheng Zhang, and Hai Zhao.

</span>
<span class="ltx_bibblock">CoCo-agent: A comprehensive cognitive MLLM agent for smartphone GUI automation.

</span>
<span class="ltx_bibblock">pp.&nbsp; 9097–9110. Association for Computational Linguistics, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Madaan et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Aman Madaan, Niket Tandon, Prakhar Gupta, Skyler Hallinan, Luyu Gao, Sarah Wiegreffe, Uri Alon, Nouha Dziri, Shrimai Prabhumoye, Yiming Yang, Shashank Gupta, Bodhisattwa&nbsp;Prasad Majumder, Katherine Hermann, Sean Welleck, Amir Yazdanbakhsh, and Peter Clark.

</span>
<span class="ltx_bibblock">Self-refine: Iterative refinement with self-feedback.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">Advances in Neural Information Processing Systems</em>, volume&nbsp;36, pp.&nbsp; 46534–46594. Curran Associates, Inc., 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mathew et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Minesh Mathew, Dimosthenis Karatzas, and CV&nbsp;Jawahar.

</span>
<span class="ltx_bibblock">Docvqa: A dataset for vqa on document images.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">Proceedings of the IEEE/CVF winter conference on applications of computer vision</em>, pp.&nbsp; 2200–2209, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McAleese et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Nat McAleese, Rai&nbsp;Michael Pokorny, Juan Felipe&nbsp;Ceron Uribe, Evgenia Nitishinskaya, Maja Trebacz, and Jan Leike.

</span>
<span class="ltx_bibblock">Llm critics help catch llm bugs.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">arXiv preprint arXiv:2407.00215</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ouyang et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Long Ouyang, Jeffrey Wu, Xu&nbsp;Jiang, Diogo Almeida, Carroll Wainwright, Pamela Mishkin, Chong Zhang, Sandhini Agarwal, Katarina Slama, Alex Ray, et&nbsp;al.

</span>
<span class="ltx_bibblock">Training language models to follow instructions with human feedback.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">Advances in neural information processing systems</em>, 35:27730–27744, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pan et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Liangming Pan, Michael Saxon, Wenda Xu, Deepak Nathani, Xinyi Wang, and William&nbsp;Yang Wang.

</span>
<span class="ltx_bibblock">Automatically correcting large language models: Surveying the landscape of diverse automated correction strategies.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">Transactions of the Association for Computational Linguistics</em>, 12:484–506, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pang et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jing-Cheng Pang, Pengyuan Wang, Kaiyuan Li, Xiong-Hui Chen, Jiacheng Xu, Zongzhang Zhang, and Yang Yu.

</span>
<span class="ltx_bibblock">Language model self-improvement by reinforcement learning contemplation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">The Twelfth International Conference on Learning Representations</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Puig et&nbsp;al. (2018)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Xavier Puig, Kevin Ra, Marko Boben, Jiaman Li, Tingwu Wang, Sanja Fidler, and Antonio Torralba.

</span>
<span class="ltx_bibblock">Virtualhome: Simulating household activities via programs.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition (CVPR)</em>, June 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qi et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Siyuan Qi, Shuo Chen, Yexin Li, Xiangyu Kong, Junqi Wang, Bangcheng Yang, Pring Wong, Yifan Zhong, Xiaoyuan Zhang, Zhaowei Zhang, Nian Liu, Yaodong Yang, and Song-Chun Zhu.

</span>
<span class="ltx_bibblock">Civrealm: A learning and reasoning odyssey in civilization for decision-making agents.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">The Twelfth International Conference on Learning Representations</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rafailov et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Rafael Rafailov, Archit Sharma, Eric Mitchell, Christopher&nbsp;D Manning, Stefano Ermon, and Chelsea Finn.

</span>
<span class="ltx_bibblock">Direct preference optimization: Your language model is secretly a reward model.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schick et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Timo Schick, Jane&nbsp;A. Yu, Zhengbao Jiang, Fabio Petroni, Patrick Lewis, Gautier Izacard, Qingfei You, Christoforos Nalmpantis, Edouard Grave, and Sebastian Riedel.

</span>
<span class="ltx_bibblock">PEER: A collaborative language model.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">The Eleventh International Conference on Learning Representations</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schulman et&nbsp;al. (2017)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
John Schulman, Filip Wolski, Prafulla Dhariwal, Alec Radford, and Oleg Klimov.

</span>
<span class="ltx_bibblock">Proximal policy optimization algorithms.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">arXiv preprint arXiv:1707.06347</em>, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Song et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Feifan Song, Bowen Yu, Minghao Li, Haiyang Yu, Fei Huang, Yongbin Li, and Houfeng Wang.

</span>
<span class="ltx_bibblock">Preference ranking optimization for human alignment.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">Proceedings of the AAAI Conference on Artificial Intelligence</em>, volume&nbsp;38, pp.&nbsp; 18990–18998, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sontakke et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Sumedh Sontakke, Jesse Zhang, Séb Arnold, Karl Pertsch, Erdem Bı&nbsp;yık, Dorsa Sadigh, Chelsea Finn, and Laurent Itti.

</span>
<span class="ltx_bibblock">Roboclip: One demonstration is enough to learn robot policies.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">Advances in Neural Information Processing Systems</em>, volume&nbsp;36, pp.&nbsp; 55681–55693. Curran Associates, Inc., 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Su et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Dan Su, Xiaoguang Li, Jindi Zhang, Lifeng Shang, Xin Jiang, Qun Liu, and Pascale Fung.

</span>
<span class="ltx_bibblock">Read before generate! faithful long form question answering with machine reading.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">Findings of the Association for Computational Linguistics: ACL 2022</em>, pp.&nbsp; 744–756. Association for Computational Linguistics, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Zhiqing Sun, Sheng Shen, Shengcao Cao, Haotian Liu, Chunyuan Li, Yikang Shen, Chuang Gan, Liangyan Gui, Yu-Xiong Wang, Yiming Yang, Kurt Keutzer, and Trevor Darrell.

</span>
<span class="ltx_bibblock">Aligning large multimodal models with factually augmented RLHF.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">Findings of the Association for Computational Linguistics ACL 2024</em>, pp.&nbsp; 13088–13110. Association for Computational Linguistics, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tan et&nbsp;al. (2024a)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Weihao Tan, Wentao Zhang, Shanqi Liu, Longtao Zheng, Xinrun Wang, and Bo&nbsp;An.

</span>
<span class="ltx_bibblock">True knowledge comes from practice: Aligning large language models with embodied environments via reinforcement learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">The Twelfth International Conference on Learning Representations</em>, 2024a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tan et&nbsp;al. (2024b)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Weihao Tan, Wentao Zhang, Xinrun Xu, Haochong Xia, Ziluo Ding, Boyu Li, Bohan Zhou, Junpeng Yue, Jiechuan Jiang, Yewen Li, Ruyi An, Molei Qin, Chuqiao Zong, Longtao Zheng, Yujie Wu, Xiaoqiang Chai, Yifei Bi, Tianbao Xie, Pengjie Gu, Xiyun Li, Ceyao Zhang, Long Tian, Chaojie Wang, Xinrun Wang, Börje&nbsp;F. Karlsson, Bo&nbsp;An, Shuicheng Yan, and Zongqing Lu.

</span>
<span class="ltx_bibblock">Cradle: Empowering foundation agents towards general computer control, 2024b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tan et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Xiaoyu Tan, Shaojie Shi, Xihe Qiu, Chao Qu, Zhenting Qi, Yinghui Xu, and Yuan Qi.

</span>
<span class="ltx_bibblock">Self-criticism: Aligning large language models with their understanding of helpfulness, honesty, and harmlessness.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib46.1.1">Proceedings of the 2023 Conference on Empirical Methods in Natural Language Processing: Industry Track</em>, pp.&nbsp; 650–662, Singapore, 2023. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tang et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jingqun Tang, Qi&nbsp;Liu, Yongjie Ye, Jinghui Lu, Shu Wei, Chunhui Lin, Wanqing Li, Mohamad Fitri Faiz&nbsp;Bin Mahmood, Hao Feng, Zhen Zhao, et&nbsp;al.

</span>
<span class="ltx_bibblock">Mtvqa: Benchmarking multilingual text-centric visual question answering.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib47.1.1">arXiv preprint arXiv:2405.11985</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tao et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Heyi Tao, Sethuraman T&nbsp;V, Michal Shlapentokh-Rothman, Tanmay Gupta, Heng Ji, and Derek Hoiem.

</span>
<span class="ltx_bibblock">WebWISE: Unlocking web interface control for LLMs via sequential exploration.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib48.1.1">Findings of the Association for Computational Linguistics: NAACL 2024</em>, pp.&nbsp; 3693–3711. Association for Computational Linguistics, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Urcelay et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Belen&nbsp;Martin Urcelay, Andreas Krause, and Giorgia Ramponi.

</span>
<span class="ltx_bibblock">Reinforcement learning from human text feedback: Learning a reward model from human text input.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib49.1.1">ICML 2024 Workshop on Models of Human Feedback for AI Alignment</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et&nbsp;al. (2024a)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Tianlu Wang, Ilia Kulikov, Olga Golovneva, Ping Yu, Weizhe Yuan, Jane Dwivedi-Yu, Richard&nbsp;Yuanzhe Pang, Maryam Fazel-Zarandi, Jason Weston, and Xian Li.

</span>
<span class="ltx_bibblock">Self-taught evaluators.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib50.1.1">arXiv preprint arXiv:2408.02666</em>, 2024a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et&nbsp;al. (2023a)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Xuezhi Wang, Jason Wei, Dale Schuurmans, Quoc&nbsp;V Le, Ed&nbsp;H. Chi, Sharan Narang, Aakanksha Chowdhery, and Denny Zhou.

</span>
<span class="ltx_bibblock">Self-consistency improves chain of thought reasoning in language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib51.1.1">The Eleventh International Conference on Learning Representations</em>, 2023a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et&nbsp;al. (2024b)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yufei Wang, Zhanyi Sun, Jesse Zhang, Zhou Xian, Erdem Biyik, David Held, and Zackory Erickson.

</span>
<span class="ltx_bibblock">RL-VLM-f: Reinforcement learning from vision language foundation model feedback.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib52.1.1">Proceedings of the 41st International Conference on Machine Learning</em>, volume 235, pp.&nbsp; 51484–51501. PMLR, 21–27 Jul 2024b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et&nbsp;al. (2023b)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Zihao Wang, Shaofei Cai, Anji Liu, Xiaojian Ma, and Yitao Liang.

</span>
<span class="ltx_bibblock">JARVIS-1: Open-world multi-task agents with memory-augmented multimodal language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib53.1.1">Second Agent Learning in Open-Endedness Workshop</em>, 2023b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wei et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jason Wei, Xuezhi Wang, Dale Schuurmans, Maarten Bosma, brian ichter, Fei Xia, Ed&nbsp;Chi, Quoc&nbsp;V Le, and Denny Zhou.

</span>
<span class="ltx_bibblock">Chain-of-thought prompting elicits reasoning in large language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib54.1.1">Advances in Neural Information Processing Systems</em>, volume&nbsp;35, pp.&nbsp; 24824–24837. Curran Associates, Inc., 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wen et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Licheng Wen, Xuemeng Yang, Daocheng Fu, Xiaofeng Wang, Pinlong Cai, Xin Li, Tao MA, Yingxuan Li, Linran XU, Dengke Shang, Zheng Zhu, Shaoyan Sun, Yeqi BAI, Xinyu Cai, Min Dou, Shuanglu Hu, Botian Shi, and Yu&nbsp;Qiao.

</span>
<span class="ltx_bibblock">On the road with GPT-4v(ision): Explorations of utilizing visual-language model as autonomous driving agent.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib55.1.1">ICLR 2024 Workshop on Large Language Model (LLM) Agents</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Winter et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Robin Winter, Marco Bertolini, Tuan Le, Frank Noe, and Djork-Arné Clevert.

</span>
<span class="ltx_bibblock">Unsupervised learning of group invariant and equivariant representations.

</span>
<span class="ltx_bibblock">In Alice&nbsp;H. Oh, Alekh Agarwal, Danielle Belgrave, and Kyunghyun Cho (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib56.1.1">Advances in Neural Information Processing Systems</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib57">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiong et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Chuyan Xiong, Chengyu Shen, Xiaoqi Li, Kaichen Zhou, Jiaming Liu, Ruiping Wang, and Hao Dong.

</span>
<span class="ltx_bibblock">Autonomous interactive correction MLLM for robust robotic manipulation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib57.1.1">8th Annual Conference on Robot Learning</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib58">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Wenda Xu, Danqing Wang, Liangming Pan, Zhenqiao Song, Markus Freitag, William Wang, and Lei Li.

</span>
<span class="ltx_bibblock">INSTRUCTSCORE: Towards explainable text generation evaluation with automatic feedback.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib58.1.1">Proceedings of the 2023 Conference on Empirical Methods in Natural Language Processing</em>, pp.&nbsp; 5967–5994. Association for Computational Linguistics, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib59">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Xinrun Xu, Yuxin Wang, Chaoyi Xu, Ziluo Ding, Jiechuan Jiang, Zhiming Ding, and Börje&nbsp;F. Karlsson.

</span>
<span class="ltx_bibblock">A survey on game playing agents and large models: Methods, applications, and challenges, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib60">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yan et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yiming Yan, Tao Wang, Chengqi Zhao, Shujian Huang, Jiajun Chen, and Mingxuan Wang.

</span>
<span class="ltx_bibblock">BLEURT has universal translations: An analysis of automatic metrics by minimum risk training.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib60.1.1">Proceedings of the 61st Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers)</em>, pp.&nbsp; 5428–5443. Association for Computational Linguistics, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib61">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Tianyu Yu, Yuan Yao, Haoye Zhang, Taiwen He, Yifeng Han, Ganqu Cui, Jinyi Hu, Zhiyuan Liu, Hai-Tao Zheng, Maosong Sun, and Tat-Seng Chua.

</span>
<span class="ltx_bibblock">Rlhf-v: Towards trustworthy mllms via behavior alignment from fine-grained correctional human feedback.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib61.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>, pp.&nbsp; 13807–13816, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib62">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jiawei Zhang, Chejian Xu, and Bo&nbsp;Li.

</span>
<span class="ltx_bibblock">Chatscene: Knowledge-enabled safety-critical scenario generation for autonomous vehicles.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib62.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>, pp.&nbsp; 15459–15469, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib63">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et&nbsp;al. (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Han Zhao, Remi&nbsp;Tachet Des&nbsp;Combes, Kun Zhang, and Geoffrey Gordon.

</span>
<span class="ltx_bibblock">On learning invariant representations for domain adaptation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib63.1.1">International conference on machine learning</em>, pp.&nbsp; 7523–7532. PMLR, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib64">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhong et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yinmin Zhong, Zili Zhang, Bingyang Wu, Shengyu Liu, Yukun Chen, Changyi Wan, Hanpeng Hu, Lei Xia, Ranchen Ming, Yibo Zhu, et&nbsp;al.

</span>
<span class="ltx_bibblock">Rlhfuse: Efficient rlhf training for large language models with inter-and intra-stage fusion.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib64.1.1">arXiv preprint arXiv:2409.13221</em>, 2024.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Appendix</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsection" id="A1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Pseudocode of SELU</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A1.SS1.p1">
<span class="ltx_ERROR undefined" id="A1.SS1.p1.1">{CJK*}</span>
<p class="ltx_p" id="A1.SS1.p1.2">UTF8gkai</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.2.1.1">algorithm 1</span> </span> SELU</figcaption>
<div class="ltx_listing ltx_listing" id="alg1.3">
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_tag ltx_tag_listingline">1:</span>critic MLLM <math alttext="M_{c}" class="ltx_Math" display="inline" id="alg1.l1.m1.1"><semantics id="alg1.l1.m1.1a"><msub id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml"><mi id="alg1.l1.m1.1.1.2" xref="alg1.l1.m1.1.1.2.cmml">M</mi><mi id="alg1.l1.m1.1.1.3" xref="alg1.l1.m1.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><apply id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.1.cmml" xref="alg1.l1.m1.1.1">subscript</csymbol><ci id="alg1.l1.m1.1.1.2.cmml" xref="alg1.l1.m1.1.1.2">𝑀</ci><ci id="alg1.l1.m1.1.1.3.cmml" xref="alg1.l1.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">M_{c}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m1.1d">italic_M start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math>, actor MLLM <math alttext="M_{a}" class="ltx_Math" display="inline" id="alg1.l1.m2.1"><semantics id="alg1.l1.m2.1a"><msub id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml"><mi id="alg1.l1.m2.1.1.2" xref="alg1.l1.m2.1.1.2.cmml">M</mi><mi id="alg1.l1.m2.1.1.3" xref="alg1.l1.m2.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><apply id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1"><csymbol cd="ambiguous" id="alg1.l1.m2.1.1.1.cmml" xref="alg1.l1.m2.1.1">subscript</csymbol><ci id="alg1.l1.m2.1.1.2.cmml" xref="alg1.l1.m2.1.1.2">𝑀</ci><ci id="alg1.l1.m2.1.1.3.cmml" xref="alg1.l1.m2.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">M_{a}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m2.1d">italic_M start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math>, critic fine-tuning dataset <math alttext="\mathcal{D}_{\rm critic}" class="ltx_Math" display="inline" id="alg1.l1.m3.1"><semantics id="alg1.l1.m3.1a"><msub id="alg1.l1.m3.1.1" xref="alg1.l1.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l1.m3.1.1.2" xref="alg1.l1.m3.1.1.2.cmml">𝒟</mi><mi id="alg1.l1.m3.1.1.3" xref="alg1.l1.m3.1.1.3.cmml">critic</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.1b"><apply id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1"><csymbol cd="ambiguous" id="alg1.l1.m3.1.1.1.cmml" xref="alg1.l1.m3.1.1">subscript</csymbol><ci id="alg1.l1.m3.1.1.2.cmml" xref="alg1.l1.m3.1.1.2">𝒟</ci><ci id="alg1.l1.m3.1.1.3.cmml" xref="alg1.l1.m3.1.1.3">critic</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.1c">\mathcal{D}_{\rm critic}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m3.1d">caligraphic_D start_POSTSUBSCRIPT roman_critic end_POSTSUBSCRIPT</annotation></semantics></math>, actor fine-tuning dataset <math alttext="\mathcal{D}_{\rm actor}" class="ltx_Math" display="inline" id="alg1.l1.m4.1"><semantics id="alg1.l1.m4.1a"><msub id="alg1.l1.m4.1.1" xref="alg1.l1.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l1.m4.1.1.2" xref="alg1.l1.m4.1.1.2.cmml">𝒟</mi><mi id="alg1.l1.m4.1.1.3" xref="alg1.l1.m4.1.1.3.cmml">actor</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m4.1b"><apply id="alg1.l1.m4.1.1.cmml" xref="alg1.l1.m4.1.1"><csymbol cd="ambiguous" id="alg1.l1.m4.1.1.1.cmml" xref="alg1.l1.m4.1.1">subscript</csymbol><ci id="alg1.l1.m4.1.1.2.cmml" xref="alg1.l1.m4.1.1.2">𝒟</ci><ci id="alg1.l1.m4.1.1.3.cmml" xref="alg1.l1.m4.1.1.3">actor</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m4.1c">\mathcal{D}_{\rm actor}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m4.1d">caligraphic_D start_POSTSUBSCRIPT roman_actor end_POSTSUBSCRIPT</annotation></semantics></math>, maximum timestep <math alttext="T" class="ltx_Math" display="inline" id="alg1.l1.m5.1"><semantics id="alg1.l1.m5.1a"><mi id="alg1.l1.m5.1.1" xref="alg1.l1.m5.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m5.1b"><ci id="alg1.l1.m5.1.1.cmml" xref="alg1.l1.m5.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m5.1c">T</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m5.1d">italic_T</annotation></semantics></math>, initial instruction list <math alttext="L" class="ltx_Math" display="inline" id="alg1.l1.m6.1"><semantics id="alg1.l1.m6.1a"><mi id="alg1.l1.m6.1.1" xref="alg1.l1.m6.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m6.1b"><ci id="alg1.l1.m6.1.1.cmml" xref="alg1.l1.m6.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m6.1c">L</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m6.1d">italic_L</annotation></semantics></math>, success detection prompt <math alttext="p_{d}" class="ltx_Math" display="inline" id="alg1.l1.m7.1"><semantics id="alg1.l1.m7.1a"><msub id="alg1.l1.m7.1.1" xref="alg1.l1.m7.1.1.cmml"><mi id="alg1.l1.m7.1.1.2" xref="alg1.l1.m7.1.1.2.cmml">p</mi><mi id="alg1.l1.m7.1.1.3" xref="alg1.l1.m7.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m7.1b"><apply id="alg1.l1.m7.1.1.cmml" xref="alg1.l1.m7.1.1"><csymbol cd="ambiguous" id="alg1.l1.m7.1.1.1.cmml" xref="alg1.l1.m7.1.1">subscript</csymbol><ci id="alg1.l1.m7.1.1.2.cmml" xref="alg1.l1.m7.1.1.2">𝑝</ci><ci id="alg1.l1.m7.1.1.3.cmml" xref="alg1.l1.m7.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m7.1c">p_{d}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m7.1d">italic_p start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT</annotation></semantics></math> and action plan prompt <math alttext="p_{a}" class="ltx_Math" display="inline" id="alg1.l1.m8.1"><semantics id="alg1.l1.m8.1a"><msub id="alg1.l1.m8.1.1" xref="alg1.l1.m8.1.1.cmml"><mi id="alg1.l1.m8.1.1.2" xref="alg1.l1.m8.1.1.2.cmml">p</mi><mi id="alg1.l1.m8.1.1.3" xref="alg1.l1.m8.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m8.1b"><apply id="alg1.l1.m8.1.1.cmml" xref="alg1.l1.m8.1.1"><csymbol cd="ambiguous" id="alg1.l1.m8.1.1.1.cmml" xref="alg1.l1.m8.1.1">subscript</csymbol><ci id="alg1.l1.m8.1.1.2.cmml" xref="alg1.l1.m8.1.1.2">𝑝</ci><ci id="alg1.l1.m8.1.1.3.cmml" xref="alg1.l1.m8.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m8.1c">p_{a}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m8.1d">italic_p start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_tag ltx_tag_listingline">2:</span>critic MLLM <math alttext="M_{c}" class="ltx_Math" display="inline" id="alg1.l2.m1.1"><semantics id="alg1.l2.m1.1a"><msub id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">M</mi><mi id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1">subscript</csymbol><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">𝑀</ci><ci id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">M_{c}</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.1d">italic_M start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math>, actor MLLM <math alttext="M_{a}" class="ltx_Math" display="inline" id="alg1.l2.m2.1"><semantics id="alg1.l2.m2.1a"><msub id="alg1.l2.m2.1.1" xref="alg1.l2.m2.1.1.cmml"><mi id="alg1.l2.m2.1.1.2" xref="alg1.l2.m2.1.1.2.cmml">M</mi><mi id="alg1.l2.m2.1.1.3" xref="alg1.l2.m2.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l2.m2.1b"><apply id="alg1.l2.m2.1.1.cmml" xref="alg1.l2.m2.1.1"><csymbol cd="ambiguous" id="alg1.l2.m2.1.1.1.cmml" xref="alg1.l2.m2.1.1">subscript</csymbol><ci id="alg1.l2.m2.1.1.2.cmml" xref="alg1.l2.m2.1.1.2">𝑀</ci><ci id="alg1.l2.m2.1.1.3.cmml" xref="alg1.l2.m2.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m2.1c">M_{a}</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m2.1d">italic_M start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_tag ltx_tag_listingline">3:</span><math alttext="\mathcal{D}_{\rm critic}" class="ltx_Math" display="inline" id="alg1.l3.m1.1"><semantics id="alg1.l3.m1.1a"><msub id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml">𝒟</mi><mi id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml">critic</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1">subscript</csymbol><ci id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2">𝒟</ci><ci id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3">critic</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">\mathcal{D}_{\rm critic}</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m1.1d">caligraphic_D start_POSTSUBSCRIPT roman_critic end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\mathcal{D}_{\rm actor}\leftarrow\{\}" class="ltx_Math" display="inline" id="alg1.l3.m2.1"><semantics id="alg1.l3.m2.1a"><mrow id="alg1.l3.m2.1.1" xref="alg1.l3.m2.1.1.cmml"><msub id="alg1.l3.m2.1.1.2" xref="alg1.l3.m2.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l3.m2.1.1.2.2" xref="alg1.l3.m2.1.1.2.2.cmml">𝒟</mi><mi id="alg1.l3.m2.1.1.2.3" xref="alg1.l3.m2.1.1.2.3.cmml">actor</mi></msub><mo id="alg1.l3.m2.1.1.1" stretchy="false" xref="alg1.l3.m2.1.1.1.cmml">←</mo><mrow id="alg1.l3.m2.1.1.3.2" xref="alg1.l3.m2.1.1.cmml"><mo id="alg1.l3.m2.1.1.3.2.1" stretchy="false" xref="alg1.l3.m2.1.1.3.1.cmml">{</mo><mo id="alg1.l3.m2.1.1.3.2.2" stretchy="false" xref="alg1.l3.m2.1.1.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m2.1b"><apply id="alg1.l3.m2.1.1.cmml" xref="alg1.l3.m2.1.1"><ci id="alg1.l3.m2.1.1.1.cmml" xref="alg1.l3.m2.1.1.1">←</ci><apply id="alg1.l3.m2.1.1.2.cmml" xref="alg1.l3.m2.1.1.2"><csymbol cd="ambiguous" id="alg1.l3.m2.1.1.2.1.cmml" xref="alg1.l3.m2.1.1.2">subscript</csymbol><ci id="alg1.l3.m2.1.1.2.2.cmml" xref="alg1.l3.m2.1.1.2.2">𝒟</ci><ci id="alg1.l3.m2.1.1.2.3.cmml" xref="alg1.l3.m2.1.1.2.3">actor</ci></apply><list id="alg1.l3.m2.1.1.3.1.cmml" xref="alg1.l3.m2.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m2.1c">\mathcal{D}_{\rm actor}\leftarrow\{\}</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m2.1d">caligraphic_D start_POSTSUBSCRIPT roman_actor end_POSTSUBSCRIPT ← { }</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_tag ltx_tag_listingline">4:</span><span class="ltx_text ltx_font_bold" id="alg1.l4.1">function</span>&nbsp;<span class="ltx_text ltx_font_smallcaps" id="alg1.l4.2">"SELU"</span>
</div>
<div class="ltx_listingline" id="alg1.l5">
<span class="ltx_tag ltx_tag_listingline">5:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ltx_text ltx_font_bold" id="alg1.l5.1">for</span>&nbsp;instruct <math alttext="I" class="ltx_Math" display="inline" id="alg1.l5.m1.1"><semantics id="alg1.l5.m1.1a"><mi id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><ci id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">I</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.1d">italic_I</annotation></semantics></math> in <math alttext="L" class="ltx_Math" display="inline" id="alg1.l5.m2.1"><semantics id="alg1.l5.m2.1a"><mi id="alg1.l5.m2.1.1" xref="alg1.l5.m2.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="alg1.l5.m2.1b"><ci id="alg1.l5.m2.1.1.cmml" xref="alg1.l5.m2.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m2.1c">L</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m2.1d">italic_L</annotation></semantics></math>&nbsp;<span class="ltx_text ltx_font_bold" id="alg1.l5.2">do</span>
</div>
<div class="ltx_listingline" id="alg1.l6">
<span class="ltx_tag ltx_tag_listingline">6:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ltx_text ltx_font_bold" id="alg1.l6.1">while</span>&nbsp;data collecting not done&nbsp;<span class="ltx_text ltx_font_bold" id="alg1.l6.2">do</span>
</div>
<div class="ltx_listingline" id="alg1.l7">
<span class="ltx_tag ltx_tag_listingline">7:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ltx_text ltx_font_bold" id="alg1.l7.1">for</span>&nbsp;timestep <math alttext="t=1" class="ltx_Math" display="inline" id="alg1.l7.m1.1"><semantics id="alg1.l7.m1.1a"><mrow id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml"><mi id="alg1.l7.m1.1.1.2" xref="alg1.l7.m1.1.1.2.cmml">t</mi><mo id="alg1.l7.m1.1.1.1" xref="alg1.l7.m1.1.1.1.cmml">=</mo><mn id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1"><eq id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1"></eq><ci id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2">𝑡</ci><cn id="alg1.l7.m1.1.1.3.cmml" type="integer" xref="alg1.l7.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">t=1</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m1.1d">italic_t = 1</annotation></semantics></math> to <math alttext="T" class="ltx_Math" display="inline" id="alg1.l7.m2.1"><semantics id="alg1.l7.m2.1a"><mi id="alg1.l7.m2.1.1" xref="alg1.l7.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg1.l7.m2.1b"><ci id="alg1.l7.m2.1.1.cmml" xref="alg1.l7.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m2.1c">T</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m2.1d">italic_T</annotation></semantics></math>&nbsp;<span class="ltx_text ltx_font_bold" id="alg1.l7.2">do</span>
</div>
<div class="ltx_listingline" id="alg1.l8">
<span class="ltx_tag ltx_tag_listingline">8:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;get observation <math alttext="o_{t}" class="ltx_Math" display="inline" id="alg1.l8.m1.1"><semantics id="alg1.l8.m1.1a"><msub id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><mi id="alg1.l8.m1.1.1.2" xref="alg1.l8.m1.1.1.2.cmml">o</mi><mi id="alg1.l8.m1.1.1.3" xref="alg1.l8.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1">subscript</csymbol><ci id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2">𝑜</ci><ci id="alg1.l8.m1.1.1.3.cmml" xref="alg1.l8.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">o_{t}</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m1.1d">italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> from env

</div>
<div class="ltx_listingline" id="alg1.l9">
<span class="ltx_tag ltx_tag_listingline">9:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<math alttext="l_{a,t}=M_{a}(I,p_{a},o_{t})" class="ltx_Math" display="inline" id="alg1.l9.m1.5"><semantics id="alg1.l9.m1.5a"><mrow id="alg1.l9.m1.5.5" xref="alg1.l9.m1.5.5.cmml"><msub id="alg1.l9.m1.5.5.4" xref="alg1.l9.m1.5.5.4.cmml"><mi id="alg1.l9.m1.5.5.4.2" xref="alg1.l9.m1.5.5.4.2.cmml">l</mi><mrow id="alg1.l9.m1.2.2.2.4" xref="alg1.l9.m1.2.2.2.3.cmml"><mi id="alg1.l9.m1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.cmml">a</mi><mo id="alg1.l9.m1.2.2.2.4.1" xref="alg1.l9.m1.2.2.2.3.cmml">,</mo><mi id="alg1.l9.m1.2.2.2.2" xref="alg1.l9.m1.2.2.2.2.cmml">t</mi></mrow></msub><mo id="alg1.l9.m1.5.5.3" xref="alg1.l9.m1.5.5.3.cmml">=</mo><mrow id="alg1.l9.m1.5.5.2" xref="alg1.l9.m1.5.5.2.cmml"><msub id="alg1.l9.m1.5.5.2.4" xref="alg1.l9.m1.5.5.2.4.cmml"><mi id="alg1.l9.m1.5.5.2.4.2" xref="alg1.l9.m1.5.5.2.4.2.cmml">M</mi><mi id="alg1.l9.m1.5.5.2.4.3" xref="alg1.l9.m1.5.5.2.4.3.cmml">a</mi></msub><mo id="alg1.l9.m1.5.5.2.3" xref="alg1.l9.m1.5.5.2.3.cmml">⁢</mo><mrow id="alg1.l9.m1.5.5.2.2.2" xref="alg1.l9.m1.5.5.2.2.3.cmml"><mo id="alg1.l9.m1.5.5.2.2.2.3" stretchy="false" xref="alg1.l9.m1.5.5.2.2.3.cmml">(</mo><mi id="alg1.l9.m1.3.3" xref="alg1.l9.m1.3.3.cmml">I</mi><mo id="alg1.l9.m1.5.5.2.2.2.4" xref="alg1.l9.m1.5.5.2.2.3.cmml">,</mo><msub id="alg1.l9.m1.4.4.1.1.1.1" xref="alg1.l9.m1.4.4.1.1.1.1.cmml"><mi id="alg1.l9.m1.4.4.1.1.1.1.2" xref="alg1.l9.m1.4.4.1.1.1.1.2.cmml">p</mi><mi id="alg1.l9.m1.4.4.1.1.1.1.3" xref="alg1.l9.m1.4.4.1.1.1.1.3.cmml">a</mi></msub><mo id="alg1.l9.m1.5.5.2.2.2.5" xref="alg1.l9.m1.5.5.2.2.3.cmml">,</mo><msub id="alg1.l9.m1.5.5.2.2.2.2" xref="alg1.l9.m1.5.5.2.2.2.2.cmml"><mi id="alg1.l9.m1.5.5.2.2.2.2.2" xref="alg1.l9.m1.5.5.2.2.2.2.2.cmml">o</mi><mi id="alg1.l9.m1.5.5.2.2.2.2.3" xref="alg1.l9.m1.5.5.2.2.2.2.3.cmml">t</mi></msub><mo id="alg1.l9.m1.5.5.2.2.2.6" stretchy="false" xref="alg1.l9.m1.5.5.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.5b"><apply id="alg1.l9.m1.5.5.cmml" xref="alg1.l9.m1.5.5"><eq id="alg1.l9.m1.5.5.3.cmml" xref="alg1.l9.m1.5.5.3"></eq><apply id="alg1.l9.m1.5.5.4.cmml" xref="alg1.l9.m1.5.5.4"><csymbol cd="ambiguous" id="alg1.l9.m1.5.5.4.1.cmml" xref="alg1.l9.m1.5.5.4">subscript</csymbol><ci id="alg1.l9.m1.5.5.4.2.cmml" xref="alg1.l9.m1.5.5.4.2">𝑙</ci><list id="alg1.l9.m1.2.2.2.3.cmml" xref="alg1.l9.m1.2.2.2.4"><ci id="alg1.l9.m1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1">𝑎</ci><ci id="alg1.l9.m1.2.2.2.2.cmml" xref="alg1.l9.m1.2.2.2.2">𝑡</ci></list></apply><apply id="alg1.l9.m1.5.5.2.cmml" xref="alg1.l9.m1.5.5.2"><times id="alg1.l9.m1.5.5.2.3.cmml" xref="alg1.l9.m1.5.5.2.3"></times><apply id="alg1.l9.m1.5.5.2.4.cmml" xref="alg1.l9.m1.5.5.2.4"><csymbol cd="ambiguous" id="alg1.l9.m1.5.5.2.4.1.cmml" xref="alg1.l9.m1.5.5.2.4">subscript</csymbol><ci id="alg1.l9.m1.5.5.2.4.2.cmml" xref="alg1.l9.m1.5.5.2.4.2">𝑀</ci><ci id="alg1.l9.m1.5.5.2.4.3.cmml" xref="alg1.l9.m1.5.5.2.4.3">𝑎</ci></apply><vector id="alg1.l9.m1.5.5.2.2.3.cmml" xref="alg1.l9.m1.5.5.2.2.2"><ci id="alg1.l9.m1.3.3.cmml" xref="alg1.l9.m1.3.3">𝐼</ci><apply id="alg1.l9.m1.4.4.1.1.1.1.cmml" xref="alg1.l9.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.4.4.1.1.1.1.1.cmml" xref="alg1.l9.m1.4.4.1.1.1.1">subscript</csymbol><ci id="alg1.l9.m1.4.4.1.1.1.1.2.cmml" xref="alg1.l9.m1.4.4.1.1.1.1.2">𝑝</ci><ci id="alg1.l9.m1.4.4.1.1.1.1.3.cmml" xref="alg1.l9.m1.4.4.1.1.1.1.3">𝑎</ci></apply><apply id="alg1.l9.m1.5.5.2.2.2.2.cmml" xref="alg1.l9.m1.5.5.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l9.m1.5.5.2.2.2.2.1.cmml" xref="alg1.l9.m1.5.5.2.2.2.2">subscript</csymbol><ci id="alg1.l9.m1.5.5.2.2.2.2.2.cmml" xref="alg1.l9.m1.5.5.2.2.2.2.2">𝑜</ci><ci id="alg1.l9.m1.5.5.2.2.2.2.3.cmml" xref="alg1.l9.m1.5.5.2.2.2.2.3">𝑡</ci></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.5c">l_{a,t}=M_{a}(I,p_{a},o_{t})</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m1.5d">italic_l start_POSTSUBSCRIPT italic_a , italic_t end_POSTSUBSCRIPT = italic_M start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT ( italic_I , italic_p start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l10">
<span class="ltx_tag ltx_tag_listingline">10:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;use <math alttext="l_{a,t}" class="ltx_Math" display="inline" id="alg1.l10.m1.2"><semantics id="alg1.l10.m1.2a"><msub id="alg1.l10.m1.2.3" xref="alg1.l10.m1.2.3.cmml"><mi id="alg1.l10.m1.2.3.2" xref="alg1.l10.m1.2.3.2.cmml">l</mi><mrow id="alg1.l10.m1.2.2.2.4" xref="alg1.l10.m1.2.2.2.3.cmml"><mi id="alg1.l10.m1.1.1.1.1" xref="alg1.l10.m1.1.1.1.1.cmml">a</mi><mo id="alg1.l10.m1.2.2.2.4.1" xref="alg1.l10.m1.2.2.2.3.cmml">,</mo><mi id="alg1.l10.m1.2.2.2.2" xref="alg1.l10.m1.2.2.2.2.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.2b"><apply id="alg1.l10.m1.2.3.cmml" xref="alg1.l10.m1.2.3"><csymbol cd="ambiguous" id="alg1.l10.m1.2.3.1.cmml" xref="alg1.l10.m1.2.3">subscript</csymbol><ci id="alg1.l10.m1.2.3.2.cmml" xref="alg1.l10.m1.2.3.2">𝑙</ci><list id="alg1.l10.m1.2.2.2.3.cmml" xref="alg1.l10.m1.2.2.2.4"><ci id="alg1.l10.m1.1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1.1">𝑎</ci><ci id="alg1.l10.m1.2.2.2.2.cmml" xref="alg1.l10.m1.2.2.2.2">𝑡</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.2c">l_{a,t}</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m1.2d">italic_l start_POSTSUBSCRIPT italic_a , italic_t end_POSTSUBSCRIPT</annotation></semantics></math> to interact with env

</div>
<div class="ltx_listingline" id="alg1.l11">
<span class="ltx_tag ltx_tag_listingline">11:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ltx_text ltx_font_bold" id="alg1.l11.1">end</span>&nbsp;<span class="ltx_text ltx_font_bold" id="alg1.l11.2">for</span>
</div>
<div class="ltx_listingline" id="alg1.l12">
<span class="ltx_tag ltx_tag_listingline">12:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<math alttext="l_{d}=M_{c}(I,p_{d},o_{T})" class="ltx_Math" display="inline" id="alg1.l12.m1.3"><semantics id="alg1.l12.m1.3a"><mrow id="alg1.l12.m1.3.3" xref="alg1.l12.m1.3.3.cmml"><msub id="alg1.l12.m1.3.3.4" xref="alg1.l12.m1.3.3.4.cmml"><mi id="alg1.l12.m1.3.3.4.2" xref="alg1.l12.m1.3.3.4.2.cmml">l</mi><mi id="alg1.l12.m1.3.3.4.3" xref="alg1.l12.m1.3.3.4.3.cmml">d</mi></msub><mo id="alg1.l12.m1.3.3.3" xref="alg1.l12.m1.3.3.3.cmml">=</mo><mrow id="alg1.l12.m1.3.3.2" xref="alg1.l12.m1.3.3.2.cmml"><msub id="alg1.l12.m1.3.3.2.4" xref="alg1.l12.m1.3.3.2.4.cmml"><mi id="alg1.l12.m1.3.3.2.4.2" xref="alg1.l12.m1.3.3.2.4.2.cmml">M</mi><mi id="alg1.l12.m1.3.3.2.4.3" xref="alg1.l12.m1.3.3.2.4.3.cmml">c</mi></msub><mo id="alg1.l12.m1.3.3.2.3" xref="alg1.l12.m1.3.3.2.3.cmml">⁢</mo><mrow id="alg1.l12.m1.3.3.2.2.2" xref="alg1.l12.m1.3.3.2.2.3.cmml"><mo id="alg1.l12.m1.3.3.2.2.2.3" stretchy="false" xref="alg1.l12.m1.3.3.2.2.3.cmml">(</mo><mi id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml">I</mi><mo id="alg1.l12.m1.3.3.2.2.2.4" xref="alg1.l12.m1.3.3.2.2.3.cmml">,</mo><msub id="alg1.l12.m1.2.2.1.1.1.1" xref="alg1.l12.m1.2.2.1.1.1.1.cmml"><mi id="alg1.l12.m1.2.2.1.1.1.1.2" xref="alg1.l12.m1.2.2.1.1.1.1.2.cmml">p</mi><mi id="alg1.l12.m1.2.2.1.1.1.1.3" xref="alg1.l12.m1.2.2.1.1.1.1.3.cmml">d</mi></msub><mo id="alg1.l12.m1.3.3.2.2.2.5" xref="alg1.l12.m1.3.3.2.2.3.cmml">,</mo><msub id="alg1.l12.m1.3.3.2.2.2.2" xref="alg1.l12.m1.3.3.2.2.2.2.cmml"><mi id="alg1.l12.m1.3.3.2.2.2.2.2" xref="alg1.l12.m1.3.3.2.2.2.2.2.cmml">o</mi><mi id="alg1.l12.m1.3.3.2.2.2.2.3" xref="alg1.l12.m1.3.3.2.2.2.2.3.cmml">T</mi></msub><mo id="alg1.l12.m1.3.3.2.2.2.6" stretchy="false" xref="alg1.l12.m1.3.3.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.3b"><apply id="alg1.l12.m1.3.3.cmml" xref="alg1.l12.m1.3.3"><eq id="alg1.l12.m1.3.3.3.cmml" xref="alg1.l12.m1.3.3.3"></eq><apply id="alg1.l12.m1.3.3.4.cmml" xref="alg1.l12.m1.3.3.4"><csymbol cd="ambiguous" id="alg1.l12.m1.3.3.4.1.cmml" xref="alg1.l12.m1.3.3.4">subscript</csymbol><ci id="alg1.l12.m1.3.3.4.2.cmml" xref="alg1.l12.m1.3.3.4.2">𝑙</ci><ci id="alg1.l12.m1.3.3.4.3.cmml" xref="alg1.l12.m1.3.3.4.3">𝑑</ci></apply><apply id="alg1.l12.m1.3.3.2.cmml" xref="alg1.l12.m1.3.3.2"><times id="alg1.l12.m1.3.3.2.3.cmml" xref="alg1.l12.m1.3.3.2.3"></times><apply id="alg1.l12.m1.3.3.2.4.cmml" xref="alg1.l12.m1.3.3.2.4"><csymbol cd="ambiguous" id="alg1.l12.m1.3.3.2.4.1.cmml" xref="alg1.l12.m1.3.3.2.4">subscript</csymbol><ci id="alg1.l12.m1.3.3.2.4.2.cmml" xref="alg1.l12.m1.3.3.2.4.2">𝑀</ci><ci id="alg1.l12.m1.3.3.2.4.3.cmml" xref="alg1.l12.m1.3.3.2.4.3">𝑐</ci></apply><vector id="alg1.l12.m1.3.3.2.2.3.cmml" xref="alg1.l12.m1.3.3.2.2.2"><ci id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1">𝐼</ci><apply id="alg1.l12.m1.2.2.1.1.1.1.cmml" xref="alg1.l12.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l12.m1.2.2.1.1.1.1.1.cmml" xref="alg1.l12.m1.2.2.1.1.1.1">subscript</csymbol><ci id="alg1.l12.m1.2.2.1.1.1.1.2.cmml" xref="alg1.l12.m1.2.2.1.1.1.1.2">𝑝</ci><ci id="alg1.l12.m1.2.2.1.1.1.1.3.cmml" xref="alg1.l12.m1.2.2.1.1.1.1.3">𝑑</ci></apply><apply id="alg1.l12.m1.3.3.2.2.2.2.cmml" xref="alg1.l12.m1.3.3.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l12.m1.3.3.2.2.2.2.1.cmml" xref="alg1.l12.m1.3.3.2.2.2.2">subscript</csymbol><ci id="alg1.l12.m1.3.3.2.2.2.2.2.cmml" xref="alg1.l12.m1.3.3.2.2.2.2.2">𝑜</ci><ci id="alg1.l12.m1.3.3.2.2.2.2.3.cmml" xref="alg1.l12.m1.3.3.2.2.2.2.3">𝑇</ci></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.3c">l_{d}=M_{c}(I,p_{d},o_{T})</annotation><annotation encoding="application/x-llamapun" id="alg1.l12.m1.3d">italic_l start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT = italic_M start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ( italic_I , italic_p start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l13">
<span class="ltx_tag ltx_tag_listingline">13:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ltx_text ltx_font_bold" id="alg1.l13.1">if</span>&nbsp;<math alttext="l_{d}=``yes&quot;" class="ltx_Math" display="inline" id="alg1.l13.m1.1"><semantics id="alg1.l13.m1.1a"><mrow id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml"><msub id="alg1.l13.m1.1.1.2" xref="alg1.l13.m1.1.1.2.cmml"><mi id="alg1.l13.m1.1.1.2.2" xref="alg1.l13.m1.1.1.2.2.cmml">l</mi><mi id="alg1.l13.m1.1.1.2.3" xref="alg1.l13.m1.1.1.2.3.cmml">d</mi></msub><mo id="alg1.l13.m1.1.1.1" xref="alg1.l13.m1.1.1.1.cmml">=</mo><mrow id="alg1.l13.m1.1.1.3" xref="alg1.l13.m1.1.1.3.cmml"><mi id="alg1.l13.m1.1.1.3.2" mathvariant="normal" xref="alg1.l13.m1.1.1.3.2.cmml">`</mi><mo id="alg1.l13.m1.1.1.3.1" xref="alg1.l13.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l13.m1.1.1.3.3" mathvariant="normal" xref="alg1.l13.m1.1.1.3.3.cmml">`</mi><mo id="alg1.l13.m1.1.1.3.1a" xref="alg1.l13.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l13.m1.1.1.3.4" xref="alg1.l13.m1.1.1.3.4.cmml">y</mi><mo id="alg1.l13.m1.1.1.3.1b" xref="alg1.l13.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l13.m1.1.1.3.5" xref="alg1.l13.m1.1.1.3.5.cmml">e</mi><mo id="alg1.l13.m1.1.1.3.1c" xref="alg1.l13.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l13.m1.1.1.3.6" xref="alg1.l13.m1.1.1.3.6.cmml">s</mi><mo id="alg1.l13.m1.1.1.3.1d" xref="alg1.l13.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l13.m1.1.1.3.7" mathvariant="normal" xref="alg1.l13.m1.1.1.3.7.cmml">"</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.1b"><apply id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1"><eq id="alg1.l13.m1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1"></eq><apply id="alg1.l13.m1.1.1.2.cmml" xref="alg1.l13.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.2.1.cmml" xref="alg1.l13.m1.1.1.2">subscript</csymbol><ci id="alg1.l13.m1.1.1.2.2.cmml" xref="alg1.l13.m1.1.1.2.2">𝑙</ci><ci id="alg1.l13.m1.1.1.2.3.cmml" xref="alg1.l13.m1.1.1.2.3">𝑑</ci></apply><apply id="alg1.l13.m1.1.1.3.cmml" xref="alg1.l13.m1.1.1.3"><times id="alg1.l13.m1.1.1.3.1.cmml" xref="alg1.l13.m1.1.1.3.1"></times><ci id="alg1.l13.m1.1.1.3.2.cmml" xref="alg1.l13.m1.1.1.3.2">`</ci><ci id="alg1.l13.m1.1.1.3.3.cmml" xref="alg1.l13.m1.1.1.3.3">`</ci><ci id="alg1.l13.m1.1.1.3.4.cmml" xref="alg1.l13.m1.1.1.3.4">𝑦</ci><ci id="alg1.l13.m1.1.1.3.5.cmml" xref="alg1.l13.m1.1.1.3.5">𝑒</ci><ci id="alg1.l13.m1.1.1.3.6.cmml" xref="alg1.l13.m1.1.1.3.6">𝑠</ci><ci id="alg1.l13.m1.1.1.3.7.cmml" xref="alg1.l13.m1.1.1.3.7">"</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.1c">l_{d}=``yes"</annotation><annotation encoding="application/x-llamapun" id="alg1.l13.m1.1d">italic_l start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT = ` ` italic_y italic_e italic_s "</annotation></semantics></math>&nbsp;<span class="ltx_text ltx_font_bold" id="alg1.l13.2">then</span>
</div>
<div class="ltx_listingline" id="alg1.l14">
<span class="ltx_tag ltx_tag_listingline">14:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;store <math alttext="(I,p_{d},o_{T},l_{d})" class="ltx_Math" display="inline" id="alg1.l14.m1.4"><semantics id="alg1.l14.m1.4a"><mrow id="alg1.l14.m1.4.4.3" xref="alg1.l14.m1.4.4.4.cmml"><mo id="alg1.l14.m1.4.4.3.4" stretchy="false" xref="alg1.l14.m1.4.4.4.cmml">(</mo><mi id="alg1.l14.m1.1.1" xref="alg1.l14.m1.1.1.cmml">I</mi><mo id="alg1.l14.m1.4.4.3.5" xref="alg1.l14.m1.4.4.4.cmml">,</mo><msub id="alg1.l14.m1.2.2.1.1" xref="alg1.l14.m1.2.2.1.1.cmml"><mi id="alg1.l14.m1.2.2.1.1.2" xref="alg1.l14.m1.2.2.1.1.2.cmml">p</mi><mi id="alg1.l14.m1.2.2.1.1.3" xref="alg1.l14.m1.2.2.1.1.3.cmml">d</mi></msub><mo id="alg1.l14.m1.4.4.3.6" xref="alg1.l14.m1.4.4.4.cmml">,</mo><msub id="alg1.l14.m1.3.3.2.2" xref="alg1.l14.m1.3.3.2.2.cmml"><mi id="alg1.l14.m1.3.3.2.2.2" xref="alg1.l14.m1.3.3.2.2.2.cmml">o</mi><mi id="alg1.l14.m1.3.3.2.2.3" xref="alg1.l14.m1.3.3.2.2.3.cmml">T</mi></msub><mo id="alg1.l14.m1.4.4.3.7" xref="alg1.l14.m1.4.4.4.cmml">,</mo><msub id="alg1.l14.m1.4.4.3.3" xref="alg1.l14.m1.4.4.3.3.cmml"><mi id="alg1.l14.m1.4.4.3.3.2" xref="alg1.l14.m1.4.4.3.3.2.cmml">l</mi><mi id="alg1.l14.m1.4.4.3.3.3" xref="alg1.l14.m1.4.4.3.3.3.cmml">d</mi></msub><mo id="alg1.l14.m1.4.4.3.8" stretchy="false" xref="alg1.l14.m1.4.4.4.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.4b"><vector id="alg1.l14.m1.4.4.4.cmml" xref="alg1.l14.m1.4.4.3"><ci id="alg1.l14.m1.1.1.cmml" xref="alg1.l14.m1.1.1">𝐼</ci><apply id="alg1.l14.m1.2.2.1.1.cmml" xref="alg1.l14.m1.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l14.m1.2.2.1.1.1.cmml" xref="alg1.l14.m1.2.2.1.1">subscript</csymbol><ci id="alg1.l14.m1.2.2.1.1.2.cmml" xref="alg1.l14.m1.2.2.1.1.2">𝑝</ci><ci id="alg1.l14.m1.2.2.1.1.3.cmml" xref="alg1.l14.m1.2.2.1.1.3">𝑑</ci></apply><apply id="alg1.l14.m1.3.3.2.2.cmml" xref="alg1.l14.m1.3.3.2.2"><csymbol cd="ambiguous" id="alg1.l14.m1.3.3.2.2.1.cmml" xref="alg1.l14.m1.3.3.2.2">subscript</csymbol><ci id="alg1.l14.m1.3.3.2.2.2.cmml" xref="alg1.l14.m1.3.3.2.2.2">𝑜</ci><ci id="alg1.l14.m1.3.3.2.2.3.cmml" xref="alg1.l14.m1.3.3.2.2.3">𝑇</ci></apply><apply id="alg1.l14.m1.4.4.3.3.cmml" xref="alg1.l14.m1.4.4.3.3"><csymbol cd="ambiguous" id="alg1.l14.m1.4.4.3.3.1.cmml" xref="alg1.l14.m1.4.4.3.3">subscript</csymbol><ci id="alg1.l14.m1.4.4.3.3.2.cmml" xref="alg1.l14.m1.4.4.3.3.2">𝑙</ci><ci id="alg1.l14.m1.4.4.3.3.3.cmml" xref="alg1.l14.m1.4.4.3.3.3">𝑑</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.4c">(I,p_{d},o_{T},l_{d})</annotation><annotation encoding="application/x-llamapun" id="alg1.l14.m1.4d">( italic_I , italic_p start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT , italic_l start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT )</annotation></semantics></math> into <math alttext="\mathcal{D}_{\rm critic}" class="ltx_Math" display="inline" id="alg1.l14.m2.1"><semantics id="alg1.l14.m2.1a"><msub id="alg1.l14.m2.1.1" xref="alg1.l14.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l14.m2.1.1.2" xref="alg1.l14.m2.1.1.2.cmml">𝒟</mi><mi id="alg1.l14.m2.1.1.3" xref="alg1.l14.m2.1.1.3.cmml">critic</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l14.m2.1b"><apply id="alg1.l14.m2.1.1.cmml" xref="alg1.l14.m2.1.1"><csymbol cd="ambiguous" id="alg1.l14.m2.1.1.1.cmml" xref="alg1.l14.m2.1.1">subscript</csymbol><ci id="alg1.l14.m2.1.1.2.cmml" xref="alg1.l14.m2.1.1.2">𝒟</ci><ci id="alg1.l14.m2.1.1.3.cmml" xref="alg1.l14.m2.1.1.3">critic</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m2.1c">\mathcal{D}_{\rm critic}</annotation><annotation encoding="application/x-llamapun" id="alg1.l14.m2.1d">caligraphic_D start_POSTSUBSCRIPT roman_critic end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l15">
<span class="ltx_tag ltx_tag_listingline">15:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;store <math alttext="(I,p_{a},o_{t},l_{a,t}),t=1,...T" class="ltx_Math" display="inline" id="alg1.l15.m1.6"><semantics id="alg1.l15.m1.6a"><mrow id="alg1.l15.m1.6.6.2" xref="alg1.l15.m1.6.6.3.cmml"><mrow id="alg1.l15.m1.5.5.1.1" xref="alg1.l15.m1.5.5.1.1.cmml"><mrow id="alg1.l15.m1.5.5.1.1.1.1" xref="alg1.l15.m1.5.5.1.1.1.2.cmml"><mrow id="alg1.l15.m1.5.5.1.1.1.1.1.3" xref="alg1.l15.m1.5.5.1.1.1.1.1.4.cmml"><mo id="alg1.l15.m1.5.5.1.1.1.1.1.3.4" stretchy="false" xref="alg1.l15.m1.5.5.1.1.1.1.1.4.cmml">(</mo><mi id="alg1.l15.m1.3.3" xref="alg1.l15.m1.3.3.cmml">I</mi><mo id="alg1.l15.m1.5.5.1.1.1.1.1.3.5" xref="alg1.l15.m1.5.5.1.1.1.1.1.4.cmml">,</mo><msub id="alg1.l15.m1.5.5.1.1.1.1.1.1.1" xref="alg1.l15.m1.5.5.1.1.1.1.1.1.1.cmml"><mi id="alg1.l15.m1.5.5.1.1.1.1.1.1.1.2" xref="alg1.l15.m1.5.5.1.1.1.1.1.1.1.2.cmml">p</mi><mi id="alg1.l15.m1.5.5.1.1.1.1.1.1.1.3" xref="alg1.l15.m1.5.5.1.1.1.1.1.1.1.3.cmml">a</mi></msub><mo id="alg1.l15.m1.5.5.1.1.1.1.1.3.6" xref="alg1.l15.m1.5.5.1.1.1.1.1.4.cmml">,</mo><msub id="alg1.l15.m1.5.5.1.1.1.1.1.2.2" xref="alg1.l15.m1.5.5.1.1.1.1.1.2.2.cmml"><mi id="alg1.l15.m1.5.5.1.1.1.1.1.2.2.2" xref="alg1.l15.m1.5.5.1.1.1.1.1.2.2.2.cmml">o</mi><mi id="alg1.l15.m1.5.5.1.1.1.1.1.2.2.3" xref="alg1.l15.m1.5.5.1.1.1.1.1.2.2.3.cmml">t</mi></msub><mo id="alg1.l15.m1.5.5.1.1.1.1.1.3.7" xref="alg1.l15.m1.5.5.1.1.1.1.1.4.cmml">,</mo><msub id="alg1.l15.m1.5.5.1.1.1.1.1.3.3" xref="alg1.l15.m1.5.5.1.1.1.1.1.3.3.cmml"><mi id="alg1.l15.m1.5.5.1.1.1.1.1.3.3.2" xref="alg1.l15.m1.5.5.1.1.1.1.1.3.3.2.cmml">l</mi><mrow id="alg1.l15.m1.2.2.2.4" xref="alg1.l15.m1.2.2.2.3.cmml"><mi id="alg1.l15.m1.1.1.1.1" xref="alg1.l15.m1.1.1.1.1.cmml">a</mi><mo id="alg1.l15.m1.2.2.2.4.1" xref="alg1.l15.m1.2.2.2.3.cmml">,</mo><mi id="alg1.l15.m1.2.2.2.2" xref="alg1.l15.m1.2.2.2.2.cmml">t</mi></mrow></msub><mo id="alg1.l15.m1.5.5.1.1.1.1.1.3.8" stretchy="false" xref="alg1.l15.m1.5.5.1.1.1.1.1.4.cmml">)</mo></mrow><mo id="alg1.l15.m1.5.5.1.1.1.1.2" xref="alg1.l15.m1.5.5.1.1.1.2.cmml">,</mo><mi id="alg1.l15.m1.4.4" xref="alg1.l15.m1.4.4.cmml">t</mi></mrow><mo id="alg1.l15.m1.5.5.1.1.2" xref="alg1.l15.m1.5.5.1.1.2.cmml">=</mo><mn id="alg1.l15.m1.5.5.1.1.3" xref="alg1.l15.m1.5.5.1.1.3.cmml">1</mn></mrow><mo id="alg1.l15.m1.6.6.2.3" xref="alg1.l15.m1.6.6.3a.cmml">,</mo><mrow id="alg1.l15.m1.6.6.2.2" xref="alg1.l15.m1.6.6.2.2.cmml"><mi id="alg1.l15.m1.6.6.2.2.2" mathvariant="normal" xref="alg1.l15.m1.6.6.2.2.2.cmml">…</mi><mo id="alg1.l15.m1.6.6.2.2.1" xref="alg1.l15.m1.6.6.2.2.1.cmml">⁢</mo><mi id="alg1.l15.m1.6.6.2.2.3" xref="alg1.l15.m1.6.6.2.2.3.cmml">T</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.6b"><apply id="alg1.l15.m1.6.6.3.cmml" xref="alg1.l15.m1.6.6.2"><csymbol cd="ambiguous" id="alg1.l15.m1.6.6.3a.cmml" xref="alg1.l15.m1.6.6.2.3">formulae-sequence</csymbol><apply id="alg1.l15.m1.5.5.1.1.cmml" xref="alg1.l15.m1.5.5.1.1"><eq id="alg1.l15.m1.5.5.1.1.2.cmml" xref="alg1.l15.m1.5.5.1.1.2"></eq><list id="alg1.l15.m1.5.5.1.1.1.2.cmml" xref="alg1.l15.m1.5.5.1.1.1.1"><vector id="alg1.l15.m1.5.5.1.1.1.1.1.4.cmml" xref="alg1.l15.m1.5.5.1.1.1.1.1.3"><ci id="alg1.l15.m1.3.3.cmml" xref="alg1.l15.m1.3.3">𝐼</ci><apply id="alg1.l15.m1.5.5.1.1.1.1.1.1.1.cmml" xref="alg1.l15.m1.5.5.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l15.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="alg1.l15.m1.5.5.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l15.m1.5.5.1.1.1.1.1.1.1.2.cmml" xref="alg1.l15.m1.5.5.1.1.1.1.1.1.1.2">𝑝</ci><ci id="alg1.l15.m1.5.5.1.1.1.1.1.1.1.3.cmml" xref="alg1.l15.m1.5.5.1.1.1.1.1.1.1.3">𝑎</ci></apply><apply id="alg1.l15.m1.5.5.1.1.1.1.1.2.2.cmml" xref="alg1.l15.m1.5.5.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="alg1.l15.m1.5.5.1.1.1.1.1.2.2.1.cmml" xref="alg1.l15.m1.5.5.1.1.1.1.1.2.2">subscript</csymbol><ci id="alg1.l15.m1.5.5.1.1.1.1.1.2.2.2.cmml" xref="alg1.l15.m1.5.5.1.1.1.1.1.2.2.2">𝑜</ci><ci id="alg1.l15.m1.5.5.1.1.1.1.1.2.2.3.cmml" xref="alg1.l15.m1.5.5.1.1.1.1.1.2.2.3">𝑡</ci></apply><apply id="alg1.l15.m1.5.5.1.1.1.1.1.3.3.cmml" xref="alg1.l15.m1.5.5.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l15.m1.5.5.1.1.1.1.1.3.3.1.cmml" xref="alg1.l15.m1.5.5.1.1.1.1.1.3.3">subscript</csymbol><ci id="alg1.l15.m1.5.5.1.1.1.1.1.3.3.2.cmml" xref="alg1.l15.m1.5.5.1.1.1.1.1.3.3.2">𝑙</ci><list id="alg1.l15.m1.2.2.2.3.cmml" xref="alg1.l15.m1.2.2.2.4"><ci id="alg1.l15.m1.1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1.1">𝑎</ci><ci id="alg1.l15.m1.2.2.2.2.cmml" xref="alg1.l15.m1.2.2.2.2">𝑡</ci></list></apply></vector><ci id="alg1.l15.m1.4.4.cmml" xref="alg1.l15.m1.4.4">𝑡</ci></list><cn id="alg1.l15.m1.5.5.1.1.3.cmml" type="integer" xref="alg1.l15.m1.5.5.1.1.3">1</cn></apply><apply id="alg1.l15.m1.6.6.2.2.cmml" xref="alg1.l15.m1.6.6.2.2"><times id="alg1.l15.m1.6.6.2.2.1.cmml" xref="alg1.l15.m1.6.6.2.2.1"></times><ci id="alg1.l15.m1.6.6.2.2.2.cmml" xref="alg1.l15.m1.6.6.2.2.2">…</ci><ci id="alg1.l15.m1.6.6.2.2.3.cmml" xref="alg1.l15.m1.6.6.2.2.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.6c">(I,p_{a},o_{t},l_{a,t}),t=1,...T</annotation><annotation encoding="application/x-llamapun" id="alg1.l15.m1.6d">( italic_I , italic_p start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_l start_POSTSUBSCRIPT italic_a , italic_t end_POSTSUBSCRIPT ) , italic_t = 1 , … italic_T</annotation></semantics></math> into <math alttext="\mathcal{D}_{\rm actor}" class="ltx_Math" display="inline" id="alg1.l15.m2.1"><semantics id="alg1.l15.m2.1a"><msub id="alg1.l15.m2.1.1" xref="alg1.l15.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l15.m2.1.1.2" xref="alg1.l15.m2.1.1.2.cmml">𝒟</mi><mi id="alg1.l15.m2.1.1.3" xref="alg1.l15.m2.1.1.3.cmml">actor</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l15.m2.1b"><apply id="alg1.l15.m2.1.1.cmml" xref="alg1.l15.m2.1.1"><csymbol cd="ambiguous" id="alg1.l15.m2.1.1.1.cmml" xref="alg1.l15.m2.1.1">subscript</csymbol><ci id="alg1.l15.m2.1.1.2.cmml" xref="alg1.l15.m2.1.1.2">𝒟</ci><ci id="alg1.l15.m2.1.1.3.cmml" xref="alg1.l15.m2.1.1.3">actor</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m2.1c">\mathcal{D}_{\rm actor}</annotation><annotation encoding="application/x-llamapun" id="alg1.l15.m2.1d">caligraphic_D start_POSTSUBSCRIPT roman_actor end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l16">
<span class="ltx_tag ltx_tag_listingline">16:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ltx_text ltx_font_bold" id="alg1.l16.1">else</span>
</div>
<div class="ltx_listingline" id="alg1.l17">
<span class="ltx_tag ltx_tag_listingline">17:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;get <math alttext="l^{\prime}_{d}" class="ltx_Math" display="inline" id="alg1.l17.m1.1"><semantics id="alg1.l17.m1.1a"><msubsup id="alg1.l17.m1.1.1" xref="alg1.l17.m1.1.1.cmml"><mi id="alg1.l17.m1.1.1.2.2" xref="alg1.l17.m1.1.1.2.2.cmml">l</mi><mi id="alg1.l17.m1.1.1.3" xref="alg1.l17.m1.1.1.3.cmml">d</mi><mo id="alg1.l17.m1.1.1.2.3" xref="alg1.l17.m1.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l17.m1.1b"><apply id="alg1.l17.m1.1.1.cmml" xref="alg1.l17.m1.1.1"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.cmml" xref="alg1.l17.m1.1.1">subscript</csymbol><apply id="alg1.l17.m1.1.1.2.cmml" xref="alg1.l17.m1.1.1"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.2.1.cmml" xref="alg1.l17.m1.1.1">superscript</csymbol><ci id="alg1.l17.m1.1.1.2.2.cmml" xref="alg1.l17.m1.1.1.2.2">𝑙</ci><ci id="alg1.l17.m1.1.1.2.3.cmml" xref="alg1.l17.m1.1.1.2.3">′</ci></apply><ci id="alg1.l17.m1.1.1.3.cmml" xref="alg1.l17.m1.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m1.1c">l^{\prime}_{d}</annotation><annotation encoding="application/x-llamapun" id="alg1.l17.m1.1d">italic_l start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT</annotation></semantics></math> through self-asking

</div>
<div class="ltx_listingline" id="alg1.l18">
<span class="ltx_tag ltx_tag_listingline">18:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ltx_text ltx_font_bold" id="alg1.l18.1">if</span>&nbsp;<math alttext="l^{\prime}_{d}=``yes&quot;" class="ltx_Math" display="inline" id="alg1.l18.m1.1"><semantics id="alg1.l18.m1.1a"><mrow id="alg1.l18.m1.1.1" xref="alg1.l18.m1.1.1.cmml"><msubsup id="alg1.l18.m1.1.1.2" xref="alg1.l18.m1.1.1.2.cmml"><mi id="alg1.l18.m1.1.1.2.2.2" xref="alg1.l18.m1.1.1.2.2.2.cmml">l</mi><mi id="alg1.l18.m1.1.1.2.3" xref="alg1.l18.m1.1.1.2.3.cmml">d</mi><mo id="alg1.l18.m1.1.1.2.2.3" xref="alg1.l18.m1.1.1.2.2.3.cmml">′</mo></msubsup><mo id="alg1.l18.m1.1.1.1" xref="alg1.l18.m1.1.1.1.cmml">=</mo><mrow id="alg1.l18.m1.1.1.3" xref="alg1.l18.m1.1.1.3.cmml"><mi id="alg1.l18.m1.1.1.3.2" mathvariant="normal" xref="alg1.l18.m1.1.1.3.2.cmml">`</mi><mo id="alg1.l18.m1.1.1.3.1" xref="alg1.l18.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l18.m1.1.1.3.3" mathvariant="normal" xref="alg1.l18.m1.1.1.3.3.cmml">`</mi><mo id="alg1.l18.m1.1.1.3.1a" xref="alg1.l18.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l18.m1.1.1.3.4" xref="alg1.l18.m1.1.1.3.4.cmml">y</mi><mo id="alg1.l18.m1.1.1.3.1b" xref="alg1.l18.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l18.m1.1.1.3.5" xref="alg1.l18.m1.1.1.3.5.cmml">e</mi><mo id="alg1.l18.m1.1.1.3.1c" xref="alg1.l18.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l18.m1.1.1.3.6" xref="alg1.l18.m1.1.1.3.6.cmml">s</mi><mo id="alg1.l18.m1.1.1.3.1d" xref="alg1.l18.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l18.m1.1.1.3.7" mathvariant="normal" xref="alg1.l18.m1.1.1.3.7.cmml">"</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l18.m1.1b"><apply id="alg1.l18.m1.1.1.cmml" xref="alg1.l18.m1.1.1"><eq id="alg1.l18.m1.1.1.1.cmml" xref="alg1.l18.m1.1.1.1"></eq><apply id="alg1.l18.m1.1.1.2.cmml" xref="alg1.l18.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l18.m1.1.1.2.1.cmml" xref="alg1.l18.m1.1.1.2">subscript</csymbol><apply id="alg1.l18.m1.1.1.2.2.cmml" xref="alg1.l18.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l18.m1.1.1.2.2.1.cmml" xref="alg1.l18.m1.1.1.2">superscript</csymbol><ci id="alg1.l18.m1.1.1.2.2.2.cmml" xref="alg1.l18.m1.1.1.2.2.2">𝑙</ci><ci id="alg1.l18.m1.1.1.2.2.3.cmml" xref="alg1.l18.m1.1.1.2.2.3">′</ci></apply><ci id="alg1.l18.m1.1.1.2.3.cmml" xref="alg1.l18.m1.1.1.2.3">𝑑</ci></apply><apply id="alg1.l18.m1.1.1.3.cmml" xref="alg1.l18.m1.1.1.3"><times id="alg1.l18.m1.1.1.3.1.cmml" xref="alg1.l18.m1.1.1.3.1"></times><ci id="alg1.l18.m1.1.1.3.2.cmml" xref="alg1.l18.m1.1.1.3.2">`</ci><ci id="alg1.l18.m1.1.1.3.3.cmml" xref="alg1.l18.m1.1.1.3.3">`</ci><ci id="alg1.l18.m1.1.1.3.4.cmml" xref="alg1.l18.m1.1.1.3.4">𝑦</ci><ci id="alg1.l18.m1.1.1.3.5.cmml" xref="alg1.l18.m1.1.1.3.5">𝑒</ci><ci id="alg1.l18.m1.1.1.3.6.cmml" xref="alg1.l18.m1.1.1.3.6">𝑠</ci><ci id="alg1.l18.m1.1.1.3.7.cmml" xref="alg1.l18.m1.1.1.3.7">"</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l18.m1.1c">l^{\prime}_{d}=``yes"</annotation><annotation encoding="application/x-llamapun" id="alg1.l18.m1.1d">italic_l start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT = ` ` italic_y italic_e italic_s "</annotation></semantics></math>&nbsp;<span class="ltx_text ltx_font_bold" id="alg1.l18.2">then</span>
</div>
<div class="ltx_listingline" id="alg1.l19">
<span class="ltx_tag ltx_tag_listingline">19:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;store <math alttext="(I,p_{d},o_{T},l^{\prime}_{d})" class="ltx_Math" display="inline" id="alg1.l19.m1.4"><semantics id="alg1.l19.m1.4a"><mrow id="alg1.l19.m1.4.4.3" xref="alg1.l19.m1.4.4.4.cmml"><mo id="alg1.l19.m1.4.4.3.4" stretchy="false" xref="alg1.l19.m1.4.4.4.cmml">(</mo><mi id="alg1.l19.m1.1.1" xref="alg1.l19.m1.1.1.cmml">I</mi><mo id="alg1.l19.m1.4.4.3.5" xref="alg1.l19.m1.4.4.4.cmml">,</mo><msub id="alg1.l19.m1.2.2.1.1" xref="alg1.l19.m1.2.2.1.1.cmml"><mi id="alg1.l19.m1.2.2.1.1.2" xref="alg1.l19.m1.2.2.1.1.2.cmml">p</mi><mi id="alg1.l19.m1.2.2.1.1.3" xref="alg1.l19.m1.2.2.1.1.3.cmml">d</mi></msub><mo id="alg1.l19.m1.4.4.3.6" xref="alg1.l19.m1.4.4.4.cmml">,</mo><msub id="alg1.l19.m1.3.3.2.2" xref="alg1.l19.m1.3.3.2.2.cmml"><mi id="alg1.l19.m1.3.3.2.2.2" xref="alg1.l19.m1.3.3.2.2.2.cmml">o</mi><mi id="alg1.l19.m1.3.3.2.2.3" xref="alg1.l19.m1.3.3.2.2.3.cmml">T</mi></msub><mo id="alg1.l19.m1.4.4.3.7" xref="alg1.l19.m1.4.4.4.cmml">,</mo><msubsup id="alg1.l19.m1.4.4.3.3" xref="alg1.l19.m1.4.4.3.3.cmml"><mi id="alg1.l19.m1.4.4.3.3.2.2" xref="alg1.l19.m1.4.4.3.3.2.2.cmml">l</mi><mi id="alg1.l19.m1.4.4.3.3.3" xref="alg1.l19.m1.4.4.3.3.3.cmml">d</mi><mo id="alg1.l19.m1.4.4.3.3.2.3" xref="alg1.l19.m1.4.4.3.3.2.3.cmml">′</mo></msubsup><mo id="alg1.l19.m1.4.4.3.8" stretchy="false" xref="alg1.l19.m1.4.4.4.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l19.m1.4b"><vector id="alg1.l19.m1.4.4.4.cmml" xref="alg1.l19.m1.4.4.3"><ci id="alg1.l19.m1.1.1.cmml" xref="alg1.l19.m1.1.1">𝐼</ci><apply id="alg1.l19.m1.2.2.1.1.cmml" xref="alg1.l19.m1.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l19.m1.2.2.1.1.1.cmml" xref="alg1.l19.m1.2.2.1.1">subscript</csymbol><ci id="alg1.l19.m1.2.2.1.1.2.cmml" xref="alg1.l19.m1.2.2.1.1.2">𝑝</ci><ci id="alg1.l19.m1.2.2.1.1.3.cmml" xref="alg1.l19.m1.2.2.1.1.3">𝑑</ci></apply><apply id="alg1.l19.m1.3.3.2.2.cmml" xref="alg1.l19.m1.3.3.2.2"><csymbol cd="ambiguous" id="alg1.l19.m1.3.3.2.2.1.cmml" xref="alg1.l19.m1.3.3.2.2">subscript</csymbol><ci id="alg1.l19.m1.3.3.2.2.2.cmml" xref="alg1.l19.m1.3.3.2.2.2">𝑜</ci><ci id="alg1.l19.m1.3.3.2.2.3.cmml" xref="alg1.l19.m1.3.3.2.2.3">𝑇</ci></apply><apply id="alg1.l19.m1.4.4.3.3.cmml" xref="alg1.l19.m1.4.4.3.3"><csymbol cd="ambiguous" id="alg1.l19.m1.4.4.3.3.1.cmml" xref="alg1.l19.m1.4.4.3.3">subscript</csymbol><apply id="alg1.l19.m1.4.4.3.3.2.cmml" xref="alg1.l19.m1.4.4.3.3"><csymbol cd="ambiguous" id="alg1.l19.m1.4.4.3.3.2.1.cmml" xref="alg1.l19.m1.4.4.3.3">superscript</csymbol><ci id="alg1.l19.m1.4.4.3.3.2.2.cmml" xref="alg1.l19.m1.4.4.3.3.2.2">𝑙</ci><ci id="alg1.l19.m1.4.4.3.3.2.3.cmml" xref="alg1.l19.m1.4.4.3.3.2.3">′</ci></apply><ci id="alg1.l19.m1.4.4.3.3.3.cmml" xref="alg1.l19.m1.4.4.3.3.3">𝑑</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.m1.4c">(I,p_{d},o_{T},l^{\prime}_{d})</annotation><annotation encoding="application/x-llamapun" id="alg1.l19.m1.4d">( italic_I , italic_p start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT , italic_l start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT )</annotation></semantics></math> into <math alttext="\mathcal{D}_{\rm critic}" class="ltx_Math" display="inline" id="alg1.l19.m2.1"><semantics id="alg1.l19.m2.1a"><msub id="alg1.l19.m2.1.1" xref="alg1.l19.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l19.m2.1.1.2" xref="alg1.l19.m2.1.1.2.cmml">𝒟</mi><mi id="alg1.l19.m2.1.1.3" xref="alg1.l19.m2.1.1.3.cmml">critic</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l19.m2.1b"><apply id="alg1.l19.m2.1.1.cmml" xref="alg1.l19.m2.1.1"><csymbol cd="ambiguous" id="alg1.l19.m2.1.1.1.cmml" xref="alg1.l19.m2.1.1">subscript</csymbol><ci id="alg1.l19.m2.1.1.2.cmml" xref="alg1.l19.m2.1.1.2">𝒟</ci><ci id="alg1.l19.m2.1.1.3.cmml" xref="alg1.l19.m2.1.1.3">critic</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.m2.1c">\mathcal{D}_{\rm critic}</annotation><annotation encoding="application/x-llamapun" id="alg1.l19.m2.1d">caligraphic_D start_POSTSUBSCRIPT roman_critic end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l20">
<span class="ltx_tag ltx_tag_listingline">20:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;store <math alttext="(I,p_{a},o_{t},l_{a,t}),t=1,...T" class="ltx_Math" display="inline" id="alg1.l20.m1.6"><semantics id="alg1.l20.m1.6a"><mrow id="alg1.l20.m1.6.6.2" xref="alg1.l20.m1.6.6.3.cmml"><mrow id="alg1.l20.m1.5.5.1.1" xref="alg1.l20.m1.5.5.1.1.cmml"><mrow id="alg1.l20.m1.5.5.1.1.1.1" xref="alg1.l20.m1.5.5.1.1.1.2.cmml"><mrow id="alg1.l20.m1.5.5.1.1.1.1.1.3" xref="alg1.l20.m1.5.5.1.1.1.1.1.4.cmml"><mo id="alg1.l20.m1.5.5.1.1.1.1.1.3.4" stretchy="false" xref="alg1.l20.m1.5.5.1.1.1.1.1.4.cmml">(</mo><mi id="alg1.l20.m1.3.3" xref="alg1.l20.m1.3.3.cmml">I</mi><mo id="alg1.l20.m1.5.5.1.1.1.1.1.3.5" xref="alg1.l20.m1.5.5.1.1.1.1.1.4.cmml">,</mo><msub id="alg1.l20.m1.5.5.1.1.1.1.1.1.1" xref="alg1.l20.m1.5.5.1.1.1.1.1.1.1.cmml"><mi id="alg1.l20.m1.5.5.1.1.1.1.1.1.1.2" xref="alg1.l20.m1.5.5.1.1.1.1.1.1.1.2.cmml">p</mi><mi id="alg1.l20.m1.5.5.1.1.1.1.1.1.1.3" xref="alg1.l20.m1.5.5.1.1.1.1.1.1.1.3.cmml">a</mi></msub><mo id="alg1.l20.m1.5.5.1.1.1.1.1.3.6" xref="alg1.l20.m1.5.5.1.1.1.1.1.4.cmml">,</mo><msub id="alg1.l20.m1.5.5.1.1.1.1.1.2.2" xref="alg1.l20.m1.5.5.1.1.1.1.1.2.2.cmml"><mi id="alg1.l20.m1.5.5.1.1.1.1.1.2.2.2" xref="alg1.l20.m1.5.5.1.1.1.1.1.2.2.2.cmml">o</mi><mi id="alg1.l20.m1.5.5.1.1.1.1.1.2.2.3" xref="alg1.l20.m1.5.5.1.1.1.1.1.2.2.3.cmml">t</mi></msub><mo id="alg1.l20.m1.5.5.1.1.1.1.1.3.7" xref="alg1.l20.m1.5.5.1.1.1.1.1.4.cmml">,</mo><msub id="alg1.l20.m1.5.5.1.1.1.1.1.3.3" xref="alg1.l20.m1.5.5.1.1.1.1.1.3.3.cmml"><mi id="alg1.l20.m1.5.5.1.1.1.1.1.3.3.2" xref="alg1.l20.m1.5.5.1.1.1.1.1.3.3.2.cmml">l</mi><mrow id="alg1.l20.m1.2.2.2.4" xref="alg1.l20.m1.2.2.2.3.cmml"><mi id="alg1.l20.m1.1.1.1.1" xref="alg1.l20.m1.1.1.1.1.cmml">a</mi><mo id="alg1.l20.m1.2.2.2.4.1" xref="alg1.l20.m1.2.2.2.3.cmml">,</mo><mi id="alg1.l20.m1.2.2.2.2" xref="alg1.l20.m1.2.2.2.2.cmml">t</mi></mrow></msub><mo id="alg1.l20.m1.5.5.1.1.1.1.1.3.8" stretchy="false" xref="alg1.l20.m1.5.5.1.1.1.1.1.4.cmml">)</mo></mrow><mo id="alg1.l20.m1.5.5.1.1.1.1.2" xref="alg1.l20.m1.5.5.1.1.1.2.cmml">,</mo><mi id="alg1.l20.m1.4.4" xref="alg1.l20.m1.4.4.cmml">t</mi></mrow><mo id="alg1.l20.m1.5.5.1.1.2" xref="alg1.l20.m1.5.5.1.1.2.cmml">=</mo><mn id="alg1.l20.m1.5.5.1.1.3" xref="alg1.l20.m1.5.5.1.1.3.cmml">1</mn></mrow><mo id="alg1.l20.m1.6.6.2.3" xref="alg1.l20.m1.6.6.3a.cmml">,</mo><mrow id="alg1.l20.m1.6.6.2.2" xref="alg1.l20.m1.6.6.2.2.cmml"><mi id="alg1.l20.m1.6.6.2.2.2" mathvariant="normal" xref="alg1.l20.m1.6.6.2.2.2.cmml">…</mi><mo id="alg1.l20.m1.6.6.2.2.1" xref="alg1.l20.m1.6.6.2.2.1.cmml">⁢</mo><mi id="alg1.l20.m1.6.6.2.2.3" xref="alg1.l20.m1.6.6.2.2.3.cmml">T</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l20.m1.6b"><apply id="alg1.l20.m1.6.6.3.cmml" xref="alg1.l20.m1.6.6.2"><csymbol cd="ambiguous" id="alg1.l20.m1.6.6.3a.cmml" xref="alg1.l20.m1.6.6.2.3">formulae-sequence</csymbol><apply id="alg1.l20.m1.5.5.1.1.cmml" xref="alg1.l20.m1.5.5.1.1"><eq id="alg1.l20.m1.5.5.1.1.2.cmml" xref="alg1.l20.m1.5.5.1.1.2"></eq><list id="alg1.l20.m1.5.5.1.1.1.2.cmml" xref="alg1.l20.m1.5.5.1.1.1.1"><vector id="alg1.l20.m1.5.5.1.1.1.1.1.4.cmml" xref="alg1.l20.m1.5.5.1.1.1.1.1.3"><ci id="alg1.l20.m1.3.3.cmml" xref="alg1.l20.m1.3.3">𝐼</ci><apply id="alg1.l20.m1.5.5.1.1.1.1.1.1.1.cmml" xref="alg1.l20.m1.5.5.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l20.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="alg1.l20.m1.5.5.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l20.m1.5.5.1.1.1.1.1.1.1.2.cmml" xref="alg1.l20.m1.5.5.1.1.1.1.1.1.1.2">𝑝</ci><ci id="alg1.l20.m1.5.5.1.1.1.1.1.1.1.3.cmml" xref="alg1.l20.m1.5.5.1.1.1.1.1.1.1.3">𝑎</ci></apply><apply id="alg1.l20.m1.5.5.1.1.1.1.1.2.2.cmml" xref="alg1.l20.m1.5.5.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="alg1.l20.m1.5.5.1.1.1.1.1.2.2.1.cmml" xref="alg1.l20.m1.5.5.1.1.1.1.1.2.2">subscript</csymbol><ci id="alg1.l20.m1.5.5.1.1.1.1.1.2.2.2.cmml" xref="alg1.l20.m1.5.5.1.1.1.1.1.2.2.2">𝑜</ci><ci id="alg1.l20.m1.5.5.1.1.1.1.1.2.2.3.cmml" xref="alg1.l20.m1.5.5.1.1.1.1.1.2.2.3">𝑡</ci></apply><apply id="alg1.l20.m1.5.5.1.1.1.1.1.3.3.cmml" xref="alg1.l20.m1.5.5.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l20.m1.5.5.1.1.1.1.1.3.3.1.cmml" xref="alg1.l20.m1.5.5.1.1.1.1.1.3.3">subscript</csymbol><ci id="alg1.l20.m1.5.5.1.1.1.1.1.3.3.2.cmml" xref="alg1.l20.m1.5.5.1.1.1.1.1.3.3.2">𝑙</ci><list id="alg1.l20.m1.2.2.2.3.cmml" xref="alg1.l20.m1.2.2.2.4"><ci id="alg1.l20.m1.1.1.1.1.cmml" xref="alg1.l20.m1.1.1.1.1">𝑎</ci><ci id="alg1.l20.m1.2.2.2.2.cmml" xref="alg1.l20.m1.2.2.2.2">𝑡</ci></list></apply></vector><ci id="alg1.l20.m1.4.4.cmml" xref="alg1.l20.m1.4.4">𝑡</ci></list><cn id="alg1.l20.m1.5.5.1.1.3.cmml" type="integer" xref="alg1.l20.m1.5.5.1.1.3">1</cn></apply><apply id="alg1.l20.m1.6.6.2.2.cmml" xref="alg1.l20.m1.6.6.2.2"><times id="alg1.l20.m1.6.6.2.2.1.cmml" xref="alg1.l20.m1.6.6.2.2.1"></times><ci id="alg1.l20.m1.6.6.2.2.2.cmml" xref="alg1.l20.m1.6.6.2.2.2">…</ci><ci id="alg1.l20.m1.6.6.2.2.3.cmml" xref="alg1.l20.m1.6.6.2.2.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l20.m1.6c">(I,p_{a},o_{t},l_{a,t}),t=1,...T</annotation><annotation encoding="application/x-llamapun" id="alg1.l20.m1.6d">( italic_I , italic_p start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_l start_POSTSUBSCRIPT italic_a , italic_t end_POSTSUBSCRIPT ) , italic_t = 1 , … italic_T</annotation></semantics></math> into <math alttext="\mathcal{D}_{\rm actor}" class="ltx_Math" display="inline" id="alg1.l20.m2.1"><semantics id="alg1.l20.m2.1a"><msub id="alg1.l20.m2.1.1" xref="alg1.l20.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l20.m2.1.1.2" xref="alg1.l20.m2.1.1.2.cmml">𝒟</mi><mi id="alg1.l20.m2.1.1.3" xref="alg1.l20.m2.1.1.3.cmml">actor</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l20.m2.1b"><apply id="alg1.l20.m2.1.1.cmml" xref="alg1.l20.m2.1.1"><csymbol cd="ambiguous" id="alg1.l20.m2.1.1.1.cmml" xref="alg1.l20.m2.1.1">subscript</csymbol><ci id="alg1.l20.m2.1.1.2.cmml" xref="alg1.l20.m2.1.1.2">𝒟</ci><ci id="alg1.l20.m2.1.1.3.cmml" xref="alg1.l20.m2.1.1.3">actor</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l20.m2.1c">\mathcal{D}_{\rm actor}</annotation><annotation encoding="application/x-llamapun" id="alg1.l20.m2.1d">caligraphic_D start_POSTSUBSCRIPT roman_actor end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l21">
<span class="ltx_tag ltx_tag_listingline">21:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ltx_text ltx_font_bold" id="alg1.l21.1">else</span>
</div>
<div class="ltx_listingline" id="alg1.l22">
<span class="ltx_tag ltx_tag_listingline">22:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;get <math alttext="I^{\prime}" class="ltx_Math" display="inline" id="alg1.l22.m1.1"><semantics id="alg1.l22.m1.1a"><msup id="alg1.l22.m1.1.1" xref="alg1.l22.m1.1.1.cmml"><mi id="alg1.l22.m1.1.1.2" xref="alg1.l22.m1.1.1.2.cmml">I</mi><mo id="alg1.l22.m1.1.1.3" xref="alg1.l22.m1.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="alg1.l22.m1.1b"><apply id="alg1.l22.m1.1.1.cmml" xref="alg1.l22.m1.1.1"><csymbol cd="ambiguous" id="alg1.l22.m1.1.1.1.cmml" xref="alg1.l22.m1.1.1">superscript</csymbol><ci id="alg1.l22.m1.1.1.2.cmml" xref="alg1.l22.m1.1.1.2">𝐼</ci><ci id="alg1.l22.m1.1.1.3.cmml" xref="alg1.l22.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l22.m1.1c">I^{\prime}</annotation><annotation encoding="application/x-llamapun" id="alg1.l22.m1.1d">italic_I start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> through hindsight relabeling

</div>
<div class="ltx_listingline" id="alg1.l23">
<span class="ltx_tag ltx_tag_listingline">23:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ltx_text ltx_font_bold" id="alg1.l23.1">if</span>&nbsp;<math alttext="I^{\prime}\neq``None&quot;" class="ltx_Math" display="inline" id="alg1.l23.m1.1"><semantics id="alg1.l23.m1.1a"><mrow id="alg1.l23.m1.1.1" xref="alg1.l23.m1.1.1.cmml"><msup id="alg1.l23.m1.1.1.2" xref="alg1.l23.m1.1.1.2.cmml"><mi id="alg1.l23.m1.1.1.2.2" xref="alg1.l23.m1.1.1.2.2.cmml">I</mi><mo id="alg1.l23.m1.1.1.2.3" xref="alg1.l23.m1.1.1.2.3.cmml">′</mo></msup><mo id="alg1.l23.m1.1.1.1" xref="alg1.l23.m1.1.1.1.cmml">≠</mo><mrow id="alg1.l23.m1.1.1.3" xref="alg1.l23.m1.1.1.3.cmml"><mi id="alg1.l23.m1.1.1.3.2" mathvariant="normal" xref="alg1.l23.m1.1.1.3.2.cmml">`</mi><mo id="alg1.l23.m1.1.1.3.1" xref="alg1.l23.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l23.m1.1.1.3.3" mathvariant="normal" xref="alg1.l23.m1.1.1.3.3.cmml">`</mi><mo id="alg1.l23.m1.1.1.3.1a" xref="alg1.l23.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l23.m1.1.1.3.4" xref="alg1.l23.m1.1.1.3.4.cmml">N</mi><mo id="alg1.l23.m1.1.1.3.1b" xref="alg1.l23.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l23.m1.1.1.3.5" xref="alg1.l23.m1.1.1.3.5.cmml">o</mi><mo id="alg1.l23.m1.1.1.3.1c" xref="alg1.l23.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l23.m1.1.1.3.6" xref="alg1.l23.m1.1.1.3.6.cmml">n</mi><mo id="alg1.l23.m1.1.1.3.1d" xref="alg1.l23.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l23.m1.1.1.3.7" xref="alg1.l23.m1.1.1.3.7.cmml">e</mi><mo id="alg1.l23.m1.1.1.3.1e" xref="alg1.l23.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l23.m1.1.1.3.8" mathvariant="normal" xref="alg1.l23.m1.1.1.3.8.cmml">"</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l23.m1.1b"><apply id="alg1.l23.m1.1.1.cmml" xref="alg1.l23.m1.1.1"><neq id="alg1.l23.m1.1.1.1.cmml" xref="alg1.l23.m1.1.1.1"></neq><apply id="alg1.l23.m1.1.1.2.cmml" xref="alg1.l23.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l23.m1.1.1.2.1.cmml" xref="alg1.l23.m1.1.1.2">superscript</csymbol><ci id="alg1.l23.m1.1.1.2.2.cmml" xref="alg1.l23.m1.1.1.2.2">𝐼</ci><ci id="alg1.l23.m1.1.1.2.3.cmml" xref="alg1.l23.m1.1.1.2.3">′</ci></apply><apply id="alg1.l23.m1.1.1.3.cmml" xref="alg1.l23.m1.1.1.3"><times id="alg1.l23.m1.1.1.3.1.cmml" xref="alg1.l23.m1.1.1.3.1"></times><ci id="alg1.l23.m1.1.1.3.2.cmml" xref="alg1.l23.m1.1.1.3.2">`</ci><ci id="alg1.l23.m1.1.1.3.3.cmml" xref="alg1.l23.m1.1.1.3.3">`</ci><ci id="alg1.l23.m1.1.1.3.4.cmml" xref="alg1.l23.m1.1.1.3.4">𝑁</ci><ci id="alg1.l23.m1.1.1.3.5.cmml" xref="alg1.l23.m1.1.1.3.5">𝑜</ci><ci id="alg1.l23.m1.1.1.3.6.cmml" xref="alg1.l23.m1.1.1.3.6">𝑛</ci><ci id="alg1.l23.m1.1.1.3.7.cmml" xref="alg1.l23.m1.1.1.3.7">𝑒</ci><ci id="alg1.l23.m1.1.1.3.8.cmml" xref="alg1.l23.m1.1.1.3.8">"</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l23.m1.1c">I^{\prime}\neq``None"</annotation><annotation encoding="application/x-llamapun" id="alg1.l23.m1.1d">italic_I start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ≠ ` ` italic_N italic_o italic_n italic_e "</annotation></semantics></math>&nbsp;<span class="ltx_text ltx_font_bold" id="alg1.l23.2">then</span>
</div>
<div class="ltx_listingline" id="alg1.l24">
<span class="ltx_tag ltx_tag_listingline">24:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;store <math alttext="(I^{\prime},p_{d},o_{T},yes)" class="ltx_Math" display="inline" id="alg1.l24.m1.4"><semantics id="alg1.l24.m1.4a"><mrow id="alg1.l24.m1.4.4.4" xref="alg1.l24.m1.4.4.5.cmml"><mo id="alg1.l24.m1.4.4.4.5" stretchy="false" xref="alg1.l24.m1.4.4.5.cmml">(</mo><msup id="alg1.l24.m1.1.1.1.1" xref="alg1.l24.m1.1.1.1.1.cmml"><mi id="alg1.l24.m1.1.1.1.1.2" xref="alg1.l24.m1.1.1.1.1.2.cmml">I</mi><mo id="alg1.l24.m1.1.1.1.1.3" xref="alg1.l24.m1.1.1.1.1.3.cmml">′</mo></msup><mo id="alg1.l24.m1.4.4.4.6" xref="alg1.l24.m1.4.4.5.cmml">,</mo><msub id="alg1.l24.m1.2.2.2.2" xref="alg1.l24.m1.2.2.2.2.cmml"><mi id="alg1.l24.m1.2.2.2.2.2" xref="alg1.l24.m1.2.2.2.2.2.cmml">p</mi><mi id="alg1.l24.m1.2.2.2.2.3" xref="alg1.l24.m1.2.2.2.2.3.cmml">d</mi></msub><mo id="alg1.l24.m1.4.4.4.7" xref="alg1.l24.m1.4.4.5.cmml">,</mo><msub id="alg1.l24.m1.3.3.3.3" xref="alg1.l24.m1.3.3.3.3.cmml"><mi id="alg1.l24.m1.3.3.3.3.2" xref="alg1.l24.m1.3.3.3.3.2.cmml">o</mi><mi id="alg1.l24.m1.3.3.3.3.3" xref="alg1.l24.m1.3.3.3.3.3.cmml">T</mi></msub><mo id="alg1.l24.m1.4.4.4.8" xref="alg1.l24.m1.4.4.5.cmml">,</mo><mrow id="alg1.l24.m1.4.4.4.4" xref="alg1.l24.m1.4.4.4.4.cmml"><mi id="alg1.l24.m1.4.4.4.4.2" xref="alg1.l24.m1.4.4.4.4.2.cmml">y</mi><mo id="alg1.l24.m1.4.4.4.4.1" xref="alg1.l24.m1.4.4.4.4.1.cmml">⁢</mo><mi id="alg1.l24.m1.4.4.4.4.3" xref="alg1.l24.m1.4.4.4.4.3.cmml">e</mi><mo id="alg1.l24.m1.4.4.4.4.1a" xref="alg1.l24.m1.4.4.4.4.1.cmml">⁢</mo><mi id="alg1.l24.m1.4.4.4.4.4" xref="alg1.l24.m1.4.4.4.4.4.cmml">s</mi></mrow><mo id="alg1.l24.m1.4.4.4.9" stretchy="false" xref="alg1.l24.m1.4.4.5.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l24.m1.4b"><vector id="alg1.l24.m1.4.4.5.cmml" xref="alg1.l24.m1.4.4.4"><apply id="alg1.l24.m1.1.1.1.1.cmml" xref="alg1.l24.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l24.m1.1.1.1.1.1.cmml" xref="alg1.l24.m1.1.1.1.1">superscript</csymbol><ci id="alg1.l24.m1.1.1.1.1.2.cmml" xref="alg1.l24.m1.1.1.1.1.2">𝐼</ci><ci id="alg1.l24.m1.1.1.1.1.3.cmml" xref="alg1.l24.m1.1.1.1.1.3">′</ci></apply><apply id="alg1.l24.m1.2.2.2.2.cmml" xref="alg1.l24.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l24.m1.2.2.2.2.1.cmml" xref="alg1.l24.m1.2.2.2.2">subscript</csymbol><ci id="alg1.l24.m1.2.2.2.2.2.cmml" xref="alg1.l24.m1.2.2.2.2.2">𝑝</ci><ci id="alg1.l24.m1.2.2.2.2.3.cmml" xref="alg1.l24.m1.2.2.2.2.3">𝑑</ci></apply><apply id="alg1.l24.m1.3.3.3.3.cmml" xref="alg1.l24.m1.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l24.m1.3.3.3.3.1.cmml" xref="alg1.l24.m1.3.3.3.3">subscript</csymbol><ci id="alg1.l24.m1.3.3.3.3.2.cmml" xref="alg1.l24.m1.3.3.3.3.2">𝑜</ci><ci id="alg1.l24.m1.3.3.3.3.3.cmml" xref="alg1.l24.m1.3.3.3.3.3">𝑇</ci></apply><apply id="alg1.l24.m1.4.4.4.4.cmml" xref="alg1.l24.m1.4.4.4.4"><times id="alg1.l24.m1.4.4.4.4.1.cmml" xref="alg1.l24.m1.4.4.4.4.1"></times><ci id="alg1.l24.m1.4.4.4.4.2.cmml" xref="alg1.l24.m1.4.4.4.4.2">𝑦</ci><ci id="alg1.l24.m1.4.4.4.4.3.cmml" xref="alg1.l24.m1.4.4.4.4.3">𝑒</ci><ci id="alg1.l24.m1.4.4.4.4.4.cmml" xref="alg1.l24.m1.4.4.4.4.4">𝑠</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="alg1.l24.m1.4c">(I^{\prime},p_{d},o_{T},yes)</annotation><annotation encoding="application/x-llamapun" id="alg1.l24.m1.4d">( italic_I start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_p start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT , italic_y italic_e italic_s )</annotation></semantics></math> into <math alttext="\mathcal{D}_{\rm critic}" class="ltx_Math" display="inline" id="alg1.l24.m2.1"><semantics id="alg1.l24.m2.1a"><msub id="alg1.l24.m2.1.1" xref="alg1.l24.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l24.m2.1.1.2" xref="alg1.l24.m2.1.1.2.cmml">𝒟</mi><mi id="alg1.l24.m2.1.1.3" xref="alg1.l24.m2.1.1.3.cmml">critic</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l24.m2.1b"><apply id="alg1.l24.m2.1.1.cmml" xref="alg1.l24.m2.1.1"><csymbol cd="ambiguous" id="alg1.l24.m2.1.1.1.cmml" xref="alg1.l24.m2.1.1">subscript</csymbol><ci id="alg1.l24.m2.1.1.2.cmml" xref="alg1.l24.m2.1.1.2">𝒟</ci><ci id="alg1.l24.m2.1.1.3.cmml" xref="alg1.l24.m2.1.1.3">critic</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l24.m2.1c">\mathcal{D}_{\rm critic}</annotation><annotation encoding="application/x-llamapun" id="alg1.l24.m2.1d">caligraphic_D start_POSTSUBSCRIPT roman_critic end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l25">
<span class="ltx_tag ltx_tag_listingline">25:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;store <math alttext="(I^{\prime},p_{a},o_{t},l_{a,t}),t=1,...T" class="ltx_Math" display="inline" id="alg1.l25.m1.5"><semantics id="alg1.l25.m1.5a"><mrow id="alg1.l25.m1.5.5.2" xref="alg1.l25.m1.5.5.3.cmml"><mrow id="alg1.l25.m1.4.4.1.1" xref="alg1.l25.m1.4.4.1.1.cmml"><mrow id="alg1.l25.m1.4.4.1.1.1.1" xref="alg1.l25.m1.4.4.1.1.1.2.cmml"><mrow id="alg1.l25.m1.4.4.1.1.1.1.1.4" xref="alg1.l25.m1.4.4.1.1.1.1.1.5.cmml"><mo id="alg1.l25.m1.4.4.1.1.1.1.1.4.5" stretchy="false" xref="alg1.l25.m1.4.4.1.1.1.1.1.5.cmml">(</mo><msup id="alg1.l25.m1.4.4.1.1.1.1.1.1.1" xref="alg1.l25.m1.4.4.1.1.1.1.1.1.1.cmml"><mi id="alg1.l25.m1.4.4.1.1.1.1.1.1.1.2" xref="alg1.l25.m1.4.4.1.1.1.1.1.1.1.2.cmml">I</mi><mo id="alg1.l25.m1.4.4.1.1.1.1.1.1.1.3" xref="alg1.l25.m1.4.4.1.1.1.1.1.1.1.3.cmml">′</mo></msup><mo id="alg1.l25.m1.4.4.1.1.1.1.1.4.6" xref="alg1.l25.m1.4.4.1.1.1.1.1.5.cmml">,</mo><msub id="alg1.l25.m1.4.4.1.1.1.1.1.2.2" xref="alg1.l25.m1.4.4.1.1.1.1.1.2.2.cmml"><mi id="alg1.l25.m1.4.4.1.1.1.1.1.2.2.2" xref="alg1.l25.m1.4.4.1.1.1.1.1.2.2.2.cmml">p</mi><mi id="alg1.l25.m1.4.4.1.1.1.1.1.2.2.3" xref="alg1.l25.m1.4.4.1.1.1.1.1.2.2.3.cmml">a</mi></msub><mo id="alg1.l25.m1.4.4.1.1.1.1.1.4.7" xref="alg1.l25.m1.4.4.1.1.1.1.1.5.cmml">,</mo><msub id="alg1.l25.m1.4.4.1.1.1.1.1.3.3" xref="alg1.l25.m1.4.4.1.1.1.1.1.3.3.cmml"><mi id="alg1.l25.m1.4.4.1.1.1.1.1.3.3.2" xref="alg1.l25.m1.4.4.1.1.1.1.1.3.3.2.cmml">o</mi><mi id="alg1.l25.m1.4.4.1.1.1.1.1.3.3.3" xref="alg1.l25.m1.4.4.1.1.1.1.1.3.3.3.cmml">t</mi></msub><mo id="alg1.l25.m1.4.4.1.1.1.1.1.4.8" xref="alg1.l25.m1.4.4.1.1.1.1.1.5.cmml">,</mo><msub id="alg1.l25.m1.4.4.1.1.1.1.1.4.4" xref="alg1.l25.m1.4.4.1.1.1.1.1.4.4.cmml"><mi id="alg1.l25.m1.4.4.1.1.1.1.1.4.4.2" xref="alg1.l25.m1.4.4.1.1.1.1.1.4.4.2.cmml">l</mi><mrow id="alg1.l25.m1.2.2.2.4" xref="alg1.l25.m1.2.2.2.3.cmml"><mi id="alg1.l25.m1.1.1.1.1" xref="alg1.l25.m1.1.1.1.1.cmml">a</mi><mo id="alg1.l25.m1.2.2.2.4.1" xref="alg1.l25.m1.2.2.2.3.cmml">,</mo><mi id="alg1.l25.m1.2.2.2.2" xref="alg1.l25.m1.2.2.2.2.cmml">t</mi></mrow></msub><mo id="alg1.l25.m1.4.4.1.1.1.1.1.4.9" stretchy="false" xref="alg1.l25.m1.4.4.1.1.1.1.1.5.cmml">)</mo></mrow><mo id="alg1.l25.m1.4.4.1.1.1.1.2" xref="alg1.l25.m1.4.4.1.1.1.2.cmml">,</mo><mi id="alg1.l25.m1.3.3" xref="alg1.l25.m1.3.3.cmml">t</mi></mrow><mo id="alg1.l25.m1.4.4.1.1.2" xref="alg1.l25.m1.4.4.1.1.2.cmml">=</mo><mn id="alg1.l25.m1.4.4.1.1.3" xref="alg1.l25.m1.4.4.1.1.3.cmml">1</mn></mrow><mo id="alg1.l25.m1.5.5.2.3" xref="alg1.l25.m1.5.5.3a.cmml">,</mo><mrow id="alg1.l25.m1.5.5.2.2" xref="alg1.l25.m1.5.5.2.2.cmml"><mi id="alg1.l25.m1.5.5.2.2.2" mathvariant="normal" xref="alg1.l25.m1.5.5.2.2.2.cmml">…</mi><mo id="alg1.l25.m1.5.5.2.2.1" xref="alg1.l25.m1.5.5.2.2.1.cmml">⁢</mo><mi id="alg1.l25.m1.5.5.2.2.3" xref="alg1.l25.m1.5.5.2.2.3.cmml">T</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l25.m1.5b"><apply id="alg1.l25.m1.5.5.3.cmml" xref="alg1.l25.m1.5.5.2"><csymbol cd="ambiguous" id="alg1.l25.m1.5.5.3a.cmml" xref="alg1.l25.m1.5.5.2.3">formulae-sequence</csymbol><apply id="alg1.l25.m1.4.4.1.1.cmml" xref="alg1.l25.m1.4.4.1.1"><eq id="alg1.l25.m1.4.4.1.1.2.cmml" xref="alg1.l25.m1.4.4.1.1.2"></eq><list id="alg1.l25.m1.4.4.1.1.1.2.cmml" xref="alg1.l25.m1.4.4.1.1.1.1"><vector id="alg1.l25.m1.4.4.1.1.1.1.1.5.cmml" xref="alg1.l25.m1.4.4.1.1.1.1.1.4"><apply id="alg1.l25.m1.4.4.1.1.1.1.1.1.1.cmml" xref="alg1.l25.m1.4.4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l25.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="alg1.l25.m1.4.4.1.1.1.1.1.1.1">superscript</csymbol><ci id="alg1.l25.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="alg1.l25.m1.4.4.1.1.1.1.1.1.1.2">𝐼</ci><ci id="alg1.l25.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="alg1.l25.m1.4.4.1.1.1.1.1.1.1.3">′</ci></apply><apply id="alg1.l25.m1.4.4.1.1.1.1.1.2.2.cmml" xref="alg1.l25.m1.4.4.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="alg1.l25.m1.4.4.1.1.1.1.1.2.2.1.cmml" xref="alg1.l25.m1.4.4.1.1.1.1.1.2.2">subscript</csymbol><ci id="alg1.l25.m1.4.4.1.1.1.1.1.2.2.2.cmml" xref="alg1.l25.m1.4.4.1.1.1.1.1.2.2.2">𝑝</ci><ci id="alg1.l25.m1.4.4.1.1.1.1.1.2.2.3.cmml" xref="alg1.l25.m1.4.4.1.1.1.1.1.2.2.3">𝑎</ci></apply><apply id="alg1.l25.m1.4.4.1.1.1.1.1.3.3.cmml" xref="alg1.l25.m1.4.4.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l25.m1.4.4.1.1.1.1.1.3.3.1.cmml" xref="alg1.l25.m1.4.4.1.1.1.1.1.3.3">subscript</csymbol><ci id="alg1.l25.m1.4.4.1.1.1.1.1.3.3.2.cmml" xref="alg1.l25.m1.4.4.1.1.1.1.1.3.3.2">𝑜</ci><ci id="alg1.l25.m1.4.4.1.1.1.1.1.3.3.3.cmml" xref="alg1.l25.m1.4.4.1.1.1.1.1.3.3.3">𝑡</ci></apply><apply id="alg1.l25.m1.4.4.1.1.1.1.1.4.4.cmml" xref="alg1.l25.m1.4.4.1.1.1.1.1.4.4"><csymbol cd="ambiguous" id="alg1.l25.m1.4.4.1.1.1.1.1.4.4.1.cmml" xref="alg1.l25.m1.4.4.1.1.1.1.1.4.4">subscript</csymbol><ci id="alg1.l25.m1.4.4.1.1.1.1.1.4.4.2.cmml" xref="alg1.l25.m1.4.4.1.1.1.1.1.4.4.2">𝑙</ci><list id="alg1.l25.m1.2.2.2.3.cmml" xref="alg1.l25.m1.2.2.2.4"><ci id="alg1.l25.m1.1.1.1.1.cmml" xref="alg1.l25.m1.1.1.1.1">𝑎</ci><ci id="alg1.l25.m1.2.2.2.2.cmml" xref="alg1.l25.m1.2.2.2.2">𝑡</ci></list></apply></vector><ci id="alg1.l25.m1.3.3.cmml" xref="alg1.l25.m1.3.3">𝑡</ci></list><cn id="alg1.l25.m1.4.4.1.1.3.cmml" type="integer" xref="alg1.l25.m1.4.4.1.1.3">1</cn></apply><apply id="alg1.l25.m1.5.5.2.2.cmml" xref="alg1.l25.m1.5.5.2.2"><times id="alg1.l25.m1.5.5.2.2.1.cmml" xref="alg1.l25.m1.5.5.2.2.1"></times><ci id="alg1.l25.m1.5.5.2.2.2.cmml" xref="alg1.l25.m1.5.5.2.2.2">…</ci><ci id="alg1.l25.m1.5.5.2.2.3.cmml" xref="alg1.l25.m1.5.5.2.2.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l25.m1.5c">(I^{\prime},p_{a},o_{t},l_{a,t}),t=1,...T</annotation><annotation encoding="application/x-llamapun" id="alg1.l25.m1.5d">( italic_I start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_p start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_l start_POSTSUBSCRIPT italic_a , italic_t end_POSTSUBSCRIPT ) , italic_t = 1 , … italic_T</annotation></semantics></math> into <math alttext="\mathcal{D}_{\rm actor}" class="ltx_Math" display="inline" id="alg1.l25.m2.1"><semantics id="alg1.l25.m2.1a"><msub id="alg1.l25.m2.1.1" xref="alg1.l25.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l25.m2.1.1.2" xref="alg1.l25.m2.1.1.2.cmml">𝒟</mi><mi id="alg1.l25.m2.1.1.3" xref="alg1.l25.m2.1.1.3.cmml">actor</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l25.m2.1b"><apply id="alg1.l25.m2.1.1.cmml" xref="alg1.l25.m2.1.1"><csymbol cd="ambiguous" id="alg1.l25.m2.1.1.1.cmml" xref="alg1.l25.m2.1.1">subscript</csymbol><ci id="alg1.l25.m2.1.1.2.cmml" xref="alg1.l25.m2.1.1.2">𝒟</ci><ci id="alg1.l25.m2.1.1.3.cmml" xref="alg1.l25.m2.1.1.3">actor</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l25.m2.1c">\mathcal{D}_{\rm actor}</annotation><annotation encoding="application/x-llamapun" id="alg1.l25.m2.1d">caligraphic_D start_POSTSUBSCRIPT roman_actor end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l26">
<span class="ltx_tag ltx_tag_listingline">26:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ltx_text ltx_font_bold" id="alg1.l26.1">end</span>&nbsp;<span class="ltx_text ltx_font_bold" id="alg1.l26.2">if</span>
</div>
<div class="ltx_listingline" id="alg1.l27">
<span class="ltx_tag ltx_tag_listingline">27:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ltx_text ltx_font_bold" id="alg1.l27.1">end</span>&nbsp;<span class="ltx_text ltx_font_bold" id="alg1.l27.2">if</span>
</div>
<div class="ltx_listingline" id="alg1.l28">
<span class="ltx_tag ltx_tag_listingline">28:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ltx_text ltx_font_bold" id="alg1.l28.1">end</span>&nbsp;<span class="ltx_text ltx_font_bold" id="alg1.l28.2">if</span>
</div>
<div class="ltx_listingline" id="alg1.l29">
<span class="ltx_tag ltx_tag_listingline">29:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ltx_text ltx_font_bold" id="alg1.l29.1">end</span>&nbsp;<span class="ltx_text ltx_font_bold" id="alg1.l29.2">while</span>
</div>
<div class="ltx_listingline" id="alg1.l30">
<span class="ltx_tag ltx_tag_listingline">30:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ltx_text ltx_font_bold" id="alg1.l30.1">end</span>&nbsp;<span class="ltx_text ltx_font_bold" id="alg1.l30.2">for</span>
</div>
<div class="ltx_listingline" id="alg1.l31">
<span class="ltx_tag ltx_tag_listingline">31:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;optimization <math alttext="M_{c}" class="ltx_Math" display="inline" id="alg1.l31.m1.1"><semantics id="alg1.l31.m1.1a"><msub id="alg1.l31.m1.1.1" xref="alg1.l31.m1.1.1.cmml"><mi id="alg1.l31.m1.1.1.2" xref="alg1.l31.m1.1.1.2.cmml">M</mi><mi id="alg1.l31.m1.1.1.3" xref="alg1.l31.m1.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l31.m1.1b"><apply id="alg1.l31.m1.1.1.cmml" xref="alg1.l31.m1.1.1"><csymbol cd="ambiguous" id="alg1.l31.m1.1.1.1.cmml" xref="alg1.l31.m1.1.1">subscript</csymbol><ci id="alg1.l31.m1.1.1.2.cmml" xref="alg1.l31.m1.1.1.2">𝑀</ci><ci id="alg1.l31.m1.1.1.3.cmml" xref="alg1.l31.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l31.m1.1c">M_{c}</annotation><annotation encoding="application/x-llamapun" id="alg1.l31.m1.1d">italic_M start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="M_{a}" class="ltx_Math" display="inline" id="alg1.l31.m2.1"><semantics id="alg1.l31.m2.1a"><msub id="alg1.l31.m2.1.1" xref="alg1.l31.m2.1.1.cmml"><mi id="alg1.l31.m2.1.1.2" xref="alg1.l31.m2.1.1.2.cmml">M</mi><mi id="alg1.l31.m2.1.1.3" xref="alg1.l31.m2.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l31.m2.1b"><apply id="alg1.l31.m2.1.1.cmml" xref="alg1.l31.m2.1.1"><csymbol cd="ambiguous" id="alg1.l31.m2.1.1.1.cmml" xref="alg1.l31.m2.1.1">subscript</csymbol><ci id="alg1.l31.m2.1.1.2.cmml" xref="alg1.l31.m2.1.1.2">𝑀</ci><ci id="alg1.l31.m2.1.1.3.cmml" xref="alg1.l31.m2.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l31.m2.1c">M_{a}</annotation><annotation encoding="application/x-llamapun" id="alg1.l31.m2.1d">italic_M start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math> by <math alttext="\mathcal{D}_{\rm critic}" class="ltx_Math" display="inline" id="alg1.l31.m3.1"><semantics id="alg1.l31.m3.1a"><msub id="alg1.l31.m3.1.1" xref="alg1.l31.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l31.m3.1.1.2" xref="alg1.l31.m3.1.1.2.cmml">𝒟</mi><mi id="alg1.l31.m3.1.1.3" xref="alg1.l31.m3.1.1.3.cmml">critic</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l31.m3.1b"><apply id="alg1.l31.m3.1.1.cmml" xref="alg1.l31.m3.1.1"><csymbol cd="ambiguous" id="alg1.l31.m3.1.1.1.cmml" xref="alg1.l31.m3.1.1">subscript</csymbol><ci id="alg1.l31.m3.1.1.2.cmml" xref="alg1.l31.m3.1.1.2">𝒟</ci><ci id="alg1.l31.m3.1.1.3.cmml" xref="alg1.l31.m3.1.1.3">critic</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l31.m3.1c">\mathcal{D}_{\rm critic}</annotation><annotation encoding="application/x-llamapun" id="alg1.l31.m3.1d">caligraphic_D start_POSTSUBSCRIPT roman_critic end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathcal{D}_{\rm actor}" class="ltx_Math" display="inline" id="alg1.l31.m4.1"><semantics id="alg1.l31.m4.1a"><msub id="alg1.l31.m4.1.1" xref="alg1.l31.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l31.m4.1.1.2" xref="alg1.l31.m4.1.1.2.cmml">𝒟</mi><mi id="alg1.l31.m4.1.1.3" xref="alg1.l31.m4.1.1.3.cmml">actor</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l31.m4.1b"><apply id="alg1.l31.m4.1.1.cmml" xref="alg1.l31.m4.1.1"><csymbol cd="ambiguous" id="alg1.l31.m4.1.1.1.cmml" xref="alg1.l31.m4.1.1">subscript</csymbol><ci id="alg1.l31.m4.1.1.2.cmml" xref="alg1.l31.m4.1.1.2">𝒟</ci><ci id="alg1.l31.m4.1.1.3.cmml" xref="alg1.l31.m4.1.1.3">actor</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l31.m4.1c">\mathcal{D}_{\rm actor}</annotation><annotation encoding="application/x-llamapun" id="alg1.l31.m4.1d">caligraphic_D start_POSTSUBSCRIPT roman_actor end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l32">
<span class="ltx_tag ltx_tag_listingline">32:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ltx_text ltx_font_bold" id="alg1.l32.1">return</span> critic MLLM <math alttext="M_{c}" class="ltx_Math" display="inline" id="alg1.l32.m1.1"><semantics id="alg1.l32.m1.1a"><msub id="alg1.l32.m1.1.1" xref="alg1.l32.m1.1.1.cmml"><mi id="alg1.l32.m1.1.1.2" xref="alg1.l32.m1.1.1.2.cmml">M</mi><mi id="alg1.l32.m1.1.1.3" xref="alg1.l32.m1.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l32.m1.1b"><apply id="alg1.l32.m1.1.1.cmml" xref="alg1.l32.m1.1.1"><csymbol cd="ambiguous" id="alg1.l32.m1.1.1.1.cmml" xref="alg1.l32.m1.1.1">subscript</csymbol><ci id="alg1.l32.m1.1.1.2.cmml" xref="alg1.l32.m1.1.1.2">𝑀</ci><ci id="alg1.l32.m1.1.1.3.cmml" xref="alg1.l32.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l32.m1.1c">M_{c}</annotation><annotation encoding="application/x-llamapun" id="alg1.l32.m1.1d">italic_M start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math>, actor MLLM <math alttext="M_{a}" class="ltx_Math" display="inline" id="alg1.l32.m2.1"><semantics id="alg1.l32.m2.1a"><msub id="alg1.l32.m2.1.1" xref="alg1.l32.m2.1.1.cmml"><mi id="alg1.l32.m2.1.1.2" xref="alg1.l32.m2.1.1.2.cmml">M</mi><mi id="alg1.l32.m2.1.1.3" xref="alg1.l32.m2.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l32.m2.1b"><apply id="alg1.l32.m2.1.1.cmml" xref="alg1.l32.m2.1.1"><csymbol cd="ambiguous" id="alg1.l32.m2.1.1.1.cmml" xref="alg1.l32.m2.1.1">subscript</csymbol><ci id="alg1.l32.m2.1.1.2.cmml" xref="alg1.l32.m2.1.1.2">𝑀</ci><ci id="alg1.l32.m2.1.1.3.cmml" xref="alg1.l32.m2.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l32.m2.1c">M_{a}</annotation><annotation encoding="application/x-llamapun" id="alg1.l32.m2.1d">italic_M start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l33">
<span class="ltx_tag ltx_tag_listingline">33:</span><span class="ltx_text ltx_font_bold" id="alg1.l33.1">end</span>&nbsp;<span class="ltx_text ltx_font_bold" id="alg1.l33.2">function</span>
</div>
</div>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_subsection" id="A1.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Implementation Details</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsubsection" id="A1.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.2.1 </span>Environment Details</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A1.SS2.SSS1.p1">
<p class="ltx_p" id="A1.SS2.SSS1.p1.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#A1.F4" title="Figure 4 ‣ A.2.1 Environment Details ‣ A.2 Implementation Details ‣ Appendix A Appendix ‣ SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_tag">4</span></a> shows our experiment environments. Both environments restrict agents to only interact with visible items, limiting their operational range to guarantee behavior plans realistic. Therefore, the actor MLLM makes decisions based on first-person perspective input to ensure accuracy as Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#A1.F4.sf1" title="In Figure 4 ‣ A.2.1 Environment Details ‣ A.2 Implementation Details ‣ Appendix A Appendix ‣ SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_tag">4(a)</span></a> and Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#A1.F4.sf3" title="In Figure 4 ‣ A.2.1 Environment Details ‣ A.2 Implementation Details ‣ Appendix A Appendix ‣ SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_tag">4(c)</span></a> show. Given the limitations of the first-person view, the critic MLLM uses a third-person perspective to evaluate the trajectory, reducing hallucinations and obtaining accurate scene information as Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#A1.F4.sf2" title="In Figure 4 ‣ A.2.1 Environment Details ‣ A.2 Implementation Details ‣ Appendix A Appendix ‣ SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_tag">4(b)</span></a> and Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03303v1#A1.F4.sf4" title="In Figure 4 ‣ A.2.1 Environment Details ‣ A.2 Implementation Details ‣ Appendix A Appendix ‣ SELU: Self-Learning Embodied MLLMs in Unknown Environments"><span class="ltx_text ltx_ref_tag">4(d)</span></a> show.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="A1.SS2.SSS1.p2">
<p class="ltx_p" id="A1.SS2.SSS1.p2.1">The positioning of the third-person camera is crucial, as it should accurately capture the agent’s position and the objects it interacts with. Any occlusion or interference can impair the MLLM’s understanding of the image, thereby affecting the results of critic success detection and hindsight relabeling.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="A1.F4">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A1.F4.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="331" id="A1.F4.sf1.g1" src="https://arxiv.org/html/2410.03303v1/x8.png" width="332">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>AI2-THOR 1</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A1.F4.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="332" id="A1.F4.sf2.g1" src="https://arxiv.org/html/2410.03303v1/x9.png" width="332">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>AI2-THOR 2</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A1.F4.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="333" id="A1.F4.sf3.g1" src="https://arxiv.org/html/2410.03303v1/x10.png" width="332">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>VirtualHome 1</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A1.F4.sf4"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="333" id="A1.F4.sf4.g1" src="https://arxiv.org/html/2410.03303v1/x11.png" width="332">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(d) </span>VirtualHome 2</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>The diagram of experimental environments. We utilize the first-person perspective for decision-making and a third-person perspective for trajectory evaluation.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_subsubsection" id="A1.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.2.2 </span>MLLM Details</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A1.SS2.SSS2.p1">
<p class="ltx_p" id="A1.SS2.SSS2.p1.1">The specific MLLMs we use are LLaVA-V1.6-Mistral-7B and Qwen-VL (Qwen-7B). We use LoRA to fine-tune them, the hyperparameters are as follows.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="A1.T7">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 7: </span>Hyperparameters of LLaVA fine-tuning by LoRA</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A1.T7.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A1.T7.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T7.1.1.1.1" style="padding-top:1pt;padding-bottom:1pt;">Hyperparameters</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T7.1.1.1.2" style="padding-top:1pt;padding-bottom:1pt;">Value</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A1.T7.1.2.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.1.2.1.1" style="padding-top:1pt;padding-bottom:1pt;">train_batch_size</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.1.2.1.2" style="padding-top:1pt;padding-bottom:1pt;">16</td>
</tr>
<tr class="ltx_tr" id="A1.T7.1.3.2">
<td class="ltx_td ltx_align_center" id="A1.T7.1.3.2.1" style="padding-top:1pt;padding-bottom:1pt;">eval_batch_size</td>
<td class="ltx_td ltx_align_center" id="A1.T7.1.3.2.2" style="padding-top:1pt;padding-bottom:1pt;">4</td>
</tr>
<tr class="ltx_tr" id="A1.T7.1.4.3">
<td class="ltx_td ltx_align_center" id="A1.T7.1.4.3.1" style="padding-top:1pt;padding-bottom:1pt;">gradient_accumulation_steps</td>
<td class="ltx_td ltx_align_center" id="A1.T7.1.4.3.2" style="padding-top:1pt;padding-bottom:1pt;">1</td>
</tr>
<tr class="ltx_tr" id="A1.T7.1.5.4">
<td class="ltx_td ltx_align_center" id="A1.T7.1.5.4.1" style="padding-top:1pt;padding-bottom:1pt;">learning_rate_actor</td>
<td class="ltx_td ltx_align_center" id="A1.T7.1.5.4.2" style="padding-top:1pt;padding-bottom:1pt;">2e-5</td>
</tr>
<tr class="ltx_tr" id="A1.T7.1.6.5">
<td class="ltx_td ltx_align_center" id="A1.T7.1.6.5.1" style="padding-top:1pt;padding-bottom:1pt;">learning_rate_critic</td>
<td class="ltx_td ltx_align_center" id="A1.T7.1.6.5.2" style="padding-top:1pt;padding-bottom:1pt;">2e-6</td>
</tr>
<tr class="ltx_tr" id="A1.T7.1.7.6">
<td class="ltx_td ltx_align_center" id="A1.T7.1.7.6.1" style="padding-top:1pt;padding-bottom:1pt;">warmup_ratio</td>
<td class="ltx_td ltx_align_center" id="A1.T7.1.7.6.2" style="padding-top:1pt;padding-bottom:1pt;">0.03</td>
</tr>
<tr class="ltx_tr" id="A1.T7.1.8.7">
<td class="ltx_td ltx_align_center" id="A1.T7.1.8.7.1" style="padding-top:1pt;padding-bottom:1pt;">weight_decay</td>
<td class="ltx_td ltx_align_center" id="A1.T7.1.8.7.2" style="padding-top:1pt;padding-bottom:1pt;">0.0</td>
</tr>
<tr class="ltx_tr" id="A1.T7.1.9.8">
<td class="ltx_td ltx_align_center" id="A1.T7.1.9.8.1" style="padding-top:1pt;padding-bottom:1pt;">model_max_length</td>
<td class="ltx_td ltx_align_center" id="A1.T7.1.9.8.2" style="padding-top:1pt;padding-bottom:1pt;">2048</td>
</tr>
<tr class="ltx_tr" id="A1.T7.1.10.9">
<td class="ltx_td ltx_align_center" id="A1.T7.1.10.9.1" style="padding-top:1pt;padding-bottom:1pt;">lr_scheduler_type</td>
<td class="ltx_td ltx_align_center" id="A1.T7.1.10.9.2" style="padding-top:1pt;padding-bottom:1pt;">"cosine"</td>
</tr>
<tr class="ltx_tr" id="A1.T7.1.11.10">
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T7.1.11.10.1" style="padding-top:1pt;padding-bottom:1pt;">tf32</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T7.1.11.10.2" style="padding-top:1pt;padding-bottom:1pt;">True</td>
</tr>
</tbody>
</table>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_table" id="A1.T8">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 8: </span>Hyperparameters of Qwen-VL fine-tuning by LoRA</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A1.T8.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A1.T8.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T8.1.1.1.1" style="padding-top:1pt;padding-bottom:1pt;">Hyperparameters</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T8.1.1.1.2" style="padding-top:1pt;padding-bottom:1pt;">Value</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A1.T8.1.2.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T8.1.2.1.1" style="padding-top:1pt;padding-bottom:1pt;">train_batch_size</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T8.1.2.1.2" style="padding-top:1pt;padding-bottom:1pt;">2</td>
</tr>
<tr class="ltx_tr" id="A1.T8.1.3.2">
<td class="ltx_td ltx_align_center" id="A1.T8.1.3.2.1" style="padding-top:1pt;padding-bottom:1pt;">eval_batch_size</td>
<td class="ltx_td ltx_align_center" id="A1.T8.1.3.2.2" style="padding-top:1pt;padding-bottom:1pt;">1</td>
</tr>
<tr class="ltx_tr" id="A1.T8.1.4.3">
<td class="ltx_td ltx_align_center" id="A1.T8.1.4.3.1" style="padding-top:1pt;padding-bottom:1pt;">gradient_accumulation_steps</td>
<td class="ltx_td ltx_align_center" id="A1.T8.1.4.3.2" style="padding-top:1pt;padding-bottom:1pt;">8</td>
</tr>
<tr class="ltx_tr" id="A1.T8.1.5.4">
<td class="ltx_td ltx_align_center" id="A1.T8.1.5.4.1" style="padding-top:1pt;padding-bottom:1pt;">learning_rate_actor</td>
<td class="ltx_td ltx_align_center" id="A1.T8.1.5.4.2" style="padding-top:1pt;padding-bottom:1pt;">1e-5</td>
</tr>
<tr class="ltx_tr" id="A1.T8.1.6.5">
<td class="ltx_td ltx_align_center" id="A1.T8.1.6.5.1" style="padding-top:1pt;padding-bottom:1pt;">learning_rate_critic</td>
<td class="ltx_td ltx_align_center" id="A1.T8.1.6.5.2" style="padding-top:1pt;padding-bottom:1pt;">1e-6</td>
</tr>
<tr class="ltx_tr" id="A1.T8.1.7.6">
<td class="ltx_td ltx_align_center" id="A1.T8.1.7.6.1" style="padding-top:1pt;padding-bottom:1pt;">warmup_ratio</td>
<td class="ltx_td ltx_align_center" id="A1.T8.1.7.6.2" style="padding-top:1pt;padding-bottom:1pt;">0.01</td>
</tr>
<tr class="ltx_tr" id="A1.T8.1.8.7">
<td class="ltx_td ltx_align_center" id="A1.T8.1.8.7.1" style="padding-top:1pt;padding-bottom:1pt;">weight_decay</td>
<td class="ltx_td ltx_align_center" id="A1.T8.1.8.7.2" style="padding-top:1pt;padding-bottom:1pt;">0.1</td>
</tr>
<tr class="ltx_tr" id="A1.T8.1.9.8">
<td class="ltx_td ltx_align_center" id="A1.T8.1.9.8.1" style="padding-top:1pt;padding-bottom:1pt;">adam_beta2</td>
<td class="ltx_td ltx_align_center" id="A1.T8.1.9.8.2" style="padding-top:1pt;padding-bottom:1pt;">0.95</td>
</tr>
<tr class="ltx_tr" id="A1.T8.1.10.9">
<td class="ltx_td ltx_align_center" id="A1.T8.1.10.9.1" style="padding-top:1pt;padding-bottom:1pt;">model_max_length</td>
<td class="ltx_td ltx_align_center" id="A1.T8.1.10.9.2" style="padding-top:1pt;padding-bottom:1pt;">2048</td>
</tr>
<tr class="ltx_tr" id="A1.T8.1.11.10">
<td class="ltx_td ltx_align_center" id="A1.T8.1.11.10.1" style="padding-top:1pt;padding-bottom:1pt;">lr_scheduler_type</td>
<td class="ltx_td ltx_align_center" id="A1.T8.1.11.10.2" style="padding-top:1pt;padding-bottom:1pt;">"cosine"</td>
</tr>
<tr class="ltx_tr" id="A1.T8.1.12.11">
<td class="ltx_td ltx_align_center" id="A1.T8.1.12.11.1" style="padding-top:1pt;padding-bottom:1pt;">bf16</td>
<td class="ltx_td ltx_align_center" id="A1.T8.1.12.11.2" style="padding-top:1pt;padding-bottom:1pt;">True</td>
</tr>
<tr class="ltx_tr" id="A1.T8.1.13.12">
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T8.1.13.12.1" style="padding-top:1pt;padding-bottom:1pt;">lazy_preprocess</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T8.1.13.12.2" style="padding-top:1pt;padding-bottom:1pt;">True</td>
</tr>
</tbody>
</table>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
</section>
<section class="ltx_subsection" id="A1.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.3 </span>Visualization of Actor and Critic on LLaVA in AI2-THOR</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A1.SS3.p1">
<p class="ltx_p" id="A1.SS3.p1.1">We use the embodied actor MLLM to interact with the unknown environment, and collect trajectories for evaluation from the critic MLLM. An example for ’pick up the lettuce’ is as follows.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="A1.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="547" id="A1.F5.g1" src="https://arxiv.org/html/2410.03303v1/x12.png" width="830">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>A visualization of the actor MLLM interacting with the AI2-THOR environment. The agent is instructed to pick up the lettuce. As the lettuce is far away, the agent needs to move closer before attempting to pick it up.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A1.SS3.p2">
<p class="ltx_p" id="A1.SS3.p2.1">We use the critic MLLM to perform success detection on each trajectory and use self-asking and hindsight relabeling techniques to build bootstrapped dataset. An example for ’break the mug’ is as follows.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="A1.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="416" id="A1.F6.g1" src="https://arxiv.org/html/2410.03303v1/x13.png" width="831">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>A visualization of the critic MLLM conducting success detection on a trajectory. Since the trajectory has completed the ’break the mug’ task, it can be added to the fine-tuning dataset.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_subsection" id="A1.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.4 </span>Prompts for SELU</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A1.SS4.p1">
<p class="ltx_p" id="A1.SS4.p1.1">The specific prompts we use for SELU are:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS4.p2">
<svg class="ltx_picture" height="191.99" id="A1.SS4.p2.pic1" overflow="visible" version="1.1" width="600"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,191.99) matrix(1 0 0 -1 0 0)"><g fill="#000000" fill-opacity="1.0"><path d="M 0 5.91 L 0 186.09 C 0 189.35 2.64 191.99 5.91 191.99 L 594.09 191.99 C 597.36 191.99 600 189.35 600 186.09 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z" style="stroke:none"></path></g><g fill="#F2F2F2" fill-opacity="1.0"><path d="M 1.97 5.91 L 1.97 170.57 L 598.03 170.57 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 176.48)"><foreignObject color="#FFFFFF" height="9.61" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="556.69">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A1.SS4.p2.pic1.1.1.1.1.1" style="width:402.3pt;">
<span class="ltx_p" id="A1.SS4.p2.pic1.1.1.1.1.1.1">Actor-Interaction with Env</span>
</span></foreignObject></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 13.78)"><foreignObject color="#000000" height="144.98" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="556.69">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A1.SS4.p2.pic1.2.2.2.1.1" style="width:402.3pt;">
<span class="ltx_p" id="A1.SS4.p2.pic1.2.2.2.1.1.1">This is the current observation from a {agent} in a {AI2-THOR/VirtualHome} environment. Now the {agent} needs to finish the task {instruction}, you can only choose the following action to interact with the environment, which are {action_list}. If you choose {PickupObject/GrabObject}, OpenObject, {BreakObject/SitObject}, you should give a specific object name. Now the objects you can interact with are {visible_objs_str}. What’s your next action to implement the command to {instruction}? You should output your action and the reasoning. The output format should be:</span>
<span class="ltx_p" id="A1.SS4.p2.pic1.2.2.2.1.1.2">Action:…</span>
<span class="ltx_p" id="A1.SS4.p2.pic1.2.2.2.1.1.3">Object:…</span>
<span class="ltx_p" id="A1.SS4.p2.pic1.2.2.2.1.1.4">Reasoning:…</span>
</span></foreignObject></g></g></svg><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS4.p3">
<svg class="ltx_picture" height="125.42" id="A1.SS4.p3.pic1" overflow="visible" version="1.1" width="600"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,125.42) matrix(1 0 0 -1 0 0)"><g fill="#000000" fill-opacity="1.0"><path d="M 0 5.91 L 0 119.51 C 0 122.78 2.64 125.42 5.91 125.42 L 594.09 125.42 C 597.36 125.42 600 122.78 600 119.51 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z" style="stroke:none"></path></g><g fill="#F2F2F2" fill-opacity="1.0"><path d="M 1.97 5.91 L 1.97 104.15 L 598.03 104.15 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 110.06)"><foreignObject color="#FFFFFF" height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="556.69">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A1.SS4.p3.pic1.2.2.2.1.1" style="width:402.3pt;">
<span class="ltx_p" id="A1.SS4.p3.pic1.2.2.2.1.1.1">Critic-Success Detection</span>
</span></foreignObject></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 13.78)"><foreignObject color="#000000" height="78.56" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="556.69">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A1.SS4.p3.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" style="width:402.3pt;">
<span class="ltx_p" id="A1.SS4.p3.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">The image shows a third-person view from the {agent}’s perspective in a {AI2-THOR/VirtualHome} environment. Please check whether the {instruction.objects} in the image is {instruction.verb <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A1.SS4.p3.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="A1.SS4.p3.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><mo id="A1.SS4.p3.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" stretchy="false" xref="A1.SS4.p3.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A1.SS4.p3.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><ci id="A1.SS4.p3.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="A1.SS4.p3.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p3.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p3.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1d">→</annotation></semantics></math> adj.} or not? You should output yes or no, and the reasoning. The output format should be:</span>
<span class="ltx_p" id="A1.SS4.p3.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">Result:…</span>
<span class="ltx_p" id="A1.SS4.p3.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">Reasoning:…</span>
</span></foreignObject></g></g></svg><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS4.p4">
<svg class="ltx_picture" height="111.66" id="A1.SS4.p4.pic1" overflow="visible" version="1.1" width="600"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,111.66) matrix(1 0 0 -1 0 0)"><g fill="#000000" fill-opacity="1.0"><path d="M 0 5.91 L 0 105.75 C 0 109.02 2.64 111.66 5.91 111.66 L 594.09 111.66 C 597.36 111.66 600 109.02 600 105.75 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z" style="stroke:none"></path></g><g fill="#F2F2F2" fill-opacity="1.0"><path d="M 1.97 5.91 L 1.97 87.55 L 598.03 87.55 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 93.45)"><foreignObject color="#FFFFFF" height="12.3" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="556.69">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A1.SS4.p4.pic1.1.1.1.1.1" style="width:402.3pt;">
<span class="ltx_p" id="A1.SS4.p4.pic1.1.1.1.1.1.1">Critic-Self Asking 1</span>
</span></foreignObject></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 13.78)"><foreignObject color="#000000" height="61.96" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="556.69">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A1.SS4.p4.pic1.2.2.2.1.1" style="width:402.3pt;">
<span class="ltx_p" id="A1.SS4.p4.pic1.2.2.2.1.1.1">The image shows a third-person view from the {agent}’s perspective in a {AI2-THOR/VirtualHome} environment. Please check the state of the {instruction.objects} in the image. You should output the state and the reasoning. The output format should be:</span>
<span class="ltx_p" id="A1.SS4.p4.pic1.2.2.2.1.1.2">State:…</span>
<span class="ltx_p" id="A1.SS4.p4.pic1.2.2.2.1.1.3">Reasoning:…</span>
</span></foreignObject></g></g></svg><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS4.p5">
<svg class="ltx_picture" height="128.26" id="A1.SS4.p5.pic1" overflow="visible" version="1.1" width="600"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,128.26) matrix(1 0 0 -1 0 0)"><g fill="#000000" fill-opacity="1.0"><path d="M 0 5.91 L 0 122.36 C 0 125.62 2.64 128.26 5.91 128.26 L 594.09 128.26 C 597.36 128.26 600 125.62 600 122.36 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z" style="stroke:none"></path></g><g fill="#F2F2F2" fill-opacity="1.0"><path d="M 1.97 5.91 L 1.97 104.15 L 598.03 104.15 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 110.06)"><foreignObject color="#FFFFFF" height="12.3" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="556.69">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A1.SS4.p5.pic1.1.1.1.1.1" style="width:402.3pt;">
<span class="ltx_p" id="A1.SS4.p5.pic1.1.1.1.1.1.1">Critic-Self Asking 2</span>
</span></foreignObject></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 13.78)"><foreignObject color="#000000" height="78.56" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="556.69">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A1.SS4.p5.pic1.2.2.2.1.1" style="width:402.3pt;">
<span class="ltx_p" id="A1.SS4.p5.pic1.2.2.2.1.1.1">The image shows a third-person view from the {agent}’s perspective in a {AI2-THOR/VirtualHome} environment. The {instruction.objects} in the observation is in {objects.state} state, please determine whether the {instruction} has been completed or not. You should output yes or no, and the reasoning. The output format should be:</span>
<span class="ltx_p" id="A1.SS4.p5.pic1.2.2.2.1.1.2">Result:…</span>
<span class="ltx_p" id="A1.SS4.p5.pic1.2.2.2.1.1.3">Reasoning:…</span>
</span></foreignObject></g></g></svg><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS4.p6">
<svg class="ltx_picture" height="128.26" id="A1.SS4.p6.pic1" overflow="visible" version="1.1" width="600"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,128.26) matrix(1 0 0 -1 0 0)"><g fill="#000000" fill-opacity="1.0"><path d="M 0 5.91 L 0 122.36 C 0 125.62 2.64 128.26 5.91 128.26 L 594.09 128.26 C 597.36 128.26 600 125.62 600 122.36 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z" style="stroke:none"></path></g><g fill="#F2F2F2" fill-opacity="1.0"><path d="M 1.97 5.91 L 1.97 104.15 L 598.03 104.15 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 110.06)"><foreignObject color="#FFFFFF" height="12.3" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="556.69">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A1.SS4.p6.pic1.2.2.2.1.1" style="width:402.3pt;">
<span class="ltx_p" id="A1.SS4.p6.pic1.2.2.2.1.1.1">Critic-hindsight relabeling 1</span>
</span></foreignObject></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 13.78)"><foreignObject color="#000000" height="78.56" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="556.69">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A1.SS4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" style="width:402.3pt;">
<span class="ltx_p" id="A1.SS4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">The image shows a third-person view from the {agent}’s perspective in a {AI2-THOR/VirtualHome} environment. Please see the image carefully. Determine whether there is any object that is {instruction.verb <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A1.SS4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="A1.SS4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><mo id="A1.SS4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" stretchy="false" xref="A1.SS4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A1.SS4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><ci id="A1.SS4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="A1.SS4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1d">→</annotation></semantics></math> adj.} by the {agent}? You should output the object name and the reasoning. The output format should be:</span>
<span class="ltx_p" id="A1.SS4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">Object:…</span>
<span class="ltx_p" id="A1.SS4.p6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">Reasoning:…</span>
</span></foreignObject></g></g></svg><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS4.p7">
<svg class="ltx_picture" height="128.26" id="A1.SS4.p7.pic1" overflow="visible" version="1.1" width="600"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,128.26) matrix(1 0 0 -1 0 0)"><g fill="#000000" fill-opacity="1.0"><path d="M 0 5.91 L 0 122.36 C 0 125.62 2.64 128.26 5.91 128.26 L 594.09 128.26 C 597.36 128.26 600 125.62 600 122.36 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z" style="stroke:none"></path></g><g fill="#F2F2F2" fill-opacity="1.0"><path d="M 1.97 5.91 L 1.97 104.15 L 598.03 104.15 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 110.06)"><foreignObject color="#FFFFFF" height="12.3" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="556.69">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A1.SS4.p7.pic1.2.2.2.1.1" style="width:402.3pt;">
<span class="ltx_p" id="A1.SS4.p7.pic1.2.2.2.1.1.1">Critic-hindsight relabeling 2</span>
</span></foreignObject></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 13.78)"><foreignObject color="#000000" height="78.56" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="556.69">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A1.SS4.p7.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" style="width:402.3pt;">
<span class="ltx_p" id="A1.SS4.p7.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">The image shows a third-person view from the {agent}’s perspective in a {AI2-THOR/VirtualHome} environment. The {relabeling.object} in the observation is {instruction.verb <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A1.SS4.p7.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="A1.SS4.p7.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><mo id="A1.SS4.p7.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" stretchy="false" xref="A1.SS4.p7.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A1.SS4.p7.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><ci id="A1.SS4.p7.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="A1.SS4.p7.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p7.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p7.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1d">→</annotation></semantics></math> adj.}, you should give a new instruction based on it. The original instruction is {instruction}, what’s the new instruction? The output format should be:</span>
<span class="ltx_p" id="A1.SS4.p7.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">New instruction:…</span>
<span class="ltx_p" id="A1.SS4.p7.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">Reasoning:…</span>
</span></foreignObject></g></g></svg><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
</article>
</div>

</div>


<button type="button" class="btn btn-primary hover-rp-button" id="openForm">Report Issue</button><div class="modal" id="myForm" role="dialog" aria-labelledby="modal-title"><div class="modal-dialog"><form class="modal-content" id="myFormContent" enctype="multipart/form-data"><div class="modal-header" id="modal-header"><h5 class="modal-title">Report Github Issue</h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div><div class="modal-body"><label for="form_title" id="modalTitle">Title:</label><input class="form-control" id="form_title" name="form_title" required="required" placeholder="Enter title"><label for="description" id="selectedTextModalDescription" style="display: none;">Content selection saved. Describe the issue below:</label><label for="description" id="nomralModalDescription">Description:</label><textarea class="form-control" id="description" name="description" required="required" style="height: 80px;" maxlength="500" placeholder="500 characters maximum"></textarea></div><div class="modal-footer d-flex justify-content-end"><button type="submit" class="sr-only button" id="modal-submit-sr">Submit without Github</button><button type="submit" class="btn btn-primary" id="modal-submit">Submit in Github</button></div></form></div></div><button id="small-report-button" type="button" class="btn btn-secondary btn-sm" style="background-color: rgb(179, 27, 27); position: fixed;">Report Issue for Selection</button><div class="ltx_page_footer">
        <div class="ltx_page_logo">
            Generated by
            <a href="https://math.nist.gov/~BMiller/LaTeXML/" class="ltx_LaTeXML_logo">
                <span style="letter-spacing: -0.2em; margin-right: 0.1em;">
                    L
                    <span style="font-size: 70%; position: relative; bottom: 2.2pt;">A</span>
                    T
                    <span style="position: relative; bottom: -0.4ex;">E</span>
                </span>
                <span class="ltx_font_smallcaps">xml</span>
                <img alt="[LOGO]" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==">
            </a>
        </div></div><footer id="footer" class="ltx_document">
        <div class="keyboard-glossary">
            <h2>Instructions for reporting errors</h2>
            <p>We are continuing to improve HTML versions of papers, and your feedback helps enhance accessibility and mobile support. To report errors in the HTML that will help us improve conversion and rendering, choose any of the methods listed below:</p>
            <ul>
                <li>Click the "Report Issue" button.</li>
                <li>Open a report feedback form via keyboard, use "<strong>Ctrl + ?</strong>".</li>
                <li>Make a text selection and click the "Report Issue for Selection" button near your cursor.</li>
                <li class="sr-only">You can use Alt+Y to toggle on and Alt+Shift+Y to toggle off accessible reporting links at each section.</li>
            </ul>
            <p>Our team has already identified <a class="ltx_ref" href="https://github.com/arXiv/html_feedback/issues" target="_blank">the following issues</a>. We appreciate your time reviewing and reporting rendering errors we may not have found yet. Your efforts will help us improve the HTML versions for all readers, because disability should not be a barrier to accessing research. Thank you for your continued support in championing open access for all.</p>
            <p>Have a free development cycle? Help support accessibility at arXiv! Our collaborators at LaTeXML maintain a <a class="ltx_ref" href="https://github.com/brucemiller/LaTeXML/wiki/Porting-LaTeX-packages-for-LaTeXML" target="_blank">list of packages that need conversion</a>, and welcome <a class="ltx_ref" href="https://github.com/brucemiller/LaTeXML/issues" target="_blank">developer contributions</a>.</p>
        </div>
    </footer></body></html>