<!DOCTYPE html><html lang="en" data-theme="light"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<title>Revisiting In-context Learning Inference Circuit in Large Language Models</title>
<!--Generated on Sun Oct  6 12:47:41 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="https://arxiv.org/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css">
<link href="https://arxiv.org/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css">
<link href="https://arxiv.org/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css">




<base href="https://arxiv.org/html/2410.04468v1/"><link rel="stylesheet" href="https://use.typekit.net/rwr5zpx.css"><link rel="icon" type="image/png" href="https://static.arxiv.org/static/browse/0.3.4/images/icons/favicon-16x16.png" sizes="16x16"><link rel="icon" type="image/png" href="https://static.arxiv.org/static/browse/0.3.4/images/icons/favicon-32x32.png" sizes="32x32"></head>
<body><header class="mob_header">
    <div class="html-header-logo">
      <a href="https://arxiv.org/">
        <img alt="logo" class="logomark" role="presentation" width="100" src="https://services.dev.arxiv.org/html/static/arxiv-logomark-small-white.svg">
        <span class="sr-only">Back to arXiv</span>
      </a>
    </div>

    <!--TOC, dark mode, links-->
    <div class="html-header-nav">
      <!--back to abstract-->
      
        <a class="nav-link ar5iv-footer-button hover-effect" aria-label="Back to abstract page" href="https://arxiv.org/abs/2410.04468v1">
        <svg xmlns="http://www.w3.org/2000/svg" height="1.25em" viewBox="0 0 512 512" fill="#ffffff" aria-hidden="true">
            <path d="M502.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L402.7 224 192 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l210.7 0-73.4 73.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l128-128zM160 96c17.7 0 32-14.3 32-32s-14.3-32-32-32L96 32C43 32 0 75 0 128L0 384c0 53 43 96 96 96l64 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-64 0c-17.7 0-32-14.3-32-32l0-256c0-17.7 14.3-32 32-32l64 0z"></path>
        </svg>
        </a>
      <!--dark mode-->
      <a class="ar5iv-toggle-color-scheme" title="Toggle dark/light mode" aria-label="System preference">
        <label id="automatic-tog" class="toggle-icon" title="Switch to light mode" for="__palette_3">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"></path></svg>
        </label>
        
        
      </a>
      <!--nav-->
      <button class="navbar-toggler ar5iv-footer-button" type="button" data-bs-theme="dark" data-bs-toggle="collapse" aria-expanded="false" data-bs-target=".ltx_page_main >.ltx_TOC.mobile" aria-controls="navbarSupportedContent" aria-label="Toggle navigation" style="border:none; margin-right: 0em;">
        <svg xmlns="http://www.w3.org/2000/svg" height="1.25em" viewBox="0 0 448 512" aria-hidden="true" role="img" fill="#ffffff"><path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"></path></svg>
      </button>
    </div>
    </header><header class="desktop_header">
    <div class="html-header-logo">
      <a href="https://arxiv.org/">
          <img alt="logo" class="logo" role="presentation" width="100" src="https://services.dev.arxiv.org/html/static/arxiv-logo-one-color-white.svg">
          <span class="sr-only">Back to arXiv</span>
      </a>
    </div>
    <div class="html-header-message" role="banner">
        <p>This is <strong>experimental HTML</strong> to improve accessibility. We invite you to report rendering errors. <span class="sr-only">Use Alt+Y to toggle on accessible reporting links and Alt+Shift+Y to toggle off.</span> Learn more <a href="https://info.arxiv.org/about/accessible_HTML.html" target="_blank">about this project</a> and <a href="https://info.arxiv.org/help/submit_latex_best_practices.html" target="_blank">help improve conversions</a>.
        </p>
    </div>
    <nav class="html-header-nav">
      <a class="ar5iv-footer-button hover-effect" href="https://info.arxiv.org/about/accessible_HTML.html" target="_blank">Why HTML?</a>
      <a class="ar5iv-footer-button hover-effect" target="_blank" href="https://arxiv.org/html/2410.04468v1/#myForm">Report Issue</a>
      <a class="ar5iv-footer-button hover-effect" href="https://arxiv.org/abs/2410.04468v1">Back to Abstract</a>
      <a class="ar5iv-footer-button hover-effect" href="https://arxiv.org/pdf/2410.04468v1" target="_blank">Download PDF</a>
      <a class="ar5iv-toggle-color-scheme" title="Toggle dark/light mode">
        <label id="automatic-tog" class="toggle-icon" title="Switch to light mode" for="__palette_3">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"></path></svg>
        </label>
        
        
      </a>
    </nav></header>

<div class="ltx_page_main" id="main">
<nav class="ltx_TOC active" aria-labelledby="toc_header"><h2 id="toc_header" class="sr-only">Table of Contents</h2>

      <div id="listIcon" type="button" class="hide">
          <svg width="17px" height="17px" viewBox="0 0 512 512" style="pointer-events: none;">
          <path d="M40 48C26.7 48 16 58.7 16 72v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V72c0-13.3-10.7-24-24-24H40zM192 64c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zM16 232v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V232c0-13.3-10.7-24-24-24H40c-13.3 0-24 10.7-24 24zM40 368c-13.3 0-24 10.7-24 24v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V392c0-13.3-10.7-24-24-24H40z"></path>
          </svg>
      </div>
      <div id="arrowIcon" type="button">
          <svg width="17px" height="17px" viewBox="0 0 448 512" style="pointer-events: none;">
          <path d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.2 288 416 288c17.7 0 32-14.3 32-32s-14.3-32-32-32l-306.7 0L214.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"></path>
          </svg>
      </div><ol class="ltx_toclist"><li class="ltx_tocentry ltx_tocentry_section">
    <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#abstract" title="Abstract">
      <span class="ltx_text ltx_ref_title">
        <span class="ltx_tag ltx_tag_ref"></span>
        Abstract
      </span>
    </a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S1" title="In Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S2" title="In Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Preparation</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S2.SS1" title="In 2 Preparation ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Background &amp; Related Works</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S2.SS2" title="In 2 Preparation ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Experiment Settings</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S3" title="In Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Step 1, Summarize: Linear Representations in Hidden States</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S3.SS1" title="In 3 Step 1, Summarize: Linear Representations in Hidden States ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>LLMs Summarize Input Text on Forerunner Tokens in Hidden States</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S3.SS2" title="In 3 Step 1, Summarize: Linear Representations in Hidden States ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Text Summarization is Linear and Task-Relevant but Position-biased</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S4" title="In Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Induction Circuits in Natural Language Models</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S4.SS1" title="In 4 Induction Circuits in Natural Language Models ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Step 2, Forerunner Token Head: Copy from Text Feature to Label Token</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S4.SS2" title="In 4 Induction Circuits in Natural Language Models ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Step 3, Induction Head: Feature Retrieval on Task Subspace</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S5" title="In Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Putting Things Together</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S5.SS1" title="In 5 Putting Things Together ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Ablation Analysis</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S5.SS2" title="In 5 Putting Things Together ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Bypass Mechanism</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S5.SS3" title="In 5 Putting Things Together ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>Explaination towards Observed ICL Phenomena</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S6" title="In Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusion and Discussion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A1" title="In Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Experiment Details and Settings</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A1.SS1" title="In Appendix A Experiment Details and Settings ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1 </span>Detailed Overall Experimental Settings</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A1.SS2" title="In Appendix A Experiment Details and Settings ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2 </span>Calculation of Mutual Nearest-neighbor Kernel Alignment</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A1.SS2.SSS1" title="In A.2 Calculation of Mutual Nearest-neighbor Kernel Alignment ‣ Appendix A Experiment Details and Settings ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2.1 </span>Background Values of Kernel Alignment: Label Token - Text Encoding.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A1.SS3" title="In Appendix A Experiment Details and Settings ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.3 </span>Training and Inference of Centroid Classifier</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A1.SS4" title="In Appendix A Experiment Details and Settings ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.4 </span>Cartography Details of Fig.&nbsp;<span class="ltx_text ltx_ref_tag">6</span> (Middle)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A1.SS5" title="In Appendix A Experiment Details and Settings ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.5 </span>Cartography Details of Fig.&nbsp;<span class="ltx_text ltx_ref_tag">7</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A1.SS6" title="In Appendix A Experiment Details and Settings ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.6 </span>Cartography Details of Fig.&nbsp;<span class="ltx_text ltx_ref_tag">8</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A2" title="In Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>LM Pre-training Dynamics Measured by ICL Circuit</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A2.SS1" title="In Appendix B LM Pre-training Dynamics Measured by ICL Circuit ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.1 </span>Data Distribution Requirement Explained by Hidden State Multiplex</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A3" title="In Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>Can LMs Segment ICL Prompt?</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A4" title="In Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D </span>Measurement on Direct Decoding</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A5" title="In Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E </span>Demonstrations Enhance the Inference of Perplexed Queries</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A6" title="In Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">F </span>Augmentated Experiment Results</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A6.SS1" title="In Appendix F Augmentated Experiment Results ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">F.1 </span>Attention Head Statistics</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A6.SS2" title="In Appendix F Augmentated Experiment Results ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">F.2 </span>Other LMs’ Experiment Results</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A6.SS3" title="In Appendix F Augmentated Experiment Results ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">F.3 </span>More Results of Fig.&nbsp;<span class="ltx_text ltx_ref_tag">7</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
    <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib" title="References">
      <span class="ltx_text ltx_ref_title">
        <span class="ltx_tag ltx_tag_ref"></span>
        References
      </span>
    </a></li></ol></nav>

<div class="ltx_page_content"><div id="target-section" class="section"><a id="license-tr" href="https://info.arxiv.org/help/license/index.html#licenses-available">License: arXiv.org perpetual non-exclusive license</a><div id="watermark-tr">arXiv:2410.04468v1 [cs.CL] 06 Oct 2024</div></div>
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Revisiting In-context Learning Inference Circuit in Large Language Models</h1><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Hakaze Cho<sup class="ltx_sup" id="id8.8.id1"><span class="ltx_text ltx_font_italic" id="id8.8.id1.1">1,∗</span></sup><span class="ltx_text ltx_phantom" id="id9.9.id2"><span style="visibility:hidden">111111</span></span> Mariko Kato<sup class="ltx_sup" id="id10.10.id3"><span class="ltx_text ltx_font_italic" id="id10.10.id3.1">1,†</span></sup><span class="ltx_text ltx_phantom" id="id11.11.id4"><span style="visibility:hidden">111111</span></span> Yoshihiro Sakai<sup class="ltx_sup" id="id12.12.id5"><span class="ltx_text ltx_font_italic" id="id12.12.id5.1">1,†</span></sup><span class="ltx_text ltx_phantom" id="id13.13.id6"><span style="visibility:hidden">111111</span></span>
Naoya Inoue<sup class="ltx_sup" id="id14.14.id7"><span class="ltx_text ltx_font_italic" id="id14.14.id7.1">1,2</span></sup>
<br class="ltx_break"><sup class="ltx_sup" id="id15.15.id8"><span class="ltx_text ltx_font_italic" id="id15.15.id8.1">1</span></sup>Japan Advanced Institute of Science and Technology <sup class="ltx_sup" id="id16.16.id9"><span class="ltx_text ltx_font_italic" id="id16.16.id9.1">2</span></sup>RIKEN
<br class="ltx_break">*Correspondence to: <span class="ltx_text ltx_font_typewriter" id="id17.17.id10">yfzhao@jaist.ac.jp<span class="ltx_text ltx_phantom ltx_font_serif" id="id17.17.id10.1"><span style="visibility:hidden">111111</span></span></span> <sup class="ltx_sup" id="id18.18.id11"><span class="ltx_text ltx_font_italic" id="id18.18.id11.1">†</span></sup>Equal contribution
</span></span>
</div><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_abstract" id="abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<p class="ltx_p" id="id19.id1"><span class="ltx_text ltx_font_bold" id="id19.id1.1">I</span>n-<span class="ltx_text ltx_font_bold" id="id19.id1.2">c</span>ontext <span class="ltx_text ltx_font_bold" id="id19.id1.3">L</span>earning (ICL) is an emerging few-shot learning paradigm on <span class="ltx_text ltx_font_bold" id="id19.id1.4">L</span>anguage <span class="ltx_text ltx_font_bold" id="id19.id1.5">M</span>odels (LMs) with inner mechanisms un-explored. There are already existing works describing the inner processing of ICL, while they struggle to capture all the inference phenomena in large language models. Therefore, this paper proposes a comprehensive circuit to model the inference dynamics and try to explain the observed phenomena of ICL. In detail, we divide ICL inference into 3 major operations: <span class="ltx_text ltx_font_bold" id="id19.id1.6">(1) Summarize</span>: LMs encode every input text (demonstrations and queries) into linear representation in the hidden states with sufficient information to solve ICL tasks. <span class="ltx_text ltx_font_bold" id="id19.id1.7">(2) Semantics Merge</span>: LMs merge the encoded representations of demonstrations with their corresponding label tokens to produce joint representations of labels and demonstrations. <span class="ltx_text ltx_font_bold" id="id19.id1.8">(3) Feature Retrieval and Copy</span>: LMs search the joint representations similar to the query representation on a task subspace, and copy the searched representations into the query. Then, language model heads capture these copied label representations to a certain extent and decode them into predicted labels. The proposed inference circuit successfully captured many phenomena observed during the ICL process, making it a comprehensive and practical explanation of the ICL inference process. Moreover, ablation analysis by disabling the proposed steps seriously damages the ICL performance, suggesting the proposed inference circuit is a dominating mechanism. Additionally, we confirm and list some bypass mechanisms that solve ICL tasks in parallel with the proposed circuit.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S1.p1">
<p class="ltx_p" id="S1.p1.6"><span class="ltx_text ltx_font_bold" id="S1.p1.6.1">I</span>n-<span class="ltx_text ltx_font_bold" id="S1.p1.6.2">C</span>ontext <span class="ltx_text ltx_font_bold" id="S1.p1.6.3">L</span>earning (ICL)&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Radford et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib34" title="">2019</a>; Dong et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib11" title="">2022</a>)</cite> is an emerging few-shot learning paradigm: given the <span class="ltx_text ltx_font_italic" id="S1.p1.6.4">demonstrations</span> <math alttext="\{(x_{i},y_{i})\}_{i=1}^{k}" class="ltx_Math" display="inline" id="S1.p1.1.m1.1"><semantics id="S1.p1.1.m1.1a"><msubsup id="S1.p1.1.m1.1.1" xref="S1.p1.1.m1.1.1.cmml"><mrow id="S1.p1.1.m1.1.1.1.1.1" xref="S1.p1.1.m1.1.1.1.1.2.cmml"><mo id="S1.p1.1.m1.1.1.1.1.1.2" stretchy="false" xref="S1.p1.1.m1.1.1.1.1.2.cmml">{</mo><mrow id="S1.p1.1.m1.1.1.1.1.1.1.2" xref="S1.p1.1.m1.1.1.1.1.1.1.3.cmml"><mo id="S1.p1.1.m1.1.1.1.1.1.1.2.3" stretchy="false" xref="S1.p1.1.m1.1.1.1.1.1.1.3.cmml">(</mo><msub id="S1.p1.1.m1.1.1.1.1.1.1.1.1" xref="S1.p1.1.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S1.p1.1.m1.1.1.1.1.1.1.1.1.2" xref="S1.p1.1.m1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S1.p1.1.m1.1.1.1.1.1.1.1.1.3" xref="S1.p1.1.m1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S1.p1.1.m1.1.1.1.1.1.1.2.4" xref="S1.p1.1.m1.1.1.1.1.1.1.3.cmml">,</mo><msub id="S1.p1.1.m1.1.1.1.1.1.1.2.2" xref="S1.p1.1.m1.1.1.1.1.1.1.2.2.cmml"><mi id="S1.p1.1.m1.1.1.1.1.1.1.2.2.2" xref="S1.p1.1.m1.1.1.1.1.1.1.2.2.2.cmml">y</mi><mi id="S1.p1.1.m1.1.1.1.1.1.1.2.2.3" xref="S1.p1.1.m1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo id="S1.p1.1.m1.1.1.1.1.1.1.2.5" stretchy="false" xref="S1.p1.1.m1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo id="S1.p1.1.m1.1.1.1.1.1.3" stretchy="false" xref="S1.p1.1.m1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S1.p1.1.m1.1.1.1.3" xref="S1.p1.1.m1.1.1.1.3.cmml"><mi id="S1.p1.1.m1.1.1.1.3.2" xref="S1.p1.1.m1.1.1.1.3.2.cmml">i</mi><mo id="S1.p1.1.m1.1.1.1.3.1" xref="S1.p1.1.m1.1.1.1.3.1.cmml">=</mo><mn id="S1.p1.1.m1.1.1.1.3.3" xref="S1.p1.1.m1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S1.p1.1.m1.1.1.3" xref="S1.p1.1.m1.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S1.p1.1.m1.1b"><apply id="S1.p1.1.m1.1.1.cmml" xref="S1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S1.p1.1.m1.1.1.2.cmml" xref="S1.p1.1.m1.1.1">superscript</csymbol><apply id="S1.p1.1.m1.1.1.1.cmml" xref="S1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S1.p1.1.m1.1.1.1.2.cmml" xref="S1.p1.1.m1.1.1">subscript</csymbol><set id="S1.p1.1.m1.1.1.1.1.2.cmml" xref="S1.p1.1.m1.1.1.1.1.1"><interval closure="open" id="S1.p1.1.m1.1.1.1.1.1.1.3.cmml" xref="S1.p1.1.m1.1.1.1.1.1.1.2"><apply id="S1.p1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S1.p1.1.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S1.p1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S1.p1.1.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S1.p1.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S1.p1.1.m1.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S1.p1.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S1.p1.1.m1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S1.p1.1.m1.1.1.1.1.1.1.2.2.cmml" xref="S1.p1.1.m1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S1.p1.1.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S1.p1.1.m1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S1.p1.1.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S1.p1.1.m1.1.1.1.1.1.1.2.2.2">𝑦</ci><ci id="S1.p1.1.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S1.p1.1.m1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply></interval></set><apply id="S1.p1.1.m1.1.1.1.3.cmml" xref="S1.p1.1.m1.1.1.1.3"><eq id="S1.p1.1.m1.1.1.1.3.1.cmml" xref="S1.p1.1.m1.1.1.1.3.1"></eq><ci id="S1.p1.1.m1.1.1.1.3.2.cmml" xref="S1.p1.1.m1.1.1.1.3.2">𝑖</ci><cn id="S1.p1.1.m1.1.1.1.3.3.cmml" type="integer" xref="S1.p1.1.m1.1.1.1.3.3">1</cn></apply></apply><ci id="S1.p1.1.m1.1.1.3.cmml" xref="S1.p1.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p1.1.m1.1c">\{(x_{i},y_{i})\}_{i=1}^{k}</annotation><annotation encoding="application/x-llamapun" id="S1.p1.1.m1.1d">{ ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT</annotation></semantics></math> consisting of [input text]-[label token] pairs and a <em class="ltx_emph ltx_font_italic" id="S1.p1.6.5">query</em> <math alttext="x_{q}" class="ltx_Math" display="inline" id="S1.p1.2.m2.1"><semantics id="S1.p1.2.m2.1a"><msub id="S1.p1.2.m2.1.1" xref="S1.p1.2.m2.1.1.cmml"><mi id="S1.p1.2.m2.1.1.2" xref="S1.p1.2.m2.1.1.2.cmml">x</mi><mi id="S1.p1.2.m2.1.1.3" xref="S1.p1.2.m2.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S1.p1.2.m2.1b"><apply id="S1.p1.2.m2.1.1.cmml" xref="S1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S1.p1.2.m2.1.1.1.cmml" xref="S1.p1.2.m2.1.1">subscript</csymbol><ci id="S1.p1.2.m2.1.1.2.cmml" xref="S1.p1.2.m2.1.1.2">𝑥</ci><ci id="S1.p1.2.m2.1.1.3.cmml" xref="S1.p1.2.m2.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p1.2.m2.1c">x_{q}</annotation><annotation encoding="application/x-llamapun" id="S1.p1.2.m2.1d">italic_x start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math>, <span class="ltx_text ltx_font_bold" id="S1.p1.6.6">L</span>anguage <span class="ltx_text ltx_font_bold" id="S1.p1.6.7">M</span>odels (LMs) take the sequence <math alttext="[x_{1}][s_{1}][y_{1}]\dots[x_{k}][s_{k}][y_{k}][x_{q}][s_{q}]" class="ltx_Math" display="inline" id="S1.p1.3.m3.8"><semantics id="S1.p1.3.m3.8a"><mrow id="S1.p1.3.m3.8.8" xref="S1.p1.3.m3.8.8.cmml"><mrow id="S1.p1.3.m3.1.1.1.1" xref="S1.p1.3.m3.1.1.1.2.cmml"><mo id="S1.p1.3.m3.1.1.1.1.2" stretchy="false" xref="S1.p1.3.m3.1.1.1.2.1.cmml">[</mo><msub id="S1.p1.3.m3.1.1.1.1.1" xref="S1.p1.3.m3.1.1.1.1.1.cmml"><mi id="S1.p1.3.m3.1.1.1.1.1.2" xref="S1.p1.3.m3.1.1.1.1.1.2.cmml">x</mi><mn id="S1.p1.3.m3.1.1.1.1.1.3" xref="S1.p1.3.m3.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S1.p1.3.m3.1.1.1.1.3" stretchy="false" xref="S1.p1.3.m3.1.1.1.2.1.cmml">]</mo></mrow><mo id="S1.p1.3.m3.8.8.9" xref="S1.p1.3.m3.8.8.9.cmml">⁢</mo><mrow id="S1.p1.3.m3.2.2.2.1" xref="S1.p1.3.m3.2.2.2.2.cmml"><mo id="S1.p1.3.m3.2.2.2.1.2" stretchy="false" xref="S1.p1.3.m3.2.2.2.2.1.cmml">[</mo><msub id="S1.p1.3.m3.2.2.2.1.1" xref="S1.p1.3.m3.2.2.2.1.1.cmml"><mi id="S1.p1.3.m3.2.2.2.1.1.2" xref="S1.p1.3.m3.2.2.2.1.1.2.cmml">s</mi><mn id="S1.p1.3.m3.2.2.2.1.1.3" xref="S1.p1.3.m3.2.2.2.1.1.3.cmml">1</mn></msub><mo id="S1.p1.3.m3.2.2.2.1.3" stretchy="false" xref="S1.p1.3.m3.2.2.2.2.1.cmml">]</mo></mrow><mo id="S1.p1.3.m3.8.8.9a" xref="S1.p1.3.m3.8.8.9.cmml">⁢</mo><mrow id="S1.p1.3.m3.3.3.3.1" xref="S1.p1.3.m3.3.3.3.2.cmml"><mo id="S1.p1.3.m3.3.3.3.1.2" stretchy="false" xref="S1.p1.3.m3.3.3.3.2.1.cmml">[</mo><msub id="S1.p1.3.m3.3.3.3.1.1" xref="S1.p1.3.m3.3.3.3.1.1.cmml"><mi id="S1.p1.3.m3.3.3.3.1.1.2" xref="S1.p1.3.m3.3.3.3.1.1.2.cmml">y</mi><mn id="S1.p1.3.m3.3.3.3.1.1.3" xref="S1.p1.3.m3.3.3.3.1.1.3.cmml">1</mn></msub><mo id="S1.p1.3.m3.3.3.3.1.3" stretchy="false" xref="S1.p1.3.m3.3.3.3.2.1.cmml">]</mo></mrow><mo id="S1.p1.3.m3.8.8.9b" xref="S1.p1.3.m3.8.8.9.cmml">⁢</mo><mi id="S1.p1.3.m3.8.8.10" mathvariant="normal" xref="S1.p1.3.m3.8.8.10.cmml">…</mi><mo id="S1.p1.3.m3.8.8.9c" xref="S1.p1.3.m3.8.8.9.cmml">⁢</mo><mrow id="S1.p1.3.m3.4.4.4.1" xref="S1.p1.3.m3.4.4.4.2.cmml"><mo id="S1.p1.3.m3.4.4.4.1.2" stretchy="false" xref="S1.p1.3.m3.4.4.4.2.1.cmml">[</mo><msub id="S1.p1.3.m3.4.4.4.1.1" xref="S1.p1.3.m3.4.4.4.1.1.cmml"><mi id="S1.p1.3.m3.4.4.4.1.1.2" xref="S1.p1.3.m3.4.4.4.1.1.2.cmml">x</mi><mi id="S1.p1.3.m3.4.4.4.1.1.3" xref="S1.p1.3.m3.4.4.4.1.1.3.cmml">k</mi></msub><mo id="S1.p1.3.m3.4.4.4.1.3" stretchy="false" xref="S1.p1.3.m3.4.4.4.2.1.cmml">]</mo></mrow><mo id="S1.p1.3.m3.8.8.9d" xref="S1.p1.3.m3.8.8.9.cmml">⁢</mo><mrow id="S1.p1.3.m3.5.5.5.1" xref="S1.p1.3.m3.5.5.5.2.cmml"><mo id="S1.p1.3.m3.5.5.5.1.2" stretchy="false" xref="S1.p1.3.m3.5.5.5.2.1.cmml">[</mo><msub id="S1.p1.3.m3.5.5.5.1.1" xref="S1.p1.3.m3.5.5.5.1.1.cmml"><mi id="S1.p1.3.m3.5.5.5.1.1.2" xref="S1.p1.3.m3.5.5.5.1.1.2.cmml">s</mi><mi id="S1.p1.3.m3.5.5.5.1.1.3" xref="S1.p1.3.m3.5.5.5.1.1.3.cmml">k</mi></msub><mo id="S1.p1.3.m3.5.5.5.1.3" stretchy="false" xref="S1.p1.3.m3.5.5.5.2.1.cmml">]</mo></mrow><mo id="S1.p1.3.m3.8.8.9e" xref="S1.p1.3.m3.8.8.9.cmml">⁢</mo><mrow id="S1.p1.3.m3.6.6.6.1" xref="S1.p1.3.m3.6.6.6.2.cmml"><mo id="S1.p1.3.m3.6.6.6.1.2" stretchy="false" xref="S1.p1.3.m3.6.6.6.2.1.cmml">[</mo><msub id="S1.p1.3.m3.6.6.6.1.1" xref="S1.p1.3.m3.6.6.6.1.1.cmml"><mi id="S1.p1.3.m3.6.6.6.1.1.2" xref="S1.p1.3.m3.6.6.6.1.1.2.cmml">y</mi><mi id="S1.p1.3.m3.6.6.6.1.1.3" xref="S1.p1.3.m3.6.6.6.1.1.3.cmml">k</mi></msub><mo id="S1.p1.3.m3.6.6.6.1.3" stretchy="false" xref="S1.p1.3.m3.6.6.6.2.1.cmml">]</mo></mrow><mo id="S1.p1.3.m3.8.8.9f" xref="S1.p1.3.m3.8.8.9.cmml">⁢</mo><mrow id="S1.p1.3.m3.7.7.7.1" xref="S1.p1.3.m3.7.7.7.2.cmml"><mo id="S1.p1.3.m3.7.7.7.1.2" stretchy="false" xref="S1.p1.3.m3.7.7.7.2.1.cmml">[</mo><msub id="S1.p1.3.m3.7.7.7.1.1" xref="S1.p1.3.m3.7.7.7.1.1.cmml"><mi id="S1.p1.3.m3.7.7.7.1.1.2" xref="S1.p1.3.m3.7.7.7.1.1.2.cmml">x</mi><mi id="S1.p1.3.m3.7.7.7.1.1.3" xref="S1.p1.3.m3.7.7.7.1.1.3.cmml">q</mi></msub><mo id="S1.p1.3.m3.7.7.7.1.3" stretchy="false" xref="S1.p1.3.m3.7.7.7.2.1.cmml">]</mo></mrow><mo id="S1.p1.3.m3.8.8.9g" xref="S1.p1.3.m3.8.8.9.cmml">⁢</mo><mrow id="S1.p1.3.m3.8.8.8.1" xref="S1.p1.3.m3.8.8.8.2.cmml"><mo id="S1.p1.3.m3.8.8.8.1.2" stretchy="false" xref="S1.p1.3.m3.8.8.8.2.1.cmml">[</mo><msub id="S1.p1.3.m3.8.8.8.1.1" xref="S1.p1.3.m3.8.8.8.1.1.cmml"><mi id="S1.p1.3.m3.8.8.8.1.1.2" xref="S1.p1.3.m3.8.8.8.1.1.2.cmml">s</mi><mi id="S1.p1.3.m3.8.8.8.1.1.3" xref="S1.p1.3.m3.8.8.8.1.1.3.cmml">q</mi></msub><mo id="S1.p1.3.m3.8.8.8.1.3" stretchy="false" xref="S1.p1.3.m3.8.8.8.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p1.3.m3.8b"><apply id="S1.p1.3.m3.8.8.cmml" xref="S1.p1.3.m3.8.8"><times id="S1.p1.3.m3.8.8.9.cmml" xref="S1.p1.3.m3.8.8.9"></times><apply id="S1.p1.3.m3.1.1.1.2.cmml" xref="S1.p1.3.m3.1.1.1.1"><csymbol cd="latexml" id="S1.p1.3.m3.1.1.1.2.1.cmml" xref="S1.p1.3.m3.1.1.1.1.2">delimited-[]</csymbol><apply id="S1.p1.3.m3.1.1.1.1.1.cmml" xref="S1.p1.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S1.p1.3.m3.1.1.1.1.1.1.cmml" xref="S1.p1.3.m3.1.1.1.1.1">subscript</csymbol><ci id="S1.p1.3.m3.1.1.1.1.1.2.cmml" xref="S1.p1.3.m3.1.1.1.1.1.2">𝑥</ci><cn id="S1.p1.3.m3.1.1.1.1.1.3.cmml" type="integer" xref="S1.p1.3.m3.1.1.1.1.1.3">1</cn></apply></apply><apply id="S1.p1.3.m3.2.2.2.2.cmml" xref="S1.p1.3.m3.2.2.2.1"><csymbol cd="latexml" id="S1.p1.3.m3.2.2.2.2.1.cmml" xref="S1.p1.3.m3.2.2.2.1.2">delimited-[]</csymbol><apply id="S1.p1.3.m3.2.2.2.1.1.cmml" xref="S1.p1.3.m3.2.2.2.1.1"><csymbol cd="ambiguous" id="S1.p1.3.m3.2.2.2.1.1.1.cmml" xref="S1.p1.3.m3.2.2.2.1.1">subscript</csymbol><ci id="S1.p1.3.m3.2.2.2.1.1.2.cmml" xref="S1.p1.3.m3.2.2.2.1.1.2">𝑠</ci><cn id="S1.p1.3.m3.2.2.2.1.1.3.cmml" type="integer" xref="S1.p1.3.m3.2.2.2.1.1.3">1</cn></apply></apply><apply id="S1.p1.3.m3.3.3.3.2.cmml" xref="S1.p1.3.m3.3.3.3.1"><csymbol cd="latexml" id="S1.p1.3.m3.3.3.3.2.1.cmml" xref="S1.p1.3.m3.3.3.3.1.2">delimited-[]</csymbol><apply id="S1.p1.3.m3.3.3.3.1.1.cmml" xref="S1.p1.3.m3.3.3.3.1.1"><csymbol cd="ambiguous" id="S1.p1.3.m3.3.3.3.1.1.1.cmml" xref="S1.p1.3.m3.3.3.3.1.1">subscript</csymbol><ci id="S1.p1.3.m3.3.3.3.1.1.2.cmml" xref="S1.p1.3.m3.3.3.3.1.1.2">𝑦</ci><cn id="S1.p1.3.m3.3.3.3.1.1.3.cmml" type="integer" xref="S1.p1.3.m3.3.3.3.1.1.3">1</cn></apply></apply><ci id="S1.p1.3.m3.8.8.10.cmml" xref="S1.p1.3.m3.8.8.10">…</ci><apply id="S1.p1.3.m3.4.4.4.2.cmml" xref="S1.p1.3.m3.4.4.4.1"><csymbol cd="latexml" id="S1.p1.3.m3.4.4.4.2.1.cmml" xref="S1.p1.3.m3.4.4.4.1.2">delimited-[]</csymbol><apply id="S1.p1.3.m3.4.4.4.1.1.cmml" xref="S1.p1.3.m3.4.4.4.1.1"><csymbol cd="ambiguous" id="S1.p1.3.m3.4.4.4.1.1.1.cmml" xref="S1.p1.3.m3.4.4.4.1.1">subscript</csymbol><ci id="S1.p1.3.m3.4.4.4.1.1.2.cmml" xref="S1.p1.3.m3.4.4.4.1.1.2">𝑥</ci><ci id="S1.p1.3.m3.4.4.4.1.1.3.cmml" xref="S1.p1.3.m3.4.4.4.1.1.3">𝑘</ci></apply></apply><apply id="S1.p1.3.m3.5.5.5.2.cmml" xref="S1.p1.3.m3.5.5.5.1"><csymbol cd="latexml" id="S1.p1.3.m3.5.5.5.2.1.cmml" xref="S1.p1.3.m3.5.5.5.1.2">delimited-[]</csymbol><apply id="S1.p1.3.m3.5.5.5.1.1.cmml" xref="S1.p1.3.m3.5.5.5.1.1"><csymbol cd="ambiguous" id="S1.p1.3.m3.5.5.5.1.1.1.cmml" xref="S1.p1.3.m3.5.5.5.1.1">subscript</csymbol><ci id="S1.p1.3.m3.5.5.5.1.1.2.cmml" xref="S1.p1.3.m3.5.5.5.1.1.2">𝑠</ci><ci id="S1.p1.3.m3.5.5.5.1.1.3.cmml" xref="S1.p1.3.m3.5.5.5.1.1.3">𝑘</ci></apply></apply><apply id="S1.p1.3.m3.6.6.6.2.cmml" xref="S1.p1.3.m3.6.6.6.1"><csymbol cd="latexml" id="S1.p1.3.m3.6.6.6.2.1.cmml" xref="S1.p1.3.m3.6.6.6.1.2">delimited-[]</csymbol><apply id="S1.p1.3.m3.6.6.6.1.1.cmml" xref="S1.p1.3.m3.6.6.6.1.1"><csymbol cd="ambiguous" id="S1.p1.3.m3.6.6.6.1.1.1.cmml" xref="S1.p1.3.m3.6.6.6.1.1">subscript</csymbol><ci id="S1.p1.3.m3.6.6.6.1.1.2.cmml" xref="S1.p1.3.m3.6.6.6.1.1.2">𝑦</ci><ci id="S1.p1.3.m3.6.6.6.1.1.3.cmml" xref="S1.p1.3.m3.6.6.6.1.1.3">𝑘</ci></apply></apply><apply id="S1.p1.3.m3.7.7.7.2.cmml" xref="S1.p1.3.m3.7.7.7.1"><csymbol cd="latexml" id="S1.p1.3.m3.7.7.7.2.1.cmml" xref="S1.p1.3.m3.7.7.7.1.2">delimited-[]</csymbol><apply id="S1.p1.3.m3.7.7.7.1.1.cmml" xref="S1.p1.3.m3.7.7.7.1.1"><csymbol cd="ambiguous" id="S1.p1.3.m3.7.7.7.1.1.1.cmml" xref="S1.p1.3.m3.7.7.7.1.1">subscript</csymbol><ci id="S1.p1.3.m3.7.7.7.1.1.2.cmml" xref="S1.p1.3.m3.7.7.7.1.1.2">𝑥</ci><ci id="S1.p1.3.m3.7.7.7.1.1.3.cmml" xref="S1.p1.3.m3.7.7.7.1.1.3">𝑞</ci></apply></apply><apply id="S1.p1.3.m3.8.8.8.2.cmml" xref="S1.p1.3.m3.8.8.8.1"><csymbol cd="latexml" id="S1.p1.3.m3.8.8.8.2.1.cmml" xref="S1.p1.3.m3.8.8.8.1.2">delimited-[]</csymbol><apply id="S1.p1.3.m3.8.8.8.1.1.cmml" xref="S1.p1.3.m3.8.8.8.1.1"><csymbol cd="ambiguous" id="S1.p1.3.m3.8.8.8.1.1.1.cmml" xref="S1.p1.3.m3.8.8.8.1.1">subscript</csymbol><ci id="S1.p1.3.m3.8.8.8.1.1.2.cmml" xref="S1.p1.3.m3.8.8.8.1.1.2">𝑠</ci><ci id="S1.p1.3.m3.8.8.8.1.1.3.cmml" xref="S1.p1.3.m3.8.8.8.1.1.3">𝑞</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p1.3.m3.8c">[x_{1}][s_{1}][y_{1}]\dots[x_{k}][s_{k}][y_{k}][x_{q}][s_{q}]</annotation><annotation encoding="application/x-llamapun" id="S1.p1.3.m3.8d">[ italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ] [ italic_s start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ] [ italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ] … [ italic_x start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ] [ italic_s start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ] [ italic_y start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ] [ italic_x start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ] [ italic_s start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ]</annotation></semantics></math><span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>In this paper, we denote <span class="ltx_text ltx_font_italic" id="footnote1.1">tokenization</span> as <math alttext="[\cdot]" class="ltx_Math" display="inline" id="footnote1.m1.1"><semantics id="footnote1.m1.1b"><mrow id="footnote1.m1.1.2.2" xref="footnote1.m1.1.2.1.cmml"><mo id="footnote1.m1.1.2.2.1" stretchy="false" xref="footnote1.m1.1.2.1.1.cmml">[</mo><mo id="footnote1.m1.1.1" lspace="0em" rspace="0em" xref="footnote1.m1.1.1.cmml">⋅</mo><mo id="footnote1.m1.1.2.2.2" stretchy="false" xref="footnote1.m1.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="footnote1.m1.1c"><apply id="footnote1.m1.1.2.1.cmml" xref="footnote1.m1.1.2.2"><csymbol cd="latexml" id="footnote1.m1.1.2.1.1.cmml" xref="footnote1.m1.1.2.2.1">delimited-[]</csymbol><ci id="footnote1.m1.1.1.cmml" xref="footnote1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote1.m1.1d">[\cdot]</annotation><annotation encoding="application/x-llamapun" id="footnote1.m1.1e">[ ⋅ ]</annotation></semantics></math>.</span></span></span> as input and then predicts the label for <math alttext="x_{q}" class="ltx_Math" display="inline" id="S1.p1.4.m4.1"><semantics id="S1.p1.4.m4.1a"><msub id="S1.p1.4.m4.1.1" xref="S1.p1.4.m4.1.1.cmml"><mi id="S1.p1.4.m4.1.1.2" xref="S1.p1.4.m4.1.1.2.cmml">x</mi><mi id="S1.p1.4.m4.1.1.3" xref="S1.p1.4.m4.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S1.p1.4.m4.1b"><apply id="S1.p1.4.m4.1.1.cmml" xref="S1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S1.p1.4.m4.1.1.1.cmml" xref="S1.p1.4.m4.1.1">subscript</csymbol><ci id="S1.p1.4.m4.1.1.2.cmml" xref="S1.p1.4.m4.1.1.2">𝑥</ci><ci id="S1.p1.4.m4.1.1.3.cmml" xref="S1.p1.4.m4.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p1.4.m4.1c">x_{q}</annotation><annotation encoding="application/x-llamapun" id="S1.p1.4.m4.1d">italic_x start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> by causal language modeling operation. Typically, the label tokens <math alttext="y_{i}" class="ltx_Math" display="inline" id="S1.p1.5.m5.1"><semantics id="S1.p1.5.m5.1a"><msub id="S1.p1.5.m5.1.1" xref="S1.p1.5.m5.1.1.cmml"><mi id="S1.p1.5.m5.1.1.2" xref="S1.p1.5.m5.1.1.2.cmml">y</mi><mi id="S1.p1.5.m5.1.1.3" xref="S1.p1.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S1.p1.5.m5.1b"><apply id="S1.p1.5.m5.1.1.cmml" xref="S1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S1.p1.5.m5.1.1.1.cmml" xref="S1.p1.5.m5.1.1">subscript</csymbol><ci id="S1.p1.5.m5.1.1.2.cmml" xref="S1.p1.5.m5.1.1.2">𝑦</ci><ci id="S1.p1.5.m5.1.1.3.cmml" xref="S1.p1.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p1.5.m5.1c">y_{i}</annotation><annotation encoding="application/x-llamapun" id="S1.p1.5.m5.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> are preceded by and also predicted by <span class="ltx_text ltx_font_italic" id="S1.p1.6.8">forerunner tokens</span> <math alttext="s_{i}" class="ltx_Math" display="inline" id="S1.p1.6.m6.1"><semantics id="S1.p1.6.m6.1a"><msub id="S1.p1.6.m6.1.1" xref="S1.p1.6.m6.1.1.cmml"><mi id="S1.p1.6.m6.1.1.2" xref="S1.p1.6.m6.1.1.2.cmml">s</mi><mi id="S1.p1.6.m6.1.1.3" xref="S1.p1.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S1.p1.6.m6.1b"><apply id="S1.p1.6.m6.1.1.cmml" xref="S1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S1.p1.6.m6.1.1.1.cmml" xref="S1.p1.6.m6.1.1">subscript</csymbol><ci id="S1.p1.6.m6.1.1.2.cmml" xref="S1.p1.6.m6.1.1.2">𝑠</ci><ci id="S1.p1.6.m6.1.1.3.cmml" xref="S1.p1.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p1.6.m6.1c">s_{i}</annotation><annotation encoding="application/x-llamapun" id="S1.p1.6.m6.1d">italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> (e.g., the colon in “Label: ”). ICL has aroused widespread interest, but its underlying mechanism is still unclear.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">There have been theoretical or empirical trials to characterize and explain the inference process of ICL&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Xie et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib41" title="">2021</a>; Dai et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib10" title="">2023</a>; Wang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib39" title="">2023</a>; Han et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib16" title="">2023a</a>; Jeon et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib20" title="">2024</a>; Zheng et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib48" title="">2024</a>)</cite>. However, to capture all the operating dynamics and the observed interesting phenomenon of ICL in <span class="ltx_text ltx_font_bold" id="S1.p2.1.1">L</span>arge <span class="ltx_text ltx_font_bold" id="S1.p2.1.2">L</span>anguage <span class="ltx_text ltx_font_bold" id="S1.p2.1.3">M</span>odels<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span><span class="ltx_text ltx_font_italic" id="footnote2.1">Large</span> refers to scaled LMs trained by natural language data, such as Llama 3&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(AI@Meta, <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib2" title="">2024</a>)</cite>, contrast to simplified work that uses simple models trained and test on well-embedded input in toy models.</span></span></span>(LLMs), a more comprehensive characterization is still necessary. Therefore, this paper proposes a unified inference circuit and measures various properties in LLMs for a conformation to the observed ICL phenomenon.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S1.p3">
<p class="ltx_p" id="S1.p3.8">As shown in Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">1</span></a>, we decompose ICL dynamics into 3 atomic operations on Transformer layers. <span class="ltx_text ltx_font_bold" id="S1.p3.8.1">Step 1: <span class="ltx_text ltx_font_smallcaps" id="S1.p3.8.1.1">Summarize</span></span>: LMs encode each input text <math alttext="x_{i}" class="ltx_Math" display="inline" id="S1.p3.1.m1.1"><semantics id="S1.p3.1.m1.1a"><msub id="S1.p3.1.m1.1.1" xref="S1.p3.1.m1.1.1.cmml"><mi id="S1.p3.1.m1.1.1.2" xref="S1.p3.1.m1.1.1.2.cmml">x</mi><mi id="S1.p3.1.m1.1.1.3" xref="S1.p3.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S1.p3.1.m1.1b"><apply id="S1.p3.1.m1.1.1.cmml" xref="S1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S1.p3.1.m1.1.1.1.cmml" xref="S1.p3.1.m1.1.1">subscript</csymbol><ci id="S1.p3.1.m1.1.1.2.cmml" xref="S1.p3.1.m1.1.1.2">𝑥</ci><ci id="S1.p3.1.m1.1.1.3.cmml" xref="S1.p3.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.1.m1.1c">x_{i}</annotation><annotation encoding="application/x-llamapun" id="S1.p3.1.m1.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> into linear representations in the hidden state of its corresponding forerunner token <math alttext="s_{i}" class="ltx_Math" display="inline" id="S1.p3.2.m2.1"><semantics id="S1.p3.2.m2.1a"><msub id="S1.p3.2.m2.1.1" xref="S1.p3.2.m2.1.1.cmml"><mi id="S1.p3.2.m2.1.1.2" xref="S1.p3.2.m2.1.1.2.cmml">s</mi><mi id="S1.p3.2.m2.1.1.3" xref="S1.p3.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S1.p3.2.m2.1b"><apply id="S1.p3.2.m2.1.1.cmml" xref="S1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S1.p3.2.m2.1.1.1.cmml" xref="S1.p3.2.m2.1.1">subscript</csymbol><ci id="S1.p3.2.m2.1.1.2.cmml" xref="S1.p3.2.m2.1.1.2">𝑠</ci><ci id="S1.p3.2.m2.1.1.3.cmml" xref="S1.p3.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.2.m2.1c">s_{i}</annotation><annotation encoding="application/x-llamapun" id="S1.p3.2.m2.1d">italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. <span class="ltx_text ltx_font_bold" id="S1.p3.8.2">Step 2: <span class="ltx_text ltx_font_smallcaps" id="S1.p3.8.2.1">Semantics Merge</span></span>: For demonstrations, LMs merge the encoded representations of <math alttext="s_{i}" class="ltx_Math" display="inline" id="S1.p3.3.m3.1"><semantics id="S1.p3.3.m3.1a"><msub id="S1.p3.3.m3.1.1" xref="S1.p3.3.m3.1.1.cmml"><mi id="S1.p3.3.m3.1.1.2" xref="S1.p3.3.m3.1.1.2.cmml">s</mi><mi id="S1.p3.3.m3.1.1.3" xref="S1.p3.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S1.p3.3.m3.1b"><apply id="S1.p3.3.m3.1.1.cmml" xref="S1.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S1.p3.3.m3.1.1.1.cmml" xref="S1.p3.3.m3.1.1">subscript</csymbol><ci id="S1.p3.3.m3.1.1.2.cmml" xref="S1.p3.3.m3.1.1.2">𝑠</ci><ci id="S1.p3.3.m3.1.1.3.cmml" xref="S1.p3.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.3.m3.1c">s_{i}</annotation><annotation encoding="application/x-llamapun" id="S1.p3.3.m3.1d">italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> with the hidden state of its corresponding label tokens <math alttext="y_{i}" class="ltx_Math" display="inline" id="S1.p3.4.m4.1"><semantics id="S1.p3.4.m4.1a"><msub id="S1.p3.4.m4.1.1" xref="S1.p3.4.m4.1.1.cmml"><mi id="S1.p3.4.m4.1.1.2" xref="S1.p3.4.m4.1.1.2.cmml">y</mi><mi id="S1.p3.4.m4.1.1.3" xref="S1.p3.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S1.p3.4.m4.1b"><apply id="S1.p3.4.m4.1.1.cmml" xref="S1.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S1.p3.4.m4.1.1.1.cmml" xref="S1.p3.4.m4.1.1">subscript</csymbol><ci id="S1.p3.4.m4.1.1.2.cmml" xref="S1.p3.4.m4.1.1.2">𝑦</ci><ci id="S1.p3.4.m4.1.1.3.cmml" xref="S1.p3.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.4.m4.1c">y_{i}</annotation><annotation encoding="application/x-llamapun" id="S1.p3.4.m4.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. <span class="ltx_text ltx_font_bold" id="S1.p3.8.3">Step 3: <span class="ltx_text ltx_font_smallcaps" id="S1.p3.8.3.1">Feature Retrieval and Copy</span></span>: LMs retrieve merged label representations <math alttext="y_{1:k}" class="ltx_Math" display="inline" id="S1.p3.5.m5.1"><semantics id="S1.p3.5.m5.1a"><msub id="S1.p3.5.m5.1.1" xref="S1.p3.5.m5.1.1.cmml"><mi id="S1.p3.5.m5.1.1.2" xref="S1.p3.5.m5.1.1.2.cmml">y</mi><mrow id="S1.p3.5.m5.1.1.3" xref="S1.p3.5.m5.1.1.3.cmml"><mn id="S1.p3.5.m5.1.1.3.2" xref="S1.p3.5.m5.1.1.3.2.cmml">1</mn><mo id="S1.p3.5.m5.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S1.p3.5.m5.1.1.3.1.cmml">:</mo><mi id="S1.p3.5.m5.1.1.3.3" xref="S1.p3.5.m5.1.1.3.3.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S1.p3.5.m5.1b"><apply id="S1.p3.5.m5.1.1.cmml" xref="S1.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S1.p3.5.m5.1.1.1.cmml" xref="S1.p3.5.m5.1.1">subscript</csymbol><ci id="S1.p3.5.m5.1.1.2.cmml" xref="S1.p3.5.m5.1.1.2">𝑦</ci><apply id="S1.p3.5.m5.1.1.3.cmml" xref="S1.p3.5.m5.1.1.3"><ci id="S1.p3.5.m5.1.1.3.1.cmml" xref="S1.p3.5.m5.1.1.3.1">:</ci><cn id="S1.p3.5.m5.1.1.3.2.cmml" type="integer" xref="S1.p3.5.m5.1.1.3.2">1</cn><ci id="S1.p3.5.m5.1.1.3.3.cmml" xref="S1.p3.5.m5.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.5.m5.1c">y_{1:k}</annotation><annotation encoding="application/x-llamapun" id="S1.p3.5.m5.1d">italic_y start_POSTSUBSCRIPT 1 : italic_k end_POSTSUBSCRIPT</annotation></semantics></math> from Step 2 similar to the query representation <math alttext="s_{q}" class="ltx_Math" display="inline" id="S1.p3.6.m6.1"><semantics id="S1.p3.6.m6.1a"><msub id="S1.p3.6.m6.1.1" xref="S1.p3.6.m6.1.1.cmml"><mi id="S1.p3.6.m6.1.1.2" xref="S1.p3.6.m6.1.1.2.cmml">s</mi><mi id="S1.p3.6.m6.1.1.3" xref="S1.p3.6.m6.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S1.p3.6.m6.1b"><apply id="S1.p3.6.m6.1.1.cmml" xref="S1.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S1.p3.6.m6.1.1.1.cmml" xref="S1.p3.6.m6.1.1">subscript</csymbol><ci id="S1.p3.6.m6.1.1.2.cmml" xref="S1.p3.6.m6.1.1.2">𝑠</ci><ci id="S1.p3.6.m6.1.1.3.cmml" xref="S1.p3.6.m6.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.6.m6.1c">s_{q}</annotation><annotation encoding="application/x-llamapun" id="S1.p3.6.m6.1d">italic_s start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> in a task-relevant subspace and then merge them with the query representation. Finally, LM heads predict the label for <math alttext="x_{q}" class="ltx_Math" display="inline" id="S1.p3.7.m7.1"><semantics id="S1.p3.7.m7.1a"><msub id="S1.p3.7.m7.1.1" xref="S1.p3.7.m7.1.1.cmml"><mi id="S1.p3.7.m7.1.1.2" xref="S1.p3.7.m7.1.1.2.cmml">x</mi><mi id="S1.p3.7.m7.1.1.3" xref="S1.p3.7.m7.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S1.p3.7.m7.1b"><apply id="S1.p3.7.m7.1.1.cmml" xref="S1.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S1.p3.7.m7.1.1.1.cmml" xref="S1.p3.7.m7.1.1">subscript</csymbol><ci id="S1.p3.7.m7.1.1.2.cmml" xref="S1.p3.7.m7.1.1.2">𝑥</ci><ci id="S1.p3.7.m7.1.1.3.cmml" xref="S1.p3.7.m7.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.7.m7.1c">x_{q}</annotation><annotation encoding="application/x-llamapun" id="S1.p3.7.m7.1d">italic_x start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> using the label-attached query representation <math alttext="s_{q}" class="ltx_Math" display="inline" id="S1.p3.8.m8.1"><semantics id="S1.p3.8.m8.1a"><msub id="S1.p3.8.m8.1.1" xref="S1.p3.8.m8.1.1.cmml"><mi id="S1.p3.8.m8.1.1.2" xref="S1.p3.8.m8.1.1.2.cmml">s</mi><mi id="S1.p3.8.m8.1.1.3" xref="S1.p3.8.m8.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S1.p3.8.m8.1b"><apply id="S1.p3.8.m8.1.1.cmml" xref="S1.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S1.p3.8.m8.1.1.1.cmml" xref="S1.p3.8.m8.1.1">subscript</csymbol><ci id="S1.p3.8.m8.1.1.2.cmml" xref="S1.p3.8.m8.1.1.2">𝑠</ci><ci id="S1.p3.8.m8.1.1.3.cmml" xref="S1.p3.8.m8.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.8.m8.1c">s_{q}</annotation><annotation encoding="application/x-llamapun" id="S1.p3.8.m8.1d">italic_s start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math>.
Steps 2 and 3 form a typical induction circuit, which is a key mechanism of ICL but only examined in synthetic scenarios&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Elhage et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib12" title="">2021</a>; Singh et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib37" title="">2024b</a>; Reddy, <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib35" title="">2024</a>)</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure ltx_align_floatright" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="166" id="S1.F1.g1" src="https://arxiv.org/html/2410.04468v1/extracted/5905049/Figure/Fig1.png" width="274">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>The 3-phase inference diagram of ICL. <span class="ltx_text ltx_font_bold" id="S1.F1.4.1">Step 1</span>: LMs encode every input text into representations, <span class="ltx_text ltx_font_bold" id="S1.F1.5.2">Step 2</span>: LMs merge the encoded text representations of demonstrations with their corresponding label semantics, <span class="ltx_text ltx_font_bold" id="S1.F1.6.3">Step 3</span>: LMs retrieve merged label-text representations similar to the encoded query, and copy the retrieved representations into the query representation.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">We empirically find evidence for the existence of each proposed step in LLMs, and conduct more fine-grained measurements to gain insights into some phenomena observed in ICL scenarios, such as (1) <span class="ltx_text ltx_font_italic" id="S1.p4.1.1">position bias</span>: the prediction is more influenced by the latter demonstration&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Zhao et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib47" title="">2021</a>)</cite>, (2) <span class="ltx_text ltx_font_italic" id="S1.p4.1.2">noise robustness</span>: the prediction is not easy to be affected by demonstrations with noisy labels&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Min et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib29" title="">2022</a>)</cite>, while larger models are less robust to noise&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Wei et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib40" title="">2023</a>)</cite>, and (3) <span class="ltx_text ltx_font_italic" id="S1.p4.1.3">demonstration saturation</span>: the improvements plateau when sufficient demonstrations are given&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Agarwal et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib1" title="">2024</a>; Bertsch et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib4" title="">2024</a>)</cite>, etc. (discussed in&nbsp;§<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S5.SS3" title="5.3 Explaination towards Observed ICL Phenomena ‣ 5 Putting Things Together ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">5.3</span></a>). Moreover, we find multiple bypass mechanisms for ICL with the help of residual connections, while the 3-phase dynamics remains dominant.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S1.p5">
<p class="ltx_p" id="S1.p5.1"><span class="ltx_text ltx_font_bold" id="S1.p5.1.1">Our contributions can be summarized as:</span> (1) We propose a comprehensive 3-step inference circuit to characterize the inference process of ICL, and find empirical evidence of their existence in LLMs. (2) We conduct careful measurements for each inference step and successfully capture a large number of interesting phenomena observed in ICL, which enhances the practicality of the proposed circuit. (3) Our ablation analysis suggests that the proposed circuit dominates, but some bypass mechanisms exist in parallel to perform ICL. We introduce some of these bypasses along with their empirical evidence.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Preparation</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Background &amp; Related Works</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.4"><span class="ltx_text ltx_font_bold" id="S2.SS1.p1.4.1">In-context Learning.</span> Discovered by&nbsp;<cite class="ltx_cite ltx_citemacro_cite">Radford et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib34" title="">2019</a>)</cite>, ICL is an emerging few-shot learning paradigm with only feed-forward calculation in LMs. Given demonstrations <math alttext="\{(x_{i},y_{i})\}_{i=1}^{k}" class="ltx_Math" display="inline" id="S2.SS1.p1.1.m1.1"><semantics id="S2.SS1.p1.1.m1.1a"><msubsup id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml"><mrow id="S2.SS1.p1.1.m1.1.1.1.1.1" xref="S2.SS1.p1.1.m1.1.1.1.1.2.cmml"><mo id="S2.SS1.p1.1.m1.1.1.1.1.1.2" stretchy="false" xref="S2.SS1.p1.1.m1.1.1.1.1.2.cmml">{</mo><mrow id="S2.SS1.p1.1.m1.1.1.1.1.1.1.2" xref="S2.SS1.p1.1.m1.1.1.1.1.1.1.3.cmml"><mo id="S2.SS1.p1.1.m1.1.1.1.1.1.1.2.3" stretchy="false" xref="S2.SS1.p1.1.m1.1.1.1.1.1.1.3.cmml">(</mo><msub id="S2.SS1.p1.1.m1.1.1.1.1.1.1.1.1" xref="S2.SS1.p1.1.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.SS1.p1.1.m1.1.1.1.1.1.1.1.1.2" xref="S2.SS1.p1.1.m1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S2.SS1.p1.1.m1.1.1.1.1.1.1.1.1.3" xref="S2.SS1.p1.1.m1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.SS1.p1.1.m1.1.1.1.1.1.1.2.4" xref="S2.SS1.p1.1.m1.1.1.1.1.1.1.3.cmml">,</mo><msub id="S2.SS1.p1.1.m1.1.1.1.1.1.1.2.2" xref="S2.SS1.p1.1.m1.1.1.1.1.1.1.2.2.cmml"><mi id="S2.SS1.p1.1.m1.1.1.1.1.1.1.2.2.2" xref="S2.SS1.p1.1.m1.1.1.1.1.1.1.2.2.2.cmml">y</mi><mi id="S2.SS1.p1.1.m1.1.1.1.1.1.1.2.2.3" xref="S2.SS1.p1.1.m1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo id="S2.SS1.p1.1.m1.1.1.1.1.1.1.2.5" stretchy="false" xref="S2.SS1.p1.1.m1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo id="S2.SS1.p1.1.m1.1.1.1.1.1.3" stretchy="false" xref="S2.SS1.p1.1.m1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.SS1.p1.1.m1.1.1.1.3" xref="S2.SS1.p1.1.m1.1.1.1.3.cmml"><mi id="S2.SS1.p1.1.m1.1.1.1.3.2" xref="S2.SS1.p1.1.m1.1.1.1.3.2.cmml">i</mi><mo id="S2.SS1.p1.1.m1.1.1.1.3.1" xref="S2.SS1.p1.1.m1.1.1.1.3.1.cmml">=</mo><mn id="S2.SS1.p1.1.m1.1.1.1.3.3" xref="S2.SS1.p1.1.m1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S2.SS1.p1.1.m1.1.1.3" xref="S2.SS1.p1.1.m1.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><apply id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.1.m1.1.1.2.cmml" xref="S2.SS1.p1.1.m1.1.1">superscript</csymbol><apply id="S2.SS1.p1.1.m1.1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.1.m1.1.1.1.2.cmml" xref="S2.SS1.p1.1.m1.1.1">subscript</csymbol><set id="S2.SS1.p1.1.m1.1.1.1.1.2.cmml" xref="S2.SS1.p1.1.m1.1.1.1.1.1"><interval closure="open" id="S2.SS1.p1.1.m1.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.1.m1.1.1.1.1.1.1.2"><apply id="S2.SS1.p1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.1.m1.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S2.SS1.p1.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.1.m1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S2.SS1.p1.1.m1.1.1.1.1.1.1.2.2.cmml" xref="S2.SS1.p1.1.m1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.1.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.SS1.p1.1.m1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S2.SS1.p1.1.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.SS1.p1.1.m1.1.1.1.1.1.1.2.2.2">𝑦</ci><ci id="S2.SS1.p1.1.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.SS1.p1.1.m1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply></interval></set><apply id="S2.SS1.p1.1.m1.1.1.1.3.cmml" xref="S2.SS1.p1.1.m1.1.1.1.3"><eq id="S2.SS1.p1.1.m1.1.1.1.3.1.cmml" xref="S2.SS1.p1.1.m1.1.1.1.3.1"></eq><ci id="S2.SS1.p1.1.m1.1.1.1.3.2.cmml" xref="S2.SS1.p1.1.m1.1.1.1.3.2">𝑖</ci><cn id="S2.SS1.p1.1.m1.1.1.1.3.3.cmml" type="integer" xref="S2.SS1.p1.1.m1.1.1.1.3.3">1</cn></apply></apply><ci id="S2.SS1.p1.1.m1.1.1.3.cmml" xref="S2.SS1.p1.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">\{(x_{i},y_{i})\}_{i=1}^{k}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.1.m1.1d">{ ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT</annotation></semantics></math> composed of structured input-label pairs and a query <math alttext="x_{q}" class="ltx_Math" display="inline" id="S2.SS1.p1.2.m2.1"><semantics id="S2.SS1.p1.2.m2.1a"><msub id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml"><mi id="S2.SS1.p1.2.m2.1.1.2" xref="S2.SS1.p1.2.m2.1.1.2.cmml">x</mi><mi id="S2.SS1.p1.2.m2.1.1.3" xref="S2.SS1.p1.2.m2.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><apply id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.1.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SS1.p1.2.m2.1.1.2.cmml" xref="S2.SS1.p1.2.m2.1.1.2">𝑥</ci><ci id="S2.SS1.p1.2.m2.1.1.3.cmml" xref="S2.SS1.p1.2.m2.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">x_{q}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.2.m2.1d">italic_x start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math>, typical ICL creates a prompt <math alttext="[x_{1}][s_{1}][y_{1}]\dots[x_{k}][s_{k}][y_{k}][x_{q}][s_{q}]" class="ltx_Math" display="inline" id="S2.SS1.p1.3.m3.8"><semantics id="S2.SS1.p1.3.m3.8a"><mrow id="S2.SS1.p1.3.m3.8.8" xref="S2.SS1.p1.3.m3.8.8.cmml"><mrow id="S2.SS1.p1.3.m3.1.1.1.1" xref="S2.SS1.p1.3.m3.1.1.1.2.cmml"><mo id="S2.SS1.p1.3.m3.1.1.1.1.2" stretchy="false" xref="S2.SS1.p1.3.m3.1.1.1.2.1.cmml">[</mo><msub id="S2.SS1.p1.3.m3.1.1.1.1.1" xref="S2.SS1.p1.3.m3.1.1.1.1.1.cmml"><mi id="S2.SS1.p1.3.m3.1.1.1.1.1.2" xref="S2.SS1.p1.3.m3.1.1.1.1.1.2.cmml">x</mi><mn id="S2.SS1.p1.3.m3.1.1.1.1.1.3" xref="S2.SS1.p1.3.m3.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS1.p1.3.m3.1.1.1.1.3" stretchy="false" xref="S2.SS1.p1.3.m3.1.1.1.2.1.cmml">]</mo></mrow><mo id="S2.SS1.p1.3.m3.8.8.9" xref="S2.SS1.p1.3.m3.8.8.9.cmml">⁢</mo><mrow id="S2.SS1.p1.3.m3.2.2.2.1" xref="S2.SS1.p1.3.m3.2.2.2.2.cmml"><mo id="S2.SS1.p1.3.m3.2.2.2.1.2" stretchy="false" xref="S2.SS1.p1.3.m3.2.2.2.2.1.cmml">[</mo><msub id="S2.SS1.p1.3.m3.2.2.2.1.1" xref="S2.SS1.p1.3.m3.2.2.2.1.1.cmml"><mi id="S2.SS1.p1.3.m3.2.2.2.1.1.2" xref="S2.SS1.p1.3.m3.2.2.2.1.1.2.cmml">s</mi><mn id="S2.SS1.p1.3.m3.2.2.2.1.1.3" xref="S2.SS1.p1.3.m3.2.2.2.1.1.3.cmml">1</mn></msub><mo id="S2.SS1.p1.3.m3.2.2.2.1.3" stretchy="false" xref="S2.SS1.p1.3.m3.2.2.2.2.1.cmml">]</mo></mrow><mo id="S2.SS1.p1.3.m3.8.8.9a" xref="S2.SS1.p1.3.m3.8.8.9.cmml">⁢</mo><mrow id="S2.SS1.p1.3.m3.3.3.3.1" xref="S2.SS1.p1.3.m3.3.3.3.2.cmml"><mo id="S2.SS1.p1.3.m3.3.3.3.1.2" stretchy="false" xref="S2.SS1.p1.3.m3.3.3.3.2.1.cmml">[</mo><msub id="S2.SS1.p1.3.m3.3.3.3.1.1" xref="S2.SS1.p1.3.m3.3.3.3.1.1.cmml"><mi id="S2.SS1.p1.3.m3.3.3.3.1.1.2" xref="S2.SS1.p1.3.m3.3.3.3.1.1.2.cmml">y</mi><mn id="S2.SS1.p1.3.m3.3.3.3.1.1.3" xref="S2.SS1.p1.3.m3.3.3.3.1.1.3.cmml">1</mn></msub><mo id="S2.SS1.p1.3.m3.3.3.3.1.3" stretchy="false" xref="S2.SS1.p1.3.m3.3.3.3.2.1.cmml">]</mo></mrow><mo id="S2.SS1.p1.3.m3.8.8.9b" xref="S2.SS1.p1.3.m3.8.8.9.cmml">⁢</mo><mi id="S2.SS1.p1.3.m3.8.8.10" mathvariant="normal" xref="S2.SS1.p1.3.m3.8.8.10.cmml">…</mi><mo id="S2.SS1.p1.3.m3.8.8.9c" xref="S2.SS1.p1.3.m3.8.8.9.cmml">⁢</mo><mrow id="S2.SS1.p1.3.m3.4.4.4.1" xref="S2.SS1.p1.3.m3.4.4.4.2.cmml"><mo id="S2.SS1.p1.3.m3.4.4.4.1.2" stretchy="false" xref="S2.SS1.p1.3.m3.4.4.4.2.1.cmml">[</mo><msub id="S2.SS1.p1.3.m3.4.4.4.1.1" xref="S2.SS1.p1.3.m3.4.4.4.1.1.cmml"><mi id="S2.SS1.p1.3.m3.4.4.4.1.1.2" xref="S2.SS1.p1.3.m3.4.4.4.1.1.2.cmml">x</mi><mi id="S2.SS1.p1.3.m3.4.4.4.1.1.3" xref="S2.SS1.p1.3.m3.4.4.4.1.1.3.cmml">k</mi></msub><mo id="S2.SS1.p1.3.m3.4.4.4.1.3" stretchy="false" xref="S2.SS1.p1.3.m3.4.4.4.2.1.cmml">]</mo></mrow><mo id="S2.SS1.p1.3.m3.8.8.9d" xref="S2.SS1.p1.3.m3.8.8.9.cmml">⁢</mo><mrow id="S2.SS1.p1.3.m3.5.5.5.1" xref="S2.SS1.p1.3.m3.5.5.5.2.cmml"><mo id="S2.SS1.p1.3.m3.5.5.5.1.2" stretchy="false" xref="S2.SS1.p1.3.m3.5.5.5.2.1.cmml">[</mo><msub id="S2.SS1.p1.3.m3.5.5.5.1.1" xref="S2.SS1.p1.3.m3.5.5.5.1.1.cmml"><mi id="S2.SS1.p1.3.m3.5.5.5.1.1.2" xref="S2.SS1.p1.3.m3.5.5.5.1.1.2.cmml">s</mi><mi id="S2.SS1.p1.3.m3.5.5.5.1.1.3" xref="S2.SS1.p1.3.m3.5.5.5.1.1.3.cmml">k</mi></msub><mo id="S2.SS1.p1.3.m3.5.5.5.1.3" stretchy="false" xref="S2.SS1.p1.3.m3.5.5.5.2.1.cmml">]</mo></mrow><mo id="S2.SS1.p1.3.m3.8.8.9e" xref="S2.SS1.p1.3.m3.8.8.9.cmml">⁢</mo><mrow id="S2.SS1.p1.3.m3.6.6.6.1" xref="S2.SS1.p1.3.m3.6.6.6.2.cmml"><mo id="S2.SS1.p1.3.m3.6.6.6.1.2" stretchy="false" xref="S2.SS1.p1.3.m3.6.6.6.2.1.cmml">[</mo><msub id="S2.SS1.p1.3.m3.6.6.6.1.1" xref="S2.SS1.p1.3.m3.6.6.6.1.1.cmml"><mi id="S2.SS1.p1.3.m3.6.6.6.1.1.2" xref="S2.SS1.p1.3.m3.6.6.6.1.1.2.cmml">y</mi><mi id="S2.SS1.p1.3.m3.6.6.6.1.1.3" xref="S2.SS1.p1.3.m3.6.6.6.1.1.3.cmml">k</mi></msub><mo id="S2.SS1.p1.3.m3.6.6.6.1.3" stretchy="false" xref="S2.SS1.p1.3.m3.6.6.6.2.1.cmml">]</mo></mrow><mo id="S2.SS1.p1.3.m3.8.8.9f" xref="S2.SS1.p1.3.m3.8.8.9.cmml">⁢</mo><mrow id="S2.SS1.p1.3.m3.7.7.7.1" xref="S2.SS1.p1.3.m3.7.7.7.2.cmml"><mo id="S2.SS1.p1.3.m3.7.7.7.1.2" stretchy="false" xref="S2.SS1.p1.3.m3.7.7.7.2.1.cmml">[</mo><msub id="S2.SS1.p1.3.m3.7.7.7.1.1" xref="S2.SS1.p1.3.m3.7.7.7.1.1.cmml"><mi id="S2.SS1.p1.3.m3.7.7.7.1.1.2" xref="S2.SS1.p1.3.m3.7.7.7.1.1.2.cmml">x</mi><mi id="S2.SS1.p1.3.m3.7.7.7.1.1.3" xref="S2.SS1.p1.3.m3.7.7.7.1.1.3.cmml">q</mi></msub><mo id="S2.SS1.p1.3.m3.7.7.7.1.3" stretchy="false" xref="S2.SS1.p1.3.m3.7.7.7.2.1.cmml">]</mo></mrow><mo id="S2.SS1.p1.3.m3.8.8.9g" xref="S2.SS1.p1.3.m3.8.8.9.cmml">⁢</mo><mrow id="S2.SS1.p1.3.m3.8.8.8.1" xref="S2.SS1.p1.3.m3.8.8.8.2.cmml"><mo id="S2.SS1.p1.3.m3.8.8.8.1.2" stretchy="false" xref="S2.SS1.p1.3.m3.8.8.8.2.1.cmml">[</mo><msub id="S2.SS1.p1.3.m3.8.8.8.1.1" xref="S2.SS1.p1.3.m3.8.8.8.1.1.cmml"><mi id="S2.SS1.p1.3.m3.8.8.8.1.1.2" xref="S2.SS1.p1.3.m3.8.8.8.1.1.2.cmml">s</mi><mi id="S2.SS1.p1.3.m3.8.8.8.1.1.3" xref="S2.SS1.p1.3.m3.8.8.8.1.1.3.cmml">q</mi></msub><mo id="S2.SS1.p1.3.m3.8.8.8.1.3" stretchy="false" xref="S2.SS1.p1.3.m3.8.8.8.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.8b"><apply id="S2.SS1.p1.3.m3.8.8.cmml" xref="S2.SS1.p1.3.m3.8.8"><times id="S2.SS1.p1.3.m3.8.8.9.cmml" xref="S2.SS1.p1.3.m3.8.8.9"></times><apply id="S2.SS1.p1.3.m3.1.1.1.2.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1"><csymbol cd="latexml" id="S2.SS1.p1.3.m3.1.1.1.2.1.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.SS1.p1.3.m3.1.1.1.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.3.m3.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.1.2">𝑥</ci><cn id="S2.SS1.p1.3.m3.1.1.1.1.1.3.cmml" type="integer" xref="S2.SS1.p1.3.m3.1.1.1.1.1.3">1</cn></apply></apply><apply id="S2.SS1.p1.3.m3.2.2.2.2.cmml" xref="S2.SS1.p1.3.m3.2.2.2.1"><csymbol cd="latexml" id="S2.SS1.p1.3.m3.2.2.2.2.1.cmml" xref="S2.SS1.p1.3.m3.2.2.2.1.2">delimited-[]</csymbol><apply id="S2.SS1.p1.3.m3.2.2.2.1.1.cmml" xref="S2.SS1.p1.3.m3.2.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.2.2.2.1.1.1.cmml" xref="S2.SS1.p1.3.m3.2.2.2.1.1">subscript</csymbol><ci id="S2.SS1.p1.3.m3.2.2.2.1.1.2.cmml" xref="S2.SS1.p1.3.m3.2.2.2.1.1.2">𝑠</ci><cn id="S2.SS1.p1.3.m3.2.2.2.1.1.3.cmml" type="integer" xref="S2.SS1.p1.3.m3.2.2.2.1.1.3">1</cn></apply></apply><apply id="S2.SS1.p1.3.m3.3.3.3.2.cmml" xref="S2.SS1.p1.3.m3.3.3.3.1"><csymbol cd="latexml" id="S2.SS1.p1.3.m3.3.3.3.2.1.cmml" xref="S2.SS1.p1.3.m3.3.3.3.1.2">delimited-[]</csymbol><apply id="S2.SS1.p1.3.m3.3.3.3.1.1.cmml" xref="S2.SS1.p1.3.m3.3.3.3.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.3.3.3.1.1.1.cmml" xref="S2.SS1.p1.3.m3.3.3.3.1.1">subscript</csymbol><ci id="S2.SS1.p1.3.m3.3.3.3.1.1.2.cmml" xref="S2.SS1.p1.3.m3.3.3.3.1.1.2">𝑦</ci><cn id="S2.SS1.p1.3.m3.3.3.3.1.1.3.cmml" type="integer" xref="S2.SS1.p1.3.m3.3.3.3.1.1.3">1</cn></apply></apply><ci id="S2.SS1.p1.3.m3.8.8.10.cmml" xref="S2.SS1.p1.3.m3.8.8.10">…</ci><apply id="S2.SS1.p1.3.m3.4.4.4.2.cmml" xref="S2.SS1.p1.3.m3.4.4.4.1"><csymbol cd="latexml" id="S2.SS1.p1.3.m3.4.4.4.2.1.cmml" xref="S2.SS1.p1.3.m3.4.4.4.1.2">delimited-[]</csymbol><apply id="S2.SS1.p1.3.m3.4.4.4.1.1.cmml" xref="S2.SS1.p1.3.m3.4.4.4.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.4.4.4.1.1.1.cmml" xref="S2.SS1.p1.3.m3.4.4.4.1.1">subscript</csymbol><ci id="S2.SS1.p1.3.m3.4.4.4.1.1.2.cmml" xref="S2.SS1.p1.3.m3.4.4.4.1.1.2">𝑥</ci><ci id="S2.SS1.p1.3.m3.4.4.4.1.1.3.cmml" xref="S2.SS1.p1.3.m3.4.4.4.1.1.3">𝑘</ci></apply></apply><apply id="S2.SS1.p1.3.m3.5.5.5.2.cmml" xref="S2.SS1.p1.3.m3.5.5.5.1"><csymbol cd="latexml" id="S2.SS1.p1.3.m3.5.5.5.2.1.cmml" xref="S2.SS1.p1.3.m3.5.5.5.1.2">delimited-[]</csymbol><apply id="S2.SS1.p1.3.m3.5.5.5.1.1.cmml" xref="S2.SS1.p1.3.m3.5.5.5.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.5.5.5.1.1.1.cmml" xref="S2.SS1.p1.3.m3.5.5.5.1.1">subscript</csymbol><ci id="S2.SS1.p1.3.m3.5.5.5.1.1.2.cmml" xref="S2.SS1.p1.3.m3.5.5.5.1.1.2">𝑠</ci><ci id="S2.SS1.p1.3.m3.5.5.5.1.1.3.cmml" xref="S2.SS1.p1.3.m3.5.5.5.1.1.3">𝑘</ci></apply></apply><apply id="S2.SS1.p1.3.m3.6.6.6.2.cmml" xref="S2.SS1.p1.3.m3.6.6.6.1"><csymbol cd="latexml" id="S2.SS1.p1.3.m3.6.6.6.2.1.cmml" xref="S2.SS1.p1.3.m3.6.6.6.1.2">delimited-[]</csymbol><apply id="S2.SS1.p1.3.m3.6.6.6.1.1.cmml" xref="S2.SS1.p1.3.m3.6.6.6.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.6.6.6.1.1.1.cmml" xref="S2.SS1.p1.3.m3.6.6.6.1.1">subscript</csymbol><ci id="S2.SS1.p1.3.m3.6.6.6.1.1.2.cmml" xref="S2.SS1.p1.3.m3.6.6.6.1.1.2">𝑦</ci><ci id="S2.SS1.p1.3.m3.6.6.6.1.1.3.cmml" xref="S2.SS1.p1.3.m3.6.6.6.1.1.3">𝑘</ci></apply></apply><apply id="S2.SS1.p1.3.m3.7.7.7.2.cmml" xref="S2.SS1.p1.3.m3.7.7.7.1"><csymbol cd="latexml" id="S2.SS1.p1.3.m3.7.7.7.2.1.cmml" xref="S2.SS1.p1.3.m3.7.7.7.1.2">delimited-[]</csymbol><apply id="S2.SS1.p1.3.m3.7.7.7.1.1.cmml" xref="S2.SS1.p1.3.m3.7.7.7.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.7.7.7.1.1.1.cmml" xref="S2.SS1.p1.3.m3.7.7.7.1.1">subscript</csymbol><ci id="S2.SS1.p1.3.m3.7.7.7.1.1.2.cmml" xref="S2.SS1.p1.3.m3.7.7.7.1.1.2">𝑥</ci><ci id="S2.SS1.p1.3.m3.7.7.7.1.1.3.cmml" xref="S2.SS1.p1.3.m3.7.7.7.1.1.3">𝑞</ci></apply></apply><apply id="S2.SS1.p1.3.m3.8.8.8.2.cmml" xref="S2.SS1.p1.3.m3.8.8.8.1"><csymbol cd="latexml" id="S2.SS1.p1.3.m3.8.8.8.2.1.cmml" xref="S2.SS1.p1.3.m3.8.8.8.1.2">delimited-[]</csymbol><apply id="S2.SS1.p1.3.m3.8.8.8.1.1.cmml" xref="S2.SS1.p1.3.m3.8.8.8.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.8.8.8.1.1.1.cmml" xref="S2.SS1.p1.3.m3.8.8.8.1.1">subscript</csymbol><ci id="S2.SS1.p1.3.m3.8.8.8.1.1.2.cmml" xref="S2.SS1.p1.3.m3.8.8.8.1.1.2">𝑠</ci><ci id="S2.SS1.p1.3.m3.8.8.8.1.1.3.cmml" xref="S2.SS1.p1.3.m3.8.8.8.1.1.3">𝑞</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.8c">[x_{1}][s_{1}][y_{1}]\dots[x_{k}][s_{k}][y_{k}][x_{q}][s_{q}]</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.3.m3.8d">[ italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ] [ italic_s start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ] [ italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ] … [ italic_x start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ] [ italic_s start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ] [ italic_y start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ] [ italic_x start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ] [ italic_s start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ]</annotation></semantics></math>, with some structural connectors (e.g. “Label: ”) including forerunner token <math alttext="s_{i}" class="ltx_Math" display="inline" id="S2.SS1.p1.4.m4.1"><semantics id="S2.SS1.p1.4.m4.1a"><msub id="S2.SS1.p1.4.m4.1.1" xref="S2.SS1.p1.4.m4.1.1.cmml"><mi id="S2.SS1.p1.4.m4.1.1.2" xref="S2.SS1.p1.4.m4.1.1.2.cmml">s</mi><mi id="S2.SS1.p1.4.m4.1.1.3" xref="S2.SS1.p1.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.1b"><apply id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.1.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S2.SS1.p1.4.m4.1.1.2.cmml" xref="S2.SS1.p1.4.m4.1.1.2">𝑠</ci><ci id="S2.SS1.p1.4.m4.1.1.3.cmml" xref="S2.SS1.p1.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.1c">s_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.4.m4.1d">italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> (e.g. “: ”), as shown in Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">1</span></a>. LMs receive such prompts and return the next token distribution, where the label token with the highest likelihood is chosen as the prediction. Explaining the principle of ICL is an unresolved research topic, although there have been some efforts on <span class="ltx_text ltx_font_bold" id="S2.SS1.p1.4.2">the relationship between ICL capacity and pre-training data</span>&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Li &amp; Qiu, <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib23" title="">2023</a>; Singh et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib37" title="">2024b</a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib36" title="">a</a>; Gu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib14" title="">2023</a>; Han et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib17" title="">2023b</a>; Chan et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib6" title="">2022</a>)</cite>, the <span class="ltx_text ltx_font_bold" id="S2.SS1.p1.4.3">feature attribution of input prompt</span>&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Min et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib29" title="">2022</a>; Yoo et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib42" title="">2022</a>; Pan, <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib32" title="">2023</a>; Kossen et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib22" title="">2024</a>)</cite>, and <span class="ltx_text ltx_font_bold" id="S2.SS1.p1.4.4">reduction to simpler algorithms</span>&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Zhang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib44" title="">2023</a>; Dai et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib10" title="">2023</a>; Xie et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib41" title="">2021</a>; Han et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib16" title="">2023a</a>)</cite>. However, a comprehensive explanation of real-world LMs is needed to capture the operating dynamics of ICL.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS1.p2">
<p class="ltx_p" id="S2.SS1.p2.5"><span class="ltx_text ltx_font_bold" id="S2.SS1.p2.5.1">Induction Circuit.</span> Introduced by&nbsp;<cite class="ltx_cite ltx_citemacro_cite">Elhage et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib12" title="">2021</a>)</cite>, an induction circuit is a pair of two cooperating attention heads from two transformer layers, where the “previous token head” writes information about the previous token to each token, and the “induction head” uses this information to identify a token that should follow each token.
Such a function is implemented by two atomic operations: (1) copy the representation of the previous token <math alttext="[\mathrm{A}]" class="ltx_Math" display="inline" id="S2.SS1.p2.1.m1.1"><semantics id="S2.SS1.p2.1.m1.1a"><mrow id="S2.SS1.p2.1.m1.1.2.2" xref="S2.SS1.p2.1.m1.1.2.1.cmml"><mo id="S2.SS1.p2.1.m1.1.2.2.1" stretchy="false" xref="S2.SS1.p2.1.m1.1.2.1.1.cmml">[</mo><mi id="S2.SS1.p2.1.m1.1.1" mathvariant="normal" xref="S2.SS1.p2.1.m1.1.1.cmml">A</mi><mo id="S2.SS1.p2.1.m1.1.2.2.2" stretchy="false" xref="S2.SS1.p2.1.m1.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.1.m1.1b"><apply id="S2.SS1.p2.1.m1.1.2.1.cmml" xref="S2.SS1.p2.1.m1.1.2.2"><csymbol cd="latexml" id="S2.SS1.p2.1.m1.1.2.1.1.cmml" xref="S2.SS1.p2.1.m1.1.2.2.1">delimited-[]</csymbol><ci id="S2.SS1.p2.1.m1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1">A</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.1.m1.1c">[\mathrm{A}]</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.1.m1.1d">[ roman_A ]</annotation></semantics></math> to the next token <math alttext="[\mathrm{B}]" class="ltx_Math" display="inline" id="S2.SS1.p2.2.m2.1"><semantics id="S2.SS1.p2.2.m2.1a"><mrow id="S2.SS1.p2.2.m2.1.2.2" xref="S2.SS1.p2.2.m2.1.2.1.cmml"><mo id="S2.SS1.p2.2.m2.1.2.2.1" stretchy="false" xref="S2.SS1.p2.2.m2.1.2.1.1.cmml">[</mo><mi id="S2.SS1.p2.2.m2.1.1" mathvariant="normal" xref="S2.SS1.p2.2.m2.1.1.cmml">B</mi><mo id="S2.SS1.p2.2.m2.1.2.2.2" stretchy="false" xref="S2.SS1.p2.2.m2.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.2.m2.1b"><apply id="S2.SS1.p2.2.m2.1.2.1.cmml" xref="S2.SS1.p2.2.m2.1.2.2"><csymbol cd="latexml" id="S2.SS1.p2.2.m2.1.2.1.1.cmml" xref="S2.SS1.p2.2.m2.1.2.2.1">delimited-[]</csymbol><ci id="S2.SS1.p2.2.m2.1.1.cmml" xref="S2.SS1.p2.2.m2.1.1">B</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.2.m2.1c">[\mathrm{B}]</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.2.m2.1d">[ roman_B ]</annotation></semantics></math>, and (2) retrieve and copy similar representations on <math alttext="[\mathrm{A}]" class="ltx_Math" display="inline" id="S2.SS1.p2.3.m3.1"><semantics id="S2.SS1.p2.3.m3.1a"><mrow id="S2.SS1.p2.3.m3.1.2.2" xref="S2.SS1.p2.3.m3.1.2.1.cmml"><mo id="S2.SS1.p2.3.m3.1.2.2.1" stretchy="false" xref="S2.SS1.p2.3.m3.1.2.1.1.cmml">[</mo><mi id="S2.SS1.p2.3.m3.1.1" mathvariant="normal" xref="S2.SS1.p2.3.m3.1.1.cmml">A</mi><mo id="S2.SS1.p2.3.m3.1.2.2.2" stretchy="false" xref="S2.SS1.p2.3.m3.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.3.m3.1b"><apply id="S2.SS1.p2.3.m3.1.2.1.cmml" xref="S2.SS1.p2.3.m3.1.2.2"><csymbol cd="latexml" id="S2.SS1.p2.3.m3.1.2.1.1.cmml" xref="S2.SS1.p2.3.m3.1.2.2.1">delimited-[]</csymbol><ci id="S2.SS1.p2.3.m3.1.1.cmml" xref="S2.SS1.p2.3.m3.1.1">A</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.3.m3.1c">[\mathrm{A}]</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.3.m3.1d">[ roman_A ]</annotation></semantics></math> to the current token <math alttext="[\mathrm{A}^{\prime}]" class="ltx_Math" display="inline" id="S2.SS1.p2.4.m4.1"><semantics id="S2.SS1.p2.4.m4.1a"><mrow id="S2.SS1.p2.4.m4.1.1.1" xref="S2.SS1.p2.4.m4.1.1.2.cmml"><mo id="S2.SS1.p2.4.m4.1.1.1.2" stretchy="false" xref="S2.SS1.p2.4.m4.1.1.2.1.cmml">[</mo><msup id="S2.SS1.p2.4.m4.1.1.1.1" xref="S2.SS1.p2.4.m4.1.1.1.1.cmml"><mi id="S2.SS1.p2.4.m4.1.1.1.1.2" mathvariant="normal" xref="S2.SS1.p2.4.m4.1.1.1.1.2.cmml">A</mi><mo id="S2.SS1.p2.4.m4.1.1.1.1.3" xref="S2.SS1.p2.4.m4.1.1.1.1.3.cmml">′</mo></msup><mo id="S2.SS1.p2.4.m4.1.1.1.3" stretchy="false" xref="S2.SS1.p2.4.m4.1.1.2.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.4.m4.1b"><apply id="S2.SS1.p2.4.m4.1.1.2.cmml" xref="S2.SS1.p2.4.m4.1.1.1"><csymbol cd="latexml" id="S2.SS1.p2.4.m4.1.1.2.1.cmml" xref="S2.SS1.p2.4.m4.1.1.1.2">delimited-[]</csymbol><apply id="S2.SS1.p2.4.m4.1.1.1.1.cmml" xref="S2.SS1.p2.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.4.m4.1.1.1.1.1.cmml" xref="S2.SS1.p2.4.m4.1.1.1.1">superscript</csymbol><ci id="S2.SS1.p2.4.m4.1.1.1.1.2.cmml" xref="S2.SS1.p2.4.m4.1.1.1.1.2">A</ci><ci id="S2.SS1.p2.4.m4.1.1.1.1.3.cmml" xref="S2.SS1.p2.4.m4.1.1.1.1.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.4.m4.1c">[\mathrm{A}^{\prime}]</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.4.m4.1d">[ roman_A start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ]</annotation></semantics></math>.
Concisely, it performs inference in the form of <math alttext="[\mathrm{A}][\mathrm{B}]\dots[\mathrm{A}^{\prime}]\Rightarrow[\mathrm{B}]" class="ltx_Math" display="inline" id="S2.SS1.p2.5.m5.4"><semantics id="S2.SS1.p2.5.m5.4a"><mrow id="S2.SS1.p2.5.m5.4.4" xref="S2.SS1.p2.5.m5.4.4.cmml"><mrow id="S2.SS1.p2.5.m5.4.4.1" xref="S2.SS1.p2.5.m5.4.4.1.cmml"><mrow id="S2.SS1.p2.5.m5.4.4.1.3.2" xref="S2.SS1.p2.5.m5.4.4.1.3.1.cmml"><mo id="S2.SS1.p2.5.m5.4.4.1.3.2.1" stretchy="false" xref="S2.SS1.p2.5.m5.4.4.1.3.1.1.cmml">[</mo><mi id="S2.SS1.p2.5.m5.1.1" mathvariant="normal" xref="S2.SS1.p2.5.m5.1.1.cmml">A</mi><mo id="S2.SS1.p2.5.m5.4.4.1.3.2.2" stretchy="false" xref="S2.SS1.p2.5.m5.4.4.1.3.1.1.cmml">]</mo></mrow><mo id="S2.SS1.p2.5.m5.4.4.1.2" xref="S2.SS1.p2.5.m5.4.4.1.2.cmml">⁢</mo><mrow id="S2.SS1.p2.5.m5.4.4.1.4.2" xref="S2.SS1.p2.5.m5.4.4.1.4.1.cmml"><mo id="S2.SS1.p2.5.m5.4.4.1.4.2.1" stretchy="false" xref="S2.SS1.p2.5.m5.4.4.1.4.1.1.cmml">[</mo><mi id="S2.SS1.p2.5.m5.2.2" mathvariant="normal" xref="S2.SS1.p2.5.m5.2.2.cmml">B</mi><mo id="S2.SS1.p2.5.m5.4.4.1.4.2.2" stretchy="false" xref="S2.SS1.p2.5.m5.4.4.1.4.1.1.cmml">]</mo></mrow><mo id="S2.SS1.p2.5.m5.4.4.1.2a" xref="S2.SS1.p2.5.m5.4.4.1.2.cmml">⁢</mo><mi id="S2.SS1.p2.5.m5.4.4.1.5" mathvariant="normal" xref="S2.SS1.p2.5.m5.4.4.1.5.cmml">…</mi><mo id="S2.SS1.p2.5.m5.4.4.1.2b" xref="S2.SS1.p2.5.m5.4.4.1.2.cmml">⁢</mo><mrow id="S2.SS1.p2.5.m5.4.4.1.1.1" xref="S2.SS1.p2.5.m5.4.4.1.1.2.cmml"><mo id="S2.SS1.p2.5.m5.4.4.1.1.1.2" stretchy="false" xref="S2.SS1.p2.5.m5.4.4.1.1.2.1.cmml">[</mo><msup id="S2.SS1.p2.5.m5.4.4.1.1.1.1" xref="S2.SS1.p2.5.m5.4.4.1.1.1.1.cmml"><mi id="S2.SS1.p2.5.m5.4.4.1.1.1.1.2" mathvariant="normal" xref="S2.SS1.p2.5.m5.4.4.1.1.1.1.2.cmml">A</mi><mo id="S2.SS1.p2.5.m5.4.4.1.1.1.1.3" xref="S2.SS1.p2.5.m5.4.4.1.1.1.1.3.cmml">′</mo></msup><mo id="S2.SS1.p2.5.m5.4.4.1.1.1.3" stretchy="false" xref="S2.SS1.p2.5.m5.4.4.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S2.SS1.p2.5.m5.4.4.2" stretchy="false" xref="S2.SS1.p2.5.m5.4.4.2.cmml">⇒</mo><mrow id="S2.SS1.p2.5.m5.4.4.3.2" xref="S2.SS1.p2.5.m5.4.4.3.1.cmml"><mo id="S2.SS1.p2.5.m5.4.4.3.2.1" stretchy="false" xref="S2.SS1.p2.5.m5.4.4.3.1.1.cmml">[</mo><mi id="S2.SS1.p2.5.m5.3.3" mathvariant="normal" xref="S2.SS1.p2.5.m5.3.3.cmml">B</mi><mo id="S2.SS1.p2.5.m5.4.4.3.2.2" stretchy="false" xref="S2.SS1.p2.5.m5.4.4.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.5.m5.4b"><apply id="S2.SS1.p2.5.m5.4.4.cmml" xref="S2.SS1.p2.5.m5.4.4"><ci id="S2.SS1.p2.5.m5.4.4.2.cmml" xref="S2.SS1.p2.5.m5.4.4.2">⇒</ci><apply id="S2.SS1.p2.5.m5.4.4.1.cmml" xref="S2.SS1.p2.5.m5.4.4.1"><times id="S2.SS1.p2.5.m5.4.4.1.2.cmml" xref="S2.SS1.p2.5.m5.4.4.1.2"></times><apply id="S2.SS1.p2.5.m5.4.4.1.3.1.cmml" xref="S2.SS1.p2.5.m5.4.4.1.3.2"><csymbol cd="latexml" id="S2.SS1.p2.5.m5.4.4.1.3.1.1.cmml" xref="S2.SS1.p2.5.m5.4.4.1.3.2.1">delimited-[]</csymbol><ci id="S2.SS1.p2.5.m5.1.1.cmml" xref="S2.SS1.p2.5.m5.1.1">A</ci></apply><apply id="S2.SS1.p2.5.m5.4.4.1.4.1.cmml" xref="S2.SS1.p2.5.m5.4.4.1.4.2"><csymbol cd="latexml" id="S2.SS1.p2.5.m5.4.4.1.4.1.1.cmml" xref="S2.SS1.p2.5.m5.4.4.1.4.2.1">delimited-[]</csymbol><ci id="S2.SS1.p2.5.m5.2.2.cmml" xref="S2.SS1.p2.5.m5.2.2">B</ci></apply><ci id="S2.SS1.p2.5.m5.4.4.1.5.cmml" xref="S2.SS1.p2.5.m5.4.4.1.5">…</ci><apply id="S2.SS1.p2.5.m5.4.4.1.1.2.cmml" xref="S2.SS1.p2.5.m5.4.4.1.1.1"><csymbol cd="latexml" id="S2.SS1.p2.5.m5.4.4.1.1.2.1.cmml" xref="S2.SS1.p2.5.m5.4.4.1.1.1.2">delimited-[]</csymbol><apply id="S2.SS1.p2.5.m5.4.4.1.1.1.1.cmml" xref="S2.SS1.p2.5.m5.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.5.m5.4.4.1.1.1.1.1.cmml" xref="S2.SS1.p2.5.m5.4.4.1.1.1.1">superscript</csymbol><ci id="S2.SS1.p2.5.m5.4.4.1.1.1.1.2.cmml" xref="S2.SS1.p2.5.m5.4.4.1.1.1.1.2">A</ci><ci id="S2.SS1.p2.5.m5.4.4.1.1.1.1.3.cmml" xref="S2.SS1.p2.5.m5.4.4.1.1.1.1.3">′</ci></apply></apply></apply><apply id="S2.SS1.p2.5.m5.4.4.3.1.cmml" xref="S2.SS1.p2.5.m5.4.4.3.2"><csymbol cd="latexml" id="S2.SS1.p2.5.m5.4.4.3.1.1.cmml" xref="S2.SS1.p2.5.m5.4.4.3.2.1">delimited-[]</csymbol><ci id="S2.SS1.p2.5.m5.3.3.cmml" xref="S2.SS1.p2.5.m5.3.3">B</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.5.m5.4c">[\mathrm{A}][\mathrm{B}]\dots[\mathrm{A}^{\prime}]\Rightarrow[\mathrm{B}]</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.5.m5.4d">[ roman_A ] [ roman_B ] … [ roman_A start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ] ⇒ [ roman_B ]</annotation></semantics></math>, which is similar to ICL-styled data. Therefore, this circuit has been widely used to explain the inference dynamics of ICL&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Wang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib39" title="">2023</a>)</cite> and the emergence of ICL during pre-training&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Olsson et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib31" title="">2022</a>; Reddy, <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib35" title="">2024</a>; Singh et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib37" title="">2024b</a>)</cite>. Despite their valuable insights, their experiments rely on a synthetic setting: using simplified models and well-embedded (linearly separable) inputs, which differs from the practical ICL scenario using real-world LMs with many layers and complicated inputs. We bridge the gap between the synthetic and real-world settings, providing more detailed explanations for the inference dynamics of ICL based on real-world LLMs.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Experiment Settings</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1"><span class="ltx_text ltx_font_bold" id="S2.SS2.p1.1.1">Models.</span> We mainly conduct experiments on 4 modern LMs: Llama 3 (8B, 70B)&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(AI@Meta, <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib2" title="">2024</a>)</cite>, and Falcon (7B, 40B)&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Almazrouei et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib3" title="">2023</a>)</cite>. Unless specified, we report the results on Llama 3 70B, since its deep and narrow structure (80 layers, 64 heads) makes it easier to show hierarchical inference dynamics (discussed in&nbsp;§<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S5.SS2" title="5.2 Bypass Mechanism ‣ 5 Putting Things Together ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">5.2</span></a>). The results of other models can be found in Appendix&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A6.SS2" title="F.2 Other LMs’ Experiment Results ‣ Appendix F Augmentated Experiment Results ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">F.2</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS2.p2">
<p class="ltx_p" id="S2.SS2.p2.1"><span class="ltx_text ltx_font_bold" id="S2.SS2.p2.1.1">Datasets.</span> We build ICL-formed test inputs from 6 sentence classification datasets: SST-2&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Socher et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib38" title="">2013</a>)</cite>, MR&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Pang &amp; Lee, <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib33" title="">2005</a>)</cite>, Financial Phrasebank&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Malo et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib28" title="">2014</a>)</cite>, SST-5&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Socher et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib38" title="">2013</a>)</cite>, TREC&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Li &amp; Roth, <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib24" title="">2002</a>; Hovy et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib18" title="">2001</a>)</cite>, AGNews&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Zhang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib45" title="">2015</a>)</cite>specified, we report the average results on these datasets.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS2.p3">
<p class="ltx_p" id="S2.SS2.p3.2"><span class="ltx_text ltx_font_bold" id="S2.SS2.p3.2.1">Others.</span> Unless specified, we use <math alttext="k=4" class="ltx_Math" display="inline" id="S2.SS2.p3.1.m1.1"><semantics id="S2.SS2.p3.1.m1.1a"><mrow id="S2.SS2.p3.1.m1.1.1" xref="S2.SS2.p3.1.m1.1.1.cmml"><mi id="S2.SS2.p3.1.m1.1.1.2" xref="S2.SS2.p3.1.m1.1.1.2.cmml">k</mi><mo id="S2.SS2.p3.1.m1.1.1.1" xref="S2.SS2.p3.1.m1.1.1.1.cmml">=</mo><mn id="S2.SS2.p3.1.m1.1.1.3" xref="S2.SS2.p3.1.m1.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.1.m1.1b"><apply id="S2.SS2.p3.1.m1.1.1.cmml" xref="S2.SS2.p3.1.m1.1.1"><eq id="S2.SS2.p3.1.m1.1.1.1.cmml" xref="S2.SS2.p3.1.m1.1.1.1"></eq><ci id="S2.SS2.p3.1.m1.1.1.2.cmml" xref="S2.SS2.p3.1.m1.1.1.2">𝑘</ci><cn id="S2.SS2.p3.1.m1.1.1.3.cmml" type="integer" xref="S2.SS2.p3.1.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.1.m1.1c">k=4</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p3.1.m1.1d">italic_k = 4</annotation></semantics></math> demonstrations in ICL inputs. For each dataset, we randomly sample <math alttext="n=512" class="ltx_Math" display="inline" id="S2.SS2.p3.2.m2.1"><semantics id="S2.SS2.p3.2.m2.1a"><mrow id="S2.SS2.p3.2.m2.1.1" xref="S2.SS2.p3.2.m2.1.1.cmml"><mi id="S2.SS2.p3.2.m2.1.1.2" xref="S2.SS2.p3.2.m2.1.1.2.cmml">n</mi><mo id="S2.SS2.p3.2.m2.1.1.1" xref="S2.SS2.p3.2.m2.1.1.1.cmml">=</mo><mn id="S2.SS2.p3.2.m2.1.1.3" xref="S2.SS2.p3.2.m2.1.1.3.cmml">512</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.2.m2.1b"><apply id="S2.SS2.p3.2.m2.1.1.cmml" xref="S2.SS2.p3.2.m2.1.1"><eq id="S2.SS2.p3.2.m2.1.1.1.cmml" xref="S2.SS2.p3.2.m2.1.1.1"></eq><ci id="S2.SS2.p3.2.m2.1.1.2.cmml" xref="S2.SS2.p3.2.m2.1.1.2">𝑛</ci><cn id="S2.SS2.p3.2.m2.1.1.3.cmml" type="integer" xref="S2.SS2.p3.2.m2.1.1.3">512</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.2.m2.1c">n=512</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p3.2.m2.1d">italic_n = 512</annotation></semantics></math> test data and assign one order-fixed demonstration sequence for each test sample. About the prompt templates, etc., please refer to Appendix&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A1.SS1" title="A.1 Detailed Overall Experimental Settings ‣ Appendix A Experiment Details and Settings ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">A.1</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Step 1, Summarize: Linear Representations in Hidden States</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">This section mainly confirms that LMs construct task-relevant and linearly separable semantic representations for every input text (demonstrations and queries) in the hidden states. Such linear representations are an important foundation for explaining the dynamics of ICL based on induction head, since attention-based feature retrieval, a key mechanism of induction head, can be easily done on linear representations. Current successful studies on simplified models and inputs&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Chan et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib6" title="">2022</a>; Reddy, <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib35" title="">2024</a>; Singh et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib37" title="">2024b</a>)</cite> also assume the existence of such linear representations. Moreover, we confirm some interesting properties of the input text representations: (1) It is based on the capacity in the model weights and can be enhanced by demonstrations in context (Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S3.F2" title="Figure 2 ‣ 3.2 Text Summarization is Linear and Task-Relevant but Position-biased ‣ 3 Step 1, Summarize: Linear Representations in Hidden States ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">2</span></a> (Middle, Right)). (2) The similarity of representations is biased towards the encoding target’s position.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>LLMs Summarize Input Text on Forerunner Tokens in Hidden States</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.5">We first study the existence of input text encoding in hidden states and then explain their linear separability and task relevance in&nbsp;§<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S3.SS2" title="3.2 Text Summarization is Linear and Task-Relevant but Position-biased ‣ 3 Step 1, Summarize: Linear Representations in Hidden States ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">3.2</span></a>. For each text-label pair <math alttext="(x_{t},y_{t})" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.2"><semantics id="S3.SS1.p1.1.m1.2a"><mrow id="S3.SS1.p1.1.m1.2.2.2" xref="S3.SS1.p1.1.m1.2.2.3.cmml"><mo id="S3.SS1.p1.1.m1.2.2.2.3" stretchy="false" xref="S3.SS1.p1.1.m1.2.2.3.cmml">(</mo><msub id="S3.SS1.p1.1.m1.1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.1.1.2.cmml">x</mi><mi id="S3.SS1.p1.1.m1.1.1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS1.p1.1.m1.2.2.2.4" xref="S3.SS1.p1.1.m1.2.2.3.cmml">,</mo><msub id="S3.SS1.p1.1.m1.2.2.2.2" xref="S3.SS1.p1.1.m1.2.2.2.2.cmml"><mi id="S3.SS1.p1.1.m1.2.2.2.2.2" xref="S3.SS1.p1.1.m1.2.2.2.2.2.cmml">y</mi><mi id="S3.SS1.p1.1.m1.2.2.2.2.3" xref="S3.SS1.p1.1.m1.2.2.2.2.3.cmml">t</mi></msub><mo id="S3.SS1.p1.1.m1.2.2.2.5" stretchy="false" xref="S3.SS1.p1.1.m1.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.2b"><interval closure="open" id="S3.SS1.p1.1.m1.2.2.3.cmml" xref="S3.SS1.p1.1.m1.2.2.2"><apply id="S3.SS1.p1.1.m1.1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.2">𝑥</ci><ci id="S3.SS1.p1.1.m1.1.1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.SS1.p1.1.m1.2.2.2.2.cmml" xref="S3.SS1.p1.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.2.2.2.2.1.cmml" xref="S3.SS1.p1.1.m1.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.1.m1.2.2.2.2.2.cmml" xref="S3.SS1.p1.1.m1.2.2.2.2.2">𝑦</ci><ci id="S3.SS1.p1.1.m1.2.2.2.2.3.cmml" xref="S3.SS1.p1.1.m1.2.2.2.2.3">𝑡</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.2c">(x_{t},y_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.2d">( italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> (<span class="ltx_text ltx_font_italic" id="S3.SS1.p1.5.1">encoding target</span>) sampled from the datasets, we prepend them with <math alttext="k" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><mi id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">italic_k</annotation></semantics></math> demonstrations, resulting in ICL-style inputs <math alttext="[x_{1}][s_{1}][y_{1}]\dots[x_{k}][s_{k}][y_{k}][x_{t}][s_{t}][y_{t}]" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.9"><semantics id="S3.SS1.p1.3.m3.9a"><mrow id="S3.SS1.p1.3.m3.9.9" xref="S3.SS1.p1.3.m3.9.9.cmml"><mrow id="S3.SS1.p1.3.m3.1.1.1.1" xref="S3.SS1.p1.3.m3.1.1.1.2.cmml"><mo id="S3.SS1.p1.3.m3.1.1.1.1.2" stretchy="false" xref="S3.SS1.p1.3.m3.1.1.1.2.1.cmml">[</mo><msub id="S3.SS1.p1.3.m3.1.1.1.1.1" xref="S3.SS1.p1.3.m3.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.3.m3.1.1.1.1.1.2" xref="S3.SS1.p1.3.m3.1.1.1.1.1.2.cmml">x</mi><mn id="S3.SS1.p1.3.m3.1.1.1.1.1.3" xref="S3.SS1.p1.3.m3.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.3.m3.1.1.1.1.3" stretchy="false" xref="S3.SS1.p1.3.m3.1.1.1.2.1.cmml">]</mo></mrow><mo id="S3.SS1.p1.3.m3.9.9.10" xref="S3.SS1.p1.3.m3.9.9.10.cmml">⁢</mo><mrow id="S3.SS1.p1.3.m3.2.2.2.1" xref="S3.SS1.p1.3.m3.2.2.2.2.cmml"><mo id="S3.SS1.p1.3.m3.2.2.2.1.2" stretchy="false" xref="S3.SS1.p1.3.m3.2.2.2.2.1.cmml">[</mo><msub id="S3.SS1.p1.3.m3.2.2.2.1.1" xref="S3.SS1.p1.3.m3.2.2.2.1.1.cmml"><mi id="S3.SS1.p1.3.m3.2.2.2.1.1.2" xref="S3.SS1.p1.3.m3.2.2.2.1.1.2.cmml">s</mi><mn id="S3.SS1.p1.3.m3.2.2.2.1.1.3" xref="S3.SS1.p1.3.m3.2.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.3.m3.2.2.2.1.3" stretchy="false" xref="S3.SS1.p1.3.m3.2.2.2.2.1.cmml">]</mo></mrow><mo id="S3.SS1.p1.3.m3.9.9.10a" xref="S3.SS1.p1.3.m3.9.9.10.cmml">⁢</mo><mrow id="S3.SS1.p1.3.m3.3.3.3.1" xref="S3.SS1.p1.3.m3.3.3.3.2.cmml"><mo id="S3.SS1.p1.3.m3.3.3.3.1.2" stretchy="false" xref="S3.SS1.p1.3.m3.3.3.3.2.1.cmml">[</mo><msub id="S3.SS1.p1.3.m3.3.3.3.1.1" xref="S3.SS1.p1.3.m3.3.3.3.1.1.cmml"><mi id="S3.SS1.p1.3.m3.3.3.3.1.1.2" xref="S3.SS1.p1.3.m3.3.3.3.1.1.2.cmml">y</mi><mn id="S3.SS1.p1.3.m3.3.3.3.1.1.3" xref="S3.SS1.p1.3.m3.3.3.3.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.3.m3.3.3.3.1.3" stretchy="false" xref="S3.SS1.p1.3.m3.3.3.3.2.1.cmml">]</mo></mrow><mo id="S3.SS1.p1.3.m3.9.9.10b" xref="S3.SS1.p1.3.m3.9.9.10.cmml">⁢</mo><mi id="S3.SS1.p1.3.m3.9.9.11" mathvariant="normal" xref="S3.SS1.p1.3.m3.9.9.11.cmml">…</mi><mo id="S3.SS1.p1.3.m3.9.9.10c" xref="S3.SS1.p1.3.m3.9.9.10.cmml">⁢</mo><mrow id="S3.SS1.p1.3.m3.4.4.4.1" xref="S3.SS1.p1.3.m3.4.4.4.2.cmml"><mo id="S3.SS1.p1.3.m3.4.4.4.1.2" stretchy="false" xref="S3.SS1.p1.3.m3.4.4.4.2.1.cmml">[</mo><msub id="S3.SS1.p1.3.m3.4.4.4.1.1" xref="S3.SS1.p1.3.m3.4.4.4.1.1.cmml"><mi id="S3.SS1.p1.3.m3.4.4.4.1.1.2" xref="S3.SS1.p1.3.m3.4.4.4.1.1.2.cmml">x</mi><mi id="S3.SS1.p1.3.m3.4.4.4.1.1.3" xref="S3.SS1.p1.3.m3.4.4.4.1.1.3.cmml">k</mi></msub><mo id="S3.SS1.p1.3.m3.4.4.4.1.3" stretchy="false" xref="S3.SS1.p1.3.m3.4.4.4.2.1.cmml">]</mo></mrow><mo id="S3.SS1.p1.3.m3.9.9.10d" xref="S3.SS1.p1.3.m3.9.9.10.cmml">⁢</mo><mrow id="S3.SS1.p1.3.m3.5.5.5.1" xref="S3.SS1.p1.3.m3.5.5.5.2.cmml"><mo id="S3.SS1.p1.3.m3.5.5.5.1.2" stretchy="false" xref="S3.SS1.p1.3.m3.5.5.5.2.1.cmml">[</mo><msub id="S3.SS1.p1.3.m3.5.5.5.1.1" xref="S3.SS1.p1.3.m3.5.5.5.1.1.cmml"><mi id="S3.SS1.p1.3.m3.5.5.5.1.1.2" xref="S3.SS1.p1.3.m3.5.5.5.1.1.2.cmml">s</mi><mi id="S3.SS1.p1.3.m3.5.5.5.1.1.3" xref="S3.SS1.p1.3.m3.5.5.5.1.1.3.cmml">k</mi></msub><mo id="S3.SS1.p1.3.m3.5.5.5.1.3" stretchy="false" xref="S3.SS1.p1.3.m3.5.5.5.2.1.cmml">]</mo></mrow><mo id="S3.SS1.p1.3.m3.9.9.10e" xref="S3.SS1.p1.3.m3.9.9.10.cmml">⁢</mo><mrow id="S3.SS1.p1.3.m3.6.6.6.1" xref="S3.SS1.p1.3.m3.6.6.6.2.cmml"><mo id="S3.SS1.p1.3.m3.6.6.6.1.2" stretchy="false" xref="S3.SS1.p1.3.m3.6.6.6.2.1.cmml">[</mo><msub id="S3.SS1.p1.3.m3.6.6.6.1.1" xref="S3.SS1.p1.3.m3.6.6.6.1.1.cmml"><mi id="S3.SS1.p1.3.m3.6.6.6.1.1.2" xref="S3.SS1.p1.3.m3.6.6.6.1.1.2.cmml">y</mi><mi id="S3.SS1.p1.3.m3.6.6.6.1.1.3" xref="S3.SS1.p1.3.m3.6.6.6.1.1.3.cmml">k</mi></msub><mo id="S3.SS1.p1.3.m3.6.6.6.1.3" stretchy="false" xref="S3.SS1.p1.3.m3.6.6.6.2.1.cmml">]</mo></mrow><mo id="S3.SS1.p1.3.m3.9.9.10f" xref="S3.SS1.p1.3.m3.9.9.10.cmml">⁢</mo><mrow id="S3.SS1.p1.3.m3.7.7.7.1" xref="S3.SS1.p1.3.m3.7.7.7.2.cmml"><mo id="S3.SS1.p1.3.m3.7.7.7.1.2" stretchy="false" xref="S3.SS1.p1.3.m3.7.7.7.2.1.cmml">[</mo><msub id="S3.SS1.p1.3.m3.7.7.7.1.1" xref="S3.SS1.p1.3.m3.7.7.7.1.1.cmml"><mi id="S3.SS1.p1.3.m3.7.7.7.1.1.2" xref="S3.SS1.p1.3.m3.7.7.7.1.1.2.cmml">x</mi><mi id="S3.SS1.p1.3.m3.7.7.7.1.1.3" xref="S3.SS1.p1.3.m3.7.7.7.1.1.3.cmml">t</mi></msub><mo id="S3.SS1.p1.3.m3.7.7.7.1.3" stretchy="false" xref="S3.SS1.p1.3.m3.7.7.7.2.1.cmml">]</mo></mrow><mo id="S3.SS1.p1.3.m3.9.9.10g" xref="S3.SS1.p1.3.m3.9.9.10.cmml">⁢</mo><mrow id="S3.SS1.p1.3.m3.8.8.8.1" xref="S3.SS1.p1.3.m3.8.8.8.2.cmml"><mo id="S3.SS1.p1.3.m3.8.8.8.1.2" stretchy="false" xref="S3.SS1.p1.3.m3.8.8.8.2.1.cmml">[</mo><msub id="S3.SS1.p1.3.m3.8.8.8.1.1" xref="S3.SS1.p1.3.m3.8.8.8.1.1.cmml"><mi id="S3.SS1.p1.3.m3.8.8.8.1.1.2" xref="S3.SS1.p1.3.m3.8.8.8.1.1.2.cmml">s</mi><mi id="S3.SS1.p1.3.m3.8.8.8.1.1.3" xref="S3.SS1.p1.3.m3.8.8.8.1.1.3.cmml">t</mi></msub><mo id="S3.SS1.p1.3.m3.8.8.8.1.3" stretchy="false" xref="S3.SS1.p1.3.m3.8.8.8.2.1.cmml">]</mo></mrow><mo id="S3.SS1.p1.3.m3.9.9.10h" xref="S3.SS1.p1.3.m3.9.9.10.cmml">⁢</mo><mrow id="S3.SS1.p1.3.m3.9.9.9.1" xref="S3.SS1.p1.3.m3.9.9.9.2.cmml"><mo id="S3.SS1.p1.3.m3.9.9.9.1.2" stretchy="false" xref="S3.SS1.p1.3.m3.9.9.9.2.1.cmml">[</mo><msub id="S3.SS1.p1.3.m3.9.9.9.1.1" xref="S3.SS1.p1.3.m3.9.9.9.1.1.cmml"><mi id="S3.SS1.p1.3.m3.9.9.9.1.1.2" xref="S3.SS1.p1.3.m3.9.9.9.1.1.2.cmml">y</mi><mi id="S3.SS1.p1.3.m3.9.9.9.1.1.3" xref="S3.SS1.p1.3.m3.9.9.9.1.1.3.cmml">t</mi></msub><mo id="S3.SS1.p1.3.m3.9.9.9.1.3" stretchy="false" xref="S3.SS1.p1.3.m3.9.9.9.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.9b"><apply id="S3.SS1.p1.3.m3.9.9.cmml" xref="S3.SS1.p1.3.m3.9.9"><times id="S3.SS1.p1.3.m3.9.9.10.cmml" xref="S3.SS1.p1.3.m3.9.9.10"></times><apply id="S3.SS1.p1.3.m3.1.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.p1.3.m3.1.1.1.2.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS1.p1.3.m3.1.1.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.2">𝑥</ci><cn id="S3.SS1.p1.3.m3.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS1.p1.3.m3.1.1.1.1.1.3">1</cn></apply></apply><apply id="S3.SS1.p1.3.m3.2.2.2.2.cmml" xref="S3.SS1.p1.3.m3.2.2.2.1"><csymbol cd="latexml" id="S3.SS1.p1.3.m3.2.2.2.2.1.cmml" xref="S3.SS1.p1.3.m3.2.2.2.1.2">delimited-[]</csymbol><apply id="S3.SS1.p1.3.m3.2.2.2.1.1.cmml" xref="S3.SS1.p1.3.m3.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.2.2.2.1.1.1.cmml" xref="S3.SS1.p1.3.m3.2.2.2.1.1">subscript</csymbol><ci id="S3.SS1.p1.3.m3.2.2.2.1.1.2.cmml" xref="S3.SS1.p1.3.m3.2.2.2.1.1.2">𝑠</ci><cn id="S3.SS1.p1.3.m3.2.2.2.1.1.3.cmml" type="integer" xref="S3.SS1.p1.3.m3.2.2.2.1.1.3">1</cn></apply></apply><apply id="S3.SS1.p1.3.m3.3.3.3.2.cmml" xref="S3.SS1.p1.3.m3.3.3.3.1"><csymbol cd="latexml" id="S3.SS1.p1.3.m3.3.3.3.2.1.cmml" xref="S3.SS1.p1.3.m3.3.3.3.1.2">delimited-[]</csymbol><apply id="S3.SS1.p1.3.m3.3.3.3.1.1.cmml" xref="S3.SS1.p1.3.m3.3.3.3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.3.3.3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.3.3.3.1.1">subscript</csymbol><ci id="S3.SS1.p1.3.m3.3.3.3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.3.3.3.1.1.2">𝑦</ci><cn id="S3.SS1.p1.3.m3.3.3.3.1.1.3.cmml" type="integer" xref="S3.SS1.p1.3.m3.3.3.3.1.1.3">1</cn></apply></apply><ci id="S3.SS1.p1.3.m3.9.9.11.cmml" xref="S3.SS1.p1.3.m3.9.9.11">…</ci><apply id="S3.SS1.p1.3.m3.4.4.4.2.cmml" xref="S3.SS1.p1.3.m3.4.4.4.1"><csymbol cd="latexml" id="S3.SS1.p1.3.m3.4.4.4.2.1.cmml" xref="S3.SS1.p1.3.m3.4.4.4.1.2">delimited-[]</csymbol><apply id="S3.SS1.p1.3.m3.4.4.4.1.1.cmml" xref="S3.SS1.p1.3.m3.4.4.4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.4.4.4.1.1.1.cmml" xref="S3.SS1.p1.3.m3.4.4.4.1.1">subscript</csymbol><ci id="S3.SS1.p1.3.m3.4.4.4.1.1.2.cmml" xref="S3.SS1.p1.3.m3.4.4.4.1.1.2">𝑥</ci><ci id="S3.SS1.p1.3.m3.4.4.4.1.1.3.cmml" xref="S3.SS1.p1.3.m3.4.4.4.1.1.3">𝑘</ci></apply></apply><apply id="S3.SS1.p1.3.m3.5.5.5.2.cmml" xref="S3.SS1.p1.3.m3.5.5.5.1"><csymbol cd="latexml" id="S3.SS1.p1.3.m3.5.5.5.2.1.cmml" xref="S3.SS1.p1.3.m3.5.5.5.1.2">delimited-[]</csymbol><apply id="S3.SS1.p1.3.m3.5.5.5.1.1.cmml" xref="S3.SS1.p1.3.m3.5.5.5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.5.5.5.1.1.1.cmml" xref="S3.SS1.p1.3.m3.5.5.5.1.1">subscript</csymbol><ci id="S3.SS1.p1.3.m3.5.5.5.1.1.2.cmml" xref="S3.SS1.p1.3.m3.5.5.5.1.1.2">𝑠</ci><ci id="S3.SS1.p1.3.m3.5.5.5.1.1.3.cmml" xref="S3.SS1.p1.3.m3.5.5.5.1.1.3">𝑘</ci></apply></apply><apply id="S3.SS1.p1.3.m3.6.6.6.2.cmml" xref="S3.SS1.p1.3.m3.6.6.6.1"><csymbol cd="latexml" id="S3.SS1.p1.3.m3.6.6.6.2.1.cmml" xref="S3.SS1.p1.3.m3.6.6.6.1.2">delimited-[]</csymbol><apply id="S3.SS1.p1.3.m3.6.6.6.1.1.cmml" xref="S3.SS1.p1.3.m3.6.6.6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.6.6.6.1.1.1.cmml" xref="S3.SS1.p1.3.m3.6.6.6.1.1">subscript</csymbol><ci id="S3.SS1.p1.3.m3.6.6.6.1.1.2.cmml" xref="S3.SS1.p1.3.m3.6.6.6.1.1.2">𝑦</ci><ci id="S3.SS1.p1.3.m3.6.6.6.1.1.3.cmml" xref="S3.SS1.p1.3.m3.6.6.6.1.1.3">𝑘</ci></apply></apply><apply id="S3.SS1.p1.3.m3.7.7.7.2.cmml" xref="S3.SS1.p1.3.m3.7.7.7.1"><csymbol cd="latexml" id="S3.SS1.p1.3.m3.7.7.7.2.1.cmml" xref="S3.SS1.p1.3.m3.7.7.7.1.2">delimited-[]</csymbol><apply id="S3.SS1.p1.3.m3.7.7.7.1.1.cmml" xref="S3.SS1.p1.3.m3.7.7.7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.7.7.7.1.1.1.cmml" xref="S3.SS1.p1.3.m3.7.7.7.1.1">subscript</csymbol><ci id="S3.SS1.p1.3.m3.7.7.7.1.1.2.cmml" xref="S3.SS1.p1.3.m3.7.7.7.1.1.2">𝑥</ci><ci id="S3.SS1.p1.3.m3.7.7.7.1.1.3.cmml" xref="S3.SS1.p1.3.m3.7.7.7.1.1.3">𝑡</ci></apply></apply><apply id="S3.SS1.p1.3.m3.8.8.8.2.cmml" xref="S3.SS1.p1.3.m3.8.8.8.1"><csymbol cd="latexml" id="S3.SS1.p1.3.m3.8.8.8.2.1.cmml" xref="S3.SS1.p1.3.m3.8.8.8.1.2">delimited-[]</csymbol><apply id="S3.SS1.p1.3.m3.8.8.8.1.1.cmml" xref="S3.SS1.p1.3.m3.8.8.8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.8.8.8.1.1.1.cmml" xref="S3.SS1.p1.3.m3.8.8.8.1.1">subscript</csymbol><ci id="S3.SS1.p1.3.m3.8.8.8.1.1.2.cmml" xref="S3.SS1.p1.3.m3.8.8.8.1.1.2">𝑠</ci><ci id="S3.SS1.p1.3.m3.8.8.8.1.1.3.cmml" xref="S3.SS1.p1.3.m3.8.8.8.1.1.3">𝑡</ci></apply></apply><apply id="S3.SS1.p1.3.m3.9.9.9.2.cmml" xref="S3.SS1.p1.3.m3.9.9.9.1"><csymbol cd="latexml" id="S3.SS1.p1.3.m3.9.9.9.2.1.cmml" xref="S3.SS1.p1.3.m3.9.9.9.1.2">delimited-[]</csymbol><apply id="S3.SS1.p1.3.m3.9.9.9.1.1.cmml" xref="S3.SS1.p1.3.m3.9.9.9.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.9.9.9.1.1.1.cmml" xref="S3.SS1.p1.3.m3.9.9.9.1.1">subscript</csymbol><ci id="S3.SS1.p1.3.m3.9.9.9.1.1.2.cmml" xref="S3.SS1.p1.3.m3.9.9.9.1.1.2">𝑦</ci><ci id="S3.SS1.p1.3.m3.9.9.9.1.1.3.cmml" xref="S3.SS1.p1.3.m3.9.9.9.1.1.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.9c">[x_{1}][s_{1}][y_{1}]\dots[x_{k}][s_{k}][y_{k}][x_{t}][s_{t}][y_{t}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.9d">[ italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ] [ italic_s start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ] [ italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ] … [ italic_x start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ] [ italic_s start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ] [ italic_y start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ] [ italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ] [ italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ] [ italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ]</annotation></semantics></math>. These inputs are then fed into an LM to extract the hidden states of a specific token in <math alttext="[x_{t}][s_{t}][y_{t}]" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.3"><semantics id="S3.SS1.p1.4.m4.3a"><mrow id="S3.SS1.p1.4.m4.3.3" xref="S3.SS1.p1.4.m4.3.3.cmml"><mrow id="S3.SS1.p1.4.m4.1.1.1.1" xref="S3.SS1.p1.4.m4.1.1.1.2.cmml"><mo id="S3.SS1.p1.4.m4.1.1.1.1.2" stretchy="false" xref="S3.SS1.p1.4.m4.1.1.1.2.1.cmml">[</mo><msub id="S3.SS1.p1.4.m4.1.1.1.1.1" xref="S3.SS1.p1.4.m4.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.4.m4.1.1.1.1.1.2" xref="S3.SS1.p1.4.m4.1.1.1.1.1.2.cmml">x</mi><mi id="S3.SS1.p1.4.m4.1.1.1.1.1.3" xref="S3.SS1.p1.4.m4.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS1.p1.4.m4.1.1.1.1.3" stretchy="false" xref="S3.SS1.p1.4.m4.1.1.1.2.1.cmml">]</mo></mrow><mo id="S3.SS1.p1.4.m4.3.3.4" xref="S3.SS1.p1.4.m4.3.3.4.cmml">⁢</mo><mrow id="S3.SS1.p1.4.m4.2.2.2.1" xref="S3.SS1.p1.4.m4.2.2.2.2.cmml"><mo id="S3.SS1.p1.4.m4.2.2.2.1.2" stretchy="false" xref="S3.SS1.p1.4.m4.2.2.2.2.1.cmml">[</mo><msub id="S3.SS1.p1.4.m4.2.2.2.1.1" xref="S3.SS1.p1.4.m4.2.2.2.1.1.cmml"><mi id="S3.SS1.p1.4.m4.2.2.2.1.1.2" xref="S3.SS1.p1.4.m4.2.2.2.1.1.2.cmml">s</mi><mi id="S3.SS1.p1.4.m4.2.2.2.1.1.3" xref="S3.SS1.p1.4.m4.2.2.2.1.1.3.cmml">t</mi></msub><mo id="S3.SS1.p1.4.m4.2.2.2.1.3" stretchy="false" xref="S3.SS1.p1.4.m4.2.2.2.2.1.cmml">]</mo></mrow><mo id="S3.SS1.p1.4.m4.3.3.4a" xref="S3.SS1.p1.4.m4.3.3.4.cmml">⁢</mo><mrow id="S3.SS1.p1.4.m4.3.3.3.1" xref="S3.SS1.p1.4.m4.3.3.3.2.cmml"><mo id="S3.SS1.p1.4.m4.3.3.3.1.2" stretchy="false" xref="S3.SS1.p1.4.m4.3.3.3.2.1.cmml">[</mo><msub id="S3.SS1.p1.4.m4.3.3.3.1.1" xref="S3.SS1.p1.4.m4.3.3.3.1.1.cmml"><mi id="S3.SS1.p1.4.m4.3.3.3.1.1.2" xref="S3.SS1.p1.4.m4.3.3.3.1.1.2.cmml">y</mi><mi id="S3.SS1.p1.4.m4.3.3.3.1.1.3" xref="S3.SS1.p1.4.m4.3.3.3.1.1.3.cmml">t</mi></msub><mo id="S3.SS1.p1.4.m4.3.3.3.1.3" stretchy="false" xref="S3.SS1.p1.4.m4.3.3.3.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.3b"><apply id="S3.SS1.p1.4.m4.3.3.cmml" xref="S3.SS1.p1.4.m4.3.3"><times id="S3.SS1.p1.4.m4.3.3.4.cmml" xref="S3.SS1.p1.4.m4.3.3.4"></times><apply id="S3.SS1.p1.4.m4.1.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.p1.4.m4.1.1.1.2.1.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS1.p1.4.m4.1.1.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1.1.2">𝑥</ci><ci id="S3.SS1.p1.4.m4.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1.1.3">𝑡</ci></apply></apply><apply id="S3.SS1.p1.4.m4.2.2.2.2.cmml" xref="S3.SS1.p1.4.m4.2.2.2.1"><csymbol cd="latexml" id="S3.SS1.p1.4.m4.2.2.2.2.1.cmml" xref="S3.SS1.p1.4.m4.2.2.2.1.2">delimited-[]</csymbol><apply id="S3.SS1.p1.4.m4.2.2.2.1.1.cmml" xref="S3.SS1.p1.4.m4.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.2.2.2.1.1.1.cmml" xref="S3.SS1.p1.4.m4.2.2.2.1.1">subscript</csymbol><ci id="S3.SS1.p1.4.m4.2.2.2.1.1.2.cmml" xref="S3.SS1.p1.4.m4.2.2.2.1.1.2">𝑠</ci><ci id="S3.SS1.p1.4.m4.2.2.2.1.1.3.cmml" xref="S3.SS1.p1.4.m4.2.2.2.1.1.3">𝑡</ci></apply></apply><apply id="S3.SS1.p1.4.m4.3.3.3.2.cmml" xref="S3.SS1.p1.4.m4.3.3.3.1"><csymbol cd="latexml" id="S3.SS1.p1.4.m4.3.3.3.2.1.cmml" xref="S3.SS1.p1.4.m4.3.3.3.1.2">delimited-[]</csymbol><apply id="S3.SS1.p1.4.m4.3.3.3.1.1.cmml" xref="S3.SS1.p1.4.m4.3.3.3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.3.3.3.1.1.1.cmml" xref="S3.SS1.p1.4.m4.3.3.3.1.1">subscript</csymbol><ci id="S3.SS1.p1.4.m4.3.3.3.1.1.2.cmml" xref="S3.SS1.p1.4.m4.3.3.3.1.1.2">𝑦</ci><ci id="S3.SS1.p1.4.m4.3.3.3.1.1.3.cmml" xref="S3.SS1.p1.4.m4.3.3.3.1.1.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.3c">[x_{t}][s_{t}][y_{t}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.3d">[ italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ] [ italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ] [ italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ]</annotation></semantics></math> from each layer, serving as the ICL inner representations. To assess the quality of these representations as sentence representations, we use the sentence embedding of <math alttext="x_{t}" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.1"><semantics id="S3.SS1.p1.5.m5.1a"><msub id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml"><mi id="S3.SS1.p1.5.m5.1.1.2" xref="S3.SS1.p1.5.m5.1.1.2.cmml">x</mi><mi id="S3.SS1.p1.5.m5.1.1.3" xref="S3.SS1.p1.5.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><apply id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.p1.5.m5.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2">𝑥</ci><ci id="S3.SS1.p1.5.m5.1.1.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">x_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m5.1d">italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> encoded by BGE M3&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Chen et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib8" title="">2024</a>)</cite>, a SotA encoder-only Transformer, as a “reference” representation and then calculate the <span class="ltx_text ltx_font_italic" id="S3.SS1.p1.5.2">mutual nearest-neighbor kernel alignment<span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_upright" id="footnote3.1.1.1">3</span></span><span class="ltx_text ltx_font_upright" id="footnote3.5">Intuitively, kernel alignment measures similarity between two representations toward the same datasets, and according to&nbsp;</span><cite class="ltx_cite ltx_citemacro_cite">Huh et&nbsp;al. <span class="ltx_text ltx_font_upright" id="footnote3.6.1.1.1">(</span><a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib19" title="">2024</a><span class="ltx_text ltx_font_upright" id="footnote3.7.2.2.1">)</span></cite><span class="ltx_text ltx_font_upright" id="footnote3.8">, a higher cross-model kernel alignment usually means a better representation.</span></span></span></span></span>&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Huh et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib19" title="">2024</a>)</cite> between these representations. See Appendix&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A1.SS1" title="A.1 Detailed Overall Experimental Settings ‣ Appendix A Experiment Details and Settings ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">A.1</span></a> and&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A1.SS2" title="A.2 Calculation of Mutual Nearest-neighbor Kernel Alignment ‣ Appendix A Experiment Details and Settings ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">A.2</span></a> for details.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.1"><span class="ltx_text ltx_font_bold" id="S3.SS1.p2.1.1">Forerunner Tokens Encode Input Text Representations.</span> We plot the kernel alignment using 3 types of tokens in Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S3.F2" title="Figure 2 ‣ 3.2 Text Summarization is Linear and Task-Relevant but Position-biased ‣ 3 Step 1, Summarize: Linear Representations in Hidden States ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">2</span></a> (Left). The forerunner token, while often overlooked in previous work, produces the best input text-encoding, emerging in the early phase (layers 0-28) of the inference process, and keeping a high level to the end of inference. Interestingly, hidden states of label words are not satisfactory input text representations even with a high background value (the result at layer 0, refer to Appendix&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A1.SS2.SSS1" title="A.2.1 Background Values of Kernel Alignment: Label Token - Text Encoding. ‣ A.2 Calculation of Mutual Nearest-neighbor Kernel Alignment ‣ Appendix A Experiment Details and Settings ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">A.2.1</span></a> for details), which is a critical supplement to previous work which suggests the label tokens are pivots for collecting the information of demontrations&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Wang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib39" title="">2023</a>)</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.1"><span class="ltx_text ltx_font_bold" id="S3.SS1.p3.1.1">Input Text Encoding is Enhanced by Demonstrations.</span> We investigate the influence of contextual in on input text encoding by repeating the experiments with different <math alttext="k" class="ltx_Math" display="inline" id="S3.SS1.p3.1.m1.1"><semantics id="S3.SS1.p3.1.m1.1a"><mi id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><ci id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.1.m1.1d">italic_k</annotation></semantics></math>. As shown in Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S3.F2" title="Figure 2 ‣ 3.2 Text Summarization is Linear and Task-Relevant but Position-biased ‣ 3 Step 1, Summarize: Linear Representations in Hidden States ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">2</span></a> (Middle), when the demonstrations increase, feature alignment is enhanced, which is counterintuitive since longer preceding texts are more likely to confuse encoding targets. Such findings indicate that LMs (1) utilize contextual information to enhance the input text encoding and (2) correctly segment different demonstrations (detailed operation discussed in Appendix&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A3" title="Appendix C Can LMs Segment ICL Prompt? ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">C</span></a>).</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p4">
<p class="ltx_p" id="S3.SS1.p4.2"><span class="ltx_text ltx_font_bold" id="S3.SS1.p4.2.1">Perplexed Texts are Encoded Worse.</span> We investigate the correlation between kernel alignment and the perplexity of encoding targets with different <math alttext="k" class="ltx_Math" display="inline" id="S3.SS1.p4.1.m1.1"><semantics id="S3.SS1.p4.1.m1.1a"><mi id="S3.SS1.p4.1.m1.1.1" xref="S3.SS1.p4.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.1.m1.1b"><ci id="S3.SS1.p4.1.m1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.1.m1.1d">italic_k</annotation></semantics></math>. Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S3.F2" title="Figure 2 ‣ 3.2 Text Summarization is Linear and Task-Relevant but Position-biased ‣ 3 Step 1, Summarize: Linear Representations in Hidden States ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">2</span></a> (Right, upper) shows a negative correlation for <math alttext="k=0" class="ltx_Math" display="inline" id="S3.SS1.p4.2.m2.1"><semantics id="S3.SS1.p4.2.m2.1a"><mrow id="S3.SS1.p4.2.m2.1.1" xref="S3.SS1.p4.2.m2.1.1.cmml"><mi id="S3.SS1.p4.2.m2.1.1.2" xref="S3.SS1.p4.2.m2.1.1.2.cmml">k</mi><mo id="S3.SS1.p4.2.m2.1.1.1" xref="S3.SS1.p4.2.m2.1.1.1.cmml">=</mo><mn id="S3.SS1.p4.2.m2.1.1.3" xref="S3.SS1.p4.2.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.2.m2.1b"><apply id="S3.SS1.p4.2.m2.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1"><eq id="S3.SS1.p4.2.m2.1.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1.1"></eq><ci id="S3.SS1.p4.2.m2.1.1.2.cmml" xref="S3.SS1.p4.2.m2.1.1.2">𝑘</ci><cn id="S3.SS1.p4.2.m2.1.1.3.cmml" type="integer" xref="S3.SS1.p4.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.2.m2.1c">k=0</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.2.m2.1d">italic_k = 0</annotation></semantics></math>,
that is, LMs generate poorer encodings for more complex input text when no demonstrations are given, which can be identified as an <span class="ltx_text ltx_font_bold" id="S3.SS1.p4.2.2">I</span>n-<span class="ltx_text ltx_font_bold" id="S3.SS1.p4.2.3">w</span>eight <span class="ltx_text ltx_font_bold" id="S3.SS1.p4.2.4">L</span>earning (IWL) property of the inner text encoding.
While, when demonstrations are given in context (Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S3.F2" title="Figure 2 ‣ 3.2 Text Summarization is Linear and Task-Relevant but Position-biased ‣ 3 Step 1, Summarize: Linear Representations in Hidden States ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">2</span></a> (Right, lower)), the negative correlation disappears, which suggests that LMs effectively encode more complex samples with the help of demonstrations in context. More discussion about the relationship of classification performance and perplexity is in Appendix&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A5" title="Appendix E Demonstrations Enhance the Inference of Perplexed Queries ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">E</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p5">
<p class="ltx_p" id="S3.SS1.p5.1">The above findings suggest that the inner text encoding is a hybrid process of ICL and IWL: Basic encoding capability presents from LMs weights, and is enhanced by demonstrations in context, which can be a clue to how demonstrations help ICL. Moreover, we are about to illustrate that these encodings are sufficiently informative for ICL tasks and linearly separable, which meets the presumption of simplified models on the linear and well-embedded input features.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Text Summarization is Linear and Task-Relevant but Position-biased</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="S3.F2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F2.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="181" id="S3.F2.sf1.g1" src="https://arxiv.org/html/2410.04468v1/x1.png" width="245">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F2.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="181" id="S3.F2.sf2.g1" src="https://arxiv.org/html/2410.04468v1/x2.png" width="308">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F2.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="185" id="S3.F2.sf3.g1" src="https://arxiv.org/html/2410.04468v1/x3.png" width="244">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Input text encoding magnitudes (metricized by kernel alignment against feature encoded by encoder-structured models) of hidden states in various layers in ICL scenario (The controlled experiments are results between current 6 datasets and TEE&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Mohammad et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib30" title="">2018</a>)</cite>). <span class="ltx_text ltx_font_bold" id="S3.F2.10.1">Left:</span> Encoding magnitudes on hidden states from various types of token. <span class="ltx_text ltx_font_bold" id="S3.F2.11.2">Middle<span class="ltx_note ltx_role_footnote" id="footnote5"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_medium" id="footnote5.1.1.1">5</span></span>Experiments of Fig.&nbsp;<a class="ltx_ref ltx_font_medium" href="https://arxiv.org/html/2410.04468v1#S3.F2" title="Figure 2 ‣ 3.2 Text Summarization is Linear and Task-Relevant but Position-biased ‣ 3 Step 1, Summarize: Linear Representations in Hidden States ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">2</span></a> (Middle) on Llama 3 70B do not involve results on AGNews.</span></span></span>:</span> Encoding magnitudes with different <math alttext="k" class="ltx_Math" display="inline" id="S3.F2.4.m1.1"><semantics id="S3.F2.4.m1.1b"><mi id="S3.F2.4.m1.1.1" xref="S3.F2.4.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.F2.4.m1.1c"><ci id="S3.F2.4.m1.1.1.cmml" xref="S3.F2.4.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.4.m1.1d">k</annotation><annotation encoding="application/x-llamapun" id="S3.F2.4.m1.1e">italic_k</annotation></semantics></math> on the forerunner tokens. <span class="ltx_text ltx_font_bold" id="S3.F2.12.3">Right:</span> Encoding magnitudes in layer 24 of Llama 3 70B against the causal language modeling loss of the input text with (upper) <math alttext="k=0" class="ltx_Math" display="inline" id="S3.F2.5.m2.1"><semantics id="S3.F2.5.m2.1b"><mrow id="S3.F2.5.m2.1.1" xref="S3.F2.5.m2.1.1.cmml"><mi id="S3.F2.5.m2.1.1.2" xref="S3.F2.5.m2.1.1.2.cmml">k</mi><mo id="S3.F2.5.m2.1.1.1" xref="S3.F2.5.m2.1.1.1.cmml">=</mo><mn id="S3.F2.5.m2.1.1.3" xref="S3.F2.5.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.5.m2.1c"><apply id="S3.F2.5.m2.1.1.cmml" xref="S3.F2.5.m2.1.1"><eq id="S3.F2.5.m2.1.1.1.cmml" xref="S3.F2.5.m2.1.1.1"></eq><ci id="S3.F2.5.m2.1.1.2.cmml" xref="S3.F2.5.m2.1.1.2">𝑘</ci><cn id="S3.F2.5.m2.1.1.3.cmml" type="integer" xref="S3.F2.5.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.5.m2.1d">k=0</annotation><annotation encoding="application/x-llamapun" id="S3.F2.5.m2.1e">italic_k = 0</annotation></semantics></math> and (lower) <math alttext="k=8" class="ltx_Math" display="inline" id="S3.F2.6.m3.1"><semantics id="S3.F2.6.m3.1b"><mrow id="S3.F2.6.m3.1.1" xref="S3.F2.6.m3.1.1.cmml"><mi id="S3.F2.6.m3.1.1.2" xref="S3.F2.6.m3.1.1.2.cmml">k</mi><mo id="S3.F2.6.m3.1.1.1" xref="S3.F2.6.m3.1.1.1.cmml">=</mo><mn id="S3.F2.6.m3.1.1.3" xref="S3.F2.6.m3.1.1.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.6.m3.1c"><apply id="S3.F2.6.m3.1.1.cmml" xref="S3.F2.6.m3.1.1"><eq id="S3.F2.6.m3.1.1.1.cmml" xref="S3.F2.6.m3.1.1.1"></eq><ci id="S3.F2.6.m3.1.1.2.cmml" xref="S3.F2.6.m3.1.1.2">𝑘</ci><cn id="S3.F2.6.m3.1.1.3.cmml" type="integer" xref="S3.F2.6.m3.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.6.m3.1d">k=8</annotation><annotation encoding="application/x-llamapun" id="S3.F2.6.m3.1e">italic_k = 8</annotation></semantics></math>.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure ltx_align_floatright" id="S3.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="174" id="S3.F3.g1" src="https://arxiv.org/html/2410.04468v1/x4.png" width="244">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Test results of centroid classifier trained on ICL hidden states. <span class="ltx_text ltx_font_bold" id="S3.F3.3.1">Solid</span>: Centroid classification accuracy, <span class="ltx_text ltx_font_bold" id="S3.F3.4.2">Dotted</span>: Kernel alignment.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.2"><span class="ltx_text ltx_font_bold" id="S3.SS2.p1.2.1">Input Text Encoding is Linear Separable and Task-relevant.</span> We train a centroid classifier on hold-out 256 input samples&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Cho et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib9" title="">2024</a>)</cite>, using the hidden states of a specific token in <math alttext="[x_{t}][s_{t}]" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.2"><semantics id="S3.SS2.p1.1.m1.2a"><mrow id="S3.SS2.p1.1.m1.2.2" xref="S3.SS2.p1.1.m1.2.2.cmml"><mrow id="S3.SS2.p1.1.m1.1.1.1.1" xref="S3.SS2.p1.1.m1.1.1.1.2.cmml"><mo id="S3.SS2.p1.1.m1.1.1.1.1.2" stretchy="false" xref="S3.SS2.p1.1.m1.1.1.1.2.1.cmml">[</mo><msub id="S3.SS2.p1.1.m1.1.1.1.1.1" xref="S3.SS2.p1.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.1.1.1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.1.1.1.2.cmml">x</mi><mi id="S3.SS2.p1.1.m1.1.1.1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS2.p1.1.m1.1.1.1.1.3" stretchy="false" xref="S3.SS2.p1.1.m1.1.1.1.2.1.cmml">]</mo></mrow><mo id="S3.SS2.p1.1.m1.2.2.3" xref="S3.SS2.p1.1.m1.2.2.3.cmml">⁢</mo><mrow id="S3.SS2.p1.1.m1.2.2.2.1" xref="S3.SS2.p1.1.m1.2.2.2.2.cmml"><mo id="S3.SS2.p1.1.m1.2.2.2.1.2" stretchy="false" xref="S3.SS2.p1.1.m1.2.2.2.2.1.cmml">[</mo><msub id="S3.SS2.p1.1.m1.2.2.2.1.1" xref="S3.SS2.p1.1.m1.2.2.2.1.1.cmml"><mi id="S3.SS2.p1.1.m1.2.2.2.1.1.2" xref="S3.SS2.p1.1.m1.2.2.2.1.1.2.cmml">s</mi><mi id="S3.SS2.p1.1.m1.2.2.2.1.1.3" xref="S3.SS2.p1.1.m1.2.2.2.1.1.3.cmml">t</mi></msub><mo id="S3.SS2.p1.1.m1.2.2.2.1.3" stretchy="false" xref="S3.SS2.p1.1.m1.2.2.2.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.2b"><apply id="S3.SS2.p1.1.m1.2.2.cmml" xref="S3.SS2.p1.1.m1.2.2"><times id="S3.SS2.p1.1.m1.2.2.3.cmml" xref="S3.SS2.p1.1.m1.2.2.3"></times><apply id="S3.SS2.p1.1.m1.1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.p1.1.m1.1.1.1.2.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS2.p1.1.m1.1.1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1.2">𝑥</ci><ci id="S3.SS2.p1.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1.3">𝑡</ci></apply></apply><apply id="S3.SS2.p1.1.m1.2.2.2.2.cmml" xref="S3.SS2.p1.1.m1.2.2.2.1"><csymbol cd="latexml" id="S3.SS2.p1.1.m1.2.2.2.2.1.cmml" xref="S3.SS2.p1.1.m1.2.2.2.1.2">delimited-[]</csymbol><apply id="S3.SS2.p1.1.m1.2.2.2.1.1.cmml" xref="S3.SS2.p1.1.m1.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.2.2.2.1.1.1.cmml" xref="S3.SS2.p1.1.m1.2.2.2.1.1">subscript</csymbol><ci id="S3.SS2.p1.1.m1.2.2.2.1.1.2.cmml" xref="S3.SS2.p1.1.m1.2.2.2.1.1.2">𝑠</ci><ci id="S3.SS2.p1.1.m1.2.2.2.1.1.3.cmml" xref="S3.SS2.p1.1.m1.2.2.2.1.1.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.2c">[x_{t}][s_{t}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.2d">[ italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ] [ italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ]</annotation></semantics></math><span class="ltx_note ltx_role_footnote" id="footnote6"><sup class="ltx_note_mark">6</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">6</sup><span class="ltx_tag ltx_tag_note">6</span>We skip the experiments on label tokens because of the leakage of ground-truth label information.</span></span></span> from each layer and then predict the label <math alttext="y_{t}" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.1"><semantics id="S3.SS2.p1.2.m2.1a"><msub id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mi id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">y</mi><mi id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2">𝑦</ci><ci id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">y_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.1d">italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> (see Appendix&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A1.SS3" title="A.3 Training and Inference of Centroid Classifier ‣ Appendix A Experiment Details and Settings ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">A.3</span></a> for details).
The results are shown in Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S3.F3" title="Figure 3 ‣ 3.2 Text Summarization is Linear and Task-Relevant but Position-biased ‣ 3 Step 1, Summarize: Linear Representations in Hidden States ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">3</span></a>. The considerably high classification accuracy of the forerunner token suggests the high linear separabilities of the hidden states in the task-semantic-relevant subspaces since the centroid classifier is linear.
In addition, a similar emerging trend in accuracy and kernel alignment confirms the reliability of the kernel alignment measurement.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.1"><span class="ltx_text ltx_font_bold" id="S3.SS2.p2.1.1">Input Text Encoding is Biased towards Position.</span> Ideally, the inner representations of similar queries should be highly similar regardless of their position in ICL inputs to support attention-based operations for classification. To verify this, for each encoding target, we extract the hidden states of forerunner tokens with various numbers of preceding demonstrations. We then calculate the cosine similarity between all possible pairs of the hidden states for the same target or different targets. As shown in Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S4.F4" title="Figure 4 ‣ 4 Induction Circuits in Natural Language Models ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">4</span></a>, although the overall similarities on the same target are higher than on the different targets, they are both especially higher when their positions are close to each other.
As to be discussed in&nbsp;§<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S5.SS3" title="5.3 Explaination towards Observed ICL Phenomena ‣ 5 Putting Things Together ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">5.3</span></a>, such positional similarity bias may lead to one flaw: demonstrations closer to the query have stronger impacts on ICL&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Zhao et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib47" title="">2021</a>; Lu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib27" title="">2022</a>; Chang &amp; Jia, <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib7" title="">2023</a>; Guo et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib15" title="">2024</a>)</cite>. The principle of such bias is discussed in Appendix&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A3" title="Appendix C Can LMs Segment ICL Prompt? ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">C</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Induction Circuits in Natural Language Models</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure ltx_align_floatright" id="S4.F4">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" height="144" id="S4.F4.g1" src="https://arxiv.org/html/2410.04468v1/x5.png" width="145"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" height="144" id="S4.F4.g2" src="https://arxiv.org/html/2410.04468v1/x6.png" width="145"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>The similarities of ICL hidden states in different positions on layer 24 between the same queries <span class="ltx_text ltx_font_bold" id="S4.F4.3.1">(Left)</span> or two different queries <span class="ltx_text ltx_font_bold" id="S4.F4.4.2">(Right)</span> (on SST-2).</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">This section mainly shows how LMs utilize the summarized linear text representations in induction circuits with a typical 2-step form&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Singh et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib37" title="">2024b</a>)</cite>: <span class="ltx_text ltx_font_bold" id="S4.p1.1.1">Forerunner Token Heads</span> merge the demonstration text representations in the forerunner token into their corresponding label tokens with a selectivity regarding the compatibility of demonstrations and label semantics. <span class="ltx_text ltx_font_bold" id="S4.p1.1.2">Induction Heads</span> copy the information in the label representations similar to the query representations back to the query. Such operations are done on task-specific subspaces, enabling LMs to solve multiple tasks by multiplexing hidden spaces.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Step 2, Forerunner Token Head: Copy from Text Feature to Label Token</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">This subsection mainly examines and measures the forerunner token heads, which copy the information in the forerunner into label tokens. We investigate the interaction between the forerunner tokens and label tokens, and focus on how the representations are merged, especially when the semantics of labels and text are disjoint, towards an explanation of why ICL are robust to wrong labels.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.5"><span class="ltx_text ltx_font_bold" id="S4.SS1.p2.5.1">Text Representations are Copied to Label Tokens.</span> To confirm the existence of the representation copy process, we start by calculating the kernel alignment between the hidden state of forerunner token <math alttext="s_{t}" class="ltx_Math" display="inline" id="S4.SS1.p2.1.m1.1"><semantics id="S4.SS1.p2.1.m1.1a"><msub id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml"><mi id="S4.SS1.p2.1.m1.1.1.2" xref="S4.SS1.p2.1.m1.1.1.2.cmml">s</mi><mi id="S4.SS1.p2.1.m1.1.1.3" xref="S4.SS1.p2.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><apply id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.1.m1.1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.p2.1.m1.1.1.2.cmml" xref="S4.SS1.p2.1.m1.1.1.2">𝑠</ci><ci id="S4.SS1.p2.1.m1.1.1.3.cmml" xref="S4.SS1.p2.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.1.m1.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> at layer <math alttext="l" class="ltx_Math" display="inline" id="S4.SS1.p2.2.m2.1"><semantics id="S4.SS1.p2.2.m2.1a"><mi id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b"><ci id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">l</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.2.m2.1d">italic_l</annotation></semantics></math> (the copy source) and that of label token <math alttext="y_{t}" class="ltx_Math" display="inline" id="S4.SS1.p2.3.m3.1"><semantics id="S4.SS1.p2.3.m3.1a"><msub id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml"><mi id="S4.SS1.p2.3.m3.1.1.2" xref="S4.SS1.p2.3.m3.1.1.2.cmml">y</mi><mi id="S4.SS1.p2.3.m3.1.1.3" xref="S4.SS1.p2.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.1b"><apply id="S4.SS1.p2.3.m3.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.3.m3.1.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1">subscript</csymbol><ci id="S4.SS1.p2.3.m3.1.1.2.cmml" xref="S4.SS1.p2.3.m3.1.1.2">𝑦</ci><ci id="S4.SS1.p2.3.m3.1.1.3.cmml" xref="S4.SS1.p2.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.1c">y_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.3.m3.1d">italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> at layer <math alttext="(l+1)" class="ltx_Math" display="inline" id="S4.SS1.p2.4.m4.1"><semantics id="S4.SS1.p2.4.m4.1a"><mrow id="S4.SS1.p2.4.m4.1.1.1" xref="S4.SS1.p2.4.m4.1.1.1.1.cmml"><mo id="S4.SS1.p2.4.m4.1.1.1.2" stretchy="false" xref="S4.SS1.p2.4.m4.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.p2.4.m4.1.1.1.1" xref="S4.SS1.p2.4.m4.1.1.1.1.cmml"><mi id="S4.SS1.p2.4.m4.1.1.1.1.2" xref="S4.SS1.p2.4.m4.1.1.1.1.2.cmml">l</mi><mo id="S4.SS1.p2.4.m4.1.1.1.1.1" xref="S4.SS1.p2.4.m4.1.1.1.1.1.cmml">+</mo><mn id="S4.SS1.p2.4.m4.1.1.1.1.3" xref="S4.SS1.p2.4.m4.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.SS1.p2.4.m4.1.1.1.3" stretchy="false" xref="S4.SS1.p2.4.m4.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.4.m4.1b"><apply id="S4.SS1.p2.4.m4.1.1.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1.1"><plus id="S4.SS1.p2.4.m4.1.1.1.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.1"></plus><ci id="S4.SS1.p2.4.m4.1.1.1.1.2.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.2">𝑙</ci><cn id="S4.SS1.p2.4.m4.1.1.1.1.3.cmml" type="integer" xref="S4.SS1.p2.4.m4.1.1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.4.m4.1c">(l+1)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.4.m4.1d">( italic_l + 1 )</annotation></semantics></math> (the copy target). To suppress the high background values caused by the semantics of labels, we use abstract label tokens <math alttext="\{\mathrm{``A&quot;,``B&quot;,``C&quot;,}\dots\}" class="ltx_Math" display="inline" id="S4.SS1.p2.5.m5.4"><semantics id="S4.SS1.p2.5.m5.4a"><mrow id="S4.SS1.p2.5.m5.4.4.3" xref="S4.SS1.p2.5.m5.4.4.4.cmml"><mo id="S4.SS1.p2.5.m5.4.4.3.4" stretchy="false" xref="S4.SS1.p2.5.m5.4.4.4.cmml">{</mo><mrow id="S4.SS1.p2.5.m5.2.2.1.1" xref="S4.SS1.p2.5.m5.2.2.1.1.cmml"><mi id="S4.SS1.p2.5.m5.2.2.1.1.2" mathvariant="normal" xref="S4.SS1.p2.5.m5.2.2.1.1.2.cmml">`</mi><mo id="S4.SS1.p2.5.m5.2.2.1.1.1" xref="S4.SS1.p2.5.m5.2.2.1.1.1.cmml">⁢</mo><mi id="S4.SS1.p2.5.m5.2.2.1.1.3" mathvariant="normal" xref="S4.SS1.p2.5.m5.2.2.1.1.3.cmml">`</mi><mo id="S4.SS1.p2.5.m5.2.2.1.1.1a" xref="S4.SS1.p2.5.m5.2.2.1.1.1.cmml">⁢</mo><mi id="S4.SS1.p2.5.m5.2.2.1.1.4" mathvariant="normal" xref="S4.SS1.p2.5.m5.2.2.1.1.4.cmml">A</mi><mo id="S4.SS1.p2.5.m5.2.2.1.1.1b" xref="S4.SS1.p2.5.m5.2.2.1.1.1.cmml">⁢</mo><mi id="S4.SS1.p2.5.m5.2.2.1.1.5" mathvariant="normal" xref="S4.SS1.p2.5.m5.2.2.1.1.5.cmml">"</mi></mrow><mo id="S4.SS1.p2.5.m5.4.4.3.5" xref="S4.SS1.p2.5.m5.4.4.4.cmml">,</mo><mrow id="S4.SS1.p2.5.m5.3.3.2.2" xref="S4.SS1.p2.5.m5.3.3.2.2.cmml"><mi id="S4.SS1.p2.5.m5.3.3.2.2.2" mathvariant="normal" xref="S4.SS1.p2.5.m5.3.3.2.2.2.cmml">`</mi><mo id="S4.SS1.p2.5.m5.3.3.2.2.1" xref="S4.SS1.p2.5.m5.3.3.2.2.1.cmml">⁢</mo><mi id="S4.SS1.p2.5.m5.3.3.2.2.3" mathvariant="normal" xref="S4.SS1.p2.5.m5.3.3.2.2.3.cmml">`</mi><mo id="S4.SS1.p2.5.m5.3.3.2.2.1a" xref="S4.SS1.p2.5.m5.3.3.2.2.1.cmml">⁢</mo><mi id="S4.SS1.p2.5.m5.3.3.2.2.4" mathvariant="normal" xref="S4.SS1.p2.5.m5.3.3.2.2.4.cmml">B</mi><mo id="S4.SS1.p2.5.m5.3.3.2.2.1b" xref="S4.SS1.p2.5.m5.3.3.2.2.1.cmml">⁢</mo><mi id="S4.SS1.p2.5.m5.3.3.2.2.5" mathvariant="normal" xref="S4.SS1.p2.5.m5.3.3.2.2.5.cmml">"</mi></mrow><mo id="S4.SS1.p2.5.m5.4.4.3.6" xref="S4.SS1.p2.5.m5.4.4.4.cmml">,</mo><mrow id="S4.SS1.p2.5.m5.4.4.3.3" xref="S4.SS1.p2.5.m5.4.4.3.3.cmml"><mi id="S4.SS1.p2.5.m5.4.4.3.3.2" mathvariant="normal" xref="S4.SS1.p2.5.m5.4.4.3.3.2.cmml">`</mi><mo id="S4.SS1.p2.5.m5.4.4.3.3.1" xref="S4.SS1.p2.5.m5.4.4.3.3.1.cmml">⁢</mo><mi id="S4.SS1.p2.5.m5.4.4.3.3.3" mathvariant="normal" xref="S4.SS1.p2.5.m5.4.4.3.3.3.cmml">`</mi><mo id="S4.SS1.p2.5.m5.4.4.3.3.1a" xref="S4.SS1.p2.5.m5.4.4.3.3.1.cmml">⁢</mo><mi id="S4.SS1.p2.5.m5.4.4.3.3.4" mathvariant="normal" xref="S4.SS1.p2.5.m5.4.4.3.3.4.cmml">C</mi><mo id="S4.SS1.p2.5.m5.4.4.3.3.1b" xref="S4.SS1.p2.5.m5.4.4.3.3.1.cmml">⁢</mo><mi id="S4.SS1.p2.5.m5.4.4.3.3.5" mathvariant="normal" xref="S4.SS1.p2.5.m5.4.4.3.3.5.cmml">"</mi></mrow><mo id="S4.SS1.p2.5.m5.4.4.3.7" xref="S4.SS1.p2.5.m5.4.4.4.cmml">,</mo><mi id="S4.SS1.p2.5.m5.1.1" mathvariant="normal" xref="S4.SS1.p2.5.m5.1.1.cmml">…</mi><mo id="S4.SS1.p2.5.m5.4.4.3.8" stretchy="false" xref="S4.SS1.p2.5.m5.4.4.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.5.m5.4b"><set id="S4.SS1.p2.5.m5.4.4.4.cmml" xref="S4.SS1.p2.5.m5.4.4.3"><apply id="S4.SS1.p2.5.m5.2.2.1.1.cmml" xref="S4.SS1.p2.5.m5.2.2.1.1"><times id="S4.SS1.p2.5.m5.2.2.1.1.1.cmml" xref="S4.SS1.p2.5.m5.2.2.1.1.1"></times><ci id="S4.SS1.p2.5.m5.2.2.1.1.2.cmml" xref="S4.SS1.p2.5.m5.2.2.1.1.2">`</ci><ci id="S4.SS1.p2.5.m5.2.2.1.1.3.cmml" xref="S4.SS1.p2.5.m5.2.2.1.1.3">`</ci><ci id="S4.SS1.p2.5.m5.2.2.1.1.4.cmml" xref="S4.SS1.p2.5.m5.2.2.1.1.4">A</ci><ci id="S4.SS1.p2.5.m5.2.2.1.1.5.cmml" xref="S4.SS1.p2.5.m5.2.2.1.1.5">"</ci></apply><apply id="S4.SS1.p2.5.m5.3.3.2.2.cmml" xref="S4.SS1.p2.5.m5.3.3.2.2"><times id="S4.SS1.p2.5.m5.3.3.2.2.1.cmml" xref="S4.SS1.p2.5.m5.3.3.2.2.1"></times><ci id="S4.SS1.p2.5.m5.3.3.2.2.2.cmml" xref="S4.SS1.p2.5.m5.3.3.2.2.2">`</ci><ci id="S4.SS1.p2.5.m5.3.3.2.2.3.cmml" xref="S4.SS1.p2.5.m5.3.3.2.2.3">`</ci><ci id="S4.SS1.p2.5.m5.3.3.2.2.4.cmml" xref="S4.SS1.p2.5.m5.3.3.2.2.4">B</ci><ci id="S4.SS1.p2.5.m5.3.3.2.2.5.cmml" xref="S4.SS1.p2.5.m5.3.3.2.2.5">"</ci></apply><apply id="S4.SS1.p2.5.m5.4.4.3.3.cmml" xref="S4.SS1.p2.5.m5.4.4.3.3"><times id="S4.SS1.p2.5.m5.4.4.3.3.1.cmml" xref="S4.SS1.p2.5.m5.4.4.3.3.1"></times><ci id="S4.SS1.p2.5.m5.4.4.3.3.2.cmml" xref="S4.SS1.p2.5.m5.4.4.3.3.2">`</ci><ci id="S4.SS1.p2.5.m5.4.4.3.3.3.cmml" xref="S4.SS1.p2.5.m5.4.4.3.3.3">`</ci><ci id="S4.SS1.p2.5.m5.4.4.3.3.4.cmml" xref="S4.SS1.p2.5.m5.4.4.3.3.4">C</ci><ci id="S4.SS1.p2.5.m5.4.4.3.3.5.cmml" xref="S4.SS1.p2.5.m5.4.4.3.3.5">"</ci></apply><ci id="S4.SS1.p2.5.m5.1.1.cmml" xref="S4.SS1.p2.5.m5.1.1">…</ci></set></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.5.m5.4c">\{\mathrm{``A",``B",``C",}\dots\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.5.m5.4d">{ ` ` roman_A " , ` ` roman_B " , ` ` roman_C " , … }</annotation></semantics></math> instead of the original label tokens. The results are shown in Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S4.F5" title="Figure 5 ‣ 4.1 Step 2, Forerunner Token Head: Copy from Text Feature to Label Token ‣ 4 Induction Circuits in Natural Language Models ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">5</span></a> (Left), where the kernel alignment between the hidden states of the label token and the forerunner token gradually increases and then bumps up after the encoding in the forerunner token (described in §<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S3" title="3 Step 1, Summarize: Linear Representations in Hidden States ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">3</span></a>) finished improving. It indicates that the hidden states of the input text representation encoded in the forerunner tokens are merged into their label tokens, suggesting the existence of copy processing from the forerunner token to the label token.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.7"><span class="ltx_text ltx_font_bold" id="S4.SS1.p3.7.1">Text Representations are Copied without Selectivity.</span> For each attention head, we extract the attention score <math alttext="\alpha_{y_{t}\rightarrow s_{t}}" class="ltx_Math" display="inline" id="S4.SS1.p3.1.m1.1"><semantics id="S4.SS1.p3.1.m1.1a"><msub id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml"><mi id="S4.SS1.p3.1.m1.1.1.2" xref="S4.SS1.p3.1.m1.1.1.2.cmml">α</mi><mrow id="S4.SS1.p3.1.m1.1.1.3" xref="S4.SS1.p3.1.m1.1.1.3.cmml"><msub id="S4.SS1.p3.1.m1.1.1.3.2" xref="S4.SS1.p3.1.m1.1.1.3.2.cmml"><mi id="S4.SS1.p3.1.m1.1.1.3.2.2" xref="S4.SS1.p3.1.m1.1.1.3.2.2.cmml">y</mi><mi id="S4.SS1.p3.1.m1.1.1.3.2.3" xref="S4.SS1.p3.1.m1.1.1.3.2.3.cmml">t</mi></msub><mo id="S4.SS1.p3.1.m1.1.1.3.1" stretchy="false" xref="S4.SS1.p3.1.m1.1.1.3.1.cmml">→</mo><msub id="S4.SS1.p3.1.m1.1.1.3.3" xref="S4.SS1.p3.1.m1.1.1.3.3.cmml"><mi id="S4.SS1.p3.1.m1.1.1.3.3.2" xref="S4.SS1.p3.1.m1.1.1.3.3.2.cmml">s</mi><mi id="S4.SS1.p3.1.m1.1.1.3.3.3" xref="S4.SS1.p3.1.m1.1.1.3.3.3.cmml">t</mi></msub></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><apply id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.1.m1.1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.p3.1.m1.1.1.2.cmml" xref="S4.SS1.p3.1.m1.1.1.2">𝛼</ci><apply id="S4.SS1.p3.1.m1.1.1.3.cmml" xref="S4.SS1.p3.1.m1.1.1.3"><ci id="S4.SS1.p3.1.m1.1.1.3.1.cmml" xref="S4.SS1.p3.1.m1.1.1.3.1">→</ci><apply id="S4.SS1.p3.1.m1.1.1.3.2.cmml" xref="S4.SS1.p3.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS1.p3.1.m1.1.1.3.2.1.cmml" xref="S4.SS1.p3.1.m1.1.1.3.2">subscript</csymbol><ci id="S4.SS1.p3.1.m1.1.1.3.2.2.cmml" xref="S4.SS1.p3.1.m1.1.1.3.2.2">𝑦</ci><ci id="S4.SS1.p3.1.m1.1.1.3.2.3.cmml" xref="S4.SS1.p3.1.m1.1.1.3.2.3">𝑡</ci></apply><apply id="S4.SS1.p3.1.m1.1.1.3.3.cmml" xref="S4.SS1.p3.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS1.p3.1.m1.1.1.3.3.1.cmml" xref="S4.SS1.p3.1.m1.1.1.3.3">subscript</csymbol><ci id="S4.SS1.p3.1.m1.1.1.3.3.2.cmml" xref="S4.SS1.p3.1.m1.1.1.3.3.2">𝑠</ci><ci id="S4.SS1.p3.1.m1.1.1.3.3.3.cmml" xref="S4.SS1.p3.1.m1.1.1.3.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">\alpha_{y_{t}\rightarrow s_{t}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.1.m1.1d">italic_α start_POSTSUBSCRIPT italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT → italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> from a label token <math alttext="y_{t}" class="ltx_Math" display="inline" id="S4.SS1.p3.2.m2.1"><semantics id="S4.SS1.p3.2.m2.1a"><msub id="S4.SS1.p3.2.m2.1.1" xref="S4.SS1.p3.2.m2.1.1.cmml"><mi id="S4.SS1.p3.2.m2.1.1.2" xref="S4.SS1.p3.2.m2.1.1.2.cmml">y</mi><mi id="S4.SS1.p3.2.m2.1.1.3" xref="S4.SS1.p3.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m2.1b"><apply id="S4.SS1.p3.2.m2.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.2.m2.1.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.p3.2.m2.1.1.2.cmml" xref="S4.SS1.p3.2.m2.1.1.2">𝑦</ci><ci id="S4.SS1.p3.2.m2.1.1.3.cmml" xref="S4.SS1.p3.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.2.m2.1c">y_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.2.m2.1d">italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> (as attention query) to the corresponding forerunner token <math alttext="s_{t}" class="ltx_Math" display="inline" id="S4.SS1.p3.3.m3.1"><semantics id="S4.SS1.p3.3.m3.1a"><msub id="S4.SS1.p3.3.m3.1.1" xref="S4.SS1.p3.3.m3.1.1.cmml"><mi id="S4.SS1.p3.3.m3.1.1.2" xref="S4.SS1.p3.3.m3.1.1.2.cmml">s</mi><mi id="S4.SS1.p3.3.m3.1.1.3" xref="S4.SS1.p3.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.3.m3.1b"><apply id="S4.SS1.p3.3.m3.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.3.m3.1.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1">subscript</csymbol><ci id="S4.SS1.p3.3.m3.1.1.2.cmml" xref="S4.SS1.p3.3.m3.1.1.2">𝑠</ci><ci id="S4.SS1.p3.3.m3.1.1.3.cmml" xref="S4.SS1.p3.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.3.m3.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.3.m3.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> (as attention keys). We then mark the head with <math alttext="\alpha_{y_{t}\rightarrow s_{t}}\geqslant 5/n_{t}" class="ltx_Math" display="inline" id="S4.SS1.p3.4.m4.1"><semantics id="S4.SS1.p3.4.m4.1a"><mrow id="S4.SS1.p3.4.m4.1.1" xref="S4.SS1.p3.4.m4.1.1.cmml"><msub id="S4.SS1.p3.4.m4.1.1.2" xref="S4.SS1.p3.4.m4.1.1.2.cmml"><mi id="S4.SS1.p3.4.m4.1.1.2.2" xref="S4.SS1.p3.4.m4.1.1.2.2.cmml">α</mi><mrow id="S4.SS1.p3.4.m4.1.1.2.3" xref="S4.SS1.p3.4.m4.1.1.2.3.cmml"><msub id="S4.SS1.p3.4.m4.1.1.2.3.2" xref="S4.SS1.p3.4.m4.1.1.2.3.2.cmml"><mi id="S4.SS1.p3.4.m4.1.1.2.3.2.2" xref="S4.SS1.p3.4.m4.1.1.2.3.2.2.cmml">y</mi><mi id="S4.SS1.p3.4.m4.1.1.2.3.2.3" xref="S4.SS1.p3.4.m4.1.1.2.3.2.3.cmml">t</mi></msub><mo id="S4.SS1.p3.4.m4.1.1.2.3.1" stretchy="false" xref="S4.SS1.p3.4.m4.1.1.2.3.1.cmml">→</mo><msub id="S4.SS1.p3.4.m4.1.1.2.3.3" xref="S4.SS1.p3.4.m4.1.1.2.3.3.cmml"><mi id="S4.SS1.p3.4.m4.1.1.2.3.3.2" xref="S4.SS1.p3.4.m4.1.1.2.3.3.2.cmml">s</mi><mi id="S4.SS1.p3.4.m4.1.1.2.3.3.3" xref="S4.SS1.p3.4.m4.1.1.2.3.3.3.cmml">t</mi></msub></mrow></msub><mo id="S4.SS1.p3.4.m4.1.1.1" xref="S4.SS1.p3.4.m4.1.1.1.cmml">⩾</mo><mrow id="S4.SS1.p3.4.m4.1.1.3" xref="S4.SS1.p3.4.m4.1.1.3.cmml"><mn id="S4.SS1.p3.4.m4.1.1.3.2" xref="S4.SS1.p3.4.m4.1.1.3.2.cmml">5</mn><mo id="S4.SS1.p3.4.m4.1.1.3.1" xref="S4.SS1.p3.4.m4.1.1.3.1.cmml">/</mo><msub id="S4.SS1.p3.4.m4.1.1.3.3" xref="S4.SS1.p3.4.m4.1.1.3.3.cmml"><mi id="S4.SS1.p3.4.m4.1.1.3.3.2" xref="S4.SS1.p3.4.m4.1.1.3.3.2.cmml">n</mi><mi id="S4.SS1.p3.4.m4.1.1.3.3.3" xref="S4.SS1.p3.4.m4.1.1.3.3.3.cmml">t</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.4.m4.1b"><apply id="S4.SS1.p3.4.m4.1.1.cmml" xref="S4.SS1.p3.4.m4.1.1"><geq id="S4.SS1.p3.4.m4.1.1.1.cmml" xref="S4.SS1.p3.4.m4.1.1.1"></geq><apply id="S4.SS1.p3.4.m4.1.1.2.cmml" xref="S4.SS1.p3.4.m4.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p3.4.m4.1.1.2.1.cmml" xref="S4.SS1.p3.4.m4.1.1.2">subscript</csymbol><ci id="S4.SS1.p3.4.m4.1.1.2.2.cmml" xref="S4.SS1.p3.4.m4.1.1.2.2">𝛼</ci><apply id="S4.SS1.p3.4.m4.1.1.2.3.cmml" xref="S4.SS1.p3.4.m4.1.1.2.3"><ci id="S4.SS1.p3.4.m4.1.1.2.3.1.cmml" xref="S4.SS1.p3.4.m4.1.1.2.3.1">→</ci><apply id="S4.SS1.p3.4.m4.1.1.2.3.2.cmml" xref="S4.SS1.p3.4.m4.1.1.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.p3.4.m4.1.1.2.3.2.1.cmml" xref="S4.SS1.p3.4.m4.1.1.2.3.2">subscript</csymbol><ci id="S4.SS1.p3.4.m4.1.1.2.3.2.2.cmml" xref="S4.SS1.p3.4.m4.1.1.2.3.2.2">𝑦</ci><ci id="S4.SS1.p3.4.m4.1.1.2.3.2.3.cmml" xref="S4.SS1.p3.4.m4.1.1.2.3.2.3">𝑡</ci></apply><apply id="S4.SS1.p3.4.m4.1.1.2.3.3.cmml" xref="S4.SS1.p3.4.m4.1.1.2.3.3"><csymbol cd="ambiguous" id="S4.SS1.p3.4.m4.1.1.2.3.3.1.cmml" xref="S4.SS1.p3.4.m4.1.1.2.3.3">subscript</csymbol><ci id="S4.SS1.p3.4.m4.1.1.2.3.3.2.cmml" xref="S4.SS1.p3.4.m4.1.1.2.3.3.2">𝑠</ci><ci id="S4.SS1.p3.4.m4.1.1.2.3.3.3.cmml" xref="S4.SS1.p3.4.m4.1.1.2.3.3.3">𝑡</ci></apply></apply></apply><apply id="S4.SS1.p3.4.m4.1.1.3.cmml" xref="S4.SS1.p3.4.m4.1.1.3"><divide id="S4.SS1.p3.4.m4.1.1.3.1.cmml" xref="S4.SS1.p3.4.m4.1.1.3.1"></divide><cn id="S4.SS1.p3.4.m4.1.1.3.2.cmml" type="integer" xref="S4.SS1.p3.4.m4.1.1.3.2">5</cn><apply id="S4.SS1.p3.4.m4.1.1.3.3.cmml" xref="S4.SS1.p3.4.m4.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS1.p3.4.m4.1.1.3.3.1.cmml" xref="S4.SS1.p3.4.m4.1.1.3.3">subscript</csymbol><ci id="S4.SS1.p3.4.m4.1.1.3.3.2.cmml" xref="S4.SS1.p3.4.m4.1.1.3.3.2">𝑛</ci><ci id="S4.SS1.p3.4.m4.1.1.3.3.3.cmml" xref="S4.SS1.p3.4.m4.1.1.3.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.4.m4.1c">\alpha_{y_{t}\rightarrow s_{t}}\geqslant 5/n_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.4.m4.1d">italic_α start_POSTSUBSCRIPT italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT → italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT ⩾ 5 / italic_n start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> (<math alttext="n_{t}" class="ltx_Math" display="inline" id="S4.SS1.p3.5.m5.1"><semantics id="S4.SS1.p3.5.m5.1a"><msub id="S4.SS1.p3.5.m5.1.1" xref="S4.SS1.p3.5.m5.1.1.cmml"><mi id="S4.SS1.p3.5.m5.1.1.2" xref="S4.SS1.p3.5.m5.1.1.2.cmml">n</mi><mi id="S4.SS1.p3.5.m5.1.1.3" xref="S4.SS1.p3.5.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.5.m5.1b"><apply id="S4.SS1.p3.5.m5.1.1.cmml" xref="S4.SS1.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.5.m5.1.1.1.cmml" xref="S4.SS1.p3.5.m5.1.1">subscript</csymbol><ci id="S4.SS1.p3.5.m5.1.1.2.cmml" xref="S4.SS1.p3.5.m5.1.1.2">𝑛</ci><ci id="S4.SS1.p3.5.m5.1.1.3.cmml" xref="S4.SS1.p3.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.5.m5.1c">n_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.5.m5.1d">italic_n start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>: the length of tokens before <math alttext="y_{t}" class="ltx_Math" display="inline" id="S4.SS1.p3.6.m6.1"><semantics id="S4.SS1.p3.6.m6.1a"><msub id="S4.SS1.p3.6.m6.1.1" xref="S4.SS1.p3.6.m6.1.1.cmml"><mi id="S4.SS1.p3.6.m6.1.1.2" xref="S4.SS1.p3.6.m6.1.1.2.cmml">y</mi><mi id="S4.SS1.p3.6.m6.1.1.3" xref="S4.SS1.p3.6.m6.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.6.m6.1b"><apply id="S4.SS1.p3.6.m6.1.1.cmml" xref="S4.SS1.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.6.m6.1.1.1.cmml" xref="S4.SS1.p3.6.m6.1.1">subscript</csymbol><ci id="S4.SS1.p3.6.m6.1.1.2.cmml" xref="S4.SS1.p3.6.m6.1.1.2">𝑦</ci><ci id="S4.SS1.p3.6.m6.1.1.3.cmml" xref="S4.SS1.p3.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.6.m6.1c">y_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.6.m6.1d">italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>) as a Forerunner Token Head and count them in each layer.
The results are shown in Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S4.F5" title="Figure 5 ‣ 4.1 Step 2, Forerunner Token Head: Copy from Text Feature to Label Token ‣ 4 Induction Circuits in Natural Language Models ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">5</span></a> (Middle, “Correct Label”), where the peak matches the copy period in Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S4.F5" title="Figure 5 ‣ 4.1 Step 2, Forerunner Token Head: Copy from Text Feature to Label Token ‣ 4 Induction Circuits in Natural Language Models ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">5</span></a> (Left). Moreover, to investigate the influence of the correctness of label tokens, we replace <math alttext="y_{t}" class="ltx_Math" display="inline" id="S4.SS1.p3.7.m7.1"><semantics id="S4.SS1.p3.7.m7.1a"><msub id="S4.SS1.p3.7.m7.1.1" xref="S4.SS1.p3.7.m7.1.1.cmml"><mi id="S4.SS1.p3.7.m7.1.1.2" xref="S4.SS1.p3.7.m7.1.1.2.cmml">y</mi><mi id="S4.SS1.p3.7.m7.1.1.3" xref="S4.SS1.p3.7.m7.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.7.m7.1b"><apply id="S4.SS1.p3.7.m7.1.1.cmml" xref="S4.SS1.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.7.m7.1.1.1.cmml" xref="S4.SS1.p3.7.m7.1.1">subscript</csymbol><ci id="S4.SS1.p3.7.m7.1.1.2.cmml" xref="S4.SS1.p3.7.m7.1.1.2">𝑦</ci><ci id="S4.SS1.p3.7.m7.1.1.3.cmml" xref="S4.SS1.p3.7.m7.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.7.m7.1c">y_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.7.m7.1d">italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> with a wrong label token<span class="ltx_note ltx_role_footnote" id="footnote7"><sup class="ltx_note_mark">7</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">7</sup><span class="ltx_tag ltx_tag_note">7</span>For example, for a label space of “positive” and “negative”, if <math alttext="y_{t}" class="ltx_Math" display="inline" id="footnote7.m1.1"><semantics id="footnote7.m1.1b"><msub id="footnote7.m1.1.1" xref="footnote7.m1.1.1.cmml"><mi id="footnote7.m1.1.1.2" xref="footnote7.m1.1.1.2.cmml">y</mi><mi id="footnote7.m1.1.1.3" xref="footnote7.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="footnote7.m1.1c"><apply id="footnote7.m1.1.1.cmml" xref="footnote7.m1.1.1"><csymbol cd="ambiguous" id="footnote7.m1.1.1.1.cmml" xref="footnote7.m1.1.1">subscript</csymbol><ci id="footnote7.m1.1.1.2.cmml" xref="footnote7.m1.1.1.2">𝑦</ci><ci id="footnote7.m1.1.1.3.cmml" xref="footnote7.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote7.m1.1d">y_{t}</annotation><annotation encoding="application/x-llamapun" id="footnote7.m1.1e">italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is “positive”, then replace it to “negative”.</span></span></span>, where the results in Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S4.F5" title="Figure 5 ‣ 4.1 Step 2, Forerunner Token Head: Copy from Text Feature to Label Token ‣ 4 Induction Circuits in Natural Language Models ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">5</span></a> (Middle, “Wrong Label”) are almost identical to the correct-label setting, suggesting that the forerunner token heads don’t show selectivity toward the semantic consistency between input text and labels simply merge the input text representations into the label tokens.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p4">
<p class="ltx_p" id="S4.SS1.p4.9"><span class="ltx_text ltx_font_bold" id="S4.SS1.p4.9.1">Hidden States of Label Tokens are Joint Representations of Text Encodings and Label Semantics.</span> Given the findings above, we probe the content of hidden states of label tokens <math alttext="[y_{t}]" class="ltx_Math" display="inline" id="S4.SS1.p4.1.m1.1"><semantics id="S4.SS1.p4.1.m1.1a"><mrow id="S4.SS1.p4.1.m1.1.1.1" xref="S4.SS1.p4.1.m1.1.1.2.cmml"><mo id="S4.SS1.p4.1.m1.1.1.1.2" stretchy="false" xref="S4.SS1.p4.1.m1.1.1.2.1.cmml">[</mo><msub id="S4.SS1.p4.1.m1.1.1.1.1" xref="S4.SS1.p4.1.m1.1.1.1.1.cmml"><mi id="S4.SS1.p4.1.m1.1.1.1.1.2" xref="S4.SS1.p4.1.m1.1.1.1.1.2.cmml">y</mi><mi id="S4.SS1.p4.1.m1.1.1.1.1.3" xref="S4.SS1.p4.1.m1.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.SS1.p4.1.m1.1.1.1.3" stretchy="false" xref="S4.SS1.p4.1.m1.1.1.2.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.1.m1.1b"><apply id="S4.SS1.p4.1.m1.1.1.2.cmml" xref="S4.SS1.p4.1.m1.1.1.1"><csymbol cd="latexml" id="S4.SS1.p4.1.m1.1.1.2.1.cmml" xref="S4.SS1.p4.1.m1.1.1.1.2">delimited-[]</csymbol><apply id="S4.SS1.p4.1.m1.1.1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p4.1.m1.1.1.1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p4.1.m1.1.1.1.1.2.cmml" xref="S4.SS1.p4.1.m1.1.1.1.1.2">𝑦</ci><ci id="S4.SS1.p4.1.m1.1.1.1.1.3.cmml" xref="S4.SS1.p4.1.m1.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.1.m1.1c">[y_{t}]</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.1.m1.1d">[ italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ]</annotation></semantics></math>, i.e., how the text representation interacts with the original label semantics. We first train two centroid classifiers to predict the corresponding label <math alttext="y_{t}" class="ltx_Math" display="inline" id="S4.SS1.p4.2.m2.1"><semantics id="S4.SS1.p4.2.m2.1a"><msub id="S4.SS1.p4.2.m2.1.1" xref="S4.SS1.p4.2.m2.1.1.cmml"><mi id="S4.SS1.p4.2.m2.1.1.2" xref="S4.SS1.p4.2.m2.1.1.2.cmml">y</mi><mi id="S4.SS1.p4.2.m2.1.1.3" xref="S4.SS1.p4.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.2.m2.1b"><apply id="S4.SS1.p4.2.m2.1.1.cmml" xref="S4.SS1.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p4.2.m2.1.1.1.cmml" xref="S4.SS1.p4.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.p4.2.m2.1.1.2.cmml" xref="S4.SS1.p4.2.m2.1.1.2">𝑦</ci><ci id="S4.SS1.p4.2.m2.1.1.3.cmml" xref="S4.SS1.p4.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.2.m2.1c">y_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.2.m2.1d">italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>: (1) <math alttext="\mathcal{C}_{f}" class="ltx_Math" display="inline" id="S4.SS1.p4.3.m3.1"><semantics id="S4.SS1.p4.3.m3.1a"><msub id="S4.SS1.p4.3.m3.1.1" xref="S4.SS1.p4.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p4.3.m3.1.1.2" xref="S4.SS1.p4.3.m3.1.1.2.cmml">𝒞</mi><mi id="S4.SS1.p4.3.m3.1.1.3" xref="S4.SS1.p4.3.m3.1.1.3.cmml">f</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.3.m3.1b"><apply id="S4.SS1.p4.3.m3.1.1.cmml" xref="S4.SS1.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p4.3.m3.1.1.1.cmml" xref="S4.SS1.p4.3.m3.1.1">subscript</csymbol><ci id="S4.SS1.p4.3.m3.1.1.2.cmml" xref="S4.SS1.p4.3.m3.1.1.2">𝒞</ci><ci id="S4.SS1.p4.3.m3.1.1.3.cmml" xref="S4.SS1.p4.3.m3.1.1.3">𝑓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.3.m3.1c">\mathcal{C}_{f}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.3.m3.1d">caligraphic_C start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT</annotation></semantics></math> trained on the hidden states of <span class="ltx_text ltx_font_italic" id="S4.SS1.p4.9.2">forerunner tokens</span> <math alttext="[s_{t}]" class="ltx_Math" display="inline" id="S4.SS1.p4.4.m4.1"><semantics id="S4.SS1.p4.4.m4.1a"><mrow id="S4.SS1.p4.4.m4.1.1.1" xref="S4.SS1.p4.4.m4.1.1.2.cmml"><mo id="S4.SS1.p4.4.m4.1.1.1.2" stretchy="false" xref="S4.SS1.p4.4.m4.1.1.2.1.cmml">[</mo><msub id="S4.SS1.p4.4.m4.1.1.1.1" xref="S4.SS1.p4.4.m4.1.1.1.1.cmml"><mi id="S4.SS1.p4.4.m4.1.1.1.1.2" xref="S4.SS1.p4.4.m4.1.1.1.1.2.cmml">s</mi><mi id="S4.SS1.p4.4.m4.1.1.1.1.3" xref="S4.SS1.p4.4.m4.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.SS1.p4.4.m4.1.1.1.3" stretchy="false" xref="S4.SS1.p4.4.m4.1.1.2.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.4.m4.1b"><apply id="S4.SS1.p4.4.m4.1.1.2.cmml" xref="S4.SS1.p4.4.m4.1.1.1"><csymbol cd="latexml" id="S4.SS1.p4.4.m4.1.1.2.1.cmml" xref="S4.SS1.p4.4.m4.1.1.1.2">delimited-[]</csymbol><apply id="S4.SS1.p4.4.m4.1.1.1.1.cmml" xref="S4.SS1.p4.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p4.4.m4.1.1.1.1.1.cmml" xref="S4.SS1.p4.4.m4.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p4.4.m4.1.1.1.1.2.cmml" xref="S4.SS1.p4.4.m4.1.1.1.1.2">𝑠</ci><ci id="S4.SS1.p4.4.m4.1.1.1.1.3.cmml" xref="S4.SS1.p4.4.m4.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.4.m4.1c">[s_{t}]</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.4.m4.1d">[ italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ]</annotation></semantics></math> and (2) <math alttext="\mathcal{C}_{l}" class="ltx_Math" display="inline" id="S4.SS1.p4.5.m5.1"><semantics id="S4.SS1.p4.5.m5.1a"><msub id="S4.SS1.p4.5.m5.1.1" xref="S4.SS1.p4.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p4.5.m5.1.1.2" xref="S4.SS1.p4.5.m5.1.1.2.cmml">𝒞</mi><mi id="S4.SS1.p4.5.m5.1.1.3" xref="S4.SS1.p4.5.m5.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.5.m5.1b"><apply id="S4.SS1.p4.5.m5.1.1.cmml" xref="S4.SS1.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p4.5.m5.1.1.1.cmml" xref="S4.SS1.p4.5.m5.1.1">subscript</csymbol><ci id="S4.SS1.p4.5.m5.1.1.2.cmml" xref="S4.SS1.p4.5.m5.1.1.2">𝒞</ci><ci id="S4.SS1.p4.5.m5.1.1.3.cmml" xref="S4.SS1.p4.5.m5.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.5.m5.1c">\mathcal{C}_{l}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.5.m5.1d">caligraphic_C start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math> trained on the hidden states of <span class="ltx_text ltx_font_italic" id="S4.SS1.p4.9.3">label tokens</span> <math alttext="[y_{t}]" class="ltx_Math" display="inline" id="S4.SS1.p4.6.m6.1"><semantics id="S4.SS1.p4.6.m6.1a"><mrow id="S4.SS1.p4.6.m6.1.1.1" xref="S4.SS1.p4.6.m6.1.1.2.cmml"><mo id="S4.SS1.p4.6.m6.1.1.1.2" stretchy="false" xref="S4.SS1.p4.6.m6.1.1.2.1.cmml">[</mo><msub id="S4.SS1.p4.6.m6.1.1.1.1" xref="S4.SS1.p4.6.m6.1.1.1.1.cmml"><mi id="S4.SS1.p4.6.m6.1.1.1.1.2" xref="S4.SS1.p4.6.m6.1.1.1.1.2.cmml">y</mi><mi id="S4.SS1.p4.6.m6.1.1.1.1.3" xref="S4.SS1.p4.6.m6.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.SS1.p4.6.m6.1.1.1.3" stretchy="false" xref="S4.SS1.p4.6.m6.1.1.2.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.6.m6.1b"><apply id="S4.SS1.p4.6.m6.1.1.2.cmml" xref="S4.SS1.p4.6.m6.1.1.1"><csymbol cd="latexml" id="S4.SS1.p4.6.m6.1.1.2.1.cmml" xref="S4.SS1.p4.6.m6.1.1.1.2">delimited-[]</csymbol><apply id="S4.SS1.p4.6.m6.1.1.1.1.cmml" xref="S4.SS1.p4.6.m6.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p4.6.m6.1.1.1.1.1.cmml" xref="S4.SS1.p4.6.m6.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p4.6.m6.1.1.1.1.2.cmml" xref="S4.SS1.p4.6.m6.1.1.1.1.2">𝑦</ci><ci id="S4.SS1.p4.6.m6.1.1.1.1.3.cmml" xref="S4.SS1.p4.6.m6.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.6.m6.1c">[y_{t}]</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.6.m6.1d">[ italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ]</annotation></semantics></math>. To check whether the label tokens include the information of forerunner tokens, we use <math alttext="\mathcal{C}_{f}" class="ltx_Math" display="inline" id="S4.SS1.p4.7.m7.1"><semantics id="S4.SS1.p4.7.m7.1a"><msub id="S4.SS1.p4.7.m7.1.1" xref="S4.SS1.p4.7.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p4.7.m7.1.1.2" xref="S4.SS1.p4.7.m7.1.1.2.cmml">𝒞</mi><mi id="S4.SS1.p4.7.m7.1.1.3" xref="S4.SS1.p4.7.m7.1.1.3.cmml">f</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.7.m7.1b"><apply id="S4.SS1.p4.7.m7.1.1.cmml" xref="S4.SS1.p4.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS1.p4.7.m7.1.1.1.cmml" xref="S4.SS1.p4.7.m7.1.1">subscript</csymbol><ci id="S4.SS1.p4.7.m7.1.1.2.cmml" xref="S4.SS1.p4.7.m7.1.1.2">𝒞</ci><ci id="S4.SS1.p4.7.m7.1.1.3.cmml" xref="S4.SS1.p4.7.m7.1.1.3">𝑓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.7.m7.1c">\mathcal{C}_{f}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.7.m7.1d">caligraphic_C start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT</annotation></semantics></math> to predict the label on the hidden state of label token <math alttext="[y_{t}]" class="ltx_Math" display="inline" id="S4.SS1.p4.8.m8.1"><semantics id="S4.SS1.p4.8.m8.1a"><mrow id="S4.SS1.p4.8.m8.1.1.1" xref="S4.SS1.p4.8.m8.1.1.2.cmml"><mo id="S4.SS1.p4.8.m8.1.1.1.2" stretchy="false" xref="S4.SS1.p4.8.m8.1.1.2.1.cmml">[</mo><msub id="S4.SS1.p4.8.m8.1.1.1.1" xref="S4.SS1.p4.8.m8.1.1.1.1.cmml"><mi id="S4.SS1.p4.8.m8.1.1.1.1.2" xref="S4.SS1.p4.8.m8.1.1.1.1.2.cmml">y</mi><mi id="S4.SS1.p4.8.m8.1.1.1.1.3" xref="S4.SS1.p4.8.m8.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.SS1.p4.8.m8.1.1.1.3" stretchy="false" xref="S4.SS1.p4.8.m8.1.1.2.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.8.m8.1b"><apply id="S4.SS1.p4.8.m8.1.1.2.cmml" xref="S4.SS1.p4.8.m8.1.1.1"><csymbol cd="latexml" id="S4.SS1.p4.8.m8.1.1.2.1.cmml" xref="S4.SS1.p4.8.m8.1.1.1.2">delimited-[]</csymbol><apply id="S4.SS1.p4.8.m8.1.1.1.1.cmml" xref="S4.SS1.p4.8.m8.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p4.8.m8.1.1.1.1.1.cmml" xref="S4.SS1.p4.8.m8.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p4.8.m8.1.1.1.1.2.cmml" xref="S4.SS1.p4.8.m8.1.1.1.1.2">𝑦</ci><ci id="S4.SS1.p4.8.m8.1.1.1.1.3.cmml" xref="S4.SS1.p4.8.m8.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.8.m8.1c">[y_{t}]</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.8.m8.1d">[ italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ]</annotation></semantics></math> in Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S4.F5" title="Figure 5 ‣ 4.1 Step 2, Forerunner Token Head: Copy from Text Feature to Label Token ‣ 4 Induction Circuits in Natural Language Models ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">5</span></a> (Right, solid). It shows that, during the copy processing, high classification accuracies can be achieved both on the correct label tokens and wrong label tokens, suggesting that the text features in the forerunner tokens can be partly and linearly detected in the label tokens. Moreover, results using <math alttext="\mathcal{C}_{l}" class="ltx_Math" display="inline" id="S4.SS1.p4.9.m9.1"><semantics id="S4.SS1.p4.9.m9.1a"><msub id="S4.SS1.p4.9.m9.1.1" xref="S4.SS1.p4.9.m9.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p4.9.m9.1.1.2" xref="S4.SS1.p4.9.m9.1.1.2.cmml">𝒞</mi><mi id="S4.SS1.p4.9.m9.1.1.3" xref="S4.SS1.p4.9.m9.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.9.m9.1b"><apply id="S4.SS1.p4.9.m9.1.1.cmml" xref="S4.SS1.p4.9.m9.1.1"><csymbol cd="ambiguous" id="S4.SS1.p4.9.m9.1.1.1.cmml" xref="S4.SS1.p4.9.m9.1.1">subscript</csymbol><ci id="S4.SS1.p4.9.m9.1.1.2.cmml" xref="S4.SS1.p4.9.m9.1.1.2">𝒞</ci><ci id="S4.SS1.p4.9.m9.1.1.3.cmml" xref="S4.SS1.p4.9.m9.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.9.m9.1c">\mathcal{C}_{l}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.9.m9.1d">caligraphic_C start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math> (dotted line) shows extreme results, suggesting the label information remains in the label token. So, we can conclude that: hidden states of label tokens are joint representations of label semantics and text representations.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p5">
<p class="ltx_p" id="S4.SS1.p5.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p5.1.1">Label Denoising is Conducted on the Overlap of Label Semantics and Text Representations.</span> Notice that in Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S4.F5" title="Figure 5 ‣ 4.1 Step 2, Forerunner Token Head: Copy from Text Feature to Label Token ‣ 4 Induction Circuits in Natural Language Models ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">5</span></a> (Right, solid), compared to the <span class="ltx_text" id="S4.SS1.p5.1.2" style="color:#FF7F0E;">typical results</span> predicted on the forerunner tokens, accuracies are improved on the <span class="ltx_text" id="S4.SS1.p5.1.3" style="color:#008000;">correct label</span> and suppressed on the <span class="ltx_text" id="S4.SS1.p5.1.4" style="color:#FF0000;">wrong label</span>, which suggests that information consistent with the label semantics is easier to be enhanced by the label tokens and vice versa, showing a feature selectivity on the consistency between the text representations and the label semantics. Given the observation that the information on label semantics and text features can be extracted separately and linearly, we can confirm that these two kinds of information are located in different sub-spaces of the hidden states, and <span class="ltx_text ltx_font_italic" id="S4.SS1.p5.1.5">linearly</span> merged by the attention operation of forerunner heads. Moreover, given the fact that there is no selectivity is observed in the copy behavior of the forerunner token head (Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S4.F5" title="Figure 5 ‣ 4.1 Step 2, Forerunner Token Head: Copy from Text Feature to Label Token ‣ 4 Induction Circuits in Natural Language Models ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">5</span></a> (Middle)), it is intuitive that the feature selectivity shown in Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S4.F5" title="Figure 5 ‣ 4.1 Step 2, Forerunner Token Head: Copy from Text Feature to Label Token ‣ 4 Induction Circuits in Natural Language Models ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">5</span></a> (Right) comes from the arithmetical interaction of feature vectors on the <span class="ltx_text ltx_font_italic" id="S4.SS1.p5.1.6">overlap</span> of sub-spaces between the label semantics and text features, making ICL stable against label noise&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Min et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib29" title="">2022</a>)</cite>. Moreover, as mentioned by&nbsp;<cite class="ltx_cite ltx_citemacro_cite">Wei et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib40" title="">2023</a>)</cite>, large models show poorer stability against label noise. We infer that the larger hidden dimensions in larger models lower the overlap between the sub-spaces of label semantics and text representations to reduce the interaction.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="S4.F5">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F5.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="195" id="S4.F5.sf1.g1" src="https://arxiv.org/html/2410.04468v1/x7.png" width="266">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F5.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="194" id="S4.F5.sf2.g1" src="https://arxiv.org/html/2410.04468v1/x8.png" width="290">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F5.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="195" id="S4.F5.sf3.g1" src="https://arxiv.org/html/2410.04468v1/x9.png" width="229">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Hidden states copy magnitude from forerunner tokens to label tokens against layers. <span class="ltx_text ltx_font_bold" id="S4.F5.16.1">Left:</span> Kernel alignment between the forerunner token (the copy source) and the label token of the next layer (the copy target). <span class="ltx_text ltx_font_bold" id="S4.F5.17.2">Middle:</span> <span class="ltx_text ltx_font_bold" id="S4.F5.18.3">Curves:</span> The count of marked forerunner token heads with correct and wrong labels; <span class="ltx_text ltx_font_bold" id="S4.F5.19.4">Colored Areas:</span> The maximum attention scores from forerunner token to query (<span class="ltx_text ltx_font_italic" id="S4.F5.20.5">copy magnitude</span>) with correct and wrong labels (detailed attention head statistical data is in Appendix&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A6.SS1" title="F.1 Attention Head Statistics ‣ Appendix F Augmentated Experiment Results ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">F.1</span></a>). <span class="ltx_text ltx_font_bold" id="S4.F5.21.6">Right:</span> Centroid classifier results predicted on the hidden states of correct and wrong <span class="ltx_text ltx_font_italic" id="S4.F5.22.7">label tokens</span>, on SST-2 and MR. (<span class="ltx_text ltx_font_bold" id="S4.F5.23.8">Solid:</span> Predicted by classifiers <math alttext="\mathcal{C}_{f}" class="ltx_Math" display="inline" id="S4.F5.3.m1.1"><semantics id="S4.F5.3.m1.1b"><msub id="S4.F5.3.m1.1.1" xref="S4.F5.3.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.F5.3.m1.1.1.2" xref="S4.F5.3.m1.1.1.2.cmml">𝒞</mi><mi id="S4.F5.3.m1.1.1.3" xref="S4.F5.3.m1.1.1.3.cmml">f</mi></msub><annotation-xml encoding="MathML-Content" id="S4.F5.3.m1.1c"><apply id="S4.F5.3.m1.1.1.cmml" xref="S4.F5.3.m1.1.1"><csymbol cd="ambiguous" id="S4.F5.3.m1.1.1.1.cmml" xref="S4.F5.3.m1.1.1">subscript</csymbol><ci id="S4.F5.3.m1.1.1.2.cmml" xref="S4.F5.3.m1.1.1.2">𝒞</ci><ci id="S4.F5.3.m1.1.1.3.cmml" xref="S4.F5.3.m1.1.1.3">𝑓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.3.m1.1d">\mathcal{C}_{f}</annotation><annotation encoding="application/x-llamapun" id="S4.F5.3.m1.1e">caligraphic_C start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT</annotation></semantics></math> trained on hidden states of <span class="ltx_text ltx_font_italic" id="S4.F5.24.9">forerunners</span>. <span class="ltx_text ltx_font_bold" id="S4.F5.25.10">Dotted:</span> Predicted by classifiers <math alttext="\mathcal{C}_{l}" class="ltx_Math" display="inline" id="S4.F5.4.m2.1"><semantics id="S4.F5.4.m2.1b"><msub id="S4.F5.4.m2.1.1" xref="S4.F5.4.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.F5.4.m2.1.1.2" xref="S4.F5.4.m2.1.1.2.cmml">𝒞</mi><mi id="S4.F5.4.m2.1.1.3" xref="S4.F5.4.m2.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S4.F5.4.m2.1c"><apply id="S4.F5.4.m2.1.1.cmml" xref="S4.F5.4.m2.1.1"><csymbol cd="ambiguous" id="S4.F5.4.m2.1.1.1.cmml" xref="S4.F5.4.m2.1.1">subscript</csymbol><ci id="S4.F5.4.m2.1.1.2.cmml" xref="S4.F5.4.m2.1.1.2">𝒞</ci><ci id="S4.F5.4.m2.1.1.3.cmml" xref="S4.F5.4.m2.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.4.m2.1d">\mathcal{C}_{l}</annotation><annotation encoding="application/x-llamapun" id="S4.F5.4.m2.1e">caligraphic_C start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math> trained on hidden states of <span class="ltx_text ltx_font_italic" id="S4.F5.26.11">label tokens</span>.)</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Step 3, Induction Head: Feature Retrieval on Task Subspace</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">This subsection examines the existence of the aforementioned induction heads, which retrieve similar label token features as the queries’ forerunner feature, and copy the retrieved features back to the query. We claim the necessity of multi-head attention in this process: correct feature retrieval can only be conducted on the subspace of the hidden space, which is captured by some attention heads.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.7"><span class="ltx_text ltx_font_bold" id="S4.SS2.p2.7.1">Induction is Correct in Minority Subspaces.</span> Similar to Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S4.F5" title="Figure 5 ‣ 4.1 Step 2, Forerunner Token Head: Copy from Text Feature to Label Token ‣ 4 Induction Circuits in Natural Language Models ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">5</span></a> (Middle), we mark (1) the attention heads with the sum of attention scores from the query’s forerunner token <math alttext="s_{q}" class="ltx_Math" display="inline" id="S4.SS2.p2.1.m1.1"><semantics id="S4.SS2.p2.1.m1.1a"><msub id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml"><mi id="S4.SS2.p2.1.m1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.2.cmml">s</mi><mi id="S4.SS2.p2.1.m1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><apply id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p2.1.m1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.2">𝑠</ci><ci id="S4.SS2.p2.1.m1.1.1.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">s_{q}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.1.m1.1d">italic_s start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> (as attention query) to all the label tokens <math alttext="[y_{1}],\dots,[y_{k}]" class="ltx_Math" display="inline" id="S4.SS2.p2.2.m2.3"><semantics id="S4.SS2.p2.2.m2.3a"><mrow id="S4.SS2.p2.2.m2.3.3.2" xref="S4.SS2.p2.2.m2.3.3.3.cmml"><mrow id="S4.SS2.p2.2.m2.2.2.1.1.1" xref="S4.SS2.p2.2.m2.2.2.1.1.2.cmml"><mo id="S4.SS2.p2.2.m2.2.2.1.1.1.2" stretchy="false" xref="S4.SS2.p2.2.m2.2.2.1.1.2.1.cmml">[</mo><msub id="S4.SS2.p2.2.m2.2.2.1.1.1.1" xref="S4.SS2.p2.2.m2.2.2.1.1.1.1.cmml"><mi id="S4.SS2.p2.2.m2.2.2.1.1.1.1.2" xref="S4.SS2.p2.2.m2.2.2.1.1.1.1.2.cmml">y</mi><mn id="S4.SS2.p2.2.m2.2.2.1.1.1.1.3" xref="S4.SS2.p2.2.m2.2.2.1.1.1.1.3.cmml">1</mn></msub><mo id="S4.SS2.p2.2.m2.2.2.1.1.1.3" stretchy="false" xref="S4.SS2.p2.2.m2.2.2.1.1.2.1.cmml">]</mo></mrow><mo id="S4.SS2.p2.2.m2.3.3.2.3" xref="S4.SS2.p2.2.m2.3.3.3.cmml">,</mo><mi id="S4.SS2.p2.2.m2.1.1" mathvariant="normal" xref="S4.SS2.p2.2.m2.1.1.cmml">…</mi><mo id="S4.SS2.p2.2.m2.3.3.2.4" xref="S4.SS2.p2.2.m2.3.3.3.cmml">,</mo><mrow id="S4.SS2.p2.2.m2.3.3.2.2.1" xref="S4.SS2.p2.2.m2.3.3.2.2.2.cmml"><mo id="S4.SS2.p2.2.m2.3.3.2.2.1.2" stretchy="false" xref="S4.SS2.p2.2.m2.3.3.2.2.2.1.cmml">[</mo><msub id="S4.SS2.p2.2.m2.3.3.2.2.1.1" xref="S4.SS2.p2.2.m2.3.3.2.2.1.1.cmml"><mi id="S4.SS2.p2.2.m2.3.3.2.2.1.1.2" xref="S4.SS2.p2.2.m2.3.3.2.2.1.1.2.cmml">y</mi><mi id="S4.SS2.p2.2.m2.3.3.2.2.1.1.3" xref="S4.SS2.p2.2.m2.3.3.2.2.1.1.3.cmml">k</mi></msub><mo id="S4.SS2.p2.2.m2.3.3.2.2.1.3" stretchy="false" xref="S4.SS2.p2.2.m2.3.3.2.2.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.3b"><list id="S4.SS2.p2.2.m2.3.3.3.cmml" xref="S4.SS2.p2.2.m2.3.3.2"><apply id="S4.SS2.p2.2.m2.2.2.1.1.2.cmml" xref="S4.SS2.p2.2.m2.2.2.1.1.1"><csymbol cd="latexml" id="S4.SS2.p2.2.m2.2.2.1.1.2.1.cmml" xref="S4.SS2.p2.2.m2.2.2.1.1.1.2">delimited-[]</csymbol><apply id="S4.SS2.p2.2.m2.2.2.1.1.1.1.cmml" xref="S4.SS2.p2.2.m2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.2.2.1.1.1.1.1.cmml" xref="S4.SS2.p2.2.m2.2.2.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p2.2.m2.2.2.1.1.1.1.2.cmml" xref="S4.SS2.p2.2.m2.2.2.1.1.1.1.2">𝑦</ci><cn id="S4.SS2.p2.2.m2.2.2.1.1.1.1.3.cmml" type="integer" xref="S4.SS2.p2.2.m2.2.2.1.1.1.1.3">1</cn></apply></apply><ci id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1">…</ci><apply id="S4.SS2.p2.2.m2.3.3.2.2.2.cmml" xref="S4.SS2.p2.2.m2.3.3.2.2.1"><csymbol cd="latexml" id="S4.SS2.p2.2.m2.3.3.2.2.2.1.cmml" xref="S4.SS2.p2.2.m2.3.3.2.2.1.2">delimited-[]</csymbol><apply id="S4.SS2.p2.2.m2.3.3.2.2.1.1.cmml" xref="S4.SS2.p2.2.m2.3.3.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.3.3.2.2.1.1.1.cmml" xref="S4.SS2.p2.2.m2.3.3.2.2.1.1">subscript</csymbol><ci id="S4.SS2.p2.2.m2.3.3.2.2.1.1.2.cmml" xref="S4.SS2.p2.2.m2.3.3.2.2.1.1.2">𝑦</ci><ci id="S4.SS2.p2.2.m2.3.3.2.2.1.1.3.cmml" xref="S4.SS2.p2.2.m2.3.3.2.2.1.1.3">𝑘</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.3c">[y_{1}],\dots,[y_{k}]</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.2.m2.3d">[ italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ] , … , [ italic_y start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ]</annotation></semantics></math> (as attention keys) in the demonstration more than <math alttext="5k/n_{t}" class="ltx_Math" display="inline" id="S4.SS2.p2.3.m3.1"><semantics id="S4.SS2.p2.3.m3.1a"><mrow id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml"><mrow id="S4.SS2.p2.3.m3.1.1.2" xref="S4.SS2.p2.3.m3.1.1.2.cmml"><mn id="S4.SS2.p2.3.m3.1.1.2.2" xref="S4.SS2.p2.3.m3.1.1.2.2.cmml">5</mn><mo id="S4.SS2.p2.3.m3.1.1.2.1" xref="S4.SS2.p2.3.m3.1.1.2.1.cmml">⁢</mo><mi id="S4.SS2.p2.3.m3.1.1.2.3" xref="S4.SS2.p2.3.m3.1.1.2.3.cmml">k</mi></mrow><mo id="S4.SS2.p2.3.m3.1.1.1" xref="S4.SS2.p2.3.m3.1.1.1.cmml">/</mo><msub id="S4.SS2.p2.3.m3.1.1.3" xref="S4.SS2.p2.3.m3.1.1.3.cmml"><mi id="S4.SS2.p2.3.m3.1.1.3.2" xref="S4.SS2.p2.3.m3.1.1.3.2.cmml">n</mi><mi id="S4.SS2.p2.3.m3.1.1.3.3" xref="S4.SS2.p2.3.m3.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><apply id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1"><divide id="S4.SS2.p2.3.m3.1.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1.1"></divide><apply id="S4.SS2.p2.3.m3.1.1.2.cmml" xref="S4.SS2.p2.3.m3.1.1.2"><times id="S4.SS2.p2.3.m3.1.1.2.1.cmml" xref="S4.SS2.p2.3.m3.1.1.2.1"></times><cn id="S4.SS2.p2.3.m3.1.1.2.2.cmml" type="integer" xref="S4.SS2.p2.3.m3.1.1.2.2">5</cn><ci id="S4.SS2.p2.3.m3.1.1.2.3.cmml" xref="S4.SS2.p2.3.m3.1.1.2.3">𝑘</ci></apply><apply id="S4.SS2.p2.3.m3.1.1.3.cmml" xref="S4.SS2.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p2.3.m3.1.1.3.1.cmml" xref="S4.SS2.p2.3.m3.1.1.3">subscript</csymbol><ci id="S4.SS2.p2.3.m3.1.1.3.2.cmml" xref="S4.SS2.p2.3.m3.1.1.3.2">𝑛</ci><ci id="S4.SS2.p2.3.m3.1.1.3.3.cmml" xref="S4.SS2.p2.3.m3.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">5k/n_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.3.m3.1d">5 italic_k / italic_n start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> as induction heads, and (2) attention heads with the sum of scores to all the correct label tokens more than <math alttext="5k/|\mathbb{Y}|n_{t}" class="ltx_Math" display="inline" id="S4.SS2.p2.4.m4.1"><semantics id="S4.SS2.p2.4.m4.1a"><mrow id="S4.SS2.p2.4.m4.1.2" xref="S4.SS2.p2.4.m4.1.2.cmml"><mrow id="S4.SS2.p2.4.m4.1.2.2" xref="S4.SS2.p2.4.m4.1.2.2.cmml"><mrow id="S4.SS2.p2.4.m4.1.2.2.2" xref="S4.SS2.p2.4.m4.1.2.2.2.cmml"><mn id="S4.SS2.p2.4.m4.1.2.2.2.2" xref="S4.SS2.p2.4.m4.1.2.2.2.2.cmml">5</mn><mo id="S4.SS2.p2.4.m4.1.2.2.2.1" xref="S4.SS2.p2.4.m4.1.2.2.2.1.cmml">⁢</mo><mi id="S4.SS2.p2.4.m4.1.2.2.2.3" xref="S4.SS2.p2.4.m4.1.2.2.2.3.cmml">k</mi></mrow><mo id="S4.SS2.p2.4.m4.1.2.2.1" xref="S4.SS2.p2.4.m4.1.2.2.1.cmml">/</mo><mrow id="S4.SS2.p2.4.m4.1.2.2.3.2" xref="S4.SS2.p2.4.m4.1.2.2.3.1.cmml"><mo id="S4.SS2.p2.4.m4.1.2.2.3.2.1" stretchy="false" xref="S4.SS2.p2.4.m4.1.2.2.3.1.1.cmml">|</mo><mi id="S4.SS2.p2.4.m4.1.1" xref="S4.SS2.p2.4.m4.1.1.cmml">𝕐</mi><mo id="S4.SS2.p2.4.m4.1.2.2.3.2.2" stretchy="false" xref="S4.SS2.p2.4.m4.1.2.2.3.1.1.cmml">|</mo></mrow></mrow><mo id="S4.SS2.p2.4.m4.1.2.1" xref="S4.SS2.p2.4.m4.1.2.1.cmml">⁢</mo><msub id="S4.SS2.p2.4.m4.1.2.3" xref="S4.SS2.p2.4.m4.1.2.3.cmml"><mi id="S4.SS2.p2.4.m4.1.2.3.2" xref="S4.SS2.p2.4.m4.1.2.3.2.cmml">n</mi><mi id="S4.SS2.p2.4.m4.1.2.3.3" xref="S4.SS2.p2.4.m4.1.2.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m4.1b"><apply id="S4.SS2.p2.4.m4.1.2.cmml" xref="S4.SS2.p2.4.m4.1.2"><times id="S4.SS2.p2.4.m4.1.2.1.cmml" xref="S4.SS2.p2.4.m4.1.2.1"></times><apply id="S4.SS2.p2.4.m4.1.2.2.cmml" xref="S4.SS2.p2.4.m4.1.2.2"><divide id="S4.SS2.p2.4.m4.1.2.2.1.cmml" xref="S4.SS2.p2.4.m4.1.2.2.1"></divide><apply id="S4.SS2.p2.4.m4.1.2.2.2.cmml" xref="S4.SS2.p2.4.m4.1.2.2.2"><times id="S4.SS2.p2.4.m4.1.2.2.2.1.cmml" xref="S4.SS2.p2.4.m4.1.2.2.2.1"></times><cn id="S4.SS2.p2.4.m4.1.2.2.2.2.cmml" type="integer" xref="S4.SS2.p2.4.m4.1.2.2.2.2">5</cn><ci id="S4.SS2.p2.4.m4.1.2.2.2.3.cmml" xref="S4.SS2.p2.4.m4.1.2.2.2.3">𝑘</ci></apply><apply id="S4.SS2.p2.4.m4.1.2.2.3.1.cmml" xref="S4.SS2.p2.4.m4.1.2.2.3.2"><abs id="S4.SS2.p2.4.m4.1.2.2.3.1.1.cmml" xref="S4.SS2.p2.4.m4.1.2.2.3.2.1"></abs><ci id="S4.SS2.p2.4.m4.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1">𝕐</ci></apply></apply><apply id="S4.SS2.p2.4.m4.1.2.3.cmml" xref="S4.SS2.p2.4.m4.1.2.3"><csymbol cd="ambiguous" id="S4.SS2.p2.4.m4.1.2.3.1.cmml" xref="S4.SS2.p2.4.m4.1.2.3">subscript</csymbol><ci id="S4.SS2.p2.4.m4.1.2.3.2.cmml" xref="S4.SS2.p2.4.m4.1.2.3.2">𝑛</ci><ci id="S4.SS2.p2.4.m4.1.2.3.3.cmml" xref="S4.SS2.p2.4.m4.1.2.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m4.1c">5k/|\mathbb{Y}|n_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.4.m4.1d">5 italic_k / | blackboard_Y | italic_n start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> as <span class="ltx_text ltx_font_italic" id="S4.SS2.p2.7.2">correct</span> induction heads (<math alttext="\mathbb{Y}" class="ltx_Math" display="inline" id="S4.SS2.p2.5.m5.1"><semantics id="S4.SS2.p2.5.m5.1a"><mi id="S4.SS2.p2.5.m5.1.1" xref="S4.SS2.p2.5.m5.1.1.cmml">𝕐</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.5.m5.1b"><ci id="S4.SS2.p2.5.m5.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1">𝕐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.5.m5.1c">\mathbb{Y}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.5.m5.1d">blackboard_Y</annotation></semantics></math> is a label space). We show the number of both kinds of induction heads in Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S4.F6" title="Figure 6 ‣ 4.2 Step 3, Induction Head: Feature Retrieval on Task Subspace ‣ 4 Induction Circuits in Natural Language Models ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">6</span></a> (Left, detailed head statistics in Appendix&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A6.SS1" title="F.1 Attention Head Statistics ‣ Appendix F Augmentated Experiment Results ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">F.1</span></a>), where a unimodal pattern is observed later than the copy processing of Step 2. Moreover, more than half of the induction heads are not correct ones, suggesting that task-specific feature similarity can only be caught on some <span class="ltx_text ltx_font_italic" id="S4.SS2.p2.7.3">induction subspaces</span> (defined by low-rank transition matrix <math alttext="W_{Q}^{h\top}W_{K}^{h}" class="ltx_Math" display="inline" id="S4.SS2.p2.6.m6.1"><semantics id="S4.SS2.p2.6.m6.1a"><mrow id="S4.SS2.p2.6.m6.1.1" xref="S4.SS2.p2.6.m6.1.1.cmml"><msubsup id="S4.SS2.p2.6.m6.1.1.2" xref="S4.SS2.p2.6.m6.1.1.2.cmml"><mi id="S4.SS2.p2.6.m6.1.1.2.2.2" xref="S4.SS2.p2.6.m6.1.1.2.2.2.cmml">W</mi><mi id="S4.SS2.p2.6.m6.1.1.2.2.3" xref="S4.SS2.p2.6.m6.1.1.2.2.3.cmml">Q</mi><mrow id="S4.SS2.p2.6.m6.1.1.2.3" xref="S4.SS2.p2.6.m6.1.1.2.3.cmml"><mi id="S4.SS2.p2.6.m6.1.1.2.3.2" xref="S4.SS2.p2.6.m6.1.1.2.3.2.cmml">h</mi><mo id="S4.SS2.p2.6.m6.1.1.2.3.3" lspace="0.222em" xref="S4.SS2.p2.6.m6.1.1.2.3.3.cmml">⊤</mo></mrow></msubsup><mo id="S4.SS2.p2.6.m6.1.1.1" xref="S4.SS2.p2.6.m6.1.1.1.cmml">⁢</mo><msubsup id="S4.SS2.p2.6.m6.1.1.3" xref="S4.SS2.p2.6.m6.1.1.3.cmml"><mi id="S4.SS2.p2.6.m6.1.1.3.2.2" xref="S4.SS2.p2.6.m6.1.1.3.2.2.cmml">W</mi><mi id="S4.SS2.p2.6.m6.1.1.3.2.3" xref="S4.SS2.p2.6.m6.1.1.3.2.3.cmml">K</mi><mi id="S4.SS2.p2.6.m6.1.1.3.3" xref="S4.SS2.p2.6.m6.1.1.3.3.cmml">h</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.6.m6.1b"><apply id="S4.SS2.p2.6.m6.1.1.cmml" xref="S4.SS2.p2.6.m6.1.1"><times id="S4.SS2.p2.6.m6.1.1.1.cmml" xref="S4.SS2.p2.6.m6.1.1.1"></times><apply id="S4.SS2.p2.6.m6.1.1.2.cmml" xref="S4.SS2.p2.6.m6.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p2.6.m6.1.1.2.1.cmml" xref="S4.SS2.p2.6.m6.1.1.2">superscript</csymbol><apply id="S4.SS2.p2.6.m6.1.1.2.2.cmml" xref="S4.SS2.p2.6.m6.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p2.6.m6.1.1.2.2.1.cmml" xref="S4.SS2.p2.6.m6.1.1.2">subscript</csymbol><ci id="S4.SS2.p2.6.m6.1.1.2.2.2.cmml" xref="S4.SS2.p2.6.m6.1.1.2.2.2">𝑊</ci><ci id="S4.SS2.p2.6.m6.1.1.2.2.3.cmml" xref="S4.SS2.p2.6.m6.1.1.2.2.3">𝑄</ci></apply><apply id="S4.SS2.p2.6.m6.1.1.2.3.cmml" xref="S4.SS2.p2.6.m6.1.1.2.3"><csymbol cd="latexml" id="S4.SS2.p2.6.m6.1.1.2.3.1.cmml" xref="S4.SS2.p2.6.m6.1.1.2.3">limit-from</csymbol><ci id="S4.SS2.p2.6.m6.1.1.2.3.2.cmml" xref="S4.SS2.p2.6.m6.1.1.2.3.2">ℎ</ci><csymbol cd="latexml" id="S4.SS2.p2.6.m6.1.1.2.3.3.cmml" xref="S4.SS2.p2.6.m6.1.1.2.3.3">top</csymbol></apply></apply><apply id="S4.SS2.p2.6.m6.1.1.3.cmml" xref="S4.SS2.p2.6.m6.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p2.6.m6.1.1.3.1.cmml" xref="S4.SS2.p2.6.m6.1.1.3">superscript</csymbol><apply id="S4.SS2.p2.6.m6.1.1.3.2.cmml" xref="S4.SS2.p2.6.m6.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p2.6.m6.1.1.3.2.1.cmml" xref="S4.SS2.p2.6.m6.1.1.3">subscript</csymbol><ci id="S4.SS2.p2.6.m6.1.1.3.2.2.cmml" xref="S4.SS2.p2.6.m6.1.1.3.2.2">𝑊</ci><ci id="S4.SS2.p2.6.m6.1.1.3.2.3.cmml" xref="S4.SS2.p2.6.m6.1.1.3.2.3">𝐾</ci></apply><ci id="S4.SS2.p2.6.m6.1.1.3.3.cmml" xref="S4.SS2.p2.6.m6.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.6.m6.1c">W_{Q}^{h\top}W_{K}^{h}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.6.m6.1d">italic_W start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_h ⊤ end_POSTSUPERSCRIPT italic_W start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_h end_POSTSUPERSCRIPT</annotation></semantics></math> of correct induction head <math alttext="h" class="ltx_Math" display="inline" id="S4.SS2.p2.7.m7.1"><semantics id="S4.SS2.p2.7.m7.1a"><mi id="S4.SS2.p2.7.m7.1.1" xref="S4.SS2.p2.7.m7.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.7.m7.1b"><ci id="S4.SS2.p2.7.m7.1.1.cmml" xref="S4.SS2.p2.7.m7.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.7.m7.1c">h</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.7.m7.1d">italic_h</annotation></semantics></math>). We enhance this claim in Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S4.F6" title="Figure 6 ‣ 4.2 Step 3, Induction Head: Feature Retrieval on Task Subspace ‣ 4 Induction Circuits in Natural Language Models ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">6</span></a> (Middle) (details in Appendix&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A1.SS4" title="A.4 Cartography Details of Fig. 6 (Middle) ‣ Appendix A Experiment Details and Settings ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">A.4</span></a>), where both vanilla attention (without transformation and head split) and attention scores averaged among heads show low assignment on correct label tokens, while some heads show considerable correctness. Considering the average value,
the majority of attention heads almost randomly copy label token information to the query, causing the prediction biased to the frequency of labels in the prompt&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Zhao et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib47" title="">2021</a>)</cite>. As the reason, we infer that the hidden states are sufficient (Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S3.F3" title="Figure 3 ‣ 3.2 Text Summarization is Linear and Task-Relevant but Position-biased ‣ 3 Step 1, Summarize: Linear Representations in Hidden States ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">3</span></a>) but not minimum for ICL, where redundant information interferes with the similarity calculation of attention.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="S4.F6">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F6.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="209" id="S4.F6.sf1.g1" src="https://arxiv.org/html/2410.04468v1/x10.png" width="276">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F6.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="207" id="S4.F6.sf2.g1" src="https://arxiv.org/html/2410.04468v1/x11.png" width="276">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F6.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="206" id="S4.F6.sf3.g1" src="https://arxiv.org/html/2410.04468v1/x12.png" width="207">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Measurements for induction heads. <span class="ltx_text ltx_font_bold" id="S4.F6.7.1">Left:</span> The count of marked induction heads and correct induction heads against layers. <span class="ltx_text ltx_font_bold" id="S4.F6.8.2">Middle:</span> The correctness of attention assignment (the sum of assignment towards correct label tokens normalized by assignment towards all the label tokens). (<span class="ltx_text ltx_font_bold" id="S4.F6.9.3">Vanilla Attention:</span> attention scores directly calculated on full dimensionality. <span class="ltx_text ltx_font_bold" id="S4.F6.10.4">Head Average:</span> the averaged attention scores among all the heads. <span class="ltx_text ltx_font_bold" id="S4.F6.11.5">Best Ind. Head:</span> the scores of attention head with the most correctness.) <span class="ltx_text ltx_font_bold" id="S4.F6.12.6">Right:</span> The correct induction heads overlap of all dataset pairs.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure ltx_align_floatright" id="S4.F7">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" height="176" id="S4.F7.g1" src="https://arxiv.org/html/2410.04468v1/x13.png" width="160"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" height="176" id="S4.F7.g2" src="https://arxiv.org/html/2410.04468v1/x14.png" width="157"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Label representations of <math alttext="k" class="ltx_Math" display="inline" id="S4.F7.5.m1.1"><semantics id="S4.F7.5.m1.1b"><mi id="S4.F7.5.m1.1.1" xref="S4.F7.5.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.F7.5.m1.1c"><ci id="S4.F7.5.m1.1.1.cmml" xref="S4.F7.5.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F7.5.m1.1d">k</annotation><annotation encoding="application/x-llamapun" id="S4.F7.5.m1.1e">italic_k</annotation></semantics></math> demonstrations visualized on (<span class="ltx_text ltx_font_bold" id="S4.F7.13.1">Left 4</span>) correct and (<span class="ltx_text ltx_font_bold" id="S4.F7.14.2">Right 4</span>) wrong induction head, on one sample of SST-2 (see Appendix&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A6.SS3" title="F.3 More Results of Fig. 7 ‣ Appendix F Augmentated Experiment Results ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">F.3</span></a>). <math alttext="\circ" class="ltx_Math" display="inline" id="S4.F7.6.m2.1"><semantics id="S4.F7.6.m2.1b"><mo id="S4.F7.6.m2.1.1" xref="S4.F7.6.m2.1.1.cmml">∘</mo><annotation-xml encoding="MathML-Content" id="S4.F7.6.m2.1c"><compose id="S4.F7.6.m2.1.1.cmml" xref="S4.F7.6.m2.1.1"></compose></annotation-xml><annotation encoding="application/x-tex" id="S4.F7.6.m2.1d">\circ</annotation><annotation encoding="application/x-llamapun" id="S4.F7.6.m2.1e">∘</annotation></semantics></math>: “positive” label, <math alttext="\times" class="ltx_Math" display="inline" id="S4.F7.7.m3.1"><semantics id="S4.F7.7.m3.1b"><mo id="S4.F7.7.m3.1.1" xref="S4.F7.7.m3.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.F7.7.m3.1c"><times id="S4.F7.7.m3.1.1.cmml" xref="S4.F7.7.m3.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.F7.7.m3.1d">\times</annotation><annotation encoding="application/x-llamapun" id="S4.F7.7.m3.1e">×</annotation></semantics></math>: “negative” label, <math alttext="\blacktriangle" class="ltx_Math" display="inline" id="S4.F7.8.m4.1"><semantics id="S4.F7.8.m4.1b"><mi id="S4.F7.8.m4.1.1" mathvariant="normal" xref="S4.F7.8.m4.1.1.cmml">▲</mi><annotation-xml encoding="MathML-Content" id="S4.F7.8.m4.1c"><ci id="S4.F7.8.m4.1.1.cmml" xref="S4.F7.8.m4.1.1">▲</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F7.8.m4.1d">\blacktriangle</annotation><annotation encoding="application/x-llamapun" id="S4.F7.8.m4.1e">▲</annotation></semantics></math>: zero vector. Color: attention assigned to query, <span class="ltx_text" id="S4.F7.15.3" style="color:#FF1E1E;">negative</span> to <span class="ltx_text" id="S4.F7.16.4" style="color:#08306B;">positive</span> (cartography: Appendix&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A1.SS5" title="A.5 Cartography Details of Fig. 7 ‣ Appendix A Experiment Details and Settings ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">A.5</span></a>).</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.4"><span class="ltx_text ltx_font_bold" id="S4.SS2.p3.4.1">Some Induction Subspaces are Task-specific.</span> We check if different tasks share the same induction subspaces based on the overlap of the correct induction heads across different datasets. Given <math alttext="n_{\mathcal{D}}(h)" class="ltx_Math" display="inline" id="S4.SS2.p3.1.m1.1"><semantics id="S4.SS2.p3.1.m1.1a"><mrow id="S4.SS2.p3.1.m1.1.2" xref="S4.SS2.p3.1.m1.1.2.cmml"><msub id="S4.SS2.p3.1.m1.1.2.2" xref="S4.SS2.p3.1.m1.1.2.2.cmml"><mi id="S4.SS2.p3.1.m1.1.2.2.2" xref="S4.SS2.p3.1.m1.1.2.2.2.cmml">n</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p3.1.m1.1.2.2.3" xref="S4.SS2.p3.1.m1.1.2.2.3.cmml">𝒟</mi></msub><mo id="S4.SS2.p3.1.m1.1.2.1" xref="S4.SS2.p3.1.m1.1.2.1.cmml">⁢</mo><mrow id="S4.SS2.p3.1.m1.1.2.3.2" xref="S4.SS2.p3.1.m1.1.2.cmml"><mo id="S4.SS2.p3.1.m1.1.2.3.2.1" stretchy="false" xref="S4.SS2.p3.1.m1.1.2.cmml">(</mo><mi id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml">h</mi><mo id="S4.SS2.p3.1.m1.1.2.3.2.2" stretchy="false" xref="S4.SS2.p3.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b"><apply id="S4.SS2.p3.1.m1.1.2.cmml" xref="S4.SS2.p3.1.m1.1.2"><times id="S4.SS2.p3.1.m1.1.2.1.cmml" xref="S4.SS2.p3.1.m1.1.2.1"></times><apply id="S4.SS2.p3.1.m1.1.2.2.cmml" xref="S4.SS2.p3.1.m1.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p3.1.m1.1.2.2.1.cmml" xref="S4.SS2.p3.1.m1.1.2.2">subscript</csymbol><ci id="S4.SS2.p3.1.m1.1.2.2.2.cmml" xref="S4.SS2.p3.1.m1.1.2.2.2">𝑛</ci><ci id="S4.SS2.p3.1.m1.1.2.2.3.cmml" xref="S4.SS2.p3.1.m1.1.2.2.3">𝒟</ci></apply><ci id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">n_{\mathcal{D}}(h)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.1.m1.1d">italic_n start_POSTSUBSCRIPT caligraphic_D end_POSTSUBSCRIPT ( italic_h )</annotation></semantics></math>, the number of times <math alttext="h" class="ltx_Math" display="inline" id="S4.SS2.p3.2.m2.1"><semantics id="S4.SS2.p3.2.m2.1a"><mi id="S4.SS2.p3.2.m2.1.1" xref="S4.SS2.p3.2.m2.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.1b"><ci id="S4.SS2.p3.2.m2.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.1c">h</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.2.m2.1d">italic_h</annotation></semantics></math> is marked as correct induction head on dataset <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S4.SS2.p3.3.m3.1"><semantics id="S4.SS2.p3.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p3.3.m3.1.1" xref="S4.SS2.p3.3.m3.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.3.m3.1b"><ci id="S4.SS2.p3.3.m3.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.3.m3.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.3.m3.1d">caligraphic_D</annotation></semantics></math>, the overlap rate <math alttext="S" class="ltx_Math" display="inline" id="S4.SS2.p3.4.m4.1"><semantics id="S4.SS2.p3.4.m4.1a"><mi id="S4.SS2.p3.4.m4.1.1" xref="S4.SS2.p3.4.m4.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.4.m4.1b"><ci id="S4.SS2.p3.4.m4.1.1.cmml" xref="S4.SS2.p3.4.m4.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.4.m4.1c">S</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.4.m4.1d">italic_S</annotation></semantics></math> is defined as:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S4.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="S(\mathcal{D}_{1},\mathcal{D}_{2})=\frac{2\sum_{\forall h}\mathrm{min}[n_{%
\mathcal{D}_{1}}(h),n_{\mathcal{D}_{2}}(h)]}{\sum_{\forall h}n_{\mathcal{D}_{1%
}}(h)+n_{\mathcal{D}_{2}}(h)}." class="ltx_Math" display="block" id="S4.E1.m1.7"><semantics id="S4.E1.m1.7a"><mrow id="S4.E1.m1.7.7.1" xref="S4.E1.m1.7.7.1.1.cmml"><mrow id="S4.E1.m1.7.7.1.1" xref="S4.E1.m1.7.7.1.1.cmml"><mrow id="S4.E1.m1.7.7.1.1.2" xref="S4.E1.m1.7.7.1.1.2.cmml"><mi id="S4.E1.m1.7.7.1.1.2.4" xref="S4.E1.m1.7.7.1.1.2.4.cmml">S</mi><mo id="S4.E1.m1.7.7.1.1.2.3" xref="S4.E1.m1.7.7.1.1.2.3.cmml">⁢</mo><mrow id="S4.E1.m1.7.7.1.1.2.2.2" xref="S4.E1.m1.7.7.1.1.2.2.3.cmml"><mo id="S4.E1.m1.7.7.1.1.2.2.2.3" stretchy="false" xref="S4.E1.m1.7.7.1.1.2.2.3.cmml">(</mo><msub id="S4.E1.m1.7.7.1.1.1.1.1.1" xref="S4.E1.m1.7.7.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E1.m1.7.7.1.1.1.1.1.1.2" xref="S4.E1.m1.7.7.1.1.1.1.1.1.2.cmml">𝒟</mi><mn id="S4.E1.m1.7.7.1.1.1.1.1.1.3" xref="S4.E1.m1.7.7.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S4.E1.m1.7.7.1.1.2.2.2.4" xref="S4.E1.m1.7.7.1.1.2.2.3.cmml">,</mo><msub id="S4.E1.m1.7.7.1.1.2.2.2.2" xref="S4.E1.m1.7.7.1.1.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E1.m1.7.7.1.1.2.2.2.2.2" xref="S4.E1.m1.7.7.1.1.2.2.2.2.2.cmml">𝒟</mi><mn id="S4.E1.m1.7.7.1.1.2.2.2.2.3" xref="S4.E1.m1.7.7.1.1.2.2.2.2.3.cmml">2</mn></msub><mo id="S4.E1.m1.7.7.1.1.2.2.2.5" stretchy="false" xref="S4.E1.m1.7.7.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E1.m1.7.7.1.1.3" xref="S4.E1.m1.7.7.1.1.3.cmml">=</mo><mfrac id="S4.E1.m1.6.6" xref="S4.E1.m1.6.6.cmml"><mrow id="S4.E1.m1.4.4.4" xref="S4.E1.m1.4.4.4.cmml"><mn id="S4.E1.m1.4.4.4.6" xref="S4.E1.m1.4.4.4.6.cmml">2</mn><mo id="S4.E1.m1.4.4.4.5" xref="S4.E1.m1.4.4.4.5.cmml">⁢</mo><mrow id="S4.E1.m1.4.4.4.4" xref="S4.E1.m1.4.4.4.4.cmml"><msub id="S4.E1.m1.4.4.4.4.3" xref="S4.E1.m1.4.4.4.4.3.cmml"><mo id="S4.E1.m1.4.4.4.4.3.2" xref="S4.E1.m1.4.4.4.4.3.2.cmml">∑</mo><mrow id="S4.E1.m1.4.4.4.4.3.3" xref="S4.E1.m1.4.4.4.4.3.3.cmml"><mo id="S4.E1.m1.4.4.4.4.3.3.1" rspace="0.167em" xref="S4.E1.m1.4.4.4.4.3.3.1.cmml">∀</mo><mi id="S4.E1.m1.4.4.4.4.3.3.2" xref="S4.E1.m1.4.4.4.4.3.3.2.cmml">h</mi></mrow></msub><mrow id="S4.E1.m1.4.4.4.4.2" xref="S4.E1.m1.4.4.4.4.2.cmml"><mi id="S4.E1.m1.4.4.4.4.2.4" xref="S4.E1.m1.4.4.4.4.2.4.cmml">min</mi><mo id="S4.E1.m1.4.4.4.4.2.3" xref="S4.E1.m1.4.4.4.4.2.3.cmml">⁢</mo><mrow id="S4.E1.m1.4.4.4.4.2.2.2" xref="S4.E1.m1.4.4.4.4.2.2.3.cmml"><mo id="S4.E1.m1.4.4.4.4.2.2.2.3" stretchy="false" xref="S4.E1.m1.4.4.4.4.2.2.3.cmml">[</mo><mrow id="S4.E1.m1.3.3.3.3.1.1.1.1" xref="S4.E1.m1.3.3.3.3.1.1.1.1.cmml"><msub id="S4.E1.m1.3.3.3.3.1.1.1.1.2" xref="S4.E1.m1.3.3.3.3.1.1.1.1.2.cmml"><mi id="S4.E1.m1.3.3.3.3.1.1.1.1.2.2" xref="S4.E1.m1.3.3.3.3.1.1.1.1.2.2.cmml">n</mi><msub id="S4.E1.m1.3.3.3.3.1.1.1.1.2.3" xref="S4.E1.m1.3.3.3.3.1.1.1.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E1.m1.3.3.3.3.1.1.1.1.2.3.2" xref="S4.E1.m1.3.3.3.3.1.1.1.1.2.3.2.cmml">𝒟</mi><mn id="S4.E1.m1.3.3.3.3.1.1.1.1.2.3.3" xref="S4.E1.m1.3.3.3.3.1.1.1.1.2.3.3.cmml">1</mn></msub></msub><mo id="S4.E1.m1.3.3.3.3.1.1.1.1.1" xref="S4.E1.m1.3.3.3.3.1.1.1.1.1.cmml">⁢</mo><mrow id="S4.E1.m1.3.3.3.3.1.1.1.1.3.2" xref="S4.E1.m1.3.3.3.3.1.1.1.1.cmml"><mo id="S4.E1.m1.3.3.3.3.1.1.1.1.3.2.1" stretchy="false" xref="S4.E1.m1.3.3.3.3.1.1.1.1.cmml">(</mo><mi id="S4.E1.m1.1.1.1.1" xref="S4.E1.m1.1.1.1.1.cmml">h</mi><mo id="S4.E1.m1.3.3.3.3.1.1.1.1.3.2.2" stretchy="false" xref="S4.E1.m1.3.3.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E1.m1.4.4.4.4.2.2.2.4" xref="S4.E1.m1.4.4.4.4.2.2.3.cmml">,</mo><mrow id="S4.E1.m1.4.4.4.4.2.2.2.2" xref="S4.E1.m1.4.4.4.4.2.2.2.2.cmml"><msub id="S4.E1.m1.4.4.4.4.2.2.2.2.2" xref="S4.E1.m1.4.4.4.4.2.2.2.2.2.cmml"><mi id="S4.E1.m1.4.4.4.4.2.2.2.2.2.2" xref="S4.E1.m1.4.4.4.4.2.2.2.2.2.2.cmml">n</mi><msub id="S4.E1.m1.4.4.4.4.2.2.2.2.2.3" xref="S4.E1.m1.4.4.4.4.2.2.2.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E1.m1.4.4.4.4.2.2.2.2.2.3.2" xref="S4.E1.m1.4.4.4.4.2.2.2.2.2.3.2.cmml">𝒟</mi><mn id="S4.E1.m1.4.4.4.4.2.2.2.2.2.3.3" xref="S4.E1.m1.4.4.4.4.2.2.2.2.2.3.3.cmml">2</mn></msub></msub><mo id="S4.E1.m1.4.4.4.4.2.2.2.2.1" xref="S4.E1.m1.4.4.4.4.2.2.2.2.1.cmml">⁢</mo><mrow id="S4.E1.m1.4.4.4.4.2.2.2.2.3.2" xref="S4.E1.m1.4.4.4.4.2.2.2.2.cmml"><mo id="S4.E1.m1.4.4.4.4.2.2.2.2.3.2.1" stretchy="false" xref="S4.E1.m1.4.4.4.4.2.2.2.2.cmml">(</mo><mi id="S4.E1.m1.2.2.2.2" xref="S4.E1.m1.2.2.2.2.cmml">h</mi><mo id="S4.E1.m1.4.4.4.4.2.2.2.2.3.2.2" stretchy="false" xref="S4.E1.m1.4.4.4.4.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="S4.E1.m1.4.4.4.4.2.2.2.5" stretchy="false" xref="S4.E1.m1.4.4.4.4.2.2.3.cmml">]</mo></mrow></mrow></mrow></mrow><mrow id="S4.E1.m1.6.6.6" xref="S4.E1.m1.6.6.6.cmml"><mrow id="S4.E1.m1.6.6.6.4" xref="S4.E1.m1.6.6.6.4.cmml"><msub id="S4.E1.m1.6.6.6.4.1" xref="S4.E1.m1.6.6.6.4.1.cmml"><mo id="S4.E1.m1.6.6.6.4.1.2" xref="S4.E1.m1.6.6.6.4.1.2.cmml">∑</mo><mrow id="S4.E1.m1.6.6.6.4.1.3" xref="S4.E1.m1.6.6.6.4.1.3.cmml"><mo id="S4.E1.m1.6.6.6.4.1.3.1" rspace="0.167em" xref="S4.E1.m1.6.6.6.4.1.3.1.cmml">∀</mo><mi id="S4.E1.m1.6.6.6.4.1.3.2" xref="S4.E1.m1.6.6.6.4.1.3.2.cmml">h</mi></mrow></msub><mrow id="S4.E1.m1.6.6.6.4.2" xref="S4.E1.m1.6.6.6.4.2.cmml"><msub id="S4.E1.m1.6.6.6.4.2.2" xref="S4.E1.m1.6.6.6.4.2.2.cmml"><mi id="S4.E1.m1.6.6.6.4.2.2.2" xref="S4.E1.m1.6.6.6.4.2.2.2.cmml">n</mi><msub id="S4.E1.m1.6.6.6.4.2.2.3" xref="S4.E1.m1.6.6.6.4.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E1.m1.6.6.6.4.2.2.3.2" xref="S4.E1.m1.6.6.6.4.2.2.3.2.cmml">𝒟</mi><mn id="S4.E1.m1.6.6.6.4.2.2.3.3" xref="S4.E1.m1.6.6.6.4.2.2.3.3.cmml">1</mn></msub></msub><mo id="S4.E1.m1.6.6.6.4.2.1" xref="S4.E1.m1.6.6.6.4.2.1.cmml">⁢</mo><mrow id="S4.E1.m1.6.6.6.4.2.3.2" xref="S4.E1.m1.6.6.6.4.2.cmml"><mo id="S4.E1.m1.6.6.6.4.2.3.2.1" stretchy="false" xref="S4.E1.m1.6.6.6.4.2.cmml">(</mo><mi id="S4.E1.m1.5.5.5.1" xref="S4.E1.m1.5.5.5.1.cmml">h</mi><mo id="S4.E1.m1.6.6.6.4.2.3.2.2" stretchy="false" xref="S4.E1.m1.6.6.6.4.2.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E1.m1.6.6.6.3" xref="S4.E1.m1.6.6.6.3.cmml">+</mo><mrow id="S4.E1.m1.6.6.6.5" xref="S4.E1.m1.6.6.6.5.cmml"><msub id="S4.E1.m1.6.6.6.5.2" xref="S4.E1.m1.6.6.6.5.2.cmml"><mi id="S4.E1.m1.6.6.6.5.2.2" xref="S4.E1.m1.6.6.6.5.2.2.cmml">n</mi><msub id="S4.E1.m1.6.6.6.5.2.3" xref="S4.E1.m1.6.6.6.5.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E1.m1.6.6.6.5.2.3.2" xref="S4.E1.m1.6.6.6.5.2.3.2.cmml">𝒟</mi><mn id="S4.E1.m1.6.6.6.5.2.3.3" xref="S4.E1.m1.6.6.6.5.2.3.3.cmml">2</mn></msub></msub><mo id="S4.E1.m1.6.6.6.5.1" xref="S4.E1.m1.6.6.6.5.1.cmml">⁢</mo><mrow id="S4.E1.m1.6.6.6.5.3.2" xref="S4.E1.m1.6.6.6.5.cmml"><mo id="S4.E1.m1.6.6.6.5.3.2.1" stretchy="false" xref="S4.E1.m1.6.6.6.5.cmml">(</mo><mi id="S4.E1.m1.6.6.6.2" xref="S4.E1.m1.6.6.6.2.cmml">h</mi><mo id="S4.E1.m1.6.6.6.5.3.2.2" stretchy="false" xref="S4.E1.m1.6.6.6.5.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><mo id="S4.E1.m1.7.7.1.2" lspace="0em" xref="S4.E1.m1.7.7.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E1.m1.7b"><apply id="S4.E1.m1.7.7.1.1.cmml" xref="S4.E1.m1.7.7.1"><eq id="S4.E1.m1.7.7.1.1.3.cmml" xref="S4.E1.m1.7.7.1.1.3"></eq><apply id="S4.E1.m1.7.7.1.1.2.cmml" xref="S4.E1.m1.7.7.1.1.2"><times id="S4.E1.m1.7.7.1.1.2.3.cmml" xref="S4.E1.m1.7.7.1.1.2.3"></times><ci id="S4.E1.m1.7.7.1.1.2.4.cmml" xref="S4.E1.m1.7.7.1.1.2.4">𝑆</ci><interval closure="open" id="S4.E1.m1.7.7.1.1.2.2.3.cmml" xref="S4.E1.m1.7.7.1.1.2.2.2"><apply id="S4.E1.m1.7.7.1.1.1.1.1.1.cmml" xref="S4.E1.m1.7.7.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E1.m1.7.7.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.7.7.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E1.m1.7.7.1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.7.7.1.1.1.1.1.1.2">𝒟</ci><cn id="S4.E1.m1.7.7.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.E1.m1.7.7.1.1.1.1.1.1.3">1</cn></apply><apply id="S4.E1.m1.7.7.1.1.2.2.2.2.cmml" xref="S4.E1.m1.7.7.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E1.m1.7.7.1.1.2.2.2.2.1.cmml" xref="S4.E1.m1.7.7.1.1.2.2.2.2">subscript</csymbol><ci id="S4.E1.m1.7.7.1.1.2.2.2.2.2.cmml" xref="S4.E1.m1.7.7.1.1.2.2.2.2.2">𝒟</ci><cn id="S4.E1.m1.7.7.1.1.2.2.2.2.3.cmml" type="integer" xref="S4.E1.m1.7.7.1.1.2.2.2.2.3">2</cn></apply></interval></apply><apply id="S4.E1.m1.6.6.cmml" xref="S4.E1.m1.6.6"><divide id="S4.E1.m1.6.6.7.cmml" xref="S4.E1.m1.6.6"></divide><apply id="S4.E1.m1.4.4.4.cmml" xref="S4.E1.m1.4.4.4"><times id="S4.E1.m1.4.4.4.5.cmml" xref="S4.E1.m1.4.4.4.5"></times><cn id="S4.E1.m1.4.4.4.6.cmml" type="integer" xref="S4.E1.m1.4.4.4.6">2</cn><apply id="S4.E1.m1.4.4.4.4.cmml" xref="S4.E1.m1.4.4.4.4"><apply id="S4.E1.m1.4.4.4.4.3.cmml" xref="S4.E1.m1.4.4.4.4.3"><csymbol cd="ambiguous" id="S4.E1.m1.4.4.4.4.3.1.cmml" xref="S4.E1.m1.4.4.4.4.3">subscript</csymbol><sum id="S4.E1.m1.4.4.4.4.3.2.cmml" xref="S4.E1.m1.4.4.4.4.3.2"></sum><apply id="S4.E1.m1.4.4.4.4.3.3.cmml" xref="S4.E1.m1.4.4.4.4.3.3"><csymbol cd="latexml" id="S4.E1.m1.4.4.4.4.3.3.1.cmml" xref="S4.E1.m1.4.4.4.4.3.3.1">for-all</csymbol><ci id="S4.E1.m1.4.4.4.4.3.3.2.cmml" xref="S4.E1.m1.4.4.4.4.3.3.2">ℎ</ci></apply></apply><apply id="S4.E1.m1.4.4.4.4.2.cmml" xref="S4.E1.m1.4.4.4.4.2"><times id="S4.E1.m1.4.4.4.4.2.3.cmml" xref="S4.E1.m1.4.4.4.4.2.3"></times><ci id="S4.E1.m1.4.4.4.4.2.4.cmml" xref="S4.E1.m1.4.4.4.4.2.4">min</ci><interval closure="closed" id="S4.E1.m1.4.4.4.4.2.2.3.cmml" xref="S4.E1.m1.4.4.4.4.2.2.2"><apply id="S4.E1.m1.3.3.3.3.1.1.1.1.cmml" xref="S4.E1.m1.3.3.3.3.1.1.1.1"><times id="S4.E1.m1.3.3.3.3.1.1.1.1.1.cmml" xref="S4.E1.m1.3.3.3.3.1.1.1.1.1"></times><apply id="S4.E1.m1.3.3.3.3.1.1.1.1.2.cmml" xref="S4.E1.m1.3.3.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E1.m1.3.3.3.3.1.1.1.1.2.1.cmml" xref="S4.E1.m1.3.3.3.3.1.1.1.1.2">subscript</csymbol><ci id="S4.E1.m1.3.3.3.3.1.1.1.1.2.2.cmml" xref="S4.E1.m1.3.3.3.3.1.1.1.1.2.2">𝑛</ci><apply id="S4.E1.m1.3.3.3.3.1.1.1.1.2.3.cmml" xref="S4.E1.m1.3.3.3.3.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E1.m1.3.3.3.3.1.1.1.1.2.3.1.cmml" xref="S4.E1.m1.3.3.3.3.1.1.1.1.2.3">subscript</csymbol><ci id="S4.E1.m1.3.3.3.3.1.1.1.1.2.3.2.cmml" xref="S4.E1.m1.3.3.3.3.1.1.1.1.2.3.2">𝒟</ci><cn id="S4.E1.m1.3.3.3.3.1.1.1.1.2.3.3.cmml" type="integer" xref="S4.E1.m1.3.3.3.3.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S4.E1.m1.1.1.1.1.cmml" xref="S4.E1.m1.1.1.1.1">ℎ</ci></apply><apply id="S4.E1.m1.4.4.4.4.2.2.2.2.cmml" xref="S4.E1.m1.4.4.4.4.2.2.2.2"><times id="S4.E1.m1.4.4.4.4.2.2.2.2.1.cmml" xref="S4.E1.m1.4.4.4.4.2.2.2.2.1"></times><apply id="S4.E1.m1.4.4.4.4.2.2.2.2.2.cmml" xref="S4.E1.m1.4.4.4.4.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E1.m1.4.4.4.4.2.2.2.2.2.1.cmml" xref="S4.E1.m1.4.4.4.4.2.2.2.2.2">subscript</csymbol><ci id="S4.E1.m1.4.4.4.4.2.2.2.2.2.2.cmml" xref="S4.E1.m1.4.4.4.4.2.2.2.2.2.2">𝑛</ci><apply id="S4.E1.m1.4.4.4.4.2.2.2.2.2.3.cmml" xref="S4.E1.m1.4.4.4.4.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.E1.m1.4.4.4.4.2.2.2.2.2.3.1.cmml" xref="S4.E1.m1.4.4.4.4.2.2.2.2.2.3">subscript</csymbol><ci id="S4.E1.m1.4.4.4.4.2.2.2.2.2.3.2.cmml" xref="S4.E1.m1.4.4.4.4.2.2.2.2.2.3.2">𝒟</ci><cn id="S4.E1.m1.4.4.4.4.2.2.2.2.2.3.3.cmml" type="integer" xref="S4.E1.m1.4.4.4.4.2.2.2.2.2.3.3">2</cn></apply></apply><ci id="S4.E1.m1.2.2.2.2.cmml" xref="S4.E1.m1.2.2.2.2">ℎ</ci></apply></interval></apply></apply></apply><apply id="S4.E1.m1.6.6.6.cmml" xref="S4.E1.m1.6.6.6"><plus id="S4.E1.m1.6.6.6.3.cmml" xref="S4.E1.m1.6.6.6.3"></plus><apply id="S4.E1.m1.6.6.6.4.cmml" xref="S4.E1.m1.6.6.6.4"><apply id="S4.E1.m1.6.6.6.4.1.cmml" xref="S4.E1.m1.6.6.6.4.1"><csymbol cd="ambiguous" id="S4.E1.m1.6.6.6.4.1.1.cmml" xref="S4.E1.m1.6.6.6.4.1">subscript</csymbol><sum id="S4.E1.m1.6.6.6.4.1.2.cmml" xref="S4.E1.m1.6.6.6.4.1.2"></sum><apply id="S4.E1.m1.6.6.6.4.1.3.cmml" xref="S4.E1.m1.6.6.6.4.1.3"><csymbol cd="latexml" id="S4.E1.m1.6.6.6.4.1.3.1.cmml" xref="S4.E1.m1.6.6.6.4.1.3.1">for-all</csymbol><ci id="S4.E1.m1.6.6.6.4.1.3.2.cmml" xref="S4.E1.m1.6.6.6.4.1.3.2">ℎ</ci></apply></apply><apply id="S4.E1.m1.6.6.6.4.2.cmml" xref="S4.E1.m1.6.6.6.4.2"><times id="S4.E1.m1.6.6.6.4.2.1.cmml" xref="S4.E1.m1.6.6.6.4.2.1"></times><apply id="S4.E1.m1.6.6.6.4.2.2.cmml" xref="S4.E1.m1.6.6.6.4.2.2"><csymbol cd="ambiguous" id="S4.E1.m1.6.6.6.4.2.2.1.cmml" xref="S4.E1.m1.6.6.6.4.2.2">subscript</csymbol><ci id="S4.E1.m1.6.6.6.4.2.2.2.cmml" xref="S4.E1.m1.6.6.6.4.2.2.2">𝑛</ci><apply id="S4.E1.m1.6.6.6.4.2.2.3.cmml" xref="S4.E1.m1.6.6.6.4.2.2.3"><csymbol cd="ambiguous" id="S4.E1.m1.6.6.6.4.2.2.3.1.cmml" xref="S4.E1.m1.6.6.6.4.2.2.3">subscript</csymbol><ci id="S4.E1.m1.6.6.6.4.2.2.3.2.cmml" xref="S4.E1.m1.6.6.6.4.2.2.3.2">𝒟</ci><cn id="S4.E1.m1.6.6.6.4.2.2.3.3.cmml" type="integer" xref="S4.E1.m1.6.6.6.4.2.2.3.3">1</cn></apply></apply><ci id="S4.E1.m1.5.5.5.1.cmml" xref="S4.E1.m1.5.5.5.1">ℎ</ci></apply></apply><apply id="S4.E1.m1.6.6.6.5.cmml" xref="S4.E1.m1.6.6.6.5"><times id="S4.E1.m1.6.6.6.5.1.cmml" xref="S4.E1.m1.6.6.6.5.1"></times><apply id="S4.E1.m1.6.6.6.5.2.cmml" xref="S4.E1.m1.6.6.6.5.2"><csymbol cd="ambiguous" id="S4.E1.m1.6.6.6.5.2.1.cmml" xref="S4.E1.m1.6.6.6.5.2">subscript</csymbol><ci id="S4.E1.m1.6.6.6.5.2.2.cmml" xref="S4.E1.m1.6.6.6.5.2.2">𝑛</ci><apply id="S4.E1.m1.6.6.6.5.2.3.cmml" xref="S4.E1.m1.6.6.6.5.2.3"><csymbol cd="ambiguous" id="S4.E1.m1.6.6.6.5.2.3.1.cmml" xref="S4.E1.m1.6.6.6.5.2.3">subscript</csymbol><ci id="S4.E1.m1.6.6.6.5.2.3.2.cmml" xref="S4.E1.m1.6.6.6.5.2.3.2">𝒟</ci><cn id="S4.E1.m1.6.6.6.5.2.3.3.cmml" type="integer" xref="S4.E1.m1.6.6.6.5.2.3.3">2</cn></apply></apply><ci id="S4.E1.m1.6.6.6.2.cmml" xref="S4.E1.m1.6.6.6.2">ℎ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E1.m1.7c">S(\mathcal{D}_{1},\mathcal{D}_{2})=\frac{2\sum_{\forall h}\mathrm{min}[n_{%
\mathcal{D}_{1}}(h),n_{\mathcal{D}_{2}}(h)]}{\sum_{\forall h}n_{\mathcal{D}_{1%
}}(h)+n_{\mathcal{D}_{2}}(h)}.</annotation><annotation encoding="application/x-llamapun" id="S4.E1.m1.7d">italic_S ( caligraphic_D start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , caligraphic_D start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) = divide start_ARG 2 ∑ start_POSTSUBSCRIPT ∀ italic_h end_POSTSUBSCRIPT roman_min [ italic_n start_POSTSUBSCRIPT caligraphic_D start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_h ) , italic_n start_POSTSUBSCRIPT caligraphic_D start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_h ) ] end_ARG start_ARG ∑ start_POSTSUBSCRIPT ∀ italic_h end_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT caligraphic_D start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_h ) + italic_n start_POSTSUBSCRIPT caligraphic_D start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_h ) end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.p3.5">The results are shown in Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S4.F6" title="Figure 6 ‣ 4.2 Step 3, Induction Head: Feature Retrieval on Task Subspace ‣ 4 Induction Circuits in Natural Language Models ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">6</span></a> (Right), where: (1) A significant overlap of induction heads indicates that a part of correct induction heads is <span class="ltx_text ltx_font_italic" id="S4.SS2.p3.5.1">inherent</span> in the model, built by the pre-training process&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Reddy, <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib35" title="">2024</a>; Singh et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib37" title="">2024b</a>)</cite>. (2) Such overlap is not fully observed, suggesting that some induction subspaces are <span class="ltx_text ltx_font_italic" id="S4.SS2.p3.5.2">task-specific</span>: input texts evoke task-specific attention in induction heads, enabling the anisotropy multiplex of different sub-spaces in the hidden spaces to transmit relevant information for various tasks.
Therefore, we can restore ICL to implicit end-to-end multi-task learning methods with hidden state multiplexing since they also use various task heads on common bottom network layers and informative hidden state&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Zhang &amp; Yang, <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib46" title="">2021</a>)</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p4">
<p class="ltx_p" id="S4.SS2.p4.3"><span class="ltx_text ltx_font_bold" id="S4.SS2.p4.3.1">Demonstration Saturates on Induction Subspace.</span> We visualize the demonstrations’ label token representations mapped on the induction subspaces by the transition matrix <math alttext="W_{Q}^{h\top}W_{K}^{h}" class="ltx_Math" display="inline" id="S4.SS2.p4.1.m1.1"><semantics id="S4.SS2.p4.1.m1.1a"><mrow id="S4.SS2.p4.1.m1.1.1" xref="S4.SS2.p4.1.m1.1.1.cmml"><msubsup id="S4.SS2.p4.1.m1.1.1.2" xref="S4.SS2.p4.1.m1.1.1.2.cmml"><mi id="S4.SS2.p4.1.m1.1.1.2.2.2" xref="S4.SS2.p4.1.m1.1.1.2.2.2.cmml">W</mi><mi id="S4.SS2.p4.1.m1.1.1.2.2.3" xref="S4.SS2.p4.1.m1.1.1.2.2.3.cmml">Q</mi><mrow id="S4.SS2.p4.1.m1.1.1.2.3" xref="S4.SS2.p4.1.m1.1.1.2.3.cmml"><mi id="S4.SS2.p4.1.m1.1.1.2.3.2" xref="S4.SS2.p4.1.m1.1.1.2.3.2.cmml">h</mi><mo id="S4.SS2.p4.1.m1.1.1.2.3.3" lspace="0.222em" xref="S4.SS2.p4.1.m1.1.1.2.3.3.cmml">⊤</mo></mrow></msubsup><mo id="S4.SS2.p4.1.m1.1.1.1" xref="S4.SS2.p4.1.m1.1.1.1.cmml">⁢</mo><msubsup id="S4.SS2.p4.1.m1.1.1.3" xref="S4.SS2.p4.1.m1.1.1.3.cmml"><mi id="S4.SS2.p4.1.m1.1.1.3.2.2" xref="S4.SS2.p4.1.m1.1.1.3.2.2.cmml">W</mi><mi id="S4.SS2.p4.1.m1.1.1.3.2.3" xref="S4.SS2.p4.1.m1.1.1.3.2.3.cmml">K</mi><mi id="S4.SS2.p4.1.m1.1.1.3.3" xref="S4.SS2.p4.1.m1.1.1.3.3.cmml">h</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.1.m1.1b"><apply id="S4.SS2.p4.1.m1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1"><times id="S4.SS2.p4.1.m1.1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1.1"></times><apply id="S4.SS2.p4.1.m1.1.1.2.cmml" xref="S4.SS2.p4.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p4.1.m1.1.1.2.1.cmml" xref="S4.SS2.p4.1.m1.1.1.2">superscript</csymbol><apply id="S4.SS2.p4.1.m1.1.1.2.2.cmml" xref="S4.SS2.p4.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p4.1.m1.1.1.2.2.1.cmml" xref="S4.SS2.p4.1.m1.1.1.2">subscript</csymbol><ci id="S4.SS2.p4.1.m1.1.1.2.2.2.cmml" xref="S4.SS2.p4.1.m1.1.1.2.2.2">𝑊</ci><ci id="S4.SS2.p4.1.m1.1.1.2.2.3.cmml" xref="S4.SS2.p4.1.m1.1.1.2.2.3">𝑄</ci></apply><apply id="S4.SS2.p4.1.m1.1.1.2.3.cmml" xref="S4.SS2.p4.1.m1.1.1.2.3"><csymbol cd="latexml" id="S4.SS2.p4.1.m1.1.1.2.3.1.cmml" xref="S4.SS2.p4.1.m1.1.1.2.3">limit-from</csymbol><ci id="S4.SS2.p4.1.m1.1.1.2.3.2.cmml" xref="S4.SS2.p4.1.m1.1.1.2.3.2">ℎ</ci><csymbol cd="latexml" id="S4.SS2.p4.1.m1.1.1.2.3.3.cmml" xref="S4.SS2.p4.1.m1.1.1.2.3.3">top</csymbol></apply></apply><apply id="S4.SS2.p4.1.m1.1.1.3.cmml" xref="S4.SS2.p4.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p4.1.m1.1.1.3.1.cmml" xref="S4.SS2.p4.1.m1.1.1.3">superscript</csymbol><apply id="S4.SS2.p4.1.m1.1.1.3.2.cmml" xref="S4.SS2.p4.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p4.1.m1.1.1.3.2.1.cmml" xref="S4.SS2.p4.1.m1.1.1.3">subscript</csymbol><ci id="S4.SS2.p4.1.m1.1.1.3.2.2.cmml" xref="S4.SS2.p4.1.m1.1.1.3.2.2">𝑊</ci><ci id="S4.SS2.p4.1.m1.1.1.3.2.3.cmml" xref="S4.SS2.p4.1.m1.1.1.3.2.3">𝐾</ci></apply><ci id="S4.SS2.p4.1.m1.1.1.3.3.cmml" xref="S4.SS2.p4.1.m1.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.1.m1.1c">W_{Q}^{h\top}W_{K}^{h}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.1.m1.1d">italic_W start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_h ⊤ end_POSTSUPERSCRIPT italic_W start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_h end_POSTSUPERSCRIPT</annotation></semantics></math> and principal component analysis in Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S4.F7" title="Figure 7 ‣ 4.2 Step 3, Induction Head: Feature Retrieval on Task Subspace ‣ 4 Induction Circuits in Natural Language Models ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">7</span></a>, indicating: (1) Compared to a correct induction head, a wrong induction head is easier to map label representations linearly inseparably. (2) In the early stage of demonstration (<math alttext="k=1\rightarrow 2" class="ltx_Math" display="inline" id="S4.SS2.p4.2.m2.1"><semantics id="S4.SS2.p4.2.m2.1a"><mrow id="S4.SS2.p4.2.m2.1.1" xref="S4.SS2.p4.2.m2.1.1.cmml"><mi id="S4.SS2.p4.2.m2.1.1.2" xref="S4.SS2.p4.2.m2.1.1.2.cmml">k</mi><mo id="S4.SS2.p4.2.m2.1.1.3" xref="S4.SS2.p4.2.m2.1.1.3.cmml">=</mo><mn id="S4.SS2.p4.2.m2.1.1.4" xref="S4.SS2.p4.2.m2.1.1.4.cmml">1</mn><mo id="S4.SS2.p4.2.m2.1.1.5" stretchy="false" xref="S4.SS2.p4.2.m2.1.1.5.cmml">→</mo><mn id="S4.SS2.p4.2.m2.1.1.6" xref="S4.SS2.p4.2.m2.1.1.6.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.2.m2.1b"><apply id="S4.SS2.p4.2.m2.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1"><and id="S4.SS2.p4.2.m2.1.1a.cmml" xref="S4.SS2.p4.2.m2.1.1"></and><apply id="S4.SS2.p4.2.m2.1.1b.cmml" xref="S4.SS2.p4.2.m2.1.1"><eq id="S4.SS2.p4.2.m2.1.1.3.cmml" xref="S4.SS2.p4.2.m2.1.1.3"></eq><ci id="S4.SS2.p4.2.m2.1.1.2.cmml" xref="S4.SS2.p4.2.m2.1.1.2">𝑘</ci><cn id="S4.SS2.p4.2.m2.1.1.4.cmml" type="integer" xref="S4.SS2.p4.2.m2.1.1.4">1</cn></apply><apply id="S4.SS2.p4.2.m2.1.1c.cmml" xref="S4.SS2.p4.2.m2.1.1"><ci id="S4.SS2.p4.2.m2.1.1.5.cmml" xref="S4.SS2.p4.2.m2.1.1.5">→</ci><share href="https://arxiv.org/html/2410.04468v1#S4.SS2.p4.2.m2.1.1.4.cmml" id="S4.SS2.p4.2.m2.1.1d.cmml" xref="S4.SS2.p4.2.m2.1.1"></share><cn id="S4.SS2.p4.2.m2.1.1.6.cmml" type="integer" xref="S4.SS2.p4.2.m2.1.1.6">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.2.m2.1c">k=1\rightarrow 2</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.2.m2.1d">italic_k = 1 → 2</annotation></semantics></math>), when a new demonstration is given, the morphology of attention assignment towards query changes significantly (shown as background color in Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S4.F7" title="Figure 7 ‣ 4.2 Step 3, Induction Head: Feature Retrieval on Task Subspace ‣ 4 Induction Circuits in Natural Language Models ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">7</span></a>; see §<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A1.SS5" title="A.5 Cartography Details of Fig. 7 ‣ Appendix A Experiment Details and Settings ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">A.5</span></a> for details), while in the late stage (<math alttext="k=15\rightarrow 16" class="ltx_Math" display="inline" id="S4.SS2.p4.3.m3.1"><semantics id="S4.SS2.p4.3.m3.1a"><mrow id="S4.SS2.p4.3.m3.1.1" xref="S4.SS2.p4.3.m3.1.1.cmml"><mi id="S4.SS2.p4.3.m3.1.1.2" xref="S4.SS2.p4.3.m3.1.1.2.cmml">k</mi><mo id="S4.SS2.p4.3.m3.1.1.3" xref="S4.SS2.p4.3.m3.1.1.3.cmml">=</mo><mn id="S4.SS2.p4.3.m3.1.1.4" xref="S4.SS2.p4.3.m3.1.1.4.cmml">15</mn><mo id="S4.SS2.p4.3.m3.1.1.5" stretchy="false" xref="S4.SS2.p4.3.m3.1.1.5.cmml">→</mo><mn id="S4.SS2.p4.3.m3.1.1.6" xref="S4.SS2.p4.3.m3.1.1.6.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.3.m3.1b"><apply id="S4.SS2.p4.3.m3.1.1.cmml" xref="S4.SS2.p4.3.m3.1.1"><and id="S4.SS2.p4.3.m3.1.1a.cmml" xref="S4.SS2.p4.3.m3.1.1"></and><apply id="S4.SS2.p4.3.m3.1.1b.cmml" xref="S4.SS2.p4.3.m3.1.1"><eq id="S4.SS2.p4.3.m3.1.1.3.cmml" xref="S4.SS2.p4.3.m3.1.1.3"></eq><ci id="S4.SS2.p4.3.m3.1.1.2.cmml" xref="S4.SS2.p4.3.m3.1.1.2">𝑘</ci><cn id="S4.SS2.p4.3.m3.1.1.4.cmml" type="integer" xref="S4.SS2.p4.3.m3.1.1.4">15</cn></apply><apply id="S4.SS2.p4.3.m3.1.1c.cmml" xref="S4.SS2.p4.3.m3.1.1"><ci id="S4.SS2.p4.3.m3.1.1.5.cmml" xref="S4.SS2.p4.3.m3.1.1.5">→</ci><share href="https://arxiv.org/html/2410.04468v1#S4.SS2.p4.3.m3.1.1.4.cmml" id="S4.SS2.p4.3.m3.1.1d.cmml" xref="S4.SS2.p4.3.m3.1.1"></share><cn id="S4.SS2.p4.3.m3.1.1.6.cmml" type="integer" xref="S4.SS2.p4.3.m3.1.1.6">16</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.3.m3.1c">k=15\rightarrow 16</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.3.m3.1d">italic_k = 15 → 16</annotation></semantics></math>), attention assignment morphology is stable. This can explain the demonstration saturation&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Agarwal et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib1" title="">2024</a>; Bertsch et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib4" title="">2024</a>)</cite>: the performance is submodular against the demonstrations. Intuitively, since demonstrations follow a prior distribution, representation of a new demonstration is likely to be located within the closure of existing demonstrations, making it less contributable to the attention assignment in the induction subspace.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Putting Things Together</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">So far, we have revealed the existence of the circuit with 3 steps, organized by the sequential inference process among Transformer layers. In this section, we find that the circuit is dominant in the ICL inference, while some bypass mechanisms activated by residual connection assist ICL inference. Moreover, a series of phenomena observed in ICL is successfully explained by the circuit.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Ablation Analysis</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_table ltx_align_floatright" id="S5.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Accuracy variation (%) with each inference step ablated on Llama 3 8B. Small numbers are controlled results of randomly ablating equivalent amounts of connections. Ablations are applied from the bottom to the top layers, and results with various ablated layers are reported.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S5.T1.51" style="width:198.7pt;height:182.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-78.7pt,72.4pt) scale(0.558190615276638,0.558190615276638) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T1.51.51">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T1.1.1.1">
<th class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_row ltx_border_tt" id="S5.T1.1.1.1.2" rowspan="2"><span class="ltx_text" id="S5.T1.1.1.1.2.1">#</span></th>
<th class="ltx_td ltx_nopad_l ltx_align_center ltx_th ltx_th_row ltx_border_tt" id="S5.T1.1.1.1.1" rowspan="2"><span class="ltx_text" id="S5.T1.1.1.1.1.1">
<span class="ltx_tabular ltx_align_middle" id="S5.T1.1.1.1.1.1.1">
<span class="ltx_tr" id="S5.T1.1.1.1.1.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T1.1.1.1.1.1.1.2.1"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.1.1.1.1.2.1.1">Attention Disconnected</span></span></span>
<span class="ltx_tr" id="S5.T1.1.1.1.1.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T1.1.1.1.1.1.1.1.1">Key <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S5.T1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S5.T1.1.1.1.1.1.1.1.1.m1.1a"><mo id="S5.T1.1.1.1.1.1.1.1.1.m1.1.1" stretchy="false" xref="S5.T1.1.1.1.1.1.1.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S5.T1.1.1.1.1.1.1.1.1.m1.1b"><ci id="S5.T1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S5.T1.1.1.1.1.1.1.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.1.1.1.1.1.1.1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T1.1.1.1.1.1.1.1.1.m1.1d">→</annotation></semantics></math> Query</span></span>
</span></span></th>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="4" id="S5.T1.1.1.1.3">
<span class="ltx_text ltx_font_bold" id="S5.T1.1.1.1.3.1">Affected Layers Ratio</span> (from layer 1)</td>
</tr>
<tr class="ltx_tr" id="S5.T1.51.51.52.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.51.51.52.1.1">25%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.51.51.52.1.2">50%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.51.51.52.1.3">75%</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T1.51.51.52.1.4">100%</td>
</tr>
<tr class="ltx_tr" id="S5.T1.3.3.3">
<th class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S5.T1.3.3.3.3">1</th>
<th class="ltx_td ltx_nopad_l ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S5.T1.3.3.3.4">
<span class="ltx_text ltx_font_bold" id="S5.T1.3.3.3.4.1">None</span> (4-shot baseline)</th>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="4" id="S5.T1.3.3.3.2">
<math alttext="\pm 0" class="ltx_Math" display="inline" id="S5.T1.2.2.2.1.m1.1"><semantics id="S5.T1.2.2.2.1.m1.1a"><mrow id="S5.T1.2.2.2.1.m1.1.1" xref="S5.T1.2.2.2.1.m1.1.1.cmml"><mo id="S5.T1.2.2.2.1.m1.1.1a" xref="S5.T1.2.2.2.1.m1.1.1.cmml">±</mo><mn id="S5.T1.2.2.2.1.m1.1.1.2" xref="S5.T1.2.2.2.1.m1.1.1.2.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.2.2.2.1.m1.1b"><apply id="S5.T1.2.2.2.1.m1.1.1.cmml" xref="S5.T1.2.2.2.1.m1.1.1"><csymbol cd="latexml" id="S5.T1.2.2.2.1.m1.1.1.1.cmml" xref="S5.T1.2.2.2.1.m1.1.1">plus-or-minus</csymbol><cn id="S5.T1.2.2.2.1.m1.1.1.2.cmml" type="integer" xref="S5.T1.2.2.2.1.m1.1.1.2">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.2.2.2.1.m1.1c">\pm 0</annotation><annotation encoding="application/x-llamapun" id="S5.T1.2.2.2.1.m1.1d">± 0</annotation></semantics></math> (Acc. <math alttext="68.55" class="ltx_Math" display="inline" id="S5.T1.3.3.3.2.m2.1"><semantics id="S5.T1.3.3.3.2.m2.1a"><mn id="S5.T1.3.3.3.2.m2.1.1" xref="S5.T1.3.3.3.2.m2.1.1.cmml">68.55</mn><annotation-xml encoding="MathML-Content" id="S5.T1.3.3.3.2.m2.1b"><cn id="S5.T1.3.3.3.2.m2.1.1.cmml" type="float" xref="S5.T1.3.3.3.2.m2.1.1">68.55</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.3.3.3.2.m2.1c">68.55</annotation><annotation encoding="application/x-llamapun" id="S5.T1.3.3.3.2.m2.1d">68.55</annotation></semantics></math>)</td>
</tr>
<tr class="ltx_tr" id="S5.T1.51.51.53.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="6" id="S5.T1.51.51.53.2.1"><span class="ltx_text ltx_font_italic" id="S5.T1.51.51.53.2.1.1">– Step1: Summarize –</span></th>
</tr>
<tr class="ltx_tr" id="S5.T1.14.14.14">
<th class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_row" id="S5.T1.14.14.14.12">2</th>
<th class="ltx_td ltx_nopad_l ltx_align_center ltx_th ltx_th_row" id="S5.T1.6.6.6.3"><span class="ltx_text ltx_font_bold" id="S5.T1.6.6.6.3.3">Demo. Texts <math alttext="x_{i}" class="ltx_Math" display="inline" id="S5.T1.4.4.4.1.1.m1.1"><semantics id="S5.T1.4.4.4.1.1.m1.1a"><msub id="S5.T1.4.4.4.1.1.m1.1.1" xref="S5.T1.4.4.4.1.1.m1.1.1.cmml"><mi id="S5.T1.4.4.4.1.1.m1.1.1.2" xref="S5.T1.4.4.4.1.1.m1.1.1.2.cmml">x</mi><mi id="S5.T1.4.4.4.1.1.m1.1.1.3" xref="S5.T1.4.4.4.1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S5.T1.4.4.4.1.1.m1.1b"><apply id="S5.T1.4.4.4.1.1.m1.1.1.cmml" xref="S5.T1.4.4.4.1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T1.4.4.4.1.1.m1.1.1.1.cmml" xref="S5.T1.4.4.4.1.1.m1.1.1">subscript</csymbol><ci id="S5.T1.4.4.4.1.1.m1.1.1.2.cmml" xref="S5.T1.4.4.4.1.1.m1.1.1.2">𝑥</ci><ci id="S5.T1.4.4.4.1.1.m1.1.1.3.cmml" xref="S5.T1.4.4.4.1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.4.4.4.1.1.m1.1c">x_{i}</annotation><annotation encoding="application/x-llamapun" id="S5.T1.4.4.4.1.1.m1.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S5.T1.5.5.5.2.2.m2.1"><semantics id="S5.T1.5.5.5.2.2.m2.1a"><mo id="S5.T1.5.5.5.2.2.m2.1.1" stretchy="false" xref="S5.T1.5.5.5.2.2.m2.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S5.T1.5.5.5.2.2.m2.1b"><ci id="S5.T1.5.5.5.2.2.m2.1.1.cmml" xref="S5.T1.5.5.5.2.2.m2.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.5.5.5.2.2.m2.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T1.5.5.5.2.2.m2.1d">→</annotation></semantics></math> Forerunner <math alttext="s_{i}" class="ltx_Math" display="inline" id="S5.T1.6.6.6.3.3.m3.1"><semantics id="S5.T1.6.6.6.3.3.m3.1a"><msub id="S5.T1.6.6.6.3.3.m3.1.1" xref="S5.T1.6.6.6.3.3.m3.1.1.cmml"><mi id="S5.T1.6.6.6.3.3.m3.1.1.2" xref="S5.T1.6.6.6.3.3.m3.1.1.2.cmml">s</mi><mi id="S5.T1.6.6.6.3.3.m3.1.1.3" xref="S5.T1.6.6.6.3.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S5.T1.6.6.6.3.3.m3.1b"><apply id="S5.T1.6.6.6.3.3.m3.1.1.cmml" xref="S5.T1.6.6.6.3.3.m3.1.1"><csymbol cd="ambiguous" id="S5.T1.6.6.6.3.3.m3.1.1.1.cmml" xref="S5.T1.6.6.6.3.3.m3.1.1">subscript</csymbol><ci id="S5.T1.6.6.6.3.3.m3.1.1.2.cmml" xref="S5.T1.6.6.6.3.3.m3.1.1.2">𝑠</ci><ci id="S5.T1.6.6.6.3.3.m3.1.1.3.cmml" xref="S5.T1.6.6.6.3.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.6.6.6.3.3.m3.1c">s_{i}</annotation><annotation encoding="application/x-llamapun" id="S5.T1.6.6.6.3.3.m3.1d">italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></span></th>
<td class="ltx_td ltx_align_center" id="S5.T1.8.8.8.5">
<table class="ltx_tabular ltx_align_middle" id="S5.T1.8.8.8.5.2">
<tbody><tr class="ltx_tr" id="S5.T1.7.7.7.4.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T1.7.7.7.4.1.1.1" style="padding-bottom:-5.16663pt;"><math alttext="-4.98" class="ltx_Math" display="inline" id="S5.T1.7.7.7.4.1.1.1.m1.1"><semantics id="S5.T1.7.7.7.4.1.1.1.m1.1a"><mrow id="S5.T1.7.7.7.4.1.1.1.m1.1.1" xref="S5.T1.7.7.7.4.1.1.1.m1.1.1.cmml"><mo id="S5.T1.7.7.7.4.1.1.1.m1.1.1a" xref="S5.T1.7.7.7.4.1.1.1.m1.1.1.cmml">−</mo><mn id="S5.T1.7.7.7.4.1.1.1.m1.1.1.2" xref="S5.T1.7.7.7.4.1.1.1.m1.1.1.2.cmml">4.98</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.7.7.7.4.1.1.1.m1.1b"><apply id="S5.T1.7.7.7.4.1.1.1.m1.1.1.cmml" xref="S5.T1.7.7.7.4.1.1.1.m1.1.1"><minus id="S5.T1.7.7.7.4.1.1.1.m1.1.1.1.cmml" xref="S5.T1.7.7.7.4.1.1.1.m1.1.1"></minus><cn id="S5.T1.7.7.7.4.1.1.1.m1.1.1.2.cmml" type="float" xref="S5.T1.7.7.7.4.1.1.1.m1.1.1.2">4.98</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.7.7.7.4.1.1.1.m1.1c">-4.98</annotation><annotation encoding="application/x-llamapun" id="S5.T1.7.7.7.4.1.1.1.m1.1d">- 4.98</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T1.8.8.8.5.2.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T1.8.8.8.5.2.2.1"><math alttext="-0.85" class="ltx_Math" display="inline" id="S5.T1.8.8.8.5.2.2.1.m1.1"><semantics id="S5.T1.8.8.8.5.2.2.1.m1.1a"><mrow id="S5.T1.8.8.8.5.2.2.1.m1.1.1" xref="S5.T1.8.8.8.5.2.2.1.m1.1.1.cmml"><mo id="S5.T1.8.8.8.5.2.2.1.m1.1.1a" xref="S5.T1.8.8.8.5.2.2.1.m1.1.1.cmml">−</mo><mn id="S5.T1.8.8.8.5.2.2.1.m1.1.1.2" xref="S5.T1.8.8.8.5.2.2.1.m1.1.1.2.cmml">0.85</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.8.8.8.5.2.2.1.m1.1b"><apply id="S5.T1.8.8.8.5.2.2.1.m1.1.1.cmml" xref="S5.T1.8.8.8.5.2.2.1.m1.1.1"><minus id="S5.T1.8.8.8.5.2.2.1.m1.1.1.1.cmml" xref="S5.T1.8.8.8.5.2.2.1.m1.1.1"></minus><cn id="S5.T1.8.8.8.5.2.2.1.m1.1.1.2.cmml" type="float" xref="S5.T1.8.8.8.5.2.2.1.m1.1.1.2">0.85</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.8.8.8.5.2.2.1.m1.1c">-0.85</annotation><annotation encoding="application/x-llamapun" id="S5.T1.8.8.8.5.2.2.1.m1.1d">- 0.85</annotation></semantics></math></td>
</tr>
</tbody></table>
</td>
<td class="ltx_td ltx_align_center" id="S5.T1.10.10.10.7">
<table class="ltx_tabular ltx_align_middle" id="S5.T1.10.10.10.7.2">
<tbody><tr class="ltx_tr" id="S5.T1.9.9.9.6.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T1.9.9.9.6.1.1.1" style="padding-bottom:-5.16663pt;"><math alttext="-15.82" class="ltx_Math" display="inline" id="S5.T1.9.9.9.6.1.1.1.m1.1"><semantics id="S5.T1.9.9.9.6.1.1.1.m1.1a"><mrow id="S5.T1.9.9.9.6.1.1.1.m1.1.1" xref="S5.T1.9.9.9.6.1.1.1.m1.1.1.cmml"><mo id="S5.T1.9.9.9.6.1.1.1.m1.1.1a" xref="S5.T1.9.9.9.6.1.1.1.m1.1.1.cmml">−</mo><mn id="S5.T1.9.9.9.6.1.1.1.m1.1.1.2" xref="S5.T1.9.9.9.6.1.1.1.m1.1.1.2.cmml">15.82</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.9.9.9.6.1.1.1.m1.1b"><apply id="S5.T1.9.9.9.6.1.1.1.m1.1.1.cmml" xref="S5.T1.9.9.9.6.1.1.1.m1.1.1"><minus id="S5.T1.9.9.9.6.1.1.1.m1.1.1.1.cmml" xref="S5.T1.9.9.9.6.1.1.1.m1.1.1"></minus><cn id="S5.T1.9.9.9.6.1.1.1.m1.1.1.2.cmml" type="float" xref="S5.T1.9.9.9.6.1.1.1.m1.1.1.2">15.82</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.9.9.9.6.1.1.1.m1.1c">-15.82</annotation><annotation encoding="application/x-llamapun" id="S5.T1.9.9.9.6.1.1.1.m1.1d">- 15.82</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T1.10.10.10.7.2.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T1.10.10.10.7.2.2.1"><math alttext="-1.33" class="ltx_Math" display="inline" id="S5.T1.10.10.10.7.2.2.1.m1.1"><semantics id="S5.T1.10.10.10.7.2.2.1.m1.1a"><mrow id="S5.T1.10.10.10.7.2.2.1.m1.1.1" xref="S5.T1.10.10.10.7.2.2.1.m1.1.1.cmml"><mo id="S5.T1.10.10.10.7.2.2.1.m1.1.1a" xref="S5.T1.10.10.10.7.2.2.1.m1.1.1.cmml">−</mo><mn id="S5.T1.10.10.10.7.2.2.1.m1.1.1.2" xref="S5.T1.10.10.10.7.2.2.1.m1.1.1.2.cmml">1.33</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.10.10.10.7.2.2.1.m1.1b"><apply id="S5.T1.10.10.10.7.2.2.1.m1.1.1.cmml" xref="S5.T1.10.10.10.7.2.2.1.m1.1.1"><minus id="S5.T1.10.10.10.7.2.2.1.m1.1.1.1.cmml" xref="S5.T1.10.10.10.7.2.2.1.m1.1.1"></minus><cn id="S5.T1.10.10.10.7.2.2.1.m1.1.1.2.cmml" type="float" xref="S5.T1.10.10.10.7.2.2.1.m1.1.1.2">1.33</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.10.10.10.7.2.2.1.m1.1c">-1.33</annotation><annotation encoding="application/x-llamapun" id="S5.T1.10.10.10.7.2.2.1.m1.1d">- 1.33</annotation></semantics></math></td>
</tr>
</tbody></table>
</td>
<td class="ltx_td ltx_align_center" id="S5.T1.12.12.12.9">
<table class="ltx_tabular ltx_align_middle" id="S5.T1.12.12.12.9.2">
<tbody><tr class="ltx_tr" id="S5.T1.11.11.11.8.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T1.11.11.11.8.1.1.1" style="padding-bottom:-5.16663pt;"><math alttext="-23.43" class="ltx_Math" display="inline" id="S5.T1.11.11.11.8.1.1.1.m1.1"><semantics id="S5.T1.11.11.11.8.1.1.1.m1.1a"><mrow id="S5.T1.11.11.11.8.1.1.1.m1.1.1" xref="S5.T1.11.11.11.8.1.1.1.m1.1.1.cmml"><mo id="S5.T1.11.11.11.8.1.1.1.m1.1.1a" xref="S5.T1.11.11.11.8.1.1.1.m1.1.1.cmml">−</mo><mn id="S5.T1.11.11.11.8.1.1.1.m1.1.1.2" xref="S5.T1.11.11.11.8.1.1.1.m1.1.1.2.cmml">23.43</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.11.11.11.8.1.1.1.m1.1b"><apply id="S5.T1.11.11.11.8.1.1.1.m1.1.1.cmml" xref="S5.T1.11.11.11.8.1.1.1.m1.1.1"><minus id="S5.T1.11.11.11.8.1.1.1.m1.1.1.1.cmml" xref="S5.T1.11.11.11.8.1.1.1.m1.1.1"></minus><cn id="S5.T1.11.11.11.8.1.1.1.m1.1.1.2.cmml" type="float" xref="S5.T1.11.11.11.8.1.1.1.m1.1.1.2">23.43</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.11.11.11.8.1.1.1.m1.1c">-23.43</annotation><annotation encoding="application/x-llamapun" id="S5.T1.11.11.11.8.1.1.1.m1.1d">- 23.43</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T1.12.12.12.9.2.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T1.12.12.12.9.2.2.1"><math alttext="-4.65" class="ltx_Math" display="inline" id="S5.T1.12.12.12.9.2.2.1.m1.1"><semantics id="S5.T1.12.12.12.9.2.2.1.m1.1a"><mrow id="S5.T1.12.12.12.9.2.2.1.m1.1.1" xref="S5.T1.12.12.12.9.2.2.1.m1.1.1.cmml"><mo id="S5.T1.12.12.12.9.2.2.1.m1.1.1a" xref="S5.T1.12.12.12.9.2.2.1.m1.1.1.cmml">−</mo><mn id="S5.T1.12.12.12.9.2.2.1.m1.1.1.2" xref="S5.T1.12.12.12.9.2.2.1.m1.1.1.2.cmml">4.65</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.12.12.12.9.2.2.1.m1.1b"><apply id="S5.T1.12.12.12.9.2.2.1.m1.1.1.cmml" xref="S5.T1.12.12.12.9.2.2.1.m1.1.1"><minus id="S5.T1.12.12.12.9.2.2.1.m1.1.1.1.cmml" xref="S5.T1.12.12.12.9.2.2.1.m1.1.1"></minus><cn id="S5.T1.12.12.12.9.2.2.1.m1.1.1.2.cmml" type="float" xref="S5.T1.12.12.12.9.2.2.1.m1.1.1.2">4.65</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.12.12.12.9.2.2.1.m1.1c">-4.65</annotation><annotation encoding="application/x-llamapun" id="S5.T1.12.12.12.9.2.2.1.m1.1d">- 4.65</annotation></semantics></math></td>
</tr>
</tbody></table>
</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T1.14.14.14.11">
<table class="ltx_tabular ltx_align_middle" id="S5.T1.14.14.14.11.2">
<tbody><tr class="ltx_tr" id="S5.T1.13.13.13.10.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T1.13.13.13.10.1.1.1" style="padding-bottom:-5.16663pt;"><math alttext="-30.60" class="ltx_Math" display="inline" id="S5.T1.13.13.13.10.1.1.1.m1.1"><semantics id="S5.T1.13.13.13.10.1.1.1.m1.1a"><mrow id="S5.T1.13.13.13.10.1.1.1.m1.1.1" xref="S5.T1.13.13.13.10.1.1.1.m1.1.1.cmml"><mo id="S5.T1.13.13.13.10.1.1.1.m1.1.1a" xref="S5.T1.13.13.13.10.1.1.1.m1.1.1.cmml">−</mo><mn id="S5.T1.13.13.13.10.1.1.1.m1.1.1.2" xref="S5.T1.13.13.13.10.1.1.1.m1.1.1.2.cmml">30.60</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.13.13.13.10.1.1.1.m1.1b"><apply id="S5.T1.13.13.13.10.1.1.1.m1.1.1.cmml" xref="S5.T1.13.13.13.10.1.1.1.m1.1.1"><minus id="S5.T1.13.13.13.10.1.1.1.m1.1.1.1.cmml" xref="S5.T1.13.13.13.10.1.1.1.m1.1.1"></minus><cn id="S5.T1.13.13.13.10.1.1.1.m1.1.1.2.cmml" type="float" xref="S5.T1.13.13.13.10.1.1.1.m1.1.1.2">30.60</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.13.13.13.10.1.1.1.m1.1c">-30.60</annotation><annotation encoding="application/x-llamapun" id="S5.T1.13.13.13.10.1.1.1.m1.1d">- 30.60</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T1.14.14.14.11.2.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T1.14.14.14.11.2.2.1"><math alttext="-1.50" class="ltx_Math" display="inline" id="S5.T1.14.14.14.11.2.2.1.m1.1"><semantics id="S5.T1.14.14.14.11.2.2.1.m1.1a"><mrow id="S5.T1.14.14.14.11.2.2.1.m1.1.1" xref="S5.T1.14.14.14.11.2.2.1.m1.1.1.cmml"><mo id="S5.T1.14.14.14.11.2.2.1.m1.1.1a" xref="S5.T1.14.14.14.11.2.2.1.m1.1.1.cmml">−</mo><mn id="S5.T1.14.14.14.11.2.2.1.m1.1.1.2" xref="S5.T1.14.14.14.11.2.2.1.m1.1.1.2.cmml">1.50</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.14.14.14.11.2.2.1.m1.1b"><apply id="S5.T1.14.14.14.11.2.2.1.m1.1.1.cmml" xref="S5.T1.14.14.14.11.2.2.1.m1.1.1"><minus id="S5.T1.14.14.14.11.2.2.1.m1.1.1.1.cmml" xref="S5.T1.14.14.14.11.2.2.1.m1.1.1"></minus><cn id="S5.T1.14.14.14.11.2.2.1.m1.1.1.2.cmml" type="float" xref="S5.T1.14.14.14.11.2.2.1.m1.1.1.2">1.50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.14.14.14.11.2.2.1.m1.1c">-1.50</annotation><annotation encoding="application/x-llamapun" id="S5.T1.14.14.14.11.2.2.1.m1.1d">- 1.50</annotation></semantics></math></td>
</tr>
</tbody></table>
</td>
</tr>
<tr class="ltx_tr" id="S5.T1.25.25.25">
<th class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_row" id="S5.T1.25.25.25.12">3</th>
<th class="ltx_td ltx_nopad_l ltx_align_center ltx_th ltx_th_row" id="S5.T1.17.17.17.3"><span class="ltx_text ltx_font_bold" id="S5.T1.17.17.17.3.3">Query Texts <math alttext="x_{q}" class="ltx_Math" display="inline" id="S5.T1.15.15.15.1.1.m1.1"><semantics id="S5.T1.15.15.15.1.1.m1.1a"><msub id="S5.T1.15.15.15.1.1.m1.1.1" xref="S5.T1.15.15.15.1.1.m1.1.1.cmml"><mi id="S5.T1.15.15.15.1.1.m1.1.1.2" xref="S5.T1.15.15.15.1.1.m1.1.1.2.cmml">x</mi><mi id="S5.T1.15.15.15.1.1.m1.1.1.3" xref="S5.T1.15.15.15.1.1.m1.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S5.T1.15.15.15.1.1.m1.1b"><apply id="S5.T1.15.15.15.1.1.m1.1.1.cmml" xref="S5.T1.15.15.15.1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T1.15.15.15.1.1.m1.1.1.1.cmml" xref="S5.T1.15.15.15.1.1.m1.1.1">subscript</csymbol><ci id="S5.T1.15.15.15.1.1.m1.1.1.2.cmml" xref="S5.T1.15.15.15.1.1.m1.1.1.2">𝑥</ci><ci id="S5.T1.15.15.15.1.1.m1.1.1.3.cmml" xref="S5.T1.15.15.15.1.1.m1.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.15.15.15.1.1.m1.1c">x_{q}</annotation><annotation encoding="application/x-llamapun" id="S5.T1.15.15.15.1.1.m1.1d">italic_x start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S5.T1.16.16.16.2.2.m2.1"><semantics id="S5.T1.16.16.16.2.2.m2.1a"><mo id="S5.T1.16.16.16.2.2.m2.1.1" stretchy="false" xref="S5.T1.16.16.16.2.2.m2.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S5.T1.16.16.16.2.2.m2.1b"><ci id="S5.T1.16.16.16.2.2.m2.1.1.cmml" xref="S5.T1.16.16.16.2.2.m2.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.16.16.16.2.2.m2.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T1.16.16.16.2.2.m2.1d">→</annotation></semantics></math> Forerunner <math alttext="s_{q}" class="ltx_Math" display="inline" id="S5.T1.17.17.17.3.3.m3.1"><semantics id="S5.T1.17.17.17.3.3.m3.1a"><msub id="S5.T1.17.17.17.3.3.m3.1.1" xref="S5.T1.17.17.17.3.3.m3.1.1.cmml"><mi id="S5.T1.17.17.17.3.3.m3.1.1.2" xref="S5.T1.17.17.17.3.3.m3.1.1.2.cmml">s</mi><mi id="S5.T1.17.17.17.3.3.m3.1.1.3" xref="S5.T1.17.17.17.3.3.m3.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S5.T1.17.17.17.3.3.m3.1b"><apply id="S5.T1.17.17.17.3.3.m3.1.1.cmml" xref="S5.T1.17.17.17.3.3.m3.1.1"><csymbol cd="ambiguous" id="S5.T1.17.17.17.3.3.m3.1.1.1.cmml" xref="S5.T1.17.17.17.3.3.m3.1.1">subscript</csymbol><ci id="S5.T1.17.17.17.3.3.m3.1.1.2.cmml" xref="S5.T1.17.17.17.3.3.m3.1.1.2">𝑠</ci><ci id="S5.T1.17.17.17.3.3.m3.1.1.3.cmml" xref="S5.T1.17.17.17.3.3.m3.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.17.17.17.3.3.m3.1c">s_{q}</annotation><annotation encoding="application/x-llamapun" id="S5.T1.17.17.17.3.3.m3.1d">italic_s start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math></span></th>
<td class="ltx_td ltx_align_center" id="S5.T1.19.19.19.5">
<table class="ltx_tabular ltx_align_middle" id="S5.T1.19.19.19.5.2">
<tbody><tr class="ltx_tr" id="S5.T1.18.18.18.4.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T1.18.18.18.4.1.1.1" style="padding-bottom:-5.16663pt;"><math alttext="-13.87" class="ltx_Math" display="inline" id="S5.T1.18.18.18.4.1.1.1.m1.1"><semantics id="S5.T1.18.18.18.4.1.1.1.m1.1a"><mrow id="S5.T1.18.18.18.4.1.1.1.m1.1.1" xref="S5.T1.18.18.18.4.1.1.1.m1.1.1.cmml"><mo id="S5.T1.18.18.18.4.1.1.1.m1.1.1a" xref="S5.T1.18.18.18.4.1.1.1.m1.1.1.cmml">−</mo><mn id="S5.T1.18.18.18.4.1.1.1.m1.1.1.2" xref="S5.T1.18.18.18.4.1.1.1.m1.1.1.2.cmml">13.87</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.18.18.18.4.1.1.1.m1.1b"><apply id="S5.T1.18.18.18.4.1.1.1.m1.1.1.cmml" xref="S5.T1.18.18.18.4.1.1.1.m1.1.1"><minus id="S5.T1.18.18.18.4.1.1.1.m1.1.1.1.cmml" xref="S5.T1.18.18.18.4.1.1.1.m1.1.1"></minus><cn id="S5.T1.18.18.18.4.1.1.1.m1.1.1.2.cmml" type="float" xref="S5.T1.18.18.18.4.1.1.1.m1.1.1.2">13.87</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.18.18.18.4.1.1.1.m1.1c">-13.87</annotation><annotation encoding="application/x-llamapun" id="S5.T1.18.18.18.4.1.1.1.m1.1d">- 13.87</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T1.19.19.19.5.2.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T1.19.19.19.5.2.2.1"><math alttext="-0.13" class="ltx_Math" display="inline" id="S5.T1.19.19.19.5.2.2.1.m1.1"><semantics id="S5.T1.19.19.19.5.2.2.1.m1.1a"><mrow id="S5.T1.19.19.19.5.2.2.1.m1.1.1" xref="S5.T1.19.19.19.5.2.2.1.m1.1.1.cmml"><mo id="S5.T1.19.19.19.5.2.2.1.m1.1.1a" xref="S5.T1.19.19.19.5.2.2.1.m1.1.1.cmml">−</mo><mn id="S5.T1.19.19.19.5.2.2.1.m1.1.1.2" xref="S5.T1.19.19.19.5.2.2.1.m1.1.1.2.cmml">0.13</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.19.19.19.5.2.2.1.m1.1b"><apply id="S5.T1.19.19.19.5.2.2.1.m1.1.1.cmml" xref="S5.T1.19.19.19.5.2.2.1.m1.1.1"><minus id="S5.T1.19.19.19.5.2.2.1.m1.1.1.1.cmml" xref="S5.T1.19.19.19.5.2.2.1.m1.1.1"></minus><cn id="S5.T1.19.19.19.5.2.2.1.m1.1.1.2.cmml" type="float" xref="S5.T1.19.19.19.5.2.2.1.m1.1.1.2">0.13</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.19.19.19.5.2.2.1.m1.1c">-0.13</annotation><annotation encoding="application/x-llamapun" id="S5.T1.19.19.19.5.2.2.1.m1.1d">- 0.13</annotation></semantics></math></td>
</tr>
</tbody></table>
</td>
<td class="ltx_td ltx_align_center" id="S5.T1.21.21.21.7">
<table class="ltx_tabular ltx_align_middle" id="S5.T1.21.21.21.7.2">
<tbody><tr class="ltx_tr" id="S5.T1.20.20.20.6.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T1.20.20.20.6.1.1.1" style="padding-bottom:-5.16663pt;"><math alttext="-21.10" class="ltx_Math" display="inline" id="S5.T1.20.20.20.6.1.1.1.m1.1"><semantics id="S5.T1.20.20.20.6.1.1.1.m1.1a"><mrow id="S5.T1.20.20.20.6.1.1.1.m1.1.1" xref="S5.T1.20.20.20.6.1.1.1.m1.1.1.cmml"><mo id="S5.T1.20.20.20.6.1.1.1.m1.1.1a" xref="S5.T1.20.20.20.6.1.1.1.m1.1.1.cmml">−</mo><mn id="S5.T1.20.20.20.6.1.1.1.m1.1.1.2" xref="S5.T1.20.20.20.6.1.1.1.m1.1.1.2.cmml">21.10</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.20.20.20.6.1.1.1.m1.1b"><apply id="S5.T1.20.20.20.6.1.1.1.m1.1.1.cmml" xref="S5.T1.20.20.20.6.1.1.1.m1.1.1"><minus id="S5.T1.20.20.20.6.1.1.1.m1.1.1.1.cmml" xref="S5.T1.20.20.20.6.1.1.1.m1.1.1"></minus><cn id="S5.T1.20.20.20.6.1.1.1.m1.1.1.2.cmml" type="float" xref="S5.T1.20.20.20.6.1.1.1.m1.1.1.2">21.10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.20.20.20.6.1.1.1.m1.1c">-21.10</annotation><annotation encoding="application/x-llamapun" id="S5.T1.20.20.20.6.1.1.1.m1.1d">- 21.10</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T1.21.21.21.7.2.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T1.21.21.21.7.2.2.1"><math alttext="-0.10" class="ltx_Math" display="inline" id="S5.T1.21.21.21.7.2.2.1.m1.1"><semantics id="S5.T1.21.21.21.7.2.2.1.m1.1a"><mrow id="S5.T1.21.21.21.7.2.2.1.m1.1.1" xref="S5.T1.21.21.21.7.2.2.1.m1.1.1.cmml"><mo id="S5.T1.21.21.21.7.2.2.1.m1.1.1a" xref="S5.T1.21.21.21.7.2.2.1.m1.1.1.cmml">−</mo><mn id="S5.T1.21.21.21.7.2.2.1.m1.1.1.2" xref="S5.T1.21.21.21.7.2.2.1.m1.1.1.2.cmml">0.10</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.21.21.21.7.2.2.1.m1.1b"><apply id="S5.T1.21.21.21.7.2.2.1.m1.1.1.cmml" xref="S5.T1.21.21.21.7.2.2.1.m1.1.1"><minus id="S5.T1.21.21.21.7.2.2.1.m1.1.1.1.cmml" xref="S5.T1.21.21.21.7.2.2.1.m1.1.1"></minus><cn id="S5.T1.21.21.21.7.2.2.1.m1.1.1.2.cmml" type="float" xref="S5.T1.21.21.21.7.2.2.1.m1.1.1.2">0.10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.21.21.21.7.2.2.1.m1.1c">-0.10</annotation><annotation encoding="application/x-llamapun" id="S5.T1.21.21.21.7.2.2.1.m1.1d">- 0.10</annotation></semantics></math></td>
</tr>
</tbody></table>
</td>
<td class="ltx_td ltx_align_center" id="S5.T1.23.23.23.9">
<table class="ltx_tabular ltx_align_middle" id="S5.T1.23.23.23.9.2">
<tbody><tr class="ltx_tr" id="S5.T1.22.22.22.8.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T1.22.22.22.8.1.1.1" style="padding-bottom:-5.16663pt;"><math alttext="-24.74" class="ltx_Math" display="inline" id="S5.T1.22.22.22.8.1.1.1.m1.1"><semantics id="S5.T1.22.22.22.8.1.1.1.m1.1a"><mrow id="S5.T1.22.22.22.8.1.1.1.m1.1.1" xref="S5.T1.22.22.22.8.1.1.1.m1.1.1.cmml"><mo id="S5.T1.22.22.22.8.1.1.1.m1.1.1a" xref="S5.T1.22.22.22.8.1.1.1.m1.1.1.cmml">−</mo><mn id="S5.T1.22.22.22.8.1.1.1.m1.1.1.2" xref="S5.T1.22.22.22.8.1.1.1.m1.1.1.2.cmml">24.74</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.22.22.22.8.1.1.1.m1.1b"><apply id="S5.T1.22.22.22.8.1.1.1.m1.1.1.cmml" xref="S5.T1.22.22.22.8.1.1.1.m1.1.1"><minus id="S5.T1.22.22.22.8.1.1.1.m1.1.1.1.cmml" xref="S5.T1.22.22.22.8.1.1.1.m1.1.1"></minus><cn id="S5.T1.22.22.22.8.1.1.1.m1.1.1.2.cmml" type="float" xref="S5.T1.22.22.22.8.1.1.1.m1.1.1.2">24.74</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.22.22.22.8.1.1.1.m1.1c">-24.74</annotation><annotation encoding="application/x-llamapun" id="S5.T1.22.22.22.8.1.1.1.m1.1d">- 24.74</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T1.23.23.23.9.2.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T1.23.23.23.9.2.2.1"><math alttext="-0.68" class="ltx_Math" display="inline" id="S5.T1.23.23.23.9.2.2.1.m1.1"><semantics id="S5.T1.23.23.23.9.2.2.1.m1.1a"><mrow id="S5.T1.23.23.23.9.2.2.1.m1.1.1" xref="S5.T1.23.23.23.9.2.2.1.m1.1.1.cmml"><mo id="S5.T1.23.23.23.9.2.2.1.m1.1.1a" xref="S5.T1.23.23.23.9.2.2.1.m1.1.1.cmml">−</mo><mn id="S5.T1.23.23.23.9.2.2.1.m1.1.1.2" xref="S5.T1.23.23.23.9.2.2.1.m1.1.1.2.cmml">0.68</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.23.23.23.9.2.2.1.m1.1b"><apply id="S5.T1.23.23.23.9.2.2.1.m1.1.1.cmml" xref="S5.T1.23.23.23.9.2.2.1.m1.1.1"><minus id="S5.T1.23.23.23.9.2.2.1.m1.1.1.1.cmml" xref="S5.T1.23.23.23.9.2.2.1.m1.1.1"></minus><cn id="S5.T1.23.23.23.9.2.2.1.m1.1.1.2.cmml" type="float" xref="S5.T1.23.23.23.9.2.2.1.m1.1.1.2">0.68</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.23.23.23.9.2.2.1.m1.1c">-0.68</annotation><annotation encoding="application/x-llamapun" id="S5.T1.23.23.23.9.2.2.1.m1.1d">- 0.68</annotation></semantics></math></td>
</tr>
</tbody></table>
</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T1.25.25.25.11">
<table class="ltx_tabular ltx_align_middle" id="S5.T1.25.25.25.11.2">
<tbody><tr class="ltx_tr" id="S5.T1.24.24.24.10.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T1.24.24.24.10.1.1.1" style="padding-bottom:-5.16663pt;"><math alttext="-28.38" class="ltx_Math" display="inline" id="S5.T1.24.24.24.10.1.1.1.m1.1"><semantics id="S5.T1.24.24.24.10.1.1.1.m1.1a"><mrow id="S5.T1.24.24.24.10.1.1.1.m1.1.1" xref="S5.T1.24.24.24.10.1.1.1.m1.1.1.cmml"><mo id="S5.T1.24.24.24.10.1.1.1.m1.1.1a" xref="S5.T1.24.24.24.10.1.1.1.m1.1.1.cmml">−</mo><mn id="S5.T1.24.24.24.10.1.1.1.m1.1.1.2" xref="S5.T1.24.24.24.10.1.1.1.m1.1.1.2.cmml">28.38</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.24.24.24.10.1.1.1.m1.1b"><apply id="S5.T1.24.24.24.10.1.1.1.m1.1.1.cmml" xref="S5.T1.24.24.24.10.1.1.1.m1.1.1"><minus id="S5.T1.24.24.24.10.1.1.1.m1.1.1.1.cmml" xref="S5.T1.24.24.24.10.1.1.1.m1.1.1"></minus><cn id="S5.T1.24.24.24.10.1.1.1.m1.1.1.2.cmml" type="float" xref="S5.T1.24.24.24.10.1.1.1.m1.1.1.2">28.38</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.24.24.24.10.1.1.1.m1.1c">-28.38</annotation><annotation encoding="application/x-llamapun" id="S5.T1.24.24.24.10.1.1.1.m1.1d">- 28.38</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T1.25.25.25.11.2.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T1.25.25.25.11.2.2.1"><math alttext="-0.62" class="ltx_Math" display="inline" id="S5.T1.25.25.25.11.2.2.1.m1.1"><semantics id="S5.T1.25.25.25.11.2.2.1.m1.1a"><mrow id="S5.T1.25.25.25.11.2.2.1.m1.1.1" xref="S5.T1.25.25.25.11.2.2.1.m1.1.1.cmml"><mo id="S5.T1.25.25.25.11.2.2.1.m1.1.1a" xref="S5.T1.25.25.25.11.2.2.1.m1.1.1.cmml">−</mo><mn id="S5.T1.25.25.25.11.2.2.1.m1.1.1.2" xref="S5.T1.25.25.25.11.2.2.1.m1.1.1.2.cmml">0.62</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.25.25.25.11.2.2.1.m1.1b"><apply id="S5.T1.25.25.25.11.2.2.1.m1.1.1.cmml" xref="S5.T1.25.25.25.11.2.2.1.m1.1.1"><minus id="S5.T1.25.25.25.11.2.2.1.m1.1.1.1.cmml" xref="S5.T1.25.25.25.11.2.2.1.m1.1.1"></minus><cn id="S5.T1.25.25.25.11.2.2.1.m1.1.1.2.cmml" type="float" xref="S5.T1.25.25.25.11.2.2.1.m1.1.1.2">0.62</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.25.25.25.11.2.2.1.m1.1c">-0.62</annotation><annotation encoding="application/x-llamapun" id="S5.T1.25.25.25.11.2.2.1.m1.1d">- 0.62</annotation></semantics></math></td>
</tr>
</tbody></table>
</td>
</tr>
<tr class="ltx_tr" id="S5.T1.51.51.54.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="6" id="S5.T1.51.51.54.3.1"><span class="ltx_text ltx_font_italic" id="S5.T1.51.51.54.3.1.1">– Step2: Semantics Merge –</span></th>
</tr>
<tr class="ltx_tr" id="S5.T1.36.36.36">
<th class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_row" id="S5.T1.36.36.36.12">4</th>
<th class="ltx_td ltx_nopad_l ltx_align_center ltx_th ltx_th_row" id="S5.T1.28.28.28.3"><span class="ltx_text ltx_font_bold" id="S5.T1.28.28.28.3.3">Demo. Forerunner <math alttext="s_{i}" class="ltx_Math" display="inline" id="S5.T1.26.26.26.1.1.m1.1"><semantics id="S5.T1.26.26.26.1.1.m1.1a"><msub id="S5.T1.26.26.26.1.1.m1.1.1" xref="S5.T1.26.26.26.1.1.m1.1.1.cmml"><mi id="S5.T1.26.26.26.1.1.m1.1.1.2" xref="S5.T1.26.26.26.1.1.m1.1.1.2.cmml">s</mi><mi id="S5.T1.26.26.26.1.1.m1.1.1.3" xref="S5.T1.26.26.26.1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S5.T1.26.26.26.1.1.m1.1b"><apply id="S5.T1.26.26.26.1.1.m1.1.1.cmml" xref="S5.T1.26.26.26.1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T1.26.26.26.1.1.m1.1.1.1.cmml" xref="S5.T1.26.26.26.1.1.m1.1.1">subscript</csymbol><ci id="S5.T1.26.26.26.1.1.m1.1.1.2.cmml" xref="S5.T1.26.26.26.1.1.m1.1.1.2">𝑠</ci><ci id="S5.T1.26.26.26.1.1.m1.1.1.3.cmml" xref="S5.T1.26.26.26.1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.26.26.26.1.1.m1.1c">s_{i}</annotation><annotation encoding="application/x-llamapun" id="S5.T1.26.26.26.1.1.m1.1d">italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S5.T1.27.27.27.2.2.m2.1"><semantics id="S5.T1.27.27.27.2.2.m2.1a"><mo id="S5.T1.27.27.27.2.2.m2.1.1" stretchy="false" xref="S5.T1.27.27.27.2.2.m2.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S5.T1.27.27.27.2.2.m2.1b"><ci id="S5.T1.27.27.27.2.2.m2.1.1.cmml" xref="S5.T1.27.27.27.2.2.m2.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.27.27.27.2.2.m2.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T1.27.27.27.2.2.m2.1d">→</annotation></semantics></math> Label <math alttext="y_{i}" class="ltx_Math" display="inline" id="S5.T1.28.28.28.3.3.m3.1"><semantics id="S5.T1.28.28.28.3.3.m3.1a"><msub id="S5.T1.28.28.28.3.3.m3.1.1" xref="S5.T1.28.28.28.3.3.m3.1.1.cmml"><mi id="S5.T1.28.28.28.3.3.m3.1.1.2" xref="S5.T1.28.28.28.3.3.m3.1.1.2.cmml">y</mi><mi id="S5.T1.28.28.28.3.3.m3.1.1.3" xref="S5.T1.28.28.28.3.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S5.T1.28.28.28.3.3.m3.1b"><apply id="S5.T1.28.28.28.3.3.m3.1.1.cmml" xref="S5.T1.28.28.28.3.3.m3.1.1"><csymbol cd="ambiguous" id="S5.T1.28.28.28.3.3.m3.1.1.1.cmml" xref="S5.T1.28.28.28.3.3.m3.1.1">subscript</csymbol><ci id="S5.T1.28.28.28.3.3.m3.1.1.2.cmml" xref="S5.T1.28.28.28.3.3.m3.1.1.2">𝑦</ci><ci id="S5.T1.28.28.28.3.3.m3.1.1.3.cmml" xref="S5.T1.28.28.28.3.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.28.28.28.3.3.m3.1c">y_{i}</annotation><annotation encoding="application/x-llamapun" id="S5.T1.28.28.28.3.3.m3.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></span></th>
<td class="ltx_td ltx_align_center" id="S5.T1.30.30.30.5">
<table class="ltx_tabular ltx_align_middle" id="S5.T1.30.30.30.5.2">
<tbody><tr class="ltx_tr" id="S5.T1.29.29.29.4.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T1.29.29.29.4.1.1.1" style="padding-bottom:-5.16663pt;"><math alttext="-2.24" class="ltx_Math" display="inline" id="S5.T1.29.29.29.4.1.1.1.m1.1"><semantics id="S5.T1.29.29.29.4.1.1.1.m1.1a"><mrow id="S5.T1.29.29.29.4.1.1.1.m1.1.1" xref="S5.T1.29.29.29.4.1.1.1.m1.1.1.cmml"><mo id="S5.T1.29.29.29.4.1.1.1.m1.1.1a" xref="S5.T1.29.29.29.4.1.1.1.m1.1.1.cmml">−</mo><mn id="S5.T1.29.29.29.4.1.1.1.m1.1.1.2" xref="S5.T1.29.29.29.4.1.1.1.m1.1.1.2.cmml">2.24</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.29.29.29.4.1.1.1.m1.1b"><apply id="S5.T1.29.29.29.4.1.1.1.m1.1.1.cmml" xref="S5.T1.29.29.29.4.1.1.1.m1.1.1"><minus id="S5.T1.29.29.29.4.1.1.1.m1.1.1.1.cmml" xref="S5.T1.29.29.29.4.1.1.1.m1.1.1"></minus><cn id="S5.T1.29.29.29.4.1.1.1.m1.1.1.2.cmml" type="float" xref="S5.T1.29.29.29.4.1.1.1.m1.1.1.2">2.24</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.29.29.29.4.1.1.1.m1.1c">-2.24</annotation><annotation encoding="application/x-llamapun" id="S5.T1.29.29.29.4.1.1.1.m1.1d">- 2.24</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T1.30.30.30.5.2.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T1.30.30.30.5.2.2.1"><math alttext="+0.07" class="ltx_Math" display="inline" id="S5.T1.30.30.30.5.2.2.1.m1.1"><semantics id="S5.T1.30.30.30.5.2.2.1.m1.1a"><mrow id="S5.T1.30.30.30.5.2.2.1.m1.1.1" xref="S5.T1.30.30.30.5.2.2.1.m1.1.1.cmml"><mo id="S5.T1.30.30.30.5.2.2.1.m1.1.1a" xref="S5.T1.30.30.30.5.2.2.1.m1.1.1.cmml">+</mo><mn id="S5.T1.30.30.30.5.2.2.1.m1.1.1.2" xref="S5.T1.30.30.30.5.2.2.1.m1.1.1.2.cmml">0.07</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.30.30.30.5.2.2.1.m1.1b"><apply id="S5.T1.30.30.30.5.2.2.1.m1.1.1.cmml" xref="S5.T1.30.30.30.5.2.2.1.m1.1.1"><plus id="S5.T1.30.30.30.5.2.2.1.m1.1.1.1.cmml" xref="S5.T1.30.30.30.5.2.2.1.m1.1.1"></plus><cn id="S5.T1.30.30.30.5.2.2.1.m1.1.1.2.cmml" type="float" xref="S5.T1.30.30.30.5.2.2.1.m1.1.1.2">0.07</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.30.30.30.5.2.2.1.m1.1c">+0.07</annotation><annotation encoding="application/x-llamapun" id="S5.T1.30.30.30.5.2.2.1.m1.1d">+ 0.07</annotation></semantics></math></td>
</tr>
</tbody></table>
</td>
<td class="ltx_td ltx_align_center" id="S5.T1.32.32.32.7">
<table class="ltx_tabular ltx_align_middle" id="S5.T1.32.32.32.7.2">
<tbody><tr class="ltx_tr" id="S5.T1.31.31.31.6.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T1.31.31.31.6.1.1.1" style="padding-bottom:-5.16663pt;"><math alttext="-3.45" class="ltx_Math" display="inline" id="S5.T1.31.31.31.6.1.1.1.m1.1"><semantics id="S5.T1.31.31.31.6.1.1.1.m1.1a"><mrow id="S5.T1.31.31.31.6.1.1.1.m1.1.1" xref="S5.T1.31.31.31.6.1.1.1.m1.1.1.cmml"><mo id="S5.T1.31.31.31.6.1.1.1.m1.1.1a" xref="S5.T1.31.31.31.6.1.1.1.m1.1.1.cmml">−</mo><mn id="S5.T1.31.31.31.6.1.1.1.m1.1.1.2" xref="S5.T1.31.31.31.6.1.1.1.m1.1.1.2.cmml">3.45</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.31.31.31.6.1.1.1.m1.1b"><apply id="S5.T1.31.31.31.6.1.1.1.m1.1.1.cmml" xref="S5.T1.31.31.31.6.1.1.1.m1.1.1"><minus id="S5.T1.31.31.31.6.1.1.1.m1.1.1.1.cmml" xref="S5.T1.31.31.31.6.1.1.1.m1.1.1"></minus><cn id="S5.T1.31.31.31.6.1.1.1.m1.1.1.2.cmml" type="float" xref="S5.T1.31.31.31.6.1.1.1.m1.1.1.2">3.45</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.31.31.31.6.1.1.1.m1.1c">-3.45</annotation><annotation encoding="application/x-llamapun" id="S5.T1.31.31.31.6.1.1.1.m1.1d">- 3.45</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T1.32.32.32.7.2.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T1.32.32.32.7.2.2.1"><math alttext="-0.20" class="ltx_Math" display="inline" id="S5.T1.32.32.32.7.2.2.1.m1.1"><semantics id="S5.T1.32.32.32.7.2.2.1.m1.1a"><mrow id="S5.T1.32.32.32.7.2.2.1.m1.1.1" xref="S5.T1.32.32.32.7.2.2.1.m1.1.1.cmml"><mo id="S5.T1.32.32.32.7.2.2.1.m1.1.1a" xref="S5.T1.32.32.32.7.2.2.1.m1.1.1.cmml">−</mo><mn id="S5.T1.32.32.32.7.2.2.1.m1.1.1.2" xref="S5.T1.32.32.32.7.2.2.1.m1.1.1.2.cmml">0.20</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.32.32.32.7.2.2.1.m1.1b"><apply id="S5.T1.32.32.32.7.2.2.1.m1.1.1.cmml" xref="S5.T1.32.32.32.7.2.2.1.m1.1.1"><minus id="S5.T1.32.32.32.7.2.2.1.m1.1.1.1.cmml" xref="S5.T1.32.32.32.7.2.2.1.m1.1.1"></minus><cn id="S5.T1.32.32.32.7.2.2.1.m1.1.1.2.cmml" type="float" xref="S5.T1.32.32.32.7.2.2.1.m1.1.1.2">0.20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.32.32.32.7.2.2.1.m1.1c">-0.20</annotation><annotation encoding="application/x-llamapun" id="S5.T1.32.32.32.7.2.2.1.m1.1d">- 0.20</annotation></semantics></math></td>
</tr>
</tbody></table>
</td>
<td class="ltx_td ltx_align_center" id="S5.T1.34.34.34.9">
<table class="ltx_tabular ltx_align_middle" id="S5.T1.34.34.34.9.2">
<tbody><tr class="ltx_tr" id="S5.T1.33.33.33.8.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T1.33.33.33.8.1.1.1" style="padding-bottom:-5.16663pt;"><math alttext="-3.39" class="ltx_Math" display="inline" id="S5.T1.33.33.33.8.1.1.1.m1.1"><semantics id="S5.T1.33.33.33.8.1.1.1.m1.1a"><mrow id="S5.T1.33.33.33.8.1.1.1.m1.1.1" xref="S5.T1.33.33.33.8.1.1.1.m1.1.1.cmml"><mo id="S5.T1.33.33.33.8.1.1.1.m1.1.1a" xref="S5.T1.33.33.33.8.1.1.1.m1.1.1.cmml">−</mo><mn id="S5.T1.33.33.33.8.1.1.1.m1.1.1.2" xref="S5.T1.33.33.33.8.1.1.1.m1.1.1.2.cmml">3.39</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.33.33.33.8.1.1.1.m1.1b"><apply id="S5.T1.33.33.33.8.1.1.1.m1.1.1.cmml" xref="S5.T1.33.33.33.8.1.1.1.m1.1.1"><minus id="S5.T1.33.33.33.8.1.1.1.m1.1.1.1.cmml" xref="S5.T1.33.33.33.8.1.1.1.m1.1.1"></minus><cn id="S5.T1.33.33.33.8.1.1.1.m1.1.1.2.cmml" type="float" xref="S5.T1.33.33.33.8.1.1.1.m1.1.1.2">3.39</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.33.33.33.8.1.1.1.m1.1c">-3.39</annotation><annotation encoding="application/x-llamapun" id="S5.T1.33.33.33.8.1.1.1.m1.1d">- 3.39</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T1.34.34.34.9.2.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T1.34.34.34.9.2.2.1"><math alttext="+0.10" class="ltx_Math" display="inline" id="S5.T1.34.34.34.9.2.2.1.m1.1"><semantics id="S5.T1.34.34.34.9.2.2.1.m1.1a"><mrow id="S5.T1.34.34.34.9.2.2.1.m1.1.1" xref="S5.T1.34.34.34.9.2.2.1.m1.1.1.cmml"><mo id="S5.T1.34.34.34.9.2.2.1.m1.1.1a" xref="S5.T1.34.34.34.9.2.2.1.m1.1.1.cmml">+</mo><mn id="S5.T1.34.34.34.9.2.2.1.m1.1.1.2" xref="S5.T1.34.34.34.9.2.2.1.m1.1.1.2.cmml">0.10</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.34.34.34.9.2.2.1.m1.1b"><apply id="S5.T1.34.34.34.9.2.2.1.m1.1.1.cmml" xref="S5.T1.34.34.34.9.2.2.1.m1.1.1"><plus id="S5.T1.34.34.34.9.2.2.1.m1.1.1.1.cmml" xref="S5.T1.34.34.34.9.2.2.1.m1.1.1"></plus><cn id="S5.T1.34.34.34.9.2.2.1.m1.1.1.2.cmml" type="float" xref="S5.T1.34.34.34.9.2.2.1.m1.1.1.2">0.10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.34.34.34.9.2.2.1.m1.1c">+0.10</annotation><annotation encoding="application/x-llamapun" id="S5.T1.34.34.34.9.2.2.1.m1.1d">+ 0.10</annotation></semantics></math></td>
</tr>
</tbody></table>
</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T1.36.36.36.11">
<table class="ltx_tabular ltx_align_middle" id="S5.T1.36.36.36.11.2">
<tbody><tr class="ltx_tr" id="S5.T1.35.35.35.10.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T1.35.35.35.10.1.1.1" style="padding-bottom:-5.16663pt;"><math alttext="-3.42" class="ltx_Math" display="inline" id="S5.T1.35.35.35.10.1.1.1.m1.1"><semantics id="S5.T1.35.35.35.10.1.1.1.m1.1a"><mrow id="S5.T1.35.35.35.10.1.1.1.m1.1.1" xref="S5.T1.35.35.35.10.1.1.1.m1.1.1.cmml"><mo id="S5.T1.35.35.35.10.1.1.1.m1.1.1a" xref="S5.T1.35.35.35.10.1.1.1.m1.1.1.cmml">−</mo><mn id="S5.T1.35.35.35.10.1.1.1.m1.1.1.2" xref="S5.T1.35.35.35.10.1.1.1.m1.1.1.2.cmml">3.42</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.35.35.35.10.1.1.1.m1.1b"><apply id="S5.T1.35.35.35.10.1.1.1.m1.1.1.cmml" xref="S5.T1.35.35.35.10.1.1.1.m1.1.1"><minus id="S5.T1.35.35.35.10.1.1.1.m1.1.1.1.cmml" xref="S5.T1.35.35.35.10.1.1.1.m1.1.1"></minus><cn id="S5.T1.35.35.35.10.1.1.1.m1.1.1.2.cmml" type="float" xref="S5.T1.35.35.35.10.1.1.1.m1.1.1.2">3.42</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.35.35.35.10.1.1.1.m1.1c">-3.42</annotation><annotation encoding="application/x-llamapun" id="S5.T1.35.35.35.10.1.1.1.m1.1d">- 3.42</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T1.36.36.36.11.2.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T1.36.36.36.11.2.2.1"><math alttext="-0.26" class="ltx_Math" display="inline" id="S5.T1.36.36.36.11.2.2.1.m1.1"><semantics id="S5.T1.36.36.36.11.2.2.1.m1.1a"><mrow id="S5.T1.36.36.36.11.2.2.1.m1.1.1" xref="S5.T1.36.36.36.11.2.2.1.m1.1.1.cmml"><mo id="S5.T1.36.36.36.11.2.2.1.m1.1.1a" xref="S5.T1.36.36.36.11.2.2.1.m1.1.1.cmml">−</mo><mn id="S5.T1.36.36.36.11.2.2.1.m1.1.1.2" xref="S5.T1.36.36.36.11.2.2.1.m1.1.1.2.cmml">0.26</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.36.36.36.11.2.2.1.m1.1b"><apply id="S5.T1.36.36.36.11.2.2.1.m1.1.1.cmml" xref="S5.T1.36.36.36.11.2.2.1.m1.1.1"><minus id="S5.T1.36.36.36.11.2.2.1.m1.1.1.1.cmml" xref="S5.T1.36.36.36.11.2.2.1.m1.1.1"></minus><cn id="S5.T1.36.36.36.11.2.2.1.m1.1.1.2.cmml" type="float" xref="S5.T1.36.36.36.11.2.2.1.m1.1.1.2">0.26</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.36.36.36.11.2.2.1.m1.1c">-0.26</annotation><annotation encoding="application/x-llamapun" id="S5.T1.36.36.36.11.2.2.1.m1.1d">- 0.26</annotation></semantics></math></td>
</tr>
</tbody></table>
</td>
</tr>
<tr class="ltx_tr" id="S5.T1.51.51.55.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="6" id="S5.T1.51.51.55.4.1"><span class="ltx_text ltx_font_italic" id="S5.T1.51.51.55.4.1.1">– Step3: Feature Retrieval &amp; Copy –</span></th>
</tr>
<tr class="ltx_tr" id="S5.T1.47.47.47">
<th class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_row" id="S5.T1.47.47.47.12">5</th>
<th class="ltx_td ltx_nopad_l ltx_align_center ltx_th ltx_th_row" id="S5.T1.39.39.39.3"><span class="ltx_text ltx_font_bold" id="S5.T1.39.39.39.3.3">Label <math alttext="y_{i}" class="ltx_Math" display="inline" id="S5.T1.37.37.37.1.1.m1.1"><semantics id="S5.T1.37.37.37.1.1.m1.1a"><msub id="S5.T1.37.37.37.1.1.m1.1.1" xref="S5.T1.37.37.37.1.1.m1.1.1.cmml"><mi id="S5.T1.37.37.37.1.1.m1.1.1.2" xref="S5.T1.37.37.37.1.1.m1.1.1.2.cmml">y</mi><mi id="S5.T1.37.37.37.1.1.m1.1.1.3" xref="S5.T1.37.37.37.1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S5.T1.37.37.37.1.1.m1.1b"><apply id="S5.T1.37.37.37.1.1.m1.1.1.cmml" xref="S5.T1.37.37.37.1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T1.37.37.37.1.1.m1.1.1.1.cmml" xref="S5.T1.37.37.37.1.1.m1.1.1">subscript</csymbol><ci id="S5.T1.37.37.37.1.1.m1.1.1.2.cmml" xref="S5.T1.37.37.37.1.1.m1.1.1.2">𝑦</ci><ci id="S5.T1.37.37.37.1.1.m1.1.1.3.cmml" xref="S5.T1.37.37.37.1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.37.37.37.1.1.m1.1c">y_{i}</annotation><annotation encoding="application/x-llamapun" id="S5.T1.37.37.37.1.1.m1.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S5.T1.38.38.38.2.2.m2.1"><semantics id="S5.T1.38.38.38.2.2.m2.1a"><mo id="S5.T1.38.38.38.2.2.m2.1.1" stretchy="false" xref="S5.T1.38.38.38.2.2.m2.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S5.T1.38.38.38.2.2.m2.1b"><ci id="S5.T1.38.38.38.2.2.m2.1.1.cmml" xref="S5.T1.38.38.38.2.2.m2.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.38.38.38.2.2.m2.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T1.38.38.38.2.2.m2.1d">→</annotation></semantics></math> Query Forerunner <math alttext="s_{q}" class="ltx_Math" display="inline" id="S5.T1.39.39.39.3.3.m3.1"><semantics id="S5.T1.39.39.39.3.3.m3.1a"><msub id="S5.T1.39.39.39.3.3.m3.1.1" xref="S5.T1.39.39.39.3.3.m3.1.1.cmml"><mi id="S5.T1.39.39.39.3.3.m3.1.1.2" xref="S5.T1.39.39.39.3.3.m3.1.1.2.cmml">s</mi><mi id="S5.T1.39.39.39.3.3.m3.1.1.3" xref="S5.T1.39.39.39.3.3.m3.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S5.T1.39.39.39.3.3.m3.1b"><apply id="S5.T1.39.39.39.3.3.m3.1.1.cmml" xref="S5.T1.39.39.39.3.3.m3.1.1"><csymbol cd="ambiguous" id="S5.T1.39.39.39.3.3.m3.1.1.1.cmml" xref="S5.T1.39.39.39.3.3.m3.1.1">subscript</csymbol><ci id="S5.T1.39.39.39.3.3.m3.1.1.2.cmml" xref="S5.T1.39.39.39.3.3.m3.1.1.2">𝑠</ci><ci id="S5.T1.39.39.39.3.3.m3.1.1.3.cmml" xref="S5.T1.39.39.39.3.3.m3.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.39.39.39.3.3.m3.1c">s_{q}</annotation><annotation encoding="application/x-llamapun" id="S5.T1.39.39.39.3.3.m3.1d">italic_s start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math></span></th>
<td class="ltx_td ltx_align_center" id="S5.T1.41.41.41.5">
<table class="ltx_tabular ltx_align_middle" id="S5.T1.41.41.41.5.2">
<tbody><tr class="ltx_tr" id="S5.T1.40.40.40.4.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T1.40.40.40.4.1.1.1" style="padding-bottom:-5.16663pt;"><math alttext="-5.14" class="ltx_Math" display="inline" id="S5.T1.40.40.40.4.1.1.1.m1.1"><semantics id="S5.T1.40.40.40.4.1.1.1.m1.1a"><mrow id="S5.T1.40.40.40.4.1.1.1.m1.1.1" xref="S5.T1.40.40.40.4.1.1.1.m1.1.1.cmml"><mo id="S5.T1.40.40.40.4.1.1.1.m1.1.1a" xref="S5.T1.40.40.40.4.1.1.1.m1.1.1.cmml">−</mo><mn id="S5.T1.40.40.40.4.1.1.1.m1.1.1.2" xref="S5.T1.40.40.40.4.1.1.1.m1.1.1.2.cmml">5.14</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.40.40.40.4.1.1.1.m1.1b"><apply id="S5.T1.40.40.40.4.1.1.1.m1.1.1.cmml" xref="S5.T1.40.40.40.4.1.1.1.m1.1.1"><minus id="S5.T1.40.40.40.4.1.1.1.m1.1.1.1.cmml" xref="S5.T1.40.40.40.4.1.1.1.m1.1.1"></minus><cn id="S5.T1.40.40.40.4.1.1.1.m1.1.1.2.cmml" type="float" xref="S5.T1.40.40.40.4.1.1.1.m1.1.1.2">5.14</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.40.40.40.4.1.1.1.m1.1c">-5.14</annotation><annotation encoding="application/x-llamapun" id="S5.T1.40.40.40.4.1.1.1.m1.1d">- 5.14</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T1.41.41.41.5.2.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T1.41.41.41.5.2.2.1"><math alttext="+0.07" class="ltx_Math" display="inline" id="S5.T1.41.41.41.5.2.2.1.m1.1"><semantics id="S5.T1.41.41.41.5.2.2.1.m1.1a"><mrow id="S5.T1.41.41.41.5.2.2.1.m1.1.1" xref="S5.T1.41.41.41.5.2.2.1.m1.1.1.cmml"><mo id="S5.T1.41.41.41.5.2.2.1.m1.1.1a" xref="S5.T1.41.41.41.5.2.2.1.m1.1.1.cmml">+</mo><mn id="S5.T1.41.41.41.5.2.2.1.m1.1.1.2" xref="S5.T1.41.41.41.5.2.2.1.m1.1.1.2.cmml">0.07</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.41.41.41.5.2.2.1.m1.1b"><apply id="S5.T1.41.41.41.5.2.2.1.m1.1.1.cmml" xref="S5.T1.41.41.41.5.2.2.1.m1.1.1"><plus id="S5.T1.41.41.41.5.2.2.1.m1.1.1.1.cmml" xref="S5.T1.41.41.41.5.2.2.1.m1.1.1"></plus><cn id="S5.T1.41.41.41.5.2.2.1.m1.1.1.2.cmml" type="float" xref="S5.T1.41.41.41.5.2.2.1.m1.1.1.2">0.07</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.41.41.41.5.2.2.1.m1.1c">+0.07</annotation><annotation encoding="application/x-llamapun" id="S5.T1.41.41.41.5.2.2.1.m1.1d">+ 0.07</annotation></semantics></math></td>
</tr>
</tbody></table>
</td>
<td class="ltx_td ltx_align_center" id="S5.T1.43.43.43.7">
<table class="ltx_tabular ltx_align_middle" id="S5.T1.43.43.43.7.2">
<tbody><tr class="ltx_tr" id="S5.T1.42.42.42.6.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T1.42.42.42.6.1.1.1" style="padding-bottom:-5.16663pt;"><math alttext="-10.03" class="ltx_Math" display="inline" id="S5.T1.42.42.42.6.1.1.1.m1.1"><semantics id="S5.T1.42.42.42.6.1.1.1.m1.1a"><mrow id="S5.T1.42.42.42.6.1.1.1.m1.1.1" xref="S5.T1.42.42.42.6.1.1.1.m1.1.1.cmml"><mo id="S5.T1.42.42.42.6.1.1.1.m1.1.1a" xref="S5.T1.42.42.42.6.1.1.1.m1.1.1.cmml">−</mo><mn id="S5.T1.42.42.42.6.1.1.1.m1.1.1.2" xref="S5.T1.42.42.42.6.1.1.1.m1.1.1.2.cmml">10.03</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.42.42.42.6.1.1.1.m1.1b"><apply id="S5.T1.42.42.42.6.1.1.1.m1.1.1.cmml" xref="S5.T1.42.42.42.6.1.1.1.m1.1.1"><minus id="S5.T1.42.42.42.6.1.1.1.m1.1.1.1.cmml" xref="S5.T1.42.42.42.6.1.1.1.m1.1.1"></minus><cn id="S5.T1.42.42.42.6.1.1.1.m1.1.1.2.cmml" type="float" xref="S5.T1.42.42.42.6.1.1.1.m1.1.1.2">10.03</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.42.42.42.6.1.1.1.m1.1c">-10.03</annotation><annotation encoding="application/x-llamapun" id="S5.T1.42.42.42.6.1.1.1.m1.1d">- 10.03</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T1.43.43.43.7.2.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T1.43.43.43.7.2.2.1"><math alttext="-0.07" class="ltx_Math" display="inline" id="S5.T1.43.43.43.7.2.2.1.m1.1"><semantics id="S5.T1.43.43.43.7.2.2.1.m1.1a"><mrow id="S5.T1.43.43.43.7.2.2.1.m1.1.1" xref="S5.T1.43.43.43.7.2.2.1.m1.1.1.cmml"><mo id="S5.T1.43.43.43.7.2.2.1.m1.1.1a" xref="S5.T1.43.43.43.7.2.2.1.m1.1.1.cmml">−</mo><mn id="S5.T1.43.43.43.7.2.2.1.m1.1.1.2" xref="S5.T1.43.43.43.7.2.2.1.m1.1.1.2.cmml">0.07</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.43.43.43.7.2.2.1.m1.1b"><apply id="S5.T1.43.43.43.7.2.2.1.m1.1.1.cmml" xref="S5.T1.43.43.43.7.2.2.1.m1.1.1"><minus id="S5.T1.43.43.43.7.2.2.1.m1.1.1.1.cmml" xref="S5.T1.43.43.43.7.2.2.1.m1.1.1"></minus><cn id="S5.T1.43.43.43.7.2.2.1.m1.1.1.2.cmml" type="float" xref="S5.T1.43.43.43.7.2.2.1.m1.1.1.2">0.07</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.43.43.43.7.2.2.1.m1.1c">-0.07</annotation><annotation encoding="application/x-llamapun" id="S5.T1.43.43.43.7.2.2.1.m1.1d">- 0.07</annotation></semantics></math></td>
</tr>
</tbody></table>
</td>
<td class="ltx_td ltx_align_center" id="S5.T1.45.45.45.9">
<table class="ltx_tabular ltx_align_middle" id="S5.T1.45.45.45.9.2">
<tbody><tr class="ltx_tr" id="S5.T1.44.44.44.8.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T1.44.44.44.8.1.1.1" style="padding-bottom:-5.16663pt;"><math alttext="-11.36" class="ltx_Math" display="inline" id="S5.T1.44.44.44.8.1.1.1.m1.1"><semantics id="S5.T1.44.44.44.8.1.1.1.m1.1a"><mrow id="S5.T1.44.44.44.8.1.1.1.m1.1.1" xref="S5.T1.44.44.44.8.1.1.1.m1.1.1.cmml"><mo id="S5.T1.44.44.44.8.1.1.1.m1.1.1a" xref="S5.T1.44.44.44.8.1.1.1.m1.1.1.cmml">−</mo><mn id="S5.T1.44.44.44.8.1.1.1.m1.1.1.2" xref="S5.T1.44.44.44.8.1.1.1.m1.1.1.2.cmml">11.36</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.44.44.44.8.1.1.1.m1.1b"><apply id="S5.T1.44.44.44.8.1.1.1.m1.1.1.cmml" xref="S5.T1.44.44.44.8.1.1.1.m1.1.1"><minus id="S5.T1.44.44.44.8.1.1.1.m1.1.1.1.cmml" xref="S5.T1.44.44.44.8.1.1.1.m1.1.1"></minus><cn id="S5.T1.44.44.44.8.1.1.1.m1.1.1.2.cmml" type="float" xref="S5.T1.44.44.44.8.1.1.1.m1.1.1.2">11.36</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.44.44.44.8.1.1.1.m1.1c">-11.36</annotation><annotation encoding="application/x-llamapun" id="S5.T1.44.44.44.8.1.1.1.m1.1d">- 11.36</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T1.45.45.45.9.2.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T1.45.45.45.9.2.2.1"><math alttext="-0.03" class="ltx_Math" display="inline" id="S5.T1.45.45.45.9.2.2.1.m1.1"><semantics id="S5.T1.45.45.45.9.2.2.1.m1.1a"><mrow id="S5.T1.45.45.45.9.2.2.1.m1.1.1" xref="S5.T1.45.45.45.9.2.2.1.m1.1.1.cmml"><mo id="S5.T1.45.45.45.9.2.2.1.m1.1.1a" xref="S5.T1.45.45.45.9.2.2.1.m1.1.1.cmml">−</mo><mn id="S5.T1.45.45.45.9.2.2.1.m1.1.1.2" xref="S5.T1.45.45.45.9.2.2.1.m1.1.1.2.cmml">0.03</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.45.45.45.9.2.2.1.m1.1b"><apply id="S5.T1.45.45.45.9.2.2.1.m1.1.1.cmml" xref="S5.T1.45.45.45.9.2.2.1.m1.1.1"><minus id="S5.T1.45.45.45.9.2.2.1.m1.1.1.1.cmml" xref="S5.T1.45.45.45.9.2.2.1.m1.1.1"></minus><cn id="S5.T1.45.45.45.9.2.2.1.m1.1.1.2.cmml" type="float" xref="S5.T1.45.45.45.9.2.2.1.m1.1.1.2">0.03</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.45.45.45.9.2.2.1.m1.1c">-0.03</annotation><annotation encoding="application/x-llamapun" id="S5.T1.45.45.45.9.2.2.1.m1.1d">- 0.03</annotation></semantics></math></td>
</tr>
</tbody></table>
</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T1.47.47.47.11">
<table class="ltx_tabular ltx_align_middle" id="S5.T1.47.47.47.11.2">
<tbody><tr class="ltx_tr" id="S5.T1.46.46.46.10.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T1.46.46.46.10.1.1.1" style="padding-bottom:-5.16663pt;"><math alttext="-10.22" class="ltx_Math" display="inline" id="S5.T1.46.46.46.10.1.1.1.m1.1"><semantics id="S5.T1.46.46.46.10.1.1.1.m1.1a"><mrow id="S5.T1.46.46.46.10.1.1.1.m1.1.1" xref="S5.T1.46.46.46.10.1.1.1.m1.1.1.cmml"><mo id="S5.T1.46.46.46.10.1.1.1.m1.1.1a" xref="S5.T1.46.46.46.10.1.1.1.m1.1.1.cmml">−</mo><mn id="S5.T1.46.46.46.10.1.1.1.m1.1.1.2" xref="S5.T1.46.46.46.10.1.1.1.m1.1.1.2.cmml">10.22</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.46.46.46.10.1.1.1.m1.1b"><apply id="S5.T1.46.46.46.10.1.1.1.m1.1.1.cmml" xref="S5.T1.46.46.46.10.1.1.1.m1.1.1"><minus id="S5.T1.46.46.46.10.1.1.1.m1.1.1.1.cmml" xref="S5.T1.46.46.46.10.1.1.1.m1.1.1"></minus><cn id="S5.T1.46.46.46.10.1.1.1.m1.1.1.2.cmml" type="float" xref="S5.T1.46.46.46.10.1.1.1.m1.1.1.2">10.22</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.46.46.46.10.1.1.1.m1.1c">-10.22</annotation><annotation encoding="application/x-llamapun" id="S5.T1.46.46.46.10.1.1.1.m1.1d">- 10.22</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T1.47.47.47.11.2.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T1.47.47.47.11.2.2.1"><math alttext="-0.03" class="ltx_Math" display="inline" id="S5.T1.47.47.47.11.2.2.1.m1.1"><semantics id="S5.T1.47.47.47.11.2.2.1.m1.1a"><mrow id="S5.T1.47.47.47.11.2.2.1.m1.1.1" xref="S5.T1.47.47.47.11.2.2.1.m1.1.1.cmml"><mo id="S5.T1.47.47.47.11.2.2.1.m1.1.1a" xref="S5.T1.47.47.47.11.2.2.1.m1.1.1.cmml">−</mo><mn id="S5.T1.47.47.47.11.2.2.1.m1.1.1.2" xref="S5.T1.47.47.47.11.2.2.1.m1.1.1.2.cmml">0.03</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.47.47.47.11.2.2.1.m1.1b"><apply id="S5.T1.47.47.47.11.2.2.1.m1.1.1.cmml" xref="S5.T1.47.47.47.11.2.2.1.m1.1.1"><minus id="S5.T1.47.47.47.11.2.2.1.m1.1.1.1.cmml" xref="S5.T1.47.47.47.11.2.2.1.m1.1.1"></minus><cn id="S5.T1.47.47.47.11.2.2.1.m1.1.1.2.cmml" type="float" xref="S5.T1.47.47.47.11.2.2.1.m1.1.1.2">0.03</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.47.47.47.11.2.2.1.m1.1c">-0.03</annotation><annotation encoding="application/x-llamapun" id="S5.T1.47.47.47.11.2.2.1.m1.1d">- 0.03</annotation></semantics></math></td>
</tr>
</tbody></table>
</td>
</tr>
<tr class="ltx_tr" id="S5.T1.51.51.56.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="6" id="S5.T1.51.51.56.5.1"><span class="ltx_text ltx_font_italic" id="S5.T1.51.51.56.5.1.1">Reference Value</span></th>
</tr>
<tr class="ltx_tr" id="S5.T1.49.49.49">
<th class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_row" id="S5.T1.49.49.49.3">6</th>
<th class="ltx_td ltx_nopad_l ltx_align_center ltx_th ltx_th_row" id="S5.T1.49.49.49.4"><span class="ltx_text ltx_font_bold" id="S5.T1.49.49.49.4.1">Zero-shot</span></th>
<td class="ltx_td ltx_align_center" colspan="4" id="S5.T1.49.49.49.2">
<math alttext="-17.90" class="ltx_Math" display="inline" id="S5.T1.48.48.48.1.m1.1"><semantics id="S5.T1.48.48.48.1.m1.1a"><mrow id="S5.T1.48.48.48.1.m1.1.1" xref="S5.T1.48.48.48.1.m1.1.1.cmml"><mo id="S5.T1.48.48.48.1.m1.1.1a" xref="S5.T1.48.48.48.1.m1.1.1.cmml">−</mo><mn id="S5.T1.48.48.48.1.m1.1.1.2" xref="S5.T1.48.48.48.1.m1.1.1.2.cmml">17.90</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.48.48.48.1.m1.1b"><apply id="S5.T1.48.48.48.1.m1.1.1.cmml" xref="S5.T1.48.48.48.1.m1.1.1"><minus id="S5.T1.48.48.48.1.m1.1.1.1.cmml" xref="S5.T1.48.48.48.1.m1.1.1"></minus><cn id="S5.T1.48.48.48.1.m1.1.1.2.cmml" type="float" xref="S5.T1.48.48.48.1.m1.1.1.2">17.90</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.48.48.48.1.m1.1c">-17.90</annotation><annotation encoding="application/x-llamapun" id="S5.T1.48.48.48.1.m1.1d">- 17.90</annotation></semantics></math> (Acc. <math alttext="50.65" class="ltx_Math" display="inline" id="S5.T1.49.49.49.2.m2.1"><semantics id="S5.T1.49.49.49.2.m2.1a"><mn id="S5.T1.49.49.49.2.m2.1.1" xref="S5.T1.49.49.49.2.m2.1.1.cmml">50.65</mn><annotation-xml encoding="MathML-Content" id="S5.T1.49.49.49.2.m2.1b"><cn id="S5.T1.49.49.49.2.m2.1.1.cmml" type="float" xref="S5.T1.49.49.49.2.m2.1.1">50.65</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.49.49.49.2.m2.1c">50.65</annotation><annotation encoding="application/x-llamapun" id="S5.T1.49.49.49.2.m2.1d">50.65</annotation></semantics></math>)</td>
</tr>
<tr class="ltx_tr" id="S5.T1.51.51.51">
<th class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="S5.T1.51.51.51.3">7</th>
<th class="ltx_td ltx_nopad_l ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="S5.T1.51.51.51.4"><span class="ltx_text ltx_font_bold" id="S5.T1.51.51.51.4.1">Random Prediction</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb" colspan="4" id="S5.T1.51.51.51.2">
<math alttext="-36.05" class="ltx_Math" display="inline" id="S5.T1.50.50.50.1.m1.1"><semantics id="S5.T1.50.50.50.1.m1.1a"><mrow id="S5.T1.50.50.50.1.m1.1.1" xref="S5.T1.50.50.50.1.m1.1.1.cmml"><mo id="S5.T1.50.50.50.1.m1.1.1a" xref="S5.T1.50.50.50.1.m1.1.1.cmml">−</mo><mn id="S5.T1.50.50.50.1.m1.1.1.2" xref="S5.T1.50.50.50.1.m1.1.1.2.cmml">36.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.50.50.50.1.m1.1b"><apply id="S5.T1.50.50.50.1.m1.1.1.cmml" xref="S5.T1.50.50.50.1.m1.1.1"><minus id="S5.T1.50.50.50.1.m1.1.1.1.cmml" xref="S5.T1.50.50.50.1.m1.1.1"></minus><cn id="S5.T1.50.50.50.1.m1.1.1.2.cmml" type="float" xref="S5.T1.50.50.50.1.m1.1.1.2">36.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.50.50.50.1.m1.1c">-36.05</annotation><annotation encoding="application/x-llamapun" id="S5.T1.50.50.50.1.m1.1d">- 36.05</annotation></semantics></math> (Acc. <math alttext="32.50" class="ltx_Math" display="inline" id="S5.T1.51.51.51.2.m2.1"><semantics id="S5.T1.51.51.51.2.m2.1a"><mn id="S5.T1.51.51.51.2.m2.1.1" xref="S5.T1.51.51.51.2.m2.1.1.cmml">32.50</mn><annotation-xml encoding="MathML-Content" id="S5.T1.51.51.51.2.m2.1b"><cn id="S5.T1.51.51.51.2.m2.1.1.cmml" type="float" xref="S5.T1.51.51.51.2.m2.1.1">32.50</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.51.51.51.2.m2.1c">32.50</annotation><annotation encoding="application/x-llamapun" id="S5.T1.51.51.51.2.m2.1d">32.50</annotation></semantics></math>)</td>
</tr>
</tbody>
</table>
</span></div>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.1">To demonstrate that our 3-phase circuit dominates or at least participates in ICL process, we disconnect the related attention connection of each step in the proposed circuit, and test the accuracies without such connections as shown in Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S5.T1" title="Table 1 ‣ 5.1 Ablation Analysis ‣ 5 Putting Things Together ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">1</span></a>. The results show that when the non-trivial connections designated by the proposed circuit are ablated, accuracies of ICL significantly decrease, supporting the existence of our circuit. However, the result doesn’t fully match expectations, for example, the result without induction (line 5) should be consistent with zero-shot (line 6), since all the expected communication from demonstration to query is intercepted, but that’s not the case; and the contribution of Step 1 in later layers are unexpectedly high, indicating the existence of some bypass mechanisms parallelly contributing to ICL accuracies.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Bypass Mechanism</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1">Motivated by the ablation results, we believe that several mechanisms including our circuit run parallelly for ICL, since the residual connection supports complex paths among layers and attention heads. We list some possible bypasses and plan a complete enumeration as future work.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure ltx_align_floatright" id="S5.F8"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="168" id="S5.F8.g1" src="https://arxiv.org/html/2410.04468v1/x15.png" width="380">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Dynamics and deserialization of magnitudes of proposed 3 inference steps (cartography details: Appendix&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A1.SS6" title="A.6 Cartography Details of Fig. 8 ‣ Appendix A Experiment Details and Settings ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">A.6</span></a>).</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S5.SS2.p2">
<p class="ltx_p" id="S5.SS2.p2.1"><span class="ltx_text ltx_font_bold" id="S5.SS2.p2.1.1">Parallel Circuits.</span> Multiple 3-step circuits can execute in parallel, that is, one layer can assign multiple inference functions to different heads, causing dispersion and deserialization as shown in Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S5.F8" title="Figure 8 ‣ 5.2 Bypass Mechanism ‣ 5 Putting Things Together ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">8</span></a>, where a narrow (fewer heads) and deep (more layers) model is more likely to generate localized inference, and vice versa.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS2.p3">
<p class="ltx_p" id="S5.SS2.p3.1"><span class="ltx_text ltx_font_bold" id="S5.SS2.p3.1.1">Direct Decoding.</span> Residual connection to output embedding allows intermediate hidden states to be decoded directly. Intuitively, a shortcut from Step 1 encodings to the LM head enables ICL with zero-shot capacities, since we have confirmed that encoded representations are informative for ICL tasks, while the decoding methods should be selected carefully&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Cho et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib9" title="">2024</a>)</cite> (e.g. with essential calibration). On the other hand, shortcuts from insufficiently encoded features may lead to meaningless information decoded by language model heads, causing prediction bias, i.e., even if no query is given, ICL still returns unbalanced results&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Zhao et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib47" title="">2021</a>)</cite> decoded from tokens of prompt template (see Appendix&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A4" title="Appendix D Measurement on Direct Decoding ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">D</span></a>).</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table ltx_align_floatright" id="S5.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Accuracy drop with shortcut ablated.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S5.T2.11" style="width:198.7pt;height:36.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-64.1pt,11.6pt) scale(0.608062550463594,0.608062550463594) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T2.11.11">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T2.11.11.12.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S5.T2.11.11.12.1.1"><span class="ltx_text ltx_font_bold" id="S5.T2.11.11.12.1.1.1">Attention Disconnected</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T2.11.11.12.1.2">25%</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T2.11.11.12.1.3">50%</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T2.11.11.12.1.4">75%</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T2.11.11.12.1.5">100%</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T2.11.11.11">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="S5.T2.3.3.3.3"><span class="ltx_text ltx_font_bold" id="S5.T2.3.3.3.3.3">Forerunner <math alttext="s_{1:i}" class="ltx_Math" display="inline" id="S5.T2.1.1.1.1.1.m1.1"><semantics id="S5.T2.1.1.1.1.1.m1.1a"><msub id="S5.T2.1.1.1.1.1.m1.1.1" xref="S5.T2.1.1.1.1.1.m1.1.1.cmml"><mi id="S5.T2.1.1.1.1.1.m1.1.1.2" xref="S5.T2.1.1.1.1.1.m1.1.1.2.cmml">s</mi><mrow id="S5.T2.1.1.1.1.1.m1.1.1.3" xref="S5.T2.1.1.1.1.1.m1.1.1.3.cmml"><mn id="S5.T2.1.1.1.1.1.m1.1.1.3.2" xref="S5.T2.1.1.1.1.1.m1.1.1.3.2.cmml">1</mn><mo id="S5.T2.1.1.1.1.1.m1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S5.T2.1.1.1.1.1.m1.1.1.3.1.cmml">:</mo><mi id="S5.T2.1.1.1.1.1.m1.1.1.3.3" xref="S5.T2.1.1.1.1.1.m1.1.1.3.3.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T2.1.1.1.1.1.m1.1b"><apply id="S5.T2.1.1.1.1.1.m1.1.1.cmml" xref="S5.T2.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.1.1.1.1.1.m1.1.1.1.cmml" xref="S5.T2.1.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S5.T2.1.1.1.1.1.m1.1.1.2.cmml" xref="S5.T2.1.1.1.1.1.m1.1.1.2">𝑠</ci><apply id="S5.T2.1.1.1.1.1.m1.1.1.3.cmml" xref="S5.T2.1.1.1.1.1.m1.1.1.3"><ci id="S5.T2.1.1.1.1.1.m1.1.1.3.1.cmml" xref="S5.T2.1.1.1.1.1.m1.1.1.3.1">:</ci><cn id="S5.T2.1.1.1.1.1.m1.1.1.3.2.cmml" type="integer" xref="S5.T2.1.1.1.1.1.m1.1.1.3.2">1</cn><ci id="S5.T2.1.1.1.1.1.m1.1.1.3.3.cmml" xref="S5.T2.1.1.1.1.1.m1.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.1.1.1.1.1.m1.1c">s_{1:i}</annotation><annotation encoding="application/x-llamapun" id="S5.T2.1.1.1.1.1.m1.1d">italic_s start_POSTSUBSCRIPT 1 : italic_i end_POSTSUBSCRIPT</annotation></semantics></math> <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S5.T2.2.2.2.2.2.m2.1"><semantics id="S5.T2.2.2.2.2.2.m2.1a"><mo id="S5.T2.2.2.2.2.2.m2.1.1" stretchy="false" xref="S5.T2.2.2.2.2.2.m2.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S5.T2.2.2.2.2.2.m2.1b"><ci id="S5.T2.2.2.2.2.2.m2.1.1.cmml" xref="S5.T2.2.2.2.2.2.m2.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.2.2.2.2.2.m2.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T2.2.2.2.2.2.m2.1d">→</annotation></semantics></math> Forerunner <math alttext="s_{i:q}" class="ltx_Math" display="inline" id="S5.T2.3.3.3.3.3.m3.1"><semantics id="S5.T2.3.3.3.3.3.m3.1a"><msub id="S5.T2.3.3.3.3.3.m3.1.1" xref="S5.T2.3.3.3.3.3.m3.1.1.cmml"><mi id="S5.T2.3.3.3.3.3.m3.1.1.2" xref="S5.T2.3.3.3.3.3.m3.1.1.2.cmml">s</mi><mrow id="S5.T2.3.3.3.3.3.m3.1.1.3" xref="S5.T2.3.3.3.3.3.m3.1.1.3.cmml"><mi id="S5.T2.3.3.3.3.3.m3.1.1.3.2" xref="S5.T2.3.3.3.3.3.m3.1.1.3.2.cmml">i</mi><mo id="S5.T2.3.3.3.3.3.m3.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S5.T2.3.3.3.3.3.m3.1.1.3.1.cmml">:</mo><mi id="S5.T2.3.3.3.3.3.m3.1.1.3.3" xref="S5.T2.3.3.3.3.3.m3.1.1.3.3.cmml">q</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T2.3.3.3.3.3.m3.1b"><apply id="S5.T2.3.3.3.3.3.m3.1.1.cmml" xref="S5.T2.3.3.3.3.3.m3.1.1"><csymbol cd="ambiguous" id="S5.T2.3.3.3.3.3.m3.1.1.1.cmml" xref="S5.T2.3.3.3.3.3.m3.1.1">subscript</csymbol><ci id="S5.T2.3.3.3.3.3.m3.1.1.2.cmml" xref="S5.T2.3.3.3.3.3.m3.1.1.2">𝑠</ci><apply id="S5.T2.3.3.3.3.3.m3.1.1.3.cmml" xref="S5.T2.3.3.3.3.3.m3.1.1.3"><ci id="S5.T2.3.3.3.3.3.m3.1.1.3.1.cmml" xref="S5.T2.3.3.3.3.3.m3.1.1.3.1">:</ci><ci id="S5.T2.3.3.3.3.3.m3.1.1.3.2.cmml" xref="S5.T2.3.3.3.3.3.m3.1.1.3.2">𝑖</ci><ci id="S5.T2.3.3.3.3.3.m3.1.1.3.3.cmml" xref="S5.T2.3.3.3.3.3.m3.1.1.3.3">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.3.3.3.3.3.m3.1c">s_{i:q}</annotation><annotation encoding="application/x-llamapun" id="S5.T2.3.3.3.3.3.m3.1d">italic_s start_POSTSUBSCRIPT italic_i : italic_q end_POSTSUBSCRIPT</annotation></semantics></math></span></th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T2.5.5.5.5">
<table class="ltx_tabular ltx_align_middle" id="S5.T2.5.5.5.5.2">
<tbody><tr class="ltx_tr" id="S5.T2.4.4.4.4.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T2.4.4.4.4.1.1.1" style="padding-bottom:-5.16663pt;"><math alttext="-1.30" class="ltx_Math" display="inline" id="S5.T2.4.4.4.4.1.1.1.m1.1"><semantics id="S5.T2.4.4.4.4.1.1.1.m1.1a"><mrow id="S5.T2.4.4.4.4.1.1.1.m1.1.1" xref="S5.T2.4.4.4.4.1.1.1.m1.1.1.cmml"><mo id="S5.T2.4.4.4.4.1.1.1.m1.1.1a" xref="S5.T2.4.4.4.4.1.1.1.m1.1.1.cmml">−</mo><mn id="S5.T2.4.4.4.4.1.1.1.m1.1.1.2" xref="S5.T2.4.4.4.4.1.1.1.m1.1.1.2.cmml">1.30</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.4.4.4.4.1.1.1.m1.1b"><apply id="S5.T2.4.4.4.4.1.1.1.m1.1.1.cmml" xref="S5.T2.4.4.4.4.1.1.1.m1.1.1"><minus id="S5.T2.4.4.4.4.1.1.1.m1.1.1.1.cmml" xref="S5.T2.4.4.4.4.1.1.1.m1.1.1"></minus><cn id="S5.T2.4.4.4.4.1.1.1.m1.1.1.2.cmml" type="float" xref="S5.T2.4.4.4.4.1.1.1.m1.1.1.2">1.30</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.4.4.4.4.1.1.1.m1.1c">-1.30</annotation><annotation encoding="application/x-llamapun" id="S5.T2.4.4.4.4.1.1.1.m1.1d">- 1.30</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T2.5.5.5.5.2.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T2.5.5.5.5.2.2.1"><math alttext="-0.00" class="ltx_Math" display="inline" id="S5.T2.5.5.5.5.2.2.1.m1.1"><semantics id="S5.T2.5.5.5.5.2.2.1.m1.1a"><mrow id="S5.T2.5.5.5.5.2.2.1.m1.1.1" xref="S5.T2.5.5.5.5.2.2.1.m1.1.1.cmml"><mo id="S5.T2.5.5.5.5.2.2.1.m1.1.1a" xref="S5.T2.5.5.5.5.2.2.1.m1.1.1.cmml">−</mo><mn id="S5.T2.5.5.5.5.2.2.1.m1.1.1.2" xref="S5.T2.5.5.5.5.2.2.1.m1.1.1.2.cmml">0.00</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.5.5.5.5.2.2.1.m1.1b"><apply id="S5.T2.5.5.5.5.2.2.1.m1.1.1.cmml" xref="S5.T2.5.5.5.5.2.2.1.m1.1.1"><minus id="S5.T2.5.5.5.5.2.2.1.m1.1.1.1.cmml" xref="S5.T2.5.5.5.5.2.2.1.m1.1.1"></minus><cn id="S5.T2.5.5.5.5.2.2.1.m1.1.1.2.cmml" type="float" xref="S5.T2.5.5.5.5.2.2.1.m1.1.1.2">0.00</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.5.5.5.5.2.2.1.m1.1c">-0.00</annotation><annotation encoding="application/x-llamapun" id="S5.T2.5.5.5.5.2.2.1.m1.1d">- 0.00</annotation></semantics></math></td>
</tr>
</tbody></table>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T2.7.7.7.7">
<table class="ltx_tabular ltx_align_middle" id="S5.T2.7.7.7.7.2">
<tbody><tr class="ltx_tr" id="S5.T2.6.6.6.6.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T2.6.6.6.6.1.1.1" style="padding-bottom:-5.16663pt;"><math alttext="-0.75" class="ltx_Math" display="inline" id="S5.T2.6.6.6.6.1.1.1.m1.1"><semantics id="S5.T2.6.6.6.6.1.1.1.m1.1a"><mrow id="S5.T2.6.6.6.6.1.1.1.m1.1.1" xref="S5.T2.6.6.6.6.1.1.1.m1.1.1.cmml"><mo id="S5.T2.6.6.6.6.1.1.1.m1.1.1a" xref="S5.T2.6.6.6.6.1.1.1.m1.1.1.cmml">−</mo><mn id="S5.T2.6.6.6.6.1.1.1.m1.1.1.2" xref="S5.T2.6.6.6.6.1.1.1.m1.1.1.2.cmml">0.75</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.6.6.6.6.1.1.1.m1.1b"><apply id="S5.T2.6.6.6.6.1.1.1.m1.1.1.cmml" xref="S5.T2.6.6.6.6.1.1.1.m1.1.1"><minus id="S5.T2.6.6.6.6.1.1.1.m1.1.1.1.cmml" xref="S5.T2.6.6.6.6.1.1.1.m1.1.1"></minus><cn id="S5.T2.6.6.6.6.1.1.1.m1.1.1.2.cmml" type="float" xref="S5.T2.6.6.6.6.1.1.1.m1.1.1.2">0.75</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.6.6.6.6.1.1.1.m1.1c">-0.75</annotation><annotation encoding="application/x-llamapun" id="S5.T2.6.6.6.6.1.1.1.m1.1d">- 0.75</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T2.7.7.7.7.2.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T2.7.7.7.7.2.2.1"><math alttext="-0.16" class="ltx_Math" display="inline" id="S5.T2.7.7.7.7.2.2.1.m1.1"><semantics id="S5.T2.7.7.7.7.2.2.1.m1.1a"><mrow id="S5.T2.7.7.7.7.2.2.1.m1.1.1" xref="S5.T2.7.7.7.7.2.2.1.m1.1.1.cmml"><mo id="S5.T2.7.7.7.7.2.2.1.m1.1.1a" xref="S5.T2.7.7.7.7.2.2.1.m1.1.1.cmml">−</mo><mn id="S5.T2.7.7.7.7.2.2.1.m1.1.1.2" xref="S5.T2.7.7.7.7.2.2.1.m1.1.1.2.cmml">0.16</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.7.7.7.7.2.2.1.m1.1b"><apply id="S5.T2.7.7.7.7.2.2.1.m1.1.1.cmml" xref="S5.T2.7.7.7.7.2.2.1.m1.1.1"><minus id="S5.T2.7.7.7.7.2.2.1.m1.1.1.1.cmml" xref="S5.T2.7.7.7.7.2.2.1.m1.1.1"></minus><cn id="S5.T2.7.7.7.7.2.2.1.m1.1.1.2.cmml" type="float" xref="S5.T2.7.7.7.7.2.2.1.m1.1.1.2">0.16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.7.7.7.7.2.2.1.m1.1c">-0.16</annotation><annotation encoding="application/x-llamapun" id="S5.T2.7.7.7.7.2.2.1.m1.1d">- 0.16</annotation></semantics></math></td>
</tr>
</tbody></table>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T2.9.9.9.9">
<table class="ltx_tabular ltx_align_middle" id="S5.T2.9.9.9.9.2">
<tbody><tr class="ltx_tr" id="S5.T2.8.8.8.8.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T2.8.8.8.8.1.1.1" style="padding-bottom:-5.16663pt;"><math alttext="-0.78" class="ltx_Math" display="inline" id="S5.T2.8.8.8.8.1.1.1.m1.1"><semantics id="S5.T2.8.8.8.8.1.1.1.m1.1a"><mrow id="S5.T2.8.8.8.8.1.1.1.m1.1.1" xref="S5.T2.8.8.8.8.1.1.1.m1.1.1.cmml"><mo id="S5.T2.8.8.8.8.1.1.1.m1.1.1a" xref="S5.T2.8.8.8.8.1.1.1.m1.1.1.cmml">−</mo><mn id="S5.T2.8.8.8.8.1.1.1.m1.1.1.2" xref="S5.T2.8.8.8.8.1.1.1.m1.1.1.2.cmml">0.78</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.8.8.8.8.1.1.1.m1.1b"><apply id="S5.T2.8.8.8.8.1.1.1.m1.1.1.cmml" xref="S5.T2.8.8.8.8.1.1.1.m1.1.1"><minus id="S5.T2.8.8.8.8.1.1.1.m1.1.1.1.cmml" xref="S5.T2.8.8.8.8.1.1.1.m1.1.1"></minus><cn id="S5.T2.8.8.8.8.1.1.1.m1.1.1.2.cmml" type="float" xref="S5.T2.8.8.8.8.1.1.1.m1.1.1.2">0.78</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.8.8.8.8.1.1.1.m1.1c">-0.78</annotation><annotation encoding="application/x-llamapun" id="S5.T2.8.8.8.8.1.1.1.m1.1d">- 0.78</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T2.9.9.9.9.2.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T2.9.9.9.9.2.2.1"><math alttext="-0.16" class="ltx_Math" display="inline" id="S5.T2.9.9.9.9.2.2.1.m1.1"><semantics id="S5.T2.9.9.9.9.2.2.1.m1.1a"><mrow id="S5.T2.9.9.9.9.2.2.1.m1.1.1" xref="S5.T2.9.9.9.9.2.2.1.m1.1.1.cmml"><mo id="S5.T2.9.9.9.9.2.2.1.m1.1.1a" xref="S5.T2.9.9.9.9.2.2.1.m1.1.1.cmml">−</mo><mn id="S5.T2.9.9.9.9.2.2.1.m1.1.1.2" xref="S5.T2.9.9.9.9.2.2.1.m1.1.1.2.cmml">0.16</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.9.9.9.9.2.2.1.m1.1b"><apply id="S5.T2.9.9.9.9.2.2.1.m1.1.1.cmml" xref="S5.T2.9.9.9.9.2.2.1.m1.1.1"><minus id="S5.T2.9.9.9.9.2.2.1.m1.1.1.1.cmml" xref="S5.T2.9.9.9.9.2.2.1.m1.1.1"></minus><cn id="S5.T2.9.9.9.9.2.2.1.m1.1.1.2.cmml" type="float" xref="S5.T2.9.9.9.9.2.2.1.m1.1.1.2">0.16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.9.9.9.9.2.2.1.m1.1c">-0.16</annotation><annotation encoding="application/x-llamapun" id="S5.T2.9.9.9.9.2.2.1.m1.1d">- 0.16</annotation></semantics></math></td>
</tr>
</tbody></table>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T2.11.11.11.11">
<table class="ltx_tabular ltx_align_middle" id="S5.T2.11.11.11.11.2">
<tbody><tr class="ltx_tr" id="S5.T2.10.10.10.10.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T2.10.10.10.10.1.1.1" style="padding-bottom:-5.16663pt;"><math alttext="-1.56" class="ltx_Math" display="inline" id="S5.T2.10.10.10.10.1.1.1.m1.1"><semantics id="S5.T2.10.10.10.10.1.1.1.m1.1a"><mrow id="S5.T2.10.10.10.10.1.1.1.m1.1.1" xref="S5.T2.10.10.10.10.1.1.1.m1.1.1.cmml"><mo id="S5.T2.10.10.10.10.1.1.1.m1.1.1a" xref="S5.T2.10.10.10.10.1.1.1.m1.1.1.cmml">−</mo><mn id="S5.T2.10.10.10.10.1.1.1.m1.1.1.2" xref="S5.T2.10.10.10.10.1.1.1.m1.1.1.2.cmml">1.56</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.10.10.10.10.1.1.1.m1.1b"><apply id="S5.T2.10.10.10.10.1.1.1.m1.1.1.cmml" xref="S5.T2.10.10.10.10.1.1.1.m1.1.1"><minus id="S5.T2.10.10.10.10.1.1.1.m1.1.1.1.cmml" xref="S5.T2.10.10.10.10.1.1.1.m1.1.1"></minus><cn id="S5.T2.10.10.10.10.1.1.1.m1.1.1.2.cmml" type="float" xref="S5.T2.10.10.10.10.1.1.1.m1.1.1.2">1.56</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.10.10.10.10.1.1.1.m1.1c">-1.56</annotation><annotation encoding="application/x-llamapun" id="S5.T2.10.10.10.10.1.1.1.m1.1d">- 1.56</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T2.11.11.11.11.2.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T2.11.11.11.11.2.2.1"><math alttext="-0.71" class="ltx_Math" display="inline" id="S5.T2.11.11.11.11.2.2.1.m1.1"><semantics id="S5.T2.11.11.11.11.2.2.1.m1.1a"><mrow id="S5.T2.11.11.11.11.2.2.1.m1.1.1" xref="S5.T2.11.11.11.11.2.2.1.m1.1.1.cmml"><mo id="S5.T2.11.11.11.11.2.2.1.m1.1.1a" xref="S5.T2.11.11.11.11.2.2.1.m1.1.1.cmml">−</mo><mn id="S5.T2.11.11.11.11.2.2.1.m1.1.1.2" xref="S5.T2.11.11.11.11.2.2.1.m1.1.1.2.cmml">0.71</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.11.11.11.11.2.2.1.m1.1b"><apply id="S5.T2.11.11.11.11.2.2.1.m1.1.1.cmml" xref="S5.T2.11.11.11.11.2.2.1.m1.1.1"><minus id="S5.T2.11.11.11.11.2.2.1.m1.1.1.1.cmml" xref="S5.T2.11.11.11.11.2.2.1.m1.1.1"></minus><cn id="S5.T2.11.11.11.11.2.2.1.m1.1.1.2.cmml" type="float" xref="S5.T2.11.11.11.11.2.2.1.m1.1.1.2">0.71</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.11.11.11.11.2.2.1.m1.1c">-0.71</annotation><annotation encoding="application/x-llamapun" id="S5.T2.11.11.11.11.2.2.1.m1.1d">- 0.71</annotation></semantics></math></td>
</tr>
</tbody></table>
</td>
</tr>
</tbody>
</table>
</span></div>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S5.SS2.p4">
<p class="ltx_p" id="S5.SS2.p4.3"><span class="ltx_text ltx_font_bold" id="S5.SS2.p4.3.1">Shortcut Induction.</span> Note that a <math alttext="k" class="ltx_Math" display="inline" id="S5.SS2.p4.1.m1.1"><semantics id="S5.SS2.p4.1.m1.1a"><mi id="S5.SS2.p4.1.m1.1.1" xref="S5.SS2.p4.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p4.1.m1.1b"><ci id="S5.SS2.p4.1.m1.1.1.cmml" xref="S5.SS2.p4.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p4.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p4.1.m1.1d">italic_k</annotation></semantics></math>-shot ICL input sequence always contains a <math alttext="(k-1)" class="ltx_Math" display="inline" id="S5.SS2.p4.2.m2.1"><semantics id="S5.SS2.p4.2.m2.1a"><mrow id="S5.SS2.p4.2.m2.1.1.1" xref="S5.SS2.p4.2.m2.1.1.1.1.cmml"><mo id="S5.SS2.p4.2.m2.1.1.1.2" stretchy="false" xref="S5.SS2.p4.2.m2.1.1.1.1.cmml">(</mo><mrow id="S5.SS2.p4.2.m2.1.1.1.1" xref="S5.SS2.p4.2.m2.1.1.1.1.cmml"><mi id="S5.SS2.p4.2.m2.1.1.1.1.2" xref="S5.SS2.p4.2.m2.1.1.1.1.2.cmml">k</mi><mo id="S5.SS2.p4.2.m2.1.1.1.1.1" xref="S5.SS2.p4.2.m2.1.1.1.1.1.cmml">−</mo><mn id="S5.SS2.p4.2.m2.1.1.1.1.3" xref="S5.SS2.p4.2.m2.1.1.1.1.3.cmml">1</mn></mrow><mo id="S5.SS2.p4.2.m2.1.1.1.3" stretchy="false" xref="S5.SS2.p4.2.m2.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p4.2.m2.1b"><apply id="S5.SS2.p4.2.m2.1.1.1.1.cmml" xref="S5.SS2.p4.2.m2.1.1.1"><minus id="S5.SS2.p4.2.m2.1.1.1.1.1.cmml" xref="S5.SS2.p4.2.m2.1.1.1.1.1"></minus><ci id="S5.SS2.p4.2.m2.1.1.1.1.2.cmml" xref="S5.SS2.p4.2.m2.1.1.1.1.2">𝑘</ci><cn id="S5.SS2.p4.2.m2.1.1.1.1.3.cmml" type="integer" xref="S5.SS2.p4.2.m2.1.1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p4.2.m2.1c">(k-1)</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p4.2.m2.1d">( italic_k - 1 )</annotation></semantics></math>-shot sequence, where the <math alttext="k" class="ltx_Math" display="inline" id="S5.SS2.p4.3.m3.1"><semantics id="S5.SS2.p4.3.m3.1a"><mi id="S5.SS2.p4.3.m3.1.1" xref="S5.SS2.p4.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p4.3.m3.1b"><ci id="S5.SS2.p4.3.m3.1.1.cmml" xref="S5.SS2.p4.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p4.3.m3.1c">k</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p4.3.m3.1d">italic_k</annotation></semantics></math>-th forerunner (once served as the query) is previously processed. So every forerunner can directly retrieve previously processed forerunners of demonstrations to copy their induction results directly. The non-trivial result (Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S5.T2" title="Table 2 ‣ 5.2 Bypass Mechanism ‣ 5 Putting Things Together ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>) with all forerunners disconnected from each other confirms such infer.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Explaination towards Observed ICL Phenomena</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.1"><span class="ltx_text ltx_font_bold" id="S5.SS3.p1.1.1">Difficulty-based Demonstration Selection.</span> In&nbsp;§<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S3.SS1" title="3.1 LLMs Summarize Input Text on Forerunner Tokens in Hidden States ‣ 3 Step 1, Summarize: Linear Representations in Hidden States ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">3.1</span></a>, we find that in the zero-shot scenario, perplexed texts are harder to be encoded, which explains the observation of PPL-ICL&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Gonen et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib13" title="">2023</a>)</cite> selecting demonstrations with lower perplexity. Moreover, while the demonstrations increase, LMs can encode more complex inputs with diverse information to update the attention assignment shown in Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S4.F7" title="Figure 7 ‣ 4.2 Step 3, Induction Head: Feature Retrieval on Task Subspace ‣ 4 Induction Circuits in Natural Language Models ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">7</span></a>, making it beneficial to input harder demonstrations later, which explains the ICCL&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Liu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib26" title="">2024</a>)</cite>, which build demonstrations sequence from easy to hard.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS3.p2">
<p class="ltx_p" id="S5.SS3.p2.1"><span class="ltx_text ltx_font_bold" id="S5.SS3.p2.1.1">Prediction Bias.</span> (1) Contextual Bias: As shown in&nbsp;§<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S5.SS2" title="5.2 Bypass Mechanism ‣ 5 Putting Things Together ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">5.2</span></a> and Appendix&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A4" title="Appendix D Measurement on Direct Decoding ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">D</span></a>, direct decoding insufficiently encoded information adds meanless logits into LM’s output, causing a background prediction value even if no queries are given (named <span class="ltx_text ltx_font_italic" id="S5.SS3.p2.1.2">bias</span>). (2) Position Bias: As shown in&nbsp;§<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S3.SS2" title="3.2 Text Summarization is Linear and Task-Relevant but Position-biased ‣ 3 Step 1, Summarize: Linear Representations in Hidden States ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">3.2</span></a>, closer input texts are encoded more similarly, so label tokens near the query have more similar information to the query, causing more attention assignment in the induction processing, so that more influences on the prediction. (3) Frequency Bias: As shown in&nbsp;§<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S4.SS2" title="4.2 Step 3, Induction Head: Feature Retrieval on Task Subspace ‣ 4 Induction Circuits in Natural Language Models ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">4.2</span></a>, in the induction, some attention heads are without selectivity towards labels, causing an averaged induction from label tokens to the query, triggering a prediction bias towards the label frequency in the demonstration, even if their contribution (absolute value of attention score on label tokens) is small. All three biases are observed by&nbsp;<cite class="ltx_cite ltx_citemacro_cite">Zhao et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib47" title="">2021</a>)</cite>, and can be removed by ICL calibration methods.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS3.p3">
<p class="ltx_p" id="S5.SS3.p3.1"><span class="ltx_text ltx_font_bold" id="S5.SS3.p3.1.1">The Roles and Saturates of Demonstrations.</span> It is well known that demonstrations improve the performance of ICL. We decompose such performance improvement into 2 parts: (1) demonstrations help early layers encode better (§<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S3.SS1" title="3.1 LLMs Summarize Input Text on Forerunner Tokens in Hidden States ‣ 3 Step 1, Summarize: Linear Representations in Hidden States ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">3.1</span></a>), and (2) more demonstrations provide larger label token closure, enabling more accurate attention assignment (§<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S4.SS2" title="4.2 Step 3, Induction Head: Feature Retrieval on Task Subspace ‣ 4 Induction Circuits in Natural Language Models ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">4.2</span></a>), while the volume of such closure is submodular to demonstrations, causing the saturates of ICL performance towards demonstrations.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS3.p4">
<p class="ltx_p" id="S5.SS3.p4.1"><span class="ltx_text ltx_font_bold" id="S5.SS3.p4.1.1">The Effect of Wrong Label.</span> It is well-known that the label noise is less harmful in ICL&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Min et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib29" title="">2022</a>)</cite> than in gradient-based learning&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Zhang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib43" title="">2021</a>)</cite>. We have explained in&nbsp;§<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S4.SS1" title="4.1 Step 2, Forerunner Token Head: Copy from Text Feature to Label Token ‣ 4 Induction Circuits in Natural Language Models ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">4.1</span></a> that ICL implies labels denoise to stabilize ICL against label noise, while weakened by dimensionality.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion and Discussion</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S6.p1">
<p class="ltx_p" id="S6.p1.1"><span class="ltx_text ltx_font_bold" id="S6.p1.1.1">Conclusion.</span> In summary, this paper restores ICL inference into 3 basic operations and confirms their existence. Careful measurements are conducted to capture and explain various phenomena successfully. Moreover, ablation studies show the proposed inference circuit dominates and reveals the existence of bypass mechanisms. We hope this paper can bring new insight into ICL practice.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table ltx_align_floatright" id="S6.T3">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Performance of full and layer-pruned ICL inference.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S6.T3.4" style="width:159.0pt;height:61.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-37.1pt,14.3pt) scale(0.68179713002766,0.68179713002766) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S6.T3.4.4">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S6.T3.4.4.5.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T3.4.4.5.1.1"><span class="ltx_text ltx_font_bold" id="S6.T3.4.4.5.1.1.1">Inference</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T3.4.4.5.1.2"><span class="ltx_text ltx_font_bold" id="S6.T3.4.4.5.1.2.1">Acc.</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T3.4.4.5.1.3"><span class="ltx_text ltx_font_bold" id="S6.T3.4.4.5.1.3.1">Para.#</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T3.4.4.5.1.4"><span class="ltx_text ltx_font_bold" id="S6.T3.4.4.5.1.4.1">Speed</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T3.1.1.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.1.1.1.2">Full + LM Head</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.1.1.1.3">66.19%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.1.1.1.4">70.6B</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.1.1.1.1">1<math alttext="\times" class="ltx_Math" display="inline" id="S6.T3.1.1.1.1.m1.1"><semantics id="S6.T3.1.1.1.1.m1.1a"><mo id="S6.T3.1.1.1.1.m1.1.1" xref="S6.T3.1.1.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S6.T3.1.1.1.1.m1.1b"><times id="S6.T3.1.1.1.1.m1.1.1.cmml" xref="S6.T3.1.1.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S6.T3.1.1.1.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S6.T3.1.1.1.1.m1.1d">×</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S6.T3.2.2.2">
<td class="ltx_td ltx_align_center" id="S6.T3.2.2.2.2">Full + Cent.</td>
<td class="ltx_td ltx_align_center" id="S6.T3.2.2.2.3">83.24%</td>
<td class="ltx_td ltx_align_center" id="S6.T3.2.2.2.4">69.5B</td>
<td class="ltx_td ltx_align_center" id="S6.T3.2.2.2.1">1.00<math alttext="\times" class="ltx_Math" display="inline" id="S6.T3.2.2.2.1.m1.1"><semantics id="S6.T3.2.2.2.1.m1.1a"><mo id="S6.T3.2.2.2.1.m1.1.1" xref="S6.T3.2.2.2.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S6.T3.2.2.2.1.m1.1b"><times id="S6.T3.2.2.2.1.m1.1.1.cmml" xref="S6.T3.2.2.2.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S6.T3.2.2.2.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S6.T3.2.2.2.1.m1.1d">×</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S6.T3.3.3.3">
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.3.3.3.2">Layer34 + LM Head</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.3.3.3.3">49.29%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.3.3.3.4">32.7B</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.3.3.3.1">2.16<math alttext="\times" class="ltx_Math" display="inline" id="S6.T3.3.3.3.1.m1.1"><semantics id="S6.T3.3.3.3.1.m1.1a"><mo id="S6.T3.3.3.3.1.m1.1.1" xref="S6.T3.3.3.3.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S6.T3.3.3.3.1.m1.1b"><times id="S6.T3.3.3.3.1.m1.1.1.cmml" xref="S6.T3.3.3.3.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S6.T3.3.3.3.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S6.T3.3.3.3.1.m1.1d">×</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S6.T3.4.4.4">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T3.4.4.4.2">Layer34 + Cent.</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T3.4.4.4.3"><span class="ltx_text ltx_font_bold" id="S6.T3.4.4.4.3.1">84.27%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T3.4.4.4.4"><span class="ltx_text ltx_font_bold" id="S6.T3.4.4.4.4.1">31.2B</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T3.4.4.4.1"><span class="ltx_text ltx_font_bold" id="S6.T3.4.4.4.1.1">2.38<math alttext="\times" class="ltx_Math" display="inline" id="S6.T3.4.4.4.1.1.m1.1"><semantics id="S6.T3.4.4.4.1.1.m1.1a"><mo id="S6.T3.4.4.4.1.1.m1.1.1" xref="S6.T3.4.4.4.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S6.T3.4.4.4.1.1.m1.1b"><times id="S6.T3.4.4.4.1.1.m1.1.1.cmml" xref="S6.T3.4.4.4.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S6.T3.4.4.4.1.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S6.T3.4.4.4.1.1.m1.1d">×</annotation></semantics></math></span></td>
</tr>
</tbody>
</table>
</span></div>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S6.p2">
<p class="ltx_p" id="S6.p2.1"><span class="ltx_text ltx_font_bold" id="S6.p2.1.1">The Role of Early and Later Layers.</span> Our framework and Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S3.F3" title="Figure 3 ‣ 3.2 Text Summarization is Linear and Task-Relevant but Position-biased ‣ 3 Step 1, Summarize: Linear Representations in Hidden States ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">3</span></a> show: encoding result of Step 1 can be directly used for classification with reliable decoding, and later transformer layers are not contributing to centroid classification accuracies, leading to a taxonomy of <span class="ltx_text ltx_font_italic" id="S6.p2.1.2">Encoding</span> for Step 1 and <span class="ltx_text ltx_font_italic" id="S6.p2.1.3">Output Preparation</span> for Step 2 and 3. LMs complete multi-task classification implicitly in early layers, and verbalize it by merging task-specific label semantics in later layers. Therefore, we suggest removing some top layers and using a centroid classifier&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Cho et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib9" title="">2024</a>)</cite> to accelerate ICL inference as shown in Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S6.T3" title="Table 3 ‣ 6 Conclusion and Discussion ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">3</span></a> and Appendix&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A4" title="Appendix D Measurement on Direct Decoding ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">D</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S6.p3">
<p class="ltx_p" id="S6.p3.1"><span class="ltx_text ltx_font_bold" id="S6.p3.1.1">Pre-training Possibility from Natural Language Data.</span> A large gap can be considered between such a precise circuit and gradient descent pre-training on the wild data. However, we believe the wild training target contains the ICL circuit <span class="ltx_text ltx_font_italic" id="S6.p3.1.2">functionally</span>. Based on the previous works finding trainability of ICL on linear representation-label pairs&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Chan et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib6" title="">2022</a>; Reddy, <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib35" title="">2024</a>; Singh et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib37" title="">2024b</a>)</cite>, we speculate that in early training step, Transformers learn to extract linear representations shown in&nbsp;§<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S3" title="3 Step 1, Summarize: Linear Representations in Hidden States ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">3</span></a> from wild data (Appendix&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A2" title="Appendix B LM Pre-training Dynamics Measured by ICL Circuit ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">B</span></a>), serving as the training input of later layers to evoke the emergence of induction heads with the same mechanism shown in aforementioned previous works. Moreover, our conclusion of Step 3 highlights the input data requirements for the later layers: These data should activate the multiplex of hidden space, i.e., it should implicate multi-task classification with a wide distribution, which is consistent with the aforementioned previous works.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S6.p4">
<p class="ltx_p" id="S6.p4.1"><span class="ltx_text ltx_font_bold" id="S6.p4.1.1">Limitations.</span> (1) These 3 basic operations are not functionally indivisible. Ideally, one can reduce every operation in ICL inference to the interconnection of special attention heads to ulteriorly examine how the operating subspaces interact between steps. (2) Even though we have some insights into how pre-training promotes ICL in natural language models, its detailed dynamics are still unknown. One can start by decomposing pre-training targets into implicit tasks, and examine how these tasks can evoke the occurrence of the 3-step inference operations. (3) We only focus on classification tasks, while we believe that our findings can be applied to non-classification tasks, efforts are still needed to fill the gap.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Agarwal et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Rishabh Agarwal, Avi Singh, Lei&nbsp;M Zhang, Bernd Bohnet, Luis Rosias, Stephanie&nbsp;CY Chan, Biao Zhang, Aleksandra Faust, and Hugo Larochelle.

</span>
<span class="ltx_bibblock">Many-shot in-context learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">ICML 2024 Workshop on In-Context Learning</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">AI@Meta (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
AI@Meta.

</span>
<span class="ltx_bibblock">Llama 3 model card.

</span>
<span class="ltx_bibblock">2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/meta-llama/llama3/blob/main/MODEL_CARD.md" title="">https://github.com/meta-llama/llama3/blob/main/MODEL_CARD.md</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Almazrouei et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Ebtesam Almazrouei, Hamza Alobeidli, Abdulaziz Alshamsi, Alessandro Cappelli, Ruxandra Cojocaru, Merouane Debbah, Etienne Goffinet, Daniel Heslow, Julien Launay, Quentin Malartic, Badreddine Noune, Baptiste Pannier, and Guilherme Penedo.

</span>
<span class="ltx_bibblock">Falcon-40B: an open large language model with state-of-the-art performance.

</span>
<span class="ltx_bibblock">2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bertsch et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Amanda Bertsch, Maor Ivgi, Uri Alon, Jonathan Berant, Matthew&nbsp;R Gormley, and Graham Neubig.

</span>
<span class="ltx_bibblock">In-context learning with long-context models: An in-depth exploration.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">arXiv preprint arXiv:2405.00200</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Biderman et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Stella Biderman, Hailey Schoelkopf, Quentin&nbsp;Gregory Anthony, Herbie Bradley, Kyle O’Brien, Eric Hallahan, Mohammad&nbsp;Aflah Khan, Shivanshu Purohit, USVSN&nbsp;Sai Prashanth, Edward Raff, et&nbsp;al.

</span>
<span class="ltx_bibblock">Pythia: A suite for analyzing large language models across training and scaling.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">International Conference on Machine Learning</em>, pp.&nbsp; 2397–2430. PMLR, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chan et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Stephanie Chan, Adam Santoro, Andrew Lampinen, Jane Wang, Aaditya Singh, Pierre Richemond, James McClelland, and Felix Hill.

</span>
<span class="ltx_bibblock">Data distributional properties drive emergent in-context learning in transformers.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">Advances in Neural Information Processing Systems</em>, 35:18878–18891, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chang &amp; Jia (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Ting-Yun Chang and Robin Jia.

</span>
<span class="ltx_bibblock">Data curation alone can stabilize in-context learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">Proceedings of the 61st Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers)</em>, pp.&nbsp; 8123–8144, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jianlv Chen, Shitao Xiao, Peitian Zhang, Kun Luo, Defu Lian, and Zheng Liu.

</span>
<span class="ltx_bibblock">Bge m3-embedding: Multi-lingual, multi-functionality, multi-granularity text embeddings through self-knowledge distillation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">arXiv preprint arXiv:2402.03216</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cho et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Hakaze Cho, Yoshihiro Sakai, Mariko Kato, Kenshiro Tanaka, Akira Ishii, and Naoya Inoue.

</span>
<span class="ltx_bibblock">Token-based decision criteria are suboptimal in in-context learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">arXiv preprint arXiv:2406.16535</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dai et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Damai Dai, Yutao Sun, Li&nbsp;Dong, Yaru Hao, Shuming Ma, Zhifang Sui, and Furu Wei.

</span>
<span class="ltx_bibblock">Why can gpt learn in-context? language models implicitly perform gradient descent as meta-optimizers.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">ICLR 2023 Workshop on Mathematical and Empirical Understanding of Foundation Models</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dong et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Qingxiu Dong, Lei Li, Damai Dai, Ce&nbsp;Zheng, Zhiyong Wu, Baobao Chang, Xu&nbsp;Sun, Jingjing Xu, and Zhifang Sui.

</span>
<span class="ltx_bibblock">A survey on in-context learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">arXiv preprint arXiv:2301.00234</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Elhage et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Nelson Elhage, Neel Nanda, Catherine Olsson, Tom Henighan, Nicholas Joseph, Ben Mann, Amanda Askell, Yuntao Bai, Anna Chen, Tom Conerly, et&nbsp;al.

</span>
<span class="ltx_bibblock">A mathematical framework for transformer circuits.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">Transformer Circuits Thread</em>, 1(1):12, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gonen et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Hila Gonen, Srini Iyer, Terra Blevins, Noah&nbsp;A Smith, and Luke Zettlemoyer.

</span>
<span class="ltx_bibblock">Demystifying prompts in language models via perplexity estimation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">Findings of the Association for Computational Linguistics: EMNLP 2023</em>, pp.&nbsp; 10136–10148, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gu et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yuxian Gu, Li&nbsp;Dong, Furu Wei, and Minlie Huang.

</span>
<span class="ltx_bibblock">Pre-training to learn in context.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">Proceedings of the 61st Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers)</em>, pp.&nbsp; 4849–4870, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Qi&nbsp;Guo, Leiyu Wang, Yidong Wang, Wei Ye, and Shikun Zhang.

</span>
<span class="ltx_bibblock">What makes a good order of examples in in-context learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Findings of the Association for Computational Linguistics ACL 2024</em>, pp.&nbsp; 14892–14904, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Han et&nbsp;al. (2023a)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Chi Han, Ziqi Wang, Han Zhao, and Heng Ji.

</span>
<span class="ltx_bibblock">Explaining emergent in-context learning as kernel regression.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">arXiv preprint arXiv:2305.12766</em>, 2023a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Han et&nbsp;al. (2023b)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Xiaochuang Han, Daniel Simig, Todor Mihaylov, Yulia Tsvetkov, Asli Celikyilmaz, and Tianlu Wang.

</span>
<span class="ltx_bibblock">Understanding in-context learning via supportive pretraining data.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">Proceedings of the 61st Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers)</em>, pp.&nbsp; 12660–12673, 2023b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hovy et&nbsp;al. (2001)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Eduard Hovy, Laurie Gerber, Ulf Hermjakob, Chin-Yew Lin, and Deepak Ravichandran.

</span>
<span class="ltx_bibblock">Toward semantics-based answer pinpointing.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">Proceedings of the First International Conference on Human Language Technology Research</em>, 2001.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.aclweb.org/anthology/H01-1069" title="">https://www.aclweb.org/anthology/H01-1069</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huh et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Minyoung Huh, Brian Cheung, Tongzhou Wang, and Phillip Isola.

</span>
<span class="ltx_bibblock">The platonic representation hypothesis.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">arXiv preprint arXiv:2405.07987</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jeon et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Hong&nbsp;Jun Jeon, Jason&nbsp;D Lee, Qi&nbsp;Lei, and Benjamin Van&nbsp;Roy.

</span>
<span class="ltx_bibblock">An information-theoretic analysis of in-context learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">Forty-first International Conference on Machine Learning</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Klabunde et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Max Klabunde, Tobias Schumacher, Markus Strohmaier, and Florian Lemmerich.

</span>
<span class="ltx_bibblock">Similarity of neural network models: A survey of functional and representational measures.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">arXiv preprint arXiv:2305.06329</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kossen et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jannik Kossen, Yarin Gal, and Tom Rainforth.

</span>
<span class="ltx_bibblock">In-context learning learns label relationships but is not conventional learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">The Twelfth International Conference on Learning Representations</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li &amp; Qiu (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Xiaonan Li and Xipeng Qiu.

</span>
<span class="ltx_bibblock">Finding support examples for in-context learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">Findings of the Association for Computational Linguistics: EMNLP 2023</em>, pp.&nbsp; 6219–6235, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li &amp; Roth (2002)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Xin Li and Dan Roth.

</span>
<span class="ltx_bibblock">Learning question classifiers.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">COLING 2002: The 19th International Conference on Computational Linguistics</em>, 2002.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.aclweb.org/anthology/C02-1150" title="">https://www.aclweb.org/anthology/C02-1150</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jinlong Liu, Guoqing Jiang, Yunzhi Bai, Ting Chen, and Huayan Wang.

</span>
<span class="ltx_bibblock">Understanding why neural networks generalize well through gsnr of parameters.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">arXiv preprint arXiv:2001.07384</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yinpeng Liu, Jiawei Liu, Xiang Shi, Qikai Cheng, and Wei Lu.

</span>
<span class="ltx_bibblock">Let’s learn step by step: Enhancing in-context learning ability with curriculum learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">arXiv preprint arXiv:2402.10738</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lu et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yao Lu, Max Bartolo, Alastair Moore, Sebastian Riedel, and Pontus Stenetorp.

</span>
<span class="ltx_bibblock">Fantastically ordered prompts and where to find them: Overcoming few-shot prompt order sensitivity.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">Proceedings of the 60th Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers)</em>, pp.&nbsp; 8086–8098, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Malo et&nbsp;al. (2014)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
P.&nbsp;Malo, A.&nbsp;Sinha, P.&nbsp;Korhonen, J.&nbsp;Wallenius, and P.&nbsp;Takala.

</span>
<span class="ltx_bibblock">Good debt or bad debt: Detecting semantic orientations in economic texts.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">Journal of the Association for Information Science and Technology</em>, 65, 2014.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Min et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Sewon Min, Xinxi Lyu, Ari Holtzman, Mikel Artetxe, Mike Lewis, Hannaneh Hajishirzi, and Luke Zettlemoyer.

</span>
<span class="ltx_bibblock">Rethinking the role of demonstrations: What makes in-context learning work?

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">Proceedings of the 2022 Conference on Empirical Methods in Natural Language Processing</em>, pp.&nbsp; 11048–11064, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mohammad et&nbsp;al. (2018)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Saif Mohammad, Felipe Bravo-Marquez, Mohammad Salameh, and Svetlana Kiritchenko.

</span>
<span class="ltx_bibblock">Semeval-2018 task 1: Affect in tweets.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">Proceedings of the 12th international workshop on semantic evaluation</em>, pp.&nbsp; 1–17, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Olsson et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Catherine Olsson, Nelson Elhage, Neel Nanda, Nicholas Joseph, Nova DasSarma, Tom Henighan, Ben Mann, Amanda Askell, Yuntao Bai, Anna Chen, et&nbsp;al.

</span>
<span class="ltx_bibblock">In-context learning and induction heads.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">arXiv preprint arXiv:2209.11895</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pan (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jane Pan.

</span>
<span class="ltx_bibblock">What in-context learning “learns” in-context: Disentangling task recognition and task learning.

</span>
<span class="ltx_bibblock">Master’s thesis, Princeton University, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pang &amp; Lee (2005)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Bo&nbsp;Pang and Lillian Lee.

</span>
<span class="ltx_bibblock">Seeing stars: Exploiting class relationships for sentiment categorization with respect to rating scales.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">Proceedings of the 43rd Annual Meeting of the Association for Computational Linguistics (ACL’05)</em>, pp.&nbsp; 115–124, 2005.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Radford et&nbsp;al. (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Alec Radford, Jeffrey Wu, Rewon Child, David Luan, Dario Amodei, Ilya Sutskever, et&nbsp;al.

</span>
<span class="ltx_bibblock">Language models are unsupervised multitask learners.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">OpenAI blog</em>, 1(8):9, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Reddy (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Gautam Reddy.

</span>
<span class="ltx_bibblock">The mechanistic basis of data dependence and abrupt learning in an in-context classification task.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">The Twelfth International Conference on Learning Representations</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Singh et&nbsp;al. (2024a)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Aaditya Singh, Stephanie Chan, Ted Moskovitz, Erin Grant, Andrew Saxe, and Felix Hill.

</span>
<span class="ltx_bibblock">The transient nature of emergent in-context learning in transformers.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">Advances in Neural Information Processing Systems</em>, 36, 2024a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Singh et&nbsp;al. (2024b)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Aaditya&nbsp;K Singh, Ted Moskovitz, Felix Hill, Stephanie&nbsp;CY Chan, and Andrew&nbsp;M Saxe.

</span>
<span class="ltx_bibblock">What needs to go right for an induction head? a mechanistic study of in-context learning circuits and their formation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">arXiv preprint arXiv:2404.07129</em>, 2024b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Socher et&nbsp;al. (2013)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Richard Socher, Alex Perelygin, Jean Wu, Jason Chuang, Christopher&nbsp;D. Manning, Andrew Ng, and Christopher Potts.

</span>
<span class="ltx_bibblock">Recursive deep models for semantic compositionality over a sentiment treebank.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">Proceedings of the 2013 Conference on Empirical Methods in Natural Language Processing</em>, pp.&nbsp; 1631–1642, Seattle, Washington, USA, October 2013. Association for Computational Linguistics.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.aclweb.org/anthology/D13-1170" title="">https://www.aclweb.org/anthology/D13-1170</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Lean Wang, Lei Li, Damai Dai, Deli Chen, Hao Zhou, Fandong Meng, Jie Zhou, and Xu&nbsp;Sun.

</span>
<span class="ltx_bibblock">Label words are anchors: An information flow perspective for understanding in-context learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">Proceedings of the 2023 Conference on Empirical Methods in Natural Language Processing</em>, pp.&nbsp; 9840–9855, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wei et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jerry Wei, Jason Wei, Yi&nbsp;Tay, Dustin Tran, Albert Webson, Yifeng Lu, Xinyun Chen, Hanxiao Liu, Da&nbsp;Huang, Denny Zhou, et&nbsp;al.

</span>
<span class="ltx_bibblock">Larger language models do in-context learning differently.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">arXiv preprint arXiv:2303.03846</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xie et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Sang&nbsp;Michael Xie, Aditi Raghunathan, Percy Liang, and Tengyu Ma.

</span>
<span class="ltx_bibblock">An explanation of in-context learning as implicit bayesian inference.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">arXiv preprint arXiv:2111.02080</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yoo et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Kang&nbsp;Min Yoo, Junyeob Kim, Hyuhng&nbsp;Joon Kim, Hyunsoo Cho, Hwiyeol Jo, Sang-Woo Lee, Sang-goo Lee, and Taeuk Kim.

</span>
<span class="ltx_bibblock">Ground-truth labels matter: A deeper look into input-label demonstrations.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">Proceedings of the 2022 Conference on Empirical Methods in Natural Language Processing</em>, pp.&nbsp; 2422–2437, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Chiyuan Zhang, Samy Bengio, Moritz Hardt, Benjamin Recht, and Oriol Vinyals.

</span>
<span class="ltx_bibblock">Understanding deep learning (still) requires rethinking generalization.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">Communications of the ACM</em>, 64(3):107–115, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Ruiqi Zhang, Spencer Frei, and Peter&nbsp;L Bartlett.

</span>
<span class="ltx_bibblock">Trained transformers learn linear models in-context.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">arXiv preprint arXiv:2306.09927</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et&nbsp;al. (2015)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Xiang Zhang, Junbo&nbsp;Jake Zhao, and Yann LeCun.

</span>
<span class="ltx_bibblock">Character-level convolutional networks for text classification.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">NIPS</em>, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang &amp; Yang (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yu&nbsp;Zhang and Qiang Yang.

</span>
<span class="ltx_bibblock">A survey on multi-task learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib46.1.1">IEEE transactions on knowledge and data engineering</em>, 34(12):5586–5609, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Zihao Zhao, Eric Wallace, Shi Feng, Dan Klein, and Sameer Singh.

</span>
<span class="ltx_bibblock">Calibrate before use: Improving few-shot performance of language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib47.1.1">International conference on machine learning</em>, pp.&nbsp; 12697–12706. PMLR, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zheng et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Bowen Zheng, Ming Ma, Zhongqiao Lin, and Tianming Yang.

</span>
<span class="ltx_bibblock">Distributed rule vectors is a key mechanism in large language models’ in-context learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib48.1.1">arXiv preprint arXiv:2406.16007</em>, 2024.

</span>
</li>
</ul>
</section>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Experiment Details and Settings</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsection" id="A1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Detailed Overall Experimental Settings</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A1.SS1.p1">
<p class="ltx_p" id="A1.SS1.p1.1"><span class="ltx_text ltx_font_bold" id="A1.SS1.p1.1.1">Prompt Template.</span> We conduct experiments on a specific prompt template for each dataset as shown in Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A1.T4" title="Table 4 ‣ A.1 Detailed Overall Experimental Settings ‣ Appendix A Experiment Details and Settings ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">4</span></a>. Moreover, similar to typical ICL practices, we reduce the label into one token to simplify the prediction decoding. The reduced label tokens are also shown in Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A1.T4" title="Table 4 ‣ A.1 Detailed Overall Experimental Settings ‣ Appendix A Experiment Details and Settings ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">4</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS1.p2">
<p class="ltx_p" id="A1.SS1.p2.1"><span class="ltx_text ltx_font_bold" id="A1.SS1.p2.1.1">Quantization.</span> In our experiments, we use <span class="ltx_text ltx_font_typewriter" id="A1.SS1.p2.1.2">BitsAndBytes<span class="ltx_note ltx_role_footnote" id="footnote8"><sup class="ltx_note_mark">8</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">8</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_serif" id="footnote8.1.1.1">8</span></span><a class="ltx_ref ltx_url" href="https://huggingface.co/docs/bitsandbytes/main/en/index" title="">https://huggingface.co/docs/bitsandbytes/main/en/index</a></span></span></span></span> to quantize Llama 3 70B and Falcon 40B to <span class="ltx_text ltx_font_typewriter" id="A1.SS1.p2.1.3">INT4</span>. For the other models, full-precision inference is conducted.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="A1.T4">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Prompt templates used in this paper.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="A1.T4.6" style="width:433.6pt;height:100.2pt;vertical-align:-0.8pt;"><span class="ltx_transformed_inner" style="transform:translate(-58.0pt,13.3pt) scale(0.788936632978054,0.788936632978054) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A1.T4.6.6">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A1.T4.6.6.7.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T4.6.6.7.1.1"><span class="ltx_text ltx_font_bold" id="A1.T4.6.6.7.1.1.1">Dataset</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T4.6.6.7.1.2"><span class="ltx_text ltx_font_bold" id="A1.T4.6.6.7.1.2.1">Prompt Template (Unit)</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T4.6.6.7.1.3"><span class="ltx_text ltx_font_bold" id="A1.T4.6.6.7.1.3.1">Label Tokens</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A1.T4.1.1.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T4.1.1.1.2">SST-2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T4.1.1.1.1"><span class="ltx_text ltx_font_typewriter" id="A1.T4.1.1.1.1.1">sentence: &lt;input sentence&gt; sentiment: &lt;label token&gt; <math alttext="\backslash" class="ltx_Math" display="inline" id="A1.T4.1.1.1.1.1.m1.1"><semantics id="A1.T4.1.1.1.1.1.m1.1a"><mo id="A1.T4.1.1.1.1.1.m1.1.1" xref="A1.T4.1.1.1.1.1.m1.1.1.cmml">\</mo><annotation-xml encoding="MathML-Content" id="A1.T4.1.1.1.1.1.m1.1b"><ci id="A1.T4.1.1.1.1.1.m1.1.1.cmml" xref="A1.T4.1.1.1.1.1.m1.1.1">\</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.1.1.1.1.1.m1.1c">\backslash</annotation><annotation encoding="application/x-llamapun" id="A1.T4.1.1.1.1.1.m1.1d">\</annotation></semantics></math>n</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T4.1.1.1.3">negative, positive</td>
</tr>
<tr class="ltx_tr" id="A1.T4.2.2.2">
<td class="ltx_td ltx_align_center" id="A1.T4.2.2.2.2">MR</td>
<td class="ltx_td ltx_align_center" id="A1.T4.2.2.2.1"><span class="ltx_text ltx_font_typewriter" id="A1.T4.2.2.2.1.1">review: &lt;input sentence&gt; sentiment: &lt;label token&gt; <math alttext="\backslash" class="ltx_Math" display="inline" id="A1.T4.2.2.2.1.1.m1.1"><semantics id="A1.T4.2.2.2.1.1.m1.1a"><mo id="A1.T4.2.2.2.1.1.m1.1.1" xref="A1.T4.2.2.2.1.1.m1.1.1.cmml">\</mo><annotation-xml encoding="MathML-Content" id="A1.T4.2.2.2.1.1.m1.1b"><ci id="A1.T4.2.2.2.1.1.m1.1.1.cmml" xref="A1.T4.2.2.2.1.1.m1.1.1">\</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.2.2.2.1.1.m1.1c">\backslash</annotation><annotation encoding="application/x-llamapun" id="A1.T4.2.2.2.1.1.m1.1d">\</annotation></semantics></math>n</span></td>
<td class="ltx_td ltx_align_center" id="A1.T4.2.2.2.3">negative, positive</td>
</tr>
<tr class="ltx_tr" id="A1.T4.3.3.3">
<td class="ltx_td ltx_align_center" id="A1.T4.3.3.3.2">FP</td>
<td class="ltx_td ltx_align_center" id="A1.T4.3.3.3.1"><span class="ltx_text ltx_font_typewriter" id="A1.T4.3.3.3.1.1">sentence: &lt;input sentence&gt; sentiment: &lt;label token&gt; <math alttext="\backslash" class="ltx_Math" display="inline" id="A1.T4.3.3.3.1.1.m1.1"><semantics id="A1.T4.3.3.3.1.1.m1.1a"><mo id="A1.T4.3.3.3.1.1.m1.1.1" xref="A1.T4.3.3.3.1.1.m1.1.1.cmml">\</mo><annotation-xml encoding="MathML-Content" id="A1.T4.3.3.3.1.1.m1.1b"><ci id="A1.T4.3.3.3.1.1.m1.1.1.cmml" xref="A1.T4.3.3.3.1.1.m1.1.1">\</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.3.3.3.1.1.m1.1c">\backslash</annotation><annotation encoding="application/x-llamapun" id="A1.T4.3.3.3.1.1.m1.1d">\</annotation></semantics></math>n</span></td>
<td class="ltx_td ltx_align_center" id="A1.T4.3.3.3.3">negative, neutral, positive</td>
</tr>
<tr class="ltx_tr" id="A1.T4.4.4.4">
<td class="ltx_td ltx_align_center" id="A1.T4.4.4.4.2">SST-5</td>
<td class="ltx_td ltx_align_center" id="A1.T4.4.4.4.1"><span class="ltx_text ltx_font_typewriter" id="A1.T4.4.4.4.1.1">sentence: &lt;input sentence&gt; sentiment: &lt;label token&gt; <math alttext="\backslash" class="ltx_Math" display="inline" id="A1.T4.4.4.4.1.1.m1.1"><semantics id="A1.T4.4.4.4.1.1.m1.1a"><mo id="A1.T4.4.4.4.1.1.m1.1.1" xref="A1.T4.4.4.4.1.1.m1.1.1.cmml">\</mo><annotation-xml encoding="MathML-Content" id="A1.T4.4.4.4.1.1.m1.1b"><ci id="A1.T4.4.4.4.1.1.m1.1.1.cmml" xref="A1.T4.4.4.4.1.1.m1.1.1">\</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.4.4.4.1.1.m1.1c">\backslash</annotation><annotation encoding="application/x-llamapun" id="A1.T4.4.4.4.1.1.m1.1d">\</annotation></semantics></math>n</span></td>
<td class="ltx_td ltx_align_center" id="A1.T4.4.4.4.3">poor, bad, neutral, good, great</td>
</tr>
<tr class="ltx_tr" id="A1.T4.5.5.5">
<td class="ltx_td ltx_align_center" id="A1.T4.5.5.5.2">TREC</td>
<td class="ltx_td ltx_align_center" id="A1.T4.5.5.5.1"><span class="ltx_text ltx_font_typewriter" id="A1.T4.5.5.5.1.1">question: &lt;input sentence&gt; target: &lt;label token&gt; <math alttext="\backslash" class="ltx_Math" display="inline" id="A1.T4.5.5.5.1.1.m1.1"><semantics id="A1.T4.5.5.5.1.1.m1.1a"><mo id="A1.T4.5.5.5.1.1.m1.1.1" xref="A1.T4.5.5.5.1.1.m1.1.1.cmml">\</mo><annotation-xml encoding="MathML-Content" id="A1.T4.5.5.5.1.1.m1.1b"><ci id="A1.T4.5.5.5.1.1.m1.1.1.cmml" xref="A1.T4.5.5.5.1.1.m1.1.1">\</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.5.5.5.1.1.m1.1c">\backslash</annotation><annotation encoding="application/x-llamapun" id="A1.T4.5.5.5.1.1.m1.1d">\</annotation></semantics></math>n</span></td>
<td class="ltx_td ltx_align_center" id="A1.T4.5.5.5.3">short, entity, description, person, location, number</td>
</tr>
<tr class="ltx_tr" id="A1.T4.6.6.6">
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T4.6.6.6.2">AGNews</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T4.6.6.6.1"><span class="ltx_text ltx_font_typewriter" id="A1.T4.6.6.6.1.1">news: &lt;input sentence&gt; topic: &lt;label token&gt; <math alttext="\backslash" class="ltx_Math" display="inline" id="A1.T4.6.6.6.1.1.m1.1"><semantics id="A1.T4.6.6.6.1.1.m1.1a"><mo id="A1.T4.6.6.6.1.1.m1.1.1" xref="A1.T4.6.6.6.1.1.m1.1.1.cmml">\</mo><annotation-xml encoding="MathML-Content" id="A1.T4.6.6.6.1.1.m1.1b"><ci id="A1.T4.6.6.6.1.1.m1.1.1.cmml" xref="A1.T4.6.6.6.1.1.m1.1.1">\</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.6.6.6.1.1.m1.1c">\backslash</annotation><annotation encoding="application/x-llamapun" id="A1.T4.6.6.6.1.1.m1.1d">\</annotation></semantics></math>n</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T4.6.6.6.3">world, sports, business, science</td>
</tr>
</tbody>
</table>
</span></div>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A1.SS1.p3">
<p class="ltx_p" id="A1.SS1.p3.1"><span class="ltx_text ltx_font_bold" id="A1.SS1.p3.1.1">Other.</span> All the experiment materials (models and datasets) are loaded from <span class="ltx_text ltx_font_typewriter" id="A1.SS1.p3.1.2">huggingface</span>. For the BGE M3, we use its&nbsp;<span class="ltx_text ltx_font_typewriter" id="A1.SS1.p3.1.3">pooler_output</span> as the output feature.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="A1.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Calculation of Mutual Nearest-neighbor Kernel Alignment</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A1.SS2.p1">
<p class="ltx_p" id="A1.SS2.p1.1">In this paper, we need to measure the similarity between features from two different models or model layers. There are many approaches&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Klabunde et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib21" title="">2023</a>)</cite>, and we use mutual nearest-neighbor kernel alignment&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Huh et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib19" title="">2024</a>)</cite>, which is relatively efficient and accurate, calculated as follows to measure the similarity of representation from the same object set <math alttext="\mathcal{X}=\left\{x_{i}\right\}_{i=1}^{n}" class="ltx_Math" display="inline" id="A1.SS2.p1.1.m1.1"><semantics id="A1.SS2.p1.1.m1.1a"><mrow id="A1.SS2.p1.1.m1.1.1" xref="A1.SS2.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS2.p1.1.m1.1.1.3" xref="A1.SS2.p1.1.m1.1.1.3.cmml">𝒳</mi><mo id="A1.SS2.p1.1.m1.1.1.2" xref="A1.SS2.p1.1.m1.1.1.2.cmml">=</mo><msubsup id="A1.SS2.p1.1.m1.1.1.1" xref="A1.SS2.p1.1.m1.1.1.1.cmml"><mrow id="A1.SS2.p1.1.m1.1.1.1.1.1.1" xref="A1.SS2.p1.1.m1.1.1.1.1.1.2.cmml"><mo id="A1.SS2.p1.1.m1.1.1.1.1.1.1.2" xref="A1.SS2.p1.1.m1.1.1.1.1.1.2.cmml">{</mo><msub id="A1.SS2.p1.1.m1.1.1.1.1.1.1.1" xref="A1.SS2.p1.1.m1.1.1.1.1.1.1.1.cmml"><mi id="A1.SS2.p1.1.m1.1.1.1.1.1.1.1.2" xref="A1.SS2.p1.1.m1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="A1.SS2.p1.1.m1.1.1.1.1.1.1.1.3" xref="A1.SS2.p1.1.m1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.SS2.p1.1.m1.1.1.1.1.1.1.3" xref="A1.SS2.p1.1.m1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="A1.SS2.p1.1.m1.1.1.1.1.3" xref="A1.SS2.p1.1.m1.1.1.1.1.3.cmml"><mi id="A1.SS2.p1.1.m1.1.1.1.1.3.2" xref="A1.SS2.p1.1.m1.1.1.1.1.3.2.cmml">i</mi><mo id="A1.SS2.p1.1.m1.1.1.1.1.3.1" xref="A1.SS2.p1.1.m1.1.1.1.1.3.1.cmml">=</mo><mn id="A1.SS2.p1.1.m1.1.1.1.1.3.3" xref="A1.SS2.p1.1.m1.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="A1.SS2.p1.1.m1.1.1.1.3" xref="A1.SS2.p1.1.m1.1.1.1.3.cmml">n</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.1.m1.1b"><apply id="A1.SS2.p1.1.m1.1.1.cmml" xref="A1.SS2.p1.1.m1.1.1"><eq id="A1.SS2.p1.1.m1.1.1.2.cmml" xref="A1.SS2.p1.1.m1.1.1.2"></eq><ci id="A1.SS2.p1.1.m1.1.1.3.cmml" xref="A1.SS2.p1.1.m1.1.1.3">𝒳</ci><apply id="A1.SS2.p1.1.m1.1.1.1.cmml" xref="A1.SS2.p1.1.m1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p1.1.m1.1.1.1.2.cmml" xref="A1.SS2.p1.1.m1.1.1.1">superscript</csymbol><apply id="A1.SS2.p1.1.m1.1.1.1.1.cmml" xref="A1.SS2.p1.1.m1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p1.1.m1.1.1.1.1.2.cmml" xref="A1.SS2.p1.1.m1.1.1.1">subscript</csymbol><set id="A1.SS2.p1.1.m1.1.1.1.1.1.2.cmml" xref="A1.SS2.p1.1.m1.1.1.1.1.1.1"><apply id="A1.SS2.p1.1.m1.1.1.1.1.1.1.1.cmml" xref="A1.SS2.p1.1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="A1.SS2.p1.1.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.SS2.p1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="A1.SS2.p1.1.m1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="A1.SS2.p1.1.m1.1.1.1.1.1.1.1.3.cmml" xref="A1.SS2.p1.1.m1.1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="A1.SS2.p1.1.m1.1.1.1.1.3.cmml" xref="A1.SS2.p1.1.m1.1.1.1.1.3"><eq id="A1.SS2.p1.1.m1.1.1.1.1.3.1.cmml" xref="A1.SS2.p1.1.m1.1.1.1.1.3.1"></eq><ci id="A1.SS2.p1.1.m1.1.1.1.1.3.2.cmml" xref="A1.SS2.p1.1.m1.1.1.1.1.3.2">𝑖</ci><cn id="A1.SS2.p1.1.m1.1.1.1.1.3.3.cmml" type="integer" xref="A1.SS2.p1.1.m1.1.1.1.1.3.3">1</cn></apply></apply><ci id="A1.SS2.p1.1.m1.1.1.1.3.cmml" xref="A1.SS2.p1.1.m1.1.1.1.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.1.m1.1c">\mathcal{X}=\left\{x_{i}\right\}_{i=1}^{n}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.1.m1.1d">caligraphic_X = { italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT</annotation></semantics></math> in different feature spaces.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS2.p2">
<p class="ltx_p" id="A1.SS2.p2.7">Given a representation mapping <math alttext="\delta:\mathcal{X}\rightarrow\mathbb{H}^{d}" class="ltx_Math" display="inline" id="A1.SS2.p2.1.m1.1"><semantics id="A1.SS2.p2.1.m1.1a"><mrow id="A1.SS2.p2.1.m1.1.1" xref="A1.SS2.p2.1.m1.1.1.cmml"><mi id="A1.SS2.p2.1.m1.1.1.2" xref="A1.SS2.p2.1.m1.1.1.2.cmml">δ</mi><mo id="A1.SS2.p2.1.m1.1.1.1" lspace="0.278em" rspace="0.278em" xref="A1.SS2.p2.1.m1.1.1.1.cmml">:</mo><mrow id="A1.SS2.p2.1.m1.1.1.3" xref="A1.SS2.p2.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS2.p2.1.m1.1.1.3.2" xref="A1.SS2.p2.1.m1.1.1.3.2.cmml">𝒳</mi><mo id="A1.SS2.p2.1.m1.1.1.3.1" stretchy="false" xref="A1.SS2.p2.1.m1.1.1.3.1.cmml">→</mo><msup id="A1.SS2.p2.1.m1.1.1.3.3" xref="A1.SS2.p2.1.m1.1.1.3.3.cmml"><mi id="A1.SS2.p2.1.m1.1.1.3.3.2" xref="A1.SS2.p2.1.m1.1.1.3.3.2.cmml">ℍ</mi><mi id="A1.SS2.p2.1.m1.1.1.3.3.3" xref="A1.SS2.p2.1.m1.1.1.3.3.3.cmml">d</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.1.m1.1b"><apply id="A1.SS2.p2.1.m1.1.1.cmml" xref="A1.SS2.p2.1.m1.1.1"><ci id="A1.SS2.p2.1.m1.1.1.1.cmml" xref="A1.SS2.p2.1.m1.1.1.1">:</ci><ci id="A1.SS2.p2.1.m1.1.1.2.cmml" xref="A1.SS2.p2.1.m1.1.1.2">𝛿</ci><apply id="A1.SS2.p2.1.m1.1.1.3.cmml" xref="A1.SS2.p2.1.m1.1.1.3"><ci id="A1.SS2.p2.1.m1.1.1.3.1.cmml" xref="A1.SS2.p2.1.m1.1.1.3.1">→</ci><ci id="A1.SS2.p2.1.m1.1.1.3.2.cmml" xref="A1.SS2.p2.1.m1.1.1.3.2">𝒳</ci><apply id="A1.SS2.p2.1.m1.1.1.3.3.cmml" xref="A1.SS2.p2.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="A1.SS2.p2.1.m1.1.1.3.3.1.cmml" xref="A1.SS2.p2.1.m1.1.1.3.3">superscript</csymbol><ci id="A1.SS2.p2.1.m1.1.1.3.3.2.cmml" xref="A1.SS2.p2.1.m1.1.1.3.3.2">ℍ</ci><ci id="A1.SS2.p2.1.m1.1.1.3.3.3.cmml" xref="A1.SS2.p2.1.m1.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.1.m1.1c">\delta:\mathcal{X}\rightarrow\mathbb{H}^{d}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p2.1.m1.1d">italic_δ : caligraphic_X → blackboard_H start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> from the objects to a space where similarity measurement <math alttext="\left\langle\cdot,\cdot\right\rangle:\mathbb{H}^{d}\times\mathbb{H}^{d}%
\rightarrow\mathbb{R}" class="ltx_Math" display="inline" id="A1.SS2.p2.2.m2.2"><semantics id="A1.SS2.p2.2.m2.2a"><mrow id="A1.SS2.p2.2.m2.2.3" xref="A1.SS2.p2.2.m2.2.3.cmml"><mrow id="A1.SS2.p2.2.m2.2.3.2.2" xref="A1.SS2.p2.2.m2.2.3.2.1.cmml"><mo id="A1.SS2.p2.2.m2.2.3.2.2.1" xref="A1.SS2.p2.2.m2.2.3.2.1.cmml">⟨</mo><mo id="A1.SS2.p2.2.m2.1.1" lspace="0em" rspace="0em" xref="A1.SS2.p2.2.m2.1.1.cmml">⋅</mo><mo id="A1.SS2.p2.2.m2.2.3.2.2.2" rspace="0em" xref="A1.SS2.p2.2.m2.2.3.2.1.cmml">,</mo><mo id="A1.SS2.p2.2.m2.2.2" lspace="0em" rspace="0em" xref="A1.SS2.p2.2.m2.2.2.cmml">⋅</mo><mo id="A1.SS2.p2.2.m2.2.3.2.2.3" rspace="0.278em" xref="A1.SS2.p2.2.m2.2.3.2.1.cmml">⟩</mo></mrow><mo id="A1.SS2.p2.2.m2.2.3.1" rspace="0.278em" xref="A1.SS2.p2.2.m2.2.3.1.cmml">:</mo><mrow id="A1.SS2.p2.2.m2.2.3.3" xref="A1.SS2.p2.2.m2.2.3.3.cmml"><mrow id="A1.SS2.p2.2.m2.2.3.3.2" xref="A1.SS2.p2.2.m2.2.3.3.2.cmml"><msup id="A1.SS2.p2.2.m2.2.3.3.2.2" xref="A1.SS2.p2.2.m2.2.3.3.2.2.cmml"><mi id="A1.SS2.p2.2.m2.2.3.3.2.2.2" xref="A1.SS2.p2.2.m2.2.3.3.2.2.2.cmml">ℍ</mi><mi id="A1.SS2.p2.2.m2.2.3.3.2.2.3" xref="A1.SS2.p2.2.m2.2.3.3.2.2.3.cmml">d</mi></msup><mo id="A1.SS2.p2.2.m2.2.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="A1.SS2.p2.2.m2.2.3.3.2.1.cmml">×</mo><msup id="A1.SS2.p2.2.m2.2.3.3.2.3" xref="A1.SS2.p2.2.m2.2.3.3.2.3.cmml"><mi id="A1.SS2.p2.2.m2.2.3.3.2.3.2" xref="A1.SS2.p2.2.m2.2.3.3.2.3.2.cmml">ℍ</mi><mi id="A1.SS2.p2.2.m2.2.3.3.2.3.3" xref="A1.SS2.p2.2.m2.2.3.3.2.3.3.cmml">d</mi></msup></mrow><mo id="A1.SS2.p2.2.m2.2.3.3.1" stretchy="false" xref="A1.SS2.p2.2.m2.2.3.3.1.cmml">→</mo><mi id="A1.SS2.p2.2.m2.2.3.3.3" xref="A1.SS2.p2.2.m2.2.3.3.3.cmml">ℝ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.2.m2.2b"><apply id="A1.SS2.p2.2.m2.2.3.cmml" xref="A1.SS2.p2.2.m2.2.3"><ci id="A1.SS2.p2.2.m2.2.3.1.cmml" xref="A1.SS2.p2.2.m2.2.3.1">:</ci><list id="A1.SS2.p2.2.m2.2.3.2.1.cmml" xref="A1.SS2.p2.2.m2.2.3.2.2"><ci id="A1.SS2.p2.2.m2.1.1.cmml" xref="A1.SS2.p2.2.m2.1.1">⋅</ci><ci id="A1.SS2.p2.2.m2.2.2.cmml" xref="A1.SS2.p2.2.m2.2.2">⋅</ci></list><apply id="A1.SS2.p2.2.m2.2.3.3.cmml" xref="A1.SS2.p2.2.m2.2.3.3"><ci id="A1.SS2.p2.2.m2.2.3.3.1.cmml" xref="A1.SS2.p2.2.m2.2.3.3.1">→</ci><apply id="A1.SS2.p2.2.m2.2.3.3.2.cmml" xref="A1.SS2.p2.2.m2.2.3.3.2"><times id="A1.SS2.p2.2.m2.2.3.3.2.1.cmml" xref="A1.SS2.p2.2.m2.2.3.3.2.1"></times><apply id="A1.SS2.p2.2.m2.2.3.3.2.2.cmml" xref="A1.SS2.p2.2.m2.2.3.3.2.2"><csymbol cd="ambiguous" id="A1.SS2.p2.2.m2.2.3.3.2.2.1.cmml" xref="A1.SS2.p2.2.m2.2.3.3.2.2">superscript</csymbol><ci id="A1.SS2.p2.2.m2.2.3.3.2.2.2.cmml" xref="A1.SS2.p2.2.m2.2.3.3.2.2.2">ℍ</ci><ci id="A1.SS2.p2.2.m2.2.3.3.2.2.3.cmml" xref="A1.SS2.p2.2.m2.2.3.3.2.2.3">𝑑</ci></apply><apply id="A1.SS2.p2.2.m2.2.3.3.2.3.cmml" xref="A1.SS2.p2.2.m2.2.3.3.2.3"><csymbol cd="ambiguous" id="A1.SS2.p2.2.m2.2.3.3.2.3.1.cmml" xref="A1.SS2.p2.2.m2.2.3.3.2.3">superscript</csymbol><ci id="A1.SS2.p2.2.m2.2.3.3.2.3.2.cmml" xref="A1.SS2.p2.2.m2.2.3.3.2.3.2">ℍ</ci><ci id="A1.SS2.p2.2.m2.2.3.3.2.3.3.cmml" xref="A1.SS2.p2.2.m2.2.3.3.2.3.3">𝑑</ci></apply></apply><ci id="A1.SS2.p2.2.m2.2.3.3.3.cmml" xref="A1.SS2.p2.2.m2.2.3.3.3">ℝ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.2.m2.2c">\left\langle\cdot,\cdot\right\rangle:\mathbb{H}^{d}\times\mathbb{H}^{d}%
\rightarrow\mathbb{R}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p2.2.m2.2d">⟨ ⋅ , ⋅ ⟩ : blackboard_H start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT × blackboard_H start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT → blackboard_R</annotation></semantics></math> is defined, we can calculate the similarity map from dataset <math alttext="\mathcal{X}" class="ltx_Math" display="inline" id="A1.SS2.p2.3.m3.1"><semantics id="A1.SS2.p2.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="A1.SS2.p2.3.m3.1.1" xref="A1.SS2.p2.3.m3.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.3.m3.1b"><ci id="A1.SS2.p2.3.m3.1.1.cmml" xref="A1.SS2.p2.3.m3.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.3.m3.1c">\mathcal{X}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p2.3.m3.1d">caligraphic_X</annotation></semantics></math> as <math alttext="\mathcal{S}_{\delta}\in\mathbb{R}^{n\times n}" class="ltx_Math" display="inline" id="A1.SS2.p2.4.m4.1"><semantics id="A1.SS2.p2.4.m4.1a"><mrow id="A1.SS2.p2.4.m4.1.1" xref="A1.SS2.p2.4.m4.1.1.cmml"><msub id="A1.SS2.p2.4.m4.1.1.2" xref="A1.SS2.p2.4.m4.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS2.p2.4.m4.1.1.2.2" xref="A1.SS2.p2.4.m4.1.1.2.2.cmml">𝒮</mi><mi id="A1.SS2.p2.4.m4.1.1.2.3" xref="A1.SS2.p2.4.m4.1.1.2.3.cmml">δ</mi></msub><mo id="A1.SS2.p2.4.m4.1.1.1" xref="A1.SS2.p2.4.m4.1.1.1.cmml">∈</mo><msup id="A1.SS2.p2.4.m4.1.1.3" xref="A1.SS2.p2.4.m4.1.1.3.cmml"><mi id="A1.SS2.p2.4.m4.1.1.3.2" xref="A1.SS2.p2.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="A1.SS2.p2.4.m4.1.1.3.3" xref="A1.SS2.p2.4.m4.1.1.3.3.cmml"><mi id="A1.SS2.p2.4.m4.1.1.3.3.2" xref="A1.SS2.p2.4.m4.1.1.3.3.2.cmml">n</mi><mo id="A1.SS2.p2.4.m4.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="A1.SS2.p2.4.m4.1.1.3.3.1.cmml">×</mo><mi id="A1.SS2.p2.4.m4.1.1.3.3.3" xref="A1.SS2.p2.4.m4.1.1.3.3.3.cmml">n</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.4.m4.1b"><apply id="A1.SS2.p2.4.m4.1.1.cmml" xref="A1.SS2.p2.4.m4.1.1"><in id="A1.SS2.p2.4.m4.1.1.1.cmml" xref="A1.SS2.p2.4.m4.1.1.1"></in><apply id="A1.SS2.p2.4.m4.1.1.2.cmml" xref="A1.SS2.p2.4.m4.1.1.2"><csymbol cd="ambiguous" id="A1.SS2.p2.4.m4.1.1.2.1.cmml" xref="A1.SS2.p2.4.m4.1.1.2">subscript</csymbol><ci id="A1.SS2.p2.4.m4.1.1.2.2.cmml" xref="A1.SS2.p2.4.m4.1.1.2.2">𝒮</ci><ci id="A1.SS2.p2.4.m4.1.1.2.3.cmml" xref="A1.SS2.p2.4.m4.1.1.2.3">𝛿</ci></apply><apply id="A1.SS2.p2.4.m4.1.1.3.cmml" xref="A1.SS2.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.p2.4.m4.1.1.3.1.cmml" xref="A1.SS2.p2.4.m4.1.1.3">superscript</csymbol><ci id="A1.SS2.p2.4.m4.1.1.3.2.cmml" xref="A1.SS2.p2.4.m4.1.1.3.2">ℝ</ci><apply id="A1.SS2.p2.4.m4.1.1.3.3.cmml" xref="A1.SS2.p2.4.m4.1.1.3.3"><times id="A1.SS2.p2.4.m4.1.1.3.3.1.cmml" xref="A1.SS2.p2.4.m4.1.1.3.3.1"></times><ci id="A1.SS2.p2.4.m4.1.1.3.3.2.cmml" xref="A1.SS2.p2.4.m4.1.1.3.3.2">𝑛</ci><ci id="A1.SS2.p2.4.m4.1.1.3.3.3.cmml" xref="A1.SS2.p2.4.m4.1.1.3.3.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.4.m4.1c">\mathcal{S}_{\delta}\in\mathbb{R}^{n\times n}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p2.4.m4.1d">caligraphic_S start_POSTSUBSCRIPT italic_δ end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_n × italic_n end_POSTSUPERSCRIPT</annotation></semantics></math>, where the elements are <math alttext="\mathcal{S}_{\delta|i,j}=\langle\delta\left(x_{i}\right),\delta\left(x_{j}%
\right)\rangle" class="ltx_Math" display="inline" id="A1.SS2.p2.5.m5.4"><semantics id="A1.SS2.p2.5.m5.4a"><mrow id="A1.SS2.p2.5.m5.4.4" xref="A1.SS2.p2.5.m5.4.4.cmml"><msub id="A1.SS2.p2.5.m5.4.4.4" xref="A1.SS2.p2.5.m5.4.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS2.p2.5.m5.4.4.4.2" xref="A1.SS2.p2.5.m5.4.4.4.2.cmml">𝒮</mi><mrow id="A1.SS2.p2.5.m5.2.2.2" xref="A1.SS2.p2.5.m5.2.2.2.cmml"><mi id="A1.SS2.p2.5.m5.2.2.2.4" xref="A1.SS2.p2.5.m5.2.2.2.4.cmml">δ</mi><mo fence="false" id="A1.SS2.p2.5.m5.2.2.2.3" xref="A1.SS2.p2.5.m5.2.2.2.3.cmml">|</mo><mrow id="A1.SS2.p2.5.m5.2.2.2.5.2" xref="A1.SS2.p2.5.m5.2.2.2.5.1.cmml"><mi id="A1.SS2.p2.5.m5.1.1.1.1" xref="A1.SS2.p2.5.m5.1.1.1.1.cmml">i</mi><mo id="A1.SS2.p2.5.m5.2.2.2.5.2.1" xref="A1.SS2.p2.5.m5.2.2.2.5.1.cmml">,</mo><mi id="A1.SS2.p2.5.m5.2.2.2.2" xref="A1.SS2.p2.5.m5.2.2.2.2.cmml">j</mi></mrow></mrow></msub><mo id="A1.SS2.p2.5.m5.4.4.3" xref="A1.SS2.p2.5.m5.4.4.3.cmml">=</mo><mrow id="A1.SS2.p2.5.m5.4.4.2.2" xref="A1.SS2.p2.5.m5.4.4.2.3.cmml"><mo id="A1.SS2.p2.5.m5.4.4.2.2.3" stretchy="false" xref="A1.SS2.p2.5.m5.4.4.2.3.cmml">⟨</mo><mrow id="A1.SS2.p2.5.m5.3.3.1.1.1" xref="A1.SS2.p2.5.m5.3.3.1.1.1.cmml"><mi id="A1.SS2.p2.5.m5.3.3.1.1.1.3" xref="A1.SS2.p2.5.m5.3.3.1.1.1.3.cmml">δ</mi><mo id="A1.SS2.p2.5.m5.3.3.1.1.1.2" xref="A1.SS2.p2.5.m5.3.3.1.1.1.2.cmml">⁢</mo><mrow id="A1.SS2.p2.5.m5.3.3.1.1.1.1.1" xref="A1.SS2.p2.5.m5.3.3.1.1.1.1.1.1.cmml"><mo id="A1.SS2.p2.5.m5.3.3.1.1.1.1.1.2" xref="A1.SS2.p2.5.m5.3.3.1.1.1.1.1.1.cmml">(</mo><msub id="A1.SS2.p2.5.m5.3.3.1.1.1.1.1.1" xref="A1.SS2.p2.5.m5.3.3.1.1.1.1.1.1.cmml"><mi id="A1.SS2.p2.5.m5.3.3.1.1.1.1.1.1.2" xref="A1.SS2.p2.5.m5.3.3.1.1.1.1.1.1.2.cmml">x</mi><mi id="A1.SS2.p2.5.m5.3.3.1.1.1.1.1.1.3" xref="A1.SS2.p2.5.m5.3.3.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.SS2.p2.5.m5.3.3.1.1.1.1.1.3" xref="A1.SS2.p2.5.m5.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.SS2.p2.5.m5.4.4.2.2.4" xref="A1.SS2.p2.5.m5.4.4.2.3.cmml">,</mo><mrow id="A1.SS2.p2.5.m5.4.4.2.2.2" xref="A1.SS2.p2.5.m5.4.4.2.2.2.cmml"><mi id="A1.SS2.p2.5.m5.4.4.2.2.2.3" xref="A1.SS2.p2.5.m5.4.4.2.2.2.3.cmml">δ</mi><mo id="A1.SS2.p2.5.m5.4.4.2.2.2.2" xref="A1.SS2.p2.5.m5.4.4.2.2.2.2.cmml">⁢</mo><mrow id="A1.SS2.p2.5.m5.4.4.2.2.2.1.1" xref="A1.SS2.p2.5.m5.4.4.2.2.2.1.1.1.cmml"><mo id="A1.SS2.p2.5.m5.4.4.2.2.2.1.1.2" xref="A1.SS2.p2.5.m5.4.4.2.2.2.1.1.1.cmml">(</mo><msub id="A1.SS2.p2.5.m5.4.4.2.2.2.1.1.1" xref="A1.SS2.p2.5.m5.4.4.2.2.2.1.1.1.cmml"><mi id="A1.SS2.p2.5.m5.4.4.2.2.2.1.1.1.2" xref="A1.SS2.p2.5.m5.4.4.2.2.2.1.1.1.2.cmml">x</mi><mi id="A1.SS2.p2.5.m5.4.4.2.2.2.1.1.1.3" xref="A1.SS2.p2.5.m5.4.4.2.2.2.1.1.1.3.cmml">j</mi></msub><mo id="A1.SS2.p2.5.m5.4.4.2.2.2.1.1.3" xref="A1.SS2.p2.5.m5.4.4.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.SS2.p2.5.m5.4.4.2.2.5" stretchy="false" xref="A1.SS2.p2.5.m5.4.4.2.3.cmml">⟩</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.5.m5.4b"><apply id="A1.SS2.p2.5.m5.4.4.cmml" xref="A1.SS2.p2.5.m5.4.4"><eq id="A1.SS2.p2.5.m5.4.4.3.cmml" xref="A1.SS2.p2.5.m5.4.4.3"></eq><apply id="A1.SS2.p2.5.m5.4.4.4.cmml" xref="A1.SS2.p2.5.m5.4.4.4"><csymbol cd="ambiguous" id="A1.SS2.p2.5.m5.4.4.4.1.cmml" xref="A1.SS2.p2.5.m5.4.4.4">subscript</csymbol><ci id="A1.SS2.p2.5.m5.4.4.4.2.cmml" xref="A1.SS2.p2.5.m5.4.4.4.2">𝒮</ci><apply id="A1.SS2.p2.5.m5.2.2.2.cmml" xref="A1.SS2.p2.5.m5.2.2.2"><csymbol cd="latexml" id="A1.SS2.p2.5.m5.2.2.2.3.cmml" xref="A1.SS2.p2.5.m5.2.2.2.3">conditional</csymbol><ci id="A1.SS2.p2.5.m5.2.2.2.4.cmml" xref="A1.SS2.p2.5.m5.2.2.2.4">𝛿</ci><list id="A1.SS2.p2.5.m5.2.2.2.5.1.cmml" xref="A1.SS2.p2.5.m5.2.2.2.5.2"><ci id="A1.SS2.p2.5.m5.1.1.1.1.cmml" xref="A1.SS2.p2.5.m5.1.1.1.1">𝑖</ci><ci id="A1.SS2.p2.5.m5.2.2.2.2.cmml" xref="A1.SS2.p2.5.m5.2.2.2.2">𝑗</ci></list></apply></apply><list id="A1.SS2.p2.5.m5.4.4.2.3.cmml" xref="A1.SS2.p2.5.m5.4.4.2.2"><apply id="A1.SS2.p2.5.m5.3.3.1.1.1.cmml" xref="A1.SS2.p2.5.m5.3.3.1.1.1"><times id="A1.SS2.p2.5.m5.3.3.1.1.1.2.cmml" xref="A1.SS2.p2.5.m5.3.3.1.1.1.2"></times><ci id="A1.SS2.p2.5.m5.3.3.1.1.1.3.cmml" xref="A1.SS2.p2.5.m5.3.3.1.1.1.3">𝛿</ci><apply id="A1.SS2.p2.5.m5.3.3.1.1.1.1.1.1.cmml" xref="A1.SS2.p2.5.m5.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p2.5.m5.3.3.1.1.1.1.1.1.1.cmml" xref="A1.SS2.p2.5.m5.3.3.1.1.1.1.1">subscript</csymbol><ci id="A1.SS2.p2.5.m5.3.3.1.1.1.1.1.1.2.cmml" xref="A1.SS2.p2.5.m5.3.3.1.1.1.1.1.1.2">𝑥</ci><ci id="A1.SS2.p2.5.m5.3.3.1.1.1.1.1.1.3.cmml" xref="A1.SS2.p2.5.m5.3.3.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="A1.SS2.p2.5.m5.4.4.2.2.2.cmml" xref="A1.SS2.p2.5.m5.4.4.2.2.2"><times id="A1.SS2.p2.5.m5.4.4.2.2.2.2.cmml" xref="A1.SS2.p2.5.m5.4.4.2.2.2.2"></times><ci id="A1.SS2.p2.5.m5.4.4.2.2.2.3.cmml" xref="A1.SS2.p2.5.m5.4.4.2.2.2.3">𝛿</ci><apply id="A1.SS2.p2.5.m5.4.4.2.2.2.1.1.1.cmml" xref="A1.SS2.p2.5.m5.4.4.2.2.2.1.1"><csymbol cd="ambiguous" id="A1.SS2.p2.5.m5.4.4.2.2.2.1.1.1.1.cmml" xref="A1.SS2.p2.5.m5.4.4.2.2.2.1.1">subscript</csymbol><ci id="A1.SS2.p2.5.m5.4.4.2.2.2.1.1.1.2.cmml" xref="A1.SS2.p2.5.m5.4.4.2.2.2.1.1.1.2">𝑥</ci><ci id="A1.SS2.p2.5.m5.4.4.2.2.2.1.1.1.3.cmml" xref="A1.SS2.p2.5.m5.4.4.2.2.2.1.1.1.3">𝑗</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.5.m5.4c">\mathcal{S}_{\delta|i,j}=\langle\delta\left(x_{i}\right),\delta\left(x_{j}%
\right)\rangle</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p2.5.m5.4d">caligraphic_S start_POSTSUBSCRIPT italic_δ | italic_i , italic_j end_POSTSUBSCRIPT = ⟨ italic_δ ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) , italic_δ ( italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ⟩</annotation></semantics></math>, especially, we axiomatic define <math alttext="\left\langle x,x\right\rangle=1" class="ltx_Math" display="inline" id="A1.SS2.p2.6.m6.2"><semantics id="A1.SS2.p2.6.m6.2a"><mrow id="A1.SS2.p2.6.m6.2.3" xref="A1.SS2.p2.6.m6.2.3.cmml"><mrow id="A1.SS2.p2.6.m6.2.3.2.2" xref="A1.SS2.p2.6.m6.2.3.2.1.cmml"><mo id="A1.SS2.p2.6.m6.2.3.2.2.1" xref="A1.SS2.p2.6.m6.2.3.2.1.cmml">⟨</mo><mi id="A1.SS2.p2.6.m6.1.1" xref="A1.SS2.p2.6.m6.1.1.cmml">x</mi><mo id="A1.SS2.p2.6.m6.2.3.2.2.2" xref="A1.SS2.p2.6.m6.2.3.2.1.cmml">,</mo><mi id="A1.SS2.p2.6.m6.2.2" xref="A1.SS2.p2.6.m6.2.2.cmml">x</mi><mo id="A1.SS2.p2.6.m6.2.3.2.2.3" xref="A1.SS2.p2.6.m6.2.3.2.1.cmml">⟩</mo></mrow><mo id="A1.SS2.p2.6.m6.2.3.1" xref="A1.SS2.p2.6.m6.2.3.1.cmml">=</mo><mn id="A1.SS2.p2.6.m6.2.3.3" xref="A1.SS2.p2.6.m6.2.3.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.6.m6.2b"><apply id="A1.SS2.p2.6.m6.2.3.cmml" xref="A1.SS2.p2.6.m6.2.3"><eq id="A1.SS2.p2.6.m6.2.3.1.cmml" xref="A1.SS2.p2.6.m6.2.3.1"></eq><list id="A1.SS2.p2.6.m6.2.3.2.1.cmml" xref="A1.SS2.p2.6.m6.2.3.2.2"><ci id="A1.SS2.p2.6.m6.1.1.cmml" xref="A1.SS2.p2.6.m6.1.1">𝑥</ci><ci id="A1.SS2.p2.6.m6.2.2.cmml" xref="A1.SS2.p2.6.m6.2.2">𝑥</ci></list><cn id="A1.SS2.p2.6.m6.2.3.3.cmml" type="integer" xref="A1.SS2.p2.6.m6.2.3.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.6.m6.2c">\left\langle x,x\right\rangle=1</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p2.6.m6.2d">⟨ italic_x , italic_x ⟩ = 1</annotation></semantics></math>, so we set the diagonal element <math alttext="\mathcal{S}_{\delta|i,i}\fallingdotseq 0" class="ltx_Math" display="inline" id="A1.SS2.p2.7.m7.2"><semantics id="A1.SS2.p2.7.m7.2a"><mrow id="A1.SS2.p2.7.m7.2.3" xref="A1.SS2.p2.7.m7.2.3.cmml"><msub id="A1.SS2.p2.7.m7.2.3.2" xref="A1.SS2.p2.7.m7.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS2.p2.7.m7.2.3.2.2" xref="A1.SS2.p2.7.m7.2.3.2.2.cmml">𝒮</mi><mrow id="A1.SS2.p2.7.m7.2.2.2" xref="A1.SS2.p2.7.m7.2.2.2.cmml"><mi id="A1.SS2.p2.7.m7.2.2.2.4" xref="A1.SS2.p2.7.m7.2.2.2.4.cmml">δ</mi><mo fence="false" id="A1.SS2.p2.7.m7.2.2.2.3" xref="A1.SS2.p2.7.m7.2.2.2.3.cmml">|</mo><mrow id="A1.SS2.p2.7.m7.2.2.2.5.2" xref="A1.SS2.p2.7.m7.2.2.2.5.1.cmml"><mi id="A1.SS2.p2.7.m7.1.1.1.1" xref="A1.SS2.p2.7.m7.1.1.1.1.cmml">i</mi><mo id="A1.SS2.p2.7.m7.2.2.2.5.2.1" xref="A1.SS2.p2.7.m7.2.2.2.5.1.cmml">,</mo><mi id="A1.SS2.p2.7.m7.2.2.2.2" xref="A1.SS2.p2.7.m7.2.2.2.2.cmml">i</mi></mrow></mrow></msub><mo id="A1.SS2.p2.7.m7.2.3.1" xref="A1.SS2.p2.7.m7.2.3.1.cmml">≒</mo><mn id="A1.SS2.p2.7.m7.2.3.3" xref="A1.SS2.p2.7.m7.2.3.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.7.m7.2b"><apply id="A1.SS2.p2.7.m7.2.3.cmml" xref="A1.SS2.p2.7.m7.2.3"><csymbol cd="latexml" id="A1.SS2.p2.7.m7.2.3.1.cmml" xref="A1.SS2.p2.7.m7.2.3.1">approximately-equals-or-image-of</csymbol><apply id="A1.SS2.p2.7.m7.2.3.2.cmml" xref="A1.SS2.p2.7.m7.2.3.2"><csymbol cd="ambiguous" id="A1.SS2.p2.7.m7.2.3.2.1.cmml" xref="A1.SS2.p2.7.m7.2.3.2">subscript</csymbol><ci id="A1.SS2.p2.7.m7.2.3.2.2.cmml" xref="A1.SS2.p2.7.m7.2.3.2.2">𝒮</ci><apply id="A1.SS2.p2.7.m7.2.2.2.cmml" xref="A1.SS2.p2.7.m7.2.2.2"><csymbol cd="latexml" id="A1.SS2.p2.7.m7.2.2.2.3.cmml" xref="A1.SS2.p2.7.m7.2.2.2.3">conditional</csymbol><ci id="A1.SS2.p2.7.m7.2.2.2.4.cmml" xref="A1.SS2.p2.7.m7.2.2.2.4">𝛿</ci><list id="A1.SS2.p2.7.m7.2.2.2.5.1.cmml" xref="A1.SS2.p2.7.m7.2.2.2.5.2"><ci id="A1.SS2.p2.7.m7.1.1.1.1.cmml" xref="A1.SS2.p2.7.m7.1.1.1.1">𝑖</ci><ci id="A1.SS2.p2.7.m7.2.2.2.2.cmml" xref="A1.SS2.p2.7.m7.2.2.2.2">𝑖</ci></list></apply></apply><cn id="A1.SS2.p2.7.m7.2.3.3.cmml" type="integer" xref="A1.SS2.p2.7.m7.2.3.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.7.m7.2c">\mathcal{S}_{\delta|i,i}\fallingdotseq 0</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p2.7.m7.2d">caligraphic_S start_POSTSUBSCRIPT italic_δ | italic_i , italic_i end_POSTSUBSCRIPT ≒ 0</annotation></semantics></math> since they are trivial values.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS2.p3">
<p class="ltx_p" id="A1.SS2.p3.11">Given two encoding <math alttext="\delta_{1}" class="ltx_Math" display="inline" id="A1.SS2.p3.1.m1.1"><semantics id="A1.SS2.p3.1.m1.1a"><msub id="A1.SS2.p3.1.m1.1.1" xref="A1.SS2.p3.1.m1.1.1.cmml"><mi id="A1.SS2.p3.1.m1.1.1.2" xref="A1.SS2.p3.1.m1.1.1.2.cmml">δ</mi><mn id="A1.SS2.p3.1.m1.1.1.3" xref="A1.SS2.p3.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.1.m1.1b"><apply id="A1.SS2.p3.1.m1.1.1.cmml" xref="A1.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p3.1.m1.1.1.1.cmml" xref="A1.SS2.p3.1.m1.1.1">subscript</csymbol><ci id="A1.SS2.p3.1.m1.1.1.2.cmml" xref="A1.SS2.p3.1.m1.1.1.2">𝛿</ci><cn id="A1.SS2.p3.1.m1.1.1.3.cmml" type="integer" xref="A1.SS2.p3.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.1.m1.1c">\delta_{1}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.1.m1.1d">italic_δ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\delta_{2}" class="ltx_Math" display="inline" id="A1.SS2.p3.2.m2.1"><semantics id="A1.SS2.p3.2.m2.1a"><msub id="A1.SS2.p3.2.m2.1.1" xref="A1.SS2.p3.2.m2.1.1.cmml"><mi id="A1.SS2.p3.2.m2.1.1.2" xref="A1.SS2.p3.2.m2.1.1.2.cmml">δ</mi><mn id="A1.SS2.p3.2.m2.1.1.3" xref="A1.SS2.p3.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.2.m2.1b"><apply id="A1.SS2.p3.2.m2.1.1.cmml" xref="A1.SS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS2.p3.2.m2.1.1.1.cmml" xref="A1.SS2.p3.2.m2.1.1">subscript</csymbol><ci id="A1.SS2.p3.2.m2.1.1.2.cmml" xref="A1.SS2.p3.2.m2.1.1.2">𝛿</ci><cn id="A1.SS2.p3.2.m2.1.1.3.cmml" type="integer" xref="A1.SS2.p3.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.2.m2.1c">\delta_{2}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.2.m2.1d">italic_δ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, two similarity map can be calculated as <math alttext="\mathcal{S}_{\delta_{1}}" class="ltx_Math" display="inline" id="A1.SS2.p3.3.m3.1"><semantics id="A1.SS2.p3.3.m3.1a"><msub id="A1.SS2.p3.3.m3.1.1" xref="A1.SS2.p3.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS2.p3.3.m3.1.1.2" xref="A1.SS2.p3.3.m3.1.1.2.cmml">𝒮</mi><msub id="A1.SS2.p3.3.m3.1.1.3" xref="A1.SS2.p3.3.m3.1.1.3.cmml"><mi id="A1.SS2.p3.3.m3.1.1.3.2" xref="A1.SS2.p3.3.m3.1.1.3.2.cmml">δ</mi><mn id="A1.SS2.p3.3.m3.1.1.3.3" xref="A1.SS2.p3.3.m3.1.1.3.3.cmml">1</mn></msub></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.3.m3.1b"><apply id="A1.SS2.p3.3.m3.1.1.cmml" xref="A1.SS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="A1.SS2.p3.3.m3.1.1.1.cmml" xref="A1.SS2.p3.3.m3.1.1">subscript</csymbol><ci id="A1.SS2.p3.3.m3.1.1.2.cmml" xref="A1.SS2.p3.3.m3.1.1.2">𝒮</ci><apply id="A1.SS2.p3.3.m3.1.1.3.cmml" xref="A1.SS2.p3.3.m3.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.p3.3.m3.1.1.3.1.cmml" xref="A1.SS2.p3.3.m3.1.1.3">subscript</csymbol><ci id="A1.SS2.p3.3.m3.1.1.3.2.cmml" xref="A1.SS2.p3.3.m3.1.1.3.2">𝛿</ci><cn id="A1.SS2.p3.3.m3.1.1.3.3.cmml" type="integer" xref="A1.SS2.p3.3.m3.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.3.m3.1c">\mathcal{S}_{\delta_{1}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.3.m3.1d">caligraphic_S start_POSTSUBSCRIPT italic_δ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathcal{S}_{\delta_{2}}" class="ltx_Math" display="inline" id="A1.SS2.p3.4.m4.1"><semantics id="A1.SS2.p3.4.m4.1a"><msub id="A1.SS2.p3.4.m4.1.1" xref="A1.SS2.p3.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS2.p3.4.m4.1.1.2" xref="A1.SS2.p3.4.m4.1.1.2.cmml">𝒮</mi><msub id="A1.SS2.p3.4.m4.1.1.3" xref="A1.SS2.p3.4.m4.1.1.3.cmml"><mi id="A1.SS2.p3.4.m4.1.1.3.2" xref="A1.SS2.p3.4.m4.1.1.3.2.cmml">δ</mi><mn id="A1.SS2.p3.4.m4.1.1.3.3" xref="A1.SS2.p3.4.m4.1.1.3.3.cmml">2</mn></msub></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.4.m4.1b"><apply id="A1.SS2.p3.4.m4.1.1.cmml" xref="A1.SS2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="A1.SS2.p3.4.m4.1.1.1.cmml" xref="A1.SS2.p3.4.m4.1.1">subscript</csymbol><ci id="A1.SS2.p3.4.m4.1.1.2.cmml" xref="A1.SS2.p3.4.m4.1.1.2">𝒮</ci><apply id="A1.SS2.p3.4.m4.1.1.3.cmml" xref="A1.SS2.p3.4.m4.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.p3.4.m4.1.1.3.1.cmml" xref="A1.SS2.p3.4.m4.1.1.3">subscript</csymbol><ci id="A1.SS2.p3.4.m4.1.1.3.2.cmml" xref="A1.SS2.p3.4.m4.1.1.3.2">𝛿</ci><cn id="A1.SS2.p3.4.m4.1.1.3.3.cmml" type="integer" xref="A1.SS2.p3.4.m4.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.4.m4.1c">\mathcal{S}_{\delta_{2}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.4.m4.1d">caligraphic_S start_POSTSUBSCRIPT italic_δ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> on the same object set <math alttext="\mathcal{X}" class="ltx_Math" display="inline" id="A1.SS2.p3.5.m5.1"><semantics id="A1.SS2.p3.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="A1.SS2.p3.5.m5.1.1" xref="A1.SS2.p3.5.m5.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.5.m5.1b"><ci id="A1.SS2.p3.5.m5.1.1.cmml" xref="A1.SS2.p3.5.m5.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.5.m5.1c">\mathcal{X}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.5.m5.1d">caligraphic_X</annotation></semantics></math>. For each line vector index <math alttext="i=1,2,\dots,n" class="ltx_Math" display="inline" id="A1.SS2.p3.6.m6.4"><semantics id="A1.SS2.p3.6.m6.4a"><mrow id="A1.SS2.p3.6.m6.4.5" xref="A1.SS2.p3.6.m6.4.5.cmml"><mi id="A1.SS2.p3.6.m6.4.5.2" xref="A1.SS2.p3.6.m6.4.5.2.cmml">i</mi><mo id="A1.SS2.p3.6.m6.4.5.1" xref="A1.SS2.p3.6.m6.4.5.1.cmml">=</mo><mrow id="A1.SS2.p3.6.m6.4.5.3.2" xref="A1.SS2.p3.6.m6.4.5.3.1.cmml"><mn id="A1.SS2.p3.6.m6.1.1" xref="A1.SS2.p3.6.m6.1.1.cmml">1</mn><mo id="A1.SS2.p3.6.m6.4.5.3.2.1" xref="A1.SS2.p3.6.m6.4.5.3.1.cmml">,</mo><mn id="A1.SS2.p3.6.m6.2.2" xref="A1.SS2.p3.6.m6.2.2.cmml">2</mn><mo id="A1.SS2.p3.6.m6.4.5.3.2.2" xref="A1.SS2.p3.6.m6.4.5.3.1.cmml">,</mo><mi id="A1.SS2.p3.6.m6.3.3" mathvariant="normal" xref="A1.SS2.p3.6.m6.3.3.cmml">…</mi><mo id="A1.SS2.p3.6.m6.4.5.3.2.3" xref="A1.SS2.p3.6.m6.4.5.3.1.cmml">,</mo><mi id="A1.SS2.p3.6.m6.4.4" xref="A1.SS2.p3.6.m6.4.4.cmml">n</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.6.m6.4b"><apply id="A1.SS2.p3.6.m6.4.5.cmml" xref="A1.SS2.p3.6.m6.4.5"><eq id="A1.SS2.p3.6.m6.4.5.1.cmml" xref="A1.SS2.p3.6.m6.4.5.1"></eq><ci id="A1.SS2.p3.6.m6.4.5.2.cmml" xref="A1.SS2.p3.6.m6.4.5.2">𝑖</ci><list id="A1.SS2.p3.6.m6.4.5.3.1.cmml" xref="A1.SS2.p3.6.m6.4.5.3.2"><cn id="A1.SS2.p3.6.m6.1.1.cmml" type="integer" xref="A1.SS2.p3.6.m6.1.1">1</cn><cn id="A1.SS2.p3.6.m6.2.2.cmml" type="integer" xref="A1.SS2.p3.6.m6.2.2">2</cn><ci id="A1.SS2.p3.6.m6.3.3.cmml" xref="A1.SS2.p3.6.m6.3.3">…</ci><ci id="A1.SS2.p3.6.m6.4.4.cmml" xref="A1.SS2.p3.6.m6.4.4">𝑛</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.6.m6.4c">i=1,2,\dots,n</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.6.m6.4d">italic_i = 1 , 2 , … , italic_n</annotation></semantics></math> in <math alttext="\mathcal{S}_{\delta_{1}}" class="ltx_Math" display="inline" id="A1.SS2.p3.7.m7.1"><semantics id="A1.SS2.p3.7.m7.1a"><msub id="A1.SS2.p3.7.m7.1.1" xref="A1.SS2.p3.7.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS2.p3.7.m7.1.1.2" xref="A1.SS2.p3.7.m7.1.1.2.cmml">𝒮</mi><msub id="A1.SS2.p3.7.m7.1.1.3" xref="A1.SS2.p3.7.m7.1.1.3.cmml"><mi id="A1.SS2.p3.7.m7.1.1.3.2" xref="A1.SS2.p3.7.m7.1.1.3.2.cmml">δ</mi><mn id="A1.SS2.p3.7.m7.1.1.3.3" xref="A1.SS2.p3.7.m7.1.1.3.3.cmml">1</mn></msub></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.7.m7.1b"><apply id="A1.SS2.p3.7.m7.1.1.cmml" xref="A1.SS2.p3.7.m7.1.1"><csymbol cd="ambiguous" id="A1.SS2.p3.7.m7.1.1.1.cmml" xref="A1.SS2.p3.7.m7.1.1">subscript</csymbol><ci id="A1.SS2.p3.7.m7.1.1.2.cmml" xref="A1.SS2.p3.7.m7.1.1.2">𝒮</ci><apply id="A1.SS2.p3.7.m7.1.1.3.cmml" xref="A1.SS2.p3.7.m7.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.p3.7.m7.1.1.3.1.cmml" xref="A1.SS2.p3.7.m7.1.1.3">subscript</csymbol><ci id="A1.SS2.p3.7.m7.1.1.3.2.cmml" xref="A1.SS2.p3.7.m7.1.1.3.2">𝛿</ci><cn id="A1.SS2.p3.7.m7.1.1.3.3.cmml" type="integer" xref="A1.SS2.p3.7.m7.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.7.m7.1c">\mathcal{S}_{\delta_{1}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.7.m7.1d">caligraphic_S start_POSTSUBSCRIPT italic_δ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>, we select the index of top-<math alttext="k" class="ltx_Math" display="inline" id="A1.SS2.p3.8.m8.1"><semantics id="A1.SS2.p3.8.m8.1a"><mi id="A1.SS2.p3.8.m8.1.1" xref="A1.SS2.p3.8.m8.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.8.m8.1b"><ci id="A1.SS2.p3.8.m8.1.1.cmml" xref="A1.SS2.p3.8.m8.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.8.m8.1c">k</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.8.m8.1d">italic_k</annotation></semantics></math> elements from greater to lower as <math alttext="\mathrm{top}_{k}\left(\mathcal{S}_{\delta_{1}|i}\right)" class="ltx_Math" display="inline" id="A1.SS2.p3.9.m9.1"><semantics id="A1.SS2.p3.9.m9.1a"><mrow id="A1.SS2.p3.9.m9.1.1" xref="A1.SS2.p3.9.m9.1.1.cmml"><msub id="A1.SS2.p3.9.m9.1.1.3" xref="A1.SS2.p3.9.m9.1.1.3.cmml"><mi id="A1.SS2.p3.9.m9.1.1.3.2" xref="A1.SS2.p3.9.m9.1.1.3.2.cmml">top</mi><mi id="A1.SS2.p3.9.m9.1.1.3.3" xref="A1.SS2.p3.9.m9.1.1.3.3.cmml">k</mi></msub><mo id="A1.SS2.p3.9.m9.1.1.2" xref="A1.SS2.p3.9.m9.1.1.2.cmml">⁢</mo><mrow id="A1.SS2.p3.9.m9.1.1.1.1" xref="A1.SS2.p3.9.m9.1.1.1.1.1.cmml"><mo id="A1.SS2.p3.9.m9.1.1.1.1.2" xref="A1.SS2.p3.9.m9.1.1.1.1.1.cmml">(</mo><msub id="A1.SS2.p3.9.m9.1.1.1.1.1" xref="A1.SS2.p3.9.m9.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS2.p3.9.m9.1.1.1.1.1.2" xref="A1.SS2.p3.9.m9.1.1.1.1.1.2.cmml">𝒮</mi><mrow id="A1.SS2.p3.9.m9.1.1.1.1.1.3" xref="A1.SS2.p3.9.m9.1.1.1.1.1.3.cmml"><msub id="A1.SS2.p3.9.m9.1.1.1.1.1.3.2" xref="A1.SS2.p3.9.m9.1.1.1.1.1.3.2.cmml"><mi id="A1.SS2.p3.9.m9.1.1.1.1.1.3.2.2" xref="A1.SS2.p3.9.m9.1.1.1.1.1.3.2.2.cmml">δ</mi><mn id="A1.SS2.p3.9.m9.1.1.1.1.1.3.2.3" xref="A1.SS2.p3.9.m9.1.1.1.1.1.3.2.3.cmml">1</mn></msub><mo fence="false" id="A1.SS2.p3.9.m9.1.1.1.1.1.3.1" xref="A1.SS2.p3.9.m9.1.1.1.1.1.3.1.cmml">|</mo><mi id="A1.SS2.p3.9.m9.1.1.1.1.1.3.3" xref="A1.SS2.p3.9.m9.1.1.1.1.1.3.3.cmml">i</mi></mrow></msub><mo id="A1.SS2.p3.9.m9.1.1.1.1.3" xref="A1.SS2.p3.9.m9.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.9.m9.1b"><apply id="A1.SS2.p3.9.m9.1.1.cmml" xref="A1.SS2.p3.9.m9.1.1"><times id="A1.SS2.p3.9.m9.1.1.2.cmml" xref="A1.SS2.p3.9.m9.1.1.2"></times><apply id="A1.SS2.p3.9.m9.1.1.3.cmml" xref="A1.SS2.p3.9.m9.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.p3.9.m9.1.1.3.1.cmml" xref="A1.SS2.p3.9.m9.1.1.3">subscript</csymbol><ci id="A1.SS2.p3.9.m9.1.1.3.2.cmml" xref="A1.SS2.p3.9.m9.1.1.3.2">top</ci><ci id="A1.SS2.p3.9.m9.1.1.3.3.cmml" xref="A1.SS2.p3.9.m9.1.1.3.3">𝑘</ci></apply><apply id="A1.SS2.p3.9.m9.1.1.1.1.1.cmml" xref="A1.SS2.p3.9.m9.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p3.9.m9.1.1.1.1.1.1.cmml" xref="A1.SS2.p3.9.m9.1.1.1.1">subscript</csymbol><ci id="A1.SS2.p3.9.m9.1.1.1.1.1.2.cmml" xref="A1.SS2.p3.9.m9.1.1.1.1.1.2">𝒮</ci><apply id="A1.SS2.p3.9.m9.1.1.1.1.1.3.cmml" xref="A1.SS2.p3.9.m9.1.1.1.1.1.3"><csymbol cd="latexml" id="A1.SS2.p3.9.m9.1.1.1.1.1.3.1.cmml" xref="A1.SS2.p3.9.m9.1.1.1.1.1.3.1">conditional</csymbol><apply id="A1.SS2.p3.9.m9.1.1.1.1.1.3.2.cmml" xref="A1.SS2.p3.9.m9.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.SS2.p3.9.m9.1.1.1.1.1.3.2.1.cmml" xref="A1.SS2.p3.9.m9.1.1.1.1.1.3.2">subscript</csymbol><ci id="A1.SS2.p3.9.m9.1.1.1.1.1.3.2.2.cmml" xref="A1.SS2.p3.9.m9.1.1.1.1.1.3.2.2">𝛿</ci><cn id="A1.SS2.p3.9.m9.1.1.1.1.1.3.2.3.cmml" type="integer" xref="A1.SS2.p3.9.m9.1.1.1.1.1.3.2.3">1</cn></apply><ci id="A1.SS2.p3.9.m9.1.1.1.1.1.3.3.cmml" xref="A1.SS2.p3.9.m9.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.9.m9.1c">\mathrm{top}_{k}\left(\mathcal{S}_{\delta_{1}|i}\right)</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.9.m9.1d">roman_top start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ( caligraphic_S start_POSTSUBSCRIPT italic_δ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT | italic_i end_POSTSUBSCRIPT )</annotation></semantics></math>. Similarly, we get <math alttext="\mathrm{top}_{k}\left(\mathcal{S}_{\delta_{2}|i}\right)" class="ltx_Math" display="inline" id="A1.SS2.p3.10.m10.1"><semantics id="A1.SS2.p3.10.m10.1a"><mrow id="A1.SS2.p3.10.m10.1.1" xref="A1.SS2.p3.10.m10.1.1.cmml"><msub id="A1.SS2.p3.10.m10.1.1.3" xref="A1.SS2.p3.10.m10.1.1.3.cmml"><mi id="A1.SS2.p3.10.m10.1.1.3.2" xref="A1.SS2.p3.10.m10.1.1.3.2.cmml">top</mi><mi id="A1.SS2.p3.10.m10.1.1.3.3" xref="A1.SS2.p3.10.m10.1.1.3.3.cmml">k</mi></msub><mo id="A1.SS2.p3.10.m10.1.1.2" xref="A1.SS2.p3.10.m10.1.1.2.cmml">⁢</mo><mrow id="A1.SS2.p3.10.m10.1.1.1.1" xref="A1.SS2.p3.10.m10.1.1.1.1.1.cmml"><mo id="A1.SS2.p3.10.m10.1.1.1.1.2" xref="A1.SS2.p3.10.m10.1.1.1.1.1.cmml">(</mo><msub id="A1.SS2.p3.10.m10.1.1.1.1.1" xref="A1.SS2.p3.10.m10.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS2.p3.10.m10.1.1.1.1.1.2" xref="A1.SS2.p3.10.m10.1.1.1.1.1.2.cmml">𝒮</mi><mrow id="A1.SS2.p3.10.m10.1.1.1.1.1.3" xref="A1.SS2.p3.10.m10.1.1.1.1.1.3.cmml"><msub id="A1.SS2.p3.10.m10.1.1.1.1.1.3.2" xref="A1.SS2.p3.10.m10.1.1.1.1.1.3.2.cmml"><mi id="A1.SS2.p3.10.m10.1.1.1.1.1.3.2.2" xref="A1.SS2.p3.10.m10.1.1.1.1.1.3.2.2.cmml">δ</mi><mn id="A1.SS2.p3.10.m10.1.1.1.1.1.3.2.3" xref="A1.SS2.p3.10.m10.1.1.1.1.1.3.2.3.cmml">2</mn></msub><mo fence="false" id="A1.SS2.p3.10.m10.1.1.1.1.1.3.1" xref="A1.SS2.p3.10.m10.1.1.1.1.1.3.1.cmml">|</mo><mi id="A1.SS2.p3.10.m10.1.1.1.1.1.3.3" xref="A1.SS2.p3.10.m10.1.1.1.1.1.3.3.cmml">i</mi></mrow></msub><mo id="A1.SS2.p3.10.m10.1.1.1.1.3" xref="A1.SS2.p3.10.m10.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.10.m10.1b"><apply id="A1.SS2.p3.10.m10.1.1.cmml" xref="A1.SS2.p3.10.m10.1.1"><times id="A1.SS2.p3.10.m10.1.1.2.cmml" xref="A1.SS2.p3.10.m10.1.1.2"></times><apply id="A1.SS2.p3.10.m10.1.1.3.cmml" xref="A1.SS2.p3.10.m10.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.p3.10.m10.1.1.3.1.cmml" xref="A1.SS2.p3.10.m10.1.1.3">subscript</csymbol><ci id="A1.SS2.p3.10.m10.1.1.3.2.cmml" xref="A1.SS2.p3.10.m10.1.1.3.2">top</ci><ci id="A1.SS2.p3.10.m10.1.1.3.3.cmml" xref="A1.SS2.p3.10.m10.1.1.3.3">𝑘</ci></apply><apply id="A1.SS2.p3.10.m10.1.1.1.1.1.cmml" xref="A1.SS2.p3.10.m10.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p3.10.m10.1.1.1.1.1.1.cmml" xref="A1.SS2.p3.10.m10.1.1.1.1">subscript</csymbol><ci id="A1.SS2.p3.10.m10.1.1.1.1.1.2.cmml" xref="A1.SS2.p3.10.m10.1.1.1.1.1.2">𝒮</ci><apply id="A1.SS2.p3.10.m10.1.1.1.1.1.3.cmml" xref="A1.SS2.p3.10.m10.1.1.1.1.1.3"><csymbol cd="latexml" id="A1.SS2.p3.10.m10.1.1.1.1.1.3.1.cmml" xref="A1.SS2.p3.10.m10.1.1.1.1.1.3.1">conditional</csymbol><apply id="A1.SS2.p3.10.m10.1.1.1.1.1.3.2.cmml" xref="A1.SS2.p3.10.m10.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.SS2.p3.10.m10.1.1.1.1.1.3.2.1.cmml" xref="A1.SS2.p3.10.m10.1.1.1.1.1.3.2">subscript</csymbol><ci id="A1.SS2.p3.10.m10.1.1.1.1.1.3.2.2.cmml" xref="A1.SS2.p3.10.m10.1.1.1.1.1.3.2.2">𝛿</ci><cn id="A1.SS2.p3.10.m10.1.1.1.1.1.3.2.3.cmml" type="integer" xref="A1.SS2.p3.10.m10.1.1.1.1.1.3.2.3">2</cn></apply><ci id="A1.SS2.p3.10.m10.1.1.1.1.1.3.3.cmml" xref="A1.SS2.p3.10.m10.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.10.m10.1c">\mathrm{top}_{k}\left(\mathcal{S}_{\delta_{2}|i}\right)</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.10.m10.1d">roman_top start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ( caligraphic_S start_POSTSUBSCRIPT italic_δ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT | italic_i end_POSTSUBSCRIPT )</annotation></semantics></math> from <math alttext="\mathcal{S}_{\delta_{2}}" class="ltx_Math" display="inline" id="A1.SS2.p3.11.m11.1"><semantics id="A1.SS2.p3.11.m11.1a"><msub id="A1.SS2.p3.11.m11.1.1" xref="A1.SS2.p3.11.m11.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS2.p3.11.m11.1.1.2" xref="A1.SS2.p3.11.m11.1.1.2.cmml">𝒮</mi><msub id="A1.SS2.p3.11.m11.1.1.3" xref="A1.SS2.p3.11.m11.1.1.3.cmml"><mi id="A1.SS2.p3.11.m11.1.1.3.2" xref="A1.SS2.p3.11.m11.1.1.3.2.cmml">δ</mi><mn id="A1.SS2.p3.11.m11.1.1.3.3" xref="A1.SS2.p3.11.m11.1.1.3.3.cmml">2</mn></msub></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.11.m11.1b"><apply id="A1.SS2.p3.11.m11.1.1.cmml" xref="A1.SS2.p3.11.m11.1.1"><csymbol cd="ambiguous" id="A1.SS2.p3.11.m11.1.1.1.cmml" xref="A1.SS2.p3.11.m11.1.1">subscript</csymbol><ci id="A1.SS2.p3.11.m11.1.1.2.cmml" xref="A1.SS2.p3.11.m11.1.1.2">𝒮</ci><apply id="A1.SS2.p3.11.m11.1.1.3.cmml" xref="A1.SS2.p3.11.m11.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.p3.11.m11.1.1.3.1.cmml" xref="A1.SS2.p3.11.m11.1.1.3">subscript</csymbol><ci id="A1.SS2.p3.11.m11.1.1.3.2.cmml" xref="A1.SS2.p3.11.m11.1.1.3.2">𝛿</ci><cn id="A1.SS2.p3.11.m11.1.1.3.3.cmml" type="integer" xref="A1.SS2.p3.11.m11.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.11.m11.1c">\mathcal{S}_{\delta_{2}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.11.m11.1d">caligraphic_S start_POSTSUBSCRIPT italic_δ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS2.p4">
<p class="ltx_p" id="A1.SS2.p4.1">Then, we calculate the kernel alignment for sample <math alttext="i" class="ltx_Math" display="inline" id="A1.SS2.p4.1.m1.1"><semantics id="A1.SS2.p4.1.m1.1a"><mi id="A1.SS2.p4.1.m1.1.1" xref="A1.SS2.p4.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p4.1.m1.1b"><ci id="A1.SS2.p4.1.m1.1.1.cmml" xref="A1.SS2.p4.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p4.1.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p4.1.m1.1d">italic_i</annotation></semantics></math> as:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="A1.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathrm{KA}_{\mathcal{X}}(\delta_{1},\delta_{2})_{i}=\frac{\left|\mathrm{top}_%
{k}\left(\mathcal{S}_{\delta_{1}|i}\right)\cap\mathrm{top}_{k}\left(\mathcal{S%
}_{\delta_{2}|i}\right)\right|}{k}." class="ltx_Math" display="block" id="A1.E2.m1.2"><semantics id="A1.E2.m1.2a"><mrow id="A1.E2.m1.2.2.1" xref="A1.E2.m1.2.2.1.1.cmml"><mrow id="A1.E2.m1.2.2.1.1" xref="A1.E2.m1.2.2.1.1.cmml"><mrow id="A1.E2.m1.2.2.1.1.2" xref="A1.E2.m1.2.2.1.1.2.cmml"><msub id="A1.E2.m1.2.2.1.1.2.4" xref="A1.E2.m1.2.2.1.1.2.4.cmml"><mi id="A1.E2.m1.2.2.1.1.2.4.2" xref="A1.E2.m1.2.2.1.1.2.4.2.cmml">KA</mi><mi class="ltx_font_mathcaligraphic" id="A1.E2.m1.2.2.1.1.2.4.3" xref="A1.E2.m1.2.2.1.1.2.4.3.cmml">𝒳</mi></msub><mo id="A1.E2.m1.2.2.1.1.2.3" xref="A1.E2.m1.2.2.1.1.2.3.cmml">⁢</mo><msub id="A1.E2.m1.2.2.1.1.2.2" xref="A1.E2.m1.2.2.1.1.2.2.cmml"><mrow id="A1.E2.m1.2.2.1.1.2.2.2.2" xref="A1.E2.m1.2.2.1.1.2.2.2.3.cmml"><mo id="A1.E2.m1.2.2.1.1.2.2.2.2.3" stretchy="false" xref="A1.E2.m1.2.2.1.1.2.2.2.3.cmml">(</mo><msub id="A1.E2.m1.2.2.1.1.1.1.1.1.1" xref="A1.E2.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="A1.E2.m1.2.2.1.1.1.1.1.1.1.2" xref="A1.E2.m1.2.2.1.1.1.1.1.1.1.2.cmml">δ</mi><mn id="A1.E2.m1.2.2.1.1.1.1.1.1.1.3" xref="A1.E2.m1.2.2.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="A1.E2.m1.2.2.1.1.2.2.2.2.4" xref="A1.E2.m1.2.2.1.1.2.2.2.3.cmml">,</mo><msub id="A1.E2.m1.2.2.1.1.2.2.2.2.2" xref="A1.E2.m1.2.2.1.1.2.2.2.2.2.cmml"><mi id="A1.E2.m1.2.2.1.1.2.2.2.2.2.2" xref="A1.E2.m1.2.2.1.1.2.2.2.2.2.2.cmml">δ</mi><mn id="A1.E2.m1.2.2.1.1.2.2.2.2.2.3" xref="A1.E2.m1.2.2.1.1.2.2.2.2.2.3.cmml">2</mn></msub><mo id="A1.E2.m1.2.2.1.1.2.2.2.2.5" stretchy="false" xref="A1.E2.m1.2.2.1.1.2.2.2.3.cmml">)</mo></mrow><mi id="A1.E2.m1.2.2.1.1.2.2.4" xref="A1.E2.m1.2.2.1.1.2.2.4.cmml">i</mi></msub></mrow><mo id="A1.E2.m1.2.2.1.1.3" xref="A1.E2.m1.2.2.1.1.3.cmml">=</mo><mfrac id="A1.E2.m1.1.1" xref="A1.E2.m1.1.1.cmml"><mrow id="A1.E2.m1.1.1.1.1" xref="A1.E2.m1.1.1.1.2.cmml"><mo id="A1.E2.m1.1.1.1.1.2" xref="A1.E2.m1.1.1.1.2.1.cmml">|</mo><mrow id="A1.E2.m1.1.1.1.1.1" xref="A1.E2.m1.1.1.1.1.1.cmml"><mrow id="A1.E2.m1.1.1.1.1.1.1" xref="A1.E2.m1.1.1.1.1.1.1.cmml"><msub id="A1.E2.m1.1.1.1.1.1.1.3" xref="A1.E2.m1.1.1.1.1.1.1.3.cmml"><mi id="A1.E2.m1.1.1.1.1.1.1.3.2" xref="A1.E2.m1.1.1.1.1.1.1.3.2.cmml">top</mi><mi id="A1.E2.m1.1.1.1.1.1.1.3.3" xref="A1.E2.m1.1.1.1.1.1.1.3.3.cmml">k</mi></msub><mo id="A1.E2.m1.1.1.1.1.1.1.2" xref="A1.E2.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E2.m1.1.1.1.1.1.1.1.1" xref="A1.E2.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E2.m1.1.1.1.1.1.1.1.1.2" xref="A1.E2.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A1.E2.m1.1.1.1.1.1.1.1.1.1" xref="A1.E2.m1.1.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E2.m1.1.1.1.1.1.1.1.1.1.2" xref="A1.E2.m1.1.1.1.1.1.1.1.1.1.2.cmml">𝒮</mi><mrow id="A1.E2.m1.1.1.1.1.1.1.1.1.1.3" xref="A1.E2.m1.1.1.1.1.1.1.1.1.1.3.cmml"><msub id="A1.E2.m1.1.1.1.1.1.1.1.1.1.3.2" xref="A1.E2.m1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="A1.E2.m1.1.1.1.1.1.1.1.1.1.3.2.2" xref="A1.E2.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">δ</mi><mn id="A1.E2.m1.1.1.1.1.1.1.1.1.1.3.2.3" xref="A1.E2.m1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">1</mn></msub><mo fence="false" id="A1.E2.m1.1.1.1.1.1.1.1.1.1.3.1" xref="A1.E2.m1.1.1.1.1.1.1.1.1.1.3.1.cmml">|</mo><mi id="A1.E2.m1.1.1.1.1.1.1.1.1.1.3.3" xref="A1.E2.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></mrow></msub><mo id="A1.E2.m1.1.1.1.1.1.1.1.1.3" xref="A1.E2.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E2.m1.1.1.1.1.1.3" xref="A1.E2.m1.1.1.1.1.1.3.cmml">∩</mo><mrow id="A1.E2.m1.1.1.1.1.1.2" xref="A1.E2.m1.1.1.1.1.1.2.cmml"><msub id="A1.E2.m1.1.1.1.1.1.2.3" xref="A1.E2.m1.1.1.1.1.1.2.3.cmml"><mi id="A1.E2.m1.1.1.1.1.1.2.3.2" xref="A1.E2.m1.1.1.1.1.1.2.3.2.cmml">top</mi><mi id="A1.E2.m1.1.1.1.1.1.2.3.3" xref="A1.E2.m1.1.1.1.1.1.2.3.3.cmml">k</mi></msub><mo id="A1.E2.m1.1.1.1.1.1.2.2" xref="A1.E2.m1.1.1.1.1.1.2.2.cmml">⁢</mo><mrow id="A1.E2.m1.1.1.1.1.1.2.1.1" xref="A1.E2.m1.1.1.1.1.1.2.1.1.1.cmml"><mo id="A1.E2.m1.1.1.1.1.1.2.1.1.2" xref="A1.E2.m1.1.1.1.1.1.2.1.1.1.cmml">(</mo><msub id="A1.E2.m1.1.1.1.1.1.2.1.1.1" xref="A1.E2.m1.1.1.1.1.1.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E2.m1.1.1.1.1.1.2.1.1.1.2" xref="A1.E2.m1.1.1.1.1.1.2.1.1.1.2.cmml">𝒮</mi><mrow id="A1.E2.m1.1.1.1.1.1.2.1.1.1.3" xref="A1.E2.m1.1.1.1.1.1.2.1.1.1.3.cmml"><msub id="A1.E2.m1.1.1.1.1.1.2.1.1.1.3.2" xref="A1.E2.m1.1.1.1.1.1.2.1.1.1.3.2.cmml"><mi id="A1.E2.m1.1.1.1.1.1.2.1.1.1.3.2.2" xref="A1.E2.m1.1.1.1.1.1.2.1.1.1.3.2.2.cmml">δ</mi><mn id="A1.E2.m1.1.1.1.1.1.2.1.1.1.3.2.3" xref="A1.E2.m1.1.1.1.1.1.2.1.1.1.3.2.3.cmml">2</mn></msub><mo fence="false" id="A1.E2.m1.1.1.1.1.1.2.1.1.1.3.1" xref="A1.E2.m1.1.1.1.1.1.2.1.1.1.3.1.cmml">|</mo><mi id="A1.E2.m1.1.1.1.1.1.2.1.1.1.3.3" xref="A1.E2.m1.1.1.1.1.1.2.1.1.1.3.3.cmml">i</mi></mrow></msub><mo id="A1.E2.m1.1.1.1.1.1.2.1.1.3" xref="A1.E2.m1.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E2.m1.1.1.1.1.3" xref="A1.E2.m1.1.1.1.2.1.cmml">|</mo></mrow><mi id="A1.E2.m1.1.1.3" xref="A1.E2.m1.1.1.3.cmml">k</mi></mfrac></mrow><mo id="A1.E2.m1.2.2.1.2" lspace="0em" xref="A1.E2.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E2.m1.2b"><apply id="A1.E2.m1.2.2.1.1.cmml" xref="A1.E2.m1.2.2.1"><eq id="A1.E2.m1.2.2.1.1.3.cmml" xref="A1.E2.m1.2.2.1.1.3"></eq><apply id="A1.E2.m1.2.2.1.1.2.cmml" xref="A1.E2.m1.2.2.1.1.2"><times id="A1.E2.m1.2.2.1.1.2.3.cmml" xref="A1.E2.m1.2.2.1.1.2.3"></times><apply id="A1.E2.m1.2.2.1.1.2.4.cmml" xref="A1.E2.m1.2.2.1.1.2.4"><csymbol cd="ambiguous" id="A1.E2.m1.2.2.1.1.2.4.1.cmml" xref="A1.E2.m1.2.2.1.1.2.4">subscript</csymbol><ci id="A1.E2.m1.2.2.1.1.2.4.2.cmml" xref="A1.E2.m1.2.2.1.1.2.4.2">KA</ci><ci id="A1.E2.m1.2.2.1.1.2.4.3.cmml" xref="A1.E2.m1.2.2.1.1.2.4.3">𝒳</ci></apply><apply id="A1.E2.m1.2.2.1.1.2.2.cmml" xref="A1.E2.m1.2.2.1.1.2.2"><csymbol cd="ambiguous" id="A1.E2.m1.2.2.1.1.2.2.3.cmml" xref="A1.E2.m1.2.2.1.1.2.2">subscript</csymbol><interval closure="open" id="A1.E2.m1.2.2.1.1.2.2.2.3.cmml" xref="A1.E2.m1.2.2.1.1.2.2.2.2"><apply id="A1.E2.m1.2.2.1.1.1.1.1.1.1.cmml" xref="A1.E2.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E2.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="A1.E2.m1.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E2.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="A1.E2.m1.2.2.1.1.1.1.1.1.1.2">𝛿</ci><cn id="A1.E2.m1.2.2.1.1.1.1.1.1.1.3.cmml" type="integer" xref="A1.E2.m1.2.2.1.1.1.1.1.1.1.3">1</cn></apply><apply id="A1.E2.m1.2.2.1.1.2.2.2.2.2.cmml" xref="A1.E2.m1.2.2.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.E2.m1.2.2.1.1.2.2.2.2.2.1.cmml" xref="A1.E2.m1.2.2.1.1.2.2.2.2.2">subscript</csymbol><ci id="A1.E2.m1.2.2.1.1.2.2.2.2.2.2.cmml" xref="A1.E2.m1.2.2.1.1.2.2.2.2.2.2">𝛿</ci><cn id="A1.E2.m1.2.2.1.1.2.2.2.2.2.3.cmml" type="integer" xref="A1.E2.m1.2.2.1.1.2.2.2.2.2.3">2</cn></apply></interval><ci id="A1.E2.m1.2.2.1.1.2.2.4.cmml" xref="A1.E2.m1.2.2.1.1.2.2.4">𝑖</ci></apply></apply><apply id="A1.E2.m1.1.1.cmml" xref="A1.E2.m1.1.1"><divide id="A1.E2.m1.1.1.2.cmml" xref="A1.E2.m1.1.1"></divide><apply id="A1.E2.m1.1.1.1.2.cmml" xref="A1.E2.m1.1.1.1.1"><abs id="A1.E2.m1.1.1.1.2.1.cmml" xref="A1.E2.m1.1.1.1.1.2"></abs><apply id="A1.E2.m1.1.1.1.1.1.cmml" xref="A1.E2.m1.1.1.1.1.1"><intersect id="A1.E2.m1.1.1.1.1.1.3.cmml" xref="A1.E2.m1.1.1.1.1.1.3"></intersect><apply id="A1.E2.m1.1.1.1.1.1.1.cmml" xref="A1.E2.m1.1.1.1.1.1.1"><times id="A1.E2.m1.1.1.1.1.1.1.2.cmml" xref="A1.E2.m1.1.1.1.1.1.1.2"></times><apply id="A1.E2.m1.1.1.1.1.1.1.3.cmml" xref="A1.E2.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E2.m1.1.1.1.1.1.1.3.1.cmml" xref="A1.E2.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E2.m1.1.1.1.1.1.1.3.2.cmml" xref="A1.E2.m1.1.1.1.1.1.1.3.2">top</ci><ci id="A1.E2.m1.1.1.1.1.1.1.3.3.cmml" xref="A1.E2.m1.1.1.1.1.1.1.3.3">𝑘</ci></apply><apply id="A1.E2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E2.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E2.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E2.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E2.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E2.m1.1.1.1.1.1.1.1.1.1.2">𝒮</ci><apply id="A1.E2.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E2.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="latexml" id="A1.E2.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E2.m1.1.1.1.1.1.1.1.1.1.3.1">conditional</csymbol><apply id="A1.E2.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E2.m1.1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.E2.m1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="A1.E2.m1.1.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="A1.E2.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="A1.E2.m1.1.1.1.1.1.1.1.1.1.3.2.2">𝛿</ci><cn id="A1.E2.m1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" type="integer" xref="A1.E2.m1.1.1.1.1.1.1.1.1.1.3.2.3">1</cn></apply><ci id="A1.E2.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A1.E2.m1.1.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply><apply id="A1.E2.m1.1.1.1.1.1.2.cmml" xref="A1.E2.m1.1.1.1.1.1.2"><times id="A1.E2.m1.1.1.1.1.1.2.2.cmml" xref="A1.E2.m1.1.1.1.1.1.2.2"></times><apply id="A1.E2.m1.1.1.1.1.1.2.3.cmml" xref="A1.E2.m1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A1.E2.m1.1.1.1.1.1.2.3.1.cmml" xref="A1.E2.m1.1.1.1.1.1.2.3">subscript</csymbol><ci id="A1.E2.m1.1.1.1.1.1.2.3.2.cmml" xref="A1.E2.m1.1.1.1.1.1.2.3.2">top</ci><ci id="A1.E2.m1.1.1.1.1.1.2.3.3.cmml" xref="A1.E2.m1.1.1.1.1.1.2.3.3">𝑘</ci></apply><apply id="A1.E2.m1.1.1.1.1.1.2.1.1.1.cmml" xref="A1.E2.m1.1.1.1.1.1.2.1.1"><csymbol cd="ambiguous" id="A1.E2.m1.1.1.1.1.1.2.1.1.1.1.cmml" xref="A1.E2.m1.1.1.1.1.1.2.1.1">subscript</csymbol><ci id="A1.E2.m1.1.1.1.1.1.2.1.1.1.2.cmml" xref="A1.E2.m1.1.1.1.1.1.2.1.1.1.2">𝒮</ci><apply id="A1.E2.m1.1.1.1.1.1.2.1.1.1.3.cmml" xref="A1.E2.m1.1.1.1.1.1.2.1.1.1.3"><csymbol cd="latexml" id="A1.E2.m1.1.1.1.1.1.2.1.1.1.3.1.cmml" xref="A1.E2.m1.1.1.1.1.1.2.1.1.1.3.1">conditional</csymbol><apply id="A1.E2.m1.1.1.1.1.1.2.1.1.1.3.2.cmml" xref="A1.E2.m1.1.1.1.1.1.2.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.E2.m1.1.1.1.1.1.2.1.1.1.3.2.1.cmml" xref="A1.E2.m1.1.1.1.1.1.2.1.1.1.3.2">subscript</csymbol><ci id="A1.E2.m1.1.1.1.1.1.2.1.1.1.3.2.2.cmml" xref="A1.E2.m1.1.1.1.1.1.2.1.1.1.3.2.2">𝛿</ci><cn id="A1.E2.m1.1.1.1.1.1.2.1.1.1.3.2.3.cmml" type="integer" xref="A1.E2.m1.1.1.1.1.1.2.1.1.1.3.2.3">2</cn></apply><ci id="A1.E2.m1.1.1.1.1.1.2.1.1.1.3.3.cmml" xref="A1.E2.m1.1.1.1.1.1.2.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply><ci id="A1.E2.m1.1.1.3.cmml" xref="A1.E2.m1.1.1.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E2.m1.2c">\mathrm{KA}_{\mathcal{X}}(\delta_{1},\delta_{2})_{i}=\frac{\left|\mathrm{top}_%
{k}\left(\mathcal{S}_{\delta_{1}|i}\right)\cap\mathrm{top}_{k}\left(\mathcal{S%
}_{\delta_{2}|i}\right)\right|}{k}.</annotation><annotation encoding="application/x-llamapun" id="A1.E2.m1.2d">roman_KA start_POSTSUBSCRIPT caligraphic_X end_POSTSUBSCRIPT ( italic_δ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_δ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = divide start_ARG | roman_top start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ( caligraphic_S start_POSTSUBSCRIPT italic_δ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT | italic_i end_POSTSUBSCRIPT ) ∩ roman_top start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ( caligraphic_S start_POSTSUBSCRIPT italic_δ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT | italic_i end_POSTSUBSCRIPT ) | end_ARG start_ARG italic_k end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS2.p4.3">The kernel alignment for dataset <math alttext="\mathcal{X}" class="ltx_Math" display="inline" id="A1.SS2.p4.2.m1.1"><semantics id="A1.SS2.p4.2.m1.1a"><mi class="ltx_font_mathcaligraphic" id="A1.SS2.p4.2.m1.1.1" xref="A1.SS2.p4.2.m1.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p4.2.m1.1b"><ci id="A1.SS2.p4.2.m1.1.1.cmml" xref="A1.SS2.p4.2.m1.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p4.2.m1.1c">\mathcal{X}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p4.2.m1.1d">caligraphic_X</annotation></semantics></math> is the average on each <math alttext="\mathrm{KA}_{\mathcal{X}}(\delta_{1},\delta_{2})_{i}" class="ltx_Math" display="inline" id="A1.SS2.p4.3.m2.2"><semantics id="A1.SS2.p4.3.m2.2a"><mrow id="A1.SS2.p4.3.m2.2.2" xref="A1.SS2.p4.3.m2.2.2.cmml"><msub id="A1.SS2.p4.3.m2.2.2.4" xref="A1.SS2.p4.3.m2.2.2.4.cmml"><mi id="A1.SS2.p4.3.m2.2.2.4.2" xref="A1.SS2.p4.3.m2.2.2.4.2.cmml">KA</mi><mi class="ltx_font_mathcaligraphic" id="A1.SS2.p4.3.m2.2.2.4.3" xref="A1.SS2.p4.3.m2.2.2.4.3.cmml">𝒳</mi></msub><mo id="A1.SS2.p4.3.m2.2.2.3" xref="A1.SS2.p4.3.m2.2.2.3.cmml">⁢</mo><msub id="A1.SS2.p4.3.m2.2.2.2" xref="A1.SS2.p4.3.m2.2.2.2.cmml"><mrow id="A1.SS2.p4.3.m2.2.2.2.2.2" xref="A1.SS2.p4.3.m2.2.2.2.2.3.cmml"><mo id="A1.SS2.p4.3.m2.2.2.2.2.2.3" stretchy="false" xref="A1.SS2.p4.3.m2.2.2.2.2.3.cmml">(</mo><msub id="A1.SS2.p4.3.m2.1.1.1.1.1.1" xref="A1.SS2.p4.3.m2.1.1.1.1.1.1.cmml"><mi id="A1.SS2.p4.3.m2.1.1.1.1.1.1.2" xref="A1.SS2.p4.3.m2.1.1.1.1.1.1.2.cmml">δ</mi><mn id="A1.SS2.p4.3.m2.1.1.1.1.1.1.3" xref="A1.SS2.p4.3.m2.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="A1.SS2.p4.3.m2.2.2.2.2.2.4" xref="A1.SS2.p4.3.m2.2.2.2.2.3.cmml">,</mo><msub id="A1.SS2.p4.3.m2.2.2.2.2.2.2" xref="A1.SS2.p4.3.m2.2.2.2.2.2.2.cmml"><mi id="A1.SS2.p4.3.m2.2.2.2.2.2.2.2" xref="A1.SS2.p4.3.m2.2.2.2.2.2.2.2.cmml">δ</mi><mn id="A1.SS2.p4.3.m2.2.2.2.2.2.2.3" xref="A1.SS2.p4.3.m2.2.2.2.2.2.2.3.cmml">2</mn></msub><mo id="A1.SS2.p4.3.m2.2.2.2.2.2.5" stretchy="false" xref="A1.SS2.p4.3.m2.2.2.2.2.3.cmml">)</mo></mrow><mi id="A1.SS2.p4.3.m2.2.2.2.4" xref="A1.SS2.p4.3.m2.2.2.2.4.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p4.3.m2.2b"><apply id="A1.SS2.p4.3.m2.2.2.cmml" xref="A1.SS2.p4.3.m2.2.2"><times id="A1.SS2.p4.3.m2.2.2.3.cmml" xref="A1.SS2.p4.3.m2.2.2.3"></times><apply id="A1.SS2.p4.3.m2.2.2.4.cmml" xref="A1.SS2.p4.3.m2.2.2.4"><csymbol cd="ambiguous" id="A1.SS2.p4.3.m2.2.2.4.1.cmml" xref="A1.SS2.p4.3.m2.2.2.4">subscript</csymbol><ci id="A1.SS2.p4.3.m2.2.2.4.2.cmml" xref="A1.SS2.p4.3.m2.2.2.4.2">KA</ci><ci id="A1.SS2.p4.3.m2.2.2.4.3.cmml" xref="A1.SS2.p4.3.m2.2.2.4.3">𝒳</ci></apply><apply id="A1.SS2.p4.3.m2.2.2.2.cmml" xref="A1.SS2.p4.3.m2.2.2.2"><csymbol cd="ambiguous" id="A1.SS2.p4.3.m2.2.2.2.3.cmml" xref="A1.SS2.p4.3.m2.2.2.2">subscript</csymbol><interval closure="open" id="A1.SS2.p4.3.m2.2.2.2.2.3.cmml" xref="A1.SS2.p4.3.m2.2.2.2.2.2"><apply id="A1.SS2.p4.3.m2.1.1.1.1.1.1.cmml" xref="A1.SS2.p4.3.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p4.3.m2.1.1.1.1.1.1.1.cmml" xref="A1.SS2.p4.3.m2.1.1.1.1.1.1">subscript</csymbol><ci id="A1.SS2.p4.3.m2.1.1.1.1.1.1.2.cmml" xref="A1.SS2.p4.3.m2.1.1.1.1.1.1.2">𝛿</ci><cn id="A1.SS2.p4.3.m2.1.1.1.1.1.1.3.cmml" type="integer" xref="A1.SS2.p4.3.m2.1.1.1.1.1.1.3">1</cn></apply><apply id="A1.SS2.p4.3.m2.2.2.2.2.2.2.cmml" xref="A1.SS2.p4.3.m2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.SS2.p4.3.m2.2.2.2.2.2.2.1.cmml" xref="A1.SS2.p4.3.m2.2.2.2.2.2.2">subscript</csymbol><ci id="A1.SS2.p4.3.m2.2.2.2.2.2.2.2.cmml" xref="A1.SS2.p4.3.m2.2.2.2.2.2.2.2">𝛿</ci><cn id="A1.SS2.p4.3.m2.2.2.2.2.2.2.3.cmml" type="integer" xref="A1.SS2.p4.3.m2.2.2.2.2.2.2.3">2</cn></apply></interval><ci id="A1.SS2.p4.3.m2.2.2.2.4.cmml" xref="A1.SS2.p4.3.m2.2.2.2.4">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p4.3.m2.2c">\mathrm{KA}_{\mathcal{X}}(\delta_{1},\delta_{2})_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p4.3.m2.2d">roman_KA start_POSTSUBSCRIPT caligraphic_X end_POSTSUBSCRIPT ( italic_δ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_δ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS2.p5">
<p class="ltx_p" id="A1.SS2.p5.5"><span class="ltx_text ltx_font_bold" id="A1.SS2.p5.5.1">Implementation.</span> In our experiments, we choose cosine similarity as the <math alttext="\langle\cdot,\cdot\rangle" class="ltx_Math" display="inline" id="A1.SS2.p5.1.m1.2"><semantics id="A1.SS2.p5.1.m1.2a"><mrow id="A1.SS2.p5.1.m1.2.3.2" xref="A1.SS2.p5.1.m1.2.3.1.cmml"><mo id="A1.SS2.p5.1.m1.2.3.2.1" stretchy="false" xref="A1.SS2.p5.1.m1.2.3.1.cmml">⟨</mo><mo id="A1.SS2.p5.1.m1.1.1" lspace="0em" rspace="0em" xref="A1.SS2.p5.1.m1.1.1.cmml">⋅</mo><mo id="A1.SS2.p5.1.m1.2.3.2.2" rspace="0em" xref="A1.SS2.p5.1.m1.2.3.1.cmml">,</mo><mo id="A1.SS2.p5.1.m1.2.2" lspace="0em" rspace="0em" xref="A1.SS2.p5.1.m1.2.2.cmml">⋅</mo><mo id="A1.SS2.p5.1.m1.2.3.2.3" stretchy="false" xref="A1.SS2.p5.1.m1.2.3.1.cmml">⟩</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p5.1.m1.2b"><list id="A1.SS2.p5.1.m1.2.3.1.cmml" xref="A1.SS2.p5.1.m1.2.3.2"><ci id="A1.SS2.p5.1.m1.1.1.cmml" xref="A1.SS2.p5.1.m1.1.1">⋅</ci><ci id="A1.SS2.p5.1.m1.2.2.cmml" xref="A1.SS2.p5.1.m1.2.2">⋅</ci></list></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p5.1.m1.2c">\langle\cdot,\cdot\rangle</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p5.1.m1.2d">⟨ ⋅ , ⋅ ⟩</annotation></semantics></math>, and <math alttext="k\fallingdotseq 64" class="ltx_Math" display="inline" id="A1.SS2.p5.2.m2.1"><semantics id="A1.SS2.p5.2.m2.1a"><mrow id="A1.SS2.p5.2.m2.1.1" xref="A1.SS2.p5.2.m2.1.1.cmml"><mi id="A1.SS2.p5.2.m2.1.1.2" xref="A1.SS2.p5.2.m2.1.1.2.cmml">k</mi><mo id="A1.SS2.p5.2.m2.1.1.1" xref="A1.SS2.p5.2.m2.1.1.1.cmml">≒</mo><mn id="A1.SS2.p5.2.m2.1.1.3" xref="A1.SS2.p5.2.m2.1.1.3.cmml">64</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p5.2.m2.1b"><apply id="A1.SS2.p5.2.m2.1.1.cmml" xref="A1.SS2.p5.2.m2.1.1"><csymbol cd="latexml" id="A1.SS2.p5.2.m2.1.1.1.cmml" xref="A1.SS2.p5.2.m2.1.1.1">approximately-equals-or-image-of</csymbol><ci id="A1.SS2.p5.2.m2.1.1.2.cmml" xref="A1.SS2.p5.2.m2.1.1.2">𝑘</ci><cn id="A1.SS2.p5.2.m2.1.1.3.cmml" type="integer" xref="A1.SS2.p5.2.m2.1.1.3">64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p5.2.m2.1c">k\fallingdotseq 64</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p5.2.m2.1d">italic_k ≒ 64</annotation></semantics></math>. According to experiment settings in&nbsp;§<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S2.SS2" title="2.2 Experiment Settings ‣ 2 Preparation ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">2.2</span></a>, <math alttext="n\fallingdotseq 512" class="ltx_Math" display="inline" id="A1.SS2.p5.3.m3.1"><semantics id="A1.SS2.p5.3.m3.1a"><mrow id="A1.SS2.p5.3.m3.1.1" xref="A1.SS2.p5.3.m3.1.1.cmml"><mi id="A1.SS2.p5.3.m3.1.1.2" xref="A1.SS2.p5.3.m3.1.1.2.cmml">n</mi><mo id="A1.SS2.p5.3.m3.1.1.1" xref="A1.SS2.p5.3.m3.1.1.1.cmml">≒</mo><mn id="A1.SS2.p5.3.m3.1.1.3" xref="A1.SS2.p5.3.m3.1.1.3.cmml">512</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p5.3.m3.1b"><apply id="A1.SS2.p5.3.m3.1.1.cmml" xref="A1.SS2.p5.3.m3.1.1"><csymbol cd="latexml" id="A1.SS2.p5.3.m3.1.1.1.cmml" xref="A1.SS2.p5.3.m3.1.1.1">approximately-equals-or-image-of</csymbol><ci id="A1.SS2.p5.3.m3.1.1.2.cmml" xref="A1.SS2.p5.3.m3.1.1.2">𝑛</ci><cn id="A1.SS2.p5.3.m3.1.1.3.cmml" type="integer" xref="A1.SS2.p5.3.m3.1.1.3">512</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p5.3.m3.1c">n\fallingdotseq 512</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p5.3.m3.1d">italic_n ≒ 512</annotation></semantics></math> is defined, and a randomlized matrix <math alttext="\mathcal{S}" class="ltx_Math" display="inline" id="A1.SS2.p5.4.m4.1"><semantics id="A1.SS2.p5.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="A1.SS2.p5.4.m4.1.1" xref="A1.SS2.p5.4.m4.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p5.4.m4.1b"><ci id="A1.SS2.p5.4.m4.1.1.cmml" xref="A1.SS2.p5.4.m4.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p5.4.m4.1c">\mathcal{S}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p5.4.m4.1d">caligraphic_S</annotation></semantics></math> have <math alttext="\mathrm{KA}=64/512=0.125" class="ltx_Math" display="inline" id="A1.SS2.p5.5.m5.1"><semantics id="A1.SS2.p5.5.m5.1a"><mrow id="A1.SS2.p5.5.m5.1.1" xref="A1.SS2.p5.5.m5.1.1.cmml"><mi id="A1.SS2.p5.5.m5.1.1.2" xref="A1.SS2.p5.5.m5.1.1.2.cmml">KA</mi><mo id="A1.SS2.p5.5.m5.1.1.3" xref="A1.SS2.p5.5.m5.1.1.3.cmml">=</mo><mrow id="A1.SS2.p5.5.m5.1.1.4" xref="A1.SS2.p5.5.m5.1.1.4.cmml"><mn id="A1.SS2.p5.5.m5.1.1.4.2" xref="A1.SS2.p5.5.m5.1.1.4.2.cmml">64</mn><mo id="A1.SS2.p5.5.m5.1.1.4.1" xref="A1.SS2.p5.5.m5.1.1.4.1.cmml">/</mo><mn id="A1.SS2.p5.5.m5.1.1.4.3" xref="A1.SS2.p5.5.m5.1.1.4.3.cmml">512</mn></mrow><mo id="A1.SS2.p5.5.m5.1.1.5" xref="A1.SS2.p5.5.m5.1.1.5.cmml">=</mo><mn id="A1.SS2.p5.5.m5.1.1.6" xref="A1.SS2.p5.5.m5.1.1.6.cmml">0.125</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p5.5.m5.1b"><apply id="A1.SS2.p5.5.m5.1.1.cmml" xref="A1.SS2.p5.5.m5.1.1"><and id="A1.SS2.p5.5.m5.1.1a.cmml" xref="A1.SS2.p5.5.m5.1.1"></and><apply id="A1.SS2.p5.5.m5.1.1b.cmml" xref="A1.SS2.p5.5.m5.1.1"><eq id="A1.SS2.p5.5.m5.1.1.3.cmml" xref="A1.SS2.p5.5.m5.1.1.3"></eq><ci id="A1.SS2.p5.5.m5.1.1.2.cmml" xref="A1.SS2.p5.5.m5.1.1.2">KA</ci><apply id="A1.SS2.p5.5.m5.1.1.4.cmml" xref="A1.SS2.p5.5.m5.1.1.4"><divide id="A1.SS2.p5.5.m5.1.1.4.1.cmml" xref="A1.SS2.p5.5.m5.1.1.4.1"></divide><cn id="A1.SS2.p5.5.m5.1.1.4.2.cmml" type="integer" xref="A1.SS2.p5.5.m5.1.1.4.2">64</cn><cn id="A1.SS2.p5.5.m5.1.1.4.3.cmml" type="integer" xref="A1.SS2.p5.5.m5.1.1.4.3">512</cn></apply></apply><apply id="A1.SS2.p5.5.m5.1.1c.cmml" xref="A1.SS2.p5.5.m5.1.1"><eq id="A1.SS2.p5.5.m5.1.1.5.cmml" xref="A1.SS2.p5.5.m5.1.1.5"></eq><share href="https://arxiv.org/html/2410.04468v1#A1.SS2.p5.5.m5.1.1.4.cmml" id="A1.SS2.p5.5.m5.1.1d.cmml" xref="A1.SS2.p5.5.m5.1.1"></share><cn id="A1.SS2.p5.5.m5.1.1.6.cmml" type="float" xref="A1.SS2.p5.5.m5.1.1.6">0.125</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p5.5.m5.1c">\mathrm{KA}=64/512=0.125</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p5.5.m5.1d">roman_KA = 64 / 512 = 0.125</annotation></semantics></math> as the random baseline.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="A1.F9"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="161" id="A1.F9.g1" src="https://arxiv.org/html/2410.04468v1/extracted/5905049/Figure/backgroundvalue.png" width="509">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>Distributions (<span class="ltx_text ltx_font_italic" id="A1.F9.5.1">clusters</span>) of representations generated by: <span class="ltx_text ltx_font_bold" id="A1.F9.6.2">Left:</span> encoder model (BGE), clustering w.r.t. the label; <span class="ltx_text ltx_font_bold" id="A1.F9.7.3">Middle:</span> ICL on the forerunner token, where representations gather into one point when no Transformer operation is conducted; <span class="ltx_text ltx_font_bold" id="A1.F9.8.4">Right:</span> ICL on the label token, where representations gather into points w.r.t. label (using a 2-way example) when no Transformer operation is conducted, causing a high background value.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsubsection" id="A1.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.2.1 </span>Background Values of Kernel Alignment: Label Token - Text Encoding.</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A1.SS2.SSS1.p1">
<p class="ltx_p" id="A1.SS2.SSS1.p1.9">Given two specific tokens <math alttext="x_{i}" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p1.1.m1.1"><semantics id="A1.SS2.SSS1.p1.1.m1.1a"><msub id="A1.SS2.SSS1.p1.1.m1.1.1" xref="A1.SS2.SSS1.p1.1.m1.1.1.cmml"><mi id="A1.SS2.SSS1.p1.1.m1.1.1.2" xref="A1.SS2.SSS1.p1.1.m1.1.1.2.cmml">x</mi><mi id="A1.SS2.SSS1.p1.1.m1.1.1.3" xref="A1.SS2.SSS1.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p1.1.m1.1b"><apply id="A1.SS2.SSS1.p1.1.m1.1.1.cmml" xref="A1.SS2.SSS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSS1.p1.1.m1.1.1.1.cmml" xref="A1.SS2.SSS1.p1.1.m1.1.1">subscript</csymbol><ci id="A1.SS2.SSS1.p1.1.m1.1.1.2.cmml" xref="A1.SS2.SSS1.p1.1.m1.1.1.2">𝑥</ci><ci id="A1.SS2.SSS1.p1.1.m1.1.1.3.cmml" xref="A1.SS2.SSS1.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p1.1.m1.1c">x_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p1.1.m1.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="x_{j}" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p1.2.m2.1"><semantics id="A1.SS2.SSS1.p1.2.m2.1a"><msub id="A1.SS2.SSS1.p1.2.m2.1.1" xref="A1.SS2.SSS1.p1.2.m2.1.1.cmml"><mi id="A1.SS2.SSS1.p1.2.m2.1.1.2" xref="A1.SS2.SSS1.p1.2.m2.1.1.2.cmml">x</mi><mi id="A1.SS2.SSS1.p1.2.m2.1.1.3" xref="A1.SS2.SSS1.p1.2.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p1.2.m2.1b"><apply id="A1.SS2.SSS1.p1.2.m2.1.1.cmml" xref="A1.SS2.SSS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSS1.p1.2.m2.1.1.1.cmml" xref="A1.SS2.SSS1.p1.2.m2.1.1">subscript</csymbol><ci id="A1.SS2.SSS1.p1.2.m2.1.1.2.cmml" xref="A1.SS2.SSS1.p1.2.m2.1.1.2">𝑥</ci><ci id="A1.SS2.SSS1.p1.2.m2.1.1.3.cmml" xref="A1.SS2.SSS1.p1.2.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p1.2.m2.1c">x_{j}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p1.2.m2.1d">italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> where kernel alignment is calculated from different ICL-styled input sequences <math alttext="p_{i}" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p1.3.m3.1"><semantics id="A1.SS2.SSS1.p1.3.m3.1a"><msub id="A1.SS2.SSS1.p1.3.m3.1.1" xref="A1.SS2.SSS1.p1.3.m3.1.1.cmml"><mi id="A1.SS2.SSS1.p1.3.m3.1.1.2" xref="A1.SS2.SSS1.p1.3.m3.1.1.2.cmml">p</mi><mi id="A1.SS2.SSS1.p1.3.m3.1.1.3" xref="A1.SS2.SSS1.p1.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p1.3.m3.1b"><apply id="A1.SS2.SSS1.p1.3.m3.1.1.cmml" xref="A1.SS2.SSS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSS1.p1.3.m3.1.1.1.cmml" xref="A1.SS2.SSS1.p1.3.m3.1.1">subscript</csymbol><ci id="A1.SS2.SSS1.p1.3.m3.1.1.2.cmml" xref="A1.SS2.SSS1.p1.3.m3.1.1.2">𝑝</ci><ci id="A1.SS2.SSS1.p1.3.m3.1.1.3.cmml" xref="A1.SS2.SSS1.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p1.3.m3.1c">p_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p1.3.m3.1d">italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="p_{j}" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p1.4.m4.1"><semantics id="A1.SS2.SSS1.p1.4.m4.1a"><msub id="A1.SS2.SSS1.p1.4.m4.1.1" xref="A1.SS2.SSS1.p1.4.m4.1.1.cmml"><mi id="A1.SS2.SSS1.p1.4.m4.1.1.2" xref="A1.SS2.SSS1.p1.4.m4.1.1.2.cmml">p</mi><mi id="A1.SS2.SSS1.p1.4.m4.1.1.3" xref="A1.SS2.SSS1.p1.4.m4.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p1.4.m4.1b"><apply id="A1.SS2.SSS1.p1.4.m4.1.1.cmml" xref="A1.SS2.SSS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSS1.p1.4.m4.1.1.1.cmml" xref="A1.SS2.SSS1.p1.4.m4.1.1">subscript</csymbol><ci id="A1.SS2.SSS1.p1.4.m4.1.1.2.cmml" xref="A1.SS2.SSS1.p1.4.m4.1.1.2">𝑝</ci><ci id="A1.SS2.SSS1.p1.4.m4.1.1.3.cmml" xref="A1.SS2.SSS1.p1.4.m4.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p1.4.m4.1c">p_{j}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p1.4.m4.1d">italic_p start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, in a specific layer of a decoder Transformer, the representations can be written as <math alttext="\delta(x)=e(x)+\epsilon(p)" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p1.5.m5.3"><semantics id="A1.SS2.SSS1.p1.5.m5.3a"><mrow id="A1.SS2.SSS1.p1.5.m5.3.4" xref="A1.SS2.SSS1.p1.5.m5.3.4.cmml"><mrow id="A1.SS2.SSS1.p1.5.m5.3.4.2" xref="A1.SS2.SSS1.p1.5.m5.3.4.2.cmml"><mi id="A1.SS2.SSS1.p1.5.m5.3.4.2.2" xref="A1.SS2.SSS1.p1.5.m5.3.4.2.2.cmml">δ</mi><mo id="A1.SS2.SSS1.p1.5.m5.3.4.2.1" xref="A1.SS2.SSS1.p1.5.m5.3.4.2.1.cmml">⁢</mo><mrow id="A1.SS2.SSS1.p1.5.m5.3.4.2.3.2" xref="A1.SS2.SSS1.p1.5.m5.3.4.2.cmml"><mo id="A1.SS2.SSS1.p1.5.m5.3.4.2.3.2.1" stretchy="false" xref="A1.SS2.SSS1.p1.5.m5.3.4.2.cmml">(</mo><mi id="A1.SS2.SSS1.p1.5.m5.1.1" xref="A1.SS2.SSS1.p1.5.m5.1.1.cmml">x</mi><mo id="A1.SS2.SSS1.p1.5.m5.3.4.2.3.2.2" stretchy="false" xref="A1.SS2.SSS1.p1.5.m5.3.4.2.cmml">)</mo></mrow></mrow><mo id="A1.SS2.SSS1.p1.5.m5.3.4.1" xref="A1.SS2.SSS1.p1.5.m5.3.4.1.cmml">=</mo><mrow id="A1.SS2.SSS1.p1.5.m5.3.4.3" xref="A1.SS2.SSS1.p1.5.m5.3.4.3.cmml"><mrow id="A1.SS2.SSS1.p1.5.m5.3.4.3.2" xref="A1.SS2.SSS1.p1.5.m5.3.4.3.2.cmml"><mi id="A1.SS2.SSS1.p1.5.m5.3.4.3.2.2" xref="A1.SS2.SSS1.p1.5.m5.3.4.3.2.2.cmml">e</mi><mo id="A1.SS2.SSS1.p1.5.m5.3.4.3.2.1" xref="A1.SS2.SSS1.p1.5.m5.3.4.3.2.1.cmml">⁢</mo><mrow id="A1.SS2.SSS1.p1.5.m5.3.4.3.2.3.2" xref="A1.SS2.SSS1.p1.5.m5.3.4.3.2.cmml"><mo id="A1.SS2.SSS1.p1.5.m5.3.4.3.2.3.2.1" stretchy="false" xref="A1.SS2.SSS1.p1.5.m5.3.4.3.2.cmml">(</mo><mi id="A1.SS2.SSS1.p1.5.m5.2.2" xref="A1.SS2.SSS1.p1.5.m5.2.2.cmml">x</mi><mo id="A1.SS2.SSS1.p1.5.m5.3.4.3.2.3.2.2" stretchy="false" xref="A1.SS2.SSS1.p1.5.m5.3.4.3.2.cmml">)</mo></mrow></mrow><mo id="A1.SS2.SSS1.p1.5.m5.3.4.3.1" xref="A1.SS2.SSS1.p1.5.m5.3.4.3.1.cmml">+</mo><mrow id="A1.SS2.SSS1.p1.5.m5.3.4.3.3" xref="A1.SS2.SSS1.p1.5.m5.3.4.3.3.cmml"><mi id="A1.SS2.SSS1.p1.5.m5.3.4.3.3.2" xref="A1.SS2.SSS1.p1.5.m5.3.4.3.3.2.cmml">ϵ</mi><mo id="A1.SS2.SSS1.p1.5.m5.3.4.3.3.1" xref="A1.SS2.SSS1.p1.5.m5.3.4.3.3.1.cmml">⁢</mo><mrow id="A1.SS2.SSS1.p1.5.m5.3.4.3.3.3.2" xref="A1.SS2.SSS1.p1.5.m5.3.4.3.3.cmml"><mo id="A1.SS2.SSS1.p1.5.m5.3.4.3.3.3.2.1" stretchy="false" xref="A1.SS2.SSS1.p1.5.m5.3.4.3.3.cmml">(</mo><mi id="A1.SS2.SSS1.p1.5.m5.3.3" xref="A1.SS2.SSS1.p1.5.m5.3.3.cmml">p</mi><mo id="A1.SS2.SSS1.p1.5.m5.3.4.3.3.3.2.2" stretchy="false" xref="A1.SS2.SSS1.p1.5.m5.3.4.3.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p1.5.m5.3b"><apply id="A1.SS2.SSS1.p1.5.m5.3.4.cmml" xref="A1.SS2.SSS1.p1.5.m5.3.4"><eq id="A1.SS2.SSS1.p1.5.m5.3.4.1.cmml" xref="A1.SS2.SSS1.p1.5.m5.3.4.1"></eq><apply id="A1.SS2.SSS1.p1.5.m5.3.4.2.cmml" xref="A1.SS2.SSS1.p1.5.m5.3.4.2"><times id="A1.SS2.SSS1.p1.5.m5.3.4.2.1.cmml" xref="A1.SS2.SSS1.p1.5.m5.3.4.2.1"></times><ci id="A1.SS2.SSS1.p1.5.m5.3.4.2.2.cmml" xref="A1.SS2.SSS1.p1.5.m5.3.4.2.2">𝛿</ci><ci id="A1.SS2.SSS1.p1.5.m5.1.1.cmml" xref="A1.SS2.SSS1.p1.5.m5.1.1">𝑥</ci></apply><apply id="A1.SS2.SSS1.p1.5.m5.3.4.3.cmml" xref="A1.SS2.SSS1.p1.5.m5.3.4.3"><plus id="A1.SS2.SSS1.p1.5.m5.3.4.3.1.cmml" xref="A1.SS2.SSS1.p1.5.m5.3.4.3.1"></plus><apply id="A1.SS2.SSS1.p1.5.m5.3.4.3.2.cmml" xref="A1.SS2.SSS1.p1.5.m5.3.4.3.2"><times id="A1.SS2.SSS1.p1.5.m5.3.4.3.2.1.cmml" xref="A1.SS2.SSS1.p1.5.m5.3.4.3.2.1"></times><ci id="A1.SS2.SSS1.p1.5.m5.3.4.3.2.2.cmml" xref="A1.SS2.SSS1.p1.5.m5.3.4.3.2.2">𝑒</ci><ci id="A1.SS2.SSS1.p1.5.m5.2.2.cmml" xref="A1.SS2.SSS1.p1.5.m5.2.2">𝑥</ci></apply><apply id="A1.SS2.SSS1.p1.5.m5.3.4.3.3.cmml" xref="A1.SS2.SSS1.p1.5.m5.3.4.3.3"><times id="A1.SS2.SSS1.p1.5.m5.3.4.3.3.1.cmml" xref="A1.SS2.SSS1.p1.5.m5.3.4.3.3.1"></times><ci id="A1.SS2.SSS1.p1.5.m5.3.4.3.3.2.cmml" xref="A1.SS2.SSS1.p1.5.m5.3.4.3.3.2">italic-ϵ</ci><ci id="A1.SS2.SSS1.p1.5.m5.3.3.cmml" xref="A1.SS2.SSS1.p1.5.m5.3.3">𝑝</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p1.5.m5.3c">\delta(x)=e(x)+\epsilon(p)</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p1.5.m5.3d">italic_δ ( italic_x ) = italic_e ( italic_x ) + italic_ϵ ( italic_p )</annotation></semantics></math>, where <math alttext="e(x)" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p1.6.m6.1"><semantics id="A1.SS2.SSS1.p1.6.m6.1a"><mrow id="A1.SS2.SSS1.p1.6.m6.1.2" xref="A1.SS2.SSS1.p1.6.m6.1.2.cmml"><mi id="A1.SS2.SSS1.p1.6.m6.1.2.2" xref="A1.SS2.SSS1.p1.6.m6.1.2.2.cmml">e</mi><mo id="A1.SS2.SSS1.p1.6.m6.1.2.1" xref="A1.SS2.SSS1.p1.6.m6.1.2.1.cmml">⁢</mo><mrow id="A1.SS2.SSS1.p1.6.m6.1.2.3.2" xref="A1.SS2.SSS1.p1.6.m6.1.2.cmml"><mo id="A1.SS2.SSS1.p1.6.m6.1.2.3.2.1" stretchy="false" xref="A1.SS2.SSS1.p1.6.m6.1.2.cmml">(</mo><mi id="A1.SS2.SSS1.p1.6.m6.1.1" xref="A1.SS2.SSS1.p1.6.m6.1.1.cmml">x</mi><mo id="A1.SS2.SSS1.p1.6.m6.1.2.3.2.2" stretchy="false" xref="A1.SS2.SSS1.p1.6.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p1.6.m6.1b"><apply id="A1.SS2.SSS1.p1.6.m6.1.2.cmml" xref="A1.SS2.SSS1.p1.6.m6.1.2"><times id="A1.SS2.SSS1.p1.6.m6.1.2.1.cmml" xref="A1.SS2.SSS1.p1.6.m6.1.2.1"></times><ci id="A1.SS2.SSS1.p1.6.m6.1.2.2.cmml" xref="A1.SS2.SSS1.p1.6.m6.1.2.2">𝑒</ci><ci id="A1.SS2.SSS1.p1.6.m6.1.1.cmml" xref="A1.SS2.SSS1.p1.6.m6.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p1.6.m6.1c">e(x)</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p1.6.m6.1d">italic_e ( italic_x )</annotation></semantics></math> are the embedding vector of the token <math alttext="x" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p1.7.m7.1"><semantics id="A1.SS2.SSS1.p1.7.m7.1a"><mi id="A1.SS2.SSS1.p1.7.m7.1.1" xref="A1.SS2.SSS1.p1.7.m7.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p1.7.m7.1b"><ci id="A1.SS2.SSS1.p1.7.m7.1.1.cmml" xref="A1.SS2.SSS1.p1.7.m7.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p1.7.m7.1c">x</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p1.7.m7.1d">italic_x</annotation></semantics></math>, and <math alttext="\epsilon(p)" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p1.8.m8.1"><semantics id="A1.SS2.SSS1.p1.8.m8.1a"><mrow id="A1.SS2.SSS1.p1.8.m8.1.2" xref="A1.SS2.SSS1.p1.8.m8.1.2.cmml"><mi id="A1.SS2.SSS1.p1.8.m8.1.2.2" xref="A1.SS2.SSS1.p1.8.m8.1.2.2.cmml">ϵ</mi><mo id="A1.SS2.SSS1.p1.8.m8.1.2.1" xref="A1.SS2.SSS1.p1.8.m8.1.2.1.cmml">⁢</mo><mrow id="A1.SS2.SSS1.p1.8.m8.1.2.3.2" xref="A1.SS2.SSS1.p1.8.m8.1.2.cmml"><mo id="A1.SS2.SSS1.p1.8.m8.1.2.3.2.1" stretchy="false" xref="A1.SS2.SSS1.p1.8.m8.1.2.cmml">(</mo><mi id="A1.SS2.SSS1.p1.8.m8.1.1" xref="A1.SS2.SSS1.p1.8.m8.1.1.cmml">p</mi><mo id="A1.SS2.SSS1.p1.8.m8.1.2.3.2.2" stretchy="false" xref="A1.SS2.SSS1.p1.8.m8.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p1.8.m8.1b"><apply id="A1.SS2.SSS1.p1.8.m8.1.2.cmml" xref="A1.SS2.SSS1.p1.8.m8.1.2"><times id="A1.SS2.SSS1.p1.8.m8.1.2.1.cmml" xref="A1.SS2.SSS1.p1.8.m8.1.2.1"></times><ci id="A1.SS2.SSS1.p1.8.m8.1.2.2.cmml" xref="A1.SS2.SSS1.p1.8.m8.1.2.2">italic-ϵ</ci><ci id="A1.SS2.SSS1.p1.8.m8.1.1.cmml" xref="A1.SS2.SSS1.p1.8.m8.1.1">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p1.8.m8.1c">\epsilon(p)</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p1.8.m8.1d">italic_ϵ ( italic_p )</annotation></semantics></math> are the residual side-flow w.r.t the context <math alttext="p" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p1.9.m9.1"><semantics id="A1.SS2.SSS1.p1.9.m9.1a"><mi id="A1.SS2.SSS1.p1.9.m9.1.1" xref="A1.SS2.SSS1.p1.9.m9.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p1.9.m9.1b"><ci id="A1.SS2.SSS1.p1.9.m9.1.1.cmml" xref="A1.SS2.SSS1.p1.9.m9.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p1.9.m9.1c">p</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p1.9.m9.1d">italic_p</annotation></semantics></math>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS2.SSS1.p2">
<p class="ltx_p" id="A1.SS2.SSS1.p2.1"><span class="ltx_text ltx_font_bold" id="A1.SS2.SSS1.p2.1.1">Intuition.</span> As shown in Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A1.F9" title="Figure 9 ‣ A.2 Calculation of Mutual Nearest-neighbor Kernel Alignment ‣ Appendix A Experiment Details and Settings ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">9</span></a>, in the hidden states of ICL, the hidden state on the label token has a prior clustering, making it naturally similar to the representation generated by the encoder model, even if the ICL process does not encode it sufficiently. So, at layer 0, since the model is not able to perform any encoding in this layer, the kernel alignment on the forerunner is on a random baseline value of 0.125, but the value on the label token will be greater. In the case where (1) BGE generates fully linearly separable clusters with sufficient inter-cluster distance, and (2) the number of samples for each label is not less than 64, this upper bias can be expected to be <math alttext="0.125(|\mathbb{Y}|-1)" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p2.1.m1.2"><semantics id="A1.SS2.SSS1.p2.1.m1.2a"><mrow id="A1.SS2.SSS1.p2.1.m1.2.2" xref="A1.SS2.SSS1.p2.1.m1.2.2.cmml"><mn id="A1.SS2.SSS1.p2.1.m1.2.2.3" xref="A1.SS2.SSS1.p2.1.m1.2.2.3.cmml">0.125</mn><mo id="A1.SS2.SSS1.p2.1.m1.2.2.2" xref="A1.SS2.SSS1.p2.1.m1.2.2.2.cmml">⁢</mo><mrow id="A1.SS2.SSS1.p2.1.m1.2.2.1.1" xref="A1.SS2.SSS1.p2.1.m1.2.2.1.1.1.cmml"><mo id="A1.SS2.SSS1.p2.1.m1.2.2.1.1.2" stretchy="false" xref="A1.SS2.SSS1.p2.1.m1.2.2.1.1.1.cmml">(</mo><mrow id="A1.SS2.SSS1.p2.1.m1.2.2.1.1.1" xref="A1.SS2.SSS1.p2.1.m1.2.2.1.1.1.cmml"><mrow id="A1.SS2.SSS1.p2.1.m1.2.2.1.1.1.2.2" xref="A1.SS2.SSS1.p2.1.m1.2.2.1.1.1.2.1.cmml"><mo id="A1.SS2.SSS1.p2.1.m1.2.2.1.1.1.2.2.1" stretchy="false" xref="A1.SS2.SSS1.p2.1.m1.2.2.1.1.1.2.1.1.cmml">|</mo><mi id="A1.SS2.SSS1.p2.1.m1.1.1" xref="A1.SS2.SSS1.p2.1.m1.1.1.cmml">𝕐</mi><mo id="A1.SS2.SSS1.p2.1.m1.2.2.1.1.1.2.2.2" stretchy="false" xref="A1.SS2.SSS1.p2.1.m1.2.2.1.1.1.2.1.1.cmml">|</mo></mrow><mo id="A1.SS2.SSS1.p2.1.m1.2.2.1.1.1.1" xref="A1.SS2.SSS1.p2.1.m1.2.2.1.1.1.1.cmml">−</mo><mn id="A1.SS2.SSS1.p2.1.m1.2.2.1.1.1.3" xref="A1.SS2.SSS1.p2.1.m1.2.2.1.1.1.3.cmml">1</mn></mrow><mo id="A1.SS2.SSS1.p2.1.m1.2.2.1.1.3" stretchy="false" xref="A1.SS2.SSS1.p2.1.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p2.1.m1.2b"><apply id="A1.SS2.SSS1.p2.1.m1.2.2.cmml" xref="A1.SS2.SSS1.p2.1.m1.2.2"><times id="A1.SS2.SSS1.p2.1.m1.2.2.2.cmml" xref="A1.SS2.SSS1.p2.1.m1.2.2.2"></times><cn id="A1.SS2.SSS1.p2.1.m1.2.2.3.cmml" type="float" xref="A1.SS2.SSS1.p2.1.m1.2.2.3">0.125</cn><apply id="A1.SS2.SSS1.p2.1.m1.2.2.1.1.1.cmml" xref="A1.SS2.SSS1.p2.1.m1.2.2.1.1"><minus id="A1.SS2.SSS1.p2.1.m1.2.2.1.1.1.1.cmml" xref="A1.SS2.SSS1.p2.1.m1.2.2.1.1.1.1"></minus><apply id="A1.SS2.SSS1.p2.1.m1.2.2.1.1.1.2.1.cmml" xref="A1.SS2.SSS1.p2.1.m1.2.2.1.1.1.2.2"><abs id="A1.SS2.SSS1.p2.1.m1.2.2.1.1.1.2.1.1.cmml" xref="A1.SS2.SSS1.p2.1.m1.2.2.1.1.1.2.2.1"></abs><ci id="A1.SS2.SSS1.p2.1.m1.1.1.cmml" xref="A1.SS2.SSS1.p2.1.m1.1.1">𝕐</ci></apply><cn id="A1.SS2.SSS1.p2.1.m1.2.2.1.1.1.3.cmml" type="integer" xref="A1.SS2.SSS1.p2.1.m1.2.2.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p2.1.m1.2c">0.125(|\mathbb{Y}|-1)</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p2.1.m1.2d">0.125 ( | blackboard_Y | - 1 )</annotation></semantics></math> (proof omitted). Intuitively, such bias can propagate along the residual network to every layer, making the results of any layer unfaithful.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS2.SSS1.p3">
<p class="ltx_p" id="A1.SS2.SSS1.p3.4"><span class="ltx_text ltx_font_bold" id="A1.SS2.SSS1.p3.4.1">Similarity on Forerunner Tokens.</span> The cosine similarity between <math alttext="\delta(x_{i})" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p3.1.m1.1"><semantics id="A1.SS2.SSS1.p3.1.m1.1a"><mrow id="A1.SS2.SSS1.p3.1.m1.1.1" xref="A1.SS2.SSS1.p3.1.m1.1.1.cmml"><mi id="A1.SS2.SSS1.p3.1.m1.1.1.3" xref="A1.SS2.SSS1.p3.1.m1.1.1.3.cmml">δ</mi><mo id="A1.SS2.SSS1.p3.1.m1.1.1.2" xref="A1.SS2.SSS1.p3.1.m1.1.1.2.cmml">⁢</mo><mrow id="A1.SS2.SSS1.p3.1.m1.1.1.1.1" xref="A1.SS2.SSS1.p3.1.m1.1.1.1.1.1.cmml"><mo id="A1.SS2.SSS1.p3.1.m1.1.1.1.1.2" stretchy="false" xref="A1.SS2.SSS1.p3.1.m1.1.1.1.1.1.cmml">(</mo><msub id="A1.SS2.SSS1.p3.1.m1.1.1.1.1.1" xref="A1.SS2.SSS1.p3.1.m1.1.1.1.1.1.cmml"><mi id="A1.SS2.SSS1.p3.1.m1.1.1.1.1.1.2" xref="A1.SS2.SSS1.p3.1.m1.1.1.1.1.1.2.cmml">x</mi><mi id="A1.SS2.SSS1.p3.1.m1.1.1.1.1.1.3" xref="A1.SS2.SSS1.p3.1.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.SS2.SSS1.p3.1.m1.1.1.1.1.3" stretchy="false" xref="A1.SS2.SSS1.p3.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p3.1.m1.1b"><apply id="A1.SS2.SSS1.p3.1.m1.1.1.cmml" xref="A1.SS2.SSS1.p3.1.m1.1.1"><times id="A1.SS2.SSS1.p3.1.m1.1.1.2.cmml" xref="A1.SS2.SSS1.p3.1.m1.1.1.2"></times><ci id="A1.SS2.SSS1.p3.1.m1.1.1.3.cmml" xref="A1.SS2.SSS1.p3.1.m1.1.1.3">𝛿</ci><apply id="A1.SS2.SSS1.p3.1.m1.1.1.1.1.1.cmml" xref="A1.SS2.SSS1.p3.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSS1.p3.1.m1.1.1.1.1.1.1.cmml" xref="A1.SS2.SSS1.p3.1.m1.1.1.1.1">subscript</csymbol><ci id="A1.SS2.SSS1.p3.1.m1.1.1.1.1.1.2.cmml" xref="A1.SS2.SSS1.p3.1.m1.1.1.1.1.1.2">𝑥</ci><ci id="A1.SS2.SSS1.p3.1.m1.1.1.1.1.1.3.cmml" xref="A1.SS2.SSS1.p3.1.m1.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p3.1.m1.1c">\delta(x_{i})</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p3.1.m1.1d">italic_δ ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math> and <math alttext="\delta(x_{j})" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p3.2.m2.1"><semantics id="A1.SS2.SSS1.p3.2.m2.1a"><mrow id="A1.SS2.SSS1.p3.2.m2.1.1" xref="A1.SS2.SSS1.p3.2.m2.1.1.cmml"><mi id="A1.SS2.SSS1.p3.2.m2.1.1.3" xref="A1.SS2.SSS1.p3.2.m2.1.1.3.cmml">δ</mi><mo id="A1.SS2.SSS1.p3.2.m2.1.1.2" xref="A1.SS2.SSS1.p3.2.m2.1.1.2.cmml">⁢</mo><mrow id="A1.SS2.SSS1.p3.2.m2.1.1.1.1" xref="A1.SS2.SSS1.p3.2.m2.1.1.1.1.1.cmml"><mo id="A1.SS2.SSS1.p3.2.m2.1.1.1.1.2" stretchy="false" xref="A1.SS2.SSS1.p3.2.m2.1.1.1.1.1.cmml">(</mo><msub id="A1.SS2.SSS1.p3.2.m2.1.1.1.1.1" xref="A1.SS2.SSS1.p3.2.m2.1.1.1.1.1.cmml"><mi id="A1.SS2.SSS1.p3.2.m2.1.1.1.1.1.2" xref="A1.SS2.SSS1.p3.2.m2.1.1.1.1.1.2.cmml">x</mi><mi id="A1.SS2.SSS1.p3.2.m2.1.1.1.1.1.3" xref="A1.SS2.SSS1.p3.2.m2.1.1.1.1.1.3.cmml">j</mi></msub><mo id="A1.SS2.SSS1.p3.2.m2.1.1.1.1.3" stretchy="false" xref="A1.SS2.SSS1.p3.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p3.2.m2.1b"><apply id="A1.SS2.SSS1.p3.2.m2.1.1.cmml" xref="A1.SS2.SSS1.p3.2.m2.1.1"><times id="A1.SS2.SSS1.p3.2.m2.1.1.2.cmml" xref="A1.SS2.SSS1.p3.2.m2.1.1.2"></times><ci id="A1.SS2.SSS1.p3.2.m2.1.1.3.cmml" xref="A1.SS2.SSS1.p3.2.m2.1.1.3">𝛿</ci><apply id="A1.SS2.SSS1.p3.2.m2.1.1.1.1.1.cmml" xref="A1.SS2.SSS1.p3.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSS1.p3.2.m2.1.1.1.1.1.1.cmml" xref="A1.SS2.SSS1.p3.2.m2.1.1.1.1">subscript</csymbol><ci id="A1.SS2.SSS1.p3.2.m2.1.1.1.1.1.2.cmml" xref="A1.SS2.SSS1.p3.2.m2.1.1.1.1.1.2">𝑥</ci><ci id="A1.SS2.SSS1.p3.2.m2.1.1.1.1.1.3.cmml" xref="A1.SS2.SSS1.p3.2.m2.1.1.1.1.1.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p3.2.m2.1c">\delta(x_{j})</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p3.2.m2.1d">italic_δ ( italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT )</annotation></semantics></math>, where the <math alttext="x_{i}" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p3.3.m3.1"><semantics id="A1.SS2.SSS1.p3.3.m3.1a"><msub id="A1.SS2.SSS1.p3.3.m3.1.1" xref="A1.SS2.SSS1.p3.3.m3.1.1.cmml"><mi id="A1.SS2.SSS1.p3.3.m3.1.1.2" xref="A1.SS2.SSS1.p3.3.m3.1.1.2.cmml">x</mi><mi id="A1.SS2.SSS1.p3.3.m3.1.1.3" xref="A1.SS2.SSS1.p3.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p3.3.m3.1b"><apply id="A1.SS2.SSS1.p3.3.m3.1.1.cmml" xref="A1.SS2.SSS1.p3.3.m3.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSS1.p3.3.m3.1.1.1.cmml" xref="A1.SS2.SSS1.p3.3.m3.1.1">subscript</csymbol><ci id="A1.SS2.SSS1.p3.3.m3.1.1.2.cmml" xref="A1.SS2.SSS1.p3.3.m3.1.1.2">𝑥</ci><ci id="A1.SS2.SSS1.p3.3.m3.1.1.3.cmml" xref="A1.SS2.SSS1.p3.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p3.3.m3.1c">x_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p3.3.m3.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="x_{j}" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p3.4.m4.1"><semantics id="A1.SS2.SSS1.p3.4.m4.1a"><msub id="A1.SS2.SSS1.p3.4.m4.1.1" xref="A1.SS2.SSS1.p3.4.m4.1.1.cmml"><mi id="A1.SS2.SSS1.p3.4.m4.1.1.2" xref="A1.SS2.SSS1.p3.4.m4.1.1.2.cmml">x</mi><mi id="A1.SS2.SSS1.p3.4.m4.1.1.3" xref="A1.SS2.SSS1.p3.4.m4.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p3.4.m4.1b"><apply id="A1.SS2.SSS1.p3.4.m4.1.1.cmml" xref="A1.SS2.SSS1.p3.4.m4.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSS1.p3.4.m4.1.1.1.cmml" xref="A1.SS2.SSS1.p3.4.m4.1.1">subscript</csymbol><ci id="A1.SS2.SSS1.p3.4.m4.1.1.2.cmml" xref="A1.SS2.SSS1.p3.4.m4.1.1.2">𝑥</ci><ci id="A1.SS2.SSS1.p3.4.m4.1.1.3.cmml" xref="A1.SS2.SSS1.p3.4.m4.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p3.4.m4.1c">x_{j}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p3.4.m4.1d">italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> are forerunner tokens of the input sequence can be written as:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A6.EGx1">
<tbody id="A1.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\left\langle\delta(x_{i}),\delta(x_{j})\right\rangle" class="ltx_Math" display="inline" id="A1.E3.m1.2"><semantics id="A1.E3.m1.2a"><mrow id="A1.E3.m1.2.2.2" xref="A1.E3.m1.2.2.3.cmml"><mo id="A1.E3.m1.2.2.2.3" xref="A1.E3.m1.2.2.3.cmml">⟨</mo><mrow id="A1.E3.m1.1.1.1.1" xref="A1.E3.m1.1.1.1.1.cmml"><mi id="A1.E3.m1.1.1.1.1.3" xref="A1.E3.m1.1.1.1.1.3.cmml">δ</mi><mo id="A1.E3.m1.1.1.1.1.2" xref="A1.E3.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E3.m1.1.1.1.1.1.1" xref="A1.E3.m1.1.1.1.1.1.1.1.cmml"><mo id="A1.E3.m1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E3.m1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A1.E3.m1.1.1.1.1.1.1.1" xref="A1.E3.m1.1.1.1.1.1.1.1.cmml"><mi id="A1.E3.m1.1.1.1.1.1.1.1.2" xref="A1.E3.m1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="A1.E3.m1.1.1.1.1.1.1.1.3" xref="A1.E3.m1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.E3.m1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E3.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E3.m1.2.2.2.4" xref="A1.E3.m1.2.2.3.cmml">,</mo><mrow id="A1.E3.m1.2.2.2.2" xref="A1.E3.m1.2.2.2.2.cmml"><mi id="A1.E3.m1.2.2.2.2.3" xref="A1.E3.m1.2.2.2.2.3.cmml">δ</mi><mo id="A1.E3.m1.2.2.2.2.2" xref="A1.E3.m1.2.2.2.2.2.cmml">⁢</mo><mrow id="A1.E3.m1.2.2.2.2.1.1" xref="A1.E3.m1.2.2.2.2.1.1.1.cmml"><mo id="A1.E3.m1.2.2.2.2.1.1.2" stretchy="false" xref="A1.E3.m1.2.2.2.2.1.1.1.cmml">(</mo><msub id="A1.E3.m1.2.2.2.2.1.1.1" xref="A1.E3.m1.2.2.2.2.1.1.1.cmml"><mi id="A1.E3.m1.2.2.2.2.1.1.1.2" xref="A1.E3.m1.2.2.2.2.1.1.1.2.cmml">x</mi><mi id="A1.E3.m1.2.2.2.2.1.1.1.3" xref="A1.E3.m1.2.2.2.2.1.1.1.3.cmml">j</mi></msub><mo id="A1.E3.m1.2.2.2.2.1.1.3" stretchy="false" xref="A1.E3.m1.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E3.m1.2.2.2.5" xref="A1.E3.m1.2.2.3.cmml">⟩</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E3.m1.2b"><list id="A1.E3.m1.2.2.3.cmml" xref="A1.E3.m1.2.2.2"><apply id="A1.E3.m1.1.1.1.1.cmml" xref="A1.E3.m1.1.1.1.1"><times id="A1.E3.m1.1.1.1.1.2.cmml" xref="A1.E3.m1.1.1.1.1.2"></times><ci id="A1.E3.m1.1.1.1.1.3.cmml" xref="A1.E3.m1.1.1.1.1.3">𝛿</ci><apply id="A1.E3.m1.1.1.1.1.1.1.1.cmml" xref="A1.E3.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E3.m1.1.1.1.1.1.1.1.1.cmml" xref="A1.E3.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E3.m1.1.1.1.1.1.1.1.2.cmml" xref="A1.E3.m1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="A1.E3.m1.1.1.1.1.1.1.1.3.cmml" xref="A1.E3.m1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="A1.E3.m1.2.2.2.2.cmml" xref="A1.E3.m1.2.2.2.2"><times id="A1.E3.m1.2.2.2.2.2.cmml" xref="A1.E3.m1.2.2.2.2.2"></times><ci id="A1.E3.m1.2.2.2.2.3.cmml" xref="A1.E3.m1.2.2.2.2.3">𝛿</ci><apply id="A1.E3.m1.2.2.2.2.1.1.1.cmml" xref="A1.E3.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="A1.E3.m1.2.2.2.2.1.1.1.1.cmml" xref="A1.E3.m1.2.2.2.2.1.1">subscript</csymbol><ci id="A1.E3.m1.2.2.2.2.1.1.1.2.cmml" xref="A1.E3.m1.2.2.2.2.1.1.1.2">𝑥</ci><ci id="A1.E3.m1.2.2.2.2.1.1.1.3.cmml" xref="A1.E3.m1.2.2.2.2.1.1.1.3">𝑗</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="A1.E3.m1.2c">\displaystyle\left\langle\delta(x_{i}),\delta(x_{j})\right\rangle</annotation><annotation encoding="application/x-llamapun" id="A1.E3.m1.2d">⟨ italic_δ ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) , italic_δ ( italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ⟩</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\left\langle e(x_{i})+\epsilon(p_{i}),e(x_{j})+\epsilon(p_{j})\right\rangle" class="ltx_Math" display="inline" id="A1.E3.m2.2"><semantics id="A1.E3.m2.2a"><mrow id="A1.E3.m2.2.2" xref="A1.E3.m2.2.2.cmml"><mi id="A1.E3.m2.2.2.4" xref="A1.E3.m2.2.2.4.cmml"></mi><mo id="A1.E3.m2.2.2.3" xref="A1.E3.m2.2.2.3.cmml">=</mo><mrow id="A1.E3.m2.2.2.2.2" xref="A1.E3.m2.2.2.2.3.cmml"><mo id="A1.E3.m2.2.2.2.2.3" xref="A1.E3.m2.2.2.2.3.cmml">⟨</mo><mrow id="A1.E3.m2.1.1.1.1.1" xref="A1.E3.m2.1.1.1.1.1.cmml"><mrow id="A1.E3.m2.1.1.1.1.1.1" xref="A1.E3.m2.1.1.1.1.1.1.cmml"><mi id="A1.E3.m2.1.1.1.1.1.1.3" xref="A1.E3.m2.1.1.1.1.1.1.3.cmml">e</mi><mo id="A1.E3.m2.1.1.1.1.1.1.2" xref="A1.E3.m2.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E3.m2.1.1.1.1.1.1.1.1" xref="A1.E3.m2.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E3.m2.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E3.m2.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A1.E3.m2.1.1.1.1.1.1.1.1.1" xref="A1.E3.m2.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E3.m2.1.1.1.1.1.1.1.1.1.2" xref="A1.E3.m2.1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="A1.E3.m2.1.1.1.1.1.1.1.1.1.3" xref="A1.E3.m2.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.E3.m2.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E3.m2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E3.m2.1.1.1.1.1.3" xref="A1.E3.m2.1.1.1.1.1.3.cmml">+</mo><mrow id="A1.E3.m2.1.1.1.1.1.2" xref="A1.E3.m2.1.1.1.1.1.2.cmml"><mi id="A1.E3.m2.1.1.1.1.1.2.3" xref="A1.E3.m2.1.1.1.1.1.2.3.cmml">ϵ</mi><mo id="A1.E3.m2.1.1.1.1.1.2.2" xref="A1.E3.m2.1.1.1.1.1.2.2.cmml">⁢</mo><mrow id="A1.E3.m2.1.1.1.1.1.2.1.1" xref="A1.E3.m2.1.1.1.1.1.2.1.1.1.cmml"><mo id="A1.E3.m2.1.1.1.1.1.2.1.1.2" stretchy="false" xref="A1.E3.m2.1.1.1.1.1.2.1.1.1.cmml">(</mo><msub id="A1.E3.m2.1.1.1.1.1.2.1.1.1" xref="A1.E3.m2.1.1.1.1.1.2.1.1.1.cmml"><mi id="A1.E3.m2.1.1.1.1.1.2.1.1.1.2" xref="A1.E3.m2.1.1.1.1.1.2.1.1.1.2.cmml">p</mi><mi id="A1.E3.m2.1.1.1.1.1.2.1.1.1.3" xref="A1.E3.m2.1.1.1.1.1.2.1.1.1.3.cmml">i</mi></msub><mo id="A1.E3.m2.1.1.1.1.1.2.1.1.3" stretchy="false" xref="A1.E3.m2.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E3.m2.2.2.2.2.4" xref="A1.E3.m2.2.2.2.3.cmml">,</mo><mrow id="A1.E3.m2.2.2.2.2.2" xref="A1.E3.m2.2.2.2.2.2.cmml"><mrow id="A1.E3.m2.2.2.2.2.2.1" xref="A1.E3.m2.2.2.2.2.2.1.cmml"><mi id="A1.E3.m2.2.2.2.2.2.1.3" xref="A1.E3.m2.2.2.2.2.2.1.3.cmml">e</mi><mo id="A1.E3.m2.2.2.2.2.2.1.2" xref="A1.E3.m2.2.2.2.2.2.1.2.cmml">⁢</mo><mrow id="A1.E3.m2.2.2.2.2.2.1.1.1" xref="A1.E3.m2.2.2.2.2.2.1.1.1.1.cmml"><mo id="A1.E3.m2.2.2.2.2.2.1.1.1.2" stretchy="false" xref="A1.E3.m2.2.2.2.2.2.1.1.1.1.cmml">(</mo><msub id="A1.E3.m2.2.2.2.2.2.1.1.1.1" xref="A1.E3.m2.2.2.2.2.2.1.1.1.1.cmml"><mi id="A1.E3.m2.2.2.2.2.2.1.1.1.1.2" xref="A1.E3.m2.2.2.2.2.2.1.1.1.1.2.cmml">x</mi><mi id="A1.E3.m2.2.2.2.2.2.1.1.1.1.3" xref="A1.E3.m2.2.2.2.2.2.1.1.1.1.3.cmml">j</mi></msub><mo id="A1.E3.m2.2.2.2.2.2.1.1.1.3" stretchy="false" xref="A1.E3.m2.2.2.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E3.m2.2.2.2.2.2.3" xref="A1.E3.m2.2.2.2.2.2.3.cmml">+</mo><mrow id="A1.E3.m2.2.2.2.2.2.2" xref="A1.E3.m2.2.2.2.2.2.2.cmml"><mi id="A1.E3.m2.2.2.2.2.2.2.3" xref="A1.E3.m2.2.2.2.2.2.2.3.cmml">ϵ</mi><mo id="A1.E3.m2.2.2.2.2.2.2.2" xref="A1.E3.m2.2.2.2.2.2.2.2.cmml">⁢</mo><mrow id="A1.E3.m2.2.2.2.2.2.2.1.1" xref="A1.E3.m2.2.2.2.2.2.2.1.1.1.cmml"><mo id="A1.E3.m2.2.2.2.2.2.2.1.1.2" stretchy="false" xref="A1.E3.m2.2.2.2.2.2.2.1.1.1.cmml">(</mo><msub id="A1.E3.m2.2.2.2.2.2.2.1.1.1" xref="A1.E3.m2.2.2.2.2.2.2.1.1.1.cmml"><mi id="A1.E3.m2.2.2.2.2.2.2.1.1.1.2" xref="A1.E3.m2.2.2.2.2.2.2.1.1.1.2.cmml">p</mi><mi id="A1.E3.m2.2.2.2.2.2.2.1.1.1.3" xref="A1.E3.m2.2.2.2.2.2.2.1.1.1.3.cmml">j</mi></msub><mo id="A1.E3.m2.2.2.2.2.2.2.1.1.3" stretchy="false" xref="A1.E3.m2.2.2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E3.m2.2.2.2.2.5" xref="A1.E3.m2.2.2.2.3.cmml">⟩</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E3.m2.2b"><apply id="A1.E3.m2.2.2.cmml" xref="A1.E3.m2.2.2"><eq id="A1.E3.m2.2.2.3.cmml" xref="A1.E3.m2.2.2.3"></eq><csymbol cd="latexml" id="A1.E3.m2.2.2.4.cmml" xref="A1.E3.m2.2.2.4">absent</csymbol><list id="A1.E3.m2.2.2.2.3.cmml" xref="A1.E3.m2.2.2.2.2"><apply id="A1.E3.m2.1.1.1.1.1.cmml" xref="A1.E3.m2.1.1.1.1.1"><plus id="A1.E3.m2.1.1.1.1.1.3.cmml" xref="A1.E3.m2.1.1.1.1.1.3"></plus><apply id="A1.E3.m2.1.1.1.1.1.1.cmml" xref="A1.E3.m2.1.1.1.1.1.1"><times id="A1.E3.m2.1.1.1.1.1.1.2.cmml" xref="A1.E3.m2.1.1.1.1.1.1.2"></times><ci id="A1.E3.m2.1.1.1.1.1.1.3.cmml" xref="A1.E3.m2.1.1.1.1.1.1.3">𝑒</ci><apply id="A1.E3.m2.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E3.m2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E3.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E3.m2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E3.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E3.m2.1.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="A1.E3.m2.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E3.m2.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="A1.E3.m2.1.1.1.1.1.2.cmml" xref="A1.E3.m2.1.1.1.1.1.2"><times id="A1.E3.m2.1.1.1.1.1.2.2.cmml" xref="A1.E3.m2.1.1.1.1.1.2.2"></times><ci id="A1.E3.m2.1.1.1.1.1.2.3.cmml" xref="A1.E3.m2.1.1.1.1.1.2.3">italic-ϵ</ci><apply id="A1.E3.m2.1.1.1.1.1.2.1.1.1.cmml" xref="A1.E3.m2.1.1.1.1.1.2.1.1"><csymbol cd="ambiguous" id="A1.E3.m2.1.1.1.1.1.2.1.1.1.1.cmml" xref="A1.E3.m2.1.1.1.1.1.2.1.1">subscript</csymbol><ci id="A1.E3.m2.1.1.1.1.1.2.1.1.1.2.cmml" xref="A1.E3.m2.1.1.1.1.1.2.1.1.1.2">𝑝</ci><ci id="A1.E3.m2.1.1.1.1.1.2.1.1.1.3.cmml" xref="A1.E3.m2.1.1.1.1.1.2.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="A1.E3.m2.2.2.2.2.2.cmml" xref="A1.E3.m2.2.2.2.2.2"><plus id="A1.E3.m2.2.2.2.2.2.3.cmml" xref="A1.E3.m2.2.2.2.2.2.3"></plus><apply id="A1.E3.m2.2.2.2.2.2.1.cmml" xref="A1.E3.m2.2.2.2.2.2.1"><times id="A1.E3.m2.2.2.2.2.2.1.2.cmml" xref="A1.E3.m2.2.2.2.2.2.1.2"></times><ci id="A1.E3.m2.2.2.2.2.2.1.3.cmml" xref="A1.E3.m2.2.2.2.2.2.1.3">𝑒</ci><apply id="A1.E3.m2.2.2.2.2.2.1.1.1.1.cmml" xref="A1.E3.m2.2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="A1.E3.m2.2.2.2.2.2.1.1.1.1.1.cmml" xref="A1.E3.m2.2.2.2.2.2.1.1.1">subscript</csymbol><ci id="A1.E3.m2.2.2.2.2.2.1.1.1.1.2.cmml" xref="A1.E3.m2.2.2.2.2.2.1.1.1.1.2">𝑥</ci><ci id="A1.E3.m2.2.2.2.2.2.1.1.1.1.3.cmml" xref="A1.E3.m2.2.2.2.2.2.1.1.1.1.3">𝑗</ci></apply></apply><apply id="A1.E3.m2.2.2.2.2.2.2.cmml" xref="A1.E3.m2.2.2.2.2.2.2"><times id="A1.E3.m2.2.2.2.2.2.2.2.cmml" xref="A1.E3.m2.2.2.2.2.2.2.2"></times><ci id="A1.E3.m2.2.2.2.2.2.2.3.cmml" xref="A1.E3.m2.2.2.2.2.2.2.3">italic-ϵ</ci><apply id="A1.E3.m2.2.2.2.2.2.2.1.1.1.cmml" xref="A1.E3.m2.2.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="A1.E3.m2.2.2.2.2.2.2.1.1.1.1.cmml" xref="A1.E3.m2.2.2.2.2.2.2.1.1">subscript</csymbol><ci id="A1.E3.m2.2.2.2.2.2.2.1.1.1.2.cmml" xref="A1.E3.m2.2.2.2.2.2.2.1.1.1.2">𝑝</ci><ci id="A1.E3.m2.2.2.2.2.2.2.1.1.1.3.cmml" xref="A1.E3.m2.2.2.2.2.2.2.1.1.1.3">𝑗</ci></apply></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E3.m2.2c">\displaystyle=\left\langle e(x_{i})+\epsilon(p_{i}),e(x_{j})+\epsilon(p_{j})\right\rangle</annotation><annotation encoding="application/x-llamapun" id="A1.E3.m2.2d">= ⟨ italic_e ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) + italic_ϵ ( italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) , italic_e ( italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) + italic_ϵ ( italic_p start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ⟩</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
<tbody id="A1.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{\left\langle e(x_{i}),e(x_{j})\right\rangle+\left\langle e%
(x_{i}),\epsilon(p_{j})\right\rangle+\left\langle e(x_{j}),\epsilon(p_{i})%
\right\rangle+\left\langle\epsilon(p_{i}),\epsilon(p_{j})\right\rangle}{\left%
\|e(x_{i})+\epsilon(p_{i})\right\|_{2}\left\|e(x_{j})+\epsilon(p_{j})\right\|_%
{2}}." class="ltx_Math" display="inline" id="A1.E4.m1.11"><semantics id="A1.E4.m1.11a"><mrow id="A1.E4.m1.11.11.1" xref="A1.E4.m1.11.11.1.1.cmml"><mrow id="A1.E4.m1.11.11.1.1" xref="A1.E4.m1.11.11.1.1.cmml"><mi id="A1.E4.m1.11.11.1.1.2" xref="A1.E4.m1.11.11.1.1.2.cmml"></mi><mo id="A1.E4.m1.11.11.1.1.1" xref="A1.E4.m1.11.11.1.1.1.cmml">=</mo><mstyle displaystyle="true" id="A1.E4.m1.10.10" xref="A1.E4.m1.10.10.cmml"><mfrac id="A1.E4.m1.10.10a" xref="A1.E4.m1.10.10.cmml"><mrow id="A1.E4.m1.8.8.8" xref="A1.E4.m1.8.8.8.cmml"><mrow id="A1.E4.m1.2.2.2.2.2" xref="A1.E4.m1.2.2.2.2.3.cmml"><mo id="A1.E4.m1.2.2.2.2.2.3" xref="A1.E4.m1.2.2.2.2.3.cmml">⟨</mo><mrow id="A1.E4.m1.1.1.1.1.1.1" xref="A1.E4.m1.1.1.1.1.1.1.cmml"><mi id="A1.E4.m1.1.1.1.1.1.1.3" xref="A1.E4.m1.1.1.1.1.1.1.3.cmml">e</mi><mo id="A1.E4.m1.1.1.1.1.1.1.2" xref="A1.E4.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E4.m1.1.1.1.1.1.1.1.1" xref="A1.E4.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E4.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E4.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A1.E4.m1.1.1.1.1.1.1.1.1.1" xref="A1.E4.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E4.m1.1.1.1.1.1.1.1.1.1.2" xref="A1.E4.m1.1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="A1.E4.m1.1.1.1.1.1.1.1.1.1.3" xref="A1.E4.m1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.E4.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E4.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E4.m1.2.2.2.2.2.4" xref="A1.E4.m1.2.2.2.2.3.cmml">,</mo><mrow id="A1.E4.m1.2.2.2.2.2.2" xref="A1.E4.m1.2.2.2.2.2.2.cmml"><mi id="A1.E4.m1.2.2.2.2.2.2.3" xref="A1.E4.m1.2.2.2.2.2.2.3.cmml">e</mi><mo id="A1.E4.m1.2.2.2.2.2.2.2" xref="A1.E4.m1.2.2.2.2.2.2.2.cmml">⁢</mo><mrow id="A1.E4.m1.2.2.2.2.2.2.1.1" xref="A1.E4.m1.2.2.2.2.2.2.1.1.1.cmml"><mo id="A1.E4.m1.2.2.2.2.2.2.1.1.2" stretchy="false" xref="A1.E4.m1.2.2.2.2.2.2.1.1.1.cmml">(</mo><msub id="A1.E4.m1.2.2.2.2.2.2.1.1.1" xref="A1.E4.m1.2.2.2.2.2.2.1.1.1.cmml"><mi id="A1.E4.m1.2.2.2.2.2.2.1.1.1.2" xref="A1.E4.m1.2.2.2.2.2.2.1.1.1.2.cmml">x</mi><mi id="A1.E4.m1.2.2.2.2.2.2.1.1.1.3" xref="A1.E4.m1.2.2.2.2.2.2.1.1.1.3.cmml">j</mi></msub><mo id="A1.E4.m1.2.2.2.2.2.2.1.1.3" stretchy="false" xref="A1.E4.m1.2.2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E4.m1.2.2.2.2.2.5" xref="A1.E4.m1.2.2.2.2.3.cmml">⟩</mo></mrow><mo id="A1.E4.m1.8.8.8.9" xref="A1.E4.m1.8.8.8.9.cmml">+</mo><mrow id="A1.E4.m1.4.4.4.4.2" xref="A1.E4.m1.4.4.4.4.3.cmml"><mo id="A1.E4.m1.4.4.4.4.2.3" xref="A1.E4.m1.4.4.4.4.3.cmml">⟨</mo><mrow id="A1.E4.m1.3.3.3.3.1.1" xref="A1.E4.m1.3.3.3.3.1.1.cmml"><mi id="A1.E4.m1.3.3.3.3.1.1.3" xref="A1.E4.m1.3.3.3.3.1.1.3.cmml">e</mi><mo id="A1.E4.m1.3.3.3.3.1.1.2" xref="A1.E4.m1.3.3.3.3.1.1.2.cmml">⁢</mo><mrow id="A1.E4.m1.3.3.3.3.1.1.1.1" xref="A1.E4.m1.3.3.3.3.1.1.1.1.1.cmml"><mo id="A1.E4.m1.3.3.3.3.1.1.1.1.2" stretchy="false" xref="A1.E4.m1.3.3.3.3.1.1.1.1.1.cmml">(</mo><msub id="A1.E4.m1.3.3.3.3.1.1.1.1.1" xref="A1.E4.m1.3.3.3.3.1.1.1.1.1.cmml"><mi id="A1.E4.m1.3.3.3.3.1.1.1.1.1.2" xref="A1.E4.m1.3.3.3.3.1.1.1.1.1.2.cmml">x</mi><mi id="A1.E4.m1.3.3.3.3.1.1.1.1.1.3" xref="A1.E4.m1.3.3.3.3.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.E4.m1.3.3.3.3.1.1.1.1.3" stretchy="false" xref="A1.E4.m1.3.3.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E4.m1.4.4.4.4.2.4" xref="A1.E4.m1.4.4.4.4.3.cmml">,</mo><mrow id="A1.E4.m1.4.4.4.4.2.2" xref="A1.E4.m1.4.4.4.4.2.2.cmml"><mi id="A1.E4.m1.4.4.4.4.2.2.3" xref="A1.E4.m1.4.4.4.4.2.2.3.cmml">ϵ</mi><mo id="A1.E4.m1.4.4.4.4.2.2.2" xref="A1.E4.m1.4.4.4.4.2.2.2.cmml">⁢</mo><mrow id="A1.E4.m1.4.4.4.4.2.2.1.1" xref="A1.E4.m1.4.4.4.4.2.2.1.1.1.cmml"><mo id="A1.E4.m1.4.4.4.4.2.2.1.1.2" stretchy="false" xref="A1.E4.m1.4.4.4.4.2.2.1.1.1.cmml">(</mo><msub id="A1.E4.m1.4.4.4.4.2.2.1.1.1" xref="A1.E4.m1.4.4.4.4.2.2.1.1.1.cmml"><mi id="A1.E4.m1.4.4.4.4.2.2.1.1.1.2" xref="A1.E4.m1.4.4.4.4.2.2.1.1.1.2.cmml">p</mi><mi id="A1.E4.m1.4.4.4.4.2.2.1.1.1.3" xref="A1.E4.m1.4.4.4.4.2.2.1.1.1.3.cmml">j</mi></msub><mo id="A1.E4.m1.4.4.4.4.2.2.1.1.3" stretchy="false" xref="A1.E4.m1.4.4.4.4.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E4.m1.4.4.4.4.2.5" xref="A1.E4.m1.4.4.4.4.3.cmml">⟩</mo></mrow><mo id="A1.E4.m1.8.8.8.9a" xref="A1.E4.m1.8.8.8.9.cmml">+</mo><mrow id="A1.E4.m1.6.6.6.6.2" xref="A1.E4.m1.6.6.6.6.3.cmml"><mo id="A1.E4.m1.6.6.6.6.2.3" xref="A1.E4.m1.6.6.6.6.3.cmml">⟨</mo><mrow id="A1.E4.m1.5.5.5.5.1.1" xref="A1.E4.m1.5.5.5.5.1.1.cmml"><mi id="A1.E4.m1.5.5.5.5.1.1.3" xref="A1.E4.m1.5.5.5.5.1.1.3.cmml">e</mi><mo id="A1.E4.m1.5.5.5.5.1.1.2" xref="A1.E4.m1.5.5.5.5.1.1.2.cmml">⁢</mo><mrow id="A1.E4.m1.5.5.5.5.1.1.1.1" xref="A1.E4.m1.5.5.5.5.1.1.1.1.1.cmml"><mo id="A1.E4.m1.5.5.5.5.1.1.1.1.2" stretchy="false" xref="A1.E4.m1.5.5.5.5.1.1.1.1.1.cmml">(</mo><msub id="A1.E4.m1.5.5.5.5.1.1.1.1.1" xref="A1.E4.m1.5.5.5.5.1.1.1.1.1.cmml"><mi id="A1.E4.m1.5.5.5.5.1.1.1.1.1.2" xref="A1.E4.m1.5.5.5.5.1.1.1.1.1.2.cmml">x</mi><mi id="A1.E4.m1.5.5.5.5.1.1.1.1.1.3" xref="A1.E4.m1.5.5.5.5.1.1.1.1.1.3.cmml">j</mi></msub><mo id="A1.E4.m1.5.5.5.5.1.1.1.1.3" stretchy="false" xref="A1.E4.m1.5.5.5.5.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E4.m1.6.6.6.6.2.4" xref="A1.E4.m1.6.6.6.6.3.cmml">,</mo><mrow id="A1.E4.m1.6.6.6.6.2.2" xref="A1.E4.m1.6.6.6.6.2.2.cmml"><mi id="A1.E4.m1.6.6.6.6.2.2.3" xref="A1.E4.m1.6.6.6.6.2.2.3.cmml">ϵ</mi><mo id="A1.E4.m1.6.6.6.6.2.2.2" xref="A1.E4.m1.6.6.6.6.2.2.2.cmml">⁢</mo><mrow id="A1.E4.m1.6.6.6.6.2.2.1.1" xref="A1.E4.m1.6.6.6.6.2.2.1.1.1.cmml"><mo id="A1.E4.m1.6.6.6.6.2.2.1.1.2" stretchy="false" xref="A1.E4.m1.6.6.6.6.2.2.1.1.1.cmml">(</mo><msub id="A1.E4.m1.6.6.6.6.2.2.1.1.1" xref="A1.E4.m1.6.6.6.6.2.2.1.1.1.cmml"><mi id="A1.E4.m1.6.6.6.6.2.2.1.1.1.2" xref="A1.E4.m1.6.6.6.6.2.2.1.1.1.2.cmml">p</mi><mi id="A1.E4.m1.6.6.6.6.2.2.1.1.1.3" xref="A1.E4.m1.6.6.6.6.2.2.1.1.1.3.cmml">i</mi></msub><mo id="A1.E4.m1.6.6.6.6.2.2.1.1.3" stretchy="false" xref="A1.E4.m1.6.6.6.6.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E4.m1.6.6.6.6.2.5" xref="A1.E4.m1.6.6.6.6.3.cmml">⟩</mo></mrow><mo id="A1.E4.m1.8.8.8.9b" xref="A1.E4.m1.8.8.8.9.cmml">+</mo><mrow id="A1.E4.m1.8.8.8.8.2" xref="A1.E4.m1.8.8.8.8.3.cmml"><mo id="A1.E4.m1.8.8.8.8.2.3" xref="A1.E4.m1.8.8.8.8.3.cmml">⟨</mo><mrow id="A1.E4.m1.7.7.7.7.1.1" xref="A1.E4.m1.7.7.7.7.1.1.cmml"><mi id="A1.E4.m1.7.7.7.7.1.1.3" xref="A1.E4.m1.7.7.7.7.1.1.3.cmml">ϵ</mi><mo id="A1.E4.m1.7.7.7.7.1.1.2" xref="A1.E4.m1.7.7.7.7.1.1.2.cmml">⁢</mo><mrow id="A1.E4.m1.7.7.7.7.1.1.1.1" xref="A1.E4.m1.7.7.7.7.1.1.1.1.1.cmml"><mo id="A1.E4.m1.7.7.7.7.1.1.1.1.2" stretchy="false" xref="A1.E4.m1.7.7.7.7.1.1.1.1.1.cmml">(</mo><msub id="A1.E4.m1.7.7.7.7.1.1.1.1.1" xref="A1.E4.m1.7.7.7.7.1.1.1.1.1.cmml"><mi id="A1.E4.m1.7.7.7.7.1.1.1.1.1.2" xref="A1.E4.m1.7.7.7.7.1.1.1.1.1.2.cmml">p</mi><mi id="A1.E4.m1.7.7.7.7.1.1.1.1.1.3" xref="A1.E4.m1.7.7.7.7.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.E4.m1.7.7.7.7.1.1.1.1.3" stretchy="false" xref="A1.E4.m1.7.7.7.7.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E4.m1.8.8.8.8.2.4" xref="A1.E4.m1.8.8.8.8.3.cmml">,</mo><mrow id="A1.E4.m1.8.8.8.8.2.2" xref="A1.E4.m1.8.8.8.8.2.2.cmml"><mi id="A1.E4.m1.8.8.8.8.2.2.3" xref="A1.E4.m1.8.8.8.8.2.2.3.cmml">ϵ</mi><mo id="A1.E4.m1.8.8.8.8.2.2.2" xref="A1.E4.m1.8.8.8.8.2.2.2.cmml">⁢</mo><mrow id="A1.E4.m1.8.8.8.8.2.2.1.1" xref="A1.E4.m1.8.8.8.8.2.2.1.1.1.cmml"><mo id="A1.E4.m1.8.8.8.8.2.2.1.1.2" stretchy="false" xref="A1.E4.m1.8.8.8.8.2.2.1.1.1.cmml">(</mo><msub id="A1.E4.m1.8.8.8.8.2.2.1.1.1" xref="A1.E4.m1.8.8.8.8.2.2.1.1.1.cmml"><mi id="A1.E4.m1.8.8.8.8.2.2.1.1.1.2" xref="A1.E4.m1.8.8.8.8.2.2.1.1.1.2.cmml">p</mi><mi id="A1.E4.m1.8.8.8.8.2.2.1.1.1.3" xref="A1.E4.m1.8.8.8.8.2.2.1.1.1.3.cmml">j</mi></msub><mo id="A1.E4.m1.8.8.8.8.2.2.1.1.3" stretchy="false" xref="A1.E4.m1.8.8.8.8.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E4.m1.8.8.8.8.2.5" xref="A1.E4.m1.8.8.8.8.3.cmml">⟩</mo></mrow></mrow><mrow id="A1.E4.m1.10.10.10" xref="A1.E4.m1.10.10.10.cmml"><msub id="A1.E4.m1.9.9.9.1" xref="A1.E4.m1.9.9.9.1.cmml"><mrow id="A1.E4.m1.9.9.9.1.1.1" xref="A1.E4.m1.9.9.9.1.1.2.cmml"><mo id="A1.E4.m1.9.9.9.1.1.1.2" xref="A1.E4.m1.9.9.9.1.1.2.1.cmml">‖</mo><mrow id="A1.E4.m1.9.9.9.1.1.1.1" xref="A1.E4.m1.9.9.9.1.1.1.1.cmml"><mrow id="A1.E4.m1.9.9.9.1.1.1.1.1" xref="A1.E4.m1.9.9.9.1.1.1.1.1.cmml"><mi id="A1.E4.m1.9.9.9.1.1.1.1.1.3" xref="A1.E4.m1.9.9.9.1.1.1.1.1.3.cmml">e</mi><mo id="A1.E4.m1.9.9.9.1.1.1.1.1.2" xref="A1.E4.m1.9.9.9.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E4.m1.9.9.9.1.1.1.1.1.1.1" xref="A1.E4.m1.9.9.9.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E4.m1.9.9.9.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E4.m1.9.9.9.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A1.E4.m1.9.9.9.1.1.1.1.1.1.1.1" xref="A1.E4.m1.9.9.9.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E4.m1.9.9.9.1.1.1.1.1.1.1.1.2" xref="A1.E4.m1.9.9.9.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="A1.E4.m1.9.9.9.1.1.1.1.1.1.1.1.3" xref="A1.E4.m1.9.9.9.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.E4.m1.9.9.9.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E4.m1.9.9.9.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E4.m1.9.9.9.1.1.1.1.3" xref="A1.E4.m1.9.9.9.1.1.1.1.3.cmml">+</mo><mrow id="A1.E4.m1.9.9.9.1.1.1.1.2" xref="A1.E4.m1.9.9.9.1.1.1.1.2.cmml"><mi id="A1.E4.m1.9.9.9.1.1.1.1.2.3" xref="A1.E4.m1.9.9.9.1.1.1.1.2.3.cmml">ϵ</mi><mo id="A1.E4.m1.9.9.9.1.1.1.1.2.2" xref="A1.E4.m1.9.9.9.1.1.1.1.2.2.cmml">⁢</mo><mrow id="A1.E4.m1.9.9.9.1.1.1.1.2.1.1" xref="A1.E4.m1.9.9.9.1.1.1.1.2.1.1.1.cmml"><mo id="A1.E4.m1.9.9.9.1.1.1.1.2.1.1.2" stretchy="false" xref="A1.E4.m1.9.9.9.1.1.1.1.2.1.1.1.cmml">(</mo><msub id="A1.E4.m1.9.9.9.1.1.1.1.2.1.1.1" xref="A1.E4.m1.9.9.9.1.1.1.1.2.1.1.1.cmml"><mi id="A1.E4.m1.9.9.9.1.1.1.1.2.1.1.1.2" xref="A1.E4.m1.9.9.9.1.1.1.1.2.1.1.1.2.cmml">p</mi><mi id="A1.E4.m1.9.9.9.1.1.1.1.2.1.1.1.3" xref="A1.E4.m1.9.9.9.1.1.1.1.2.1.1.1.3.cmml">i</mi></msub><mo id="A1.E4.m1.9.9.9.1.1.1.1.2.1.1.3" stretchy="false" xref="A1.E4.m1.9.9.9.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E4.m1.9.9.9.1.1.1.3" xref="A1.E4.m1.9.9.9.1.1.2.1.cmml">‖</mo></mrow><mn id="A1.E4.m1.9.9.9.1.3" xref="A1.E4.m1.9.9.9.1.3.cmml">2</mn></msub><mo id="A1.E4.m1.10.10.10.3" xref="A1.E4.m1.10.10.10.3.cmml">⁢</mo><msub id="A1.E4.m1.10.10.10.2" xref="A1.E4.m1.10.10.10.2.cmml"><mrow id="A1.E4.m1.10.10.10.2.1.1" xref="A1.E4.m1.10.10.10.2.1.2.cmml"><mo id="A1.E4.m1.10.10.10.2.1.1.2" xref="A1.E4.m1.10.10.10.2.1.2.1.cmml">‖</mo><mrow id="A1.E4.m1.10.10.10.2.1.1.1" xref="A1.E4.m1.10.10.10.2.1.1.1.cmml"><mrow id="A1.E4.m1.10.10.10.2.1.1.1.1" xref="A1.E4.m1.10.10.10.2.1.1.1.1.cmml"><mi id="A1.E4.m1.10.10.10.2.1.1.1.1.3" xref="A1.E4.m1.10.10.10.2.1.1.1.1.3.cmml">e</mi><mo id="A1.E4.m1.10.10.10.2.1.1.1.1.2" xref="A1.E4.m1.10.10.10.2.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E4.m1.10.10.10.2.1.1.1.1.1.1" xref="A1.E4.m1.10.10.10.2.1.1.1.1.1.1.1.cmml"><mo id="A1.E4.m1.10.10.10.2.1.1.1.1.1.1.2" stretchy="false" xref="A1.E4.m1.10.10.10.2.1.1.1.1.1.1.1.cmml">(</mo><msub id="A1.E4.m1.10.10.10.2.1.1.1.1.1.1.1" xref="A1.E4.m1.10.10.10.2.1.1.1.1.1.1.1.cmml"><mi id="A1.E4.m1.10.10.10.2.1.1.1.1.1.1.1.2" xref="A1.E4.m1.10.10.10.2.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="A1.E4.m1.10.10.10.2.1.1.1.1.1.1.1.3" xref="A1.E4.m1.10.10.10.2.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="A1.E4.m1.10.10.10.2.1.1.1.1.1.1.3" stretchy="false" xref="A1.E4.m1.10.10.10.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E4.m1.10.10.10.2.1.1.1.3" xref="A1.E4.m1.10.10.10.2.1.1.1.3.cmml">+</mo><mrow id="A1.E4.m1.10.10.10.2.1.1.1.2" xref="A1.E4.m1.10.10.10.2.1.1.1.2.cmml"><mi id="A1.E4.m1.10.10.10.2.1.1.1.2.3" xref="A1.E4.m1.10.10.10.2.1.1.1.2.3.cmml">ϵ</mi><mo id="A1.E4.m1.10.10.10.2.1.1.1.2.2" xref="A1.E4.m1.10.10.10.2.1.1.1.2.2.cmml">⁢</mo><mrow id="A1.E4.m1.10.10.10.2.1.1.1.2.1.1" xref="A1.E4.m1.10.10.10.2.1.1.1.2.1.1.1.cmml"><mo id="A1.E4.m1.10.10.10.2.1.1.1.2.1.1.2" stretchy="false" xref="A1.E4.m1.10.10.10.2.1.1.1.2.1.1.1.cmml">(</mo><msub id="A1.E4.m1.10.10.10.2.1.1.1.2.1.1.1" xref="A1.E4.m1.10.10.10.2.1.1.1.2.1.1.1.cmml"><mi id="A1.E4.m1.10.10.10.2.1.1.1.2.1.1.1.2" xref="A1.E4.m1.10.10.10.2.1.1.1.2.1.1.1.2.cmml">p</mi><mi id="A1.E4.m1.10.10.10.2.1.1.1.2.1.1.1.3" xref="A1.E4.m1.10.10.10.2.1.1.1.2.1.1.1.3.cmml">j</mi></msub><mo id="A1.E4.m1.10.10.10.2.1.1.1.2.1.1.3" stretchy="false" xref="A1.E4.m1.10.10.10.2.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E4.m1.10.10.10.2.1.1.3" xref="A1.E4.m1.10.10.10.2.1.2.1.cmml">‖</mo></mrow><mn id="A1.E4.m1.10.10.10.2.3" xref="A1.E4.m1.10.10.10.2.3.cmml">2</mn></msub></mrow></mfrac></mstyle></mrow><mo id="A1.E4.m1.11.11.1.2" lspace="0em" xref="A1.E4.m1.11.11.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E4.m1.11b"><apply id="A1.E4.m1.11.11.1.1.cmml" xref="A1.E4.m1.11.11.1"><eq id="A1.E4.m1.11.11.1.1.1.cmml" xref="A1.E4.m1.11.11.1.1.1"></eq><csymbol cd="latexml" id="A1.E4.m1.11.11.1.1.2.cmml" xref="A1.E4.m1.11.11.1.1.2">absent</csymbol><apply id="A1.E4.m1.10.10.cmml" xref="A1.E4.m1.10.10"><divide id="A1.E4.m1.10.10.11.cmml" xref="A1.E4.m1.10.10"></divide><apply id="A1.E4.m1.8.8.8.cmml" xref="A1.E4.m1.8.8.8"><plus id="A1.E4.m1.8.8.8.9.cmml" xref="A1.E4.m1.8.8.8.9"></plus><list id="A1.E4.m1.2.2.2.2.3.cmml" xref="A1.E4.m1.2.2.2.2.2"><apply id="A1.E4.m1.1.1.1.1.1.1.cmml" xref="A1.E4.m1.1.1.1.1.1.1"><times id="A1.E4.m1.1.1.1.1.1.1.2.cmml" xref="A1.E4.m1.1.1.1.1.1.1.2"></times><ci id="A1.E4.m1.1.1.1.1.1.1.3.cmml" xref="A1.E4.m1.1.1.1.1.1.1.3">𝑒</ci><apply id="A1.E4.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E4.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E4.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E4.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E4.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E4.m1.1.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="A1.E4.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E4.m1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="A1.E4.m1.2.2.2.2.2.2.cmml" xref="A1.E4.m1.2.2.2.2.2.2"><times id="A1.E4.m1.2.2.2.2.2.2.2.cmml" xref="A1.E4.m1.2.2.2.2.2.2.2"></times><ci id="A1.E4.m1.2.2.2.2.2.2.3.cmml" xref="A1.E4.m1.2.2.2.2.2.2.3">𝑒</ci><apply id="A1.E4.m1.2.2.2.2.2.2.1.1.1.cmml" xref="A1.E4.m1.2.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="A1.E4.m1.2.2.2.2.2.2.1.1.1.1.cmml" xref="A1.E4.m1.2.2.2.2.2.2.1.1">subscript</csymbol><ci id="A1.E4.m1.2.2.2.2.2.2.1.1.1.2.cmml" xref="A1.E4.m1.2.2.2.2.2.2.1.1.1.2">𝑥</ci><ci id="A1.E4.m1.2.2.2.2.2.2.1.1.1.3.cmml" xref="A1.E4.m1.2.2.2.2.2.2.1.1.1.3">𝑗</ci></apply></apply></list><list id="A1.E4.m1.4.4.4.4.3.cmml" xref="A1.E4.m1.4.4.4.4.2"><apply id="A1.E4.m1.3.3.3.3.1.1.cmml" xref="A1.E4.m1.3.3.3.3.1.1"><times id="A1.E4.m1.3.3.3.3.1.1.2.cmml" xref="A1.E4.m1.3.3.3.3.1.1.2"></times><ci id="A1.E4.m1.3.3.3.3.1.1.3.cmml" xref="A1.E4.m1.3.3.3.3.1.1.3">𝑒</ci><apply id="A1.E4.m1.3.3.3.3.1.1.1.1.1.cmml" xref="A1.E4.m1.3.3.3.3.1.1.1.1"><csymbol cd="ambiguous" id="A1.E4.m1.3.3.3.3.1.1.1.1.1.1.cmml" xref="A1.E4.m1.3.3.3.3.1.1.1.1">subscript</csymbol><ci id="A1.E4.m1.3.3.3.3.1.1.1.1.1.2.cmml" xref="A1.E4.m1.3.3.3.3.1.1.1.1.1.2">𝑥</ci><ci id="A1.E4.m1.3.3.3.3.1.1.1.1.1.3.cmml" xref="A1.E4.m1.3.3.3.3.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="A1.E4.m1.4.4.4.4.2.2.cmml" xref="A1.E4.m1.4.4.4.4.2.2"><times id="A1.E4.m1.4.4.4.4.2.2.2.cmml" xref="A1.E4.m1.4.4.4.4.2.2.2"></times><ci id="A1.E4.m1.4.4.4.4.2.2.3.cmml" xref="A1.E4.m1.4.4.4.4.2.2.3">italic-ϵ</ci><apply id="A1.E4.m1.4.4.4.4.2.2.1.1.1.cmml" xref="A1.E4.m1.4.4.4.4.2.2.1.1"><csymbol cd="ambiguous" id="A1.E4.m1.4.4.4.4.2.2.1.1.1.1.cmml" xref="A1.E4.m1.4.4.4.4.2.2.1.1">subscript</csymbol><ci id="A1.E4.m1.4.4.4.4.2.2.1.1.1.2.cmml" xref="A1.E4.m1.4.4.4.4.2.2.1.1.1.2">𝑝</ci><ci id="A1.E4.m1.4.4.4.4.2.2.1.1.1.3.cmml" xref="A1.E4.m1.4.4.4.4.2.2.1.1.1.3">𝑗</ci></apply></apply></list><list id="A1.E4.m1.6.6.6.6.3.cmml" xref="A1.E4.m1.6.6.6.6.2"><apply id="A1.E4.m1.5.5.5.5.1.1.cmml" xref="A1.E4.m1.5.5.5.5.1.1"><times id="A1.E4.m1.5.5.5.5.1.1.2.cmml" xref="A1.E4.m1.5.5.5.5.1.1.2"></times><ci id="A1.E4.m1.5.5.5.5.1.1.3.cmml" xref="A1.E4.m1.5.5.5.5.1.1.3">𝑒</ci><apply id="A1.E4.m1.5.5.5.5.1.1.1.1.1.cmml" xref="A1.E4.m1.5.5.5.5.1.1.1.1"><csymbol cd="ambiguous" id="A1.E4.m1.5.5.5.5.1.1.1.1.1.1.cmml" xref="A1.E4.m1.5.5.5.5.1.1.1.1">subscript</csymbol><ci id="A1.E4.m1.5.5.5.5.1.1.1.1.1.2.cmml" xref="A1.E4.m1.5.5.5.5.1.1.1.1.1.2">𝑥</ci><ci id="A1.E4.m1.5.5.5.5.1.1.1.1.1.3.cmml" xref="A1.E4.m1.5.5.5.5.1.1.1.1.1.3">𝑗</ci></apply></apply><apply id="A1.E4.m1.6.6.6.6.2.2.cmml" xref="A1.E4.m1.6.6.6.6.2.2"><times id="A1.E4.m1.6.6.6.6.2.2.2.cmml" xref="A1.E4.m1.6.6.6.6.2.2.2"></times><ci id="A1.E4.m1.6.6.6.6.2.2.3.cmml" xref="A1.E4.m1.6.6.6.6.2.2.3">italic-ϵ</ci><apply id="A1.E4.m1.6.6.6.6.2.2.1.1.1.cmml" xref="A1.E4.m1.6.6.6.6.2.2.1.1"><csymbol cd="ambiguous" id="A1.E4.m1.6.6.6.6.2.2.1.1.1.1.cmml" xref="A1.E4.m1.6.6.6.6.2.2.1.1">subscript</csymbol><ci id="A1.E4.m1.6.6.6.6.2.2.1.1.1.2.cmml" xref="A1.E4.m1.6.6.6.6.2.2.1.1.1.2">𝑝</ci><ci id="A1.E4.m1.6.6.6.6.2.2.1.1.1.3.cmml" xref="A1.E4.m1.6.6.6.6.2.2.1.1.1.3">𝑖</ci></apply></apply></list><list id="A1.E4.m1.8.8.8.8.3.cmml" xref="A1.E4.m1.8.8.8.8.2"><apply id="A1.E4.m1.7.7.7.7.1.1.cmml" xref="A1.E4.m1.7.7.7.7.1.1"><times id="A1.E4.m1.7.7.7.7.1.1.2.cmml" xref="A1.E4.m1.7.7.7.7.1.1.2"></times><ci id="A1.E4.m1.7.7.7.7.1.1.3.cmml" xref="A1.E4.m1.7.7.7.7.1.1.3">italic-ϵ</ci><apply id="A1.E4.m1.7.7.7.7.1.1.1.1.1.cmml" xref="A1.E4.m1.7.7.7.7.1.1.1.1"><csymbol cd="ambiguous" id="A1.E4.m1.7.7.7.7.1.1.1.1.1.1.cmml" xref="A1.E4.m1.7.7.7.7.1.1.1.1">subscript</csymbol><ci id="A1.E4.m1.7.7.7.7.1.1.1.1.1.2.cmml" xref="A1.E4.m1.7.7.7.7.1.1.1.1.1.2">𝑝</ci><ci id="A1.E4.m1.7.7.7.7.1.1.1.1.1.3.cmml" xref="A1.E4.m1.7.7.7.7.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="A1.E4.m1.8.8.8.8.2.2.cmml" xref="A1.E4.m1.8.8.8.8.2.2"><times id="A1.E4.m1.8.8.8.8.2.2.2.cmml" xref="A1.E4.m1.8.8.8.8.2.2.2"></times><ci id="A1.E4.m1.8.8.8.8.2.2.3.cmml" xref="A1.E4.m1.8.8.8.8.2.2.3">italic-ϵ</ci><apply id="A1.E4.m1.8.8.8.8.2.2.1.1.1.cmml" xref="A1.E4.m1.8.8.8.8.2.2.1.1"><csymbol cd="ambiguous" id="A1.E4.m1.8.8.8.8.2.2.1.1.1.1.cmml" xref="A1.E4.m1.8.8.8.8.2.2.1.1">subscript</csymbol><ci id="A1.E4.m1.8.8.8.8.2.2.1.1.1.2.cmml" xref="A1.E4.m1.8.8.8.8.2.2.1.1.1.2">𝑝</ci><ci id="A1.E4.m1.8.8.8.8.2.2.1.1.1.3.cmml" xref="A1.E4.m1.8.8.8.8.2.2.1.1.1.3">𝑗</ci></apply></apply></list></apply><apply id="A1.E4.m1.10.10.10.cmml" xref="A1.E4.m1.10.10.10"><times id="A1.E4.m1.10.10.10.3.cmml" xref="A1.E4.m1.10.10.10.3"></times><apply id="A1.E4.m1.9.9.9.1.cmml" xref="A1.E4.m1.9.9.9.1"><csymbol cd="ambiguous" id="A1.E4.m1.9.9.9.1.2.cmml" xref="A1.E4.m1.9.9.9.1">subscript</csymbol><apply id="A1.E4.m1.9.9.9.1.1.2.cmml" xref="A1.E4.m1.9.9.9.1.1.1"><csymbol cd="latexml" id="A1.E4.m1.9.9.9.1.1.2.1.cmml" xref="A1.E4.m1.9.9.9.1.1.1.2">norm</csymbol><apply id="A1.E4.m1.9.9.9.1.1.1.1.cmml" xref="A1.E4.m1.9.9.9.1.1.1.1"><plus id="A1.E4.m1.9.9.9.1.1.1.1.3.cmml" xref="A1.E4.m1.9.9.9.1.1.1.1.3"></plus><apply id="A1.E4.m1.9.9.9.1.1.1.1.1.cmml" xref="A1.E4.m1.9.9.9.1.1.1.1.1"><times id="A1.E4.m1.9.9.9.1.1.1.1.1.2.cmml" xref="A1.E4.m1.9.9.9.1.1.1.1.1.2"></times><ci id="A1.E4.m1.9.9.9.1.1.1.1.1.3.cmml" xref="A1.E4.m1.9.9.9.1.1.1.1.1.3">𝑒</ci><apply id="A1.E4.m1.9.9.9.1.1.1.1.1.1.1.1.cmml" xref="A1.E4.m1.9.9.9.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E4.m1.9.9.9.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E4.m1.9.9.9.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E4.m1.9.9.9.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E4.m1.9.9.9.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="A1.E4.m1.9.9.9.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E4.m1.9.9.9.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="A1.E4.m1.9.9.9.1.1.1.1.2.cmml" xref="A1.E4.m1.9.9.9.1.1.1.1.2"><times id="A1.E4.m1.9.9.9.1.1.1.1.2.2.cmml" xref="A1.E4.m1.9.9.9.1.1.1.1.2.2"></times><ci id="A1.E4.m1.9.9.9.1.1.1.1.2.3.cmml" xref="A1.E4.m1.9.9.9.1.1.1.1.2.3">italic-ϵ</ci><apply id="A1.E4.m1.9.9.9.1.1.1.1.2.1.1.1.cmml" xref="A1.E4.m1.9.9.9.1.1.1.1.2.1.1"><csymbol cd="ambiguous" id="A1.E4.m1.9.9.9.1.1.1.1.2.1.1.1.1.cmml" xref="A1.E4.m1.9.9.9.1.1.1.1.2.1.1">subscript</csymbol><ci id="A1.E4.m1.9.9.9.1.1.1.1.2.1.1.1.2.cmml" xref="A1.E4.m1.9.9.9.1.1.1.1.2.1.1.1.2">𝑝</ci><ci id="A1.E4.m1.9.9.9.1.1.1.1.2.1.1.1.3.cmml" xref="A1.E4.m1.9.9.9.1.1.1.1.2.1.1.1.3">𝑖</ci></apply></apply></apply></apply><cn id="A1.E4.m1.9.9.9.1.3.cmml" type="integer" xref="A1.E4.m1.9.9.9.1.3">2</cn></apply><apply id="A1.E4.m1.10.10.10.2.cmml" xref="A1.E4.m1.10.10.10.2"><csymbol cd="ambiguous" id="A1.E4.m1.10.10.10.2.2.cmml" xref="A1.E4.m1.10.10.10.2">subscript</csymbol><apply id="A1.E4.m1.10.10.10.2.1.2.cmml" xref="A1.E4.m1.10.10.10.2.1.1"><csymbol cd="latexml" id="A1.E4.m1.10.10.10.2.1.2.1.cmml" xref="A1.E4.m1.10.10.10.2.1.1.2">norm</csymbol><apply id="A1.E4.m1.10.10.10.2.1.1.1.cmml" xref="A1.E4.m1.10.10.10.2.1.1.1"><plus id="A1.E4.m1.10.10.10.2.1.1.1.3.cmml" xref="A1.E4.m1.10.10.10.2.1.1.1.3"></plus><apply id="A1.E4.m1.10.10.10.2.1.1.1.1.cmml" xref="A1.E4.m1.10.10.10.2.1.1.1.1"><times id="A1.E4.m1.10.10.10.2.1.1.1.1.2.cmml" xref="A1.E4.m1.10.10.10.2.1.1.1.1.2"></times><ci id="A1.E4.m1.10.10.10.2.1.1.1.1.3.cmml" xref="A1.E4.m1.10.10.10.2.1.1.1.1.3">𝑒</ci><apply id="A1.E4.m1.10.10.10.2.1.1.1.1.1.1.1.cmml" xref="A1.E4.m1.10.10.10.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E4.m1.10.10.10.2.1.1.1.1.1.1.1.1.cmml" xref="A1.E4.m1.10.10.10.2.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E4.m1.10.10.10.2.1.1.1.1.1.1.1.2.cmml" xref="A1.E4.m1.10.10.10.2.1.1.1.1.1.1.1.2">𝑥</ci><ci id="A1.E4.m1.10.10.10.2.1.1.1.1.1.1.1.3.cmml" xref="A1.E4.m1.10.10.10.2.1.1.1.1.1.1.1.3">𝑗</ci></apply></apply><apply id="A1.E4.m1.10.10.10.2.1.1.1.2.cmml" xref="A1.E4.m1.10.10.10.2.1.1.1.2"><times id="A1.E4.m1.10.10.10.2.1.1.1.2.2.cmml" xref="A1.E4.m1.10.10.10.2.1.1.1.2.2"></times><ci id="A1.E4.m1.10.10.10.2.1.1.1.2.3.cmml" xref="A1.E4.m1.10.10.10.2.1.1.1.2.3">italic-ϵ</ci><apply id="A1.E4.m1.10.10.10.2.1.1.1.2.1.1.1.cmml" xref="A1.E4.m1.10.10.10.2.1.1.1.2.1.1"><csymbol cd="ambiguous" id="A1.E4.m1.10.10.10.2.1.1.1.2.1.1.1.1.cmml" xref="A1.E4.m1.10.10.10.2.1.1.1.2.1.1">subscript</csymbol><ci id="A1.E4.m1.10.10.10.2.1.1.1.2.1.1.1.2.cmml" xref="A1.E4.m1.10.10.10.2.1.1.1.2.1.1.1.2">𝑝</ci><ci id="A1.E4.m1.10.10.10.2.1.1.1.2.1.1.1.3.cmml" xref="A1.E4.m1.10.10.10.2.1.1.1.2.1.1.1.3">𝑗</ci></apply></apply></apply></apply><cn id="A1.E4.m1.10.10.10.2.3.cmml" type="integer" xref="A1.E4.m1.10.10.10.2.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E4.m1.11c">\displaystyle=\frac{\left\langle e(x_{i}),e(x_{j})\right\rangle+\left\langle e%
(x_{i}),\epsilon(p_{j})\right\rangle+\left\langle e(x_{j}),\epsilon(p_{i})%
\right\rangle+\left\langle\epsilon(p_{i}),\epsilon(p_{j})\right\rangle}{\left%
\|e(x_{i})+\epsilon(p_{i})\right\|_{2}\left\|e(x_{j})+\epsilon(p_{j})\right\|_%
{2}}.</annotation><annotation encoding="application/x-llamapun" id="A1.E4.m1.11d">= divide start_ARG ⟨ italic_e ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) , italic_e ( italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ⟩ + ⟨ italic_e ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) , italic_ϵ ( italic_p start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ⟩ + ⟨ italic_e ( italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) , italic_ϵ ( italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ⟩ + ⟨ italic_ϵ ( italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) , italic_ϵ ( italic_p start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ⟩ end_ARG start_ARG ∥ italic_e ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) + italic_ϵ ( italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ∥ italic_e ( italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) + italic_ϵ ( italic_p start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS2.SSS1.p3.7">Denote <math alttext="B_{i,j}=\left\langle e(x_{i}),\epsilon(p_{j})\right\rangle+\left\langle e(x_{j%
}),\epsilon(p_{i})\right\rangle" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p3.5.m1.6"><semantics id="A1.SS2.SSS1.p3.5.m1.6a"><mrow id="A1.SS2.SSS1.p3.5.m1.6.6" xref="A1.SS2.SSS1.p3.5.m1.6.6.cmml"><msub id="A1.SS2.SSS1.p3.5.m1.6.6.6" xref="A1.SS2.SSS1.p3.5.m1.6.6.6.cmml"><mi id="A1.SS2.SSS1.p3.5.m1.6.6.6.2" xref="A1.SS2.SSS1.p3.5.m1.6.6.6.2.cmml">B</mi><mrow id="A1.SS2.SSS1.p3.5.m1.2.2.2.4" xref="A1.SS2.SSS1.p3.5.m1.2.2.2.3.cmml"><mi id="A1.SS2.SSS1.p3.5.m1.1.1.1.1" xref="A1.SS2.SSS1.p3.5.m1.1.1.1.1.cmml">i</mi><mo id="A1.SS2.SSS1.p3.5.m1.2.2.2.4.1" xref="A1.SS2.SSS1.p3.5.m1.2.2.2.3.cmml">,</mo><mi id="A1.SS2.SSS1.p3.5.m1.2.2.2.2" xref="A1.SS2.SSS1.p3.5.m1.2.2.2.2.cmml">j</mi></mrow></msub><mo id="A1.SS2.SSS1.p3.5.m1.6.6.5" xref="A1.SS2.SSS1.p3.5.m1.6.6.5.cmml">=</mo><mrow id="A1.SS2.SSS1.p3.5.m1.6.6.4" xref="A1.SS2.SSS1.p3.5.m1.6.6.4.cmml"><mrow id="A1.SS2.SSS1.p3.5.m1.4.4.2.2.2" xref="A1.SS2.SSS1.p3.5.m1.4.4.2.2.3.cmml"><mo id="A1.SS2.SSS1.p3.5.m1.4.4.2.2.2.3" xref="A1.SS2.SSS1.p3.5.m1.4.4.2.2.3.cmml">⟨</mo><mrow id="A1.SS2.SSS1.p3.5.m1.3.3.1.1.1.1" xref="A1.SS2.SSS1.p3.5.m1.3.3.1.1.1.1.cmml"><mi id="A1.SS2.SSS1.p3.5.m1.3.3.1.1.1.1.3" xref="A1.SS2.SSS1.p3.5.m1.3.3.1.1.1.1.3.cmml">e</mi><mo id="A1.SS2.SSS1.p3.5.m1.3.3.1.1.1.1.2" xref="A1.SS2.SSS1.p3.5.m1.3.3.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.SS2.SSS1.p3.5.m1.3.3.1.1.1.1.1.1" xref="A1.SS2.SSS1.p3.5.m1.3.3.1.1.1.1.1.1.1.cmml"><mo id="A1.SS2.SSS1.p3.5.m1.3.3.1.1.1.1.1.1.2" stretchy="false" xref="A1.SS2.SSS1.p3.5.m1.3.3.1.1.1.1.1.1.1.cmml">(</mo><msub id="A1.SS2.SSS1.p3.5.m1.3.3.1.1.1.1.1.1.1" xref="A1.SS2.SSS1.p3.5.m1.3.3.1.1.1.1.1.1.1.cmml"><mi id="A1.SS2.SSS1.p3.5.m1.3.3.1.1.1.1.1.1.1.2" xref="A1.SS2.SSS1.p3.5.m1.3.3.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="A1.SS2.SSS1.p3.5.m1.3.3.1.1.1.1.1.1.1.3" xref="A1.SS2.SSS1.p3.5.m1.3.3.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.SS2.SSS1.p3.5.m1.3.3.1.1.1.1.1.1.3" stretchy="false" xref="A1.SS2.SSS1.p3.5.m1.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.SS2.SSS1.p3.5.m1.4.4.2.2.2.4" xref="A1.SS2.SSS1.p3.5.m1.4.4.2.2.3.cmml">,</mo><mrow id="A1.SS2.SSS1.p3.5.m1.4.4.2.2.2.2" xref="A1.SS2.SSS1.p3.5.m1.4.4.2.2.2.2.cmml"><mi id="A1.SS2.SSS1.p3.5.m1.4.4.2.2.2.2.3" xref="A1.SS2.SSS1.p3.5.m1.4.4.2.2.2.2.3.cmml">ϵ</mi><mo id="A1.SS2.SSS1.p3.5.m1.4.4.2.2.2.2.2" xref="A1.SS2.SSS1.p3.5.m1.4.4.2.2.2.2.2.cmml">⁢</mo><mrow id="A1.SS2.SSS1.p3.5.m1.4.4.2.2.2.2.1.1" xref="A1.SS2.SSS1.p3.5.m1.4.4.2.2.2.2.1.1.1.cmml"><mo id="A1.SS2.SSS1.p3.5.m1.4.4.2.2.2.2.1.1.2" stretchy="false" xref="A1.SS2.SSS1.p3.5.m1.4.4.2.2.2.2.1.1.1.cmml">(</mo><msub id="A1.SS2.SSS1.p3.5.m1.4.4.2.2.2.2.1.1.1" xref="A1.SS2.SSS1.p3.5.m1.4.4.2.2.2.2.1.1.1.cmml"><mi id="A1.SS2.SSS1.p3.5.m1.4.4.2.2.2.2.1.1.1.2" xref="A1.SS2.SSS1.p3.5.m1.4.4.2.2.2.2.1.1.1.2.cmml">p</mi><mi id="A1.SS2.SSS1.p3.5.m1.4.4.2.2.2.2.1.1.1.3" xref="A1.SS2.SSS1.p3.5.m1.4.4.2.2.2.2.1.1.1.3.cmml">j</mi></msub><mo id="A1.SS2.SSS1.p3.5.m1.4.4.2.2.2.2.1.1.3" stretchy="false" xref="A1.SS2.SSS1.p3.5.m1.4.4.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.SS2.SSS1.p3.5.m1.4.4.2.2.2.5" xref="A1.SS2.SSS1.p3.5.m1.4.4.2.2.3.cmml">⟩</mo></mrow><mo id="A1.SS2.SSS1.p3.5.m1.6.6.4.5" xref="A1.SS2.SSS1.p3.5.m1.6.6.4.5.cmml">+</mo><mrow id="A1.SS2.SSS1.p3.5.m1.6.6.4.4.2" xref="A1.SS2.SSS1.p3.5.m1.6.6.4.4.3.cmml"><mo id="A1.SS2.SSS1.p3.5.m1.6.6.4.4.2.3" xref="A1.SS2.SSS1.p3.5.m1.6.6.4.4.3.cmml">⟨</mo><mrow id="A1.SS2.SSS1.p3.5.m1.5.5.3.3.1.1" xref="A1.SS2.SSS1.p3.5.m1.5.5.3.3.1.1.cmml"><mi id="A1.SS2.SSS1.p3.5.m1.5.5.3.3.1.1.3" xref="A1.SS2.SSS1.p3.5.m1.5.5.3.3.1.1.3.cmml">e</mi><mo id="A1.SS2.SSS1.p3.5.m1.5.5.3.3.1.1.2" xref="A1.SS2.SSS1.p3.5.m1.5.5.3.3.1.1.2.cmml">⁢</mo><mrow id="A1.SS2.SSS1.p3.5.m1.5.5.3.3.1.1.1.1" xref="A1.SS2.SSS1.p3.5.m1.5.5.3.3.1.1.1.1.1.cmml"><mo id="A1.SS2.SSS1.p3.5.m1.5.5.3.3.1.1.1.1.2" stretchy="false" xref="A1.SS2.SSS1.p3.5.m1.5.5.3.3.1.1.1.1.1.cmml">(</mo><msub id="A1.SS2.SSS1.p3.5.m1.5.5.3.3.1.1.1.1.1" xref="A1.SS2.SSS1.p3.5.m1.5.5.3.3.1.1.1.1.1.cmml"><mi id="A1.SS2.SSS1.p3.5.m1.5.5.3.3.1.1.1.1.1.2" xref="A1.SS2.SSS1.p3.5.m1.5.5.3.3.1.1.1.1.1.2.cmml">x</mi><mi id="A1.SS2.SSS1.p3.5.m1.5.5.3.3.1.1.1.1.1.3" xref="A1.SS2.SSS1.p3.5.m1.5.5.3.3.1.1.1.1.1.3.cmml">j</mi></msub><mo id="A1.SS2.SSS1.p3.5.m1.5.5.3.3.1.1.1.1.3" stretchy="false" xref="A1.SS2.SSS1.p3.5.m1.5.5.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.SS2.SSS1.p3.5.m1.6.6.4.4.2.4" xref="A1.SS2.SSS1.p3.5.m1.6.6.4.4.3.cmml">,</mo><mrow id="A1.SS2.SSS1.p3.5.m1.6.6.4.4.2.2" xref="A1.SS2.SSS1.p3.5.m1.6.6.4.4.2.2.cmml"><mi id="A1.SS2.SSS1.p3.5.m1.6.6.4.4.2.2.3" xref="A1.SS2.SSS1.p3.5.m1.6.6.4.4.2.2.3.cmml">ϵ</mi><mo id="A1.SS2.SSS1.p3.5.m1.6.6.4.4.2.2.2" xref="A1.SS2.SSS1.p3.5.m1.6.6.4.4.2.2.2.cmml">⁢</mo><mrow id="A1.SS2.SSS1.p3.5.m1.6.6.4.4.2.2.1.1" xref="A1.SS2.SSS1.p3.5.m1.6.6.4.4.2.2.1.1.1.cmml"><mo id="A1.SS2.SSS1.p3.5.m1.6.6.4.4.2.2.1.1.2" stretchy="false" xref="A1.SS2.SSS1.p3.5.m1.6.6.4.4.2.2.1.1.1.cmml">(</mo><msub id="A1.SS2.SSS1.p3.5.m1.6.6.4.4.2.2.1.1.1" xref="A1.SS2.SSS1.p3.5.m1.6.6.4.4.2.2.1.1.1.cmml"><mi id="A1.SS2.SSS1.p3.5.m1.6.6.4.4.2.2.1.1.1.2" xref="A1.SS2.SSS1.p3.5.m1.6.6.4.4.2.2.1.1.1.2.cmml">p</mi><mi id="A1.SS2.SSS1.p3.5.m1.6.6.4.4.2.2.1.1.1.3" xref="A1.SS2.SSS1.p3.5.m1.6.6.4.4.2.2.1.1.1.3.cmml">i</mi></msub><mo id="A1.SS2.SSS1.p3.5.m1.6.6.4.4.2.2.1.1.3" stretchy="false" xref="A1.SS2.SSS1.p3.5.m1.6.6.4.4.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.SS2.SSS1.p3.5.m1.6.6.4.4.2.5" xref="A1.SS2.SSS1.p3.5.m1.6.6.4.4.3.cmml">⟩</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p3.5.m1.6b"><apply id="A1.SS2.SSS1.p3.5.m1.6.6.cmml" xref="A1.SS2.SSS1.p3.5.m1.6.6"><eq id="A1.SS2.SSS1.p3.5.m1.6.6.5.cmml" xref="A1.SS2.SSS1.p3.5.m1.6.6.5"></eq><apply id="A1.SS2.SSS1.p3.5.m1.6.6.6.cmml" xref="A1.SS2.SSS1.p3.5.m1.6.6.6"><csymbol cd="ambiguous" id="A1.SS2.SSS1.p3.5.m1.6.6.6.1.cmml" xref="A1.SS2.SSS1.p3.5.m1.6.6.6">subscript</csymbol><ci id="A1.SS2.SSS1.p3.5.m1.6.6.6.2.cmml" xref="A1.SS2.SSS1.p3.5.m1.6.6.6.2">𝐵</ci><list id="A1.SS2.SSS1.p3.5.m1.2.2.2.3.cmml" xref="A1.SS2.SSS1.p3.5.m1.2.2.2.4"><ci id="A1.SS2.SSS1.p3.5.m1.1.1.1.1.cmml" xref="A1.SS2.SSS1.p3.5.m1.1.1.1.1">𝑖</ci><ci id="A1.SS2.SSS1.p3.5.m1.2.2.2.2.cmml" xref="A1.SS2.SSS1.p3.5.m1.2.2.2.2">𝑗</ci></list></apply><apply id="A1.SS2.SSS1.p3.5.m1.6.6.4.cmml" xref="A1.SS2.SSS1.p3.5.m1.6.6.4"><plus id="A1.SS2.SSS1.p3.5.m1.6.6.4.5.cmml" xref="A1.SS2.SSS1.p3.5.m1.6.6.4.5"></plus><list id="A1.SS2.SSS1.p3.5.m1.4.4.2.2.3.cmml" xref="A1.SS2.SSS1.p3.5.m1.4.4.2.2.2"><apply id="A1.SS2.SSS1.p3.5.m1.3.3.1.1.1.1.cmml" xref="A1.SS2.SSS1.p3.5.m1.3.3.1.1.1.1"><times id="A1.SS2.SSS1.p3.5.m1.3.3.1.1.1.1.2.cmml" xref="A1.SS2.SSS1.p3.5.m1.3.3.1.1.1.1.2"></times><ci id="A1.SS2.SSS1.p3.5.m1.3.3.1.1.1.1.3.cmml" xref="A1.SS2.SSS1.p3.5.m1.3.3.1.1.1.1.3">𝑒</ci><apply id="A1.SS2.SSS1.p3.5.m1.3.3.1.1.1.1.1.1.1.cmml" xref="A1.SS2.SSS1.p3.5.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSS1.p3.5.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="A1.SS2.SSS1.p3.5.m1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="A1.SS2.SSS1.p3.5.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="A1.SS2.SSS1.p3.5.m1.3.3.1.1.1.1.1.1.1.2">𝑥</ci><ci id="A1.SS2.SSS1.p3.5.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="A1.SS2.SSS1.p3.5.m1.3.3.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="A1.SS2.SSS1.p3.5.m1.4.4.2.2.2.2.cmml" xref="A1.SS2.SSS1.p3.5.m1.4.4.2.2.2.2"><times id="A1.SS2.SSS1.p3.5.m1.4.4.2.2.2.2.2.cmml" xref="A1.SS2.SSS1.p3.5.m1.4.4.2.2.2.2.2"></times><ci id="A1.SS2.SSS1.p3.5.m1.4.4.2.2.2.2.3.cmml" xref="A1.SS2.SSS1.p3.5.m1.4.4.2.2.2.2.3">italic-ϵ</ci><apply id="A1.SS2.SSS1.p3.5.m1.4.4.2.2.2.2.1.1.1.cmml" xref="A1.SS2.SSS1.p3.5.m1.4.4.2.2.2.2.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSS1.p3.5.m1.4.4.2.2.2.2.1.1.1.1.cmml" xref="A1.SS2.SSS1.p3.5.m1.4.4.2.2.2.2.1.1">subscript</csymbol><ci id="A1.SS2.SSS1.p3.5.m1.4.4.2.2.2.2.1.1.1.2.cmml" xref="A1.SS2.SSS1.p3.5.m1.4.4.2.2.2.2.1.1.1.2">𝑝</ci><ci id="A1.SS2.SSS1.p3.5.m1.4.4.2.2.2.2.1.1.1.3.cmml" xref="A1.SS2.SSS1.p3.5.m1.4.4.2.2.2.2.1.1.1.3">𝑗</ci></apply></apply></list><list id="A1.SS2.SSS1.p3.5.m1.6.6.4.4.3.cmml" xref="A1.SS2.SSS1.p3.5.m1.6.6.4.4.2"><apply id="A1.SS2.SSS1.p3.5.m1.5.5.3.3.1.1.cmml" xref="A1.SS2.SSS1.p3.5.m1.5.5.3.3.1.1"><times id="A1.SS2.SSS1.p3.5.m1.5.5.3.3.1.1.2.cmml" xref="A1.SS2.SSS1.p3.5.m1.5.5.3.3.1.1.2"></times><ci id="A1.SS2.SSS1.p3.5.m1.5.5.3.3.1.1.3.cmml" xref="A1.SS2.SSS1.p3.5.m1.5.5.3.3.1.1.3">𝑒</ci><apply id="A1.SS2.SSS1.p3.5.m1.5.5.3.3.1.1.1.1.1.cmml" xref="A1.SS2.SSS1.p3.5.m1.5.5.3.3.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSS1.p3.5.m1.5.5.3.3.1.1.1.1.1.1.cmml" xref="A1.SS2.SSS1.p3.5.m1.5.5.3.3.1.1.1.1">subscript</csymbol><ci id="A1.SS2.SSS1.p3.5.m1.5.5.3.3.1.1.1.1.1.2.cmml" xref="A1.SS2.SSS1.p3.5.m1.5.5.3.3.1.1.1.1.1.2">𝑥</ci><ci id="A1.SS2.SSS1.p3.5.m1.5.5.3.3.1.1.1.1.1.3.cmml" xref="A1.SS2.SSS1.p3.5.m1.5.5.3.3.1.1.1.1.1.3">𝑗</ci></apply></apply><apply id="A1.SS2.SSS1.p3.5.m1.6.6.4.4.2.2.cmml" xref="A1.SS2.SSS1.p3.5.m1.6.6.4.4.2.2"><times id="A1.SS2.SSS1.p3.5.m1.6.6.4.4.2.2.2.cmml" xref="A1.SS2.SSS1.p3.5.m1.6.6.4.4.2.2.2"></times><ci id="A1.SS2.SSS1.p3.5.m1.6.6.4.4.2.2.3.cmml" xref="A1.SS2.SSS1.p3.5.m1.6.6.4.4.2.2.3">italic-ϵ</ci><apply id="A1.SS2.SSS1.p3.5.m1.6.6.4.4.2.2.1.1.1.cmml" xref="A1.SS2.SSS1.p3.5.m1.6.6.4.4.2.2.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSS1.p3.5.m1.6.6.4.4.2.2.1.1.1.1.cmml" xref="A1.SS2.SSS1.p3.5.m1.6.6.4.4.2.2.1.1">subscript</csymbol><ci id="A1.SS2.SSS1.p3.5.m1.6.6.4.4.2.2.1.1.1.2.cmml" xref="A1.SS2.SSS1.p3.5.m1.6.6.4.4.2.2.1.1.1.2">𝑝</ci><ci id="A1.SS2.SSS1.p3.5.m1.6.6.4.4.2.2.1.1.1.3.cmml" xref="A1.SS2.SSS1.p3.5.m1.6.6.4.4.2.2.1.1.1.3">𝑖</ci></apply></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p3.5.m1.6c">B_{i,j}=\left\langle e(x_{i}),\epsilon(p_{j})\right\rangle+\left\langle e(x_{j%
}),\epsilon(p_{i})\right\rangle</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p3.5.m1.6d">italic_B start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT = ⟨ italic_e ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) , italic_ϵ ( italic_p start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ⟩ + ⟨ italic_e ( italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) , italic_ϵ ( italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ⟩</annotation></semantics></math>, <math alttext="C_{i,j}=\left\|e(x_{i})+\epsilon(p_{i})\right\|_{2}\left\|e(x_{j})+\epsilon(p_%
{j})\right\|_{2}" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p3.6.m2.4"><semantics id="A1.SS2.SSS1.p3.6.m2.4a"><mrow id="A1.SS2.SSS1.p3.6.m2.4.4" xref="A1.SS2.SSS1.p3.6.m2.4.4.cmml"><msub id="A1.SS2.SSS1.p3.6.m2.4.4.4" xref="A1.SS2.SSS1.p3.6.m2.4.4.4.cmml"><mi id="A1.SS2.SSS1.p3.6.m2.4.4.4.2" xref="A1.SS2.SSS1.p3.6.m2.4.4.4.2.cmml">C</mi><mrow id="A1.SS2.SSS1.p3.6.m2.2.2.2.4" xref="A1.SS2.SSS1.p3.6.m2.2.2.2.3.cmml"><mi id="A1.SS2.SSS1.p3.6.m2.1.1.1.1" xref="A1.SS2.SSS1.p3.6.m2.1.1.1.1.cmml">i</mi><mo id="A1.SS2.SSS1.p3.6.m2.2.2.2.4.1" xref="A1.SS2.SSS1.p3.6.m2.2.2.2.3.cmml">,</mo><mi id="A1.SS2.SSS1.p3.6.m2.2.2.2.2" xref="A1.SS2.SSS1.p3.6.m2.2.2.2.2.cmml">j</mi></mrow></msub><mo id="A1.SS2.SSS1.p3.6.m2.4.4.3" xref="A1.SS2.SSS1.p3.6.m2.4.4.3.cmml">=</mo><mrow id="A1.SS2.SSS1.p3.6.m2.4.4.2" xref="A1.SS2.SSS1.p3.6.m2.4.4.2.cmml"><msub id="A1.SS2.SSS1.p3.6.m2.3.3.1.1" xref="A1.SS2.SSS1.p3.6.m2.3.3.1.1.cmml"><mrow id="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1" xref="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.2.cmml"><mo id="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.2" xref="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.2.1.cmml">‖</mo><mrow id="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1" xref="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.cmml"><mrow id="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.1" xref="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.1.cmml"><mi id="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.1.3" xref="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.1.3.cmml">e</mi><mo id="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.1.2" xref="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.1.1.1" xref="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.1.1.1.1" xref="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.1.1.1.1.2" xref="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.1.1.1.1.3" xref="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.3" xref="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.3.cmml">+</mo><mrow id="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.2" xref="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.2.cmml"><mi id="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.2.3" xref="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.2.3.cmml">ϵ</mi><mo id="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.2.2" xref="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.2.2.cmml">⁢</mo><mrow id="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.2.1.1" xref="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.2.1.1.1.cmml"><mo id="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.2.1.1.2" stretchy="false" xref="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.2.1.1.1.cmml">(</mo><msub id="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.2.1.1.1" xref="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.2.1.1.1.cmml"><mi id="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.2.1.1.1.2" xref="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.2.1.1.1.2.cmml">p</mi><mi id="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.2.1.1.1.3" xref="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.2.1.1.1.3.cmml">i</mi></msub><mo id="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.2.1.1.3" stretchy="false" xref="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.3" xref="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.2.1.cmml">‖</mo></mrow><mn id="A1.SS2.SSS1.p3.6.m2.3.3.1.1.3" xref="A1.SS2.SSS1.p3.6.m2.3.3.1.1.3.cmml">2</mn></msub><mo id="A1.SS2.SSS1.p3.6.m2.4.4.2.3" xref="A1.SS2.SSS1.p3.6.m2.4.4.2.3.cmml">⁢</mo><msub id="A1.SS2.SSS1.p3.6.m2.4.4.2.2" xref="A1.SS2.SSS1.p3.6.m2.4.4.2.2.cmml"><mrow id="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1" xref="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.2.cmml"><mo id="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.2" xref="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.2.1.cmml">‖</mo><mrow id="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1" xref="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.cmml"><mrow id="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.1" xref="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.1.cmml"><mi id="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.1.3" xref="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.1.3.cmml">e</mi><mo id="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.1.2" xref="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.1.1.1" xref="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.1.1.1.1.cmml"><mo id="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.1.1.1.2" stretchy="false" xref="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.1.1.1.1.cmml">(</mo><msub id="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.1.1.1.1" xref="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.1.1.1.1.cmml"><mi id="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.1.1.1.1.2" xref="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.1.1.1.1.3" xref="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.1.1.1.3" stretchy="false" xref="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.3" xref="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.3.cmml">+</mo><mrow id="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.2" xref="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.2.cmml"><mi id="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.2.3" xref="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.2.3.cmml">ϵ</mi><mo id="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.2.2" xref="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.2.2.cmml">⁢</mo><mrow id="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.2.1.1" xref="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.2.1.1.1.cmml"><mo id="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.2.1.1.2" stretchy="false" xref="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.2.1.1.1.cmml">(</mo><msub id="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.2.1.1.1" xref="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.2.1.1.1.cmml"><mi id="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.2.1.1.1.2" xref="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.2.1.1.1.2.cmml">p</mi><mi id="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.2.1.1.1.3" xref="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.2.1.1.1.3.cmml">j</mi></msub><mo id="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.2.1.1.3" stretchy="false" xref="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.3" xref="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.2.1.cmml">‖</mo></mrow><mn id="A1.SS2.SSS1.p3.6.m2.4.4.2.2.3" xref="A1.SS2.SSS1.p3.6.m2.4.4.2.2.3.cmml">2</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p3.6.m2.4b"><apply id="A1.SS2.SSS1.p3.6.m2.4.4.cmml" xref="A1.SS2.SSS1.p3.6.m2.4.4"><eq id="A1.SS2.SSS1.p3.6.m2.4.4.3.cmml" xref="A1.SS2.SSS1.p3.6.m2.4.4.3"></eq><apply id="A1.SS2.SSS1.p3.6.m2.4.4.4.cmml" xref="A1.SS2.SSS1.p3.6.m2.4.4.4"><csymbol cd="ambiguous" id="A1.SS2.SSS1.p3.6.m2.4.4.4.1.cmml" xref="A1.SS2.SSS1.p3.6.m2.4.4.4">subscript</csymbol><ci id="A1.SS2.SSS1.p3.6.m2.4.4.4.2.cmml" xref="A1.SS2.SSS1.p3.6.m2.4.4.4.2">𝐶</ci><list id="A1.SS2.SSS1.p3.6.m2.2.2.2.3.cmml" xref="A1.SS2.SSS1.p3.6.m2.2.2.2.4"><ci id="A1.SS2.SSS1.p3.6.m2.1.1.1.1.cmml" xref="A1.SS2.SSS1.p3.6.m2.1.1.1.1">𝑖</ci><ci id="A1.SS2.SSS1.p3.6.m2.2.2.2.2.cmml" xref="A1.SS2.SSS1.p3.6.m2.2.2.2.2">𝑗</ci></list></apply><apply id="A1.SS2.SSS1.p3.6.m2.4.4.2.cmml" xref="A1.SS2.SSS1.p3.6.m2.4.4.2"><times id="A1.SS2.SSS1.p3.6.m2.4.4.2.3.cmml" xref="A1.SS2.SSS1.p3.6.m2.4.4.2.3"></times><apply id="A1.SS2.SSS1.p3.6.m2.3.3.1.1.cmml" xref="A1.SS2.SSS1.p3.6.m2.3.3.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSS1.p3.6.m2.3.3.1.1.2.cmml" xref="A1.SS2.SSS1.p3.6.m2.3.3.1.1">subscript</csymbol><apply id="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.2.cmml" xref="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1"><csymbol cd="latexml" id="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.2.1.cmml" xref="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.2">norm</csymbol><apply id="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.cmml" xref="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1"><plus id="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.3.cmml" xref="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.3"></plus><apply id="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.1.cmml" xref="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.1"><times id="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.1.2.cmml" xref="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.1.2"></times><ci id="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.1.3.cmml" xref="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.1.3">𝑒</ci><apply id="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.2.cmml" xref="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.2"><times id="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.2.2.cmml" xref="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.2.2"></times><ci id="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.2.3.cmml" xref="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.2.3">italic-ϵ</ci><apply id="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.2.1.1.1.cmml" xref="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.2.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.2.1.1.1.1.cmml" xref="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.2.1.1">subscript</csymbol><ci id="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.2.1.1.1.2.cmml" xref="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.2.1.1.1.2">𝑝</ci><ci id="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.2.1.1.1.3.cmml" xref="A1.SS2.SSS1.p3.6.m2.3.3.1.1.1.1.1.2.1.1.1.3">𝑖</ci></apply></apply></apply></apply><cn id="A1.SS2.SSS1.p3.6.m2.3.3.1.1.3.cmml" type="integer" xref="A1.SS2.SSS1.p3.6.m2.3.3.1.1.3">2</cn></apply><apply id="A1.SS2.SSS1.p3.6.m2.4.4.2.2.cmml" xref="A1.SS2.SSS1.p3.6.m2.4.4.2.2"><csymbol cd="ambiguous" id="A1.SS2.SSS1.p3.6.m2.4.4.2.2.2.cmml" xref="A1.SS2.SSS1.p3.6.m2.4.4.2.2">subscript</csymbol><apply id="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.2.cmml" xref="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1"><csymbol cd="latexml" id="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.2.1.cmml" xref="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.2">norm</csymbol><apply id="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.cmml" xref="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1"><plus id="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.3.cmml" xref="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.3"></plus><apply id="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.1.cmml" xref="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.1"><times id="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.1.2.cmml" xref="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.1.2"></times><ci id="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.1.3.cmml" xref="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.1.3">𝑒</ci><apply id="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.1.1.1.1.cmml" xref="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.1.1.1.1.1.cmml" xref="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.1.1.1.1.2.cmml" xref="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.1.1.1.1.2">𝑥</ci><ci id="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.1.1.1.1.3.cmml" xref="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.1.1.1.1.3">𝑗</ci></apply></apply><apply id="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.2.cmml" xref="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.2"><times id="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.2.2.cmml" xref="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.2.2"></times><ci id="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.2.3.cmml" xref="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.2.3">italic-ϵ</ci><apply id="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.2.1.1.1.cmml" xref="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.2.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.2.1.1.1.1.cmml" xref="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.2.1.1">subscript</csymbol><ci id="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.2.1.1.1.2.cmml" xref="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.2.1.1.1.2">𝑝</ci><ci id="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.2.1.1.1.3.cmml" xref="A1.SS2.SSS1.p3.6.m2.4.4.2.2.1.1.1.2.1.1.1.3">𝑗</ci></apply></apply></apply></apply><cn id="A1.SS2.SSS1.p3.6.m2.4.4.2.2.3.cmml" type="integer" xref="A1.SS2.SSS1.p3.6.m2.4.4.2.2.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p3.6.m2.4c">C_{i,j}=\left\|e(x_{i})+\epsilon(p_{i})\right\|_{2}\left\|e(x_{j})+\epsilon(p_%
{j})\right\|_{2}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p3.6.m2.4d">italic_C start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT = ∥ italic_e ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) + italic_ϵ ( italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ∥ italic_e ( italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) + italic_ϵ ( italic_p start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, and notice that <math alttext="x_{i}=x_{j}" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p3.7.m3.1"><semantics id="A1.SS2.SSS1.p3.7.m3.1a"><mrow id="A1.SS2.SSS1.p3.7.m3.1.1" xref="A1.SS2.SSS1.p3.7.m3.1.1.cmml"><msub id="A1.SS2.SSS1.p3.7.m3.1.1.2" xref="A1.SS2.SSS1.p3.7.m3.1.1.2.cmml"><mi id="A1.SS2.SSS1.p3.7.m3.1.1.2.2" xref="A1.SS2.SSS1.p3.7.m3.1.1.2.2.cmml">x</mi><mi id="A1.SS2.SSS1.p3.7.m3.1.1.2.3" xref="A1.SS2.SSS1.p3.7.m3.1.1.2.3.cmml">i</mi></msub><mo id="A1.SS2.SSS1.p3.7.m3.1.1.1" xref="A1.SS2.SSS1.p3.7.m3.1.1.1.cmml">=</mo><msub id="A1.SS2.SSS1.p3.7.m3.1.1.3" xref="A1.SS2.SSS1.p3.7.m3.1.1.3.cmml"><mi id="A1.SS2.SSS1.p3.7.m3.1.1.3.2" xref="A1.SS2.SSS1.p3.7.m3.1.1.3.2.cmml">x</mi><mi id="A1.SS2.SSS1.p3.7.m3.1.1.3.3" xref="A1.SS2.SSS1.p3.7.m3.1.1.3.3.cmml">j</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p3.7.m3.1b"><apply id="A1.SS2.SSS1.p3.7.m3.1.1.cmml" xref="A1.SS2.SSS1.p3.7.m3.1.1"><eq id="A1.SS2.SSS1.p3.7.m3.1.1.1.cmml" xref="A1.SS2.SSS1.p3.7.m3.1.1.1"></eq><apply id="A1.SS2.SSS1.p3.7.m3.1.1.2.cmml" xref="A1.SS2.SSS1.p3.7.m3.1.1.2"><csymbol cd="ambiguous" id="A1.SS2.SSS1.p3.7.m3.1.1.2.1.cmml" xref="A1.SS2.SSS1.p3.7.m3.1.1.2">subscript</csymbol><ci id="A1.SS2.SSS1.p3.7.m3.1.1.2.2.cmml" xref="A1.SS2.SSS1.p3.7.m3.1.1.2.2">𝑥</ci><ci id="A1.SS2.SSS1.p3.7.m3.1.1.2.3.cmml" xref="A1.SS2.SSS1.p3.7.m3.1.1.2.3">𝑖</ci></apply><apply id="A1.SS2.SSS1.p3.7.m3.1.1.3.cmml" xref="A1.SS2.SSS1.p3.7.m3.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.SSS1.p3.7.m3.1.1.3.1.cmml" xref="A1.SS2.SSS1.p3.7.m3.1.1.3">subscript</csymbol><ci id="A1.SS2.SSS1.p3.7.m3.1.1.3.2.cmml" xref="A1.SS2.SSS1.p3.7.m3.1.1.3.2">𝑥</ci><ci id="A1.SS2.SSS1.p3.7.m3.1.1.3.3.cmml" xref="A1.SS2.SSS1.p3.7.m3.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p3.7.m3.1c">x_{i}=x_{j}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p3.7.m3.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> since they are forerunner tokens which is kept consistent in experiments, we have:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="A1.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\left\langle\delta(x_{i}),\delta(x_{j})\right\rangle=\frac{1+B_{i,j}+\left%
\langle\epsilon(p_{i}),\epsilon(p_{j})\right\rangle}{C_{i,j}}." class="ltx_Math" display="block" id="A1.E5.m1.7"><semantics id="A1.E5.m1.7a"><mrow id="A1.E5.m1.7.7.1" xref="A1.E5.m1.7.7.1.1.cmml"><mrow id="A1.E5.m1.7.7.1.1" xref="A1.E5.m1.7.7.1.1.cmml"><mrow id="A1.E5.m1.7.7.1.1.2.2" xref="A1.E5.m1.7.7.1.1.2.3.cmml"><mo id="A1.E5.m1.7.7.1.1.2.2.3" xref="A1.E5.m1.7.7.1.1.2.3.cmml">⟨</mo><mrow id="A1.E5.m1.7.7.1.1.1.1.1" xref="A1.E5.m1.7.7.1.1.1.1.1.cmml"><mi id="A1.E5.m1.7.7.1.1.1.1.1.3" xref="A1.E5.m1.7.7.1.1.1.1.1.3.cmml">δ</mi><mo id="A1.E5.m1.7.7.1.1.1.1.1.2" xref="A1.E5.m1.7.7.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E5.m1.7.7.1.1.1.1.1.1.1" xref="A1.E5.m1.7.7.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E5.m1.7.7.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E5.m1.7.7.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A1.E5.m1.7.7.1.1.1.1.1.1.1.1" xref="A1.E5.m1.7.7.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E5.m1.7.7.1.1.1.1.1.1.1.1.2" xref="A1.E5.m1.7.7.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="A1.E5.m1.7.7.1.1.1.1.1.1.1.1.3" xref="A1.E5.m1.7.7.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.E5.m1.7.7.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E5.m1.7.7.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E5.m1.7.7.1.1.2.2.4" xref="A1.E5.m1.7.7.1.1.2.3.cmml">,</mo><mrow id="A1.E5.m1.7.7.1.1.2.2.2" xref="A1.E5.m1.7.7.1.1.2.2.2.cmml"><mi id="A1.E5.m1.7.7.1.1.2.2.2.3" xref="A1.E5.m1.7.7.1.1.2.2.2.3.cmml">δ</mi><mo id="A1.E5.m1.7.7.1.1.2.2.2.2" xref="A1.E5.m1.7.7.1.1.2.2.2.2.cmml">⁢</mo><mrow id="A1.E5.m1.7.7.1.1.2.2.2.1.1" xref="A1.E5.m1.7.7.1.1.2.2.2.1.1.1.cmml"><mo id="A1.E5.m1.7.7.1.1.2.2.2.1.1.2" stretchy="false" xref="A1.E5.m1.7.7.1.1.2.2.2.1.1.1.cmml">(</mo><msub id="A1.E5.m1.7.7.1.1.2.2.2.1.1.1" xref="A1.E5.m1.7.7.1.1.2.2.2.1.1.1.cmml"><mi id="A1.E5.m1.7.7.1.1.2.2.2.1.1.1.2" xref="A1.E5.m1.7.7.1.1.2.2.2.1.1.1.2.cmml">x</mi><mi id="A1.E5.m1.7.7.1.1.2.2.2.1.1.1.3" xref="A1.E5.m1.7.7.1.1.2.2.2.1.1.1.3.cmml">j</mi></msub><mo id="A1.E5.m1.7.7.1.1.2.2.2.1.1.3" stretchy="false" xref="A1.E5.m1.7.7.1.1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E5.m1.7.7.1.1.2.2.5" xref="A1.E5.m1.7.7.1.1.2.3.cmml">⟩</mo></mrow><mo id="A1.E5.m1.7.7.1.1.3" xref="A1.E5.m1.7.7.1.1.3.cmml">=</mo><mfrac id="A1.E5.m1.6.6" xref="A1.E5.m1.6.6.cmml"><mrow id="A1.E5.m1.4.4.4" xref="A1.E5.m1.4.4.4.cmml"><mn id="A1.E5.m1.4.4.4.6" xref="A1.E5.m1.4.4.4.6.cmml">1</mn><mo id="A1.E5.m1.4.4.4.5" xref="A1.E5.m1.4.4.4.5.cmml">+</mo><msub id="A1.E5.m1.4.4.4.7" xref="A1.E5.m1.4.4.4.7.cmml"><mi id="A1.E5.m1.4.4.4.7.2" xref="A1.E5.m1.4.4.4.7.2.cmml">B</mi><mrow id="A1.E5.m1.2.2.2.2.2.4" xref="A1.E5.m1.2.2.2.2.2.3.cmml"><mi id="A1.E5.m1.1.1.1.1.1.1" xref="A1.E5.m1.1.1.1.1.1.1.cmml">i</mi><mo id="A1.E5.m1.2.2.2.2.2.4.1" xref="A1.E5.m1.2.2.2.2.2.3.cmml">,</mo><mi id="A1.E5.m1.2.2.2.2.2.2" xref="A1.E5.m1.2.2.2.2.2.2.cmml">j</mi></mrow></msub><mo id="A1.E5.m1.4.4.4.5a" xref="A1.E5.m1.4.4.4.5.cmml">+</mo><mrow id="A1.E5.m1.4.4.4.4.2" xref="A1.E5.m1.4.4.4.4.3.cmml"><mo id="A1.E5.m1.4.4.4.4.2.3" xref="A1.E5.m1.4.4.4.4.3.cmml">⟨</mo><mrow id="A1.E5.m1.3.3.3.3.1.1" xref="A1.E5.m1.3.3.3.3.1.1.cmml"><mi id="A1.E5.m1.3.3.3.3.1.1.3" xref="A1.E5.m1.3.3.3.3.1.1.3.cmml">ϵ</mi><mo id="A1.E5.m1.3.3.3.3.1.1.2" xref="A1.E5.m1.3.3.3.3.1.1.2.cmml">⁢</mo><mrow id="A1.E5.m1.3.3.3.3.1.1.1.1" xref="A1.E5.m1.3.3.3.3.1.1.1.1.1.cmml"><mo id="A1.E5.m1.3.3.3.3.1.1.1.1.2" stretchy="false" xref="A1.E5.m1.3.3.3.3.1.1.1.1.1.cmml">(</mo><msub id="A1.E5.m1.3.3.3.3.1.1.1.1.1" xref="A1.E5.m1.3.3.3.3.1.1.1.1.1.cmml"><mi id="A1.E5.m1.3.3.3.3.1.1.1.1.1.2" xref="A1.E5.m1.3.3.3.3.1.1.1.1.1.2.cmml">p</mi><mi id="A1.E5.m1.3.3.3.3.1.1.1.1.1.3" xref="A1.E5.m1.3.3.3.3.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.E5.m1.3.3.3.3.1.1.1.1.3" stretchy="false" xref="A1.E5.m1.3.3.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E5.m1.4.4.4.4.2.4" xref="A1.E5.m1.4.4.4.4.3.cmml">,</mo><mrow id="A1.E5.m1.4.4.4.4.2.2" xref="A1.E5.m1.4.4.4.4.2.2.cmml"><mi id="A1.E5.m1.4.4.4.4.2.2.3" xref="A1.E5.m1.4.4.4.4.2.2.3.cmml">ϵ</mi><mo id="A1.E5.m1.4.4.4.4.2.2.2" xref="A1.E5.m1.4.4.4.4.2.2.2.cmml">⁢</mo><mrow id="A1.E5.m1.4.4.4.4.2.2.1.1" xref="A1.E5.m1.4.4.4.4.2.2.1.1.1.cmml"><mo id="A1.E5.m1.4.4.4.4.2.2.1.1.2" stretchy="false" xref="A1.E5.m1.4.4.4.4.2.2.1.1.1.cmml">(</mo><msub id="A1.E5.m1.4.4.4.4.2.2.1.1.1" xref="A1.E5.m1.4.4.4.4.2.2.1.1.1.cmml"><mi id="A1.E5.m1.4.4.4.4.2.2.1.1.1.2" xref="A1.E5.m1.4.4.4.4.2.2.1.1.1.2.cmml">p</mi><mi id="A1.E5.m1.4.4.4.4.2.2.1.1.1.3" xref="A1.E5.m1.4.4.4.4.2.2.1.1.1.3.cmml">j</mi></msub><mo id="A1.E5.m1.4.4.4.4.2.2.1.1.3" stretchy="false" xref="A1.E5.m1.4.4.4.4.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E5.m1.4.4.4.4.2.5" xref="A1.E5.m1.4.4.4.4.3.cmml">⟩</mo></mrow></mrow><msub id="A1.E5.m1.6.6.6" xref="A1.E5.m1.6.6.6.cmml"><mi id="A1.E5.m1.6.6.6.4" xref="A1.E5.m1.6.6.6.4.cmml">C</mi><mrow id="A1.E5.m1.6.6.6.2.2.4" xref="A1.E5.m1.6.6.6.2.2.3.cmml"><mi id="A1.E5.m1.5.5.5.1.1.1" xref="A1.E5.m1.5.5.5.1.1.1.cmml">i</mi><mo id="A1.E5.m1.6.6.6.2.2.4.1" xref="A1.E5.m1.6.6.6.2.2.3.cmml">,</mo><mi id="A1.E5.m1.6.6.6.2.2.2" xref="A1.E5.m1.6.6.6.2.2.2.cmml">j</mi></mrow></msub></mfrac></mrow><mo id="A1.E5.m1.7.7.1.2" lspace="0em" xref="A1.E5.m1.7.7.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E5.m1.7b"><apply id="A1.E5.m1.7.7.1.1.cmml" xref="A1.E5.m1.7.7.1"><eq id="A1.E5.m1.7.7.1.1.3.cmml" xref="A1.E5.m1.7.7.1.1.3"></eq><list id="A1.E5.m1.7.7.1.1.2.3.cmml" xref="A1.E5.m1.7.7.1.1.2.2"><apply id="A1.E5.m1.7.7.1.1.1.1.1.cmml" xref="A1.E5.m1.7.7.1.1.1.1.1"><times id="A1.E5.m1.7.7.1.1.1.1.1.2.cmml" xref="A1.E5.m1.7.7.1.1.1.1.1.2"></times><ci id="A1.E5.m1.7.7.1.1.1.1.1.3.cmml" xref="A1.E5.m1.7.7.1.1.1.1.1.3">𝛿</ci><apply id="A1.E5.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="A1.E5.m1.7.7.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E5.m1.7.7.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E5.m1.7.7.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E5.m1.7.7.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E5.m1.7.7.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="A1.E5.m1.7.7.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E5.m1.7.7.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="A1.E5.m1.7.7.1.1.2.2.2.cmml" xref="A1.E5.m1.7.7.1.1.2.2.2"><times id="A1.E5.m1.7.7.1.1.2.2.2.2.cmml" xref="A1.E5.m1.7.7.1.1.2.2.2.2"></times><ci id="A1.E5.m1.7.7.1.1.2.2.2.3.cmml" xref="A1.E5.m1.7.7.1.1.2.2.2.3">𝛿</ci><apply id="A1.E5.m1.7.7.1.1.2.2.2.1.1.1.cmml" xref="A1.E5.m1.7.7.1.1.2.2.2.1.1"><csymbol cd="ambiguous" id="A1.E5.m1.7.7.1.1.2.2.2.1.1.1.1.cmml" xref="A1.E5.m1.7.7.1.1.2.2.2.1.1">subscript</csymbol><ci id="A1.E5.m1.7.7.1.1.2.2.2.1.1.1.2.cmml" xref="A1.E5.m1.7.7.1.1.2.2.2.1.1.1.2">𝑥</ci><ci id="A1.E5.m1.7.7.1.1.2.2.2.1.1.1.3.cmml" xref="A1.E5.m1.7.7.1.1.2.2.2.1.1.1.3">𝑗</ci></apply></apply></list><apply id="A1.E5.m1.6.6.cmml" xref="A1.E5.m1.6.6"><divide id="A1.E5.m1.6.6.7.cmml" xref="A1.E5.m1.6.6"></divide><apply id="A1.E5.m1.4.4.4.cmml" xref="A1.E5.m1.4.4.4"><plus id="A1.E5.m1.4.4.4.5.cmml" xref="A1.E5.m1.4.4.4.5"></plus><cn id="A1.E5.m1.4.4.4.6.cmml" type="integer" xref="A1.E5.m1.4.4.4.6">1</cn><apply id="A1.E5.m1.4.4.4.7.cmml" xref="A1.E5.m1.4.4.4.7"><csymbol cd="ambiguous" id="A1.E5.m1.4.4.4.7.1.cmml" xref="A1.E5.m1.4.4.4.7">subscript</csymbol><ci id="A1.E5.m1.4.4.4.7.2.cmml" xref="A1.E5.m1.4.4.4.7.2">𝐵</ci><list id="A1.E5.m1.2.2.2.2.2.3.cmml" xref="A1.E5.m1.2.2.2.2.2.4"><ci id="A1.E5.m1.1.1.1.1.1.1.cmml" xref="A1.E5.m1.1.1.1.1.1.1">𝑖</ci><ci id="A1.E5.m1.2.2.2.2.2.2.cmml" xref="A1.E5.m1.2.2.2.2.2.2">𝑗</ci></list></apply><list id="A1.E5.m1.4.4.4.4.3.cmml" xref="A1.E5.m1.4.4.4.4.2"><apply id="A1.E5.m1.3.3.3.3.1.1.cmml" xref="A1.E5.m1.3.3.3.3.1.1"><times id="A1.E5.m1.3.3.3.3.1.1.2.cmml" xref="A1.E5.m1.3.3.3.3.1.1.2"></times><ci id="A1.E5.m1.3.3.3.3.1.1.3.cmml" xref="A1.E5.m1.3.3.3.3.1.1.3">italic-ϵ</ci><apply id="A1.E5.m1.3.3.3.3.1.1.1.1.1.cmml" xref="A1.E5.m1.3.3.3.3.1.1.1.1"><csymbol cd="ambiguous" id="A1.E5.m1.3.3.3.3.1.1.1.1.1.1.cmml" xref="A1.E5.m1.3.3.3.3.1.1.1.1">subscript</csymbol><ci id="A1.E5.m1.3.3.3.3.1.1.1.1.1.2.cmml" xref="A1.E5.m1.3.3.3.3.1.1.1.1.1.2">𝑝</ci><ci id="A1.E5.m1.3.3.3.3.1.1.1.1.1.3.cmml" xref="A1.E5.m1.3.3.3.3.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="A1.E5.m1.4.4.4.4.2.2.cmml" xref="A1.E5.m1.4.4.4.4.2.2"><times id="A1.E5.m1.4.4.4.4.2.2.2.cmml" xref="A1.E5.m1.4.4.4.4.2.2.2"></times><ci id="A1.E5.m1.4.4.4.4.2.2.3.cmml" xref="A1.E5.m1.4.4.4.4.2.2.3">italic-ϵ</ci><apply id="A1.E5.m1.4.4.4.4.2.2.1.1.1.cmml" xref="A1.E5.m1.4.4.4.4.2.2.1.1"><csymbol cd="ambiguous" id="A1.E5.m1.4.4.4.4.2.2.1.1.1.1.cmml" xref="A1.E5.m1.4.4.4.4.2.2.1.1">subscript</csymbol><ci id="A1.E5.m1.4.4.4.4.2.2.1.1.1.2.cmml" xref="A1.E5.m1.4.4.4.4.2.2.1.1.1.2">𝑝</ci><ci id="A1.E5.m1.4.4.4.4.2.2.1.1.1.3.cmml" xref="A1.E5.m1.4.4.4.4.2.2.1.1.1.3">𝑗</ci></apply></apply></list></apply><apply id="A1.E5.m1.6.6.6.cmml" xref="A1.E5.m1.6.6.6"><csymbol cd="ambiguous" id="A1.E5.m1.6.6.6.3.cmml" xref="A1.E5.m1.6.6.6">subscript</csymbol><ci id="A1.E5.m1.6.6.6.4.cmml" xref="A1.E5.m1.6.6.6.4">𝐶</ci><list id="A1.E5.m1.6.6.6.2.2.3.cmml" xref="A1.E5.m1.6.6.6.2.2.4"><ci id="A1.E5.m1.5.5.5.1.1.1.cmml" xref="A1.E5.m1.5.5.5.1.1.1">𝑖</ci><ci id="A1.E5.m1.6.6.6.2.2.2.cmml" xref="A1.E5.m1.6.6.6.2.2.2">𝑗</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E5.m1.7c">\left\langle\delta(x_{i}),\delta(x_{j})\right\rangle=\frac{1+B_{i,j}+\left%
\langle\epsilon(p_{i}),\epsilon(p_{j})\right\rangle}{C_{i,j}}.</annotation><annotation encoding="application/x-llamapun" id="A1.E5.m1.7d">⟨ italic_δ ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) , italic_δ ( italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ⟩ = divide start_ARG 1 + italic_B start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT + ⟨ italic_ϵ ( italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) , italic_ϵ ( italic_p start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ⟩ end_ARG start_ARG italic_C start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS2.SSS1.p3.9"><span class="ltx_text ltx_font_bold" id="A1.SS2.SSS1.p3.9.1">Similarity on Label Tokens.</span> Similarly, the cosine similarity between <math alttext="\delta(y_{i})" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p3.8.m1.1"><semantics id="A1.SS2.SSS1.p3.8.m1.1a"><mrow id="A1.SS2.SSS1.p3.8.m1.1.1" xref="A1.SS2.SSS1.p3.8.m1.1.1.cmml"><mi id="A1.SS2.SSS1.p3.8.m1.1.1.3" xref="A1.SS2.SSS1.p3.8.m1.1.1.3.cmml">δ</mi><mo id="A1.SS2.SSS1.p3.8.m1.1.1.2" xref="A1.SS2.SSS1.p3.8.m1.1.1.2.cmml">⁢</mo><mrow id="A1.SS2.SSS1.p3.8.m1.1.1.1.1" xref="A1.SS2.SSS1.p3.8.m1.1.1.1.1.1.cmml"><mo id="A1.SS2.SSS1.p3.8.m1.1.1.1.1.2" stretchy="false" xref="A1.SS2.SSS1.p3.8.m1.1.1.1.1.1.cmml">(</mo><msub id="A1.SS2.SSS1.p3.8.m1.1.1.1.1.1" xref="A1.SS2.SSS1.p3.8.m1.1.1.1.1.1.cmml"><mi id="A1.SS2.SSS1.p3.8.m1.1.1.1.1.1.2" xref="A1.SS2.SSS1.p3.8.m1.1.1.1.1.1.2.cmml">y</mi><mi id="A1.SS2.SSS1.p3.8.m1.1.1.1.1.1.3" xref="A1.SS2.SSS1.p3.8.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.SS2.SSS1.p3.8.m1.1.1.1.1.3" stretchy="false" xref="A1.SS2.SSS1.p3.8.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p3.8.m1.1b"><apply id="A1.SS2.SSS1.p3.8.m1.1.1.cmml" xref="A1.SS2.SSS1.p3.8.m1.1.1"><times id="A1.SS2.SSS1.p3.8.m1.1.1.2.cmml" xref="A1.SS2.SSS1.p3.8.m1.1.1.2"></times><ci id="A1.SS2.SSS1.p3.8.m1.1.1.3.cmml" xref="A1.SS2.SSS1.p3.8.m1.1.1.3">𝛿</ci><apply id="A1.SS2.SSS1.p3.8.m1.1.1.1.1.1.cmml" xref="A1.SS2.SSS1.p3.8.m1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSS1.p3.8.m1.1.1.1.1.1.1.cmml" xref="A1.SS2.SSS1.p3.8.m1.1.1.1.1">subscript</csymbol><ci id="A1.SS2.SSS1.p3.8.m1.1.1.1.1.1.2.cmml" xref="A1.SS2.SSS1.p3.8.m1.1.1.1.1.1.2">𝑦</ci><ci id="A1.SS2.SSS1.p3.8.m1.1.1.1.1.1.3.cmml" xref="A1.SS2.SSS1.p3.8.m1.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p3.8.m1.1c">\delta(y_{i})</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p3.8.m1.1d">italic_δ ( italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math> and <math alttext="\delta(y_{j})" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p3.9.m2.1"><semantics id="A1.SS2.SSS1.p3.9.m2.1a"><mrow id="A1.SS2.SSS1.p3.9.m2.1.1" xref="A1.SS2.SSS1.p3.9.m2.1.1.cmml"><mi id="A1.SS2.SSS1.p3.9.m2.1.1.3" xref="A1.SS2.SSS1.p3.9.m2.1.1.3.cmml">δ</mi><mo id="A1.SS2.SSS1.p3.9.m2.1.1.2" xref="A1.SS2.SSS1.p3.9.m2.1.1.2.cmml">⁢</mo><mrow id="A1.SS2.SSS1.p3.9.m2.1.1.1.1" xref="A1.SS2.SSS1.p3.9.m2.1.1.1.1.1.cmml"><mo id="A1.SS2.SSS1.p3.9.m2.1.1.1.1.2" stretchy="false" xref="A1.SS2.SSS1.p3.9.m2.1.1.1.1.1.cmml">(</mo><msub id="A1.SS2.SSS1.p3.9.m2.1.1.1.1.1" xref="A1.SS2.SSS1.p3.9.m2.1.1.1.1.1.cmml"><mi id="A1.SS2.SSS1.p3.9.m2.1.1.1.1.1.2" xref="A1.SS2.SSS1.p3.9.m2.1.1.1.1.1.2.cmml">y</mi><mi id="A1.SS2.SSS1.p3.9.m2.1.1.1.1.1.3" xref="A1.SS2.SSS1.p3.9.m2.1.1.1.1.1.3.cmml">j</mi></msub><mo id="A1.SS2.SSS1.p3.9.m2.1.1.1.1.3" stretchy="false" xref="A1.SS2.SSS1.p3.9.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p3.9.m2.1b"><apply id="A1.SS2.SSS1.p3.9.m2.1.1.cmml" xref="A1.SS2.SSS1.p3.9.m2.1.1"><times id="A1.SS2.SSS1.p3.9.m2.1.1.2.cmml" xref="A1.SS2.SSS1.p3.9.m2.1.1.2"></times><ci id="A1.SS2.SSS1.p3.9.m2.1.1.3.cmml" xref="A1.SS2.SSS1.p3.9.m2.1.1.3">𝛿</ci><apply id="A1.SS2.SSS1.p3.9.m2.1.1.1.1.1.cmml" xref="A1.SS2.SSS1.p3.9.m2.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSS1.p3.9.m2.1.1.1.1.1.1.cmml" xref="A1.SS2.SSS1.p3.9.m2.1.1.1.1">subscript</csymbol><ci id="A1.SS2.SSS1.p3.9.m2.1.1.1.1.1.2.cmml" xref="A1.SS2.SSS1.p3.9.m2.1.1.1.1.1.2">𝑦</ci><ci id="A1.SS2.SSS1.p3.9.m2.1.1.1.1.1.3.cmml" xref="A1.SS2.SSS1.p3.9.m2.1.1.1.1.1.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p3.9.m2.1c">\delta(y_{j})</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p3.9.m2.1d">italic_δ ( italic_y start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT )</annotation></semantics></math> on label tokens can be written as:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="A1.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\left\langle\delta(y_{i}),\delta(y_{j})\right\rangle=\frac{\left\langle e(y_{i%
}),e(y_{j})\right\rangle+B_{i,j}+\left\langle\epsilon(p_{i}),\epsilon(p_{j})%
\right\rangle}{C_{i,j}}." class="ltx_Math" display="block" id="A1.E6.m1.9"><semantics id="A1.E6.m1.9a"><mrow id="A1.E6.m1.9.9.1" xref="A1.E6.m1.9.9.1.1.cmml"><mrow id="A1.E6.m1.9.9.1.1" xref="A1.E6.m1.9.9.1.1.cmml"><mrow id="A1.E6.m1.9.9.1.1.2.2" xref="A1.E6.m1.9.9.1.1.2.3.cmml"><mo id="A1.E6.m1.9.9.1.1.2.2.3" xref="A1.E6.m1.9.9.1.1.2.3.cmml">⟨</mo><mrow id="A1.E6.m1.9.9.1.1.1.1.1" xref="A1.E6.m1.9.9.1.1.1.1.1.cmml"><mi id="A1.E6.m1.9.9.1.1.1.1.1.3" xref="A1.E6.m1.9.9.1.1.1.1.1.3.cmml">δ</mi><mo id="A1.E6.m1.9.9.1.1.1.1.1.2" xref="A1.E6.m1.9.9.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E6.m1.9.9.1.1.1.1.1.1.1" xref="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E6.m1.9.9.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A1.E6.m1.9.9.1.1.1.1.1.1.1.1" xref="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.2" xref="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.2.cmml">y</mi><mi id="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.3" xref="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.E6.m1.9.9.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E6.m1.9.9.1.1.2.2.4" xref="A1.E6.m1.9.9.1.1.2.3.cmml">,</mo><mrow id="A1.E6.m1.9.9.1.1.2.2.2" xref="A1.E6.m1.9.9.1.1.2.2.2.cmml"><mi id="A1.E6.m1.9.9.1.1.2.2.2.3" xref="A1.E6.m1.9.9.1.1.2.2.2.3.cmml">δ</mi><mo id="A1.E6.m1.9.9.1.1.2.2.2.2" xref="A1.E6.m1.9.9.1.1.2.2.2.2.cmml">⁢</mo><mrow id="A1.E6.m1.9.9.1.1.2.2.2.1.1" xref="A1.E6.m1.9.9.1.1.2.2.2.1.1.1.cmml"><mo id="A1.E6.m1.9.9.1.1.2.2.2.1.1.2" stretchy="false" xref="A1.E6.m1.9.9.1.1.2.2.2.1.1.1.cmml">(</mo><msub id="A1.E6.m1.9.9.1.1.2.2.2.1.1.1" xref="A1.E6.m1.9.9.1.1.2.2.2.1.1.1.cmml"><mi id="A1.E6.m1.9.9.1.1.2.2.2.1.1.1.2" xref="A1.E6.m1.9.9.1.1.2.2.2.1.1.1.2.cmml">y</mi><mi id="A1.E6.m1.9.9.1.1.2.2.2.1.1.1.3" xref="A1.E6.m1.9.9.1.1.2.2.2.1.1.1.3.cmml">j</mi></msub><mo id="A1.E6.m1.9.9.1.1.2.2.2.1.1.3" stretchy="false" xref="A1.E6.m1.9.9.1.1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E6.m1.9.9.1.1.2.2.5" xref="A1.E6.m1.9.9.1.1.2.3.cmml">⟩</mo></mrow><mo id="A1.E6.m1.9.9.1.1.3" xref="A1.E6.m1.9.9.1.1.3.cmml">=</mo><mfrac id="A1.E6.m1.8.8" xref="A1.E6.m1.8.8.cmml"><mrow id="A1.E6.m1.6.6.6" xref="A1.E6.m1.6.6.6.cmml"><mrow id="A1.E6.m1.4.4.4.4.2" xref="A1.E6.m1.4.4.4.4.3.cmml"><mo id="A1.E6.m1.4.4.4.4.2.3" xref="A1.E6.m1.4.4.4.4.3.cmml">⟨</mo><mrow id="A1.E6.m1.3.3.3.3.1.1" xref="A1.E6.m1.3.3.3.3.1.1.cmml"><mi id="A1.E6.m1.3.3.3.3.1.1.3" xref="A1.E6.m1.3.3.3.3.1.1.3.cmml">e</mi><mo id="A1.E6.m1.3.3.3.3.1.1.2" xref="A1.E6.m1.3.3.3.3.1.1.2.cmml">⁢</mo><mrow id="A1.E6.m1.3.3.3.3.1.1.1.1" xref="A1.E6.m1.3.3.3.3.1.1.1.1.1.cmml"><mo id="A1.E6.m1.3.3.3.3.1.1.1.1.2" stretchy="false" xref="A1.E6.m1.3.3.3.3.1.1.1.1.1.cmml">(</mo><msub id="A1.E6.m1.3.3.3.3.1.1.1.1.1" xref="A1.E6.m1.3.3.3.3.1.1.1.1.1.cmml"><mi id="A1.E6.m1.3.3.3.3.1.1.1.1.1.2" xref="A1.E6.m1.3.3.3.3.1.1.1.1.1.2.cmml">y</mi><mi id="A1.E6.m1.3.3.3.3.1.1.1.1.1.3" xref="A1.E6.m1.3.3.3.3.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.E6.m1.3.3.3.3.1.1.1.1.3" stretchy="false" xref="A1.E6.m1.3.3.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E6.m1.4.4.4.4.2.4" xref="A1.E6.m1.4.4.4.4.3.cmml">,</mo><mrow id="A1.E6.m1.4.4.4.4.2.2" xref="A1.E6.m1.4.4.4.4.2.2.cmml"><mi id="A1.E6.m1.4.4.4.4.2.2.3" xref="A1.E6.m1.4.4.4.4.2.2.3.cmml">e</mi><mo id="A1.E6.m1.4.4.4.4.2.2.2" xref="A1.E6.m1.4.4.4.4.2.2.2.cmml">⁢</mo><mrow id="A1.E6.m1.4.4.4.4.2.2.1.1" xref="A1.E6.m1.4.4.4.4.2.2.1.1.1.cmml"><mo id="A1.E6.m1.4.4.4.4.2.2.1.1.2" stretchy="false" xref="A1.E6.m1.4.4.4.4.2.2.1.1.1.cmml">(</mo><msub id="A1.E6.m1.4.4.4.4.2.2.1.1.1" xref="A1.E6.m1.4.4.4.4.2.2.1.1.1.cmml"><mi id="A1.E6.m1.4.4.4.4.2.2.1.1.1.2" xref="A1.E6.m1.4.4.4.4.2.2.1.1.1.2.cmml">y</mi><mi id="A1.E6.m1.4.4.4.4.2.2.1.1.1.3" xref="A1.E6.m1.4.4.4.4.2.2.1.1.1.3.cmml">j</mi></msub><mo id="A1.E6.m1.4.4.4.4.2.2.1.1.3" stretchy="false" xref="A1.E6.m1.4.4.4.4.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E6.m1.4.4.4.4.2.5" xref="A1.E6.m1.4.4.4.4.3.cmml">⟩</mo></mrow><mo id="A1.E6.m1.6.6.6.7" xref="A1.E6.m1.6.6.6.7.cmml">+</mo><msub id="A1.E6.m1.6.6.6.8" xref="A1.E6.m1.6.6.6.8.cmml"><mi id="A1.E6.m1.6.6.6.8.2" xref="A1.E6.m1.6.6.6.8.2.cmml">B</mi><mrow id="A1.E6.m1.2.2.2.2.2.4" xref="A1.E6.m1.2.2.2.2.2.3.cmml"><mi id="A1.E6.m1.1.1.1.1.1.1" xref="A1.E6.m1.1.1.1.1.1.1.cmml">i</mi><mo id="A1.E6.m1.2.2.2.2.2.4.1" xref="A1.E6.m1.2.2.2.2.2.3.cmml">,</mo><mi id="A1.E6.m1.2.2.2.2.2.2" xref="A1.E6.m1.2.2.2.2.2.2.cmml">j</mi></mrow></msub><mo id="A1.E6.m1.6.6.6.7a" xref="A1.E6.m1.6.6.6.7.cmml">+</mo><mrow id="A1.E6.m1.6.6.6.6.2" xref="A1.E6.m1.6.6.6.6.3.cmml"><mo id="A1.E6.m1.6.6.6.6.2.3" xref="A1.E6.m1.6.6.6.6.3.cmml">⟨</mo><mrow id="A1.E6.m1.5.5.5.5.1.1" xref="A1.E6.m1.5.5.5.5.1.1.cmml"><mi id="A1.E6.m1.5.5.5.5.1.1.3" xref="A1.E6.m1.5.5.5.5.1.1.3.cmml">ϵ</mi><mo id="A1.E6.m1.5.5.5.5.1.1.2" xref="A1.E6.m1.5.5.5.5.1.1.2.cmml">⁢</mo><mrow id="A1.E6.m1.5.5.5.5.1.1.1.1" xref="A1.E6.m1.5.5.5.5.1.1.1.1.1.cmml"><mo id="A1.E6.m1.5.5.5.5.1.1.1.1.2" stretchy="false" xref="A1.E6.m1.5.5.5.5.1.1.1.1.1.cmml">(</mo><msub id="A1.E6.m1.5.5.5.5.1.1.1.1.1" xref="A1.E6.m1.5.5.5.5.1.1.1.1.1.cmml"><mi id="A1.E6.m1.5.5.5.5.1.1.1.1.1.2" xref="A1.E6.m1.5.5.5.5.1.1.1.1.1.2.cmml">p</mi><mi id="A1.E6.m1.5.5.5.5.1.1.1.1.1.3" xref="A1.E6.m1.5.5.5.5.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.E6.m1.5.5.5.5.1.1.1.1.3" stretchy="false" xref="A1.E6.m1.5.5.5.5.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E6.m1.6.6.6.6.2.4" xref="A1.E6.m1.6.6.6.6.3.cmml">,</mo><mrow id="A1.E6.m1.6.6.6.6.2.2" xref="A1.E6.m1.6.6.6.6.2.2.cmml"><mi id="A1.E6.m1.6.6.6.6.2.2.3" xref="A1.E6.m1.6.6.6.6.2.2.3.cmml">ϵ</mi><mo id="A1.E6.m1.6.6.6.6.2.2.2" xref="A1.E6.m1.6.6.6.6.2.2.2.cmml">⁢</mo><mrow id="A1.E6.m1.6.6.6.6.2.2.1.1" xref="A1.E6.m1.6.6.6.6.2.2.1.1.1.cmml"><mo id="A1.E6.m1.6.6.6.6.2.2.1.1.2" stretchy="false" xref="A1.E6.m1.6.6.6.6.2.2.1.1.1.cmml">(</mo><msub id="A1.E6.m1.6.6.6.6.2.2.1.1.1" xref="A1.E6.m1.6.6.6.6.2.2.1.1.1.cmml"><mi id="A1.E6.m1.6.6.6.6.2.2.1.1.1.2" xref="A1.E6.m1.6.6.6.6.2.2.1.1.1.2.cmml">p</mi><mi id="A1.E6.m1.6.6.6.6.2.2.1.1.1.3" xref="A1.E6.m1.6.6.6.6.2.2.1.1.1.3.cmml">j</mi></msub><mo id="A1.E6.m1.6.6.6.6.2.2.1.1.3" stretchy="false" xref="A1.E6.m1.6.6.6.6.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E6.m1.6.6.6.6.2.5" xref="A1.E6.m1.6.6.6.6.3.cmml">⟩</mo></mrow></mrow><msub id="A1.E6.m1.8.8.8" xref="A1.E6.m1.8.8.8.cmml"><mi id="A1.E6.m1.8.8.8.4" xref="A1.E6.m1.8.8.8.4.cmml">C</mi><mrow id="A1.E6.m1.8.8.8.2.2.4" xref="A1.E6.m1.8.8.8.2.2.3.cmml"><mi id="A1.E6.m1.7.7.7.1.1.1" xref="A1.E6.m1.7.7.7.1.1.1.cmml">i</mi><mo id="A1.E6.m1.8.8.8.2.2.4.1" xref="A1.E6.m1.8.8.8.2.2.3.cmml">,</mo><mi id="A1.E6.m1.8.8.8.2.2.2" xref="A1.E6.m1.8.8.8.2.2.2.cmml">j</mi></mrow></msub></mfrac></mrow><mo id="A1.E6.m1.9.9.1.2" lspace="0em" xref="A1.E6.m1.9.9.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E6.m1.9b"><apply id="A1.E6.m1.9.9.1.1.cmml" xref="A1.E6.m1.9.9.1"><eq id="A1.E6.m1.9.9.1.1.3.cmml" xref="A1.E6.m1.9.9.1.1.3"></eq><list id="A1.E6.m1.9.9.1.1.2.3.cmml" xref="A1.E6.m1.9.9.1.1.2.2"><apply id="A1.E6.m1.9.9.1.1.1.1.1.cmml" xref="A1.E6.m1.9.9.1.1.1.1.1"><times id="A1.E6.m1.9.9.1.1.1.1.1.2.cmml" xref="A1.E6.m1.9.9.1.1.1.1.1.2"></times><ci id="A1.E6.m1.9.9.1.1.1.1.1.3.cmml" xref="A1.E6.m1.9.9.1.1.1.1.1.3">𝛿</ci><apply id="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.cmml" xref="A1.E6.m1.9.9.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E6.m1.9.9.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.2">𝑦</ci><ci id="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="A1.E6.m1.9.9.1.1.2.2.2.cmml" xref="A1.E6.m1.9.9.1.1.2.2.2"><times id="A1.E6.m1.9.9.1.1.2.2.2.2.cmml" xref="A1.E6.m1.9.9.1.1.2.2.2.2"></times><ci id="A1.E6.m1.9.9.1.1.2.2.2.3.cmml" xref="A1.E6.m1.9.9.1.1.2.2.2.3">𝛿</ci><apply id="A1.E6.m1.9.9.1.1.2.2.2.1.1.1.cmml" xref="A1.E6.m1.9.9.1.1.2.2.2.1.1"><csymbol cd="ambiguous" id="A1.E6.m1.9.9.1.1.2.2.2.1.1.1.1.cmml" xref="A1.E6.m1.9.9.1.1.2.2.2.1.1">subscript</csymbol><ci id="A1.E6.m1.9.9.1.1.2.2.2.1.1.1.2.cmml" xref="A1.E6.m1.9.9.1.1.2.2.2.1.1.1.2">𝑦</ci><ci id="A1.E6.m1.9.9.1.1.2.2.2.1.1.1.3.cmml" xref="A1.E6.m1.9.9.1.1.2.2.2.1.1.1.3">𝑗</ci></apply></apply></list><apply id="A1.E6.m1.8.8.cmml" xref="A1.E6.m1.8.8"><divide id="A1.E6.m1.8.8.9.cmml" xref="A1.E6.m1.8.8"></divide><apply id="A1.E6.m1.6.6.6.cmml" xref="A1.E6.m1.6.6.6"><plus id="A1.E6.m1.6.6.6.7.cmml" xref="A1.E6.m1.6.6.6.7"></plus><list id="A1.E6.m1.4.4.4.4.3.cmml" xref="A1.E6.m1.4.4.4.4.2"><apply id="A1.E6.m1.3.3.3.3.1.1.cmml" xref="A1.E6.m1.3.3.3.3.1.1"><times id="A1.E6.m1.3.3.3.3.1.1.2.cmml" xref="A1.E6.m1.3.3.3.3.1.1.2"></times><ci id="A1.E6.m1.3.3.3.3.1.1.3.cmml" xref="A1.E6.m1.3.3.3.3.1.1.3">𝑒</ci><apply id="A1.E6.m1.3.3.3.3.1.1.1.1.1.cmml" xref="A1.E6.m1.3.3.3.3.1.1.1.1"><csymbol cd="ambiguous" id="A1.E6.m1.3.3.3.3.1.1.1.1.1.1.cmml" xref="A1.E6.m1.3.3.3.3.1.1.1.1">subscript</csymbol><ci id="A1.E6.m1.3.3.3.3.1.1.1.1.1.2.cmml" xref="A1.E6.m1.3.3.3.3.1.1.1.1.1.2">𝑦</ci><ci id="A1.E6.m1.3.3.3.3.1.1.1.1.1.3.cmml" xref="A1.E6.m1.3.3.3.3.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="A1.E6.m1.4.4.4.4.2.2.cmml" xref="A1.E6.m1.4.4.4.4.2.2"><times id="A1.E6.m1.4.4.4.4.2.2.2.cmml" xref="A1.E6.m1.4.4.4.4.2.2.2"></times><ci id="A1.E6.m1.4.4.4.4.2.2.3.cmml" xref="A1.E6.m1.4.4.4.4.2.2.3">𝑒</ci><apply id="A1.E6.m1.4.4.4.4.2.2.1.1.1.cmml" xref="A1.E6.m1.4.4.4.4.2.2.1.1"><csymbol cd="ambiguous" id="A1.E6.m1.4.4.4.4.2.2.1.1.1.1.cmml" xref="A1.E6.m1.4.4.4.4.2.2.1.1">subscript</csymbol><ci id="A1.E6.m1.4.4.4.4.2.2.1.1.1.2.cmml" xref="A1.E6.m1.4.4.4.4.2.2.1.1.1.2">𝑦</ci><ci id="A1.E6.m1.4.4.4.4.2.2.1.1.1.3.cmml" xref="A1.E6.m1.4.4.4.4.2.2.1.1.1.3">𝑗</ci></apply></apply></list><apply id="A1.E6.m1.6.6.6.8.cmml" xref="A1.E6.m1.6.6.6.8"><csymbol cd="ambiguous" id="A1.E6.m1.6.6.6.8.1.cmml" xref="A1.E6.m1.6.6.6.8">subscript</csymbol><ci id="A1.E6.m1.6.6.6.8.2.cmml" xref="A1.E6.m1.6.6.6.8.2">𝐵</ci><list id="A1.E6.m1.2.2.2.2.2.3.cmml" xref="A1.E6.m1.2.2.2.2.2.4"><ci id="A1.E6.m1.1.1.1.1.1.1.cmml" xref="A1.E6.m1.1.1.1.1.1.1">𝑖</ci><ci id="A1.E6.m1.2.2.2.2.2.2.cmml" xref="A1.E6.m1.2.2.2.2.2.2">𝑗</ci></list></apply><list id="A1.E6.m1.6.6.6.6.3.cmml" xref="A1.E6.m1.6.6.6.6.2"><apply id="A1.E6.m1.5.5.5.5.1.1.cmml" xref="A1.E6.m1.5.5.5.5.1.1"><times id="A1.E6.m1.5.5.5.5.1.1.2.cmml" xref="A1.E6.m1.5.5.5.5.1.1.2"></times><ci id="A1.E6.m1.5.5.5.5.1.1.3.cmml" xref="A1.E6.m1.5.5.5.5.1.1.3">italic-ϵ</ci><apply id="A1.E6.m1.5.5.5.5.1.1.1.1.1.cmml" xref="A1.E6.m1.5.5.5.5.1.1.1.1"><csymbol cd="ambiguous" id="A1.E6.m1.5.5.5.5.1.1.1.1.1.1.cmml" xref="A1.E6.m1.5.5.5.5.1.1.1.1">subscript</csymbol><ci id="A1.E6.m1.5.5.5.5.1.1.1.1.1.2.cmml" xref="A1.E6.m1.5.5.5.5.1.1.1.1.1.2">𝑝</ci><ci id="A1.E6.m1.5.5.5.5.1.1.1.1.1.3.cmml" xref="A1.E6.m1.5.5.5.5.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="A1.E6.m1.6.6.6.6.2.2.cmml" xref="A1.E6.m1.6.6.6.6.2.2"><times id="A1.E6.m1.6.6.6.6.2.2.2.cmml" xref="A1.E6.m1.6.6.6.6.2.2.2"></times><ci id="A1.E6.m1.6.6.6.6.2.2.3.cmml" xref="A1.E6.m1.6.6.6.6.2.2.3">italic-ϵ</ci><apply id="A1.E6.m1.6.6.6.6.2.2.1.1.1.cmml" xref="A1.E6.m1.6.6.6.6.2.2.1.1"><csymbol cd="ambiguous" id="A1.E6.m1.6.6.6.6.2.2.1.1.1.1.cmml" xref="A1.E6.m1.6.6.6.6.2.2.1.1">subscript</csymbol><ci id="A1.E6.m1.6.6.6.6.2.2.1.1.1.2.cmml" xref="A1.E6.m1.6.6.6.6.2.2.1.1.1.2">𝑝</ci><ci id="A1.E6.m1.6.6.6.6.2.2.1.1.1.3.cmml" xref="A1.E6.m1.6.6.6.6.2.2.1.1.1.3">𝑗</ci></apply></apply></list></apply><apply id="A1.E6.m1.8.8.8.cmml" xref="A1.E6.m1.8.8.8"><csymbol cd="ambiguous" id="A1.E6.m1.8.8.8.3.cmml" xref="A1.E6.m1.8.8.8">subscript</csymbol><ci id="A1.E6.m1.8.8.8.4.cmml" xref="A1.E6.m1.8.8.8.4">𝐶</ci><list id="A1.E6.m1.8.8.8.2.2.3.cmml" xref="A1.E6.m1.8.8.8.2.2.4"><ci id="A1.E6.m1.7.7.7.1.1.1.cmml" xref="A1.E6.m1.7.7.7.1.1.1">𝑖</ci><ci id="A1.E6.m1.8.8.8.2.2.2.cmml" xref="A1.E6.m1.8.8.8.2.2.2">𝑗</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E6.m1.9c">\left\langle\delta(y_{i}),\delta(y_{j})\right\rangle=\frac{\left\langle e(y_{i%
}),e(y_{j})\right\rangle+B_{i,j}+\left\langle\epsilon(p_{i}),\epsilon(p_{j})%
\right\rangle}{C_{i,j}}.</annotation><annotation encoding="application/x-llamapun" id="A1.E6.m1.9d">⟨ italic_δ ( italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) , italic_δ ( italic_y start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ⟩ = divide start_ARG ⟨ italic_e ( italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) , italic_e ( italic_y start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ⟩ + italic_B start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT + ⟨ italic_ϵ ( italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) , italic_ϵ ( italic_p start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ⟩ end_ARG start_ARG italic_C start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS2.SSS1.p3.12"><span class="ltx_text ltx_font_bold" id="A1.SS2.SSS1.p3.12.1">Encoding on Label Tokens Enhances the Similarity with Same Labels.</span> Given <math alttext="k=1" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p3.10.m1.1"><semantics id="A1.SS2.SSS1.p3.10.m1.1a"><mrow id="A1.SS2.SSS1.p3.10.m1.1.1" xref="A1.SS2.SSS1.p3.10.m1.1.1.cmml"><mi id="A1.SS2.SSS1.p3.10.m1.1.1.2" xref="A1.SS2.SSS1.p3.10.m1.1.1.2.cmml">k</mi><mo id="A1.SS2.SSS1.p3.10.m1.1.1.1" xref="A1.SS2.SSS1.p3.10.m1.1.1.1.cmml">=</mo><mn id="A1.SS2.SSS1.p3.10.m1.1.1.3" xref="A1.SS2.SSS1.p3.10.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p3.10.m1.1b"><apply id="A1.SS2.SSS1.p3.10.m1.1.1.cmml" xref="A1.SS2.SSS1.p3.10.m1.1.1"><eq id="A1.SS2.SSS1.p3.10.m1.1.1.1.cmml" xref="A1.SS2.SSS1.p3.10.m1.1.1.1"></eq><ci id="A1.SS2.SSS1.p3.10.m1.1.1.2.cmml" xref="A1.SS2.SSS1.p3.10.m1.1.1.2">𝑘</ci><cn id="A1.SS2.SSS1.p3.10.m1.1.1.3.cmml" type="integer" xref="A1.SS2.SSS1.p3.10.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p3.10.m1.1c">k=1</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p3.10.m1.1d">italic_k = 1</annotation></semantics></math> for simplicity, the probability <math alttext="\mathrm{top}_{1}\left(\mathcal{S}_{\delta|i}\right)" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p3.11.m2.1"><semantics id="A1.SS2.SSS1.p3.11.m2.1a"><mrow id="A1.SS2.SSS1.p3.11.m2.1.1" xref="A1.SS2.SSS1.p3.11.m2.1.1.cmml"><msub id="A1.SS2.SSS1.p3.11.m2.1.1.3" xref="A1.SS2.SSS1.p3.11.m2.1.1.3.cmml"><mi id="A1.SS2.SSS1.p3.11.m2.1.1.3.2" xref="A1.SS2.SSS1.p3.11.m2.1.1.3.2.cmml">top</mi><mn id="A1.SS2.SSS1.p3.11.m2.1.1.3.3" xref="A1.SS2.SSS1.p3.11.m2.1.1.3.3.cmml">1</mn></msub><mo id="A1.SS2.SSS1.p3.11.m2.1.1.2" xref="A1.SS2.SSS1.p3.11.m2.1.1.2.cmml">⁢</mo><mrow id="A1.SS2.SSS1.p3.11.m2.1.1.1.1" xref="A1.SS2.SSS1.p3.11.m2.1.1.1.1.1.cmml"><mo id="A1.SS2.SSS1.p3.11.m2.1.1.1.1.2" xref="A1.SS2.SSS1.p3.11.m2.1.1.1.1.1.cmml">(</mo><msub id="A1.SS2.SSS1.p3.11.m2.1.1.1.1.1" xref="A1.SS2.SSS1.p3.11.m2.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS2.SSS1.p3.11.m2.1.1.1.1.1.2" xref="A1.SS2.SSS1.p3.11.m2.1.1.1.1.1.2.cmml">𝒮</mi><mrow id="A1.SS2.SSS1.p3.11.m2.1.1.1.1.1.3" xref="A1.SS2.SSS1.p3.11.m2.1.1.1.1.1.3.cmml"><mi id="A1.SS2.SSS1.p3.11.m2.1.1.1.1.1.3.2" xref="A1.SS2.SSS1.p3.11.m2.1.1.1.1.1.3.2.cmml">δ</mi><mo fence="false" id="A1.SS2.SSS1.p3.11.m2.1.1.1.1.1.3.1" xref="A1.SS2.SSS1.p3.11.m2.1.1.1.1.1.3.1.cmml">|</mo><mi id="A1.SS2.SSS1.p3.11.m2.1.1.1.1.1.3.3" xref="A1.SS2.SSS1.p3.11.m2.1.1.1.1.1.3.3.cmml">i</mi></mrow></msub><mo id="A1.SS2.SSS1.p3.11.m2.1.1.1.1.3" xref="A1.SS2.SSS1.p3.11.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p3.11.m2.1b"><apply id="A1.SS2.SSS1.p3.11.m2.1.1.cmml" xref="A1.SS2.SSS1.p3.11.m2.1.1"><times id="A1.SS2.SSS1.p3.11.m2.1.1.2.cmml" xref="A1.SS2.SSS1.p3.11.m2.1.1.2"></times><apply id="A1.SS2.SSS1.p3.11.m2.1.1.3.cmml" xref="A1.SS2.SSS1.p3.11.m2.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.SSS1.p3.11.m2.1.1.3.1.cmml" xref="A1.SS2.SSS1.p3.11.m2.1.1.3">subscript</csymbol><ci id="A1.SS2.SSS1.p3.11.m2.1.1.3.2.cmml" xref="A1.SS2.SSS1.p3.11.m2.1.1.3.2">top</ci><cn id="A1.SS2.SSS1.p3.11.m2.1.1.3.3.cmml" type="integer" xref="A1.SS2.SSS1.p3.11.m2.1.1.3.3">1</cn></apply><apply id="A1.SS2.SSS1.p3.11.m2.1.1.1.1.1.cmml" xref="A1.SS2.SSS1.p3.11.m2.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSS1.p3.11.m2.1.1.1.1.1.1.cmml" xref="A1.SS2.SSS1.p3.11.m2.1.1.1.1">subscript</csymbol><ci id="A1.SS2.SSS1.p3.11.m2.1.1.1.1.1.2.cmml" xref="A1.SS2.SSS1.p3.11.m2.1.1.1.1.1.2">𝒮</ci><apply id="A1.SS2.SSS1.p3.11.m2.1.1.1.1.1.3.cmml" xref="A1.SS2.SSS1.p3.11.m2.1.1.1.1.1.3"><csymbol cd="latexml" id="A1.SS2.SSS1.p3.11.m2.1.1.1.1.1.3.1.cmml" xref="A1.SS2.SSS1.p3.11.m2.1.1.1.1.1.3.1">conditional</csymbol><ci id="A1.SS2.SSS1.p3.11.m2.1.1.1.1.1.3.2.cmml" xref="A1.SS2.SSS1.p3.11.m2.1.1.1.1.1.3.2">𝛿</ci><ci id="A1.SS2.SSS1.p3.11.m2.1.1.1.1.1.3.3.cmml" xref="A1.SS2.SSS1.p3.11.m2.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p3.11.m2.1c">\mathrm{top}_{1}\left(\mathcal{S}_{\delta|i}\right)</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p3.11.m2.1d">roman_top start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( caligraphic_S start_POSTSUBSCRIPT italic_δ | italic_i end_POSTSUBSCRIPT )</annotation></semantics></math> selects a sample with the similar label with <math alttext="i" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p3.12.m3.1"><semantics id="A1.SS2.SSS1.p3.12.m3.1a"><mi id="A1.SS2.SSS1.p3.12.m3.1.1" xref="A1.SS2.SSS1.p3.12.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p3.12.m3.1b"><ci id="A1.SS2.SSS1.p3.12.m3.1.1.cmml" xref="A1.SS2.SSS1.p3.12.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p3.12.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p3.12.m3.1d">italic_i</annotation></semantics></math>-th sample <span class="ltx_text ltx_font_bold" id="A1.SS2.SSS1.p3.12.2">on the forerunner token</span> can be written as:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A6.EGx2">
<tbody id="A1.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathrm{P}_{F}\left[y_{i}=y_{\mathrm{top}_{1}\left(\mathcal{S}_{%
\delta|i}\right)}\right]" class="ltx_Math" display="inline" id="A1.E7.m1.2"><semantics id="A1.E7.m1.2a"><mrow id="A1.E7.m1.2.2" xref="A1.E7.m1.2.2.cmml"><msub id="A1.E7.m1.2.2.3" xref="A1.E7.m1.2.2.3.cmml"><mi id="A1.E7.m1.2.2.3.2" mathvariant="normal" xref="A1.E7.m1.2.2.3.2.cmml">P</mi><mi id="A1.E7.m1.2.2.3.3" xref="A1.E7.m1.2.2.3.3.cmml">F</mi></msub><mo id="A1.E7.m1.2.2.2" xref="A1.E7.m1.2.2.2.cmml">⁢</mo><mrow id="A1.E7.m1.2.2.1.1" xref="A1.E7.m1.2.2.1.2.cmml"><mo id="A1.E7.m1.2.2.1.1.2" xref="A1.E7.m1.2.2.1.2.1.cmml">[</mo><mrow id="A1.E7.m1.2.2.1.1.1" xref="A1.E7.m1.2.2.1.1.1.cmml"><msub id="A1.E7.m1.2.2.1.1.1.2" xref="A1.E7.m1.2.2.1.1.1.2.cmml"><mi id="A1.E7.m1.2.2.1.1.1.2.2" xref="A1.E7.m1.2.2.1.1.1.2.2.cmml">y</mi><mi id="A1.E7.m1.2.2.1.1.1.2.3" xref="A1.E7.m1.2.2.1.1.1.2.3.cmml">i</mi></msub><mo id="A1.E7.m1.2.2.1.1.1.1" xref="A1.E7.m1.2.2.1.1.1.1.cmml">=</mo><msub id="A1.E7.m1.2.2.1.1.1.3" xref="A1.E7.m1.2.2.1.1.1.3.cmml"><mi id="A1.E7.m1.2.2.1.1.1.3.2" xref="A1.E7.m1.2.2.1.1.1.3.2.cmml">y</mi><mrow id="A1.E7.m1.1.1.1" xref="A1.E7.m1.1.1.1.cmml"><msub id="A1.E7.m1.1.1.1.3" xref="A1.E7.m1.1.1.1.3.cmml"><mi id="A1.E7.m1.1.1.1.3.2" xref="A1.E7.m1.1.1.1.3.2.cmml">top</mi><mn id="A1.E7.m1.1.1.1.3.3" xref="A1.E7.m1.1.1.1.3.3.cmml">1</mn></msub><mo id="A1.E7.m1.1.1.1.2" xref="A1.E7.m1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E7.m1.1.1.1.1.1" xref="A1.E7.m1.1.1.1.1.1.1.cmml"><mo id="A1.E7.m1.1.1.1.1.1.2" xref="A1.E7.m1.1.1.1.1.1.1.cmml">(</mo><msub id="A1.E7.m1.1.1.1.1.1.1" xref="A1.E7.m1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E7.m1.1.1.1.1.1.1.2" xref="A1.E7.m1.1.1.1.1.1.1.2.cmml">𝒮</mi><mrow id="A1.E7.m1.1.1.1.1.1.1.3" xref="A1.E7.m1.1.1.1.1.1.1.3.cmml"><mi id="A1.E7.m1.1.1.1.1.1.1.3.2" xref="A1.E7.m1.1.1.1.1.1.1.3.2.cmml">δ</mi><mo fence="false" id="A1.E7.m1.1.1.1.1.1.1.3.1" xref="A1.E7.m1.1.1.1.1.1.1.3.1.cmml">|</mo><mi id="A1.E7.m1.1.1.1.1.1.1.3.3" xref="A1.E7.m1.1.1.1.1.1.1.3.3.cmml">i</mi></mrow></msub><mo id="A1.E7.m1.1.1.1.1.1.3" xref="A1.E7.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msub></mrow><mo id="A1.E7.m1.2.2.1.1.3" xref="A1.E7.m1.2.2.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E7.m1.2b"><apply id="A1.E7.m1.2.2.cmml" xref="A1.E7.m1.2.2"><times id="A1.E7.m1.2.2.2.cmml" xref="A1.E7.m1.2.2.2"></times><apply id="A1.E7.m1.2.2.3.cmml" xref="A1.E7.m1.2.2.3"><csymbol cd="ambiguous" id="A1.E7.m1.2.2.3.1.cmml" xref="A1.E7.m1.2.2.3">subscript</csymbol><ci id="A1.E7.m1.2.2.3.2.cmml" xref="A1.E7.m1.2.2.3.2">P</ci><ci id="A1.E7.m1.2.2.3.3.cmml" xref="A1.E7.m1.2.2.3.3">𝐹</ci></apply><apply id="A1.E7.m1.2.2.1.2.cmml" xref="A1.E7.m1.2.2.1.1"><csymbol cd="latexml" id="A1.E7.m1.2.2.1.2.1.cmml" xref="A1.E7.m1.2.2.1.1.2">delimited-[]</csymbol><apply id="A1.E7.m1.2.2.1.1.1.cmml" xref="A1.E7.m1.2.2.1.1.1"><eq id="A1.E7.m1.2.2.1.1.1.1.cmml" xref="A1.E7.m1.2.2.1.1.1.1"></eq><apply id="A1.E7.m1.2.2.1.1.1.2.cmml" xref="A1.E7.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="A1.E7.m1.2.2.1.1.1.2.1.cmml" xref="A1.E7.m1.2.2.1.1.1.2">subscript</csymbol><ci id="A1.E7.m1.2.2.1.1.1.2.2.cmml" xref="A1.E7.m1.2.2.1.1.1.2.2">𝑦</ci><ci id="A1.E7.m1.2.2.1.1.1.2.3.cmml" xref="A1.E7.m1.2.2.1.1.1.2.3">𝑖</ci></apply><apply id="A1.E7.m1.2.2.1.1.1.3.cmml" xref="A1.E7.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="A1.E7.m1.2.2.1.1.1.3.1.cmml" xref="A1.E7.m1.2.2.1.1.1.3">subscript</csymbol><ci id="A1.E7.m1.2.2.1.1.1.3.2.cmml" xref="A1.E7.m1.2.2.1.1.1.3.2">𝑦</ci><apply id="A1.E7.m1.1.1.1.cmml" xref="A1.E7.m1.1.1.1"><times id="A1.E7.m1.1.1.1.2.cmml" xref="A1.E7.m1.1.1.1.2"></times><apply id="A1.E7.m1.1.1.1.3.cmml" xref="A1.E7.m1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E7.m1.1.1.1.3.1.cmml" xref="A1.E7.m1.1.1.1.3">subscript</csymbol><ci id="A1.E7.m1.1.1.1.3.2.cmml" xref="A1.E7.m1.1.1.1.3.2">top</ci><cn id="A1.E7.m1.1.1.1.3.3.cmml" type="integer" xref="A1.E7.m1.1.1.1.3.3">1</cn></apply><apply id="A1.E7.m1.1.1.1.1.1.1.cmml" xref="A1.E7.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E7.m1.1.1.1.1.1.1.1.cmml" xref="A1.E7.m1.1.1.1.1.1">subscript</csymbol><ci id="A1.E7.m1.1.1.1.1.1.1.2.cmml" xref="A1.E7.m1.1.1.1.1.1.1.2">𝒮</ci><apply id="A1.E7.m1.1.1.1.1.1.1.3.cmml" xref="A1.E7.m1.1.1.1.1.1.1.3"><csymbol cd="latexml" id="A1.E7.m1.1.1.1.1.1.1.3.1.cmml" xref="A1.E7.m1.1.1.1.1.1.1.3.1">conditional</csymbol><ci id="A1.E7.m1.1.1.1.1.1.1.3.2.cmml" xref="A1.E7.m1.1.1.1.1.1.1.3.2">𝛿</ci><ci id="A1.E7.m1.1.1.1.1.1.1.3.3.cmml" xref="A1.E7.m1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E7.m1.2c">\displaystyle\mathrm{P}_{F}\left[y_{i}=y_{\mathrm{top}_{1}\left(\mathcal{S}_{%
\delta|i}\right)}\right]</annotation><annotation encoding="application/x-llamapun" id="A1.E7.m1.2d">roman_P start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT [ italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_y start_POSTSUBSCRIPT roman_top start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( caligraphic_S start_POSTSUBSCRIPT italic_δ | italic_i end_POSTSUBSCRIPT ) end_POSTSUBSCRIPT ]</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=r_{y_{i}}\frac{\mathbb{E}_{j|y_{i}=y_{j}}\left[\left\langle%
\delta(x_{i}),\delta(x_{j})\right\rangle\right]}{\mathbb{E}_{j}\left[\left%
\langle\delta(x_{i}),\delta(x_{j})\right\rangle\right]}" class="ltx_Math" display="inline" id="A1.E7.m2.2"><semantics id="A1.E7.m2.2a"><mrow id="A1.E7.m2.2.3" xref="A1.E7.m2.2.3.cmml"><mi id="A1.E7.m2.2.3.2" xref="A1.E7.m2.2.3.2.cmml"></mi><mo id="A1.E7.m2.2.3.1" xref="A1.E7.m2.2.3.1.cmml">=</mo><mrow id="A1.E7.m2.2.3.3" xref="A1.E7.m2.2.3.3.cmml"><msub id="A1.E7.m2.2.3.3.2" xref="A1.E7.m2.2.3.3.2.cmml"><mi id="A1.E7.m2.2.3.3.2.2" xref="A1.E7.m2.2.3.3.2.2.cmml">r</mi><msub id="A1.E7.m2.2.3.3.2.3" xref="A1.E7.m2.2.3.3.2.3.cmml"><mi id="A1.E7.m2.2.3.3.2.3.2" xref="A1.E7.m2.2.3.3.2.3.2.cmml">y</mi><mi id="A1.E7.m2.2.3.3.2.3.3" xref="A1.E7.m2.2.3.3.2.3.3.cmml">i</mi></msub></msub><mo id="A1.E7.m2.2.3.3.1" xref="A1.E7.m2.2.3.3.1.cmml">⁢</mo><mstyle displaystyle="true" id="A1.E7.m2.2.2" xref="A1.E7.m2.2.2.cmml"><mfrac id="A1.E7.m2.2.2a" xref="A1.E7.m2.2.2.cmml"><mrow id="A1.E7.m2.1.1.1" xref="A1.E7.m2.1.1.1.cmml"><msub id="A1.E7.m2.1.1.1.3" xref="A1.E7.m2.1.1.1.3.cmml"><mi id="A1.E7.m2.1.1.1.3.2" xref="A1.E7.m2.1.1.1.3.2.cmml">𝔼</mi><mrow id="A1.E7.m2.1.1.1.3.3" xref="A1.E7.m2.1.1.1.3.3.cmml"><mrow id="A1.E7.m2.1.1.1.3.3.2" xref="A1.E7.m2.1.1.1.3.3.2.cmml"><mi id="A1.E7.m2.1.1.1.3.3.2.2" xref="A1.E7.m2.1.1.1.3.3.2.2.cmml">j</mi><mo fence="false" id="A1.E7.m2.1.1.1.3.3.2.1" xref="A1.E7.m2.1.1.1.3.3.2.1.cmml">|</mo><msub id="A1.E7.m2.1.1.1.3.3.2.3" xref="A1.E7.m2.1.1.1.3.3.2.3.cmml"><mi id="A1.E7.m2.1.1.1.3.3.2.3.2" xref="A1.E7.m2.1.1.1.3.3.2.3.2.cmml">y</mi><mi id="A1.E7.m2.1.1.1.3.3.2.3.3" xref="A1.E7.m2.1.1.1.3.3.2.3.3.cmml">i</mi></msub></mrow><mo id="A1.E7.m2.1.1.1.3.3.1" xref="A1.E7.m2.1.1.1.3.3.1.cmml">=</mo><msub id="A1.E7.m2.1.1.1.3.3.3" xref="A1.E7.m2.1.1.1.3.3.3.cmml"><mi id="A1.E7.m2.1.1.1.3.3.3.2" xref="A1.E7.m2.1.1.1.3.3.3.2.cmml">y</mi><mi id="A1.E7.m2.1.1.1.3.3.3.3" xref="A1.E7.m2.1.1.1.3.3.3.3.cmml">j</mi></msub></mrow></msub><mo id="A1.E7.m2.1.1.1.2" xref="A1.E7.m2.1.1.1.2.cmml">⁢</mo><mrow id="A1.E7.m2.1.1.1.1.1" xref="A1.E7.m2.1.1.1.1.2.cmml"><mo id="A1.E7.m2.1.1.1.1.1.2" xref="A1.E7.m2.1.1.1.1.2.1.cmml">[</mo><mrow id="A1.E7.m2.1.1.1.1.1.1.2" xref="A1.E7.m2.1.1.1.1.1.1.3.cmml"><mo id="A1.E7.m2.1.1.1.1.1.1.2.3" xref="A1.E7.m2.1.1.1.1.1.1.3.cmml">⟨</mo><mrow id="A1.E7.m2.1.1.1.1.1.1.1.1" xref="A1.E7.m2.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E7.m2.1.1.1.1.1.1.1.1.3" xref="A1.E7.m2.1.1.1.1.1.1.1.1.3.cmml">δ</mi><mo id="A1.E7.m2.1.1.1.1.1.1.1.1.2" xref="A1.E7.m2.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E7.m2.1.1.1.1.1.1.1.1.1.1" xref="A1.E7.m2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E7.m2.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E7.m2.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A1.E7.m2.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E7.m2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E7.m2.1.1.1.1.1.1.1.1.1.1.1.2" xref="A1.E7.m2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="A1.E7.m2.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E7.m2.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.E7.m2.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E7.m2.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E7.m2.1.1.1.1.1.1.2.4" xref="A1.E7.m2.1.1.1.1.1.1.3.cmml">,</mo><mrow id="A1.E7.m2.1.1.1.1.1.1.2.2" xref="A1.E7.m2.1.1.1.1.1.1.2.2.cmml"><mi id="A1.E7.m2.1.1.1.1.1.1.2.2.3" xref="A1.E7.m2.1.1.1.1.1.1.2.2.3.cmml">δ</mi><mo id="A1.E7.m2.1.1.1.1.1.1.2.2.2" xref="A1.E7.m2.1.1.1.1.1.1.2.2.2.cmml">⁢</mo><mrow id="A1.E7.m2.1.1.1.1.1.1.2.2.1.1" xref="A1.E7.m2.1.1.1.1.1.1.2.2.1.1.1.cmml"><mo id="A1.E7.m2.1.1.1.1.1.1.2.2.1.1.2" stretchy="false" xref="A1.E7.m2.1.1.1.1.1.1.2.2.1.1.1.cmml">(</mo><msub id="A1.E7.m2.1.1.1.1.1.1.2.2.1.1.1" xref="A1.E7.m2.1.1.1.1.1.1.2.2.1.1.1.cmml"><mi id="A1.E7.m2.1.1.1.1.1.1.2.2.1.1.1.2" xref="A1.E7.m2.1.1.1.1.1.1.2.2.1.1.1.2.cmml">x</mi><mi id="A1.E7.m2.1.1.1.1.1.1.2.2.1.1.1.3" xref="A1.E7.m2.1.1.1.1.1.1.2.2.1.1.1.3.cmml">j</mi></msub><mo id="A1.E7.m2.1.1.1.1.1.1.2.2.1.1.3" stretchy="false" xref="A1.E7.m2.1.1.1.1.1.1.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E7.m2.1.1.1.1.1.1.2.5" xref="A1.E7.m2.1.1.1.1.1.1.3.cmml">⟩</mo></mrow><mo id="A1.E7.m2.1.1.1.1.1.3" xref="A1.E7.m2.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mrow id="A1.E7.m2.2.2.2" xref="A1.E7.m2.2.2.2.cmml"><msub id="A1.E7.m2.2.2.2.3" xref="A1.E7.m2.2.2.2.3.cmml"><mi id="A1.E7.m2.2.2.2.3.2" xref="A1.E7.m2.2.2.2.3.2.cmml">𝔼</mi><mi id="A1.E7.m2.2.2.2.3.3" xref="A1.E7.m2.2.2.2.3.3.cmml">j</mi></msub><mo id="A1.E7.m2.2.2.2.2" xref="A1.E7.m2.2.2.2.2.cmml">⁢</mo><mrow id="A1.E7.m2.2.2.2.1.1" xref="A1.E7.m2.2.2.2.1.2.cmml"><mo id="A1.E7.m2.2.2.2.1.1.2" xref="A1.E7.m2.2.2.2.1.2.1.cmml">[</mo><mrow id="A1.E7.m2.2.2.2.1.1.1.2" xref="A1.E7.m2.2.2.2.1.1.1.3.cmml"><mo id="A1.E7.m2.2.2.2.1.1.1.2.3" xref="A1.E7.m2.2.2.2.1.1.1.3.cmml">⟨</mo><mrow id="A1.E7.m2.2.2.2.1.1.1.1.1" xref="A1.E7.m2.2.2.2.1.1.1.1.1.cmml"><mi id="A1.E7.m2.2.2.2.1.1.1.1.1.3" xref="A1.E7.m2.2.2.2.1.1.1.1.1.3.cmml">δ</mi><mo id="A1.E7.m2.2.2.2.1.1.1.1.1.2" xref="A1.E7.m2.2.2.2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E7.m2.2.2.2.1.1.1.1.1.1.1" xref="A1.E7.m2.2.2.2.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E7.m2.2.2.2.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E7.m2.2.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A1.E7.m2.2.2.2.1.1.1.1.1.1.1.1" xref="A1.E7.m2.2.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E7.m2.2.2.2.1.1.1.1.1.1.1.1.2" xref="A1.E7.m2.2.2.2.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="A1.E7.m2.2.2.2.1.1.1.1.1.1.1.1.3" xref="A1.E7.m2.2.2.2.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.E7.m2.2.2.2.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E7.m2.2.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E7.m2.2.2.2.1.1.1.2.4" xref="A1.E7.m2.2.2.2.1.1.1.3.cmml">,</mo><mrow id="A1.E7.m2.2.2.2.1.1.1.2.2" xref="A1.E7.m2.2.2.2.1.1.1.2.2.cmml"><mi id="A1.E7.m2.2.2.2.1.1.1.2.2.3" xref="A1.E7.m2.2.2.2.1.1.1.2.2.3.cmml">δ</mi><mo id="A1.E7.m2.2.2.2.1.1.1.2.2.2" xref="A1.E7.m2.2.2.2.1.1.1.2.2.2.cmml">⁢</mo><mrow id="A1.E7.m2.2.2.2.1.1.1.2.2.1.1" xref="A1.E7.m2.2.2.2.1.1.1.2.2.1.1.1.cmml"><mo id="A1.E7.m2.2.2.2.1.1.1.2.2.1.1.2" stretchy="false" xref="A1.E7.m2.2.2.2.1.1.1.2.2.1.1.1.cmml">(</mo><msub id="A1.E7.m2.2.2.2.1.1.1.2.2.1.1.1" xref="A1.E7.m2.2.2.2.1.1.1.2.2.1.1.1.cmml"><mi id="A1.E7.m2.2.2.2.1.1.1.2.2.1.1.1.2" xref="A1.E7.m2.2.2.2.1.1.1.2.2.1.1.1.2.cmml">x</mi><mi id="A1.E7.m2.2.2.2.1.1.1.2.2.1.1.1.3" xref="A1.E7.m2.2.2.2.1.1.1.2.2.1.1.1.3.cmml">j</mi></msub><mo id="A1.E7.m2.2.2.2.1.1.1.2.2.1.1.3" stretchy="false" xref="A1.E7.m2.2.2.2.1.1.1.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E7.m2.2.2.2.1.1.1.2.5" xref="A1.E7.m2.2.2.2.1.1.1.3.cmml">⟩</mo></mrow><mo id="A1.E7.m2.2.2.2.1.1.3" xref="A1.E7.m2.2.2.2.1.2.1.cmml">]</mo></mrow></mrow></mfrac></mstyle></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E7.m2.2b"><apply id="A1.E7.m2.2.3.cmml" xref="A1.E7.m2.2.3"><eq id="A1.E7.m2.2.3.1.cmml" xref="A1.E7.m2.2.3.1"></eq><csymbol cd="latexml" id="A1.E7.m2.2.3.2.cmml" xref="A1.E7.m2.2.3.2">absent</csymbol><apply id="A1.E7.m2.2.3.3.cmml" xref="A1.E7.m2.2.3.3"><times id="A1.E7.m2.2.3.3.1.cmml" xref="A1.E7.m2.2.3.3.1"></times><apply id="A1.E7.m2.2.3.3.2.cmml" xref="A1.E7.m2.2.3.3.2"><csymbol cd="ambiguous" id="A1.E7.m2.2.3.3.2.1.cmml" xref="A1.E7.m2.2.3.3.2">subscript</csymbol><ci id="A1.E7.m2.2.3.3.2.2.cmml" xref="A1.E7.m2.2.3.3.2.2">𝑟</ci><apply id="A1.E7.m2.2.3.3.2.3.cmml" xref="A1.E7.m2.2.3.3.2.3"><csymbol cd="ambiguous" id="A1.E7.m2.2.3.3.2.3.1.cmml" xref="A1.E7.m2.2.3.3.2.3">subscript</csymbol><ci id="A1.E7.m2.2.3.3.2.3.2.cmml" xref="A1.E7.m2.2.3.3.2.3.2">𝑦</ci><ci id="A1.E7.m2.2.3.3.2.3.3.cmml" xref="A1.E7.m2.2.3.3.2.3.3">𝑖</ci></apply></apply><apply id="A1.E7.m2.2.2.cmml" xref="A1.E7.m2.2.2"><divide id="A1.E7.m2.2.2.3.cmml" xref="A1.E7.m2.2.2"></divide><apply id="A1.E7.m2.1.1.1.cmml" xref="A1.E7.m2.1.1.1"><times id="A1.E7.m2.1.1.1.2.cmml" xref="A1.E7.m2.1.1.1.2"></times><apply id="A1.E7.m2.1.1.1.3.cmml" xref="A1.E7.m2.1.1.1.3"><csymbol cd="ambiguous" id="A1.E7.m2.1.1.1.3.1.cmml" xref="A1.E7.m2.1.1.1.3">subscript</csymbol><ci id="A1.E7.m2.1.1.1.3.2.cmml" xref="A1.E7.m2.1.1.1.3.2">𝔼</ci><apply id="A1.E7.m2.1.1.1.3.3.cmml" xref="A1.E7.m2.1.1.1.3.3"><eq id="A1.E7.m2.1.1.1.3.3.1.cmml" xref="A1.E7.m2.1.1.1.3.3.1"></eq><apply id="A1.E7.m2.1.1.1.3.3.2.cmml" xref="A1.E7.m2.1.1.1.3.3.2"><csymbol cd="latexml" id="A1.E7.m2.1.1.1.3.3.2.1.cmml" xref="A1.E7.m2.1.1.1.3.3.2.1">conditional</csymbol><ci id="A1.E7.m2.1.1.1.3.3.2.2.cmml" xref="A1.E7.m2.1.1.1.3.3.2.2">𝑗</ci><apply id="A1.E7.m2.1.1.1.3.3.2.3.cmml" xref="A1.E7.m2.1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="A1.E7.m2.1.1.1.3.3.2.3.1.cmml" xref="A1.E7.m2.1.1.1.3.3.2.3">subscript</csymbol><ci id="A1.E7.m2.1.1.1.3.3.2.3.2.cmml" xref="A1.E7.m2.1.1.1.3.3.2.3.2">𝑦</ci><ci id="A1.E7.m2.1.1.1.3.3.2.3.3.cmml" xref="A1.E7.m2.1.1.1.3.3.2.3.3">𝑖</ci></apply></apply><apply id="A1.E7.m2.1.1.1.3.3.3.cmml" xref="A1.E7.m2.1.1.1.3.3.3"><csymbol cd="ambiguous" id="A1.E7.m2.1.1.1.3.3.3.1.cmml" xref="A1.E7.m2.1.1.1.3.3.3">subscript</csymbol><ci id="A1.E7.m2.1.1.1.3.3.3.2.cmml" xref="A1.E7.m2.1.1.1.3.3.3.2">𝑦</ci><ci id="A1.E7.m2.1.1.1.3.3.3.3.cmml" xref="A1.E7.m2.1.1.1.3.3.3.3">𝑗</ci></apply></apply></apply><apply id="A1.E7.m2.1.1.1.1.2.cmml" xref="A1.E7.m2.1.1.1.1.1"><csymbol cd="latexml" id="A1.E7.m2.1.1.1.1.2.1.cmml" xref="A1.E7.m2.1.1.1.1.1.2">delimited-[]</csymbol><list id="A1.E7.m2.1.1.1.1.1.1.3.cmml" xref="A1.E7.m2.1.1.1.1.1.1.2"><apply id="A1.E7.m2.1.1.1.1.1.1.1.1.cmml" xref="A1.E7.m2.1.1.1.1.1.1.1.1"><times id="A1.E7.m2.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E7.m2.1.1.1.1.1.1.1.1.2"></times><ci id="A1.E7.m2.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E7.m2.1.1.1.1.1.1.1.1.3">𝛿</ci><apply id="A1.E7.m2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E7.m2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E7.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E7.m2.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E7.m2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E7.m2.1.1.1.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="A1.E7.m2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E7.m2.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="A1.E7.m2.1.1.1.1.1.1.2.2.cmml" xref="A1.E7.m2.1.1.1.1.1.1.2.2"><times id="A1.E7.m2.1.1.1.1.1.1.2.2.2.cmml" xref="A1.E7.m2.1.1.1.1.1.1.2.2.2"></times><ci id="A1.E7.m2.1.1.1.1.1.1.2.2.3.cmml" xref="A1.E7.m2.1.1.1.1.1.1.2.2.3">𝛿</ci><apply id="A1.E7.m2.1.1.1.1.1.1.2.2.1.1.1.cmml" xref="A1.E7.m2.1.1.1.1.1.1.2.2.1.1"><csymbol cd="ambiguous" id="A1.E7.m2.1.1.1.1.1.1.2.2.1.1.1.1.cmml" xref="A1.E7.m2.1.1.1.1.1.1.2.2.1.1">subscript</csymbol><ci id="A1.E7.m2.1.1.1.1.1.1.2.2.1.1.1.2.cmml" xref="A1.E7.m2.1.1.1.1.1.1.2.2.1.1.1.2">𝑥</ci><ci id="A1.E7.m2.1.1.1.1.1.1.2.2.1.1.1.3.cmml" xref="A1.E7.m2.1.1.1.1.1.1.2.2.1.1.1.3">𝑗</ci></apply></apply></list></apply></apply><apply id="A1.E7.m2.2.2.2.cmml" xref="A1.E7.m2.2.2.2"><times id="A1.E7.m2.2.2.2.2.cmml" xref="A1.E7.m2.2.2.2.2"></times><apply id="A1.E7.m2.2.2.2.3.cmml" xref="A1.E7.m2.2.2.2.3"><csymbol cd="ambiguous" id="A1.E7.m2.2.2.2.3.1.cmml" xref="A1.E7.m2.2.2.2.3">subscript</csymbol><ci id="A1.E7.m2.2.2.2.3.2.cmml" xref="A1.E7.m2.2.2.2.3.2">𝔼</ci><ci id="A1.E7.m2.2.2.2.3.3.cmml" xref="A1.E7.m2.2.2.2.3.3">𝑗</ci></apply><apply id="A1.E7.m2.2.2.2.1.2.cmml" xref="A1.E7.m2.2.2.2.1.1"><csymbol cd="latexml" id="A1.E7.m2.2.2.2.1.2.1.cmml" xref="A1.E7.m2.2.2.2.1.1.2">delimited-[]</csymbol><list id="A1.E7.m2.2.2.2.1.1.1.3.cmml" xref="A1.E7.m2.2.2.2.1.1.1.2"><apply id="A1.E7.m2.2.2.2.1.1.1.1.1.cmml" xref="A1.E7.m2.2.2.2.1.1.1.1.1"><times id="A1.E7.m2.2.2.2.1.1.1.1.1.2.cmml" xref="A1.E7.m2.2.2.2.1.1.1.1.1.2"></times><ci id="A1.E7.m2.2.2.2.1.1.1.1.1.3.cmml" xref="A1.E7.m2.2.2.2.1.1.1.1.1.3">𝛿</ci><apply id="A1.E7.m2.2.2.2.1.1.1.1.1.1.1.1.cmml" xref="A1.E7.m2.2.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E7.m2.2.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E7.m2.2.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E7.m2.2.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E7.m2.2.2.2.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="A1.E7.m2.2.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E7.m2.2.2.2.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="A1.E7.m2.2.2.2.1.1.1.2.2.cmml" xref="A1.E7.m2.2.2.2.1.1.1.2.2"><times id="A1.E7.m2.2.2.2.1.1.1.2.2.2.cmml" xref="A1.E7.m2.2.2.2.1.1.1.2.2.2"></times><ci id="A1.E7.m2.2.2.2.1.1.1.2.2.3.cmml" xref="A1.E7.m2.2.2.2.1.1.1.2.2.3">𝛿</ci><apply id="A1.E7.m2.2.2.2.1.1.1.2.2.1.1.1.cmml" xref="A1.E7.m2.2.2.2.1.1.1.2.2.1.1"><csymbol cd="ambiguous" id="A1.E7.m2.2.2.2.1.1.1.2.2.1.1.1.1.cmml" xref="A1.E7.m2.2.2.2.1.1.1.2.2.1.1">subscript</csymbol><ci id="A1.E7.m2.2.2.2.1.1.1.2.2.1.1.1.2.cmml" xref="A1.E7.m2.2.2.2.1.1.1.2.2.1.1.1.2">𝑥</ci><ci id="A1.E7.m2.2.2.2.1.1.1.2.2.1.1.1.3.cmml" xref="A1.E7.m2.2.2.2.1.1.1.2.2.1.1.1.3">𝑗</ci></apply></apply></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E7.m2.2c">\displaystyle=r_{y_{i}}\frac{\mathbb{E}_{j|y_{i}=y_{j}}\left[\left\langle%
\delta(x_{i}),\delta(x_{j})\right\rangle\right]}{\mathbb{E}_{j}\left[\left%
\langle\delta(x_{i}),\delta(x_{j})\right\rangle\right]}</annotation><annotation encoding="application/x-llamapun" id="A1.E7.m2.2d">= italic_r start_POSTSUBSCRIPT italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT divide start_ARG blackboard_E start_POSTSUBSCRIPT italic_j | italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_y start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ ⟨ italic_δ ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) , italic_δ ( italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ⟩ ] end_ARG start_ARG blackboard_E start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT [ ⟨ italic_δ ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) , italic_δ ( italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ⟩ ] end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
<tbody id="A1.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\approx r_{y_{i}}\frac{1+\mathbb{E}_{j|y_{i}=y_{j}}\left[B_{i,j}%
\right]+\mathbb{E}_{j|y_{i}=y_{j}}\left[\left\langle\epsilon(p_{i}),\epsilon(p%
_{j})\right\rangle\right]}{1+\mathbb{E}_{j}\left[B_{i,j}\right]+\mathbb{E}_{j}%
\left[\left\langle\epsilon(p_{i}),\epsilon(p_{j})\right\rangle\right]}," class="ltx_Math" display="inline" id="A1.E8.m1.9"><semantics id="A1.E8.m1.9a"><mrow id="A1.E8.m1.9.9.1" xref="A1.E8.m1.9.9.1.1.cmml"><mrow id="A1.E8.m1.9.9.1.1" xref="A1.E8.m1.9.9.1.1.cmml"><mi id="A1.E8.m1.9.9.1.1.2" xref="A1.E8.m1.9.9.1.1.2.cmml"></mi><mo id="A1.E8.m1.9.9.1.1.1" xref="A1.E8.m1.9.9.1.1.1.cmml">≈</mo><mrow id="A1.E8.m1.9.9.1.1.3" xref="A1.E8.m1.9.9.1.1.3.cmml"><msub id="A1.E8.m1.9.9.1.1.3.2" xref="A1.E8.m1.9.9.1.1.3.2.cmml"><mi id="A1.E8.m1.9.9.1.1.3.2.2" xref="A1.E8.m1.9.9.1.1.3.2.2.cmml">r</mi><msub id="A1.E8.m1.9.9.1.1.3.2.3" xref="A1.E8.m1.9.9.1.1.3.2.3.cmml"><mi id="A1.E8.m1.9.9.1.1.3.2.3.2" xref="A1.E8.m1.9.9.1.1.3.2.3.2.cmml">y</mi><mi id="A1.E8.m1.9.9.1.1.3.2.3.3" xref="A1.E8.m1.9.9.1.1.3.2.3.3.cmml">i</mi></msub></msub><mo id="A1.E8.m1.9.9.1.1.3.1" xref="A1.E8.m1.9.9.1.1.3.1.cmml">⁢</mo><mstyle displaystyle="true" id="A1.E8.m1.8.8" xref="A1.E8.m1.8.8.cmml"><mfrac id="A1.E8.m1.8.8a" xref="A1.E8.m1.8.8.cmml"><mrow id="A1.E8.m1.4.4.4" xref="A1.E8.m1.4.4.4.cmml"><mn id="A1.E8.m1.4.4.4.6" xref="A1.E8.m1.4.4.4.6.cmml">1</mn><mo id="A1.E8.m1.4.4.4.5" xref="A1.E8.m1.4.4.4.5.cmml">+</mo><mrow id="A1.E8.m1.3.3.3.3" xref="A1.E8.m1.3.3.3.3.cmml"><msub id="A1.E8.m1.3.3.3.3.3" xref="A1.E8.m1.3.3.3.3.3.cmml"><mi id="A1.E8.m1.3.3.3.3.3.2" xref="A1.E8.m1.3.3.3.3.3.2.cmml">𝔼</mi><mrow id="A1.E8.m1.3.3.3.3.3.3" xref="A1.E8.m1.3.3.3.3.3.3.cmml"><mrow id="A1.E8.m1.3.3.3.3.3.3.2" xref="A1.E8.m1.3.3.3.3.3.3.2.cmml"><mi id="A1.E8.m1.3.3.3.3.3.3.2.2" xref="A1.E8.m1.3.3.3.3.3.3.2.2.cmml">j</mi><mo fence="false" id="A1.E8.m1.3.3.3.3.3.3.2.1" xref="A1.E8.m1.3.3.3.3.3.3.2.1.cmml">|</mo><msub id="A1.E8.m1.3.3.3.3.3.3.2.3" xref="A1.E8.m1.3.3.3.3.3.3.2.3.cmml"><mi id="A1.E8.m1.3.3.3.3.3.3.2.3.2" xref="A1.E8.m1.3.3.3.3.3.3.2.3.2.cmml">y</mi><mi id="A1.E8.m1.3.3.3.3.3.3.2.3.3" xref="A1.E8.m1.3.3.3.3.3.3.2.3.3.cmml">i</mi></msub></mrow><mo id="A1.E8.m1.3.3.3.3.3.3.1" xref="A1.E8.m1.3.3.3.3.3.3.1.cmml">=</mo><msub id="A1.E8.m1.3.3.3.3.3.3.3" xref="A1.E8.m1.3.3.3.3.3.3.3.cmml"><mi id="A1.E8.m1.3.3.3.3.3.3.3.2" xref="A1.E8.m1.3.3.3.3.3.3.3.2.cmml">y</mi><mi id="A1.E8.m1.3.3.3.3.3.3.3.3" xref="A1.E8.m1.3.3.3.3.3.3.3.3.cmml">j</mi></msub></mrow></msub><mo id="A1.E8.m1.3.3.3.3.2" xref="A1.E8.m1.3.3.3.3.2.cmml">⁢</mo><mrow id="A1.E8.m1.3.3.3.3.1.1" xref="A1.E8.m1.3.3.3.3.1.2.cmml"><mo id="A1.E8.m1.3.3.3.3.1.1.2" xref="A1.E8.m1.3.3.3.3.1.2.1.cmml">[</mo><msub id="A1.E8.m1.3.3.3.3.1.1.1" xref="A1.E8.m1.3.3.3.3.1.1.1.cmml"><mi id="A1.E8.m1.3.3.3.3.1.1.1.2" xref="A1.E8.m1.3.3.3.3.1.1.1.2.cmml">B</mi><mrow id="A1.E8.m1.2.2.2.2.2.4" xref="A1.E8.m1.2.2.2.2.2.3.cmml"><mi id="A1.E8.m1.1.1.1.1.1.1" xref="A1.E8.m1.1.1.1.1.1.1.cmml">i</mi><mo id="A1.E8.m1.2.2.2.2.2.4.1" xref="A1.E8.m1.2.2.2.2.2.3.cmml">,</mo><mi id="A1.E8.m1.2.2.2.2.2.2" xref="A1.E8.m1.2.2.2.2.2.2.cmml">j</mi></mrow></msub><mo id="A1.E8.m1.3.3.3.3.1.1.3" xref="A1.E8.m1.3.3.3.3.1.2.1.cmml">]</mo></mrow></mrow><mo id="A1.E8.m1.4.4.4.5a" xref="A1.E8.m1.4.4.4.5.cmml">+</mo><mrow id="A1.E8.m1.4.4.4.4" xref="A1.E8.m1.4.4.4.4.cmml"><msub id="A1.E8.m1.4.4.4.4.3" xref="A1.E8.m1.4.4.4.4.3.cmml"><mi id="A1.E8.m1.4.4.4.4.3.2" xref="A1.E8.m1.4.4.4.4.3.2.cmml">𝔼</mi><mrow id="A1.E8.m1.4.4.4.4.3.3" xref="A1.E8.m1.4.4.4.4.3.3.cmml"><mrow id="A1.E8.m1.4.4.4.4.3.3.2" xref="A1.E8.m1.4.4.4.4.3.3.2.cmml"><mi id="A1.E8.m1.4.4.4.4.3.3.2.2" xref="A1.E8.m1.4.4.4.4.3.3.2.2.cmml">j</mi><mo fence="false" id="A1.E8.m1.4.4.4.4.3.3.2.1" xref="A1.E8.m1.4.4.4.4.3.3.2.1.cmml">|</mo><msub id="A1.E8.m1.4.4.4.4.3.3.2.3" xref="A1.E8.m1.4.4.4.4.3.3.2.3.cmml"><mi id="A1.E8.m1.4.4.4.4.3.3.2.3.2" xref="A1.E8.m1.4.4.4.4.3.3.2.3.2.cmml">y</mi><mi id="A1.E8.m1.4.4.4.4.3.3.2.3.3" xref="A1.E8.m1.4.4.4.4.3.3.2.3.3.cmml">i</mi></msub></mrow><mo id="A1.E8.m1.4.4.4.4.3.3.1" xref="A1.E8.m1.4.4.4.4.3.3.1.cmml">=</mo><msub id="A1.E8.m1.4.4.4.4.3.3.3" xref="A1.E8.m1.4.4.4.4.3.3.3.cmml"><mi id="A1.E8.m1.4.4.4.4.3.3.3.2" xref="A1.E8.m1.4.4.4.4.3.3.3.2.cmml">y</mi><mi id="A1.E8.m1.4.4.4.4.3.3.3.3" xref="A1.E8.m1.4.4.4.4.3.3.3.3.cmml">j</mi></msub></mrow></msub><mo id="A1.E8.m1.4.4.4.4.2" xref="A1.E8.m1.4.4.4.4.2.cmml">⁢</mo><mrow id="A1.E8.m1.4.4.4.4.1.1" xref="A1.E8.m1.4.4.4.4.1.2.cmml"><mo id="A1.E8.m1.4.4.4.4.1.1.2" xref="A1.E8.m1.4.4.4.4.1.2.1.cmml">[</mo><mrow id="A1.E8.m1.4.4.4.4.1.1.1.2" xref="A1.E8.m1.4.4.4.4.1.1.1.3.cmml"><mo id="A1.E8.m1.4.4.4.4.1.1.1.2.3" xref="A1.E8.m1.4.4.4.4.1.1.1.3.cmml">⟨</mo><mrow id="A1.E8.m1.4.4.4.4.1.1.1.1.1" xref="A1.E8.m1.4.4.4.4.1.1.1.1.1.cmml"><mi id="A1.E8.m1.4.4.4.4.1.1.1.1.1.3" xref="A1.E8.m1.4.4.4.4.1.1.1.1.1.3.cmml">ϵ</mi><mo id="A1.E8.m1.4.4.4.4.1.1.1.1.1.2" xref="A1.E8.m1.4.4.4.4.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E8.m1.4.4.4.4.1.1.1.1.1.1.1" xref="A1.E8.m1.4.4.4.4.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E8.m1.4.4.4.4.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E8.m1.4.4.4.4.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A1.E8.m1.4.4.4.4.1.1.1.1.1.1.1.1" xref="A1.E8.m1.4.4.4.4.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E8.m1.4.4.4.4.1.1.1.1.1.1.1.1.2" xref="A1.E8.m1.4.4.4.4.1.1.1.1.1.1.1.1.2.cmml">p</mi><mi id="A1.E8.m1.4.4.4.4.1.1.1.1.1.1.1.1.3" xref="A1.E8.m1.4.4.4.4.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.E8.m1.4.4.4.4.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E8.m1.4.4.4.4.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E8.m1.4.4.4.4.1.1.1.2.4" xref="A1.E8.m1.4.4.4.4.1.1.1.3.cmml">,</mo><mrow id="A1.E8.m1.4.4.4.4.1.1.1.2.2" xref="A1.E8.m1.4.4.4.4.1.1.1.2.2.cmml"><mi id="A1.E8.m1.4.4.4.4.1.1.1.2.2.3" xref="A1.E8.m1.4.4.4.4.1.1.1.2.2.3.cmml">ϵ</mi><mo id="A1.E8.m1.4.4.4.4.1.1.1.2.2.2" xref="A1.E8.m1.4.4.4.4.1.1.1.2.2.2.cmml">⁢</mo><mrow id="A1.E8.m1.4.4.4.4.1.1.1.2.2.1.1" xref="A1.E8.m1.4.4.4.4.1.1.1.2.2.1.1.1.cmml"><mo id="A1.E8.m1.4.4.4.4.1.1.1.2.2.1.1.2" stretchy="false" xref="A1.E8.m1.4.4.4.4.1.1.1.2.2.1.1.1.cmml">(</mo><msub id="A1.E8.m1.4.4.4.4.1.1.1.2.2.1.1.1" xref="A1.E8.m1.4.4.4.4.1.1.1.2.2.1.1.1.cmml"><mi id="A1.E8.m1.4.4.4.4.1.1.1.2.2.1.1.1.2" xref="A1.E8.m1.4.4.4.4.1.1.1.2.2.1.1.1.2.cmml">p</mi><mi id="A1.E8.m1.4.4.4.4.1.1.1.2.2.1.1.1.3" xref="A1.E8.m1.4.4.4.4.1.1.1.2.2.1.1.1.3.cmml">j</mi></msub><mo id="A1.E8.m1.4.4.4.4.1.1.1.2.2.1.1.3" stretchy="false" xref="A1.E8.m1.4.4.4.4.1.1.1.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E8.m1.4.4.4.4.1.1.1.2.5" xref="A1.E8.m1.4.4.4.4.1.1.1.3.cmml">⟩</mo></mrow><mo id="A1.E8.m1.4.4.4.4.1.1.3" xref="A1.E8.m1.4.4.4.4.1.2.1.cmml">]</mo></mrow></mrow></mrow><mrow id="A1.E8.m1.8.8.8" xref="A1.E8.m1.8.8.8.cmml"><mn id="A1.E8.m1.8.8.8.6" xref="A1.E8.m1.8.8.8.6.cmml">1</mn><mo id="A1.E8.m1.8.8.8.5" xref="A1.E8.m1.8.8.8.5.cmml">+</mo><mrow id="A1.E8.m1.7.7.7.3" xref="A1.E8.m1.7.7.7.3.cmml"><msub id="A1.E8.m1.7.7.7.3.3" xref="A1.E8.m1.7.7.7.3.3.cmml"><mi id="A1.E8.m1.7.7.7.3.3.2" xref="A1.E8.m1.7.7.7.3.3.2.cmml">𝔼</mi><mi id="A1.E8.m1.7.7.7.3.3.3" xref="A1.E8.m1.7.7.7.3.3.3.cmml">j</mi></msub><mo id="A1.E8.m1.7.7.7.3.2" xref="A1.E8.m1.7.7.7.3.2.cmml">⁢</mo><mrow id="A1.E8.m1.7.7.7.3.1.1" xref="A1.E8.m1.7.7.7.3.1.2.cmml"><mo id="A1.E8.m1.7.7.7.3.1.1.2" xref="A1.E8.m1.7.7.7.3.1.2.1.cmml">[</mo><msub id="A1.E8.m1.7.7.7.3.1.1.1" xref="A1.E8.m1.7.7.7.3.1.1.1.cmml"><mi id="A1.E8.m1.7.7.7.3.1.1.1.2" xref="A1.E8.m1.7.7.7.3.1.1.1.2.cmml">B</mi><mrow id="A1.E8.m1.6.6.6.2.2.4" xref="A1.E8.m1.6.6.6.2.2.3.cmml"><mi id="A1.E8.m1.5.5.5.1.1.1" xref="A1.E8.m1.5.5.5.1.1.1.cmml">i</mi><mo id="A1.E8.m1.6.6.6.2.2.4.1" xref="A1.E8.m1.6.6.6.2.2.3.cmml">,</mo><mi id="A1.E8.m1.6.6.6.2.2.2" xref="A1.E8.m1.6.6.6.2.2.2.cmml">j</mi></mrow></msub><mo id="A1.E8.m1.7.7.7.3.1.1.3" xref="A1.E8.m1.7.7.7.3.1.2.1.cmml">]</mo></mrow></mrow><mo id="A1.E8.m1.8.8.8.5a" xref="A1.E8.m1.8.8.8.5.cmml">+</mo><mrow id="A1.E8.m1.8.8.8.4" xref="A1.E8.m1.8.8.8.4.cmml"><msub id="A1.E8.m1.8.8.8.4.3" xref="A1.E8.m1.8.8.8.4.3.cmml"><mi id="A1.E8.m1.8.8.8.4.3.2" xref="A1.E8.m1.8.8.8.4.3.2.cmml">𝔼</mi><mi id="A1.E8.m1.8.8.8.4.3.3" xref="A1.E8.m1.8.8.8.4.3.3.cmml">j</mi></msub><mo id="A1.E8.m1.8.8.8.4.2" xref="A1.E8.m1.8.8.8.4.2.cmml">⁢</mo><mrow id="A1.E8.m1.8.8.8.4.1.1" xref="A1.E8.m1.8.8.8.4.1.2.cmml"><mo id="A1.E8.m1.8.8.8.4.1.1.2" xref="A1.E8.m1.8.8.8.4.1.2.1.cmml">[</mo><mrow id="A1.E8.m1.8.8.8.4.1.1.1.2" xref="A1.E8.m1.8.8.8.4.1.1.1.3.cmml"><mo id="A1.E8.m1.8.8.8.4.1.1.1.2.3" xref="A1.E8.m1.8.8.8.4.1.1.1.3.cmml">⟨</mo><mrow id="A1.E8.m1.8.8.8.4.1.1.1.1.1" xref="A1.E8.m1.8.8.8.4.1.1.1.1.1.cmml"><mi id="A1.E8.m1.8.8.8.4.1.1.1.1.1.3" xref="A1.E8.m1.8.8.8.4.1.1.1.1.1.3.cmml">ϵ</mi><mo id="A1.E8.m1.8.8.8.4.1.1.1.1.1.2" xref="A1.E8.m1.8.8.8.4.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E8.m1.8.8.8.4.1.1.1.1.1.1.1" xref="A1.E8.m1.8.8.8.4.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E8.m1.8.8.8.4.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E8.m1.8.8.8.4.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A1.E8.m1.8.8.8.4.1.1.1.1.1.1.1.1" xref="A1.E8.m1.8.8.8.4.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E8.m1.8.8.8.4.1.1.1.1.1.1.1.1.2" xref="A1.E8.m1.8.8.8.4.1.1.1.1.1.1.1.1.2.cmml">p</mi><mi id="A1.E8.m1.8.8.8.4.1.1.1.1.1.1.1.1.3" xref="A1.E8.m1.8.8.8.4.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.E8.m1.8.8.8.4.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E8.m1.8.8.8.4.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E8.m1.8.8.8.4.1.1.1.2.4" xref="A1.E8.m1.8.8.8.4.1.1.1.3.cmml">,</mo><mrow id="A1.E8.m1.8.8.8.4.1.1.1.2.2" xref="A1.E8.m1.8.8.8.4.1.1.1.2.2.cmml"><mi id="A1.E8.m1.8.8.8.4.1.1.1.2.2.3" xref="A1.E8.m1.8.8.8.4.1.1.1.2.2.3.cmml">ϵ</mi><mo id="A1.E8.m1.8.8.8.4.1.1.1.2.2.2" xref="A1.E8.m1.8.8.8.4.1.1.1.2.2.2.cmml">⁢</mo><mrow id="A1.E8.m1.8.8.8.4.1.1.1.2.2.1.1" xref="A1.E8.m1.8.8.8.4.1.1.1.2.2.1.1.1.cmml"><mo id="A1.E8.m1.8.8.8.4.1.1.1.2.2.1.1.2" stretchy="false" xref="A1.E8.m1.8.8.8.4.1.1.1.2.2.1.1.1.cmml">(</mo><msub id="A1.E8.m1.8.8.8.4.1.1.1.2.2.1.1.1" xref="A1.E8.m1.8.8.8.4.1.1.1.2.2.1.1.1.cmml"><mi id="A1.E8.m1.8.8.8.4.1.1.1.2.2.1.1.1.2" xref="A1.E8.m1.8.8.8.4.1.1.1.2.2.1.1.1.2.cmml">p</mi><mi id="A1.E8.m1.8.8.8.4.1.1.1.2.2.1.1.1.3" xref="A1.E8.m1.8.8.8.4.1.1.1.2.2.1.1.1.3.cmml">j</mi></msub><mo id="A1.E8.m1.8.8.8.4.1.1.1.2.2.1.1.3" stretchy="false" xref="A1.E8.m1.8.8.8.4.1.1.1.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E8.m1.8.8.8.4.1.1.1.2.5" xref="A1.E8.m1.8.8.8.4.1.1.1.3.cmml">⟩</mo></mrow><mo id="A1.E8.m1.8.8.8.4.1.1.3" xref="A1.E8.m1.8.8.8.4.1.2.1.cmml">]</mo></mrow></mrow></mrow></mfrac></mstyle></mrow></mrow><mo id="A1.E8.m1.9.9.1.2" xref="A1.E8.m1.9.9.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E8.m1.9b"><apply id="A1.E8.m1.9.9.1.1.cmml" xref="A1.E8.m1.9.9.1"><approx id="A1.E8.m1.9.9.1.1.1.cmml" xref="A1.E8.m1.9.9.1.1.1"></approx><csymbol cd="latexml" id="A1.E8.m1.9.9.1.1.2.cmml" xref="A1.E8.m1.9.9.1.1.2">absent</csymbol><apply id="A1.E8.m1.9.9.1.1.3.cmml" xref="A1.E8.m1.9.9.1.1.3"><times id="A1.E8.m1.9.9.1.1.3.1.cmml" xref="A1.E8.m1.9.9.1.1.3.1"></times><apply id="A1.E8.m1.9.9.1.1.3.2.cmml" xref="A1.E8.m1.9.9.1.1.3.2"><csymbol cd="ambiguous" id="A1.E8.m1.9.9.1.1.3.2.1.cmml" xref="A1.E8.m1.9.9.1.1.3.2">subscript</csymbol><ci id="A1.E8.m1.9.9.1.1.3.2.2.cmml" xref="A1.E8.m1.9.9.1.1.3.2.2">𝑟</ci><apply id="A1.E8.m1.9.9.1.1.3.2.3.cmml" xref="A1.E8.m1.9.9.1.1.3.2.3"><csymbol cd="ambiguous" id="A1.E8.m1.9.9.1.1.3.2.3.1.cmml" xref="A1.E8.m1.9.9.1.1.3.2.3">subscript</csymbol><ci id="A1.E8.m1.9.9.1.1.3.2.3.2.cmml" xref="A1.E8.m1.9.9.1.1.3.2.3.2">𝑦</ci><ci id="A1.E8.m1.9.9.1.1.3.2.3.3.cmml" xref="A1.E8.m1.9.9.1.1.3.2.3.3">𝑖</ci></apply></apply><apply id="A1.E8.m1.8.8.cmml" xref="A1.E8.m1.8.8"><divide id="A1.E8.m1.8.8.9.cmml" xref="A1.E8.m1.8.8"></divide><apply id="A1.E8.m1.4.4.4.cmml" xref="A1.E8.m1.4.4.4"><plus id="A1.E8.m1.4.4.4.5.cmml" xref="A1.E8.m1.4.4.4.5"></plus><cn id="A1.E8.m1.4.4.4.6.cmml" type="integer" xref="A1.E8.m1.4.4.4.6">1</cn><apply id="A1.E8.m1.3.3.3.3.cmml" xref="A1.E8.m1.3.3.3.3"><times id="A1.E8.m1.3.3.3.3.2.cmml" xref="A1.E8.m1.3.3.3.3.2"></times><apply id="A1.E8.m1.3.3.3.3.3.cmml" xref="A1.E8.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="A1.E8.m1.3.3.3.3.3.1.cmml" xref="A1.E8.m1.3.3.3.3.3">subscript</csymbol><ci id="A1.E8.m1.3.3.3.3.3.2.cmml" xref="A1.E8.m1.3.3.3.3.3.2">𝔼</ci><apply id="A1.E8.m1.3.3.3.3.3.3.cmml" xref="A1.E8.m1.3.3.3.3.3.3"><eq id="A1.E8.m1.3.3.3.3.3.3.1.cmml" xref="A1.E8.m1.3.3.3.3.3.3.1"></eq><apply id="A1.E8.m1.3.3.3.3.3.3.2.cmml" xref="A1.E8.m1.3.3.3.3.3.3.2"><csymbol cd="latexml" id="A1.E8.m1.3.3.3.3.3.3.2.1.cmml" xref="A1.E8.m1.3.3.3.3.3.3.2.1">conditional</csymbol><ci id="A1.E8.m1.3.3.3.3.3.3.2.2.cmml" xref="A1.E8.m1.3.3.3.3.3.3.2.2">𝑗</ci><apply id="A1.E8.m1.3.3.3.3.3.3.2.3.cmml" xref="A1.E8.m1.3.3.3.3.3.3.2.3"><csymbol cd="ambiguous" id="A1.E8.m1.3.3.3.3.3.3.2.3.1.cmml" xref="A1.E8.m1.3.3.3.3.3.3.2.3">subscript</csymbol><ci id="A1.E8.m1.3.3.3.3.3.3.2.3.2.cmml" xref="A1.E8.m1.3.3.3.3.3.3.2.3.2">𝑦</ci><ci id="A1.E8.m1.3.3.3.3.3.3.2.3.3.cmml" xref="A1.E8.m1.3.3.3.3.3.3.2.3.3">𝑖</ci></apply></apply><apply id="A1.E8.m1.3.3.3.3.3.3.3.cmml" xref="A1.E8.m1.3.3.3.3.3.3.3"><csymbol cd="ambiguous" id="A1.E8.m1.3.3.3.3.3.3.3.1.cmml" xref="A1.E8.m1.3.3.3.3.3.3.3">subscript</csymbol><ci id="A1.E8.m1.3.3.3.3.3.3.3.2.cmml" xref="A1.E8.m1.3.3.3.3.3.3.3.2">𝑦</ci><ci id="A1.E8.m1.3.3.3.3.3.3.3.3.cmml" xref="A1.E8.m1.3.3.3.3.3.3.3.3">𝑗</ci></apply></apply></apply><apply id="A1.E8.m1.3.3.3.3.1.2.cmml" xref="A1.E8.m1.3.3.3.3.1.1"><csymbol cd="latexml" id="A1.E8.m1.3.3.3.3.1.2.1.cmml" xref="A1.E8.m1.3.3.3.3.1.1.2">delimited-[]</csymbol><apply id="A1.E8.m1.3.3.3.3.1.1.1.cmml" xref="A1.E8.m1.3.3.3.3.1.1.1"><csymbol cd="ambiguous" id="A1.E8.m1.3.3.3.3.1.1.1.1.cmml" xref="A1.E8.m1.3.3.3.3.1.1.1">subscript</csymbol><ci id="A1.E8.m1.3.3.3.3.1.1.1.2.cmml" xref="A1.E8.m1.3.3.3.3.1.1.1.2">𝐵</ci><list id="A1.E8.m1.2.2.2.2.2.3.cmml" xref="A1.E8.m1.2.2.2.2.2.4"><ci id="A1.E8.m1.1.1.1.1.1.1.cmml" xref="A1.E8.m1.1.1.1.1.1.1">𝑖</ci><ci id="A1.E8.m1.2.2.2.2.2.2.cmml" xref="A1.E8.m1.2.2.2.2.2.2">𝑗</ci></list></apply></apply></apply><apply id="A1.E8.m1.4.4.4.4.cmml" xref="A1.E8.m1.4.4.4.4"><times id="A1.E8.m1.4.4.4.4.2.cmml" xref="A1.E8.m1.4.4.4.4.2"></times><apply id="A1.E8.m1.4.4.4.4.3.cmml" xref="A1.E8.m1.4.4.4.4.3"><csymbol cd="ambiguous" id="A1.E8.m1.4.4.4.4.3.1.cmml" xref="A1.E8.m1.4.4.4.4.3">subscript</csymbol><ci id="A1.E8.m1.4.4.4.4.3.2.cmml" xref="A1.E8.m1.4.4.4.4.3.2">𝔼</ci><apply id="A1.E8.m1.4.4.4.4.3.3.cmml" xref="A1.E8.m1.4.4.4.4.3.3"><eq id="A1.E8.m1.4.4.4.4.3.3.1.cmml" xref="A1.E8.m1.4.4.4.4.3.3.1"></eq><apply id="A1.E8.m1.4.4.4.4.3.3.2.cmml" xref="A1.E8.m1.4.4.4.4.3.3.2"><csymbol cd="latexml" id="A1.E8.m1.4.4.4.4.3.3.2.1.cmml" xref="A1.E8.m1.4.4.4.4.3.3.2.1">conditional</csymbol><ci id="A1.E8.m1.4.4.4.4.3.3.2.2.cmml" xref="A1.E8.m1.4.4.4.4.3.3.2.2">𝑗</ci><apply id="A1.E8.m1.4.4.4.4.3.3.2.3.cmml" xref="A1.E8.m1.4.4.4.4.3.3.2.3"><csymbol cd="ambiguous" id="A1.E8.m1.4.4.4.4.3.3.2.3.1.cmml" xref="A1.E8.m1.4.4.4.4.3.3.2.3">subscript</csymbol><ci id="A1.E8.m1.4.4.4.4.3.3.2.3.2.cmml" xref="A1.E8.m1.4.4.4.4.3.3.2.3.2">𝑦</ci><ci id="A1.E8.m1.4.4.4.4.3.3.2.3.3.cmml" xref="A1.E8.m1.4.4.4.4.3.3.2.3.3">𝑖</ci></apply></apply><apply id="A1.E8.m1.4.4.4.4.3.3.3.cmml" xref="A1.E8.m1.4.4.4.4.3.3.3"><csymbol cd="ambiguous" id="A1.E8.m1.4.4.4.4.3.3.3.1.cmml" xref="A1.E8.m1.4.4.4.4.3.3.3">subscript</csymbol><ci id="A1.E8.m1.4.4.4.4.3.3.3.2.cmml" xref="A1.E8.m1.4.4.4.4.3.3.3.2">𝑦</ci><ci id="A1.E8.m1.4.4.4.4.3.3.3.3.cmml" xref="A1.E8.m1.4.4.4.4.3.3.3.3">𝑗</ci></apply></apply></apply><apply id="A1.E8.m1.4.4.4.4.1.2.cmml" xref="A1.E8.m1.4.4.4.4.1.1"><csymbol cd="latexml" id="A1.E8.m1.4.4.4.4.1.2.1.cmml" xref="A1.E8.m1.4.4.4.4.1.1.2">delimited-[]</csymbol><list id="A1.E8.m1.4.4.4.4.1.1.1.3.cmml" xref="A1.E8.m1.4.4.4.4.1.1.1.2"><apply id="A1.E8.m1.4.4.4.4.1.1.1.1.1.cmml" xref="A1.E8.m1.4.4.4.4.1.1.1.1.1"><times id="A1.E8.m1.4.4.4.4.1.1.1.1.1.2.cmml" xref="A1.E8.m1.4.4.4.4.1.1.1.1.1.2"></times><ci id="A1.E8.m1.4.4.4.4.1.1.1.1.1.3.cmml" xref="A1.E8.m1.4.4.4.4.1.1.1.1.1.3">italic-ϵ</ci><apply id="A1.E8.m1.4.4.4.4.1.1.1.1.1.1.1.1.cmml" xref="A1.E8.m1.4.4.4.4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E8.m1.4.4.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E8.m1.4.4.4.4.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E8.m1.4.4.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E8.m1.4.4.4.4.1.1.1.1.1.1.1.1.2">𝑝</ci><ci id="A1.E8.m1.4.4.4.4.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E8.m1.4.4.4.4.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="A1.E8.m1.4.4.4.4.1.1.1.2.2.cmml" xref="A1.E8.m1.4.4.4.4.1.1.1.2.2"><times id="A1.E8.m1.4.4.4.4.1.1.1.2.2.2.cmml" xref="A1.E8.m1.4.4.4.4.1.1.1.2.2.2"></times><ci id="A1.E8.m1.4.4.4.4.1.1.1.2.2.3.cmml" xref="A1.E8.m1.4.4.4.4.1.1.1.2.2.3">italic-ϵ</ci><apply id="A1.E8.m1.4.4.4.4.1.1.1.2.2.1.1.1.cmml" xref="A1.E8.m1.4.4.4.4.1.1.1.2.2.1.1"><csymbol cd="ambiguous" id="A1.E8.m1.4.4.4.4.1.1.1.2.2.1.1.1.1.cmml" xref="A1.E8.m1.4.4.4.4.1.1.1.2.2.1.1">subscript</csymbol><ci id="A1.E8.m1.4.4.4.4.1.1.1.2.2.1.1.1.2.cmml" xref="A1.E8.m1.4.4.4.4.1.1.1.2.2.1.1.1.2">𝑝</ci><ci id="A1.E8.m1.4.4.4.4.1.1.1.2.2.1.1.1.3.cmml" xref="A1.E8.m1.4.4.4.4.1.1.1.2.2.1.1.1.3">𝑗</ci></apply></apply></list></apply></apply></apply><apply id="A1.E8.m1.8.8.8.cmml" xref="A1.E8.m1.8.8.8"><plus id="A1.E8.m1.8.8.8.5.cmml" xref="A1.E8.m1.8.8.8.5"></plus><cn id="A1.E8.m1.8.8.8.6.cmml" type="integer" xref="A1.E8.m1.8.8.8.6">1</cn><apply id="A1.E8.m1.7.7.7.3.cmml" xref="A1.E8.m1.7.7.7.3"><times id="A1.E8.m1.7.7.7.3.2.cmml" xref="A1.E8.m1.7.7.7.3.2"></times><apply id="A1.E8.m1.7.7.7.3.3.cmml" xref="A1.E8.m1.7.7.7.3.3"><csymbol cd="ambiguous" id="A1.E8.m1.7.7.7.3.3.1.cmml" xref="A1.E8.m1.7.7.7.3.3">subscript</csymbol><ci id="A1.E8.m1.7.7.7.3.3.2.cmml" xref="A1.E8.m1.7.7.7.3.3.2">𝔼</ci><ci id="A1.E8.m1.7.7.7.3.3.3.cmml" xref="A1.E8.m1.7.7.7.3.3.3">𝑗</ci></apply><apply id="A1.E8.m1.7.7.7.3.1.2.cmml" xref="A1.E8.m1.7.7.7.3.1.1"><csymbol cd="latexml" id="A1.E8.m1.7.7.7.3.1.2.1.cmml" xref="A1.E8.m1.7.7.7.3.1.1.2">delimited-[]</csymbol><apply id="A1.E8.m1.7.7.7.3.1.1.1.cmml" xref="A1.E8.m1.7.7.7.3.1.1.1"><csymbol cd="ambiguous" id="A1.E8.m1.7.7.7.3.1.1.1.1.cmml" xref="A1.E8.m1.7.7.7.3.1.1.1">subscript</csymbol><ci id="A1.E8.m1.7.7.7.3.1.1.1.2.cmml" xref="A1.E8.m1.7.7.7.3.1.1.1.2">𝐵</ci><list id="A1.E8.m1.6.6.6.2.2.3.cmml" xref="A1.E8.m1.6.6.6.2.2.4"><ci id="A1.E8.m1.5.5.5.1.1.1.cmml" xref="A1.E8.m1.5.5.5.1.1.1">𝑖</ci><ci id="A1.E8.m1.6.6.6.2.2.2.cmml" xref="A1.E8.m1.6.6.6.2.2.2">𝑗</ci></list></apply></apply></apply><apply id="A1.E8.m1.8.8.8.4.cmml" xref="A1.E8.m1.8.8.8.4"><times id="A1.E8.m1.8.8.8.4.2.cmml" xref="A1.E8.m1.8.8.8.4.2"></times><apply id="A1.E8.m1.8.8.8.4.3.cmml" xref="A1.E8.m1.8.8.8.4.3"><csymbol cd="ambiguous" id="A1.E8.m1.8.8.8.4.3.1.cmml" xref="A1.E8.m1.8.8.8.4.3">subscript</csymbol><ci id="A1.E8.m1.8.8.8.4.3.2.cmml" xref="A1.E8.m1.8.8.8.4.3.2">𝔼</ci><ci id="A1.E8.m1.8.8.8.4.3.3.cmml" xref="A1.E8.m1.8.8.8.4.3.3">𝑗</ci></apply><apply id="A1.E8.m1.8.8.8.4.1.2.cmml" xref="A1.E8.m1.8.8.8.4.1.1"><csymbol cd="latexml" id="A1.E8.m1.8.8.8.4.1.2.1.cmml" xref="A1.E8.m1.8.8.8.4.1.1.2">delimited-[]</csymbol><list id="A1.E8.m1.8.8.8.4.1.1.1.3.cmml" xref="A1.E8.m1.8.8.8.4.1.1.1.2"><apply id="A1.E8.m1.8.8.8.4.1.1.1.1.1.cmml" xref="A1.E8.m1.8.8.8.4.1.1.1.1.1"><times id="A1.E8.m1.8.8.8.4.1.1.1.1.1.2.cmml" xref="A1.E8.m1.8.8.8.4.1.1.1.1.1.2"></times><ci id="A1.E8.m1.8.8.8.4.1.1.1.1.1.3.cmml" xref="A1.E8.m1.8.8.8.4.1.1.1.1.1.3">italic-ϵ</ci><apply id="A1.E8.m1.8.8.8.4.1.1.1.1.1.1.1.1.cmml" xref="A1.E8.m1.8.8.8.4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E8.m1.8.8.8.4.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E8.m1.8.8.8.4.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E8.m1.8.8.8.4.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E8.m1.8.8.8.4.1.1.1.1.1.1.1.1.2">𝑝</ci><ci id="A1.E8.m1.8.8.8.4.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E8.m1.8.8.8.4.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="A1.E8.m1.8.8.8.4.1.1.1.2.2.cmml" xref="A1.E8.m1.8.8.8.4.1.1.1.2.2"><times id="A1.E8.m1.8.8.8.4.1.1.1.2.2.2.cmml" xref="A1.E8.m1.8.8.8.4.1.1.1.2.2.2"></times><ci id="A1.E8.m1.8.8.8.4.1.1.1.2.2.3.cmml" xref="A1.E8.m1.8.8.8.4.1.1.1.2.2.3">italic-ϵ</ci><apply id="A1.E8.m1.8.8.8.4.1.1.1.2.2.1.1.1.cmml" xref="A1.E8.m1.8.8.8.4.1.1.1.2.2.1.1"><csymbol cd="ambiguous" id="A1.E8.m1.8.8.8.4.1.1.1.2.2.1.1.1.1.cmml" xref="A1.E8.m1.8.8.8.4.1.1.1.2.2.1.1">subscript</csymbol><ci id="A1.E8.m1.8.8.8.4.1.1.1.2.2.1.1.1.2.cmml" xref="A1.E8.m1.8.8.8.4.1.1.1.2.2.1.1.1.2">𝑝</ci><ci id="A1.E8.m1.8.8.8.4.1.1.1.2.2.1.1.1.3.cmml" xref="A1.E8.m1.8.8.8.4.1.1.1.2.2.1.1.1.3">𝑗</ci></apply></apply></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E8.m1.9c">\displaystyle\approx r_{y_{i}}\frac{1+\mathbb{E}_{j|y_{i}=y_{j}}\left[B_{i,j}%
\right]+\mathbb{E}_{j|y_{i}=y_{j}}\left[\left\langle\epsilon(p_{i}),\epsilon(p%
_{j})\right\rangle\right]}{1+\mathbb{E}_{j}\left[B_{i,j}\right]+\mathbb{E}_{j}%
\left[\left\langle\epsilon(p_{i}),\epsilon(p_{j})\right\rangle\right]},</annotation><annotation encoding="application/x-llamapun" id="A1.E8.m1.9d">≈ italic_r start_POSTSUBSCRIPT italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT divide start_ARG 1 + blackboard_E start_POSTSUBSCRIPT italic_j | italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_y start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ italic_B start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT ] + blackboard_E start_POSTSUBSCRIPT italic_j | italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_y start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ ⟨ italic_ϵ ( italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) , italic_ϵ ( italic_p start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ⟩ ] end_ARG start_ARG 1 + blackboard_E start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT [ italic_B start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT ] + blackboard_E start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT [ ⟨ italic_ϵ ( italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) , italic_ϵ ( italic_p start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ⟩ ] end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS2.SSS1.p3.14">where the <math alttext="r_{y_{i}}" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p3.13.m1.1"><semantics id="A1.SS2.SSS1.p3.13.m1.1a"><msub id="A1.SS2.SSS1.p3.13.m1.1.1" xref="A1.SS2.SSS1.p3.13.m1.1.1.cmml"><mi id="A1.SS2.SSS1.p3.13.m1.1.1.2" xref="A1.SS2.SSS1.p3.13.m1.1.1.2.cmml">r</mi><msub id="A1.SS2.SSS1.p3.13.m1.1.1.3" xref="A1.SS2.SSS1.p3.13.m1.1.1.3.cmml"><mi id="A1.SS2.SSS1.p3.13.m1.1.1.3.2" xref="A1.SS2.SSS1.p3.13.m1.1.1.3.2.cmml">y</mi><mi id="A1.SS2.SSS1.p3.13.m1.1.1.3.3" xref="A1.SS2.SSS1.p3.13.m1.1.1.3.3.cmml">i</mi></msub></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p3.13.m1.1b"><apply id="A1.SS2.SSS1.p3.13.m1.1.1.cmml" xref="A1.SS2.SSS1.p3.13.m1.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSS1.p3.13.m1.1.1.1.cmml" xref="A1.SS2.SSS1.p3.13.m1.1.1">subscript</csymbol><ci id="A1.SS2.SSS1.p3.13.m1.1.1.2.cmml" xref="A1.SS2.SSS1.p3.13.m1.1.1.2">𝑟</ci><apply id="A1.SS2.SSS1.p3.13.m1.1.1.3.cmml" xref="A1.SS2.SSS1.p3.13.m1.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.SSS1.p3.13.m1.1.1.3.1.cmml" xref="A1.SS2.SSS1.p3.13.m1.1.1.3">subscript</csymbol><ci id="A1.SS2.SSS1.p3.13.m1.1.1.3.2.cmml" xref="A1.SS2.SSS1.p3.13.m1.1.1.3.2">𝑦</ci><ci id="A1.SS2.SSS1.p3.13.m1.1.1.3.3.cmml" xref="A1.SS2.SSS1.p3.13.m1.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p3.13.m1.1c">r_{y_{i}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p3.13.m1.1d">italic_r start_POSTSUBSCRIPT italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> is the label ratio of <math alttext="y_{i}" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p3.14.m2.1"><semantics id="A1.SS2.SSS1.p3.14.m2.1a"><msub id="A1.SS2.SSS1.p3.14.m2.1.1" xref="A1.SS2.SSS1.p3.14.m2.1.1.cmml"><mi id="A1.SS2.SSS1.p3.14.m2.1.1.2" xref="A1.SS2.SSS1.p3.14.m2.1.1.2.cmml">y</mi><mi id="A1.SS2.SSS1.p3.14.m2.1.1.3" xref="A1.SS2.SSS1.p3.14.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p3.14.m2.1b"><apply id="A1.SS2.SSS1.p3.14.m2.1.1.cmml" xref="A1.SS2.SSS1.p3.14.m2.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSS1.p3.14.m2.1.1.1.cmml" xref="A1.SS2.SSS1.p3.14.m2.1.1">subscript</csymbol><ci id="A1.SS2.SSS1.p3.14.m2.1.1.2.cmml" xref="A1.SS2.SSS1.p3.14.m2.1.1.2">𝑦</ci><ci id="A1.SS2.SSS1.p3.14.m2.1.1.3.cmml" xref="A1.SS2.SSS1.p3.14.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p3.14.m2.1c">y_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p3.14.m2.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. Similarly, the probability on the label token can be written as:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A6.EGx3">
<tbody id="A1.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\mathrm{P}_{L}\left[y_{i}=y_{\mathrm{top}_{1}\left(\mathcal{S}_{%
\delta|i}\right)}\right]" class="ltx_Math" display="inline" id="A1.Ex1.m1.2"><semantics id="A1.Ex1.m1.2a"><mrow id="A1.Ex1.m1.2.2" xref="A1.Ex1.m1.2.2.cmml"><msub id="A1.Ex1.m1.2.2.3" xref="A1.Ex1.m1.2.2.3.cmml"><mi id="A1.Ex1.m1.2.2.3.2" mathvariant="normal" xref="A1.Ex1.m1.2.2.3.2.cmml">P</mi><mi id="A1.Ex1.m1.2.2.3.3" xref="A1.Ex1.m1.2.2.3.3.cmml">L</mi></msub><mo id="A1.Ex1.m1.2.2.2" xref="A1.Ex1.m1.2.2.2.cmml">⁢</mo><mrow id="A1.Ex1.m1.2.2.1.1" xref="A1.Ex1.m1.2.2.1.2.cmml"><mo id="A1.Ex1.m1.2.2.1.1.2" xref="A1.Ex1.m1.2.2.1.2.1.cmml">[</mo><mrow id="A1.Ex1.m1.2.2.1.1.1" xref="A1.Ex1.m1.2.2.1.1.1.cmml"><msub id="A1.Ex1.m1.2.2.1.1.1.2" xref="A1.Ex1.m1.2.2.1.1.1.2.cmml"><mi id="A1.Ex1.m1.2.2.1.1.1.2.2" xref="A1.Ex1.m1.2.2.1.1.1.2.2.cmml">y</mi><mi id="A1.Ex1.m1.2.2.1.1.1.2.3" xref="A1.Ex1.m1.2.2.1.1.1.2.3.cmml">i</mi></msub><mo id="A1.Ex1.m1.2.2.1.1.1.1" xref="A1.Ex1.m1.2.2.1.1.1.1.cmml">=</mo><msub id="A1.Ex1.m1.2.2.1.1.1.3" xref="A1.Ex1.m1.2.2.1.1.1.3.cmml"><mi id="A1.Ex1.m1.2.2.1.1.1.3.2" xref="A1.Ex1.m1.2.2.1.1.1.3.2.cmml">y</mi><mrow id="A1.Ex1.m1.1.1.1" xref="A1.Ex1.m1.1.1.1.cmml"><msub id="A1.Ex1.m1.1.1.1.3" xref="A1.Ex1.m1.1.1.1.3.cmml"><mi id="A1.Ex1.m1.1.1.1.3.2" xref="A1.Ex1.m1.1.1.1.3.2.cmml">top</mi><mn id="A1.Ex1.m1.1.1.1.3.3" xref="A1.Ex1.m1.1.1.1.3.3.cmml">1</mn></msub><mo id="A1.Ex1.m1.1.1.1.2" xref="A1.Ex1.m1.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex1.m1.1.1.1.1.1" xref="A1.Ex1.m1.1.1.1.1.1.1.cmml"><mo id="A1.Ex1.m1.1.1.1.1.1.2" xref="A1.Ex1.m1.1.1.1.1.1.1.cmml">(</mo><msub id="A1.Ex1.m1.1.1.1.1.1.1" xref="A1.Ex1.m1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.Ex1.m1.1.1.1.1.1.1.2" xref="A1.Ex1.m1.1.1.1.1.1.1.2.cmml">𝒮</mi><mrow id="A1.Ex1.m1.1.1.1.1.1.1.3" xref="A1.Ex1.m1.1.1.1.1.1.1.3.cmml"><mi id="A1.Ex1.m1.1.1.1.1.1.1.3.2" xref="A1.Ex1.m1.1.1.1.1.1.1.3.2.cmml">δ</mi><mo fence="false" id="A1.Ex1.m1.1.1.1.1.1.1.3.1" xref="A1.Ex1.m1.1.1.1.1.1.1.3.1.cmml">|</mo><mi id="A1.Ex1.m1.1.1.1.1.1.1.3.3" xref="A1.Ex1.m1.1.1.1.1.1.1.3.3.cmml">i</mi></mrow></msub><mo id="A1.Ex1.m1.1.1.1.1.1.3" xref="A1.Ex1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msub></mrow><mo id="A1.Ex1.m1.2.2.1.1.3" xref="A1.Ex1.m1.2.2.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex1.m1.2b"><apply id="A1.Ex1.m1.2.2.cmml" xref="A1.Ex1.m1.2.2"><times id="A1.Ex1.m1.2.2.2.cmml" xref="A1.Ex1.m1.2.2.2"></times><apply id="A1.Ex1.m1.2.2.3.cmml" xref="A1.Ex1.m1.2.2.3"><csymbol cd="ambiguous" id="A1.Ex1.m1.2.2.3.1.cmml" xref="A1.Ex1.m1.2.2.3">subscript</csymbol><ci id="A1.Ex1.m1.2.2.3.2.cmml" xref="A1.Ex1.m1.2.2.3.2">P</ci><ci id="A1.Ex1.m1.2.2.3.3.cmml" xref="A1.Ex1.m1.2.2.3.3">𝐿</ci></apply><apply id="A1.Ex1.m1.2.2.1.2.cmml" xref="A1.Ex1.m1.2.2.1.1"><csymbol cd="latexml" id="A1.Ex1.m1.2.2.1.2.1.cmml" xref="A1.Ex1.m1.2.2.1.1.2">delimited-[]</csymbol><apply id="A1.Ex1.m1.2.2.1.1.1.cmml" xref="A1.Ex1.m1.2.2.1.1.1"><eq id="A1.Ex1.m1.2.2.1.1.1.1.cmml" xref="A1.Ex1.m1.2.2.1.1.1.1"></eq><apply id="A1.Ex1.m1.2.2.1.1.1.2.cmml" xref="A1.Ex1.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex1.m1.2.2.1.1.1.2.1.cmml" xref="A1.Ex1.m1.2.2.1.1.1.2">subscript</csymbol><ci id="A1.Ex1.m1.2.2.1.1.1.2.2.cmml" xref="A1.Ex1.m1.2.2.1.1.1.2.2">𝑦</ci><ci id="A1.Ex1.m1.2.2.1.1.1.2.3.cmml" xref="A1.Ex1.m1.2.2.1.1.1.2.3">𝑖</ci></apply><apply id="A1.Ex1.m1.2.2.1.1.1.3.cmml" xref="A1.Ex1.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex1.m1.2.2.1.1.1.3.1.cmml" xref="A1.Ex1.m1.2.2.1.1.1.3">subscript</csymbol><ci id="A1.Ex1.m1.2.2.1.1.1.3.2.cmml" xref="A1.Ex1.m1.2.2.1.1.1.3.2">𝑦</ci><apply id="A1.Ex1.m1.1.1.1.cmml" xref="A1.Ex1.m1.1.1.1"><times id="A1.Ex1.m1.1.1.1.2.cmml" xref="A1.Ex1.m1.1.1.1.2"></times><apply id="A1.Ex1.m1.1.1.1.3.cmml" xref="A1.Ex1.m1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex1.m1.1.1.1.3.1.cmml" xref="A1.Ex1.m1.1.1.1.3">subscript</csymbol><ci id="A1.Ex1.m1.1.1.1.3.2.cmml" xref="A1.Ex1.m1.1.1.1.3.2">top</ci><cn id="A1.Ex1.m1.1.1.1.3.3.cmml" type="integer" xref="A1.Ex1.m1.1.1.1.3.3">1</cn></apply><apply id="A1.Ex1.m1.1.1.1.1.1.1.cmml" xref="A1.Ex1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex1.m1.1.1.1.1.1.1.1.cmml" xref="A1.Ex1.m1.1.1.1.1.1">subscript</csymbol><ci id="A1.Ex1.m1.1.1.1.1.1.1.2.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.2">𝒮</ci><apply id="A1.Ex1.m1.1.1.1.1.1.1.3.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.3"><csymbol cd="latexml" id="A1.Ex1.m1.1.1.1.1.1.1.3.1.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.3.1">conditional</csymbol><ci id="A1.Ex1.m1.1.1.1.1.1.1.3.2.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.3.2">𝛿</ci><ci id="A1.Ex1.m1.1.1.1.1.1.1.3.3.cmml" xref="A1.Ex1.m1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex1.m1.2c">\displaystyle\mathrm{P}_{L}\left[y_{i}=y_{\mathrm{top}_{1}\left(\mathcal{S}_{%
\delta|i}\right)}\right]</annotation><annotation encoding="application/x-llamapun" id="A1.Ex1.m1.2d">roman_P start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT [ italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_y start_POSTSUBSCRIPT roman_top start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( caligraphic_S start_POSTSUBSCRIPT italic_δ | italic_i end_POSTSUBSCRIPT ) end_POSTSUBSCRIPT ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.E11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\approx\frac{r_{y_{i}}(1+\mathbb{E}_{j|y_{i}=y_{j}}\left[B_{i,j}%
\right]+\mathbb{E}_{j|y_{i}=y_{j}}\left[\left\langle\epsilon(p_{i}),\epsilon(p%
_{j})\right\rangle\right])}{\begin{multlined}r_{y_{i}}\left(1+\mathbb{E}_{j|y_%
{i}=y_{j}}\left[B_{i,j}\right]+\mathbb{E}_{j|y_{i}=y_{j}}\left[\left\langle%
\epsilon(p_{i}),\epsilon(p_{j})\right\rangle\right]\right)\\
+\left(1-r_{y_{i}}\right)\left(\left\langle e(y_{i}),e(y_{j})\right\rangle+%
\mathbb{E}_{j}\left[B_{i,j}\right]+\mathbb{E}_{j}\left[\left\langle\epsilon(p_%
{i}),\epsilon(p_{j})\right\rangle\right]\right)\end{multlined}r_{y_{i}}\left(1%
+\mathbb{E}_{j|y_{i}=y_{j}}\left[B_{i,j}\right]+\mathbb{E}_{j|y_{i}=y_{j}}%
\left[\left\langle\epsilon(p_{i}),\epsilon(p_{j})\right\rangle\right]\right)\\
+\left(1-r_{y_{i}}\right)\left(\left\langle e(y_{i}),e(y_{j})\right\rangle+%
\mathbb{E}_{j}\left[B_{i,j}\right]+\mathbb{E}_{j}\left[\left\langle\epsilon(p_%
{i}),\epsilon(p_{j})\right\rangle\right]\right)}" class="ltx_Math" display="inline" id="A1.E11.m1.6"><semantics id="A1.E11.m1.6a"><mrow id="A1.E11.m1.6.7" xref="A1.E11.m1.6.7.cmml"><mi id="A1.E11.m1.6.7.2" xref="A1.E11.m1.6.7.2.cmml"></mi><mo id="A1.E11.m1.6.7.1" xref="A1.E11.m1.6.7.1.cmml">≈</mo><mstyle displaystyle="true" id="A1.E11.m1.6.6" xref="A1.E11.m1.6.6.cmml"><mfrac id="A1.E11.m1.6.6a" xref="A1.E11.m1.6.6.cmml"><mrow id="A1.E11.m1.3.3.3" xref="A1.E11.m1.3.3.3.cmml"><msub id="A1.E11.m1.3.3.3.5" xref="A1.E11.m1.3.3.3.5.cmml"><mi id="A1.E11.m1.3.3.3.5.2" xref="A1.E11.m1.3.3.3.5.2.cmml">r</mi><msub id="A1.E11.m1.3.3.3.5.3" xref="A1.E11.m1.3.3.3.5.3.cmml"><mi id="A1.E11.m1.3.3.3.5.3.2" xref="A1.E11.m1.3.3.3.5.3.2.cmml">y</mi><mi id="A1.E11.m1.3.3.3.5.3.3" xref="A1.E11.m1.3.3.3.5.3.3.cmml">i</mi></msub></msub><mo id="A1.E11.m1.3.3.3.4" xref="A1.E11.m1.3.3.3.4.cmml">⁢</mo><mrow id="A1.E11.m1.3.3.3.3.1" xref="A1.E11.m1.3.3.3.3.1.1.cmml"><mo id="A1.E11.m1.3.3.3.3.1.2" stretchy="false" xref="A1.E11.m1.3.3.3.3.1.1.cmml">(</mo><mrow id="A1.E11.m1.3.3.3.3.1.1" xref="A1.E11.m1.3.3.3.3.1.1.cmml"><mn id="A1.E11.m1.3.3.3.3.1.1.4" xref="A1.E11.m1.3.3.3.3.1.1.4.cmml">1</mn><mo id="A1.E11.m1.3.3.3.3.1.1.3" xref="A1.E11.m1.3.3.3.3.1.1.3.cmml">+</mo><mrow id="A1.E11.m1.3.3.3.3.1.1.1" xref="A1.E11.m1.3.3.3.3.1.1.1.cmml"><msub id="A1.E11.m1.3.3.3.3.1.1.1.3" xref="A1.E11.m1.3.3.3.3.1.1.1.3.cmml"><mi id="A1.E11.m1.3.3.3.3.1.1.1.3.2" xref="A1.E11.m1.3.3.3.3.1.1.1.3.2.cmml">𝔼</mi><mrow id="A1.E11.m1.3.3.3.3.1.1.1.3.3" xref="A1.E11.m1.3.3.3.3.1.1.1.3.3.cmml"><mrow id="A1.E11.m1.3.3.3.3.1.1.1.3.3.2" xref="A1.E11.m1.3.3.3.3.1.1.1.3.3.2.cmml"><mi id="A1.E11.m1.3.3.3.3.1.1.1.3.3.2.2" xref="A1.E11.m1.3.3.3.3.1.1.1.3.3.2.2.cmml">j</mi><mo fence="false" id="A1.E11.m1.3.3.3.3.1.1.1.3.3.2.1" xref="A1.E11.m1.3.3.3.3.1.1.1.3.3.2.1.cmml">|</mo><msub id="A1.E11.m1.3.3.3.3.1.1.1.3.3.2.3" xref="A1.E11.m1.3.3.3.3.1.1.1.3.3.2.3.cmml"><mi id="A1.E11.m1.3.3.3.3.1.1.1.3.3.2.3.2" xref="A1.E11.m1.3.3.3.3.1.1.1.3.3.2.3.2.cmml">y</mi><mi id="A1.E11.m1.3.3.3.3.1.1.1.3.3.2.3.3" xref="A1.E11.m1.3.3.3.3.1.1.1.3.3.2.3.3.cmml">i</mi></msub></mrow><mo id="A1.E11.m1.3.3.3.3.1.1.1.3.3.1" xref="A1.E11.m1.3.3.3.3.1.1.1.3.3.1.cmml">=</mo><msub id="A1.E11.m1.3.3.3.3.1.1.1.3.3.3" xref="A1.E11.m1.3.3.3.3.1.1.1.3.3.3.cmml"><mi id="A1.E11.m1.3.3.3.3.1.1.1.3.3.3.2" xref="A1.E11.m1.3.3.3.3.1.1.1.3.3.3.2.cmml">y</mi><mi id="A1.E11.m1.3.3.3.3.1.1.1.3.3.3.3" xref="A1.E11.m1.3.3.3.3.1.1.1.3.3.3.3.cmml">j</mi></msub></mrow></msub><mo id="A1.E11.m1.3.3.3.3.1.1.1.2" xref="A1.E11.m1.3.3.3.3.1.1.1.2.cmml">⁢</mo><mrow id="A1.E11.m1.3.3.3.3.1.1.1.1.1" xref="A1.E11.m1.3.3.3.3.1.1.1.1.2.cmml"><mo id="A1.E11.m1.3.3.3.3.1.1.1.1.1.2" xref="A1.E11.m1.3.3.3.3.1.1.1.1.2.1.cmml">[</mo><msub id="A1.E11.m1.3.3.3.3.1.1.1.1.1.1" xref="A1.E11.m1.3.3.3.3.1.1.1.1.1.1.cmml"><mi id="A1.E11.m1.3.3.3.3.1.1.1.1.1.1.2" xref="A1.E11.m1.3.3.3.3.1.1.1.1.1.1.2.cmml">B</mi><mrow id="A1.E11.m1.2.2.2.2.2.4" xref="A1.E11.m1.2.2.2.2.2.3.cmml"><mi id="A1.E11.m1.1.1.1.1.1.1" xref="A1.E11.m1.1.1.1.1.1.1.cmml">i</mi><mo id="A1.E11.m1.2.2.2.2.2.4.1" xref="A1.E11.m1.2.2.2.2.2.3.cmml">,</mo><mi id="A1.E11.m1.2.2.2.2.2.2" xref="A1.E11.m1.2.2.2.2.2.2.cmml">j</mi></mrow></msub><mo id="A1.E11.m1.3.3.3.3.1.1.1.1.1.3" xref="A1.E11.m1.3.3.3.3.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="A1.E11.m1.3.3.3.3.1.1.3a" xref="A1.E11.m1.3.3.3.3.1.1.3.cmml">+</mo><mrow id="A1.E11.m1.3.3.3.3.1.1.2" xref="A1.E11.m1.3.3.3.3.1.1.2.cmml"><msub id="A1.E11.m1.3.3.3.3.1.1.2.3" xref="A1.E11.m1.3.3.3.3.1.1.2.3.cmml"><mi id="A1.E11.m1.3.3.3.3.1.1.2.3.2" xref="A1.E11.m1.3.3.3.3.1.1.2.3.2.cmml">𝔼</mi><mrow id="A1.E11.m1.3.3.3.3.1.1.2.3.3" xref="A1.E11.m1.3.3.3.3.1.1.2.3.3.cmml"><mrow id="A1.E11.m1.3.3.3.3.1.1.2.3.3.2" xref="A1.E11.m1.3.3.3.3.1.1.2.3.3.2.cmml"><mi id="A1.E11.m1.3.3.3.3.1.1.2.3.3.2.2" xref="A1.E11.m1.3.3.3.3.1.1.2.3.3.2.2.cmml">j</mi><mo fence="false" id="A1.E11.m1.3.3.3.3.1.1.2.3.3.2.1" xref="A1.E11.m1.3.3.3.3.1.1.2.3.3.2.1.cmml">|</mo><msub id="A1.E11.m1.3.3.3.3.1.1.2.3.3.2.3" xref="A1.E11.m1.3.3.3.3.1.1.2.3.3.2.3.cmml"><mi id="A1.E11.m1.3.3.3.3.1.1.2.3.3.2.3.2" xref="A1.E11.m1.3.3.3.3.1.1.2.3.3.2.3.2.cmml">y</mi><mi id="A1.E11.m1.3.3.3.3.1.1.2.3.3.2.3.3" xref="A1.E11.m1.3.3.3.3.1.1.2.3.3.2.3.3.cmml">i</mi></msub></mrow><mo id="A1.E11.m1.3.3.3.3.1.1.2.3.3.1" xref="A1.E11.m1.3.3.3.3.1.1.2.3.3.1.cmml">=</mo><msub id="A1.E11.m1.3.3.3.3.1.1.2.3.3.3" xref="A1.E11.m1.3.3.3.3.1.1.2.3.3.3.cmml"><mi id="A1.E11.m1.3.3.3.3.1.1.2.3.3.3.2" xref="A1.E11.m1.3.3.3.3.1.1.2.3.3.3.2.cmml">y</mi><mi id="A1.E11.m1.3.3.3.3.1.1.2.3.3.3.3" xref="A1.E11.m1.3.3.3.3.1.1.2.3.3.3.3.cmml">j</mi></msub></mrow></msub><mo id="A1.E11.m1.3.3.3.3.1.1.2.2" xref="A1.E11.m1.3.3.3.3.1.1.2.2.cmml">⁢</mo><mrow id="A1.E11.m1.3.3.3.3.1.1.2.1.1" xref="A1.E11.m1.3.3.3.3.1.1.2.1.2.cmml"><mo id="A1.E11.m1.3.3.3.3.1.1.2.1.1.2" xref="A1.E11.m1.3.3.3.3.1.1.2.1.2.1.cmml">[</mo><mrow id="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.2" xref="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.3.cmml"><mo id="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.2.3" xref="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.3.cmml">⟨</mo><mrow id="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.1.1" xref="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.1.1.cmml"><mi id="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.1.1.3" xref="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.1.1.3.cmml">ϵ</mi><mo id="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.1.1.2" xref="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.1.1.1.1" xref="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.1.1.1.1.1" xref="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.1.1.1.1.1.2" xref="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.1.1.1.1.1.2.cmml">p</mi><mi id="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.1.1.1.1.1.3" xref="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.2.4" xref="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.3.cmml">,</mo><mrow id="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.2.2" xref="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.2.2.cmml"><mi id="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.2.2.3" xref="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.2.2.3.cmml">ϵ</mi><mo id="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.2.2.2" xref="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.2.2.2.cmml">⁢</mo><mrow id="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.2.2.1.1" xref="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.2.2.1.1.1.cmml"><mo id="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.2.2.1.1.2" stretchy="false" xref="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.2.2.1.1.1.cmml">(</mo><msub id="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.2.2.1.1.1" xref="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.2.2.1.1.1.cmml"><mi id="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.2.2.1.1.1.2" xref="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.2.2.1.1.1.2.cmml">p</mi><mi id="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.2.2.1.1.1.3" xref="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.2.2.1.1.1.3.cmml">j</mi></msub><mo id="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.2.2.1.1.3" stretchy="false" xref="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.2.5" xref="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.3.cmml">⟩</mo></mrow><mo id="A1.E11.m1.3.3.3.3.1.1.2.1.1.3" xref="A1.E11.m1.3.3.3.3.1.1.2.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="A1.E11.m1.3.3.3.3.1.3" stretchy="false" xref="A1.E11.m1.3.3.3.3.1.1.cmml">)</mo></mrow></mrow><mtable id="A1.E11.m1.6.6.6.4" rowspacing="0pt" xref="A1.E11.m1.6.6.6.3.3.cmml"><mtr id="A1.E11.m1.6.6.6.4a" xref="A1.E11.m1.6.6.6.3.3.cmml"><mtd class="ltx_align_left" columnalign="left" id="A1.E11.m1.6.6.6.4b" xref="A1.E11.m1.6.6.6.3.3.cmml"><mrow id="A1.E9.31.31" xref="A1.E11.m1.6.6.6.3.3.cmml"><msub id="A1.E9.31.31.33" xref="A1.E11.m1.6.6.6.3.3.cmml"><mi id="A1.E9.1.1.1" xref="A1.E9.1.1.1.cmml">r</mi><msub id="A1.E9.2.2.2.1" xref="A1.E9.2.2.2.1.cmml"><mi id="A1.E9.2.2.2.1.2" xref="A1.E9.2.2.2.1.2.cmml">y</mi><mi id="A1.E9.2.2.2.1.3" xref="A1.E9.2.2.2.1.3.cmml">i</mi></msub></msub><mo id="A1.E9.31.31.32" xref="A1.E11.m1.6.6.6.3.3.cmml">⁢</mo><mrow id="A1.E9.31.31.31.1" xref="A1.E11.m1.6.6.6.3.3.cmml"><mo id="A1.E9.3.3.3" xref="A1.E11.m1.6.6.6.3.3.cmml">(</mo><mrow id="A1.E9.31.31.31.1.1" xref="A1.E11.m1.6.6.6.3.3.cmml"><mn id="A1.E9.4.4.4" xref="A1.E9.4.4.4.cmml">1</mn><mo id="A1.E9.5.5.5" xref="A1.E9.5.5.5.cmml">+</mo><mrow id="A1.E9.31.31.31.1.1.1" xref="A1.E11.m1.6.6.6.3.3.cmml"><msub id="A1.E9.31.31.31.1.1.1.3" xref="A1.E11.m1.6.6.6.3.3.cmml"><mi id="A1.E9.6.6.6" xref="A1.E9.6.6.6.cmml">𝔼</mi><mrow id="A1.E9.7.7.7.1" xref="A1.E9.7.7.7.1.cmml"><mrow id="A1.E9.7.7.7.1.2" xref="A1.E9.7.7.7.1.2.cmml"><mi id="A1.E9.7.7.7.1.2.2" xref="A1.E9.7.7.7.1.2.2.cmml">j</mi><mo fence="false" id="A1.E9.7.7.7.1.2.1" xref="A1.E9.7.7.7.1.2.1.cmml">|</mo><msub id="A1.E9.7.7.7.1.2.3" xref="A1.E9.7.7.7.1.2.3.cmml"><mi id="A1.E9.7.7.7.1.2.3.2" xref="A1.E9.7.7.7.1.2.3.2.cmml">y</mi><mi id="A1.E9.7.7.7.1.2.3.3" xref="A1.E9.7.7.7.1.2.3.3.cmml">i</mi></msub></mrow><mo id="A1.E9.7.7.7.1.1" xref="A1.E9.7.7.7.1.1.cmml">=</mo><msub id="A1.E9.7.7.7.1.3" xref="A1.E9.7.7.7.1.3.cmml"><mi id="A1.E9.7.7.7.1.3.2" xref="A1.E9.7.7.7.1.3.2.cmml">y</mi><mi id="A1.E9.7.7.7.1.3.3" xref="A1.E9.7.7.7.1.3.3.cmml">j</mi></msub></mrow></msub><mo id="A1.E9.31.31.31.1.1.1.2" xref="A1.E11.m1.6.6.6.3.3.cmml">⁢</mo><mrow id="A1.E9.31.31.31.1.1.1.1.1" xref="A1.E11.m1.6.6.6.3.3.cmml"><mo id="A1.E9.8.8.8" xref="A1.E11.m1.6.6.6.3.3.cmml">[</mo><msub id="A1.E9.31.31.31.1.1.1.1.1.1" xref="A1.E11.m1.6.6.6.3.3.cmml"><mi id="A1.E9.9.9.9" xref="A1.E9.9.9.9.cmml">B</mi><mrow id="A1.E9.10.10.10.1.4" xref="A1.E9.10.10.10.1.3.cmml"><mi id="A1.E9.10.10.10.1.1" xref="A1.E9.10.10.10.1.1.cmml">i</mi><mo id="A1.E9.10.10.10.1.4.1" xref="A1.E9.10.10.10.1.3.cmml">,</mo><mi id="A1.E9.10.10.10.1.2" xref="A1.E9.10.10.10.1.2.cmml">j</mi></mrow></msub><mo id="A1.E9.11.11.11" xref="A1.E11.m1.6.6.6.3.3.cmml">]</mo></mrow></mrow><mo id="A1.E9.5.5.5a" xref="A1.E9.5.5.5.cmml">+</mo><mrow id="A1.E9.31.31.31.1.1.2" xref="A1.E11.m1.6.6.6.3.3.cmml"><msub id="A1.E9.31.31.31.1.1.2.3" xref="A1.E11.m1.6.6.6.3.3.cmml"><mi id="A1.E9.13.13.13" xref="A1.E9.13.13.13.cmml">𝔼</mi><mrow id="A1.E9.14.14.14.1" xref="A1.E9.14.14.14.1.cmml"><mrow id="A1.E9.14.14.14.1.2" xref="A1.E9.14.14.14.1.2.cmml"><mi id="A1.E9.14.14.14.1.2.2" xref="A1.E9.14.14.14.1.2.2.cmml">j</mi><mo fence="false" id="A1.E9.14.14.14.1.2.1" xref="A1.E9.14.14.14.1.2.1.cmml">|</mo><msub id="A1.E9.14.14.14.1.2.3" xref="A1.E9.14.14.14.1.2.3.cmml"><mi id="A1.E9.14.14.14.1.2.3.2" xref="A1.E9.14.14.14.1.2.3.2.cmml">y</mi><mi id="A1.E9.14.14.14.1.2.3.3" xref="A1.E9.14.14.14.1.2.3.3.cmml">i</mi></msub></mrow><mo id="A1.E9.14.14.14.1.1" xref="A1.E9.14.14.14.1.1.cmml">=</mo><msub id="A1.E9.14.14.14.1.3" xref="A1.E9.14.14.14.1.3.cmml"><mi id="A1.E9.14.14.14.1.3.2" xref="A1.E9.14.14.14.1.3.2.cmml">y</mi><mi id="A1.E9.14.14.14.1.3.3" xref="A1.E9.14.14.14.1.3.3.cmml">j</mi></msub></mrow></msub><mo id="A1.E9.31.31.31.1.1.2.2" xref="A1.E11.m1.6.6.6.3.3.cmml">⁢</mo><mrow id="A1.E9.31.31.31.1.1.2.1.1" xref="A1.E11.m1.6.6.6.3.3.cmml"><mo id="A1.E9.15.15.15" xref="A1.E11.m1.6.6.6.3.3.cmml">[</mo><mrow id="A1.E9.31.31.31.1.1.2.1.1.1" xref="A1.E11.m1.6.6.6.3.3.cmml"><mo id="A1.E9.16.16.16" xref="A1.E11.m1.6.6.6.3.3.cmml">⟨</mo><mrow id="A1.E9.31.31.31.1.1.2.1.1.1.1.1" xref="A1.E11.m1.6.6.6.3.3.cmml"><mi id="A1.E9.17.17.17" xref="A1.E9.17.17.17.cmml">ϵ</mi><mo id="A1.E9.31.31.31.1.1.2.1.1.1.1.1.2" xref="A1.E11.m1.6.6.6.3.3.cmml">⁢</mo><mrow id="A1.E9.31.31.31.1.1.2.1.1.1.1.1.1.1" xref="A1.E11.m1.6.6.6.3.3.cmml"><mo id="A1.E9.18.18.18" stretchy="false" xref="A1.E11.m1.6.6.6.3.3.cmml">(</mo><msub id="A1.E9.31.31.31.1.1.2.1.1.1.1.1.1.1.1" xref="A1.E11.m1.6.6.6.3.3.cmml"><mi id="A1.E9.19.19.19" xref="A1.E9.19.19.19.cmml">p</mi><mi id="A1.E9.20.20.20.1" xref="A1.E9.20.20.20.1.cmml">i</mi></msub><mo id="A1.E9.21.21.21" stretchy="false" xref="A1.E11.m1.6.6.6.3.3.cmml">)</mo></mrow></mrow><mo id="A1.E9.22.22.22" xref="A1.E11.m1.6.6.6.3.3.cmml">,</mo><mrow id="A1.E9.31.31.31.1.1.2.1.1.1.2.2" xref="A1.E11.m1.6.6.6.3.3.cmml"><mi id="A1.E9.23.23.23" xref="A1.E9.23.23.23.cmml">ϵ</mi><mo id="A1.E9.31.31.31.1.1.2.1.1.1.2.2.2" xref="A1.E11.m1.6.6.6.3.3.cmml">⁢</mo><mrow id="A1.E9.31.31.31.1.1.2.1.1.1.2.2.1.1" xref="A1.E11.m1.6.6.6.3.3.cmml"><mo id="A1.E9.24.24.24" stretchy="false" xref="A1.E11.m1.6.6.6.3.3.cmml">(</mo><msub id="A1.E9.31.31.31.1.1.2.1.1.1.2.2.1.1.1" xref="A1.E11.m1.6.6.6.3.3.cmml"><mi id="A1.E9.25.25.25" xref="A1.E9.25.25.25.cmml">p</mi><mi id="A1.E9.26.26.26.1" xref="A1.E9.26.26.26.1.cmml">j</mi></msub><mo id="A1.E9.27.27.27" stretchy="false" xref="A1.E11.m1.6.6.6.3.3.cmml">)</mo></mrow></mrow><mo id="A1.E9.28.28.28" xref="A1.E11.m1.6.6.6.3.3.cmml">⟩</mo></mrow><mo id="A1.E9.29.29.29" xref="A1.E11.m1.6.6.6.3.3.cmml">]</mo></mrow></mrow></mrow><mo id="A1.E9.30.30.30" xref="A1.E11.m1.6.6.6.3.3.cmml">)</mo></mrow></mrow></mtd></mtr><mtr id="A1.E11.m1.6.6.6.4c" xref="A1.E11.m1.6.6.6.3.3.cmml"><mtd class="ltx_align_right" columnalign="right" id="A1.E11.m1.6.6.6.4d" xref="A1.E11.m1.6.6.6.3.3.cmml"><mrow id="A1.E10.49.49" xref="A1.E11.m1.6.6.6.3.3.cmml"><mo id="A1.E10.49.49a" xref="A1.E11.m1.6.6.6.3.3.cmml">+</mo><mrow id="A1.E10.49.49.49" xref="A1.E11.m1.6.6.6.3.3.cmml"><mrow id="A1.E10.48.48.48.1.1" xref="A1.E11.m1.6.6.6.3.3.cmml"><mo id="A1.E10.2.2.2" xref="A1.E11.m1.6.6.6.3.3.cmml">(</mo><mrow id="A1.E10.48.48.48.1.1.1" xref="A1.E11.m1.6.6.6.3.3.cmml"><mn id="A1.E10.3.3.3" xref="A1.E10.3.3.3.cmml">1</mn><mo id="A1.E10.4.4.4" xref="A1.E10.4.4.4.cmml">−</mo><msub id="A1.E10.48.48.48.1.1.1.1" xref="A1.E11.m1.6.6.6.3.3.cmml"><mi id="A1.E10.5.5.5" xref="A1.E10.5.5.5.cmml">r</mi><msub id="A1.E10.6.6.6.1" xref="A1.E10.6.6.6.1.cmml"><mi id="A1.E10.6.6.6.1.2" xref="A1.E10.6.6.6.1.2.cmml">y</mi><mi id="A1.E10.6.6.6.1.3" xref="A1.E10.6.6.6.1.3.cmml">i</mi></msub></msub></mrow><mo id="A1.E10.7.7.7" xref="A1.E11.m1.6.6.6.3.3.cmml">)</mo></mrow><mo id="A1.E10.49.49.49.3" xref="A1.E11.m1.6.6.6.3.3.cmml">⁢</mo><mrow id="A1.E10.49.49.49.2.1" xref="A1.E11.m1.6.6.6.3.3.cmml"><mo id="A1.E10.8.8.8" xref="A1.E11.m1.6.6.6.3.3.cmml">(</mo><mrow id="A1.E10.49.49.49.2.1.1" xref="A1.E11.m1.6.6.6.3.3.cmml"><mrow id="A1.E10.49.49.49.2.1.1.2.2" xref="A1.E11.m1.6.6.6.3.3.cmml"><mo id="A1.E10.9.9.9" xref="A1.E11.m1.6.6.6.3.3.cmml">⟨</mo><mrow id="A1.E10.49.49.49.2.1.1.1.1.1" xref="A1.E11.m1.6.6.6.3.3.cmml"><mi id="A1.E10.10.10.10" xref="A1.E10.10.10.10.cmml">e</mi><mo id="A1.E10.49.49.49.2.1.1.1.1.1.2" xref="A1.E11.m1.6.6.6.3.3.cmml">⁢</mo><mrow id="A1.E10.49.49.49.2.1.1.1.1.1.1.1" xref="A1.E11.m1.6.6.6.3.3.cmml"><mo id="A1.E10.11.11.11" stretchy="false" xref="A1.E11.m1.6.6.6.3.3.cmml">(</mo><msub id="A1.E10.49.49.49.2.1.1.1.1.1.1.1.1" xref="A1.E11.m1.6.6.6.3.3.cmml"><mi id="A1.E10.12.12.12" xref="A1.E10.12.12.12.cmml">y</mi><mi id="A1.E10.13.13.13.1" xref="A1.E10.13.13.13.1.cmml">i</mi></msub><mo id="A1.E10.14.14.14" stretchy="false" xref="A1.E11.m1.6.6.6.3.3.cmml">)</mo></mrow></mrow><mo id="A1.E10.15.15.15" xref="A1.E11.m1.6.6.6.3.3.cmml">,</mo><mrow id="A1.E10.49.49.49.2.1.1.2.2.2" xref="A1.E11.m1.6.6.6.3.3.cmml"><mi id="A1.E10.16.16.16" xref="A1.E10.16.16.16.cmml">e</mi><mo id="A1.E10.49.49.49.2.1.1.2.2.2.2" xref="A1.E11.m1.6.6.6.3.3.cmml">⁢</mo><mrow id="A1.E10.49.49.49.2.1.1.2.2.2.1.1" xref="A1.E11.m1.6.6.6.3.3.cmml"><mo id="A1.E10.17.17.17" stretchy="false" xref="A1.E11.m1.6.6.6.3.3.cmml">(</mo><msub id="A1.E10.49.49.49.2.1.1.2.2.2.1.1.1" xref="A1.E11.m1.6.6.6.3.3.cmml"><mi id="A1.E10.18.18.18" xref="A1.E10.18.18.18.cmml">y</mi><mi id="A1.E10.19.19.19.1" xref="A1.E10.19.19.19.1.cmml">j</mi></msub><mo id="A1.E10.20.20.20" stretchy="false" xref="A1.E11.m1.6.6.6.3.3.cmml">)</mo></mrow></mrow><mo id="A1.E10.21.21.21" xref="A1.E11.m1.6.6.6.3.3.cmml">⟩</mo></mrow><mo id="A1.E10.22.22.22" xref="A1.E10.22.22.22.cmml">+</mo><mrow id="A1.E10.49.49.49.2.1.1.3" xref="A1.E11.m1.6.6.6.3.3.cmml"><msub id="A1.E10.49.49.49.2.1.1.3.3" xref="A1.E11.m1.6.6.6.3.3.cmml"><mi id="A1.E10.23.23.23" xref="A1.E10.23.23.23.cmml">𝔼</mi><mi id="A1.E10.24.24.24.1" xref="A1.E10.24.24.24.1.cmml">j</mi></msub><mo id="A1.E10.49.49.49.2.1.1.3.2" xref="A1.E11.m1.6.6.6.3.3.cmml">⁢</mo><mrow id="A1.E10.49.49.49.2.1.1.3.1.1" xref="A1.E11.m1.6.6.6.3.3.cmml"><mo id="A1.E10.25.25.25" xref="A1.E11.m1.6.6.6.3.3.cmml">[</mo><msub id="A1.E10.49.49.49.2.1.1.3.1.1.1" xref="A1.E11.m1.6.6.6.3.3.cmml"><mi id="A1.E10.26.26.26" xref="A1.E10.26.26.26.cmml">B</mi><mrow id="A1.E10.27.27.27.1.4" xref="A1.E10.27.27.27.1.3.cmml"><mi id="A1.E10.27.27.27.1.1" xref="A1.E10.27.27.27.1.1.cmml">i</mi><mo id="A1.E10.27.27.27.1.4.1" xref="A1.E10.27.27.27.1.3.cmml">,</mo><mi id="A1.E10.27.27.27.1.2" xref="A1.E10.27.27.27.1.2.cmml">j</mi></mrow></msub><mo id="A1.E10.28.28.28" xref="A1.E11.m1.6.6.6.3.3.cmml">]</mo></mrow></mrow><mo id="A1.E10.22.22.22a" xref="A1.E10.22.22.22.cmml">+</mo><mrow id="A1.E10.49.49.49.2.1.1.4" xref="A1.E11.m1.6.6.6.3.3.cmml"><msub id="A1.E10.49.49.49.2.1.1.4.3" xref="A1.E11.m1.6.6.6.3.3.cmml"><mi id="A1.E10.30.30.30" xref="A1.E10.30.30.30.cmml">𝔼</mi><mi id="A1.E10.31.31.31.1" xref="A1.E10.31.31.31.1.cmml">j</mi></msub><mo id="A1.E10.49.49.49.2.1.1.4.2" xref="A1.E11.m1.6.6.6.3.3.cmml">⁢</mo><mrow id="A1.E10.49.49.49.2.1.1.4.1.1" xref="A1.E11.m1.6.6.6.3.3.cmml"><mo id="A1.E10.32.32.32" xref="A1.E11.m1.6.6.6.3.3.cmml">[</mo><mrow id="A1.E10.49.49.49.2.1.1.4.1.1.1" xref="A1.E11.m1.6.6.6.3.3.cmml"><mo id="A1.E10.33.33.33" xref="A1.E11.m1.6.6.6.3.3.cmml">⟨</mo><mrow id="A1.E10.49.49.49.2.1.1.4.1.1.1.1.1" xref="A1.E11.m1.6.6.6.3.3.cmml"><mi id="A1.E10.34.34.34" xref="A1.E10.34.34.34.cmml">ϵ</mi><mo id="A1.E10.49.49.49.2.1.1.4.1.1.1.1.1.2" xref="A1.E11.m1.6.6.6.3.3.cmml">⁢</mo><mrow id="A1.E10.49.49.49.2.1.1.4.1.1.1.1.1.1.1" xref="A1.E11.m1.6.6.6.3.3.cmml"><mo id="A1.E10.35.35.35" stretchy="false" xref="A1.E11.m1.6.6.6.3.3.cmml">(</mo><msub id="A1.E10.49.49.49.2.1.1.4.1.1.1.1.1.1.1.1" xref="A1.E11.m1.6.6.6.3.3.cmml"><mi id="A1.E10.36.36.36" xref="A1.E10.36.36.36.cmml">p</mi><mi id="A1.E10.37.37.37.1" xref="A1.E10.37.37.37.1.cmml">i</mi></msub><mo id="A1.E10.38.38.38" stretchy="false" xref="A1.E11.m1.6.6.6.3.3.cmml">)</mo></mrow></mrow><mo id="A1.E10.39.39.39" xref="A1.E11.m1.6.6.6.3.3.cmml">,</mo><mrow id="A1.E10.49.49.49.2.1.1.4.1.1.1.2.2" xref="A1.E11.m1.6.6.6.3.3.cmml"><mi id="A1.E10.40.40.40" xref="A1.E10.40.40.40.cmml">ϵ</mi><mo id="A1.E10.49.49.49.2.1.1.4.1.1.1.2.2.2" xref="A1.E11.m1.6.6.6.3.3.cmml">⁢</mo><mrow id="A1.E10.49.49.49.2.1.1.4.1.1.1.2.2.1.1" xref="A1.E11.m1.6.6.6.3.3.cmml"><mo id="A1.E10.41.41.41" stretchy="false" xref="A1.E11.m1.6.6.6.3.3.cmml">(</mo><msub id="A1.E10.49.49.49.2.1.1.4.1.1.1.2.2.1.1.1" xref="A1.E11.m1.6.6.6.3.3.cmml"><mi id="A1.E10.42.42.42" xref="A1.E10.42.42.42.cmml">p</mi><mi id="A1.E10.43.43.43.1" xref="A1.E10.43.43.43.1.cmml">j</mi></msub><mo id="A1.E10.44.44.44" stretchy="false" xref="A1.E11.m1.6.6.6.3.3.cmml">)</mo></mrow></mrow><mo id="A1.E10.45.45.45" xref="A1.E11.m1.6.6.6.3.3.cmml">⟩</mo></mrow><mo id="A1.E10.46.46.46" xref="A1.E11.m1.6.6.6.3.3.cmml">]</mo></mrow></mrow></mrow><mo id="A1.E10.47.47.47" xref="A1.E11.m1.6.6.6.3.3.cmml">)</mo></mrow></mrow></mrow></mtd></mtr></mtable></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="A1.E11.m1.6b"><apply id="A1.E11.m1.6.7.cmml" xref="A1.E11.m1.6.7"><approx id="A1.E11.m1.6.7.1.cmml" xref="A1.E11.m1.6.7.1"></approx><csymbol cd="latexml" id="A1.E11.m1.6.7.2.cmml" xref="A1.E11.m1.6.7.2">absent</csymbol><apply id="A1.E11.m1.6.6.cmml" xref="A1.E11.m1.6.6"><divide id="A1.E11.m1.6.6.7.cmml" xref="A1.E11.m1.6.6"></divide><apply id="A1.E11.m1.3.3.3.cmml" xref="A1.E11.m1.3.3.3"><times id="A1.E11.m1.3.3.3.4.cmml" xref="A1.E11.m1.3.3.3.4"></times><apply id="A1.E11.m1.3.3.3.5.cmml" xref="A1.E11.m1.3.3.3.5"><csymbol cd="ambiguous" id="A1.E11.m1.3.3.3.5.1.cmml" xref="A1.E11.m1.3.3.3.5">subscript</csymbol><ci id="A1.E11.m1.3.3.3.5.2.cmml" xref="A1.E11.m1.3.3.3.5.2">𝑟</ci><apply id="A1.E11.m1.3.3.3.5.3.cmml" xref="A1.E11.m1.3.3.3.5.3"><csymbol cd="ambiguous" id="A1.E11.m1.3.3.3.5.3.1.cmml" xref="A1.E11.m1.3.3.3.5.3">subscript</csymbol><ci id="A1.E11.m1.3.3.3.5.3.2.cmml" xref="A1.E11.m1.3.3.3.5.3.2">𝑦</ci><ci id="A1.E11.m1.3.3.3.5.3.3.cmml" xref="A1.E11.m1.3.3.3.5.3.3">𝑖</ci></apply></apply><apply id="A1.E11.m1.3.3.3.3.1.1.cmml" xref="A1.E11.m1.3.3.3.3.1"><plus id="A1.E11.m1.3.3.3.3.1.1.3.cmml" xref="A1.E11.m1.3.3.3.3.1.1.3"></plus><cn id="A1.E11.m1.3.3.3.3.1.1.4.cmml" type="integer" xref="A1.E11.m1.3.3.3.3.1.1.4">1</cn><apply id="A1.E11.m1.3.3.3.3.1.1.1.cmml" xref="A1.E11.m1.3.3.3.3.1.1.1"><times id="A1.E11.m1.3.3.3.3.1.1.1.2.cmml" xref="A1.E11.m1.3.3.3.3.1.1.1.2"></times><apply id="A1.E11.m1.3.3.3.3.1.1.1.3.cmml" xref="A1.E11.m1.3.3.3.3.1.1.1.3"><csymbol cd="ambiguous" id="A1.E11.m1.3.3.3.3.1.1.1.3.1.cmml" xref="A1.E11.m1.3.3.3.3.1.1.1.3">subscript</csymbol><ci id="A1.E11.m1.3.3.3.3.1.1.1.3.2.cmml" xref="A1.E11.m1.3.3.3.3.1.1.1.3.2">𝔼</ci><apply id="A1.E11.m1.3.3.3.3.1.1.1.3.3.cmml" xref="A1.E11.m1.3.3.3.3.1.1.1.3.3"><eq id="A1.E11.m1.3.3.3.3.1.1.1.3.3.1.cmml" xref="A1.E11.m1.3.3.3.3.1.1.1.3.3.1"></eq><apply id="A1.E11.m1.3.3.3.3.1.1.1.3.3.2.cmml" xref="A1.E11.m1.3.3.3.3.1.1.1.3.3.2"><csymbol cd="latexml" id="A1.E11.m1.3.3.3.3.1.1.1.3.3.2.1.cmml" xref="A1.E11.m1.3.3.3.3.1.1.1.3.3.2.1">conditional</csymbol><ci id="A1.E11.m1.3.3.3.3.1.1.1.3.3.2.2.cmml" xref="A1.E11.m1.3.3.3.3.1.1.1.3.3.2.2">𝑗</ci><apply id="A1.E11.m1.3.3.3.3.1.1.1.3.3.2.3.cmml" xref="A1.E11.m1.3.3.3.3.1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="A1.E11.m1.3.3.3.3.1.1.1.3.3.2.3.1.cmml" xref="A1.E11.m1.3.3.3.3.1.1.1.3.3.2.3">subscript</csymbol><ci id="A1.E11.m1.3.3.3.3.1.1.1.3.3.2.3.2.cmml" xref="A1.E11.m1.3.3.3.3.1.1.1.3.3.2.3.2">𝑦</ci><ci id="A1.E11.m1.3.3.3.3.1.1.1.3.3.2.3.3.cmml" xref="A1.E11.m1.3.3.3.3.1.1.1.3.3.2.3.3">𝑖</ci></apply></apply><apply id="A1.E11.m1.3.3.3.3.1.1.1.3.3.3.cmml" xref="A1.E11.m1.3.3.3.3.1.1.1.3.3.3"><csymbol cd="ambiguous" id="A1.E11.m1.3.3.3.3.1.1.1.3.3.3.1.cmml" xref="A1.E11.m1.3.3.3.3.1.1.1.3.3.3">subscript</csymbol><ci id="A1.E11.m1.3.3.3.3.1.1.1.3.3.3.2.cmml" xref="A1.E11.m1.3.3.3.3.1.1.1.3.3.3.2">𝑦</ci><ci id="A1.E11.m1.3.3.3.3.1.1.1.3.3.3.3.cmml" xref="A1.E11.m1.3.3.3.3.1.1.1.3.3.3.3">𝑗</ci></apply></apply></apply><apply id="A1.E11.m1.3.3.3.3.1.1.1.1.2.cmml" xref="A1.E11.m1.3.3.3.3.1.1.1.1.1"><csymbol cd="latexml" id="A1.E11.m1.3.3.3.3.1.1.1.1.2.1.cmml" xref="A1.E11.m1.3.3.3.3.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A1.E11.m1.3.3.3.3.1.1.1.1.1.1.cmml" xref="A1.E11.m1.3.3.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E11.m1.3.3.3.3.1.1.1.1.1.1.1.cmml" xref="A1.E11.m1.3.3.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E11.m1.3.3.3.3.1.1.1.1.1.1.2.cmml" xref="A1.E11.m1.3.3.3.3.1.1.1.1.1.1.2">𝐵</ci><list id="A1.E11.m1.2.2.2.2.2.3.cmml" xref="A1.E11.m1.2.2.2.2.2.4"><ci id="A1.E11.m1.1.1.1.1.1.1.cmml" xref="A1.E11.m1.1.1.1.1.1.1">𝑖</ci><ci id="A1.E11.m1.2.2.2.2.2.2.cmml" xref="A1.E11.m1.2.2.2.2.2.2">𝑗</ci></list></apply></apply></apply><apply id="A1.E11.m1.3.3.3.3.1.1.2.cmml" xref="A1.E11.m1.3.3.3.3.1.1.2"><times id="A1.E11.m1.3.3.3.3.1.1.2.2.cmml" xref="A1.E11.m1.3.3.3.3.1.1.2.2"></times><apply id="A1.E11.m1.3.3.3.3.1.1.2.3.cmml" xref="A1.E11.m1.3.3.3.3.1.1.2.3"><csymbol cd="ambiguous" id="A1.E11.m1.3.3.3.3.1.1.2.3.1.cmml" xref="A1.E11.m1.3.3.3.3.1.1.2.3">subscript</csymbol><ci id="A1.E11.m1.3.3.3.3.1.1.2.3.2.cmml" xref="A1.E11.m1.3.3.3.3.1.1.2.3.2">𝔼</ci><apply id="A1.E11.m1.3.3.3.3.1.1.2.3.3.cmml" xref="A1.E11.m1.3.3.3.3.1.1.2.3.3"><eq id="A1.E11.m1.3.3.3.3.1.1.2.3.3.1.cmml" xref="A1.E11.m1.3.3.3.3.1.1.2.3.3.1"></eq><apply id="A1.E11.m1.3.3.3.3.1.1.2.3.3.2.cmml" xref="A1.E11.m1.3.3.3.3.1.1.2.3.3.2"><csymbol cd="latexml" id="A1.E11.m1.3.3.3.3.1.1.2.3.3.2.1.cmml" xref="A1.E11.m1.3.3.3.3.1.1.2.3.3.2.1">conditional</csymbol><ci id="A1.E11.m1.3.3.3.3.1.1.2.3.3.2.2.cmml" xref="A1.E11.m1.3.3.3.3.1.1.2.3.3.2.2">𝑗</ci><apply id="A1.E11.m1.3.3.3.3.1.1.2.3.3.2.3.cmml" xref="A1.E11.m1.3.3.3.3.1.1.2.3.3.2.3"><csymbol cd="ambiguous" id="A1.E11.m1.3.3.3.3.1.1.2.3.3.2.3.1.cmml" xref="A1.E11.m1.3.3.3.3.1.1.2.3.3.2.3">subscript</csymbol><ci id="A1.E11.m1.3.3.3.3.1.1.2.3.3.2.3.2.cmml" xref="A1.E11.m1.3.3.3.3.1.1.2.3.3.2.3.2">𝑦</ci><ci id="A1.E11.m1.3.3.3.3.1.1.2.3.3.2.3.3.cmml" xref="A1.E11.m1.3.3.3.3.1.1.2.3.3.2.3.3">𝑖</ci></apply></apply><apply id="A1.E11.m1.3.3.3.3.1.1.2.3.3.3.cmml" xref="A1.E11.m1.3.3.3.3.1.1.2.3.3.3"><csymbol cd="ambiguous" id="A1.E11.m1.3.3.3.3.1.1.2.3.3.3.1.cmml" xref="A1.E11.m1.3.3.3.3.1.1.2.3.3.3">subscript</csymbol><ci id="A1.E11.m1.3.3.3.3.1.1.2.3.3.3.2.cmml" xref="A1.E11.m1.3.3.3.3.1.1.2.3.3.3.2">𝑦</ci><ci id="A1.E11.m1.3.3.3.3.1.1.2.3.3.3.3.cmml" xref="A1.E11.m1.3.3.3.3.1.1.2.3.3.3.3">𝑗</ci></apply></apply></apply><apply id="A1.E11.m1.3.3.3.3.1.1.2.1.2.cmml" xref="A1.E11.m1.3.3.3.3.1.1.2.1.1"><csymbol cd="latexml" id="A1.E11.m1.3.3.3.3.1.1.2.1.2.1.cmml" xref="A1.E11.m1.3.3.3.3.1.1.2.1.1.2">delimited-[]</csymbol><list id="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.3.cmml" xref="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.2"><apply id="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.1.1.cmml" xref="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.1.1"><times id="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.1.1.2.cmml" xref="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.1.1.2"></times><ci id="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.1.1.3.cmml" xref="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.1.1.3">italic-ϵ</ci><apply id="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.1.1.1.1.1.2">𝑝</ci><ci id="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.2.2.cmml" xref="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.2.2"><times id="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.2.2.2.cmml" xref="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.2.2.2"></times><ci id="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.2.2.3.cmml" xref="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.2.2.3">italic-ϵ</ci><apply id="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.2.2.1.1.1.cmml" xref="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.2.2.1.1"><csymbol cd="ambiguous" id="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.2.2.1.1.1.1.cmml" xref="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.2.2.1.1">subscript</csymbol><ci id="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.2.2.1.1.1.2.cmml" xref="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.2.2.1.1.1.2">𝑝</ci><ci id="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.2.2.1.1.1.3.cmml" xref="A1.E11.m1.3.3.3.3.1.1.2.1.1.1.2.2.1.1.1.3">𝑗</ci></apply></apply></list></apply></apply></apply></apply><apply id="A1.E11.m1.6.6.6.3.3.cmml" xref="A1.E11.m1.6.6.6.4"><plus id="A1.E10.1.1.1.cmml" xref="A1.E11.m1.6.6.6.4"></plus><apply id="A1.E11.m1.4.4.4.1.1.1.cmml" xref="A1.E11.m1.6.6.6.4"><times id="A1.E11.m1.4.4.4.1.1.1.2.cmml" xref="A1.E11.m1.6.6.6.4"></times><apply id="A1.E11.m1.4.4.4.1.1.1.3.cmml" xref="A1.E11.m1.6.6.6.4"><csymbol cd="ambiguous" id="A1.E11.m1.4.4.4.1.1.1.3.1.cmml" xref="A1.E11.m1.6.6.6.4">subscript</csymbol><ci id="A1.E9.1.1.1.cmml" xref="A1.E9.1.1.1">𝑟</ci><apply id="A1.E9.2.2.2.1.cmml" xref="A1.E9.2.2.2.1"><csymbol cd="ambiguous" id="A1.E9.2.2.2.1.1.cmml" xref="A1.E9.2.2.2.1">subscript</csymbol><ci id="A1.E9.2.2.2.1.2.cmml" xref="A1.E9.2.2.2.1.2">𝑦</ci><ci id="A1.E9.2.2.2.1.3.cmml" xref="A1.E9.2.2.2.1.3">𝑖</ci></apply></apply><apply id="A1.E11.m1.4.4.4.1.1.1.1.1.1.cmml" xref="A1.E11.m1.6.6.6.4"><plus id="A1.E9.5.5.5.cmml" xref="A1.E9.5.5.5"></plus><cn id="A1.E9.4.4.4.cmml" type="integer" xref="A1.E9.4.4.4">1</cn><apply id="A1.E11.m1.4.4.4.1.1.1.1.1.1.1.cmml" xref="A1.E11.m1.6.6.6.4"><times id="A1.E11.m1.4.4.4.1.1.1.1.1.1.1.2.cmml" xref="A1.E11.m1.6.6.6.4"></times><apply id="A1.E11.m1.4.4.4.1.1.1.1.1.1.1.3.cmml" xref="A1.E11.m1.6.6.6.4"><csymbol cd="ambiguous" id="A1.E11.m1.4.4.4.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E11.m1.6.6.6.4">subscript</csymbol><ci id="A1.E9.6.6.6.cmml" xref="A1.E9.6.6.6">𝔼</ci><apply id="A1.E9.7.7.7.1.cmml" xref="A1.E9.7.7.7.1"><eq id="A1.E9.7.7.7.1.1.cmml" xref="A1.E9.7.7.7.1.1"></eq><apply id="A1.E9.7.7.7.1.2.cmml" xref="A1.E9.7.7.7.1.2"><csymbol cd="latexml" id="A1.E9.7.7.7.1.2.1.cmml" xref="A1.E9.7.7.7.1.2.1">conditional</csymbol><ci id="A1.E9.7.7.7.1.2.2.cmml" xref="A1.E9.7.7.7.1.2.2">𝑗</ci><apply id="A1.E9.7.7.7.1.2.3.cmml" xref="A1.E9.7.7.7.1.2.3"><csymbol cd="ambiguous" id="A1.E9.7.7.7.1.2.3.1.cmml" xref="A1.E9.7.7.7.1.2.3">subscript</csymbol><ci id="A1.E9.7.7.7.1.2.3.2.cmml" xref="A1.E9.7.7.7.1.2.3.2">𝑦</ci><ci id="A1.E9.7.7.7.1.2.3.3.cmml" xref="A1.E9.7.7.7.1.2.3.3">𝑖</ci></apply></apply><apply id="A1.E9.7.7.7.1.3.cmml" xref="A1.E9.7.7.7.1.3"><csymbol cd="ambiguous" id="A1.E9.7.7.7.1.3.1.cmml" xref="A1.E9.7.7.7.1.3">subscript</csymbol><ci id="A1.E9.7.7.7.1.3.2.cmml" xref="A1.E9.7.7.7.1.3.2">𝑦</ci><ci id="A1.E9.7.7.7.1.3.3.cmml" xref="A1.E9.7.7.7.1.3.3">𝑗</ci></apply></apply></apply><apply id="A1.E11.m1.4.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E11.m1.6.6.6.4"><csymbol cd="latexml" id="A1.E11.m1.4.4.4.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E11.m1.6.6.6.4">delimited-[]</csymbol><apply id="A1.E11.m1.4.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E11.m1.6.6.6.4"><csymbol cd="ambiguous" id="A1.E11.m1.4.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E11.m1.6.6.6.4">subscript</csymbol><ci id="A1.E9.9.9.9.cmml" xref="A1.E9.9.9.9">𝐵</ci><list id="A1.E9.10.10.10.1.3.cmml" xref="A1.E9.10.10.10.1.4"><ci id="A1.E9.10.10.10.1.1.cmml" xref="A1.E9.10.10.10.1.1">𝑖</ci><ci id="A1.E9.10.10.10.1.2.cmml" xref="A1.E9.10.10.10.1.2">𝑗</ci></list></apply></apply></apply><apply id="A1.E11.m1.4.4.4.1.1.1.1.1.1.2.cmml" xref="A1.E11.m1.6.6.6.4"><times id="A1.E11.m1.4.4.4.1.1.1.1.1.1.2.2.cmml" xref="A1.E11.m1.6.6.6.4"></times><apply id="A1.E11.m1.4.4.4.1.1.1.1.1.1.2.3.cmml" xref="A1.E11.m1.6.6.6.4"><csymbol cd="ambiguous" id="A1.E11.m1.4.4.4.1.1.1.1.1.1.2.3.1.cmml" xref="A1.E11.m1.6.6.6.4">subscript</csymbol><ci id="A1.E9.13.13.13.cmml" xref="A1.E9.13.13.13">𝔼</ci><apply id="A1.E9.14.14.14.1.cmml" xref="A1.E9.14.14.14.1"><eq id="A1.E9.14.14.14.1.1.cmml" xref="A1.E9.14.14.14.1.1"></eq><apply id="A1.E9.14.14.14.1.2.cmml" xref="A1.E9.14.14.14.1.2"><csymbol cd="latexml" id="A1.E9.14.14.14.1.2.1.cmml" xref="A1.E9.14.14.14.1.2.1">conditional</csymbol><ci id="A1.E9.14.14.14.1.2.2.cmml" xref="A1.E9.14.14.14.1.2.2">𝑗</ci><apply id="A1.E9.14.14.14.1.2.3.cmml" xref="A1.E9.14.14.14.1.2.3"><csymbol cd="ambiguous" id="A1.E9.14.14.14.1.2.3.1.cmml" xref="A1.E9.14.14.14.1.2.3">subscript</csymbol><ci id="A1.E9.14.14.14.1.2.3.2.cmml" xref="A1.E9.14.14.14.1.2.3.2">𝑦</ci><ci id="A1.E9.14.14.14.1.2.3.3.cmml" xref="A1.E9.14.14.14.1.2.3.3">𝑖</ci></apply></apply><apply id="A1.E9.14.14.14.1.3.cmml" xref="A1.E9.14.14.14.1.3"><csymbol cd="ambiguous" id="A1.E9.14.14.14.1.3.1.cmml" xref="A1.E9.14.14.14.1.3">subscript</csymbol><ci id="A1.E9.14.14.14.1.3.2.cmml" xref="A1.E9.14.14.14.1.3.2">𝑦</ci><ci id="A1.E9.14.14.14.1.3.3.cmml" xref="A1.E9.14.14.14.1.3.3">𝑗</ci></apply></apply></apply><apply id="A1.E11.m1.4.4.4.1.1.1.1.1.1.2.1.2.cmml" xref="A1.E11.m1.6.6.6.4"><csymbol cd="latexml" id="A1.E11.m1.4.4.4.1.1.1.1.1.1.2.1.2.1.cmml" xref="A1.E11.m1.6.6.6.4">delimited-[]</csymbol><list id="A1.E11.m1.4.4.4.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="A1.E11.m1.6.6.6.4"><apply id="A1.E11.m1.4.4.4.1.1.1.1.1.1.2.1.1.1.1.1.cmml" xref="A1.E11.m1.6.6.6.4"><times id="A1.E11.m1.4.4.4.1.1.1.1.1.1.2.1.1.1.1.1.2.cmml" xref="A1.E11.m1.6.6.6.4"></times><ci id="A1.E9.17.17.17.cmml" xref="A1.E9.17.17.17">italic-ϵ</ci><apply id="A1.E11.m1.4.4.4.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="A1.E11.m1.6.6.6.4"><csymbol cd="ambiguous" id="A1.E11.m1.4.4.4.1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E11.m1.6.6.6.4">subscript</csymbol><ci id="A1.E9.19.19.19.cmml" xref="A1.E9.19.19.19">𝑝</ci><ci id="A1.E9.20.20.20.1.cmml" xref="A1.E9.20.20.20.1">𝑖</ci></apply></apply><apply id="A1.E11.m1.4.4.4.1.1.1.1.1.1.2.1.1.1.2.2.cmml" xref="A1.E11.m1.6.6.6.4"><times id="A1.E11.m1.4.4.4.1.1.1.1.1.1.2.1.1.1.2.2.2.cmml" xref="A1.E11.m1.6.6.6.4"></times><ci id="A1.E9.23.23.23.cmml" xref="A1.E9.23.23.23">italic-ϵ</ci><apply id="A1.E11.m1.4.4.4.1.1.1.1.1.1.2.1.1.1.2.2.1.1.1.cmml" xref="A1.E11.m1.6.6.6.4"><csymbol cd="ambiguous" id="A1.E11.m1.4.4.4.1.1.1.1.1.1.2.1.1.1.2.2.1.1.1.1.cmml" xref="A1.E11.m1.6.6.6.4">subscript</csymbol><ci id="A1.E9.25.25.25.cmml" xref="A1.E9.25.25.25">𝑝</ci><ci id="A1.E9.26.26.26.1.cmml" xref="A1.E9.26.26.26.1">𝑗</ci></apply></apply></list></apply></apply></apply></apply><apply id="A1.E11.m1.6.6.6.3.3.3.cmml" xref="A1.E11.m1.6.6.6.4"><times id="A1.E11.m1.6.6.6.3.3.3.3.cmml" xref="A1.E11.m1.6.6.6.4"></times><apply id="A1.E11.m1.5.5.5.2.2.2.1.1.1.cmml" xref="A1.E11.m1.6.6.6.4"><minus id="A1.E10.4.4.4.cmml" xref="A1.E10.4.4.4"></minus><cn id="A1.E10.3.3.3.cmml" type="integer" xref="A1.E10.3.3.3">1</cn><apply id="A1.E11.m1.5.5.5.2.2.2.1.1.1.3.cmml" xref="A1.E11.m1.6.6.6.4"><csymbol cd="ambiguous" id="A1.E11.m1.5.5.5.2.2.2.1.1.1.3.1.cmml" xref="A1.E11.m1.6.6.6.4">subscript</csymbol><ci id="A1.E10.5.5.5.cmml" xref="A1.E10.5.5.5">𝑟</ci><apply id="A1.E10.6.6.6.1.cmml" xref="A1.E10.6.6.6.1"><csymbol cd="ambiguous" id="A1.E10.6.6.6.1.1.cmml" xref="A1.E10.6.6.6.1">subscript</csymbol><ci id="A1.E10.6.6.6.1.2.cmml" xref="A1.E10.6.6.6.1.2">𝑦</ci><ci id="A1.E10.6.6.6.1.3.cmml" xref="A1.E10.6.6.6.1.3">𝑖</ci></apply></apply></apply><apply id="A1.E11.m1.6.6.6.3.3.3.2.1.1.cmml" xref="A1.E11.m1.6.6.6.4"><plus id="A1.E10.22.22.22.cmml" xref="A1.E10.22.22.22"></plus><list id="A1.E11.m1.6.6.6.3.3.3.2.1.1.2.3.cmml" xref="A1.E11.m1.6.6.6.4"><apply id="A1.E11.m1.6.6.6.3.3.3.2.1.1.1.1.1.cmml" xref="A1.E11.m1.6.6.6.4"><times id="A1.E11.m1.6.6.6.3.3.3.2.1.1.1.1.1.2.cmml" xref="A1.E11.m1.6.6.6.4"></times><ci id="A1.E10.10.10.10.cmml" xref="A1.E10.10.10.10">𝑒</ci><apply id="A1.E11.m1.6.6.6.3.3.3.2.1.1.1.1.1.1.1.1.cmml" xref="A1.E11.m1.6.6.6.4"><csymbol cd="ambiguous" id="A1.E11.m1.6.6.6.3.3.3.2.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E11.m1.6.6.6.4">subscript</csymbol><ci id="A1.E10.12.12.12.cmml" xref="A1.E10.12.12.12">𝑦</ci><ci id="A1.E10.13.13.13.1.cmml" xref="A1.E10.13.13.13.1">𝑖</ci></apply></apply><apply id="A1.E11.m1.6.6.6.3.3.3.2.1.1.2.2.2.cmml" xref="A1.E11.m1.6.6.6.4"><times id="A1.E11.m1.6.6.6.3.3.3.2.1.1.2.2.2.2.cmml" xref="A1.E11.m1.6.6.6.4"></times><ci id="A1.E10.16.16.16.cmml" xref="A1.E10.16.16.16">𝑒</ci><apply id="A1.E11.m1.6.6.6.3.3.3.2.1.1.2.2.2.1.1.1.cmml" xref="A1.E11.m1.6.6.6.4"><csymbol cd="ambiguous" id="A1.E11.m1.6.6.6.3.3.3.2.1.1.2.2.2.1.1.1.1.cmml" xref="A1.E11.m1.6.6.6.4">subscript</csymbol><ci id="A1.E10.18.18.18.cmml" xref="A1.E10.18.18.18">𝑦</ci><ci id="A1.E10.19.19.19.1.cmml" xref="A1.E10.19.19.19.1">𝑗</ci></apply></apply></list><apply id="A1.E11.m1.6.6.6.3.3.3.2.1.1.3.cmml" xref="A1.E11.m1.6.6.6.4"><times id="A1.E11.m1.6.6.6.3.3.3.2.1.1.3.2.cmml" xref="A1.E11.m1.6.6.6.4"></times><apply id="A1.E11.m1.6.6.6.3.3.3.2.1.1.3.3.cmml" xref="A1.E11.m1.6.6.6.4"><csymbol cd="ambiguous" id="A1.E11.m1.6.6.6.3.3.3.2.1.1.3.3.1.cmml" xref="A1.E11.m1.6.6.6.4">subscript</csymbol><ci id="A1.E10.23.23.23.cmml" xref="A1.E10.23.23.23">𝔼</ci><ci id="A1.E10.24.24.24.1.cmml" xref="A1.E10.24.24.24.1">𝑗</ci></apply><apply id="A1.E11.m1.6.6.6.3.3.3.2.1.1.3.1.2.cmml" xref="A1.E11.m1.6.6.6.4"><csymbol cd="latexml" id="A1.E11.m1.6.6.6.3.3.3.2.1.1.3.1.2.1.cmml" xref="A1.E11.m1.6.6.6.4">delimited-[]</csymbol><apply id="A1.E11.m1.6.6.6.3.3.3.2.1.1.3.1.1.1.cmml" xref="A1.E11.m1.6.6.6.4"><csymbol cd="ambiguous" id="A1.E11.m1.6.6.6.3.3.3.2.1.1.3.1.1.1.1.cmml" xref="A1.E11.m1.6.6.6.4">subscript</csymbol><ci id="A1.E10.26.26.26.cmml" xref="A1.E10.26.26.26">𝐵</ci><list id="A1.E10.27.27.27.1.3.cmml" xref="A1.E10.27.27.27.1.4"><ci id="A1.E10.27.27.27.1.1.cmml" xref="A1.E10.27.27.27.1.1">𝑖</ci><ci id="A1.E10.27.27.27.1.2.cmml" xref="A1.E10.27.27.27.1.2">𝑗</ci></list></apply></apply></apply><apply id="A1.E11.m1.6.6.6.3.3.3.2.1.1.4.cmml" xref="A1.E11.m1.6.6.6.4"><times id="A1.E11.m1.6.6.6.3.3.3.2.1.1.4.2.cmml" xref="A1.E11.m1.6.6.6.4"></times><apply id="A1.E11.m1.6.6.6.3.3.3.2.1.1.4.3.cmml" xref="A1.E11.m1.6.6.6.4"><csymbol cd="ambiguous" id="A1.E11.m1.6.6.6.3.3.3.2.1.1.4.3.1.cmml" xref="A1.E11.m1.6.6.6.4">subscript</csymbol><ci id="A1.E10.30.30.30.cmml" xref="A1.E10.30.30.30">𝔼</ci><ci id="A1.E10.31.31.31.1.cmml" xref="A1.E10.31.31.31.1">𝑗</ci></apply><apply id="A1.E11.m1.6.6.6.3.3.3.2.1.1.4.1.2.cmml" xref="A1.E11.m1.6.6.6.4"><csymbol cd="latexml" id="A1.E11.m1.6.6.6.3.3.3.2.1.1.4.1.2.1.cmml" xref="A1.E11.m1.6.6.6.4">delimited-[]</csymbol><list id="A1.E11.m1.6.6.6.3.3.3.2.1.1.4.1.1.1.3.cmml" xref="A1.E11.m1.6.6.6.4"><apply id="A1.E11.m1.6.6.6.3.3.3.2.1.1.4.1.1.1.1.1.cmml" xref="A1.E11.m1.6.6.6.4"><times id="A1.E11.m1.6.6.6.3.3.3.2.1.1.4.1.1.1.1.1.2.cmml" xref="A1.E11.m1.6.6.6.4"></times><ci id="A1.E10.34.34.34.cmml" xref="A1.E10.34.34.34">italic-ϵ</ci><apply id="A1.E11.m1.6.6.6.3.3.3.2.1.1.4.1.1.1.1.1.1.1.1.cmml" xref="A1.E11.m1.6.6.6.4"><csymbol cd="ambiguous" id="A1.E11.m1.6.6.6.3.3.3.2.1.1.4.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E11.m1.6.6.6.4">subscript</csymbol><ci id="A1.E10.36.36.36.cmml" xref="A1.E10.36.36.36">𝑝</ci><ci id="A1.E10.37.37.37.1.cmml" xref="A1.E10.37.37.37.1">𝑖</ci></apply></apply><apply id="A1.E11.m1.6.6.6.3.3.3.2.1.1.4.1.1.1.2.2.cmml" xref="A1.E11.m1.6.6.6.4"><times id="A1.E11.m1.6.6.6.3.3.3.2.1.1.4.1.1.1.2.2.2.cmml" xref="A1.E11.m1.6.6.6.4"></times><ci id="A1.E10.40.40.40.cmml" xref="A1.E10.40.40.40">italic-ϵ</ci><apply id="A1.E11.m1.6.6.6.3.3.3.2.1.1.4.1.1.1.2.2.1.1.1.cmml" xref="A1.E11.m1.6.6.6.4"><csymbol cd="ambiguous" id="A1.E11.m1.6.6.6.3.3.3.2.1.1.4.1.1.1.2.2.1.1.1.1.cmml" xref="A1.E11.m1.6.6.6.4">subscript</csymbol><ci id="A1.E10.42.42.42.cmml" xref="A1.E10.42.42.42">𝑝</ci><ci id="A1.E10.43.43.43.1.cmml" xref="A1.E10.43.43.43.1">𝑗</ci></apply></apply></list></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E11.m1.6c">\displaystyle\approx\frac{r_{y_{i}}(1+\mathbb{E}_{j|y_{i}=y_{j}}\left[B_{i,j}%
\right]+\mathbb{E}_{j|y_{i}=y_{j}}\left[\left\langle\epsilon(p_{i}),\epsilon(p%
_{j})\right\rangle\right])}{\begin{multlined}r_{y_{i}}\left(1+\mathbb{E}_{j|y_%
{i}=y_{j}}\left[B_{i,j}\right]+\mathbb{E}_{j|y_{i}=y_{j}}\left[\left\langle%
\epsilon(p_{i}),\epsilon(p_{j})\right\rangle\right]\right)\\
+\left(1-r_{y_{i}}\right)\left(\left\langle e(y_{i}),e(y_{j})\right\rangle+%
\mathbb{E}_{j}\left[B_{i,j}\right]+\mathbb{E}_{j}\left[\left\langle\epsilon(p_%
{i}),\epsilon(p_{j})\right\rangle\right]\right)\end{multlined}r_{y_{i}}\left(1%
+\mathbb{E}_{j|y_{i}=y_{j}}\left[B_{i,j}\right]+\mathbb{E}_{j|y_{i}=y_{j}}%
\left[\left\langle\epsilon(p_{i}),\epsilon(p_{j})\right\rangle\right]\right)\\
+\left(1-r_{y_{i}}\right)\left(\left\langle e(y_{i}),e(y_{j})\right\rangle+%
\mathbb{E}_{j}\left[B_{i,j}\right]+\mathbb{E}_{j}\left[\left\langle\epsilon(p_%
{i}),\epsilon(p_{j})\right\rangle\right]\right)}</annotation><annotation encoding="application/x-llamapun" id="A1.E11.m1.6d">≈ divide start_ARG italic_r start_POSTSUBSCRIPT italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( 1 + blackboard_E start_POSTSUBSCRIPT italic_j | italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_y start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ italic_B start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT ] + blackboard_E start_POSTSUBSCRIPT italic_j | italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_y start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ ⟨ italic_ϵ ( italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) , italic_ϵ ( italic_p start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ⟩ ] ) end_ARG start_ARG start_ROW start_CELL italic_r start_POSTSUBSCRIPT italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( 1 + blackboard_E start_POSTSUBSCRIPT italic_j | italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_y start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ italic_B start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT ] + blackboard_E start_POSTSUBSCRIPT italic_j | italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_y start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ ⟨ italic_ϵ ( italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) , italic_ϵ ( italic_p start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ⟩ ] ) end_CELL end_ROW start_ROW start_CELL + ( 1 - italic_r start_POSTSUBSCRIPT italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) ( ⟨ italic_e ( italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) , italic_e ( italic_y start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ⟩ + blackboard_E start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT [ italic_B start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT ] + blackboard_E start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT [ ⟨ italic_ϵ ( italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) , italic_ϵ ( italic_p start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ⟩ ] ) end_CELL end_ROW end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
<tbody id="A1.E12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\geqslant\mathrm{P}_{F}\left[y_{i}=y_{\mathrm{top}_{1}\left(%
\mathcal{S}_{\delta|i}\right)}\right]." class="ltx_Math" display="inline" id="A1.E12.m1.2"><semantics id="A1.E12.m1.2a"><mrow id="A1.E12.m1.2.2.1" xref="A1.E12.m1.2.2.1.1.cmml"><mrow id="A1.E12.m1.2.2.1.1" xref="A1.E12.m1.2.2.1.1.cmml"><mi id="A1.E12.m1.2.2.1.1.3" xref="A1.E12.m1.2.2.1.1.3.cmml"></mi><mo id="A1.E12.m1.2.2.1.1.2" xref="A1.E12.m1.2.2.1.1.2.cmml">⩾</mo><mrow id="A1.E12.m1.2.2.1.1.1" xref="A1.E12.m1.2.2.1.1.1.cmml"><msub id="A1.E12.m1.2.2.1.1.1.3" xref="A1.E12.m1.2.2.1.1.1.3.cmml"><mi id="A1.E12.m1.2.2.1.1.1.3.2" mathvariant="normal" xref="A1.E12.m1.2.2.1.1.1.3.2.cmml">P</mi><mi id="A1.E12.m1.2.2.1.1.1.3.3" xref="A1.E12.m1.2.2.1.1.1.3.3.cmml">F</mi></msub><mo id="A1.E12.m1.2.2.1.1.1.2" xref="A1.E12.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="A1.E12.m1.2.2.1.1.1.1.1" xref="A1.E12.m1.2.2.1.1.1.1.2.cmml"><mo id="A1.E12.m1.2.2.1.1.1.1.1.2" xref="A1.E12.m1.2.2.1.1.1.1.2.1.cmml">[</mo><mrow id="A1.E12.m1.2.2.1.1.1.1.1.1" xref="A1.E12.m1.2.2.1.1.1.1.1.1.cmml"><msub id="A1.E12.m1.2.2.1.1.1.1.1.1.2" xref="A1.E12.m1.2.2.1.1.1.1.1.1.2.cmml"><mi id="A1.E12.m1.2.2.1.1.1.1.1.1.2.2" xref="A1.E12.m1.2.2.1.1.1.1.1.1.2.2.cmml">y</mi><mi id="A1.E12.m1.2.2.1.1.1.1.1.1.2.3" xref="A1.E12.m1.2.2.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="A1.E12.m1.2.2.1.1.1.1.1.1.1" xref="A1.E12.m1.2.2.1.1.1.1.1.1.1.cmml">=</mo><msub id="A1.E12.m1.2.2.1.1.1.1.1.1.3" xref="A1.E12.m1.2.2.1.1.1.1.1.1.3.cmml"><mi id="A1.E12.m1.2.2.1.1.1.1.1.1.3.2" xref="A1.E12.m1.2.2.1.1.1.1.1.1.3.2.cmml">y</mi><mrow id="A1.E12.m1.1.1.1" xref="A1.E12.m1.1.1.1.cmml"><msub id="A1.E12.m1.1.1.1.3" xref="A1.E12.m1.1.1.1.3.cmml"><mi id="A1.E12.m1.1.1.1.3.2" xref="A1.E12.m1.1.1.1.3.2.cmml">top</mi><mn id="A1.E12.m1.1.1.1.3.3" xref="A1.E12.m1.1.1.1.3.3.cmml">1</mn></msub><mo id="A1.E12.m1.1.1.1.2" xref="A1.E12.m1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E12.m1.1.1.1.1.1" xref="A1.E12.m1.1.1.1.1.1.1.cmml"><mo id="A1.E12.m1.1.1.1.1.1.2" xref="A1.E12.m1.1.1.1.1.1.1.cmml">(</mo><msub id="A1.E12.m1.1.1.1.1.1.1" xref="A1.E12.m1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E12.m1.1.1.1.1.1.1.2" xref="A1.E12.m1.1.1.1.1.1.1.2.cmml">𝒮</mi><mrow id="A1.E12.m1.1.1.1.1.1.1.3" xref="A1.E12.m1.1.1.1.1.1.1.3.cmml"><mi id="A1.E12.m1.1.1.1.1.1.1.3.2" xref="A1.E12.m1.1.1.1.1.1.1.3.2.cmml">δ</mi><mo fence="false" id="A1.E12.m1.1.1.1.1.1.1.3.1" xref="A1.E12.m1.1.1.1.1.1.1.3.1.cmml">|</mo><mi id="A1.E12.m1.1.1.1.1.1.1.3.3" xref="A1.E12.m1.1.1.1.1.1.1.3.3.cmml">i</mi></mrow></msub><mo id="A1.E12.m1.1.1.1.1.1.3" xref="A1.E12.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msub></mrow><mo id="A1.E12.m1.2.2.1.1.1.1.1.3" xref="A1.E12.m1.2.2.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="A1.E12.m1.2.2.1.2" lspace="0em" xref="A1.E12.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E12.m1.2b"><apply id="A1.E12.m1.2.2.1.1.cmml" xref="A1.E12.m1.2.2.1"><geq id="A1.E12.m1.2.2.1.1.2.cmml" xref="A1.E12.m1.2.2.1.1.2"></geq><csymbol cd="latexml" id="A1.E12.m1.2.2.1.1.3.cmml" xref="A1.E12.m1.2.2.1.1.3">absent</csymbol><apply id="A1.E12.m1.2.2.1.1.1.cmml" xref="A1.E12.m1.2.2.1.1.1"><times id="A1.E12.m1.2.2.1.1.1.2.cmml" xref="A1.E12.m1.2.2.1.1.1.2"></times><apply id="A1.E12.m1.2.2.1.1.1.3.cmml" xref="A1.E12.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="A1.E12.m1.2.2.1.1.1.3.1.cmml" xref="A1.E12.m1.2.2.1.1.1.3">subscript</csymbol><ci id="A1.E12.m1.2.2.1.1.1.3.2.cmml" xref="A1.E12.m1.2.2.1.1.1.3.2">P</ci><ci id="A1.E12.m1.2.2.1.1.1.3.3.cmml" xref="A1.E12.m1.2.2.1.1.1.3.3">𝐹</ci></apply><apply id="A1.E12.m1.2.2.1.1.1.1.2.cmml" xref="A1.E12.m1.2.2.1.1.1.1.1"><csymbol cd="latexml" id="A1.E12.m1.2.2.1.1.1.1.2.1.cmml" xref="A1.E12.m1.2.2.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A1.E12.m1.2.2.1.1.1.1.1.1.cmml" xref="A1.E12.m1.2.2.1.1.1.1.1.1"><eq id="A1.E12.m1.2.2.1.1.1.1.1.1.1.cmml" xref="A1.E12.m1.2.2.1.1.1.1.1.1.1"></eq><apply id="A1.E12.m1.2.2.1.1.1.1.1.1.2.cmml" xref="A1.E12.m1.2.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E12.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="A1.E12.m1.2.2.1.1.1.1.1.1.2">subscript</csymbol><ci id="A1.E12.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="A1.E12.m1.2.2.1.1.1.1.1.1.2.2">𝑦</ci><ci id="A1.E12.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="A1.E12.m1.2.2.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="A1.E12.m1.2.2.1.1.1.1.1.1.3.cmml" xref="A1.E12.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E12.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="A1.E12.m1.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E12.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="A1.E12.m1.2.2.1.1.1.1.1.1.3.2">𝑦</ci><apply id="A1.E12.m1.1.1.1.cmml" xref="A1.E12.m1.1.1.1"><times id="A1.E12.m1.1.1.1.2.cmml" xref="A1.E12.m1.1.1.1.2"></times><apply id="A1.E12.m1.1.1.1.3.cmml" xref="A1.E12.m1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E12.m1.1.1.1.3.1.cmml" xref="A1.E12.m1.1.1.1.3">subscript</csymbol><ci id="A1.E12.m1.1.1.1.3.2.cmml" xref="A1.E12.m1.1.1.1.3.2">top</ci><cn id="A1.E12.m1.1.1.1.3.3.cmml" type="integer" xref="A1.E12.m1.1.1.1.3.3">1</cn></apply><apply id="A1.E12.m1.1.1.1.1.1.1.cmml" xref="A1.E12.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E12.m1.1.1.1.1.1.1.1.cmml" xref="A1.E12.m1.1.1.1.1.1">subscript</csymbol><ci id="A1.E12.m1.1.1.1.1.1.1.2.cmml" xref="A1.E12.m1.1.1.1.1.1.1.2">𝒮</ci><apply id="A1.E12.m1.1.1.1.1.1.1.3.cmml" xref="A1.E12.m1.1.1.1.1.1.1.3"><csymbol cd="latexml" id="A1.E12.m1.1.1.1.1.1.1.3.1.cmml" xref="A1.E12.m1.1.1.1.1.1.1.3.1">conditional</csymbol><ci id="A1.E12.m1.1.1.1.1.1.1.3.2.cmml" xref="A1.E12.m1.1.1.1.1.1.1.3.2">𝛿</ci><ci id="A1.E12.m1.1.1.1.1.1.1.3.3.cmml" xref="A1.E12.m1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E12.m1.2c">\displaystyle\geqslant\mathrm{P}_{F}\left[y_{i}=y_{\mathrm{top}_{1}\left(%
\mathcal{S}_{\delta|i}\right)}\right].</annotation><annotation encoding="application/x-llamapun" id="A1.E12.m1.2d">⩾ roman_P start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT [ italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_y start_POSTSUBSCRIPT roman_top start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( caligraphic_S start_POSTSUBSCRIPT italic_δ | italic_i end_POSTSUBSCRIPT ) end_POSTSUBSCRIPT ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS2.SSS1.p3.18">That is, the inputs with the same labels with <math alttext="x_{i}" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p3.15.m1.1"><semantics id="A1.SS2.SSS1.p3.15.m1.1a"><msub id="A1.SS2.SSS1.p3.15.m1.1.1" xref="A1.SS2.SSS1.p3.15.m1.1.1.cmml"><mi id="A1.SS2.SSS1.p3.15.m1.1.1.2" xref="A1.SS2.SSS1.p3.15.m1.1.1.2.cmml">x</mi><mi id="A1.SS2.SSS1.p3.15.m1.1.1.3" xref="A1.SS2.SSS1.p3.15.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p3.15.m1.1b"><apply id="A1.SS2.SSS1.p3.15.m1.1.1.cmml" xref="A1.SS2.SSS1.p3.15.m1.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSS1.p3.15.m1.1.1.1.cmml" xref="A1.SS2.SSS1.p3.15.m1.1.1">subscript</csymbol><ci id="A1.SS2.SSS1.p3.15.m1.1.1.2.cmml" xref="A1.SS2.SSS1.p3.15.m1.1.1.2">𝑥</ci><ci id="A1.SS2.SSS1.p3.15.m1.1.1.3.cmml" xref="A1.SS2.SSS1.p3.15.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p3.15.m1.1c">x_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p3.15.m1.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> are easier to be selected into the <math alttext="\mathrm{top}_{1}\left(\mathcal{S}_{\delta|i}\right)" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p3.16.m2.1"><semantics id="A1.SS2.SSS1.p3.16.m2.1a"><mrow id="A1.SS2.SSS1.p3.16.m2.1.1" xref="A1.SS2.SSS1.p3.16.m2.1.1.cmml"><msub id="A1.SS2.SSS1.p3.16.m2.1.1.3" xref="A1.SS2.SSS1.p3.16.m2.1.1.3.cmml"><mi id="A1.SS2.SSS1.p3.16.m2.1.1.3.2" xref="A1.SS2.SSS1.p3.16.m2.1.1.3.2.cmml">top</mi><mn id="A1.SS2.SSS1.p3.16.m2.1.1.3.3" xref="A1.SS2.SSS1.p3.16.m2.1.1.3.3.cmml">1</mn></msub><mo id="A1.SS2.SSS1.p3.16.m2.1.1.2" xref="A1.SS2.SSS1.p3.16.m2.1.1.2.cmml">⁢</mo><mrow id="A1.SS2.SSS1.p3.16.m2.1.1.1.1" xref="A1.SS2.SSS1.p3.16.m2.1.1.1.1.1.cmml"><mo id="A1.SS2.SSS1.p3.16.m2.1.1.1.1.2" xref="A1.SS2.SSS1.p3.16.m2.1.1.1.1.1.cmml">(</mo><msub id="A1.SS2.SSS1.p3.16.m2.1.1.1.1.1" xref="A1.SS2.SSS1.p3.16.m2.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS2.SSS1.p3.16.m2.1.1.1.1.1.2" xref="A1.SS2.SSS1.p3.16.m2.1.1.1.1.1.2.cmml">𝒮</mi><mrow id="A1.SS2.SSS1.p3.16.m2.1.1.1.1.1.3" xref="A1.SS2.SSS1.p3.16.m2.1.1.1.1.1.3.cmml"><mi id="A1.SS2.SSS1.p3.16.m2.1.1.1.1.1.3.2" xref="A1.SS2.SSS1.p3.16.m2.1.1.1.1.1.3.2.cmml">δ</mi><mo fence="false" id="A1.SS2.SSS1.p3.16.m2.1.1.1.1.1.3.1" xref="A1.SS2.SSS1.p3.16.m2.1.1.1.1.1.3.1.cmml">|</mo><mi id="A1.SS2.SSS1.p3.16.m2.1.1.1.1.1.3.3" xref="A1.SS2.SSS1.p3.16.m2.1.1.1.1.1.3.3.cmml">i</mi></mrow></msub><mo id="A1.SS2.SSS1.p3.16.m2.1.1.1.1.3" xref="A1.SS2.SSS1.p3.16.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p3.16.m2.1b"><apply id="A1.SS2.SSS1.p3.16.m2.1.1.cmml" xref="A1.SS2.SSS1.p3.16.m2.1.1"><times id="A1.SS2.SSS1.p3.16.m2.1.1.2.cmml" xref="A1.SS2.SSS1.p3.16.m2.1.1.2"></times><apply id="A1.SS2.SSS1.p3.16.m2.1.1.3.cmml" xref="A1.SS2.SSS1.p3.16.m2.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.SSS1.p3.16.m2.1.1.3.1.cmml" xref="A1.SS2.SSS1.p3.16.m2.1.1.3">subscript</csymbol><ci id="A1.SS2.SSS1.p3.16.m2.1.1.3.2.cmml" xref="A1.SS2.SSS1.p3.16.m2.1.1.3.2">top</ci><cn id="A1.SS2.SSS1.p3.16.m2.1.1.3.3.cmml" type="integer" xref="A1.SS2.SSS1.p3.16.m2.1.1.3.3">1</cn></apply><apply id="A1.SS2.SSS1.p3.16.m2.1.1.1.1.1.cmml" xref="A1.SS2.SSS1.p3.16.m2.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSS1.p3.16.m2.1.1.1.1.1.1.cmml" xref="A1.SS2.SSS1.p3.16.m2.1.1.1.1">subscript</csymbol><ci id="A1.SS2.SSS1.p3.16.m2.1.1.1.1.1.2.cmml" xref="A1.SS2.SSS1.p3.16.m2.1.1.1.1.1.2">𝒮</ci><apply id="A1.SS2.SSS1.p3.16.m2.1.1.1.1.1.3.cmml" xref="A1.SS2.SSS1.p3.16.m2.1.1.1.1.1.3"><csymbol cd="latexml" id="A1.SS2.SSS1.p3.16.m2.1.1.1.1.1.3.1.cmml" xref="A1.SS2.SSS1.p3.16.m2.1.1.1.1.1.3.1">conditional</csymbol><ci id="A1.SS2.SSS1.p3.16.m2.1.1.1.1.1.3.2.cmml" xref="A1.SS2.SSS1.p3.16.m2.1.1.1.1.1.3.2">𝛿</ci><ci id="A1.SS2.SSS1.p3.16.m2.1.1.1.1.1.3.3.cmml" xref="A1.SS2.SSS1.p3.16.m2.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p3.16.m2.1c">\mathrm{top}_{1}\left(\mathcal{S}_{\delta|i}\right)</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p3.16.m2.1d">roman_top start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( caligraphic_S start_POSTSUBSCRIPT italic_δ | italic_i end_POSTSUBSCRIPT )</annotation></semantics></math>. Notice that we make approximations here: (1) we consider the <math alttext="\mathbb{E}_{j|y_{i}=y_{j}}\left[C_{i,j}\right]\approx\mathbb{E}_{j}\left[C_{i,%
j}\right]" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p3.17.m3.6"><semantics id="A1.SS2.SSS1.p3.17.m3.6a"><mrow id="A1.SS2.SSS1.p3.17.m3.6.6" xref="A1.SS2.SSS1.p3.17.m3.6.6.cmml"><mrow id="A1.SS2.SSS1.p3.17.m3.5.5.1" xref="A1.SS2.SSS1.p3.17.m3.5.5.1.cmml"><msub id="A1.SS2.SSS1.p3.17.m3.5.5.1.3" xref="A1.SS2.SSS1.p3.17.m3.5.5.1.3.cmml"><mi id="A1.SS2.SSS1.p3.17.m3.5.5.1.3.2" xref="A1.SS2.SSS1.p3.17.m3.5.5.1.3.2.cmml">𝔼</mi><mrow id="A1.SS2.SSS1.p3.17.m3.5.5.1.3.3" xref="A1.SS2.SSS1.p3.17.m3.5.5.1.3.3.cmml"><mrow id="A1.SS2.SSS1.p3.17.m3.5.5.1.3.3.2" xref="A1.SS2.SSS1.p3.17.m3.5.5.1.3.3.2.cmml"><mi id="A1.SS2.SSS1.p3.17.m3.5.5.1.3.3.2.2" xref="A1.SS2.SSS1.p3.17.m3.5.5.1.3.3.2.2.cmml">j</mi><mo fence="false" id="A1.SS2.SSS1.p3.17.m3.5.5.1.3.3.2.1" xref="A1.SS2.SSS1.p3.17.m3.5.5.1.3.3.2.1.cmml">|</mo><msub id="A1.SS2.SSS1.p3.17.m3.5.5.1.3.3.2.3" xref="A1.SS2.SSS1.p3.17.m3.5.5.1.3.3.2.3.cmml"><mi id="A1.SS2.SSS1.p3.17.m3.5.5.1.3.3.2.3.2" xref="A1.SS2.SSS1.p3.17.m3.5.5.1.3.3.2.3.2.cmml">y</mi><mi id="A1.SS2.SSS1.p3.17.m3.5.5.1.3.3.2.3.3" xref="A1.SS2.SSS1.p3.17.m3.5.5.1.3.3.2.3.3.cmml">i</mi></msub></mrow><mo id="A1.SS2.SSS1.p3.17.m3.5.5.1.3.3.1" xref="A1.SS2.SSS1.p3.17.m3.5.5.1.3.3.1.cmml">=</mo><msub id="A1.SS2.SSS1.p3.17.m3.5.5.1.3.3.3" xref="A1.SS2.SSS1.p3.17.m3.5.5.1.3.3.3.cmml"><mi id="A1.SS2.SSS1.p3.17.m3.5.5.1.3.3.3.2" xref="A1.SS2.SSS1.p3.17.m3.5.5.1.3.3.3.2.cmml">y</mi><mi id="A1.SS2.SSS1.p3.17.m3.5.5.1.3.3.3.3" xref="A1.SS2.SSS1.p3.17.m3.5.5.1.3.3.3.3.cmml">j</mi></msub></mrow></msub><mo id="A1.SS2.SSS1.p3.17.m3.5.5.1.2" xref="A1.SS2.SSS1.p3.17.m3.5.5.1.2.cmml">⁢</mo><mrow id="A1.SS2.SSS1.p3.17.m3.5.5.1.1.1" xref="A1.SS2.SSS1.p3.17.m3.5.5.1.1.2.cmml"><mo id="A1.SS2.SSS1.p3.17.m3.5.5.1.1.1.2" xref="A1.SS2.SSS1.p3.17.m3.5.5.1.1.2.1.cmml">[</mo><msub id="A1.SS2.SSS1.p3.17.m3.5.5.1.1.1.1" xref="A1.SS2.SSS1.p3.17.m3.5.5.1.1.1.1.cmml"><mi id="A1.SS2.SSS1.p3.17.m3.5.5.1.1.1.1.2" xref="A1.SS2.SSS1.p3.17.m3.5.5.1.1.1.1.2.cmml">C</mi><mrow id="A1.SS2.SSS1.p3.17.m3.2.2.2.4" xref="A1.SS2.SSS1.p3.17.m3.2.2.2.3.cmml"><mi id="A1.SS2.SSS1.p3.17.m3.1.1.1.1" xref="A1.SS2.SSS1.p3.17.m3.1.1.1.1.cmml">i</mi><mo id="A1.SS2.SSS1.p3.17.m3.2.2.2.4.1" xref="A1.SS2.SSS1.p3.17.m3.2.2.2.3.cmml">,</mo><mi id="A1.SS2.SSS1.p3.17.m3.2.2.2.2" xref="A1.SS2.SSS1.p3.17.m3.2.2.2.2.cmml">j</mi></mrow></msub><mo id="A1.SS2.SSS1.p3.17.m3.5.5.1.1.1.3" xref="A1.SS2.SSS1.p3.17.m3.5.5.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="A1.SS2.SSS1.p3.17.m3.6.6.3" xref="A1.SS2.SSS1.p3.17.m3.6.6.3.cmml">≈</mo><mrow id="A1.SS2.SSS1.p3.17.m3.6.6.2" xref="A1.SS2.SSS1.p3.17.m3.6.6.2.cmml"><msub id="A1.SS2.SSS1.p3.17.m3.6.6.2.3" xref="A1.SS2.SSS1.p3.17.m3.6.6.2.3.cmml"><mi id="A1.SS2.SSS1.p3.17.m3.6.6.2.3.2" xref="A1.SS2.SSS1.p3.17.m3.6.6.2.3.2.cmml">𝔼</mi><mi id="A1.SS2.SSS1.p3.17.m3.6.6.2.3.3" xref="A1.SS2.SSS1.p3.17.m3.6.6.2.3.3.cmml">j</mi></msub><mo id="A1.SS2.SSS1.p3.17.m3.6.6.2.2" xref="A1.SS2.SSS1.p3.17.m3.6.6.2.2.cmml">⁢</mo><mrow id="A1.SS2.SSS1.p3.17.m3.6.6.2.1.1" xref="A1.SS2.SSS1.p3.17.m3.6.6.2.1.2.cmml"><mo id="A1.SS2.SSS1.p3.17.m3.6.6.2.1.1.2" xref="A1.SS2.SSS1.p3.17.m3.6.6.2.1.2.1.cmml">[</mo><msub id="A1.SS2.SSS1.p3.17.m3.6.6.2.1.1.1" xref="A1.SS2.SSS1.p3.17.m3.6.6.2.1.1.1.cmml"><mi id="A1.SS2.SSS1.p3.17.m3.6.6.2.1.1.1.2" xref="A1.SS2.SSS1.p3.17.m3.6.6.2.1.1.1.2.cmml">C</mi><mrow id="A1.SS2.SSS1.p3.17.m3.4.4.2.4" xref="A1.SS2.SSS1.p3.17.m3.4.4.2.3.cmml"><mi id="A1.SS2.SSS1.p3.17.m3.3.3.1.1" xref="A1.SS2.SSS1.p3.17.m3.3.3.1.1.cmml">i</mi><mo id="A1.SS2.SSS1.p3.17.m3.4.4.2.4.1" xref="A1.SS2.SSS1.p3.17.m3.4.4.2.3.cmml">,</mo><mi id="A1.SS2.SSS1.p3.17.m3.4.4.2.2" xref="A1.SS2.SSS1.p3.17.m3.4.4.2.2.cmml">j</mi></mrow></msub><mo id="A1.SS2.SSS1.p3.17.m3.6.6.2.1.1.3" xref="A1.SS2.SSS1.p3.17.m3.6.6.2.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p3.17.m3.6b"><apply id="A1.SS2.SSS1.p3.17.m3.6.6.cmml" xref="A1.SS2.SSS1.p3.17.m3.6.6"><approx id="A1.SS2.SSS1.p3.17.m3.6.6.3.cmml" xref="A1.SS2.SSS1.p3.17.m3.6.6.3"></approx><apply id="A1.SS2.SSS1.p3.17.m3.5.5.1.cmml" xref="A1.SS2.SSS1.p3.17.m3.5.5.1"><times id="A1.SS2.SSS1.p3.17.m3.5.5.1.2.cmml" xref="A1.SS2.SSS1.p3.17.m3.5.5.1.2"></times><apply id="A1.SS2.SSS1.p3.17.m3.5.5.1.3.cmml" xref="A1.SS2.SSS1.p3.17.m3.5.5.1.3"><csymbol cd="ambiguous" id="A1.SS2.SSS1.p3.17.m3.5.5.1.3.1.cmml" xref="A1.SS2.SSS1.p3.17.m3.5.5.1.3">subscript</csymbol><ci id="A1.SS2.SSS1.p3.17.m3.5.5.1.3.2.cmml" xref="A1.SS2.SSS1.p3.17.m3.5.5.1.3.2">𝔼</ci><apply id="A1.SS2.SSS1.p3.17.m3.5.5.1.3.3.cmml" xref="A1.SS2.SSS1.p3.17.m3.5.5.1.3.3"><eq id="A1.SS2.SSS1.p3.17.m3.5.5.1.3.3.1.cmml" xref="A1.SS2.SSS1.p3.17.m3.5.5.1.3.3.1"></eq><apply id="A1.SS2.SSS1.p3.17.m3.5.5.1.3.3.2.cmml" xref="A1.SS2.SSS1.p3.17.m3.5.5.1.3.3.2"><csymbol cd="latexml" id="A1.SS2.SSS1.p3.17.m3.5.5.1.3.3.2.1.cmml" xref="A1.SS2.SSS1.p3.17.m3.5.5.1.3.3.2.1">conditional</csymbol><ci id="A1.SS2.SSS1.p3.17.m3.5.5.1.3.3.2.2.cmml" xref="A1.SS2.SSS1.p3.17.m3.5.5.1.3.3.2.2">𝑗</ci><apply id="A1.SS2.SSS1.p3.17.m3.5.5.1.3.3.2.3.cmml" xref="A1.SS2.SSS1.p3.17.m3.5.5.1.3.3.2.3"><csymbol cd="ambiguous" id="A1.SS2.SSS1.p3.17.m3.5.5.1.3.3.2.3.1.cmml" xref="A1.SS2.SSS1.p3.17.m3.5.5.1.3.3.2.3">subscript</csymbol><ci id="A1.SS2.SSS1.p3.17.m3.5.5.1.3.3.2.3.2.cmml" xref="A1.SS2.SSS1.p3.17.m3.5.5.1.3.3.2.3.2">𝑦</ci><ci id="A1.SS2.SSS1.p3.17.m3.5.5.1.3.3.2.3.3.cmml" xref="A1.SS2.SSS1.p3.17.m3.5.5.1.3.3.2.3.3">𝑖</ci></apply></apply><apply id="A1.SS2.SSS1.p3.17.m3.5.5.1.3.3.3.cmml" xref="A1.SS2.SSS1.p3.17.m3.5.5.1.3.3.3"><csymbol cd="ambiguous" id="A1.SS2.SSS1.p3.17.m3.5.5.1.3.3.3.1.cmml" xref="A1.SS2.SSS1.p3.17.m3.5.5.1.3.3.3">subscript</csymbol><ci id="A1.SS2.SSS1.p3.17.m3.5.5.1.3.3.3.2.cmml" xref="A1.SS2.SSS1.p3.17.m3.5.5.1.3.3.3.2">𝑦</ci><ci id="A1.SS2.SSS1.p3.17.m3.5.5.1.3.3.3.3.cmml" xref="A1.SS2.SSS1.p3.17.m3.5.5.1.3.3.3.3">𝑗</ci></apply></apply></apply><apply id="A1.SS2.SSS1.p3.17.m3.5.5.1.1.2.cmml" xref="A1.SS2.SSS1.p3.17.m3.5.5.1.1.1"><csymbol cd="latexml" id="A1.SS2.SSS1.p3.17.m3.5.5.1.1.2.1.cmml" xref="A1.SS2.SSS1.p3.17.m3.5.5.1.1.1.2">delimited-[]</csymbol><apply id="A1.SS2.SSS1.p3.17.m3.5.5.1.1.1.1.cmml" xref="A1.SS2.SSS1.p3.17.m3.5.5.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSS1.p3.17.m3.5.5.1.1.1.1.1.cmml" xref="A1.SS2.SSS1.p3.17.m3.5.5.1.1.1.1">subscript</csymbol><ci id="A1.SS2.SSS1.p3.17.m3.5.5.1.1.1.1.2.cmml" xref="A1.SS2.SSS1.p3.17.m3.5.5.1.1.1.1.2">𝐶</ci><list id="A1.SS2.SSS1.p3.17.m3.2.2.2.3.cmml" xref="A1.SS2.SSS1.p3.17.m3.2.2.2.4"><ci id="A1.SS2.SSS1.p3.17.m3.1.1.1.1.cmml" xref="A1.SS2.SSS1.p3.17.m3.1.1.1.1">𝑖</ci><ci id="A1.SS2.SSS1.p3.17.m3.2.2.2.2.cmml" xref="A1.SS2.SSS1.p3.17.m3.2.2.2.2">𝑗</ci></list></apply></apply></apply><apply id="A1.SS2.SSS1.p3.17.m3.6.6.2.cmml" xref="A1.SS2.SSS1.p3.17.m3.6.6.2"><times id="A1.SS2.SSS1.p3.17.m3.6.6.2.2.cmml" xref="A1.SS2.SSS1.p3.17.m3.6.6.2.2"></times><apply id="A1.SS2.SSS1.p3.17.m3.6.6.2.3.cmml" xref="A1.SS2.SSS1.p3.17.m3.6.6.2.3"><csymbol cd="ambiguous" id="A1.SS2.SSS1.p3.17.m3.6.6.2.3.1.cmml" xref="A1.SS2.SSS1.p3.17.m3.6.6.2.3">subscript</csymbol><ci id="A1.SS2.SSS1.p3.17.m3.6.6.2.3.2.cmml" xref="A1.SS2.SSS1.p3.17.m3.6.6.2.3.2">𝔼</ci><ci id="A1.SS2.SSS1.p3.17.m3.6.6.2.3.3.cmml" xref="A1.SS2.SSS1.p3.17.m3.6.6.2.3.3">𝑗</ci></apply><apply id="A1.SS2.SSS1.p3.17.m3.6.6.2.1.2.cmml" xref="A1.SS2.SSS1.p3.17.m3.6.6.2.1.1"><csymbol cd="latexml" id="A1.SS2.SSS1.p3.17.m3.6.6.2.1.2.1.cmml" xref="A1.SS2.SSS1.p3.17.m3.6.6.2.1.1.2">delimited-[]</csymbol><apply id="A1.SS2.SSS1.p3.17.m3.6.6.2.1.1.1.cmml" xref="A1.SS2.SSS1.p3.17.m3.6.6.2.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSS1.p3.17.m3.6.6.2.1.1.1.1.cmml" xref="A1.SS2.SSS1.p3.17.m3.6.6.2.1.1.1">subscript</csymbol><ci id="A1.SS2.SSS1.p3.17.m3.6.6.2.1.1.1.2.cmml" xref="A1.SS2.SSS1.p3.17.m3.6.6.2.1.1.1.2">𝐶</ci><list id="A1.SS2.SSS1.p3.17.m3.4.4.2.3.cmml" xref="A1.SS2.SSS1.p3.17.m3.4.4.2.4"><ci id="A1.SS2.SSS1.p3.17.m3.3.3.1.1.cmml" xref="A1.SS2.SSS1.p3.17.m3.3.3.1.1">𝑖</ci><ci id="A1.SS2.SSS1.p3.17.m3.4.4.2.2.cmml" xref="A1.SS2.SSS1.p3.17.m3.4.4.2.2">𝑗</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p3.17.m3.6c">\mathbb{E}_{j|y_{i}=y_{j}}\left[C_{i,j}\right]\approx\mathbb{E}_{j}\left[C_{i,%
j}\right]</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p3.17.m3.6d">blackboard_E start_POSTSUBSCRIPT italic_j | italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_y start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ italic_C start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT ] ≈ blackboard_E start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT [ italic_C start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT ]</annotation></semantics></math>, i.e., the 2-norm of two encoding vectors are considered equal granted by normalization used in Transformer. (2) We consider the context term <math alttext="c" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p3.18.m4.1"><semantics id="A1.SS2.SSS1.p3.18.m4.1a"><mi id="A1.SS2.SSS1.p3.18.m4.1.1" xref="A1.SS2.SSS1.p3.18.m4.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p3.18.m4.1b"><ci id="A1.SS2.SSS1.p3.18.m4.1.1.cmml" xref="A1.SS2.SSS1.p3.18.m4.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p3.18.m4.1c">c</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p3.18.m4.1d">italic_c</annotation></semantics></math> in the label token scenario the same as the forerunner scenario since the difference is only a label token, which usually occupies quite a small part of the input sequence.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS2.SSS1.p4">
<p class="ltx_p" id="A1.SS2.SSS1.p4.5"><span class="ltx_text ltx_font_bold" id="A1.SS2.SSS1.p4.5.1">Background Values of Kernel Alignment.</span> According to the explanation above, it is intuitive to conclude that <math alttext="\mathrm{top}_{k}\left(\mathcal{S}_{\delta|i}\right)" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p4.1.m1.1"><semantics id="A1.SS2.SSS1.p4.1.m1.1a"><mrow id="A1.SS2.SSS1.p4.1.m1.1.1" xref="A1.SS2.SSS1.p4.1.m1.1.1.cmml"><msub id="A1.SS2.SSS1.p4.1.m1.1.1.3" xref="A1.SS2.SSS1.p4.1.m1.1.1.3.cmml"><mi id="A1.SS2.SSS1.p4.1.m1.1.1.3.2" xref="A1.SS2.SSS1.p4.1.m1.1.1.3.2.cmml">top</mi><mi id="A1.SS2.SSS1.p4.1.m1.1.1.3.3" xref="A1.SS2.SSS1.p4.1.m1.1.1.3.3.cmml">k</mi></msub><mo id="A1.SS2.SSS1.p4.1.m1.1.1.2" xref="A1.SS2.SSS1.p4.1.m1.1.1.2.cmml">⁢</mo><mrow id="A1.SS2.SSS1.p4.1.m1.1.1.1.1" xref="A1.SS2.SSS1.p4.1.m1.1.1.1.1.1.cmml"><mo id="A1.SS2.SSS1.p4.1.m1.1.1.1.1.2" xref="A1.SS2.SSS1.p4.1.m1.1.1.1.1.1.cmml">(</mo><msub id="A1.SS2.SSS1.p4.1.m1.1.1.1.1.1" xref="A1.SS2.SSS1.p4.1.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS2.SSS1.p4.1.m1.1.1.1.1.1.2" xref="A1.SS2.SSS1.p4.1.m1.1.1.1.1.1.2.cmml">𝒮</mi><mrow id="A1.SS2.SSS1.p4.1.m1.1.1.1.1.1.3" xref="A1.SS2.SSS1.p4.1.m1.1.1.1.1.1.3.cmml"><mi id="A1.SS2.SSS1.p4.1.m1.1.1.1.1.1.3.2" xref="A1.SS2.SSS1.p4.1.m1.1.1.1.1.1.3.2.cmml">δ</mi><mo fence="false" id="A1.SS2.SSS1.p4.1.m1.1.1.1.1.1.3.1" xref="A1.SS2.SSS1.p4.1.m1.1.1.1.1.1.3.1.cmml">|</mo><mi id="A1.SS2.SSS1.p4.1.m1.1.1.1.1.1.3.3" xref="A1.SS2.SSS1.p4.1.m1.1.1.1.1.1.3.3.cmml">i</mi></mrow></msub><mo id="A1.SS2.SSS1.p4.1.m1.1.1.1.1.3" xref="A1.SS2.SSS1.p4.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p4.1.m1.1b"><apply id="A1.SS2.SSS1.p4.1.m1.1.1.cmml" xref="A1.SS2.SSS1.p4.1.m1.1.1"><times id="A1.SS2.SSS1.p4.1.m1.1.1.2.cmml" xref="A1.SS2.SSS1.p4.1.m1.1.1.2"></times><apply id="A1.SS2.SSS1.p4.1.m1.1.1.3.cmml" xref="A1.SS2.SSS1.p4.1.m1.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.SSS1.p4.1.m1.1.1.3.1.cmml" xref="A1.SS2.SSS1.p4.1.m1.1.1.3">subscript</csymbol><ci id="A1.SS2.SSS1.p4.1.m1.1.1.3.2.cmml" xref="A1.SS2.SSS1.p4.1.m1.1.1.3.2">top</ci><ci id="A1.SS2.SSS1.p4.1.m1.1.1.3.3.cmml" xref="A1.SS2.SSS1.p4.1.m1.1.1.3.3">𝑘</ci></apply><apply id="A1.SS2.SSS1.p4.1.m1.1.1.1.1.1.cmml" xref="A1.SS2.SSS1.p4.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSS1.p4.1.m1.1.1.1.1.1.1.cmml" xref="A1.SS2.SSS1.p4.1.m1.1.1.1.1">subscript</csymbol><ci id="A1.SS2.SSS1.p4.1.m1.1.1.1.1.1.2.cmml" xref="A1.SS2.SSS1.p4.1.m1.1.1.1.1.1.2">𝒮</ci><apply id="A1.SS2.SSS1.p4.1.m1.1.1.1.1.1.3.cmml" xref="A1.SS2.SSS1.p4.1.m1.1.1.1.1.1.3"><csymbol cd="latexml" id="A1.SS2.SSS1.p4.1.m1.1.1.1.1.1.3.1.cmml" xref="A1.SS2.SSS1.p4.1.m1.1.1.1.1.1.3.1">conditional</csymbol><ci id="A1.SS2.SSS1.p4.1.m1.1.1.1.1.1.3.2.cmml" xref="A1.SS2.SSS1.p4.1.m1.1.1.1.1.1.3.2">𝛿</ci><ci id="A1.SS2.SSS1.p4.1.m1.1.1.1.1.1.3.3.cmml" xref="A1.SS2.SSS1.p4.1.m1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p4.1.m1.1c">\mathrm{top}_{k}\left(\mathcal{S}_{\delta|i}\right)</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p4.1.m1.1d">roman_top start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ( caligraphic_S start_POSTSUBSCRIPT italic_δ | italic_i end_POSTSUBSCRIPT )</annotation></semantics></math> from label tokens is easier to cluster samples with the same label as <math alttext="y_{i}" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p4.2.m2.1"><semantics id="A1.SS2.SSS1.p4.2.m2.1a"><msub id="A1.SS2.SSS1.p4.2.m2.1.1" xref="A1.SS2.SSS1.p4.2.m2.1.1.cmml"><mi id="A1.SS2.SSS1.p4.2.m2.1.1.2" xref="A1.SS2.SSS1.p4.2.m2.1.1.2.cmml">y</mi><mi id="A1.SS2.SSS1.p4.2.m2.1.1.3" xref="A1.SS2.SSS1.p4.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p4.2.m2.1b"><apply id="A1.SS2.SSS1.p4.2.m2.1.1.cmml" xref="A1.SS2.SSS1.p4.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSS1.p4.2.m2.1.1.1.cmml" xref="A1.SS2.SSS1.p4.2.m2.1.1">subscript</csymbol><ci id="A1.SS2.SSS1.p4.2.m2.1.1.2.cmml" xref="A1.SS2.SSS1.p4.2.m2.1.1.2">𝑦</ci><ci id="A1.SS2.SSS1.p4.2.m2.1.1.3.cmml" xref="A1.SS2.SSS1.p4.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p4.2.m2.1c">y_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p4.2.m2.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. Moreover, a well-pre-trained encoder can catch the prior distribution determined by these labels, and also cluster samples with the same label, causing a high similarity of similarity map, so that a high but unfaithful kernel alignment as the background value from the similarity on <math alttext="e(y)" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p4.3.m3.1"><semantics id="A1.SS2.SSS1.p4.3.m3.1a"><mrow id="A1.SS2.SSS1.p4.3.m3.1.2" xref="A1.SS2.SSS1.p4.3.m3.1.2.cmml"><mi id="A1.SS2.SSS1.p4.3.m3.1.2.2" xref="A1.SS2.SSS1.p4.3.m3.1.2.2.cmml">e</mi><mo id="A1.SS2.SSS1.p4.3.m3.1.2.1" xref="A1.SS2.SSS1.p4.3.m3.1.2.1.cmml">⁢</mo><mrow id="A1.SS2.SSS1.p4.3.m3.1.2.3.2" xref="A1.SS2.SSS1.p4.3.m3.1.2.cmml"><mo id="A1.SS2.SSS1.p4.3.m3.1.2.3.2.1" stretchy="false" xref="A1.SS2.SSS1.p4.3.m3.1.2.cmml">(</mo><mi id="A1.SS2.SSS1.p4.3.m3.1.1" xref="A1.SS2.SSS1.p4.3.m3.1.1.cmml">y</mi><mo id="A1.SS2.SSS1.p4.3.m3.1.2.3.2.2" stretchy="false" xref="A1.SS2.SSS1.p4.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p4.3.m3.1b"><apply id="A1.SS2.SSS1.p4.3.m3.1.2.cmml" xref="A1.SS2.SSS1.p4.3.m3.1.2"><times id="A1.SS2.SSS1.p4.3.m3.1.2.1.cmml" xref="A1.SS2.SSS1.p4.3.m3.1.2.1"></times><ci id="A1.SS2.SSS1.p4.3.m3.1.2.2.cmml" xref="A1.SS2.SSS1.p4.3.m3.1.2.2">𝑒</ci><ci id="A1.SS2.SSS1.p4.3.m3.1.1.cmml" xref="A1.SS2.SSS1.p4.3.m3.1.1">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p4.3.m3.1c">e(y)</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p4.3.m3.1d">italic_e ( italic_y )</annotation></semantics></math> but not <math alttext="\epsilon(p)" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p4.4.m4.1"><semantics id="A1.SS2.SSS1.p4.4.m4.1a"><mrow id="A1.SS2.SSS1.p4.4.m4.1.2" xref="A1.SS2.SSS1.p4.4.m4.1.2.cmml"><mi id="A1.SS2.SSS1.p4.4.m4.1.2.2" xref="A1.SS2.SSS1.p4.4.m4.1.2.2.cmml">ϵ</mi><mo id="A1.SS2.SSS1.p4.4.m4.1.2.1" xref="A1.SS2.SSS1.p4.4.m4.1.2.1.cmml">⁢</mo><mrow id="A1.SS2.SSS1.p4.4.m4.1.2.3.2" xref="A1.SS2.SSS1.p4.4.m4.1.2.cmml"><mo id="A1.SS2.SSS1.p4.4.m4.1.2.3.2.1" stretchy="false" xref="A1.SS2.SSS1.p4.4.m4.1.2.cmml">(</mo><mi id="A1.SS2.SSS1.p4.4.m4.1.1" xref="A1.SS2.SSS1.p4.4.m4.1.1.cmml">p</mi><mo id="A1.SS2.SSS1.p4.4.m4.1.2.3.2.2" stretchy="false" xref="A1.SS2.SSS1.p4.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p4.4.m4.1b"><apply id="A1.SS2.SSS1.p4.4.m4.1.2.cmml" xref="A1.SS2.SSS1.p4.4.m4.1.2"><times id="A1.SS2.SSS1.p4.4.m4.1.2.1.cmml" xref="A1.SS2.SSS1.p4.4.m4.1.2.1"></times><ci id="A1.SS2.SSS1.p4.4.m4.1.2.2.cmml" xref="A1.SS2.SSS1.p4.4.m4.1.2.2">italic-ϵ</ci><ci id="A1.SS2.SSS1.p4.4.m4.1.1.cmml" xref="A1.SS2.SSS1.p4.4.m4.1.1">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p4.4.m4.1c">\epsilon(p)</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p4.4.m4.1d">italic_ϵ ( italic_p )</annotation></semantics></math>. An intuitive verification of such background value is shown in the Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S3.F2" title="Figure 2 ‣ 3.2 Text Summarization is Linear and Task-Relevant but Position-biased ‣ 3 Step 1, Summarize: Linear Representations in Hidden States ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">2</span></a> (Left), where the “Label Token” curve has a high value in layer 0 with <math alttext="\epsilon(p)=0" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p4.5.m5.1"><semantics id="A1.SS2.SSS1.p4.5.m5.1a"><mrow id="A1.SS2.SSS1.p4.5.m5.1.2" xref="A1.SS2.SSS1.p4.5.m5.1.2.cmml"><mrow id="A1.SS2.SSS1.p4.5.m5.1.2.2" xref="A1.SS2.SSS1.p4.5.m5.1.2.2.cmml"><mi id="A1.SS2.SSS1.p4.5.m5.1.2.2.2" xref="A1.SS2.SSS1.p4.5.m5.1.2.2.2.cmml">ϵ</mi><mo id="A1.SS2.SSS1.p4.5.m5.1.2.2.1" xref="A1.SS2.SSS1.p4.5.m5.1.2.2.1.cmml">⁢</mo><mrow id="A1.SS2.SSS1.p4.5.m5.1.2.2.3.2" xref="A1.SS2.SSS1.p4.5.m5.1.2.2.cmml"><mo id="A1.SS2.SSS1.p4.5.m5.1.2.2.3.2.1" stretchy="false" xref="A1.SS2.SSS1.p4.5.m5.1.2.2.cmml">(</mo><mi id="A1.SS2.SSS1.p4.5.m5.1.1" xref="A1.SS2.SSS1.p4.5.m5.1.1.cmml">p</mi><mo id="A1.SS2.SSS1.p4.5.m5.1.2.2.3.2.2" stretchy="false" xref="A1.SS2.SSS1.p4.5.m5.1.2.2.cmml">)</mo></mrow></mrow><mo id="A1.SS2.SSS1.p4.5.m5.1.2.1" xref="A1.SS2.SSS1.p4.5.m5.1.2.1.cmml">=</mo><mn id="A1.SS2.SSS1.p4.5.m5.1.2.3" xref="A1.SS2.SSS1.p4.5.m5.1.2.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p4.5.m5.1b"><apply id="A1.SS2.SSS1.p4.5.m5.1.2.cmml" xref="A1.SS2.SSS1.p4.5.m5.1.2"><eq id="A1.SS2.SSS1.p4.5.m5.1.2.1.cmml" xref="A1.SS2.SSS1.p4.5.m5.1.2.1"></eq><apply id="A1.SS2.SSS1.p4.5.m5.1.2.2.cmml" xref="A1.SS2.SSS1.p4.5.m5.1.2.2"><times id="A1.SS2.SSS1.p4.5.m5.1.2.2.1.cmml" xref="A1.SS2.SSS1.p4.5.m5.1.2.2.1"></times><ci id="A1.SS2.SSS1.p4.5.m5.1.2.2.2.cmml" xref="A1.SS2.SSS1.p4.5.m5.1.2.2.2">italic-ϵ</ci><ci id="A1.SS2.SSS1.p4.5.m5.1.1.cmml" xref="A1.SS2.SSS1.p4.5.m5.1.1">𝑝</ci></apply><cn id="A1.SS2.SSS1.p4.5.m5.1.2.3.cmml" type="integer" xref="A1.SS2.SSS1.p4.5.m5.1.2.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p4.5.m5.1c">\epsilon(p)=0</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p4.5.m5.1d">italic_ϵ ( italic_p ) = 0</annotation></semantics></math>. However, the background value also indicates that the representation generated by BGE correctly clusters the samples, confirming its reliability.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_subsection" id="A1.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.3 </span>Training and Inference of Centroid Classifier</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A1.SS3.p1">
<p class="ltx_p" id="A1.SS3.p1.5">In this paper, we follow&nbsp;<cite class="ltx_cite ltx_citemacro_cite">Cho et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib9" title="">2024</a>)</cite> to train centroid classifiers as a probe toward hidden states of LMs. In detail, given the LM’s hidden states set <math alttext="\left\{h_{i}^{l}\right\}_{i=1}^{m}" class="ltx_Math" display="inline" id="A1.SS3.p1.1.m1.1"><semantics id="A1.SS3.p1.1.m1.1a"><msubsup id="A1.SS3.p1.1.m1.1.1" xref="A1.SS3.p1.1.m1.1.1.cmml"><mrow id="A1.SS3.p1.1.m1.1.1.1.1.1" xref="A1.SS3.p1.1.m1.1.1.1.1.2.cmml"><mo id="A1.SS3.p1.1.m1.1.1.1.1.1.2" xref="A1.SS3.p1.1.m1.1.1.1.1.2.cmml">{</mo><msubsup id="A1.SS3.p1.1.m1.1.1.1.1.1.1" xref="A1.SS3.p1.1.m1.1.1.1.1.1.1.cmml"><mi id="A1.SS3.p1.1.m1.1.1.1.1.1.1.2.2" xref="A1.SS3.p1.1.m1.1.1.1.1.1.1.2.2.cmml">h</mi><mi id="A1.SS3.p1.1.m1.1.1.1.1.1.1.2.3" xref="A1.SS3.p1.1.m1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="A1.SS3.p1.1.m1.1.1.1.1.1.1.3" xref="A1.SS3.p1.1.m1.1.1.1.1.1.1.3.cmml">l</mi></msubsup><mo id="A1.SS3.p1.1.m1.1.1.1.1.1.3" xref="A1.SS3.p1.1.m1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="A1.SS3.p1.1.m1.1.1.1.3" xref="A1.SS3.p1.1.m1.1.1.1.3.cmml"><mi id="A1.SS3.p1.1.m1.1.1.1.3.2" xref="A1.SS3.p1.1.m1.1.1.1.3.2.cmml">i</mi><mo id="A1.SS3.p1.1.m1.1.1.1.3.1" xref="A1.SS3.p1.1.m1.1.1.1.3.1.cmml">=</mo><mn id="A1.SS3.p1.1.m1.1.1.1.3.3" xref="A1.SS3.p1.1.m1.1.1.1.3.3.cmml">1</mn></mrow><mi id="A1.SS3.p1.1.m1.1.1.3" xref="A1.SS3.p1.1.m1.1.1.3.cmml">m</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS3.p1.1.m1.1b"><apply id="A1.SS3.p1.1.m1.1.1.cmml" xref="A1.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS3.p1.1.m1.1.1.2.cmml" xref="A1.SS3.p1.1.m1.1.1">superscript</csymbol><apply id="A1.SS3.p1.1.m1.1.1.1.cmml" xref="A1.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS3.p1.1.m1.1.1.1.2.cmml" xref="A1.SS3.p1.1.m1.1.1">subscript</csymbol><set id="A1.SS3.p1.1.m1.1.1.1.1.2.cmml" xref="A1.SS3.p1.1.m1.1.1.1.1.1"><apply id="A1.SS3.p1.1.m1.1.1.1.1.1.1.cmml" xref="A1.SS3.p1.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS3.p1.1.m1.1.1.1.1.1.1.1.cmml" xref="A1.SS3.p1.1.m1.1.1.1.1.1.1">superscript</csymbol><apply id="A1.SS3.p1.1.m1.1.1.1.1.1.1.2.cmml" xref="A1.SS3.p1.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS3.p1.1.m1.1.1.1.1.1.1.2.1.cmml" xref="A1.SS3.p1.1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.SS3.p1.1.m1.1.1.1.1.1.1.2.2.cmml" xref="A1.SS3.p1.1.m1.1.1.1.1.1.1.2.2">ℎ</ci><ci id="A1.SS3.p1.1.m1.1.1.1.1.1.1.2.3.cmml" xref="A1.SS3.p1.1.m1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="A1.SS3.p1.1.m1.1.1.1.1.1.1.3.cmml" xref="A1.SS3.p1.1.m1.1.1.1.1.1.1.3">𝑙</ci></apply></set><apply id="A1.SS3.p1.1.m1.1.1.1.3.cmml" xref="A1.SS3.p1.1.m1.1.1.1.3"><eq id="A1.SS3.p1.1.m1.1.1.1.3.1.cmml" xref="A1.SS3.p1.1.m1.1.1.1.3.1"></eq><ci id="A1.SS3.p1.1.m1.1.1.1.3.2.cmml" xref="A1.SS3.p1.1.m1.1.1.1.3.2">𝑖</ci><cn id="A1.SS3.p1.1.m1.1.1.1.3.3.cmml" type="integer" xref="A1.SS3.p1.1.m1.1.1.1.3.3">1</cn></apply></apply><ci id="A1.SS3.p1.1.m1.1.1.3.cmml" xref="A1.SS3.p1.1.m1.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p1.1.m1.1c">\left\{h_{i}^{l}\right\}_{i=1}^{m}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.p1.1.m1.1d">{ italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT</annotation></semantics></math> of the selected tokens (according to the experimental setting, the last label token or forerunner token) in layer <math alttext="l" class="ltx_Math" display="inline" id="A1.SS3.p1.2.m2.1"><semantics id="A1.SS3.p1.2.m2.1a"><mi id="A1.SS3.p1.2.m2.1.1" xref="A1.SS3.p1.2.m2.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="A1.SS3.p1.2.m2.1b"><ci id="A1.SS3.p1.2.m2.1.1.cmml" xref="A1.SS3.p1.2.m2.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p1.2.m2.1c">l</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.p1.2.m2.1d">italic_l</annotation></semantics></math> from an [input prompt]-[query label] set <math alttext="\mathcal{Z}=\left\{\left(p_{i},y_{i}\right)\right\}_{i=1}^{m}" class="ltx_Math" display="inline" id="A1.SS3.p1.3.m3.1"><semantics id="A1.SS3.p1.3.m3.1a"><mrow id="A1.SS3.p1.3.m3.1.1" xref="A1.SS3.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS3.p1.3.m3.1.1.3" xref="A1.SS3.p1.3.m3.1.1.3.cmml">𝒵</mi><mo id="A1.SS3.p1.3.m3.1.1.2" xref="A1.SS3.p1.3.m3.1.1.2.cmml">=</mo><msubsup id="A1.SS3.p1.3.m3.1.1.1" xref="A1.SS3.p1.3.m3.1.1.1.cmml"><mrow id="A1.SS3.p1.3.m3.1.1.1.1.1.1" xref="A1.SS3.p1.3.m3.1.1.1.1.1.2.cmml"><mo id="A1.SS3.p1.3.m3.1.1.1.1.1.1.2" xref="A1.SS3.p1.3.m3.1.1.1.1.1.2.cmml">{</mo><mrow id="A1.SS3.p1.3.m3.1.1.1.1.1.1.1.2" xref="A1.SS3.p1.3.m3.1.1.1.1.1.1.1.3.cmml"><mo id="A1.SS3.p1.3.m3.1.1.1.1.1.1.1.2.3" xref="A1.SS3.p1.3.m3.1.1.1.1.1.1.1.3.cmml">(</mo><msub id="A1.SS3.p1.3.m3.1.1.1.1.1.1.1.1.1" xref="A1.SS3.p1.3.m3.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.SS3.p1.3.m3.1.1.1.1.1.1.1.1.1.2" xref="A1.SS3.p1.3.m3.1.1.1.1.1.1.1.1.1.2.cmml">p</mi><mi id="A1.SS3.p1.3.m3.1.1.1.1.1.1.1.1.1.3" xref="A1.SS3.p1.3.m3.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.SS3.p1.3.m3.1.1.1.1.1.1.1.2.4" xref="A1.SS3.p1.3.m3.1.1.1.1.1.1.1.3.cmml">,</mo><msub id="A1.SS3.p1.3.m3.1.1.1.1.1.1.1.2.2" xref="A1.SS3.p1.3.m3.1.1.1.1.1.1.1.2.2.cmml"><mi id="A1.SS3.p1.3.m3.1.1.1.1.1.1.1.2.2.2" xref="A1.SS3.p1.3.m3.1.1.1.1.1.1.1.2.2.2.cmml">y</mi><mi id="A1.SS3.p1.3.m3.1.1.1.1.1.1.1.2.2.3" xref="A1.SS3.p1.3.m3.1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo id="A1.SS3.p1.3.m3.1.1.1.1.1.1.1.2.5" xref="A1.SS3.p1.3.m3.1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo id="A1.SS3.p1.3.m3.1.1.1.1.1.1.3" xref="A1.SS3.p1.3.m3.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="A1.SS3.p1.3.m3.1.1.1.1.3" xref="A1.SS3.p1.3.m3.1.1.1.1.3.cmml"><mi id="A1.SS3.p1.3.m3.1.1.1.1.3.2" xref="A1.SS3.p1.3.m3.1.1.1.1.3.2.cmml">i</mi><mo id="A1.SS3.p1.3.m3.1.1.1.1.3.1" xref="A1.SS3.p1.3.m3.1.1.1.1.3.1.cmml">=</mo><mn id="A1.SS3.p1.3.m3.1.1.1.1.3.3" xref="A1.SS3.p1.3.m3.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="A1.SS3.p1.3.m3.1.1.1.3" xref="A1.SS3.p1.3.m3.1.1.1.3.cmml">m</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.p1.3.m3.1b"><apply id="A1.SS3.p1.3.m3.1.1.cmml" xref="A1.SS3.p1.3.m3.1.1"><eq id="A1.SS3.p1.3.m3.1.1.2.cmml" xref="A1.SS3.p1.3.m3.1.1.2"></eq><ci id="A1.SS3.p1.3.m3.1.1.3.cmml" xref="A1.SS3.p1.3.m3.1.1.3">𝒵</ci><apply id="A1.SS3.p1.3.m3.1.1.1.cmml" xref="A1.SS3.p1.3.m3.1.1.1"><csymbol cd="ambiguous" id="A1.SS3.p1.3.m3.1.1.1.2.cmml" xref="A1.SS3.p1.3.m3.1.1.1">superscript</csymbol><apply id="A1.SS3.p1.3.m3.1.1.1.1.cmml" xref="A1.SS3.p1.3.m3.1.1.1"><csymbol cd="ambiguous" id="A1.SS3.p1.3.m3.1.1.1.1.2.cmml" xref="A1.SS3.p1.3.m3.1.1.1">subscript</csymbol><set id="A1.SS3.p1.3.m3.1.1.1.1.1.2.cmml" xref="A1.SS3.p1.3.m3.1.1.1.1.1.1"><interval closure="open" id="A1.SS3.p1.3.m3.1.1.1.1.1.1.1.3.cmml" xref="A1.SS3.p1.3.m3.1.1.1.1.1.1.1.2"><apply id="A1.SS3.p1.3.m3.1.1.1.1.1.1.1.1.1.cmml" xref="A1.SS3.p1.3.m3.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS3.p1.3.m3.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.SS3.p1.3.m3.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.SS3.p1.3.m3.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.SS3.p1.3.m3.1.1.1.1.1.1.1.1.1.2">𝑝</ci><ci id="A1.SS3.p1.3.m3.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.SS3.p1.3.m3.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="A1.SS3.p1.3.m3.1.1.1.1.1.1.1.2.2.cmml" xref="A1.SS3.p1.3.m3.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A1.SS3.p1.3.m3.1.1.1.1.1.1.1.2.2.1.cmml" xref="A1.SS3.p1.3.m3.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="A1.SS3.p1.3.m3.1.1.1.1.1.1.1.2.2.2.cmml" xref="A1.SS3.p1.3.m3.1.1.1.1.1.1.1.2.2.2">𝑦</ci><ci id="A1.SS3.p1.3.m3.1.1.1.1.1.1.1.2.2.3.cmml" xref="A1.SS3.p1.3.m3.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply></interval></set><apply id="A1.SS3.p1.3.m3.1.1.1.1.3.cmml" xref="A1.SS3.p1.3.m3.1.1.1.1.3"><eq id="A1.SS3.p1.3.m3.1.1.1.1.3.1.cmml" xref="A1.SS3.p1.3.m3.1.1.1.1.3.1"></eq><ci id="A1.SS3.p1.3.m3.1.1.1.1.3.2.cmml" xref="A1.SS3.p1.3.m3.1.1.1.1.3.2">𝑖</ci><cn id="A1.SS3.p1.3.m3.1.1.1.1.3.3.cmml" type="integer" xref="A1.SS3.p1.3.m3.1.1.1.1.3.3">1</cn></apply></apply><ci id="A1.SS3.p1.3.m3.1.1.1.3.cmml" xref="A1.SS3.p1.3.m3.1.1.1.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p1.3.m3.1c">\mathcal{Z}=\left\{\left(p_{i},y_{i}\right)\right\}_{i=1}^{m}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.p1.3.m3.1d">caligraphic_Z = { ( italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT</annotation></semantics></math>, where the labels are limited in label space <math alttext="\mathbb{Y}" class="ltx_Math" display="inline" id="A1.SS3.p1.4.m4.1"><semantics id="A1.SS3.p1.4.m4.1a"><mi id="A1.SS3.p1.4.m4.1.1" xref="A1.SS3.p1.4.m4.1.1.cmml">𝕐</mi><annotation-xml encoding="MathML-Content" id="A1.SS3.p1.4.m4.1b"><ci id="A1.SS3.p1.4.m4.1.1.cmml" xref="A1.SS3.p1.4.m4.1.1">𝕐</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p1.4.m4.1c">\mathbb{Y}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.p1.4.m4.1d">blackboard_Y</annotation></semantics></math>, in the <span class="ltx_text ltx_font_bold" id="A1.SS3.p1.5.1">training phase</span>, we calculate the centroid of the hidden state <math alttext="\bar{h}^{l}_{y}" class="ltx_Math" display="inline" id="A1.SS3.p1.5.m5.1"><semantics id="A1.SS3.p1.5.m5.1a"><msubsup id="A1.SS3.p1.5.m5.1.1" xref="A1.SS3.p1.5.m5.1.1.cmml"><mover accent="true" id="A1.SS3.p1.5.m5.1.1.2.2" xref="A1.SS3.p1.5.m5.1.1.2.2.cmml"><mi id="A1.SS3.p1.5.m5.1.1.2.2.2" xref="A1.SS3.p1.5.m5.1.1.2.2.2.cmml">h</mi><mo id="A1.SS3.p1.5.m5.1.1.2.2.1" xref="A1.SS3.p1.5.m5.1.1.2.2.1.cmml">¯</mo></mover><mi id="A1.SS3.p1.5.m5.1.1.3" xref="A1.SS3.p1.5.m5.1.1.3.cmml">y</mi><mi id="A1.SS3.p1.5.m5.1.1.2.3" xref="A1.SS3.p1.5.m5.1.1.2.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS3.p1.5.m5.1b"><apply id="A1.SS3.p1.5.m5.1.1.cmml" xref="A1.SS3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="A1.SS3.p1.5.m5.1.1.1.cmml" xref="A1.SS3.p1.5.m5.1.1">subscript</csymbol><apply id="A1.SS3.p1.5.m5.1.1.2.cmml" xref="A1.SS3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="A1.SS3.p1.5.m5.1.1.2.1.cmml" xref="A1.SS3.p1.5.m5.1.1">superscript</csymbol><apply id="A1.SS3.p1.5.m5.1.1.2.2.cmml" xref="A1.SS3.p1.5.m5.1.1.2.2"><ci id="A1.SS3.p1.5.m5.1.1.2.2.1.cmml" xref="A1.SS3.p1.5.m5.1.1.2.2.1">¯</ci><ci id="A1.SS3.p1.5.m5.1.1.2.2.2.cmml" xref="A1.SS3.p1.5.m5.1.1.2.2.2">ℎ</ci></apply><ci id="A1.SS3.p1.5.m5.1.1.2.3.cmml" xref="A1.SS3.p1.5.m5.1.1.2.3">𝑙</ci></apply><ci id="A1.SS3.p1.5.m5.1.1.3.cmml" xref="A1.SS3.p1.5.m5.1.1.3">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p1.5.m5.1c">\bar{h}^{l}_{y}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.p1.5.m5.1d">over¯ start_ARG italic_h end_ARG start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT</annotation></semantics></math> for each label respectively:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="A1.E13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\bar{h}^{l}_{y}=\mathbb{E}_{i|y_{i}=y}\left[h_{i}^{l}\right]." class="ltx_Math" display="block" id="A1.E13.m1.1"><semantics id="A1.E13.m1.1a"><mrow id="A1.E13.m1.1.1.1" xref="A1.E13.m1.1.1.1.1.cmml"><mrow id="A1.E13.m1.1.1.1.1" xref="A1.E13.m1.1.1.1.1.cmml"><msubsup id="A1.E13.m1.1.1.1.1.3" xref="A1.E13.m1.1.1.1.1.3.cmml"><mover accent="true" id="A1.E13.m1.1.1.1.1.3.2.2" xref="A1.E13.m1.1.1.1.1.3.2.2.cmml"><mi id="A1.E13.m1.1.1.1.1.3.2.2.2" xref="A1.E13.m1.1.1.1.1.3.2.2.2.cmml">h</mi><mo id="A1.E13.m1.1.1.1.1.3.2.2.1" xref="A1.E13.m1.1.1.1.1.3.2.2.1.cmml">¯</mo></mover><mi id="A1.E13.m1.1.1.1.1.3.3" xref="A1.E13.m1.1.1.1.1.3.3.cmml">y</mi><mi id="A1.E13.m1.1.1.1.1.3.2.3" xref="A1.E13.m1.1.1.1.1.3.2.3.cmml">l</mi></msubsup><mo id="A1.E13.m1.1.1.1.1.2" xref="A1.E13.m1.1.1.1.1.2.cmml">=</mo><mrow id="A1.E13.m1.1.1.1.1.1" xref="A1.E13.m1.1.1.1.1.1.cmml"><msub id="A1.E13.m1.1.1.1.1.1.3" xref="A1.E13.m1.1.1.1.1.1.3.cmml"><mi id="A1.E13.m1.1.1.1.1.1.3.2" xref="A1.E13.m1.1.1.1.1.1.3.2.cmml">𝔼</mi><mrow id="A1.E13.m1.1.1.1.1.1.3.3" xref="A1.E13.m1.1.1.1.1.1.3.3.cmml"><mrow id="A1.E13.m1.1.1.1.1.1.3.3.2" xref="A1.E13.m1.1.1.1.1.1.3.3.2.cmml"><mi id="A1.E13.m1.1.1.1.1.1.3.3.2.2" xref="A1.E13.m1.1.1.1.1.1.3.3.2.2.cmml">i</mi><mo fence="false" id="A1.E13.m1.1.1.1.1.1.3.3.2.1" xref="A1.E13.m1.1.1.1.1.1.3.3.2.1.cmml">|</mo><msub id="A1.E13.m1.1.1.1.1.1.3.3.2.3" xref="A1.E13.m1.1.1.1.1.1.3.3.2.3.cmml"><mi id="A1.E13.m1.1.1.1.1.1.3.3.2.3.2" xref="A1.E13.m1.1.1.1.1.1.3.3.2.3.2.cmml">y</mi><mi id="A1.E13.m1.1.1.1.1.1.3.3.2.3.3" xref="A1.E13.m1.1.1.1.1.1.3.3.2.3.3.cmml">i</mi></msub></mrow><mo id="A1.E13.m1.1.1.1.1.1.3.3.1" xref="A1.E13.m1.1.1.1.1.1.3.3.1.cmml">=</mo><mi id="A1.E13.m1.1.1.1.1.1.3.3.3" xref="A1.E13.m1.1.1.1.1.1.3.3.3.cmml">y</mi></mrow></msub><mo id="A1.E13.m1.1.1.1.1.1.2" xref="A1.E13.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E13.m1.1.1.1.1.1.1.1" xref="A1.E13.m1.1.1.1.1.1.1.2.cmml"><mo id="A1.E13.m1.1.1.1.1.1.1.1.2" xref="A1.E13.m1.1.1.1.1.1.1.2.1.cmml">[</mo><msubsup id="A1.E13.m1.1.1.1.1.1.1.1.1" xref="A1.E13.m1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E13.m1.1.1.1.1.1.1.1.1.2.2" xref="A1.E13.m1.1.1.1.1.1.1.1.1.2.2.cmml">h</mi><mi id="A1.E13.m1.1.1.1.1.1.1.1.1.2.3" xref="A1.E13.m1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="A1.E13.m1.1.1.1.1.1.1.1.1.3" xref="A1.E13.m1.1.1.1.1.1.1.1.1.3.cmml">l</mi></msubsup><mo id="A1.E13.m1.1.1.1.1.1.1.1.3" xref="A1.E13.m1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="A1.E13.m1.1.1.1.2" lspace="0em" xref="A1.E13.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E13.m1.1b"><apply id="A1.E13.m1.1.1.1.1.cmml" xref="A1.E13.m1.1.1.1"><eq id="A1.E13.m1.1.1.1.1.2.cmml" xref="A1.E13.m1.1.1.1.1.2"></eq><apply id="A1.E13.m1.1.1.1.1.3.cmml" xref="A1.E13.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E13.m1.1.1.1.1.3.1.cmml" xref="A1.E13.m1.1.1.1.1.3">subscript</csymbol><apply id="A1.E13.m1.1.1.1.1.3.2.cmml" xref="A1.E13.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E13.m1.1.1.1.1.3.2.1.cmml" xref="A1.E13.m1.1.1.1.1.3">superscript</csymbol><apply id="A1.E13.m1.1.1.1.1.3.2.2.cmml" xref="A1.E13.m1.1.1.1.1.3.2.2"><ci id="A1.E13.m1.1.1.1.1.3.2.2.1.cmml" xref="A1.E13.m1.1.1.1.1.3.2.2.1">¯</ci><ci id="A1.E13.m1.1.1.1.1.3.2.2.2.cmml" xref="A1.E13.m1.1.1.1.1.3.2.2.2">ℎ</ci></apply><ci id="A1.E13.m1.1.1.1.1.3.2.3.cmml" xref="A1.E13.m1.1.1.1.1.3.2.3">𝑙</ci></apply><ci id="A1.E13.m1.1.1.1.1.3.3.cmml" xref="A1.E13.m1.1.1.1.1.3.3">𝑦</ci></apply><apply id="A1.E13.m1.1.1.1.1.1.cmml" xref="A1.E13.m1.1.1.1.1.1"><times id="A1.E13.m1.1.1.1.1.1.2.cmml" xref="A1.E13.m1.1.1.1.1.1.2"></times><apply id="A1.E13.m1.1.1.1.1.1.3.cmml" xref="A1.E13.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E13.m1.1.1.1.1.1.3.1.cmml" xref="A1.E13.m1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E13.m1.1.1.1.1.1.3.2.cmml" xref="A1.E13.m1.1.1.1.1.1.3.2">𝔼</ci><apply id="A1.E13.m1.1.1.1.1.1.3.3.cmml" xref="A1.E13.m1.1.1.1.1.1.3.3"><eq id="A1.E13.m1.1.1.1.1.1.3.3.1.cmml" xref="A1.E13.m1.1.1.1.1.1.3.3.1"></eq><apply id="A1.E13.m1.1.1.1.1.1.3.3.2.cmml" xref="A1.E13.m1.1.1.1.1.1.3.3.2"><csymbol cd="latexml" id="A1.E13.m1.1.1.1.1.1.3.3.2.1.cmml" xref="A1.E13.m1.1.1.1.1.1.3.3.2.1">conditional</csymbol><ci id="A1.E13.m1.1.1.1.1.1.3.3.2.2.cmml" xref="A1.E13.m1.1.1.1.1.1.3.3.2.2">𝑖</ci><apply id="A1.E13.m1.1.1.1.1.1.3.3.2.3.cmml" xref="A1.E13.m1.1.1.1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="A1.E13.m1.1.1.1.1.1.3.3.2.3.1.cmml" xref="A1.E13.m1.1.1.1.1.1.3.3.2.3">subscript</csymbol><ci id="A1.E13.m1.1.1.1.1.1.3.3.2.3.2.cmml" xref="A1.E13.m1.1.1.1.1.1.3.3.2.3.2">𝑦</ci><ci id="A1.E13.m1.1.1.1.1.1.3.3.2.3.3.cmml" xref="A1.E13.m1.1.1.1.1.1.3.3.2.3.3">𝑖</ci></apply></apply><ci id="A1.E13.m1.1.1.1.1.1.3.3.3.cmml" xref="A1.E13.m1.1.1.1.1.1.3.3.3">𝑦</ci></apply></apply><apply id="A1.E13.m1.1.1.1.1.1.1.2.cmml" xref="A1.E13.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E13.m1.1.1.1.1.1.1.2.1.cmml" xref="A1.E13.m1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A1.E13.m1.1.1.1.1.1.1.1.1.cmml" xref="A1.E13.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E13.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E13.m1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="A1.E13.m1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E13.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E13.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E13.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E13.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E13.m1.1.1.1.1.1.1.1.1.2.2">ℎ</ci><ci id="A1.E13.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.E13.m1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="A1.E13.m1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E13.m1.1.1.1.1.1.1.1.1.3">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E13.m1.1c">\bar{h}^{l}_{y}=\mathbb{E}_{i|y_{i}=y}\left[h_{i}^{l}\right].</annotation><annotation encoding="application/x-llamapun" id="A1.E13.m1.1d">over¯ start_ARG italic_h end_ARG start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT = blackboard_E start_POSTSUBSCRIPT italic_i | italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_y end_POSTSUBSCRIPT [ italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS3.p1.7">In the <span class="ltx_text ltx_font_bold" id="A1.SS3.p1.7.1">inference phase</span>, we extract the equitant<span class="ltx_note ltx_role_footnote" id="footnote9"><sup class="ltx_note_mark">9</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">9</sup><span class="ltx_tag ltx_tag_note">9</span>Equitant refers to hidden states from the same layer and token type. While, in experiments shown in Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S4.F5" title="Figure 5 ‣ 4.1 Step 2, Forerunner Token Head: Copy from Text Feature to Label Token ‣ 4 Induction Circuits in Natural Language Models ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">5</span></a> (Right), we don’t keep the token type consistent.</span></span></span> hidden state <math alttext="h_{t}^{l}" class="ltx_Math" display="inline" id="A1.SS3.p1.6.m1.1"><semantics id="A1.SS3.p1.6.m1.1a"><msubsup id="A1.SS3.p1.6.m1.1.1" xref="A1.SS3.p1.6.m1.1.1.cmml"><mi id="A1.SS3.p1.6.m1.1.1.2.2" xref="A1.SS3.p1.6.m1.1.1.2.2.cmml">h</mi><mi id="A1.SS3.p1.6.m1.1.1.2.3" xref="A1.SS3.p1.6.m1.1.1.2.3.cmml">t</mi><mi id="A1.SS3.p1.6.m1.1.1.3" xref="A1.SS3.p1.6.m1.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS3.p1.6.m1.1b"><apply id="A1.SS3.p1.6.m1.1.1.cmml" xref="A1.SS3.p1.6.m1.1.1"><csymbol cd="ambiguous" id="A1.SS3.p1.6.m1.1.1.1.cmml" xref="A1.SS3.p1.6.m1.1.1">superscript</csymbol><apply id="A1.SS3.p1.6.m1.1.1.2.cmml" xref="A1.SS3.p1.6.m1.1.1"><csymbol cd="ambiguous" id="A1.SS3.p1.6.m1.1.1.2.1.cmml" xref="A1.SS3.p1.6.m1.1.1">subscript</csymbol><ci id="A1.SS3.p1.6.m1.1.1.2.2.cmml" xref="A1.SS3.p1.6.m1.1.1.2.2">ℎ</ci><ci id="A1.SS3.p1.6.m1.1.1.2.3.cmml" xref="A1.SS3.p1.6.m1.1.1.2.3">𝑡</ci></apply><ci id="A1.SS3.p1.6.m1.1.1.3.cmml" xref="A1.SS3.p1.6.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p1.6.m1.1c">h_{t}^{l}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.p1.6.m1.1d">italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT</annotation></semantics></math> as the training phase from the test input, and calculate the similarity between <math alttext="h_{t}^{l}" class="ltx_Math" display="inline" id="A1.SS3.p1.7.m2.1"><semantics id="A1.SS3.p1.7.m2.1a"><msubsup id="A1.SS3.p1.7.m2.1.1" xref="A1.SS3.p1.7.m2.1.1.cmml"><mi id="A1.SS3.p1.7.m2.1.1.2.2" xref="A1.SS3.p1.7.m2.1.1.2.2.cmml">h</mi><mi id="A1.SS3.p1.7.m2.1.1.2.3" xref="A1.SS3.p1.7.m2.1.1.2.3.cmml">t</mi><mi id="A1.SS3.p1.7.m2.1.1.3" xref="A1.SS3.p1.7.m2.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS3.p1.7.m2.1b"><apply id="A1.SS3.p1.7.m2.1.1.cmml" xref="A1.SS3.p1.7.m2.1.1"><csymbol cd="ambiguous" id="A1.SS3.p1.7.m2.1.1.1.cmml" xref="A1.SS3.p1.7.m2.1.1">superscript</csymbol><apply id="A1.SS3.p1.7.m2.1.1.2.cmml" xref="A1.SS3.p1.7.m2.1.1"><csymbol cd="ambiguous" id="A1.SS3.p1.7.m2.1.1.2.1.cmml" xref="A1.SS3.p1.7.m2.1.1">subscript</csymbol><ci id="A1.SS3.p1.7.m2.1.1.2.2.cmml" xref="A1.SS3.p1.7.m2.1.1.2.2">ℎ</ci><ci id="A1.SS3.p1.7.m2.1.1.2.3.cmml" xref="A1.SS3.p1.7.m2.1.1.2.3">𝑡</ci></apply><ci id="A1.SS3.p1.7.m2.1.1.3.cmml" xref="A1.SS3.p1.7.m2.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p1.7.m2.1c">h_{t}^{l}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.p1.7.m2.1d">italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT</annotation></semantics></math> and the centroids calculated above. Then, we choose the label of the most similar centroids as the prediction:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="A1.E14">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{C}(h_{t}^{l})=\mathop{\mathrm{argmax}}\limits_{y}\left\langle h_{t}^{%
l},\bar{h}^{l}_{y}\right\rangle." class="ltx_Math" display="block" id="A1.E14.m1.1"><semantics id="A1.E14.m1.1a"><mrow id="A1.E14.m1.1.1.1" xref="A1.E14.m1.1.1.1.1.cmml"><mrow id="A1.E14.m1.1.1.1.1" xref="A1.E14.m1.1.1.1.1.cmml"><mrow id="A1.E14.m1.1.1.1.1.1" xref="A1.E14.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E14.m1.1.1.1.1.1.3" xref="A1.E14.m1.1.1.1.1.1.3.cmml">𝒞</mi><mo id="A1.E14.m1.1.1.1.1.1.2" xref="A1.E14.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E14.m1.1.1.1.1.1.1.1" xref="A1.E14.m1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E14.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E14.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="A1.E14.m1.1.1.1.1.1.1.1.1" xref="A1.E14.m1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E14.m1.1.1.1.1.1.1.1.1.2.2" xref="A1.E14.m1.1.1.1.1.1.1.1.1.2.2.cmml">h</mi><mi id="A1.E14.m1.1.1.1.1.1.1.1.1.2.3" xref="A1.E14.m1.1.1.1.1.1.1.1.1.2.3.cmml">t</mi><mi id="A1.E14.m1.1.1.1.1.1.1.1.1.3" xref="A1.E14.m1.1.1.1.1.1.1.1.1.3.cmml">l</mi></msubsup><mo id="A1.E14.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E14.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E14.m1.1.1.1.1.4" rspace="0.1389em" xref="A1.E14.m1.1.1.1.1.4.cmml">=</mo><mrow id="A1.E14.m1.1.1.1.1.3" xref="A1.E14.m1.1.1.1.1.3.cmml"><munder id="A1.E14.m1.1.1.1.1.3.3" xref="A1.E14.m1.1.1.1.1.3.3.cmml"><mo id="A1.E14.m1.1.1.1.1.3.3.2" lspace="0.1389em" movablelimits="false" rspace="0em" xref="A1.E14.m1.1.1.1.1.3.3.2.cmml">argmax</mo><mi id="A1.E14.m1.1.1.1.1.3.3.3" xref="A1.E14.m1.1.1.1.1.3.3.3.cmml">y</mi></munder><mrow id="A1.E14.m1.1.1.1.1.3.2.2" xref="A1.E14.m1.1.1.1.1.3.2.3.cmml"><mo id="A1.E14.m1.1.1.1.1.3.2.2.3" xref="A1.E14.m1.1.1.1.1.3.2.3.cmml">⟨</mo><msubsup id="A1.E14.m1.1.1.1.1.2.1.1.1" xref="A1.E14.m1.1.1.1.1.2.1.1.1.cmml"><mi id="A1.E14.m1.1.1.1.1.2.1.1.1.2.2" xref="A1.E14.m1.1.1.1.1.2.1.1.1.2.2.cmml">h</mi><mi id="A1.E14.m1.1.1.1.1.2.1.1.1.2.3" xref="A1.E14.m1.1.1.1.1.2.1.1.1.2.3.cmml">t</mi><mi id="A1.E14.m1.1.1.1.1.2.1.1.1.3" xref="A1.E14.m1.1.1.1.1.2.1.1.1.3.cmml">l</mi></msubsup><mo id="A1.E14.m1.1.1.1.1.3.2.2.4" xref="A1.E14.m1.1.1.1.1.3.2.3.cmml">,</mo><msubsup id="A1.E14.m1.1.1.1.1.3.2.2.2" xref="A1.E14.m1.1.1.1.1.3.2.2.2.cmml"><mover accent="true" id="A1.E14.m1.1.1.1.1.3.2.2.2.2.2" xref="A1.E14.m1.1.1.1.1.3.2.2.2.2.2.cmml"><mi id="A1.E14.m1.1.1.1.1.3.2.2.2.2.2.2" xref="A1.E14.m1.1.1.1.1.3.2.2.2.2.2.2.cmml">h</mi><mo id="A1.E14.m1.1.1.1.1.3.2.2.2.2.2.1" xref="A1.E14.m1.1.1.1.1.3.2.2.2.2.2.1.cmml">¯</mo></mover><mi id="A1.E14.m1.1.1.1.1.3.2.2.2.3" xref="A1.E14.m1.1.1.1.1.3.2.2.2.3.cmml">y</mi><mi id="A1.E14.m1.1.1.1.1.3.2.2.2.2.3" xref="A1.E14.m1.1.1.1.1.3.2.2.2.2.3.cmml">l</mi></msubsup><mo id="A1.E14.m1.1.1.1.1.3.2.2.5" xref="A1.E14.m1.1.1.1.1.3.2.3.cmml">⟩</mo></mrow></mrow></mrow><mo id="A1.E14.m1.1.1.1.2" lspace="0em" xref="A1.E14.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E14.m1.1b"><apply id="A1.E14.m1.1.1.1.1.cmml" xref="A1.E14.m1.1.1.1"><eq id="A1.E14.m1.1.1.1.1.4.cmml" xref="A1.E14.m1.1.1.1.1.4"></eq><apply id="A1.E14.m1.1.1.1.1.1.cmml" xref="A1.E14.m1.1.1.1.1.1"><times id="A1.E14.m1.1.1.1.1.1.2.cmml" xref="A1.E14.m1.1.1.1.1.1.2"></times><ci id="A1.E14.m1.1.1.1.1.1.3.cmml" xref="A1.E14.m1.1.1.1.1.1.3">𝒞</ci><apply id="A1.E14.m1.1.1.1.1.1.1.1.1.cmml" xref="A1.E14.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E14.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E14.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="A1.E14.m1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E14.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E14.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E14.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E14.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E14.m1.1.1.1.1.1.1.1.1.2.2">ℎ</ci><ci id="A1.E14.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.E14.m1.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="A1.E14.m1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E14.m1.1.1.1.1.1.1.1.1.3">𝑙</ci></apply></apply><apply id="A1.E14.m1.1.1.1.1.3.cmml" xref="A1.E14.m1.1.1.1.1.3"><apply id="A1.E14.m1.1.1.1.1.3.3.cmml" xref="A1.E14.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.E14.m1.1.1.1.1.3.3.1.cmml" xref="A1.E14.m1.1.1.1.1.3.3">subscript</csymbol><ci id="A1.E14.m1.1.1.1.1.3.3.2.cmml" xref="A1.E14.m1.1.1.1.1.3.3.2">argmax</ci><ci id="A1.E14.m1.1.1.1.1.3.3.3.cmml" xref="A1.E14.m1.1.1.1.1.3.3.3">𝑦</ci></apply><list id="A1.E14.m1.1.1.1.1.3.2.3.cmml" xref="A1.E14.m1.1.1.1.1.3.2.2"><apply id="A1.E14.m1.1.1.1.1.2.1.1.1.cmml" xref="A1.E14.m1.1.1.1.1.2.1.1.1"><csymbol cd="ambiguous" id="A1.E14.m1.1.1.1.1.2.1.1.1.1.cmml" xref="A1.E14.m1.1.1.1.1.2.1.1.1">superscript</csymbol><apply id="A1.E14.m1.1.1.1.1.2.1.1.1.2.cmml" xref="A1.E14.m1.1.1.1.1.2.1.1.1"><csymbol cd="ambiguous" id="A1.E14.m1.1.1.1.1.2.1.1.1.2.1.cmml" xref="A1.E14.m1.1.1.1.1.2.1.1.1">subscript</csymbol><ci id="A1.E14.m1.1.1.1.1.2.1.1.1.2.2.cmml" xref="A1.E14.m1.1.1.1.1.2.1.1.1.2.2">ℎ</ci><ci id="A1.E14.m1.1.1.1.1.2.1.1.1.2.3.cmml" xref="A1.E14.m1.1.1.1.1.2.1.1.1.2.3">𝑡</ci></apply><ci id="A1.E14.m1.1.1.1.1.2.1.1.1.3.cmml" xref="A1.E14.m1.1.1.1.1.2.1.1.1.3">𝑙</ci></apply><apply id="A1.E14.m1.1.1.1.1.3.2.2.2.cmml" xref="A1.E14.m1.1.1.1.1.3.2.2.2"><csymbol cd="ambiguous" id="A1.E14.m1.1.1.1.1.3.2.2.2.1.cmml" xref="A1.E14.m1.1.1.1.1.3.2.2.2">subscript</csymbol><apply id="A1.E14.m1.1.1.1.1.3.2.2.2.2.cmml" xref="A1.E14.m1.1.1.1.1.3.2.2.2"><csymbol cd="ambiguous" id="A1.E14.m1.1.1.1.1.3.2.2.2.2.1.cmml" xref="A1.E14.m1.1.1.1.1.3.2.2.2">superscript</csymbol><apply id="A1.E14.m1.1.1.1.1.3.2.2.2.2.2.cmml" xref="A1.E14.m1.1.1.1.1.3.2.2.2.2.2"><ci id="A1.E14.m1.1.1.1.1.3.2.2.2.2.2.1.cmml" xref="A1.E14.m1.1.1.1.1.3.2.2.2.2.2.1">¯</ci><ci id="A1.E14.m1.1.1.1.1.3.2.2.2.2.2.2.cmml" xref="A1.E14.m1.1.1.1.1.3.2.2.2.2.2.2">ℎ</ci></apply><ci id="A1.E14.m1.1.1.1.1.3.2.2.2.2.3.cmml" xref="A1.E14.m1.1.1.1.1.3.2.2.2.2.3">𝑙</ci></apply><ci id="A1.E14.m1.1.1.1.1.3.2.2.2.3.cmml" xref="A1.E14.m1.1.1.1.1.3.2.2.2.3">𝑦</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E14.m1.1c">\mathcal{C}(h_{t}^{l})=\mathop{\mathrm{argmax}}\limits_{y}\left\langle h_{t}^{%
l},\bar{h}^{l}_{y}\right\rangle.</annotation><annotation encoding="application/x-llamapun" id="A1.E14.m1.1d">caligraphic_C ( italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT ) = roman_argmax start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT ⟨ italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT , over¯ start_ARG italic_h end_ARG start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT ⟩ .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS3.p1.9"><span class="ltx_text ltx_font_bold" id="A1.SS3.p1.9.1">Implementation.</span> In our experiments, we set training sample number <math alttext="m\fallingdotseq 256" class="ltx_Math" display="inline" id="A1.SS3.p1.8.m1.1"><semantics id="A1.SS3.p1.8.m1.1a"><mrow id="A1.SS3.p1.8.m1.1.1" xref="A1.SS3.p1.8.m1.1.1.cmml"><mi id="A1.SS3.p1.8.m1.1.1.2" xref="A1.SS3.p1.8.m1.1.1.2.cmml">m</mi><mo id="A1.SS3.p1.8.m1.1.1.1" xref="A1.SS3.p1.8.m1.1.1.1.cmml">≒</mo><mn id="A1.SS3.p1.8.m1.1.1.3" xref="A1.SS3.p1.8.m1.1.1.3.cmml">256</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.p1.8.m1.1b"><apply id="A1.SS3.p1.8.m1.1.1.cmml" xref="A1.SS3.p1.8.m1.1.1"><csymbol cd="latexml" id="A1.SS3.p1.8.m1.1.1.1.cmml" xref="A1.SS3.p1.8.m1.1.1.1">approximately-equals-or-image-of</csymbol><ci id="A1.SS3.p1.8.m1.1.1.2.cmml" xref="A1.SS3.p1.8.m1.1.1.2">𝑚</ci><cn id="A1.SS3.p1.8.m1.1.1.3.cmml" type="integer" xref="A1.SS3.p1.8.m1.1.1.3">256</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p1.8.m1.1c">m\fallingdotseq 256</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.p1.8.m1.1d">italic_m ≒ 256</annotation></semantics></math>, similarity function <math alttext="\left\langle a,b\right\rangle=-\|a-b\|_{2}" class="ltx_Math" display="inline" id="A1.SS3.p1.9.m2.3"><semantics id="A1.SS3.p1.9.m2.3a"><mrow id="A1.SS3.p1.9.m2.3.3" xref="A1.SS3.p1.9.m2.3.3.cmml"><mrow id="A1.SS3.p1.9.m2.3.3.3.2" xref="A1.SS3.p1.9.m2.3.3.3.1.cmml"><mo id="A1.SS3.p1.9.m2.3.3.3.2.1" xref="A1.SS3.p1.9.m2.3.3.3.1.cmml">⟨</mo><mi id="A1.SS3.p1.9.m2.1.1" xref="A1.SS3.p1.9.m2.1.1.cmml">a</mi><mo id="A1.SS3.p1.9.m2.3.3.3.2.2" xref="A1.SS3.p1.9.m2.3.3.3.1.cmml">,</mo><mi id="A1.SS3.p1.9.m2.2.2" xref="A1.SS3.p1.9.m2.2.2.cmml">b</mi><mo id="A1.SS3.p1.9.m2.3.3.3.2.3" xref="A1.SS3.p1.9.m2.3.3.3.1.cmml">⟩</mo></mrow><mo id="A1.SS3.p1.9.m2.3.3.2" xref="A1.SS3.p1.9.m2.3.3.2.cmml">=</mo><mrow id="A1.SS3.p1.9.m2.3.3.1" xref="A1.SS3.p1.9.m2.3.3.1.cmml"><mo id="A1.SS3.p1.9.m2.3.3.1a" xref="A1.SS3.p1.9.m2.3.3.1.cmml">−</mo><msub id="A1.SS3.p1.9.m2.3.3.1.1" xref="A1.SS3.p1.9.m2.3.3.1.1.cmml"><mrow id="A1.SS3.p1.9.m2.3.3.1.1.1.1" xref="A1.SS3.p1.9.m2.3.3.1.1.1.2.cmml"><mo id="A1.SS3.p1.9.m2.3.3.1.1.1.1.2" stretchy="false" xref="A1.SS3.p1.9.m2.3.3.1.1.1.2.1.cmml">‖</mo><mrow id="A1.SS3.p1.9.m2.3.3.1.1.1.1.1" xref="A1.SS3.p1.9.m2.3.3.1.1.1.1.1.cmml"><mi id="A1.SS3.p1.9.m2.3.3.1.1.1.1.1.2" xref="A1.SS3.p1.9.m2.3.3.1.1.1.1.1.2.cmml">a</mi><mo id="A1.SS3.p1.9.m2.3.3.1.1.1.1.1.1" xref="A1.SS3.p1.9.m2.3.3.1.1.1.1.1.1.cmml">−</mo><mi id="A1.SS3.p1.9.m2.3.3.1.1.1.1.1.3" xref="A1.SS3.p1.9.m2.3.3.1.1.1.1.1.3.cmml">b</mi></mrow><mo id="A1.SS3.p1.9.m2.3.3.1.1.1.1.3" stretchy="false" xref="A1.SS3.p1.9.m2.3.3.1.1.1.2.1.cmml">‖</mo></mrow><mn id="A1.SS3.p1.9.m2.3.3.1.1.3" xref="A1.SS3.p1.9.m2.3.3.1.1.3.cmml">2</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.p1.9.m2.3b"><apply id="A1.SS3.p1.9.m2.3.3.cmml" xref="A1.SS3.p1.9.m2.3.3"><eq id="A1.SS3.p1.9.m2.3.3.2.cmml" xref="A1.SS3.p1.9.m2.3.3.2"></eq><list id="A1.SS3.p1.9.m2.3.3.3.1.cmml" xref="A1.SS3.p1.9.m2.3.3.3.2"><ci id="A1.SS3.p1.9.m2.1.1.cmml" xref="A1.SS3.p1.9.m2.1.1">𝑎</ci><ci id="A1.SS3.p1.9.m2.2.2.cmml" xref="A1.SS3.p1.9.m2.2.2">𝑏</ci></list><apply id="A1.SS3.p1.9.m2.3.3.1.cmml" xref="A1.SS3.p1.9.m2.3.3.1"><minus id="A1.SS3.p1.9.m2.3.3.1.2.cmml" xref="A1.SS3.p1.9.m2.3.3.1"></minus><apply id="A1.SS3.p1.9.m2.3.3.1.1.cmml" xref="A1.SS3.p1.9.m2.3.3.1.1"><csymbol cd="ambiguous" id="A1.SS3.p1.9.m2.3.3.1.1.2.cmml" xref="A1.SS3.p1.9.m2.3.3.1.1">subscript</csymbol><apply id="A1.SS3.p1.9.m2.3.3.1.1.1.2.cmml" xref="A1.SS3.p1.9.m2.3.3.1.1.1.1"><csymbol cd="latexml" id="A1.SS3.p1.9.m2.3.3.1.1.1.2.1.cmml" xref="A1.SS3.p1.9.m2.3.3.1.1.1.1.2">norm</csymbol><apply id="A1.SS3.p1.9.m2.3.3.1.1.1.1.1.cmml" xref="A1.SS3.p1.9.m2.3.3.1.1.1.1.1"><minus id="A1.SS3.p1.9.m2.3.3.1.1.1.1.1.1.cmml" xref="A1.SS3.p1.9.m2.3.3.1.1.1.1.1.1"></minus><ci id="A1.SS3.p1.9.m2.3.3.1.1.1.1.1.2.cmml" xref="A1.SS3.p1.9.m2.3.3.1.1.1.1.1.2">𝑎</ci><ci id="A1.SS3.p1.9.m2.3.3.1.1.1.1.1.3.cmml" xref="A1.SS3.p1.9.m2.3.3.1.1.1.1.1.3">𝑏</ci></apply></apply><cn id="A1.SS3.p1.9.m2.3.3.1.1.3.cmml" type="integer" xref="A1.SS3.p1.9.m2.3.3.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p1.9.m2.3c">\left\langle a,b\right\rangle=-\|a-b\|_{2}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.p1.9.m2.3d">⟨ italic_a , italic_b ⟩ = - ∥ italic_a - italic_b ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="A1.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.4 </span>Cartography Details of Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S4.F6" title="Figure 6 ‣ 4.2 Step 3, Induction Head: Feature Retrieval on Task Subspace ‣ 4 Induction Circuits in Natural Language Models ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">6</span></a> (Middle)</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A1.SS4.p1">
<p class="ltx_p" id="A1.SS4.p1.1">In Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S4.F6" title="Figure 6 ‣ 4.2 Step 3, Induction Head: Feature Retrieval on Task Subspace ‣ 4 Induction Circuits in Natural Language Models ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">6</span></a> (Middle), we define a Correct Label Assignment, here we introduce how this measurement is calculated. Suppose we have an attention score <math alttext="\mathcal{A}_{W,f}(K,Q)" class="ltx_Math" display="inline" id="A1.SS4.p1.1.m1.4"><semantics id="A1.SS4.p1.1.m1.4a"><mrow id="A1.SS4.p1.1.m1.4.5" xref="A1.SS4.p1.1.m1.4.5.cmml"><msub id="A1.SS4.p1.1.m1.4.5.2" xref="A1.SS4.p1.1.m1.4.5.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS4.p1.1.m1.4.5.2.2" xref="A1.SS4.p1.1.m1.4.5.2.2.cmml">𝒜</mi><mrow id="A1.SS4.p1.1.m1.2.2.2.4" xref="A1.SS4.p1.1.m1.2.2.2.3.cmml"><mi id="A1.SS4.p1.1.m1.1.1.1.1" xref="A1.SS4.p1.1.m1.1.1.1.1.cmml">W</mi><mo id="A1.SS4.p1.1.m1.2.2.2.4.1" xref="A1.SS4.p1.1.m1.2.2.2.3.cmml">,</mo><mi id="A1.SS4.p1.1.m1.2.2.2.2" xref="A1.SS4.p1.1.m1.2.2.2.2.cmml">f</mi></mrow></msub><mo id="A1.SS4.p1.1.m1.4.5.1" xref="A1.SS4.p1.1.m1.4.5.1.cmml">⁢</mo><mrow id="A1.SS4.p1.1.m1.4.5.3.2" xref="A1.SS4.p1.1.m1.4.5.3.1.cmml"><mo id="A1.SS4.p1.1.m1.4.5.3.2.1" stretchy="false" xref="A1.SS4.p1.1.m1.4.5.3.1.cmml">(</mo><mi id="A1.SS4.p1.1.m1.3.3" xref="A1.SS4.p1.1.m1.3.3.cmml">K</mi><mo id="A1.SS4.p1.1.m1.4.5.3.2.2" xref="A1.SS4.p1.1.m1.4.5.3.1.cmml">,</mo><mi id="A1.SS4.p1.1.m1.4.4" xref="A1.SS4.p1.1.m1.4.4.cmml">Q</mi><mo id="A1.SS4.p1.1.m1.4.5.3.2.3" stretchy="false" xref="A1.SS4.p1.1.m1.4.5.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS4.p1.1.m1.4b"><apply id="A1.SS4.p1.1.m1.4.5.cmml" xref="A1.SS4.p1.1.m1.4.5"><times id="A1.SS4.p1.1.m1.4.5.1.cmml" xref="A1.SS4.p1.1.m1.4.5.1"></times><apply id="A1.SS4.p1.1.m1.4.5.2.cmml" xref="A1.SS4.p1.1.m1.4.5.2"><csymbol cd="ambiguous" id="A1.SS4.p1.1.m1.4.5.2.1.cmml" xref="A1.SS4.p1.1.m1.4.5.2">subscript</csymbol><ci id="A1.SS4.p1.1.m1.4.5.2.2.cmml" xref="A1.SS4.p1.1.m1.4.5.2.2">𝒜</ci><list id="A1.SS4.p1.1.m1.2.2.2.3.cmml" xref="A1.SS4.p1.1.m1.2.2.2.4"><ci id="A1.SS4.p1.1.m1.1.1.1.1.cmml" xref="A1.SS4.p1.1.m1.1.1.1.1">𝑊</ci><ci id="A1.SS4.p1.1.m1.2.2.2.2.cmml" xref="A1.SS4.p1.1.m1.2.2.2.2">𝑓</ci></list></apply><interval closure="open" id="A1.SS4.p1.1.m1.4.5.3.1.cmml" xref="A1.SS4.p1.1.m1.4.5.3.2"><ci id="A1.SS4.p1.1.m1.3.3.cmml" xref="A1.SS4.p1.1.m1.3.3">𝐾</ci><ci id="A1.SS4.p1.1.m1.4.4.cmml" xref="A1.SS4.p1.1.m1.4.4">𝑄</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p1.1.m1.4c">\mathcal{A}_{W,f}(K,Q)</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p1.1.m1.4d">caligraphic_A start_POSTSUBSCRIPT italic_W , italic_f end_POSTSUBSCRIPT ( italic_K , italic_Q )</annotation></semantics></math> calculated as:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="A1.E15">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{A}_{W,f}\left(K,Q\right)=f\left(Q^{\top}WK\right)," class="ltx_Math" display="block" id="A1.E15.m1.5"><semantics id="A1.E15.m1.5a"><mrow id="A1.E15.m1.5.5.1" xref="A1.E15.m1.5.5.1.1.cmml"><mrow id="A1.E15.m1.5.5.1.1" xref="A1.E15.m1.5.5.1.1.cmml"><mrow id="A1.E15.m1.5.5.1.1.3" xref="A1.E15.m1.5.5.1.1.3.cmml"><msub id="A1.E15.m1.5.5.1.1.3.2" xref="A1.E15.m1.5.5.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E15.m1.5.5.1.1.3.2.2" xref="A1.E15.m1.5.5.1.1.3.2.2.cmml">𝒜</mi><mrow id="A1.E15.m1.2.2.2.4" xref="A1.E15.m1.2.2.2.3.cmml"><mi id="A1.E15.m1.1.1.1.1" xref="A1.E15.m1.1.1.1.1.cmml">W</mi><mo id="A1.E15.m1.2.2.2.4.1" xref="A1.E15.m1.2.2.2.3.cmml">,</mo><mi id="A1.E15.m1.2.2.2.2" xref="A1.E15.m1.2.2.2.2.cmml">f</mi></mrow></msub><mo id="A1.E15.m1.5.5.1.1.3.1" xref="A1.E15.m1.5.5.1.1.3.1.cmml">⁢</mo><mrow id="A1.E15.m1.5.5.1.1.3.3.2" xref="A1.E15.m1.5.5.1.1.3.3.1.cmml"><mo id="A1.E15.m1.5.5.1.1.3.3.2.1" xref="A1.E15.m1.5.5.1.1.3.3.1.cmml">(</mo><mi id="A1.E15.m1.3.3" xref="A1.E15.m1.3.3.cmml">K</mi><mo id="A1.E15.m1.5.5.1.1.3.3.2.2" xref="A1.E15.m1.5.5.1.1.3.3.1.cmml">,</mo><mi id="A1.E15.m1.4.4" xref="A1.E15.m1.4.4.cmml">Q</mi><mo id="A1.E15.m1.5.5.1.1.3.3.2.3" xref="A1.E15.m1.5.5.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo id="A1.E15.m1.5.5.1.1.2" xref="A1.E15.m1.5.5.1.1.2.cmml">=</mo><mrow id="A1.E15.m1.5.5.1.1.1" xref="A1.E15.m1.5.5.1.1.1.cmml"><mi id="A1.E15.m1.5.5.1.1.1.3" xref="A1.E15.m1.5.5.1.1.1.3.cmml">f</mi><mo id="A1.E15.m1.5.5.1.1.1.2" xref="A1.E15.m1.5.5.1.1.1.2.cmml">⁢</mo><mrow id="A1.E15.m1.5.5.1.1.1.1.1" xref="A1.E15.m1.5.5.1.1.1.1.1.1.cmml"><mo id="A1.E15.m1.5.5.1.1.1.1.1.2" xref="A1.E15.m1.5.5.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E15.m1.5.5.1.1.1.1.1.1" xref="A1.E15.m1.5.5.1.1.1.1.1.1.cmml"><msup id="A1.E15.m1.5.5.1.1.1.1.1.1.2" xref="A1.E15.m1.5.5.1.1.1.1.1.1.2.cmml"><mi id="A1.E15.m1.5.5.1.1.1.1.1.1.2.2" xref="A1.E15.m1.5.5.1.1.1.1.1.1.2.2.cmml">Q</mi><mo id="A1.E15.m1.5.5.1.1.1.1.1.1.2.3" xref="A1.E15.m1.5.5.1.1.1.1.1.1.2.3.cmml">⊤</mo></msup><mo id="A1.E15.m1.5.5.1.1.1.1.1.1.1" xref="A1.E15.m1.5.5.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="A1.E15.m1.5.5.1.1.1.1.1.1.3" xref="A1.E15.m1.5.5.1.1.1.1.1.1.3.cmml">W</mi><mo id="A1.E15.m1.5.5.1.1.1.1.1.1.1a" xref="A1.E15.m1.5.5.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="A1.E15.m1.5.5.1.1.1.1.1.1.4" xref="A1.E15.m1.5.5.1.1.1.1.1.1.4.cmml">K</mi></mrow><mo id="A1.E15.m1.5.5.1.1.1.1.1.3" xref="A1.E15.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E15.m1.5.5.1.2" xref="A1.E15.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E15.m1.5b"><apply id="A1.E15.m1.5.5.1.1.cmml" xref="A1.E15.m1.5.5.1"><eq id="A1.E15.m1.5.5.1.1.2.cmml" xref="A1.E15.m1.5.5.1.1.2"></eq><apply id="A1.E15.m1.5.5.1.1.3.cmml" xref="A1.E15.m1.5.5.1.1.3"><times id="A1.E15.m1.5.5.1.1.3.1.cmml" xref="A1.E15.m1.5.5.1.1.3.1"></times><apply id="A1.E15.m1.5.5.1.1.3.2.cmml" xref="A1.E15.m1.5.5.1.1.3.2"><csymbol cd="ambiguous" id="A1.E15.m1.5.5.1.1.3.2.1.cmml" xref="A1.E15.m1.5.5.1.1.3.2">subscript</csymbol><ci id="A1.E15.m1.5.5.1.1.3.2.2.cmml" xref="A1.E15.m1.5.5.1.1.3.2.2">𝒜</ci><list id="A1.E15.m1.2.2.2.3.cmml" xref="A1.E15.m1.2.2.2.4"><ci id="A1.E15.m1.1.1.1.1.cmml" xref="A1.E15.m1.1.1.1.1">𝑊</ci><ci id="A1.E15.m1.2.2.2.2.cmml" xref="A1.E15.m1.2.2.2.2">𝑓</ci></list></apply><interval closure="open" id="A1.E15.m1.5.5.1.1.3.3.1.cmml" xref="A1.E15.m1.5.5.1.1.3.3.2"><ci id="A1.E15.m1.3.3.cmml" xref="A1.E15.m1.3.3">𝐾</ci><ci id="A1.E15.m1.4.4.cmml" xref="A1.E15.m1.4.4">𝑄</ci></interval></apply><apply id="A1.E15.m1.5.5.1.1.1.cmml" xref="A1.E15.m1.5.5.1.1.1"><times id="A1.E15.m1.5.5.1.1.1.2.cmml" xref="A1.E15.m1.5.5.1.1.1.2"></times><ci id="A1.E15.m1.5.5.1.1.1.3.cmml" xref="A1.E15.m1.5.5.1.1.1.3">𝑓</ci><apply id="A1.E15.m1.5.5.1.1.1.1.1.1.cmml" xref="A1.E15.m1.5.5.1.1.1.1.1"><times id="A1.E15.m1.5.5.1.1.1.1.1.1.1.cmml" xref="A1.E15.m1.5.5.1.1.1.1.1.1.1"></times><apply id="A1.E15.m1.5.5.1.1.1.1.1.1.2.cmml" xref="A1.E15.m1.5.5.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E15.m1.5.5.1.1.1.1.1.1.2.1.cmml" xref="A1.E15.m1.5.5.1.1.1.1.1.1.2">superscript</csymbol><ci id="A1.E15.m1.5.5.1.1.1.1.1.1.2.2.cmml" xref="A1.E15.m1.5.5.1.1.1.1.1.1.2.2">𝑄</ci><csymbol cd="latexml" id="A1.E15.m1.5.5.1.1.1.1.1.1.2.3.cmml" xref="A1.E15.m1.5.5.1.1.1.1.1.1.2.3">top</csymbol></apply><ci id="A1.E15.m1.5.5.1.1.1.1.1.1.3.cmml" xref="A1.E15.m1.5.5.1.1.1.1.1.1.3">𝑊</ci><ci id="A1.E15.m1.5.5.1.1.1.1.1.1.4.cmml" xref="A1.E15.m1.5.5.1.1.1.1.1.1.4">𝐾</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E15.m1.5c">\mathcal{A}_{W,f}\left(K,Q\right)=f\left(Q^{\top}WK\right),</annotation><annotation encoding="application/x-llamapun" id="A1.E15.m1.5d">caligraphic_A start_POSTSUBSCRIPT italic_W , italic_f end_POSTSUBSCRIPT ( italic_K , italic_Q ) = italic_f ( italic_Q start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_W italic_K ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS4.p1.12">with hidden dimensionality of <math alttext="d" class="ltx_Math" display="inline" id="A1.SS4.p1.2.m1.1"><semantics id="A1.SS4.p1.2.m1.1a"><mi id="A1.SS4.p1.2.m1.1.1" xref="A1.SS4.p1.2.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="A1.SS4.p1.2.m1.1b"><ci id="A1.SS4.p1.2.m1.1.1.cmml" xref="A1.SS4.p1.2.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p1.2.m1.1c">d</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p1.2.m1.1d">italic_d</annotation></semantics></math>, give a certain layer, <math alttext="K\in\mathbb{R}^{d\times n_{t}}" class="ltx_Math" display="inline" id="A1.SS4.p1.3.m2.1"><semantics id="A1.SS4.p1.3.m2.1a"><mrow id="A1.SS4.p1.3.m2.1.1" xref="A1.SS4.p1.3.m2.1.1.cmml"><mi id="A1.SS4.p1.3.m2.1.1.2" xref="A1.SS4.p1.3.m2.1.1.2.cmml">K</mi><mo id="A1.SS4.p1.3.m2.1.1.1" xref="A1.SS4.p1.3.m2.1.1.1.cmml">∈</mo><msup id="A1.SS4.p1.3.m2.1.1.3" xref="A1.SS4.p1.3.m2.1.1.3.cmml"><mi id="A1.SS4.p1.3.m2.1.1.3.2" xref="A1.SS4.p1.3.m2.1.1.3.2.cmml">ℝ</mi><mrow id="A1.SS4.p1.3.m2.1.1.3.3" xref="A1.SS4.p1.3.m2.1.1.3.3.cmml"><mi id="A1.SS4.p1.3.m2.1.1.3.3.2" xref="A1.SS4.p1.3.m2.1.1.3.3.2.cmml">d</mi><mo id="A1.SS4.p1.3.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="A1.SS4.p1.3.m2.1.1.3.3.1.cmml">×</mo><msub id="A1.SS4.p1.3.m2.1.1.3.3.3" xref="A1.SS4.p1.3.m2.1.1.3.3.3.cmml"><mi id="A1.SS4.p1.3.m2.1.1.3.3.3.2" xref="A1.SS4.p1.3.m2.1.1.3.3.3.2.cmml">n</mi><mi id="A1.SS4.p1.3.m2.1.1.3.3.3.3" xref="A1.SS4.p1.3.m2.1.1.3.3.3.3.cmml">t</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS4.p1.3.m2.1b"><apply id="A1.SS4.p1.3.m2.1.1.cmml" xref="A1.SS4.p1.3.m2.1.1"><in id="A1.SS4.p1.3.m2.1.1.1.cmml" xref="A1.SS4.p1.3.m2.1.1.1"></in><ci id="A1.SS4.p1.3.m2.1.1.2.cmml" xref="A1.SS4.p1.3.m2.1.1.2">𝐾</ci><apply id="A1.SS4.p1.3.m2.1.1.3.cmml" xref="A1.SS4.p1.3.m2.1.1.3"><csymbol cd="ambiguous" id="A1.SS4.p1.3.m2.1.1.3.1.cmml" xref="A1.SS4.p1.3.m2.1.1.3">superscript</csymbol><ci id="A1.SS4.p1.3.m2.1.1.3.2.cmml" xref="A1.SS4.p1.3.m2.1.1.3.2">ℝ</ci><apply id="A1.SS4.p1.3.m2.1.1.3.3.cmml" xref="A1.SS4.p1.3.m2.1.1.3.3"><times id="A1.SS4.p1.3.m2.1.1.3.3.1.cmml" xref="A1.SS4.p1.3.m2.1.1.3.3.1"></times><ci id="A1.SS4.p1.3.m2.1.1.3.3.2.cmml" xref="A1.SS4.p1.3.m2.1.1.3.3.2">𝑑</ci><apply id="A1.SS4.p1.3.m2.1.1.3.3.3.cmml" xref="A1.SS4.p1.3.m2.1.1.3.3.3"><csymbol cd="ambiguous" id="A1.SS4.p1.3.m2.1.1.3.3.3.1.cmml" xref="A1.SS4.p1.3.m2.1.1.3.3.3">subscript</csymbol><ci id="A1.SS4.p1.3.m2.1.1.3.3.3.2.cmml" xref="A1.SS4.p1.3.m2.1.1.3.3.3.2">𝑛</ci><ci id="A1.SS4.p1.3.m2.1.1.3.3.3.3.cmml" xref="A1.SS4.p1.3.m2.1.1.3.3.3.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p1.3.m2.1c">K\in\mathbb{R}^{d\times n_{t}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p1.3.m2.1d">italic_K ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_n start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> is the hidden state matrix of full context, <math alttext="Q\in\mathbb{R}^{d\times 1}" class="ltx_Math" display="inline" id="A1.SS4.p1.4.m3.1"><semantics id="A1.SS4.p1.4.m3.1a"><mrow id="A1.SS4.p1.4.m3.1.1" xref="A1.SS4.p1.4.m3.1.1.cmml"><mi id="A1.SS4.p1.4.m3.1.1.2" xref="A1.SS4.p1.4.m3.1.1.2.cmml">Q</mi><mo id="A1.SS4.p1.4.m3.1.1.1" xref="A1.SS4.p1.4.m3.1.1.1.cmml">∈</mo><msup id="A1.SS4.p1.4.m3.1.1.3" xref="A1.SS4.p1.4.m3.1.1.3.cmml"><mi id="A1.SS4.p1.4.m3.1.1.3.2" xref="A1.SS4.p1.4.m3.1.1.3.2.cmml">ℝ</mi><mrow id="A1.SS4.p1.4.m3.1.1.3.3" xref="A1.SS4.p1.4.m3.1.1.3.3.cmml"><mi id="A1.SS4.p1.4.m3.1.1.3.3.2" xref="A1.SS4.p1.4.m3.1.1.3.3.2.cmml">d</mi><mo id="A1.SS4.p1.4.m3.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="A1.SS4.p1.4.m3.1.1.3.3.1.cmml">×</mo><mn id="A1.SS4.p1.4.m3.1.1.3.3.3" xref="A1.SS4.p1.4.m3.1.1.3.3.3.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS4.p1.4.m3.1b"><apply id="A1.SS4.p1.4.m3.1.1.cmml" xref="A1.SS4.p1.4.m3.1.1"><in id="A1.SS4.p1.4.m3.1.1.1.cmml" xref="A1.SS4.p1.4.m3.1.1.1"></in><ci id="A1.SS4.p1.4.m3.1.1.2.cmml" xref="A1.SS4.p1.4.m3.1.1.2">𝑄</ci><apply id="A1.SS4.p1.4.m3.1.1.3.cmml" xref="A1.SS4.p1.4.m3.1.1.3"><csymbol cd="ambiguous" id="A1.SS4.p1.4.m3.1.1.3.1.cmml" xref="A1.SS4.p1.4.m3.1.1.3">superscript</csymbol><ci id="A1.SS4.p1.4.m3.1.1.3.2.cmml" xref="A1.SS4.p1.4.m3.1.1.3.2">ℝ</ci><apply id="A1.SS4.p1.4.m3.1.1.3.3.cmml" xref="A1.SS4.p1.4.m3.1.1.3.3"><times id="A1.SS4.p1.4.m3.1.1.3.3.1.cmml" xref="A1.SS4.p1.4.m3.1.1.3.3.1"></times><ci id="A1.SS4.p1.4.m3.1.1.3.3.2.cmml" xref="A1.SS4.p1.4.m3.1.1.3.3.2">𝑑</ci><cn id="A1.SS4.p1.4.m3.1.1.3.3.3.cmml" type="integer" xref="A1.SS4.p1.4.m3.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p1.4.m3.1c">Q\in\mathbb{R}^{d\times 1}</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p1.4.m3.1d">italic_Q ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × 1 end_POSTSUPERSCRIPT</annotation></semantics></math> is the hidden state of query’s forerunner token (<math alttext="Q^{\top}=K^{\top}_{n_{t}}" class="ltx_Math" display="inline" id="A1.SS4.p1.5.m4.1"><semantics id="A1.SS4.p1.5.m4.1a"><mrow id="A1.SS4.p1.5.m4.1.1" xref="A1.SS4.p1.5.m4.1.1.cmml"><msup id="A1.SS4.p1.5.m4.1.1.2" xref="A1.SS4.p1.5.m4.1.1.2.cmml"><mi id="A1.SS4.p1.5.m4.1.1.2.2" xref="A1.SS4.p1.5.m4.1.1.2.2.cmml">Q</mi><mo id="A1.SS4.p1.5.m4.1.1.2.3" xref="A1.SS4.p1.5.m4.1.1.2.3.cmml">⊤</mo></msup><mo id="A1.SS4.p1.5.m4.1.1.1" xref="A1.SS4.p1.5.m4.1.1.1.cmml">=</mo><msubsup id="A1.SS4.p1.5.m4.1.1.3" xref="A1.SS4.p1.5.m4.1.1.3.cmml"><mi id="A1.SS4.p1.5.m4.1.1.3.2.2" xref="A1.SS4.p1.5.m4.1.1.3.2.2.cmml">K</mi><msub id="A1.SS4.p1.5.m4.1.1.3.3" xref="A1.SS4.p1.5.m4.1.1.3.3.cmml"><mi id="A1.SS4.p1.5.m4.1.1.3.3.2" xref="A1.SS4.p1.5.m4.1.1.3.3.2.cmml">n</mi><mi id="A1.SS4.p1.5.m4.1.1.3.3.3" xref="A1.SS4.p1.5.m4.1.1.3.3.3.cmml">t</mi></msub><mo id="A1.SS4.p1.5.m4.1.1.3.2.3" xref="A1.SS4.p1.5.m4.1.1.3.2.3.cmml">⊤</mo></msubsup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS4.p1.5.m4.1b"><apply id="A1.SS4.p1.5.m4.1.1.cmml" xref="A1.SS4.p1.5.m4.1.1"><eq id="A1.SS4.p1.5.m4.1.1.1.cmml" xref="A1.SS4.p1.5.m4.1.1.1"></eq><apply id="A1.SS4.p1.5.m4.1.1.2.cmml" xref="A1.SS4.p1.5.m4.1.1.2"><csymbol cd="ambiguous" id="A1.SS4.p1.5.m4.1.1.2.1.cmml" xref="A1.SS4.p1.5.m4.1.1.2">superscript</csymbol><ci id="A1.SS4.p1.5.m4.1.1.2.2.cmml" xref="A1.SS4.p1.5.m4.1.1.2.2">𝑄</ci><csymbol cd="latexml" id="A1.SS4.p1.5.m4.1.1.2.3.cmml" xref="A1.SS4.p1.5.m4.1.1.2.3">top</csymbol></apply><apply id="A1.SS4.p1.5.m4.1.1.3.cmml" xref="A1.SS4.p1.5.m4.1.1.3"><csymbol cd="ambiguous" id="A1.SS4.p1.5.m4.1.1.3.1.cmml" xref="A1.SS4.p1.5.m4.1.1.3">subscript</csymbol><apply id="A1.SS4.p1.5.m4.1.1.3.2.cmml" xref="A1.SS4.p1.5.m4.1.1.3"><csymbol cd="ambiguous" id="A1.SS4.p1.5.m4.1.1.3.2.1.cmml" xref="A1.SS4.p1.5.m4.1.1.3">superscript</csymbol><ci id="A1.SS4.p1.5.m4.1.1.3.2.2.cmml" xref="A1.SS4.p1.5.m4.1.1.3.2.2">𝐾</ci><csymbol cd="latexml" id="A1.SS4.p1.5.m4.1.1.3.2.3.cmml" xref="A1.SS4.p1.5.m4.1.1.3.2.3">top</csymbol></apply><apply id="A1.SS4.p1.5.m4.1.1.3.3.cmml" xref="A1.SS4.p1.5.m4.1.1.3.3"><csymbol cd="ambiguous" id="A1.SS4.p1.5.m4.1.1.3.3.1.cmml" xref="A1.SS4.p1.5.m4.1.1.3.3">subscript</csymbol><ci id="A1.SS4.p1.5.m4.1.1.3.3.2.cmml" xref="A1.SS4.p1.5.m4.1.1.3.3.2">𝑛</ci><ci id="A1.SS4.p1.5.m4.1.1.3.3.3.cmml" xref="A1.SS4.p1.5.m4.1.1.3.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p1.5.m4.1c">Q^{\top}=K^{\top}_{n_{t}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p1.5.m4.1d">italic_Q start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT = italic_K start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>), <math alttext="f:\mathbb{R}^{n_{t}}\rightarrow\Omega^{n_{t}}" class="ltx_Math" display="inline" id="A1.SS4.p1.6.m5.1"><semantics id="A1.SS4.p1.6.m5.1a"><mrow id="A1.SS4.p1.6.m5.1.1" xref="A1.SS4.p1.6.m5.1.1.cmml"><mi id="A1.SS4.p1.6.m5.1.1.2" xref="A1.SS4.p1.6.m5.1.1.2.cmml">f</mi><mo id="A1.SS4.p1.6.m5.1.1.1" lspace="0.278em" rspace="0.278em" xref="A1.SS4.p1.6.m5.1.1.1.cmml">:</mo><mrow id="A1.SS4.p1.6.m5.1.1.3" xref="A1.SS4.p1.6.m5.1.1.3.cmml"><msup id="A1.SS4.p1.6.m5.1.1.3.2" xref="A1.SS4.p1.6.m5.1.1.3.2.cmml"><mi id="A1.SS4.p1.6.m5.1.1.3.2.2" xref="A1.SS4.p1.6.m5.1.1.3.2.2.cmml">ℝ</mi><msub id="A1.SS4.p1.6.m5.1.1.3.2.3" xref="A1.SS4.p1.6.m5.1.1.3.2.3.cmml"><mi id="A1.SS4.p1.6.m5.1.1.3.2.3.2" xref="A1.SS4.p1.6.m5.1.1.3.2.3.2.cmml">n</mi><mi id="A1.SS4.p1.6.m5.1.1.3.2.3.3" xref="A1.SS4.p1.6.m5.1.1.3.2.3.3.cmml">t</mi></msub></msup><mo id="A1.SS4.p1.6.m5.1.1.3.1" stretchy="false" xref="A1.SS4.p1.6.m5.1.1.3.1.cmml">→</mo><msup id="A1.SS4.p1.6.m5.1.1.3.3" xref="A1.SS4.p1.6.m5.1.1.3.3.cmml"><mi id="A1.SS4.p1.6.m5.1.1.3.3.2" mathvariant="normal" xref="A1.SS4.p1.6.m5.1.1.3.3.2.cmml">Ω</mi><msub id="A1.SS4.p1.6.m5.1.1.3.3.3" xref="A1.SS4.p1.6.m5.1.1.3.3.3.cmml"><mi id="A1.SS4.p1.6.m5.1.1.3.3.3.2" xref="A1.SS4.p1.6.m5.1.1.3.3.3.2.cmml">n</mi><mi id="A1.SS4.p1.6.m5.1.1.3.3.3.3" xref="A1.SS4.p1.6.m5.1.1.3.3.3.3.cmml">t</mi></msub></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS4.p1.6.m5.1b"><apply id="A1.SS4.p1.6.m5.1.1.cmml" xref="A1.SS4.p1.6.m5.1.1"><ci id="A1.SS4.p1.6.m5.1.1.1.cmml" xref="A1.SS4.p1.6.m5.1.1.1">:</ci><ci id="A1.SS4.p1.6.m5.1.1.2.cmml" xref="A1.SS4.p1.6.m5.1.1.2">𝑓</ci><apply id="A1.SS4.p1.6.m5.1.1.3.cmml" xref="A1.SS4.p1.6.m5.1.1.3"><ci id="A1.SS4.p1.6.m5.1.1.3.1.cmml" xref="A1.SS4.p1.6.m5.1.1.3.1">→</ci><apply id="A1.SS4.p1.6.m5.1.1.3.2.cmml" xref="A1.SS4.p1.6.m5.1.1.3.2"><csymbol cd="ambiguous" id="A1.SS4.p1.6.m5.1.1.3.2.1.cmml" xref="A1.SS4.p1.6.m5.1.1.3.2">superscript</csymbol><ci id="A1.SS4.p1.6.m5.1.1.3.2.2.cmml" xref="A1.SS4.p1.6.m5.1.1.3.2.2">ℝ</ci><apply id="A1.SS4.p1.6.m5.1.1.3.2.3.cmml" xref="A1.SS4.p1.6.m5.1.1.3.2.3"><csymbol cd="ambiguous" id="A1.SS4.p1.6.m5.1.1.3.2.3.1.cmml" xref="A1.SS4.p1.6.m5.1.1.3.2.3">subscript</csymbol><ci id="A1.SS4.p1.6.m5.1.1.3.2.3.2.cmml" xref="A1.SS4.p1.6.m5.1.1.3.2.3.2">𝑛</ci><ci id="A1.SS4.p1.6.m5.1.1.3.2.3.3.cmml" xref="A1.SS4.p1.6.m5.1.1.3.2.3.3">𝑡</ci></apply></apply><apply id="A1.SS4.p1.6.m5.1.1.3.3.cmml" xref="A1.SS4.p1.6.m5.1.1.3.3"><csymbol cd="ambiguous" id="A1.SS4.p1.6.m5.1.1.3.3.1.cmml" xref="A1.SS4.p1.6.m5.1.1.3.3">superscript</csymbol><ci id="A1.SS4.p1.6.m5.1.1.3.3.2.cmml" xref="A1.SS4.p1.6.m5.1.1.3.3.2">Ω</ci><apply id="A1.SS4.p1.6.m5.1.1.3.3.3.cmml" xref="A1.SS4.p1.6.m5.1.1.3.3.3"><csymbol cd="ambiguous" id="A1.SS4.p1.6.m5.1.1.3.3.3.1.cmml" xref="A1.SS4.p1.6.m5.1.1.3.3.3">subscript</csymbol><ci id="A1.SS4.p1.6.m5.1.1.3.3.3.2.cmml" xref="A1.SS4.p1.6.m5.1.1.3.3.3.2">𝑛</ci><ci id="A1.SS4.p1.6.m5.1.1.3.3.3.3.cmml" xref="A1.SS4.p1.6.m5.1.1.3.3.3.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p1.6.m5.1c">f:\mathbb{R}^{n_{t}}\rightarrow\Omega^{n_{t}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p1.6.m5.1d">italic_f : blackboard_R start_POSTSUPERSCRIPT italic_n start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUPERSCRIPT → roman_Ω start_POSTSUPERSCRIPT italic_n start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> is a normalization mapping from <math alttext="n_{t}" class="ltx_Math" display="inline" id="A1.SS4.p1.7.m6.1"><semantics id="A1.SS4.p1.7.m6.1a"><msub id="A1.SS4.p1.7.m6.1.1" xref="A1.SS4.p1.7.m6.1.1.cmml"><mi id="A1.SS4.p1.7.m6.1.1.2" xref="A1.SS4.p1.7.m6.1.1.2.cmml">n</mi><mi id="A1.SS4.p1.7.m6.1.1.3" xref="A1.SS4.p1.7.m6.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS4.p1.7.m6.1b"><apply id="A1.SS4.p1.7.m6.1.1.cmml" xref="A1.SS4.p1.7.m6.1.1"><csymbol cd="ambiguous" id="A1.SS4.p1.7.m6.1.1.1.cmml" xref="A1.SS4.p1.7.m6.1.1">subscript</csymbol><ci id="A1.SS4.p1.7.m6.1.1.2.cmml" xref="A1.SS4.p1.7.m6.1.1.2">𝑛</ci><ci id="A1.SS4.p1.7.m6.1.1.3.cmml" xref="A1.SS4.p1.7.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p1.7.m6.1c">n_{t}</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p1.7.m6.1d">italic_n start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>-dimensional real vector to <math alttext="n_{t}" class="ltx_Math" display="inline" id="A1.SS4.p1.8.m7.1"><semantics id="A1.SS4.p1.8.m7.1a"><msub id="A1.SS4.p1.8.m7.1.1" xref="A1.SS4.p1.8.m7.1.1.cmml"><mi id="A1.SS4.p1.8.m7.1.1.2" xref="A1.SS4.p1.8.m7.1.1.2.cmml">n</mi><mi id="A1.SS4.p1.8.m7.1.1.3" xref="A1.SS4.p1.8.m7.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS4.p1.8.m7.1b"><apply id="A1.SS4.p1.8.m7.1.1.cmml" xref="A1.SS4.p1.8.m7.1.1"><csymbol cd="ambiguous" id="A1.SS4.p1.8.m7.1.1.1.cmml" xref="A1.SS4.p1.8.m7.1.1">subscript</csymbol><ci id="A1.SS4.p1.8.m7.1.1.2.cmml" xref="A1.SS4.p1.8.m7.1.1.2">𝑛</ci><ci id="A1.SS4.p1.8.m7.1.1.3.cmml" xref="A1.SS4.p1.8.m7.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p1.8.m7.1c">n_{t}</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p1.8.m7.1d">italic_n start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>-dimensional probability vector (usually <math alttext="\mathrm{softmax}" class="ltx_Math" display="inline" id="A1.SS4.p1.9.m8.1"><semantics id="A1.SS4.p1.9.m8.1a"><mi id="A1.SS4.p1.9.m8.1.1" xref="A1.SS4.p1.9.m8.1.1.cmml">softmax</mi><annotation-xml encoding="MathML-Content" id="A1.SS4.p1.9.m8.1b"><ci id="A1.SS4.p1.9.m8.1.1.cmml" xref="A1.SS4.p1.9.m8.1.1">softmax</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p1.9.m8.1c">\mathrm{softmax}</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p1.9.m8.1d">roman_softmax</annotation></semantics></math> function), the <math alttext="W" class="ltx_Math" display="inline" id="A1.SS4.p1.10.m9.1"><semantics id="A1.SS4.p1.10.m9.1a"><mi id="A1.SS4.p1.10.m9.1.1" xref="A1.SS4.p1.10.m9.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="A1.SS4.p1.10.m9.1b"><ci id="A1.SS4.p1.10.m9.1.1.cmml" xref="A1.SS4.p1.10.m9.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p1.10.m9.1c">W</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p1.10.m9.1d">italic_W</annotation></semantics></math> is a linear kernel, usually <math alttext="W_{Q}^{h\top}W_{K}^{h}" class="ltx_Math" display="inline" id="A1.SS4.p1.11.m10.1"><semantics id="A1.SS4.p1.11.m10.1a"><mrow id="A1.SS4.p1.11.m10.1.1" xref="A1.SS4.p1.11.m10.1.1.cmml"><msubsup id="A1.SS4.p1.11.m10.1.1.2" xref="A1.SS4.p1.11.m10.1.1.2.cmml"><mi id="A1.SS4.p1.11.m10.1.1.2.2.2" xref="A1.SS4.p1.11.m10.1.1.2.2.2.cmml">W</mi><mi id="A1.SS4.p1.11.m10.1.1.2.2.3" xref="A1.SS4.p1.11.m10.1.1.2.2.3.cmml">Q</mi><mrow id="A1.SS4.p1.11.m10.1.1.2.3" xref="A1.SS4.p1.11.m10.1.1.2.3.cmml"><mi id="A1.SS4.p1.11.m10.1.1.2.3.2" xref="A1.SS4.p1.11.m10.1.1.2.3.2.cmml">h</mi><mo id="A1.SS4.p1.11.m10.1.1.2.3.3" lspace="0.222em" xref="A1.SS4.p1.11.m10.1.1.2.3.3.cmml">⊤</mo></mrow></msubsup><mo id="A1.SS4.p1.11.m10.1.1.1" xref="A1.SS4.p1.11.m10.1.1.1.cmml">⁢</mo><msubsup id="A1.SS4.p1.11.m10.1.1.3" xref="A1.SS4.p1.11.m10.1.1.3.cmml"><mi id="A1.SS4.p1.11.m10.1.1.3.2.2" xref="A1.SS4.p1.11.m10.1.1.3.2.2.cmml">W</mi><mi id="A1.SS4.p1.11.m10.1.1.3.2.3" xref="A1.SS4.p1.11.m10.1.1.3.2.3.cmml">K</mi><mi id="A1.SS4.p1.11.m10.1.1.3.3" xref="A1.SS4.p1.11.m10.1.1.3.3.cmml">h</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS4.p1.11.m10.1b"><apply id="A1.SS4.p1.11.m10.1.1.cmml" xref="A1.SS4.p1.11.m10.1.1"><times id="A1.SS4.p1.11.m10.1.1.1.cmml" xref="A1.SS4.p1.11.m10.1.1.1"></times><apply id="A1.SS4.p1.11.m10.1.1.2.cmml" xref="A1.SS4.p1.11.m10.1.1.2"><csymbol cd="ambiguous" id="A1.SS4.p1.11.m10.1.1.2.1.cmml" xref="A1.SS4.p1.11.m10.1.1.2">superscript</csymbol><apply id="A1.SS4.p1.11.m10.1.1.2.2.cmml" xref="A1.SS4.p1.11.m10.1.1.2"><csymbol cd="ambiguous" id="A1.SS4.p1.11.m10.1.1.2.2.1.cmml" xref="A1.SS4.p1.11.m10.1.1.2">subscript</csymbol><ci id="A1.SS4.p1.11.m10.1.1.2.2.2.cmml" xref="A1.SS4.p1.11.m10.1.1.2.2.2">𝑊</ci><ci id="A1.SS4.p1.11.m10.1.1.2.2.3.cmml" xref="A1.SS4.p1.11.m10.1.1.2.2.3">𝑄</ci></apply><apply id="A1.SS4.p1.11.m10.1.1.2.3.cmml" xref="A1.SS4.p1.11.m10.1.1.2.3"><csymbol cd="latexml" id="A1.SS4.p1.11.m10.1.1.2.3.1.cmml" xref="A1.SS4.p1.11.m10.1.1.2.3">limit-from</csymbol><ci id="A1.SS4.p1.11.m10.1.1.2.3.2.cmml" xref="A1.SS4.p1.11.m10.1.1.2.3.2">ℎ</ci><csymbol cd="latexml" id="A1.SS4.p1.11.m10.1.1.2.3.3.cmml" xref="A1.SS4.p1.11.m10.1.1.2.3.3">top</csymbol></apply></apply><apply id="A1.SS4.p1.11.m10.1.1.3.cmml" xref="A1.SS4.p1.11.m10.1.1.3"><csymbol cd="ambiguous" id="A1.SS4.p1.11.m10.1.1.3.1.cmml" xref="A1.SS4.p1.11.m10.1.1.3">superscript</csymbol><apply id="A1.SS4.p1.11.m10.1.1.3.2.cmml" xref="A1.SS4.p1.11.m10.1.1.3"><csymbol cd="ambiguous" id="A1.SS4.p1.11.m10.1.1.3.2.1.cmml" xref="A1.SS4.p1.11.m10.1.1.3">subscript</csymbol><ci id="A1.SS4.p1.11.m10.1.1.3.2.2.cmml" xref="A1.SS4.p1.11.m10.1.1.3.2.2">𝑊</ci><ci id="A1.SS4.p1.11.m10.1.1.3.2.3.cmml" xref="A1.SS4.p1.11.m10.1.1.3.2.3">𝐾</ci></apply><ci id="A1.SS4.p1.11.m10.1.1.3.3.cmml" xref="A1.SS4.p1.11.m10.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p1.11.m10.1c">W_{Q}^{h\top}W_{K}^{h}</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p1.11.m10.1d">italic_W start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_h ⊤ end_POSTSUPERSCRIPT italic_W start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_h end_POSTSUPERSCRIPT</annotation></semantics></math> for multi-head attention or <math alttext="\mathrm{I}=\mathrm{diag\left(\mathbbold{1}^{n_{t}}\right)}" class="ltx_Math" display="inline" id="A1.SS4.p1.12.m11.1"><semantics id="A1.SS4.p1.12.m11.1a"><mrow id="A1.SS4.p1.12.m11.1.1" xref="A1.SS4.p1.12.m11.1.1.cmml"><mi id="A1.SS4.p1.12.m11.1.1.3" mathvariant="normal" xref="A1.SS4.p1.12.m11.1.1.3.cmml">I</mi><mo id="A1.SS4.p1.12.m11.1.1.2" xref="A1.SS4.p1.12.m11.1.1.2.cmml">=</mo><mrow id="A1.SS4.p1.12.m11.1.1.1" xref="A1.SS4.p1.12.m11.1.1.1.cmml"><mi id="A1.SS4.p1.12.m11.1.1.1.3" xref="A1.SS4.p1.12.m11.1.1.1.3.cmml">diag</mi><mo id="A1.SS4.p1.12.m11.1.1.1.2" xref="A1.SS4.p1.12.m11.1.1.1.2.cmml">⁢</mo><mrow id="A1.SS4.p1.12.m11.1.1.1.1.1" xref="A1.SS4.p1.12.m11.1.1.1.1.1.1.cmml"><mo id="A1.SS4.p1.12.m11.1.1.1.1.1.2" xref="A1.SS4.p1.12.m11.1.1.1.1.1.1.cmml">(</mo><msup id="A1.SS4.p1.12.m11.1.1.1.1.1.1" xref="A1.SS4.p1.12.m11.1.1.1.1.1.1.cmml"><mn id="A1.SS4.p1.12.m11.1.1.1.1.1.1.2" xref="A1.SS4.p1.12.m11.1.1.1.1.1.1.2.cmml">𝟙</mn><msub id="A1.SS4.p1.12.m11.1.1.1.1.1.1.3" xref="A1.SS4.p1.12.m11.1.1.1.1.1.1.3.cmml"><mi id="A1.SS4.p1.12.m11.1.1.1.1.1.1.3.2" xref="A1.SS4.p1.12.m11.1.1.1.1.1.1.3.2.cmml">𝕟</mi><mi id="A1.SS4.p1.12.m11.1.1.1.1.1.1.3.3" xref="A1.SS4.p1.12.m11.1.1.1.1.1.1.3.3.cmml">𝕥</mi></msub></msup><mo id="A1.SS4.p1.12.m11.1.1.1.1.1.3" xref="A1.SS4.p1.12.m11.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS4.p1.12.m11.1b"><apply id="A1.SS4.p1.12.m11.1.1.cmml" xref="A1.SS4.p1.12.m11.1.1"><eq id="A1.SS4.p1.12.m11.1.1.2.cmml" xref="A1.SS4.p1.12.m11.1.1.2"></eq><ci id="A1.SS4.p1.12.m11.1.1.3.cmml" xref="A1.SS4.p1.12.m11.1.1.3">I</ci><apply id="A1.SS4.p1.12.m11.1.1.1.cmml" xref="A1.SS4.p1.12.m11.1.1.1"><times id="A1.SS4.p1.12.m11.1.1.1.2.cmml" xref="A1.SS4.p1.12.m11.1.1.1.2"></times><ci id="A1.SS4.p1.12.m11.1.1.1.3.cmml" xref="A1.SS4.p1.12.m11.1.1.1.3">diag</ci><apply id="A1.SS4.p1.12.m11.1.1.1.1.1.1.cmml" xref="A1.SS4.p1.12.m11.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS4.p1.12.m11.1.1.1.1.1.1.1.cmml" xref="A1.SS4.p1.12.m11.1.1.1.1.1">superscript</csymbol><cn id="A1.SS4.p1.12.m11.1.1.1.1.1.1.2.cmml" type="integer" xref="A1.SS4.p1.12.m11.1.1.1.1.1.1.2">1</cn><apply id="A1.SS4.p1.12.m11.1.1.1.1.1.1.3.cmml" xref="A1.SS4.p1.12.m11.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.SS4.p1.12.m11.1.1.1.1.1.1.3.1.cmml" xref="A1.SS4.p1.12.m11.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.SS4.p1.12.m11.1.1.1.1.1.1.3.2.cmml" xref="A1.SS4.p1.12.m11.1.1.1.1.1.1.3.2">𝕟</ci><ci id="A1.SS4.p1.12.m11.1.1.1.1.1.1.3.3.cmml" xref="A1.SS4.p1.12.m11.1.1.1.1.1.1.3.3">𝕥</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p1.12.m11.1c">\mathrm{I}=\mathrm{diag\left(\mathbbold{1}^{n_{t}}\right)}</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p1.12.m11.1d">roman_I = roman_diag ( blackboard_1 start_POSTSUPERSCRIPT blackboard_n start_POSTSUBSCRIPT blackboard_t end_POSTSUBSCRIPT end_POSTSUPERSCRIPT )</annotation></semantics></math> for vanilla attention.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS4.p2">
<p class="ltx_p" id="A1.SS4.p2.2">For one input sample, given the token-index set of label tokens as <math alttext="\mathcal{L}" class="ltx_Math" display="inline" id="A1.SS4.p2.1.m1.1"><semantics id="A1.SS4.p2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="A1.SS4.p2.1.m1.1.1" xref="A1.SS4.p2.1.m1.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="A1.SS4.p2.1.m1.1b"><ci id="A1.SS4.p2.1.m1.1.1.cmml" xref="A1.SS4.p2.1.m1.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p2.1.m1.1c">\mathcal{L}</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p2.1.m1.1d">caligraphic_L</annotation></semantics></math>, the token-index set of label tokens which is the same as the query’s ground truth label as <math alttext="\mathcal{L}^{+}" class="ltx_Math" display="inline" id="A1.SS4.p2.2.m2.1"><semantics id="A1.SS4.p2.2.m2.1a"><msup id="A1.SS4.p2.2.m2.1.1" xref="A1.SS4.p2.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS4.p2.2.m2.1.1.2" xref="A1.SS4.p2.2.m2.1.1.2.cmml">ℒ</mi><mo id="A1.SS4.p2.2.m2.1.1.3" xref="A1.SS4.p2.2.m2.1.1.3.cmml">+</mo></msup><annotation-xml encoding="MathML-Content" id="A1.SS4.p2.2.m2.1b"><apply id="A1.SS4.p2.2.m2.1.1.cmml" xref="A1.SS4.p2.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS4.p2.2.m2.1.1.1.cmml" xref="A1.SS4.p2.2.m2.1.1">superscript</csymbol><ci id="A1.SS4.p2.2.m2.1.1.2.cmml" xref="A1.SS4.p2.2.m2.1.1.2">ℒ</ci><plus id="A1.SS4.p2.2.m2.1.1.3.cmml" xref="A1.SS4.p2.2.m2.1.1.3"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p2.2.m2.1c">\mathcal{L}^{+}</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p2.2.m2.1d">caligraphic_L start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT</annotation></semantics></math>, we define the <span class="ltx_text ltx_font_bold" id="A1.SS4.p2.2.1">C</span>orrect <span class="ltx_text ltx_font_bold" id="A1.SS4.p2.2.2">L</span>abel <span class="ltx_text ltx_font_bold" id="A1.SS4.p2.2.3">A</span>ssignment (CLA) of one sample as:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="A1.E16">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathrm{CLA}_{W,f}(K,Q,\mathcal{L},\mathcal{L}^{+})=\frac{\sum_{i\in\mathcal{L%
}^{+}}\mathcal{A}_{W,f}\left(K,Q\right)_{i}}{\sum_{i\in\mathcal{L}}\mathcal{A}%
_{W,f}\left(K,Q\right)_{i}}." class="ltx_Math" display="block" id="A1.E16.m1.14"><semantics id="A1.E16.m1.14a"><mrow id="A1.E16.m1.14.14.1" xref="A1.E16.m1.14.14.1.1.cmml"><mrow id="A1.E16.m1.14.14.1.1" xref="A1.E16.m1.14.14.1.1.cmml"><mrow id="A1.E16.m1.14.14.1.1.1" xref="A1.E16.m1.14.14.1.1.1.cmml"><msub id="A1.E16.m1.14.14.1.1.1.3" xref="A1.E16.m1.14.14.1.1.1.3.cmml"><mi id="A1.E16.m1.14.14.1.1.1.3.2" xref="A1.E16.m1.14.14.1.1.1.3.2.cmml">CLA</mi><mrow id="A1.E16.m1.2.2.2.4" xref="A1.E16.m1.2.2.2.3.cmml"><mi id="A1.E16.m1.1.1.1.1" xref="A1.E16.m1.1.1.1.1.cmml">W</mi><mo id="A1.E16.m1.2.2.2.4.1" xref="A1.E16.m1.2.2.2.3.cmml">,</mo><mi id="A1.E16.m1.2.2.2.2" xref="A1.E16.m1.2.2.2.2.cmml">f</mi></mrow></msub><mo id="A1.E16.m1.14.14.1.1.1.2" xref="A1.E16.m1.14.14.1.1.1.2.cmml">⁢</mo><mrow id="A1.E16.m1.14.14.1.1.1.1.1" xref="A1.E16.m1.14.14.1.1.1.1.2.cmml"><mo id="A1.E16.m1.14.14.1.1.1.1.1.2" stretchy="false" xref="A1.E16.m1.14.14.1.1.1.1.2.cmml">(</mo><mi id="A1.E16.m1.11.11" xref="A1.E16.m1.11.11.cmml">K</mi><mo id="A1.E16.m1.14.14.1.1.1.1.1.3" xref="A1.E16.m1.14.14.1.1.1.1.2.cmml">,</mo><mi id="A1.E16.m1.12.12" xref="A1.E16.m1.12.12.cmml">Q</mi><mo id="A1.E16.m1.14.14.1.1.1.1.1.4" xref="A1.E16.m1.14.14.1.1.1.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="A1.E16.m1.13.13" xref="A1.E16.m1.13.13.cmml">ℒ</mi><mo id="A1.E16.m1.14.14.1.1.1.1.1.5" xref="A1.E16.m1.14.14.1.1.1.1.2.cmml">,</mo><msup id="A1.E16.m1.14.14.1.1.1.1.1.1" xref="A1.E16.m1.14.14.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E16.m1.14.14.1.1.1.1.1.1.2" xref="A1.E16.m1.14.14.1.1.1.1.1.1.2.cmml">ℒ</mi><mo id="A1.E16.m1.14.14.1.1.1.1.1.1.3" xref="A1.E16.m1.14.14.1.1.1.1.1.1.3.cmml">+</mo></msup><mo id="A1.E16.m1.14.14.1.1.1.1.1.6" stretchy="false" xref="A1.E16.m1.14.14.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.E16.m1.14.14.1.1.2" xref="A1.E16.m1.14.14.1.1.2.cmml">=</mo><mfrac id="A1.E16.m1.10.10" xref="A1.E16.m1.10.10.cmml"><mrow id="A1.E16.m1.6.6.4" xref="A1.E16.m1.6.6.4.cmml"><msub id="A1.E16.m1.6.6.4.5" xref="A1.E16.m1.6.6.4.5.cmml"><mo id="A1.E16.m1.6.6.4.5.2" xref="A1.E16.m1.6.6.4.5.2.cmml">∑</mo><mrow id="A1.E16.m1.6.6.4.5.3" xref="A1.E16.m1.6.6.4.5.3.cmml"><mi id="A1.E16.m1.6.6.4.5.3.2" xref="A1.E16.m1.6.6.4.5.3.2.cmml">i</mi><mo id="A1.E16.m1.6.6.4.5.3.1" xref="A1.E16.m1.6.6.4.5.3.1.cmml">∈</mo><msup id="A1.E16.m1.6.6.4.5.3.3" xref="A1.E16.m1.6.6.4.5.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E16.m1.6.6.4.5.3.3.2" xref="A1.E16.m1.6.6.4.5.3.3.2.cmml">ℒ</mi><mo id="A1.E16.m1.6.6.4.5.3.3.3" xref="A1.E16.m1.6.6.4.5.3.3.3.cmml">+</mo></msup></mrow></msub><mrow id="A1.E16.m1.6.6.4.6" xref="A1.E16.m1.6.6.4.6.cmml"><msub id="A1.E16.m1.6.6.4.6.2" xref="A1.E16.m1.6.6.4.6.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E16.m1.6.6.4.6.2.2" xref="A1.E16.m1.6.6.4.6.2.2.cmml">𝒜</mi><mrow id="A1.E16.m1.4.4.2.2.2.4" xref="A1.E16.m1.4.4.2.2.2.3.cmml"><mi id="A1.E16.m1.3.3.1.1.1.1" xref="A1.E16.m1.3.3.1.1.1.1.cmml">W</mi><mo id="A1.E16.m1.4.4.2.2.2.4.1" xref="A1.E16.m1.4.4.2.2.2.3.cmml">,</mo><mi id="A1.E16.m1.4.4.2.2.2.2" xref="A1.E16.m1.4.4.2.2.2.2.cmml">f</mi></mrow></msub><mo id="A1.E16.m1.6.6.4.6.1" xref="A1.E16.m1.6.6.4.6.1.cmml">⁢</mo><msub id="A1.E16.m1.6.6.4.6.3" xref="A1.E16.m1.6.6.4.6.3.cmml"><mrow id="A1.E16.m1.6.6.4.6.3.2.2" xref="A1.E16.m1.6.6.4.6.3.2.1.cmml"><mo id="A1.E16.m1.6.6.4.6.3.2.2.1" xref="A1.E16.m1.6.6.4.6.3.2.1.cmml">(</mo><mi id="A1.E16.m1.5.5.3.3" xref="A1.E16.m1.5.5.3.3.cmml">K</mi><mo id="A1.E16.m1.6.6.4.6.3.2.2.2" xref="A1.E16.m1.6.6.4.6.3.2.1.cmml">,</mo><mi id="A1.E16.m1.6.6.4.4" xref="A1.E16.m1.6.6.4.4.cmml">Q</mi><mo id="A1.E16.m1.6.6.4.6.3.2.2.3" xref="A1.E16.m1.6.6.4.6.3.2.1.cmml">)</mo></mrow><mi id="A1.E16.m1.6.6.4.6.3.3" xref="A1.E16.m1.6.6.4.6.3.3.cmml">i</mi></msub></mrow></mrow><mrow id="A1.E16.m1.10.10.8" xref="A1.E16.m1.10.10.8.cmml"><msub id="A1.E16.m1.10.10.8.5" xref="A1.E16.m1.10.10.8.5.cmml"><mo id="A1.E16.m1.10.10.8.5.2" xref="A1.E16.m1.10.10.8.5.2.cmml">∑</mo><mrow id="A1.E16.m1.10.10.8.5.3" xref="A1.E16.m1.10.10.8.5.3.cmml"><mi id="A1.E16.m1.10.10.8.5.3.2" xref="A1.E16.m1.10.10.8.5.3.2.cmml">i</mi><mo id="A1.E16.m1.10.10.8.5.3.1" xref="A1.E16.m1.10.10.8.5.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="A1.E16.m1.10.10.8.5.3.3" xref="A1.E16.m1.10.10.8.5.3.3.cmml">ℒ</mi></mrow></msub><mrow id="A1.E16.m1.10.10.8.6" xref="A1.E16.m1.10.10.8.6.cmml"><msub id="A1.E16.m1.10.10.8.6.2" xref="A1.E16.m1.10.10.8.6.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E16.m1.10.10.8.6.2.2" xref="A1.E16.m1.10.10.8.6.2.2.cmml">𝒜</mi><mrow id="A1.E16.m1.8.8.6.2.2.4" xref="A1.E16.m1.8.8.6.2.2.3.cmml"><mi id="A1.E16.m1.7.7.5.1.1.1" xref="A1.E16.m1.7.7.5.1.1.1.cmml">W</mi><mo id="A1.E16.m1.8.8.6.2.2.4.1" xref="A1.E16.m1.8.8.6.2.2.3.cmml">,</mo><mi id="A1.E16.m1.8.8.6.2.2.2" xref="A1.E16.m1.8.8.6.2.2.2.cmml">f</mi></mrow></msub><mo id="A1.E16.m1.10.10.8.6.1" xref="A1.E16.m1.10.10.8.6.1.cmml">⁢</mo><msub id="A1.E16.m1.10.10.8.6.3" xref="A1.E16.m1.10.10.8.6.3.cmml"><mrow id="A1.E16.m1.10.10.8.6.3.2.2" xref="A1.E16.m1.10.10.8.6.3.2.1.cmml"><mo id="A1.E16.m1.10.10.8.6.3.2.2.1" xref="A1.E16.m1.10.10.8.6.3.2.1.cmml">(</mo><mi id="A1.E16.m1.9.9.7.3" xref="A1.E16.m1.9.9.7.3.cmml">K</mi><mo id="A1.E16.m1.10.10.8.6.3.2.2.2" xref="A1.E16.m1.10.10.8.6.3.2.1.cmml">,</mo><mi id="A1.E16.m1.10.10.8.4" xref="A1.E16.m1.10.10.8.4.cmml">Q</mi><mo id="A1.E16.m1.10.10.8.6.3.2.2.3" xref="A1.E16.m1.10.10.8.6.3.2.1.cmml">)</mo></mrow><mi id="A1.E16.m1.10.10.8.6.3.3" xref="A1.E16.m1.10.10.8.6.3.3.cmml">i</mi></msub></mrow></mrow></mfrac></mrow><mo id="A1.E16.m1.14.14.1.2" lspace="0em" xref="A1.E16.m1.14.14.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E16.m1.14b"><apply id="A1.E16.m1.14.14.1.1.cmml" xref="A1.E16.m1.14.14.1"><eq id="A1.E16.m1.14.14.1.1.2.cmml" xref="A1.E16.m1.14.14.1.1.2"></eq><apply id="A1.E16.m1.14.14.1.1.1.cmml" xref="A1.E16.m1.14.14.1.1.1"><times id="A1.E16.m1.14.14.1.1.1.2.cmml" xref="A1.E16.m1.14.14.1.1.1.2"></times><apply id="A1.E16.m1.14.14.1.1.1.3.cmml" xref="A1.E16.m1.14.14.1.1.1.3"><csymbol cd="ambiguous" id="A1.E16.m1.14.14.1.1.1.3.1.cmml" xref="A1.E16.m1.14.14.1.1.1.3">subscript</csymbol><ci id="A1.E16.m1.14.14.1.1.1.3.2.cmml" xref="A1.E16.m1.14.14.1.1.1.3.2">CLA</ci><list id="A1.E16.m1.2.2.2.3.cmml" xref="A1.E16.m1.2.2.2.4"><ci id="A1.E16.m1.1.1.1.1.cmml" xref="A1.E16.m1.1.1.1.1">𝑊</ci><ci id="A1.E16.m1.2.2.2.2.cmml" xref="A1.E16.m1.2.2.2.2">𝑓</ci></list></apply><vector id="A1.E16.m1.14.14.1.1.1.1.2.cmml" xref="A1.E16.m1.14.14.1.1.1.1.1"><ci id="A1.E16.m1.11.11.cmml" xref="A1.E16.m1.11.11">𝐾</ci><ci id="A1.E16.m1.12.12.cmml" xref="A1.E16.m1.12.12">𝑄</ci><ci id="A1.E16.m1.13.13.cmml" xref="A1.E16.m1.13.13">ℒ</ci><apply id="A1.E16.m1.14.14.1.1.1.1.1.1.cmml" xref="A1.E16.m1.14.14.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E16.m1.14.14.1.1.1.1.1.1.1.cmml" xref="A1.E16.m1.14.14.1.1.1.1.1.1">superscript</csymbol><ci id="A1.E16.m1.14.14.1.1.1.1.1.1.2.cmml" xref="A1.E16.m1.14.14.1.1.1.1.1.1.2">ℒ</ci><plus id="A1.E16.m1.14.14.1.1.1.1.1.1.3.cmml" xref="A1.E16.m1.14.14.1.1.1.1.1.1.3"></plus></apply></vector></apply><apply id="A1.E16.m1.10.10.cmml" xref="A1.E16.m1.10.10"><divide id="A1.E16.m1.10.10.9.cmml" xref="A1.E16.m1.10.10"></divide><apply id="A1.E16.m1.6.6.4.cmml" xref="A1.E16.m1.6.6.4"><apply id="A1.E16.m1.6.6.4.5.cmml" xref="A1.E16.m1.6.6.4.5"><csymbol cd="ambiguous" id="A1.E16.m1.6.6.4.5.1.cmml" xref="A1.E16.m1.6.6.4.5">subscript</csymbol><sum id="A1.E16.m1.6.6.4.5.2.cmml" xref="A1.E16.m1.6.6.4.5.2"></sum><apply id="A1.E16.m1.6.6.4.5.3.cmml" xref="A1.E16.m1.6.6.4.5.3"><in id="A1.E16.m1.6.6.4.5.3.1.cmml" xref="A1.E16.m1.6.6.4.5.3.1"></in><ci id="A1.E16.m1.6.6.4.5.3.2.cmml" xref="A1.E16.m1.6.6.4.5.3.2">𝑖</ci><apply id="A1.E16.m1.6.6.4.5.3.3.cmml" xref="A1.E16.m1.6.6.4.5.3.3"><csymbol cd="ambiguous" id="A1.E16.m1.6.6.4.5.3.3.1.cmml" xref="A1.E16.m1.6.6.4.5.3.3">superscript</csymbol><ci id="A1.E16.m1.6.6.4.5.3.3.2.cmml" xref="A1.E16.m1.6.6.4.5.3.3.2">ℒ</ci><plus id="A1.E16.m1.6.6.4.5.3.3.3.cmml" xref="A1.E16.m1.6.6.4.5.3.3.3"></plus></apply></apply></apply><apply id="A1.E16.m1.6.6.4.6.cmml" xref="A1.E16.m1.6.6.4.6"><times id="A1.E16.m1.6.6.4.6.1.cmml" xref="A1.E16.m1.6.6.4.6.1"></times><apply id="A1.E16.m1.6.6.4.6.2.cmml" xref="A1.E16.m1.6.6.4.6.2"><csymbol cd="ambiguous" id="A1.E16.m1.6.6.4.6.2.1.cmml" xref="A1.E16.m1.6.6.4.6.2">subscript</csymbol><ci id="A1.E16.m1.6.6.4.6.2.2.cmml" xref="A1.E16.m1.6.6.4.6.2.2">𝒜</ci><list id="A1.E16.m1.4.4.2.2.2.3.cmml" xref="A1.E16.m1.4.4.2.2.2.4"><ci id="A1.E16.m1.3.3.1.1.1.1.cmml" xref="A1.E16.m1.3.3.1.1.1.1">𝑊</ci><ci id="A1.E16.m1.4.4.2.2.2.2.cmml" xref="A1.E16.m1.4.4.2.2.2.2">𝑓</ci></list></apply><apply id="A1.E16.m1.6.6.4.6.3.cmml" xref="A1.E16.m1.6.6.4.6.3"><csymbol cd="ambiguous" id="A1.E16.m1.6.6.4.6.3.1.cmml" xref="A1.E16.m1.6.6.4.6.3">subscript</csymbol><interval closure="open" id="A1.E16.m1.6.6.4.6.3.2.1.cmml" xref="A1.E16.m1.6.6.4.6.3.2.2"><ci id="A1.E16.m1.5.5.3.3.cmml" xref="A1.E16.m1.5.5.3.3">𝐾</ci><ci id="A1.E16.m1.6.6.4.4.cmml" xref="A1.E16.m1.6.6.4.4">𝑄</ci></interval><ci id="A1.E16.m1.6.6.4.6.3.3.cmml" xref="A1.E16.m1.6.6.4.6.3.3">𝑖</ci></apply></apply></apply><apply id="A1.E16.m1.10.10.8.cmml" xref="A1.E16.m1.10.10.8"><apply id="A1.E16.m1.10.10.8.5.cmml" xref="A1.E16.m1.10.10.8.5"><csymbol cd="ambiguous" id="A1.E16.m1.10.10.8.5.1.cmml" xref="A1.E16.m1.10.10.8.5">subscript</csymbol><sum id="A1.E16.m1.10.10.8.5.2.cmml" xref="A1.E16.m1.10.10.8.5.2"></sum><apply id="A1.E16.m1.10.10.8.5.3.cmml" xref="A1.E16.m1.10.10.8.5.3"><in id="A1.E16.m1.10.10.8.5.3.1.cmml" xref="A1.E16.m1.10.10.8.5.3.1"></in><ci id="A1.E16.m1.10.10.8.5.3.2.cmml" xref="A1.E16.m1.10.10.8.5.3.2">𝑖</ci><ci id="A1.E16.m1.10.10.8.5.3.3.cmml" xref="A1.E16.m1.10.10.8.5.3.3">ℒ</ci></apply></apply><apply id="A1.E16.m1.10.10.8.6.cmml" xref="A1.E16.m1.10.10.8.6"><times id="A1.E16.m1.10.10.8.6.1.cmml" xref="A1.E16.m1.10.10.8.6.1"></times><apply id="A1.E16.m1.10.10.8.6.2.cmml" xref="A1.E16.m1.10.10.8.6.2"><csymbol cd="ambiguous" id="A1.E16.m1.10.10.8.6.2.1.cmml" xref="A1.E16.m1.10.10.8.6.2">subscript</csymbol><ci id="A1.E16.m1.10.10.8.6.2.2.cmml" xref="A1.E16.m1.10.10.8.6.2.2">𝒜</ci><list id="A1.E16.m1.8.8.6.2.2.3.cmml" xref="A1.E16.m1.8.8.6.2.2.4"><ci id="A1.E16.m1.7.7.5.1.1.1.cmml" xref="A1.E16.m1.7.7.5.1.1.1">𝑊</ci><ci id="A1.E16.m1.8.8.6.2.2.2.cmml" xref="A1.E16.m1.8.8.6.2.2.2">𝑓</ci></list></apply><apply id="A1.E16.m1.10.10.8.6.3.cmml" xref="A1.E16.m1.10.10.8.6.3"><csymbol cd="ambiguous" id="A1.E16.m1.10.10.8.6.3.1.cmml" xref="A1.E16.m1.10.10.8.6.3">subscript</csymbol><interval closure="open" id="A1.E16.m1.10.10.8.6.3.2.1.cmml" xref="A1.E16.m1.10.10.8.6.3.2.2"><ci id="A1.E16.m1.9.9.7.3.cmml" xref="A1.E16.m1.9.9.7.3">𝐾</ci><ci id="A1.E16.m1.10.10.8.4.cmml" xref="A1.E16.m1.10.10.8.4">𝑄</ci></interval><ci id="A1.E16.m1.10.10.8.6.3.3.cmml" xref="A1.E16.m1.10.10.8.6.3.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E16.m1.14c">\mathrm{CLA}_{W,f}(K,Q,\mathcal{L},\mathcal{L}^{+})=\frac{\sum_{i\in\mathcal{L%
}^{+}}\mathcal{A}_{W,f}\left(K,Q\right)_{i}}{\sum_{i\in\mathcal{L}}\mathcal{A}%
_{W,f}\left(K,Q\right)_{i}}.</annotation><annotation encoding="application/x-llamapun" id="A1.E16.m1.14d">roman_CLA start_POSTSUBSCRIPT italic_W , italic_f end_POSTSUBSCRIPT ( italic_K , italic_Q , caligraphic_L , caligraphic_L start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT ) = divide start_ARG ∑ start_POSTSUBSCRIPT italic_i ∈ caligraphic_L start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT end_POSTSUBSCRIPT caligraphic_A start_POSTSUBSCRIPT italic_W , italic_f end_POSTSUBSCRIPT ( italic_K , italic_Q ) start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_i ∈ caligraphic_L end_POSTSUBSCRIPT caligraphic_A start_POSTSUBSCRIPT italic_W , italic_f end_POSTSUBSCRIPT ( italic_K , italic_Q ) start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS4.p2.4">Intuitively, CLA reflects the accuracy of attention computation <math alttext="\mathcal{A}_{W,f}" class="ltx_Math" display="inline" id="A1.SS4.p2.3.m1.2"><semantics id="A1.SS4.p2.3.m1.2a"><msub id="A1.SS4.p2.3.m1.2.3" xref="A1.SS4.p2.3.m1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS4.p2.3.m1.2.3.2" xref="A1.SS4.p2.3.m1.2.3.2.cmml">𝒜</mi><mrow id="A1.SS4.p2.3.m1.2.2.2.4" xref="A1.SS4.p2.3.m1.2.2.2.3.cmml"><mi id="A1.SS4.p2.3.m1.1.1.1.1" xref="A1.SS4.p2.3.m1.1.1.1.1.cmml">W</mi><mo id="A1.SS4.p2.3.m1.2.2.2.4.1" xref="A1.SS4.p2.3.m1.2.2.2.3.cmml">,</mo><mi id="A1.SS4.p2.3.m1.2.2.2.2" xref="A1.SS4.p2.3.m1.2.2.2.2.cmml">f</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.SS4.p2.3.m1.2b"><apply id="A1.SS4.p2.3.m1.2.3.cmml" xref="A1.SS4.p2.3.m1.2.3"><csymbol cd="ambiguous" id="A1.SS4.p2.3.m1.2.3.1.cmml" xref="A1.SS4.p2.3.m1.2.3">subscript</csymbol><ci id="A1.SS4.p2.3.m1.2.3.2.cmml" xref="A1.SS4.p2.3.m1.2.3.2">𝒜</ci><list id="A1.SS4.p2.3.m1.2.2.2.3.cmml" xref="A1.SS4.p2.3.m1.2.2.2.4"><ci id="A1.SS4.p2.3.m1.1.1.1.1.cmml" xref="A1.SS4.p2.3.m1.1.1.1.1">𝑊</ci><ci id="A1.SS4.p2.3.m1.2.2.2.2.cmml" xref="A1.SS4.p2.3.m1.2.2.2.2">𝑓</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p2.3.m1.2c">\mathcal{A}_{W,f}</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p2.3.m1.2d">caligraphic_A start_POSTSUBSCRIPT italic_W , italic_f end_POSTSUBSCRIPT</annotation></semantics></math> towards label tokens on one input. For an input set built from a dataset, we calculate the averaged <math alttext="\mathrm{CLA}" class="ltx_Math" display="inline" id="A1.SS4.p2.4.m2.1"><semantics id="A1.SS4.p2.4.m2.1a"><mi id="A1.SS4.p2.4.m2.1.1" xref="A1.SS4.p2.4.m2.1.1.cmml">CLA</mi><annotation-xml encoding="MathML-Content" id="A1.SS4.p2.4.m2.1b"><ci id="A1.SS4.p2.4.m2.1.1.cmml" xref="A1.SS4.p2.4.m2.1.1">CLA</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p2.4.m2.1c">\mathrm{CLA}</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p2.4.m2.1d">roman_CLA</annotation></semantics></math> on these inputs, and repeat in every layer to plot a curve of Averaged CLA against layer numbers. Specifically:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS4.p3">
<p class="ltx_p" id="A1.SS4.p3.2"><span class="ltx_text ltx_font_bold" id="A1.SS4.p3.2.1">(1) Vanilla attention.</span> We assign <math alttext="W\fallingdotseq\mathrm{I}" class="ltx_Math" display="inline" id="A1.SS4.p3.1.m1.1"><semantics id="A1.SS4.p3.1.m1.1a"><mrow id="A1.SS4.p3.1.m1.1.1" xref="A1.SS4.p3.1.m1.1.1.cmml"><mi id="A1.SS4.p3.1.m1.1.1.2" xref="A1.SS4.p3.1.m1.1.1.2.cmml">W</mi><mo id="A1.SS4.p3.1.m1.1.1.1" xref="A1.SS4.p3.1.m1.1.1.1.cmml">≒</mo><mi id="A1.SS4.p3.1.m1.1.1.3" mathvariant="normal" xref="A1.SS4.p3.1.m1.1.1.3.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS4.p3.1.m1.1b"><apply id="A1.SS4.p3.1.m1.1.1.cmml" xref="A1.SS4.p3.1.m1.1.1"><csymbol cd="latexml" id="A1.SS4.p3.1.m1.1.1.1.cmml" xref="A1.SS4.p3.1.m1.1.1.1">approximately-equals-or-image-of</csymbol><ci id="A1.SS4.p3.1.m1.1.1.2.cmml" xref="A1.SS4.p3.1.m1.1.1.2">𝑊</ci><ci id="A1.SS4.p3.1.m1.1.1.3.cmml" xref="A1.SS4.p3.1.m1.1.1.3">I</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p3.1.m1.1c">W\fallingdotseq\mathrm{I}</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p3.1.m1.1d">italic_W ≒ roman_I</annotation></semantics></math>, <math alttext="f" class="ltx_Math" display="inline" id="A1.SS4.p3.2.m2.1"><semantics id="A1.SS4.p3.2.m2.1a"><mi id="A1.SS4.p3.2.m2.1.1" xref="A1.SS4.p3.2.m2.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="A1.SS4.p3.2.m2.1b"><ci id="A1.SS4.p3.2.m2.1.1.cmml" xref="A1.SS4.p3.2.m2.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p3.2.m2.1c">f</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p3.2.m2.1d">italic_f</annotation></semantics></math> to linear normlization.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS4.p4">
<p class="ltx_p" id="A1.SS4.p4.4"><span class="ltx_text ltx_font_bold" id="A1.SS4.p4.4.1">(2) Best Induction Head.</span> For each attention head <math alttext="h" class="ltx_Math" display="inline" id="A1.SS4.p4.1.m1.1"><semantics id="A1.SS4.p4.1.m1.1a"><mi id="A1.SS4.p4.1.m1.1.1" xref="A1.SS4.p4.1.m1.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="A1.SS4.p4.1.m1.1b"><ci id="A1.SS4.p4.1.m1.1.1.cmml" xref="A1.SS4.p4.1.m1.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p4.1.m1.1c">h</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p4.1.m1.1d">italic_h</annotation></semantics></math>, we assign <math alttext="W^{h}\fallingdotseq W_{Q}^{h\top}W_{K}^{h}" class="ltx_Math" display="inline" id="A1.SS4.p4.2.m2.1"><semantics id="A1.SS4.p4.2.m2.1a"><mrow id="A1.SS4.p4.2.m2.1.1" xref="A1.SS4.p4.2.m2.1.1.cmml"><msup id="A1.SS4.p4.2.m2.1.1.2" xref="A1.SS4.p4.2.m2.1.1.2.cmml"><mi id="A1.SS4.p4.2.m2.1.1.2.2" xref="A1.SS4.p4.2.m2.1.1.2.2.cmml">W</mi><mi id="A1.SS4.p4.2.m2.1.1.2.3" xref="A1.SS4.p4.2.m2.1.1.2.3.cmml">h</mi></msup><mo id="A1.SS4.p4.2.m2.1.1.1" xref="A1.SS4.p4.2.m2.1.1.1.cmml">≒</mo><mrow id="A1.SS4.p4.2.m2.1.1.3" xref="A1.SS4.p4.2.m2.1.1.3.cmml"><msubsup id="A1.SS4.p4.2.m2.1.1.3.2" xref="A1.SS4.p4.2.m2.1.1.3.2.cmml"><mi id="A1.SS4.p4.2.m2.1.1.3.2.2.2" xref="A1.SS4.p4.2.m2.1.1.3.2.2.2.cmml">W</mi><mi id="A1.SS4.p4.2.m2.1.1.3.2.2.3" xref="A1.SS4.p4.2.m2.1.1.3.2.2.3.cmml">Q</mi><mrow id="A1.SS4.p4.2.m2.1.1.3.2.3" xref="A1.SS4.p4.2.m2.1.1.3.2.3.cmml"><mi id="A1.SS4.p4.2.m2.1.1.3.2.3.2" xref="A1.SS4.p4.2.m2.1.1.3.2.3.2.cmml">h</mi><mo id="A1.SS4.p4.2.m2.1.1.3.2.3.3" lspace="0.222em" xref="A1.SS4.p4.2.m2.1.1.3.2.3.3.cmml">⊤</mo></mrow></msubsup><mo id="A1.SS4.p4.2.m2.1.1.3.1" xref="A1.SS4.p4.2.m2.1.1.3.1.cmml">⁢</mo><msubsup id="A1.SS4.p4.2.m2.1.1.3.3" xref="A1.SS4.p4.2.m2.1.1.3.3.cmml"><mi id="A1.SS4.p4.2.m2.1.1.3.3.2.2" xref="A1.SS4.p4.2.m2.1.1.3.3.2.2.cmml">W</mi><mi id="A1.SS4.p4.2.m2.1.1.3.3.2.3" xref="A1.SS4.p4.2.m2.1.1.3.3.2.3.cmml">K</mi><mi id="A1.SS4.p4.2.m2.1.1.3.3.3" xref="A1.SS4.p4.2.m2.1.1.3.3.3.cmml">h</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS4.p4.2.m2.1b"><apply id="A1.SS4.p4.2.m2.1.1.cmml" xref="A1.SS4.p4.2.m2.1.1"><csymbol cd="latexml" id="A1.SS4.p4.2.m2.1.1.1.cmml" xref="A1.SS4.p4.2.m2.1.1.1">approximately-equals-or-image-of</csymbol><apply id="A1.SS4.p4.2.m2.1.1.2.cmml" xref="A1.SS4.p4.2.m2.1.1.2"><csymbol cd="ambiguous" id="A1.SS4.p4.2.m2.1.1.2.1.cmml" xref="A1.SS4.p4.2.m2.1.1.2">superscript</csymbol><ci id="A1.SS4.p4.2.m2.1.1.2.2.cmml" xref="A1.SS4.p4.2.m2.1.1.2.2">𝑊</ci><ci id="A1.SS4.p4.2.m2.1.1.2.3.cmml" xref="A1.SS4.p4.2.m2.1.1.2.3">ℎ</ci></apply><apply id="A1.SS4.p4.2.m2.1.1.3.cmml" xref="A1.SS4.p4.2.m2.1.1.3"><times id="A1.SS4.p4.2.m2.1.1.3.1.cmml" xref="A1.SS4.p4.2.m2.1.1.3.1"></times><apply id="A1.SS4.p4.2.m2.1.1.3.2.cmml" xref="A1.SS4.p4.2.m2.1.1.3.2"><csymbol cd="ambiguous" id="A1.SS4.p4.2.m2.1.1.3.2.1.cmml" xref="A1.SS4.p4.2.m2.1.1.3.2">superscript</csymbol><apply id="A1.SS4.p4.2.m2.1.1.3.2.2.cmml" xref="A1.SS4.p4.2.m2.1.1.3.2"><csymbol cd="ambiguous" id="A1.SS4.p4.2.m2.1.1.3.2.2.1.cmml" xref="A1.SS4.p4.2.m2.1.1.3.2">subscript</csymbol><ci id="A1.SS4.p4.2.m2.1.1.3.2.2.2.cmml" xref="A1.SS4.p4.2.m2.1.1.3.2.2.2">𝑊</ci><ci id="A1.SS4.p4.2.m2.1.1.3.2.2.3.cmml" xref="A1.SS4.p4.2.m2.1.1.3.2.2.3">𝑄</ci></apply><apply id="A1.SS4.p4.2.m2.1.1.3.2.3.cmml" xref="A1.SS4.p4.2.m2.1.1.3.2.3"><csymbol cd="latexml" id="A1.SS4.p4.2.m2.1.1.3.2.3.1.cmml" xref="A1.SS4.p4.2.m2.1.1.3.2.3">limit-from</csymbol><ci id="A1.SS4.p4.2.m2.1.1.3.2.3.2.cmml" xref="A1.SS4.p4.2.m2.1.1.3.2.3.2">ℎ</ci><csymbol cd="latexml" id="A1.SS4.p4.2.m2.1.1.3.2.3.3.cmml" xref="A1.SS4.p4.2.m2.1.1.3.2.3.3">top</csymbol></apply></apply><apply id="A1.SS4.p4.2.m2.1.1.3.3.cmml" xref="A1.SS4.p4.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="A1.SS4.p4.2.m2.1.1.3.3.1.cmml" xref="A1.SS4.p4.2.m2.1.1.3.3">superscript</csymbol><apply id="A1.SS4.p4.2.m2.1.1.3.3.2.cmml" xref="A1.SS4.p4.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="A1.SS4.p4.2.m2.1.1.3.3.2.1.cmml" xref="A1.SS4.p4.2.m2.1.1.3.3">subscript</csymbol><ci id="A1.SS4.p4.2.m2.1.1.3.3.2.2.cmml" xref="A1.SS4.p4.2.m2.1.1.3.3.2.2">𝑊</ci><ci id="A1.SS4.p4.2.m2.1.1.3.3.2.3.cmml" xref="A1.SS4.p4.2.m2.1.1.3.3.2.3">𝐾</ci></apply><ci id="A1.SS4.p4.2.m2.1.1.3.3.3.cmml" xref="A1.SS4.p4.2.m2.1.1.3.3.3">ℎ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p4.2.m2.1c">W^{h}\fallingdotseq W_{Q}^{h\top}W_{K}^{h}</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p4.2.m2.1d">italic_W start_POSTSUPERSCRIPT italic_h end_POSTSUPERSCRIPT ≒ italic_W start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_h ⊤ end_POSTSUPERSCRIPT italic_W start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_h end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="f\fallingdotseq\mathrm{softmax}" class="ltx_Math" display="inline" id="A1.SS4.p4.3.m3.1"><semantics id="A1.SS4.p4.3.m3.1a"><mrow id="A1.SS4.p4.3.m3.1.1" xref="A1.SS4.p4.3.m3.1.1.cmml"><mi id="A1.SS4.p4.3.m3.1.1.2" xref="A1.SS4.p4.3.m3.1.1.2.cmml">f</mi><mo id="A1.SS4.p4.3.m3.1.1.1" xref="A1.SS4.p4.3.m3.1.1.1.cmml">≒</mo><mi id="A1.SS4.p4.3.m3.1.1.3" xref="A1.SS4.p4.3.m3.1.1.3.cmml">softmax</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS4.p4.3.m3.1b"><apply id="A1.SS4.p4.3.m3.1.1.cmml" xref="A1.SS4.p4.3.m3.1.1"><csymbol cd="latexml" id="A1.SS4.p4.3.m3.1.1.1.cmml" xref="A1.SS4.p4.3.m3.1.1.1">approximately-equals-or-image-of</csymbol><ci id="A1.SS4.p4.3.m3.1.1.2.cmml" xref="A1.SS4.p4.3.m3.1.1.2">𝑓</ci><ci id="A1.SS4.p4.3.m3.1.1.3.cmml" xref="A1.SS4.p4.3.m3.1.1.3">softmax</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p4.3.m3.1c">f\fallingdotseq\mathrm{softmax}</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p4.3.m3.1d">italic_f ≒ roman_softmax</annotation></semantics></math>. For each input, we calculate <math alttext="\max\limits_{h}\mathrm{CLA}_{W^{h},f}\left(K,Q,\mathcal{L},\mathcal{L}^{+}\right)" class="ltx_Math" display="inline" id="A1.SS4.p4.4.m4.6"><semantics id="A1.SS4.p4.4.m4.6a"><mrow id="A1.SS4.p4.4.m4.6.6" xref="A1.SS4.p4.4.m4.6.6.cmml"><mrow id="A1.SS4.p4.4.m4.6.6.3" xref="A1.SS4.p4.4.m4.6.6.3.cmml"><munder id="A1.SS4.p4.4.m4.6.6.3.1" xref="A1.SS4.p4.4.m4.6.6.3.1.cmml"><mi id="A1.SS4.p4.4.m4.6.6.3.1.2" xref="A1.SS4.p4.4.m4.6.6.3.1.2.cmml">max</mi><mi id="A1.SS4.p4.4.m4.6.6.3.1.3" xref="A1.SS4.p4.4.m4.6.6.3.1.3.cmml">h</mi></munder><mo id="A1.SS4.p4.4.m4.6.6.3a" lspace="0.167em" xref="A1.SS4.p4.4.m4.6.6.3.cmml">⁡</mo><msub id="A1.SS4.p4.4.m4.6.6.3.2" xref="A1.SS4.p4.4.m4.6.6.3.2.cmml"><mi id="A1.SS4.p4.4.m4.6.6.3.2.2" xref="A1.SS4.p4.4.m4.6.6.3.2.2.cmml">CLA</mi><mrow id="A1.SS4.p4.4.m4.2.2.2.2" xref="A1.SS4.p4.4.m4.2.2.2.3.cmml"><msup id="A1.SS4.p4.4.m4.2.2.2.2.1" xref="A1.SS4.p4.4.m4.2.2.2.2.1.cmml"><mi id="A1.SS4.p4.4.m4.2.2.2.2.1.2" xref="A1.SS4.p4.4.m4.2.2.2.2.1.2.cmml">W</mi><mi id="A1.SS4.p4.4.m4.2.2.2.2.1.3" xref="A1.SS4.p4.4.m4.2.2.2.2.1.3.cmml">h</mi></msup><mo id="A1.SS4.p4.4.m4.2.2.2.2.2" xref="A1.SS4.p4.4.m4.2.2.2.3.cmml">,</mo><mi id="A1.SS4.p4.4.m4.1.1.1.1" xref="A1.SS4.p4.4.m4.1.1.1.1.cmml">f</mi></mrow></msub></mrow><mo id="A1.SS4.p4.4.m4.6.6.2" xref="A1.SS4.p4.4.m4.6.6.2.cmml">⁢</mo><mrow id="A1.SS4.p4.4.m4.6.6.1.1" xref="A1.SS4.p4.4.m4.6.6.1.2.cmml"><mo id="A1.SS4.p4.4.m4.6.6.1.1.2" xref="A1.SS4.p4.4.m4.6.6.1.2.cmml">(</mo><mi id="A1.SS4.p4.4.m4.3.3" xref="A1.SS4.p4.4.m4.3.3.cmml">K</mi><mo id="A1.SS4.p4.4.m4.6.6.1.1.3" xref="A1.SS4.p4.4.m4.6.6.1.2.cmml">,</mo><mi id="A1.SS4.p4.4.m4.4.4" xref="A1.SS4.p4.4.m4.4.4.cmml">Q</mi><mo id="A1.SS4.p4.4.m4.6.6.1.1.4" xref="A1.SS4.p4.4.m4.6.6.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="A1.SS4.p4.4.m4.5.5" xref="A1.SS4.p4.4.m4.5.5.cmml">ℒ</mi><mo id="A1.SS4.p4.4.m4.6.6.1.1.5" xref="A1.SS4.p4.4.m4.6.6.1.2.cmml">,</mo><msup id="A1.SS4.p4.4.m4.6.6.1.1.1" xref="A1.SS4.p4.4.m4.6.6.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS4.p4.4.m4.6.6.1.1.1.2" xref="A1.SS4.p4.4.m4.6.6.1.1.1.2.cmml">ℒ</mi><mo id="A1.SS4.p4.4.m4.6.6.1.1.1.3" xref="A1.SS4.p4.4.m4.6.6.1.1.1.3.cmml">+</mo></msup><mo id="A1.SS4.p4.4.m4.6.6.1.1.6" xref="A1.SS4.p4.4.m4.6.6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS4.p4.4.m4.6b"><apply id="A1.SS4.p4.4.m4.6.6.cmml" xref="A1.SS4.p4.4.m4.6.6"><times id="A1.SS4.p4.4.m4.6.6.2.cmml" xref="A1.SS4.p4.4.m4.6.6.2"></times><apply id="A1.SS4.p4.4.m4.6.6.3.cmml" xref="A1.SS4.p4.4.m4.6.6.3"><apply id="A1.SS4.p4.4.m4.6.6.3.1.cmml" xref="A1.SS4.p4.4.m4.6.6.3.1"><csymbol cd="ambiguous" id="A1.SS4.p4.4.m4.6.6.3.1.1.cmml" xref="A1.SS4.p4.4.m4.6.6.3.1">subscript</csymbol><max id="A1.SS4.p4.4.m4.6.6.3.1.2.cmml" xref="A1.SS4.p4.4.m4.6.6.3.1.2"></max><ci id="A1.SS4.p4.4.m4.6.6.3.1.3.cmml" xref="A1.SS4.p4.4.m4.6.6.3.1.3">ℎ</ci></apply><apply id="A1.SS4.p4.4.m4.6.6.3.2.cmml" xref="A1.SS4.p4.4.m4.6.6.3.2"><csymbol cd="ambiguous" id="A1.SS4.p4.4.m4.6.6.3.2.1.cmml" xref="A1.SS4.p4.4.m4.6.6.3.2">subscript</csymbol><ci id="A1.SS4.p4.4.m4.6.6.3.2.2.cmml" xref="A1.SS4.p4.4.m4.6.6.3.2.2">CLA</ci><list id="A1.SS4.p4.4.m4.2.2.2.3.cmml" xref="A1.SS4.p4.4.m4.2.2.2.2"><apply id="A1.SS4.p4.4.m4.2.2.2.2.1.cmml" xref="A1.SS4.p4.4.m4.2.2.2.2.1"><csymbol cd="ambiguous" id="A1.SS4.p4.4.m4.2.2.2.2.1.1.cmml" xref="A1.SS4.p4.4.m4.2.2.2.2.1">superscript</csymbol><ci id="A1.SS4.p4.4.m4.2.2.2.2.1.2.cmml" xref="A1.SS4.p4.4.m4.2.2.2.2.1.2">𝑊</ci><ci id="A1.SS4.p4.4.m4.2.2.2.2.1.3.cmml" xref="A1.SS4.p4.4.m4.2.2.2.2.1.3">ℎ</ci></apply><ci id="A1.SS4.p4.4.m4.1.1.1.1.cmml" xref="A1.SS4.p4.4.m4.1.1.1.1">𝑓</ci></list></apply></apply><vector id="A1.SS4.p4.4.m4.6.6.1.2.cmml" xref="A1.SS4.p4.4.m4.6.6.1.1"><ci id="A1.SS4.p4.4.m4.3.3.cmml" xref="A1.SS4.p4.4.m4.3.3">𝐾</ci><ci id="A1.SS4.p4.4.m4.4.4.cmml" xref="A1.SS4.p4.4.m4.4.4">𝑄</ci><ci id="A1.SS4.p4.4.m4.5.5.cmml" xref="A1.SS4.p4.4.m4.5.5">ℒ</ci><apply id="A1.SS4.p4.4.m4.6.6.1.1.1.cmml" xref="A1.SS4.p4.4.m4.6.6.1.1.1"><csymbol cd="ambiguous" id="A1.SS4.p4.4.m4.6.6.1.1.1.1.cmml" xref="A1.SS4.p4.4.m4.6.6.1.1.1">superscript</csymbol><ci id="A1.SS4.p4.4.m4.6.6.1.1.1.2.cmml" xref="A1.SS4.p4.4.m4.6.6.1.1.1.2">ℒ</ci><plus id="A1.SS4.p4.4.m4.6.6.1.1.1.3.cmml" xref="A1.SS4.p4.4.m4.6.6.1.1.1.3"></plus></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p4.4.m4.6c">\max\limits_{h}\mathrm{CLA}_{W^{h},f}\left(K,Q,\mathcal{L},\mathcal{L}^{+}\right)</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p4.4.m4.6d">roman_max start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT roman_CLA start_POSTSUBSCRIPT italic_W start_POSTSUPERSCRIPT italic_h end_POSTSUPERSCRIPT , italic_f end_POSTSUBSCRIPT ( italic_K , italic_Q , caligraphic_L , caligraphic_L start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT )</annotation></semantics></math> as the result for single input.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS4.p5">
<p class="ltx_p" id="A1.SS4.p5.5"><span class="ltx_text ltx_font_bold" id="A1.SS4.p5.5.1">(3) Head Average.</span> For each attention head <math alttext="h" class="ltx_Math" display="inline" id="A1.SS4.p5.1.m1.1"><semantics id="A1.SS4.p5.1.m1.1a"><mi id="A1.SS4.p5.1.m1.1.1" xref="A1.SS4.p5.1.m1.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="A1.SS4.p5.1.m1.1b"><ci id="A1.SS4.p5.1.m1.1.1.cmml" xref="A1.SS4.p5.1.m1.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p5.1.m1.1c">h</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p5.1.m1.1d">italic_h</annotation></semantics></math>, we assign <math alttext="W^{h}\fallingdotseq W_{Q}^{h\top}W_{K}^{h}" class="ltx_Math" display="inline" id="A1.SS4.p5.2.m2.1"><semantics id="A1.SS4.p5.2.m2.1a"><mrow id="A1.SS4.p5.2.m2.1.1" xref="A1.SS4.p5.2.m2.1.1.cmml"><msup id="A1.SS4.p5.2.m2.1.1.2" xref="A1.SS4.p5.2.m2.1.1.2.cmml"><mi id="A1.SS4.p5.2.m2.1.1.2.2" xref="A1.SS4.p5.2.m2.1.1.2.2.cmml">W</mi><mi id="A1.SS4.p5.2.m2.1.1.2.3" xref="A1.SS4.p5.2.m2.1.1.2.3.cmml">h</mi></msup><mo id="A1.SS4.p5.2.m2.1.1.1" xref="A1.SS4.p5.2.m2.1.1.1.cmml">≒</mo><mrow id="A1.SS4.p5.2.m2.1.1.3" xref="A1.SS4.p5.2.m2.1.1.3.cmml"><msubsup id="A1.SS4.p5.2.m2.1.1.3.2" xref="A1.SS4.p5.2.m2.1.1.3.2.cmml"><mi id="A1.SS4.p5.2.m2.1.1.3.2.2.2" xref="A1.SS4.p5.2.m2.1.1.3.2.2.2.cmml">W</mi><mi id="A1.SS4.p5.2.m2.1.1.3.2.2.3" xref="A1.SS4.p5.2.m2.1.1.3.2.2.3.cmml">Q</mi><mrow id="A1.SS4.p5.2.m2.1.1.3.2.3" xref="A1.SS4.p5.2.m2.1.1.3.2.3.cmml"><mi id="A1.SS4.p5.2.m2.1.1.3.2.3.2" xref="A1.SS4.p5.2.m2.1.1.3.2.3.2.cmml">h</mi><mo id="A1.SS4.p5.2.m2.1.1.3.2.3.3" lspace="0.222em" xref="A1.SS4.p5.2.m2.1.1.3.2.3.3.cmml">⊤</mo></mrow></msubsup><mo id="A1.SS4.p5.2.m2.1.1.3.1" xref="A1.SS4.p5.2.m2.1.1.3.1.cmml">⁢</mo><msubsup id="A1.SS4.p5.2.m2.1.1.3.3" xref="A1.SS4.p5.2.m2.1.1.3.3.cmml"><mi id="A1.SS4.p5.2.m2.1.1.3.3.2.2" xref="A1.SS4.p5.2.m2.1.1.3.3.2.2.cmml">W</mi><mi id="A1.SS4.p5.2.m2.1.1.3.3.2.3" xref="A1.SS4.p5.2.m2.1.1.3.3.2.3.cmml">K</mi><mi id="A1.SS4.p5.2.m2.1.1.3.3.3" xref="A1.SS4.p5.2.m2.1.1.3.3.3.cmml">h</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS4.p5.2.m2.1b"><apply id="A1.SS4.p5.2.m2.1.1.cmml" xref="A1.SS4.p5.2.m2.1.1"><csymbol cd="latexml" id="A1.SS4.p5.2.m2.1.1.1.cmml" xref="A1.SS4.p5.2.m2.1.1.1">approximately-equals-or-image-of</csymbol><apply id="A1.SS4.p5.2.m2.1.1.2.cmml" xref="A1.SS4.p5.2.m2.1.1.2"><csymbol cd="ambiguous" id="A1.SS4.p5.2.m2.1.1.2.1.cmml" xref="A1.SS4.p5.2.m2.1.1.2">superscript</csymbol><ci id="A1.SS4.p5.2.m2.1.1.2.2.cmml" xref="A1.SS4.p5.2.m2.1.1.2.2">𝑊</ci><ci id="A1.SS4.p5.2.m2.1.1.2.3.cmml" xref="A1.SS4.p5.2.m2.1.1.2.3">ℎ</ci></apply><apply id="A1.SS4.p5.2.m2.1.1.3.cmml" xref="A1.SS4.p5.2.m2.1.1.3"><times id="A1.SS4.p5.2.m2.1.1.3.1.cmml" xref="A1.SS4.p5.2.m2.1.1.3.1"></times><apply id="A1.SS4.p5.2.m2.1.1.3.2.cmml" xref="A1.SS4.p5.2.m2.1.1.3.2"><csymbol cd="ambiguous" id="A1.SS4.p5.2.m2.1.1.3.2.1.cmml" xref="A1.SS4.p5.2.m2.1.1.3.2">superscript</csymbol><apply id="A1.SS4.p5.2.m2.1.1.3.2.2.cmml" xref="A1.SS4.p5.2.m2.1.1.3.2"><csymbol cd="ambiguous" id="A1.SS4.p5.2.m2.1.1.3.2.2.1.cmml" xref="A1.SS4.p5.2.m2.1.1.3.2">subscript</csymbol><ci id="A1.SS4.p5.2.m2.1.1.3.2.2.2.cmml" xref="A1.SS4.p5.2.m2.1.1.3.2.2.2">𝑊</ci><ci id="A1.SS4.p5.2.m2.1.1.3.2.2.3.cmml" xref="A1.SS4.p5.2.m2.1.1.3.2.2.3">𝑄</ci></apply><apply id="A1.SS4.p5.2.m2.1.1.3.2.3.cmml" xref="A1.SS4.p5.2.m2.1.1.3.2.3"><csymbol cd="latexml" id="A1.SS4.p5.2.m2.1.1.3.2.3.1.cmml" xref="A1.SS4.p5.2.m2.1.1.3.2.3">limit-from</csymbol><ci id="A1.SS4.p5.2.m2.1.1.3.2.3.2.cmml" xref="A1.SS4.p5.2.m2.1.1.3.2.3.2">ℎ</ci><csymbol cd="latexml" id="A1.SS4.p5.2.m2.1.1.3.2.3.3.cmml" xref="A1.SS4.p5.2.m2.1.1.3.2.3.3">top</csymbol></apply></apply><apply id="A1.SS4.p5.2.m2.1.1.3.3.cmml" xref="A1.SS4.p5.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="A1.SS4.p5.2.m2.1.1.3.3.1.cmml" xref="A1.SS4.p5.2.m2.1.1.3.3">superscript</csymbol><apply id="A1.SS4.p5.2.m2.1.1.3.3.2.cmml" xref="A1.SS4.p5.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="A1.SS4.p5.2.m2.1.1.3.3.2.1.cmml" xref="A1.SS4.p5.2.m2.1.1.3.3">subscript</csymbol><ci id="A1.SS4.p5.2.m2.1.1.3.3.2.2.cmml" xref="A1.SS4.p5.2.m2.1.1.3.3.2.2">𝑊</ci><ci id="A1.SS4.p5.2.m2.1.1.3.3.2.3.cmml" xref="A1.SS4.p5.2.m2.1.1.3.3.2.3">𝐾</ci></apply><ci id="A1.SS4.p5.2.m2.1.1.3.3.3.cmml" xref="A1.SS4.p5.2.m2.1.1.3.3.3">ℎ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p5.2.m2.1c">W^{h}\fallingdotseq W_{Q}^{h\top}W_{K}^{h}</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p5.2.m2.1d">italic_W start_POSTSUPERSCRIPT italic_h end_POSTSUPERSCRIPT ≒ italic_W start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_h ⊤ end_POSTSUPERSCRIPT italic_W start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_h end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="f\fallingdotseq\mathrm{softmax}" class="ltx_Math" display="inline" id="A1.SS4.p5.3.m3.1"><semantics id="A1.SS4.p5.3.m3.1a"><mrow id="A1.SS4.p5.3.m3.1.1" xref="A1.SS4.p5.3.m3.1.1.cmml"><mi id="A1.SS4.p5.3.m3.1.1.2" xref="A1.SS4.p5.3.m3.1.1.2.cmml">f</mi><mo id="A1.SS4.p5.3.m3.1.1.1" xref="A1.SS4.p5.3.m3.1.1.1.cmml">≒</mo><mi id="A1.SS4.p5.3.m3.1.1.3" xref="A1.SS4.p5.3.m3.1.1.3.cmml">softmax</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS4.p5.3.m3.1b"><apply id="A1.SS4.p5.3.m3.1.1.cmml" xref="A1.SS4.p5.3.m3.1.1"><csymbol cd="latexml" id="A1.SS4.p5.3.m3.1.1.1.cmml" xref="A1.SS4.p5.3.m3.1.1.1">approximately-equals-or-image-of</csymbol><ci id="A1.SS4.p5.3.m3.1.1.2.cmml" xref="A1.SS4.p5.3.m3.1.1.2">𝑓</ci><ci id="A1.SS4.p5.3.m3.1.1.3.cmml" xref="A1.SS4.p5.3.m3.1.1.3">softmax</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p5.3.m3.1c">f\fallingdotseq\mathrm{softmax}</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p5.3.m3.1d">italic_f ≒ roman_softmax</annotation></semantics></math>. For each input, we calculate <math alttext="\sum_{h}\mathrm{CLA}_{W^{h},f}\left(K,Q,\mathcal{L},\mathcal{L}^{+}\right)/|%
\mathcal{H}|" class="ltx_Math" display="inline" id="A1.SS4.p5.4.m4.7"><semantics id="A1.SS4.p5.4.m4.7a"><mrow id="A1.SS4.p5.4.m4.7.7" xref="A1.SS4.p5.4.m4.7.7.cmml"><msub id="A1.SS4.p5.4.m4.7.7.2" xref="A1.SS4.p5.4.m4.7.7.2.cmml"><mo id="A1.SS4.p5.4.m4.7.7.2.2" xref="A1.SS4.p5.4.m4.7.7.2.2.cmml">∑</mo><mi id="A1.SS4.p5.4.m4.7.7.2.3" xref="A1.SS4.p5.4.m4.7.7.2.3.cmml">h</mi></msub><mrow id="A1.SS4.p5.4.m4.7.7.1" xref="A1.SS4.p5.4.m4.7.7.1.cmml"><mrow id="A1.SS4.p5.4.m4.7.7.1.1" xref="A1.SS4.p5.4.m4.7.7.1.1.cmml"><msub id="A1.SS4.p5.4.m4.7.7.1.1.3" xref="A1.SS4.p5.4.m4.7.7.1.1.3.cmml"><mi id="A1.SS4.p5.4.m4.7.7.1.1.3.2" xref="A1.SS4.p5.4.m4.7.7.1.1.3.2.cmml">CLA</mi><mrow id="A1.SS4.p5.4.m4.2.2.2.2" xref="A1.SS4.p5.4.m4.2.2.2.3.cmml"><msup id="A1.SS4.p5.4.m4.2.2.2.2.1" xref="A1.SS4.p5.4.m4.2.2.2.2.1.cmml"><mi id="A1.SS4.p5.4.m4.2.2.2.2.1.2" xref="A1.SS4.p5.4.m4.2.2.2.2.1.2.cmml">W</mi><mi id="A1.SS4.p5.4.m4.2.2.2.2.1.3" xref="A1.SS4.p5.4.m4.2.2.2.2.1.3.cmml">h</mi></msup><mo id="A1.SS4.p5.4.m4.2.2.2.2.2" xref="A1.SS4.p5.4.m4.2.2.2.3.cmml">,</mo><mi id="A1.SS4.p5.4.m4.1.1.1.1" xref="A1.SS4.p5.4.m4.1.1.1.1.cmml">f</mi></mrow></msub><mo id="A1.SS4.p5.4.m4.7.7.1.1.2" xref="A1.SS4.p5.4.m4.7.7.1.1.2.cmml">⁢</mo><mrow id="A1.SS4.p5.4.m4.7.7.1.1.1.1" xref="A1.SS4.p5.4.m4.7.7.1.1.1.2.cmml"><mo id="A1.SS4.p5.4.m4.7.7.1.1.1.1.2" xref="A1.SS4.p5.4.m4.7.7.1.1.1.2.cmml">(</mo><mi id="A1.SS4.p5.4.m4.3.3" xref="A1.SS4.p5.4.m4.3.3.cmml">K</mi><mo id="A1.SS4.p5.4.m4.7.7.1.1.1.1.3" xref="A1.SS4.p5.4.m4.7.7.1.1.1.2.cmml">,</mo><mi id="A1.SS4.p5.4.m4.4.4" xref="A1.SS4.p5.4.m4.4.4.cmml">Q</mi><mo id="A1.SS4.p5.4.m4.7.7.1.1.1.1.4" xref="A1.SS4.p5.4.m4.7.7.1.1.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="A1.SS4.p5.4.m4.5.5" xref="A1.SS4.p5.4.m4.5.5.cmml">ℒ</mi><mo id="A1.SS4.p5.4.m4.7.7.1.1.1.1.5" xref="A1.SS4.p5.4.m4.7.7.1.1.1.2.cmml">,</mo><msup id="A1.SS4.p5.4.m4.7.7.1.1.1.1.1" xref="A1.SS4.p5.4.m4.7.7.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS4.p5.4.m4.7.7.1.1.1.1.1.2" xref="A1.SS4.p5.4.m4.7.7.1.1.1.1.1.2.cmml">ℒ</mi><mo id="A1.SS4.p5.4.m4.7.7.1.1.1.1.1.3" xref="A1.SS4.p5.4.m4.7.7.1.1.1.1.1.3.cmml">+</mo></msup><mo id="A1.SS4.p5.4.m4.7.7.1.1.1.1.6" xref="A1.SS4.p5.4.m4.7.7.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.SS4.p5.4.m4.7.7.1.2" xref="A1.SS4.p5.4.m4.7.7.1.2.cmml">/</mo><mrow id="A1.SS4.p5.4.m4.7.7.1.3.2" xref="A1.SS4.p5.4.m4.7.7.1.3.1.cmml"><mo id="A1.SS4.p5.4.m4.7.7.1.3.2.1" stretchy="false" xref="A1.SS4.p5.4.m4.7.7.1.3.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="A1.SS4.p5.4.m4.6.6" xref="A1.SS4.p5.4.m4.6.6.cmml">ℋ</mi><mo id="A1.SS4.p5.4.m4.7.7.1.3.2.2" stretchy="false" xref="A1.SS4.p5.4.m4.7.7.1.3.1.1.cmml">|</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS4.p5.4.m4.7b"><apply id="A1.SS4.p5.4.m4.7.7.cmml" xref="A1.SS4.p5.4.m4.7.7"><apply id="A1.SS4.p5.4.m4.7.7.2.cmml" xref="A1.SS4.p5.4.m4.7.7.2"><csymbol cd="ambiguous" id="A1.SS4.p5.4.m4.7.7.2.1.cmml" xref="A1.SS4.p5.4.m4.7.7.2">subscript</csymbol><sum id="A1.SS4.p5.4.m4.7.7.2.2.cmml" xref="A1.SS4.p5.4.m4.7.7.2.2"></sum><ci id="A1.SS4.p5.4.m4.7.7.2.3.cmml" xref="A1.SS4.p5.4.m4.7.7.2.3">ℎ</ci></apply><apply id="A1.SS4.p5.4.m4.7.7.1.cmml" xref="A1.SS4.p5.4.m4.7.7.1"><divide id="A1.SS4.p5.4.m4.7.7.1.2.cmml" xref="A1.SS4.p5.4.m4.7.7.1.2"></divide><apply id="A1.SS4.p5.4.m4.7.7.1.1.cmml" xref="A1.SS4.p5.4.m4.7.7.1.1"><times id="A1.SS4.p5.4.m4.7.7.1.1.2.cmml" xref="A1.SS4.p5.4.m4.7.7.1.1.2"></times><apply id="A1.SS4.p5.4.m4.7.7.1.1.3.cmml" xref="A1.SS4.p5.4.m4.7.7.1.1.3"><csymbol cd="ambiguous" id="A1.SS4.p5.4.m4.7.7.1.1.3.1.cmml" xref="A1.SS4.p5.4.m4.7.7.1.1.3">subscript</csymbol><ci id="A1.SS4.p5.4.m4.7.7.1.1.3.2.cmml" xref="A1.SS4.p5.4.m4.7.7.1.1.3.2">CLA</ci><list id="A1.SS4.p5.4.m4.2.2.2.3.cmml" xref="A1.SS4.p5.4.m4.2.2.2.2"><apply id="A1.SS4.p5.4.m4.2.2.2.2.1.cmml" xref="A1.SS4.p5.4.m4.2.2.2.2.1"><csymbol cd="ambiguous" id="A1.SS4.p5.4.m4.2.2.2.2.1.1.cmml" xref="A1.SS4.p5.4.m4.2.2.2.2.1">superscript</csymbol><ci id="A1.SS4.p5.4.m4.2.2.2.2.1.2.cmml" xref="A1.SS4.p5.4.m4.2.2.2.2.1.2">𝑊</ci><ci id="A1.SS4.p5.4.m4.2.2.2.2.1.3.cmml" xref="A1.SS4.p5.4.m4.2.2.2.2.1.3">ℎ</ci></apply><ci id="A1.SS4.p5.4.m4.1.1.1.1.cmml" xref="A1.SS4.p5.4.m4.1.1.1.1">𝑓</ci></list></apply><vector id="A1.SS4.p5.4.m4.7.7.1.1.1.2.cmml" xref="A1.SS4.p5.4.m4.7.7.1.1.1.1"><ci id="A1.SS4.p5.4.m4.3.3.cmml" xref="A1.SS4.p5.4.m4.3.3">𝐾</ci><ci id="A1.SS4.p5.4.m4.4.4.cmml" xref="A1.SS4.p5.4.m4.4.4">𝑄</ci><ci id="A1.SS4.p5.4.m4.5.5.cmml" xref="A1.SS4.p5.4.m4.5.5">ℒ</ci><apply id="A1.SS4.p5.4.m4.7.7.1.1.1.1.1.cmml" xref="A1.SS4.p5.4.m4.7.7.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS4.p5.4.m4.7.7.1.1.1.1.1.1.cmml" xref="A1.SS4.p5.4.m4.7.7.1.1.1.1.1">superscript</csymbol><ci id="A1.SS4.p5.4.m4.7.7.1.1.1.1.1.2.cmml" xref="A1.SS4.p5.4.m4.7.7.1.1.1.1.1.2">ℒ</ci><plus id="A1.SS4.p5.4.m4.7.7.1.1.1.1.1.3.cmml" xref="A1.SS4.p5.4.m4.7.7.1.1.1.1.1.3"></plus></apply></vector></apply><apply id="A1.SS4.p5.4.m4.7.7.1.3.1.cmml" xref="A1.SS4.p5.4.m4.7.7.1.3.2"><abs id="A1.SS4.p5.4.m4.7.7.1.3.1.1.cmml" xref="A1.SS4.p5.4.m4.7.7.1.3.2.1"></abs><ci id="A1.SS4.p5.4.m4.6.6.cmml" xref="A1.SS4.p5.4.m4.6.6">ℋ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p5.4.m4.7c">\sum_{h}\mathrm{CLA}_{W^{h},f}\left(K,Q,\mathcal{L},\mathcal{L}^{+}\right)/|%
\mathcal{H}|</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p5.4.m4.7d">∑ start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT roman_CLA start_POSTSUBSCRIPT italic_W start_POSTSUPERSCRIPT italic_h end_POSTSUPERSCRIPT , italic_f end_POSTSUBSCRIPT ( italic_K , italic_Q , caligraphic_L , caligraphic_L start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT ) / | caligraphic_H |</annotation></semantics></math>, where the <math alttext="|\mathcal{H}|" class="ltx_Math" display="inline" id="A1.SS4.p5.5.m5.1"><semantics id="A1.SS4.p5.5.m5.1a"><mrow id="A1.SS4.p5.5.m5.1.2.2" xref="A1.SS4.p5.5.m5.1.2.1.cmml"><mo id="A1.SS4.p5.5.m5.1.2.2.1" stretchy="false" xref="A1.SS4.p5.5.m5.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="A1.SS4.p5.5.m5.1.1" xref="A1.SS4.p5.5.m5.1.1.cmml">ℋ</mi><mo id="A1.SS4.p5.5.m5.1.2.2.2" stretchy="false" xref="A1.SS4.p5.5.m5.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS4.p5.5.m5.1b"><apply id="A1.SS4.p5.5.m5.1.2.1.cmml" xref="A1.SS4.p5.5.m5.1.2.2"><abs id="A1.SS4.p5.5.m5.1.2.1.1.cmml" xref="A1.SS4.p5.5.m5.1.2.2.1"></abs><ci id="A1.SS4.p5.5.m5.1.1.cmml" xref="A1.SS4.p5.5.m5.1.1">ℋ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p5.5.m5.1c">|\mathcal{H}|</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p5.5.m5.1d">| caligraphic_H |</annotation></semantics></math> is the amount of heads in current layer, as the result for single input.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS4.p6">
<p class="ltx_p" id="A1.SS4.p6.1">Note that we do not consider the absolute value of attention assignment on label tokens in this experiment, and most of the heads have little scores assigned to the label (Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S4.F6" title="Figure 6 ‣ 4.2 Step 3, Induction Head: Feature Retrieval on Task Subspace ‣ 4 Induction Circuits in Natural Language Models ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">6</span></a> (Left)), therefore, although the average assignments tend to be average, this result shown in Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S4.F6" title="Figure 6 ‣ 4.2 Step 3, Induction Head: Feature Retrieval on Task Subspace ‣ 4 Induction Circuits in Natural Language Models ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">6</span></a> (Middle) does not contradict the phenomenon that ICL can achieve high accuracy.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="A1.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.5 </span>Cartography Details of Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S4.F7" title="Figure 7 ‣ 4.2 Step 3, Induction Head: Feature Retrieval on Task Subspace ‣ 4 Induction Circuits in Natural Language Models ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">7</span></a>
</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A1.SS5.p1">
<p class="ltx_p" id="A1.SS5.p1.3">For Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S4.F7" title="Figure 7 ‣ 4.2 Step 3, Induction Head: Feature Retrieval on Task Subspace ‣ 4 Induction Circuits in Natural Language Models ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">7</span></a>, we input one sample from SST-2 into Llama 3 70B, take the output of layer 30 on the label tokens to span a matrix <math alttext="K_{\mathcal{L}}" class="ltx_Math" display="inline" id="A1.SS5.p1.1.m1.1"><semantics id="A1.SS5.p1.1.m1.1a"><msub id="A1.SS5.p1.1.m1.1.1" xref="A1.SS5.p1.1.m1.1.1.cmml"><mi id="A1.SS5.p1.1.m1.1.1.2" xref="A1.SS5.p1.1.m1.1.1.2.cmml">K</mi><mi class="ltx_font_mathcaligraphic" id="A1.SS5.p1.1.m1.1.1.3" xref="A1.SS5.p1.1.m1.1.1.3.cmml">ℒ</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS5.p1.1.m1.1b"><apply id="A1.SS5.p1.1.m1.1.1.cmml" xref="A1.SS5.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS5.p1.1.m1.1.1.1.cmml" xref="A1.SS5.p1.1.m1.1.1">subscript</csymbol><ci id="A1.SS5.p1.1.m1.1.1.2.cmml" xref="A1.SS5.p1.1.m1.1.1.2">𝐾</ci><ci id="A1.SS5.p1.1.m1.1.1.3.cmml" xref="A1.SS5.p1.1.m1.1.1.3">ℒ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.p1.1.m1.1c">K_{\mathcal{L}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.p1.1.m1.1d">italic_K start_POSTSUBSCRIPT caligraphic_L end_POSTSUBSCRIPT</annotation></semantics></math>, and map them by <math alttext="W_{Q}^{h\top}W_{K}^{h}" class="ltx_Math" display="inline" id="A1.SS5.p1.2.m2.1"><semantics id="A1.SS5.p1.2.m2.1a"><mrow id="A1.SS5.p1.2.m2.1.1" xref="A1.SS5.p1.2.m2.1.1.cmml"><msubsup id="A1.SS5.p1.2.m2.1.1.2" xref="A1.SS5.p1.2.m2.1.1.2.cmml"><mi id="A1.SS5.p1.2.m2.1.1.2.2.2" xref="A1.SS5.p1.2.m2.1.1.2.2.2.cmml">W</mi><mi id="A1.SS5.p1.2.m2.1.1.2.2.3" xref="A1.SS5.p1.2.m2.1.1.2.2.3.cmml">Q</mi><mrow id="A1.SS5.p1.2.m2.1.1.2.3" xref="A1.SS5.p1.2.m2.1.1.2.3.cmml"><mi id="A1.SS5.p1.2.m2.1.1.2.3.2" xref="A1.SS5.p1.2.m2.1.1.2.3.2.cmml">h</mi><mo id="A1.SS5.p1.2.m2.1.1.2.3.3" lspace="0.222em" xref="A1.SS5.p1.2.m2.1.1.2.3.3.cmml">⊤</mo></mrow></msubsup><mo id="A1.SS5.p1.2.m2.1.1.1" xref="A1.SS5.p1.2.m2.1.1.1.cmml">⁢</mo><msubsup id="A1.SS5.p1.2.m2.1.1.3" xref="A1.SS5.p1.2.m2.1.1.3.cmml"><mi id="A1.SS5.p1.2.m2.1.1.3.2.2" xref="A1.SS5.p1.2.m2.1.1.3.2.2.cmml">W</mi><mi id="A1.SS5.p1.2.m2.1.1.3.2.3" xref="A1.SS5.p1.2.m2.1.1.3.2.3.cmml">K</mi><mi id="A1.SS5.p1.2.m2.1.1.3.3" xref="A1.SS5.p1.2.m2.1.1.3.3.cmml">h</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS5.p1.2.m2.1b"><apply id="A1.SS5.p1.2.m2.1.1.cmml" xref="A1.SS5.p1.2.m2.1.1"><times id="A1.SS5.p1.2.m2.1.1.1.cmml" xref="A1.SS5.p1.2.m2.1.1.1"></times><apply id="A1.SS5.p1.2.m2.1.1.2.cmml" xref="A1.SS5.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="A1.SS5.p1.2.m2.1.1.2.1.cmml" xref="A1.SS5.p1.2.m2.1.1.2">superscript</csymbol><apply id="A1.SS5.p1.2.m2.1.1.2.2.cmml" xref="A1.SS5.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="A1.SS5.p1.2.m2.1.1.2.2.1.cmml" xref="A1.SS5.p1.2.m2.1.1.2">subscript</csymbol><ci id="A1.SS5.p1.2.m2.1.1.2.2.2.cmml" xref="A1.SS5.p1.2.m2.1.1.2.2.2">𝑊</ci><ci id="A1.SS5.p1.2.m2.1.1.2.2.3.cmml" xref="A1.SS5.p1.2.m2.1.1.2.2.3">𝑄</ci></apply><apply id="A1.SS5.p1.2.m2.1.1.2.3.cmml" xref="A1.SS5.p1.2.m2.1.1.2.3"><csymbol cd="latexml" id="A1.SS5.p1.2.m2.1.1.2.3.1.cmml" xref="A1.SS5.p1.2.m2.1.1.2.3">limit-from</csymbol><ci id="A1.SS5.p1.2.m2.1.1.2.3.2.cmml" xref="A1.SS5.p1.2.m2.1.1.2.3.2">ℎ</ci><csymbol cd="latexml" id="A1.SS5.p1.2.m2.1.1.2.3.3.cmml" xref="A1.SS5.p1.2.m2.1.1.2.3.3">top</csymbol></apply></apply><apply id="A1.SS5.p1.2.m2.1.1.3.cmml" xref="A1.SS5.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="A1.SS5.p1.2.m2.1.1.3.1.cmml" xref="A1.SS5.p1.2.m2.1.1.3">superscript</csymbol><apply id="A1.SS5.p1.2.m2.1.1.3.2.cmml" xref="A1.SS5.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="A1.SS5.p1.2.m2.1.1.3.2.1.cmml" xref="A1.SS5.p1.2.m2.1.1.3">subscript</csymbol><ci id="A1.SS5.p1.2.m2.1.1.3.2.2.cmml" xref="A1.SS5.p1.2.m2.1.1.3.2.2">𝑊</ci><ci id="A1.SS5.p1.2.m2.1.1.3.2.3.cmml" xref="A1.SS5.p1.2.m2.1.1.3.2.3">𝐾</ci></apply><ci id="A1.SS5.p1.2.m2.1.1.3.3.cmml" xref="A1.SS5.p1.2.m2.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.p1.2.m2.1c">W_{Q}^{h\top}W_{K}^{h}</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.p1.2.m2.1d">italic_W start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_h ⊤ end_POSTSUPERSCRIPT italic_W start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_h end_POSTSUPERSCRIPT</annotation></semantics></math> of head 32 (the best induction heads in this layer) and 9 (the worst induction heads) of layer 31 (the layer with the most correct induction heads), respectively. We visualize the distribution of these mapped <math alttext="W_{Q}^{h\top}W_{K}^{h}K_{\mathcal{L}}" class="ltx_Math" display="inline" id="A1.SS5.p1.3.m3.1"><semantics id="A1.SS5.p1.3.m3.1a"><mrow id="A1.SS5.p1.3.m3.1.1" xref="A1.SS5.p1.3.m3.1.1.cmml"><msubsup id="A1.SS5.p1.3.m3.1.1.2" xref="A1.SS5.p1.3.m3.1.1.2.cmml"><mi id="A1.SS5.p1.3.m3.1.1.2.2.2" xref="A1.SS5.p1.3.m3.1.1.2.2.2.cmml">W</mi><mi id="A1.SS5.p1.3.m3.1.1.2.2.3" xref="A1.SS5.p1.3.m3.1.1.2.2.3.cmml">Q</mi><mrow id="A1.SS5.p1.3.m3.1.1.2.3" xref="A1.SS5.p1.3.m3.1.1.2.3.cmml"><mi id="A1.SS5.p1.3.m3.1.1.2.3.2" xref="A1.SS5.p1.3.m3.1.1.2.3.2.cmml">h</mi><mo id="A1.SS5.p1.3.m3.1.1.2.3.3" lspace="0.222em" xref="A1.SS5.p1.3.m3.1.1.2.3.3.cmml">⊤</mo></mrow></msubsup><mo id="A1.SS5.p1.3.m3.1.1.1" xref="A1.SS5.p1.3.m3.1.1.1.cmml">⁢</mo><msubsup id="A1.SS5.p1.3.m3.1.1.3" xref="A1.SS5.p1.3.m3.1.1.3.cmml"><mi id="A1.SS5.p1.3.m3.1.1.3.2.2" xref="A1.SS5.p1.3.m3.1.1.3.2.2.cmml">W</mi><mi id="A1.SS5.p1.3.m3.1.1.3.2.3" xref="A1.SS5.p1.3.m3.1.1.3.2.3.cmml">K</mi><mi id="A1.SS5.p1.3.m3.1.1.3.3" xref="A1.SS5.p1.3.m3.1.1.3.3.cmml">h</mi></msubsup><mo id="A1.SS5.p1.3.m3.1.1.1a" xref="A1.SS5.p1.3.m3.1.1.1.cmml">⁢</mo><msub id="A1.SS5.p1.3.m3.1.1.4" xref="A1.SS5.p1.3.m3.1.1.4.cmml"><mi id="A1.SS5.p1.3.m3.1.1.4.2" xref="A1.SS5.p1.3.m3.1.1.4.2.cmml">K</mi><mi class="ltx_font_mathcaligraphic" id="A1.SS5.p1.3.m3.1.1.4.3" xref="A1.SS5.p1.3.m3.1.1.4.3.cmml">ℒ</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.SS5.p1.3.m3.1b"><apply id="A1.SS5.p1.3.m3.1.1.cmml" xref="A1.SS5.p1.3.m3.1.1"><times id="A1.SS5.p1.3.m3.1.1.1.cmml" xref="A1.SS5.p1.3.m3.1.1.1"></times><apply id="A1.SS5.p1.3.m3.1.1.2.cmml" xref="A1.SS5.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="A1.SS5.p1.3.m3.1.1.2.1.cmml" xref="A1.SS5.p1.3.m3.1.1.2">superscript</csymbol><apply id="A1.SS5.p1.3.m3.1.1.2.2.cmml" xref="A1.SS5.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="A1.SS5.p1.3.m3.1.1.2.2.1.cmml" xref="A1.SS5.p1.3.m3.1.1.2">subscript</csymbol><ci id="A1.SS5.p1.3.m3.1.1.2.2.2.cmml" xref="A1.SS5.p1.3.m3.1.1.2.2.2">𝑊</ci><ci id="A1.SS5.p1.3.m3.1.1.2.2.3.cmml" xref="A1.SS5.p1.3.m3.1.1.2.2.3">𝑄</ci></apply><apply id="A1.SS5.p1.3.m3.1.1.2.3.cmml" xref="A1.SS5.p1.3.m3.1.1.2.3"><csymbol cd="latexml" id="A1.SS5.p1.3.m3.1.1.2.3.1.cmml" xref="A1.SS5.p1.3.m3.1.1.2.3">limit-from</csymbol><ci id="A1.SS5.p1.3.m3.1.1.2.3.2.cmml" xref="A1.SS5.p1.3.m3.1.1.2.3.2">ℎ</ci><csymbol cd="latexml" id="A1.SS5.p1.3.m3.1.1.2.3.3.cmml" xref="A1.SS5.p1.3.m3.1.1.2.3.3">top</csymbol></apply></apply><apply id="A1.SS5.p1.3.m3.1.1.3.cmml" xref="A1.SS5.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="A1.SS5.p1.3.m3.1.1.3.1.cmml" xref="A1.SS5.p1.3.m3.1.1.3">superscript</csymbol><apply id="A1.SS5.p1.3.m3.1.1.3.2.cmml" xref="A1.SS5.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="A1.SS5.p1.3.m3.1.1.3.2.1.cmml" xref="A1.SS5.p1.3.m3.1.1.3">subscript</csymbol><ci id="A1.SS5.p1.3.m3.1.1.3.2.2.cmml" xref="A1.SS5.p1.3.m3.1.1.3.2.2">𝑊</ci><ci id="A1.SS5.p1.3.m3.1.1.3.2.3.cmml" xref="A1.SS5.p1.3.m3.1.1.3.2.3">𝐾</ci></apply><ci id="A1.SS5.p1.3.m3.1.1.3.3.cmml" xref="A1.SS5.p1.3.m3.1.1.3.3">ℎ</ci></apply><apply id="A1.SS5.p1.3.m3.1.1.4.cmml" xref="A1.SS5.p1.3.m3.1.1.4"><csymbol cd="ambiguous" id="A1.SS5.p1.3.m3.1.1.4.1.cmml" xref="A1.SS5.p1.3.m3.1.1.4">subscript</csymbol><ci id="A1.SS5.p1.3.m3.1.1.4.2.cmml" xref="A1.SS5.p1.3.m3.1.1.4.2">𝐾</ci><ci id="A1.SS5.p1.3.m3.1.1.4.3.cmml" xref="A1.SS5.p1.3.m3.1.1.4.3">ℒ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.p1.3.m3.1c">W_{Q}^{h\top}W_{K}^{h}K_{\mathcal{L}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.p1.3.m3.1d">italic_W start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_h ⊤ end_POSTSUPERSCRIPT italic_W start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_h end_POSTSUPERSCRIPT italic_K start_POSTSUBSCRIPT caligraphic_L end_POSTSUBSCRIPT</annotation></semantics></math>, we conduct principal component analysis on them, and plot them on the plane of the first two components.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS5.p2">
<p class="ltx_p" id="A1.SS5.p2.4">For each point <math alttext="q\in\mathbb{R}^{2}" class="ltx_Math" display="inline" id="A1.SS5.p2.1.m1.1"><semantics id="A1.SS5.p2.1.m1.1a"><mrow id="A1.SS5.p2.1.m1.1.1" xref="A1.SS5.p2.1.m1.1.1.cmml"><mi id="A1.SS5.p2.1.m1.1.1.2" xref="A1.SS5.p2.1.m1.1.1.2.cmml">q</mi><mo id="A1.SS5.p2.1.m1.1.1.1" xref="A1.SS5.p2.1.m1.1.1.1.cmml">∈</mo><msup id="A1.SS5.p2.1.m1.1.1.3" xref="A1.SS5.p2.1.m1.1.1.3.cmml"><mi id="A1.SS5.p2.1.m1.1.1.3.2" xref="A1.SS5.p2.1.m1.1.1.3.2.cmml">ℝ</mi><mn id="A1.SS5.p2.1.m1.1.1.3.3" xref="A1.SS5.p2.1.m1.1.1.3.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS5.p2.1.m1.1b"><apply id="A1.SS5.p2.1.m1.1.1.cmml" xref="A1.SS5.p2.1.m1.1.1"><in id="A1.SS5.p2.1.m1.1.1.1.cmml" xref="A1.SS5.p2.1.m1.1.1.1"></in><ci id="A1.SS5.p2.1.m1.1.1.2.cmml" xref="A1.SS5.p2.1.m1.1.1.2">𝑞</ci><apply id="A1.SS5.p2.1.m1.1.1.3.cmml" xref="A1.SS5.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="A1.SS5.p2.1.m1.1.1.3.1.cmml" xref="A1.SS5.p2.1.m1.1.1.3">superscript</csymbol><ci id="A1.SS5.p2.1.m1.1.1.3.2.cmml" xref="A1.SS5.p2.1.m1.1.1.3.2">ℝ</ci><cn id="A1.SS5.p2.1.m1.1.1.3.3.cmml" type="integer" xref="A1.SS5.p2.1.m1.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.p2.1.m1.1c">q\in\mathbb{R}^{2}</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.p2.1.m1.1d">italic_q ∈ blackboard_R start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> on the principal component plane, we calculate the attention assignment as follows. Give the index set of “positive” label token in <math alttext="K_{\mathcal{L}}" class="ltx_Math" display="inline" id="A1.SS5.p2.2.m2.1"><semantics id="A1.SS5.p2.2.m2.1a"><msub id="A1.SS5.p2.2.m2.1.1" xref="A1.SS5.p2.2.m2.1.1.cmml"><mi id="A1.SS5.p2.2.m2.1.1.2" xref="A1.SS5.p2.2.m2.1.1.2.cmml">K</mi><mi class="ltx_font_mathcaligraphic" id="A1.SS5.p2.2.m2.1.1.3" xref="A1.SS5.p2.2.m2.1.1.3.cmml">ℒ</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS5.p2.2.m2.1b"><apply id="A1.SS5.p2.2.m2.1.1.cmml" xref="A1.SS5.p2.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS5.p2.2.m2.1.1.1.cmml" xref="A1.SS5.p2.2.m2.1.1">subscript</csymbol><ci id="A1.SS5.p2.2.m2.1.1.2.cmml" xref="A1.SS5.p2.2.m2.1.1.2">𝐾</ci><ci id="A1.SS5.p2.2.m2.1.1.3.cmml" xref="A1.SS5.p2.2.m2.1.1.3">ℒ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.p2.2.m2.1c">K_{\mathcal{L}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.p2.2.m2.1d">italic_K start_POSTSUBSCRIPT caligraphic_L end_POSTSUBSCRIPT</annotation></semantics></math> as <math alttext="\mathcal{L}^{+}" class="ltx_Math" display="inline" id="A1.SS5.p2.3.m3.1"><semantics id="A1.SS5.p2.3.m3.1a"><msup id="A1.SS5.p2.3.m3.1.1" xref="A1.SS5.p2.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS5.p2.3.m3.1.1.2" xref="A1.SS5.p2.3.m3.1.1.2.cmml">ℒ</mi><mo id="A1.SS5.p2.3.m3.1.1.3" xref="A1.SS5.p2.3.m3.1.1.3.cmml">+</mo></msup><annotation-xml encoding="MathML-Content" id="A1.SS5.p2.3.m3.1b"><apply id="A1.SS5.p2.3.m3.1.1.cmml" xref="A1.SS5.p2.3.m3.1.1"><csymbol cd="ambiguous" id="A1.SS5.p2.3.m3.1.1.1.cmml" xref="A1.SS5.p2.3.m3.1.1">superscript</csymbol><ci id="A1.SS5.p2.3.m3.1.1.2.cmml" xref="A1.SS5.p2.3.m3.1.1.2">ℒ</ci><plus id="A1.SS5.p2.3.m3.1.1.3.cmml" xref="A1.SS5.p2.3.m3.1.1.3"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.p2.3.m3.1c">\mathcal{L}^{+}</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.p2.3.m3.1d">caligraphic_L start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT</annotation></semantics></math>, the index set of “negative” label token as <math alttext="\mathcal{L}^{-}" class="ltx_Math" display="inline" id="A1.SS5.p2.4.m4.1"><semantics id="A1.SS5.p2.4.m4.1a"><msup id="A1.SS5.p2.4.m4.1.1" xref="A1.SS5.p2.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS5.p2.4.m4.1.1.2" xref="A1.SS5.p2.4.m4.1.1.2.cmml">ℒ</mi><mo id="A1.SS5.p2.4.m4.1.1.3" xref="A1.SS5.p2.4.m4.1.1.3.cmml">−</mo></msup><annotation-xml encoding="MathML-Content" id="A1.SS5.p2.4.m4.1b"><apply id="A1.SS5.p2.4.m4.1.1.cmml" xref="A1.SS5.p2.4.m4.1.1"><csymbol cd="ambiguous" id="A1.SS5.p2.4.m4.1.1.1.cmml" xref="A1.SS5.p2.4.m4.1.1">superscript</csymbol><ci id="A1.SS5.p2.4.m4.1.1.2.cmml" xref="A1.SS5.p2.4.m4.1.1.2">ℒ</ci><minus id="A1.SS5.p2.4.m4.1.1.3.cmml" xref="A1.SS5.p2.4.m4.1.1.3"></minus></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.p2.4.m4.1c">\mathcal{L}^{-}</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.p2.4.m4.1d">caligraphic_L start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT</annotation></semantics></math>, we calculate the attention assignment, which can be an estimate of ICL prediction&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Wang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib39" title="">2023</a>)</cite>, as:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="A1.E17">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathrm{AttAssign}(q)=\sum_{i\in\mathcal{L}^{+}}q^{\top}W_{Q}^{h\top}W_{K}^{h}%
K_{\mathcal{L}|i}-\sum_{i\in\mathcal{L}^{-}}q^{\top}W_{Q}^{h\top}W_{K}^{h}K_{%
\mathcal{L}|i}." class="ltx_Math" display="block" id="A1.E17.m1.2"><semantics id="A1.E17.m1.2a"><mrow id="A1.E17.m1.2.2.1" xref="A1.E17.m1.2.2.1.1.cmml"><mrow id="A1.E17.m1.2.2.1.1" xref="A1.E17.m1.2.2.1.1.cmml"><mrow id="A1.E17.m1.2.2.1.1.2" xref="A1.E17.m1.2.2.1.1.2.cmml"><mi id="A1.E17.m1.2.2.1.1.2.2" xref="A1.E17.m1.2.2.1.1.2.2.cmml">AttAssign</mi><mo id="A1.E17.m1.2.2.1.1.2.1" xref="A1.E17.m1.2.2.1.1.2.1.cmml">⁢</mo><mrow id="A1.E17.m1.2.2.1.1.2.3.2" xref="A1.E17.m1.2.2.1.1.2.cmml"><mo id="A1.E17.m1.2.2.1.1.2.3.2.1" stretchy="false" xref="A1.E17.m1.2.2.1.1.2.cmml">(</mo><mi id="A1.E17.m1.1.1" xref="A1.E17.m1.1.1.cmml">q</mi><mo id="A1.E17.m1.2.2.1.1.2.3.2.2" stretchy="false" xref="A1.E17.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.E17.m1.2.2.1.1.1" rspace="0.111em" xref="A1.E17.m1.2.2.1.1.1.cmml">=</mo><mrow id="A1.E17.m1.2.2.1.1.3" xref="A1.E17.m1.2.2.1.1.3.cmml"><mrow id="A1.E17.m1.2.2.1.1.3.2" xref="A1.E17.m1.2.2.1.1.3.2.cmml"><munder id="A1.E17.m1.2.2.1.1.3.2.1" xref="A1.E17.m1.2.2.1.1.3.2.1.cmml"><mo id="A1.E17.m1.2.2.1.1.3.2.1.2" movablelimits="false" xref="A1.E17.m1.2.2.1.1.3.2.1.2.cmml">∑</mo><mrow id="A1.E17.m1.2.2.1.1.3.2.1.3" xref="A1.E17.m1.2.2.1.1.3.2.1.3.cmml"><mi id="A1.E17.m1.2.2.1.1.3.2.1.3.2" xref="A1.E17.m1.2.2.1.1.3.2.1.3.2.cmml">i</mi><mo id="A1.E17.m1.2.2.1.1.3.2.1.3.1" xref="A1.E17.m1.2.2.1.1.3.2.1.3.1.cmml">∈</mo><msup id="A1.E17.m1.2.2.1.1.3.2.1.3.3" xref="A1.E17.m1.2.2.1.1.3.2.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E17.m1.2.2.1.1.3.2.1.3.3.2" xref="A1.E17.m1.2.2.1.1.3.2.1.3.3.2.cmml">ℒ</mi><mo id="A1.E17.m1.2.2.1.1.3.2.1.3.3.3" xref="A1.E17.m1.2.2.1.1.3.2.1.3.3.3.cmml">+</mo></msup></mrow></munder><mrow id="A1.E17.m1.2.2.1.1.3.2.2" xref="A1.E17.m1.2.2.1.1.3.2.2.cmml"><msup id="A1.E17.m1.2.2.1.1.3.2.2.2" xref="A1.E17.m1.2.2.1.1.3.2.2.2.cmml"><mi id="A1.E17.m1.2.2.1.1.3.2.2.2.2" xref="A1.E17.m1.2.2.1.1.3.2.2.2.2.cmml">q</mi><mo id="A1.E17.m1.2.2.1.1.3.2.2.2.3" xref="A1.E17.m1.2.2.1.1.3.2.2.2.3.cmml">⊤</mo></msup><mo id="A1.E17.m1.2.2.1.1.3.2.2.1" xref="A1.E17.m1.2.2.1.1.3.2.2.1.cmml">⁢</mo><msubsup id="A1.E17.m1.2.2.1.1.3.2.2.3" xref="A1.E17.m1.2.2.1.1.3.2.2.3.cmml"><mi id="A1.E17.m1.2.2.1.1.3.2.2.3.2.2" xref="A1.E17.m1.2.2.1.1.3.2.2.3.2.2.cmml">W</mi><mi id="A1.E17.m1.2.2.1.1.3.2.2.3.2.3" xref="A1.E17.m1.2.2.1.1.3.2.2.3.2.3.cmml">Q</mi><mrow id="A1.E17.m1.2.2.1.1.3.2.2.3.3" xref="A1.E17.m1.2.2.1.1.3.2.2.3.3.cmml"><mi id="A1.E17.m1.2.2.1.1.3.2.2.3.3.2" xref="A1.E17.m1.2.2.1.1.3.2.2.3.3.2.cmml">h</mi><mo id="A1.E17.m1.2.2.1.1.3.2.2.3.3.3" lspace="0.222em" xref="A1.E17.m1.2.2.1.1.3.2.2.3.3.3.cmml">⊤</mo></mrow></msubsup><mo id="A1.E17.m1.2.2.1.1.3.2.2.1a" xref="A1.E17.m1.2.2.1.1.3.2.2.1.cmml">⁢</mo><msubsup id="A1.E17.m1.2.2.1.1.3.2.2.4" xref="A1.E17.m1.2.2.1.1.3.2.2.4.cmml"><mi id="A1.E17.m1.2.2.1.1.3.2.2.4.2.2" xref="A1.E17.m1.2.2.1.1.3.2.2.4.2.2.cmml">W</mi><mi id="A1.E17.m1.2.2.1.1.3.2.2.4.2.3" xref="A1.E17.m1.2.2.1.1.3.2.2.4.2.3.cmml">K</mi><mi id="A1.E17.m1.2.2.1.1.3.2.2.4.3" xref="A1.E17.m1.2.2.1.1.3.2.2.4.3.cmml">h</mi></msubsup><mo id="A1.E17.m1.2.2.1.1.3.2.2.1b" xref="A1.E17.m1.2.2.1.1.3.2.2.1.cmml">⁢</mo><msub id="A1.E17.m1.2.2.1.1.3.2.2.5" xref="A1.E17.m1.2.2.1.1.3.2.2.5.cmml"><mi id="A1.E17.m1.2.2.1.1.3.2.2.5.2" xref="A1.E17.m1.2.2.1.1.3.2.2.5.2.cmml">K</mi><mrow id="A1.E17.m1.2.2.1.1.3.2.2.5.3" xref="A1.E17.m1.2.2.1.1.3.2.2.5.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E17.m1.2.2.1.1.3.2.2.5.3.2" xref="A1.E17.m1.2.2.1.1.3.2.2.5.3.2.cmml">ℒ</mi><mo fence="false" id="A1.E17.m1.2.2.1.1.3.2.2.5.3.1" xref="A1.E17.m1.2.2.1.1.3.2.2.5.3.1.cmml">|</mo><mi id="A1.E17.m1.2.2.1.1.3.2.2.5.3.3" xref="A1.E17.m1.2.2.1.1.3.2.2.5.3.3.cmml">i</mi></mrow></msub></mrow></mrow><mo id="A1.E17.m1.2.2.1.1.3.1" rspace="0.055em" xref="A1.E17.m1.2.2.1.1.3.1.cmml">−</mo><mrow id="A1.E17.m1.2.2.1.1.3.3" xref="A1.E17.m1.2.2.1.1.3.3.cmml"><munder id="A1.E17.m1.2.2.1.1.3.3.1" xref="A1.E17.m1.2.2.1.1.3.3.1.cmml"><mo id="A1.E17.m1.2.2.1.1.3.3.1.2" movablelimits="false" xref="A1.E17.m1.2.2.1.1.3.3.1.2.cmml">∑</mo><mrow id="A1.E17.m1.2.2.1.1.3.3.1.3" xref="A1.E17.m1.2.2.1.1.3.3.1.3.cmml"><mi id="A1.E17.m1.2.2.1.1.3.3.1.3.2" xref="A1.E17.m1.2.2.1.1.3.3.1.3.2.cmml">i</mi><mo id="A1.E17.m1.2.2.1.1.3.3.1.3.1" xref="A1.E17.m1.2.2.1.1.3.3.1.3.1.cmml">∈</mo><msup id="A1.E17.m1.2.2.1.1.3.3.1.3.3" xref="A1.E17.m1.2.2.1.1.3.3.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E17.m1.2.2.1.1.3.3.1.3.3.2" xref="A1.E17.m1.2.2.1.1.3.3.1.3.3.2.cmml">ℒ</mi><mo id="A1.E17.m1.2.2.1.1.3.3.1.3.3.3" xref="A1.E17.m1.2.2.1.1.3.3.1.3.3.3.cmml">−</mo></msup></mrow></munder><mrow id="A1.E17.m1.2.2.1.1.3.3.2" xref="A1.E17.m1.2.2.1.1.3.3.2.cmml"><msup id="A1.E17.m1.2.2.1.1.3.3.2.2" xref="A1.E17.m1.2.2.1.1.3.3.2.2.cmml"><mi id="A1.E17.m1.2.2.1.1.3.3.2.2.2" xref="A1.E17.m1.2.2.1.1.3.3.2.2.2.cmml">q</mi><mo id="A1.E17.m1.2.2.1.1.3.3.2.2.3" xref="A1.E17.m1.2.2.1.1.3.3.2.2.3.cmml">⊤</mo></msup><mo id="A1.E17.m1.2.2.1.1.3.3.2.1" xref="A1.E17.m1.2.2.1.1.3.3.2.1.cmml">⁢</mo><msubsup id="A1.E17.m1.2.2.1.1.3.3.2.3" xref="A1.E17.m1.2.2.1.1.3.3.2.3.cmml"><mi id="A1.E17.m1.2.2.1.1.3.3.2.3.2.2" xref="A1.E17.m1.2.2.1.1.3.3.2.3.2.2.cmml">W</mi><mi id="A1.E17.m1.2.2.1.1.3.3.2.3.2.3" xref="A1.E17.m1.2.2.1.1.3.3.2.3.2.3.cmml">Q</mi><mrow id="A1.E17.m1.2.2.1.1.3.3.2.3.3" xref="A1.E17.m1.2.2.1.1.3.3.2.3.3.cmml"><mi id="A1.E17.m1.2.2.1.1.3.3.2.3.3.2" xref="A1.E17.m1.2.2.1.1.3.3.2.3.3.2.cmml">h</mi><mo id="A1.E17.m1.2.2.1.1.3.3.2.3.3.3" lspace="0.222em" xref="A1.E17.m1.2.2.1.1.3.3.2.3.3.3.cmml">⊤</mo></mrow></msubsup><mo id="A1.E17.m1.2.2.1.1.3.3.2.1a" xref="A1.E17.m1.2.2.1.1.3.3.2.1.cmml">⁢</mo><msubsup id="A1.E17.m1.2.2.1.1.3.3.2.4" xref="A1.E17.m1.2.2.1.1.3.3.2.4.cmml"><mi id="A1.E17.m1.2.2.1.1.3.3.2.4.2.2" xref="A1.E17.m1.2.2.1.1.3.3.2.4.2.2.cmml">W</mi><mi id="A1.E17.m1.2.2.1.1.3.3.2.4.2.3" xref="A1.E17.m1.2.2.1.1.3.3.2.4.2.3.cmml">K</mi><mi id="A1.E17.m1.2.2.1.1.3.3.2.4.3" xref="A1.E17.m1.2.2.1.1.3.3.2.4.3.cmml">h</mi></msubsup><mo id="A1.E17.m1.2.2.1.1.3.3.2.1b" xref="A1.E17.m1.2.2.1.1.3.3.2.1.cmml">⁢</mo><msub id="A1.E17.m1.2.2.1.1.3.3.2.5" xref="A1.E17.m1.2.2.1.1.3.3.2.5.cmml"><mi id="A1.E17.m1.2.2.1.1.3.3.2.5.2" xref="A1.E17.m1.2.2.1.1.3.3.2.5.2.cmml">K</mi><mrow id="A1.E17.m1.2.2.1.1.3.3.2.5.3" xref="A1.E17.m1.2.2.1.1.3.3.2.5.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E17.m1.2.2.1.1.3.3.2.5.3.2" xref="A1.E17.m1.2.2.1.1.3.3.2.5.3.2.cmml">ℒ</mi><mo fence="false" id="A1.E17.m1.2.2.1.1.3.3.2.5.3.1" xref="A1.E17.m1.2.2.1.1.3.3.2.5.3.1.cmml">|</mo><mi id="A1.E17.m1.2.2.1.1.3.3.2.5.3.3" xref="A1.E17.m1.2.2.1.1.3.3.2.5.3.3.cmml">i</mi></mrow></msub></mrow></mrow></mrow></mrow><mo id="A1.E17.m1.2.2.1.2" lspace="0em" xref="A1.E17.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E17.m1.2b"><apply id="A1.E17.m1.2.2.1.1.cmml" xref="A1.E17.m1.2.2.1"><eq id="A1.E17.m1.2.2.1.1.1.cmml" xref="A1.E17.m1.2.2.1.1.1"></eq><apply id="A1.E17.m1.2.2.1.1.2.cmml" xref="A1.E17.m1.2.2.1.1.2"><times id="A1.E17.m1.2.2.1.1.2.1.cmml" xref="A1.E17.m1.2.2.1.1.2.1"></times><ci id="A1.E17.m1.2.2.1.1.2.2.cmml" xref="A1.E17.m1.2.2.1.1.2.2">AttAssign</ci><ci id="A1.E17.m1.1.1.cmml" xref="A1.E17.m1.1.1">𝑞</ci></apply><apply id="A1.E17.m1.2.2.1.1.3.cmml" xref="A1.E17.m1.2.2.1.1.3"><minus id="A1.E17.m1.2.2.1.1.3.1.cmml" xref="A1.E17.m1.2.2.1.1.3.1"></minus><apply id="A1.E17.m1.2.2.1.1.3.2.cmml" xref="A1.E17.m1.2.2.1.1.3.2"><apply id="A1.E17.m1.2.2.1.1.3.2.1.cmml" xref="A1.E17.m1.2.2.1.1.3.2.1"><csymbol cd="ambiguous" id="A1.E17.m1.2.2.1.1.3.2.1.1.cmml" xref="A1.E17.m1.2.2.1.1.3.2.1">subscript</csymbol><sum id="A1.E17.m1.2.2.1.1.3.2.1.2.cmml" xref="A1.E17.m1.2.2.1.1.3.2.1.2"></sum><apply id="A1.E17.m1.2.2.1.1.3.2.1.3.cmml" xref="A1.E17.m1.2.2.1.1.3.2.1.3"><in id="A1.E17.m1.2.2.1.1.3.2.1.3.1.cmml" xref="A1.E17.m1.2.2.1.1.3.2.1.3.1"></in><ci id="A1.E17.m1.2.2.1.1.3.2.1.3.2.cmml" xref="A1.E17.m1.2.2.1.1.3.2.1.3.2">𝑖</ci><apply id="A1.E17.m1.2.2.1.1.3.2.1.3.3.cmml" xref="A1.E17.m1.2.2.1.1.3.2.1.3.3"><csymbol cd="ambiguous" id="A1.E17.m1.2.2.1.1.3.2.1.3.3.1.cmml" xref="A1.E17.m1.2.2.1.1.3.2.1.3.3">superscript</csymbol><ci id="A1.E17.m1.2.2.1.1.3.2.1.3.3.2.cmml" xref="A1.E17.m1.2.2.1.1.3.2.1.3.3.2">ℒ</ci><plus id="A1.E17.m1.2.2.1.1.3.2.1.3.3.3.cmml" xref="A1.E17.m1.2.2.1.1.3.2.1.3.3.3"></plus></apply></apply></apply><apply id="A1.E17.m1.2.2.1.1.3.2.2.cmml" xref="A1.E17.m1.2.2.1.1.3.2.2"><times id="A1.E17.m1.2.2.1.1.3.2.2.1.cmml" xref="A1.E17.m1.2.2.1.1.3.2.2.1"></times><apply id="A1.E17.m1.2.2.1.1.3.2.2.2.cmml" xref="A1.E17.m1.2.2.1.1.3.2.2.2"><csymbol cd="ambiguous" id="A1.E17.m1.2.2.1.1.3.2.2.2.1.cmml" xref="A1.E17.m1.2.2.1.1.3.2.2.2">superscript</csymbol><ci id="A1.E17.m1.2.2.1.1.3.2.2.2.2.cmml" xref="A1.E17.m1.2.2.1.1.3.2.2.2.2">𝑞</ci><csymbol cd="latexml" id="A1.E17.m1.2.2.1.1.3.2.2.2.3.cmml" xref="A1.E17.m1.2.2.1.1.3.2.2.2.3">top</csymbol></apply><apply id="A1.E17.m1.2.2.1.1.3.2.2.3.cmml" xref="A1.E17.m1.2.2.1.1.3.2.2.3"><csymbol cd="ambiguous" id="A1.E17.m1.2.2.1.1.3.2.2.3.1.cmml" xref="A1.E17.m1.2.2.1.1.3.2.2.3">superscript</csymbol><apply id="A1.E17.m1.2.2.1.1.3.2.2.3.2.cmml" xref="A1.E17.m1.2.2.1.1.3.2.2.3"><csymbol cd="ambiguous" id="A1.E17.m1.2.2.1.1.3.2.2.3.2.1.cmml" xref="A1.E17.m1.2.2.1.1.3.2.2.3">subscript</csymbol><ci id="A1.E17.m1.2.2.1.1.3.2.2.3.2.2.cmml" xref="A1.E17.m1.2.2.1.1.3.2.2.3.2.2">𝑊</ci><ci id="A1.E17.m1.2.2.1.1.3.2.2.3.2.3.cmml" xref="A1.E17.m1.2.2.1.1.3.2.2.3.2.3">𝑄</ci></apply><apply id="A1.E17.m1.2.2.1.1.3.2.2.3.3.cmml" xref="A1.E17.m1.2.2.1.1.3.2.2.3.3"><csymbol cd="latexml" id="A1.E17.m1.2.2.1.1.3.2.2.3.3.1.cmml" xref="A1.E17.m1.2.2.1.1.3.2.2.3.3">limit-from</csymbol><ci id="A1.E17.m1.2.2.1.1.3.2.2.3.3.2.cmml" xref="A1.E17.m1.2.2.1.1.3.2.2.3.3.2">ℎ</ci><csymbol cd="latexml" id="A1.E17.m1.2.2.1.1.3.2.2.3.3.3.cmml" xref="A1.E17.m1.2.2.1.1.3.2.2.3.3.3">top</csymbol></apply></apply><apply id="A1.E17.m1.2.2.1.1.3.2.2.4.cmml" xref="A1.E17.m1.2.2.1.1.3.2.2.4"><csymbol cd="ambiguous" id="A1.E17.m1.2.2.1.1.3.2.2.4.1.cmml" xref="A1.E17.m1.2.2.1.1.3.2.2.4">superscript</csymbol><apply id="A1.E17.m1.2.2.1.1.3.2.2.4.2.cmml" xref="A1.E17.m1.2.2.1.1.3.2.2.4"><csymbol cd="ambiguous" id="A1.E17.m1.2.2.1.1.3.2.2.4.2.1.cmml" xref="A1.E17.m1.2.2.1.1.3.2.2.4">subscript</csymbol><ci id="A1.E17.m1.2.2.1.1.3.2.2.4.2.2.cmml" xref="A1.E17.m1.2.2.1.1.3.2.2.4.2.2">𝑊</ci><ci id="A1.E17.m1.2.2.1.1.3.2.2.4.2.3.cmml" xref="A1.E17.m1.2.2.1.1.3.2.2.4.2.3">𝐾</ci></apply><ci id="A1.E17.m1.2.2.1.1.3.2.2.4.3.cmml" xref="A1.E17.m1.2.2.1.1.3.2.2.4.3">ℎ</ci></apply><apply id="A1.E17.m1.2.2.1.1.3.2.2.5.cmml" xref="A1.E17.m1.2.2.1.1.3.2.2.5"><csymbol cd="ambiguous" id="A1.E17.m1.2.2.1.1.3.2.2.5.1.cmml" xref="A1.E17.m1.2.2.1.1.3.2.2.5">subscript</csymbol><ci id="A1.E17.m1.2.2.1.1.3.2.2.5.2.cmml" xref="A1.E17.m1.2.2.1.1.3.2.2.5.2">𝐾</ci><apply id="A1.E17.m1.2.2.1.1.3.2.2.5.3.cmml" xref="A1.E17.m1.2.2.1.1.3.2.2.5.3"><csymbol cd="latexml" id="A1.E17.m1.2.2.1.1.3.2.2.5.3.1.cmml" xref="A1.E17.m1.2.2.1.1.3.2.2.5.3.1">conditional</csymbol><ci id="A1.E17.m1.2.2.1.1.3.2.2.5.3.2.cmml" xref="A1.E17.m1.2.2.1.1.3.2.2.5.3.2">ℒ</ci><ci id="A1.E17.m1.2.2.1.1.3.2.2.5.3.3.cmml" xref="A1.E17.m1.2.2.1.1.3.2.2.5.3.3">𝑖</ci></apply></apply></apply></apply><apply id="A1.E17.m1.2.2.1.1.3.3.cmml" xref="A1.E17.m1.2.2.1.1.3.3"><apply id="A1.E17.m1.2.2.1.1.3.3.1.cmml" xref="A1.E17.m1.2.2.1.1.3.3.1"><csymbol cd="ambiguous" id="A1.E17.m1.2.2.1.1.3.3.1.1.cmml" xref="A1.E17.m1.2.2.1.1.3.3.1">subscript</csymbol><sum id="A1.E17.m1.2.2.1.1.3.3.1.2.cmml" xref="A1.E17.m1.2.2.1.1.3.3.1.2"></sum><apply id="A1.E17.m1.2.2.1.1.3.3.1.3.cmml" xref="A1.E17.m1.2.2.1.1.3.3.1.3"><in id="A1.E17.m1.2.2.1.1.3.3.1.3.1.cmml" xref="A1.E17.m1.2.2.1.1.3.3.1.3.1"></in><ci id="A1.E17.m1.2.2.1.1.3.3.1.3.2.cmml" xref="A1.E17.m1.2.2.1.1.3.3.1.3.2">𝑖</ci><apply id="A1.E17.m1.2.2.1.1.3.3.1.3.3.cmml" xref="A1.E17.m1.2.2.1.1.3.3.1.3.3"><csymbol cd="ambiguous" id="A1.E17.m1.2.2.1.1.3.3.1.3.3.1.cmml" xref="A1.E17.m1.2.2.1.1.3.3.1.3.3">superscript</csymbol><ci id="A1.E17.m1.2.2.1.1.3.3.1.3.3.2.cmml" xref="A1.E17.m1.2.2.1.1.3.3.1.3.3.2">ℒ</ci><minus id="A1.E17.m1.2.2.1.1.3.3.1.3.3.3.cmml" xref="A1.E17.m1.2.2.1.1.3.3.1.3.3.3"></minus></apply></apply></apply><apply id="A1.E17.m1.2.2.1.1.3.3.2.cmml" xref="A1.E17.m1.2.2.1.1.3.3.2"><times id="A1.E17.m1.2.2.1.1.3.3.2.1.cmml" xref="A1.E17.m1.2.2.1.1.3.3.2.1"></times><apply id="A1.E17.m1.2.2.1.1.3.3.2.2.cmml" xref="A1.E17.m1.2.2.1.1.3.3.2.2"><csymbol cd="ambiguous" id="A1.E17.m1.2.2.1.1.3.3.2.2.1.cmml" xref="A1.E17.m1.2.2.1.1.3.3.2.2">superscript</csymbol><ci id="A1.E17.m1.2.2.1.1.3.3.2.2.2.cmml" xref="A1.E17.m1.2.2.1.1.3.3.2.2.2">𝑞</ci><csymbol cd="latexml" id="A1.E17.m1.2.2.1.1.3.3.2.2.3.cmml" xref="A1.E17.m1.2.2.1.1.3.3.2.2.3">top</csymbol></apply><apply id="A1.E17.m1.2.2.1.1.3.3.2.3.cmml" xref="A1.E17.m1.2.2.1.1.3.3.2.3"><csymbol cd="ambiguous" id="A1.E17.m1.2.2.1.1.3.3.2.3.1.cmml" xref="A1.E17.m1.2.2.1.1.3.3.2.3">superscript</csymbol><apply id="A1.E17.m1.2.2.1.1.3.3.2.3.2.cmml" xref="A1.E17.m1.2.2.1.1.3.3.2.3"><csymbol cd="ambiguous" id="A1.E17.m1.2.2.1.1.3.3.2.3.2.1.cmml" xref="A1.E17.m1.2.2.1.1.3.3.2.3">subscript</csymbol><ci id="A1.E17.m1.2.2.1.1.3.3.2.3.2.2.cmml" xref="A1.E17.m1.2.2.1.1.3.3.2.3.2.2">𝑊</ci><ci id="A1.E17.m1.2.2.1.1.3.3.2.3.2.3.cmml" xref="A1.E17.m1.2.2.1.1.3.3.2.3.2.3">𝑄</ci></apply><apply id="A1.E17.m1.2.2.1.1.3.3.2.3.3.cmml" xref="A1.E17.m1.2.2.1.1.3.3.2.3.3"><csymbol cd="latexml" id="A1.E17.m1.2.2.1.1.3.3.2.3.3.1.cmml" xref="A1.E17.m1.2.2.1.1.3.3.2.3.3">limit-from</csymbol><ci id="A1.E17.m1.2.2.1.1.3.3.2.3.3.2.cmml" xref="A1.E17.m1.2.2.1.1.3.3.2.3.3.2">ℎ</ci><csymbol cd="latexml" id="A1.E17.m1.2.2.1.1.3.3.2.3.3.3.cmml" xref="A1.E17.m1.2.2.1.1.3.3.2.3.3.3">top</csymbol></apply></apply><apply id="A1.E17.m1.2.2.1.1.3.3.2.4.cmml" xref="A1.E17.m1.2.2.1.1.3.3.2.4"><csymbol cd="ambiguous" id="A1.E17.m1.2.2.1.1.3.3.2.4.1.cmml" xref="A1.E17.m1.2.2.1.1.3.3.2.4">superscript</csymbol><apply id="A1.E17.m1.2.2.1.1.3.3.2.4.2.cmml" xref="A1.E17.m1.2.2.1.1.3.3.2.4"><csymbol cd="ambiguous" id="A1.E17.m1.2.2.1.1.3.3.2.4.2.1.cmml" xref="A1.E17.m1.2.2.1.1.3.3.2.4">subscript</csymbol><ci id="A1.E17.m1.2.2.1.1.3.3.2.4.2.2.cmml" xref="A1.E17.m1.2.2.1.1.3.3.2.4.2.2">𝑊</ci><ci id="A1.E17.m1.2.2.1.1.3.3.2.4.2.3.cmml" xref="A1.E17.m1.2.2.1.1.3.3.2.4.2.3">𝐾</ci></apply><ci id="A1.E17.m1.2.2.1.1.3.3.2.4.3.cmml" xref="A1.E17.m1.2.2.1.1.3.3.2.4.3">ℎ</ci></apply><apply id="A1.E17.m1.2.2.1.1.3.3.2.5.cmml" xref="A1.E17.m1.2.2.1.1.3.3.2.5"><csymbol cd="ambiguous" id="A1.E17.m1.2.2.1.1.3.3.2.5.1.cmml" xref="A1.E17.m1.2.2.1.1.3.3.2.5">subscript</csymbol><ci id="A1.E17.m1.2.2.1.1.3.3.2.5.2.cmml" xref="A1.E17.m1.2.2.1.1.3.3.2.5.2">𝐾</ci><apply id="A1.E17.m1.2.2.1.1.3.3.2.5.3.cmml" xref="A1.E17.m1.2.2.1.1.3.3.2.5.3"><csymbol cd="latexml" id="A1.E17.m1.2.2.1.1.3.3.2.5.3.1.cmml" xref="A1.E17.m1.2.2.1.1.3.3.2.5.3.1">conditional</csymbol><ci id="A1.E17.m1.2.2.1.1.3.3.2.5.3.2.cmml" xref="A1.E17.m1.2.2.1.1.3.3.2.5.3.2">ℒ</ci><ci id="A1.E17.m1.2.2.1.1.3.3.2.5.3.3.cmml" xref="A1.E17.m1.2.2.1.1.3.3.2.5.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E17.m1.2c">\mathrm{AttAssign}(q)=\sum_{i\in\mathcal{L}^{+}}q^{\top}W_{Q}^{h\top}W_{K}^{h}%
K_{\mathcal{L}|i}-\sum_{i\in\mathcal{L}^{-}}q^{\top}W_{Q}^{h\top}W_{K}^{h}K_{%
\mathcal{L}|i}.</annotation><annotation encoding="application/x-llamapun" id="A1.E17.m1.2d">roman_AttAssign ( italic_q ) = ∑ start_POSTSUBSCRIPT italic_i ∈ caligraphic_L start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT end_POSTSUBSCRIPT italic_q start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_W start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_h ⊤ end_POSTSUPERSCRIPT italic_W start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_h end_POSTSUPERSCRIPT italic_K start_POSTSUBSCRIPT caligraphic_L | italic_i end_POSTSUBSCRIPT - ∑ start_POSTSUBSCRIPT italic_i ∈ caligraphic_L start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT end_POSTSUBSCRIPT italic_q start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_W start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_h ⊤ end_POSTSUPERSCRIPT italic_W start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_h end_POSTSUPERSCRIPT italic_K start_POSTSUBSCRIPT caligraphic_L | italic_i end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(17)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS5.p2.5">We map this value to the degree of blue color of each pixel. The larger the positive value, the bluer it is, and the smaller the negative value, the redder it is.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="A1.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.6 </span>Cartography Details of Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S5.F8" title="Figure 8 ‣ 5.2 Bypass Mechanism ‣ 5 Putting Things Together ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">8</span></a>
</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A1.SS6.p1">
<p class="ltx_p" id="A1.SS6.p1.1">For Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S5.F8" title="Figure 8 ‣ 5.2 Bypass Mechanism ‣ 5 Putting Things Together ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">8</span></a>, we calculate the magnitude of Step 1 as the finite differences of kernel alignment in Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S3.F2" title="Figure 2 ‣ 3.2 Text Summarization is Linear and Task-Relevant but Position-biased ‣ 3 Step 1, Summarize: Linear Representations in Hidden States ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">2</span></a> (Left, Forerunner Token of Label). We directly use the head counting of Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S4.F5" title="Figure 5 ‣ 4.1 Step 2, Forerunner Token Head: Copy from Text Feature to Label Token ‣ 4 Induction Circuits in Natural Language Models ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">5</span></a> (Middle) and Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S4.F6" title="Figure 6 ‣ 4.2 Step 3, Induction Head: Feature Retrieval on Task Subspace ‣ 4 Induction Circuits in Natural Language Models ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">6</span></a> (Left) as the magnitude of Steps 2 and 3. These data are regularized and converted into transparencies.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>LM Pre-training Dynamics Measured by ICL Circuit</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A2.p1">
<p class="ltx_p" id="A2.p1.1">We extend the discussion of pre-training dynamics in&nbsp;§<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S6" title="6 Conclusion and Discussion ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">6</span></a> here.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure ltx_align_floatright" id="A2.F10"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="202" id="A2.F10.g1" src="https://arxiv.org/html/2410.04468v1/x16.png" width="267">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span>Operating magnitude (normalized) and ICL accuracy w.r.t. pre-training steps on Pythia 6.9B and SST-2.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A2.p2">
<p class="ltx_p" id="A2.p2.1">One can divide a self-regression model into an early part and a later part, where the early part encodes the input into a hidden representation, and the later part decodes the hidden representation back to the input. So, the training object can also be divided into an encoding loss and a decoding loss. According to the discussion in&nbsp;§<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S6" title="6 Conclusion and Discussion ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">6</span></a>, the summarization operation (Step 1) can be classified as encoding, and the other two steps of the induction circuit can be classified as decoding. Intuitively, since the decoding operations require the encoding results as input, unless the encoding operation converges to a stable output, the decoding can not be trained since the input-output mapping is noised, causing unstable gradients to interfere with the training&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Liu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib25" title="">2020</a>)</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A2.p3">
<p class="ltx_p" id="A2.p3.1">We confirm such inference by a measurement in Pythia 6.9B&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Biderman et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib5" title="">2023</a>)</cite> as shown in Fig&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A2.F10" title="Figure 10 ‣ Appendix B LM Pre-training Dynamics Measured by ICL Circuit ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">10</span></a>, where: <span class="ltx_text ltx_font_bold" id="A2.p3.1.1">(1)</span>. The magnitude of the 3 operations is emergent in the early phase of pre-training (less than 10k steps), and is monotonically increasing, while the encoding operation has the fastest growth rate. <span class="ltx_text ltx_font_bold" id="A2.p3.1.2">(2)</span>. ICL capacity appearance after all three operations reaches a high level (around 50k steps, notice that the random accuracy is 0.5), while the curve morphology of the operating magnitude against the layer number (shown in Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A2.F11" title="Figure 11 ‣ B.1 Data Distribution Requirement Explained by Hidden State Multiplex ‣ Appendix B LM Pre-training Dynamics Measured by ICL Circuit ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">11</span></a>) is convergence to the last training step and also the main results in this paper. Such results suggest that: LMs start to produce the inner encoding in the very early steps of the pre-training, and can be an important fundamental in building the subsequent induction circuits, as explained in the previous works mentioned in&nbsp;§<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S2.SS1" title="2.1 Background &amp; Related Works ‣ 2 Preparation ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">2.1</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_subsection" id="A2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.1 </span>Data Distribution Requirement Explained by Hidden State Multiplex</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="A2.F11">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F11.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="188" id="A2.F11.sf1.g1" src="https://arxiv.org/html/2410.04468v1/x17.png" width="249">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F11.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="184" id="A2.F11.sf2.g1" src="https://arxiv.org/html/2410.04468v1/x18.png" width="249">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F11.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="192" id="A2.F11.sf3.g1" src="https://arxiv.org/html/2410.04468v1/x19.png" width="302">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 11: </span>The 3 operating magnitudes on Pythia 6.9B with various pre-training steps. <span class="ltx_text ltx_font_bold" id="A2.F11.4.1">Left:</span> Step 1, summarize; <span class="ltx_text ltx_font_bold" id="A2.F11.5.2">Middle:</span> Step 2, semantics merge; <span class="ltx_text ltx_font_bold" id="A2.F11.6.3">Right:</span> Step 3, feature retrieval and copy, measured by the correct induction head numbers.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A2.SS1.p1">
<p class="ltx_p" id="A2.SS1.p1.1">Moreover, the hidden space multiplexing in the induction operation observed in this paper can give a prototypical and phenomenological conjecture for the data distribution requirement found in the previous works&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Olsson et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib31" title="">2022</a>; Reddy, <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib35" title="">2024</a>; Singh et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib37" title="">2024b</a>)</cite>, where data with a large label space and various tasks can promote ICL and suppress <span class="ltx_text ltx_font_bold" id="A2.SS1.p1.1.1">I</span>n-<span class="ltx_text ltx_font_bold" id="A2.SS1.p1.1.2">w</span>eight <span class="ltx_text ltx_font_bold" id="A2.SS1.p1.1.3">L</span>earning (IWL), and vice versa. Intuitively, suppose the encoding inputted into the later layers is clustered by their labels (similar to the well-embedded input styles in the works above, confirmed in Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S3.F3" title="Figure 3 ‣ 3.2 Text Summarization is Linear and Task-Relevant but Position-biased ‣ 3 Step 1, Summarize: Linear Representations in Hidden States ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">3</span></a>). In that case, we can say a cluster center is the eigen-subspace of the corresponding label. Since attention only conducts dot-multiplication operations, let us assume that these eigen-subspaces are radially distributed.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure ltx_align_floatright" id="A2.F12"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="230" id="A2.F12.g1" src="https://arxiv.org/html/2410.04468v1/extracted/5905049/Figure/appendix_segmentation/segmentation_index1_3.png" width="258">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 12: </span>Attention matrix visualized on layer 2, head 53 in Llama 3 70B from an input case.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A2.SS1.p2">
<p class="ltx_p" id="A2.SS1.p2.13">During the training, (1) <span class="ltx_text ltx_font_bold" id="A2.SS1.p2.13.1">When the label space is small</span>, the trained attention heads only need to extract the projected length of the query on each label eigen-subspace. For each label, such operation has a parameters’ analytical solution with (<span class="ltx_text ltx_font_italic" id="A2.SS1.p2.13.2">encoding kernel</span>) <math alttext="W_{Q}^{\top}W_{K}=I" class="ltx_Math" display="inline" id="A2.SS1.p2.1.m1.1"><semantics id="A2.SS1.p2.1.m1.1a"><mrow id="A2.SS1.p2.1.m1.1.1" xref="A2.SS1.p2.1.m1.1.1.cmml"><mrow id="A2.SS1.p2.1.m1.1.1.2" xref="A2.SS1.p2.1.m1.1.1.2.cmml"><msubsup id="A2.SS1.p2.1.m1.1.1.2.2" xref="A2.SS1.p2.1.m1.1.1.2.2.cmml"><mi id="A2.SS1.p2.1.m1.1.1.2.2.2.2" xref="A2.SS1.p2.1.m1.1.1.2.2.2.2.cmml">W</mi><mi id="A2.SS1.p2.1.m1.1.1.2.2.2.3" xref="A2.SS1.p2.1.m1.1.1.2.2.2.3.cmml">Q</mi><mo id="A2.SS1.p2.1.m1.1.1.2.2.3" xref="A2.SS1.p2.1.m1.1.1.2.2.3.cmml">⊤</mo></msubsup><mo id="A2.SS1.p2.1.m1.1.1.2.1" xref="A2.SS1.p2.1.m1.1.1.2.1.cmml">⁢</mo><msub id="A2.SS1.p2.1.m1.1.1.2.3" xref="A2.SS1.p2.1.m1.1.1.2.3.cmml"><mi id="A2.SS1.p2.1.m1.1.1.2.3.2" xref="A2.SS1.p2.1.m1.1.1.2.3.2.cmml">W</mi><mi id="A2.SS1.p2.1.m1.1.1.2.3.3" xref="A2.SS1.p2.1.m1.1.1.2.3.3.cmml">K</mi></msub></mrow><mo id="A2.SS1.p2.1.m1.1.1.1" xref="A2.SS1.p2.1.m1.1.1.1.cmml">=</mo><mi id="A2.SS1.p2.1.m1.1.1.3" xref="A2.SS1.p2.1.m1.1.1.3.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p2.1.m1.1b"><apply id="A2.SS1.p2.1.m1.1.1.cmml" xref="A2.SS1.p2.1.m1.1.1"><eq id="A2.SS1.p2.1.m1.1.1.1.cmml" xref="A2.SS1.p2.1.m1.1.1.1"></eq><apply id="A2.SS1.p2.1.m1.1.1.2.cmml" xref="A2.SS1.p2.1.m1.1.1.2"><times id="A2.SS1.p2.1.m1.1.1.2.1.cmml" xref="A2.SS1.p2.1.m1.1.1.2.1"></times><apply id="A2.SS1.p2.1.m1.1.1.2.2.cmml" xref="A2.SS1.p2.1.m1.1.1.2.2"><csymbol cd="ambiguous" id="A2.SS1.p2.1.m1.1.1.2.2.1.cmml" xref="A2.SS1.p2.1.m1.1.1.2.2">superscript</csymbol><apply id="A2.SS1.p2.1.m1.1.1.2.2.2.cmml" xref="A2.SS1.p2.1.m1.1.1.2.2"><csymbol cd="ambiguous" id="A2.SS1.p2.1.m1.1.1.2.2.2.1.cmml" xref="A2.SS1.p2.1.m1.1.1.2.2">subscript</csymbol><ci id="A2.SS1.p2.1.m1.1.1.2.2.2.2.cmml" xref="A2.SS1.p2.1.m1.1.1.2.2.2.2">𝑊</ci><ci id="A2.SS1.p2.1.m1.1.1.2.2.2.3.cmml" xref="A2.SS1.p2.1.m1.1.1.2.2.2.3">𝑄</ci></apply><csymbol cd="latexml" id="A2.SS1.p2.1.m1.1.1.2.2.3.cmml" xref="A2.SS1.p2.1.m1.1.1.2.2.3">top</csymbol></apply><apply id="A2.SS1.p2.1.m1.1.1.2.3.cmml" xref="A2.SS1.p2.1.m1.1.1.2.3"><csymbol cd="ambiguous" id="A2.SS1.p2.1.m1.1.1.2.3.1.cmml" xref="A2.SS1.p2.1.m1.1.1.2.3">subscript</csymbol><ci id="A2.SS1.p2.1.m1.1.1.2.3.2.cmml" xref="A2.SS1.p2.1.m1.1.1.2.3.2">𝑊</ci><ci id="A2.SS1.p2.1.m1.1.1.2.3.3.cmml" xref="A2.SS1.p2.1.m1.1.1.2.3.3">𝐾</ci></apply></apply><ci id="A2.SS1.p2.1.m1.1.1.3.cmml" xref="A2.SS1.p2.1.m1.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p2.1.m1.1c">W_{Q}^{\top}W_{K}=I</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p2.1.m1.1d">italic_W start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_W start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT = italic_I</annotation></semantics></math> and (<span class="ltx_text ltx_font_italic" id="A2.SS1.p2.13.3">decoding transformation</span>) <math alttext="W_{O}W_{V}=o_{y}^{\top}e_{y}" class="ltx_Math" display="inline" id="A2.SS1.p2.2.m2.1"><semantics id="A2.SS1.p2.2.m2.1a"><mrow id="A2.SS1.p2.2.m2.1.1" xref="A2.SS1.p2.2.m2.1.1.cmml"><mrow id="A2.SS1.p2.2.m2.1.1.2" xref="A2.SS1.p2.2.m2.1.1.2.cmml"><msub id="A2.SS1.p2.2.m2.1.1.2.2" xref="A2.SS1.p2.2.m2.1.1.2.2.cmml"><mi id="A2.SS1.p2.2.m2.1.1.2.2.2" xref="A2.SS1.p2.2.m2.1.1.2.2.2.cmml">W</mi><mi id="A2.SS1.p2.2.m2.1.1.2.2.3" xref="A2.SS1.p2.2.m2.1.1.2.2.3.cmml">O</mi></msub><mo id="A2.SS1.p2.2.m2.1.1.2.1" xref="A2.SS1.p2.2.m2.1.1.2.1.cmml">⁢</mo><msub id="A2.SS1.p2.2.m2.1.1.2.3" xref="A2.SS1.p2.2.m2.1.1.2.3.cmml"><mi id="A2.SS1.p2.2.m2.1.1.2.3.2" xref="A2.SS1.p2.2.m2.1.1.2.3.2.cmml">W</mi><mi id="A2.SS1.p2.2.m2.1.1.2.3.3" xref="A2.SS1.p2.2.m2.1.1.2.3.3.cmml">V</mi></msub></mrow><mo id="A2.SS1.p2.2.m2.1.1.1" xref="A2.SS1.p2.2.m2.1.1.1.cmml">=</mo><mrow id="A2.SS1.p2.2.m2.1.1.3" xref="A2.SS1.p2.2.m2.1.1.3.cmml"><msubsup id="A2.SS1.p2.2.m2.1.1.3.2" xref="A2.SS1.p2.2.m2.1.1.3.2.cmml"><mi id="A2.SS1.p2.2.m2.1.1.3.2.2.2" xref="A2.SS1.p2.2.m2.1.1.3.2.2.2.cmml">o</mi><mi id="A2.SS1.p2.2.m2.1.1.3.2.2.3" xref="A2.SS1.p2.2.m2.1.1.3.2.2.3.cmml">y</mi><mo id="A2.SS1.p2.2.m2.1.1.3.2.3" xref="A2.SS1.p2.2.m2.1.1.3.2.3.cmml">⊤</mo></msubsup><mo id="A2.SS1.p2.2.m2.1.1.3.1" xref="A2.SS1.p2.2.m2.1.1.3.1.cmml">⁢</mo><msub id="A2.SS1.p2.2.m2.1.1.3.3" xref="A2.SS1.p2.2.m2.1.1.3.3.cmml"><mi id="A2.SS1.p2.2.m2.1.1.3.3.2" xref="A2.SS1.p2.2.m2.1.1.3.3.2.cmml">e</mi><mi id="A2.SS1.p2.2.m2.1.1.3.3.3" xref="A2.SS1.p2.2.m2.1.1.3.3.3.cmml">y</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p2.2.m2.1b"><apply id="A2.SS1.p2.2.m2.1.1.cmml" xref="A2.SS1.p2.2.m2.1.1"><eq id="A2.SS1.p2.2.m2.1.1.1.cmml" xref="A2.SS1.p2.2.m2.1.1.1"></eq><apply id="A2.SS1.p2.2.m2.1.1.2.cmml" xref="A2.SS1.p2.2.m2.1.1.2"><times id="A2.SS1.p2.2.m2.1.1.2.1.cmml" xref="A2.SS1.p2.2.m2.1.1.2.1"></times><apply id="A2.SS1.p2.2.m2.1.1.2.2.cmml" xref="A2.SS1.p2.2.m2.1.1.2.2"><csymbol cd="ambiguous" id="A2.SS1.p2.2.m2.1.1.2.2.1.cmml" xref="A2.SS1.p2.2.m2.1.1.2.2">subscript</csymbol><ci id="A2.SS1.p2.2.m2.1.1.2.2.2.cmml" xref="A2.SS1.p2.2.m2.1.1.2.2.2">𝑊</ci><ci id="A2.SS1.p2.2.m2.1.1.2.2.3.cmml" xref="A2.SS1.p2.2.m2.1.1.2.2.3">𝑂</ci></apply><apply id="A2.SS1.p2.2.m2.1.1.2.3.cmml" xref="A2.SS1.p2.2.m2.1.1.2.3"><csymbol cd="ambiguous" id="A2.SS1.p2.2.m2.1.1.2.3.1.cmml" xref="A2.SS1.p2.2.m2.1.1.2.3">subscript</csymbol><ci id="A2.SS1.p2.2.m2.1.1.2.3.2.cmml" xref="A2.SS1.p2.2.m2.1.1.2.3.2">𝑊</ci><ci id="A2.SS1.p2.2.m2.1.1.2.3.3.cmml" xref="A2.SS1.p2.2.m2.1.1.2.3.3">𝑉</ci></apply></apply><apply id="A2.SS1.p2.2.m2.1.1.3.cmml" xref="A2.SS1.p2.2.m2.1.1.3"><times id="A2.SS1.p2.2.m2.1.1.3.1.cmml" xref="A2.SS1.p2.2.m2.1.1.3.1"></times><apply id="A2.SS1.p2.2.m2.1.1.3.2.cmml" xref="A2.SS1.p2.2.m2.1.1.3.2"><csymbol cd="ambiguous" id="A2.SS1.p2.2.m2.1.1.3.2.1.cmml" xref="A2.SS1.p2.2.m2.1.1.3.2">superscript</csymbol><apply id="A2.SS1.p2.2.m2.1.1.3.2.2.cmml" xref="A2.SS1.p2.2.m2.1.1.3.2"><csymbol cd="ambiguous" id="A2.SS1.p2.2.m2.1.1.3.2.2.1.cmml" xref="A2.SS1.p2.2.m2.1.1.3.2">subscript</csymbol><ci id="A2.SS1.p2.2.m2.1.1.3.2.2.2.cmml" xref="A2.SS1.p2.2.m2.1.1.3.2.2.2">𝑜</ci><ci id="A2.SS1.p2.2.m2.1.1.3.2.2.3.cmml" xref="A2.SS1.p2.2.m2.1.1.3.2.2.3">𝑦</ci></apply><csymbol cd="latexml" id="A2.SS1.p2.2.m2.1.1.3.2.3.cmml" xref="A2.SS1.p2.2.m2.1.1.3.2.3">top</csymbol></apply><apply id="A2.SS1.p2.2.m2.1.1.3.3.cmml" xref="A2.SS1.p2.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="A2.SS1.p2.2.m2.1.1.3.3.1.cmml" xref="A2.SS1.p2.2.m2.1.1.3.3">subscript</csymbol><ci id="A2.SS1.p2.2.m2.1.1.3.3.2.cmml" xref="A2.SS1.p2.2.m2.1.1.3.3.2">𝑒</ci><ci id="A2.SS1.p2.2.m2.1.1.3.3.3.cmml" xref="A2.SS1.p2.2.m2.1.1.3.3.3">𝑦</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p2.2.m2.1c">W_{O}W_{V}=o_{y}^{\top}e_{y}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p2.2.m2.1d">italic_W start_POSTSUBSCRIPT italic_O end_POSTSUBSCRIPT italic_W start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT = italic_o start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_e start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT</annotation></semantics></math>, where <math alttext="o_{y}" class="ltx_Math" display="inline" id="A2.SS1.p2.3.m3.1"><semantics id="A2.SS1.p2.3.m3.1a"><msub id="A2.SS1.p2.3.m3.1.1" xref="A2.SS1.p2.3.m3.1.1.cmml"><mi id="A2.SS1.p2.3.m3.1.1.2" xref="A2.SS1.p2.3.m3.1.1.2.cmml">o</mi><mi id="A2.SS1.p2.3.m3.1.1.3" xref="A2.SS1.p2.3.m3.1.1.3.cmml">y</mi></msub><annotation-xml encoding="MathML-Content" id="A2.SS1.p2.3.m3.1b"><apply id="A2.SS1.p2.3.m3.1.1.cmml" xref="A2.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="A2.SS1.p2.3.m3.1.1.1.cmml" xref="A2.SS1.p2.3.m3.1.1">subscript</csymbol><ci id="A2.SS1.p2.3.m3.1.1.2.cmml" xref="A2.SS1.p2.3.m3.1.1.2">𝑜</ci><ci id="A2.SS1.p2.3.m3.1.1.3.cmml" xref="A2.SS1.p2.3.m3.1.1.3">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p2.3.m3.1c">o_{y}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p2.3.m3.1d">italic_o start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT</annotation></semantics></math> is the label token’s output embedding, and <math alttext="e_{y}" class="ltx_Math" display="inline" id="A2.SS1.p2.4.m4.1"><semantics id="A2.SS1.p2.4.m4.1a"><msub id="A2.SS1.p2.4.m4.1.1" xref="A2.SS1.p2.4.m4.1.1.cmml"><mi id="A2.SS1.p2.4.m4.1.1.2" xref="A2.SS1.p2.4.m4.1.1.2.cmml">e</mi><mi id="A2.SS1.p2.4.m4.1.1.3" xref="A2.SS1.p2.4.m4.1.1.3.cmml">y</mi></msub><annotation-xml encoding="MathML-Content" id="A2.SS1.p2.4.m4.1b"><apply id="A2.SS1.p2.4.m4.1.1.cmml" xref="A2.SS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="A2.SS1.p2.4.m4.1.1.1.cmml" xref="A2.SS1.p2.4.m4.1.1">subscript</csymbol><ci id="A2.SS1.p2.4.m4.1.1.2.cmml" xref="A2.SS1.p2.4.m4.1.1.2">𝑒</ci><ci id="A2.SS1.p2.4.m4.1.1.3.cmml" xref="A2.SS1.p2.4.m4.1.1.3">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p2.4.m4.1c">e_{y}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p2.4.m4.1d">italic_e start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT</annotation></semantics></math> is the label’s eigen-subspace. From such an operation, theoretically, one layer can handle at most <math alttext="|\mathcal{H}|" class="ltx_Math" display="inline" id="A2.SS1.p2.5.m5.1"><semantics id="A2.SS1.p2.5.m5.1a"><mrow id="A2.SS1.p2.5.m5.1.2.2" xref="A2.SS1.p2.5.m5.1.2.1.cmml"><mo id="A2.SS1.p2.5.m5.1.2.2.1" stretchy="false" xref="A2.SS1.p2.5.m5.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="A2.SS1.p2.5.m5.1.1" xref="A2.SS1.p2.5.m5.1.1.cmml">ℋ</mi><mo id="A2.SS1.p2.5.m5.1.2.2.2" stretchy="false" xref="A2.SS1.p2.5.m5.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p2.5.m5.1b"><apply id="A2.SS1.p2.5.m5.1.2.1.cmml" xref="A2.SS1.p2.5.m5.1.2.2"><abs id="A2.SS1.p2.5.m5.1.2.1.1.cmml" xref="A2.SS1.p2.5.m5.1.2.2.1"></abs><ci id="A2.SS1.p2.5.m5.1.1.cmml" xref="A2.SS1.p2.5.m5.1.1">ℋ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p2.5.m5.1c">|\mathcal{H}|</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p2.5.m5.1d">| caligraphic_H |</annotation></semantics></math> labels, where <math alttext="|\mathcal{H}|" class="ltx_Math" display="inline" id="A2.SS1.p2.6.m6.1"><semantics id="A2.SS1.p2.6.m6.1a"><mrow id="A2.SS1.p2.6.m6.1.2.2" xref="A2.SS1.p2.6.m6.1.2.1.cmml"><mo id="A2.SS1.p2.6.m6.1.2.2.1" stretchy="false" xref="A2.SS1.p2.6.m6.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="A2.SS1.p2.6.m6.1.1" xref="A2.SS1.p2.6.m6.1.1.cmml">ℋ</mi><mo id="A2.SS1.p2.6.m6.1.2.2.2" stretchy="false" xref="A2.SS1.p2.6.m6.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p2.6.m6.1b"><apply id="A2.SS1.p2.6.m6.1.2.1.cmml" xref="A2.SS1.p2.6.m6.1.2.2"><abs id="A2.SS1.p2.6.m6.1.2.1.1.cmml" xref="A2.SS1.p2.6.m6.1.2.2.1"></abs><ci id="A2.SS1.p2.6.m6.1.1.cmml" xref="A2.SS1.p2.6.m6.1.1">ℋ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p2.6.m6.1c">|\mathcal{H}|</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p2.6.m6.1d">| caligraphic_H |</annotation></semantics></math> is the head amounts. While, considering the sparsity of these eigen-subspaces, such an upper bound can be increased to <math alttext="d^{\prime}|\mathcal{H}|" class="ltx_Math" display="inline" id="A2.SS1.p2.7.m7.1"><semantics id="A2.SS1.p2.7.m7.1a"><mrow id="A2.SS1.p2.7.m7.1.2" xref="A2.SS1.p2.7.m7.1.2.cmml"><msup id="A2.SS1.p2.7.m7.1.2.2" xref="A2.SS1.p2.7.m7.1.2.2.cmml"><mi id="A2.SS1.p2.7.m7.1.2.2.2" xref="A2.SS1.p2.7.m7.1.2.2.2.cmml">d</mi><mo id="A2.SS1.p2.7.m7.1.2.2.3" xref="A2.SS1.p2.7.m7.1.2.2.3.cmml">′</mo></msup><mo id="A2.SS1.p2.7.m7.1.2.1" xref="A2.SS1.p2.7.m7.1.2.1.cmml">⁢</mo><mrow id="A2.SS1.p2.7.m7.1.2.3.2" xref="A2.SS1.p2.7.m7.1.2.3.1.cmml"><mo id="A2.SS1.p2.7.m7.1.2.3.2.1" stretchy="false" xref="A2.SS1.p2.7.m7.1.2.3.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="A2.SS1.p2.7.m7.1.1" xref="A2.SS1.p2.7.m7.1.1.cmml">ℋ</mi><mo id="A2.SS1.p2.7.m7.1.2.3.2.2" stretchy="false" xref="A2.SS1.p2.7.m7.1.2.3.1.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p2.7.m7.1b"><apply id="A2.SS1.p2.7.m7.1.2.cmml" xref="A2.SS1.p2.7.m7.1.2"><times id="A2.SS1.p2.7.m7.1.2.1.cmml" xref="A2.SS1.p2.7.m7.1.2.1"></times><apply id="A2.SS1.p2.7.m7.1.2.2.cmml" xref="A2.SS1.p2.7.m7.1.2.2"><csymbol cd="ambiguous" id="A2.SS1.p2.7.m7.1.2.2.1.cmml" xref="A2.SS1.p2.7.m7.1.2.2">superscript</csymbol><ci id="A2.SS1.p2.7.m7.1.2.2.2.cmml" xref="A2.SS1.p2.7.m7.1.2.2.2">𝑑</ci><ci id="A2.SS1.p2.7.m7.1.2.2.3.cmml" xref="A2.SS1.p2.7.m7.1.2.2.3">′</ci></apply><apply id="A2.SS1.p2.7.m7.1.2.3.1.cmml" xref="A2.SS1.p2.7.m7.1.2.3.2"><abs id="A2.SS1.p2.7.m7.1.2.3.1.1.cmml" xref="A2.SS1.p2.7.m7.1.2.3.2.1"></abs><ci id="A2.SS1.p2.7.m7.1.1.cmml" xref="A2.SS1.p2.7.m7.1.1">ℋ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p2.7.m7.1c">d^{\prime}|\mathcal{H}|</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p2.7.m7.1d">italic_d start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT | caligraphic_H |</annotation></semantics></math> by multiplex one head to decode an orthogonal group of labels with orthogonal eigen-subspaces of <math alttext="\mathcal{E}=[e_{y_{1}};e_{y_{2}};\dots;e_{y_{d^{\prime}}}]" class="ltx_Math" display="inline" id="A2.SS1.p2.8.m8.4"><semantics id="A2.SS1.p2.8.m8.4a"><mrow id="A2.SS1.p2.8.m8.4.4" xref="A2.SS1.p2.8.m8.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.SS1.p2.8.m8.4.4.5" xref="A2.SS1.p2.8.m8.4.4.5.cmml">ℰ</mi><mo id="A2.SS1.p2.8.m8.4.4.4" xref="A2.SS1.p2.8.m8.4.4.4.cmml">=</mo><mrow id="A2.SS1.p2.8.m8.4.4.3.3" xref="A2.SS1.p2.8.m8.4.4.3.4.cmml"><mo id="A2.SS1.p2.8.m8.4.4.3.3.4" stretchy="false" xref="A2.SS1.p2.8.m8.4.4.3.4.cmml">[</mo><msub id="A2.SS1.p2.8.m8.2.2.1.1.1" xref="A2.SS1.p2.8.m8.2.2.1.1.1.cmml"><mi id="A2.SS1.p2.8.m8.2.2.1.1.1.2" xref="A2.SS1.p2.8.m8.2.2.1.1.1.2.cmml">e</mi><msub id="A2.SS1.p2.8.m8.2.2.1.1.1.3" xref="A2.SS1.p2.8.m8.2.2.1.1.1.3.cmml"><mi id="A2.SS1.p2.8.m8.2.2.1.1.1.3.2" xref="A2.SS1.p2.8.m8.2.2.1.1.1.3.2.cmml">y</mi><mn id="A2.SS1.p2.8.m8.2.2.1.1.1.3.3" xref="A2.SS1.p2.8.m8.2.2.1.1.1.3.3.cmml">1</mn></msub></msub><mo id="A2.SS1.p2.8.m8.4.4.3.3.5" xref="A2.SS1.p2.8.m8.4.4.3.4.cmml">;</mo><msub id="A2.SS1.p2.8.m8.3.3.2.2.2" xref="A2.SS1.p2.8.m8.3.3.2.2.2.cmml"><mi id="A2.SS1.p2.8.m8.3.3.2.2.2.2" xref="A2.SS1.p2.8.m8.3.3.2.2.2.2.cmml">e</mi><msub id="A2.SS1.p2.8.m8.3.3.2.2.2.3" xref="A2.SS1.p2.8.m8.3.3.2.2.2.3.cmml"><mi id="A2.SS1.p2.8.m8.3.3.2.2.2.3.2" xref="A2.SS1.p2.8.m8.3.3.2.2.2.3.2.cmml">y</mi><mn id="A2.SS1.p2.8.m8.3.3.2.2.2.3.3" xref="A2.SS1.p2.8.m8.3.3.2.2.2.3.3.cmml">2</mn></msub></msub><mo id="A2.SS1.p2.8.m8.4.4.3.3.6" xref="A2.SS1.p2.8.m8.4.4.3.4.cmml">;</mo><mi id="A2.SS1.p2.8.m8.1.1" mathvariant="normal" xref="A2.SS1.p2.8.m8.1.1.cmml">…</mi><mo id="A2.SS1.p2.8.m8.4.4.3.3.7" xref="A2.SS1.p2.8.m8.4.4.3.4.cmml">;</mo><msub id="A2.SS1.p2.8.m8.4.4.3.3.3" xref="A2.SS1.p2.8.m8.4.4.3.3.3.cmml"><mi id="A2.SS1.p2.8.m8.4.4.3.3.3.2" xref="A2.SS1.p2.8.m8.4.4.3.3.3.2.cmml">e</mi><msub id="A2.SS1.p2.8.m8.4.4.3.3.3.3" xref="A2.SS1.p2.8.m8.4.4.3.3.3.3.cmml"><mi id="A2.SS1.p2.8.m8.4.4.3.3.3.3.2" xref="A2.SS1.p2.8.m8.4.4.3.3.3.3.2.cmml">y</mi><msup id="A2.SS1.p2.8.m8.4.4.3.3.3.3.3" xref="A2.SS1.p2.8.m8.4.4.3.3.3.3.3.cmml"><mi id="A2.SS1.p2.8.m8.4.4.3.3.3.3.3.2" xref="A2.SS1.p2.8.m8.4.4.3.3.3.3.3.2.cmml">d</mi><mo id="A2.SS1.p2.8.m8.4.4.3.3.3.3.3.3" xref="A2.SS1.p2.8.m8.4.4.3.3.3.3.3.3.cmml">′</mo></msup></msub></msub><mo id="A2.SS1.p2.8.m8.4.4.3.3.8" stretchy="false" xref="A2.SS1.p2.8.m8.4.4.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p2.8.m8.4b"><apply id="A2.SS1.p2.8.m8.4.4.cmml" xref="A2.SS1.p2.8.m8.4.4"><eq id="A2.SS1.p2.8.m8.4.4.4.cmml" xref="A2.SS1.p2.8.m8.4.4.4"></eq><ci id="A2.SS1.p2.8.m8.4.4.5.cmml" xref="A2.SS1.p2.8.m8.4.4.5">ℰ</ci><list id="A2.SS1.p2.8.m8.4.4.3.4.cmml" xref="A2.SS1.p2.8.m8.4.4.3.3"><apply id="A2.SS1.p2.8.m8.2.2.1.1.1.cmml" xref="A2.SS1.p2.8.m8.2.2.1.1.1"><csymbol cd="ambiguous" id="A2.SS1.p2.8.m8.2.2.1.1.1.1.cmml" xref="A2.SS1.p2.8.m8.2.2.1.1.1">subscript</csymbol><ci id="A2.SS1.p2.8.m8.2.2.1.1.1.2.cmml" xref="A2.SS1.p2.8.m8.2.2.1.1.1.2">𝑒</ci><apply id="A2.SS1.p2.8.m8.2.2.1.1.1.3.cmml" xref="A2.SS1.p2.8.m8.2.2.1.1.1.3"><csymbol cd="ambiguous" id="A2.SS1.p2.8.m8.2.2.1.1.1.3.1.cmml" xref="A2.SS1.p2.8.m8.2.2.1.1.1.3">subscript</csymbol><ci id="A2.SS1.p2.8.m8.2.2.1.1.1.3.2.cmml" xref="A2.SS1.p2.8.m8.2.2.1.1.1.3.2">𝑦</ci><cn id="A2.SS1.p2.8.m8.2.2.1.1.1.3.3.cmml" type="integer" xref="A2.SS1.p2.8.m8.2.2.1.1.1.3.3">1</cn></apply></apply><apply id="A2.SS1.p2.8.m8.3.3.2.2.2.cmml" xref="A2.SS1.p2.8.m8.3.3.2.2.2"><csymbol cd="ambiguous" id="A2.SS1.p2.8.m8.3.3.2.2.2.1.cmml" xref="A2.SS1.p2.8.m8.3.3.2.2.2">subscript</csymbol><ci id="A2.SS1.p2.8.m8.3.3.2.2.2.2.cmml" xref="A2.SS1.p2.8.m8.3.3.2.2.2.2">𝑒</ci><apply id="A2.SS1.p2.8.m8.3.3.2.2.2.3.cmml" xref="A2.SS1.p2.8.m8.3.3.2.2.2.3"><csymbol cd="ambiguous" id="A2.SS1.p2.8.m8.3.3.2.2.2.3.1.cmml" xref="A2.SS1.p2.8.m8.3.3.2.2.2.3">subscript</csymbol><ci id="A2.SS1.p2.8.m8.3.3.2.2.2.3.2.cmml" xref="A2.SS1.p2.8.m8.3.3.2.2.2.3.2">𝑦</ci><cn id="A2.SS1.p2.8.m8.3.3.2.2.2.3.3.cmml" type="integer" xref="A2.SS1.p2.8.m8.3.3.2.2.2.3.3">2</cn></apply></apply><ci id="A2.SS1.p2.8.m8.1.1.cmml" xref="A2.SS1.p2.8.m8.1.1">…</ci><apply id="A2.SS1.p2.8.m8.4.4.3.3.3.cmml" xref="A2.SS1.p2.8.m8.4.4.3.3.3"><csymbol cd="ambiguous" id="A2.SS1.p2.8.m8.4.4.3.3.3.1.cmml" xref="A2.SS1.p2.8.m8.4.4.3.3.3">subscript</csymbol><ci id="A2.SS1.p2.8.m8.4.4.3.3.3.2.cmml" xref="A2.SS1.p2.8.m8.4.4.3.3.3.2">𝑒</ci><apply id="A2.SS1.p2.8.m8.4.4.3.3.3.3.cmml" xref="A2.SS1.p2.8.m8.4.4.3.3.3.3"><csymbol cd="ambiguous" id="A2.SS1.p2.8.m8.4.4.3.3.3.3.1.cmml" xref="A2.SS1.p2.8.m8.4.4.3.3.3.3">subscript</csymbol><ci id="A2.SS1.p2.8.m8.4.4.3.3.3.3.2.cmml" xref="A2.SS1.p2.8.m8.4.4.3.3.3.3.2">𝑦</ci><apply id="A2.SS1.p2.8.m8.4.4.3.3.3.3.3.cmml" xref="A2.SS1.p2.8.m8.4.4.3.3.3.3.3"><csymbol cd="ambiguous" id="A2.SS1.p2.8.m8.4.4.3.3.3.3.3.1.cmml" xref="A2.SS1.p2.8.m8.4.4.3.3.3.3.3">superscript</csymbol><ci id="A2.SS1.p2.8.m8.4.4.3.3.3.3.3.2.cmml" xref="A2.SS1.p2.8.m8.4.4.3.3.3.3.3.2">𝑑</ci><ci id="A2.SS1.p2.8.m8.4.4.3.3.3.3.3.3.cmml" xref="A2.SS1.p2.8.m8.4.4.3.3.3.3.3.3">′</ci></apply></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p2.8.m8.4c">\mathcal{E}=[e_{y_{1}};e_{y_{2}};\dots;e_{y_{d^{\prime}}}]</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p2.8.m8.4d">caligraphic_E = [ italic_e start_POSTSUBSCRIPT italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ; italic_e start_POSTSUBSCRIPT italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ; … ; italic_e start_POSTSUBSCRIPT italic_y start_POSTSUBSCRIPT italic_d start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT end_POSTSUBSCRIPT ]</annotation></semantics></math> and orthogonal output embedding <math alttext="\mathcal{O}=[o_{y_{1}};o_{y_{2}};\dots;o_{y_{d^{\prime}}}]" class="ltx_Math" display="inline" id="A2.SS1.p2.9.m9.4"><semantics id="A2.SS1.p2.9.m9.4a"><mrow id="A2.SS1.p2.9.m9.4.4" xref="A2.SS1.p2.9.m9.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.SS1.p2.9.m9.4.4.5" xref="A2.SS1.p2.9.m9.4.4.5.cmml">𝒪</mi><mo id="A2.SS1.p2.9.m9.4.4.4" xref="A2.SS1.p2.9.m9.4.4.4.cmml">=</mo><mrow id="A2.SS1.p2.9.m9.4.4.3.3" xref="A2.SS1.p2.9.m9.4.4.3.4.cmml"><mo id="A2.SS1.p2.9.m9.4.4.3.3.4" stretchy="false" xref="A2.SS1.p2.9.m9.4.4.3.4.cmml">[</mo><msub id="A2.SS1.p2.9.m9.2.2.1.1.1" xref="A2.SS1.p2.9.m9.2.2.1.1.1.cmml"><mi id="A2.SS1.p2.9.m9.2.2.1.1.1.2" xref="A2.SS1.p2.9.m9.2.2.1.1.1.2.cmml">o</mi><msub id="A2.SS1.p2.9.m9.2.2.1.1.1.3" xref="A2.SS1.p2.9.m9.2.2.1.1.1.3.cmml"><mi id="A2.SS1.p2.9.m9.2.2.1.1.1.3.2" xref="A2.SS1.p2.9.m9.2.2.1.1.1.3.2.cmml">y</mi><mn id="A2.SS1.p2.9.m9.2.2.1.1.1.3.3" xref="A2.SS1.p2.9.m9.2.2.1.1.1.3.3.cmml">1</mn></msub></msub><mo id="A2.SS1.p2.9.m9.4.4.3.3.5" xref="A2.SS1.p2.9.m9.4.4.3.4.cmml">;</mo><msub id="A2.SS1.p2.9.m9.3.3.2.2.2" xref="A2.SS1.p2.9.m9.3.3.2.2.2.cmml"><mi id="A2.SS1.p2.9.m9.3.3.2.2.2.2" xref="A2.SS1.p2.9.m9.3.3.2.2.2.2.cmml">o</mi><msub id="A2.SS1.p2.9.m9.3.3.2.2.2.3" xref="A2.SS1.p2.9.m9.3.3.2.2.2.3.cmml"><mi id="A2.SS1.p2.9.m9.3.3.2.2.2.3.2" xref="A2.SS1.p2.9.m9.3.3.2.2.2.3.2.cmml">y</mi><mn id="A2.SS1.p2.9.m9.3.3.2.2.2.3.3" xref="A2.SS1.p2.9.m9.3.3.2.2.2.3.3.cmml">2</mn></msub></msub><mo id="A2.SS1.p2.9.m9.4.4.3.3.6" xref="A2.SS1.p2.9.m9.4.4.3.4.cmml">;</mo><mi id="A2.SS1.p2.9.m9.1.1" mathvariant="normal" xref="A2.SS1.p2.9.m9.1.1.cmml">…</mi><mo id="A2.SS1.p2.9.m9.4.4.3.3.7" xref="A2.SS1.p2.9.m9.4.4.3.4.cmml">;</mo><msub id="A2.SS1.p2.9.m9.4.4.3.3.3" xref="A2.SS1.p2.9.m9.4.4.3.3.3.cmml"><mi id="A2.SS1.p2.9.m9.4.4.3.3.3.2" xref="A2.SS1.p2.9.m9.4.4.3.3.3.2.cmml">o</mi><msub id="A2.SS1.p2.9.m9.4.4.3.3.3.3" xref="A2.SS1.p2.9.m9.4.4.3.3.3.3.cmml"><mi id="A2.SS1.p2.9.m9.4.4.3.3.3.3.2" xref="A2.SS1.p2.9.m9.4.4.3.3.3.3.2.cmml">y</mi><msup id="A2.SS1.p2.9.m9.4.4.3.3.3.3.3" xref="A2.SS1.p2.9.m9.4.4.3.3.3.3.3.cmml"><mi id="A2.SS1.p2.9.m9.4.4.3.3.3.3.3.2" xref="A2.SS1.p2.9.m9.4.4.3.3.3.3.3.2.cmml">d</mi><mo id="A2.SS1.p2.9.m9.4.4.3.3.3.3.3.3" xref="A2.SS1.p2.9.m9.4.4.3.3.3.3.3.3.cmml">′</mo></msup></msub></msub><mo id="A2.SS1.p2.9.m9.4.4.3.3.8" stretchy="false" xref="A2.SS1.p2.9.m9.4.4.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p2.9.m9.4b"><apply id="A2.SS1.p2.9.m9.4.4.cmml" xref="A2.SS1.p2.9.m9.4.4"><eq id="A2.SS1.p2.9.m9.4.4.4.cmml" xref="A2.SS1.p2.9.m9.4.4.4"></eq><ci id="A2.SS1.p2.9.m9.4.4.5.cmml" xref="A2.SS1.p2.9.m9.4.4.5">𝒪</ci><list id="A2.SS1.p2.9.m9.4.4.3.4.cmml" xref="A2.SS1.p2.9.m9.4.4.3.3"><apply id="A2.SS1.p2.9.m9.2.2.1.1.1.cmml" xref="A2.SS1.p2.9.m9.2.2.1.1.1"><csymbol cd="ambiguous" id="A2.SS1.p2.9.m9.2.2.1.1.1.1.cmml" xref="A2.SS1.p2.9.m9.2.2.1.1.1">subscript</csymbol><ci id="A2.SS1.p2.9.m9.2.2.1.1.1.2.cmml" xref="A2.SS1.p2.9.m9.2.2.1.1.1.2">𝑜</ci><apply id="A2.SS1.p2.9.m9.2.2.1.1.1.3.cmml" xref="A2.SS1.p2.9.m9.2.2.1.1.1.3"><csymbol cd="ambiguous" id="A2.SS1.p2.9.m9.2.2.1.1.1.3.1.cmml" xref="A2.SS1.p2.9.m9.2.2.1.1.1.3">subscript</csymbol><ci id="A2.SS1.p2.9.m9.2.2.1.1.1.3.2.cmml" xref="A2.SS1.p2.9.m9.2.2.1.1.1.3.2">𝑦</ci><cn id="A2.SS1.p2.9.m9.2.2.1.1.1.3.3.cmml" type="integer" xref="A2.SS1.p2.9.m9.2.2.1.1.1.3.3">1</cn></apply></apply><apply id="A2.SS1.p2.9.m9.3.3.2.2.2.cmml" xref="A2.SS1.p2.9.m9.3.3.2.2.2"><csymbol cd="ambiguous" id="A2.SS1.p2.9.m9.3.3.2.2.2.1.cmml" xref="A2.SS1.p2.9.m9.3.3.2.2.2">subscript</csymbol><ci id="A2.SS1.p2.9.m9.3.3.2.2.2.2.cmml" xref="A2.SS1.p2.9.m9.3.3.2.2.2.2">𝑜</ci><apply id="A2.SS1.p2.9.m9.3.3.2.2.2.3.cmml" xref="A2.SS1.p2.9.m9.3.3.2.2.2.3"><csymbol cd="ambiguous" id="A2.SS1.p2.9.m9.3.3.2.2.2.3.1.cmml" xref="A2.SS1.p2.9.m9.3.3.2.2.2.3">subscript</csymbol><ci id="A2.SS1.p2.9.m9.3.3.2.2.2.3.2.cmml" xref="A2.SS1.p2.9.m9.3.3.2.2.2.3.2">𝑦</ci><cn id="A2.SS1.p2.9.m9.3.3.2.2.2.3.3.cmml" type="integer" xref="A2.SS1.p2.9.m9.3.3.2.2.2.3.3">2</cn></apply></apply><ci id="A2.SS1.p2.9.m9.1.1.cmml" xref="A2.SS1.p2.9.m9.1.1">…</ci><apply id="A2.SS1.p2.9.m9.4.4.3.3.3.cmml" xref="A2.SS1.p2.9.m9.4.4.3.3.3"><csymbol cd="ambiguous" id="A2.SS1.p2.9.m9.4.4.3.3.3.1.cmml" xref="A2.SS1.p2.9.m9.4.4.3.3.3">subscript</csymbol><ci id="A2.SS1.p2.9.m9.4.4.3.3.3.2.cmml" xref="A2.SS1.p2.9.m9.4.4.3.3.3.2">𝑜</ci><apply id="A2.SS1.p2.9.m9.4.4.3.3.3.3.cmml" xref="A2.SS1.p2.9.m9.4.4.3.3.3.3"><csymbol cd="ambiguous" id="A2.SS1.p2.9.m9.4.4.3.3.3.3.1.cmml" xref="A2.SS1.p2.9.m9.4.4.3.3.3.3">subscript</csymbol><ci id="A2.SS1.p2.9.m9.4.4.3.3.3.3.2.cmml" xref="A2.SS1.p2.9.m9.4.4.3.3.3.3.2">𝑦</ci><apply id="A2.SS1.p2.9.m9.4.4.3.3.3.3.3.cmml" xref="A2.SS1.p2.9.m9.4.4.3.3.3.3.3"><csymbol cd="ambiguous" id="A2.SS1.p2.9.m9.4.4.3.3.3.3.3.1.cmml" xref="A2.SS1.p2.9.m9.4.4.3.3.3.3.3">superscript</csymbol><ci id="A2.SS1.p2.9.m9.4.4.3.3.3.3.3.2.cmml" xref="A2.SS1.p2.9.m9.4.4.3.3.3.3.3.2">𝑑</ci><ci id="A2.SS1.p2.9.m9.4.4.3.3.3.3.3.3.cmml" xref="A2.SS1.p2.9.m9.4.4.3.3.3.3.3.3">′</ci></apply></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p2.9.m9.4c">\mathcal{O}=[o_{y_{1}};o_{y_{2}};\dots;o_{y_{d^{\prime}}}]</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p2.9.m9.4d">caligraphic_O = [ italic_o start_POSTSUBSCRIPT italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ; italic_o start_POSTSUBSCRIPT italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ; … ; italic_o start_POSTSUBSCRIPT italic_y start_POSTSUBSCRIPT italic_d start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT end_POSTSUBSCRIPT ]</annotation></semantics></math>, where <math alttext="d^{\prime}" class="ltx_Math" display="inline" id="A2.SS1.p2.10.m10.1"><semantics id="A2.SS1.p2.10.m10.1a"><msup id="A2.SS1.p2.10.m10.1.1" xref="A2.SS1.p2.10.m10.1.1.cmml"><mi id="A2.SS1.p2.10.m10.1.1.2" xref="A2.SS1.p2.10.m10.1.1.2.cmml">d</mi><mo id="A2.SS1.p2.10.m10.1.1.3" xref="A2.SS1.p2.10.m10.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="A2.SS1.p2.10.m10.1b"><apply id="A2.SS1.p2.10.m10.1.1.cmml" xref="A2.SS1.p2.10.m10.1.1"><csymbol cd="ambiguous" id="A2.SS1.p2.10.m10.1.1.1.cmml" xref="A2.SS1.p2.10.m10.1.1">superscript</csymbol><ci id="A2.SS1.p2.10.m10.1.1.2.cmml" xref="A2.SS1.p2.10.m10.1.1.2">𝑑</ci><ci id="A2.SS1.p2.10.m10.1.1.3.cmml" xref="A2.SS1.p2.10.m10.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p2.10.m10.1c">d^{\prime}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p2.10.m10.1d">italic_d start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> is the inner dimension of attention head, with decoding transformation <math alttext="W_{O}W_{V}=\mathcal{O}^{\top}\mathcal{E}" class="ltx_Math" display="inline" id="A2.SS1.p2.11.m11.1"><semantics id="A2.SS1.p2.11.m11.1a"><mrow id="A2.SS1.p2.11.m11.1.1" xref="A2.SS1.p2.11.m11.1.1.cmml"><mrow id="A2.SS1.p2.11.m11.1.1.2" xref="A2.SS1.p2.11.m11.1.1.2.cmml"><msub id="A2.SS1.p2.11.m11.1.1.2.2" xref="A2.SS1.p2.11.m11.1.1.2.2.cmml"><mi id="A2.SS1.p2.11.m11.1.1.2.2.2" xref="A2.SS1.p2.11.m11.1.1.2.2.2.cmml">W</mi><mi id="A2.SS1.p2.11.m11.1.1.2.2.3" xref="A2.SS1.p2.11.m11.1.1.2.2.3.cmml">O</mi></msub><mo id="A2.SS1.p2.11.m11.1.1.2.1" xref="A2.SS1.p2.11.m11.1.1.2.1.cmml">⁢</mo><msub id="A2.SS1.p2.11.m11.1.1.2.3" xref="A2.SS1.p2.11.m11.1.1.2.3.cmml"><mi id="A2.SS1.p2.11.m11.1.1.2.3.2" xref="A2.SS1.p2.11.m11.1.1.2.3.2.cmml">W</mi><mi id="A2.SS1.p2.11.m11.1.1.2.3.3" xref="A2.SS1.p2.11.m11.1.1.2.3.3.cmml">V</mi></msub></mrow><mo id="A2.SS1.p2.11.m11.1.1.1" xref="A2.SS1.p2.11.m11.1.1.1.cmml">=</mo><mrow id="A2.SS1.p2.11.m11.1.1.3" xref="A2.SS1.p2.11.m11.1.1.3.cmml"><msup id="A2.SS1.p2.11.m11.1.1.3.2" xref="A2.SS1.p2.11.m11.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.SS1.p2.11.m11.1.1.3.2.2" xref="A2.SS1.p2.11.m11.1.1.3.2.2.cmml">𝒪</mi><mo id="A2.SS1.p2.11.m11.1.1.3.2.3" xref="A2.SS1.p2.11.m11.1.1.3.2.3.cmml">⊤</mo></msup><mo id="A2.SS1.p2.11.m11.1.1.3.1" xref="A2.SS1.p2.11.m11.1.1.3.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="A2.SS1.p2.11.m11.1.1.3.3" xref="A2.SS1.p2.11.m11.1.1.3.3.cmml">ℰ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p2.11.m11.1b"><apply id="A2.SS1.p2.11.m11.1.1.cmml" xref="A2.SS1.p2.11.m11.1.1"><eq id="A2.SS1.p2.11.m11.1.1.1.cmml" xref="A2.SS1.p2.11.m11.1.1.1"></eq><apply id="A2.SS1.p2.11.m11.1.1.2.cmml" xref="A2.SS1.p2.11.m11.1.1.2"><times id="A2.SS1.p2.11.m11.1.1.2.1.cmml" xref="A2.SS1.p2.11.m11.1.1.2.1"></times><apply id="A2.SS1.p2.11.m11.1.1.2.2.cmml" xref="A2.SS1.p2.11.m11.1.1.2.2"><csymbol cd="ambiguous" id="A2.SS1.p2.11.m11.1.1.2.2.1.cmml" xref="A2.SS1.p2.11.m11.1.1.2.2">subscript</csymbol><ci id="A2.SS1.p2.11.m11.1.1.2.2.2.cmml" xref="A2.SS1.p2.11.m11.1.1.2.2.2">𝑊</ci><ci id="A2.SS1.p2.11.m11.1.1.2.2.3.cmml" xref="A2.SS1.p2.11.m11.1.1.2.2.3">𝑂</ci></apply><apply id="A2.SS1.p2.11.m11.1.1.2.3.cmml" xref="A2.SS1.p2.11.m11.1.1.2.3"><csymbol cd="ambiguous" id="A2.SS1.p2.11.m11.1.1.2.3.1.cmml" xref="A2.SS1.p2.11.m11.1.1.2.3">subscript</csymbol><ci id="A2.SS1.p2.11.m11.1.1.2.3.2.cmml" xref="A2.SS1.p2.11.m11.1.1.2.3.2">𝑊</ci><ci id="A2.SS1.p2.11.m11.1.1.2.3.3.cmml" xref="A2.SS1.p2.11.m11.1.1.2.3.3">𝑉</ci></apply></apply><apply id="A2.SS1.p2.11.m11.1.1.3.cmml" xref="A2.SS1.p2.11.m11.1.1.3"><times id="A2.SS1.p2.11.m11.1.1.3.1.cmml" xref="A2.SS1.p2.11.m11.1.1.3.1"></times><apply id="A2.SS1.p2.11.m11.1.1.3.2.cmml" xref="A2.SS1.p2.11.m11.1.1.3.2"><csymbol cd="ambiguous" id="A2.SS1.p2.11.m11.1.1.3.2.1.cmml" xref="A2.SS1.p2.11.m11.1.1.3.2">superscript</csymbol><ci id="A2.SS1.p2.11.m11.1.1.3.2.2.cmml" xref="A2.SS1.p2.11.m11.1.1.3.2.2">𝒪</ci><csymbol cd="latexml" id="A2.SS1.p2.11.m11.1.1.3.2.3.cmml" xref="A2.SS1.p2.11.m11.1.1.3.2.3">top</csymbol></apply><ci id="A2.SS1.p2.11.m11.1.1.3.3.cmml" xref="A2.SS1.p2.11.m11.1.1.3.3">ℰ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p2.11.m11.1c">W_{O}W_{V}=\mathcal{O}^{\top}\mathcal{E}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p2.11.m11.1d">italic_W start_POSTSUBSCRIPT italic_O end_POSTSUBSCRIPT italic_W start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT = caligraphic_O start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT caligraphic_E</annotation></semantics></math>. (2) <span class="ltx_text ltx_font_bold" id="A2.SS1.p2.13.4">When the label space expands<span class="ltx_note ltx_role_footnote" id="footnote10"><sup class="ltx_note_mark">10</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">10</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_medium" id="footnote10.1.1.1">10</span></span><span class="ltx_text ltx_font_medium" id="footnote10.5">Notice that such a situation can also occur when the orthogonality between eigen-subspaces or output embeddings is lost. A common situation is that the variance of the cluster increases, creating confusion within the decoding space of the attention head.</span></span></span></span></span>, the decoding transformation can not distinguish all the clusters since the <math alttext="W_{O}W_{V}" class="ltx_Math" display="inline" id="A2.SS1.p2.12.m12.1"><semantics id="A2.SS1.p2.12.m12.1a"><mrow id="A2.SS1.p2.12.m12.1.1" xref="A2.SS1.p2.12.m12.1.1.cmml"><msub id="A2.SS1.p2.12.m12.1.1.2" xref="A2.SS1.p2.12.m12.1.1.2.cmml"><mi id="A2.SS1.p2.12.m12.1.1.2.2" xref="A2.SS1.p2.12.m12.1.1.2.2.cmml">W</mi><mi id="A2.SS1.p2.12.m12.1.1.2.3" xref="A2.SS1.p2.12.m12.1.1.2.3.cmml">O</mi></msub><mo id="A2.SS1.p2.12.m12.1.1.1" xref="A2.SS1.p2.12.m12.1.1.1.cmml">⁢</mo><msub id="A2.SS1.p2.12.m12.1.1.3" xref="A2.SS1.p2.12.m12.1.1.3.cmml"><mi id="A2.SS1.p2.12.m12.1.1.3.2" xref="A2.SS1.p2.12.m12.1.1.3.2.cmml">W</mi><mi id="A2.SS1.p2.12.m12.1.1.3.3" xref="A2.SS1.p2.12.m12.1.1.3.3.cmml">V</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p2.12.m12.1b"><apply id="A2.SS1.p2.12.m12.1.1.cmml" xref="A2.SS1.p2.12.m12.1.1"><times id="A2.SS1.p2.12.m12.1.1.1.cmml" xref="A2.SS1.p2.12.m12.1.1.1"></times><apply id="A2.SS1.p2.12.m12.1.1.2.cmml" xref="A2.SS1.p2.12.m12.1.1.2"><csymbol cd="ambiguous" id="A2.SS1.p2.12.m12.1.1.2.1.cmml" xref="A2.SS1.p2.12.m12.1.1.2">subscript</csymbol><ci id="A2.SS1.p2.12.m12.1.1.2.2.cmml" xref="A2.SS1.p2.12.m12.1.1.2.2">𝑊</ci><ci id="A2.SS1.p2.12.m12.1.1.2.3.cmml" xref="A2.SS1.p2.12.m12.1.1.2.3">𝑂</ci></apply><apply id="A2.SS1.p2.12.m12.1.1.3.cmml" xref="A2.SS1.p2.12.m12.1.1.3"><csymbol cd="ambiguous" id="A2.SS1.p2.12.m12.1.1.3.1.cmml" xref="A2.SS1.p2.12.m12.1.1.3">subscript</csymbol><ci id="A2.SS1.p2.12.m12.1.1.3.2.cmml" xref="A2.SS1.p2.12.m12.1.1.3.2">𝑊</ci><ci id="A2.SS1.p2.12.m12.1.1.3.3.cmml" xref="A2.SS1.p2.12.m12.1.1.3.3">𝑉</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p2.12.m12.1c">W_{O}W_{V}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p2.12.m12.1d">italic_W start_POSTSUBSCRIPT italic_O end_POSTSUBSCRIPT italic_W start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT</annotation></semantics></math> is low-rank. Driven by the training loss, the model can choose to transform the encoding kernel to focus on catching the most similar label tokens with the query, and copy the label tokens’ information back to the query. As a result, one attention head can catch at most <math alttext="d^{\prime}" class="ltx_Math" display="inline" id="A2.SS1.p2.13.m13.1"><semantics id="A2.SS1.p2.13.m13.1a"><msup id="A2.SS1.p2.13.m13.1.1" xref="A2.SS1.p2.13.m13.1.1.cmml"><mi id="A2.SS1.p2.13.m13.1.1.2" xref="A2.SS1.p2.13.m13.1.1.2.cmml">d</mi><mo id="A2.SS1.p2.13.m13.1.1.3" xref="A2.SS1.p2.13.m13.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="A2.SS1.p2.13.m13.1b"><apply id="A2.SS1.p2.13.m13.1.1.cmml" xref="A2.SS1.p2.13.m13.1.1"><csymbol cd="ambiguous" id="A2.SS1.p2.13.m13.1.1.1.cmml" xref="A2.SS1.p2.13.m13.1.1">superscript</csymbol><ci id="A2.SS1.p2.13.m13.1.1.2.cmml" xref="A2.SS1.p2.13.m13.1.1.2">𝑑</ci><ci id="A2.SS1.p2.13.m13.1.1.3.cmml" xref="A2.SS1.p2.13.m13.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p2.13.m13.1c">d^{\prime}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p2.13.m13.1d">italic_d start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> groups of label tokens mapped collinearly by the encoding kernel (note that this set of labels may not appear simultaneously in the context, so confusion can be avoided), and the common space of these label words become the induction subspace shown in&nbsp;§<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S4.SS2" title="4.2 Step 3, Induction Head: Feature Retrieval on Task Subspace ‣ 4 Induction Circuits in Natural Language Models ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">4.2</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="A2.F13">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F13.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="248" id="A2.F13.sf1.g1" src="https://arxiv.org/html/2410.04468v1/extracted/5905049/Figure/appendix_segmentation/segmentation_index1_1.png" width="281">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F13.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="248" id="A2.F13.sf2.g1" src="https://arxiv.org/html/2410.04468v1/extracted/5905049/Figure/appendix_segmentation/segmentation_index1_2.png" width="281">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 13: </span>Attention score visualized with the forerunner token of the ICL query as the attention query, from (<span class="ltx_text ltx_font_bold" id="A2.F13.3.1">Left</span>) layer 21 and (<span class="ltx_text ltx_font_bold" id="A2.F13.4.2">Right</span>) layer 2 in Llama 3 70B from an input case.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A2.SS1.p3">
<p class="ltx_p" id="A2.SS1.p3.1">Our other conjecture is that the ICL training endpoint is thermodynamically stable (with a lower loss), and in contrast, the IWL training endpoint is kinetically stable (with a more accessible training trajectory). Moreover, the IWL training object can be a precursor of ICL training, since the total number of labels fed into the model gradually increases with the data. So, we can hypothesize that: when the metastable state is disturbed by some condition, such as the appearance of rare or noisy labels, the training can show a phase transition toward a thermodynamically stable state.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS1.p4">
<p class="ltx_p" id="A2.SS1.p4.1">Notice that this section is our hypothesis based on the results of this paper, which should be empirically validated in future work. In addition, we still need to find implicit input-label tuples in wild data, which will also be addressed in future work.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_appendix" id="A3">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Can LMs Segment ICL Prompt?</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_table ltx_align_floatright" id="A3.T5">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span>Accuracy drop with delimiters removed / modified from prompts on SST-2.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="A3.T5.4" style="width:178.9pt;height:147.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-19.6pt,16.2pt) scale(0.820489882105705,0.820489882105705) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A3.T5.4.4">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A3.T5.4.4.5.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A3.T5.4.4.5.1.1"><span class="ltx_text ltx_font_bold" id="A3.T5.4.4.5.1.1.1">Template Modification</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A3.T5.4.4.5.1.2">
<span class="ltx_text ltx_font_bold" id="A3.T5.4.4.5.1.2.1">Acc.</span> (%)</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A3.T5.4.4.6.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A3.T5.4.4.6.1.1">
<span class="ltx_text ltx_font_bold" id="A3.T5.4.4.6.1.1.1">None</span> (Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A1.T4" title="Table 4 ‣ A.1 Detailed Overall Experimental Settings ‣ Appendix A Experiment Details and Settings ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">4</span></a>)</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T5.4.4.6.1.2">91.60</td>
</tr>
<tr class="ltx_tr" id="A3.T5.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A3.T5.1.1.1.1">&nbsp;&nbsp; - w/o “<math alttext="\backslash" class="ltx_Math" display="inline" id="A3.T5.1.1.1.1.m1.1"><semantics id="A3.T5.1.1.1.1.m1.1a"><mo id="A3.T5.1.1.1.1.m1.1.1" xref="A3.T5.1.1.1.1.m1.1.1.cmml">\</mo><annotation-xml encoding="MathML-Content" id="A3.T5.1.1.1.1.m1.1b"><ci id="A3.T5.1.1.1.1.m1.1.1.cmml" xref="A3.T5.1.1.1.1.m1.1.1">\</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T5.1.1.1.1.m1.1c">\backslash</annotation><annotation encoding="application/x-llamapun" id="A3.T5.1.1.1.1.m1.1d">\</annotation></semantics></math><span class="ltx_text ltx_font_typewriter" id="A3.T5.1.1.1.1.1">n</span>”</th>
<td class="ltx_td ltx_align_center" id="A3.T5.1.1.1.2">93.36</td>
</tr>
<tr class="ltx_tr" id="A3.T5.4.4.7.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A3.T5.4.4.7.2.1">&nbsp;&nbsp; - w/o “<span class="ltx_text ltx_font_typewriter" id="A3.T5.4.4.7.2.1.1">:</span>”</th>
<td class="ltx_td ltx_align_center" id="A3.T5.4.4.7.2.2">85.74</td>
</tr>
<tr class="ltx_tr" id="A3.T5.4.4.8.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A3.T5.4.4.8.3.1">&nbsp;&nbsp; - w/o “<span class="ltx_text ltx_font_typewriter" id="A3.T5.4.4.8.3.1.1">sentence:</span>”, “<span class="ltx_text ltx_font_typewriter" id="A3.T5.4.4.8.3.1.2">sentiment:</span>”</th>
<td class="ltx_td ltx_align_center" id="A3.T5.4.4.8.3.2">79.10</td>
</tr>
<tr class="ltx_tr" id="A3.T5.4.4.9.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A3.T5.4.4.9.4.1">&nbsp;&nbsp; - w/o all above</th>
<td class="ltx_td ltx_align_center" id="A3.T5.4.4.9.4.2">50.98</td>
</tr>
<tr class="ltx_tr" id="A3.T5.2.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A3.T5.2.2.2.1">&nbsp;&nbsp; - “<span class="ltx_text ltx_font_typewriter" id="A3.T5.2.2.2.1.1">:</span>” <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A3.T5.2.2.2.1.m1.1"><semantics id="A3.T5.2.2.2.1.m1.1a"><mo id="A3.T5.2.2.2.1.m1.1.1" stretchy="false" xref="A3.T5.2.2.2.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A3.T5.2.2.2.1.m1.1b"><ci id="A3.T5.2.2.2.1.m1.1.1.cmml" xref="A3.T5.2.2.2.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T5.2.2.2.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="A3.T5.2.2.2.1.m1.1d">→</annotation></semantics></math> “<span class="ltx_text ltx_font_typewriter" id="A3.T5.2.2.2.1.2">hello</span>”</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T5.2.2.2.2">78.91</td>
</tr>
<tr class="ltx_tr" id="A3.T5.3.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A3.T5.3.3.3.1">&nbsp;&nbsp; - “<span class="ltx_text ltx_font_typewriter" id="A3.T5.3.3.3.1.1">:</span>” <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A3.T5.3.3.3.1.m1.1"><semantics id="A3.T5.3.3.3.1.m1.1a"><mo id="A3.T5.3.3.3.1.m1.1.1" stretchy="false" xref="A3.T5.3.3.3.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A3.T5.3.3.3.1.m1.1b"><ci id="A3.T5.3.3.3.1.m1.1.1.cmml" xref="A3.T5.3.3.3.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T5.3.3.3.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="A3.T5.3.3.3.1.m1.1d">→</annotation></semantics></math> “<span class="ltx_text ltx_font_typewriter" id="A3.T5.3.3.3.1.2">@</span>”</th>
<td class="ltx_td ltx_align_center" id="A3.T5.3.3.3.2">91.41</td>
</tr>
<tr class="ltx_tr" id="A3.T5.4.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A3.T5.4.4.4.1">&nbsp;&nbsp; - “<span class="ltx_text ltx_font_typewriter" id="A3.T5.4.4.4.1.1">:</span>” <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A3.T5.4.4.4.1.m1.1"><semantics id="A3.T5.4.4.4.1.m1.1a"><mo id="A3.T5.4.4.4.1.m1.1.1" stretchy="false" xref="A3.T5.4.4.4.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A3.T5.4.4.4.1.m1.1b"><ci id="A3.T5.4.4.4.1.m1.1.1.cmml" xref="A3.T5.4.4.4.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T5.4.4.4.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="A3.T5.4.4.4.1.m1.1d">→</annotation></semantics></math> “<span class="ltx_text ltx_font_typewriter" id="A3.T5.4.4.4.1.2">positive</span>”</th>
<td class="ltx_td ltx_align_center" id="A3.T5.4.4.4.2">71.48</td>
</tr>
<tr class="ltx_tr" id="A3.T5.4.4.10.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="A3.T5.4.4.10.5.1"><span class="ltx_text ltx_font_bold" id="A3.T5.4.4.10.5.1.1">(Random)</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A3.T5.4.4.10.5.2">50.00</td>
</tr>
</tbody>
</table>
</span></div>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A3.p1">
<p class="ltx_p" id="A3.p1.1">The experiments in&nbsp;§<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S3.SS1" title="3.1 LLMs Summarize Input Text on Forerunner Tokens in Hidden States ‣ 3 Step 1, Summarize: Linear Representations in Hidden States ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">3.1</span></a> imply that LMs conduct effective segmentation on ICL-styled inputs, enabling LMs to block the interference of preceding demonstrations in the input text encoding operation. Here, as a prototypical discussion, we confirm the existence of segmentation and then reveal that such segmentation can be done in very early layers from an attention operation focusing on some specific segmentation tokens in the inputs.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A3.p2">
<p class="ltx_p" id="A3.p2.1">As a preliminary observation, we visualize the attention scores with the last forerunner token as the attention queue at layer 21 (a layer with high encoding magnitude, refer to Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S3.F2" title="Figure 2 ‣ 3.2 Text Summarization is Linear and Task-Relevant but Position-biased ‣ 3 Step 1, Summarize: Linear Representations in Hidden States ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>) from an input case, as shown in Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A2.F13" title="Figure 13 ‣ B.1 Data Distribution Requirement Explained by Hidden State Multiplex ‣ Appendix B LM Pre-training Dynamics Measured by ICL Circuit ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">13</span></a> (Left), where most of the attention heads are focused on the query text. The visualization suggests that encoding operations are localized into the query.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A3.p3">
<p class="ltx_p" id="A3.p3.1">Although position embedding inserts sufficient positional information to hidden states and enables attention heads to identify nearby tokens, we believe that position embedding is insufficient to accurately segment the various input parts of uncertain lengths. We hypothesize that LM focused on natural delimiters (e.g. “<math alttext="\backslash" class="ltx_Math" display="inline" id="A3.p3.1.m1.1"><semantics id="A3.p3.1.m1.1a"><mo id="A3.p3.1.m1.1.1" xref="A3.p3.1.m1.1.1.cmml">\</mo><annotation-xml encoding="MathML-Content" id="A3.p3.1.m1.1b"><ci id="A3.p3.1.m1.1.1.cmml" xref="A3.p3.1.m1.1.1">\</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p3.1.m1.1c">\backslash</annotation><annotation encoding="application/x-llamapun" id="A3.p3.1.m1.1d">\</annotation></semantics></math><span class="ltx_text ltx_font_typewriter" id="A3.p3.1.1">n</span>”, “<span class="ltx_text ltx_font_typewriter" id="A3.p3.1.2">:</span>”) in the input during the early stages of inference, and visualization in Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A2.F13" title="Figure 13 ‣ B.1 Data Distribution Requirement Explained by Hidden State Multiplex ‣ Appendix B LM Pre-training Dynamics Measured by ICL Circuit ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">13</span></a> (Right) supports such hypothesis: in layer 2, most of the attention heads focus on the natural delimiters, and another visualization in Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A2.F12" title="Figure 12 ‣ B.1 Data Distribution Requirement Explained by Hidden State Multiplex ‣ Appendix B LM Pre-training Dynamics Measured by ICL Circuit ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">12</span></a> shows that all attention queries (not only the forerunner token) exhibit similar separator-focusing behavior, suggesting that: some attention heads merge all the preceding delimiters’ representation into every token as <span class="ltx_text ltx_font_italic" id="A3.p3.1.3">delimiter-based positional encoding</span>, making the representations of tokens with the same number of preceding delimiters similar, while differentiating the representations of tokens with different numbers of preceding delimiters. In the subsequent inference process, LM can utilize these delimiter-based positional encodings for localization operations. Such observation is also consistent with Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S4.F4" title="Figure 4 ‣ 4 Induction Circuits in Natural Language Models ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">4</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A3.p4">
<p class="ltx_p" id="A3.p4.1">Furthermore, we empirically demonstrate that delimiters have significant saliency towards ICL accuracies in Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A3.T5" title="Table 5 ‣ Appendix C Can LMs Segment ICL Prompt? ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">5</span></a> (upper), experimented by removing them from prompt templates. Interestingly, the trial to completely remove these delimiters from the prompt yielded almost random results, even though these inputs still conform to the primary form of ICL. A reliable reason can be that: The missing delimiter interferes with the encoding operation (Step 1) on both demonstrations and queries, so that completely disrupts the ICL process.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A3.p5">
<p class="ltx_p" id="A3.p5.1">The scale of such a segmentation operation can surprise one since more than half of the heads focus on the segmenting operation as shown in Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A2.F13" title="Figure 13 ‣ B.1 Data Distribution Requirement Explained by Hidden State Multiplex ‣ Appendix B LM Pre-training Dynamics Measured by ICL Circuit ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">13</span></a> (Right). However, as an assumption, we want to argue that dividing the input text into local segmentation is a crucial step in language modeling, so, functionally, LM has sufficient motivation to focus on segmenting during the training process. Moreover, based on the above principles, as long as the delimiter appears periodically at appropriate positions and can be captured by attention heads (only in the structured parts of the prompt template), as shown in Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A3.T5" title="Table 5 ‣ Appendix C Can LMs Segment ICL Prompt? ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">5</span></a> (lower), the delimiter can be designed to any token. While we still recommend natural delimiters without semantics in the template design.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_appendix" id="A4">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Measurement on Direct Decoding</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure ltx_align_floatright" id="A4.F14"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="202" id="A4.F14.g1" src="https://arxiv.org/html/2410.04468v1/x20.png" width="267">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 14: </span>Direct decoding accuracies on various layers.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A4.p1">
<p class="ltx_p" id="A4.p1.1">This section measures the direct decoding bypass, suggesting that: (1) Direct decoding on well-processed hidden states with some later layer skipped can get satisfactory accuracy even better than the full inference process. (2) Direct decoding on insufficient processed hidden states adds bias towards the predicting distribution.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A4.p2">
<p class="ltx_p" id="A4.p2.1">We examine the first claim by applying the language model head on each layer’s hidden state on SST-2, Llama 3 8B, and conduct a standard ICL process on the decoded token prediction distribution. The results are shown in Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A4.F14" title="Figure 14 ‣ Appendix D Measurement on Direct Decoding ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">14</span></a>, where direct decoding accuracy emerges from random to near <math alttext="1" class="ltx_Math" display="inline" id="A4.p2.1.m1.1"><semantics id="A4.p2.1.m1.1a"><mn id="A4.p2.1.m1.1.1" xref="A4.p2.1.m1.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="A4.p2.1.m1.1b"><cn id="A4.p2.1.m1.1.1.cmml" type="integer" xref="A4.p2.1.m1.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.p2.1.m1.1c">1</annotation><annotation encoding="application/x-llamapun" id="A4.p2.1.m1.1d">1</annotation></semantics></math> around layer 18. Refer to Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S5.F8" title="Figure 8 ‣ 5.2 Bypass Mechanism ‣ 5 Putting Things Together ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">8</span></a> and results in Appendix&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A6.SS2" title="F.2 Other LMs’ Experiment Results ‣ Appendix F Augmentated Experiment Results ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">F.2</span></a>, we can confirm: accuracy emerges after all three steps are executed. Moreover, the accuracies on the intermediate hidden states are even higher than the last hidden states, which is aligned with the discussion in Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S6.T3" title="Table 3 ‣ 6 Conclusion and Discussion ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">3</span></a>. So, we can conclude: direct decoding on well-processed hidden states can classify well.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="A4.F15">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="235" id="A4.F15.g1" src="https://arxiv.org/html/2410.04468v1/x21.png" width="663"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="235" id="A4.F15.g2" src="https://arxiv.org/html/2410.04468v1/x22.png" width="663"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 15: </span>Predicting distributions on different forerunner tokens with various direct decoding logits. Inference process used: <span class="ltx_text ltx_font_bold" id="A4.F15.3.1">Upper:</span> Vanilla ICL, <span class="ltx_text ltx_font_bold" id="A4.F15.4.2">Lower:</span> Biased removed inference by Contextual Calibration proposed by&nbsp;<cite class="ltx_cite ltx_citemacro_cite">Zhao et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib47" title="">2021</a>)</cite>.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_table ltx_align_floatright" id="A4.T6">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 6: </span>Results of Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S5.T1" title="Table 1 ‣ 5.1 Ablation Analysis ‣ 5 Putting Things Together ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">1</span></a> on Falcon 7B.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="A4.T6.51" style="width:198.7pt;height:183.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-78.4pt,72.2pt) scale(0.55906292232204,0.55906292232204) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A4.T6.51.51">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A4.T6.1.1.1">
<th class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_row ltx_border_tt" id="A4.T6.1.1.1.2" rowspan="2"><span class="ltx_text" id="A4.T6.1.1.1.2.1">#</span></th>
<th class="ltx_td ltx_nopad_l ltx_align_center ltx_th ltx_th_row ltx_border_tt" id="A4.T6.1.1.1.1" rowspan="2"><span class="ltx_text" id="A4.T6.1.1.1.1.1">
<span class="ltx_tabular ltx_align_middle" id="A4.T6.1.1.1.1.1.1">
<span class="ltx_tr" id="A4.T6.1.1.1.1.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.1.1.1.1.1.1.2.1"><span class="ltx_text ltx_font_bold" id="A4.T6.1.1.1.1.1.1.2.1.1">Attention Disconnected</span></span></span>
<span class="ltx_tr" id="A4.T6.1.1.1.1.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.1.1.1.1.1.1.1.1">Key <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A4.T6.1.1.1.1.1.1.1.1.m1.1"><semantics id="A4.T6.1.1.1.1.1.1.1.1.m1.1a"><mo id="A4.T6.1.1.1.1.1.1.1.1.m1.1.1" stretchy="false" xref="A4.T6.1.1.1.1.1.1.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A4.T6.1.1.1.1.1.1.1.1.m1.1b"><ci id="A4.T6.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="A4.T6.1.1.1.1.1.1.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.1.1.1.1.1.1.1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="A4.T6.1.1.1.1.1.1.1.1.m1.1d">→</annotation></semantics></math> Query</span></span>
</span></span></th>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="4" id="A4.T6.1.1.1.3">
<span class="ltx_text ltx_font_bold" id="A4.T6.1.1.1.3.1">Affected Layers Ratio</span> (from layer 1)</td>
</tr>
<tr class="ltx_tr" id="A4.T6.51.51.52.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="A4.T6.51.51.52.1.1">25%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A4.T6.51.51.52.1.2">50%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A4.T6.51.51.52.1.3">75%</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="A4.T6.51.51.52.1.4">100%</td>
</tr>
<tr class="ltx_tr" id="A4.T6.3.3.3">
<th class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_row ltx_border_t" id="A4.T6.3.3.3.3">1</th>
<th class="ltx_td ltx_nopad_l ltx_align_center ltx_th ltx_th_row ltx_border_t" id="A4.T6.3.3.3.4">
<span class="ltx_text ltx_font_bold" id="A4.T6.3.3.3.4.1">None</span> (4-shot baseline)</th>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="4" id="A4.T6.3.3.3.2">
<math alttext="\pm 0" class="ltx_Math" display="inline" id="A4.T6.2.2.2.1.m1.1"><semantics id="A4.T6.2.2.2.1.m1.1a"><mrow id="A4.T6.2.2.2.1.m1.1.1" xref="A4.T6.2.2.2.1.m1.1.1.cmml"><mo id="A4.T6.2.2.2.1.m1.1.1a" xref="A4.T6.2.2.2.1.m1.1.1.cmml">±</mo><mn id="A4.T6.2.2.2.1.m1.1.1.2" xref="A4.T6.2.2.2.1.m1.1.1.2.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.T6.2.2.2.1.m1.1b"><apply id="A4.T6.2.2.2.1.m1.1.1.cmml" xref="A4.T6.2.2.2.1.m1.1.1"><csymbol cd="latexml" id="A4.T6.2.2.2.1.m1.1.1.1.cmml" xref="A4.T6.2.2.2.1.m1.1.1">plus-or-minus</csymbol><cn id="A4.T6.2.2.2.1.m1.1.1.2.cmml" type="integer" xref="A4.T6.2.2.2.1.m1.1.1.2">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.2.2.2.1.m1.1c">\pm 0</annotation><annotation encoding="application/x-llamapun" id="A4.T6.2.2.2.1.m1.1d">± 0</annotation></semantics></math> (Acc. <math alttext="65.27" class="ltx_Math" display="inline" id="A4.T6.3.3.3.2.m2.1"><semantics id="A4.T6.3.3.3.2.m2.1a"><mn id="A4.T6.3.3.3.2.m2.1.1" xref="A4.T6.3.3.3.2.m2.1.1.cmml">65.27</mn><annotation-xml encoding="MathML-Content" id="A4.T6.3.3.3.2.m2.1b"><cn id="A4.T6.3.3.3.2.m2.1.1.cmml" type="float" xref="A4.T6.3.3.3.2.m2.1.1">65.27</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.3.3.3.2.m2.1c">65.27</annotation><annotation encoding="application/x-llamapun" id="A4.T6.3.3.3.2.m2.1d">65.27</annotation></semantics></math>)</td>
</tr>
<tr class="ltx_tr" id="A4.T6.51.51.53.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="6" id="A4.T6.51.51.53.2.1"><span class="ltx_text ltx_font_italic" id="A4.T6.51.51.53.2.1.1">– Step1: Summarize –</span></th>
</tr>
<tr class="ltx_tr" id="A4.T6.14.14.14">
<th class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_row" id="A4.T6.14.14.14.12">2</th>
<th class="ltx_td ltx_nopad_l ltx_align_center ltx_th ltx_th_row" id="A4.T6.6.6.6.3"><span class="ltx_text ltx_font_bold" id="A4.T6.6.6.6.3.3">Demo. Texts <math alttext="x_{i}" class="ltx_Math" display="inline" id="A4.T6.4.4.4.1.1.m1.1"><semantics id="A4.T6.4.4.4.1.1.m1.1a"><msub id="A4.T6.4.4.4.1.1.m1.1.1" xref="A4.T6.4.4.4.1.1.m1.1.1.cmml"><mi id="A4.T6.4.4.4.1.1.m1.1.1.2" xref="A4.T6.4.4.4.1.1.m1.1.1.2.cmml">x</mi><mi id="A4.T6.4.4.4.1.1.m1.1.1.3" xref="A4.T6.4.4.4.1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A4.T6.4.4.4.1.1.m1.1b"><apply id="A4.T6.4.4.4.1.1.m1.1.1.cmml" xref="A4.T6.4.4.4.1.1.m1.1.1"><csymbol cd="ambiguous" id="A4.T6.4.4.4.1.1.m1.1.1.1.cmml" xref="A4.T6.4.4.4.1.1.m1.1.1">subscript</csymbol><ci id="A4.T6.4.4.4.1.1.m1.1.1.2.cmml" xref="A4.T6.4.4.4.1.1.m1.1.1.2">𝑥</ci><ci id="A4.T6.4.4.4.1.1.m1.1.1.3.cmml" xref="A4.T6.4.4.4.1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.4.4.4.1.1.m1.1c">x_{i}</annotation><annotation encoding="application/x-llamapun" id="A4.T6.4.4.4.1.1.m1.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A4.T6.5.5.5.2.2.m2.1"><semantics id="A4.T6.5.5.5.2.2.m2.1a"><mo id="A4.T6.5.5.5.2.2.m2.1.1" stretchy="false" xref="A4.T6.5.5.5.2.2.m2.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A4.T6.5.5.5.2.2.m2.1b"><ci id="A4.T6.5.5.5.2.2.m2.1.1.cmml" xref="A4.T6.5.5.5.2.2.m2.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.5.5.5.2.2.m2.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="A4.T6.5.5.5.2.2.m2.1d">→</annotation></semantics></math> Forerunner <math alttext="s_{i}" class="ltx_Math" display="inline" id="A4.T6.6.6.6.3.3.m3.1"><semantics id="A4.T6.6.6.6.3.3.m3.1a"><msub id="A4.T6.6.6.6.3.3.m3.1.1" xref="A4.T6.6.6.6.3.3.m3.1.1.cmml"><mi id="A4.T6.6.6.6.3.3.m3.1.1.2" xref="A4.T6.6.6.6.3.3.m3.1.1.2.cmml">s</mi><mi id="A4.T6.6.6.6.3.3.m3.1.1.3" xref="A4.T6.6.6.6.3.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A4.T6.6.6.6.3.3.m3.1b"><apply id="A4.T6.6.6.6.3.3.m3.1.1.cmml" xref="A4.T6.6.6.6.3.3.m3.1.1"><csymbol cd="ambiguous" id="A4.T6.6.6.6.3.3.m3.1.1.1.cmml" xref="A4.T6.6.6.6.3.3.m3.1.1">subscript</csymbol><ci id="A4.T6.6.6.6.3.3.m3.1.1.2.cmml" xref="A4.T6.6.6.6.3.3.m3.1.1.2">𝑠</ci><ci id="A4.T6.6.6.6.3.3.m3.1.1.3.cmml" xref="A4.T6.6.6.6.3.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.6.6.6.3.3.m3.1c">s_{i}</annotation><annotation encoding="application/x-llamapun" id="A4.T6.6.6.6.3.3.m3.1d">italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></span></th>
<td class="ltx_td ltx_align_center" id="A4.T6.8.8.8.5">
<table class="ltx_tabular ltx_align_middle" id="A4.T6.8.8.8.5.2">
<tbody><tr class="ltx_tr" id="A4.T6.7.7.7.4.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.7.7.7.4.1.1.1" style="padding-bottom:-5.16663pt;"><math alttext="-7.65" class="ltx_Math" display="inline" id="A4.T6.7.7.7.4.1.1.1.m1.1"><semantics id="A4.T6.7.7.7.4.1.1.1.m1.1a"><mrow id="A4.T6.7.7.7.4.1.1.1.m1.1.1" xref="A4.T6.7.7.7.4.1.1.1.m1.1.1.cmml"><mo id="A4.T6.7.7.7.4.1.1.1.m1.1.1a" xref="A4.T6.7.7.7.4.1.1.1.m1.1.1.cmml">−</mo><mn id="A4.T6.7.7.7.4.1.1.1.m1.1.1.2" xref="A4.T6.7.7.7.4.1.1.1.m1.1.1.2.cmml">7.65</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.T6.7.7.7.4.1.1.1.m1.1b"><apply id="A4.T6.7.7.7.4.1.1.1.m1.1.1.cmml" xref="A4.T6.7.7.7.4.1.1.1.m1.1.1"><minus id="A4.T6.7.7.7.4.1.1.1.m1.1.1.1.cmml" xref="A4.T6.7.7.7.4.1.1.1.m1.1.1"></minus><cn id="A4.T6.7.7.7.4.1.1.1.m1.1.1.2.cmml" type="float" xref="A4.T6.7.7.7.4.1.1.1.m1.1.1.2">7.65</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.7.7.7.4.1.1.1.m1.1c">-7.65</annotation><annotation encoding="application/x-llamapun" id="A4.T6.7.7.7.4.1.1.1.m1.1d">- 7.65</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A4.T6.8.8.8.5.2.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.8.8.8.5.2.2.1"><math alttext="-0.42" class="ltx_Math" display="inline" id="A4.T6.8.8.8.5.2.2.1.m1.1"><semantics id="A4.T6.8.8.8.5.2.2.1.m1.1a"><mrow id="A4.T6.8.8.8.5.2.2.1.m1.1.1" xref="A4.T6.8.8.8.5.2.2.1.m1.1.1.cmml"><mo id="A4.T6.8.8.8.5.2.2.1.m1.1.1a" xref="A4.T6.8.8.8.5.2.2.1.m1.1.1.cmml">−</mo><mn id="A4.T6.8.8.8.5.2.2.1.m1.1.1.2" xref="A4.T6.8.8.8.5.2.2.1.m1.1.1.2.cmml">0.42</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.T6.8.8.8.5.2.2.1.m1.1b"><apply id="A4.T6.8.8.8.5.2.2.1.m1.1.1.cmml" xref="A4.T6.8.8.8.5.2.2.1.m1.1.1"><minus id="A4.T6.8.8.8.5.2.2.1.m1.1.1.1.cmml" xref="A4.T6.8.8.8.5.2.2.1.m1.1.1"></minus><cn id="A4.T6.8.8.8.5.2.2.1.m1.1.1.2.cmml" type="float" xref="A4.T6.8.8.8.5.2.2.1.m1.1.1.2">0.42</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.8.8.8.5.2.2.1.m1.1c">-0.42</annotation><annotation encoding="application/x-llamapun" id="A4.T6.8.8.8.5.2.2.1.m1.1d">- 0.42</annotation></semantics></math></td>
</tr>
</tbody></table>
</td>
<td class="ltx_td ltx_align_center" id="A4.T6.10.10.10.7">
<table class="ltx_tabular ltx_align_middle" id="A4.T6.10.10.10.7.2">
<tbody><tr class="ltx_tr" id="A4.T6.9.9.9.6.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.9.9.9.6.1.1.1" style="padding-bottom:-5.16663pt;"><math alttext="-15.69" class="ltx_Math" display="inline" id="A4.T6.9.9.9.6.1.1.1.m1.1"><semantics id="A4.T6.9.9.9.6.1.1.1.m1.1a"><mrow id="A4.T6.9.9.9.6.1.1.1.m1.1.1" xref="A4.T6.9.9.9.6.1.1.1.m1.1.1.cmml"><mo id="A4.T6.9.9.9.6.1.1.1.m1.1.1a" xref="A4.T6.9.9.9.6.1.1.1.m1.1.1.cmml">−</mo><mn id="A4.T6.9.9.9.6.1.1.1.m1.1.1.2" xref="A4.T6.9.9.9.6.1.1.1.m1.1.1.2.cmml">15.69</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.T6.9.9.9.6.1.1.1.m1.1b"><apply id="A4.T6.9.9.9.6.1.1.1.m1.1.1.cmml" xref="A4.T6.9.9.9.6.1.1.1.m1.1.1"><minus id="A4.T6.9.9.9.6.1.1.1.m1.1.1.1.cmml" xref="A4.T6.9.9.9.6.1.1.1.m1.1.1"></minus><cn id="A4.T6.9.9.9.6.1.1.1.m1.1.1.2.cmml" type="float" xref="A4.T6.9.9.9.6.1.1.1.m1.1.1.2">15.69</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.9.9.9.6.1.1.1.m1.1c">-15.69</annotation><annotation encoding="application/x-llamapun" id="A4.T6.9.9.9.6.1.1.1.m1.1d">- 15.69</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A4.T6.10.10.10.7.2.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.10.10.10.7.2.2.1"><math alttext="-0.36" class="ltx_Math" display="inline" id="A4.T6.10.10.10.7.2.2.1.m1.1"><semantics id="A4.T6.10.10.10.7.2.2.1.m1.1a"><mrow id="A4.T6.10.10.10.7.2.2.1.m1.1.1" xref="A4.T6.10.10.10.7.2.2.1.m1.1.1.cmml"><mo id="A4.T6.10.10.10.7.2.2.1.m1.1.1a" xref="A4.T6.10.10.10.7.2.2.1.m1.1.1.cmml">−</mo><mn id="A4.T6.10.10.10.7.2.2.1.m1.1.1.2" xref="A4.T6.10.10.10.7.2.2.1.m1.1.1.2.cmml">0.36</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.T6.10.10.10.7.2.2.1.m1.1b"><apply id="A4.T6.10.10.10.7.2.2.1.m1.1.1.cmml" xref="A4.T6.10.10.10.7.2.2.1.m1.1.1"><minus id="A4.T6.10.10.10.7.2.2.1.m1.1.1.1.cmml" xref="A4.T6.10.10.10.7.2.2.1.m1.1.1"></minus><cn id="A4.T6.10.10.10.7.2.2.1.m1.1.1.2.cmml" type="float" xref="A4.T6.10.10.10.7.2.2.1.m1.1.1.2">0.36</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.10.10.10.7.2.2.1.m1.1c">-0.36</annotation><annotation encoding="application/x-llamapun" id="A4.T6.10.10.10.7.2.2.1.m1.1d">- 0.36</annotation></semantics></math></td>
</tr>
</tbody></table>
</td>
<td class="ltx_td ltx_align_center" id="A4.T6.12.12.12.9">
<table class="ltx_tabular ltx_align_middle" id="A4.T6.12.12.12.9.2">
<tbody><tr class="ltx_tr" id="A4.T6.11.11.11.8.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.11.11.11.8.1.1.1" style="padding-bottom:-5.16663pt;"><math alttext="-27.15" class="ltx_Math" display="inline" id="A4.T6.11.11.11.8.1.1.1.m1.1"><semantics id="A4.T6.11.11.11.8.1.1.1.m1.1a"><mrow id="A4.T6.11.11.11.8.1.1.1.m1.1.1" xref="A4.T6.11.11.11.8.1.1.1.m1.1.1.cmml"><mo id="A4.T6.11.11.11.8.1.1.1.m1.1.1a" xref="A4.T6.11.11.11.8.1.1.1.m1.1.1.cmml">−</mo><mn id="A4.T6.11.11.11.8.1.1.1.m1.1.1.2" xref="A4.T6.11.11.11.8.1.1.1.m1.1.1.2.cmml">27.15</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.T6.11.11.11.8.1.1.1.m1.1b"><apply id="A4.T6.11.11.11.8.1.1.1.m1.1.1.cmml" xref="A4.T6.11.11.11.8.1.1.1.m1.1.1"><minus id="A4.T6.11.11.11.8.1.1.1.m1.1.1.1.cmml" xref="A4.T6.11.11.11.8.1.1.1.m1.1.1"></minus><cn id="A4.T6.11.11.11.8.1.1.1.m1.1.1.2.cmml" type="float" xref="A4.T6.11.11.11.8.1.1.1.m1.1.1.2">27.15</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.11.11.11.8.1.1.1.m1.1c">-27.15</annotation><annotation encoding="application/x-llamapun" id="A4.T6.11.11.11.8.1.1.1.m1.1d">- 27.15</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A4.T6.12.12.12.9.2.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.12.12.12.9.2.2.1"><math alttext="-0.10" class="ltx_Math" display="inline" id="A4.T6.12.12.12.9.2.2.1.m1.1"><semantics id="A4.T6.12.12.12.9.2.2.1.m1.1a"><mrow id="A4.T6.12.12.12.9.2.2.1.m1.1.1" xref="A4.T6.12.12.12.9.2.2.1.m1.1.1.cmml"><mo id="A4.T6.12.12.12.9.2.2.1.m1.1.1a" xref="A4.T6.12.12.12.9.2.2.1.m1.1.1.cmml">−</mo><mn id="A4.T6.12.12.12.9.2.2.1.m1.1.1.2" xref="A4.T6.12.12.12.9.2.2.1.m1.1.1.2.cmml">0.10</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.T6.12.12.12.9.2.2.1.m1.1b"><apply id="A4.T6.12.12.12.9.2.2.1.m1.1.1.cmml" xref="A4.T6.12.12.12.9.2.2.1.m1.1.1"><minus id="A4.T6.12.12.12.9.2.2.1.m1.1.1.1.cmml" xref="A4.T6.12.12.12.9.2.2.1.m1.1.1"></minus><cn id="A4.T6.12.12.12.9.2.2.1.m1.1.1.2.cmml" type="float" xref="A4.T6.12.12.12.9.2.2.1.m1.1.1.2">0.10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.12.12.12.9.2.2.1.m1.1c">-0.10</annotation><annotation encoding="application/x-llamapun" id="A4.T6.12.12.12.9.2.2.1.m1.1d">- 0.10</annotation></semantics></math></td>
</tr>
</tbody></table>
</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.14.14.14.11">
<table class="ltx_tabular ltx_align_middle" id="A4.T6.14.14.14.11.2">
<tbody><tr class="ltx_tr" id="A4.T6.13.13.13.10.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.13.13.13.10.1.1.1" style="padding-bottom:-5.16663pt;"><math alttext="-29.10" class="ltx_Math" display="inline" id="A4.T6.13.13.13.10.1.1.1.m1.1"><semantics id="A4.T6.13.13.13.10.1.1.1.m1.1a"><mrow id="A4.T6.13.13.13.10.1.1.1.m1.1.1" xref="A4.T6.13.13.13.10.1.1.1.m1.1.1.cmml"><mo id="A4.T6.13.13.13.10.1.1.1.m1.1.1a" xref="A4.T6.13.13.13.10.1.1.1.m1.1.1.cmml">−</mo><mn id="A4.T6.13.13.13.10.1.1.1.m1.1.1.2" xref="A4.T6.13.13.13.10.1.1.1.m1.1.1.2.cmml">29.10</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.T6.13.13.13.10.1.1.1.m1.1b"><apply id="A4.T6.13.13.13.10.1.1.1.m1.1.1.cmml" xref="A4.T6.13.13.13.10.1.1.1.m1.1.1"><minus id="A4.T6.13.13.13.10.1.1.1.m1.1.1.1.cmml" xref="A4.T6.13.13.13.10.1.1.1.m1.1.1"></minus><cn id="A4.T6.13.13.13.10.1.1.1.m1.1.1.2.cmml" type="float" xref="A4.T6.13.13.13.10.1.1.1.m1.1.1.2">29.10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.13.13.13.10.1.1.1.m1.1c">-29.10</annotation><annotation encoding="application/x-llamapun" id="A4.T6.13.13.13.10.1.1.1.m1.1d">- 29.10</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A4.T6.14.14.14.11.2.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.14.14.14.11.2.2.1"><math alttext="-4.68" class="ltx_Math" display="inline" id="A4.T6.14.14.14.11.2.2.1.m1.1"><semantics id="A4.T6.14.14.14.11.2.2.1.m1.1a"><mrow id="A4.T6.14.14.14.11.2.2.1.m1.1.1" xref="A4.T6.14.14.14.11.2.2.1.m1.1.1.cmml"><mo id="A4.T6.14.14.14.11.2.2.1.m1.1.1a" xref="A4.T6.14.14.14.11.2.2.1.m1.1.1.cmml">−</mo><mn id="A4.T6.14.14.14.11.2.2.1.m1.1.1.2" xref="A4.T6.14.14.14.11.2.2.1.m1.1.1.2.cmml">4.68</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.T6.14.14.14.11.2.2.1.m1.1b"><apply id="A4.T6.14.14.14.11.2.2.1.m1.1.1.cmml" xref="A4.T6.14.14.14.11.2.2.1.m1.1.1"><minus id="A4.T6.14.14.14.11.2.2.1.m1.1.1.1.cmml" xref="A4.T6.14.14.14.11.2.2.1.m1.1.1"></minus><cn id="A4.T6.14.14.14.11.2.2.1.m1.1.1.2.cmml" type="float" xref="A4.T6.14.14.14.11.2.2.1.m1.1.1.2">4.68</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.14.14.14.11.2.2.1.m1.1c">-4.68</annotation><annotation encoding="application/x-llamapun" id="A4.T6.14.14.14.11.2.2.1.m1.1d">- 4.68</annotation></semantics></math></td>
</tr>
</tbody></table>
</td>
</tr>
<tr class="ltx_tr" id="A4.T6.25.25.25">
<th class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_row" id="A4.T6.25.25.25.12">3</th>
<th class="ltx_td ltx_nopad_l ltx_align_center ltx_th ltx_th_row" id="A4.T6.17.17.17.3"><span class="ltx_text ltx_font_bold" id="A4.T6.17.17.17.3.3">Query Texts <math alttext="x_{q}" class="ltx_Math" display="inline" id="A4.T6.15.15.15.1.1.m1.1"><semantics id="A4.T6.15.15.15.1.1.m1.1a"><msub id="A4.T6.15.15.15.1.1.m1.1.1" xref="A4.T6.15.15.15.1.1.m1.1.1.cmml"><mi id="A4.T6.15.15.15.1.1.m1.1.1.2" xref="A4.T6.15.15.15.1.1.m1.1.1.2.cmml">x</mi><mi id="A4.T6.15.15.15.1.1.m1.1.1.3" xref="A4.T6.15.15.15.1.1.m1.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="A4.T6.15.15.15.1.1.m1.1b"><apply id="A4.T6.15.15.15.1.1.m1.1.1.cmml" xref="A4.T6.15.15.15.1.1.m1.1.1"><csymbol cd="ambiguous" id="A4.T6.15.15.15.1.1.m1.1.1.1.cmml" xref="A4.T6.15.15.15.1.1.m1.1.1">subscript</csymbol><ci id="A4.T6.15.15.15.1.1.m1.1.1.2.cmml" xref="A4.T6.15.15.15.1.1.m1.1.1.2">𝑥</ci><ci id="A4.T6.15.15.15.1.1.m1.1.1.3.cmml" xref="A4.T6.15.15.15.1.1.m1.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.15.15.15.1.1.m1.1c">x_{q}</annotation><annotation encoding="application/x-llamapun" id="A4.T6.15.15.15.1.1.m1.1d">italic_x start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A4.T6.16.16.16.2.2.m2.1"><semantics id="A4.T6.16.16.16.2.2.m2.1a"><mo id="A4.T6.16.16.16.2.2.m2.1.1" stretchy="false" xref="A4.T6.16.16.16.2.2.m2.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A4.T6.16.16.16.2.2.m2.1b"><ci id="A4.T6.16.16.16.2.2.m2.1.1.cmml" xref="A4.T6.16.16.16.2.2.m2.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.16.16.16.2.2.m2.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="A4.T6.16.16.16.2.2.m2.1d">→</annotation></semantics></math> Forerunner <math alttext="s_{q}" class="ltx_Math" display="inline" id="A4.T6.17.17.17.3.3.m3.1"><semantics id="A4.T6.17.17.17.3.3.m3.1a"><msub id="A4.T6.17.17.17.3.3.m3.1.1" xref="A4.T6.17.17.17.3.3.m3.1.1.cmml"><mi id="A4.T6.17.17.17.3.3.m3.1.1.2" xref="A4.T6.17.17.17.3.3.m3.1.1.2.cmml">s</mi><mi id="A4.T6.17.17.17.3.3.m3.1.1.3" xref="A4.T6.17.17.17.3.3.m3.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="A4.T6.17.17.17.3.3.m3.1b"><apply id="A4.T6.17.17.17.3.3.m3.1.1.cmml" xref="A4.T6.17.17.17.3.3.m3.1.1"><csymbol cd="ambiguous" id="A4.T6.17.17.17.3.3.m3.1.1.1.cmml" xref="A4.T6.17.17.17.3.3.m3.1.1">subscript</csymbol><ci id="A4.T6.17.17.17.3.3.m3.1.1.2.cmml" xref="A4.T6.17.17.17.3.3.m3.1.1.2">𝑠</ci><ci id="A4.T6.17.17.17.3.3.m3.1.1.3.cmml" xref="A4.T6.17.17.17.3.3.m3.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.17.17.17.3.3.m3.1c">s_{q}</annotation><annotation encoding="application/x-llamapun" id="A4.T6.17.17.17.3.3.m3.1d">italic_s start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math></span></th>
<td class="ltx_td ltx_align_center" id="A4.T6.19.19.19.5">
<table class="ltx_tabular ltx_align_middle" id="A4.T6.19.19.19.5.2">
<tbody><tr class="ltx_tr" id="A4.T6.18.18.18.4.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.18.18.18.4.1.1.1" style="padding-bottom:-5.16663pt;"><math alttext="-8.30" class="ltx_Math" display="inline" id="A4.T6.18.18.18.4.1.1.1.m1.1"><semantics id="A4.T6.18.18.18.4.1.1.1.m1.1a"><mrow id="A4.T6.18.18.18.4.1.1.1.m1.1.1" xref="A4.T6.18.18.18.4.1.1.1.m1.1.1.cmml"><mo id="A4.T6.18.18.18.4.1.1.1.m1.1.1a" xref="A4.T6.18.18.18.4.1.1.1.m1.1.1.cmml">−</mo><mn id="A4.T6.18.18.18.4.1.1.1.m1.1.1.2" xref="A4.T6.18.18.18.4.1.1.1.m1.1.1.2.cmml">8.30</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.T6.18.18.18.4.1.1.1.m1.1b"><apply id="A4.T6.18.18.18.4.1.1.1.m1.1.1.cmml" xref="A4.T6.18.18.18.4.1.1.1.m1.1.1"><minus id="A4.T6.18.18.18.4.1.1.1.m1.1.1.1.cmml" xref="A4.T6.18.18.18.4.1.1.1.m1.1.1"></minus><cn id="A4.T6.18.18.18.4.1.1.1.m1.1.1.2.cmml" type="float" xref="A4.T6.18.18.18.4.1.1.1.m1.1.1.2">8.30</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.18.18.18.4.1.1.1.m1.1c">-8.30</annotation><annotation encoding="application/x-llamapun" id="A4.T6.18.18.18.4.1.1.1.m1.1d">- 8.30</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A4.T6.19.19.19.5.2.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.19.19.19.5.2.2.1"><math alttext="-0.26" class="ltx_Math" display="inline" id="A4.T6.19.19.19.5.2.2.1.m1.1"><semantics id="A4.T6.19.19.19.5.2.2.1.m1.1a"><mrow id="A4.T6.19.19.19.5.2.2.1.m1.1.1" xref="A4.T6.19.19.19.5.2.2.1.m1.1.1.cmml"><mo id="A4.T6.19.19.19.5.2.2.1.m1.1.1a" xref="A4.T6.19.19.19.5.2.2.1.m1.1.1.cmml">−</mo><mn id="A4.T6.19.19.19.5.2.2.1.m1.1.1.2" xref="A4.T6.19.19.19.5.2.2.1.m1.1.1.2.cmml">0.26</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.T6.19.19.19.5.2.2.1.m1.1b"><apply id="A4.T6.19.19.19.5.2.2.1.m1.1.1.cmml" xref="A4.T6.19.19.19.5.2.2.1.m1.1.1"><minus id="A4.T6.19.19.19.5.2.2.1.m1.1.1.1.cmml" xref="A4.T6.19.19.19.5.2.2.1.m1.1.1"></minus><cn id="A4.T6.19.19.19.5.2.2.1.m1.1.1.2.cmml" type="float" xref="A4.T6.19.19.19.5.2.2.1.m1.1.1.2">0.26</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.19.19.19.5.2.2.1.m1.1c">-0.26</annotation><annotation encoding="application/x-llamapun" id="A4.T6.19.19.19.5.2.2.1.m1.1d">- 0.26</annotation></semantics></math></td>
</tr>
</tbody></table>
</td>
<td class="ltx_td ltx_align_center" id="A4.T6.21.21.21.7">
<table class="ltx_tabular ltx_align_middle" id="A4.T6.21.21.21.7.2">
<tbody><tr class="ltx_tr" id="A4.T6.20.20.20.6.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.20.20.20.6.1.1.1" style="padding-bottom:-5.16663pt;"><math alttext="-21.13" class="ltx_Math" display="inline" id="A4.T6.20.20.20.6.1.1.1.m1.1"><semantics id="A4.T6.20.20.20.6.1.1.1.m1.1a"><mrow id="A4.T6.20.20.20.6.1.1.1.m1.1.1" xref="A4.T6.20.20.20.6.1.1.1.m1.1.1.cmml"><mo id="A4.T6.20.20.20.6.1.1.1.m1.1.1a" xref="A4.T6.20.20.20.6.1.1.1.m1.1.1.cmml">−</mo><mn id="A4.T6.20.20.20.6.1.1.1.m1.1.1.2" xref="A4.T6.20.20.20.6.1.1.1.m1.1.1.2.cmml">21.13</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.T6.20.20.20.6.1.1.1.m1.1b"><apply id="A4.T6.20.20.20.6.1.1.1.m1.1.1.cmml" xref="A4.T6.20.20.20.6.1.1.1.m1.1.1"><minus id="A4.T6.20.20.20.6.1.1.1.m1.1.1.1.cmml" xref="A4.T6.20.20.20.6.1.1.1.m1.1.1"></minus><cn id="A4.T6.20.20.20.6.1.1.1.m1.1.1.2.cmml" type="float" xref="A4.T6.20.20.20.6.1.1.1.m1.1.1.2">21.13</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.20.20.20.6.1.1.1.m1.1c">-21.13</annotation><annotation encoding="application/x-llamapun" id="A4.T6.20.20.20.6.1.1.1.m1.1d">- 21.13</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A4.T6.21.21.21.7.2.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.21.21.21.7.2.2.1"><math alttext="-0.13" class="ltx_Math" display="inline" id="A4.T6.21.21.21.7.2.2.1.m1.1"><semantics id="A4.T6.21.21.21.7.2.2.1.m1.1a"><mrow id="A4.T6.21.21.21.7.2.2.1.m1.1.1" xref="A4.T6.21.21.21.7.2.2.1.m1.1.1.cmml"><mo id="A4.T6.21.21.21.7.2.2.1.m1.1.1a" xref="A4.T6.21.21.21.7.2.2.1.m1.1.1.cmml">−</mo><mn id="A4.T6.21.21.21.7.2.2.1.m1.1.1.2" xref="A4.T6.21.21.21.7.2.2.1.m1.1.1.2.cmml">0.13</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.T6.21.21.21.7.2.2.1.m1.1b"><apply id="A4.T6.21.21.21.7.2.2.1.m1.1.1.cmml" xref="A4.T6.21.21.21.7.2.2.1.m1.1.1"><minus id="A4.T6.21.21.21.7.2.2.1.m1.1.1.1.cmml" xref="A4.T6.21.21.21.7.2.2.1.m1.1.1"></minus><cn id="A4.T6.21.21.21.7.2.2.1.m1.1.1.2.cmml" type="float" xref="A4.T6.21.21.21.7.2.2.1.m1.1.1.2">0.13</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.21.21.21.7.2.2.1.m1.1c">-0.13</annotation><annotation encoding="application/x-llamapun" id="A4.T6.21.21.21.7.2.2.1.m1.1d">- 0.13</annotation></semantics></math></td>
</tr>
</tbody></table>
</td>
<td class="ltx_td ltx_align_center" id="A4.T6.23.23.23.9">
<table class="ltx_tabular ltx_align_middle" id="A4.T6.23.23.23.9.2">
<tbody><tr class="ltx_tr" id="A4.T6.22.22.22.8.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.22.22.22.8.1.1.1" style="padding-bottom:-5.16663pt;"><math alttext="-28.84" class="ltx_Math" display="inline" id="A4.T6.22.22.22.8.1.1.1.m1.1"><semantics id="A4.T6.22.22.22.8.1.1.1.m1.1a"><mrow id="A4.T6.22.22.22.8.1.1.1.m1.1.1" xref="A4.T6.22.22.22.8.1.1.1.m1.1.1.cmml"><mo id="A4.T6.22.22.22.8.1.1.1.m1.1.1a" xref="A4.T6.22.22.22.8.1.1.1.m1.1.1.cmml">−</mo><mn id="A4.T6.22.22.22.8.1.1.1.m1.1.1.2" xref="A4.T6.22.22.22.8.1.1.1.m1.1.1.2.cmml">28.84</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.T6.22.22.22.8.1.1.1.m1.1b"><apply id="A4.T6.22.22.22.8.1.1.1.m1.1.1.cmml" xref="A4.T6.22.22.22.8.1.1.1.m1.1.1"><minus id="A4.T6.22.22.22.8.1.1.1.m1.1.1.1.cmml" xref="A4.T6.22.22.22.8.1.1.1.m1.1.1"></minus><cn id="A4.T6.22.22.22.8.1.1.1.m1.1.1.2.cmml" type="float" xref="A4.T6.22.22.22.8.1.1.1.m1.1.1.2">28.84</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.22.22.22.8.1.1.1.m1.1c">-28.84</annotation><annotation encoding="application/x-llamapun" id="A4.T6.22.22.22.8.1.1.1.m1.1d">- 28.84</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A4.T6.23.23.23.9.2.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.23.23.23.9.2.2.1"><math alttext="+0.19" class="ltx_Math" display="inline" id="A4.T6.23.23.23.9.2.2.1.m1.1"><semantics id="A4.T6.23.23.23.9.2.2.1.m1.1a"><mrow id="A4.T6.23.23.23.9.2.2.1.m1.1.1" xref="A4.T6.23.23.23.9.2.2.1.m1.1.1.cmml"><mo id="A4.T6.23.23.23.9.2.2.1.m1.1.1a" xref="A4.T6.23.23.23.9.2.2.1.m1.1.1.cmml">+</mo><mn id="A4.T6.23.23.23.9.2.2.1.m1.1.1.2" xref="A4.T6.23.23.23.9.2.2.1.m1.1.1.2.cmml">0.19</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.T6.23.23.23.9.2.2.1.m1.1b"><apply id="A4.T6.23.23.23.9.2.2.1.m1.1.1.cmml" xref="A4.T6.23.23.23.9.2.2.1.m1.1.1"><plus id="A4.T6.23.23.23.9.2.2.1.m1.1.1.1.cmml" xref="A4.T6.23.23.23.9.2.2.1.m1.1.1"></plus><cn id="A4.T6.23.23.23.9.2.2.1.m1.1.1.2.cmml" type="float" xref="A4.T6.23.23.23.9.2.2.1.m1.1.1.2">0.19</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.23.23.23.9.2.2.1.m1.1c">+0.19</annotation><annotation encoding="application/x-llamapun" id="A4.T6.23.23.23.9.2.2.1.m1.1d">+ 0.19</annotation></semantics></math></td>
</tr>
</tbody></table>
</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.25.25.25.11">
<table class="ltx_tabular ltx_align_middle" id="A4.T6.25.25.25.11.2">
<tbody><tr class="ltx_tr" id="A4.T6.24.24.24.10.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.24.24.24.10.1.1.1" style="padding-bottom:-5.16663pt;"><math alttext="-31.74" class="ltx_Math" display="inline" id="A4.T6.24.24.24.10.1.1.1.m1.1"><semantics id="A4.T6.24.24.24.10.1.1.1.m1.1a"><mrow id="A4.T6.24.24.24.10.1.1.1.m1.1.1" xref="A4.T6.24.24.24.10.1.1.1.m1.1.1.cmml"><mo id="A4.T6.24.24.24.10.1.1.1.m1.1.1a" xref="A4.T6.24.24.24.10.1.1.1.m1.1.1.cmml">−</mo><mn id="A4.T6.24.24.24.10.1.1.1.m1.1.1.2" xref="A4.T6.24.24.24.10.1.1.1.m1.1.1.2.cmml">31.74</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.T6.24.24.24.10.1.1.1.m1.1b"><apply id="A4.T6.24.24.24.10.1.1.1.m1.1.1.cmml" xref="A4.T6.24.24.24.10.1.1.1.m1.1.1"><minus id="A4.T6.24.24.24.10.1.1.1.m1.1.1.1.cmml" xref="A4.T6.24.24.24.10.1.1.1.m1.1.1"></minus><cn id="A4.T6.24.24.24.10.1.1.1.m1.1.1.2.cmml" type="float" xref="A4.T6.24.24.24.10.1.1.1.m1.1.1.2">31.74</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.24.24.24.10.1.1.1.m1.1c">-31.74</annotation><annotation encoding="application/x-llamapun" id="A4.T6.24.24.24.10.1.1.1.m1.1d">- 31.74</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A4.T6.25.25.25.11.2.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.25.25.25.11.2.2.1"><math alttext="-0.00" class="ltx_Math" display="inline" id="A4.T6.25.25.25.11.2.2.1.m1.1"><semantics id="A4.T6.25.25.25.11.2.2.1.m1.1a"><mrow id="A4.T6.25.25.25.11.2.2.1.m1.1.1" xref="A4.T6.25.25.25.11.2.2.1.m1.1.1.cmml"><mo id="A4.T6.25.25.25.11.2.2.1.m1.1.1a" xref="A4.T6.25.25.25.11.2.2.1.m1.1.1.cmml">−</mo><mn id="A4.T6.25.25.25.11.2.2.1.m1.1.1.2" xref="A4.T6.25.25.25.11.2.2.1.m1.1.1.2.cmml">0.00</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.T6.25.25.25.11.2.2.1.m1.1b"><apply id="A4.T6.25.25.25.11.2.2.1.m1.1.1.cmml" xref="A4.T6.25.25.25.11.2.2.1.m1.1.1"><minus id="A4.T6.25.25.25.11.2.2.1.m1.1.1.1.cmml" xref="A4.T6.25.25.25.11.2.2.1.m1.1.1"></minus><cn id="A4.T6.25.25.25.11.2.2.1.m1.1.1.2.cmml" type="float" xref="A4.T6.25.25.25.11.2.2.1.m1.1.1.2">0.00</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.25.25.25.11.2.2.1.m1.1c">-0.00</annotation><annotation encoding="application/x-llamapun" id="A4.T6.25.25.25.11.2.2.1.m1.1d">- 0.00</annotation></semantics></math></td>
</tr>
</tbody></table>
</td>
</tr>
<tr class="ltx_tr" id="A4.T6.51.51.54.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="6" id="A4.T6.51.51.54.3.1"><span class="ltx_text ltx_font_italic" id="A4.T6.51.51.54.3.1.1">– Step2: Semantics Merge –</span></th>
</tr>
<tr class="ltx_tr" id="A4.T6.36.36.36">
<th class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_row" id="A4.T6.36.36.36.12">4</th>
<th class="ltx_td ltx_nopad_l ltx_align_center ltx_th ltx_th_row" id="A4.T6.28.28.28.3"><span class="ltx_text ltx_font_bold" id="A4.T6.28.28.28.3.3">Demo. Forerunner <math alttext="s_{i}" class="ltx_Math" display="inline" id="A4.T6.26.26.26.1.1.m1.1"><semantics id="A4.T6.26.26.26.1.1.m1.1a"><msub id="A4.T6.26.26.26.1.1.m1.1.1" xref="A4.T6.26.26.26.1.1.m1.1.1.cmml"><mi id="A4.T6.26.26.26.1.1.m1.1.1.2" xref="A4.T6.26.26.26.1.1.m1.1.1.2.cmml">s</mi><mi id="A4.T6.26.26.26.1.1.m1.1.1.3" xref="A4.T6.26.26.26.1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A4.T6.26.26.26.1.1.m1.1b"><apply id="A4.T6.26.26.26.1.1.m1.1.1.cmml" xref="A4.T6.26.26.26.1.1.m1.1.1"><csymbol cd="ambiguous" id="A4.T6.26.26.26.1.1.m1.1.1.1.cmml" xref="A4.T6.26.26.26.1.1.m1.1.1">subscript</csymbol><ci id="A4.T6.26.26.26.1.1.m1.1.1.2.cmml" xref="A4.T6.26.26.26.1.1.m1.1.1.2">𝑠</ci><ci id="A4.T6.26.26.26.1.1.m1.1.1.3.cmml" xref="A4.T6.26.26.26.1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.26.26.26.1.1.m1.1c">s_{i}</annotation><annotation encoding="application/x-llamapun" id="A4.T6.26.26.26.1.1.m1.1d">italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A4.T6.27.27.27.2.2.m2.1"><semantics id="A4.T6.27.27.27.2.2.m2.1a"><mo id="A4.T6.27.27.27.2.2.m2.1.1" stretchy="false" xref="A4.T6.27.27.27.2.2.m2.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A4.T6.27.27.27.2.2.m2.1b"><ci id="A4.T6.27.27.27.2.2.m2.1.1.cmml" xref="A4.T6.27.27.27.2.2.m2.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.27.27.27.2.2.m2.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="A4.T6.27.27.27.2.2.m2.1d">→</annotation></semantics></math> Label <math alttext="y_{i}" class="ltx_Math" display="inline" id="A4.T6.28.28.28.3.3.m3.1"><semantics id="A4.T6.28.28.28.3.3.m3.1a"><msub id="A4.T6.28.28.28.3.3.m3.1.1" xref="A4.T6.28.28.28.3.3.m3.1.1.cmml"><mi id="A4.T6.28.28.28.3.3.m3.1.1.2" xref="A4.T6.28.28.28.3.3.m3.1.1.2.cmml">y</mi><mi id="A4.T6.28.28.28.3.3.m3.1.1.3" xref="A4.T6.28.28.28.3.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A4.T6.28.28.28.3.3.m3.1b"><apply id="A4.T6.28.28.28.3.3.m3.1.1.cmml" xref="A4.T6.28.28.28.3.3.m3.1.1"><csymbol cd="ambiguous" id="A4.T6.28.28.28.3.3.m3.1.1.1.cmml" xref="A4.T6.28.28.28.3.3.m3.1.1">subscript</csymbol><ci id="A4.T6.28.28.28.3.3.m3.1.1.2.cmml" xref="A4.T6.28.28.28.3.3.m3.1.1.2">𝑦</ci><ci id="A4.T6.28.28.28.3.3.m3.1.1.3.cmml" xref="A4.T6.28.28.28.3.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.28.28.28.3.3.m3.1c">y_{i}</annotation><annotation encoding="application/x-llamapun" id="A4.T6.28.28.28.3.3.m3.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></span></th>
<td class="ltx_td ltx_align_center" id="A4.T6.30.30.30.5">
<table class="ltx_tabular ltx_align_middle" id="A4.T6.30.30.30.5.2">
<tbody><tr class="ltx_tr" id="A4.T6.29.29.29.4.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.29.29.29.4.1.1.1" style="padding-bottom:-5.16663pt;"><math alttext="-1.01" class="ltx_Math" display="inline" id="A4.T6.29.29.29.4.1.1.1.m1.1"><semantics id="A4.T6.29.29.29.4.1.1.1.m1.1a"><mrow id="A4.T6.29.29.29.4.1.1.1.m1.1.1" xref="A4.T6.29.29.29.4.1.1.1.m1.1.1.cmml"><mo id="A4.T6.29.29.29.4.1.1.1.m1.1.1a" xref="A4.T6.29.29.29.4.1.1.1.m1.1.1.cmml">−</mo><mn id="A4.T6.29.29.29.4.1.1.1.m1.1.1.2" xref="A4.T6.29.29.29.4.1.1.1.m1.1.1.2.cmml">1.01</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.T6.29.29.29.4.1.1.1.m1.1b"><apply id="A4.T6.29.29.29.4.1.1.1.m1.1.1.cmml" xref="A4.T6.29.29.29.4.1.1.1.m1.1.1"><minus id="A4.T6.29.29.29.4.1.1.1.m1.1.1.1.cmml" xref="A4.T6.29.29.29.4.1.1.1.m1.1.1"></minus><cn id="A4.T6.29.29.29.4.1.1.1.m1.1.1.2.cmml" type="float" xref="A4.T6.29.29.29.4.1.1.1.m1.1.1.2">1.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.29.29.29.4.1.1.1.m1.1c">-1.01</annotation><annotation encoding="application/x-llamapun" id="A4.T6.29.29.29.4.1.1.1.m1.1d">- 1.01</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A4.T6.30.30.30.5.2.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.30.30.30.5.2.2.1"><math alttext="+0.68" class="ltx_Math" display="inline" id="A4.T6.30.30.30.5.2.2.1.m1.1"><semantics id="A4.T6.30.30.30.5.2.2.1.m1.1a"><mrow id="A4.T6.30.30.30.5.2.2.1.m1.1.1" xref="A4.T6.30.30.30.5.2.2.1.m1.1.1.cmml"><mo id="A4.T6.30.30.30.5.2.2.1.m1.1.1a" xref="A4.T6.30.30.30.5.2.2.1.m1.1.1.cmml">+</mo><mn id="A4.T6.30.30.30.5.2.2.1.m1.1.1.2" xref="A4.T6.30.30.30.5.2.2.1.m1.1.1.2.cmml">0.68</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.T6.30.30.30.5.2.2.1.m1.1b"><apply id="A4.T6.30.30.30.5.2.2.1.m1.1.1.cmml" xref="A4.T6.30.30.30.5.2.2.1.m1.1.1"><plus id="A4.T6.30.30.30.5.2.2.1.m1.1.1.1.cmml" xref="A4.T6.30.30.30.5.2.2.1.m1.1.1"></plus><cn id="A4.T6.30.30.30.5.2.2.1.m1.1.1.2.cmml" type="float" xref="A4.T6.30.30.30.5.2.2.1.m1.1.1.2">0.68</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.30.30.30.5.2.2.1.m1.1c">+0.68</annotation><annotation encoding="application/x-llamapun" id="A4.T6.30.30.30.5.2.2.1.m1.1d">+ 0.68</annotation></semantics></math></td>
</tr>
</tbody></table>
</td>
<td class="ltx_td ltx_align_center" id="A4.T6.32.32.32.7">
<table class="ltx_tabular ltx_align_middle" id="A4.T6.32.32.32.7.2">
<tbody><tr class="ltx_tr" id="A4.T6.31.31.31.6.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.31.31.31.6.1.1.1" style="padding-bottom:-5.16663pt;"><math alttext="-1.92" class="ltx_Math" display="inline" id="A4.T6.31.31.31.6.1.1.1.m1.1"><semantics id="A4.T6.31.31.31.6.1.1.1.m1.1a"><mrow id="A4.T6.31.31.31.6.1.1.1.m1.1.1" xref="A4.T6.31.31.31.6.1.1.1.m1.1.1.cmml"><mo id="A4.T6.31.31.31.6.1.1.1.m1.1.1a" xref="A4.T6.31.31.31.6.1.1.1.m1.1.1.cmml">−</mo><mn id="A4.T6.31.31.31.6.1.1.1.m1.1.1.2" xref="A4.T6.31.31.31.6.1.1.1.m1.1.1.2.cmml">1.92</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.T6.31.31.31.6.1.1.1.m1.1b"><apply id="A4.T6.31.31.31.6.1.1.1.m1.1.1.cmml" xref="A4.T6.31.31.31.6.1.1.1.m1.1.1"><minus id="A4.T6.31.31.31.6.1.1.1.m1.1.1.1.cmml" xref="A4.T6.31.31.31.6.1.1.1.m1.1.1"></minus><cn id="A4.T6.31.31.31.6.1.1.1.m1.1.1.2.cmml" type="float" xref="A4.T6.31.31.31.6.1.1.1.m1.1.1.2">1.92</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.31.31.31.6.1.1.1.m1.1c">-1.92</annotation><annotation encoding="application/x-llamapun" id="A4.T6.31.31.31.6.1.1.1.m1.1d">- 1.92</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A4.T6.32.32.32.7.2.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.32.32.32.7.2.2.1"><math alttext="-0.03" class="ltx_Math" display="inline" id="A4.T6.32.32.32.7.2.2.1.m1.1"><semantics id="A4.T6.32.32.32.7.2.2.1.m1.1a"><mrow id="A4.T6.32.32.32.7.2.2.1.m1.1.1" xref="A4.T6.32.32.32.7.2.2.1.m1.1.1.cmml"><mo id="A4.T6.32.32.32.7.2.2.1.m1.1.1a" xref="A4.T6.32.32.32.7.2.2.1.m1.1.1.cmml">−</mo><mn id="A4.T6.32.32.32.7.2.2.1.m1.1.1.2" xref="A4.T6.32.32.32.7.2.2.1.m1.1.1.2.cmml">0.03</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.T6.32.32.32.7.2.2.1.m1.1b"><apply id="A4.T6.32.32.32.7.2.2.1.m1.1.1.cmml" xref="A4.T6.32.32.32.7.2.2.1.m1.1.1"><minus id="A4.T6.32.32.32.7.2.2.1.m1.1.1.1.cmml" xref="A4.T6.32.32.32.7.2.2.1.m1.1.1"></minus><cn id="A4.T6.32.32.32.7.2.2.1.m1.1.1.2.cmml" type="float" xref="A4.T6.32.32.32.7.2.2.1.m1.1.1.2">0.03</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.32.32.32.7.2.2.1.m1.1c">-0.03</annotation><annotation encoding="application/x-llamapun" id="A4.T6.32.32.32.7.2.2.1.m1.1d">- 0.03</annotation></semantics></math></td>
</tr>
</tbody></table>
</td>
<td class="ltx_td ltx_align_center" id="A4.T6.34.34.34.9">
<table class="ltx_tabular ltx_align_middle" id="A4.T6.34.34.34.9.2">
<tbody><tr class="ltx_tr" id="A4.T6.33.33.33.8.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.33.33.33.8.1.1.1" style="padding-bottom:-5.16663pt;"><math alttext="-1.04" class="ltx_Math" display="inline" id="A4.T6.33.33.33.8.1.1.1.m1.1"><semantics id="A4.T6.33.33.33.8.1.1.1.m1.1a"><mrow id="A4.T6.33.33.33.8.1.1.1.m1.1.1" xref="A4.T6.33.33.33.8.1.1.1.m1.1.1.cmml"><mo id="A4.T6.33.33.33.8.1.1.1.m1.1.1a" xref="A4.T6.33.33.33.8.1.1.1.m1.1.1.cmml">−</mo><mn id="A4.T6.33.33.33.8.1.1.1.m1.1.1.2" xref="A4.T6.33.33.33.8.1.1.1.m1.1.1.2.cmml">1.04</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.T6.33.33.33.8.1.1.1.m1.1b"><apply id="A4.T6.33.33.33.8.1.1.1.m1.1.1.cmml" xref="A4.T6.33.33.33.8.1.1.1.m1.1.1"><minus id="A4.T6.33.33.33.8.1.1.1.m1.1.1.1.cmml" xref="A4.T6.33.33.33.8.1.1.1.m1.1.1"></minus><cn id="A4.T6.33.33.33.8.1.1.1.m1.1.1.2.cmml" type="float" xref="A4.T6.33.33.33.8.1.1.1.m1.1.1.2">1.04</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.33.33.33.8.1.1.1.m1.1c">-1.04</annotation><annotation encoding="application/x-llamapun" id="A4.T6.33.33.33.8.1.1.1.m1.1d">- 1.04</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A4.T6.34.34.34.9.2.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.34.34.34.9.2.2.1"><math alttext="-0.00" class="ltx_Math" display="inline" id="A4.T6.34.34.34.9.2.2.1.m1.1"><semantics id="A4.T6.34.34.34.9.2.2.1.m1.1a"><mrow id="A4.T6.34.34.34.9.2.2.1.m1.1.1" xref="A4.T6.34.34.34.9.2.2.1.m1.1.1.cmml"><mo id="A4.T6.34.34.34.9.2.2.1.m1.1.1a" xref="A4.T6.34.34.34.9.2.2.1.m1.1.1.cmml">−</mo><mn id="A4.T6.34.34.34.9.2.2.1.m1.1.1.2" xref="A4.T6.34.34.34.9.2.2.1.m1.1.1.2.cmml">0.00</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.T6.34.34.34.9.2.2.1.m1.1b"><apply id="A4.T6.34.34.34.9.2.2.1.m1.1.1.cmml" xref="A4.T6.34.34.34.9.2.2.1.m1.1.1"><minus id="A4.T6.34.34.34.9.2.2.1.m1.1.1.1.cmml" xref="A4.T6.34.34.34.9.2.2.1.m1.1.1"></minus><cn id="A4.T6.34.34.34.9.2.2.1.m1.1.1.2.cmml" type="float" xref="A4.T6.34.34.34.9.2.2.1.m1.1.1.2">0.00</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.34.34.34.9.2.2.1.m1.1c">-0.00</annotation><annotation encoding="application/x-llamapun" id="A4.T6.34.34.34.9.2.2.1.m1.1d">- 0.00</annotation></semantics></math></td>
</tr>
</tbody></table>
</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.36.36.36.11">
<table class="ltx_tabular ltx_align_middle" id="A4.T6.36.36.36.11.2">
<tbody><tr class="ltx_tr" id="A4.T6.35.35.35.10.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.35.35.35.10.1.1.1" style="padding-bottom:-5.16663pt;"><math alttext="-1.27" class="ltx_Math" display="inline" id="A4.T6.35.35.35.10.1.1.1.m1.1"><semantics id="A4.T6.35.35.35.10.1.1.1.m1.1a"><mrow id="A4.T6.35.35.35.10.1.1.1.m1.1.1" xref="A4.T6.35.35.35.10.1.1.1.m1.1.1.cmml"><mo id="A4.T6.35.35.35.10.1.1.1.m1.1.1a" xref="A4.T6.35.35.35.10.1.1.1.m1.1.1.cmml">−</mo><mn id="A4.T6.35.35.35.10.1.1.1.m1.1.1.2" xref="A4.T6.35.35.35.10.1.1.1.m1.1.1.2.cmml">1.27</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.T6.35.35.35.10.1.1.1.m1.1b"><apply id="A4.T6.35.35.35.10.1.1.1.m1.1.1.cmml" xref="A4.T6.35.35.35.10.1.1.1.m1.1.1"><minus id="A4.T6.35.35.35.10.1.1.1.m1.1.1.1.cmml" xref="A4.T6.35.35.35.10.1.1.1.m1.1.1"></minus><cn id="A4.T6.35.35.35.10.1.1.1.m1.1.1.2.cmml" type="float" xref="A4.T6.35.35.35.10.1.1.1.m1.1.1.2">1.27</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.35.35.35.10.1.1.1.m1.1c">-1.27</annotation><annotation encoding="application/x-llamapun" id="A4.T6.35.35.35.10.1.1.1.m1.1d">- 1.27</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A4.T6.36.36.36.11.2.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.36.36.36.11.2.2.1"><math alttext="-0.07" class="ltx_Math" display="inline" id="A4.T6.36.36.36.11.2.2.1.m1.1"><semantics id="A4.T6.36.36.36.11.2.2.1.m1.1a"><mrow id="A4.T6.36.36.36.11.2.2.1.m1.1.1" xref="A4.T6.36.36.36.11.2.2.1.m1.1.1.cmml"><mo id="A4.T6.36.36.36.11.2.2.1.m1.1.1a" xref="A4.T6.36.36.36.11.2.2.1.m1.1.1.cmml">−</mo><mn id="A4.T6.36.36.36.11.2.2.1.m1.1.1.2" xref="A4.T6.36.36.36.11.2.2.1.m1.1.1.2.cmml">0.07</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.T6.36.36.36.11.2.2.1.m1.1b"><apply id="A4.T6.36.36.36.11.2.2.1.m1.1.1.cmml" xref="A4.T6.36.36.36.11.2.2.1.m1.1.1"><minus id="A4.T6.36.36.36.11.2.2.1.m1.1.1.1.cmml" xref="A4.T6.36.36.36.11.2.2.1.m1.1.1"></minus><cn id="A4.T6.36.36.36.11.2.2.1.m1.1.1.2.cmml" type="float" xref="A4.T6.36.36.36.11.2.2.1.m1.1.1.2">0.07</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.36.36.36.11.2.2.1.m1.1c">-0.07</annotation><annotation encoding="application/x-llamapun" id="A4.T6.36.36.36.11.2.2.1.m1.1d">- 0.07</annotation></semantics></math></td>
</tr>
</tbody></table>
</td>
</tr>
<tr class="ltx_tr" id="A4.T6.51.51.55.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="6" id="A4.T6.51.51.55.4.1"><span class="ltx_text ltx_font_italic" id="A4.T6.51.51.55.4.1.1">– Step3: Feature Retrieval &amp; Copy –</span></th>
</tr>
<tr class="ltx_tr" id="A4.T6.47.47.47">
<th class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_row" id="A4.T6.47.47.47.12">5</th>
<th class="ltx_td ltx_nopad_l ltx_align_center ltx_th ltx_th_row" id="A4.T6.39.39.39.3"><span class="ltx_text ltx_font_bold" id="A4.T6.39.39.39.3.3">Label <math alttext="y_{i}" class="ltx_Math" display="inline" id="A4.T6.37.37.37.1.1.m1.1"><semantics id="A4.T6.37.37.37.1.1.m1.1a"><msub id="A4.T6.37.37.37.1.1.m1.1.1" xref="A4.T6.37.37.37.1.1.m1.1.1.cmml"><mi id="A4.T6.37.37.37.1.1.m1.1.1.2" xref="A4.T6.37.37.37.1.1.m1.1.1.2.cmml">y</mi><mi id="A4.T6.37.37.37.1.1.m1.1.1.3" xref="A4.T6.37.37.37.1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A4.T6.37.37.37.1.1.m1.1b"><apply id="A4.T6.37.37.37.1.1.m1.1.1.cmml" xref="A4.T6.37.37.37.1.1.m1.1.1"><csymbol cd="ambiguous" id="A4.T6.37.37.37.1.1.m1.1.1.1.cmml" xref="A4.T6.37.37.37.1.1.m1.1.1">subscript</csymbol><ci id="A4.T6.37.37.37.1.1.m1.1.1.2.cmml" xref="A4.T6.37.37.37.1.1.m1.1.1.2">𝑦</ci><ci id="A4.T6.37.37.37.1.1.m1.1.1.3.cmml" xref="A4.T6.37.37.37.1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.37.37.37.1.1.m1.1c">y_{i}</annotation><annotation encoding="application/x-llamapun" id="A4.T6.37.37.37.1.1.m1.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A4.T6.38.38.38.2.2.m2.1"><semantics id="A4.T6.38.38.38.2.2.m2.1a"><mo id="A4.T6.38.38.38.2.2.m2.1.1" stretchy="false" xref="A4.T6.38.38.38.2.2.m2.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A4.T6.38.38.38.2.2.m2.1b"><ci id="A4.T6.38.38.38.2.2.m2.1.1.cmml" xref="A4.T6.38.38.38.2.2.m2.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.38.38.38.2.2.m2.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="A4.T6.38.38.38.2.2.m2.1d">→</annotation></semantics></math> Query Forerunner <math alttext="s_{q}" class="ltx_Math" display="inline" id="A4.T6.39.39.39.3.3.m3.1"><semantics id="A4.T6.39.39.39.3.3.m3.1a"><msub id="A4.T6.39.39.39.3.3.m3.1.1" xref="A4.T6.39.39.39.3.3.m3.1.1.cmml"><mi id="A4.T6.39.39.39.3.3.m3.1.1.2" xref="A4.T6.39.39.39.3.3.m3.1.1.2.cmml">s</mi><mi id="A4.T6.39.39.39.3.3.m3.1.1.3" xref="A4.T6.39.39.39.3.3.m3.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="A4.T6.39.39.39.3.3.m3.1b"><apply id="A4.T6.39.39.39.3.3.m3.1.1.cmml" xref="A4.T6.39.39.39.3.3.m3.1.1"><csymbol cd="ambiguous" id="A4.T6.39.39.39.3.3.m3.1.1.1.cmml" xref="A4.T6.39.39.39.3.3.m3.1.1">subscript</csymbol><ci id="A4.T6.39.39.39.3.3.m3.1.1.2.cmml" xref="A4.T6.39.39.39.3.3.m3.1.1.2">𝑠</ci><ci id="A4.T6.39.39.39.3.3.m3.1.1.3.cmml" xref="A4.T6.39.39.39.3.3.m3.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.39.39.39.3.3.m3.1c">s_{q}</annotation><annotation encoding="application/x-llamapun" id="A4.T6.39.39.39.3.3.m3.1d">italic_s start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math></span></th>
<td class="ltx_td ltx_align_center" id="A4.T6.41.41.41.5">
<table class="ltx_tabular ltx_align_middle" id="A4.T6.41.41.41.5.2">
<tbody><tr class="ltx_tr" id="A4.T6.40.40.40.4.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.40.40.40.4.1.1.1" style="padding-bottom:-5.16663pt;"><math alttext="+3.32" class="ltx_Math" display="inline" id="A4.T6.40.40.40.4.1.1.1.m1.1"><semantics id="A4.T6.40.40.40.4.1.1.1.m1.1a"><mrow id="A4.T6.40.40.40.4.1.1.1.m1.1.1" xref="A4.T6.40.40.40.4.1.1.1.m1.1.1.cmml"><mo id="A4.T6.40.40.40.4.1.1.1.m1.1.1a" xref="A4.T6.40.40.40.4.1.1.1.m1.1.1.cmml">+</mo><mn id="A4.T6.40.40.40.4.1.1.1.m1.1.1.2" xref="A4.T6.40.40.40.4.1.1.1.m1.1.1.2.cmml">3.32</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.T6.40.40.40.4.1.1.1.m1.1b"><apply id="A4.T6.40.40.40.4.1.1.1.m1.1.1.cmml" xref="A4.T6.40.40.40.4.1.1.1.m1.1.1"><plus id="A4.T6.40.40.40.4.1.1.1.m1.1.1.1.cmml" xref="A4.T6.40.40.40.4.1.1.1.m1.1.1"></plus><cn id="A4.T6.40.40.40.4.1.1.1.m1.1.1.2.cmml" type="float" xref="A4.T6.40.40.40.4.1.1.1.m1.1.1.2">3.32</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.40.40.40.4.1.1.1.m1.1c">+3.32</annotation><annotation encoding="application/x-llamapun" id="A4.T6.40.40.40.4.1.1.1.m1.1d">+ 3.32</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A4.T6.41.41.41.5.2.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.41.41.41.5.2.2.1"><math alttext="+3.71" class="ltx_Math" display="inline" id="A4.T6.41.41.41.5.2.2.1.m1.1"><semantics id="A4.T6.41.41.41.5.2.2.1.m1.1a"><mrow id="A4.T6.41.41.41.5.2.2.1.m1.1.1" xref="A4.T6.41.41.41.5.2.2.1.m1.1.1.cmml"><mo id="A4.T6.41.41.41.5.2.2.1.m1.1.1a" xref="A4.T6.41.41.41.5.2.2.1.m1.1.1.cmml">+</mo><mn id="A4.T6.41.41.41.5.2.2.1.m1.1.1.2" xref="A4.T6.41.41.41.5.2.2.1.m1.1.1.2.cmml">3.71</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.T6.41.41.41.5.2.2.1.m1.1b"><apply id="A4.T6.41.41.41.5.2.2.1.m1.1.1.cmml" xref="A4.T6.41.41.41.5.2.2.1.m1.1.1"><plus id="A4.T6.41.41.41.5.2.2.1.m1.1.1.1.cmml" xref="A4.T6.41.41.41.5.2.2.1.m1.1.1"></plus><cn id="A4.T6.41.41.41.5.2.2.1.m1.1.1.2.cmml" type="float" xref="A4.T6.41.41.41.5.2.2.1.m1.1.1.2">3.71</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.41.41.41.5.2.2.1.m1.1c">+3.71</annotation><annotation encoding="application/x-llamapun" id="A4.T6.41.41.41.5.2.2.1.m1.1d">+ 3.71</annotation></semantics></math></td>
</tr>
</tbody></table>
</td>
<td class="ltx_td ltx_align_center" id="A4.T6.43.43.43.7">
<table class="ltx_tabular ltx_align_middle" id="A4.T6.43.43.43.7.2">
<tbody><tr class="ltx_tr" id="A4.T6.42.42.42.6.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.42.42.42.6.1.1.1" style="padding-bottom:-5.16663pt;"><math alttext="-3.61" class="ltx_Math" display="inline" id="A4.T6.42.42.42.6.1.1.1.m1.1"><semantics id="A4.T6.42.42.42.6.1.1.1.m1.1a"><mrow id="A4.T6.42.42.42.6.1.1.1.m1.1.1" xref="A4.T6.42.42.42.6.1.1.1.m1.1.1.cmml"><mo id="A4.T6.42.42.42.6.1.1.1.m1.1.1a" xref="A4.T6.42.42.42.6.1.1.1.m1.1.1.cmml">−</mo><mn id="A4.T6.42.42.42.6.1.1.1.m1.1.1.2" xref="A4.T6.42.42.42.6.1.1.1.m1.1.1.2.cmml">3.61</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.T6.42.42.42.6.1.1.1.m1.1b"><apply id="A4.T6.42.42.42.6.1.1.1.m1.1.1.cmml" xref="A4.T6.42.42.42.6.1.1.1.m1.1.1"><minus id="A4.T6.42.42.42.6.1.1.1.m1.1.1.1.cmml" xref="A4.T6.42.42.42.6.1.1.1.m1.1.1"></minus><cn id="A4.T6.42.42.42.6.1.1.1.m1.1.1.2.cmml" type="float" xref="A4.T6.42.42.42.6.1.1.1.m1.1.1.2">3.61</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.42.42.42.6.1.1.1.m1.1c">-3.61</annotation><annotation encoding="application/x-llamapun" id="A4.T6.42.42.42.6.1.1.1.m1.1d">- 3.61</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A4.T6.43.43.43.7.2.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.43.43.43.7.2.2.1"><math alttext="-0.03" class="ltx_Math" display="inline" id="A4.T6.43.43.43.7.2.2.1.m1.1"><semantics id="A4.T6.43.43.43.7.2.2.1.m1.1a"><mrow id="A4.T6.43.43.43.7.2.2.1.m1.1.1" xref="A4.T6.43.43.43.7.2.2.1.m1.1.1.cmml"><mo id="A4.T6.43.43.43.7.2.2.1.m1.1.1a" xref="A4.T6.43.43.43.7.2.2.1.m1.1.1.cmml">−</mo><mn id="A4.T6.43.43.43.7.2.2.1.m1.1.1.2" xref="A4.T6.43.43.43.7.2.2.1.m1.1.1.2.cmml">0.03</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.T6.43.43.43.7.2.2.1.m1.1b"><apply id="A4.T6.43.43.43.7.2.2.1.m1.1.1.cmml" xref="A4.T6.43.43.43.7.2.2.1.m1.1.1"><minus id="A4.T6.43.43.43.7.2.2.1.m1.1.1.1.cmml" xref="A4.T6.43.43.43.7.2.2.1.m1.1.1"></minus><cn id="A4.T6.43.43.43.7.2.2.1.m1.1.1.2.cmml" type="float" xref="A4.T6.43.43.43.7.2.2.1.m1.1.1.2">0.03</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.43.43.43.7.2.2.1.m1.1c">-0.03</annotation><annotation encoding="application/x-llamapun" id="A4.T6.43.43.43.7.2.2.1.m1.1d">- 0.03</annotation></semantics></math></td>
</tr>
</tbody></table>
</td>
<td class="ltx_td ltx_align_center" id="A4.T6.45.45.45.9">
<table class="ltx_tabular ltx_align_middle" id="A4.T6.45.45.45.9.2">
<tbody><tr class="ltx_tr" id="A4.T6.44.44.44.8.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.44.44.44.8.1.1.1" style="padding-bottom:-5.16663pt;"><math alttext="-7.91" class="ltx_Math" display="inline" id="A4.T6.44.44.44.8.1.1.1.m1.1"><semantics id="A4.T6.44.44.44.8.1.1.1.m1.1a"><mrow id="A4.T6.44.44.44.8.1.1.1.m1.1.1" xref="A4.T6.44.44.44.8.1.1.1.m1.1.1.cmml"><mo id="A4.T6.44.44.44.8.1.1.1.m1.1.1a" xref="A4.T6.44.44.44.8.1.1.1.m1.1.1.cmml">−</mo><mn id="A4.T6.44.44.44.8.1.1.1.m1.1.1.2" xref="A4.T6.44.44.44.8.1.1.1.m1.1.1.2.cmml">7.91</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.T6.44.44.44.8.1.1.1.m1.1b"><apply id="A4.T6.44.44.44.8.1.1.1.m1.1.1.cmml" xref="A4.T6.44.44.44.8.1.1.1.m1.1.1"><minus id="A4.T6.44.44.44.8.1.1.1.m1.1.1.1.cmml" xref="A4.T6.44.44.44.8.1.1.1.m1.1.1"></minus><cn id="A4.T6.44.44.44.8.1.1.1.m1.1.1.2.cmml" type="float" xref="A4.T6.44.44.44.8.1.1.1.m1.1.1.2">7.91</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.44.44.44.8.1.1.1.m1.1c">-7.91</annotation><annotation encoding="application/x-llamapun" id="A4.T6.44.44.44.8.1.1.1.m1.1d">- 7.91</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A4.T6.45.45.45.9.2.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.45.45.45.9.2.2.1"><math alttext="-0.00" class="ltx_Math" display="inline" id="A4.T6.45.45.45.9.2.2.1.m1.1"><semantics id="A4.T6.45.45.45.9.2.2.1.m1.1a"><mrow id="A4.T6.45.45.45.9.2.2.1.m1.1.1" xref="A4.T6.45.45.45.9.2.2.1.m1.1.1.cmml"><mo id="A4.T6.45.45.45.9.2.2.1.m1.1.1a" xref="A4.T6.45.45.45.9.2.2.1.m1.1.1.cmml">−</mo><mn id="A4.T6.45.45.45.9.2.2.1.m1.1.1.2" xref="A4.T6.45.45.45.9.2.2.1.m1.1.1.2.cmml">0.00</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.T6.45.45.45.9.2.2.1.m1.1b"><apply id="A4.T6.45.45.45.9.2.2.1.m1.1.1.cmml" xref="A4.T6.45.45.45.9.2.2.1.m1.1.1"><minus id="A4.T6.45.45.45.9.2.2.1.m1.1.1.1.cmml" xref="A4.T6.45.45.45.9.2.2.1.m1.1.1"></minus><cn id="A4.T6.45.45.45.9.2.2.1.m1.1.1.2.cmml" type="float" xref="A4.T6.45.45.45.9.2.2.1.m1.1.1.2">0.00</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.45.45.45.9.2.2.1.m1.1c">-0.00</annotation><annotation encoding="application/x-llamapun" id="A4.T6.45.45.45.9.2.2.1.m1.1d">- 0.00</annotation></semantics></math></td>
</tr>
</tbody></table>
</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.47.47.47.11">
<table class="ltx_tabular ltx_align_middle" id="A4.T6.47.47.47.11.2">
<tbody><tr class="ltx_tr" id="A4.T6.46.46.46.10.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.46.46.46.10.1.1.1" style="padding-bottom:-5.16663pt;"><math alttext="-5.92" class="ltx_Math" display="inline" id="A4.T6.46.46.46.10.1.1.1.m1.1"><semantics id="A4.T6.46.46.46.10.1.1.1.m1.1a"><mrow id="A4.T6.46.46.46.10.1.1.1.m1.1.1" xref="A4.T6.46.46.46.10.1.1.1.m1.1.1.cmml"><mo id="A4.T6.46.46.46.10.1.1.1.m1.1.1a" xref="A4.T6.46.46.46.10.1.1.1.m1.1.1.cmml">−</mo><mn id="A4.T6.46.46.46.10.1.1.1.m1.1.1.2" xref="A4.T6.46.46.46.10.1.1.1.m1.1.1.2.cmml">5.92</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.T6.46.46.46.10.1.1.1.m1.1b"><apply id="A4.T6.46.46.46.10.1.1.1.m1.1.1.cmml" xref="A4.T6.46.46.46.10.1.1.1.m1.1.1"><minus id="A4.T6.46.46.46.10.1.1.1.m1.1.1.1.cmml" xref="A4.T6.46.46.46.10.1.1.1.m1.1.1"></minus><cn id="A4.T6.46.46.46.10.1.1.1.m1.1.1.2.cmml" type="float" xref="A4.T6.46.46.46.10.1.1.1.m1.1.1.2">5.92</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.46.46.46.10.1.1.1.m1.1c">-5.92</annotation><annotation encoding="application/x-llamapun" id="A4.T6.46.46.46.10.1.1.1.m1.1d">- 5.92</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A4.T6.47.47.47.11.2.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.47.47.47.11.2.2.1"><math alttext="+0.16" class="ltx_Math" display="inline" id="A4.T6.47.47.47.11.2.2.1.m1.1"><semantics id="A4.T6.47.47.47.11.2.2.1.m1.1a"><mrow id="A4.T6.47.47.47.11.2.2.1.m1.1.1" xref="A4.T6.47.47.47.11.2.2.1.m1.1.1.cmml"><mo id="A4.T6.47.47.47.11.2.2.1.m1.1.1a" xref="A4.T6.47.47.47.11.2.2.1.m1.1.1.cmml">+</mo><mn id="A4.T6.47.47.47.11.2.2.1.m1.1.1.2" xref="A4.T6.47.47.47.11.2.2.1.m1.1.1.2.cmml">0.16</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.T6.47.47.47.11.2.2.1.m1.1b"><apply id="A4.T6.47.47.47.11.2.2.1.m1.1.1.cmml" xref="A4.T6.47.47.47.11.2.2.1.m1.1.1"><plus id="A4.T6.47.47.47.11.2.2.1.m1.1.1.1.cmml" xref="A4.T6.47.47.47.11.2.2.1.m1.1.1"></plus><cn id="A4.T6.47.47.47.11.2.2.1.m1.1.1.2.cmml" type="float" xref="A4.T6.47.47.47.11.2.2.1.m1.1.1.2">0.16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.47.47.47.11.2.2.1.m1.1c">+0.16</annotation><annotation encoding="application/x-llamapun" id="A4.T6.47.47.47.11.2.2.1.m1.1d">+ 0.16</annotation></semantics></math></td>
</tr>
</tbody></table>
</td>
</tr>
<tr class="ltx_tr" id="A4.T6.51.51.56.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="6" id="A4.T6.51.51.56.5.1"><span class="ltx_text ltx_font_italic" id="A4.T6.51.51.56.5.1.1">Reference Value</span></th>
</tr>
<tr class="ltx_tr" id="A4.T6.49.49.49">
<th class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_row" id="A4.T6.49.49.49.3">6</th>
<th class="ltx_td ltx_nopad_l ltx_align_center ltx_th ltx_th_row" id="A4.T6.49.49.49.4"><span class="ltx_text ltx_font_bold" id="A4.T6.49.49.49.4.1">Zero-shot</span></th>
<td class="ltx_td ltx_align_center" colspan="4" id="A4.T6.49.49.49.2">
<math alttext="-4.28" class="ltx_Math" display="inline" id="A4.T6.48.48.48.1.m1.1"><semantics id="A4.T6.48.48.48.1.m1.1a"><mrow id="A4.T6.48.48.48.1.m1.1.1" xref="A4.T6.48.48.48.1.m1.1.1.cmml"><mo id="A4.T6.48.48.48.1.m1.1.1a" xref="A4.T6.48.48.48.1.m1.1.1.cmml">−</mo><mn id="A4.T6.48.48.48.1.m1.1.1.2" xref="A4.T6.48.48.48.1.m1.1.1.2.cmml">4.28</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.T6.48.48.48.1.m1.1b"><apply id="A4.T6.48.48.48.1.m1.1.1.cmml" xref="A4.T6.48.48.48.1.m1.1.1"><minus id="A4.T6.48.48.48.1.m1.1.1.1.cmml" xref="A4.T6.48.48.48.1.m1.1.1"></minus><cn id="A4.T6.48.48.48.1.m1.1.1.2.cmml" type="float" xref="A4.T6.48.48.48.1.m1.1.1.2">4.28</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.48.48.48.1.m1.1c">-4.28</annotation><annotation encoding="application/x-llamapun" id="A4.T6.48.48.48.1.m1.1d">- 4.28</annotation></semantics></math> (Acc. <math alttext="60.99" class="ltx_Math" display="inline" id="A4.T6.49.49.49.2.m2.1"><semantics id="A4.T6.49.49.49.2.m2.1a"><mn id="A4.T6.49.49.49.2.m2.1.1" xref="A4.T6.49.49.49.2.m2.1.1.cmml">60.99</mn><annotation-xml encoding="MathML-Content" id="A4.T6.49.49.49.2.m2.1b"><cn id="A4.T6.49.49.49.2.m2.1.1.cmml" type="float" xref="A4.T6.49.49.49.2.m2.1.1">60.99</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.49.49.49.2.m2.1c">60.99</annotation><annotation encoding="application/x-llamapun" id="A4.T6.49.49.49.2.m2.1d">60.99</annotation></semantics></math>)</td>
</tr>
<tr class="ltx_tr" id="A4.T6.51.51.51">
<th class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="A4.T6.51.51.51.3">7</th>
<th class="ltx_td ltx_nopad_l ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="A4.T6.51.51.51.4"><span class="ltx_text ltx_font_bold" id="A4.T6.51.51.51.4.1">Random Prediction</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb" colspan="4" id="A4.T6.51.51.51.2">
<math alttext="-32.77" class="ltx_Math" display="inline" id="A4.T6.50.50.50.1.m1.1"><semantics id="A4.T6.50.50.50.1.m1.1a"><mrow id="A4.T6.50.50.50.1.m1.1.1" xref="A4.T6.50.50.50.1.m1.1.1.cmml"><mo id="A4.T6.50.50.50.1.m1.1.1a" xref="A4.T6.50.50.50.1.m1.1.1.cmml">−</mo><mn id="A4.T6.50.50.50.1.m1.1.1.2" xref="A4.T6.50.50.50.1.m1.1.1.2.cmml">32.77</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.T6.50.50.50.1.m1.1b"><apply id="A4.T6.50.50.50.1.m1.1.1.cmml" xref="A4.T6.50.50.50.1.m1.1.1"><minus id="A4.T6.50.50.50.1.m1.1.1.1.cmml" xref="A4.T6.50.50.50.1.m1.1.1"></minus><cn id="A4.T6.50.50.50.1.m1.1.1.2.cmml" type="float" xref="A4.T6.50.50.50.1.m1.1.1.2">32.77</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.50.50.50.1.m1.1c">-32.77</annotation><annotation encoding="application/x-llamapun" id="A4.T6.50.50.50.1.m1.1d">- 32.77</annotation></semantics></math> (Acc. <math alttext="32.50" class="ltx_Math" display="inline" id="A4.T6.51.51.51.2.m2.1"><semantics id="A4.T6.51.51.51.2.m2.1a"><mn id="A4.T6.51.51.51.2.m2.1.1" xref="A4.T6.51.51.51.2.m2.1.1.cmml">32.50</mn><annotation-xml encoding="MathML-Content" id="A4.T6.51.51.51.2.m2.1b"><cn id="A4.T6.51.51.51.2.m2.1.1.cmml" type="float" xref="A4.T6.51.51.51.2.m2.1.1">32.50</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.51.51.51.2.m2.1c">32.50</annotation><annotation encoding="application/x-llamapun" id="A4.T6.51.51.51.2.m2.1d">32.50</annotation></semantics></math>)</td>
</tr>
</tbody>
</table>
</span></div>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A4.p3">
<p class="ltx_p" id="A4.p3.1">Moreover, we infer that direct decoding from lower layers, where hidden states are not sufficiently processed, causes prediction bias. We investigate the influence of the direct decoding result of layer 0, by the relationship between direct decoded distribution and final prediction distribution. In detail, on SST-2 and Llama 3 8B, we use various forerunner tokens with different direct decoding distributions on the label tokens “positive” and “negative”, and calculate their ICL prediction probability distributions respectively, as shown in Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A4.F15" title="Figure 15 ‣ Appendix D Measurement on Direct Decoding ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">15</span></a> (upper), where forerunner tokens with biased direct decoding distribution produce prediction biases with the same tendencies. While, when we apply contextual calibration&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Zhao et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#bib.bib47" title="">2021</a>)</cite>, which removes the background value without a query from the prediction, such similar tendencies disappear (Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A4.F15" title="Figure 15 ‣ Appendix D Measurement on Direct Decoding ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">15</span></a> (Lower)).</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_appendix" id="A5">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix E </span>Demonstrations Enhance the Inference of Perplexed Queries</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A5.p1">
<p class="ltx_p" id="A5.p1.1">We investigate the correlation between the queries’ perplexities and the classification accuracies with and without demonstrations, as a supplement of results in Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S3.F2" title="Figure 2 ‣ 3.2 Text Summarization is Linear and Task-Relevant but Position-biased ‣ 3 Step 1, Summarize: Linear Representations in Hidden States ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">2</span></a> (Right). We divide the queries into 10 bins w.r.t. the language modeling loss, and calculate the prediction accuracy in each bin, shown in Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A6.F16" title="Figure 16 ‣ F.1 Attention Head Statistics ‣ Appendix F Augmentated Experiment Results ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">16</span></a>. In these results, although a unified correlation can not be observed, we can confirm that: compared to the 0-shot results, the 4-shot inference shows better accuracies, especially on queries with high language modeling loss. So, we can conclude that: demonstrations enhance the inference accuracy of perplexed queries, consistent with the results in Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S3.F2" title="Figure 2 ‣ 3.2 Text Summarization is Linear and Task-Relevant but Position-biased ‣ 3 Step 1, Summarize: Linear Representations in Hidden States ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">2</span></a> (Right).</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_appendix" id="A6">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix F </span>Augmentated Experiment Results</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsection" id="A6.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">F.1 </span>Attention Head Statistics</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A6.SS1.p1">
<p class="ltx_p" id="A6.SS1.p1.1">We count the marked count of each attention head as Forerunner Token Head (Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A6.F18" title="Figure 18 ‣ Acknowledgments ‣ F.3 More Results of Fig. 7 ‣ Appendix F Augmentated Experiment Results ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">18</span></a>,&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A6.F19" title="Figure 19 ‣ Acknowledgments ‣ F.3 More Results of Fig. 7 ‣ Appendix F Augmentated Experiment Results ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">19</span></a>,&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A6.F20" title="Figure 20 ‣ Acknowledgments ‣ F.3 More Results of Fig. 7 ‣ Appendix F Augmentated Experiment Results ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">20</span></a>,&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A6.F21" title="Figure 21 ‣ Acknowledgments ‣ F.3 More Results of Fig. 7 ‣ Appendix F Augmentated Experiment Results ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">21</span></a>) / Correct Induction Head (Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A6.F22" title="Figure 22 ‣ Acknowledgments ‣ F.3 More Results of Fig. 7 ‣ Appendix F Augmentated Experiment Results ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">22</span></a>,&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A6.F23" title="Figure 23 ‣ Acknowledgments ‣ F.3 More Results of Fig. 7 ‣ Appendix F Augmentated Experiment Results ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">23</span></a>,&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A6.F24" title="Figure 24 ‣ Acknowledgments ‣ F.3 More Results of Fig. 7 ‣ Appendix F Augmentated Experiment Results ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">24</span></a>,&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A6.F25" title="Figure 25 ‣ Acknowledgments ‣ F.3 More Results of Fig. 7 ‣ Appendix F Augmentated Experiment Results ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">25</span></a>) by every data sample from each dataset on each model.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A6.SS1.p2">
<p class="ltx_p" id="A6.SS1.p2.1"><span class="ltx_text ltx_font_bold" id="A6.SS1.p2.1.1">Forerunner Token Head Statistics.</span> We plot the distributions of the marked Forerunner Token Heads towards correct and wrong labels, where: there are observable morphological differences in figures across different datasets, while the forerunner token heads marked on the correct and incorrect labels of the same dataset are almost identical. The detailed data confirms our conclusion in&nbsp;§<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S4.SS1" title="4.1 Step 2, Forerunner Token Head: Copy from Text Feature to Label Token ‣ 4 Induction Circuits in Natural Language Models ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">4.1</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A6.SS1.p3">
<p class="ltx_p" id="A6.SS1.p3.1"><span class="ltx_text ltx_font_bold" id="A6.SS1.p3.1.1">Induction Head Statistics.</span> We plot the distributions of the marked Correct Induction Heads, where there are observable morphological differences in figures across different datasets, but also significant overlaps, which confirms our conclusion in&nbsp;§<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S4.SS2" title="4.2 Step 3, Induction Head: Feature Retrieval on Task Subspace ‣ 4 Induction Circuits in Natural Language Models ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">4.2</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="A6.F16">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_block ltx_figure_panel" id="A6.F16.1">
<figure class="ltx_figure ltx_align_center" id="A6.F16.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="130" id="A6.F16.sf1.g1" src="https://arxiv.org/html/2410.04468v1/x23.png" width="125">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure ltx_align_center" id="A6.F16.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="130" id="A6.F16.sf2.g1" src="https://arxiv.org/html/2410.04468v1/x24.png" width="125">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure ltx_align_center" id="A6.F16.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="130" id="A6.F16.sf3.g1" src="https://arxiv.org/html/2410.04468v1/x25.png" width="125">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure ltx_align_center" id="A6.F16.sf4"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="130" id="A6.F16.sf4.g1" src="https://arxiv.org/html/2410.04468v1/x26.png" width="125">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(d) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure ltx_align_center" id="A6.F16.sf5"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="130" id="A6.F16.sf5.g1" src="https://arxiv.org/html/2410.04468v1/x27.png" width="125">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(e) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure ltx_align_center" id="A6.F16.sf6"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="130" id="A6.F16.sf6.g1" src="https://arxiv.org/html/2410.04468v1/x28.png" width="125">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(f) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_block ltx_figure_panel" id="A6.F16.2">
<figure class="ltx_figure ltx_align_center" id="A6.F16.sf7"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="130" id="A6.F16.sf7.g1" src="https://arxiv.org/html/2410.04468v1/x29.png" width="125">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(g) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure ltx_align_center" id="A6.F16.sf8"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="130" id="A6.F16.sf8.g1" src="https://arxiv.org/html/2410.04468v1/x30.png" width="125">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(h) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure ltx_align_center" id="A6.F16.sf9"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="130" id="A6.F16.sf9.g1" src="https://arxiv.org/html/2410.04468v1/x31.png" width="125">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(i) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure ltx_align_center" id="A6.F16.sf10"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="130" id="A6.F16.sf10.g1" src="https://arxiv.org/html/2410.04468v1/x32.png" width="125">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(j) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure ltx_align_center" id="A6.F16.sf11"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="130" id="A6.F16.sf11.g1" src="https://arxiv.org/html/2410.04468v1/x33.png" width="125">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(k) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure ltx_align_center" id="A6.F16.sf12"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="130" id="A6.F16.sf12.g1" src="https://arxiv.org/html/2410.04468v1/x34.png" width="125">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(l) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 16: </span>The correlations between language modeling loss and ICL prediction accuracies. <span class="ltx_text ltx_font_bold" id="A6.F16.5.1">Upper:</span> 0-shot results; <span class="ltx_text ltx_font_bold" id="A6.F16.6.2">Lower:</span> 4-shot results.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="A6.F17">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" height="176" id="A6.F17.g1" src="https://arxiv.org/html/2410.04468v1/x35.png" width="160"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="A6.F17.7"><span class="ltx_text ltx_phantom" id="A6.F17.7.1"><span style="visibility:hidden">11.</span></span>
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="176" id="A6.F17.1.g1" src="https://arxiv.org/html/2410.04468v1/x36.png" width="157"> <img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="176" id="A6.F17.2.g2" src="https://arxiv.org/html/2410.04468v1/x37.png" width="160"> <span class="ltx_text ltx_phantom" id="A6.F17.7.2"><span style="visibility:hidden">11.</span></span>
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="176" id="A6.F17.3.g3" src="https://arxiv.org/html/2410.04468v1/x38.png" width="157">
<br class="ltx_break">
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="176" id="A6.F17.4.g4" src="https://arxiv.org/html/2410.04468v1/x39.png" width="160"> <span class="ltx_text ltx_phantom" id="A6.F17.7.3"><span style="visibility:hidden">11.</span></span>
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="176" id="A6.F17.5.g5" src="https://arxiv.org/html/2410.04468v1/x40.png" width="157"> <img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="176" id="A6.F17.6.g6" src="https://arxiv.org/html/2410.04468v1/x41.png" width="160"> <span class="ltx_text ltx_phantom" id="A6.F17.7.4"><span style="visibility:hidden">11.</span></span>
<img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="176" id="A6.F17.7.g7" src="https://arxiv.org/html/2410.04468v1/x42.png" width="157"></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 17: </span>Supplemental experiment result on more samples for Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S4.F7" title="Figure 7 ‣ 4.2 Step 3, Induction Head: Feature Retrieval on Task Subspace ‣ 4 Induction Circuits in Natural Language Models ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">7</span></a>.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_subsection" id="A6.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">F.2 </span>Other LMs’ Experiment Results</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A6.SS2.p1">
<p class="ltx_p" id="A6.SS2.p1.1">The results of most experiments in the main text on Llama 3 8B are shown in Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A6.F26" title="Figure 26 ‣ Acknowledgments ‣ F.3 More Results of Fig. 7 ‣ Appendix F Augmentated Experiment Results ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">26</span></a>, &nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A6.F29" title="Figure 29 ‣ Acknowledgments ‣ F.3 More Results of Fig. 7 ‣ Appendix F Augmentated Experiment Results ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">29</span></a>, &nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A6.F32" title="Figure 32 ‣ Acknowledgments ‣ F.3 More Results of Fig. 7 ‣ Appendix F Augmentated Experiment Results ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">32</span></a>, and&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A6.F35" title="Figure 35 ‣ Acknowledgments ‣ F.3 More Results of Fig. 7 ‣ Appendix F Augmentated Experiment Results ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">35</span></a>; The results of most experiments in the main text on Falcon 40B are shown in Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A6.F27" title="Figure 27 ‣ Acknowledgments ‣ F.3 More Results of Fig. 7 ‣ Appendix F Augmentated Experiment Results ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">27</span></a>, &nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A6.F30" title="Figure 30 ‣ Acknowledgments ‣ F.3 More Results of Fig. 7 ‣ Appendix F Augmentated Experiment Results ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">30</span></a>, &nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A6.F33" title="Figure 33 ‣ Acknowledgments ‣ F.3 More Results of Fig. 7 ‣ Appendix F Augmentated Experiment Results ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">33</span></a>, and&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A6.F36" title="Figure 36 ‣ Acknowledgments ‣ F.3 More Results of Fig. 7 ‣ Appendix F Augmentated Experiment Results ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">36</span></a>; The results of most experiments in the main text on Falcon 7B are shown in Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A6.F28" title="Figure 28 ‣ Acknowledgments ‣ F.3 More Results of Fig. 7 ‣ Appendix F Augmentated Experiment Results ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">28</span></a>, &nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A6.F31" title="Figure 31 ‣ Acknowledgments ‣ F.3 More Results of Fig. 7 ‣ Appendix F Augmentated Experiment Results ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">31</span></a>, &nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A6.F34" title="Figure 34 ‣ Acknowledgments ‣ F.3 More Results of Fig. 7 ‣ Appendix F Augmentated Experiment Results ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">34</span></a>, &nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A6.F37" title="Figure 37 ‣ Acknowledgments ‣ F.3 More Results of Fig. 7 ‣ Appendix F Augmentated Experiment Results ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">37</span></a>, and Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A4.T6" title="Table 6 ‣ Appendix D Measurement on Direct Decoding ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">6</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A6.SS2.p2">
<p class="ltx_p" id="A6.SS2.p2.1">From these results, we can conclude consistently with the main text. However, as discussed in&nbsp;§<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S5.SS2" title="5.2 Bypass Mechanism ‣ 5 Putting Things Together ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">5.2</span></a>, inference dynamics on these models are delocalized, thus clear serialization of the 3 steps can not be observed in these results.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="A6.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">F.3 </span>More Results of Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S4.F7" title="Figure 7 ‣ 4.2 Step 3, Induction Head: Feature Retrieval on Task Subspace ‣ 4 Induction Circuits in Natural Language Models ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">7</span></a>
</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A6.SS3.p1">
<p class="ltx_p" id="A6.SS3.p1.1">To enhance the persuasiveness, we additionally and randomly try 4 input samples as supplements to Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S4.F7" title="Figure 7 ‣ 4.2 Step 3, Induction Head: Feature Retrieval on Task Subspace ‣ 4 Induction Circuits in Natural Language Models ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">7</span></a> on SST-2 and Llama 3 70B as shown in Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A6.F17" title="Figure 17 ‣ F.1 Attention Head Statistics ‣ Appendix F Augmentated Experiment Results ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">17</span></a>. From these results, we can observe similar phenomena to Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#A6.F17" title="Figure 17 ‣ F.1 Attention Head Statistics ‣ Appendix F Augmentated Experiment Results ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">17</span></a> and conclude consistently.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_subsubsection" id="A6.SS3.SSSx1">
<h4 class="ltx_title ltx_title_subsubsection">Reproducibility Statement</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A6.SS3.SSSx1.p1">
<p class="ltx_p" id="A6.SS3.SSSx1.p1.1">We will publicly release our experiment code after the acceptance of this paper.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsubsection" id="A6.SS3.SSSx2">
<h4 class="ltx_title ltx_title_subsubsection">Author Contributions</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A6.SS3.SSSx2.p1">
<p class="ltx_p" id="A6.SS3.SSSx2.p1.1">H.C. conducted the overwhelming majority of work in this paper.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A6.SS3.SSSx2.p2">
<p class="ltx_p" id="A6.SS3.SSSx2.p2.1">N.I. is their principal investigator, providing important and beneficial guidance, revision, and research support. M.K. and Y.S. participated in our discussion and provided some helpful suggestions and revisions.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsubsection" id="A6.SS3.SSSx3">
<h4 class="ltx_title ltx_title_subsubsection">Acknowledgments</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A6.SS3.SSSx3.p1">
<p class="ltx_p" id="A6.SS3.SSSx3.p1.1">This work was supported by JSPS KAKENHI Grant Number 19K20332, and The Nakajima Foundation Start-Up Support Grant.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
<figure class="ltx_figure" id="A6.F18">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F18.sf1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_square" height="204" id="A6.F18.sf1.g1" src="https://arxiv.org/html/2410.04468v1/x43.png" width="199"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_square" height="204" id="A6.F18.sf1.g2" src="https://arxiv.org/html/2410.04468v1/x44.png" width="199"></div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>SST-2</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F18.sf2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_square" height="204" id="A6.F18.sf2.g1" src="https://arxiv.org/html/2410.04468v1/x45.png" width="199"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_square" height="204" id="A6.F18.sf2.g2" src="https://arxiv.org/html/2410.04468v1/x46.png" width="199"></div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>MR</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F18.sf3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_square" height="204" id="A6.F18.sf3.g1" src="https://arxiv.org/html/2410.04468v1/x47.png" width="199"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_square" height="204" id="A6.F18.sf3.g2" src="https://arxiv.org/html/2410.04468v1/x48.png" width="199"></div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>FP</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F18.sf4">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_square" height="204" id="A6.F18.sf4.g1" src="https://arxiv.org/html/2410.04468v1/x49.png" width="199"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_square" height="204" id="A6.F18.sf4.g2" src="https://arxiv.org/html/2410.04468v1/x50.png" width="199"></div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(d) </span>SST-5</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F18.sf5">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_square" height="204" id="A6.F18.sf5.g1" src="https://arxiv.org/html/2410.04468v1/x51.png" width="199"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_square" height="204" id="A6.F18.sf5.g2" src="https://arxiv.org/html/2410.04468v1/x52.png" width="199"></div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(e) </span>TREC</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F18.sf6">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_square" height="204" id="A6.F18.sf6.g1" src="https://arxiv.org/html/2410.04468v1/x53.png" width="199"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_square" height="204" id="A6.F18.sf6.g2" src="https://arxiv.org/html/2410.04468v1/x54.png" width="199"></div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(f) </span>AGNews</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 18: </span>Forerunner Token Head marked on Llama 3 70B.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="A6.SS3.SSSx3.fig1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="A6.F19.sf1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_square" height="174" id="A6.F19.sf1.g1" src="https://arxiv.org/html/2410.04468v1/x55.png" width="199"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_square" height="174" id="A6.F19.sf1.g2" src="https://arxiv.org/html/2410.04468v1/x56.png" width="199"></div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>SST-2</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F19.sf2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_square" height="174" id="A6.F19.sf2.g1" src="https://arxiv.org/html/2410.04468v1/x57.png" width="199"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_square" height="174" id="A6.F19.sf2.g2" src="https://arxiv.org/html/2410.04468v1/x58.png" width="199"></div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>MR</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F19.sf3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_square" height="174" id="A6.F19.sf3.g1" src="https://arxiv.org/html/2410.04468v1/x59.png" width="199"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_square" height="174" id="A6.F19.sf3.g2" src="https://arxiv.org/html/2410.04468v1/x60.png" width="199"></div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>FP</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F19.sf4">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_square" height="174" id="A6.F19.sf4.g1" src="https://arxiv.org/html/2410.04468v1/x61.png" width="199"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_square" height="174" id="A6.F19.sf4.g2" src="https://arxiv.org/html/2410.04468v1/x62.png" width="199"></div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(d) </span>SST-5</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
</div>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="A6.F19">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F19.sf5">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_square" height="174" id="A6.F19.sf5.g1" src="https://arxiv.org/html/2410.04468v1/x63.png" width="199"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_square" height="174" id="A6.F19.sf5.g2" src="https://arxiv.org/html/2410.04468v1/x64.png" width="199"></div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(e) </span>TREC</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F19.sf6">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_square" height="174" id="A6.F19.sf6.g1" src="https://arxiv.org/html/2410.04468v1/x65.png" width="199"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_square" height="174" id="A6.F19.sf6.g2" src="https://arxiv.org/html/2410.04468v1/x66.png" width="199"></div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(f) </span>AGNews</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 19: </span>Forerunner Token Head marked on Llama 3 8B.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="A6.SS3.SSSx3.fig2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel" id="A6.F20.sf1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="199" id="A6.F20.sf1.g1" src="https://arxiv.org/html/2410.04468v1/x67.png" width="407"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="199" id="A6.F20.sf1.g2" src="https://arxiv.org/html/2410.04468v1/x68.png" width="407"></div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>SST-2</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F20.sf2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="199" id="A6.F20.sf2.g1" src="https://arxiv.org/html/2410.04468v1/x69.png" width="407"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="199" id="A6.F20.sf2.g2" src="https://arxiv.org/html/2410.04468v1/x70.png" width="407"></div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>MR</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F20.sf3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="199" id="A6.F20.sf3.g1" src="https://arxiv.org/html/2410.04468v1/x71.png" width="407"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="199" id="A6.F20.sf3.g2" src="https://arxiv.org/html/2410.04468v1/x72.png" width="407"></div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>FP</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F20.sf4">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="199" id="A6.F20.sf4.g1" src="https://arxiv.org/html/2410.04468v1/x73.png" width="407"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="199" id="A6.F20.sf4.g2" src="https://arxiv.org/html/2410.04468v1/x74.png" width="407"></div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(d) </span>SST-5</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
</div>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="A6.F20">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F20.sf5">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="199" id="A6.F20.sf5.g1" src="https://arxiv.org/html/2410.04468v1/x75.png" width="407"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="199" id="A6.F20.sf5.g2" src="https://arxiv.org/html/2410.04468v1/x76.png" width="407"></div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(e) </span>TREC</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F20.sf6">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="199" id="A6.F20.sf6.g1" src="https://arxiv.org/html/2410.04468v1/x77.png" width="407"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="199" id="A6.F20.sf6.g2" src="https://arxiv.org/html/2410.04468v1/x78.png" width="407"></div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(f) </span>AGNews</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 20: </span>Forerunner Token Head marked on Falcon 40B.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="A6.SS3.SSSx3.fig3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel" id="A6.F21.sf1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="194" id="A6.F21.sf1.g1" src="https://arxiv.org/html/2410.04468v1/x79.png" width="407"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="194" id="A6.F21.sf1.g2" src="https://arxiv.org/html/2410.04468v1/x80.png" width="407"></div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>SST-2</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F21.sf2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="194" id="A6.F21.sf2.g1" src="https://arxiv.org/html/2410.04468v1/x81.png" width="407"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="194" id="A6.F21.sf2.g2" src="https://arxiv.org/html/2410.04468v1/x82.png" width="407"></div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>MR</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F21.sf3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="194" id="A6.F21.sf3.g1" src="https://arxiv.org/html/2410.04468v1/x83.png" width="407"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="194" id="A6.F21.sf3.g2" src="https://arxiv.org/html/2410.04468v1/x84.png" width="407"></div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>FP</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
</div>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="A6.F21">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F21.sf4">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="194" id="A6.F21.sf4.g1" src="https://arxiv.org/html/2410.04468v1/x85.png" width="407"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="194" id="A6.F21.sf4.g2" src="https://arxiv.org/html/2410.04468v1/x86.png" width="407"></div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(d) </span>SST-5</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F21.sf5">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="194" id="A6.F21.sf5.g1" src="https://arxiv.org/html/2410.04468v1/x87.png" width="407"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="194" id="A6.F21.sf5.g2" src="https://arxiv.org/html/2410.04468v1/x88.png" width="407"></div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(e) </span>TREC</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F21.sf6">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="194" id="A6.F21.sf6.g1" src="https://arxiv.org/html/2410.04468v1/x89.png" width="407"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="194" id="A6.F21.sf6.g2" src="https://arxiv.org/html/2410.04468v1/x90.png" width="407"></div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(f) </span>AGNews</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 21: </span>Forerunner Token Head marked on Falcon 7B.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="A6.F22">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F22.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="204" id="A6.F22.sf1.g1" src="https://arxiv.org/html/2410.04468v1/x91.png" width="199">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>SST-2</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F22.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="204" id="A6.F22.sf2.g1" src="https://arxiv.org/html/2410.04468v1/x92.png" width="199">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>MR</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F22.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="204" id="A6.F22.sf3.g1" src="https://arxiv.org/html/2410.04468v1/x93.png" width="199">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>FP</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F22.sf4"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="204" id="A6.F22.sf4.g1" src="https://arxiv.org/html/2410.04468v1/x94.png" width="199">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(d) </span>SST-5</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F22.sf5"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="204" id="A6.F22.sf5.g1" src="https://arxiv.org/html/2410.04468v1/x95.png" width="199">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(e) </span>TREC</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F22.sf6"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="204" id="A6.F22.sf6.g1" src="https://arxiv.org/html/2410.04468v1/x96.png" width="199">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(f) </span>AGNews</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 22: </span>Correct Induction Head marked on Llama 3 70B.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="A6.F23">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F23.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="174" id="A6.F23.sf1.g1" src="https://arxiv.org/html/2410.04468v1/x97.png" width="199">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>SST-2</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F23.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="174" id="A6.F23.sf2.g1" src="https://arxiv.org/html/2410.04468v1/x98.png" width="199">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>MR</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F23.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="174" id="A6.F23.sf3.g1" src="https://arxiv.org/html/2410.04468v1/x99.png" width="199">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>FP</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F23.sf4"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="174" id="A6.F23.sf4.g1" src="https://arxiv.org/html/2410.04468v1/x100.png" width="199">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(d) </span>SST-5</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F23.sf5"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="174" id="A6.F23.sf5.g1" src="https://arxiv.org/html/2410.04468v1/x101.png" width="199">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(e) </span>TREC</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F23.sf6"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="174" id="A6.F23.sf6.g1" src="https://arxiv.org/html/2410.04468v1/x102.png" width="199">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(f) </span>AGNews</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 23: </span>Correct Induction Head marked on Llama 3 8B.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="A6.F24">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F24.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="199" id="A6.F24.sf1.g1" src="https://arxiv.org/html/2410.04468v1/x103.png" width="407">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>SST-2</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F24.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="199" id="A6.F24.sf2.g1" src="https://arxiv.org/html/2410.04468v1/x104.png" width="407">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>MR</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F24.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="199" id="A6.F24.sf3.g1" src="https://arxiv.org/html/2410.04468v1/x105.png" width="407">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>FP</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F24.sf4"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="199" id="A6.F24.sf4.g1" src="https://arxiv.org/html/2410.04468v1/x106.png" width="407">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(d) </span>SST-5</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F24.sf5"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="199" id="A6.F24.sf5.g1" src="https://arxiv.org/html/2410.04468v1/x107.png" width="407">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(e) </span>TREC</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F24.sf6"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="199" id="A6.F24.sf6.g1" src="https://arxiv.org/html/2410.04468v1/x108.png" width="407">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(f) </span>AGNews</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 24: </span>Correct Induction Head marked on Falcon 40B.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="A6.F25">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F25.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="194" id="A6.F25.sf1.g1" src="https://arxiv.org/html/2410.04468v1/x109.png" width="407">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>SST-2</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F25.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="194" id="A6.F25.sf2.g1" src="https://arxiv.org/html/2410.04468v1/x110.png" width="407">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>MR</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F25.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="194" id="A6.F25.sf3.g1" src="https://arxiv.org/html/2410.04468v1/x111.png" width="407">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>FP</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F25.sf4"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="194" id="A6.F25.sf4.g1" src="https://arxiv.org/html/2410.04468v1/x112.png" width="407">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(d) </span>SST-5</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F25.sf5"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="194" id="A6.F25.sf5.g1" src="https://arxiv.org/html/2410.04468v1/x113.png" width="407">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(e) </span>TREC</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F25.sf6"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="194" id="A6.F25.sf6.g1" src="https://arxiv.org/html/2410.04468v1/x114.png" width="407">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(f) </span>AGNews</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 25: </span>Correct Induction Head marked on Falcon 7B.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_pagination ltx_role_newpage"></div>
<figure class="ltx_figure" id="A6.F26">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F26.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="181" id="A6.F26.sf1.g1" src="https://arxiv.org/html/2410.04468v1/x115.png" width="245">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F26.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="184" id="A6.F26.sf2.g1" src="https://arxiv.org/html/2410.04468v1/x116.png" width="308">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F26.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="183" id="A6.F26.sf3.g1" src="https://arxiv.org/html/2410.04468v1/x117.png" width="244">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 26: </span>Augmentated results towards Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S3.F2" title="Figure 2 ‣ 3.2 Text Summarization is Linear and Task-Relevant but Position-biased ‣ 3 Step 1, Summarize: Linear Representations in Hidden States ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">2</span></a> on Llama 3 8B.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="A6.F27">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F27.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="177" id="A6.F27.sf1.g1" src="https://arxiv.org/html/2410.04468v1/x118.png" width="245">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F27.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="181" id="A6.F27.sf2.g1" src="https://arxiv.org/html/2410.04468v1/x119.png" width="308">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F27.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="185" id="A6.F27.sf3.g1" src="https://arxiv.org/html/2410.04468v1/x120.png" width="244">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 27: </span>Augmentated results towards Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S3.F2" title="Figure 2 ‣ 3.2 Text Summarization is Linear and Task-Relevant but Position-biased ‣ 3 Step 1, Summarize: Linear Representations in Hidden States ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">2</span></a> on Falcon 40B.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="A6.F28">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F28.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="177" id="A6.F28.sf1.g1" src="https://arxiv.org/html/2410.04468v1/x121.png" width="245">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F28.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="181" id="A6.F28.sf2.g1" src="https://arxiv.org/html/2410.04468v1/x122.png" width="308">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F28.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="179" id="A6.F28.sf3.g1" src="https://arxiv.org/html/2410.04468v1/x123.png" width="244">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 28: </span>Augmentated results towards Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S3.F2" title="Figure 2 ‣ 3.2 Text Summarization is Linear and Task-Relevant but Position-biased ‣ 3 Step 1, Summarize: Linear Representations in Hidden States ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">2</span></a> on Falcon 7B.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="A6.F29">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F29.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="224" id="A6.F29.sf1.g1" src="https://arxiv.org/html/2410.04468v1/x124.png" width="314">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F29.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="216" id="A6.F29.sf2.g1" src="https://arxiv.org/html/2410.04468v1/x125.png" width="217">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F29.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="216" id="A6.F29.sf3.g1" src="https://arxiv.org/html/2410.04468v1/x126.png" width="217">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 29: </span>Augmentated results towards Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S3.F3" title="Figure 3 ‣ 3.2 Text Summarization is Linear and Task-Relevant but Position-biased ‣ 3 Step 1, Summarize: Linear Representations in Hidden States ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">3</span></a> and&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S4.F4" title="Figure 4 ‣ 4 Induction Circuits in Natural Language Models ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">4</span></a> (on Layer 16) on Llama 3 8B.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="A6.F30">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F30.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="224" id="A6.F30.sf1.g1" src="https://arxiv.org/html/2410.04468v1/x127.png" width="314">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F30.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="216" id="A6.F30.sf2.g1" src="https://arxiv.org/html/2410.04468v1/x128.png" width="217">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F30.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="216" id="A6.F30.sf3.g1" src="https://arxiv.org/html/2410.04468v1/x129.png" width="217">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 30: </span>Augmentated results towards Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S3.F3" title="Figure 3 ‣ 3.2 Text Summarization is Linear and Task-Relevant but Position-biased ‣ 3 Step 1, Summarize: Linear Representations in Hidden States ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">3</span></a> and&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S4.F4" title="Figure 4 ‣ 4 Induction Circuits in Natural Language Models ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">4</span></a> (on Layer 24) on Falcon 40B.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="A6.F31">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F31.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="224" id="A6.F31.sf1.g1" src="https://arxiv.org/html/2410.04468v1/x130.png" width="314">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F31.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="216" id="A6.F31.sf2.g1" src="https://arxiv.org/html/2410.04468v1/x131.png" width="217">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F31.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="216" id="A6.F31.sf3.g1" src="https://arxiv.org/html/2410.04468v1/x132.png" width="217">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 31: </span>Augmentated results towards Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S3.F3" title="Figure 3 ‣ 3.2 Text Summarization is Linear and Task-Relevant but Position-biased ‣ 3 Step 1, Summarize: Linear Representations in Hidden States ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">3</span></a> and&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S4.F4" title="Figure 4 ‣ 4 Induction Circuits in Natural Language Models ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">4</span></a> (on Layer 16) on Falcon 7B.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="A6.F32">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F32.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="200" id="A6.F32.sf1.g1" src="https://arxiv.org/html/2410.04468v1/x133.png" width="265">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F32.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="197" id="A6.F32.sf2.g1" src="https://arxiv.org/html/2410.04468v1/x134.png" width="303">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F32.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="195" id="A6.F32.sf3.g1" src="https://arxiv.org/html/2410.04468v1/x135.png" width="228">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 32: </span>Augmentated results towards Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S4.F5" title="Figure 5 ‣ 4.1 Step 2, Forerunner Token Head: Copy from Text Feature to Label Token ‣ 4 Induction Circuits in Natural Language Models ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">5</span></a> on Llama 3 8B.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="A6.F33">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F33.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="195" id="A6.F33.sf1.g1" src="https://arxiv.org/html/2410.04468v1/x136.png" width="266">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F33.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="194" id="A6.F33.sf2.g1" src="https://arxiv.org/html/2410.04468v1/x137.png" width="290">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F33.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="195" id="A6.F33.sf3.g1" src="https://arxiv.org/html/2410.04468v1/x138.png" width="228">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 33: </span>Augmentated results towards Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S4.F5" title="Figure 5 ‣ 4.1 Step 2, Forerunner Token Head: Copy from Text Feature to Label Token ‣ 4 Induction Circuits in Natural Language Models ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">5</span></a> on Falcon 40B.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="A6.F34">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F34.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="197" id="A6.F34.sf1.g1" src="https://arxiv.org/html/2410.04468v1/x139.png" width="265">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F34.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="194" id="A6.F34.sf2.g1" src="https://arxiv.org/html/2410.04468v1/x140.png" width="290">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F34.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="195" id="A6.F34.sf3.g1" src="https://arxiv.org/html/2410.04468v1/x141.png" width="228">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 34: </span>Augmentated results towards Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S4.F5" title="Figure 5 ‣ 4.1 Step 2, Forerunner Token Head: Copy from Text Feature to Label Token ‣ 4 Induction Circuits in Natural Language Models ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">5</span></a> on Falcon 7B.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="A6.F35">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F35.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="213" id="A6.F35.sf1.g1" src="https://arxiv.org/html/2410.04468v1/x142.png" width="276">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F35.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="210" id="A6.F35.sf2.g1" src="https://arxiv.org/html/2410.04468v1/x143.png" width="277">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F35.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="206" id="A6.F35.sf3.g1" src="https://arxiv.org/html/2410.04468v1/x144.png" width="207">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 35: </span>Augmentated results towards Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S4.F6" title="Figure 6 ‣ 4.2 Step 3, Induction Head: Feature Retrieval on Task Subspace ‣ 4 Induction Circuits in Natural Language Models ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">6</span></a> on Llama 3 8B.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="A6.F36">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F36.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="210" id="A6.F36.sf1.g1" src="https://arxiv.org/html/2410.04468v1/x145.png" width="276">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F36.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="208" id="A6.F36.sf2.g1" src="https://arxiv.org/html/2410.04468v1/x146.png" width="276">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F36.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="206" id="A6.F36.sf3.g1" src="https://arxiv.org/html/2410.04468v1/x147.png" width="207">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 36: </span>Augmentated results towards Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S4.F6" title="Figure 6 ‣ 4.2 Step 3, Induction Head: Feature Retrieval on Task Subspace ‣ 4 Induction Circuits in Natural Language Models ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">6</span></a> on Falcon 40B.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="A6.F37">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F37.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="213" id="A6.F37.sf1.g1" src="https://arxiv.org/html/2410.04468v1/x148.png" width="276">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F37.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="210" id="A6.F37.sf2.g1" src="https://arxiv.org/html/2410.04468v1/x149.png" width="277">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F37.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="206" id="A6.F37.sf3.g1" src="https://arxiv.org/html/2410.04468v1/x150.png" width="207">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 37: </span>Augmentated results towards Fig.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04468v1#S4.F6" title="Figure 6 ‣ 4.2 Step 3, Induction Head: Feature Retrieval on Task Subspace ‣ 4 Induction Circuits in Natural Language Models ‣ Revisiting In-context Learning Inference Circuit in Large Language Models"><span class="ltx_text ltx_ref_tag">6</span></a> on Falcon 7B.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
</section>
</section>
</article>
</div>

</div>


<button type="button" class="btn btn-primary hover-rp-button" id="openForm">Report Issue</button><div class="modal" id="myForm" role="dialog" aria-labelledby="modal-title"><div class="modal-dialog"><form class="modal-content" id="myFormContent" enctype="multipart/form-data"><div class="modal-header" id="modal-header"><h5 class="modal-title">Report Github Issue</h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div><div class="modal-body"><label for="form_title" id="modalTitle">Title:</label><input class="form-control" id="form_title" name="form_title" required="required" placeholder="Enter title"><label for="description" id="selectedTextModalDescription" style="display: none;">Content selection saved. Describe the issue below:</label><label for="description" id="nomralModalDescription">Description:</label><textarea class="form-control" id="description" name="description" required="required" style="height: 80px;" maxlength="500" placeholder="500 characters maximum"></textarea></div><div class="modal-footer d-flex justify-content-end"><button type="submit" class="sr-only button" id="modal-submit-sr">Submit without Github</button><button type="submit" class="btn btn-primary" id="modal-submit">Submit in Github</button></div></form></div></div><button id="small-report-button" type="button" class="btn btn-secondary btn-sm" style="background-color: rgb(179, 27, 27); position: fixed;">Report Issue for Selection</button><div class="ltx_page_footer">
        <div class="ltx_page_logo">
            Generated by
            <a href="https://math.nist.gov/~BMiller/LaTeXML/" class="ltx_LaTeXML_logo">
                <span style="letter-spacing: -0.2em; margin-right: 0.1em;">
                    L
                    <span style="font-size: 70%; position: relative; bottom: 2.2pt;">A</span>
                    T
                    <span style="position: relative; bottom: -0.4ex;">E</span>
                </span>
                <span class="ltx_font_smallcaps">xml</span>
                <img alt="[LOGO]" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==">
            </a>
        </div></div><footer id="footer" class="ltx_document">
        <div class="keyboard-glossary">
            <h2>Instructions for reporting errors</h2>
            <p>We are continuing to improve HTML versions of papers, and your feedback helps enhance accessibility and mobile support. To report errors in the HTML that will help us improve conversion and rendering, choose any of the methods listed below:</p>
            <ul>
                <li>Click the "Report Issue" button.</li>
                <li>Open a report feedback form via keyboard, use "<strong>Ctrl + ?</strong>".</li>
                <li>Make a text selection and click the "Report Issue for Selection" button near your cursor.</li>
                <li class="sr-only">You can use Alt+Y to toggle on and Alt+Shift+Y to toggle off accessible reporting links at each section.</li>
            </ul>
            <p>Our team has already identified <a class="ltx_ref" href="https://github.com/arXiv/html_feedback/issues" target="_blank">the following issues</a>. We appreciate your time reviewing and reporting rendering errors we may not have found yet. Your efforts will help us improve the HTML versions for all readers, because disability should not be a barrier to accessing research. Thank you for your continued support in championing open access for all.</p>
            <p>Have a free development cycle? Help support accessibility at arXiv! Our collaborators at LaTeXML maintain a <a class="ltx_ref" href="https://github.com/brucemiller/LaTeXML/wiki/Porting-LaTeX-packages-for-LaTeXML" target="_blank">list of packages that need conversion</a>, and welcome <a class="ltx_ref" href="https://github.com/brucemiller/LaTeXML/issues" target="_blank">developer contributions</a>.</p>
        </div>
    </footer></body></html>