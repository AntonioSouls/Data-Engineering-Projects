<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2212.00313] Concealed Object Detection for Passive Millimeter-Wave Security Imaging Based on Task-Aligned Detection Transformer</title><meta property="og:description" content="Passive millimeter-wave (PMMW) is a significant potential technique for human security screening. Several popular object detection networks have been used for PMMW images. However, restricted by the low resolution and …">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Concealed Object Detection for Passive Millimeter-Wave Security Imaging Based on Task-Aligned Detection Transformer">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Concealed Object Detection for Passive Millimeter-Wave Security Imaging Based on Task-Aligned Detection Transformer">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2212.00313">

<!--Generated on Fri Mar  1 08:57:05 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="
Millimeter-wave radiometry,  deep learning,  object detection,  transformer,  security screening.
">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Concealed Object Detection for Passive Millimeter-Wave Security Imaging Based on Task-Aligned Detection Transformer</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Cheng Guo,
Fei Hu,
and Yan Hu
</span><span class="ltx_author_notes">Manuscript received XX XX, 2022; revised XX XX, 2022. This work was supported in part by the National Natural Science Foundation of China (NSFC) under Grants 61871438. <em id="id4.1.id1" class="ltx_emph ltx_font_italic">(Corresponding author: Fei Hu.)</em>C. Guo, F. Hu, and Y. Hu are with the School of Electronic Information and Communications, Huazhong University of Science and Technology, Wuhan 430074, China, and F. Hu are also with the National Key Laboratory of Science and Technology on Multi-Spectral Information Processing, Wuhan 430074, China (e-mail: ch3ngguo@foxmail.com, hufei@hust.edu.cn, dawalish@foxmail.com ).</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id5.id1" class="ltx_p">Passive millimeter-wave (PMMW) is a significant potential technique for human security screening. Several popular object detection networks have been used for PMMW images. However, restricted by the low resolution and high noise of PMMW images, PMMW hidden object detection based on deep learning usually suffers from low accuracy and low classification confidence. To tackle the above problems, this paper proposes a Task-Aligned Detection Transformer network, named PMMW-DETR. In the first stage, a Denoising Coarse-to-Fine Transformer (DCFT) backbone is designed to extract long- and short-range features in the different scales. In the second stage, we propose the Query Selection module to introduce learned spatial features into the network as prior knowledge, which enhances the semantic perception capability of the network. In the third stage, aiming to improve the classification performance, we perform a Task-Aligned Dual-Head block that decouples the classification and regression tasks, and enhances the interaction between the two heads. Based on our self-developed PMMW security screening dataset, experimental results including comparison with State-Of-The-Art (SOTA) methods and ablation study demonstrate that the PMMW-DETR obtains higher accuracy and classification confidence than previous works, and exhibits robustness to the PMMW images of low quality.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Index Terms: </h6>
Millimeter-wave radiometry, deep learning, object detection, transformer, security screening.

</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span id="S1.1.1" class="ltx_text ltx_font_smallcaps">Introduction</span>
</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Passive millimeter-wave (PMMW) imaging has attracted increasing attention from academia and industry in recent years <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>. Similar to sensors in the infrared and visible bands, PMMW sensors receive the self-emitted radiation of objects and reflected environmental radiation. PMMW sensors, on the other hand, do not require an irradiation source and have the ability to detect through smoke, dust, and light rain, making PMMW imaging capable of all-day and quasi-all-weather, so it is widely used in astronomy and remote sensing <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>. With the
improvement in resolution brought by the development of millimeter-wave (MMW) devices, MMW radiometry is gradually applied to the information acquisition of close-range objects <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>. Among these, the most widely used application is the detection of concealed objects such as firearms, gasoline, and knives in human security screening for harmlessness to human safety and the ability to penetrate textile materials of MMW.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Since the 1990s, researchers have designed a variety of security systems and conducted many human imaging experiments. So far, the performance of the human body security inspection system has gradually met the application requirements. In recent years, Tian <span id="S1.p2.1.1" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> develop a security system based on active ElectroMagnetic (EM) detection methods. Gumbmann <span id="S1.p2.1.2" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> proposed a Stepped-frequency continuous-wave (SFCW) radar system with an optimum sweep design. Cheng <span id="S1.p2.1.3" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> first applied polarization imaging mode to the PMMW security system. And Zhao <span id="S1.p2.1.4" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> develop a Ka-band 1024-channel PMMW security system named BHU-1024. It can be seen that the security systems have reached a relatively mature stage. However, the current system is still not commercially available, the main reason is that the level of concealed object detection algorithms for PMMW security images lags behind the hardware level. The PMMW radiation signal is weak, with only one hundred thousandths of the infrared signal, so the image contains a lot of noise. Meanwhile, the resolution of PMMW images is much lower than that of infrared and visible images, making concealed object detection a challenging task. Many methods have been proposed for the detection of concealed objects in PMMW security images. Earlier research works were mainly based on statistical learning and machine learning, for example, Martinez <span id="S1.p2.1.5" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> used Iterative Steering Kernel Regression (ISKR) method for denoising and the Local Binary Fitting (LBF) method to segment hidden objects and the human body. Lee <span id="S1.p2.1.6" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> applied Bayesian learning and expectation maximization algorithms to detect and segment concealed objects. Yeom <span id="S1.p2.1.7" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> further proposed the use of principal component analysis (PCA) to extract object features and measure the similarity between the object and ground truth based on Lee’s work. Lopez <span id="S1.p2.1.8" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> extracted Haar features for images and used classical machine learning algorithms such as random forest and support vector machine for detection.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">The requirement for manual design features is a common disadvantage of the above methods, which leads to poor generalization ability and does not adapt as well when the object distribution changes. Deep learning has now been very successful in the field of computer vision, and many networks have achieved impressive performance on available datasets. Inspired by these works, deep learning, especially convolutional neural network (CNN), has been attempted to be applied to PMMW image feature extraction and object detection in recent years, which avoids the need to manually design complex features. For example, Lopez <span id="S1.p3.1.1" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> performed smoothing preprocessing and applied SCNN networks for object segmentation. Mainstream networks in industrial applications, such as YOLOv3 and SSD, have also been used for concealed object detection in PMMW security images <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>. The common shortcoming of the above works is that they all need to set the prior anchor boxes manually, whose shape and size have a significant impact on the final performance of the network.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">The attention mechanism <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> is a bionic approach to human vision that allows the detection network to focus on the object site of interest by computing the mutual correlation between sample elements. With its global perception capability and superior detection performance, Transformer excels in the field of computer vision. Typical computer vision Transformer models include the Visual Transformer (ViT) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>, Swin Transformer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>, and Detection Transformer (DETR) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>. ViT pioneered the application of Transformer to computer vision tasks by treating the Patch of an image as a vector. However, the computation required by ViT to apply the attention mechanism directly to the full graph is very large, so Swin Transformer proposed a windowed attention mechanism and a shifted windowed attention mechanism to address this problem, reducing the computation of the detection network while weakening the long-range sensing capability of the network. DETR, on the other hand, pioneers an ensemble prediction-based object detection method that eliminates the necessity for post-processing processes such as the manual design of a priori anchor frames and Non-Maximal Suppression (NMS). However, DETR converges very slowly due to the cross-attention mechanism and the instability brought by the randomness of its bipartite graph matching. The design for optical images makes either Swin or DETR perform poorly on the PMMW dataset, therefore it is necessary to design a Transformer that adapts to the characteristics of PMMW imaging.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">Yang <span id="S1.p5.1.1" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite> proposed the PMMW-Transformer for human security screening, an Anchor-Free Transformer network that implements adaptive assignment of positive and negative sample labels. The network proposes a new local-global attention mechanism and Attention Weighting Module inspired by Twins <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>, Swin, ATSS <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>, and other networks. However, it does not well address the problems of difficult classification on low-quality images, low AP at high IoU thresholds, and difficult convergence on small datasets. The reasons are mainly the following:</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">First, the PMMW security images have low resolution and little texture information, which is easy to cause a low precision rate and low recall rate. Second, due to the intrinsic conflicts between classification and regression <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>, the network model has difficulty in learning classification information on such a dataset. Third, the inductive bias of Transformer is much weaker than CNN and RNN, which makes the network harder to train on small-scale datasets <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>, Especially for data with high noise like PMMW security images.</p>
</div>
<div id="S1.p7" class="ltx_para">
<p id="S1.p7.1" class="ltx_p">To address the characteristics of PMMW security images in security scenarios, this paper proposes a task-aligned detection Transformer network named PMMW-DETR. The backbone of the Transformer network consists of several hierarchical multi-scale Denoising Coarse-to-Fine Transformer (DCFT) attention blocks so as to extract features, and the extracted feature map enters the neck composed of an encoder and a query selection module to further aggregate features. The output features, after introducing a spatial prior, are divided into two independent decoders to perform classification and regression tasks, the queries of both are shared to ensure that they are predicting the same object in the similar regions, which also called task-aligned. The main contributions of this paper are as follows:</p>
</div>
<div id="S1.p8" class="ltx_para">
<p id="S1.p8.1" class="ltx_p">1) For the previous problem of classification-regression conflict, we propose a new task-aligned dual-head block design, in which two decoders share queries while performing different (classification/regression) tasks with different parameters, achieving decoupled classification and regression in two different feature spaces.</p>
</div>
<div id="S1.p9" class="ltx_para">
<p id="S1.p9.1" class="ltx_p">2) We propose a query selection method adapted to the security check scenario, i.e., introducing a spatial prior to the detection head. Thus, the semantic perception capability of the network is enhanced. In addition, we perform an interaction method which we called query sharing between two decoders for the selected queries.</p>
</div>
<div id="S1.p10" class="ltx_para">
<p id="S1.p10.1" class="ltx_p">3) In order to balance global information perception and computational effort, we propose a coarse-to-fine multi-scale DCFT attention block. The coarse global attention is used to help the network understand human body semantic information to reduce false alarms caused by object-similar backgrounds, such as gaps between limbs and torso, while the fine local attention provides rich classification information. In addition, by redesigning the pooling part of the block, we improve the robustness of the network to measurement noise.</p>
</div>
<div id="S1.p11" class="ltx_para">
<p id="S1.p11.1" class="ltx_p">4) PMMW-DETR surpasses the popular SOTA models in accuracy. To train our network, we contribute a new dataset that contains 4543 images with high-quality annotations. To the best of our knowledge, this is the first dataset with the best image quality that represents the level of the most advanced PMMW imaging technology. With this dataset, we compared the classification performance of different models for the first time.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span id="S2.1.1" class="ltx_text ltx_font_smallcaps">Proposed Method</span>
</h2>

<figure id="S2.F1" class="ltx_figure"><img src="/html/2212.00313/assets/x1.png" id="S2.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="484" height="217" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>The overall structure of the Task-aligned PMMW-DETR.</figcaption>
</figure>
<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS1.5.1.1" class="ltx_text">II-A</span> </span><span id="S2.SS1.6.2" class="ltx_text ltx_font_italic">The Overall Structure</span>
</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">In order to solve the problem of insufficient information and difficult convergence of the PMMW image dataset, we propose a Transformer-based concealed object detection network named PMMW-DETR. Like the current mainstream detection network, our Transformer network consists of the backbone, neck, and head. As shown in Figure <a href="#S2.F1" title="Figure 1 ‣ II Proposed Method ‣ Concealed Object Detection for Passive Millimeter-Wave Security Imaging Based on Task-Aligned Detection Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, the backbone is mainly applied to extract low-level features of images, while the neck functions to further aggregate and extract high-dimensional features, and the head performs classification and localization tasks on the obtained feature maps. For the problems mentioned in Section <a href="#S1" title="I Introduction ‣ Concealed Object Detection for Passive Millimeter-Wave Security Imaging Based on Task-Aligned Detection Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a>, we propose 1) a coarse-to-fine multi-scale DCFT attention block that balances global information and computational efforts, 2) a multi-scale deformable attention module that effectively integrates independent semantic features, and the query selection module that introduces a spatial prior for the detection head, and 3) a task-aligned dual-head block with query sharing that fully aligns the classification and localization tasks, on the backbone, neck, and head, respectively.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS2.5.1.1" class="ltx_text">II-B</span> </span><span id="S2.SS2.6.2" class="ltx_text ltx_font_italic">Denoising Coarse-to-Fine Transformer (DCFT) Attention-Based Backbone</span>
</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">The attention mechanism has the advantage of long-range perception compared to convolution. The ability to fully extract features of the whole picture makes it well suited for detection tasks with less local information such as PMMW security screening. However, the original attention mechanism does fine-grained operations on the whole globe, resulting in a quadratic computational overhead w.r.t the image size <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>, which is unacceptable. Although Swin Transformer proposed the local attention mechanism and the shifted window attention mechanism to reduce the computational cost, the long- and short-range perception capability of the attention mechanism is greatly weakened since the size of the window is far less than that of the image, which might cause the false alarms due to similar local features between objects and the background.</p>
</div>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.8" class="ltx_p">To balance the performance and computational overhead of the attention mechanism, we propose the DCFT attention-based backbone which consists of four DCFT attention blocks, as shown in Figure <a href="#S2.F1" title="Figure 1 ‣ II Proposed Method ‣ Concealed Object Detection for Passive Millimeter-Wave Security Imaging Based on Task-Aligned Detection Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. In order to obtain a hierarchical multi-scale backbone structure, we partition each image <math id="S2.SS2.p2.1.m1.1" class="ltx_Math" alttext="I\in\mathbb{R}^{{H}\times{W}}" display="inline"><semantics id="S2.SS2.p2.1.m1.1a"><mrow id="S2.SS2.p2.1.m1.1.1" xref="S2.SS2.p2.1.m1.1.1.cmml"><mi id="S2.SS2.p2.1.m1.1.1.2" xref="S2.SS2.p2.1.m1.1.1.2.cmml">I</mi><mo id="S2.SS2.p2.1.m1.1.1.1" xref="S2.SS2.p2.1.m1.1.1.1.cmml">∈</mo><msup id="S2.SS2.p2.1.m1.1.1.3" xref="S2.SS2.p2.1.m1.1.1.3.cmml"><mi id="S2.SS2.p2.1.m1.1.1.3.2" xref="S2.SS2.p2.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS2.p2.1.m1.1.1.3.3" xref="S2.SS2.p2.1.m1.1.1.3.3.cmml"><mi id="S2.SS2.p2.1.m1.1.1.3.3.2" xref="S2.SS2.p2.1.m1.1.1.3.3.2.cmml">H</mi><mo lspace="0.222em" rspace="0.222em" id="S2.SS2.p2.1.m1.1.1.3.3.1" xref="S2.SS2.p2.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S2.SS2.p2.1.m1.1.1.3.3.3" xref="S2.SS2.p2.1.m1.1.1.3.3.3.cmml">W</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.m1.1b"><apply id="S2.SS2.p2.1.m1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1"><in id="S2.SS2.p2.1.m1.1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1.1"></in><ci id="S2.SS2.p2.1.m1.1.1.2.cmml" xref="S2.SS2.p2.1.m1.1.1.2">𝐼</ci><apply id="S2.SS2.p2.1.m1.1.1.3.cmml" xref="S2.SS2.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p2.1.m1.1.1.3.1.cmml" xref="S2.SS2.p2.1.m1.1.1.3">superscript</csymbol><ci id="S2.SS2.p2.1.m1.1.1.3.2.cmml" xref="S2.SS2.p2.1.m1.1.1.3.2">ℝ</ci><apply id="S2.SS2.p2.1.m1.1.1.3.3.cmml" xref="S2.SS2.p2.1.m1.1.1.3.3"><times id="S2.SS2.p2.1.m1.1.1.3.3.1.cmml" xref="S2.SS2.p2.1.m1.1.1.3.3.1"></times><ci id="S2.SS2.p2.1.m1.1.1.3.3.2.cmml" xref="S2.SS2.p2.1.m1.1.1.3.3.2">𝐻</ci><ci id="S2.SS2.p2.1.m1.1.1.3.3.3.cmml" xref="S2.SS2.p2.1.m1.1.1.3.3.3">𝑊</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.1.m1.1c">I\in\mathbb{R}^{{H}\times{W}}</annotation></semantics></math> into patches of size <math id="S2.SS2.p2.2.m2.1" class="ltx_Math" alttext="4\times 4" display="inline"><semantics id="S2.SS2.p2.2.m2.1a"><mrow id="S2.SS2.p2.2.m2.1.1" xref="S2.SS2.p2.2.m2.1.1.cmml"><mn id="S2.SS2.p2.2.m2.1.1.2" xref="S2.SS2.p2.2.m2.1.1.2.cmml">4</mn><mo lspace="0.222em" rspace="0.222em" id="S2.SS2.p2.2.m2.1.1.1" xref="S2.SS2.p2.2.m2.1.1.1.cmml">×</mo><mn id="S2.SS2.p2.2.m2.1.1.3" xref="S2.SS2.p2.2.m2.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.2.m2.1b"><apply id="S2.SS2.p2.2.m2.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1"><times id="S2.SS2.p2.2.m2.1.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1.1"></times><cn type="integer" id="S2.SS2.p2.2.m2.1.1.2.cmml" xref="S2.SS2.p2.2.m2.1.1.2">4</cn><cn type="integer" id="S2.SS2.p2.2.m2.1.1.3.cmml" xref="S2.SS2.p2.2.m2.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.2.m2.1c">4\times 4</annotation></semantics></math>, resulting in <math id="S2.SS2.p2.3.m3.1" class="ltx_Math" alttext="\frac{H}{4}\times\frac{W}{4}" display="inline"><semantics id="S2.SS2.p2.3.m3.1a"><mrow id="S2.SS2.p2.3.m3.1.1" xref="S2.SS2.p2.3.m3.1.1.cmml"><mfrac id="S2.SS2.p2.3.m3.1.1.2" xref="S2.SS2.p2.3.m3.1.1.2.cmml"><mi id="S2.SS2.p2.3.m3.1.1.2.2" xref="S2.SS2.p2.3.m3.1.1.2.2.cmml">H</mi><mn id="S2.SS2.p2.3.m3.1.1.2.3" xref="S2.SS2.p2.3.m3.1.1.2.3.cmml">4</mn></mfrac><mo lspace="0.222em" rspace="0.222em" id="S2.SS2.p2.3.m3.1.1.1" xref="S2.SS2.p2.3.m3.1.1.1.cmml">×</mo><mfrac id="S2.SS2.p2.3.m3.1.1.3" xref="S2.SS2.p2.3.m3.1.1.3.cmml"><mi id="S2.SS2.p2.3.m3.1.1.3.2" xref="S2.SS2.p2.3.m3.1.1.3.2.cmml">W</mi><mn id="S2.SS2.p2.3.m3.1.1.3.3" xref="S2.SS2.p2.3.m3.1.1.3.3.cmml">4</mn></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.3.m3.1b"><apply id="S2.SS2.p2.3.m3.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1"><times id="S2.SS2.p2.3.m3.1.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1.1"></times><apply id="S2.SS2.p2.3.m3.1.1.2.cmml" xref="S2.SS2.p2.3.m3.1.1.2"><divide id="S2.SS2.p2.3.m3.1.1.2.1.cmml" xref="S2.SS2.p2.3.m3.1.1.2"></divide><ci id="S2.SS2.p2.3.m3.1.1.2.2.cmml" xref="S2.SS2.p2.3.m3.1.1.2.2">𝐻</ci><cn type="integer" id="S2.SS2.p2.3.m3.1.1.2.3.cmml" xref="S2.SS2.p2.3.m3.1.1.2.3">4</cn></apply><apply id="S2.SS2.p2.3.m3.1.1.3.cmml" xref="S2.SS2.p2.3.m3.1.1.3"><divide id="S2.SS2.p2.3.m3.1.1.3.1.cmml" xref="S2.SS2.p2.3.m3.1.1.3"></divide><ci id="S2.SS2.p2.3.m3.1.1.3.2.cmml" xref="S2.SS2.p2.3.m3.1.1.3.2">𝑊</ci><cn type="integer" id="S2.SS2.p2.3.m3.1.1.3.3.cmml" xref="S2.SS2.p2.3.m3.1.1.3.3">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.3.m3.1c">\frac{H}{4}\times\frac{W}{4}</annotation></semantics></math> visual tokens with dimension <math id="S2.SS2.p2.4.m4.1" class="ltx_Math" alttext="4\times 4" display="inline"><semantics id="S2.SS2.p2.4.m4.1a"><mrow id="S2.SS2.p2.4.m4.1.1" xref="S2.SS2.p2.4.m4.1.1.cmml"><mn id="S2.SS2.p2.4.m4.1.1.2" xref="S2.SS2.p2.4.m4.1.1.2.cmml">4</mn><mo lspace="0.222em" rspace="0.222em" id="S2.SS2.p2.4.m4.1.1.1" xref="S2.SS2.p2.4.m4.1.1.1.cmml">×</mo><mn id="S2.SS2.p2.4.m4.1.1.3" xref="S2.SS2.p2.4.m4.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.4.m4.1b"><apply id="S2.SS2.p2.4.m4.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1"><times id="S2.SS2.p2.4.m4.1.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1.1"></times><cn type="integer" id="S2.SS2.p2.4.m4.1.1.2.cmml" xref="S2.SS2.p2.4.m4.1.1.2">4</cn><cn type="integer" id="S2.SS2.p2.4.m4.1.1.3.cmml" xref="S2.SS2.p2.4.m4.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.4.m4.1c">4\times 4</annotation></semantics></math>. Then, as shown in Figure <a href="#S2.F2" title="Figure 2 ‣ II-B Denoising Coarse-to-Fine Transformer (DCFT) Attention-Based Backbone ‣ II Proposed Method ‣ Concealed Object Detection for Passive Millimeter-Wave Security Imaging Based on Task-Aligned Detection Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>(a), a patch embedding layer consisting of a convolutional layer with stride and filter size both equal to 4, is used to project the patches into the feature map <math id="S2.SS2.p2.5.m5.1" class="ltx_Math" alttext="z\in\mathbb{R}^{\frac{H}{4}\times\frac{W}{4}\times c}" display="inline"><semantics id="S2.SS2.p2.5.m5.1a"><mrow id="S2.SS2.p2.5.m5.1.1" xref="S2.SS2.p2.5.m5.1.1.cmml"><mi id="S2.SS2.p2.5.m5.1.1.2" xref="S2.SS2.p2.5.m5.1.1.2.cmml">z</mi><mo id="S2.SS2.p2.5.m5.1.1.1" xref="S2.SS2.p2.5.m5.1.1.1.cmml">∈</mo><msup id="S2.SS2.p2.5.m5.1.1.3" xref="S2.SS2.p2.5.m5.1.1.3.cmml"><mi id="S2.SS2.p2.5.m5.1.1.3.2" xref="S2.SS2.p2.5.m5.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS2.p2.5.m5.1.1.3.3" xref="S2.SS2.p2.5.m5.1.1.3.3.cmml"><mfrac id="S2.SS2.p2.5.m5.1.1.3.3.2" xref="S2.SS2.p2.5.m5.1.1.3.3.2.cmml"><mi id="S2.SS2.p2.5.m5.1.1.3.3.2.2" xref="S2.SS2.p2.5.m5.1.1.3.3.2.2.cmml">H</mi><mn id="S2.SS2.p2.5.m5.1.1.3.3.2.3" xref="S2.SS2.p2.5.m5.1.1.3.3.2.3.cmml">4</mn></mfrac><mo lspace="0.222em" rspace="0.222em" id="S2.SS2.p2.5.m5.1.1.3.3.1" xref="S2.SS2.p2.5.m5.1.1.3.3.1.cmml">×</mo><mfrac id="S2.SS2.p2.5.m5.1.1.3.3.3" xref="S2.SS2.p2.5.m5.1.1.3.3.3.cmml"><mi id="S2.SS2.p2.5.m5.1.1.3.3.3.2" xref="S2.SS2.p2.5.m5.1.1.3.3.3.2.cmml">W</mi><mn id="S2.SS2.p2.5.m5.1.1.3.3.3.3" xref="S2.SS2.p2.5.m5.1.1.3.3.3.3.cmml">4</mn></mfrac><mo lspace="0.222em" rspace="0.222em" id="S2.SS2.p2.5.m5.1.1.3.3.1a" xref="S2.SS2.p2.5.m5.1.1.3.3.1.cmml">×</mo><mi id="S2.SS2.p2.5.m5.1.1.3.3.4" xref="S2.SS2.p2.5.m5.1.1.3.3.4.cmml">c</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.5.m5.1b"><apply id="S2.SS2.p2.5.m5.1.1.cmml" xref="S2.SS2.p2.5.m5.1.1"><in id="S2.SS2.p2.5.m5.1.1.1.cmml" xref="S2.SS2.p2.5.m5.1.1.1"></in><ci id="S2.SS2.p2.5.m5.1.1.2.cmml" xref="S2.SS2.p2.5.m5.1.1.2">𝑧</ci><apply id="S2.SS2.p2.5.m5.1.1.3.cmml" xref="S2.SS2.p2.5.m5.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p2.5.m5.1.1.3.1.cmml" xref="S2.SS2.p2.5.m5.1.1.3">superscript</csymbol><ci id="S2.SS2.p2.5.m5.1.1.3.2.cmml" xref="S2.SS2.p2.5.m5.1.1.3.2">ℝ</ci><apply id="S2.SS2.p2.5.m5.1.1.3.3.cmml" xref="S2.SS2.p2.5.m5.1.1.3.3"><times id="S2.SS2.p2.5.m5.1.1.3.3.1.cmml" xref="S2.SS2.p2.5.m5.1.1.3.3.1"></times><apply id="S2.SS2.p2.5.m5.1.1.3.3.2.cmml" xref="S2.SS2.p2.5.m5.1.1.3.3.2"><divide id="S2.SS2.p2.5.m5.1.1.3.3.2.1.cmml" xref="S2.SS2.p2.5.m5.1.1.3.3.2"></divide><ci id="S2.SS2.p2.5.m5.1.1.3.3.2.2.cmml" xref="S2.SS2.p2.5.m5.1.1.3.3.2.2">𝐻</ci><cn type="integer" id="S2.SS2.p2.5.m5.1.1.3.3.2.3.cmml" xref="S2.SS2.p2.5.m5.1.1.3.3.2.3">4</cn></apply><apply id="S2.SS2.p2.5.m5.1.1.3.3.3.cmml" xref="S2.SS2.p2.5.m5.1.1.3.3.3"><divide id="S2.SS2.p2.5.m5.1.1.3.3.3.1.cmml" xref="S2.SS2.p2.5.m5.1.1.3.3.3"></divide><ci id="S2.SS2.p2.5.m5.1.1.3.3.3.2.cmml" xref="S2.SS2.p2.5.m5.1.1.3.3.3.2">𝑊</ci><cn type="integer" id="S2.SS2.p2.5.m5.1.1.3.3.3.3.cmml" xref="S2.SS2.p2.5.m5.1.1.3.3.3.3">4</cn></apply><ci id="S2.SS2.p2.5.m5.1.1.3.3.4.cmml" xref="S2.SS2.p2.5.m5.1.1.3.3.4">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.5.m5.1c">z\in\mathbb{R}^{\frac{H}{4}\times\frac{W}{4}\times c}</annotation></semantics></math>. After the projection, similar operations are performed on the feature map in the four stages of DCFT attention blocks. At each stage <math id="S2.SS2.p2.6.m6.4" class="ltx_Math" alttext="i\in\{1,2,3,4\}" display="inline"><semantics id="S2.SS2.p2.6.m6.4a"><mrow id="S2.SS2.p2.6.m6.4.5" xref="S2.SS2.p2.6.m6.4.5.cmml"><mi id="S2.SS2.p2.6.m6.4.5.2" xref="S2.SS2.p2.6.m6.4.5.2.cmml">i</mi><mo id="S2.SS2.p2.6.m6.4.5.1" xref="S2.SS2.p2.6.m6.4.5.1.cmml">∈</mo><mrow id="S2.SS2.p2.6.m6.4.5.3.2" xref="S2.SS2.p2.6.m6.4.5.3.1.cmml"><mo stretchy="false" id="S2.SS2.p2.6.m6.4.5.3.2.1" xref="S2.SS2.p2.6.m6.4.5.3.1.cmml">{</mo><mn id="S2.SS2.p2.6.m6.1.1" xref="S2.SS2.p2.6.m6.1.1.cmml">1</mn><mo id="S2.SS2.p2.6.m6.4.5.3.2.2" xref="S2.SS2.p2.6.m6.4.5.3.1.cmml">,</mo><mn id="S2.SS2.p2.6.m6.2.2" xref="S2.SS2.p2.6.m6.2.2.cmml">2</mn><mo id="S2.SS2.p2.6.m6.4.5.3.2.3" xref="S2.SS2.p2.6.m6.4.5.3.1.cmml">,</mo><mn id="S2.SS2.p2.6.m6.3.3" xref="S2.SS2.p2.6.m6.3.3.cmml">3</mn><mo id="S2.SS2.p2.6.m6.4.5.3.2.4" xref="S2.SS2.p2.6.m6.4.5.3.1.cmml">,</mo><mn id="S2.SS2.p2.6.m6.4.4" xref="S2.SS2.p2.6.m6.4.4.cmml">4</mn><mo stretchy="false" id="S2.SS2.p2.6.m6.4.5.3.2.5" xref="S2.SS2.p2.6.m6.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.6.m6.4b"><apply id="S2.SS2.p2.6.m6.4.5.cmml" xref="S2.SS2.p2.6.m6.4.5"><in id="S2.SS2.p2.6.m6.4.5.1.cmml" xref="S2.SS2.p2.6.m6.4.5.1"></in><ci id="S2.SS2.p2.6.m6.4.5.2.cmml" xref="S2.SS2.p2.6.m6.4.5.2">𝑖</ci><set id="S2.SS2.p2.6.m6.4.5.3.1.cmml" xref="S2.SS2.p2.6.m6.4.5.3.2"><cn type="integer" id="S2.SS2.p2.6.m6.1.1.cmml" xref="S2.SS2.p2.6.m6.1.1">1</cn><cn type="integer" id="S2.SS2.p2.6.m6.2.2.cmml" xref="S2.SS2.p2.6.m6.2.2">2</cn><cn type="integer" id="S2.SS2.p2.6.m6.3.3.cmml" xref="S2.SS2.p2.6.m6.3.3">3</cn><cn type="integer" id="S2.SS2.p2.6.m6.4.4.cmml" xref="S2.SS2.p2.6.m6.4.4">4</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.6.m6.4c">i\in\{1,2,3,4\}</annotation></semantics></math>, the DCFT attention block consists of <math id="S2.SS2.p2.7.m7.1" class="ltx_Math" alttext="N_{i}" display="inline"><semantics id="S2.SS2.p2.7.m7.1a"><msub id="S2.SS2.p2.7.m7.1.1" xref="S2.SS2.p2.7.m7.1.1.cmml"><mi id="S2.SS2.p2.7.m7.1.1.2" xref="S2.SS2.p2.7.m7.1.1.2.cmml">N</mi><mi id="S2.SS2.p2.7.m7.1.1.3" xref="S2.SS2.p2.7.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.7.m7.1b"><apply id="S2.SS2.p2.7.m7.1.1.cmml" xref="S2.SS2.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.7.m7.1.1.1.cmml" xref="S2.SS2.p2.7.m7.1.1">subscript</csymbol><ci id="S2.SS2.p2.7.m7.1.1.2.cmml" xref="S2.SS2.p2.7.m7.1.1.2">𝑁</ci><ci id="S2.SS2.p2.7.m7.1.1.3.cmml" xref="S2.SS2.p2.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.7.m7.1c">N_{i}</annotation></semantics></math> DCFT layers. In particular, for the patch embedding layer in the <math id="S2.SS2.p2.8.m8.3" class="ltx_Math" alttext="i\in\{2,3,4\}" display="inline"><semantics id="S2.SS2.p2.8.m8.3a"><mrow id="S2.SS2.p2.8.m8.3.4" xref="S2.SS2.p2.8.m8.3.4.cmml"><mi id="S2.SS2.p2.8.m8.3.4.2" xref="S2.SS2.p2.8.m8.3.4.2.cmml">i</mi><mo id="S2.SS2.p2.8.m8.3.4.1" xref="S2.SS2.p2.8.m8.3.4.1.cmml">∈</mo><mrow id="S2.SS2.p2.8.m8.3.4.3.2" xref="S2.SS2.p2.8.m8.3.4.3.1.cmml"><mo stretchy="false" id="S2.SS2.p2.8.m8.3.4.3.2.1" xref="S2.SS2.p2.8.m8.3.4.3.1.cmml">{</mo><mn id="S2.SS2.p2.8.m8.1.1" xref="S2.SS2.p2.8.m8.1.1.cmml">2</mn><mo id="S2.SS2.p2.8.m8.3.4.3.2.2" xref="S2.SS2.p2.8.m8.3.4.3.1.cmml">,</mo><mn id="S2.SS2.p2.8.m8.2.2" xref="S2.SS2.p2.8.m8.2.2.cmml">3</mn><mo id="S2.SS2.p2.8.m8.3.4.3.2.3" xref="S2.SS2.p2.8.m8.3.4.3.1.cmml">,</mo><mn id="S2.SS2.p2.8.m8.3.3" xref="S2.SS2.p2.8.m8.3.3.cmml">4</mn><mo stretchy="false" id="S2.SS2.p2.8.m8.3.4.3.2.4" xref="S2.SS2.p2.8.m8.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.8.m8.3b"><apply id="S2.SS2.p2.8.m8.3.4.cmml" xref="S2.SS2.p2.8.m8.3.4"><in id="S2.SS2.p2.8.m8.3.4.1.cmml" xref="S2.SS2.p2.8.m8.3.4.1"></in><ci id="S2.SS2.p2.8.m8.3.4.2.cmml" xref="S2.SS2.p2.8.m8.3.4.2">𝑖</ci><set id="S2.SS2.p2.8.m8.3.4.3.1.cmml" xref="S2.SS2.p2.8.m8.3.4.3.2"><cn type="integer" id="S2.SS2.p2.8.m8.1.1.cmml" xref="S2.SS2.p2.8.m8.1.1">2</cn><cn type="integer" id="S2.SS2.p2.8.m8.2.2.cmml" xref="S2.SS2.p2.8.m8.2.2">3</cn><cn type="integer" id="S2.SS2.p2.8.m8.3.3.cmml" xref="S2.SS2.p2.8.m8.3.3">4</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.8.m8.3c">i\in\{2,3,4\}</annotation></semantics></math> stage, the spatial size of the feature map is reduced by a factor of 2, meanwhile, the feature dimension increases by a factor of 2, which is different from the first stage mentioned above. The output of the last 3 stages forms the multi-scale feature maps, which are then fed to the neck.</p>
</div>
<figure id="S2.F2" class="ltx_figure"><img src="/html/2212.00313/assets/x2.png" id="S2.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="453" height="255" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>An illustration of DCFT Attention Block. (a) A DCFT Attention Block consists of a Patch Embedding layer and <math id="S2.F2.2.m1.1" class="ltx_Math" alttext="N_{i}" display="inline"><semantics id="S2.F2.2.m1.1b"><msub id="S2.F2.2.m1.1.1" xref="S2.F2.2.m1.1.1.cmml"><mi id="S2.F2.2.m1.1.1.2" xref="S2.F2.2.m1.1.1.2.cmml">N</mi><mi id="S2.F2.2.m1.1.1.3" xref="S2.F2.2.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.F2.2.m1.1c"><apply id="S2.F2.2.m1.1.1.cmml" xref="S2.F2.2.m1.1.1"><csymbol cd="ambiguous" id="S2.F2.2.m1.1.1.1.cmml" xref="S2.F2.2.m1.1.1">subscript</csymbol><ci id="S2.F2.2.m1.1.1.2.cmml" xref="S2.F2.2.m1.1.1.2">𝑁</ci><ci id="S2.F2.2.m1.1.1.3.cmml" xref="S2.F2.2.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.2.m1.1d">N_{i}</annotation></semantics></math> DCFT layers. (b) An illustration of the DCFT attention at window levels. Each of the finest square cells represents a query token.</figcaption>
</figure>
<div id="S2.SS2.p3" class="ltx_para">
<p id="S2.SS2.p3.1" class="ltx_p">Figure <a href="#S2.F2" title="Figure 2 ‣ II-B Denoising Coarse-to-Fine Transformer (DCFT) Attention-Based Backbone ‣ II Proposed Method ‣ Concealed Object Detection for Passive Millimeter-Wave Security Imaging Based on Task-Aligned Detection Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>(b) shows the illustration of a single DCFT attention block, considering that the visual dependencies between the close regions are usually stronger than the far region, we maintain fine-grained attention to the surrounding pixels closest to the query tokens in the feature map and captures coarse-grained attention on distant regions after being pooling, so this attention mechanism has the far-to-close, coarse-to-fine character. With this character, we get a reasonable trade-off between computational overhead and long-range perception capabilities.</p>
</div>
<div id="S2.SS2.p4" class="ltx_para">
<p id="S2.SS2.p4.11" class="ltx_p">As shown in Figure <a href="#S2.F2" title="Figure 2 ‣ II-B Denoising Coarse-to-Fine Transformer (DCFT) Attention-Based Backbone ‣ II Proposed Method ‣ Concealed Object Detection for Passive Millimeter-Wave Security Imaging Based on Task-Aligned Detection Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>(b), for a input feature map <math id="S2.SS2.p4.1.m1.1" class="ltx_Math" alttext="z\in\mathbb{R}^{{H}\times{W}\times c}" display="inline"><semantics id="S2.SS2.p4.1.m1.1a"><mrow id="S2.SS2.p4.1.m1.1.1" xref="S2.SS2.p4.1.m1.1.1.cmml"><mi id="S2.SS2.p4.1.m1.1.1.2" xref="S2.SS2.p4.1.m1.1.1.2.cmml">z</mi><mo id="S2.SS2.p4.1.m1.1.1.1" xref="S2.SS2.p4.1.m1.1.1.1.cmml">∈</mo><msup id="S2.SS2.p4.1.m1.1.1.3" xref="S2.SS2.p4.1.m1.1.1.3.cmml"><mi id="S2.SS2.p4.1.m1.1.1.3.2" xref="S2.SS2.p4.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS2.p4.1.m1.1.1.3.3" xref="S2.SS2.p4.1.m1.1.1.3.3.cmml"><mi id="S2.SS2.p4.1.m1.1.1.3.3.2" xref="S2.SS2.p4.1.m1.1.1.3.3.2.cmml">H</mi><mo lspace="0.222em" rspace="0.222em" id="S2.SS2.p4.1.m1.1.1.3.3.1" xref="S2.SS2.p4.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S2.SS2.p4.1.m1.1.1.3.3.3" xref="S2.SS2.p4.1.m1.1.1.3.3.3.cmml">W</mi><mo lspace="0.222em" rspace="0.222em" id="S2.SS2.p4.1.m1.1.1.3.3.1a" xref="S2.SS2.p4.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S2.SS2.p4.1.m1.1.1.3.3.4" xref="S2.SS2.p4.1.m1.1.1.3.3.4.cmml">c</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.1.m1.1b"><apply id="S2.SS2.p4.1.m1.1.1.cmml" xref="S2.SS2.p4.1.m1.1.1"><in id="S2.SS2.p4.1.m1.1.1.1.cmml" xref="S2.SS2.p4.1.m1.1.1.1"></in><ci id="S2.SS2.p4.1.m1.1.1.2.cmml" xref="S2.SS2.p4.1.m1.1.1.2">𝑧</ci><apply id="S2.SS2.p4.1.m1.1.1.3.cmml" xref="S2.SS2.p4.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p4.1.m1.1.1.3.1.cmml" xref="S2.SS2.p4.1.m1.1.1.3">superscript</csymbol><ci id="S2.SS2.p4.1.m1.1.1.3.2.cmml" xref="S2.SS2.p4.1.m1.1.1.3.2">ℝ</ci><apply id="S2.SS2.p4.1.m1.1.1.3.3.cmml" xref="S2.SS2.p4.1.m1.1.1.3.3"><times id="S2.SS2.p4.1.m1.1.1.3.3.1.cmml" xref="S2.SS2.p4.1.m1.1.1.3.3.1"></times><ci id="S2.SS2.p4.1.m1.1.1.3.3.2.cmml" xref="S2.SS2.p4.1.m1.1.1.3.3.2">𝐻</ci><ci id="S2.SS2.p4.1.m1.1.1.3.3.3.cmml" xref="S2.SS2.p4.1.m1.1.1.3.3.3">𝑊</ci><ci id="S2.SS2.p4.1.m1.1.1.3.3.4.cmml" xref="S2.SS2.p4.1.m1.1.1.3.3.4">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.1.m1.1c">z\in\mathbb{R}^{{H}\times{W}\times c}</annotation></semantics></math>, we first partition it into a grid of query windows with size <math id="S2.SS2.p4.2.m2.1" class="ltx_Math" alttext="n_{wp}\times n_{wp}" display="inline"><semantics id="S2.SS2.p4.2.m2.1a"><mrow id="S2.SS2.p4.2.m2.1.1" xref="S2.SS2.p4.2.m2.1.1.cmml"><msub id="S2.SS2.p4.2.m2.1.1.2" xref="S2.SS2.p4.2.m2.1.1.2.cmml"><mi id="S2.SS2.p4.2.m2.1.1.2.2" xref="S2.SS2.p4.2.m2.1.1.2.2.cmml">n</mi><mrow id="S2.SS2.p4.2.m2.1.1.2.3" xref="S2.SS2.p4.2.m2.1.1.2.3.cmml"><mi id="S2.SS2.p4.2.m2.1.1.2.3.2" xref="S2.SS2.p4.2.m2.1.1.2.3.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p4.2.m2.1.1.2.3.1" xref="S2.SS2.p4.2.m2.1.1.2.3.1.cmml">​</mo><mi id="S2.SS2.p4.2.m2.1.1.2.3.3" xref="S2.SS2.p4.2.m2.1.1.2.3.3.cmml">p</mi></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="S2.SS2.p4.2.m2.1.1.1" xref="S2.SS2.p4.2.m2.1.1.1.cmml">×</mo><msub id="S2.SS2.p4.2.m2.1.1.3" xref="S2.SS2.p4.2.m2.1.1.3.cmml"><mi id="S2.SS2.p4.2.m2.1.1.3.2" xref="S2.SS2.p4.2.m2.1.1.3.2.cmml">n</mi><mrow id="S2.SS2.p4.2.m2.1.1.3.3" xref="S2.SS2.p4.2.m2.1.1.3.3.cmml"><mi id="S2.SS2.p4.2.m2.1.1.3.3.2" xref="S2.SS2.p4.2.m2.1.1.3.3.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p4.2.m2.1.1.3.3.1" xref="S2.SS2.p4.2.m2.1.1.3.3.1.cmml">​</mo><mi id="S2.SS2.p4.2.m2.1.1.3.3.3" xref="S2.SS2.p4.2.m2.1.1.3.3.3.cmml">p</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.2.m2.1b"><apply id="S2.SS2.p4.2.m2.1.1.cmml" xref="S2.SS2.p4.2.m2.1.1"><times id="S2.SS2.p4.2.m2.1.1.1.cmml" xref="S2.SS2.p4.2.m2.1.1.1"></times><apply id="S2.SS2.p4.2.m2.1.1.2.cmml" xref="S2.SS2.p4.2.m2.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p4.2.m2.1.1.2.1.cmml" xref="S2.SS2.p4.2.m2.1.1.2">subscript</csymbol><ci id="S2.SS2.p4.2.m2.1.1.2.2.cmml" xref="S2.SS2.p4.2.m2.1.1.2.2">𝑛</ci><apply id="S2.SS2.p4.2.m2.1.1.2.3.cmml" xref="S2.SS2.p4.2.m2.1.1.2.3"><times id="S2.SS2.p4.2.m2.1.1.2.3.1.cmml" xref="S2.SS2.p4.2.m2.1.1.2.3.1"></times><ci id="S2.SS2.p4.2.m2.1.1.2.3.2.cmml" xref="S2.SS2.p4.2.m2.1.1.2.3.2">𝑤</ci><ci id="S2.SS2.p4.2.m2.1.1.2.3.3.cmml" xref="S2.SS2.p4.2.m2.1.1.2.3.3">𝑝</ci></apply></apply><apply id="S2.SS2.p4.2.m2.1.1.3.cmml" xref="S2.SS2.p4.2.m2.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p4.2.m2.1.1.3.1.cmml" xref="S2.SS2.p4.2.m2.1.1.3">subscript</csymbol><ci id="S2.SS2.p4.2.m2.1.1.3.2.cmml" xref="S2.SS2.p4.2.m2.1.1.3.2">𝑛</ci><apply id="S2.SS2.p4.2.m2.1.1.3.3.cmml" xref="S2.SS2.p4.2.m2.1.1.3.3"><times id="S2.SS2.p4.2.m2.1.1.3.3.1.cmml" xref="S2.SS2.p4.2.m2.1.1.3.3.1"></times><ci id="S2.SS2.p4.2.m2.1.1.3.3.2.cmml" xref="S2.SS2.p4.2.m2.1.1.3.3.2">𝑤</ci><ci id="S2.SS2.p4.2.m2.1.1.3.3.3.cmml" xref="S2.SS2.p4.2.m2.1.1.3.3.3">𝑝</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.2.m2.1c">n_{wp}\times n_{wp}</annotation></semantics></math>, in which the query window shares the same surroundings. Each query window will pass through a linear projection layer to obtain the <math id="S2.SS2.p4.3.m3.1" class="ltx_Math" alttext="Q_{i}=f_{q}\left(z^{1}\right)" display="inline"><semantics id="S2.SS2.p4.3.m3.1a"><mrow id="S2.SS2.p4.3.m3.1.1" xref="S2.SS2.p4.3.m3.1.1.cmml"><msub id="S2.SS2.p4.3.m3.1.1.3" xref="S2.SS2.p4.3.m3.1.1.3.cmml"><mi id="S2.SS2.p4.3.m3.1.1.3.2" xref="S2.SS2.p4.3.m3.1.1.3.2.cmml">Q</mi><mi id="S2.SS2.p4.3.m3.1.1.3.3" xref="S2.SS2.p4.3.m3.1.1.3.3.cmml">i</mi></msub><mo id="S2.SS2.p4.3.m3.1.1.2" xref="S2.SS2.p4.3.m3.1.1.2.cmml">=</mo><mrow id="S2.SS2.p4.3.m3.1.1.1" xref="S2.SS2.p4.3.m3.1.1.1.cmml"><msub id="S2.SS2.p4.3.m3.1.1.1.3" xref="S2.SS2.p4.3.m3.1.1.1.3.cmml"><mi id="S2.SS2.p4.3.m3.1.1.1.3.2" xref="S2.SS2.p4.3.m3.1.1.1.3.2.cmml">f</mi><mi id="S2.SS2.p4.3.m3.1.1.1.3.3" xref="S2.SS2.p4.3.m3.1.1.1.3.3.cmml">q</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.p4.3.m3.1.1.1.2" xref="S2.SS2.p4.3.m3.1.1.1.2.cmml">​</mo><mrow id="S2.SS2.p4.3.m3.1.1.1.1.1" xref="S2.SS2.p4.3.m3.1.1.1.1.1.1.cmml"><mo id="S2.SS2.p4.3.m3.1.1.1.1.1.2" xref="S2.SS2.p4.3.m3.1.1.1.1.1.1.cmml">(</mo><msup id="S2.SS2.p4.3.m3.1.1.1.1.1.1" xref="S2.SS2.p4.3.m3.1.1.1.1.1.1.cmml"><mi id="S2.SS2.p4.3.m3.1.1.1.1.1.1.2" xref="S2.SS2.p4.3.m3.1.1.1.1.1.1.2.cmml">z</mi><mn id="S2.SS2.p4.3.m3.1.1.1.1.1.1.3" xref="S2.SS2.p4.3.m3.1.1.1.1.1.1.3.cmml">1</mn></msup><mo id="S2.SS2.p4.3.m3.1.1.1.1.1.3" xref="S2.SS2.p4.3.m3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.3.m3.1b"><apply id="S2.SS2.p4.3.m3.1.1.cmml" xref="S2.SS2.p4.3.m3.1.1"><eq id="S2.SS2.p4.3.m3.1.1.2.cmml" xref="S2.SS2.p4.3.m3.1.1.2"></eq><apply id="S2.SS2.p4.3.m3.1.1.3.cmml" xref="S2.SS2.p4.3.m3.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p4.3.m3.1.1.3.1.cmml" xref="S2.SS2.p4.3.m3.1.1.3">subscript</csymbol><ci id="S2.SS2.p4.3.m3.1.1.3.2.cmml" xref="S2.SS2.p4.3.m3.1.1.3.2">𝑄</ci><ci id="S2.SS2.p4.3.m3.1.1.3.3.cmml" xref="S2.SS2.p4.3.m3.1.1.3.3">𝑖</ci></apply><apply id="S2.SS2.p4.3.m3.1.1.1.cmml" xref="S2.SS2.p4.3.m3.1.1.1"><times id="S2.SS2.p4.3.m3.1.1.1.2.cmml" xref="S2.SS2.p4.3.m3.1.1.1.2"></times><apply id="S2.SS2.p4.3.m3.1.1.1.3.cmml" xref="S2.SS2.p4.3.m3.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p4.3.m3.1.1.1.3.1.cmml" xref="S2.SS2.p4.3.m3.1.1.1.3">subscript</csymbol><ci id="S2.SS2.p4.3.m3.1.1.1.3.2.cmml" xref="S2.SS2.p4.3.m3.1.1.1.3.2">𝑓</ci><ci id="S2.SS2.p4.3.m3.1.1.1.3.3.cmml" xref="S2.SS2.p4.3.m3.1.1.1.3.3">𝑞</ci></apply><apply id="S2.SS2.p4.3.m3.1.1.1.1.1.1.cmml" xref="S2.SS2.p4.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.3.m3.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p4.3.m3.1.1.1.1.1">superscript</csymbol><ci id="S2.SS2.p4.3.m3.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p4.3.m3.1.1.1.1.1.1.2">𝑧</ci><cn type="integer" id="S2.SS2.p4.3.m3.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p4.3.m3.1.1.1.1.1.1.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.3.m3.1c">Q_{i}=f_{q}\left(z^{1}\right)</annotation></semantics></math> in the calculation of the attention mechanism, where <math id="S2.SS2.p4.4.m4.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.SS2.p4.4.m4.1a"><mi id="S2.SS2.p4.4.m4.1.1" xref="S2.SS2.p4.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.4.m4.1b"><ci id="S2.SS2.p4.4.m4.1.1.cmml" xref="S2.SS2.p4.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.4.m4.1c">i</annotation></semantics></math> indexes the <math id="S2.SS2.p4.5.m5.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.SS2.p4.5.m5.1a"><mi id="S2.SS2.p4.5.m5.1.1" xref="S2.SS2.p4.5.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.5.m5.1b"><ci id="S2.SS2.p4.5.m5.1.1.cmml" xref="S2.SS2.p4.5.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.5.m5.1c">i</annotation></semantics></math>-th query window. For the <math id="S2.SS2.p4.6.m6.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.SS2.p4.6.m6.1a"><mi id="S2.SS2.p4.6.m6.1.1" xref="S2.SS2.p4.6.m6.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.6.m6.1b"><ci id="S2.SS2.p4.6.m6.1.1.cmml" xref="S2.SS2.p4.6.m6.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.6.m6.1c">i</annotation></semantics></math>-th query window <math id="S2.SS2.p4.7.m7.1" class="ltx_Math" alttext="Q_{i}\in\mathbb{R}^{n_{wp}\times n_{wp}\times d}" display="inline"><semantics id="S2.SS2.p4.7.m7.1a"><mrow id="S2.SS2.p4.7.m7.1.1" xref="S2.SS2.p4.7.m7.1.1.cmml"><msub id="S2.SS2.p4.7.m7.1.1.2" xref="S2.SS2.p4.7.m7.1.1.2.cmml"><mi id="S2.SS2.p4.7.m7.1.1.2.2" xref="S2.SS2.p4.7.m7.1.1.2.2.cmml">Q</mi><mi id="S2.SS2.p4.7.m7.1.1.2.3" xref="S2.SS2.p4.7.m7.1.1.2.3.cmml">i</mi></msub><mo id="S2.SS2.p4.7.m7.1.1.1" xref="S2.SS2.p4.7.m7.1.1.1.cmml">∈</mo><msup id="S2.SS2.p4.7.m7.1.1.3" xref="S2.SS2.p4.7.m7.1.1.3.cmml"><mi id="S2.SS2.p4.7.m7.1.1.3.2" xref="S2.SS2.p4.7.m7.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS2.p4.7.m7.1.1.3.3" xref="S2.SS2.p4.7.m7.1.1.3.3.cmml"><msub id="S2.SS2.p4.7.m7.1.1.3.3.2" xref="S2.SS2.p4.7.m7.1.1.3.3.2.cmml"><mi id="S2.SS2.p4.7.m7.1.1.3.3.2.2" xref="S2.SS2.p4.7.m7.1.1.3.3.2.2.cmml">n</mi><mrow id="S2.SS2.p4.7.m7.1.1.3.3.2.3" xref="S2.SS2.p4.7.m7.1.1.3.3.2.3.cmml"><mi id="S2.SS2.p4.7.m7.1.1.3.3.2.3.2" xref="S2.SS2.p4.7.m7.1.1.3.3.2.3.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p4.7.m7.1.1.3.3.2.3.1" xref="S2.SS2.p4.7.m7.1.1.3.3.2.3.1.cmml">​</mo><mi id="S2.SS2.p4.7.m7.1.1.3.3.2.3.3" xref="S2.SS2.p4.7.m7.1.1.3.3.2.3.3.cmml">p</mi></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="S2.SS2.p4.7.m7.1.1.3.3.1" xref="S2.SS2.p4.7.m7.1.1.3.3.1.cmml">×</mo><msub id="S2.SS2.p4.7.m7.1.1.3.3.3" xref="S2.SS2.p4.7.m7.1.1.3.3.3.cmml"><mi id="S2.SS2.p4.7.m7.1.1.3.3.3.2" xref="S2.SS2.p4.7.m7.1.1.3.3.3.2.cmml">n</mi><mrow id="S2.SS2.p4.7.m7.1.1.3.3.3.3" xref="S2.SS2.p4.7.m7.1.1.3.3.3.3.cmml"><mi id="S2.SS2.p4.7.m7.1.1.3.3.3.3.2" xref="S2.SS2.p4.7.m7.1.1.3.3.3.3.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p4.7.m7.1.1.3.3.3.3.1" xref="S2.SS2.p4.7.m7.1.1.3.3.3.3.1.cmml">​</mo><mi id="S2.SS2.p4.7.m7.1.1.3.3.3.3.3" xref="S2.SS2.p4.7.m7.1.1.3.3.3.3.3.cmml">p</mi></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="S2.SS2.p4.7.m7.1.1.3.3.1a" xref="S2.SS2.p4.7.m7.1.1.3.3.1.cmml">×</mo><mi id="S2.SS2.p4.7.m7.1.1.3.3.4" xref="S2.SS2.p4.7.m7.1.1.3.3.4.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.7.m7.1b"><apply id="S2.SS2.p4.7.m7.1.1.cmml" xref="S2.SS2.p4.7.m7.1.1"><in id="S2.SS2.p4.7.m7.1.1.1.cmml" xref="S2.SS2.p4.7.m7.1.1.1"></in><apply id="S2.SS2.p4.7.m7.1.1.2.cmml" xref="S2.SS2.p4.7.m7.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p4.7.m7.1.1.2.1.cmml" xref="S2.SS2.p4.7.m7.1.1.2">subscript</csymbol><ci id="S2.SS2.p4.7.m7.1.1.2.2.cmml" xref="S2.SS2.p4.7.m7.1.1.2.2">𝑄</ci><ci id="S2.SS2.p4.7.m7.1.1.2.3.cmml" xref="S2.SS2.p4.7.m7.1.1.2.3">𝑖</ci></apply><apply id="S2.SS2.p4.7.m7.1.1.3.cmml" xref="S2.SS2.p4.7.m7.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p4.7.m7.1.1.3.1.cmml" xref="S2.SS2.p4.7.m7.1.1.3">superscript</csymbol><ci id="S2.SS2.p4.7.m7.1.1.3.2.cmml" xref="S2.SS2.p4.7.m7.1.1.3.2">ℝ</ci><apply id="S2.SS2.p4.7.m7.1.1.3.3.cmml" xref="S2.SS2.p4.7.m7.1.1.3.3"><times id="S2.SS2.p4.7.m7.1.1.3.3.1.cmml" xref="S2.SS2.p4.7.m7.1.1.3.3.1"></times><apply id="S2.SS2.p4.7.m7.1.1.3.3.2.cmml" xref="S2.SS2.p4.7.m7.1.1.3.3.2"><csymbol cd="ambiguous" id="S2.SS2.p4.7.m7.1.1.3.3.2.1.cmml" xref="S2.SS2.p4.7.m7.1.1.3.3.2">subscript</csymbol><ci id="S2.SS2.p4.7.m7.1.1.3.3.2.2.cmml" xref="S2.SS2.p4.7.m7.1.1.3.3.2.2">𝑛</ci><apply id="S2.SS2.p4.7.m7.1.1.3.3.2.3.cmml" xref="S2.SS2.p4.7.m7.1.1.3.3.2.3"><times id="S2.SS2.p4.7.m7.1.1.3.3.2.3.1.cmml" xref="S2.SS2.p4.7.m7.1.1.3.3.2.3.1"></times><ci id="S2.SS2.p4.7.m7.1.1.3.3.2.3.2.cmml" xref="S2.SS2.p4.7.m7.1.1.3.3.2.3.2">𝑤</ci><ci id="S2.SS2.p4.7.m7.1.1.3.3.2.3.3.cmml" xref="S2.SS2.p4.7.m7.1.1.3.3.2.3.3">𝑝</ci></apply></apply><apply id="S2.SS2.p4.7.m7.1.1.3.3.3.cmml" xref="S2.SS2.p4.7.m7.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.SS2.p4.7.m7.1.1.3.3.3.1.cmml" xref="S2.SS2.p4.7.m7.1.1.3.3.3">subscript</csymbol><ci id="S2.SS2.p4.7.m7.1.1.3.3.3.2.cmml" xref="S2.SS2.p4.7.m7.1.1.3.3.3.2">𝑛</ci><apply id="S2.SS2.p4.7.m7.1.1.3.3.3.3.cmml" xref="S2.SS2.p4.7.m7.1.1.3.3.3.3"><times id="S2.SS2.p4.7.m7.1.1.3.3.3.3.1.cmml" xref="S2.SS2.p4.7.m7.1.1.3.3.3.3.1"></times><ci id="S2.SS2.p4.7.m7.1.1.3.3.3.3.2.cmml" xref="S2.SS2.p4.7.m7.1.1.3.3.3.3.2">𝑤</ci><ci id="S2.SS2.p4.7.m7.1.1.3.3.3.3.3.cmml" xref="S2.SS2.p4.7.m7.1.1.3.3.3.3.3">𝑝</ci></apply></apply><ci id="S2.SS2.p4.7.m7.1.1.3.3.4.cmml" xref="S2.SS2.p4.7.m7.1.1.3.3.4">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.7.m7.1c">Q_{i}\in\mathbb{R}^{n_{wp}\times n_{wp}\times d}</annotation></semantics></math>, we split the input feature map <math id="S2.SS2.p4.8.m8.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S2.SS2.p4.8.m8.1a"><mi id="S2.SS2.p4.8.m8.1.1" xref="S2.SS2.p4.8.m8.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.8.m8.1b"><ci id="S2.SS2.p4.8.m8.1.1.cmml" xref="S2.SS2.p4.8.m8.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.8.m8.1c">z</annotation></semantics></math> into multiply sub-windows with the number of <math id="S2.SS2.p4.9.m9.1" class="ltx_Math" alttext="N^{l}\times N^{l}" display="inline"><semantics id="S2.SS2.p4.9.m9.1a"><mrow id="S2.SS2.p4.9.m9.1.1" xref="S2.SS2.p4.9.m9.1.1.cmml"><msup id="S2.SS2.p4.9.m9.1.1.2" xref="S2.SS2.p4.9.m9.1.1.2.cmml"><mi id="S2.SS2.p4.9.m9.1.1.2.2" xref="S2.SS2.p4.9.m9.1.1.2.2.cmml">N</mi><mi id="S2.SS2.p4.9.m9.1.1.2.3" xref="S2.SS2.p4.9.m9.1.1.2.3.cmml">l</mi></msup><mo lspace="0.222em" rspace="0.222em" id="S2.SS2.p4.9.m9.1.1.1" xref="S2.SS2.p4.9.m9.1.1.1.cmml">×</mo><msup id="S2.SS2.p4.9.m9.1.1.3" xref="S2.SS2.p4.9.m9.1.1.3.cmml"><mi id="S2.SS2.p4.9.m9.1.1.3.2" xref="S2.SS2.p4.9.m9.1.1.3.2.cmml">N</mi><mi id="S2.SS2.p4.9.m9.1.1.3.3" xref="S2.SS2.p4.9.m9.1.1.3.3.cmml">l</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.9.m9.1b"><apply id="S2.SS2.p4.9.m9.1.1.cmml" xref="S2.SS2.p4.9.m9.1.1"><times id="S2.SS2.p4.9.m9.1.1.1.cmml" xref="S2.SS2.p4.9.m9.1.1.1"></times><apply id="S2.SS2.p4.9.m9.1.1.2.cmml" xref="S2.SS2.p4.9.m9.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p4.9.m9.1.1.2.1.cmml" xref="S2.SS2.p4.9.m9.1.1.2">superscript</csymbol><ci id="S2.SS2.p4.9.m9.1.1.2.2.cmml" xref="S2.SS2.p4.9.m9.1.1.2.2">𝑁</ci><ci id="S2.SS2.p4.9.m9.1.1.2.3.cmml" xref="S2.SS2.p4.9.m9.1.1.2.3">𝑙</ci></apply><apply id="S2.SS2.p4.9.m9.1.1.3.cmml" xref="S2.SS2.p4.9.m9.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p4.9.m9.1.1.3.1.cmml" xref="S2.SS2.p4.9.m9.1.1.3">superscript</csymbol><ci id="S2.SS2.p4.9.m9.1.1.3.2.cmml" xref="S2.SS2.p4.9.m9.1.1.3.2">𝑁</ci><ci id="S2.SS2.p4.9.m9.1.1.3.3.cmml" xref="S2.SS2.p4.9.m9.1.1.3.3">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.9.m9.1c">N^{l}\times N^{l}</annotation></semantics></math>. Then we perform pooling for each feature map level <math id="S2.SS2.p4.10.m10.3" class="ltx_Math" alttext="l\in\{1,...,L\}" display="inline"><semantics id="S2.SS2.p4.10.m10.3a"><mrow id="S2.SS2.p4.10.m10.3.4" xref="S2.SS2.p4.10.m10.3.4.cmml"><mi id="S2.SS2.p4.10.m10.3.4.2" xref="S2.SS2.p4.10.m10.3.4.2.cmml">l</mi><mo id="S2.SS2.p4.10.m10.3.4.1" xref="S2.SS2.p4.10.m10.3.4.1.cmml">∈</mo><mrow id="S2.SS2.p4.10.m10.3.4.3.2" xref="S2.SS2.p4.10.m10.3.4.3.1.cmml"><mo stretchy="false" id="S2.SS2.p4.10.m10.3.4.3.2.1" xref="S2.SS2.p4.10.m10.3.4.3.1.cmml">{</mo><mn id="S2.SS2.p4.10.m10.1.1" xref="S2.SS2.p4.10.m10.1.1.cmml">1</mn><mo id="S2.SS2.p4.10.m10.3.4.3.2.2" xref="S2.SS2.p4.10.m10.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="S2.SS2.p4.10.m10.2.2" xref="S2.SS2.p4.10.m10.2.2.cmml">…</mi><mo id="S2.SS2.p4.10.m10.3.4.3.2.3" xref="S2.SS2.p4.10.m10.3.4.3.1.cmml">,</mo><mi id="S2.SS2.p4.10.m10.3.3" xref="S2.SS2.p4.10.m10.3.3.cmml">L</mi><mo stretchy="false" id="S2.SS2.p4.10.m10.3.4.3.2.4" xref="S2.SS2.p4.10.m10.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.10.m10.3b"><apply id="S2.SS2.p4.10.m10.3.4.cmml" xref="S2.SS2.p4.10.m10.3.4"><in id="S2.SS2.p4.10.m10.3.4.1.cmml" xref="S2.SS2.p4.10.m10.3.4.1"></in><ci id="S2.SS2.p4.10.m10.3.4.2.cmml" xref="S2.SS2.p4.10.m10.3.4.2">𝑙</ci><set id="S2.SS2.p4.10.m10.3.4.3.1.cmml" xref="S2.SS2.p4.10.m10.3.4.3.2"><cn type="integer" id="S2.SS2.p4.10.m10.1.1.cmml" xref="S2.SS2.p4.10.m10.1.1">1</cn><ci id="S2.SS2.p4.10.m10.2.2.cmml" xref="S2.SS2.p4.10.m10.2.2">…</ci><ci id="S2.SS2.p4.10.m10.3.3.cmml" xref="S2.SS2.p4.10.m10.3.3">𝐿</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.10.m10.3c">l\in\{1,...,L\}</annotation></semantics></math> to generate fine-grained and coarse-grained information. Since PMMW security images bear much more random noise than optical images, we adopt a denoising kernel in the pooling operation, with it has been shown in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> that denoising pre-processing is beneficial for object detection in PMMW security screening. A simple linear layer <math id="S2.SS2.p4.11.m11.1" class="ltx_Math" alttext="f_{p}^{l}" display="inline"><semantics id="S2.SS2.p4.11.m11.1a"><msubsup id="S2.SS2.p4.11.m11.1.1" xref="S2.SS2.p4.11.m11.1.1.cmml"><mi id="S2.SS2.p4.11.m11.1.1.2.2" xref="S2.SS2.p4.11.m11.1.1.2.2.cmml">f</mi><mi id="S2.SS2.p4.11.m11.1.1.2.3" xref="S2.SS2.p4.11.m11.1.1.2.3.cmml">p</mi><mi id="S2.SS2.p4.11.m11.1.1.3" xref="S2.SS2.p4.11.m11.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.11.m11.1b"><apply id="S2.SS2.p4.11.m11.1.1.cmml" xref="S2.SS2.p4.11.m11.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.11.m11.1.1.1.cmml" xref="S2.SS2.p4.11.m11.1.1">superscript</csymbol><apply id="S2.SS2.p4.11.m11.1.1.2.cmml" xref="S2.SS2.p4.11.m11.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.11.m11.1.1.2.1.cmml" xref="S2.SS2.p4.11.m11.1.1">subscript</csymbol><ci id="S2.SS2.p4.11.m11.1.1.2.2.cmml" xref="S2.SS2.p4.11.m11.1.1.2.2">𝑓</ci><ci id="S2.SS2.p4.11.m11.1.1.2.3.cmml" xref="S2.SS2.p4.11.m11.1.1.2.3">𝑝</ci></apply><ci id="S2.SS2.p4.11.m11.1.1.3.cmml" xref="S2.SS2.p4.11.m11.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.11.m11.1c">f_{p}^{l}</annotation></semantics></math> to pool the sub-windows spatially by:</p>
</div>
<div id="S2.SS2.p5" class="ltx_para">
<table id="S2.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E1.m1.26" class="ltx_Math" alttext="\begin{split}&amp;z^{l}=f_{p}^{l}(\hat{z})\in\mathbb{R}^{\frac{H}{n^{l}}\times\frac{W}{n^{l}}\times c},\\
&amp;\hat{z}=\operatorname{Reshape}(z)\in\mathbb{R}^{\left(\frac{H}{n^{l}}\times\frac{W}{n^{l}}\times c\right)\times\left(n^{l}\times n^{l}\right)},\end{split}" display="block"><semantics id="S2.E1.m1.26a"><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt" id="S2.E1.m1.26.26.3"><mtr id="S2.E1.m1.26.26.3a"><mtd id="S2.E1.m1.26.26.3b"></mtd><mtd class="ltx_align_left" columnalign="left" id="S2.E1.m1.26.26.3c"><mrow id="S2.E1.m1.25.25.2.24.14.14.14"><mrow id="S2.E1.m1.25.25.2.24.14.14.14.1"><msup id="S2.E1.m1.25.25.2.24.14.14.14.1.2"><mi id="S2.E1.m1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.cmml">z</mi><mi id="S2.E1.m1.2.2.2.2.2.2.1" xref="S2.E1.m1.2.2.2.2.2.2.1.cmml">l</mi></msup><mo id="S2.E1.m1.3.3.3.3.3.3" xref="S2.E1.m1.3.3.3.3.3.3.cmml">=</mo><mrow id="S2.E1.m1.25.25.2.24.14.14.14.1.3"><msubsup id="S2.E1.m1.25.25.2.24.14.14.14.1.3.2"><mi id="S2.E1.m1.4.4.4.4.4.4" xref="S2.E1.m1.4.4.4.4.4.4.cmml">f</mi><mi id="S2.E1.m1.5.5.5.5.5.5.1" xref="S2.E1.m1.5.5.5.5.5.5.1.cmml">p</mi><mi id="S2.E1.m1.6.6.6.6.6.6.1" xref="S2.E1.m1.6.6.6.6.6.6.1.cmml">l</mi></msubsup><mo lspace="0em" rspace="0em" id="S2.E1.m1.25.25.2.24.14.14.14.1.3.1">​</mo><mrow id="S2.E1.m1.25.25.2.24.14.14.14.1.3.3"><mo stretchy="false" id="S2.E1.m1.7.7.7.7.7.7">(</mo><mover accent="true" id="S2.E1.m1.8.8.8.8.8.8" xref="S2.E1.m1.8.8.8.8.8.8.cmml"><mi id="S2.E1.m1.8.8.8.8.8.8.2" xref="S2.E1.m1.8.8.8.8.8.8.2.cmml">z</mi><mo id="S2.E1.m1.8.8.8.8.8.8.1" xref="S2.E1.m1.8.8.8.8.8.8.1.cmml">^</mo></mover><mo stretchy="false" id="S2.E1.m1.9.9.9.9.9.9">)</mo></mrow></mrow><mo id="S2.E1.m1.10.10.10.10.10.10" xref="S2.E1.m1.10.10.10.10.10.10.cmml">∈</mo><msup id="S2.E1.m1.25.25.2.24.14.14.14.1.4"><mi id="S2.E1.m1.11.11.11.11.11.11" xref="S2.E1.m1.11.11.11.11.11.11.cmml">ℝ</mi><mrow id="S2.E1.m1.12.12.12.12.12.12.1" xref="S2.E1.m1.12.12.12.12.12.12.1.cmml"><mfrac id="S2.E1.m1.12.12.12.12.12.12.1.2" xref="S2.E1.m1.12.12.12.12.12.12.1.2.cmml"><mi id="S2.E1.m1.12.12.12.12.12.12.1.2.2" xref="S2.E1.m1.12.12.12.12.12.12.1.2.2.cmml">H</mi><msup id="S2.E1.m1.12.12.12.12.12.12.1.2.3" xref="S2.E1.m1.12.12.12.12.12.12.1.2.3.cmml"><mi id="S2.E1.m1.12.12.12.12.12.12.1.2.3.2" xref="S2.E1.m1.12.12.12.12.12.12.1.2.3.2.cmml">n</mi><mi id="S2.E1.m1.12.12.12.12.12.12.1.2.3.3" xref="S2.E1.m1.12.12.12.12.12.12.1.2.3.3.cmml">l</mi></msup></mfrac><mo lspace="0.222em" rspace="0.222em" id="S2.E1.m1.12.12.12.12.12.12.1.1" xref="S2.E1.m1.12.12.12.12.12.12.1.1.cmml">×</mo><mfrac id="S2.E1.m1.12.12.12.12.12.12.1.3" xref="S2.E1.m1.12.12.12.12.12.12.1.3.cmml"><mi id="S2.E1.m1.12.12.12.12.12.12.1.3.2" xref="S2.E1.m1.12.12.12.12.12.12.1.3.2.cmml">W</mi><msup id="S2.E1.m1.12.12.12.12.12.12.1.3.3" xref="S2.E1.m1.12.12.12.12.12.12.1.3.3.cmml"><mi id="S2.E1.m1.12.12.12.12.12.12.1.3.3.2" xref="S2.E1.m1.12.12.12.12.12.12.1.3.3.2.cmml">n</mi><mi id="S2.E1.m1.12.12.12.12.12.12.1.3.3.3" xref="S2.E1.m1.12.12.12.12.12.12.1.3.3.3.cmml">l</mi></msup></mfrac><mo lspace="0.222em" rspace="0.222em" id="S2.E1.m1.12.12.12.12.12.12.1.1a" xref="S2.E1.m1.12.12.12.12.12.12.1.1.cmml">×</mo><mi id="S2.E1.m1.12.12.12.12.12.12.1.4" xref="S2.E1.m1.12.12.12.12.12.12.1.4.cmml">c</mi></mrow></msup></mrow><mo id="S2.E1.m1.13.13.13.13.13.13">,</mo></mrow></mtd></mtr><mtr id="S2.E1.m1.26.26.3d"><mtd id="S2.E1.m1.26.26.3e"></mtd><mtd class="ltx_align_left" columnalign="left" id="S2.E1.m1.26.26.3f"><mrow id="S2.E1.m1.26.26.3.25.11.11.11"><mrow id="S2.E1.m1.26.26.3.25.11.11.11.1"><mover accent="true" id="S2.E1.m1.14.14.14.1.1.1" xref="S2.E1.m1.14.14.14.1.1.1.cmml"><mi id="S2.E1.m1.14.14.14.1.1.1.2" xref="S2.E1.m1.14.14.14.1.1.1.2.cmml">z</mi><mo id="S2.E1.m1.14.14.14.1.1.1.1" xref="S2.E1.m1.14.14.14.1.1.1.1.cmml">^</mo></mover><mo id="S2.E1.m1.15.15.15.2.2.2" xref="S2.E1.m1.15.15.15.2.2.2.cmml">=</mo><mrow id="S2.E1.m1.26.26.3.25.11.11.11.1.2"><mi id="S2.E1.m1.16.16.16.3.3.3" xref="S2.E1.m1.16.16.16.3.3.3.cmml">Reshape</mi><mo id="S2.E1.m1.26.26.3.25.11.11.11.1.2a">⁡</mo><mrow id="S2.E1.m1.26.26.3.25.11.11.11.1.2.1"><mo stretchy="false" id="S2.E1.m1.17.17.17.4.4.4">(</mo><mi id="S2.E1.m1.18.18.18.5.5.5" xref="S2.E1.m1.18.18.18.5.5.5.cmml">z</mi><mo stretchy="false" id="S2.E1.m1.19.19.19.6.6.6">)</mo></mrow></mrow><mo id="S2.E1.m1.20.20.20.7.7.7" xref="S2.E1.m1.20.20.20.7.7.7.cmml">∈</mo><msup id="S2.E1.m1.26.26.3.25.11.11.11.1.3"><mi id="S2.E1.m1.21.21.21.8.8.8" xref="S2.E1.m1.21.21.21.8.8.8.cmml">ℝ</mi><mrow id="S2.E1.m1.22.22.22.9.9.9.1" xref="S2.E1.m1.22.22.22.9.9.9.1.cmml"><mrow id="S2.E1.m1.22.22.22.9.9.9.1.1.1" xref="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.cmml"><mo id="S2.E1.m1.22.22.22.9.9.9.1.1.1.2" xref="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.cmml">(</mo><mrow id="S2.E1.m1.22.22.22.9.9.9.1.1.1.1" xref="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.cmml"><mfrac id="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.2" xref="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.2.cmml"><mi id="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.2.2" xref="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.2.2.cmml">H</mi><msup id="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.2.3" xref="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.2.3.cmml"><mi id="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.2.3.2" xref="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.2.3.2.cmml">n</mi><mi id="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.2.3.3" xref="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.2.3.3.cmml">l</mi></msup></mfrac><mo lspace="0.222em" rspace="0.222em" id="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.1" xref="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.1.cmml">×</mo><mfrac id="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.3" xref="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.3.cmml"><mi id="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.3.2" xref="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.3.2.cmml">W</mi><msup id="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.3.3" xref="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.3.3.cmml"><mi id="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.3.3.2" xref="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.3.3.2.cmml">n</mi><mi id="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.3.3.3" xref="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.3.3.3.cmml">l</mi></msup></mfrac><mo lspace="0.222em" rspace="0.222em" id="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.1a" xref="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.1.cmml">×</mo><mi id="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.4" xref="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.4.cmml">c</mi></mrow><mo rspace="0.055em" id="S2.E1.m1.22.22.22.9.9.9.1.1.1.3" xref="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S2.E1.m1.22.22.22.9.9.9.1.3" xref="S2.E1.m1.22.22.22.9.9.9.1.3.cmml">×</mo><mrow id="S2.E1.m1.22.22.22.9.9.9.1.2.1" xref="S2.E1.m1.22.22.22.9.9.9.1.2.1.1.cmml"><mo id="S2.E1.m1.22.22.22.9.9.9.1.2.1.2" xref="S2.E1.m1.22.22.22.9.9.9.1.2.1.1.cmml">(</mo><mrow id="S2.E1.m1.22.22.22.9.9.9.1.2.1.1" xref="S2.E1.m1.22.22.22.9.9.9.1.2.1.1.cmml"><msup id="S2.E1.m1.22.22.22.9.9.9.1.2.1.1.2" xref="S2.E1.m1.22.22.22.9.9.9.1.2.1.1.2.cmml"><mi id="S2.E1.m1.22.22.22.9.9.9.1.2.1.1.2.2" xref="S2.E1.m1.22.22.22.9.9.9.1.2.1.1.2.2.cmml">n</mi><mi id="S2.E1.m1.22.22.22.9.9.9.1.2.1.1.2.3" xref="S2.E1.m1.22.22.22.9.9.9.1.2.1.1.2.3.cmml">l</mi></msup><mo lspace="0.222em" rspace="0.222em" id="S2.E1.m1.22.22.22.9.9.9.1.2.1.1.1" xref="S2.E1.m1.22.22.22.9.9.9.1.2.1.1.1.cmml">×</mo><msup id="S2.E1.m1.22.22.22.9.9.9.1.2.1.1.3" xref="S2.E1.m1.22.22.22.9.9.9.1.2.1.1.3.cmml"><mi id="S2.E1.m1.22.22.22.9.9.9.1.2.1.1.3.2" xref="S2.E1.m1.22.22.22.9.9.9.1.2.1.1.3.2.cmml">n</mi><mi id="S2.E1.m1.22.22.22.9.9.9.1.2.1.1.3.3" xref="S2.E1.m1.22.22.22.9.9.9.1.2.1.1.3.3.cmml">l</mi></msup></mrow><mo id="S2.E1.m1.22.22.22.9.9.9.1.2.1.3" xref="S2.E1.m1.22.22.22.9.9.9.1.2.1.1.cmml">)</mo></mrow></mrow></msup></mrow><mo id="S2.E1.m1.23.23.23.10.10.10">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S2.E1.m1.26b"><apply id="S2.E1.m1.24.24.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S2.E1.m1.24.24.1.1.1.3a.cmml">formulae-sequence</csymbol><apply id="S2.E1.m1.24.24.1.1.1.1.1.cmml"><and id="S2.E1.m1.24.24.1.1.1.1.1a.cmml"></and><apply id="S2.E1.m1.24.24.1.1.1.1.1b.cmml"><eq id="S2.E1.m1.3.3.3.3.3.3.cmml" xref="S2.E1.m1.3.3.3.3.3.3"></eq><apply id="S2.E1.m1.24.24.1.1.1.1.1.2.cmml"><csymbol cd="ambiguous" id="S2.E1.m1.24.24.1.1.1.1.1.2.1.cmml">superscript</csymbol><ci id="S2.E1.m1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1">𝑧</ci><ci id="S2.E1.m1.2.2.2.2.2.2.1.cmml" xref="S2.E1.m1.2.2.2.2.2.2.1">𝑙</ci></apply><apply id="S2.E1.m1.24.24.1.1.1.1.1.4.cmml"><times id="S2.E1.m1.24.24.1.1.1.1.1.4.1.cmml"></times><apply id="S2.E1.m1.24.24.1.1.1.1.1.4.2.cmml"><csymbol cd="ambiguous" id="S2.E1.m1.24.24.1.1.1.1.1.4.2.1.cmml">superscript</csymbol><apply id="S2.E1.m1.24.24.1.1.1.1.1.4.2.2.cmml"><csymbol cd="ambiguous" id="S2.E1.m1.24.24.1.1.1.1.1.4.2.2.1.cmml">subscript</csymbol><ci id="S2.E1.m1.4.4.4.4.4.4.cmml" xref="S2.E1.m1.4.4.4.4.4.4">𝑓</ci><ci id="S2.E1.m1.5.5.5.5.5.5.1.cmml" xref="S2.E1.m1.5.5.5.5.5.5.1">𝑝</ci></apply><ci id="S2.E1.m1.6.6.6.6.6.6.1.cmml" xref="S2.E1.m1.6.6.6.6.6.6.1">𝑙</ci></apply><apply id="S2.E1.m1.8.8.8.8.8.8.cmml" xref="S2.E1.m1.8.8.8.8.8.8"><ci id="S2.E1.m1.8.8.8.8.8.8.1.cmml" xref="S2.E1.m1.8.8.8.8.8.8.1">^</ci><ci id="S2.E1.m1.8.8.8.8.8.8.2.cmml" xref="S2.E1.m1.8.8.8.8.8.8.2">𝑧</ci></apply></apply></apply><apply id="S2.E1.m1.24.24.1.1.1.1.1c.cmml"><in id="S2.E1.m1.10.10.10.10.10.10.cmml" xref="S2.E1.m1.10.10.10.10.10.10"></in><share href="#S2.E1.m1.24.24.1.1.1.1.1.4.cmml" id="S2.E1.m1.24.24.1.1.1.1.1d.cmml"></share><apply id="S2.E1.m1.24.24.1.1.1.1.1.6.cmml"><csymbol cd="ambiguous" id="S2.E1.m1.24.24.1.1.1.1.1.6.1.cmml">superscript</csymbol><ci id="S2.E1.m1.11.11.11.11.11.11.cmml" xref="S2.E1.m1.11.11.11.11.11.11">ℝ</ci><apply id="S2.E1.m1.12.12.12.12.12.12.1.cmml" xref="S2.E1.m1.12.12.12.12.12.12.1"><times id="S2.E1.m1.12.12.12.12.12.12.1.1.cmml" xref="S2.E1.m1.12.12.12.12.12.12.1.1"></times><apply id="S2.E1.m1.12.12.12.12.12.12.1.2.cmml" xref="S2.E1.m1.12.12.12.12.12.12.1.2"><divide id="S2.E1.m1.12.12.12.12.12.12.1.2.1.cmml" xref="S2.E1.m1.12.12.12.12.12.12.1.2"></divide><ci id="S2.E1.m1.12.12.12.12.12.12.1.2.2.cmml" xref="S2.E1.m1.12.12.12.12.12.12.1.2.2">𝐻</ci><apply id="S2.E1.m1.12.12.12.12.12.12.1.2.3.cmml" xref="S2.E1.m1.12.12.12.12.12.12.1.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.12.12.12.12.12.12.1.2.3.1.cmml" xref="S2.E1.m1.12.12.12.12.12.12.1.2.3">superscript</csymbol><ci id="S2.E1.m1.12.12.12.12.12.12.1.2.3.2.cmml" xref="S2.E1.m1.12.12.12.12.12.12.1.2.3.2">𝑛</ci><ci id="S2.E1.m1.12.12.12.12.12.12.1.2.3.3.cmml" xref="S2.E1.m1.12.12.12.12.12.12.1.2.3.3">𝑙</ci></apply></apply><apply id="S2.E1.m1.12.12.12.12.12.12.1.3.cmml" xref="S2.E1.m1.12.12.12.12.12.12.1.3"><divide id="S2.E1.m1.12.12.12.12.12.12.1.3.1.cmml" xref="S2.E1.m1.12.12.12.12.12.12.1.3"></divide><ci id="S2.E1.m1.12.12.12.12.12.12.1.3.2.cmml" xref="S2.E1.m1.12.12.12.12.12.12.1.3.2">𝑊</ci><apply id="S2.E1.m1.12.12.12.12.12.12.1.3.3.cmml" xref="S2.E1.m1.12.12.12.12.12.12.1.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.12.12.12.12.12.12.1.3.3.1.cmml" xref="S2.E1.m1.12.12.12.12.12.12.1.3.3">superscript</csymbol><ci id="S2.E1.m1.12.12.12.12.12.12.1.3.3.2.cmml" xref="S2.E1.m1.12.12.12.12.12.12.1.3.3.2">𝑛</ci><ci id="S2.E1.m1.12.12.12.12.12.12.1.3.3.3.cmml" xref="S2.E1.m1.12.12.12.12.12.12.1.3.3.3">𝑙</ci></apply></apply><ci id="S2.E1.m1.12.12.12.12.12.12.1.4.cmml" xref="S2.E1.m1.12.12.12.12.12.12.1.4">𝑐</ci></apply></apply></apply></apply><apply id="S2.E1.m1.24.24.1.1.1.2.2.cmml"><and id="S2.E1.m1.24.24.1.1.1.2.2a.cmml"></and><apply id="S2.E1.m1.24.24.1.1.1.2.2b.cmml"><eq id="S2.E1.m1.15.15.15.2.2.2.cmml" xref="S2.E1.m1.15.15.15.2.2.2"></eq><apply id="S2.E1.m1.14.14.14.1.1.1.cmml" xref="S2.E1.m1.14.14.14.1.1.1"><ci id="S2.E1.m1.14.14.14.1.1.1.1.cmml" xref="S2.E1.m1.14.14.14.1.1.1.1">^</ci><ci id="S2.E1.m1.14.14.14.1.1.1.2.cmml" xref="S2.E1.m1.14.14.14.1.1.1.2">𝑧</ci></apply><apply id="S2.E1.m1.24.24.1.1.1.2.2.4.cmml"><ci id="S2.E1.m1.16.16.16.3.3.3.cmml" xref="S2.E1.m1.16.16.16.3.3.3">Reshape</ci><ci id="S2.E1.m1.18.18.18.5.5.5.cmml" xref="S2.E1.m1.18.18.18.5.5.5">𝑧</ci></apply></apply><apply id="S2.E1.m1.24.24.1.1.1.2.2c.cmml"><in id="S2.E1.m1.20.20.20.7.7.7.cmml" xref="S2.E1.m1.20.20.20.7.7.7"></in><share href="#S2.E1.m1.24.24.1.1.1.2.2.4.cmml" id="S2.E1.m1.24.24.1.1.1.2.2d.cmml"></share><apply id="S2.E1.m1.24.24.1.1.1.2.2.6.cmml"><csymbol cd="ambiguous" id="S2.E1.m1.24.24.1.1.1.2.2.6.1.cmml">superscript</csymbol><ci id="S2.E1.m1.21.21.21.8.8.8.cmml" xref="S2.E1.m1.21.21.21.8.8.8">ℝ</ci><apply id="S2.E1.m1.22.22.22.9.9.9.1.cmml" xref="S2.E1.m1.22.22.22.9.9.9.1"><times id="S2.E1.m1.22.22.22.9.9.9.1.3.cmml" xref="S2.E1.m1.22.22.22.9.9.9.1.3"></times><apply id="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.cmml" xref="S2.E1.m1.22.22.22.9.9.9.1.1.1"><times id="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.1.cmml" xref="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.1"></times><apply id="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.2.cmml" xref="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.2"><divide id="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.2.1.cmml" xref="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.2"></divide><ci id="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.2.2.cmml" xref="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.2.2">𝐻</ci><apply id="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.2.3.cmml" xref="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.2.3.1.cmml" xref="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.2.3">superscript</csymbol><ci id="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.2.3.2.cmml" xref="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.2.3.2">𝑛</ci><ci id="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.2.3.3.cmml" xref="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.2.3.3">𝑙</ci></apply></apply><apply id="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.3.cmml" xref="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.3"><divide id="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.3.1.cmml" xref="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.3"></divide><ci id="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.3.2.cmml" xref="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.3.2">𝑊</ci><apply id="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.3.3.cmml" xref="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.3.3.1.cmml" xref="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.3.3">superscript</csymbol><ci id="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.3.3.2.cmml" xref="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.3.3.2">𝑛</ci><ci id="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.3.3.3.cmml" xref="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.3.3.3">𝑙</ci></apply></apply><ci id="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.4.cmml" xref="S2.E1.m1.22.22.22.9.9.9.1.1.1.1.4">𝑐</ci></apply><apply id="S2.E1.m1.22.22.22.9.9.9.1.2.1.1.cmml" xref="S2.E1.m1.22.22.22.9.9.9.1.2.1"><times id="S2.E1.m1.22.22.22.9.9.9.1.2.1.1.1.cmml" xref="S2.E1.m1.22.22.22.9.9.9.1.2.1.1.1"></times><apply id="S2.E1.m1.22.22.22.9.9.9.1.2.1.1.2.cmml" xref="S2.E1.m1.22.22.22.9.9.9.1.2.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.22.22.22.9.9.9.1.2.1.1.2.1.cmml" xref="S2.E1.m1.22.22.22.9.9.9.1.2.1.1.2">superscript</csymbol><ci id="S2.E1.m1.22.22.22.9.9.9.1.2.1.1.2.2.cmml" xref="S2.E1.m1.22.22.22.9.9.9.1.2.1.1.2.2">𝑛</ci><ci id="S2.E1.m1.22.22.22.9.9.9.1.2.1.1.2.3.cmml" xref="S2.E1.m1.22.22.22.9.9.9.1.2.1.1.2.3">𝑙</ci></apply><apply id="S2.E1.m1.22.22.22.9.9.9.1.2.1.1.3.cmml" xref="S2.E1.m1.22.22.22.9.9.9.1.2.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.22.22.22.9.9.9.1.2.1.1.3.1.cmml" xref="S2.E1.m1.22.22.22.9.9.9.1.2.1.1.3">superscript</csymbol><ci id="S2.E1.m1.22.22.22.9.9.9.1.2.1.1.3.2.cmml" xref="S2.E1.m1.22.22.22.9.9.9.1.2.1.1.3.2">𝑛</ci><ci id="S2.E1.m1.22.22.22.9.9.9.1.2.1.1.3.3.cmml" xref="S2.E1.m1.22.22.22.9.9.9.1.2.1.1.3.3">𝑙</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.26c">\begin{split}&amp;z^{l}=f_{p}^{l}(\hat{z})\in\mathbb{R}^{\frac{H}{n^{l}}\times\frac{W}{n^{l}}\times c},\\
&amp;\hat{z}=\operatorname{Reshape}(z)\in\mathbb{R}^{\left(\frac{H}{n^{l}}\times\frac{W}{n^{l}}\times c\right)\times\left(n^{l}\times n^{l}\right)},\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.p5.19" class="ltx_p">where <math id="S2.SS2.p5.1.m1.3" class="ltx_Math" alttext="n^{l}=\{n^{1},\ldots,n^{L}\}" display="inline"><semantics id="S2.SS2.p5.1.m1.3a"><mrow id="S2.SS2.p5.1.m1.3.3" xref="S2.SS2.p5.1.m1.3.3.cmml"><msup id="S2.SS2.p5.1.m1.3.3.4" xref="S2.SS2.p5.1.m1.3.3.4.cmml"><mi id="S2.SS2.p5.1.m1.3.3.4.2" xref="S2.SS2.p5.1.m1.3.3.4.2.cmml">n</mi><mi id="S2.SS2.p5.1.m1.3.3.4.3" xref="S2.SS2.p5.1.m1.3.3.4.3.cmml">l</mi></msup><mo id="S2.SS2.p5.1.m1.3.3.3" xref="S2.SS2.p5.1.m1.3.3.3.cmml">=</mo><mrow id="S2.SS2.p5.1.m1.3.3.2.2" xref="S2.SS2.p5.1.m1.3.3.2.3.cmml"><mo stretchy="false" id="S2.SS2.p5.1.m1.3.3.2.2.3" xref="S2.SS2.p5.1.m1.3.3.2.3.cmml">{</mo><msup id="S2.SS2.p5.1.m1.2.2.1.1.1" xref="S2.SS2.p5.1.m1.2.2.1.1.1.cmml"><mi id="S2.SS2.p5.1.m1.2.2.1.1.1.2" xref="S2.SS2.p5.1.m1.2.2.1.1.1.2.cmml">n</mi><mn id="S2.SS2.p5.1.m1.2.2.1.1.1.3" xref="S2.SS2.p5.1.m1.2.2.1.1.1.3.cmml">1</mn></msup><mo id="S2.SS2.p5.1.m1.3.3.2.2.4" xref="S2.SS2.p5.1.m1.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S2.SS2.p5.1.m1.1.1" xref="S2.SS2.p5.1.m1.1.1.cmml">…</mi><mo id="S2.SS2.p5.1.m1.3.3.2.2.5" xref="S2.SS2.p5.1.m1.3.3.2.3.cmml">,</mo><msup id="S2.SS2.p5.1.m1.3.3.2.2.2" xref="S2.SS2.p5.1.m1.3.3.2.2.2.cmml"><mi id="S2.SS2.p5.1.m1.3.3.2.2.2.2" xref="S2.SS2.p5.1.m1.3.3.2.2.2.2.cmml">n</mi><mi id="S2.SS2.p5.1.m1.3.3.2.2.2.3" xref="S2.SS2.p5.1.m1.3.3.2.2.2.3.cmml">L</mi></msup><mo stretchy="false" id="S2.SS2.p5.1.m1.3.3.2.2.6" xref="S2.SS2.p5.1.m1.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.1.m1.3b"><apply id="S2.SS2.p5.1.m1.3.3.cmml" xref="S2.SS2.p5.1.m1.3.3"><eq id="S2.SS2.p5.1.m1.3.3.3.cmml" xref="S2.SS2.p5.1.m1.3.3.3"></eq><apply id="S2.SS2.p5.1.m1.3.3.4.cmml" xref="S2.SS2.p5.1.m1.3.3.4"><csymbol cd="ambiguous" id="S2.SS2.p5.1.m1.3.3.4.1.cmml" xref="S2.SS2.p5.1.m1.3.3.4">superscript</csymbol><ci id="S2.SS2.p5.1.m1.3.3.4.2.cmml" xref="S2.SS2.p5.1.m1.3.3.4.2">𝑛</ci><ci id="S2.SS2.p5.1.m1.3.3.4.3.cmml" xref="S2.SS2.p5.1.m1.3.3.4.3">𝑙</ci></apply><set id="S2.SS2.p5.1.m1.3.3.2.3.cmml" xref="S2.SS2.p5.1.m1.3.3.2.2"><apply id="S2.SS2.p5.1.m1.2.2.1.1.1.cmml" xref="S2.SS2.p5.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p5.1.m1.2.2.1.1.1.1.cmml" xref="S2.SS2.p5.1.m1.2.2.1.1.1">superscript</csymbol><ci id="S2.SS2.p5.1.m1.2.2.1.1.1.2.cmml" xref="S2.SS2.p5.1.m1.2.2.1.1.1.2">𝑛</ci><cn type="integer" id="S2.SS2.p5.1.m1.2.2.1.1.1.3.cmml" xref="S2.SS2.p5.1.m1.2.2.1.1.1.3">1</cn></apply><ci id="S2.SS2.p5.1.m1.1.1.cmml" xref="S2.SS2.p5.1.m1.1.1">…</ci><apply id="S2.SS2.p5.1.m1.3.3.2.2.2.cmml" xref="S2.SS2.p5.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p5.1.m1.3.3.2.2.2.1.cmml" xref="S2.SS2.p5.1.m1.3.3.2.2.2">superscript</csymbol><ci id="S2.SS2.p5.1.m1.3.3.2.2.2.2.cmml" xref="S2.SS2.p5.1.m1.3.3.2.2.2.2">𝑛</ci><ci id="S2.SS2.p5.1.m1.3.3.2.2.2.3.cmml" xref="S2.SS2.p5.1.m1.3.3.2.2.2.3">𝐿</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.1.m1.3c">n^{l}=\{n^{1},\ldots,n^{L}\}</annotation></semantics></math> is the size of sub-windows, and <math id="S2.SS2.p5.2.m2.1" class="ltx_Math" alttext="n^{1}" display="inline"><semantics id="S2.SS2.p5.2.m2.1a"><msup id="S2.SS2.p5.2.m2.1.1" xref="S2.SS2.p5.2.m2.1.1.cmml"><mi id="S2.SS2.p5.2.m2.1.1.2" xref="S2.SS2.p5.2.m2.1.1.2.cmml">n</mi><mn id="S2.SS2.p5.2.m2.1.1.3" xref="S2.SS2.p5.2.m2.1.1.3.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.2.m2.1b"><apply id="S2.SS2.p5.2.m2.1.1.cmml" xref="S2.SS2.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p5.2.m2.1.1.1.cmml" xref="S2.SS2.p5.2.m2.1.1">superscript</csymbol><ci id="S2.SS2.p5.2.m2.1.1.2.cmml" xref="S2.SS2.p5.2.m2.1.1.2">𝑛</ci><cn type="integer" id="S2.SS2.p5.2.m2.1.1.3.cmml" xref="S2.SS2.p5.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.2.m2.1c">n^{1}</annotation></semantics></math> of the first feature map level is set to 1 to extract the finest granularity local feature. Once we obtain the pooled feature maps <math id="S2.SS2.p5.3.m3.3" class="ltx_Math" alttext="\{z^{1},...,z^{L}\}" display="inline"><semantics id="S2.SS2.p5.3.m3.3a"><mrow id="S2.SS2.p5.3.m3.3.3.2" xref="S2.SS2.p5.3.m3.3.3.3.cmml"><mo stretchy="false" id="S2.SS2.p5.3.m3.3.3.2.3" xref="S2.SS2.p5.3.m3.3.3.3.cmml">{</mo><msup id="S2.SS2.p5.3.m3.2.2.1.1" xref="S2.SS2.p5.3.m3.2.2.1.1.cmml"><mi id="S2.SS2.p5.3.m3.2.2.1.1.2" xref="S2.SS2.p5.3.m3.2.2.1.1.2.cmml">z</mi><mn id="S2.SS2.p5.3.m3.2.2.1.1.3" xref="S2.SS2.p5.3.m3.2.2.1.1.3.cmml">1</mn></msup><mo id="S2.SS2.p5.3.m3.3.3.2.4" xref="S2.SS2.p5.3.m3.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S2.SS2.p5.3.m3.1.1" xref="S2.SS2.p5.3.m3.1.1.cmml">…</mi><mo id="S2.SS2.p5.3.m3.3.3.2.5" xref="S2.SS2.p5.3.m3.3.3.3.cmml">,</mo><msup id="S2.SS2.p5.3.m3.3.3.2.2" xref="S2.SS2.p5.3.m3.3.3.2.2.cmml"><mi id="S2.SS2.p5.3.m3.3.3.2.2.2" xref="S2.SS2.p5.3.m3.3.3.2.2.2.cmml">z</mi><mi id="S2.SS2.p5.3.m3.3.3.2.2.3" xref="S2.SS2.p5.3.m3.3.3.2.2.3.cmml">L</mi></msup><mo stretchy="false" id="S2.SS2.p5.3.m3.3.3.2.6" xref="S2.SS2.p5.3.m3.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.3.m3.3b"><set id="S2.SS2.p5.3.m3.3.3.3.cmml" xref="S2.SS2.p5.3.m3.3.3.2"><apply id="S2.SS2.p5.3.m3.2.2.1.1.cmml" xref="S2.SS2.p5.3.m3.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p5.3.m3.2.2.1.1.1.cmml" xref="S2.SS2.p5.3.m3.2.2.1.1">superscript</csymbol><ci id="S2.SS2.p5.3.m3.2.2.1.1.2.cmml" xref="S2.SS2.p5.3.m3.2.2.1.1.2">𝑧</ci><cn type="integer" id="S2.SS2.p5.3.m3.2.2.1.1.3.cmml" xref="S2.SS2.p5.3.m3.2.2.1.1.3">1</cn></apply><ci id="S2.SS2.p5.3.m3.1.1.cmml" xref="S2.SS2.p5.3.m3.1.1">…</ci><apply id="S2.SS2.p5.3.m3.3.3.2.2.cmml" xref="S2.SS2.p5.3.m3.3.3.2.2"><csymbol cd="ambiguous" id="S2.SS2.p5.3.m3.3.3.2.2.1.cmml" xref="S2.SS2.p5.3.m3.3.3.2.2">superscript</csymbol><ci id="S2.SS2.p5.3.m3.3.3.2.2.2.cmml" xref="S2.SS2.p5.3.m3.3.3.2.2.2">𝑧</ci><ci id="S2.SS2.p5.3.m3.3.3.2.2.3.cmml" xref="S2.SS2.p5.3.m3.3.3.2.2.3">𝐿</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.3.m3.3c">\{z^{1},...,z^{L}\}</annotation></semantics></math> at all <math id="S2.SS2.p5.4.m4.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S2.SS2.p5.4.m4.1a"><mi id="S2.SS2.p5.4.m4.1.1" xref="S2.SS2.p5.4.m4.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.4.m4.1b"><ci id="S2.SS2.p5.4.m4.1.1.cmml" xref="S2.SS2.p5.4.m4.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.4.m4.1c">L</annotation></semantics></math> levels, we compute the key and value for all levels using two linear projection layers <math id="S2.SS2.p5.5.m5.1" class="ltx_Math" alttext="f_{k}" display="inline"><semantics id="S2.SS2.p5.5.m5.1a"><msub id="S2.SS2.p5.5.m5.1.1" xref="S2.SS2.p5.5.m5.1.1.cmml"><mi id="S2.SS2.p5.5.m5.1.1.2" xref="S2.SS2.p5.5.m5.1.1.2.cmml">f</mi><mi id="S2.SS2.p5.5.m5.1.1.3" xref="S2.SS2.p5.5.m5.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.5.m5.1b"><apply id="S2.SS2.p5.5.m5.1.1.cmml" xref="S2.SS2.p5.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS2.p5.5.m5.1.1.1.cmml" xref="S2.SS2.p5.5.m5.1.1">subscript</csymbol><ci id="S2.SS2.p5.5.m5.1.1.2.cmml" xref="S2.SS2.p5.5.m5.1.1.2">𝑓</ci><ci id="S2.SS2.p5.5.m5.1.1.3.cmml" xref="S2.SS2.p5.5.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.5.m5.1c">f_{k}</annotation></semantics></math> , <math id="S2.SS2.p5.6.m6.1" class="ltx_Math" alttext="f_{v}" display="inline"><semantics id="S2.SS2.p5.6.m6.1a"><msub id="S2.SS2.p5.6.m6.1.1" xref="S2.SS2.p5.6.m6.1.1.cmml"><mi id="S2.SS2.p5.6.m6.1.1.2" xref="S2.SS2.p5.6.m6.1.1.2.cmml">f</mi><mi id="S2.SS2.p5.6.m6.1.1.3" xref="S2.SS2.p5.6.m6.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.6.m6.1b"><apply id="S2.SS2.p5.6.m6.1.1.cmml" xref="S2.SS2.p5.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS2.p5.6.m6.1.1.1.cmml" xref="S2.SS2.p5.6.m6.1.1">subscript</csymbol><ci id="S2.SS2.p5.6.m6.1.1.2.cmml" xref="S2.SS2.p5.6.m6.1.1.2">𝑓</ci><ci id="S2.SS2.p5.6.m6.1.1.3.cmml" xref="S2.SS2.p5.6.m6.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.6.m6.1c">f_{v}</annotation></semantics></math>, i.e. <math id="S2.SS2.p5.7.m7.4" class="ltx_Math" alttext="K_{i}=f_{k}\left(\left\{z^{1},\ldots,z^{L}\right\}\right),V_{i}=f_{v}\left(\left\{z^{1},\ldots,z^{L}\right\}\right)" display="inline"><semantics id="S2.SS2.p5.7.m7.4a"><mrow id="S2.SS2.p5.7.m7.4.4.2" xref="S2.SS2.p5.7.m7.4.4.3.cmml"><mrow id="S2.SS2.p5.7.m7.3.3.1.1" xref="S2.SS2.p5.7.m7.3.3.1.1.cmml"><msub id="S2.SS2.p5.7.m7.3.3.1.1.3" xref="S2.SS2.p5.7.m7.3.3.1.1.3.cmml"><mi id="S2.SS2.p5.7.m7.3.3.1.1.3.2" xref="S2.SS2.p5.7.m7.3.3.1.1.3.2.cmml">K</mi><mi id="S2.SS2.p5.7.m7.3.3.1.1.3.3" xref="S2.SS2.p5.7.m7.3.3.1.1.3.3.cmml">i</mi></msub><mo id="S2.SS2.p5.7.m7.3.3.1.1.2" xref="S2.SS2.p5.7.m7.3.3.1.1.2.cmml">=</mo><mrow id="S2.SS2.p5.7.m7.3.3.1.1.1" xref="S2.SS2.p5.7.m7.3.3.1.1.1.cmml"><msub id="S2.SS2.p5.7.m7.3.3.1.1.1.3" xref="S2.SS2.p5.7.m7.3.3.1.1.1.3.cmml"><mi id="S2.SS2.p5.7.m7.3.3.1.1.1.3.2" xref="S2.SS2.p5.7.m7.3.3.1.1.1.3.2.cmml">f</mi><mi id="S2.SS2.p5.7.m7.3.3.1.1.1.3.3" xref="S2.SS2.p5.7.m7.3.3.1.1.1.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.p5.7.m7.3.3.1.1.1.2" xref="S2.SS2.p5.7.m7.3.3.1.1.1.2.cmml">​</mo><mrow id="S2.SS2.p5.7.m7.3.3.1.1.1.1.1" xref="S2.SS2.p5.7.m7.3.3.1.1.1.cmml"><mo id="S2.SS2.p5.7.m7.3.3.1.1.1.1.1.2" xref="S2.SS2.p5.7.m7.3.3.1.1.1.cmml">(</mo><mrow id="S2.SS2.p5.7.m7.3.3.1.1.1.1.1.1.2" xref="S2.SS2.p5.7.m7.3.3.1.1.1.1.1.1.3.cmml"><mo id="S2.SS2.p5.7.m7.3.3.1.1.1.1.1.1.2.3" xref="S2.SS2.p5.7.m7.3.3.1.1.1.1.1.1.3.cmml">{</mo><msup id="S2.SS2.p5.7.m7.3.3.1.1.1.1.1.1.1.1" xref="S2.SS2.p5.7.m7.3.3.1.1.1.1.1.1.1.1.cmml"><mi id="S2.SS2.p5.7.m7.3.3.1.1.1.1.1.1.1.1.2" xref="S2.SS2.p5.7.m7.3.3.1.1.1.1.1.1.1.1.2.cmml">z</mi><mn id="S2.SS2.p5.7.m7.3.3.1.1.1.1.1.1.1.1.3" xref="S2.SS2.p5.7.m7.3.3.1.1.1.1.1.1.1.1.3.cmml">1</mn></msup><mo id="S2.SS2.p5.7.m7.3.3.1.1.1.1.1.1.2.4" xref="S2.SS2.p5.7.m7.3.3.1.1.1.1.1.1.3.cmml">,</mo><mi mathvariant="normal" id="S2.SS2.p5.7.m7.1.1" xref="S2.SS2.p5.7.m7.1.1.cmml">…</mi><mo id="S2.SS2.p5.7.m7.3.3.1.1.1.1.1.1.2.5" xref="S2.SS2.p5.7.m7.3.3.1.1.1.1.1.1.3.cmml">,</mo><msup id="S2.SS2.p5.7.m7.3.3.1.1.1.1.1.1.2.2" xref="S2.SS2.p5.7.m7.3.3.1.1.1.1.1.1.2.2.cmml"><mi id="S2.SS2.p5.7.m7.3.3.1.1.1.1.1.1.2.2.2" xref="S2.SS2.p5.7.m7.3.3.1.1.1.1.1.1.2.2.2.cmml">z</mi><mi id="S2.SS2.p5.7.m7.3.3.1.1.1.1.1.1.2.2.3" xref="S2.SS2.p5.7.m7.3.3.1.1.1.1.1.1.2.2.3.cmml">L</mi></msup><mo id="S2.SS2.p5.7.m7.3.3.1.1.1.1.1.1.2.6" xref="S2.SS2.p5.7.m7.3.3.1.1.1.1.1.1.3.cmml">}</mo></mrow><mo id="S2.SS2.p5.7.m7.3.3.1.1.1.1.1.3" xref="S2.SS2.p5.7.m7.3.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.SS2.p5.7.m7.4.4.2.3" xref="S2.SS2.p5.7.m7.4.4.3a.cmml">,</mo><mrow id="S2.SS2.p5.7.m7.4.4.2.2" xref="S2.SS2.p5.7.m7.4.4.2.2.cmml"><msub id="S2.SS2.p5.7.m7.4.4.2.2.3" xref="S2.SS2.p5.7.m7.4.4.2.2.3.cmml"><mi id="S2.SS2.p5.7.m7.4.4.2.2.3.2" xref="S2.SS2.p5.7.m7.4.4.2.2.3.2.cmml">V</mi><mi id="S2.SS2.p5.7.m7.4.4.2.2.3.3" xref="S2.SS2.p5.7.m7.4.4.2.2.3.3.cmml">i</mi></msub><mo id="S2.SS2.p5.7.m7.4.4.2.2.2" xref="S2.SS2.p5.7.m7.4.4.2.2.2.cmml">=</mo><mrow id="S2.SS2.p5.7.m7.4.4.2.2.1" xref="S2.SS2.p5.7.m7.4.4.2.2.1.cmml"><msub id="S2.SS2.p5.7.m7.4.4.2.2.1.3" xref="S2.SS2.p5.7.m7.4.4.2.2.1.3.cmml"><mi id="S2.SS2.p5.7.m7.4.4.2.2.1.3.2" xref="S2.SS2.p5.7.m7.4.4.2.2.1.3.2.cmml">f</mi><mi id="S2.SS2.p5.7.m7.4.4.2.2.1.3.3" xref="S2.SS2.p5.7.m7.4.4.2.2.1.3.3.cmml">v</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.p5.7.m7.4.4.2.2.1.2" xref="S2.SS2.p5.7.m7.4.4.2.2.1.2.cmml">​</mo><mrow id="S2.SS2.p5.7.m7.4.4.2.2.1.1.1" xref="S2.SS2.p5.7.m7.4.4.2.2.1.cmml"><mo id="S2.SS2.p5.7.m7.4.4.2.2.1.1.1.2" xref="S2.SS2.p5.7.m7.4.4.2.2.1.cmml">(</mo><mrow id="S2.SS2.p5.7.m7.4.4.2.2.1.1.1.1.2" xref="S2.SS2.p5.7.m7.4.4.2.2.1.1.1.1.3.cmml"><mo id="S2.SS2.p5.7.m7.4.4.2.2.1.1.1.1.2.3" xref="S2.SS2.p5.7.m7.4.4.2.2.1.1.1.1.3.cmml">{</mo><msup id="S2.SS2.p5.7.m7.4.4.2.2.1.1.1.1.1.1" xref="S2.SS2.p5.7.m7.4.4.2.2.1.1.1.1.1.1.cmml"><mi id="S2.SS2.p5.7.m7.4.4.2.2.1.1.1.1.1.1.2" xref="S2.SS2.p5.7.m7.4.4.2.2.1.1.1.1.1.1.2.cmml">z</mi><mn id="S2.SS2.p5.7.m7.4.4.2.2.1.1.1.1.1.1.3" xref="S2.SS2.p5.7.m7.4.4.2.2.1.1.1.1.1.1.3.cmml">1</mn></msup><mo id="S2.SS2.p5.7.m7.4.4.2.2.1.1.1.1.2.4" xref="S2.SS2.p5.7.m7.4.4.2.2.1.1.1.1.3.cmml">,</mo><mi mathvariant="normal" id="S2.SS2.p5.7.m7.2.2" xref="S2.SS2.p5.7.m7.2.2.cmml">…</mi><mo id="S2.SS2.p5.7.m7.4.4.2.2.1.1.1.1.2.5" xref="S2.SS2.p5.7.m7.4.4.2.2.1.1.1.1.3.cmml">,</mo><msup id="S2.SS2.p5.7.m7.4.4.2.2.1.1.1.1.2.2" xref="S2.SS2.p5.7.m7.4.4.2.2.1.1.1.1.2.2.cmml"><mi id="S2.SS2.p5.7.m7.4.4.2.2.1.1.1.1.2.2.2" xref="S2.SS2.p5.7.m7.4.4.2.2.1.1.1.1.2.2.2.cmml">z</mi><mi id="S2.SS2.p5.7.m7.4.4.2.2.1.1.1.1.2.2.3" xref="S2.SS2.p5.7.m7.4.4.2.2.1.1.1.1.2.2.3.cmml">L</mi></msup><mo id="S2.SS2.p5.7.m7.4.4.2.2.1.1.1.1.2.6" xref="S2.SS2.p5.7.m7.4.4.2.2.1.1.1.1.3.cmml">}</mo></mrow><mo id="S2.SS2.p5.7.m7.4.4.2.2.1.1.1.3" xref="S2.SS2.p5.7.m7.4.4.2.2.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.7.m7.4b"><apply id="S2.SS2.p5.7.m7.4.4.3.cmml" xref="S2.SS2.p5.7.m7.4.4.2"><csymbol cd="ambiguous" id="S2.SS2.p5.7.m7.4.4.3a.cmml" xref="S2.SS2.p5.7.m7.4.4.2.3">formulae-sequence</csymbol><apply id="S2.SS2.p5.7.m7.3.3.1.1.cmml" xref="S2.SS2.p5.7.m7.3.3.1.1"><eq id="S2.SS2.p5.7.m7.3.3.1.1.2.cmml" xref="S2.SS2.p5.7.m7.3.3.1.1.2"></eq><apply id="S2.SS2.p5.7.m7.3.3.1.1.3.cmml" xref="S2.SS2.p5.7.m7.3.3.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p5.7.m7.3.3.1.1.3.1.cmml" xref="S2.SS2.p5.7.m7.3.3.1.1.3">subscript</csymbol><ci id="S2.SS2.p5.7.m7.3.3.1.1.3.2.cmml" xref="S2.SS2.p5.7.m7.3.3.1.1.3.2">𝐾</ci><ci id="S2.SS2.p5.7.m7.3.3.1.1.3.3.cmml" xref="S2.SS2.p5.7.m7.3.3.1.1.3.3">𝑖</ci></apply><apply id="S2.SS2.p5.7.m7.3.3.1.1.1.cmml" xref="S2.SS2.p5.7.m7.3.3.1.1.1"><times id="S2.SS2.p5.7.m7.3.3.1.1.1.2.cmml" xref="S2.SS2.p5.7.m7.3.3.1.1.1.2"></times><apply id="S2.SS2.p5.7.m7.3.3.1.1.1.3.cmml" xref="S2.SS2.p5.7.m7.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p5.7.m7.3.3.1.1.1.3.1.cmml" xref="S2.SS2.p5.7.m7.3.3.1.1.1.3">subscript</csymbol><ci id="S2.SS2.p5.7.m7.3.3.1.1.1.3.2.cmml" xref="S2.SS2.p5.7.m7.3.3.1.1.1.3.2">𝑓</ci><ci id="S2.SS2.p5.7.m7.3.3.1.1.1.3.3.cmml" xref="S2.SS2.p5.7.m7.3.3.1.1.1.3.3">𝑘</ci></apply><set id="S2.SS2.p5.7.m7.3.3.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p5.7.m7.3.3.1.1.1.1.1.1.2"><apply id="S2.SS2.p5.7.m7.3.3.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p5.7.m7.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p5.7.m7.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p5.7.m7.3.3.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.SS2.p5.7.m7.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p5.7.m7.3.3.1.1.1.1.1.1.1.1.2">𝑧</ci><cn type="integer" id="S2.SS2.p5.7.m7.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p5.7.m7.3.3.1.1.1.1.1.1.1.1.3">1</cn></apply><ci id="S2.SS2.p5.7.m7.1.1.cmml" xref="S2.SS2.p5.7.m7.1.1">…</ci><apply id="S2.SS2.p5.7.m7.3.3.1.1.1.1.1.1.2.2.cmml" xref="S2.SS2.p5.7.m7.3.3.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.p5.7.m7.3.3.1.1.1.1.1.1.2.2.1.cmml" xref="S2.SS2.p5.7.m7.3.3.1.1.1.1.1.1.2.2">superscript</csymbol><ci id="S2.SS2.p5.7.m7.3.3.1.1.1.1.1.1.2.2.2.cmml" xref="S2.SS2.p5.7.m7.3.3.1.1.1.1.1.1.2.2.2">𝑧</ci><ci id="S2.SS2.p5.7.m7.3.3.1.1.1.1.1.1.2.2.3.cmml" xref="S2.SS2.p5.7.m7.3.3.1.1.1.1.1.1.2.2.3">𝐿</ci></apply></set></apply></apply><apply id="S2.SS2.p5.7.m7.4.4.2.2.cmml" xref="S2.SS2.p5.7.m7.4.4.2.2"><eq id="S2.SS2.p5.7.m7.4.4.2.2.2.cmml" xref="S2.SS2.p5.7.m7.4.4.2.2.2"></eq><apply id="S2.SS2.p5.7.m7.4.4.2.2.3.cmml" xref="S2.SS2.p5.7.m7.4.4.2.2.3"><csymbol cd="ambiguous" id="S2.SS2.p5.7.m7.4.4.2.2.3.1.cmml" xref="S2.SS2.p5.7.m7.4.4.2.2.3">subscript</csymbol><ci id="S2.SS2.p5.7.m7.4.4.2.2.3.2.cmml" xref="S2.SS2.p5.7.m7.4.4.2.2.3.2">𝑉</ci><ci id="S2.SS2.p5.7.m7.4.4.2.2.3.3.cmml" xref="S2.SS2.p5.7.m7.4.4.2.2.3.3">𝑖</ci></apply><apply id="S2.SS2.p5.7.m7.4.4.2.2.1.cmml" xref="S2.SS2.p5.7.m7.4.4.2.2.1"><times id="S2.SS2.p5.7.m7.4.4.2.2.1.2.cmml" xref="S2.SS2.p5.7.m7.4.4.2.2.1.2"></times><apply id="S2.SS2.p5.7.m7.4.4.2.2.1.3.cmml" xref="S2.SS2.p5.7.m7.4.4.2.2.1.3"><csymbol cd="ambiguous" id="S2.SS2.p5.7.m7.4.4.2.2.1.3.1.cmml" xref="S2.SS2.p5.7.m7.4.4.2.2.1.3">subscript</csymbol><ci id="S2.SS2.p5.7.m7.4.4.2.2.1.3.2.cmml" xref="S2.SS2.p5.7.m7.4.4.2.2.1.3.2">𝑓</ci><ci id="S2.SS2.p5.7.m7.4.4.2.2.1.3.3.cmml" xref="S2.SS2.p5.7.m7.4.4.2.2.1.3.3">𝑣</ci></apply><set id="S2.SS2.p5.7.m7.4.4.2.2.1.1.1.1.3.cmml" xref="S2.SS2.p5.7.m7.4.4.2.2.1.1.1.1.2"><apply id="S2.SS2.p5.7.m7.4.4.2.2.1.1.1.1.1.1.cmml" xref="S2.SS2.p5.7.m7.4.4.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p5.7.m7.4.4.2.2.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p5.7.m7.4.4.2.2.1.1.1.1.1.1">superscript</csymbol><ci id="S2.SS2.p5.7.m7.4.4.2.2.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p5.7.m7.4.4.2.2.1.1.1.1.1.1.2">𝑧</ci><cn type="integer" id="S2.SS2.p5.7.m7.4.4.2.2.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p5.7.m7.4.4.2.2.1.1.1.1.1.1.3">1</cn></apply><ci id="S2.SS2.p5.7.m7.2.2.cmml" xref="S2.SS2.p5.7.m7.2.2">…</ci><apply id="S2.SS2.p5.7.m7.4.4.2.2.1.1.1.1.2.2.cmml" xref="S2.SS2.p5.7.m7.4.4.2.2.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.p5.7.m7.4.4.2.2.1.1.1.1.2.2.1.cmml" xref="S2.SS2.p5.7.m7.4.4.2.2.1.1.1.1.2.2">superscript</csymbol><ci id="S2.SS2.p5.7.m7.4.4.2.2.1.1.1.1.2.2.2.cmml" xref="S2.SS2.p5.7.m7.4.4.2.2.1.1.1.1.2.2.2">𝑧</ci><ci id="S2.SS2.p5.7.m7.4.4.2.2.1.1.1.1.2.2.3.cmml" xref="S2.SS2.p5.7.m7.4.4.2.2.1.1.1.1.2.2.3">𝐿</ci></apply></set></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.7.m7.4c">K_{i}=f_{k}\left(\left\{z^{1},\ldots,z^{L}\right\}\right),V_{i}=f_{v}\left(\left\{z^{1},\ldots,z^{L}\right\}\right)</annotation></semantics></math>. To perform DCFT attention, we need to first extract the surrounding tokens for each query token in the feature map. As we mentioned earlier, query tokens inside a query window <math id="S2.SS2.p5.8.m8.1" class="ltx_Math" alttext="n_{wp}\times n_{wp}" display="inline"><semantics id="S2.SS2.p5.8.m8.1a"><mrow id="S2.SS2.p5.8.m8.1.1" xref="S2.SS2.p5.8.m8.1.1.cmml"><msub id="S2.SS2.p5.8.m8.1.1.2" xref="S2.SS2.p5.8.m8.1.1.2.cmml"><mi id="S2.SS2.p5.8.m8.1.1.2.2" xref="S2.SS2.p5.8.m8.1.1.2.2.cmml">n</mi><mrow id="S2.SS2.p5.8.m8.1.1.2.3" xref="S2.SS2.p5.8.m8.1.1.2.3.cmml"><mi id="S2.SS2.p5.8.m8.1.1.2.3.2" xref="S2.SS2.p5.8.m8.1.1.2.3.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p5.8.m8.1.1.2.3.1" xref="S2.SS2.p5.8.m8.1.1.2.3.1.cmml">​</mo><mi id="S2.SS2.p5.8.m8.1.1.2.3.3" xref="S2.SS2.p5.8.m8.1.1.2.3.3.cmml">p</mi></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="S2.SS2.p5.8.m8.1.1.1" xref="S2.SS2.p5.8.m8.1.1.1.cmml">×</mo><msub id="S2.SS2.p5.8.m8.1.1.3" xref="S2.SS2.p5.8.m8.1.1.3.cmml"><mi id="S2.SS2.p5.8.m8.1.1.3.2" xref="S2.SS2.p5.8.m8.1.1.3.2.cmml">n</mi><mrow id="S2.SS2.p5.8.m8.1.1.3.3" xref="S2.SS2.p5.8.m8.1.1.3.3.cmml"><mi id="S2.SS2.p5.8.m8.1.1.3.3.2" xref="S2.SS2.p5.8.m8.1.1.3.3.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p5.8.m8.1.1.3.3.1" xref="S2.SS2.p5.8.m8.1.1.3.3.1.cmml">​</mo><mi id="S2.SS2.p5.8.m8.1.1.3.3.3" xref="S2.SS2.p5.8.m8.1.1.3.3.3.cmml">p</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.8.m8.1b"><apply id="S2.SS2.p5.8.m8.1.1.cmml" xref="S2.SS2.p5.8.m8.1.1"><times id="S2.SS2.p5.8.m8.1.1.1.cmml" xref="S2.SS2.p5.8.m8.1.1.1"></times><apply id="S2.SS2.p5.8.m8.1.1.2.cmml" xref="S2.SS2.p5.8.m8.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p5.8.m8.1.1.2.1.cmml" xref="S2.SS2.p5.8.m8.1.1.2">subscript</csymbol><ci id="S2.SS2.p5.8.m8.1.1.2.2.cmml" xref="S2.SS2.p5.8.m8.1.1.2.2">𝑛</ci><apply id="S2.SS2.p5.8.m8.1.1.2.3.cmml" xref="S2.SS2.p5.8.m8.1.1.2.3"><times id="S2.SS2.p5.8.m8.1.1.2.3.1.cmml" xref="S2.SS2.p5.8.m8.1.1.2.3.1"></times><ci id="S2.SS2.p5.8.m8.1.1.2.3.2.cmml" xref="S2.SS2.p5.8.m8.1.1.2.3.2">𝑤</ci><ci id="S2.SS2.p5.8.m8.1.1.2.3.3.cmml" xref="S2.SS2.p5.8.m8.1.1.2.3.3">𝑝</ci></apply></apply><apply id="S2.SS2.p5.8.m8.1.1.3.cmml" xref="S2.SS2.p5.8.m8.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p5.8.m8.1.1.3.1.cmml" xref="S2.SS2.p5.8.m8.1.1.3">subscript</csymbol><ci id="S2.SS2.p5.8.m8.1.1.3.2.cmml" xref="S2.SS2.p5.8.m8.1.1.3.2">𝑛</ci><apply id="S2.SS2.p5.8.m8.1.1.3.3.cmml" xref="S2.SS2.p5.8.m8.1.1.3.3"><times id="S2.SS2.p5.8.m8.1.1.3.3.1.cmml" xref="S2.SS2.p5.8.m8.1.1.3.3.1"></times><ci id="S2.SS2.p5.8.m8.1.1.3.3.2.cmml" xref="S2.SS2.p5.8.m8.1.1.3.3.2">𝑤</ci><ci id="S2.SS2.p5.8.m8.1.1.3.3.3.cmml" xref="S2.SS2.p5.8.m8.1.1.3.3.3">𝑝</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.8.m8.1c">n_{wp}\times n_{wp}</annotation></semantics></math> share the same surroundings. For the queries inside the <math id="S2.SS2.p5.9.m9.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.SS2.p5.9.m9.1a"><mi id="S2.SS2.p5.9.m9.1.1" xref="S2.SS2.p5.9.m9.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.9.m9.1b"><ci id="S2.SS2.p5.9.m9.1.1.cmml" xref="S2.SS2.p5.9.m9.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.9.m9.1c">i</annotation></semantics></math>-th query window <math id="S2.SS2.p5.10.m10.1" class="ltx_Math" alttext="Q_{i}\in\mathbb{R}^{n_{wp}\times n_{wp}\times d}" display="inline"><semantics id="S2.SS2.p5.10.m10.1a"><mrow id="S2.SS2.p5.10.m10.1.1" xref="S2.SS2.p5.10.m10.1.1.cmml"><msub id="S2.SS2.p5.10.m10.1.1.2" xref="S2.SS2.p5.10.m10.1.1.2.cmml"><mi id="S2.SS2.p5.10.m10.1.1.2.2" xref="S2.SS2.p5.10.m10.1.1.2.2.cmml">Q</mi><mi id="S2.SS2.p5.10.m10.1.1.2.3" xref="S2.SS2.p5.10.m10.1.1.2.3.cmml">i</mi></msub><mo id="S2.SS2.p5.10.m10.1.1.1" xref="S2.SS2.p5.10.m10.1.1.1.cmml">∈</mo><msup id="S2.SS2.p5.10.m10.1.1.3" xref="S2.SS2.p5.10.m10.1.1.3.cmml"><mi id="S2.SS2.p5.10.m10.1.1.3.2" xref="S2.SS2.p5.10.m10.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS2.p5.10.m10.1.1.3.3" xref="S2.SS2.p5.10.m10.1.1.3.3.cmml"><msub id="S2.SS2.p5.10.m10.1.1.3.3.2" xref="S2.SS2.p5.10.m10.1.1.3.3.2.cmml"><mi id="S2.SS2.p5.10.m10.1.1.3.3.2.2" xref="S2.SS2.p5.10.m10.1.1.3.3.2.2.cmml">n</mi><mrow id="S2.SS2.p5.10.m10.1.1.3.3.2.3" xref="S2.SS2.p5.10.m10.1.1.3.3.2.3.cmml"><mi id="S2.SS2.p5.10.m10.1.1.3.3.2.3.2" xref="S2.SS2.p5.10.m10.1.1.3.3.2.3.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p5.10.m10.1.1.3.3.2.3.1" xref="S2.SS2.p5.10.m10.1.1.3.3.2.3.1.cmml">​</mo><mi id="S2.SS2.p5.10.m10.1.1.3.3.2.3.3" xref="S2.SS2.p5.10.m10.1.1.3.3.2.3.3.cmml">p</mi></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="S2.SS2.p5.10.m10.1.1.3.3.1" xref="S2.SS2.p5.10.m10.1.1.3.3.1.cmml">×</mo><msub id="S2.SS2.p5.10.m10.1.1.3.3.3" xref="S2.SS2.p5.10.m10.1.1.3.3.3.cmml"><mi id="S2.SS2.p5.10.m10.1.1.3.3.3.2" xref="S2.SS2.p5.10.m10.1.1.3.3.3.2.cmml">n</mi><mrow id="S2.SS2.p5.10.m10.1.1.3.3.3.3" xref="S2.SS2.p5.10.m10.1.1.3.3.3.3.cmml"><mi id="S2.SS2.p5.10.m10.1.1.3.3.3.3.2" xref="S2.SS2.p5.10.m10.1.1.3.3.3.3.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p5.10.m10.1.1.3.3.3.3.1" xref="S2.SS2.p5.10.m10.1.1.3.3.3.3.1.cmml">​</mo><mi id="S2.SS2.p5.10.m10.1.1.3.3.3.3.3" xref="S2.SS2.p5.10.m10.1.1.3.3.3.3.3.cmml">p</mi></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="S2.SS2.p5.10.m10.1.1.3.3.1a" xref="S2.SS2.p5.10.m10.1.1.3.3.1.cmml">×</mo><mi id="S2.SS2.p5.10.m10.1.1.3.3.4" xref="S2.SS2.p5.10.m10.1.1.3.3.4.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.10.m10.1b"><apply id="S2.SS2.p5.10.m10.1.1.cmml" xref="S2.SS2.p5.10.m10.1.1"><in id="S2.SS2.p5.10.m10.1.1.1.cmml" xref="S2.SS2.p5.10.m10.1.1.1"></in><apply id="S2.SS2.p5.10.m10.1.1.2.cmml" xref="S2.SS2.p5.10.m10.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p5.10.m10.1.1.2.1.cmml" xref="S2.SS2.p5.10.m10.1.1.2">subscript</csymbol><ci id="S2.SS2.p5.10.m10.1.1.2.2.cmml" xref="S2.SS2.p5.10.m10.1.1.2.2">𝑄</ci><ci id="S2.SS2.p5.10.m10.1.1.2.3.cmml" xref="S2.SS2.p5.10.m10.1.1.2.3">𝑖</ci></apply><apply id="S2.SS2.p5.10.m10.1.1.3.cmml" xref="S2.SS2.p5.10.m10.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p5.10.m10.1.1.3.1.cmml" xref="S2.SS2.p5.10.m10.1.1.3">superscript</csymbol><ci id="S2.SS2.p5.10.m10.1.1.3.2.cmml" xref="S2.SS2.p5.10.m10.1.1.3.2">ℝ</ci><apply id="S2.SS2.p5.10.m10.1.1.3.3.cmml" xref="S2.SS2.p5.10.m10.1.1.3.3"><times id="S2.SS2.p5.10.m10.1.1.3.3.1.cmml" xref="S2.SS2.p5.10.m10.1.1.3.3.1"></times><apply id="S2.SS2.p5.10.m10.1.1.3.3.2.cmml" xref="S2.SS2.p5.10.m10.1.1.3.3.2"><csymbol cd="ambiguous" id="S2.SS2.p5.10.m10.1.1.3.3.2.1.cmml" xref="S2.SS2.p5.10.m10.1.1.3.3.2">subscript</csymbol><ci id="S2.SS2.p5.10.m10.1.1.3.3.2.2.cmml" xref="S2.SS2.p5.10.m10.1.1.3.3.2.2">𝑛</ci><apply id="S2.SS2.p5.10.m10.1.1.3.3.2.3.cmml" xref="S2.SS2.p5.10.m10.1.1.3.3.2.3"><times id="S2.SS2.p5.10.m10.1.1.3.3.2.3.1.cmml" xref="S2.SS2.p5.10.m10.1.1.3.3.2.3.1"></times><ci id="S2.SS2.p5.10.m10.1.1.3.3.2.3.2.cmml" xref="S2.SS2.p5.10.m10.1.1.3.3.2.3.2">𝑤</ci><ci id="S2.SS2.p5.10.m10.1.1.3.3.2.3.3.cmml" xref="S2.SS2.p5.10.m10.1.1.3.3.2.3.3">𝑝</ci></apply></apply><apply id="S2.SS2.p5.10.m10.1.1.3.3.3.cmml" xref="S2.SS2.p5.10.m10.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.SS2.p5.10.m10.1.1.3.3.3.1.cmml" xref="S2.SS2.p5.10.m10.1.1.3.3.3">subscript</csymbol><ci id="S2.SS2.p5.10.m10.1.1.3.3.3.2.cmml" xref="S2.SS2.p5.10.m10.1.1.3.3.3.2">𝑛</ci><apply id="S2.SS2.p5.10.m10.1.1.3.3.3.3.cmml" xref="S2.SS2.p5.10.m10.1.1.3.3.3.3"><times id="S2.SS2.p5.10.m10.1.1.3.3.3.3.1.cmml" xref="S2.SS2.p5.10.m10.1.1.3.3.3.3.1"></times><ci id="S2.SS2.p5.10.m10.1.1.3.3.3.3.2.cmml" xref="S2.SS2.p5.10.m10.1.1.3.3.3.3.2">𝑤</ci><ci id="S2.SS2.p5.10.m10.1.1.3.3.3.3.3.cmml" xref="S2.SS2.p5.10.m10.1.1.3.3.3.3.3">𝑝</ci></apply></apply><ci id="S2.SS2.p5.10.m10.1.1.3.3.4.cmml" xref="S2.SS2.p5.10.m10.1.1.3.3.4">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.10.m10.1c">Q_{i}\in\mathbb{R}^{n_{wp}\times n_{wp}\times d}</annotation></semantics></math>, we extract the <math id="S2.SS2.p5.11.m11.1" class="ltx_Math" alttext="N^{l}\times N^{l}" display="inline"><semantics id="S2.SS2.p5.11.m11.1a"><mrow id="S2.SS2.p5.11.m11.1.1" xref="S2.SS2.p5.11.m11.1.1.cmml"><msup id="S2.SS2.p5.11.m11.1.1.2" xref="S2.SS2.p5.11.m11.1.1.2.cmml"><mi id="S2.SS2.p5.11.m11.1.1.2.2" xref="S2.SS2.p5.11.m11.1.1.2.2.cmml">N</mi><mi id="S2.SS2.p5.11.m11.1.1.2.3" xref="S2.SS2.p5.11.m11.1.1.2.3.cmml">l</mi></msup><mo lspace="0.222em" rspace="0.222em" id="S2.SS2.p5.11.m11.1.1.1" xref="S2.SS2.p5.11.m11.1.1.1.cmml">×</mo><msup id="S2.SS2.p5.11.m11.1.1.3" xref="S2.SS2.p5.11.m11.1.1.3.cmml"><mi id="S2.SS2.p5.11.m11.1.1.3.2" xref="S2.SS2.p5.11.m11.1.1.3.2.cmml">N</mi><mi id="S2.SS2.p5.11.m11.1.1.3.3" xref="S2.SS2.p5.11.m11.1.1.3.3.cmml">l</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.11.m11.1b"><apply id="S2.SS2.p5.11.m11.1.1.cmml" xref="S2.SS2.p5.11.m11.1.1"><times id="S2.SS2.p5.11.m11.1.1.1.cmml" xref="S2.SS2.p5.11.m11.1.1.1"></times><apply id="S2.SS2.p5.11.m11.1.1.2.cmml" xref="S2.SS2.p5.11.m11.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p5.11.m11.1.1.2.1.cmml" xref="S2.SS2.p5.11.m11.1.1.2">superscript</csymbol><ci id="S2.SS2.p5.11.m11.1.1.2.2.cmml" xref="S2.SS2.p5.11.m11.1.1.2.2">𝑁</ci><ci id="S2.SS2.p5.11.m11.1.1.2.3.cmml" xref="S2.SS2.p5.11.m11.1.1.2.3">𝑙</ci></apply><apply id="S2.SS2.p5.11.m11.1.1.3.cmml" xref="S2.SS2.p5.11.m11.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p5.11.m11.1.1.3.1.cmml" xref="S2.SS2.p5.11.m11.1.1.3">superscript</csymbol><ci id="S2.SS2.p5.11.m11.1.1.3.2.cmml" xref="S2.SS2.p5.11.m11.1.1.3.2">𝑁</ci><ci id="S2.SS2.p5.11.m11.1.1.3.3.cmml" xref="S2.SS2.p5.11.m11.1.1.3.3">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.11.m11.1c">N^{l}\times N^{l}</annotation></semantics></math> keys and values from <math id="S2.SS2.p5.12.m12.1" class="ltx_Math" alttext="K^{l}" display="inline"><semantics id="S2.SS2.p5.12.m12.1a"><msup id="S2.SS2.p5.12.m12.1.1" xref="S2.SS2.p5.12.m12.1.1.cmml"><mi id="S2.SS2.p5.12.m12.1.1.2" xref="S2.SS2.p5.12.m12.1.1.2.cmml">K</mi><mi id="S2.SS2.p5.12.m12.1.1.3" xref="S2.SS2.p5.12.m12.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.12.m12.1b"><apply id="S2.SS2.p5.12.m12.1.1.cmml" xref="S2.SS2.p5.12.m12.1.1"><csymbol cd="ambiguous" id="S2.SS2.p5.12.m12.1.1.1.cmml" xref="S2.SS2.p5.12.m12.1.1">superscript</csymbol><ci id="S2.SS2.p5.12.m12.1.1.2.cmml" xref="S2.SS2.p5.12.m12.1.1.2">𝐾</ci><ci id="S2.SS2.p5.12.m12.1.1.3.cmml" xref="S2.SS2.p5.12.m12.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.12.m12.1c">K^{l}</annotation></semantics></math> and <math id="S2.SS2.p5.13.m13.1" class="ltx_Math" alttext="V^{l}" display="inline"><semantics id="S2.SS2.p5.13.m13.1a"><msup id="S2.SS2.p5.13.m13.1.1" xref="S2.SS2.p5.13.m13.1.1.cmml"><mi id="S2.SS2.p5.13.m13.1.1.2" xref="S2.SS2.p5.13.m13.1.1.2.cmml">V</mi><mi id="S2.SS2.p5.13.m13.1.1.3" xref="S2.SS2.p5.13.m13.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.13.m13.1b"><apply id="S2.SS2.p5.13.m13.1.1.cmml" xref="S2.SS2.p5.13.m13.1.1"><csymbol cd="ambiguous" id="S2.SS2.p5.13.m13.1.1.1.cmml" xref="S2.SS2.p5.13.m13.1.1">superscript</csymbol><ci id="S2.SS2.p5.13.m13.1.1.2.cmml" xref="S2.SS2.p5.13.m13.1.1.2">𝑉</ci><ci id="S2.SS2.p5.13.m13.1.1.3.cmml" xref="S2.SS2.p5.13.m13.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.13.m13.1c">V^{l}</annotation></semantics></math> around the window where the query lies in, and then gather the keys and values from all <math id="S2.SS2.p5.14.m14.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S2.SS2.p5.14.m14.1a"><mi id="S2.SS2.p5.14.m14.1.1" xref="S2.SS2.p5.14.m14.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.14.m14.1b"><ci id="S2.SS2.p5.14.m14.1.1.cmml" xref="S2.SS2.p5.14.m14.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.14.m14.1c">L</annotation></semantics></math> to obtain <math id="S2.SS2.p5.15.m15.3" class="ltx_Math" alttext="K_{i}=\{K_{i}^{1},...,K_{i}^{L}\}\in\mathbb{R}^{N\times c}" display="inline"><semantics id="S2.SS2.p5.15.m15.3a"><mrow id="S2.SS2.p5.15.m15.3.3" xref="S2.SS2.p5.15.m15.3.3.cmml"><msub id="S2.SS2.p5.15.m15.3.3.4" xref="S2.SS2.p5.15.m15.3.3.4.cmml"><mi id="S2.SS2.p5.15.m15.3.3.4.2" xref="S2.SS2.p5.15.m15.3.3.4.2.cmml">K</mi><mi id="S2.SS2.p5.15.m15.3.3.4.3" xref="S2.SS2.p5.15.m15.3.3.4.3.cmml">i</mi></msub><mo id="S2.SS2.p5.15.m15.3.3.5" xref="S2.SS2.p5.15.m15.3.3.5.cmml">=</mo><mrow id="S2.SS2.p5.15.m15.3.3.2.2" xref="S2.SS2.p5.15.m15.3.3.2.3.cmml"><mo stretchy="false" id="S2.SS2.p5.15.m15.3.3.2.2.3" xref="S2.SS2.p5.15.m15.3.3.2.3.cmml">{</mo><msubsup id="S2.SS2.p5.15.m15.2.2.1.1.1" xref="S2.SS2.p5.15.m15.2.2.1.1.1.cmml"><mi id="S2.SS2.p5.15.m15.2.2.1.1.1.2.2" xref="S2.SS2.p5.15.m15.2.2.1.1.1.2.2.cmml">K</mi><mi id="S2.SS2.p5.15.m15.2.2.1.1.1.2.3" xref="S2.SS2.p5.15.m15.2.2.1.1.1.2.3.cmml">i</mi><mn id="S2.SS2.p5.15.m15.2.2.1.1.1.3" xref="S2.SS2.p5.15.m15.2.2.1.1.1.3.cmml">1</mn></msubsup><mo id="S2.SS2.p5.15.m15.3.3.2.2.4" xref="S2.SS2.p5.15.m15.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S2.SS2.p5.15.m15.1.1" xref="S2.SS2.p5.15.m15.1.1.cmml">…</mi><mo id="S2.SS2.p5.15.m15.3.3.2.2.5" xref="S2.SS2.p5.15.m15.3.3.2.3.cmml">,</mo><msubsup id="S2.SS2.p5.15.m15.3.3.2.2.2" xref="S2.SS2.p5.15.m15.3.3.2.2.2.cmml"><mi id="S2.SS2.p5.15.m15.3.3.2.2.2.2.2" xref="S2.SS2.p5.15.m15.3.3.2.2.2.2.2.cmml">K</mi><mi id="S2.SS2.p5.15.m15.3.3.2.2.2.2.3" xref="S2.SS2.p5.15.m15.3.3.2.2.2.2.3.cmml">i</mi><mi id="S2.SS2.p5.15.m15.3.3.2.2.2.3" xref="S2.SS2.p5.15.m15.3.3.2.2.2.3.cmml">L</mi></msubsup><mo stretchy="false" id="S2.SS2.p5.15.m15.3.3.2.2.6" xref="S2.SS2.p5.15.m15.3.3.2.3.cmml">}</mo></mrow><mo id="S2.SS2.p5.15.m15.3.3.6" xref="S2.SS2.p5.15.m15.3.3.6.cmml">∈</mo><msup id="S2.SS2.p5.15.m15.3.3.7" xref="S2.SS2.p5.15.m15.3.3.7.cmml"><mi id="S2.SS2.p5.15.m15.3.3.7.2" xref="S2.SS2.p5.15.m15.3.3.7.2.cmml">ℝ</mi><mrow id="S2.SS2.p5.15.m15.3.3.7.3" xref="S2.SS2.p5.15.m15.3.3.7.3.cmml"><mi id="S2.SS2.p5.15.m15.3.3.7.3.2" xref="S2.SS2.p5.15.m15.3.3.7.3.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S2.SS2.p5.15.m15.3.3.7.3.1" xref="S2.SS2.p5.15.m15.3.3.7.3.1.cmml">×</mo><mi id="S2.SS2.p5.15.m15.3.3.7.3.3" xref="S2.SS2.p5.15.m15.3.3.7.3.3.cmml">c</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.15.m15.3b"><apply id="S2.SS2.p5.15.m15.3.3.cmml" xref="S2.SS2.p5.15.m15.3.3"><and id="S2.SS2.p5.15.m15.3.3a.cmml" xref="S2.SS2.p5.15.m15.3.3"></and><apply id="S2.SS2.p5.15.m15.3.3b.cmml" xref="S2.SS2.p5.15.m15.3.3"><eq id="S2.SS2.p5.15.m15.3.3.5.cmml" xref="S2.SS2.p5.15.m15.3.3.5"></eq><apply id="S2.SS2.p5.15.m15.3.3.4.cmml" xref="S2.SS2.p5.15.m15.3.3.4"><csymbol cd="ambiguous" id="S2.SS2.p5.15.m15.3.3.4.1.cmml" xref="S2.SS2.p5.15.m15.3.3.4">subscript</csymbol><ci id="S2.SS2.p5.15.m15.3.3.4.2.cmml" xref="S2.SS2.p5.15.m15.3.3.4.2">𝐾</ci><ci id="S2.SS2.p5.15.m15.3.3.4.3.cmml" xref="S2.SS2.p5.15.m15.3.3.4.3">𝑖</ci></apply><set id="S2.SS2.p5.15.m15.3.3.2.3.cmml" xref="S2.SS2.p5.15.m15.3.3.2.2"><apply id="S2.SS2.p5.15.m15.2.2.1.1.1.cmml" xref="S2.SS2.p5.15.m15.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p5.15.m15.2.2.1.1.1.1.cmml" xref="S2.SS2.p5.15.m15.2.2.1.1.1">superscript</csymbol><apply id="S2.SS2.p5.15.m15.2.2.1.1.1.2.cmml" xref="S2.SS2.p5.15.m15.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p5.15.m15.2.2.1.1.1.2.1.cmml" xref="S2.SS2.p5.15.m15.2.2.1.1.1">subscript</csymbol><ci id="S2.SS2.p5.15.m15.2.2.1.1.1.2.2.cmml" xref="S2.SS2.p5.15.m15.2.2.1.1.1.2.2">𝐾</ci><ci id="S2.SS2.p5.15.m15.2.2.1.1.1.2.3.cmml" xref="S2.SS2.p5.15.m15.2.2.1.1.1.2.3">𝑖</ci></apply><cn type="integer" id="S2.SS2.p5.15.m15.2.2.1.1.1.3.cmml" xref="S2.SS2.p5.15.m15.2.2.1.1.1.3">1</cn></apply><ci id="S2.SS2.p5.15.m15.1.1.cmml" xref="S2.SS2.p5.15.m15.1.1">…</ci><apply id="S2.SS2.p5.15.m15.3.3.2.2.2.cmml" xref="S2.SS2.p5.15.m15.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p5.15.m15.3.3.2.2.2.1.cmml" xref="S2.SS2.p5.15.m15.3.3.2.2.2">superscript</csymbol><apply id="S2.SS2.p5.15.m15.3.3.2.2.2.2.cmml" xref="S2.SS2.p5.15.m15.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p5.15.m15.3.3.2.2.2.2.1.cmml" xref="S2.SS2.p5.15.m15.3.3.2.2.2">subscript</csymbol><ci id="S2.SS2.p5.15.m15.3.3.2.2.2.2.2.cmml" xref="S2.SS2.p5.15.m15.3.3.2.2.2.2.2">𝐾</ci><ci id="S2.SS2.p5.15.m15.3.3.2.2.2.2.3.cmml" xref="S2.SS2.p5.15.m15.3.3.2.2.2.2.3">𝑖</ci></apply><ci id="S2.SS2.p5.15.m15.3.3.2.2.2.3.cmml" xref="S2.SS2.p5.15.m15.3.3.2.2.2.3">𝐿</ci></apply></set></apply><apply id="S2.SS2.p5.15.m15.3.3c.cmml" xref="S2.SS2.p5.15.m15.3.3"><in id="S2.SS2.p5.15.m15.3.3.6.cmml" xref="S2.SS2.p5.15.m15.3.3.6"></in><share href="#S2.SS2.p5.15.m15.3.3.2.cmml" id="S2.SS2.p5.15.m15.3.3d.cmml" xref="S2.SS2.p5.15.m15.3.3"></share><apply id="S2.SS2.p5.15.m15.3.3.7.cmml" xref="S2.SS2.p5.15.m15.3.3.7"><csymbol cd="ambiguous" id="S2.SS2.p5.15.m15.3.3.7.1.cmml" xref="S2.SS2.p5.15.m15.3.3.7">superscript</csymbol><ci id="S2.SS2.p5.15.m15.3.3.7.2.cmml" xref="S2.SS2.p5.15.m15.3.3.7.2">ℝ</ci><apply id="S2.SS2.p5.15.m15.3.3.7.3.cmml" xref="S2.SS2.p5.15.m15.3.3.7.3"><times id="S2.SS2.p5.15.m15.3.3.7.3.1.cmml" xref="S2.SS2.p5.15.m15.3.3.7.3.1"></times><ci id="S2.SS2.p5.15.m15.3.3.7.3.2.cmml" xref="S2.SS2.p5.15.m15.3.3.7.3.2">𝑁</ci><ci id="S2.SS2.p5.15.m15.3.3.7.3.3.cmml" xref="S2.SS2.p5.15.m15.3.3.7.3.3">𝑐</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.15.m15.3c">K_{i}=\{K_{i}^{1},...,K_{i}^{L}\}\in\mathbb{R}^{N\times c}</annotation></semantics></math> and <math id="S2.SS2.p5.16.m16.3" class="ltx_Math" alttext="V_{i}=\{V_{i}^{1},...,V_{i}^{L}\}\in\mathbb{R}^{N\times c}" display="inline"><semantics id="S2.SS2.p5.16.m16.3a"><mrow id="S2.SS2.p5.16.m16.3.3" xref="S2.SS2.p5.16.m16.3.3.cmml"><msub id="S2.SS2.p5.16.m16.3.3.4" xref="S2.SS2.p5.16.m16.3.3.4.cmml"><mi id="S2.SS2.p5.16.m16.3.3.4.2" xref="S2.SS2.p5.16.m16.3.3.4.2.cmml">V</mi><mi id="S2.SS2.p5.16.m16.3.3.4.3" xref="S2.SS2.p5.16.m16.3.3.4.3.cmml">i</mi></msub><mo id="S2.SS2.p5.16.m16.3.3.5" xref="S2.SS2.p5.16.m16.3.3.5.cmml">=</mo><mrow id="S2.SS2.p5.16.m16.3.3.2.2" xref="S2.SS2.p5.16.m16.3.3.2.3.cmml"><mo stretchy="false" id="S2.SS2.p5.16.m16.3.3.2.2.3" xref="S2.SS2.p5.16.m16.3.3.2.3.cmml">{</mo><msubsup id="S2.SS2.p5.16.m16.2.2.1.1.1" xref="S2.SS2.p5.16.m16.2.2.1.1.1.cmml"><mi id="S2.SS2.p5.16.m16.2.2.1.1.1.2.2" xref="S2.SS2.p5.16.m16.2.2.1.1.1.2.2.cmml">V</mi><mi id="S2.SS2.p5.16.m16.2.2.1.1.1.2.3" xref="S2.SS2.p5.16.m16.2.2.1.1.1.2.3.cmml">i</mi><mn id="S2.SS2.p5.16.m16.2.2.1.1.1.3" xref="S2.SS2.p5.16.m16.2.2.1.1.1.3.cmml">1</mn></msubsup><mo id="S2.SS2.p5.16.m16.3.3.2.2.4" xref="S2.SS2.p5.16.m16.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S2.SS2.p5.16.m16.1.1" xref="S2.SS2.p5.16.m16.1.1.cmml">…</mi><mo id="S2.SS2.p5.16.m16.3.3.2.2.5" xref="S2.SS2.p5.16.m16.3.3.2.3.cmml">,</mo><msubsup id="S2.SS2.p5.16.m16.3.3.2.2.2" xref="S2.SS2.p5.16.m16.3.3.2.2.2.cmml"><mi id="S2.SS2.p5.16.m16.3.3.2.2.2.2.2" xref="S2.SS2.p5.16.m16.3.3.2.2.2.2.2.cmml">V</mi><mi id="S2.SS2.p5.16.m16.3.3.2.2.2.2.3" xref="S2.SS2.p5.16.m16.3.3.2.2.2.2.3.cmml">i</mi><mi id="S2.SS2.p5.16.m16.3.3.2.2.2.3" xref="S2.SS2.p5.16.m16.3.3.2.2.2.3.cmml">L</mi></msubsup><mo stretchy="false" id="S2.SS2.p5.16.m16.3.3.2.2.6" xref="S2.SS2.p5.16.m16.3.3.2.3.cmml">}</mo></mrow><mo id="S2.SS2.p5.16.m16.3.3.6" xref="S2.SS2.p5.16.m16.3.3.6.cmml">∈</mo><msup id="S2.SS2.p5.16.m16.3.3.7" xref="S2.SS2.p5.16.m16.3.3.7.cmml"><mi id="S2.SS2.p5.16.m16.3.3.7.2" xref="S2.SS2.p5.16.m16.3.3.7.2.cmml">ℝ</mi><mrow id="S2.SS2.p5.16.m16.3.3.7.3" xref="S2.SS2.p5.16.m16.3.3.7.3.cmml"><mi id="S2.SS2.p5.16.m16.3.3.7.3.2" xref="S2.SS2.p5.16.m16.3.3.7.3.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S2.SS2.p5.16.m16.3.3.7.3.1" xref="S2.SS2.p5.16.m16.3.3.7.3.1.cmml">×</mo><mi id="S2.SS2.p5.16.m16.3.3.7.3.3" xref="S2.SS2.p5.16.m16.3.3.7.3.3.cmml">c</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.16.m16.3b"><apply id="S2.SS2.p5.16.m16.3.3.cmml" xref="S2.SS2.p5.16.m16.3.3"><and id="S2.SS2.p5.16.m16.3.3a.cmml" xref="S2.SS2.p5.16.m16.3.3"></and><apply id="S2.SS2.p5.16.m16.3.3b.cmml" xref="S2.SS2.p5.16.m16.3.3"><eq id="S2.SS2.p5.16.m16.3.3.5.cmml" xref="S2.SS2.p5.16.m16.3.3.5"></eq><apply id="S2.SS2.p5.16.m16.3.3.4.cmml" xref="S2.SS2.p5.16.m16.3.3.4"><csymbol cd="ambiguous" id="S2.SS2.p5.16.m16.3.3.4.1.cmml" xref="S2.SS2.p5.16.m16.3.3.4">subscript</csymbol><ci id="S2.SS2.p5.16.m16.3.3.4.2.cmml" xref="S2.SS2.p5.16.m16.3.3.4.2">𝑉</ci><ci id="S2.SS2.p5.16.m16.3.3.4.3.cmml" xref="S2.SS2.p5.16.m16.3.3.4.3">𝑖</ci></apply><set id="S2.SS2.p5.16.m16.3.3.2.3.cmml" xref="S2.SS2.p5.16.m16.3.3.2.2"><apply id="S2.SS2.p5.16.m16.2.2.1.1.1.cmml" xref="S2.SS2.p5.16.m16.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p5.16.m16.2.2.1.1.1.1.cmml" xref="S2.SS2.p5.16.m16.2.2.1.1.1">superscript</csymbol><apply id="S2.SS2.p5.16.m16.2.2.1.1.1.2.cmml" xref="S2.SS2.p5.16.m16.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p5.16.m16.2.2.1.1.1.2.1.cmml" xref="S2.SS2.p5.16.m16.2.2.1.1.1">subscript</csymbol><ci id="S2.SS2.p5.16.m16.2.2.1.1.1.2.2.cmml" xref="S2.SS2.p5.16.m16.2.2.1.1.1.2.2">𝑉</ci><ci id="S2.SS2.p5.16.m16.2.2.1.1.1.2.3.cmml" xref="S2.SS2.p5.16.m16.2.2.1.1.1.2.3">𝑖</ci></apply><cn type="integer" id="S2.SS2.p5.16.m16.2.2.1.1.1.3.cmml" xref="S2.SS2.p5.16.m16.2.2.1.1.1.3">1</cn></apply><ci id="S2.SS2.p5.16.m16.1.1.cmml" xref="S2.SS2.p5.16.m16.1.1">…</ci><apply id="S2.SS2.p5.16.m16.3.3.2.2.2.cmml" xref="S2.SS2.p5.16.m16.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p5.16.m16.3.3.2.2.2.1.cmml" xref="S2.SS2.p5.16.m16.3.3.2.2.2">superscript</csymbol><apply id="S2.SS2.p5.16.m16.3.3.2.2.2.2.cmml" xref="S2.SS2.p5.16.m16.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p5.16.m16.3.3.2.2.2.2.1.cmml" xref="S2.SS2.p5.16.m16.3.3.2.2.2">subscript</csymbol><ci id="S2.SS2.p5.16.m16.3.3.2.2.2.2.2.cmml" xref="S2.SS2.p5.16.m16.3.3.2.2.2.2.2">𝑉</ci><ci id="S2.SS2.p5.16.m16.3.3.2.2.2.2.3.cmml" xref="S2.SS2.p5.16.m16.3.3.2.2.2.2.3">𝑖</ci></apply><ci id="S2.SS2.p5.16.m16.3.3.2.2.2.3.cmml" xref="S2.SS2.p5.16.m16.3.3.2.2.2.3">𝐿</ci></apply></set></apply><apply id="S2.SS2.p5.16.m16.3.3c.cmml" xref="S2.SS2.p5.16.m16.3.3"><in id="S2.SS2.p5.16.m16.3.3.6.cmml" xref="S2.SS2.p5.16.m16.3.3.6"></in><share href="#S2.SS2.p5.16.m16.3.3.2.cmml" id="S2.SS2.p5.16.m16.3.3d.cmml" xref="S2.SS2.p5.16.m16.3.3"></share><apply id="S2.SS2.p5.16.m16.3.3.7.cmml" xref="S2.SS2.p5.16.m16.3.3.7"><csymbol cd="ambiguous" id="S2.SS2.p5.16.m16.3.3.7.1.cmml" xref="S2.SS2.p5.16.m16.3.3.7">superscript</csymbol><ci id="S2.SS2.p5.16.m16.3.3.7.2.cmml" xref="S2.SS2.p5.16.m16.3.3.7.2">ℝ</ci><apply id="S2.SS2.p5.16.m16.3.3.7.3.cmml" xref="S2.SS2.p5.16.m16.3.3.7.3"><times id="S2.SS2.p5.16.m16.3.3.7.3.1.cmml" xref="S2.SS2.p5.16.m16.3.3.7.3.1"></times><ci id="S2.SS2.p5.16.m16.3.3.7.3.2.cmml" xref="S2.SS2.p5.16.m16.3.3.7.3.2">𝑁</ci><ci id="S2.SS2.p5.16.m16.3.3.7.3.3.cmml" xref="S2.SS2.p5.16.m16.3.3.7.3.3">𝑐</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.16.m16.3c">V_{i}=\{V_{i}^{1},...,V_{i}^{L}\}\in\mathbb{R}^{N\times c}</annotation></semantics></math>, where <math id="S2.SS2.p5.17.m17.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S2.SS2.p5.17.m17.1a"><mi id="S2.SS2.p5.17.m17.1.1" xref="S2.SS2.p5.17.m17.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.17.m17.1b"><ci id="S2.SS2.p5.17.m17.1.1.cmml" xref="S2.SS2.p5.17.m17.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.17.m17.1c">N</annotation></semantics></math> is the sum of DCFT region from all levels, i.e., <math id="S2.SS2.p5.18.m18.1" class="ltx_Math" alttext="N=\sum_{l=1}^{L}\left(N^{l}\right)^{2}" display="inline"><semantics id="S2.SS2.p5.18.m18.1a"><mrow id="S2.SS2.p5.18.m18.1.1" xref="S2.SS2.p5.18.m18.1.1.cmml"><mi id="S2.SS2.p5.18.m18.1.1.3" xref="S2.SS2.p5.18.m18.1.1.3.cmml">N</mi><mo rspace="0.111em" id="S2.SS2.p5.18.m18.1.1.2" xref="S2.SS2.p5.18.m18.1.1.2.cmml">=</mo><mrow id="S2.SS2.p5.18.m18.1.1.1" xref="S2.SS2.p5.18.m18.1.1.1.cmml"><msubsup id="S2.SS2.p5.18.m18.1.1.1.2" xref="S2.SS2.p5.18.m18.1.1.1.2.cmml"><mo rspace="0em" id="S2.SS2.p5.18.m18.1.1.1.2.2.2" xref="S2.SS2.p5.18.m18.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.SS2.p5.18.m18.1.1.1.2.2.3" xref="S2.SS2.p5.18.m18.1.1.1.2.2.3.cmml"><mi id="S2.SS2.p5.18.m18.1.1.1.2.2.3.2" xref="S2.SS2.p5.18.m18.1.1.1.2.2.3.2.cmml">l</mi><mo id="S2.SS2.p5.18.m18.1.1.1.2.2.3.1" xref="S2.SS2.p5.18.m18.1.1.1.2.2.3.1.cmml">=</mo><mn id="S2.SS2.p5.18.m18.1.1.1.2.2.3.3" xref="S2.SS2.p5.18.m18.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S2.SS2.p5.18.m18.1.1.1.2.3" xref="S2.SS2.p5.18.m18.1.1.1.2.3.cmml">L</mi></msubsup><msup id="S2.SS2.p5.18.m18.1.1.1.1" xref="S2.SS2.p5.18.m18.1.1.1.1.cmml"><mrow id="S2.SS2.p5.18.m18.1.1.1.1.1.1" xref="S2.SS2.p5.18.m18.1.1.1.1.1.1.1.cmml"><mo id="S2.SS2.p5.18.m18.1.1.1.1.1.1.2" xref="S2.SS2.p5.18.m18.1.1.1.1.1.1.1.cmml">(</mo><msup id="S2.SS2.p5.18.m18.1.1.1.1.1.1.1" xref="S2.SS2.p5.18.m18.1.1.1.1.1.1.1.cmml"><mi id="S2.SS2.p5.18.m18.1.1.1.1.1.1.1.2" xref="S2.SS2.p5.18.m18.1.1.1.1.1.1.1.2.cmml">N</mi><mi id="S2.SS2.p5.18.m18.1.1.1.1.1.1.1.3" xref="S2.SS2.p5.18.m18.1.1.1.1.1.1.1.3.cmml">l</mi></msup><mo id="S2.SS2.p5.18.m18.1.1.1.1.1.1.3" xref="S2.SS2.p5.18.m18.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S2.SS2.p5.18.m18.1.1.1.1.3" xref="S2.SS2.p5.18.m18.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.18.m18.1b"><apply id="S2.SS2.p5.18.m18.1.1.cmml" xref="S2.SS2.p5.18.m18.1.1"><eq id="S2.SS2.p5.18.m18.1.1.2.cmml" xref="S2.SS2.p5.18.m18.1.1.2"></eq><ci id="S2.SS2.p5.18.m18.1.1.3.cmml" xref="S2.SS2.p5.18.m18.1.1.3">𝑁</ci><apply id="S2.SS2.p5.18.m18.1.1.1.cmml" xref="S2.SS2.p5.18.m18.1.1.1"><apply id="S2.SS2.p5.18.m18.1.1.1.2.cmml" xref="S2.SS2.p5.18.m18.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p5.18.m18.1.1.1.2.1.cmml" xref="S2.SS2.p5.18.m18.1.1.1.2">superscript</csymbol><apply id="S2.SS2.p5.18.m18.1.1.1.2.2.cmml" xref="S2.SS2.p5.18.m18.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p5.18.m18.1.1.1.2.2.1.cmml" xref="S2.SS2.p5.18.m18.1.1.1.2">subscript</csymbol><sum id="S2.SS2.p5.18.m18.1.1.1.2.2.2.cmml" xref="S2.SS2.p5.18.m18.1.1.1.2.2.2"></sum><apply id="S2.SS2.p5.18.m18.1.1.1.2.2.3.cmml" xref="S2.SS2.p5.18.m18.1.1.1.2.2.3"><eq id="S2.SS2.p5.18.m18.1.1.1.2.2.3.1.cmml" xref="S2.SS2.p5.18.m18.1.1.1.2.2.3.1"></eq><ci id="S2.SS2.p5.18.m18.1.1.1.2.2.3.2.cmml" xref="S2.SS2.p5.18.m18.1.1.1.2.2.3.2">𝑙</ci><cn type="integer" id="S2.SS2.p5.18.m18.1.1.1.2.2.3.3.cmml" xref="S2.SS2.p5.18.m18.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S2.SS2.p5.18.m18.1.1.1.2.3.cmml" xref="S2.SS2.p5.18.m18.1.1.1.2.3">𝐿</ci></apply><apply id="S2.SS2.p5.18.m18.1.1.1.1.cmml" xref="S2.SS2.p5.18.m18.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p5.18.m18.1.1.1.1.2.cmml" xref="S2.SS2.p5.18.m18.1.1.1.1">superscript</csymbol><apply id="S2.SS2.p5.18.m18.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p5.18.m18.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p5.18.m18.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p5.18.m18.1.1.1.1.1.1">superscript</csymbol><ci id="S2.SS2.p5.18.m18.1.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p5.18.m18.1.1.1.1.1.1.1.2">𝑁</ci><ci id="S2.SS2.p5.18.m18.1.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p5.18.m18.1.1.1.1.1.1.1.3">𝑙</ci></apply><cn type="integer" id="S2.SS2.p5.18.m18.1.1.1.1.3.cmml" xref="S2.SS2.p5.18.m18.1.1.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.18.m18.1c">N=\sum_{l=1}^{L}\left(N^{l}\right)^{2}</annotation></semantics></math>. Finally, we follow <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> to introduce a relative position bias and compute the DCFT attention for <math id="S2.SS2.p5.19.m19.1" class="ltx_Math" alttext="Q_{i}" display="inline"><semantics id="S2.SS2.p5.19.m19.1a"><msub id="S2.SS2.p5.19.m19.1.1" xref="S2.SS2.p5.19.m19.1.1.cmml"><mi id="S2.SS2.p5.19.m19.1.1.2" xref="S2.SS2.p5.19.m19.1.1.2.cmml">Q</mi><mi id="S2.SS2.p5.19.m19.1.1.3" xref="S2.SS2.p5.19.m19.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.19.m19.1b"><apply id="S2.SS2.p5.19.m19.1.1.cmml" xref="S2.SS2.p5.19.m19.1.1"><csymbol cd="ambiguous" id="S2.SS2.p5.19.m19.1.1.1.cmml" xref="S2.SS2.p5.19.m19.1.1">subscript</csymbol><ci id="S2.SS2.p5.19.m19.1.1.2.cmml" xref="S2.SS2.p5.19.m19.1.1.2">𝑄</ci><ci id="S2.SS2.p5.19.m19.1.1.3.cmml" xref="S2.SS2.p5.19.m19.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.19.m19.1c">Q_{i}</annotation></semantics></math> by :</p>
</div>
<div id="S2.SS2.p6" class="ltx_para">
<table id="S2.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E2.m1.23" class="ltx_Math" alttext="\begin{split}\operatorname{Attention}\left(Q_{i},K_{i},V_{i}\right)=\operatorname{Softmax}\left(\frac{Q_{i}K_{i}^{T}}{\sqrt{c}}+B\right)V_{i},\end{split}" display="block"><semantics id="S2.E2.m1.23a"><mtable displaystyle="true" id="S2.E2.m1.23.23.2"><mtr id="S2.E2.m1.23.23.2a"><mtd class="ltx_align_right" columnalign="right" id="S2.E2.m1.23.23.2b"><mrow id="S2.E2.m1.23.23.2.22.22.22.22"><mrow id="S2.E2.m1.23.23.2.22.22.22.22.1"><mrow id="S2.E2.m1.23.23.2.22.22.22.22.1.3.3"><mi id="S2.E2.m1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.cmml">Attention</mi><mo id="S2.E2.m1.23.23.2.22.22.22.22.1.3.3a" xref="S2.E2.m1.22.22.1.1.1.cmml">⁡</mo><mrow id="S2.E2.m1.23.23.2.22.22.22.22.1.3.3.3"><mo id="S2.E2.m1.2.2.2.2.2.2" xref="S2.E2.m1.22.22.1.1.1.cmml">(</mo><msub id="S2.E2.m1.23.23.2.22.22.22.22.1.1.1.1.1"><mi id="S2.E2.m1.3.3.3.3.3.3" xref="S2.E2.m1.3.3.3.3.3.3.cmml">Q</mi><mi id="S2.E2.m1.4.4.4.4.4.4.1" xref="S2.E2.m1.4.4.4.4.4.4.1.cmml">i</mi></msub><mo id="S2.E2.m1.5.5.5.5.5.5" xref="S2.E2.m1.22.22.1.1.1.cmml">,</mo><msub id="S2.E2.m1.23.23.2.22.22.22.22.1.2.2.2.2"><mi id="S2.E2.m1.6.6.6.6.6.6" xref="S2.E2.m1.6.6.6.6.6.6.cmml">K</mi><mi id="S2.E2.m1.7.7.7.7.7.7.1" xref="S2.E2.m1.7.7.7.7.7.7.1.cmml">i</mi></msub><mo id="S2.E2.m1.8.8.8.8.8.8" xref="S2.E2.m1.22.22.1.1.1.cmml">,</mo><msub id="S2.E2.m1.23.23.2.22.22.22.22.1.3.3.3.3"><mi id="S2.E2.m1.9.9.9.9.9.9" xref="S2.E2.m1.9.9.9.9.9.9.cmml">V</mi><mi id="S2.E2.m1.10.10.10.10.10.10.1" xref="S2.E2.m1.10.10.10.10.10.10.1.cmml">i</mi></msub><mo id="S2.E2.m1.11.11.11.11.11.11" xref="S2.E2.m1.22.22.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.12.12.12.12.12.12" xref="S2.E2.m1.12.12.12.12.12.12.cmml">=</mo><mrow id="S2.E2.m1.23.23.2.22.22.22.22.1.4"><mrow id="S2.E2.m1.23.23.2.22.22.22.22.1.4.1.1"><mi id="S2.E2.m1.13.13.13.13.13.13" xref="S2.E2.m1.13.13.13.13.13.13.cmml">Softmax</mi><mo id="S2.E2.m1.23.23.2.22.22.22.22.1.4.1.1a" xref="S2.E2.m1.22.22.1.1.1.cmml">⁡</mo><mrow id="S2.E2.m1.23.23.2.22.22.22.22.1.4.1.1.1"><mo id="S2.E2.m1.14.14.14.14.14.14" xref="S2.E2.m1.22.22.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.23.23.2.22.22.22.22.1.4.1.1.1.1"><mfrac id="S2.E2.m1.15.15.15.15.15.15" xref="S2.E2.m1.15.15.15.15.15.15.cmml"><mrow id="S2.E2.m1.15.15.15.15.15.15.2" xref="S2.E2.m1.15.15.15.15.15.15.2.cmml"><msub id="S2.E2.m1.15.15.15.15.15.15.2.2" xref="S2.E2.m1.15.15.15.15.15.15.2.2.cmml"><mi id="S2.E2.m1.15.15.15.15.15.15.2.2.2" xref="S2.E2.m1.15.15.15.15.15.15.2.2.2.cmml">Q</mi><mi id="S2.E2.m1.15.15.15.15.15.15.2.2.3" xref="S2.E2.m1.15.15.15.15.15.15.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S2.E2.m1.15.15.15.15.15.15.2.1" xref="S2.E2.m1.15.15.15.15.15.15.2.1.cmml">​</mo><msubsup id="S2.E2.m1.15.15.15.15.15.15.2.3" xref="S2.E2.m1.15.15.15.15.15.15.2.3.cmml"><mi id="S2.E2.m1.15.15.15.15.15.15.2.3.2.2" xref="S2.E2.m1.15.15.15.15.15.15.2.3.2.2.cmml">K</mi><mi id="S2.E2.m1.15.15.15.15.15.15.2.3.2.3" xref="S2.E2.m1.15.15.15.15.15.15.2.3.2.3.cmml">i</mi><mi id="S2.E2.m1.15.15.15.15.15.15.2.3.3" xref="S2.E2.m1.15.15.15.15.15.15.2.3.3.cmml">T</mi></msubsup></mrow><msqrt id="S2.E2.m1.15.15.15.15.15.15.3" xref="S2.E2.m1.15.15.15.15.15.15.3.cmml"><mi id="S2.E2.m1.15.15.15.15.15.15.3.2" xref="S2.E2.m1.15.15.15.15.15.15.3.2.cmml">c</mi></msqrt></mfrac><mo id="S2.E2.m1.16.16.16.16.16.16" xref="S2.E2.m1.16.16.16.16.16.16.cmml">+</mo><mi id="S2.E2.m1.17.17.17.17.17.17" xref="S2.E2.m1.17.17.17.17.17.17.cmml">B</mi></mrow><mo id="S2.E2.m1.18.18.18.18.18.18" xref="S2.E2.m1.22.22.1.1.1.cmml">)</mo></mrow></mrow><mo lspace="0em" rspace="0em" id="S2.E2.m1.23.23.2.22.22.22.22.1.4.2" xref="S2.E2.m1.22.22.1.1.1.cmml">​</mo><msub id="S2.E2.m1.23.23.2.22.22.22.22.1.4.3"><mi id="S2.E2.m1.19.19.19.19.19.19" xref="S2.E2.m1.19.19.19.19.19.19.cmml">V</mi><mi id="S2.E2.m1.20.20.20.20.20.20.1" xref="S2.E2.m1.20.20.20.20.20.20.1.cmml">i</mi></msub></mrow></mrow><mo id="S2.E2.m1.21.21.21.21.21.21" xref="S2.E2.m1.22.22.1.1.1.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S2.E2.m1.23b"><apply id="S2.E2.m1.22.22.1.1.1.cmml" xref="S2.E2.m1.23.23.2.22.22.22.22.1.3.3a"><eq id="S2.E2.m1.12.12.12.12.12.12.cmml" xref="S2.E2.m1.12.12.12.12.12.12"></eq><apply id="S2.E2.m1.22.22.1.1.1.3.4.cmml" xref="S2.E2.m1.23.23.2.22.22.22.22.1.3.3a"><ci id="S2.E2.m1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1">Attention</ci><apply id="S2.E2.m1.22.22.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.23.23.2.22.22.22.22.1.3.3a"><csymbol cd="ambiguous" id="S2.E2.m1.22.22.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.23.23.2.22.22.22.22.1.3.3a">subscript</csymbol><ci id="S2.E2.m1.3.3.3.3.3.3.cmml" xref="S2.E2.m1.3.3.3.3.3.3">𝑄</ci><ci id="S2.E2.m1.4.4.4.4.4.4.1.cmml" xref="S2.E2.m1.4.4.4.4.4.4.1">𝑖</ci></apply><apply id="S2.E2.m1.22.22.1.1.1.2.2.2.2.cmml" xref="S2.E2.m1.23.23.2.22.22.22.22.1.3.3a"><csymbol cd="ambiguous" id="S2.E2.m1.22.22.1.1.1.2.2.2.2.1.cmml" xref="S2.E2.m1.23.23.2.22.22.22.22.1.3.3a">subscript</csymbol><ci id="S2.E2.m1.6.6.6.6.6.6.cmml" xref="S2.E2.m1.6.6.6.6.6.6">𝐾</ci><ci id="S2.E2.m1.7.7.7.7.7.7.1.cmml" xref="S2.E2.m1.7.7.7.7.7.7.1">𝑖</ci></apply><apply id="S2.E2.m1.22.22.1.1.1.3.3.3.3.cmml" xref="S2.E2.m1.23.23.2.22.22.22.22.1.3.3a"><csymbol cd="ambiguous" id="S2.E2.m1.22.22.1.1.1.3.3.3.3.1.cmml" xref="S2.E2.m1.23.23.2.22.22.22.22.1.3.3a">subscript</csymbol><ci id="S2.E2.m1.9.9.9.9.9.9.cmml" xref="S2.E2.m1.9.9.9.9.9.9">𝑉</ci><ci id="S2.E2.m1.10.10.10.10.10.10.1.cmml" xref="S2.E2.m1.10.10.10.10.10.10.1">𝑖</ci></apply></apply><apply id="S2.E2.m1.22.22.1.1.1.4.cmml" xref="S2.E2.m1.23.23.2.22.22.22.22.1.3.3a"><times id="S2.E2.m1.22.22.1.1.1.4.2.cmml" xref="S2.E2.m1.23.23.2.22.22.22.22.1.3.3a"></times><apply id="S2.E2.m1.22.22.1.1.1.4.1.2.cmml" xref="S2.E2.m1.23.23.2.22.22.22.22.1.3.3a"><ci id="S2.E2.m1.13.13.13.13.13.13.cmml" xref="S2.E2.m1.13.13.13.13.13.13">Softmax</ci><apply id="S2.E2.m1.22.22.1.1.1.4.1.1.1.1.cmml" xref="S2.E2.m1.23.23.2.22.22.22.22.1.3.3a"><plus id="S2.E2.m1.16.16.16.16.16.16.cmml" xref="S2.E2.m1.16.16.16.16.16.16"></plus><apply id="S2.E2.m1.15.15.15.15.15.15.cmml" xref="S2.E2.m1.15.15.15.15.15.15"><divide id="S2.E2.m1.15.15.15.15.15.15.1.cmml" xref="S2.E2.m1.15.15.15.15.15.15"></divide><apply id="S2.E2.m1.15.15.15.15.15.15.2.cmml" xref="S2.E2.m1.15.15.15.15.15.15.2"><times id="S2.E2.m1.15.15.15.15.15.15.2.1.cmml" xref="S2.E2.m1.15.15.15.15.15.15.2.1"></times><apply id="S2.E2.m1.15.15.15.15.15.15.2.2.cmml" xref="S2.E2.m1.15.15.15.15.15.15.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.15.15.15.15.15.15.2.2.1.cmml" xref="S2.E2.m1.15.15.15.15.15.15.2.2">subscript</csymbol><ci id="S2.E2.m1.15.15.15.15.15.15.2.2.2.cmml" xref="S2.E2.m1.15.15.15.15.15.15.2.2.2">𝑄</ci><ci id="S2.E2.m1.15.15.15.15.15.15.2.2.3.cmml" xref="S2.E2.m1.15.15.15.15.15.15.2.2.3">𝑖</ci></apply><apply id="S2.E2.m1.15.15.15.15.15.15.2.3.cmml" xref="S2.E2.m1.15.15.15.15.15.15.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.15.15.15.15.15.15.2.3.1.cmml" xref="S2.E2.m1.15.15.15.15.15.15.2.3">superscript</csymbol><apply id="S2.E2.m1.15.15.15.15.15.15.2.3.2.cmml" xref="S2.E2.m1.15.15.15.15.15.15.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.15.15.15.15.15.15.2.3.2.1.cmml" xref="S2.E2.m1.15.15.15.15.15.15.2.3">subscript</csymbol><ci id="S2.E2.m1.15.15.15.15.15.15.2.3.2.2.cmml" xref="S2.E2.m1.15.15.15.15.15.15.2.3.2.2">𝐾</ci><ci id="S2.E2.m1.15.15.15.15.15.15.2.3.2.3.cmml" xref="S2.E2.m1.15.15.15.15.15.15.2.3.2.3">𝑖</ci></apply><ci id="S2.E2.m1.15.15.15.15.15.15.2.3.3.cmml" xref="S2.E2.m1.15.15.15.15.15.15.2.3.3">𝑇</ci></apply></apply><apply id="S2.E2.m1.15.15.15.15.15.15.3.cmml" xref="S2.E2.m1.15.15.15.15.15.15.3"><root id="S2.E2.m1.15.15.15.15.15.15.3a.cmml" xref="S2.E2.m1.15.15.15.15.15.15.3"></root><ci id="S2.E2.m1.15.15.15.15.15.15.3.2.cmml" xref="S2.E2.m1.15.15.15.15.15.15.3.2">𝑐</ci></apply></apply><ci id="S2.E2.m1.17.17.17.17.17.17.cmml" xref="S2.E2.m1.17.17.17.17.17.17">𝐵</ci></apply></apply><apply id="S2.E2.m1.22.22.1.1.1.4.3.cmml" xref="S2.E2.m1.23.23.2.22.22.22.22.1.3.3a"><csymbol cd="ambiguous" id="S2.E2.m1.22.22.1.1.1.4.3.1.cmml" xref="S2.E2.m1.23.23.2.22.22.22.22.1.3.3a">subscript</csymbol><ci id="S2.E2.m1.19.19.19.19.19.19.cmml" xref="S2.E2.m1.19.19.19.19.19.19">𝑉</ci><ci id="S2.E2.m1.20.20.20.20.20.20.1.cmml" xref="S2.E2.m1.20.20.20.20.20.20.1">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.23c">\begin{split}\operatorname{Attention}\left(Q_{i},K_{i},V_{i}\right)=\operatorname{Softmax}\left(\frac{Q_{i}K_{i}^{T}}{\sqrt{c}}+B\right)V_{i},\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.p6.3" class="ltx_p">where <math id="S2.SS2.p6.1.m1.3" class="ltx_Math" alttext="B=\{B^{1},\ldots,B^{L}\}" display="inline"><semantics id="S2.SS2.p6.1.m1.3a"><mrow id="S2.SS2.p6.1.m1.3.3" xref="S2.SS2.p6.1.m1.3.3.cmml"><mi id="S2.SS2.p6.1.m1.3.3.4" xref="S2.SS2.p6.1.m1.3.3.4.cmml">B</mi><mo id="S2.SS2.p6.1.m1.3.3.3" xref="S2.SS2.p6.1.m1.3.3.3.cmml">=</mo><mrow id="S2.SS2.p6.1.m1.3.3.2.2" xref="S2.SS2.p6.1.m1.3.3.2.3.cmml"><mo stretchy="false" id="S2.SS2.p6.1.m1.3.3.2.2.3" xref="S2.SS2.p6.1.m1.3.3.2.3.cmml">{</mo><msup id="S2.SS2.p6.1.m1.2.2.1.1.1" xref="S2.SS2.p6.1.m1.2.2.1.1.1.cmml"><mi id="S2.SS2.p6.1.m1.2.2.1.1.1.2" xref="S2.SS2.p6.1.m1.2.2.1.1.1.2.cmml">B</mi><mn id="S2.SS2.p6.1.m1.2.2.1.1.1.3" xref="S2.SS2.p6.1.m1.2.2.1.1.1.3.cmml">1</mn></msup><mo id="S2.SS2.p6.1.m1.3.3.2.2.4" xref="S2.SS2.p6.1.m1.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S2.SS2.p6.1.m1.1.1" xref="S2.SS2.p6.1.m1.1.1.cmml">…</mi><mo id="S2.SS2.p6.1.m1.3.3.2.2.5" xref="S2.SS2.p6.1.m1.3.3.2.3.cmml">,</mo><msup id="S2.SS2.p6.1.m1.3.3.2.2.2" xref="S2.SS2.p6.1.m1.3.3.2.2.2.cmml"><mi id="S2.SS2.p6.1.m1.3.3.2.2.2.2" xref="S2.SS2.p6.1.m1.3.3.2.2.2.2.cmml">B</mi><mi id="S2.SS2.p6.1.m1.3.3.2.2.2.3" xref="S2.SS2.p6.1.m1.3.3.2.2.2.3.cmml">L</mi></msup><mo stretchy="false" id="S2.SS2.p6.1.m1.3.3.2.2.6" xref="S2.SS2.p6.1.m1.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p6.1.m1.3b"><apply id="S2.SS2.p6.1.m1.3.3.cmml" xref="S2.SS2.p6.1.m1.3.3"><eq id="S2.SS2.p6.1.m1.3.3.3.cmml" xref="S2.SS2.p6.1.m1.3.3.3"></eq><ci id="S2.SS2.p6.1.m1.3.3.4.cmml" xref="S2.SS2.p6.1.m1.3.3.4">𝐵</ci><set id="S2.SS2.p6.1.m1.3.3.2.3.cmml" xref="S2.SS2.p6.1.m1.3.3.2.2"><apply id="S2.SS2.p6.1.m1.2.2.1.1.1.cmml" xref="S2.SS2.p6.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p6.1.m1.2.2.1.1.1.1.cmml" xref="S2.SS2.p6.1.m1.2.2.1.1.1">superscript</csymbol><ci id="S2.SS2.p6.1.m1.2.2.1.1.1.2.cmml" xref="S2.SS2.p6.1.m1.2.2.1.1.1.2">𝐵</ci><cn type="integer" id="S2.SS2.p6.1.m1.2.2.1.1.1.3.cmml" xref="S2.SS2.p6.1.m1.2.2.1.1.1.3">1</cn></apply><ci id="S2.SS2.p6.1.m1.1.1.cmml" xref="S2.SS2.p6.1.m1.1.1">…</ci><apply id="S2.SS2.p6.1.m1.3.3.2.2.2.cmml" xref="S2.SS2.p6.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p6.1.m1.3.3.2.2.2.1.cmml" xref="S2.SS2.p6.1.m1.3.3.2.2.2">superscript</csymbol><ci id="S2.SS2.p6.1.m1.3.3.2.2.2.2.cmml" xref="S2.SS2.p6.1.m1.3.3.2.2.2.2">𝐵</ci><ci id="S2.SS2.p6.1.m1.3.3.2.2.2.3.cmml" xref="S2.SS2.p6.1.m1.3.3.2.2.2.3">𝐿</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p6.1.m1.3c">B=\{B^{1},\ldots,B^{L}\}</annotation></semantics></math> is the learnable relative position bias. Similar to <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>, we parameterize the bias <math id="S2.SS2.p6.2.m2.2" class="ltx_Math" alttext="B^{1}\in\mathbb{R}^{\left(2n_{wp}-1\right)\times\left(2n_{wp}-1\right)}" display="inline"><semantics id="S2.SS2.p6.2.m2.2a"><mrow id="S2.SS2.p6.2.m2.2.3" xref="S2.SS2.p6.2.m2.2.3.cmml"><msup id="S2.SS2.p6.2.m2.2.3.2" xref="S2.SS2.p6.2.m2.2.3.2.cmml"><mi id="S2.SS2.p6.2.m2.2.3.2.2" xref="S2.SS2.p6.2.m2.2.3.2.2.cmml">B</mi><mn id="S2.SS2.p6.2.m2.2.3.2.3" xref="S2.SS2.p6.2.m2.2.3.2.3.cmml">1</mn></msup><mo id="S2.SS2.p6.2.m2.2.3.1" xref="S2.SS2.p6.2.m2.2.3.1.cmml">∈</mo><msup id="S2.SS2.p6.2.m2.2.3.3" xref="S2.SS2.p6.2.m2.2.3.3.cmml"><mi id="S2.SS2.p6.2.m2.2.3.3.2" xref="S2.SS2.p6.2.m2.2.3.3.2.cmml">ℝ</mi><mrow id="S2.SS2.p6.2.m2.2.2.2" xref="S2.SS2.p6.2.m2.2.2.2.cmml"><mrow id="S2.SS2.p6.2.m2.1.1.1.1.1" xref="S2.SS2.p6.2.m2.1.1.1.1.1.1.cmml"><mo id="S2.SS2.p6.2.m2.1.1.1.1.1.2" xref="S2.SS2.p6.2.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p6.2.m2.1.1.1.1.1.1" xref="S2.SS2.p6.2.m2.1.1.1.1.1.1.cmml"><mrow id="S2.SS2.p6.2.m2.1.1.1.1.1.1.2" xref="S2.SS2.p6.2.m2.1.1.1.1.1.1.2.cmml"><mn id="S2.SS2.p6.2.m2.1.1.1.1.1.1.2.2" xref="S2.SS2.p6.2.m2.1.1.1.1.1.1.2.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S2.SS2.p6.2.m2.1.1.1.1.1.1.2.1" xref="S2.SS2.p6.2.m2.1.1.1.1.1.1.2.1.cmml">​</mo><msub id="S2.SS2.p6.2.m2.1.1.1.1.1.1.2.3" xref="S2.SS2.p6.2.m2.1.1.1.1.1.1.2.3.cmml"><mi id="S2.SS2.p6.2.m2.1.1.1.1.1.1.2.3.2" xref="S2.SS2.p6.2.m2.1.1.1.1.1.1.2.3.2.cmml">n</mi><mrow id="S2.SS2.p6.2.m2.1.1.1.1.1.1.2.3.3" xref="S2.SS2.p6.2.m2.1.1.1.1.1.1.2.3.3.cmml"><mi id="S2.SS2.p6.2.m2.1.1.1.1.1.1.2.3.3.2" xref="S2.SS2.p6.2.m2.1.1.1.1.1.1.2.3.3.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p6.2.m2.1.1.1.1.1.1.2.3.3.1" xref="S2.SS2.p6.2.m2.1.1.1.1.1.1.2.3.3.1.cmml">​</mo><mi id="S2.SS2.p6.2.m2.1.1.1.1.1.1.2.3.3.3" xref="S2.SS2.p6.2.m2.1.1.1.1.1.1.2.3.3.3.cmml">p</mi></mrow></msub></mrow><mo id="S2.SS2.p6.2.m2.1.1.1.1.1.1.1" xref="S2.SS2.p6.2.m2.1.1.1.1.1.1.1.cmml">−</mo><mn id="S2.SS2.p6.2.m2.1.1.1.1.1.1.3" xref="S2.SS2.p6.2.m2.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo rspace="0.055em" id="S2.SS2.p6.2.m2.1.1.1.1.1.3" xref="S2.SS2.p6.2.m2.1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S2.SS2.p6.2.m2.2.2.2.3" xref="S2.SS2.p6.2.m2.2.2.2.3.cmml">×</mo><mrow id="S2.SS2.p6.2.m2.2.2.2.2.1" xref="S2.SS2.p6.2.m2.2.2.2.2.1.1.cmml"><mo id="S2.SS2.p6.2.m2.2.2.2.2.1.2" xref="S2.SS2.p6.2.m2.2.2.2.2.1.1.cmml">(</mo><mrow id="S2.SS2.p6.2.m2.2.2.2.2.1.1" xref="S2.SS2.p6.2.m2.2.2.2.2.1.1.cmml"><mrow id="S2.SS2.p6.2.m2.2.2.2.2.1.1.2" xref="S2.SS2.p6.2.m2.2.2.2.2.1.1.2.cmml"><mn id="S2.SS2.p6.2.m2.2.2.2.2.1.1.2.2" xref="S2.SS2.p6.2.m2.2.2.2.2.1.1.2.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S2.SS2.p6.2.m2.2.2.2.2.1.1.2.1" xref="S2.SS2.p6.2.m2.2.2.2.2.1.1.2.1.cmml">​</mo><msub id="S2.SS2.p6.2.m2.2.2.2.2.1.1.2.3" xref="S2.SS2.p6.2.m2.2.2.2.2.1.1.2.3.cmml"><mi id="S2.SS2.p6.2.m2.2.2.2.2.1.1.2.3.2" xref="S2.SS2.p6.2.m2.2.2.2.2.1.1.2.3.2.cmml">n</mi><mrow id="S2.SS2.p6.2.m2.2.2.2.2.1.1.2.3.3" xref="S2.SS2.p6.2.m2.2.2.2.2.1.1.2.3.3.cmml"><mi id="S2.SS2.p6.2.m2.2.2.2.2.1.1.2.3.3.2" xref="S2.SS2.p6.2.m2.2.2.2.2.1.1.2.3.3.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p6.2.m2.2.2.2.2.1.1.2.3.3.1" xref="S2.SS2.p6.2.m2.2.2.2.2.1.1.2.3.3.1.cmml">​</mo><mi id="S2.SS2.p6.2.m2.2.2.2.2.1.1.2.3.3.3" xref="S2.SS2.p6.2.m2.2.2.2.2.1.1.2.3.3.3.cmml">p</mi></mrow></msub></mrow><mo id="S2.SS2.p6.2.m2.2.2.2.2.1.1.1" xref="S2.SS2.p6.2.m2.2.2.2.2.1.1.1.cmml">−</mo><mn id="S2.SS2.p6.2.m2.2.2.2.2.1.1.3" xref="S2.SS2.p6.2.m2.2.2.2.2.1.1.3.cmml">1</mn></mrow><mo id="S2.SS2.p6.2.m2.2.2.2.2.1.3" xref="S2.SS2.p6.2.m2.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p6.2.m2.2b"><apply id="S2.SS2.p6.2.m2.2.3.cmml" xref="S2.SS2.p6.2.m2.2.3"><in id="S2.SS2.p6.2.m2.2.3.1.cmml" xref="S2.SS2.p6.2.m2.2.3.1"></in><apply id="S2.SS2.p6.2.m2.2.3.2.cmml" xref="S2.SS2.p6.2.m2.2.3.2"><csymbol cd="ambiguous" id="S2.SS2.p6.2.m2.2.3.2.1.cmml" xref="S2.SS2.p6.2.m2.2.3.2">superscript</csymbol><ci id="S2.SS2.p6.2.m2.2.3.2.2.cmml" xref="S2.SS2.p6.2.m2.2.3.2.2">𝐵</ci><cn type="integer" id="S2.SS2.p6.2.m2.2.3.2.3.cmml" xref="S2.SS2.p6.2.m2.2.3.2.3">1</cn></apply><apply id="S2.SS2.p6.2.m2.2.3.3.cmml" xref="S2.SS2.p6.2.m2.2.3.3"><csymbol cd="ambiguous" id="S2.SS2.p6.2.m2.2.3.3.1.cmml" xref="S2.SS2.p6.2.m2.2.3.3">superscript</csymbol><ci id="S2.SS2.p6.2.m2.2.3.3.2.cmml" xref="S2.SS2.p6.2.m2.2.3.3.2">ℝ</ci><apply id="S2.SS2.p6.2.m2.2.2.2.cmml" xref="S2.SS2.p6.2.m2.2.2.2"><times id="S2.SS2.p6.2.m2.2.2.2.3.cmml" xref="S2.SS2.p6.2.m2.2.2.2.3"></times><apply id="S2.SS2.p6.2.m2.1.1.1.1.1.1.cmml" xref="S2.SS2.p6.2.m2.1.1.1.1.1"><minus id="S2.SS2.p6.2.m2.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p6.2.m2.1.1.1.1.1.1.1"></minus><apply id="S2.SS2.p6.2.m2.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p6.2.m2.1.1.1.1.1.1.2"><times id="S2.SS2.p6.2.m2.1.1.1.1.1.1.2.1.cmml" xref="S2.SS2.p6.2.m2.1.1.1.1.1.1.2.1"></times><cn type="integer" id="S2.SS2.p6.2.m2.1.1.1.1.1.1.2.2.cmml" xref="S2.SS2.p6.2.m2.1.1.1.1.1.1.2.2">2</cn><apply id="S2.SS2.p6.2.m2.1.1.1.1.1.1.2.3.cmml" xref="S2.SS2.p6.2.m2.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.SS2.p6.2.m2.1.1.1.1.1.1.2.3.1.cmml" xref="S2.SS2.p6.2.m2.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S2.SS2.p6.2.m2.1.1.1.1.1.1.2.3.2.cmml" xref="S2.SS2.p6.2.m2.1.1.1.1.1.1.2.3.2">𝑛</ci><apply id="S2.SS2.p6.2.m2.1.1.1.1.1.1.2.3.3.cmml" xref="S2.SS2.p6.2.m2.1.1.1.1.1.1.2.3.3"><times id="S2.SS2.p6.2.m2.1.1.1.1.1.1.2.3.3.1.cmml" xref="S2.SS2.p6.2.m2.1.1.1.1.1.1.2.3.3.1"></times><ci id="S2.SS2.p6.2.m2.1.1.1.1.1.1.2.3.3.2.cmml" xref="S2.SS2.p6.2.m2.1.1.1.1.1.1.2.3.3.2">𝑤</ci><ci id="S2.SS2.p6.2.m2.1.1.1.1.1.1.2.3.3.3.cmml" xref="S2.SS2.p6.2.m2.1.1.1.1.1.1.2.3.3.3">𝑝</ci></apply></apply></apply><cn type="integer" id="S2.SS2.p6.2.m2.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p6.2.m2.1.1.1.1.1.1.3">1</cn></apply><apply id="S2.SS2.p6.2.m2.2.2.2.2.1.1.cmml" xref="S2.SS2.p6.2.m2.2.2.2.2.1"><minus id="S2.SS2.p6.2.m2.2.2.2.2.1.1.1.cmml" xref="S2.SS2.p6.2.m2.2.2.2.2.1.1.1"></minus><apply id="S2.SS2.p6.2.m2.2.2.2.2.1.1.2.cmml" xref="S2.SS2.p6.2.m2.2.2.2.2.1.1.2"><times id="S2.SS2.p6.2.m2.2.2.2.2.1.1.2.1.cmml" xref="S2.SS2.p6.2.m2.2.2.2.2.1.1.2.1"></times><cn type="integer" id="S2.SS2.p6.2.m2.2.2.2.2.1.1.2.2.cmml" xref="S2.SS2.p6.2.m2.2.2.2.2.1.1.2.2">2</cn><apply id="S2.SS2.p6.2.m2.2.2.2.2.1.1.2.3.cmml" xref="S2.SS2.p6.2.m2.2.2.2.2.1.1.2.3"><csymbol cd="ambiguous" id="S2.SS2.p6.2.m2.2.2.2.2.1.1.2.3.1.cmml" xref="S2.SS2.p6.2.m2.2.2.2.2.1.1.2.3">subscript</csymbol><ci id="S2.SS2.p6.2.m2.2.2.2.2.1.1.2.3.2.cmml" xref="S2.SS2.p6.2.m2.2.2.2.2.1.1.2.3.2">𝑛</ci><apply id="S2.SS2.p6.2.m2.2.2.2.2.1.1.2.3.3.cmml" xref="S2.SS2.p6.2.m2.2.2.2.2.1.1.2.3.3"><times id="S2.SS2.p6.2.m2.2.2.2.2.1.1.2.3.3.1.cmml" xref="S2.SS2.p6.2.m2.2.2.2.2.1.1.2.3.3.1"></times><ci id="S2.SS2.p6.2.m2.2.2.2.2.1.1.2.3.3.2.cmml" xref="S2.SS2.p6.2.m2.2.2.2.2.1.1.2.3.3.2">𝑤</ci><ci id="S2.SS2.p6.2.m2.2.2.2.2.1.1.2.3.3.3.cmml" xref="S2.SS2.p6.2.m2.2.2.2.2.1.1.2.3.3.3">𝑝</ci></apply></apply></apply><cn type="integer" id="S2.SS2.p6.2.m2.2.2.2.2.1.1.3.cmml" xref="S2.SS2.p6.2.m2.2.2.2.2.1.1.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p6.2.m2.2c">B^{1}\in\mathbb{R}^{\left(2n_{wp}-1\right)\times\left(2n_{wp}-1\right)}</annotation></semantics></math> in the first level, since the relative position along the horizontal and vertical axis are both lies in <math id="S2.SS2.p6.3.m3.2" class="ltx_Math" alttext="[-n_{wp}+1,n_{wp}-1]" display="inline"><semantics id="S2.SS2.p6.3.m3.2a"><mrow id="S2.SS2.p6.3.m3.2.2.2" xref="S2.SS2.p6.3.m3.2.2.3.cmml"><mo stretchy="false" id="S2.SS2.p6.3.m3.2.2.2.3" xref="S2.SS2.p6.3.m3.2.2.3.cmml">[</mo><mrow id="S2.SS2.p6.3.m3.1.1.1.1" xref="S2.SS2.p6.3.m3.1.1.1.1.cmml"><mrow id="S2.SS2.p6.3.m3.1.1.1.1.2" xref="S2.SS2.p6.3.m3.1.1.1.1.2.cmml"><mo id="S2.SS2.p6.3.m3.1.1.1.1.2a" xref="S2.SS2.p6.3.m3.1.1.1.1.2.cmml">−</mo><msub id="S2.SS2.p6.3.m3.1.1.1.1.2.2" xref="S2.SS2.p6.3.m3.1.1.1.1.2.2.cmml"><mi id="S2.SS2.p6.3.m3.1.1.1.1.2.2.2" xref="S2.SS2.p6.3.m3.1.1.1.1.2.2.2.cmml">n</mi><mrow id="S2.SS2.p6.3.m3.1.1.1.1.2.2.3" xref="S2.SS2.p6.3.m3.1.1.1.1.2.2.3.cmml"><mi id="S2.SS2.p6.3.m3.1.1.1.1.2.2.3.2" xref="S2.SS2.p6.3.m3.1.1.1.1.2.2.3.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p6.3.m3.1.1.1.1.2.2.3.1" xref="S2.SS2.p6.3.m3.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="S2.SS2.p6.3.m3.1.1.1.1.2.2.3.3" xref="S2.SS2.p6.3.m3.1.1.1.1.2.2.3.3.cmml">p</mi></mrow></msub></mrow><mo id="S2.SS2.p6.3.m3.1.1.1.1.1" xref="S2.SS2.p6.3.m3.1.1.1.1.1.cmml">+</mo><mn id="S2.SS2.p6.3.m3.1.1.1.1.3" xref="S2.SS2.p6.3.m3.1.1.1.1.3.cmml">1</mn></mrow><mo id="S2.SS2.p6.3.m3.2.2.2.4" xref="S2.SS2.p6.3.m3.2.2.3.cmml">,</mo><mrow id="S2.SS2.p6.3.m3.2.2.2.2" xref="S2.SS2.p6.3.m3.2.2.2.2.cmml"><msub id="S2.SS2.p6.3.m3.2.2.2.2.2" xref="S2.SS2.p6.3.m3.2.2.2.2.2.cmml"><mi id="S2.SS2.p6.3.m3.2.2.2.2.2.2" xref="S2.SS2.p6.3.m3.2.2.2.2.2.2.cmml">n</mi><mrow id="S2.SS2.p6.3.m3.2.2.2.2.2.3" xref="S2.SS2.p6.3.m3.2.2.2.2.2.3.cmml"><mi id="S2.SS2.p6.3.m3.2.2.2.2.2.3.2" xref="S2.SS2.p6.3.m3.2.2.2.2.2.3.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p6.3.m3.2.2.2.2.2.3.1" xref="S2.SS2.p6.3.m3.2.2.2.2.2.3.1.cmml">​</mo><mi id="S2.SS2.p6.3.m3.2.2.2.2.2.3.3" xref="S2.SS2.p6.3.m3.2.2.2.2.2.3.3.cmml">p</mi></mrow></msub><mo id="S2.SS2.p6.3.m3.2.2.2.2.1" xref="S2.SS2.p6.3.m3.2.2.2.2.1.cmml">−</mo><mn id="S2.SS2.p6.3.m3.2.2.2.2.3" xref="S2.SS2.p6.3.m3.2.2.2.2.3.cmml">1</mn></mrow><mo stretchy="false" id="S2.SS2.p6.3.m3.2.2.2.5" xref="S2.SS2.p6.3.m3.2.2.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p6.3.m3.2b"><interval closure="closed" id="S2.SS2.p6.3.m3.2.2.3.cmml" xref="S2.SS2.p6.3.m3.2.2.2"><apply id="S2.SS2.p6.3.m3.1.1.1.1.cmml" xref="S2.SS2.p6.3.m3.1.1.1.1"><plus id="S2.SS2.p6.3.m3.1.1.1.1.1.cmml" xref="S2.SS2.p6.3.m3.1.1.1.1.1"></plus><apply id="S2.SS2.p6.3.m3.1.1.1.1.2.cmml" xref="S2.SS2.p6.3.m3.1.1.1.1.2"><minus id="S2.SS2.p6.3.m3.1.1.1.1.2.1.cmml" xref="S2.SS2.p6.3.m3.1.1.1.1.2"></minus><apply id="S2.SS2.p6.3.m3.1.1.1.1.2.2.cmml" xref="S2.SS2.p6.3.m3.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.p6.3.m3.1.1.1.1.2.2.1.cmml" xref="S2.SS2.p6.3.m3.1.1.1.1.2.2">subscript</csymbol><ci id="S2.SS2.p6.3.m3.1.1.1.1.2.2.2.cmml" xref="S2.SS2.p6.3.m3.1.1.1.1.2.2.2">𝑛</ci><apply id="S2.SS2.p6.3.m3.1.1.1.1.2.2.3.cmml" xref="S2.SS2.p6.3.m3.1.1.1.1.2.2.3"><times id="S2.SS2.p6.3.m3.1.1.1.1.2.2.3.1.cmml" xref="S2.SS2.p6.3.m3.1.1.1.1.2.2.3.1"></times><ci id="S2.SS2.p6.3.m3.1.1.1.1.2.2.3.2.cmml" xref="S2.SS2.p6.3.m3.1.1.1.1.2.2.3.2">𝑤</ci><ci id="S2.SS2.p6.3.m3.1.1.1.1.2.2.3.3.cmml" xref="S2.SS2.p6.3.m3.1.1.1.1.2.2.3.3">𝑝</ci></apply></apply></apply><cn type="integer" id="S2.SS2.p6.3.m3.1.1.1.1.3.cmml" xref="S2.SS2.p6.3.m3.1.1.1.1.3">1</cn></apply><apply id="S2.SS2.p6.3.m3.2.2.2.2.cmml" xref="S2.SS2.p6.3.m3.2.2.2.2"><minus id="S2.SS2.p6.3.m3.2.2.2.2.1.cmml" xref="S2.SS2.p6.3.m3.2.2.2.2.1"></minus><apply id="S2.SS2.p6.3.m3.2.2.2.2.2.cmml" xref="S2.SS2.p6.3.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p6.3.m3.2.2.2.2.2.1.cmml" xref="S2.SS2.p6.3.m3.2.2.2.2.2">subscript</csymbol><ci id="S2.SS2.p6.3.m3.2.2.2.2.2.2.cmml" xref="S2.SS2.p6.3.m3.2.2.2.2.2.2">𝑛</ci><apply id="S2.SS2.p6.3.m3.2.2.2.2.2.3.cmml" xref="S2.SS2.p6.3.m3.2.2.2.2.2.3"><times id="S2.SS2.p6.3.m3.2.2.2.2.2.3.1.cmml" xref="S2.SS2.p6.3.m3.2.2.2.2.2.3.1"></times><ci id="S2.SS2.p6.3.m3.2.2.2.2.2.3.2.cmml" xref="S2.SS2.p6.3.m3.2.2.2.2.2.3.2">𝑤</ci><ci id="S2.SS2.p6.3.m3.2.2.2.2.2.3.3.cmml" xref="S2.SS2.p6.3.m3.2.2.2.2.2.3.3">𝑝</ci></apply></apply><cn type="integer" id="S2.SS2.p6.3.m3.2.2.2.2.3.cmml" xref="S2.SS2.p6.3.m3.2.2.2.2.3">1</cn></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p6.3.m3.2c">[-n_{wp}+1,n_{wp}-1]</annotation></semantics></math>. After obtaining the attention scores of the feature map, we send the scores to the LayerNorm and Multi-Layer Perceptron (MLP) blocks.</p>
</div>
<div id="S2.SS2.p7" class="ltx_para">
<p id="S2.SS2.p7.4" class="ltx_p">The overall computational cost of our DCFT attention becomes <math id="S2.SS2.p7.1.m1.1" class="ltx_Math" alttext="\mathcal{O}\left(\left(L+{\textstyle\sum_{l}}\left(n^{l}\right)^{2}\right)(HW)c\right)" display="inline"><semantics id="S2.SS2.p7.1.m1.1a"><mrow id="S2.SS2.p7.1.m1.1.1" xref="S2.SS2.p7.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p7.1.m1.1.1.3" xref="S2.SS2.p7.1.m1.1.1.3.cmml">𝒪</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p7.1.m1.1.1.2" xref="S2.SS2.p7.1.m1.1.1.2.cmml">​</mo><mrow id="S2.SS2.p7.1.m1.1.1.1.1" xref="S2.SS2.p7.1.m1.1.1.1.1.1.cmml"><mo id="S2.SS2.p7.1.m1.1.1.1.1.2" xref="S2.SS2.p7.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p7.1.m1.1.1.1.1.1" xref="S2.SS2.p7.1.m1.1.1.1.1.1.cmml"><mrow id="S2.SS2.p7.1.m1.1.1.1.1.1.1.1" xref="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.2" xref="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1" xref="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.3" xref="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.3.cmml">L</mi><mo rspace="0.055em" id="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.2" xref="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.2.cmml">+</mo><mrow id="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.1" xref="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.1.2" xref="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mo rspace="0em" id="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">∑</mo><mi id="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">l</mi></msub><msup id="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.1.1" xref="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">n</mi><mi id="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">l</mi></msup><mo id="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow><mo id="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.3" xref="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.SS2.p7.1.m1.1.1.1.1.1.3" xref="S2.SS2.p7.1.m1.1.1.1.1.1.3.cmml">​</mo><mrow id="S2.SS2.p7.1.m1.1.1.1.1.1.2.1" xref="S2.SS2.p7.1.m1.1.1.1.1.1.2.1.1.cmml"><mo stretchy="false" id="S2.SS2.p7.1.m1.1.1.1.1.1.2.1.2" xref="S2.SS2.p7.1.m1.1.1.1.1.1.2.1.1.cmml">(</mo><mrow id="S2.SS2.p7.1.m1.1.1.1.1.1.2.1.1" xref="S2.SS2.p7.1.m1.1.1.1.1.1.2.1.1.cmml"><mi id="S2.SS2.p7.1.m1.1.1.1.1.1.2.1.1.2" xref="S2.SS2.p7.1.m1.1.1.1.1.1.2.1.1.2.cmml">H</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p7.1.m1.1.1.1.1.1.2.1.1.1" xref="S2.SS2.p7.1.m1.1.1.1.1.1.2.1.1.1.cmml">​</mo><mi id="S2.SS2.p7.1.m1.1.1.1.1.1.2.1.1.3" xref="S2.SS2.p7.1.m1.1.1.1.1.1.2.1.1.3.cmml">W</mi></mrow><mo stretchy="false" id="S2.SS2.p7.1.m1.1.1.1.1.1.2.1.3" xref="S2.SS2.p7.1.m1.1.1.1.1.1.2.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.SS2.p7.1.m1.1.1.1.1.1.3a" xref="S2.SS2.p7.1.m1.1.1.1.1.1.3.cmml">​</mo><mi id="S2.SS2.p7.1.m1.1.1.1.1.1.4" xref="S2.SS2.p7.1.m1.1.1.1.1.1.4.cmml">c</mi></mrow><mo id="S2.SS2.p7.1.m1.1.1.1.1.3" xref="S2.SS2.p7.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p7.1.m1.1b"><apply id="S2.SS2.p7.1.m1.1.1.cmml" xref="S2.SS2.p7.1.m1.1.1"><times id="S2.SS2.p7.1.m1.1.1.2.cmml" xref="S2.SS2.p7.1.m1.1.1.2"></times><ci id="S2.SS2.p7.1.m1.1.1.3.cmml" xref="S2.SS2.p7.1.m1.1.1.3">𝒪</ci><apply id="S2.SS2.p7.1.m1.1.1.1.1.1.cmml" xref="S2.SS2.p7.1.m1.1.1.1.1"><times id="S2.SS2.p7.1.m1.1.1.1.1.1.3.cmml" xref="S2.SS2.p7.1.m1.1.1.1.1.1.3"></times><apply id="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p7.1.m1.1.1.1.1.1.1.1"><plus id="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.2"></plus><ci id="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.3">𝐿</ci><apply id="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.1"><apply id="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><sum id="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.1.2.2"></sum><ci id="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.1.2.3">𝑙</ci></apply><apply id="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑛</ci><ci id="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑙</ci></apply><cn type="integer" id="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.1.1.1.3">2</cn></apply></apply></apply><apply id="S2.SS2.p7.1.m1.1.1.1.1.1.2.1.1.cmml" xref="S2.SS2.p7.1.m1.1.1.1.1.1.2.1"><times id="S2.SS2.p7.1.m1.1.1.1.1.1.2.1.1.1.cmml" xref="S2.SS2.p7.1.m1.1.1.1.1.1.2.1.1.1"></times><ci id="S2.SS2.p7.1.m1.1.1.1.1.1.2.1.1.2.cmml" xref="S2.SS2.p7.1.m1.1.1.1.1.1.2.1.1.2">𝐻</ci><ci id="S2.SS2.p7.1.m1.1.1.1.1.1.2.1.1.3.cmml" xref="S2.SS2.p7.1.m1.1.1.1.1.1.2.1.1.3">𝑊</ci></apply><ci id="S2.SS2.p7.1.m1.1.1.1.1.1.4.cmml" xref="S2.SS2.p7.1.m1.1.1.1.1.1.4">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p7.1.m1.1c">\mathcal{O}\left(\left(L+{\textstyle\sum_{l}}\left(n^{l}\right)^{2}\right)(HW)c\right)</annotation></semantics></math>, while the computational cost of original ViT and Swin Transformer are <math id="S2.SS2.p7.2.m2.1" class="ltx_Math" alttext="\mathcal{O}\left(\left(4c+2HW\right)(HW)c\right)" display="inline"><semantics id="S2.SS2.p7.2.m2.1a"><mrow id="S2.SS2.p7.2.m2.1.1" xref="S2.SS2.p7.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p7.2.m2.1.1.3" xref="S2.SS2.p7.2.m2.1.1.3.cmml">𝒪</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p7.2.m2.1.1.2" xref="S2.SS2.p7.2.m2.1.1.2.cmml">​</mo><mrow id="S2.SS2.p7.2.m2.1.1.1.1" xref="S2.SS2.p7.2.m2.1.1.1.1.1.cmml"><mo id="S2.SS2.p7.2.m2.1.1.1.1.2" xref="S2.SS2.p7.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p7.2.m2.1.1.1.1.1" xref="S2.SS2.p7.2.m2.1.1.1.1.1.cmml"><mrow id="S2.SS2.p7.2.m2.1.1.1.1.1.1.1" xref="S2.SS2.p7.2.m2.1.1.1.1.1.1.1.1.cmml"><mo id="S2.SS2.p7.2.m2.1.1.1.1.1.1.1.2" xref="S2.SS2.p7.2.m2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p7.2.m2.1.1.1.1.1.1.1.1" xref="S2.SS2.p7.2.m2.1.1.1.1.1.1.1.1.cmml"><mrow id="S2.SS2.p7.2.m2.1.1.1.1.1.1.1.1.2" xref="S2.SS2.p7.2.m2.1.1.1.1.1.1.1.1.2.cmml"><mn id="S2.SS2.p7.2.m2.1.1.1.1.1.1.1.1.2.2" xref="S2.SS2.p7.2.m2.1.1.1.1.1.1.1.1.2.2.cmml">4</mn><mo lspace="0em" rspace="0em" id="S2.SS2.p7.2.m2.1.1.1.1.1.1.1.1.2.1" xref="S2.SS2.p7.2.m2.1.1.1.1.1.1.1.1.2.1.cmml">​</mo><mi id="S2.SS2.p7.2.m2.1.1.1.1.1.1.1.1.2.3" xref="S2.SS2.p7.2.m2.1.1.1.1.1.1.1.1.2.3.cmml">c</mi></mrow><mo id="S2.SS2.p7.2.m2.1.1.1.1.1.1.1.1.1" xref="S2.SS2.p7.2.m2.1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S2.SS2.p7.2.m2.1.1.1.1.1.1.1.1.3" xref="S2.SS2.p7.2.m2.1.1.1.1.1.1.1.1.3.cmml"><mn id="S2.SS2.p7.2.m2.1.1.1.1.1.1.1.1.3.2" xref="S2.SS2.p7.2.m2.1.1.1.1.1.1.1.1.3.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S2.SS2.p7.2.m2.1.1.1.1.1.1.1.1.3.1" xref="S2.SS2.p7.2.m2.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S2.SS2.p7.2.m2.1.1.1.1.1.1.1.1.3.3" xref="S2.SS2.p7.2.m2.1.1.1.1.1.1.1.1.3.3.cmml">H</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p7.2.m2.1.1.1.1.1.1.1.1.3.1a" xref="S2.SS2.p7.2.m2.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S2.SS2.p7.2.m2.1.1.1.1.1.1.1.1.3.4" xref="S2.SS2.p7.2.m2.1.1.1.1.1.1.1.1.3.4.cmml">W</mi></mrow></mrow><mo id="S2.SS2.p7.2.m2.1.1.1.1.1.1.1.3" xref="S2.SS2.p7.2.m2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.SS2.p7.2.m2.1.1.1.1.1.3" xref="S2.SS2.p7.2.m2.1.1.1.1.1.3.cmml">​</mo><mrow id="S2.SS2.p7.2.m2.1.1.1.1.1.2.1" xref="S2.SS2.p7.2.m2.1.1.1.1.1.2.1.1.cmml"><mo stretchy="false" id="S2.SS2.p7.2.m2.1.1.1.1.1.2.1.2" xref="S2.SS2.p7.2.m2.1.1.1.1.1.2.1.1.cmml">(</mo><mrow id="S2.SS2.p7.2.m2.1.1.1.1.1.2.1.1" xref="S2.SS2.p7.2.m2.1.1.1.1.1.2.1.1.cmml"><mi id="S2.SS2.p7.2.m2.1.1.1.1.1.2.1.1.2" xref="S2.SS2.p7.2.m2.1.1.1.1.1.2.1.1.2.cmml">H</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p7.2.m2.1.1.1.1.1.2.1.1.1" xref="S2.SS2.p7.2.m2.1.1.1.1.1.2.1.1.1.cmml">​</mo><mi id="S2.SS2.p7.2.m2.1.1.1.1.1.2.1.1.3" xref="S2.SS2.p7.2.m2.1.1.1.1.1.2.1.1.3.cmml">W</mi></mrow><mo stretchy="false" id="S2.SS2.p7.2.m2.1.1.1.1.1.2.1.3" xref="S2.SS2.p7.2.m2.1.1.1.1.1.2.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.SS2.p7.2.m2.1.1.1.1.1.3a" xref="S2.SS2.p7.2.m2.1.1.1.1.1.3.cmml">​</mo><mi id="S2.SS2.p7.2.m2.1.1.1.1.1.4" xref="S2.SS2.p7.2.m2.1.1.1.1.1.4.cmml">c</mi></mrow><mo id="S2.SS2.p7.2.m2.1.1.1.1.3" xref="S2.SS2.p7.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p7.2.m2.1b"><apply id="S2.SS2.p7.2.m2.1.1.cmml" xref="S2.SS2.p7.2.m2.1.1"><times id="S2.SS2.p7.2.m2.1.1.2.cmml" xref="S2.SS2.p7.2.m2.1.1.2"></times><ci id="S2.SS2.p7.2.m2.1.1.3.cmml" xref="S2.SS2.p7.2.m2.1.1.3">𝒪</ci><apply id="S2.SS2.p7.2.m2.1.1.1.1.1.cmml" xref="S2.SS2.p7.2.m2.1.1.1.1"><times id="S2.SS2.p7.2.m2.1.1.1.1.1.3.cmml" xref="S2.SS2.p7.2.m2.1.1.1.1.1.3"></times><apply id="S2.SS2.p7.2.m2.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p7.2.m2.1.1.1.1.1.1.1"><plus id="S2.SS2.p7.2.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p7.2.m2.1.1.1.1.1.1.1.1.1"></plus><apply id="S2.SS2.p7.2.m2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p7.2.m2.1.1.1.1.1.1.1.1.2"><times id="S2.SS2.p7.2.m2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.SS2.p7.2.m2.1.1.1.1.1.1.1.1.2.1"></times><cn type="integer" id="S2.SS2.p7.2.m2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.SS2.p7.2.m2.1.1.1.1.1.1.1.1.2.2">4</cn><ci id="S2.SS2.p7.2.m2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.SS2.p7.2.m2.1.1.1.1.1.1.1.1.2.3">𝑐</ci></apply><apply id="S2.SS2.p7.2.m2.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p7.2.m2.1.1.1.1.1.1.1.1.3"><times id="S2.SS2.p7.2.m2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.SS2.p7.2.m2.1.1.1.1.1.1.1.1.3.1"></times><cn type="integer" id="S2.SS2.p7.2.m2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.SS2.p7.2.m2.1.1.1.1.1.1.1.1.3.2">2</cn><ci id="S2.SS2.p7.2.m2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.SS2.p7.2.m2.1.1.1.1.1.1.1.1.3.3">𝐻</ci><ci id="S2.SS2.p7.2.m2.1.1.1.1.1.1.1.1.3.4.cmml" xref="S2.SS2.p7.2.m2.1.1.1.1.1.1.1.1.3.4">𝑊</ci></apply></apply><apply id="S2.SS2.p7.2.m2.1.1.1.1.1.2.1.1.cmml" xref="S2.SS2.p7.2.m2.1.1.1.1.1.2.1"><times id="S2.SS2.p7.2.m2.1.1.1.1.1.2.1.1.1.cmml" xref="S2.SS2.p7.2.m2.1.1.1.1.1.2.1.1.1"></times><ci id="S2.SS2.p7.2.m2.1.1.1.1.1.2.1.1.2.cmml" xref="S2.SS2.p7.2.m2.1.1.1.1.1.2.1.1.2">𝐻</ci><ci id="S2.SS2.p7.2.m2.1.1.1.1.1.2.1.1.3.cmml" xref="S2.SS2.p7.2.m2.1.1.1.1.1.2.1.1.3">𝑊</ci></apply><ci id="S2.SS2.p7.2.m2.1.1.1.1.1.4.cmml" xref="S2.SS2.p7.2.m2.1.1.1.1.1.4">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p7.2.m2.1c">\mathcal{O}\left(\left(4c+2HW\right)(HW)c\right)</annotation></semantics></math> and <math id="S2.SS2.p7.3.m3.1" class="ltx_Math" alttext="\mathcal{O}\left(\left(4c+2n_{wp}^{2}\right)(HW)c\right)" display="inline"><semantics id="S2.SS2.p7.3.m3.1a"><mrow id="S2.SS2.p7.3.m3.1.1" xref="S2.SS2.p7.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p7.3.m3.1.1.3" xref="S2.SS2.p7.3.m3.1.1.3.cmml">𝒪</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p7.3.m3.1.1.2" xref="S2.SS2.p7.3.m3.1.1.2.cmml">​</mo><mrow id="S2.SS2.p7.3.m3.1.1.1.1" xref="S2.SS2.p7.3.m3.1.1.1.1.1.cmml"><mo id="S2.SS2.p7.3.m3.1.1.1.1.2" xref="S2.SS2.p7.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p7.3.m3.1.1.1.1.1" xref="S2.SS2.p7.3.m3.1.1.1.1.1.cmml"><mrow id="S2.SS2.p7.3.m3.1.1.1.1.1.1.1" xref="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.cmml"><mo id="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.2" xref="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1" xref="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.cmml"><mrow id="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.2" xref="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.2.cmml"><mn id="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.2.2" xref="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.2.2.cmml">4</mn><mo lspace="0em" rspace="0em" id="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.2.1" xref="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.2.1.cmml">​</mo><mi id="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.2.3" xref="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.2.3.cmml">c</mi></mrow><mo id="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.1" xref="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.3" xref="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.3.cmml"><mn id="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.3.2" xref="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.3.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.3.1" xref="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><msubsup id="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.3.3" xref="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.3.3.2.2" xref="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.3.3.2.2.cmml">n</mi><mrow id="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.3.3.2.3" xref="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.3.3.2.3.cmml"><mi id="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.3.3.2.3.2" xref="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.3.3.2.3.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.3.3.2.3.1" xref="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.3.3.2.3.1.cmml">​</mo><mi id="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.3.3.2.3.3" xref="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.3.3.2.3.3.cmml">p</mi></mrow><mn id="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.3.3.3" xref="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.3.3.3.cmml">2</mn></msubsup></mrow></mrow><mo id="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.3" xref="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.SS2.p7.3.m3.1.1.1.1.1.3" xref="S2.SS2.p7.3.m3.1.1.1.1.1.3.cmml">​</mo><mrow id="S2.SS2.p7.3.m3.1.1.1.1.1.2.1" xref="S2.SS2.p7.3.m3.1.1.1.1.1.2.1.1.cmml"><mo stretchy="false" id="S2.SS2.p7.3.m3.1.1.1.1.1.2.1.2" xref="S2.SS2.p7.3.m3.1.1.1.1.1.2.1.1.cmml">(</mo><mrow id="S2.SS2.p7.3.m3.1.1.1.1.1.2.1.1" xref="S2.SS2.p7.3.m3.1.1.1.1.1.2.1.1.cmml"><mi id="S2.SS2.p7.3.m3.1.1.1.1.1.2.1.1.2" xref="S2.SS2.p7.3.m3.1.1.1.1.1.2.1.1.2.cmml">H</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p7.3.m3.1.1.1.1.1.2.1.1.1" xref="S2.SS2.p7.3.m3.1.1.1.1.1.2.1.1.1.cmml">​</mo><mi id="S2.SS2.p7.3.m3.1.1.1.1.1.2.1.1.3" xref="S2.SS2.p7.3.m3.1.1.1.1.1.2.1.1.3.cmml">W</mi></mrow><mo stretchy="false" id="S2.SS2.p7.3.m3.1.1.1.1.1.2.1.3" xref="S2.SS2.p7.3.m3.1.1.1.1.1.2.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.SS2.p7.3.m3.1.1.1.1.1.3a" xref="S2.SS2.p7.3.m3.1.1.1.1.1.3.cmml">​</mo><mi id="S2.SS2.p7.3.m3.1.1.1.1.1.4" xref="S2.SS2.p7.3.m3.1.1.1.1.1.4.cmml">c</mi></mrow><mo id="S2.SS2.p7.3.m3.1.1.1.1.3" xref="S2.SS2.p7.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p7.3.m3.1b"><apply id="S2.SS2.p7.3.m3.1.1.cmml" xref="S2.SS2.p7.3.m3.1.1"><times id="S2.SS2.p7.3.m3.1.1.2.cmml" xref="S2.SS2.p7.3.m3.1.1.2"></times><ci id="S2.SS2.p7.3.m3.1.1.3.cmml" xref="S2.SS2.p7.3.m3.1.1.3">𝒪</ci><apply id="S2.SS2.p7.3.m3.1.1.1.1.1.cmml" xref="S2.SS2.p7.3.m3.1.1.1.1"><times id="S2.SS2.p7.3.m3.1.1.1.1.1.3.cmml" xref="S2.SS2.p7.3.m3.1.1.1.1.1.3"></times><apply id="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p7.3.m3.1.1.1.1.1.1.1"><plus id="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.1"></plus><apply id="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.2"><times id="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.2.1"></times><cn type="integer" id="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.2.2">4</cn><ci id="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.2.3">𝑐</ci></apply><apply id="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.3"><times id="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.3.1"></times><cn type="integer" id="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.3.2">2</cn><apply id="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.3.3">superscript</csymbol><apply id="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.3.3.2.1.cmml" xref="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.3.3.2.2.cmml" xref="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.3.3.2.2">𝑛</ci><apply id="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.3.3.2.3.cmml" xref="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.3.3.2.3"><times id="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.3.3.2.3.1.cmml" xref="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.3.3.2.3.1"></times><ci id="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.3.3.2.3.2.cmml" xref="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.3.3.2.3.2">𝑤</ci><ci id="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.3.3.2.3.3.cmml" xref="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.3.3.2.3.3">𝑝</ci></apply></apply><cn type="integer" id="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S2.SS2.p7.3.m3.1.1.1.1.1.1.1.1.3.3.3">2</cn></apply></apply></apply><apply id="S2.SS2.p7.3.m3.1.1.1.1.1.2.1.1.cmml" xref="S2.SS2.p7.3.m3.1.1.1.1.1.2.1"><times id="S2.SS2.p7.3.m3.1.1.1.1.1.2.1.1.1.cmml" xref="S2.SS2.p7.3.m3.1.1.1.1.1.2.1.1.1"></times><ci id="S2.SS2.p7.3.m3.1.1.1.1.1.2.1.1.2.cmml" xref="S2.SS2.p7.3.m3.1.1.1.1.1.2.1.1.2">𝐻</ci><ci id="S2.SS2.p7.3.m3.1.1.1.1.1.2.1.1.3.cmml" xref="S2.SS2.p7.3.m3.1.1.1.1.1.2.1.1.3">𝑊</ci></apply><ci id="S2.SS2.p7.3.m3.1.1.1.1.1.4.cmml" xref="S2.SS2.p7.3.m3.1.1.1.1.1.4">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p7.3.m3.1c">\mathcal{O}\left(\left(4c+2n_{wp}^{2}\right)(HW)c\right)</annotation></semantics></math>, where <math id="S2.SS2.p7.4.m4.1" class="ltx_Math" alttext="n_{wp}" display="inline"><semantics id="S2.SS2.p7.4.m4.1a"><msub id="S2.SS2.p7.4.m4.1.1" xref="S2.SS2.p7.4.m4.1.1.cmml"><mi id="S2.SS2.p7.4.m4.1.1.2" xref="S2.SS2.p7.4.m4.1.1.2.cmml">n</mi><mrow id="S2.SS2.p7.4.m4.1.1.3" xref="S2.SS2.p7.4.m4.1.1.3.cmml"><mi id="S2.SS2.p7.4.m4.1.1.3.2" xref="S2.SS2.p7.4.m4.1.1.3.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p7.4.m4.1.1.3.1" xref="S2.SS2.p7.4.m4.1.1.3.1.cmml">​</mo><mi id="S2.SS2.p7.4.m4.1.1.3.3" xref="S2.SS2.p7.4.m4.1.1.3.3.cmml">p</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p7.4.m4.1b"><apply id="S2.SS2.p7.4.m4.1.1.cmml" xref="S2.SS2.p7.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.p7.4.m4.1.1.1.cmml" xref="S2.SS2.p7.4.m4.1.1">subscript</csymbol><ci id="S2.SS2.p7.4.m4.1.1.2.cmml" xref="S2.SS2.p7.4.m4.1.1.2">𝑛</ci><apply id="S2.SS2.p7.4.m4.1.1.3.cmml" xref="S2.SS2.p7.4.m4.1.1.3"><times id="S2.SS2.p7.4.m4.1.1.3.1.cmml" xref="S2.SS2.p7.4.m4.1.1.3.1"></times><ci id="S2.SS2.p7.4.m4.1.1.3.2.cmml" xref="S2.SS2.p7.4.m4.1.1.3.2">𝑤</ci><ci id="S2.SS2.p7.4.m4.1.1.3.3.cmml" xref="S2.SS2.p7.4.m4.1.1.3.3">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p7.4.m4.1c">n_{wp}</annotation></semantics></math> is the window partition size of Swin Transformer, which is usually set to 7. It can be seen that our proposed DCFT attention is more accurate with less computational complexity, and the accuracy comparison experiments are given in the ablation study in Section <a href="#S3.SS4" title="III-D Ablation Study ‣ III Experiments and Results ‣ Concealed Object Detection for Passive Millimeter-Wave Security Imaging Based on Task-Aligned Detection Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">III-D</span></span></a>.</p>
</div>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS3.5.1.1" class="ltx_text">II-C</span> </span><span id="S2.SS3.6.2" class="ltx_text ltx_font_italic">Multi-Scale Deformable Attention Neck</span>
</h3>

<div id="S2.SS3.p1" class="ltx_para">
<p id="S2.SS3.p1.1" class="ltx_p">Since PMMW security images contain high noise and sparse texture, the object and noise are relatively similar in the low-level feature dimension, which leads to network confusion and convergence difficulties. Therefore, a neck to further learn the high-dimensional semantic features and aggregate different classes of features is highly desired. DETR has been very successful in this direction. DETR proposes the idea of treating the object detection task as a set prediction to eliminate post-processing (e.g., NMS) while extracting the semantic features of individual instances well. The shortcomings of DETR are the slow convergence rate and the data-hungry characteristics<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>, which have been intensified in the low-resolution PMMW image situation. Therefore, the deformable attention module<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> is proposed, which has proven that its data-efficient properties<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite> alleviate the inherent data-hungry problem of the DETR model. We follow the design of Deformabe DETR using the deformable attention module for further feature aggregation of the multi-scale feature maps output by the backbone.</p>
</div>
<div id="S2.SS3.p2" class="ltx_para">
<p id="S2.SS3.p2.1" class="ltx_p">Also, some recent work has demonstrated that the encoder of DETR is functionally identical to the region proposal network in traditional two-stage networks<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>, <a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>, and the queries output by the encoder can be regarded as proposals in the region proposals network. Inspired by these works, we propose a method for introducing a spatial prior adapted to security screening, called query selection.</p>
</div>
<figure id="S2.F3" class="ltx_figure"><img src="/html/2212.00313/assets/x3.png" id="S2.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="393" height="284" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Schematic of deformable attention neck. The Multi-Scale feature maps of the encoder output are used for the query selection and the cross-attention in the decoder.</figcaption>
</figure>
<section id="S2.SS3.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S2.SS3.SSS1.5.1.1" class="ltx_text">II-C</span>1 </span>Deformable Attention Module</h4>

<div id="S2.SS3.SSS1.p1" class="ltx_para">
<p id="S2.SS3.SSS1.p1.11" class="ltx_p">The deformable attention module only attends to a small set of key sampling points around a reference point, regardless of the spatial size of the feature maps, as shown in Fig <a href="#S2.F3" title="Figure 3 ‣ II-C Multi-Scale Deformable Attention Neck ‣ II Proposed Method ‣ Concealed Object Detection for Passive Millimeter-Wave Security Imaging Based on Task-Aligned Detection Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. We first take the output multi-scale feature map <math id="S2.SS3.SSS1.p1.1.m1.1" class="ltx_Math" alttext="\{{z^{s}\}}_{s=1}^{S}\in\mathbb{R}^{H\times W\times c}" display="inline"><semantics id="S2.SS3.SSS1.p1.1.m1.1a"><mrow id="S2.SS3.SSS1.p1.1.m1.1.1" xref="S2.SS3.SSS1.p1.1.m1.1.1.cmml"><msubsup id="S2.SS3.SSS1.p1.1.m1.1.1.1" xref="S2.SS3.SSS1.p1.1.m1.1.1.1.cmml"><mrow id="S2.SS3.SSS1.p1.1.m1.1.1.1.1.1.1" xref="S2.SS3.SSS1.p1.1.m1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.SS3.SSS1.p1.1.m1.1.1.1.1.1.1.2" xref="S2.SS3.SSS1.p1.1.m1.1.1.1.1.1.2.cmml">{</mo><msup id="S2.SS3.SSS1.p1.1.m1.1.1.1.1.1.1.1" xref="S2.SS3.SSS1.p1.1.m1.1.1.1.1.1.1.1.cmml"><mi id="S2.SS3.SSS1.p1.1.m1.1.1.1.1.1.1.1.2" xref="S2.SS3.SSS1.p1.1.m1.1.1.1.1.1.1.1.2.cmml">z</mi><mi id="S2.SS3.SSS1.p1.1.m1.1.1.1.1.1.1.1.3" xref="S2.SS3.SSS1.p1.1.m1.1.1.1.1.1.1.1.3.cmml">s</mi></msup><mo stretchy="false" id="S2.SS3.SSS1.p1.1.m1.1.1.1.1.1.1.3" xref="S2.SS3.SSS1.p1.1.m1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.SS3.SSS1.p1.1.m1.1.1.1.1.3" xref="S2.SS3.SSS1.p1.1.m1.1.1.1.1.3.cmml"><mi id="S2.SS3.SSS1.p1.1.m1.1.1.1.1.3.2" xref="S2.SS3.SSS1.p1.1.m1.1.1.1.1.3.2.cmml">s</mi><mo id="S2.SS3.SSS1.p1.1.m1.1.1.1.1.3.1" xref="S2.SS3.SSS1.p1.1.m1.1.1.1.1.3.1.cmml">=</mo><mn id="S2.SS3.SSS1.p1.1.m1.1.1.1.1.3.3" xref="S2.SS3.SSS1.p1.1.m1.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S2.SS3.SSS1.p1.1.m1.1.1.1.3" xref="S2.SS3.SSS1.p1.1.m1.1.1.1.3.cmml">S</mi></msubsup><mo id="S2.SS3.SSS1.p1.1.m1.1.1.2" xref="S2.SS3.SSS1.p1.1.m1.1.1.2.cmml">∈</mo><msup id="S2.SS3.SSS1.p1.1.m1.1.1.3" xref="S2.SS3.SSS1.p1.1.m1.1.1.3.cmml"><mi id="S2.SS3.SSS1.p1.1.m1.1.1.3.2" xref="S2.SS3.SSS1.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS3.SSS1.p1.1.m1.1.1.3.3" xref="S2.SS3.SSS1.p1.1.m1.1.1.3.3.cmml"><mi id="S2.SS3.SSS1.p1.1.m1.1.1.3.3.2" xref="S2.SS3.SSS1.p1.1.m1.1.1.3.3.2.cmml">H</mi><mo lspace="0.222em" rspace="0.222em" id="S2.SS3.SSS1.p1.1.m1.1.1.3.3.1" xref="S2.SS3.SSS1.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S2.SS3.SSS1.p1.1.m1.1.1.3.3.3" xref="S2.SS3.SSS1.p1.1.m1.1.1.3.3.3.cmml">W</mi><mo lspace="0.222em" rspace="0.222em" id="S2.SS3.SSS1.p1.1.m1.1.1.3.3.1a" xref="S2.SS3.SSS1.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S2.SS3.SSS1.p1.1.m1.1.1.3.3.4" xref="S2.SS3.SSS1.p1.1.m1.1.1.3.3.4.cmml">c</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.1.m1.1b"><apply id="S2.SS3.SSS1.p1.1.m1.1.1.cmml" xref="S2.SS3.SSS1.p1.1.m1.1.1"><in id="S2.SS3.SSS1.p1.1.m1.1.1.2.cmml" xref="S2.SS3.SSS1.p1.1.m1.1.1.2"></in><apply id="S2.SS3.SSS1.p1.1.m1.1.1.1.cmml" xref="S2.SS3.SSS1.p1.1.m1.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.1.m1.1.1.1.2.cmml" xref="S2.SS3.SSS1.p1.1.m1.1.1.1">superscript</csymbol><apply id="S2.SS3.SSS1.p1.1.m1.1.1.1.1.cmml" xref="S2.SS3.SSS1.p1.1.m1.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.1.m1.1.1.1.1.2.cmml" xref="S2.SS3.SSS1.p1.1.m1.1.1.1">subscript</csymbol><set id="S2.SS3.SSS1.p1.1.m1.1.1.1.1.1.2.cmml" xref="S2.SS3.SSS1.p1.1.m1.1.1.1.1.1.1"><apply id="S2.SS3.SSS1.p1.1.m1.1.1.1.1.1.1.1.cmml" xref="S2.SS3.SSS1.p1.1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS3.SSS1.p1.1.m1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.SS3.SSS1.p1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS3.SSS1.p1.1.m1.1.1.1.1.1.1.1.2">𝑧</ci><ci id="S2.SS3.SSS1.p1.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS3.SSS1.p1.1.m1.1.1.1.1.1.1.1.3">𝑠</ci></apply></set><apply id="S2.SS3.SSS1.p1.1.m1.1.1.1.1.3.cmml" xref="S2.SS3.SSS1.p1.1.m1.1.1.1.1.3"><eq id="S2.SS3.SSS1.p1.1.m1.1.1.1.1.3.1.cmml" xref="S2.SS3.SSS1.p1.1.m1.1.1.1.1.3.1"></eq><ci id="S2.SS3.SSS1.p1.1.m1.1.1.1.1.3.2.cmml" xref="S2.SS3.SSS1.p1.1.m1.1.1.1.1.3.2">𝑠</ci><cn type="integer" id="S2.SS3.SSS1.p1.1.m1.1.1.1.1.3.3.cmml" xref="S2.SS3.SSS1.p1.1.m1.1.1.1.1.3.3">1</cn></apply></apply><ci id="S2.SS3.SSS1.p1.1.m1.1.1.1.3.cmml" xref="S2.SS3.SSS1.p1.1.m1.1.1.1.3">𝑆</ci></apply><apply id="S2.SS3.SSS1.p1.1.m1.1.1.3.cmml" xref="S2.SS3.SSS1.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.1.m1.1.1.3.1.cmml" xref="S2.SS3.SSS1.p1.1.m1.1.1.3">superscript</csymbol><ci id="S2.SS3.SSS1.p1.1.m1.1.1.3.2.cmml" xref="S2.SS3.SSS1.p1.1.m1.1.1.3.2">ℝ</ci><apply id="S2.SS3.SSS1.p1.1.m1.1.1.3.3.cmml" xref="S2.SS3.SSS1.p1.1.m1.1.1.3.3"><times id="S2.SS3.SSS1.p1.1.m1.1.1.3.3.1.cmml" xref="S2.SS3.SSS1.p1.1.m1.1.1.3.3.1"></times><ci id="S2.SS3.SSS1.p1.1.m1.1.1.3.3.2.cmml" xref="S2.SS3.SSS1.p1.1.m1.1.1.3.3.2">𝐻</ci><ci id="S2.SS3.SSS1.p1.1.m1.1.1.3.3.3.cmml" xref="S2.SS3.SSS1.p1.1.m1.1.1.3.3.3">𝑊</ci><ci id="S2.SS3.SSS1.p1.1.m1.1.1.3.3.4.cmml" xref="S2.SS3.SSS1.p1.1.m1.1.1.3.3.4">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.1.m1.1c">\{{z^{s}\}}_{s=1}^{S}\in\mathbb{R}^{H\times W\times c}</annotation></semantics></math> from the backbone, content feature <math id="S2.SS3.SSS1.p1.2.m2.1" class="ltx_Math" alttext="z_{q}\in\mathbb{R}^{C}" display="inline"><semantics id="S2.SS3.SSS1.p1.2.m2.1a"><mrow id="S2.SS3.SSS1.p1.2.m2.1.1" xref="S2.SS3.SSS1.p1.2.m2.1.1.cmml"><msub id="S2.SS3.SSS1.p1.2.m2.1.1.2" xref="S2.SS3.SSS1.p1.2.m2.1.1.2.cmml"><mi id="S2.SS3.SSS1.p1.2.m2.1.1.2.2" xref="S2.SS3.SSS1.p1.2.m2.1.1.2.2.cmml">z</mi><mi id="S2.SS3.SSS1.p1.2.m2.1.1.2.3" xref="S2.SS3.SSS1.p1.2.m2.1.1.2.3.cmml">q</mi></msub><mo id="S2.SS3.SSS1.p1.2.m2.1.1.1" xref="S2.SS3.SSS1.p1.2.m2.1.1.1.cmml">∈</mo><msup id="S2.SS3.SSS1.p1.2.m2.1.1.3" xref="S2.SS3.SSS1.p1.2.m2.1.1.3.cmml"><mi id="S2.SS3.SSS1.p1.2.m2.1.1.3.2" xref="S2.SS3.SSS1.p1.2.m2.1.1.3.2.cmml">ℝ</mi><mi id="S2.SS3.SSS1.p1.2.m2.1.1.3.3" xref="S2.SS3.SSS1.p1.2.m2.1.1.3.3.cmml">C</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.2.m2.1b"><apply id="S2.SS3.SSS1.p1.2.m2.1.1.cmml" xref="S2.SS3.SSS1.p1.2.m2.1.1"><in id="S2.SS3.SSS1.p1.2.m2.1.1.1.cmml" xref="S2.SS3.SSS1.p1.2.m2.1.1.1"></in><apply id="S2.SS3.SSS1.p1.2.m2.1.1.2.cmml" xref="S2.SS3.SSS1.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.2.m2.1.1.2.1.cmml" xref="S2.SS3.SSS1.p1.2.m2.1.1.2">subscript</csymbol><ci id="S2.SS3.SSS1.p1.2.m2.1.1.2.2.cmml" xref="S2.SS3.SSS1.p1.2.m2.1.1.2.2">𝑧</ci><ci id="S2.SS3.SSS1.p1.2.m2.1.1.2.3.cmml" xref="S2.SS3.SSS1.p1.2.m2.1.1.2.3">𝑞</ci></apply><apply id="S2.SS3.SSS1.p1.2.m2.1.1.3.cmml" xref="S2.SS3.SSS1.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.2.m2.1.1.3.1.cmml" xref="S2.SS3.SSS1.p1.2.m2.1.1.3">superscript</csymbol><ci id="S2.SS3.SSS1.p1.2.m2.1.1.3.2.cmml" xref="S2.SS3.SSS1.p1.2.m2.1.1.3.2">ℝ</ci><ci id="S2.SS3.SSS1.p1.2.m2.1.1.3.3.cmml" xref="S2.SS3.SSS1.p1.2.m2.1.1.3.3">𝐶</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.2.m2.1c">z_{q}\in\mathbb{R}^{C}</annotation></semantics></math>, and its correspondent normalized coordinates of the 2-d reference point <math id="S2.SS3.SSS1.p1.3.m3.2" class="ltx_Math" alttext="\hat{\boldsymbol{p}}_{q}\in[0,1]^{2}" display="inline"><semantics id="S2.SS3.SSS1.p1.3.m3.2a"><mrow id="S2.SS3.SSS1.p1.3.m3.2.3" xref="S2.SS3.SSS1.p1.3.m3.2.3.cmml"><msub id="S2.SS3.SSS1.p1.3.m3.2.3.2" xref="S2.SS3.SSS1.p1.3.m3.2.3.2.cmml"><mover accent="true" id="S2.SS3.SSS1.p1.3.m3.2.3.2.2" xref="S2.SS3.SSS1.p1.3.m3.2.3.2.2.cmml"><mi id="S2.SS3.SSS1.p1.3.m3.2.3.2.2.2" xref="S2.SS3.SSS1.p1.3.m3.2.3.2.2.2.cmml">𝒑</mi><mo id="S2.SS3.SSS1.p1.3.m3.2.3.2.2.1" xref="S2.SS3.SSS1.p1.3.m3.2.3.2.2.1.cmml">^</mo></mover><mi id="S2.SS3.SSS1.p1.3.m3.2.3.2.3" xref="S2.SS3.SSS1.p1.3.m3.2.3.2.3.cmml">q</mi></msub><mo id="S2.SS3.SSS1.p1.3.m3.2.3.1" xref="S2.SS3.SSS1.p1.3.m3.2.3.1.cmml">∈</mo><msup id="S2.SS3.SSS1.p1.3.m3.2.3.3" xref="S2.SS3.SSS1.p1.3.m3.2.3.3.cmml"><mrow id="S2.SS3.SSS1.p1.3.m3.2.3.3.2.2" xref="S2.SS3.SSS1.p1.3.m3.2.3.3.2.1.cmml"><mo stretchy="false" id="S2.SS3.SSS1.p1.3.m3.2.3.3.2.2.1" xref="S2.SS3.SSS1.p1.3.m3.2.3.3.2.1.cmml">[</mo><mn id="S2.SS3.SSS1.p1.3.m3.1.1" xref="S2.SS3.SSS1.p1.3.m3.1.1.cmml">0</mn><mo id="S2.SS3.SSS1.p1.3.m3.2.3.3.2.2.2" xref="S2.SS3.SSS1.p1.3.m3.2.3.3.2.1.cmml">,</mo><mn id="S2.SS3.SSS1.p1.3.m3.2.2" xref="S2.SS3.SSS1.p1.3.m3.2.2.cmml">1</mn><mo stretchy="false" id="S2.SS3.SSS1.p1.3.m3.2.3.3.2.2.3" xref="S2.SS3.SSS1.p1.3.m3.2.3.3.2.1.cmml">]</mo></mrow><mn id="S2.SS3.SSS1.p1.3.m3.2.3.3.3" xref="S2.SS3.SSS1.p1.3.m3.2.3.3.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.3.m3.2b"><apply id="S2.SS3.SSS1.p1.3.m3.2.3.cmml" xref="S2.SS3.SSS1.p1.3.m3.2.3"><in id="S2.SS3.SSS1.p1.3.m3.2.3.1.cmml" xref="S2.SS3.SSS1.p1.3.m3.2.3.1"></in><apply id="S2.SS3.SSS1.p1.3.m3.2.3.2.cmml" xref="S2.SS3.SSS1.p1.3.m3.2.3.2"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.3.m3.2.3.2.1.cmml" xref="S2.SS3.SSS1.p1.3.m3.2.3.2">subscript</csymbol><apply id="S2.SS3.SSS1.p1.3.m3.2.3.2.2.cmml" xref="S2.SS3.SSS1.p1.3.m3.2.3.2.2"><ci id="S2.SS3.SSS1.p1.3.m3.2.3.2.2.1.cmml" xref="S2.SS3.SSS1.p1.3.m3.2.3.2.2.1">^</ci><ci id="S2.SS3.SSS1.p1.3.m3.2.3.2.2.2.cmml" xref="S2.SS3.SSS1.p1.3.m3.2.3.2.2.2">𝒑</ci></apply><ci id="S2.SS3.SSS1.p1.3.m3.2.3.2.3.cmml" xref="S2.SS3.SSS1.p1.3.m3.2.3.2.3">𝑞</ci></apply><apply id="S2.SS3.SSS1.p1.3.m3.2.3.3.cmml" xref="S2.SS3.SSS1.p1.3.m3.2.3.3"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.3.m3.2.3.3.1.cmml" xref="S2.SS3.SSS1.p1.3.m3.2.3.3">superscript</csymbol><interval closure="closed" id="S2.SS3.SSS1.p1.3.m3.2.3.3.2.1.cmml" xref="S2.SS3.SSS1.p1.3.m3.2.3.3.2.2"><cn type="integer" id="S2.SS3.SSS1.p1.3.m3.1.1.cmml" xref="S2.SS3.SSS1.p1.3.m3.1.1">0</cn><cn type="integer" id="S2.SS3.SSS1.p1.3.m3.2.2.cmml" xref="S2.SS3.SSS1.p1.3.m3.2.2">1</cn></interval><cn type="integer" id="S2.SS3.SSS1.p1.3.m3.2.3.3.3.cmml" xref="S2.SS3.SSS1.p1.3.m3.2.3.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.3.m3.2c">\hat{\boldsymbol{p}}_{q}\in[0,1]^{2}</annotation></semantics></math> as input of deformable attention, where <math id="S2.SS3.SSS1.p1.4.m4.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S2.SS3.SSS1.p1.4.m4.1a"><mi id="S2.SS3.SSS1.p1.4.m4.1.1" xref="S2.SS3.SSS1.p1.4.m4.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.4.m4.1b"><ci id="S2.SS3.SSS1.p1.4.m4.1.1.cmml" xref="S2.SS3.SSS1.p1.4.m4.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.4.m4.1c">q</annotation></semantics></math> indexes a query element, <math id="S2.SS3.SSS1.p1.5.m5.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S2.SS3.SSS1.p1.5.m5.1a"><mi id="S2.SS3.SSS1.p1.5.m5.1.1" xref="S2.SS3.SSS1.p1.5.m5.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.5.m5.1b"><ci id="S2.SS3.SSS1.p1.5.m5.1.1.cmml" xref="S2.SS3.SSS1.p1.5.m5.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.5.m5.1c">s</annotation></semantics></math> indexes the input feature maps level. Then via two independent linear projection layers, we use the query feature <math id="S2.SS3.SSS1.p1.6.m6.1" class="ltx_Math" alttext="z_{q}" display="inline"><semantics id="S2.SS3.SSS1.p1.6.m6.1a"><msub id="S2.SS3.SSS1.p1.6.m6.1.1" xref="S2.SS3.SSS1.p1.6.m6.1.1.cmml"><mi id="S2.SS3.SSS1.p1.6.m6.1.1.2" xref="S2.SS3.SSS1.p1.6.m6.1.1.2.cmml">z</mi><mi id="S2.SS3.SSS1.p1.6.m6.1.1.3" xref="S2.SS3.SSS1.p1.6.m6.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.6.m6.1b"><apply id="S2.SS3.SSS1.p1.6.m6.1.1.cmml" xref="S2.SS3.SSS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.6.m6.1.1.1.cmml" xref="S2.SS3.SSS1.p1.6.m6.1.1">subscript</csymbol><ci id="S2.SS3.SSS1.p1.6.m6.1.1.2.cmml" xref="S2.SS3.SSS1.p1.6.m6.1.1.2">𝑧</ci><ci id="S2.SS3.SSS1.p1.6.m6.1.1.3.cmml" xref="S2.SS3.SSS1.p1.6.m6.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.6.m6.1c">z_{q}</annotation></semantics></math> to obtain sampling offset <math id="S2.SS3.SSS1.p1.7.m7.1" class="ltx_Math" alttext="\Delta\boldsymbol{p}_{msqk}" display="inline"><semantics id="S2.SS3.SSS1.p1.7.m7.1a"><mrow id="S2.SS3.SSS1.p1.7.m7.1.1" xref="S2.SS3.SSS1.p1.7.m7.1.1.cmml"><mi mathvariant="normal" id="S2.SS3.SSS1.p1.7.m7.1.1.2" xref="S2.SS3.SSS1.p1.7.m7.1.1.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S2.SS3.SSS1.p1.7.m7.1.1.1" xref="S2.SS3.SSS1.p1.7.m7.1.1.1.cmml">​</mo><msub id="S2.SS3.SSS1.p1.7.m7.1.1.3" xref="S2.SS3.SSS1.p1.7.m7.1.1.3.cmml"><mi id="S2.SS3.SSS1.p1.7.m7.1.1.3.2" xref="S2.SS3.SSS1.p1.7.m7.1.1.3.2.cmml">𝒑</mi><mrow id="S2.SS3.SSS1.p1.7.m7.1.1.3.3" xref="S2.SS3.SSS1.p1.7.m7.1.1.3.3.cmml"><mi id="S2.SS3.SSS1.p1.7.m7.1.1.3.3.2" xref="S2.SS3.SSS1.p1.7.m7.1.1.3.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S2.SS3.SSS1.p1.7.m7.1.1.3.3.1" xref="S2.SS3.SSS1.p1.7.m7.1.1.3.3.1.cmml">​</mo><mi id="S2.SS3.SSS1.p1.7.m7.1.1.3.3.3" xref="S2.SS3.SSS1.p1.7.m7.1.1.3.3.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.SS3.SSS1.p1.7.m7.1.1.3.3.1a" xref="S2.SS3.SSS1.p1.7.m7.1.1.3.3.1.cmml">​</mo><mi id="S2.SS3.SSS1.p1.7.m7.1.1.3.3.4" xref="S2.SS3.SSS1.p1.7.m7.1.1.3.3.4.cmml">q</mi><mo lspace="0em" rspace="0em" id="S2.SS3.SSS1.p1.7.m7.1.1.3.3.1b" xref="S2.SS3.SSS1.p1.7.m7.1.1.3.3.1.cmml">​</mo><mi id="S2.SS3.SSS1.p1.7.m7.1.1.3.3.5" xref="S2.SS3.SSS1.p1.7.m7.1.1.3.3.5.cmml">k</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.7.m7.1b"><apply id="S2.SS3.SSS1.p1.7.m7.1.1.cmml" xref="S2.SS3.SSS1.p1.7.m7.1.1"><times id="S2.SS3.SSS1.p1.7.m7.1.1.1.cmml" xref="S2.SS3.SSS1.p1.7.m7.1.1.1"></times><ci id="S2.SS3.SSS1.p1.7.m7.1.1.2.cmml" xref="S2.SS3.SSS1.p1.7.m7.1.1.2">Δ</ci><apply id="S2.SS3.SSS1.p1.7.m7.1.1.3.cmml" xref="S2.SS3.SSS1.p1.7.m7.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.7.m7.1.1.3.1.cmml" xref="S2.SS3.SSS1.p1.7.m7.1.1.3">subscript</csymbol><ci id="S2.SS3.SSS1.p1.7.m7.1.1.3.2.cmml" xref="S2.SS3.SSS1.p1.7.m7.1.1.3.2">𝒑</ci><apply id="S2.SS3.SSS1.p1.7.m7.1.1.3.3.cmml" xref="S2.SS3.SSS1.p1.7.m7.1.1.3.3"><times id="S2.SS3.SSS1.p1.7.m7.1.1.3.3.1.cmml" xref="S2.SS3.SSS1.p1.7.m7.1.1.3.3.1"></times><ci id="S2.SS3.SSS1.p1.7.m7.1.1.3.3.2.cmml" xref="S2.SS3.SSS1.p1.7.m7.1.1.3.3.2">𝑚</ci><ci id="S2.SS3.SSS1.p1.7.m7.1.1.3.3.3.cmml" xref="S2.SS3.SSS1.p1.7.m7.1.1.3.3.3">𝑠</ci><ci id="S2.SS3.SSS1.p1.7.m7.1.1.3.3.4.cmml" xref="S2.SS3.SSS1.p1.7.m7.1.1.3.3.4">𝑞</ci><ci id="S2.SS3.SSS1.p1.7.m7.1.1.3.3.5.cmml" xref="S2.SS3.SSS1.p1.7.m7.1.1.3.3.5">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.7.m7.1c">\Delta\boldsymbol{p}_{msqk}</annotation></semantics></math> and attention weight <math id="S2.SS3.SSS1.p1.8.m8.1" class="ltx_Math" alttext="A_{msqk}" display="inline"><semantics id="S2.SS3.SSS1.p1.8.m8.1a"><msub id="S2.SS3.SSS1.p1.8.m8.1.1" xref="S2.SS3.SSS1.p1.8.m8.1.1.cmml"><mi id="S2.SS3.SSS1.p1.8.m8.1.1.2" xref="S2.SS3.SSS1.p1.8.m8.1.1.2.cmml">A</mi><mrow id="S2.SS3.SSS1.p1.8.m8.1.1.3" xref="S2.SS3.SSS1.p1.8.m8.1.1.3.cmml"><mi id="S2.SS3.SSS1.p1.8.m8.1.1.3.2" xref="S2.SS3.SSS1.p1.8.m8.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S2.SS3.SSS1.p1.8.m8.1.1.3.1" xref="S2.SS3.SSS1.p1.8.m8.1.1.3.1.cmml">​</mo><mi id="S2.SS3.SSS1.p1.8.m8.1.1.3.3" xref="S2.SS3.SSS1.p1.8.m8.1.1.3.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.SS3.SSS1.p1.8.m8.1.1.3.1a" xref="S2.SS3.SSS1.p1.8.m8.1.1.3.1.cmml">​</mo><mi id="S2.SS3.SSS1.p1.8.m8.1.1.3.4" xref="S2.SS3.SSS1.p1.8.m8.1.1.3.4.cmml">q</mi><mo lspace="0em" rspace="0em" id="S2.SS3.SSS1.p1.8.m8.1.1.3.1b" xref="S2.SS3.SSS1.p1.8.m8.1.1.3.1.cmml">​</mo><mi id="S2.SS3.SSS1.p1.8.m8.1.1.3.5" xref="S2.SS3.SSS1.p1.8.m8.1.1.3.5.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.8.m8.1b"><apply id="S2.SS3.SSS1.p1.8.m8.1.1.cmml" xref="S2.SS3.SSS1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.8.m8.1.1.1.cmml" xref="S2.SS3.SSS1.p1.8.m8.1.1">subscript</csymbol><ci id="S2.SS3.SSS1.p1.8.m8.1.1.2.cmml" xref="S2.SS3.SSS1.p1.8.m8.1.1.2">𝐴</ci><apply id="S2.SS3.SSS1.p1.8.m8.1.1.3.cmml" xref="S2.SS3.SSS1.p1.8.m8.1.1.3"><times id="S2.SS3.SSS1.p1.8.m8.1.1.3.1.cmml" xref="S2.SS3.SSS1.p1.8.m8.1.1.3.1"></times><ci id="S2.SS3.SSS1.p1.8.m8.1.1.3.2.cmml" xref="S2.SS3.SSS1.p1.8.m8.1.1.3.2">𝑚</ci><ci id="S2.SS3.SSS1.p1.8.m8.1.1.3.3.cmml" xref="S2.SS3.SSS1.p1.8.m8.1.1.3.3">𝑠</ci><ci id="S2.SS3.SSS1.p1.8.m8.1.1.3.4.cmml" xref="S2.SS3.SSS1.p1.8.m8.1.1.3.4">𝑞</ci><ci id="S2.SS3.SSS1.p1.8.m8.1.1.3.5.cmml" xref="S2.SS3.SSS1.p1.8.m8.1.1.3.5">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.8.m8.1c">A_{msqk}</annotation></semantics></math>, where <math id="S2.SS3.SSS1.p1.9.m9.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S2.SS3.SSS1.p1.9.m9.1a"><mi id="S2.SS3.SSS1.p1.9.m9.1.1" xref="S2.SS3.SSS1.p1.9.m9.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.9.m9.1b"><ci id="S2.SS3.SSS1.p1.9.m9.1.1.cmml" xref="S2.SS3.SSS1.p1.9.m9.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.9.m9.1c">m</annotation></semantics></math> indexes the attention head, and <math id="S2.SS3.SSS1.p1.10.m10.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S2.SS3.SSS1.p1.10.m10.1a"><mi id="S2.SS3.SSS1.p1.10.m10.1.1" xref="S2.SS3.SSS1.p1.10.m10.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.10.m10.1b"><ci id="S2.SS3.SSS1.p1.10.m10.1.1.cmml" xref="S2.SS3.SSS1.p1.10.m10.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.10.m10.1c">k</annotation></semantics></math> indexes the sampling point and <math id="S2.SS3.SSS1.p1.11.m11.1" class="ltx_Math" alttext="\sum_{s=1}^{S}\sum_{k=1}^{K}A_{msqk}=1" display="inline"><semantics id="S2.SS3.SSS1.p1.11.m11.1a"><mrow id="S2.SS3.SSS1.p1.11.m11.1.1" xref="S2.SS3.SSS1.p1.11.m11.1.1.cmml"><mrow id="S2.SS3.SSS1.p1.11.m11.1.1.2" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.cmml"><msubsup id="S2.SS3.SSS1.p1.11.m11.1.1.2.1" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.1.cmml"><mo id="S2.SS3.SSS1.p1.11.m11.1.1.2.1.2.2" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.1.2.2.cmml">∑</mo><mrow id="S2.SS3.SSS1.p1.11.m11.1.1.2.1.2.3" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.1.2.3.cmml"><mi id="S2.SS3.SSS1.p1.11.m11.1.1.2.1.2.3.2" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.1.2.3.2.cmml">s</mi><mo id="S2.SS3.SSS1.p1.11.m11.1.1.2.1.2.3.1" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.1.2.3.1.cmml">=</mo><mn id="S2.SS3.SSS1.p1.11.m11.1.1.2.1.2.3.3" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.1.2.3.3.cmml">1</mn></mrow><mi id="S2.SS3.SSS1.p1.11.m11.1.1.2.1.3" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.1.3.cmml">S</mi></msubsup><mrow id="S2.SS3.SSS1.p1.11.m11.1.1.2.2" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.2.cmml"><msubsup id="S2.SS3.SSS1.p1.11.m11.1.1.2.2.1" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.2.1.cmml"><mo lspace="0.167em" id="S2.SS3.SSS1.p1.11.m11.1.1.2.2.1.2.2" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.2.1.2.2.cmml">∑</mo><mrow id="S2.SS3.SSS1.p1.11.m11.1.1.2.2.1.2.3" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.2.1.2.3.cmml"><mi id="S2.SS3.SSS1.p1.11.m11.1.1.2.2.1.2.3.2" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.2.1.2.3.2.cmml">k</mi><mo id="S2.SS3.SSS1.p1.11.m11.1.1.2.2.1.2.3.1" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.2.1.2.3.1.cmml">=</mo><mn id="S2.SS3.SSS1.p1.11.m11.1.1.2.2.1.2.3.3" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.2.1.2.3.3.cmml">1</mn></mrow><mi id="S2.SS3.SSS1.p1.11.m11.1.1.2.2.1.3" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.2.1.3.cmml">K</mi></msubsup><msub id="S2.SS3.SSS1.p1.11.m11.1.1.2.2.2" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.2.2.cmml"><mi id="S2.SS3.SSS1.p1.11.m11.1.1.2.2.2.2" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.2.2.2.cmml">A</mi><mrow id="S2.SS3.SSS1.p1.11.m11.1.1.2.2.2.3" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.2.2.3.cmml"><mi id="S2.SS3.SSS1.p1.11.m11.1.1.2.2.2.3.2" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.2.2.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S2.SS3.SSS1.p1.11.m11.1.1.2.2.2.3.1" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.2.2.3.1.cmml">​</mo><mi id="S2.SS3.SSS1.p1.11.m11.1.1.2.2.2.3.3" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.2.2.3.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.SS3.SSS1.p1.11.m11.1.1.2.2.2.3.1a" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.2.2.3.1.cmml">​</mo><mi id="S2.SS3.SSS1.p1.11.m11.1.1.2.2.2.3.4" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.2.2.3.4.cmml">q</mi><mo lspace="0em" rspace="0em" id="S2.SS3.SSS1.p1.11.m11.1.1.2.2.2.3.1b" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.2.2.3.1.cmml">​</mo><mi id="S2.SS3.SSS1.p1.11.m11.1.1.2.2.2.3.5" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.2.2.3.5.cmml">k</mi></mrow></msub></mrow></mrow><mo id="S2.SS3.SSS1.p1.11.m11.1.1.1" xref="S2.SS3.SSS1.p1.11.m11.1.1.1.cmml">=</mo><mn id="S2.SS3.SSS1.p1.11.m11.1.1.3" xref="S2.SS3.SSS1.p1.11.m11.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.11.m11.1b"><apply id="S2.SS3.SSS1.p1.11.m11.1.1.cmml" xref="S2.SS3.SSS1.p1.11.m11.1.1"><eq id="S2.SS3.SSS1.p1.11.m11.1.1.1.cmml" xref="S2.SS3.SSS1.p1.11.m11.1.1.1"></eq><apply id="S2.SS3.SSS1.p1.11.m11.1.1.2.cmml" xref="S2.SS3.SSS1.p1.11.m11.1.1.2"><apply id="S2.SS3.SSS1.p1.11.m11.1.1.2.1.cmml" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.1"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.11.m11.1.1.2.1.1.cmml" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.1">superscript</csymbol><apply id="S2.SS3.SSS1.p1.11.m11.1.1.2.1.2.cmml" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.1"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.11.m11.1.1.2.1.2.1.cmml" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.1">subscript</csymbol><sum id="S2.SS3.SSS1.p1.11.m11.1.1.2.1.2.2.cmml" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.1.2.2"></sum><apply id="S2.SS3.SSS1.p1.11.m11.1.1.2.1.2.3.cmml" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.1.2.3"><eq id="S2.SS3.SSS1.p1.11.m11.1.1.2.1.2.3.1.cmml" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.1.2.3.1"></eq><ci id="S2.SS3.SSS1.p1.11.m11.1.1.2.1.2.3.2.cmml" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.1.2.3.2">𝑠</ci><cn type="integer" id="S2.SS3.SSS1.p1.11.m11.1.1.2.1.2.3.3.cmml" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.1.2.3.3">1</cn></apply></apply><ci id="S2.SS3.SSS1.p1.11.m11.1.1.2.1.3.cmml" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.1.3">𝑆</ci></apply><apply id="S2.SS3.SSS1.p1.11.m11.1.1.2.2.cmml" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.2"><apply id="S2.SS3.SSS1.p1.11.m11.1.1.2.2.1.cmml" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.2.1"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.11.m11.1.1.2.2.1.1.cmml" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.2.1">superscript</csymbol><apply id="S2.SS3.SSS1.p1.11.m11.1.1.2.2.1.2.cmml" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.2.1"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.11.m11.1.1.2.2.1.2.1.cmml" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.2.1">subscript</csymbol><sum id="S2.SS3.SSS1.p1.11.m11.1.1.2.2.1.2.2.cmml" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.2.1.2.2"></sum><apply id="S2.SS3.SSS1.p1.11.m11.1.1.2.2.1.2.3.cmml" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.2.1.2.3"><eq id="S2.SS3.SSS1.p1.11.m11.1.1.2.2.1.2.3.1.cmml" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.2.1.2.3.1"></eq><ci id="S2.SS3.SSS1.p1.11.m11.1.1.2.2.1.2.3.2.cmml" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.2.1.2.3.2">𝑘</ci><cn type="integer" id="S2.SS3.SSS1.p1.11.m11.1.1.2.2.1.2.3.3.cmml" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.2.1.2.3.3">1</cn></apply></apply><ci id="S2.SS3.SSS1.p1.11.m11.1.1.2.2.1.3.cmml" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.2.1.3">𝐾</ci></apply><apply id="S2.SS3.SSS1.p1.11.m11.1.1.2.2.2.cmml" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.11.m11.1.1.2.2.2.1.cmml" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.2.2">subscript</csymbol><ci id="S2.SS3.SSS1.p1.11.m11.1.1.2.2.2.2.cmml" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.2.2.2">𝐴</ci><apply id="S2.SS3.SSS1.p1.11.m11.1.1.2.2.2.3.cmml" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.2.2.3"><times id="S2.SS3.SSS1.p1.11.m11.1.1.2.2.2.3.1.cmml" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.2.2.3.1"></times><ci id="S2.SS3.SSS1.p1.11.m11.1.1.2.2.2.3.2.cmml" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.2.2.3.2">𝑚</ci><ci id="S2.SS3.SSS1.p1.11.m11.1.1.2.2.2.3.3.cmml" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.2.2.3.3">𝑠</ci><ci id="S2.SS3.SSS1.p1.11.m11.1.1.2.2.2.3.4.cmml" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.2.2.3.4">𝑞</ci><ci id="S2.SS3.SSS1.p1.11.m11.1.1.2.2.2.3.5.cmml" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.2.2.3.5">𝑘</ci></apply></apply></apply></apply><cn type="integer" id="S2.SS3.SSS1.p1.11.m11.1.1.3.cmml" xref="S2.SS3.SSS1.p1.11.m11.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.11.m11.1c">\sum_{s=1}^{S}\sum_{k=1}^{K}A_{msqk}=1</annotation></semantics></math>. The calculation of the multi-scale deformable attention can be expressed as:</p>
</div>
<div id="S2.SS3.SSS1.p2" class="ltx_para">
<table id="S2.E3" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S2.E3X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E3X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\operatorname{MS}" display="inline"><semantics id="S2.E3X.2.1.1.m1.1a"><mi id="S2.E3X.2.1.1.m1.1.1" xref="S2.E3X.2.1.1.m1.1.1.cmml">MS</mi><annotation-xml encoding="MathML-Content" id="S2.E3X.2.1.1.m1.1b"><ci id="S2.E3X.2.1.1.m1.1.1.cmml" xref="S2.E3X.2.1.1.m1.1.1">MS</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.E3X.2.1.1.m1.1c">\displaystyle\operatorname{MS}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E3X.3.2.2.m1.1" class="ltx_math_unparsed" alttext="\displaystyle\operatorname{DeformAttn}\left(\boldsymbol{z}_{q},\hat{\boldsymbol{p}}_{q},\left\{\boldsymbol{z}^{s}\right\}_{s=1}^{S}\right)=\sum_{m=1}^{M}\boldsymbol{W}_{m}\cdot" display="inline"><semantics id="S2.E3X.3.2.2.m1.1a"><mrow id="S2.E3X.3.2.2.m1.1b"><mi id="S2.E3X.3.2.2.m1.1.1">DeformAttn</mi><mrow id="S2.E3X.3.2.2.m1.1.2"><mo id="S2.E3X.3.2.2.m1.1.2.1">(</mo><msub id="S2.E3X.3.2.2.m1.1.2.2"><mi id="S2.E3X.3.2.2.m1.1.2.2.2">𝒛</mi><mi id="S2.E3X.3.2.2.m1.1.2.2.3">q</mi></msub><mo id="S2.E3X.3.2.2.m1.1.2.3">,</mo><msub id="S2.E3X.3.2.2.m1.1.2.4"><mover accent="true" id="S2.E3X.3.2.2.m1.1.2.4.2"><mi id="S2.E3X.3.2.2.m1.1.2.4.2.2">𝒑</mi><mo id="S2.E3X.3.2.2.m1.1.2.4.2.1">^</mo></mover><mi id="S2.E3X.3.2.2.m1.1.2.4.3">q</mi></msub><mo id="S2.E3X.3.2.2.m1.1.2.5">,</mo><msubsup id="S2.E3X.3.2.2.m1.1.2.6"><mrow id="S2.E3X.3.2.2.m1.1.2.6.2.2"><mo id="S2.E3X.3.2.2.m1.1.2.6.2.2.1">{</mo><msup id="S2.E3X.3.2.2.m1.1.2.6.2.2.2"><mi id="S2.E3X.3.2.2.m1.1.2.6.2.2.2.2">𝒛</mi><mi id="S2.E3X.3.2.2.m1.1.2.6.2.2.2.3">s</mi></msup><mo id="S2.E3X.3.2.2.m1.1.2.6.2.2.3">}</mo></mrow><mrow id="S2.E3X.3.2.2.m1.1.2.6.2.3"><mi id="S2.E3X.3.2.2.m1.1.2.6.2.3.2">s</mi><mo id="S2.E3X.3.2.2.m1.1.2.6.2.3.1">=</mo><mn id="S2.E3X.3.2.2.m1.1.2.6.2.3.3">1</mn></mrow><mi id="S2.E3X.3.2.2.m1.1.2.6.3">S</mi></msubsup><mo id="S2.E3X.3.2.2.m1.1.2.7">)</mo></mrow><mo id="S2.E3X.3.2.2.m1.1.3">=</mo><mstyle displaystyle="true" id="S2.E3X.3.2.2.m1.1.4"><munderover id="S2.E3X.3.2.2.m1.1.4a"><mo movablelimits="false" id="S2.E3X.3.2.2.m1.1.4.2.2">∑</mo><mrow id="S2.E3X.3.2.2.m1.1.4.2.3"><mi id="S2.E3X.3.2.2.m1.1.4.2.3.2">m</mi><mo id="S2.E3X.3.2.2.m1.1.4.2.3.1">=</mo><mn id="S2.E3X.3.2.2.m1.1.4.2.3.3">1</mn></mrow><mi id="S2.E3X.3.2.2.m1.1.4.3">M</mi></munderover></mstyle><msub id="S2.E3X.3.2.2.m1.1.5"><mi id="S2.E3X.3.2.2.m1.1.5.2">𝑾</mi><mi id="S2.E3X.3.2.2.m1.1.5.3">m</mi></msub><mo lspace="0.222em" id="S2.E3X.3.2.2.m1.1.6">⋅</mo></mrow><annotation encoding="application/x-tex" id="S2.E3X.3.2.2.m1.1c">\displaystyle\operatorname{DeformAttn}\left(\boldsymbol{z}_{q},\hat{\boldsymbol{p}}_{q},\left\{\boldsymbol{z}^{s}\right\}_{s=1}^{S}\right)=\sum_{m=1}^{M}\boldsymbol{W}_{m}\cdot</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(3)</span></td>
</tr>
<tr id="S2.E3Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E3Xa.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\left[\sum_{s=1}^{S}\sum_{k=1}^{K}A_{msqk}\cdot\boldsymbol{W}_{m}^{\prime}\boldsymbol{z}^{s}\left(\phi_{s}\left(\hat{\boldsymbol{p}}_{q}\right)+\Delta\boldsymbol{p}_{msqk}\right)\right]," display="inline"><semantics id="S2.E3Xa.2.1.1.m1.1a"><mrow id="S2.E3Xa.2.1.1.m1.1.1.1"><mrow id="S2.E3Xa.2.1.1.m1.1.1.1.1.1" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.2.cmml"><mo id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.2" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.2.1.cmml">[</mo><mrow id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.2" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.2.cmml"><munderover id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.2a" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.2.cmml"><mo movablelimits="false" id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.2.2.2" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.2.2.3" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.2.2.3.2" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.2.2.3.2.cmml">s</mi><mo id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.2.2.3.1" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.2.2.3.3" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.2.3" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.2.3.cmml">S</mi></munderover></mstyle><mrow id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2.cmml"><munderover id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2a" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2.cmml"><mo movablelimits="false" id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.2" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.3" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.3.2" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.3.2.cmml">k</mi><mo id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.3.1" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.3.3" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2.3" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2.3.cmml">K</mi></munderover></mstyle><mrow id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.cmml"><msub id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.2" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.2.cmml">A</mi><mrow id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.3" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.3.cmml"><mi id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.3.2" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.3.1" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.3.3" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.3.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.3.1a" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.3.4" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.3.4.cmml">q</mi><mo lspace="0em" rspace="0em" id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.3.1b" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.3.5" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.3.5.cmml">k</mi></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.1" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.1.cmml">⋅</mo><msubsup id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.2.2" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.2.2.cmml">𝑾</mi><mi id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.2.3" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.2.3.cmml">m</mi><mo id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.3" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.3.cmml">′</mo></msubsup></mrow><mo lspace="0em" rspace="0em" id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.cmml">​</mo><msup id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.cmml"><mi id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.2" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.cmml">𝒛</mi><mi id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.3" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.3.cmml">s</mi></msup><mo lspace="0em" rspace="0em" id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2a" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">ϕ</mi><mi id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">s</mi></msub><mo lspace="0em" rspace="0em" id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝒑</mi><mo id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">q</mi></msub><mo id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">+</mo><mrow id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi mathvariant="normal" id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><msub id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">𝒑</mi><mrow id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml"><mi id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.2" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.1" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.1.cmml">​</mo><mi id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.3" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.1a" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.1.cmml">​</mo><mi id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.4" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.4.cmml">q</mi><mo lspace="0em" rspace="0em" id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.1b" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.1.cmml">​</mo><mi id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.5" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.5.cmml">k</mi></mrow></msub></mrow></mrow><mo id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.3" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.2.1.cmml">]</mo></mrow><mo id="S2.E3Xa.2.1.1.m1.1.1.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3Xa.2.1.1.m1.1b"><apply id="S2.E3Xa.2.1.1.m1.1.1.1.1.2.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E3Xa.2.1.1.m1.1.1.1.1.2.1.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1"><apply id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.2.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.2.1.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.2.2.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.2">subscript</csymbol><sum id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.2.2.2"></sum><apply id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.2.2.3"><eq id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.2.2.3.1"></eq><ci id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.2.2.3.2">𝑠</ci><cn type="integer" id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.2.3.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.2.3">𝑆</ci></apply><apply id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1"><apply id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2">subscript</csymbol><sum id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.2"></sum><apply id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.3"><eq id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.3.1"></eq><ci id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.3.2">𝑘</ci><cn type="integer" id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2.3">𝐾</ci></apply><apply id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1"><times id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2"></times><apply id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3"><ci id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.1">⋅</ci><apply id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.2">𝐴</ci><apply id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.3"><times id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.3.1.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.3.1"></times><ci id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.3.2.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.3.2">𝑚</ci><ci id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.3.3.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.3.3">𝑠</ci><ci id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.3.4.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.3.4">𝑞</ci><ci id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.3.5.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.3.5">𝑘</ci></apply></apply><apply id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3">superscript</csymbol><apply id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.2.1.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.2.2.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.2.2">𝑾</ci><ci id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.2.3.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.2.3">𝑚</ci></apply><ci id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.3">′</ci></apply></apply><apply id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.1.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4">superscript</csymbol><ci id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.2.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.2">𝒛</ci><ci id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.3.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.4.3">𝑠</ci></apply><apply id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1"><plus id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2"></plus><apply id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1"><times id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">italic-ϕ</ci><ci id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑠</ci></apply><apply id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><ci id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1">^</ci><ci id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝒑</ci></apply><ci id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑞</ci></apply></apply><apply id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3"><times id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.1"></times><ci id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2">Δ</ci><apply id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2">𝒑</ci><apply id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3"><times id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.1.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.1"></times><ci id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.2.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.2">𝑚</ci><ci id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.3.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.3">𝑠</ci><ci id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.4.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.4">𝑞</ci><ci id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.5.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.5">𝑘</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3Xa.2.1.1.m1.1c">\displaystyle\left[\sum_{s=1}^{S}\sum_{k=1}^{K}A_{msqk}\cdot\boldsymbol{W}_{m}^{\prime}\boldsymbol{z}^{s}\left(\phi_{s}\left(\hat{\boldsymbol{p}}_{q}\right)+\Delta\boldsymbol{p}_{msqk}\right)\right],</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S2.SS3.SSS1.p2.6" class="ltx_p">where <math id="S2.SS3.SSS1.p2.1.m1.1" class="ltx_Math" alttext="\phi_{s}\left(\hat{\boldsymbol{p}}_{q}\right)" display="inline"><semantics id="S2.SS3.SSS1.p2.1.m1.1a"><mrow id="S2.SS3.SSS1.p2.1.m1.1.1" xref="S2.SS3.SSS1.p2.1.m1.1.1.cmml"><msub id="S2.SS3.SSS1.p2.1.m1.1.1.3" xref="S2.SS3.SSS1.p2.1.m1.1.1.3.cmml"><mi id="S2.SS3.SSS1.p2.1.m1.1.1.3.2" xref="S2.SS3.SSS1.p2.1.m1.1.1.3.2.cmml">ϕ</mi><mi id="S2.SS3.SSS1.p2.1.m1.1.1.3.3" xref="S2.SS3.SSS1.p2.1.m1.1.1.3.3.cmml">s</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS3.SSS1.p2.1.m1.1.1.2" xref="S2.SS3.SSS1.p2.1.m1.1.1.2.cmml">​</mo><mrow id="S2.SS3.SSS1.p2.1.m1.1.1.1.1" xref="S2.SS3.SSS1.p2.1.m1.1.1.1.1.1.cmml"><mo id="S2.SS3.SSS1.p2.1.m1.1.1.1.1.2" xref="S2.SS3.SSS1.p2.1.m1.1.1.1.1.1.cmml">(</mo><msub id="S2.SS3.SSS1.p2.1.m1.1.1.1.1.1" xref="S2.SS3.SSS1.p2.1.m1.1.1.1.1.1.cmml"><mover accent="true" id="S2.SS3.SSS1.p2.1.m1.1.1.1.1.1.2" xref="S2.SS3.SSS1.p2.1.m1.1.1.1.1.1.2.cmml"><mi id="S2.SS3.SSS1.p2.1.m1.1.1.1.1.1.2.2" xref="S2.SS3.SSS1.p2.1.m1.1.1.1.1.1.2.2.cmml">𝒑</mi><mo id="S2.SS3.SSS1.p2.1.m1.1.1.1.1.1.2.1" xref="S2.SS3.SSS1.p2.1.m1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S2.SS3.SSS1.p2.1.m1.1.1.1.1.1.3" xref="S2.SS3.SSS1.p2.1.m1.1.1.1.1.1.3.cmml">q</mi></msub><mo id="S2.SS3.SSS1.p2.1.m1.1.1.1.1.3" xref="S2.SS3.SSS1.p2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p2.1.m1.1b"><apply id="S2.SS3.SSS1.p2.1.m1.1.1.cmml" xref="S2.SS3.SSS1.p2.1.m1.1.1"><times id="S2.SS3.SSS1.p2.1.m1.1.1.2.cmml" xref="S2.SS3.SSS1.p2.1.m1.1.1.2"></times><apply id="S2.SS3.SSS1.p2.1.m1.1.1.3.cmml" xref="S2.SS3.SSS1.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p2.1.m1.1.1.3.1.cmml" xref="S2.SS3.SSS1.p2.1.m1.1.1.3">subscript</csymbol><ci id="S2.SS3.SSS1.p2.1.m1.1.1.3.2.cmml" xref="S2.SS3.SSS1.p2.1.m1.1.1.3.2">italic-ϕ</ci><ci id="S2.SS3.SSS1.p2.1.m1.1.1.3.3.cmml" xref="S2.SS3.SSS1.p2.1.m1.1.1.3.3">𝑠</ci></apply><apply id="S2.SS3.SSS1.p2.1.m1.1.1.1.1.1.cmml" xref="S2.SS3.SSS1.p2.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p2.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS3.SSS1.p2.1.m1.1.1.1.1">subscript</csymbol><apply id="S2.SS3.SSS1.p2.1.m1.1.1.1.1.1.2.cmml" xref="S2.SS3.SSS1.p2.1.m1.1.1.1.1.1.2"><ci id="S2.SS3.SSS1.p2.1.m1.1.1.1.1.1.2.1.cmml" xref="S2.SS3.SSS1.p2.1.m1.1.1.1.1.1.2.1">^</ci><ci id="S2.SS3.SSS1.p2.1.m1.1.1.1.1.1.2.2.cmml" xref="S2.SS3.SSS1.p2.1.m1.1.1.1.1.1.2.2">𝒑</ci></apply><ci id="S2.SS3.SSS1.p2.1.m1.1.1.1.1.1.3.cmml" xref="S2.SS3.SSS1.p2.1.m1.1.1.1.1.1.3">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p2.1.m1.1c">\phi_{s}\left(\hat{\boldsymbol{p}}_{q}\right)</annotation></semantics></math> re-scales the normalized coordinates <math id="S2.SS3.SSS1.p2.2.m2.1" class="ltx_Math" alttext="\hat{\boldsymbol{p}}_{q}" display="inline"><semantics id="S2.SS3.SSS1.p2.2.m2.1a"><msub id="S2.SS3.SSS1.p2.2.m2.1.1" xref="S2.SS3.SSS1.p2.2.m2.1.1.cmml"><mover accent="true" id="S2.SS3.SSS1.p2.2.m2.1.1.2" xref="S2.SS3.SSS1.p2.2.m2.1.1.2.cmml"><mi id="S2.SS3.SSS1.p2.2.m2.1.1.2.2" xref="S2.SS3.SSS1.p2.2.m2.1.1.2.2.cmml">𝒑</mi><mo id="S2.SS3.SSS1.p2.2.m2.1.1.2.1" xref="S2.SS3.SSS1.p2.2.m2.1.1.2.1.cmml">^</mo></mover><mi id="S2.SS3.SSS1.p2.2.m2.1.1.3" xref="S2.SS3.SSS1.p2.2.m2.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p2.2.m2.1b"><apply id="S2.SS3.SSS1.p2.2.m2.1.1.cmml" xref="S2.SS3.SSS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p2.2.m2.1.1.1.cmml" xref="S2.SS3.SSS1.p2.2.m2.1.1">subscript</csymbol><apply id="S2.SS3.SSS1.p2.2.m2.1.1.2.cmml" xref="S2.SS3.SSS1.p2.2.m2.1.1.2"><ci id="S2.SS3.SSS1.p2.2.m2.1.1.2.1.cmml" xref="S2.SS3.SSS1.p2.2.m2.1.1.2.1">^</ci><ci id="S2.SS3.SSS1.p2.2.m2.1.1.2.2.cmml" xref="S2.SS3.SSS1.p2.2.m2.1.1.2.2">𝒑</ci></apply><ci id="S2.SS3.SSS1.p2.2.m2.1.1.3.cmml" xref="S2.SS3.SSS1.p2.2.m2.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p2.2.m2.1c">\hat{\boldsymbol{p}}_{q}</annotation></semantics></math> to the input feature map of the <math id="S2.SS3.SSS1.p2.3.m3.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S2.SS3.SSS1.p2.3.m3.1a"><mi id="S2.SS3.SSS1.p2.3.m3.1.1" xref="S2.SS3.SSS1.p2.3.m3.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p2.3.m3.1b"><ci id="S2.SS3.SSS1.p2.3.m3.1.1.cmml" xref="S2.SS3.SSS1.p2.3.m3.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p2.3.m3.1c">s</annotation></semantics></math>-th level, <math id="S2.SS3.SSS1.p2.4.m4.1" class="ltx_Math" alttext="\boldsymbol{W}_{m}^{\prime}\in\mathbb{R}^{C_{v}\times C}" display="inline"><semantics id="S2.SS3.SSS1.p2.4.m4.1a"><mrow id="S2.SS3.SSS1.p2.4.m4.1.1" xref="S2.SS3.SSS1.p2.4.m4.1.1.cmml"><msubsup id="S2.SS3.SSS1.p2.4.m4.1.1.2" xref="S2.SS3.SSS1.p2.4.m4.1.1.2.cmml"><mi id="S2.SS3.SSS1.p2.4.m4.1.1.2.2.2" xref="S2.SS3.SSS1.p2.4.m4.1.1.2.2.2.cmml">𝑾</mi><mi id="S2.SS3.SSS1.p2.4.m4.1.1.2.2.3" xref="S2.SS3.SSS1.p2.4.m4.1.1.2.2.3.cmml">m</mi><mo id="S2.SS3.SSS1.p2.4.m4.1.1.2.3" xref="S2.SS3.SSS1.p2.4.m4.1.1.2.3.cmml">′</mo></msubsup><mo id="S2.SS3.SSS1.p2.4.m4.1.1.1" xref="S2.SS3.SSS1.p2.4.m4.1.1.1.cmml">∈</mo><msup id="S2.SS3.SSS1.p2.4.m4.1.1.3" xref="S2.SS3.SSS1.p2.4.m4.1.1.3.cmml"><mi id="S2.SS3.SSS1.p2.4.m4.1.1.3.2" xref="S2.SS3.SSS1.p2.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS3.SSS1.p2.4.m4.1.1.3.3" xref="S2.SS3.SSS1.p2.4.m4.1.1.3.3.cmml"><msub id="S2.SS3.SSS1.p2.4.m4.1.1.3.3.2" xref="S2.SS3.SSS1.p2.4.m4.1.1.3.3.2.cmml"><mi id="S2.SS3.SSS1.p2.4.m4.1.1.3.3.2.2" xref="S2.SS3.SSS1.p2.4.m4.1.1.3.3.2.2.cmml">C</mi><mi id="S2.SS3.SSS1.p2.4.m4.1.1.3.3.2.3" xref="S2.SS3.SSS1.p2.4.m4.1.1.3.3.2.3.cmml">v</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S2.SS3.SSS1.p2.4.m4.1.1.3.3.1" xref="S2.SS3.SSS1.p2.4.m4.1.1.3.3.1.cmml">×</mo><mi id="S2.SS3.SSS1.p2.4.m4.1.1.3.3.3" xref="S2.SS3.SSS1.p2.4.m4.1.1.3.3.3.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p2.4.m4.1b"><apply id="S2.SS3.SSS1.p2.4.m4.1.1.cmml" xref="S2.SS3.SSS1.p2.4.m4.1.1"><in id="S2.SS3.SSS1.p2.4.m4.1.1.1.cmml" xref="S2.SS3.SSS1.p2.4.m4.1.1.1"></in><apply id="S2.SS3.SSS1.p2.4.m4.1.1.2.cmml" xref="S2.SS3.SSS1.p2.4.m4.1.1.2"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p2.4.m4.1.1.2.1.cmml" xref="S2.SS3.SSS1.p2.4.m4.1.1.2">superscript</csymbol><apply id="S2.SS3.SSS1.p2.4.m4.1.1.2.2.cmml" xref="S2.SS3.SSS1.p2.4.m4.1.1.2"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p2.4.m4.1.1.2.2.1.cmml" xref="S2.SS3.SSS1.p2.4.m4.1.1.2">subscript</csymbol><ci id="S2.SS3.SSS1.p2.4.m4.1.1.2.2.2.cmml" xref="S2.SS3.SSS1.p2.4.m4.1.1.2.2.2">𝑾</ci><ci id="S2.SS3.SSS1.p2.4.m4.1.1.2.2.3.cmml" xref="S2.SS3.SSS1.p2.4.m4.1.1.2.2.3">𝑚</ci></apply><ci id="S2.SS3.SSS1.p2.4.m4.1.1.2.3.cmml" xref="S2.SS3.SSS1.p2.4.m4.1.1.2.3">′</ci></apply><apply id="S2.SS3.SSS1.p2.4.m4.1.1.3.cmml" xref="S2.SS3.SSS1.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p2.4.m4.1.1.3.1.cmml" xref="S2.SS3.SSS1.p2.4.m4.1.1.3">superscript</csymbol><ci id="S2.SS3.SSS1.p2.4.m4.1.1.3.2.cmml" xref="S2.SS3.SSS1.p2.4.m4.1.1.3.2">ℝ</ci><apply id="S2.SS3.SSS1.p2.4.m4.1.1.3.3.cmml" xref="S2.SS3.SSS1.p2.4.m4.1.1.3.3"><times id="S2.SS3.SSS1.p2.4.m4.1.1.3.3.1.cmml" xref="S2.SS3.SSS1.p2.4.m4.1.1.3.3.1"></times><apply id="S2.SS3.SSS1.p2.4.m4.1.1.3.3.2.cmml" xref="S2.SS3.SSS1.p2.4.m4.1.1.3.3.2"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p2.4.m4.1.1.3.3.2.1.cmml" xref="S2.SS3.SSS1.p2.4.m4.1.1.3.3.2">subscript</csymbol><ci id="S2.SS3.SSS1.p2.4.m4.1.1.3.3.2.2.cmml" xref="S2.SS3.SSS1.p2.4.m4.1.1.3.3.2.2">𝐶</ci><ci id="S2.SS3.SSS1.p2.4.m4.1.1.3.3.2.3.cmml" xref="S2.SS3.SSS1.p2.4.m4.1.1.3.3.2.3">𝑣</ci></apply><ci id="S2.SS3.SSS1.p2.4.m4.1.1.3.3.3.cmml" xref="S2.SS3.SSS1.p2.4.m4.1.1.3.3.3">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p2.4.m4.1c">\boldsymbol{W}_{m}^{\prime}\in\mathbb{R}^{C_{v}\times C}</annotation></semantics></math>and <math id="S2.SS3.SSS1.p2.5.m5.1" class="ltx_Math" alttext="\boldsymbol{W}_{m}\in\mathbb{R}^{C\times C_{v}}" display="inline"><semantics id="S2.SS3.SSS1.p2.5.m5.1a"><mrow id="S2.SS3.SSS1.p2.5.m5.1.1" xref="S2.SS3.SSS1.p2.5.m5.1.1.cmml"><msub id="S2.SS3.SSS1.p2.5.m5.1.1.2" xref="S2.SS3.SSS1.p2.5.m5.1.1.2.cmml"><mi id="S2.SS3.SSS1.p2.5.m5.1.1.2.2" xref="S2.SS3.SSS1.p2.5.m5.1.1.2.2.cmml">𝑾</mi><mi id="S2.SS3.SSS1.p2.5.m5.1.1.2.3" xref="S2.SS3.SSS1.p2.5.m5.1.1.2.3.cmml">m</mi></msub><mo id="S2.SS3.SSS1.p2.5.m5.1.1.1" xref="S2.SS3.SSS1.p2.5.m5.1.1.1.cmml">∈</mo><msup id="S2.SS3.SSS1.p2.5.m5.1.1.3" xref="S2.SS3.SSS1.p2.5.m5.1.1.3.cmml"><mi id="S2.SS3.SSS1.p2.5.m5.1.1.3.2" xref="S2.SS3.SSS1.p2.5.m5.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS3.SSS1.p2.5.m5.1.1.3.3" xref="S2.SS3.SSS1.p2.5.m5.1.1.3.3.cmml"><mi id="S2.SS3.SSS1.p2.5.m5.1.1.3.3.2" xref="S2.SS3.SSS1.p2.5.m5.1.1.3.3.2.cmml">C</mi><mo lspace="0.222em" rspace="0.222em" id="S2.SS3.SSS1.p2.5.m5.1.1.3.3.1" xref="S2.SS3.SSS1.p2.5.m5.1.1.3.3.1.cmml">×</mo><msub id="S2.SS3.SSS1.p2.5.m5.1.1.3.3.3" xref="S2.SS3.SSS1.p2.5.m5.1.1.3.3.3.cmml"><mi id="S2.SS3.SSS1.p2.5.m5.1.1.3.3.3.2" xref="S2.SS3.SSS1.p2.5.m5.1.1.3.3.3.2.cmml">C</mi><mi id="S2.SS3.SSS1.p2.5.m5.1.1.3.3.3.3" xref="S2.SS3.SSS1.p2.5.m5.1.1.3.3.3.3.cmml">v</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p2.5.m5.1b"><apply id="S2.SS3.SSS1.p2.5.m5.1.1.cmml" xref="S2.SS3.SSS1.p2.5.m5.1.1"><in id="S2.SS3.SSS1.p2.5.m5.1.1.1.cmml" xref="S2.SS3.SSS1.p2.5.m5.1.1.1"></in><apply id="S2.SS3.SSS1.p2.5.m5.1.1.2.cmml" xref="S2.SS3.SSS1.p2.5.m5.1.1.2"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p2.5.m5.1.1.2.1.cmml" xref="S2.SS3.SSS1.p2.5.m5.1.1.2">subscript</csymbol><ci id="S2.SS3.SSS1.p2.5.m5.1.1.2.2.cmml" xref="S2.SS3.SSS1.p2.5.m5.1.1.2.2">𝑾</ci><ci id="S2.SS3.SSS1.p2.5.m5.1.1.2.3.cmml" xref="S2.SS3.SSS1.p2.5.m5.1.1.2.3">𝑚</ci></apply><apply id="S2.SS3.SSS1.p2.5.m5.1.1.3.cmml" xref="S2.SS3.SSS1.p2.5.m5.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p2.5.m5.1.1.3.1.cmml" xref="S2.SS3.SSS1.p2.5.m5.1.1.3">superscript</csymbol><ci id="S2.SS3.SSS1.p2.5.m5.1.1.3.2.cmml" xref="S2.SS3.SSS1.p2.5.m5.1.1.3.2">ℝ</ci><apply id="S2.SS3.SSS1.p2.5.m5.1.1.3.3.cmml" xref="S2.SS3.SSS1.p2.5.m5.1.1.3.3"><times id="S2.SS3.SSS1.p2.5.m5.1.1.3.3.1.cmml" xref="S2.SS3.SSS1.p2.5.m5.1.1.3.3.1"></times><ci id="S2.SS3.SSS1.p2.5.m5.1.1.3.3.2.cmml" xref="S2.SS3.SSS1.p2.5.m5.1.1.3.3.2">𝐶</ci><apply id="S2.SS3.SSS1.p2.5.m5.1.1.3.3.3.cmml" xref="S2.SS3.SSS1.p2.5.m5.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p2.5.m5.1.1.3.3.3.1.cmml" xref="S2.SS3.SSS1.p2.5.m5.1.1.3.3.3">subscript</csymbol><ci id="S2.SS3.SSS1.p2.5.m5.1.1.3.3.3.2.cmml" xref="S2.SS3.SSS1.p2.5.m5.1.1.3.3.3.2">𝐶</ci><ci id="S2.SS3.SSS1.p2.5.m5.1.1.3.3.3.3.cmml" xref="S2.SS3.SSS1.p2.5.m5.1.1.3.3.3.3">𝑣</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p2.5.m5.1c">\boldsymbol{W}_{m}\in\mathbb{R}^{C\times C_{v}}</annotation></semantics></math> are of learnable weights (<math id="S2.SS3.SSS1.p2.6.m6.1" class="ltx_Math" alttext="C_{v}=C/M" display="inline"><semantics id="S2.SS3.SSS1.p2.6.m6.1a"><mrow id="S2.SS3.SSS1.p2.6.m6.1.1" xref="S2.SS3.SSS1.p2.6.m6.1.1.cmml"><msub id="S2.SS3.SSS1.p2.6.m6.1.1.2" xref="S2.SS3.SSS1.p2.6.m6.1.1.2.cmml"><mi id="S2.SS3.SSS1.p2.6.m6.1.1.2.2" xref="S2.SS3.SSS1.p2.6.m6.1.1.2.2.cmml">C</mi><mi id="S2.SS3.SSS1.p2.6.m6.1.1.2.3" xref="S2.SS3.SSS1.p2.6.m6.1.1.2.3.cmml">v</mi></msub><mo id="S2.SS3.SSS1.p2.6.m6.1.1.1" xref="S2.SS3.SSS1.p2.6.m6.1.1.1.cmml">=</mo><mrow id="S2.SS3.SSS1.p2.6.m6.1.1.3" xref="S2.SS3.SSS1.p2.6.m6.1.1.3.cmml"><mi id="S2.SS3.SSS1.p2.6.m6.1.1.3.2" xref="S2.SS3.SSS1.p2.6.m6.1.1.3.2.cmml">C</mi><mo id="S2.SS3.SSS1.p2.6.m6.1.1.3.1" xref="S2.SS3.SSS1.p2.6.m6.1.1.3.1.cmml">/</mo><mi id="S2.SS3.SSS1.p2.6.m6.1.1.3.3" xref="S2.SS3.SSS1.p2.6.m6.1.1.3.3.cmml">M</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p2.6.m6.1b"><apply id="S2.SS3.SSS1.p2.6.m6.1.1.cmml" xref="S2.SS3.SSS1.p2.6.m6.1.1"><eq id="S2.SS3.SSS1.p2.6.m6.1.1.1.cmml" xref="S2.SS3.SSS1.p2.6.m6.1.1.1"></eq><apply id="S2.SS3.SSS1.p2.6.m6.1.1.2.cmml" xref="S2.SS3.SSS1.p2.6.m6.1.1.2"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p2.6.m6.1.1.2.1.cmml" xref="S2.SS3.SSS1.p2.6.m6.1.1.2">subscript</csymbol><ci id="S2.SS3.SSS1.p2.6.m6.1.1.2.2.cmml" xref="S2.SS3.SSS1.p2.6.m6.1.1.2.2">𝐶</ci><ci id="S2.SS3.SSS1.p2.6.m6.1.1.2.3.cmml" xref="S2.SS3.SSS1.p2.6.m6.1.1.2.3">𝑣</ci></apply><apply id="S2.SS3.SSS1.p2.6.m6.1.1.3.cmml" xref="S2.SS3.SSS1.p2.6.m6.1.1.3"><divide id="S2.SS3.SSS1.p2.6.m6.1.1.3.1.cmml" xref="S2.SS3.SSS1.p2.6.m6.1.1.3.1"></divide><ci id="S2.SS3.SSS1.p2.6.m6.1.1.3.2.cmml" xref="S2.SS3.SSS1.p2.6.m6.1.1.3.2">𝐶</ci><ci id="S2.SS3.SSS1.p2.6.m6.1.1.3.3.cmml" xref="S2.SS3.SSS1.p2.6.m6.1.1.3.3">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p2.6.m6.1c">C_{v}=C/M</annotation></semantics></math>).</p>
</div>
</section>
<section id="S2.SS3.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S2.SS3.SSS2.5.1.1" class="ltx_text">II-C</span>2 </span>Query Selection Module</h4>

<div id="S2.SS3.SSS2.p1" class="ltx_para">
<p id="S2.SS3.SSS2.p1.1" class="ltx_p">As shown on the right side of Figure <a href="#S2.F3" title="Figure 3 ‣ II-C Multi-Scale Deformable Attention Neck ‣ II Proposed Method ‣ Concealed Object Detection for Passive Millimeter-Wave Security Imaging Based on Task-Aligned Detection Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, the object queries used as input to the decoder contain spatial queries and content queries<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>, <a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>. In DETR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>, both queries are randomly initialized as static embeddings without using any encoder features as spatial prior. For the spatial queries, DAB-DETR<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite> has proved that anchor boxes are better queries for DETR, which learns anchor boxes directly instead of learning the spatial queries. For the content queries, DETR set them as all zero vectors, while Deformable DETR<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> learns content queries together with the spatial queries, which is an alternative approach to implementing query initialization. Furthermore, Deformable DETR also has a similar query selection module that is called ”two-stage”, that is, both the spatial and content queries are generated by the top-K selected features. Similarly, Efficient DETR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite> also selects top-K features based on the classification score of each image spatial feature. Furthermore, rather than the static 2d queries in DETR, the initialization of dynamic 4d anchor boxes in PMMW-DETR makes it more closely related to spatial queries so that it can be spatial prior to being introduced by query selection.</p>
</div>
<div id="S2.SS3.SSS2.p2" class="ltx_para">
<p id="S2.SS3.SSS2.p2.1" class="ltx_p">Inspired by the above practice<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>, <a href="#bib.bib26" title="" class="ltx_ref">26</a>, <a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite>, we propose a query selection module that combines the static content queries initialization and the dynamic anchor queries selection. Dynamic anchor queries are helpful to enhance spatial queries. However, since the multi-scale features contain rich content information, we make content queries static and learnable to avoid introducing incomplete objects that may lose information and mislead the decoder. To give more detail, as shown in Figure <a href="#S2.F3" title="Figure 3 ‣ II-C Multi-Scale Deformable Attention Neck ‣ II Proposed Method ‣ Concealed Object Detection for Passive Millimeter-Wave Security Imaging Based on Task-Aligned Detection Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, the output multi-scale features are first embedded into classification scores and anchors by the class embedding layer and anchor embedding layer, respectively. Then we select the top-K anchors as proposals based on the classification score. Finally, we obtain dynamic anchor queries by encoding the selected anchor proposals while initializing the static content queries as original DETR.</p>
</div>
<div id="S2.SS3.SSS2.p3" class="ltx_para">
<p id="S2.SS3.SSS2.p3.1" class="ltx_p">By the query selection module, the decoder of PMMW-DETR learns the spatial distribution information directly from the feature maps output by the encoder, instead of starting from zero with blind queries. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> has shown that object queries will query the object in its spatial distribution range, and the human security images happen to all have a human body as the subject with high similarity. Besides, as mentioned above, in order to avoid misleading the network, we refine the content queries layer by layer. The detailed comparative ablation experiments are given in Section <a href="#S3.SS4" title="III-D Ablation Study ‣ III Experiments and Results ‣ Concealed Object Detection for Passive Millimeter-Wave Security Imaging Based on Task-Aligned Detection Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">III-D</span></span></a>.</p>
</div>
</section>
</section>
<section id="S2.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS4.5.1.1" class="ltx_text">II-D</span> </span><span id="S2.SS4.6.2" class="ltx_text ltx_font_italic">Task-Aligned Dual-Head Block</span>
</h3>

<figure id="S2.F4" class="ltx_figure"><img src="/html/2212.00313/assets/x4.png" id="S2.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="393" height="259" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Previous end-to-end detectors like DETR and Deformable DETR (a) and ours (b).</figcaption>
</figure>
<div id="S2.SS4.p1" class="ltx_para">
<p id="S2.SS4.p1.1" class="ltx_p">Most current concealed object detection networks share a head for both classification and bounding box regression. However, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>, <a href="#bib.bib37" title="" class="ltx_ref">37</a>, <a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite> have proved that there is a spatial misalignment between classification and regression tasks. This misalignment can be explained from two aspect. In the one hand, the two tasks have different sensitive locations for the same object. For example, some salient areas may be beneficial for classification while the boundary might have rich information for regression. The spatial task misalignment greatly limits the performance of concealed object detection. Therefore, we propose a task-aligned dual-head block. We perform concealed object classification and regression independently by using two independent branches in parallel heads. But such a two-branch design might lead to a lack of interaction between the two tasks, resulting in inconsistent predictions when performing them, <span id="S2.SS4.p1.1.1" class="ltx_text ltx_font_italic">i.e. </span> two different decoders focus on regions that are too far apart from each other, which creates a spatial misalignment on the other hand. So these two problems can be jointly modeled as a trade-off between task decoupling and spatial consistency of two parallel branches. To avoid this problem, we propose query sharing to explicitly align the two tasks with the sharing query cross attention.</p>
</div>
<div id="S2.SS4.p2" class="ltx_para">
<p id="S2.SS4.p2.1" class="ltx_p">As shown in Figure <a href="#S2.F4" title="Figure 4 ‣ II-D Task-Aligned Dual-Head Block ‣ II Proposed Method ‣ Concealed Object Detection for Passive Millimeter-Wave Security Imaging Based on Task-Aligned Detection Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, the proposed task-aligned dual-head block has two different types of decoder layers with query sharing modules. Different from the six-layer structure of the original DETR decoder, we design a decoder layer with two branches and add the decoder to the head to refine the features. The dual-head design achieves decoupling the classification and regression tasks, avoiding the inherent conflict between these two tasks. The regression head consists of regression layers on the left, and on the right side is the classification head consisting of classification layers. The regression layers and classification layers are three layers each, and the total number of layers is 6, which is consistent with the original DETR. In the PMMW-DETR network, the regression layer is responsible for refining the anchor boxes, while the classification layer refines the class labels. Therefore, in the following, we call the regression layer the anchor refinement layer and the classification layer the class refinement layer.</p>
</div>
<figure id="S2.F5" class="ltx_figure"><img src="/html/2212.00313/assets/x5.png" id="S2.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="453" height="277" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>The illustration of the task-aligned dual-head block. Three task-aligned dual-headed blocks consist of the decoder.</figcaption>
</figure>
<div id="S2.SS4.p3" class="ltx_para">
<p id="S2.SS4.p3.11" class="ltx_p">Figure <a href="#S2.F5" title="Figure 5 ‣ II-D Task-Aligned Dual-Head Block ‣ II Proposed Method ‣ Concealed Object Detection for Passive Millimeter-Wave Security Imaging Based on Task-Aligned Detection Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> shows the specific data flow of the task-aligned dual-head block. Each block layer includes a self-attention module and a cross-attention module. The self-attention module is used for query updating, and can be expressed as:</p>
<table id="S2.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E4.m1.17" class="ltx_Math" alttext="\begin{split}\operatorname{SelfAttn}(Q,K,V)=\operatorname{softmax}\left(\frac{QK^{T}}{\sqrt{d}}\right)V,\end{split}" display="block"><semantics id="S2.E4.m1.17a"><mtable displaystyle="true" id="S2.E4.m1.17.17.2"><mtr id="S2.E4.m1.17.17.2a"><mtd class="ltx_align_right" columnalign="right" id="S2.E4.m1.17.17.2b"><mrow id="S2.E4.m1.17.17.2.16.16.16.16"><mrow id="S2.E4.m1.17.17.2.16.16.16.16.1"><mrow id="S2.E4.m1.17.17.2.16.16.16.16.1.1"><mi id="S2.E4.m1.1.1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.1.1.cmml">SelfAttn</mi><mo id="S2.E4.m1.17.17.2.16.16.16.16.1.1a" xref="S2.E4.m1.16.16.1.1.1.cmml">⁡</mo><mrow id="S2.E4.m1.17.17.2.16.16.16.16.1.1.1"><mo stretchy="false" id="S2.E4.m1.2.2.2.2.2.2" xref="S2.E4.m1.16.16.1.1.1.cmml">(</mo><mi id="S2.E4.m1.3.3.3.3.3.3" xref="S2.E4.m1.3.3.3.3.3.3.cmml">Q</mi><mo id="S2.E4.m1.4.4.4.4.4.4" xref="S2.E4.m1.16.16.1.1.1.cmml">,</mo><mi id="S2.E4.m1.5.5.5.5.5.5" xref="S2.E4.m1.5.5.5.5.5.5.cmml">K</mi><mo id="S2.E4.m1.6.6.6.6.6.6" xref="S2.E4.m1.16.16.1.1.1.cmml">,</mo><mi id="S2.E4.m1.7.7.7.7.7.7" xref="S2.E4.m1.7.7.7.7.7.7.cmml">V</mi><mo stretchy="false" id="S2.E4.m1.8.8.8.8.8.8" xref="S2.E4.m1.16.16.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E4.m1.9.9.9.9.9.9" xref="S2.E4.m1.9.9.9.9.9.9.cmml">=</mo><mrow id="S2.E4.m1.17.17.2.16.16.16.16.1.2"><mrow id="S2.E4.m1.17.17.2.16.16.16.16.1.2.2"><mi id="S2.E4.m1.10.10.10.10.10.10" xref="S2.E4.m1.10.10.10.10.10.10.cmml">softmax</mi><mo id="S2.E4.m1.17.17.2.16.16.16.16.1.2.2a" xref="S2.E4.m1.16.16.1.1.1.cmml">⁡</mo><mrow id="S2.E4.m1.17.17.2.16.16.16.16.1.2.2.1"><mo id="S2.E4.m1.11.11.11.11.11.11" xref="S2.E4.m1.16.16.1.1.1.cmml">(</mo><mfrac id="S2.E4.m1.12.12.12.12.12.12" xref="S2.E4.m1.12.12.12.12.12.12.cmml"><mrow id="S2.E4.m1.12.12.12.12.12.12.2" xref="S2.E4.m1.12.12.12.12.12.12.2.cmml"><mi id="S2.E4.m1.12.12.12.12.12.12.2.2" xref="S2.E4.m1.12.12.12.12.12.12.2.2.cmml">Q</mi><mo lspace="0em" rspace="0em" id="S2.E4.m1.12.12.12.12.12.12.2.1" xref="S2.E4.m1.12.12.12.12.12.12.2.1.cmml">​</mo><msup id="S2.E4.m1.12.12.12.12.12.12.2.3" xref="S2.E4.m1.12.12.12.12.12.12.2.3.cmml"><mi id="S2.E4.m1.12.12.12.12.12.12.2.3.2" xref="S2.E4.m1.12.12.12.12.12.12.2.3.2.cmml">K</mi><mi id="S2.E4.m1.12.12.12.12.12.12.2.3.3" xref="S2.E4.m1.12.12.12.12.12.12.2.3.3.cmml">T</mi></msup></mrow><msqrt id="S2.E4.m1.12.12.12.12.12.12.3" xref="S2.E4.m1.12.12.12.12.12.12.3.cmml"><mi id="S2.E4.m1.12.12.12.12.12.12.3.2" xref="S2.E4.m1.12.12.12.12.12.12.3.2.cmml">d</mi></msqrt></mfrac><mo id="S2.E4.m1.13.13.13.13.13.13" xref="S2.E4.m1.16.16.1.1.1.cmml">)</mo></mrow></mrow><mo lspace="0em" rspace="0em" id="S2.E4.m1.17.17.2.16.16.16.16.1.2.1" xref="S2.E4.m1.16.16.1.1.1.cmml">​</mo><mi id="S2.E4.m1.14.14.14.14.14.14" xref="S2.E4.m1.14.14.14.14.14.14.cmml">V</mi></mrow></mrow><mo id="S2.E4.m1.15.15.15.15.15.15" xref="S2.E4.m1.16.16.1.1.1.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S2.E4.m1.17b"><apply id="S2.E4.m1.16.16.1.1.1.cmml" xref="S2.E4.m1.17.17.2.16.16.16.16.1.1a"><eq id="S2.E4.m1.9.9.9.9.9.9.cmml" xref="S2.E4.m1.9.9.9.9.9.9"></eq><apply id="S2.E4.m1.16.16.1.1.1.2.cmml" xref="S2.E4.m1.17.17.2.16.16.16.16.1.1a"><ci id="S2.E4.m1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1">SelfAttn</ci><ci id="S2.E4.m1.3.3.3.3.3.3.cmml" xref="S2.E4.m1.3.3.3.3.3.3">𝑄</ci><ci id="S2.E4.m1.5.5.5.5.5.5.cmml" xref="S2.E4.m1.5.5.5.5.5.5">𝐾</ci><ci id="S2.E4.m1.7.7.7.7.7.7.cmml" xref="S2.E4.m1.7.7.7.7.7.7">𝑉</ci></apply><apply id="S2.E4.m1.16.16.1.1.1.3.cmml" xref="S2.E4.m1.17.17.2.16.16.16.16.1.1a"><times id="S2.E4.m1.16.16.1.1.1.3.1.cmml" xref="S2.E4.m1.17.17.2.16.16.16.16.1.1a"></times><apply id="S2.E4.m1.16.16.1.1.1.3.2.cmml" xref="S2.E4.m1.17.17.2.16.16.16.16.1.1a"><ci id="S2.E4.m1.10.10.10.10.10.10.cmml" xref="S2.E4.m1.10.10.10.10.10.10">softmax</ci><apply id="S2.E4.m1.12.12.12.12.12.12.cmml" xref="S2.E4.m1.12.12.12.12.12.12"><divide id="S2.E4.m1.12.12.12.12.12.12.1.cmml" xref="S2.E4.m1.12.12.12.12.12.12"></divide><apply id="S2.E4.m1.12.12.12.12.12.12.2.cmml" xref="S2.E4.m1.12.12.12.12.12.12.2"><times id="S2.E4.m1.12.12.12.12.12.12.2.1.cmml" xref="S2.E4.m1.12.12.12.12.12.12.2.1"></times><ci id="S2.E4.m1.12.12.12.12.12.12.2.2.cmml" xref="S2.E4.m1.12.12.12.12.12.12.2.2">𝑄</ci><apply id="S2.E4.m1.12.12.12.12.12.12.2.3.cmml" xref="S2.E4.m1.12.12.12.12.12.12.2.3"><csymbol cd="ambiguous" id="S2.E4.m1.12.12.12.12.12.12.2.3.1.cmml" xref="S2.E4.m1.12.12.12.12.12.12.2.3">superscript</csymbol><ci id="S2.E4.m1.12.12.12.12.12.12.2.3.2.cmml" xref="S2.E4.m1.12.12.12.12.12.12.2.3.2">𝐾</ci><ci id="S2.E4.m1.12.12.12.12.12.12.2.3.3.cmml" xref="S2.E4.m1.12.12.12.12.12.12.2.3.3">𝑇</ci></apply></apply><apply id="S2.E4.m1.12.12.12.12.12.12.3.cmml" xref="S2.E4.m1.12.12.12.12.12.12.3"><root id="S2.E4.m1.12.12.12.12.12.12.3a.cmml" xref="S2.E4.m1.12.12.12.12.12.12.3"></root><ci id="S2.E4.m1.12.12.12.12.12.12.3.2.cmml" xref="S2.E4.m1.12.12.12.12.12.12.3.2">𝑑</ci></apply></apply></apply><ci id="S2.E4.m1.14.14.14.14.14.14.cmml" xref="S2.E4.m1.14.14.14.14.14.14">𝑉</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.17c">\begin{split}\operatorname{SelfAttn}(Q,K,V)=\operatorname{softmax}\left(\frac{QK^{T}}{\sqrt{d}}\right)V,\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S2.SS4.p3.4" class="ltx_p">where <math id="S2.SS4.p3.1.m1.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S2.SS4.p3.1.m1.1a"><mi id="S2.SS4.p3.1.m1.1.1" xref="S2.SS4.p3.1.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p3.1.m1.1b"><ci id="S2.SS4.p3.1.m1.1.1.cmml" xref="S2.SS4.p3.1.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p3.1.m1.1c">d</annotation></semantics></math> is the number of queries, and queries <math id="S2.SS4.p3.2.m2.1" class="ltx_Math" alttext="Q_{q}" display="inline"><semantics id="S2.SS4.p3.2.m2.1a"><msub id="S2.SS4.p3.2.m2.1.1" xref="S2.SS4.p3.2.m2.1.1.cmml"><mi id="S2.SS4.p3.2.m2.1.1.2" xref="S2.SS4.p3.2.m2.1.1.2.cmml">Q</mi><mi id="S2.SS4.p3.2.m2.1.1.3" xref="S2.SS4.p3.2.m2.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p3.2.m2.1b"><apply id="S2.SS4.p3.2.m2.1.1.cmml" xref="S2.SS4.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS4.p3.2.m2.1.1.1.cmml" xref="S2.SS4.p3.2.m2.1.1">subscript</csymbol><ci id="S2.SS4.p3.2.m2.1.1.2.cmml" xref="S2.SS4.p3.2.m2.1.1.2">𝑄</ci><ci id="S2.SS4.p3.2.m2.1.1.3.cmml" xref="S2.SS4.p3.2.m2.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p3.2.m2.1c">Q_{q}</annotation></semantics></math>, keys <math id="S2.SS4.p3.3.m3.1" class="ltx_Math" alttext="K_{q}" display="inline"><semantics id="S2.SS4.p3.3.m3.1a"><msub id="S2.SS4.p3.3.m3.1.1" xref="S2.SS4.p3.3.m3.1.1.cmml"><mi id="S2.SS4.p3.3.m3.1.1.2" xref="S2.SS4.p3.3.m3.1.1.2.cmml">K</mi><mi id="S2.SS4.p3.3.m3.1.1.3" xref="S2.SS4.p3.3.m3.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p3.3.m3.1b"><apply id="S2.SS4.p3.3.m3.1.1.cmml" xref="S2.SS4.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS4.p3.3.m3.1.1.1.cmml" xref="S2.SS4.p3.3.m3.1.1">subscript</csymbol><ci id="S2.SS4.p3.3.m3.1.1.2.cmml" xref="S2.SS4.p3.3.m3.1.1.2">𝐾</ci><ci id="S2.SS4.p3.3.m3.1.1.3.cmml" xref="S2.SS4.p3.3.m3.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p3.3.m3.1c">K_{q}</annotation></semantics></math>, and values <math id="S2.SS4.p3.4.m4.1" class="ltx_Math" alttext="V_{q}" display="inline"><semantics id="S2.SS4.p3.4.m4.1a"><msub id="S2.SS4.p3.4.m4.1.1" xref="S2.SS4.p3.4.m4.1.1.cmml"><mi id="S2.SS4.p3.4.m4.1.1.2" xref="S2.SS4.p3.4.m4.1.1.2.cmml">V</mi><mi id="S2.SS4.p3.4.m4.1.1.3" xref="S2.SS4.p3.4.m4.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p3.4.m4.1b"><apply id="S2.SS4.p3.4.m4.1.1.cmml" xref="S2.SS4.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS4.p3.4.m4.1.1.1.cmml" xref="S2.SS4.p3.4.m4.1.1">subscript</csymbol><ci id="S2.SS4.p3.4.m4.1.1.2.cmml" xref="S2.SS4.p3.4.m4.1.1.2">𝑉</ci><ci id="S2.SS4.p3.4.m4.1.1.3.cmml" xref="S2.SS4.p3.4.m4.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p3.4.m4.1c">V_{q}</annotation></semantics></math> can be expressed as</p>
<table id="S2.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E5.m1.25" class="ltx_math_unparsed" alttext="\begin{split}Q_{q}=C_{q}+P_{q},\quad K_{q}=C_{q}+P_{q},\quad V_{q}=C_{q},\end{split}" display="block"><semantics id="S2.E5.m1.25a"><mtable displaystyle="true" id="S2.E5.m1.25.25.1"><mtr id="S2.E5.m1.25.25.1a"><mtd class="ltx_align_right" columnalign="right" id="S2.E5.m1.25.25.1b"><mrow id="S2.E5.m1.25.25.1.25.25.25.25"><mrow id="S2.E5.m1.25.25.1.25.25.25.25.1"><mrow id="S2.E5.m1.25.25.1.25.25.25.25.1.1.1"><msub id="S2.E5.m1.25.25.1.25.25.25.25.1.1.1.1"><mi id="S2.E5.m1.1.1.1.1.1.1">Q</mi><mi id="S2.E5.m1.2.2.2.2.2.2.1">q</mi></msub><mo id="S2.E5.m1.3.3.3.3.3.3">=</mo><mrow id="S2.E5.m1.25.25.1.25.25.25.25.1.1.1.2"><msub id="S2.E5.m1.25.25.1.25.25.25.25.1.1.1.2.1"><mi id="S2.E5.m1.4.4.4.4.4.4">C</mi><mi id="S2.E5.m1.5.5.5.5.5.5.1">q</mi></msub><mo id="S2.E5.m1.6.6.6.6.6.6">+</mo><msub id="S2.E5.m1.25.25.1.25.25.25.25.1.1.1.2.2"><mi id="S2.E5.m1.7.7.7.7.7.7">P</mi><mi id="S2.E5.m1.8.8.8.8.8.8.1">q</mi></msub></mrow></mrow><mo rspace="1.167em" id="S2.E5.m1.9.9.9.9.9.9">,</mo><mrow id="S2.E5.m1.25.25.1.25.25.25.25.1.2.2"><mrow id="S2.E5.m1.25.25.1.25.25.25.25.1.2.2.1.1"><msub id="S2.E5.m1.25.25.1.25.25.25.25.1.2.2.1.1.1"><mi id="S2.E5.m1.10.10.10.10.10.10">K</mi><mi id="S2.E5.m1.11.11.11.11.11.11.1">q</mi></msub><mo id="S2.E5.m1.12.12.12.12.12.12">=</mo><mrow id="S2.E5.m1.25.25.1.25.25.25.25.1.2.2.1.1.2"><msub id="S2.E5.m1.25.25.1.25.25.25.25.1.2.2.1.1.2.1"><mi id="S2.E5.m1.13.13.13.13.13.13">C</mi><mi id="S2.E5.m1.14.14.14.14.14.14.1">q</mi></msub><mo id="S2.E5.m1.15.15.15.15.15.15">+</mo><msub id="S2.E5.m1.25.25.1.25.25.25.25.1.2.2.1.1.2.2"><mi id="S2.E5.m1.16.16.16.16.16.16">P</mi><mi id="S2.E5.m1.17.17.17.17.17.17.1">q</mi></msub></mrow></mrow><mo rspace="1.167em" id="S2.E5.m1.18.18.18.18.18.18">,</mo><mrow id="S2.E5.m1.25.25.1.25.25.25.25.1.2.2.2.2"><msub id="S2.E5.m1.25.25.1.25.25.25.25.1.2.2.2.2.1"><mi id="S2.E5.m1.19.19.19.19.19.19">V</mi><mi id="S2.E5.m1.20.20.20.20.20.20.1">q</mi></msub><mo id="S2.E5.m1.21.21.21.21.21.21">=</mo><msub id="S2.E5.m1.25.25.1.25.25.25.25.1.2.2.2.2.2"><mi id="S2.E5.m1.22.22.22.22.22.22">C</mi><mi id="S2.E5.m1.23.23.23.23.23.23.1">q</mi></msub></mrow></mrow></mrow><mo id="S2.E5.m1.24.24.24.24.24.24">,</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex" id="S2.E5.m1.25b">\begin{split}Q_{q}=C_{q}+P_{q},\quad K_{q}=C_{q}+P_{q},\quad V_{q}=C_{q},\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S2.SS4.p3.6" class="ltx_p">where <math id="S2.SS4.p3.5.m1.1" class="ltx_Math" alttext="C_{q}\in\mathbb{R}^{D}" display="inline"><semantics id="S2.SS4.p3.5.m1.1a"><mrow id="S2.SS4.p3.5.m1.1.1" xref="S2.SS4.p3.5.m1.1.1.cmml"><msub id="S2.SS4.p3.5.m1.1.1.2" xref="S2.SS4.p3.5.m1.1.1.2.cmml"><mi id="S2.SS4.p3.5.m1.1.1.2.2" xref="S2.SS4.p3.5.m1.1.1.2.2.cmml">C</mi><mi id="S2.SS4.p3.5.m1.1.1.2.3" xref="S2.SS4.p3.5.m1.1.1.2.3.cmml">q</mi></msub><mo id="S2.SS4.p3.5.m1.1.1.1" xref="S2.SS4.p3.5.m1.1.1.1.cmml">∈</mo><msup id="S2.SS4.p3.5.m1.1.1.3" xref="S2.SS4.p3.5.m1.1.1.3.cmml"><mi id="S2.SS4.p3.5.m1.1.1.3.2" xref="S2.SS4.p3.5.m1.1.1.3.2.cmml">ℝ</mi><mi id="S2.SS4.p3.5.m1.1.1.3.3" xref="S2.SS4.p3.5.m1.1.1.3.3.cmml">D</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p3.5.m1.1b"><apply id="S2.SS4.p3.5.m1.1.1.cmml" xref="S2.SS4.p3.5.m1.1.1"><in id="S2.SS4.p3.5.m1.1.1.1.cmml" xref="S2.SS4.p3.5.m1.1.1.1"></in><apply id="S2.SS4.p3.5.m1.1.1.2.cmml" xref="S2.SS4.p3.5.m1.1.1.2"><csymbol cd="ambiguous" id="S2.SS4.p3.5.m1.1.1.2.1.cmml" xref="S2.SS4.p3.5.m1.1.1.2">subscript</csymbol><ci id="S2.SS4.p3.5.m1.1.1.2.2.cmml" xref="S2.SS4.p3.5.m1.1.1.2.2">𝐶</ci><ci id="S2.SS4.p3.5.m1.1.1.2.3.cmml" xref="S2.SS4.p3.5.m1.1.1.2.3">𝑞</ci></apply><apply id="S2.SS4.p3.5.m1.1.1.3.cmml" xref="S2.SS4.p3.5.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS4.p3.5.m1.1.1.3.1.cmml" xref="S2.SS4.p3.5.m1.1.1.3">superscript</csymbol><ci id="S2.SS4.p3.5.m1.1.1.3.2.cmml" xref="S2.SS4.p3.5.m1.1.1.3.2">ℝ</ci><ci id="S2.SS4.p3.5.m1.1.1.3.3.cmml" xref="S2.SS4.p3.5.m1.1.1.3.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p3.5.m1.1c">C_{q}\in\mathbb{R}^{D}</annotation></semantics></math> indicates the learnable content query, and <math id="S2.SS4.p3.6.m2.1" class="ltx_Math" alttext="P_{q}\in\mathbb{R}^{D}" display="inline"><semantics id="S2.SS4.p3.6.m2.1a"><mrow id="S2.SS4.p3.6.m2.1.1" xref="S2.SS4.p3.6.m2.1.1.cmml"><msub id="S2.SS4.p3.6.m2.1.1.2" xref="S2.SS4.p3.6.m2.1.1.2.cmml"><mi id="S2.SS4.p3.6.m2.1.1.2.2" xref="S2.SS4.p3.6.m2.1.1.2.2.cmml">P</mi><mi id="S2.SS4.p3.6.m2.1.1.2.3" xref="S2.SS4.p3.6.m2.1.1.2.3.cmml">q</mi></msub><mo id="S2.SS4.p3.6.m2.1.1.1" xref="S2.SS4.p3.6.m2.1.1.1.cmml">∈</mo><msup id="S2.SS4.p3.6.m2.1.1.3" xref="S2.SS4.p3.6.m2.1.1.3.cmml"><mi id="S2.SS4.p3.6.m2.1.1.3.2" xref="S2.SS4.p3.6.m2.1.1.3.2.cmml">ℝ</mi><mi id="S2.SS4.p3.6.m2.1.1.3.3" xref="S2.SS4.p3.6.m2.1.1.3.3.cmml">D</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p3.6.m2.1b"><apply id="S2.SS4.p3.6.m2.1.1.cmml" xref="S2.SS4.p3.6.m2.1.1"><in id="S2.SS4.p3.6.m2.1.1.1.cmml" xref="S2.SS4.p3.6.m2.1.1.1"></in><apply id="S2.SS4.p3.6.m2.1.1.2.cmml" xref="S2.SS4.p3.6.m2.1.1.2"><csymbol cd="ambiguous" id="S2.SS4.p3.6.m2.1.1.2.1.cmml" xref="S2.SS4.p3.6.m2.1.1.2">subscript</csymbol><ci id="S2.SS4.p3.6.m2.1.1.2.2.cmml" xref="S2.SS4.p3.6.m2.1.1.2.2">𝑃</ci><ci id="S2.SS4.p3.6.m2.1.1.2.3.cmml" xref="S2.SS4.p3.6.m2.1.1.2.3">𝑞</ci></apply><apply id="S2.SS4.p3.6.m2.1.1.3.cmml" xref="S2.SS4.p3.6.m2.1.1.3"><csymbol cd="ambiguous" id="S2.SS4.p3.6.m2.1.1.3.1.cmml" xref="S2.SS4.p3.6.m2.1.1.3">superscript</csymbol><ci id="S2.SS4.p3.6.m2.1.1.3.2.cmml" xref="S2.SS4.p3.6.m2.1.1.3.2">ℝ</ci><ci id="S2.SS4.p3.6.m2.1.1.3.3.cmml" xref="S2.SS4.p3.6.m2.1.1.3.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p3.6.m2.1c">P_{q}\in\mathbb{R}^{D}</annotation></semantics></math> indicates the spatial query generated by</p>
<table id="S2.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E6.m1.35" class="ltx_Math" alttext="\begin{split}P_{q}=\operatorname{MLP}\left\{\operatorname{Cat}\left[\operatorname{PE}\left(x_{q}\right),\operatorname{PE}\left(y_{q}\right),\operatorname{PE}\left(w_{q}\right),\operatorname{PE}\left(h_{q}\right)\right]\right\},\end{split}" display="block"><semantics id="S2.E6.m1.35a"><mtable displaystyle="true" id="S2.E6.m1.35.35.2"><mtr id="S2.E6.m1.35.35.2a"><mtd class="ltx_align_right" columnalign="right" id="S2.E6.m1.35.35.2b"><mrow id="S2.E6.m1.35.35.2.34.34.34.34"><mrow id="S2.E6.m1.35.35.2.34.34.34.34.1"><msub id="S2.E6.m1.35.35.2.34.34.34.34.1.2"><mi id="S2.E6.m1.1.1.1.1.1.1" xref="S2.E6.m1.1.1.1.1.1.1.cmml">P</mi><mi id="S2.E6.m1.2.2.2.2.2.2.1" xref="S2.E6.m1.2.2.2.2.2.2.1.cmml">q</mi></msub><mo id="S2.E6.m1.3.3.3.3.3.3" xref="S2.E6.m1.3.3.3.3.3.3.cmml">=</mo><mrow id="S2.E6.m1.35.35.2.34.34.34.34.1.1.1"><mi id="S2.E6.m1.4.4.4.4.4.4" xref="S2.E6.m1.4.4.4.4.4.4.cmml">MLP</mi><mo id="S2.E6.m1.35.35.2.34.34.34.34.1.1.1a" xref="S2.E6.m1.34.34.1.1.1.cmml">⁡</mo><mrow id="S2.E6.m1.35.35.2.34.34.34.34.1.1.1.1"><mo id="S2.E6.m1.5.5.5.5.5.5" xref="S2.E6.m1.34.34.1.1.1.cmml">{</mo><mrow id="S2.E6.m1.35.35.2.34.34.34.34.1.1.1.1.1"><mi id="S2.E6.m1.6.6.6.6.6.6" xref="S2.E6.m1.6.6.6.6.6.6.cmml">Cat</mi><mo id="S2.E6.m1.35.35.2.34.34.34.34.1.1.1.1.1a" xref="S2.E6.m1.34.34.1.1.1.cmml">⁡</mo><mrow id="S2.E6.m1.35.35.2.34.34.34.34.1.1.1.1.1.4.4"><mo id="S2.E6.m1.7.7.7.7.7.7" xref="S2.E6.m1.34.34.1.1.1.cmml">[</mo><mrow id="S2.E6.m1.35.35.2.34.34.34.34.1.1.1.1.1.1.1.1"><mi id="S2.E6.m1.8.8.8.8.8.8" xref="S2.E6.m1.8.8.8.8.8.8.cmml">PE</mi><mo id="S2.E6.m1.35.35.2.34.34.34.34.1.1.1.1.1.1.1.1a" xref="S2.E6.m1.34.34.1.1.1.cmml">⁡</mo><mrow id="S2.E6.m1.35.35.2.34.34.34.34.1.1.1.1.1.1.1.1.1.1"><mo id="S2.E6.m1.9.9.9.9.9.9" xref="S2.E6.m1.34.34.1.1.1.cmml">(</mo><msub id="S2.E6.m1.35.35.2.34.34.34.34.1.1.1.1.1.1.1.1.1.1.1"><mi id="S2.E6.m1.10.10.10.10.10.10" xref="S2.E6.m1.10.10.10.10.10.10.cmml">x</mi><mi id="S2.E6.m1.11.11.11.11.11.11.1" xref="S2.E6.m1.11.11.11.11.11.11.1.cmml">q</mi></msub><mo id="S2.E6.m1.12.12.12.12.12.12" xref="S2.E6.m1.34.34.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E6.m1.13.13.13.13.13.13" xref="S2.E6.m1.34.34.1.1.1.cmml">,</mo><mrow id="S2.E6.m1.35.35.2.34.34.34.34.1.1.1.1.1.2.2.2"><mi id="S2.E6.m1.14.14.14.14.14.14" xref="S2.E6.m1.14.14.14.14.14.14.cmml">PE</mi><mo id="S2.E6.m1.35.35.2.34.34.34.34.1.1.1.1.1.2.2.2a" xref="S2.E6.m1.34.34.1.1.1.cmml">⁡</mo><mrow id="S2.E6.m1.35.35.2.34.34.34.34.1.1.1.1.1.2.2.2.1.1"><mo id="S2.E6.m1.15.15.15.15.15.15" xref="S2.E6.m1.34.34.1.1.1.cmml">(</mo><msub id="S2.E6.m1.35.35.2.34.34.34.34.1.1.1.1.1.2.2.2.1.1.1"><mi id="S2.E6.m1.16.16.16.16.16.16" xref="S2.E6.m1.16.16.16.16.16.16.cmml">y</mi><mi id="S2.E6.m1.17.17.17.17.17.17.1" xref="S2.E6.m1.17.17.17.17.17.17.1.cmml">q</mi></msub><mo id="S2.E6.m1.18.18.18.18.18.18" xref="S2.E6.m1.34.34.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E6.m1.19.19.19.19.19.19" xref="S2.E6.m1.34.34.1.1.1.cmml">,</mo><mrow id="S2.E6.m1.35.35.2.34.34.34.34.1.1.1.1.1.3.3.3"><mi id="S2.E6.m1.20.20.20.20.20.20" xref="S2.E6.m1.20.20.20.20.20.20.cmml">PE</mi><mo id="S2.E6.m1.35.35.2.34.34.34.34.1.1.1.1.1.3.3.3a" xref="S2.E6.m1.34.34.1.1.1.cmml">⁡</mo><mrow id="S2.E6.m1.35.35.2.34.34.34.34.1.1.1.1.1.3.3.3.1.1"><mo id="S2.E6.m1.21.21.21.21.21.21" xref="S2.E6.m1.34.34.1.1.1.cmml">(</mo><msub id="S2.E6.m1.35.35.2.34.34.34.34.1.1.1.1.1.3.3.3.1.1.1"><mi id="S2.E6.m1.22.22.22.22.22.22" xref="S2.E6.m1.22.22.22.22.22.22.cmml">w</mi><mi id="S2.E6.m1.23.23.23.23.23.23.1" xref="S2.E6.m1.23.23.23.23.23.23.1.cmml">q</mi></msub><mo id="S2.E6.m1.24.24.24.24.24.24" xref="S2.E6.m1.34.34.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E6.m1.25.25.25.25.25.25" xref="S2.E6.m1.34.34.1.1.1.cmml">,</mo><mrow id="S2.E6.m1.35.35.2.34.34.34.34.1.1.1.1.1.4.4.4"><mi id="S2.E6.m1.26.26.26.26.26.26" xref="S2.E6.m1.26.26.26.26.26.26.cmml">PE</mi><mo id="S2.E6.m1.35.35.2.34.34.34.34.1.1.1.1.1.4.4.4a" xref="S2.E6.m1.34.34.1.1.1.cmml">⁡</mo><mrow id="S2.E6.m1.35.35.2.34.34.34.34.1.1.1.1.1.4.4.4.1.1"><mo id="S2.E6.m1.27.27.27.27.27.27" xref="S2.E6.m1.34.34.1.1.1.cmml">(</mo><msub id="S2.E6.m1.35.35.2.34.34.34.34.1.1.1.1.1.4.4.4.1.1.1"><mi id="S2.E6.m1.28.28.28.28.28.28" xref="S2.E6.m1.28.28.28.28.28.28.cmml">h</mi><mi id="S2.E6.m1.29.29.29.29.29.29.1" xref="S2.E6.m1.29.29.29.29.29.29.1.cmml">q</mi></msub><mo id="S2.E6.m1.30.30.30.30.30.30" xref="S2.E6.m1.34.34.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E6.m1.31.31.31.31.31.31" xref="S2.E6.m1.34.34.1.1.1.cmml">]</mo></mrow></mrow><mo id="S2.E6.m1.32.32.32.32.32.32" xref="S2.E6.m1.34.34.1.1.1.cmml">}</mo></mrow></mrow></mrow><mo id="S2.E6.m1.33.33.33.33.33.33" xref="S2.E6.m1.34.34.1.1.1.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S2.E6.m1.35b"><apply id="S2.E6.m1.34.34.1.1.1.cmml" xref="S2.E6.m1.35.35.2.34.34.34.34.1.1.1a"><eq id="S2.E6.m1.3.3.3.3.3.3.cmml" xref="S2.E6.m1.3.3.3.3.3.3"></eq><apply id="S2.E6.m1.34.34.1.1.1.3.cmml" xref="S2.E6.m1.35.35.2.34.34.34.34.1.1.1a"><csymbol cd="ambiguous" id="S2.E6.m1.34.34.1.1.1.3.1.cmml" xref="S2.E6.m1.35.35.2.34.34.34.34.1.1.1a">subscript</csymbol><ci id="S2.E6.m1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.1.1.1.1.1.1">𝑃</ci><ci id="S2.E6.m1.2.2.2.2.2.2.1.cmml" xref="S2.E6.m1.2.2.2.2.2.2.1">𝑞</ci></apply><apply id="S2.E6.m1.34.34.1.1.1.1.2.cmml" xref="S2.E6.m1.35.35.2.34.34.34.34.1.1.1a"><ci id="S2.E6.m1.4.4.4.4.4.4.cmml" xref="S2.E6.m1.4.4.4.4.4.4">MLP</ci><apply id="S2.E6.m1.34.34.1.1.1.1.1.1.1.5.cmml" xref="S2.E6.m1.35.35.2.34.34.34.34.1.1.1a"><ci id="S2.E6.m1.6.6.6.6.6.6.cmml" xref="S2.E6.m1.6.6.6.6.6.6">Cat</ci><apply id="S2.E6.m1.34.34.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E6.m1.35.35.2.34.34.34.34.1.1.1a"><ci id="S2.E6.m1.8.8.8.8.8.8.cmml" xref="S2.E6.m1.8.8.8.8.8.8">PE</ci><apply id="S2.E6.m1.34.34.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.35.35.2.34.34.34.34.1.1.1a"><csymbol cd="ambiguous" id="S2.E6.m1.34.34.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.35.35.2.34.34.34.34.1.1.1a">subscript</csymbol><ci id="S2.E6.m1.10.10.10.10.10.10.cmml" xref="S2.E6.m1.10.10.10.10.10.10">𝑥</ci><ci id="S2.E6.m1.11.11.11.11.11.11.1.cmml" xref="S2.E6.m1.11.11.11.11.11.11.1">𝑞</ci></apply></apply><apply id="S2.E6.m1.34.34.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.E6.m1.35.35.2.34.34.34.34.1.1.1a"><ci id="S2.E6.m1.14.14.14.14.14.14.cmml" xref="S2.E6.m1.14.14.14.14.14.14">PE</ci><apply id="S2.E6.m1.34.34.1.1.1.1.1.1.1.2.2.2.1.1.1.cmml" xref="S2.E6.m1.35.35.2.34.34.34.34.1.1.1a"><csymbol cd="ambiguous" id="S2.E6.m1.34.34.1.1.1.1.1.1.1.2.2.2.1.1.1.1.cmml" xref="S2.E6.m1.35.35.2.34.34.34.34.1.1.1a">subscript</csymbol><ci id="S2.E6.m1.16.16.16.16.16.16.cmml" xref="S2.E6.m1.16.16.16.16.16.16">𝑦</ci><ci id="S2.E6.m1.17.17.17.17.17.17.1.cmml" xref="S2.E6.m1.17.17.17.17.17.17.1">𝑞</ci></apply></apply><apply id="S2.E6.m1.34.34.1.1.1.1.1.1.1.3.3.3.2.cmml" xref="S2.E6.m1.35.35.2.34.34.34.34.1.1.1a"><ci id="S2.E6.m1.20.20.20.20.20.20.cmml" xref="S2.E6.m1.20.20.20.20.20.20">PE</ci><apply id="S2.E6.m1.34.34.1.1.1.1.1.1.1.3.3.3.1.1.1.cmml" xref="S2.E6.m1.35.35.2.34.34.34.34.1.1.1a"><csymbol cd="ambiguous" id="S2.E6.m1.34.34.1.1.1.1.1.1.1.3.3.3.1.1.1.1.cmml" xref="S2.E6.m1.35.35.2.34.34.34.34.1.1.1a">subscript</csymbol><ci id="S2.E6.m1.22.22.22.22.22.22.cmml" xref="S2.E6.m1.22.22.22.22.22.22">𝑤</ci><ci id="S2.E6.m1.23.23.23.23.23.23.1.cmml" xref="S2.E6.m1.23.23.23.23.23.23.1">𝑞</ci></apply></apply><apply id="S2.E6.m1.34.34.1.1.1.1.1.1.1.4.4.4.2.cmml" xref="S2.E6.m1.35.35.2.34.34.34.34.1.1.1a"><ci id="S2.E6.m1.26.26.26.26.26.26.cmml" xref="S2.E6.m1.26.26.26.26.26.26">PE</ci><apply id="S2.E6.m1.34.34.1.1.1.1.1.1.1.4.4.4.1.1.1.cmml" xref="S2.E6.m1.35.35.2.34.34.34.34.1.1.1a"><csymbol cd="ambiguous" id="S2.E6.m1.34.34.1.1.1.1.1.1.1.4.4.4.1.1.1.1.cmml" xref="S2.E6.m1.35.35.2.34.34.34.34.1.1.1a">subscript</csymbol><ci id="S2.E6.m1.28.28.28.28.28.28.cmml" xref="S2.E6.m1.28.28.28.28.28.28">ℎ</ci><ci id="S2.E6.m1.29.29.29.29.29.29.1.cmml" xref="S2.E6.m1.29.29.29.29.29.29.1">𝑞</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E6.m1.35c">\begin{split}P_{q}=\operatorname{MLP}\left\{\operatorname{Cat}\left[\operatorname{PE}\left(x_{q}\right),\operatorname{PE}\left(y_{q}\right),\operatorname{PE}\left(w_{q}\right),\operatorname{PE}\left(h_{q}\right)\right]\right\},\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S2.SS4.p3.10" class="ltx_p">where <math id="S2.SS4.p3.7.m1.4" class="ltx_Math" alttext="(x_{q},y_{q},w_{q},h_{q})" display="inline"><semantics id="S2.SS4.p3.7.m1.4a"><mrow id="S2.SS4.p3.7.m1.4.4.4" xref="S2.SS4.p3.7.m1.4.4.5.cmml"><mo stretchy="false" id="S2.SS4.p3.7.m1.4.4.4.5" xref="S2.SS4.p3.7.m1.4.4.5.cmml">(</mo><msub id="S2.SS4.p3.7.m1.1.1.1.1" xref="S2.SS4.p3.7.m1.1.1.1.1.cmml"><mi id="S2.SS4.p3.7.m1.1.1.1.1.2" xref="S2.SS4.p3.7.m1.1.1.1.1.2.cmml">x</mi><mi id="S2.SS4.p3.7.m1.1.1.1.1.3" xref="S2.SS4.p3.7.m1.1.1.1.1.3.cmml">q</mi></msub><mo id="S2.SS4.p3.7.m1.4.4.4.6" xref="S2.SS4.p3.7.m1.4.4.5.cmml">,</mo><msub id="S2.SS4.p3.7.m1.2.2.2.2" xref="S2.SS4.p3.7.m1.2.2.2.2.cmml"><mi id="S2.SS4.p3.7.m1.2.2.2.2.2" xref="S2.SS4.p3.7.m1.2.2.2.2.2.cmml">y</mi><mi id="S2.SS4.p3.7.m1.2.2.2.2.3" xref="S2.SS4.p3.7.m1.2.2.2.2.3.cmml">q</mi></msub><mo id="S2.SS4.p3.7.m1.4.4.4.7" xref="S2.SS4.p3.7.m1.4.4.5.cmml">,</mo><msub id="S2.SS4.p3.7.m1.3.3.3.3" xref="S2.SS4.p3.7.m1.3.3.3.3.cmml"><mi id="S2.SS4.p3.7.m1.3.3.3.3.2" xref="S2.SS4.p3.7.m1.3.3.3.3.2.cmml">w</mi><mi id="S2.SS4.p3.7.m1.3.3.3.3.3" xref="S2.SS4.p3.7.m1.3.3.3.3.3.cmml">q</mi></msub><mo id="S2.SS4.p3.7.m1.4.4.4.8" xref="S2.SS4.p3.7.m1.4.4.5.cmml">,</mo><msub id="S2.SS4.p3.7.m1.4.4.4.4" xref="S2.SS4.p3.7.m1.4.4.4.4.cmml"><mi id="S2.SS4.p3.7.m1.4.4.4.4.2" xref="S2.SS4.p3.7.m1.4.4.4.4.2.cmml">h</mi><mi id="S2.SS4.p3.7.m1.4.4.4.4.3" xref="S2.SS4.p3.7.m1.4.4.4.4.3.cmml">q</mi></msub><mo stretchy="false" id="S2.SS4.p3.7.m1.4.4.4.9" xref="S2.SS4.p3.7.m1.4.4.5.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p3.7.m1.4b"><vector id="S2.SS4.p3.7.m1.4.4.5.cmml" xref="S2.SS4.p3.7.m1.4.4.4"><apply id="S2.SS4.p3.7.m1.1.1.1.1.cmml" xref="S2.SS4.p3.7.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p3.7.m1.1.1.1.1.1.cmml" xref="S2.SS4.p3.7.m1.1.1.1.1">subscript</csymbol><ci id="S2.SS4.p3.7.m1.1.1.1.1.2.cmml" xref="S2.SS4.p3.7.m1.1.1.1.1.2">𝑥</ci><ci id="S2.SS4.p3.7.m1.1.1.1.1.3.cmml" xref="S2.SS4.p3.7.m1.1.1.1.1.3">𝑞</ci></apply><apply id="S2.SS4.p3.7.m1.2.2.2.2.cmml" xref="S2.SS4.p3.7.m1.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS4.p3.7.m1.2.2.2.2.1.cmml" xref="S2.SS4.p3.7.m1.2.2.2.2">subscript</csymbol><ci id="S2.SS4.p3.7.m1.2.2.2.2.2.cmml" xref="S2.SS4.p3.7.m1.2.2.2.2.2">𝑦</ci><ci id="S2.SS4.p3.7.m1.2.2.2.2.3.cmml" xref="S2.SS4.p3.7.m1.2.2.2.2.3">𝑞</ci></apply><apply id="S2.SS4.p3.7.m1.3.3.3.3.cmml" xref="S2.SS4.p3.7.m1.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS4.p3.7.m1.3.3.3.3.1.cmml" xref="S2.SS4.p3.7.m1.3.3.3.3">subscript</csymbol><ci id="S2.SS4.p3.7.m1.3.3.3.3.2.cmml" xref="S2.SS4.p3.7.m1.3.3.3.3.2">𝑤</ci><ci id="S2.SS4.p3.7.m1.3.3.3.3.3.cmml" xref="S2.SS4.p3.7.m1.3.3.3.3.3">𝑞</ci></apply><apply id="S2.SS4.p3.7.m1.4.4.4.4.cmml" xref="S2.SS4.p3.7.m1.4.4.4.4"><csymbol cd="ambiguous" id="S2.SS4.p3.7.m1.4.4.4.4.1.cmml" xref="S2.SS4.p3.7.m1.4.4.4.4">subscript</csymbol><ci id="S2.SS4.p3.7.m1.4.4.4.4.2.cmml" xref="S2.SS4.p3.7.m1.4.4.4.4.2">ℎ</ci><ci id="S2.SS4.p3.7.m1.4.4.4.4.3.cmml" xref="S2.SS4.p3.7.m1.4.4.4.4.3">𝑞</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p3.7.m1.4c">(x_{q},y_{q},w_{q},h_{q})</annotation></semantics></math> is the <math id="S2.SS4.p3.8.m2.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S2.SS4.p3.8.m2.1a"><mi id="S2.SS4.p3.8.m2.1.1" xref="S2.SS4.p3.8.m2.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p3.8.m2.1b"><ci id="S2.SS4.p3.8.m2.1.1.cmml" xref="S2.SS4.p3.8.m2.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p3.8.m2.1c">q</annotation></semantics></math>-th anchor generated from the query selection module; <math id="S2.SS4.p3.9.m3.1" class="ltx_Math" alttext="\operatorname{PE}:\mathbb{R}\rightarrow\mathbb{R}^{D/2}" display="inline"><semantics id="S2.SS4.p3.9.m3.1a"><mrow id="S2.SS4.p3.9.m3.1.1" xref="S2.SS4.p3.9.m3.1.1.cmml"><mi id="S2.SS4.p3.9.m3.1.1.2" xref="S2.SS4.p3.9.m3.1.1.2.cmml">PE</mi><mo lspace="0.278em" rspace="0.278em" id="S2.SS4.p3.9.m3.1.1.1" xref="S2.SS4.p3.9.m3.1.1.1.cmml">:</mo><mrow id="S2.SS4.p3.9.m3.1.1.3" xref="S2.SS4.p3.9.m3.1.1.3.cmml"><mi id="S2.SS4.p3.9.m3.1.1.3.2" xref="S2.SS4.p3.9.m3.1.1.3.2.cmml">ℝ</mi><mo stretchy="false" id="S2.SS4.p3.9.m3.1.1.3.1" xref="S2.SS4.p3.9.m3.1.1.3.1.cmml">→</mo><msup id="S2.SS4.p3.9.m3.1.1.3.3" xref="S2.SS4.p3.9.m3.1.1.3.3.cmml"><mi id="S2.SS4.p3.9.m3.1.1.3.3.2" xref="S2.SS4.p3.9.m3.1.1.3.3.2.cmml">ℝ</mi><mrow id="S2.SS4.p3.9.m3.1.1.3.3.3" xref="S2.SS4.p3.9.m3.1.1.3.3.3.cmml"><mi id="S2.SS4.p3.9.m3.1.1.3.3.3.2" xref="S2.SS4.p3.9.m3.1.1.3.3.3.2.cmml">D</mi><mo id="S2.SS4.p3.9.m3.1.1.3.3.3.1" xref="S2.SS4.p3.9.m3.1.1.3.3.3.1.cmml">/</mo><mn id="S2.SS4.p3.9.m3.1.1.3.3.3.3" xref="S2.SS4.p3.9.m3.1.1.3.3.3.3.cmml">2</mn></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p3.9.m3.1b"><apply id="S2.SS4.p3.9.m3.1.1.cmml" xref="S2.SS4.p3.9.m3.1.1"><ci id="S2.SS4.p3.9.m3.1.1.1.cmml" xref="S2.SS4.p3.9.m3.1.1.1">:</ci><ci id="S2.SS4.p3.9.m3.1.1.2.cmml" xref="S2.SS4.p3.9.m3.1.1.2">PE</ci><apply id="S2.SS4.p3.9.m3.1.1.3.cmml" xref="S2.SS4.p3.9.m3.1.1.3"><ci id="S2.SS4.p3.9.m3.1.1.3.1.cmml" xref="S2.SS4.p3.9.m3.1.1.3.1">→</ci><ci id="S2.SS4.p3.9.m3.1.1.3.2.cmml" xref="S2.SS4.p3.9.m3.1.1.3.2">ℝ</ci><apply id="S2.SS4.p3.9.m3.1.1.3.3.cmml" xref="S2.SS4.p3.9.m3.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS4.p3.9.m3.1.1.3.3.1.cmml" xref="S2.SS4.p3.9.m3.1.1.3.3">superscript</csymbol><ci id="S2.SS4.p3.9.m3.1.1.3.3.2.cmml" xref="S2.SS4.p3.9.m3.1.1.3.3.2">ℝ</ci><apply id="S2.SS4.p3.9.m3.1.1.3.3.3.cmml" xref="S2.SS4.p3.9.m3.1.1.3.3.3"><divide id="S2.SS4.p3.9.m3.1.1.3.3.3.1.cmml" xref="S2.SS4.p3.9.m3.1.1.3.3.3.1"></divide><ci id="S2.SS4.p3.9.m3.1.1.3.3.3.2.cmml" xref="S2.SS4.p3.9.m3.1.1.3.3.3.2">𝐷</ci><cn type="integer" id="S2.SS4.p3.9.m3.1.1.3.3.3.3.cmml" xref="S2.SS4.p3.9.m3.1.1.3.3.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p3.9.m3.1c">\operatorname{PE}:\mathbb{R}\rightarrow\mathbb{R}^{D/2}</annotation></semantics></math> is the positional encoding function to generate sinusoidal embeddings; the notion Cat means concatenation function; <math id="S2.SS4.p3.10.m4.1" class="ltx_Math" alttext="\operatorname{MLP}:\mathbb{R}^{2D}\rightarrow\mathbb{R}^{D}" display="inline"><semantics id="S2.SS4.p3.10.m4.1a"><mrow id="S2.SS4.p3.10.m4.1.1" xref="S2.SS4.p3.10.m4.1.1.cmml"><mi id="S2.SS4.p3.10.m4.1.1.2" xref="S2.SS4.p3.10.m4.1.1.2.cmml">MLP</mi><mo lspace="0.278em" rspace="0.278em" id="S2.SS4.p3.10.m4.1.1.1" xref="S2.SS4.p3.10.m4.1.1.1.cmml">:</mo><mrow id="S2.SS4.p3.10.m4.1.1.3" xref="S2.SS4.p3.10.m4.1.1.3.cmml"><msup id="S2.SS4.p3.10.m4.1.1.3.2" xref="S2.SS4.p3.10.m4.1.1.3.2.cmml"><mi id="S2.SS4.p3.10.m4.1.1.3.2.2" xref="S2.SS4.p3.10.m4.1.1.3.2.2.cmml">ℝ</mi><mrow id="S2.SS4.p3.10.m4.1.1.3.2.3" xref="S2.SS4.p3.10.m4.1.1.3.2.3.cmml"><mn id="S2.SS4.p3.10.m4.1.1.3.2.3.2" xref="S2.SS4.p3.10.m4.1.1.3.2.3.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S2.SS4.p3.10.m4.1.1.3.2.3.1" xref="S2.SS4.p3.10.m4.1.1.3.2.3.1.cmml">​</mo><mi id="S2.SS4.p3.10.m4.1.1.3.2.3.3" xref="S2.SS4.p3.10.m4.1.1.3.2.3.3.cmml">D</mi></mrow></msup><mo stretchy="false" id="S2.SS4.p3.10.m4.1.1.3.1" xref="S2.SS4.p3.10.m4.1.1.3.1.cmml">→</mo><msup id="S2.SS4.p3.10.m4.1.1.3.3" xref="S2.SS4.p3.10.m4.1.1.3.3.cmml"><mi id="S2.SS4.p3.10.m4.1.1.3.3.2" xref="S2.SS4.p3.10.m4.1.1.3.3.2.cmml">ℝ</mi><mi id="S2.SS4.p3.10.m4.1.1.3.3.3" xref="S2.SS4.p3.10.m4.1.1.3.3.3.cmml">D</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p3.10.m4.1b"><apply id="S2.SS4.p3.10.m4.1.1.cmml" xref="S2.SS4.p3.10.m4.1.1"><ci id="S2.SS4.p3.10.m4.1.1.1.cmml" xref="S2.SS4.p3.10.m4.1.1.1">:</ci><ci id="S2.SS4.p3.10.m4.1.1.2.cmml" xref="S2.SS4.p3.10.m4.1.1.2">MLP</ci><apply id="S2.SS4.p3.10.m4.1.1.3.cmml" xref="S2.SS4.p3.10.m4.1.1.3"><ci id="S2.SS4.p3.10.m4.1.1.3.1.cmml" xref="S2.SS4.p3.10.m4.1.1.3.1">→</ci><apply id="S2.SS4.p3.10.m4.1.1.3.2.cmml" xref="S2.SS4.p3.10.m4.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS4.p3.10.m4.1.1.3.2.1.cmml" xref="S2.SS4.p3.10.m4.1.1.3.2">superscript</csymbol><ci id="S2.SS4.p3.10.m4.1.1.3.2.2.cmml" xref="S2.SS4.p3.10.m4.1.1.3.2.2">ℝ</ci><apply id="S2.SS4.p3.10.m4.1.1.3.2.3.cmml" xref="S2.SS4.p3.10.m4.1.1.3.2.3"><times id="S2.SS4.p3.10.m4.1.1.3.2.3.1.cmml" xref="S2.SS4.p3.10.m4.1.1.3.2.3.1"></times><cn type="integer" id="S2.SS4.p3.10.m4.1.1.3.2.3.2.cmml" xref="S2.SS4.p3.10.m4.1.1.3.2.3.2">2</cn><ci id="S2.SS4.p3.10.m4.1.1.3.2.3.3.cmml" xref="S2.SS4.p3.10.m4.1.1.3.2.3.3">𝐷</ci></apply></apply><apply id="S2.SS4.p3.10.m4.1.1.3.3.cmml" xref="S2.SS4.p3.10.m4.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS4.p3.10.m4.1.1.3.3.1.cmml" xref="S2.SS4.p3.10.m4.1.1.3.3">superscript</csymbol><ci id="S2.SS4.p3.10.m4.1.1.3.3.2.cmml" xref="S2.SS4.p3.10.m4.1.1.3.3.2">ℝ</ci><ci id="S2.SS4.p3.10.m4.1.1.3.3.3.cmml" xref="S2.SS4.p3.10.m4.1.1.3.3.3">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p3.10.m4.1c">\operatorname{MLP}:\mathbb{R}^{2D}\rightarrow\mathbb{R}^{D}</annotation></semantics></math> is composed of two linear layers.</p>
</div>
<div id="S2.SS4.p4" class="ltx_para">
<p id="S2.SS4.p4.6" class="ltx_p">The cross-attention module is used for feature probing, where queries, keys, and values can be expressed as</p>
<table id="S2.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E7.m1.50" class="ltx_Math" alttext="\begin{split}&amp;Q_{q}=\operatorname{Cat}\left(C_{q},\operatorname{PE}\left(x_{q},y_{q}\right)\cdot\operatorname{MLP}\left(C_{q}\right)\right),\\
&amp;K_{x,y}=\operatorname{Cat}\left(F_{x,y},\operatorname{PE}(x,y)\right),\\
&amp;V_{x,y}=F_{x,y},\end{split}" display="block"><semantics id="S2.E7.m1.50a"><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt" id="S2.E7.m1.50.50.4"><mtr id="S2.E7.m1.50.50.4a"><mtd id="S2.E7.m1.50.50.4b"></mtd><mtd class="ltx_align_left" columnalign="left" id="S2.E7.m1.50.50.4c"><mrow id="S2.E7.m1.48.48.2.47.25.25.25"><mrow id="S2.E7.m1.48.48.2.47.25.25.25.1"><msub id="S2.E7.m1.48.48.2.47.25.25.25.1.3"><mi id="S2.E7.m1.1.1.1.1.1.1" xref="S2.E7.m1.1.1.1.1.1.1.cmml">Q</mi><mi id="S2.E7.m1.2.2.2.2.2.2.1" xref="S2.E7.m1.2.2.2.2.2.2.1.cmml">q</mi></msub><mo id="S2.E7.m1.3.3.3.3.3.3" xref="S2.E7.m1.3.3.3.3.3.3.cmml">=</mo><mrow id="S2.E7.m1.48.48.2.47.25.25.25.1.2.2"><mi id="S2.E7.m1.4.4.4.4.4.4" xref="S2.E7.m1.4.4.4.4.4.4.cmml">Cat</mi><mo id="S2.E7.m1.48.48.2.47.25.25.25.1.2.2a">⁡</mo><mrow id="S2.E7.m1.48.48.2.47.25.25.25.1.2.2.2"><mo id="S2.E7.m1.5.5.5.5.5.5">(</mo><msub id="S2.E7.m1.48.48.2.47.25.25.25.1.1.1.1.1"><mi id="S2.E7.m1.6.6.6.6.6.6" xref="S2.E7.m1.6.6.6.6.6.6.cmml">C</mi><mi id="S2.E7.m1.7.7.7.7.7.7.1" xref="S2.E7.m1.7.7.7.7.7.7.1.cmml">q</mi></msub><mo id="S2.E7.m1.8.8.8.8.8.8">,</mo><mrow id="S2.E7.m1.48.48.2.47.25.25.25.1.2.2.2.2"><mrow id="S2.E7.m1.48.48.2.47.25.25.25.1.2.2.2.2.2.2"><mi id="S2.E7.m1.9.9.9.9.9.9" xref="S2.E7.m1.9.9.9.9.9.9.cmml">PE</mi><mo id="S2.E7.m1.48.48.2.47.25.25.25.1.2.2.2.2.2.2a">⁡</mo><mrow id="S2.E7.m1.48.48.2.47.25.25.25.1.2.2.2.2.2.2.2"><mo id="S2.E7.m1.10.10.10.10.10.10">(</mo><msub id="S2.E7.m1.48.48.2.47.25.25.25.1.2.2.2.2.1.1.1.1"><mi id="S2.E7.m1.11.11.11.11.11.11" xref="S2.E7.m1.11.11.11.11.11.11.cmml">x</mi><mi id="S2.E7.m1.12.12.12.12.12.12.1" xref="S2.E7.m1.12.12.12.12.12.12.1.cmml">q</mi></msub><mo id="S2.E7.m1.13.13.13.13.13.13">,</mo><msub id="S2.E7.m1.48.48.2.47.25.25.25.1.2.2.2.2.2.2.2.2"><mi id="S2.E7.m1.14.14.14.14.14.14" xref="S2.E7.m1.14.14.14.14.14.14.cmml">y</mi><mi id="S2.E7.m1.15.15.15.15.15.15.1" xref="S2.E7.m1.15.15.15.15.15.15.1.cmml">q</mi></msub><mo rspace="0.055em" id="S2.E7.m1.16.16.16.16.16.16">)</mo></mrow></mrow><mo rspace="0.222em" id="S2.E7.m1.17.17.17.17.17.17" xref="S2.E7.m1.17.17.17.17.17.17.cmml">⋅</mo><mrow id="S2.E7.m1.48.48.2.47.25.25.25.1.2.2.2.2.3.1"><mi id="S2.E7.m1.18.18.18.18.18.18" xref="S2.E7.m1.18.18.18.18.18.18.cmml">MLP</mi><mo id="S2.E7.m1.48.48.2.47.25.25.25.1.2.2.2.2.3.1a">⁡</mo><mrow id="S2.E7.m1.48.48.2.47.25.25.25.1.2.2.2.2.3.1.1"><mo id="S2.E7.m1.19.19.19.19.19.19">(</mo><msub id="S2.E7.m1.48.48.2.47.25.25.25.1.2.2.2.2.3.1.1.1"><mi id="S2.E7.m1.20.20.20.20.20.20" xref="S2.E7.m1.20.20.20.20.20.20.cmml">C</mi><mi id="S2.E7.m1.21.21.21.21.21.21.1" xref="S2.E7.m1.21.21.21.21.21.21.1.cmml">q</mi></msub><mo id="S2.E7.m1.22.22.22.22.22.22">)</mo></mrow></mrow></mrow><mo id="S2.E7.m1.23.23.23.23.23.23">)</mo></mrow></mrow></mrow><mo id="S2.E7.m1.24.24.24.24.24.24">,</mo></mrow></mtd></mtr><mtr id="S2.E7.m1.50.50.4d"><mtd id="S2.E7.m1.50.50.4e"></mtd><mtd class="ltx_align_left" columnalign="left" id="S2.E7.m1.50.50.4f"><mrow id="S2.E7.m1.49.49.3.48.17.17.17"><mrow id="S2.E7.m1.49.49.3.48.17.17.17.1"><msub id="S2.E7.m1.49.49.3.48.17.17.17.1.3"><mi id="S2.E7.m1.25.25.25.1.1.1" xref="S2.E7.m1.25.25.25.1.1.1.cmml">K</mi><mrow id="S2.E7.m1.26.26.26.2.2.2.1.4" xref="S2.E7.m1.26.26.26.2.2.2.1.3.cmml"><mi id="S2.E7.m1.26.26.26.2.2.2.1.1" xref="S2.E7.m1.26.26.26.2.2.2.1.1.cmml">x</mi><mo id="S2.E7.m1.26.26.26.2.2.2.1.4.1" xref="S2.E7.m1.26.26.26.2.2.2.1.3.cmml">,</mo><mi id="S2.E7.m1.26.26.26.2.2.2.1.2" xref="S2.E7.m1.26.26.26.2.2.2.1.2.cmml">y</mi></mrow></msub><mo id="S2.E7.m1.27.27.27.3.3.3" xref="S2.E7.m1.27.27.27.3.3.3.cmml">=</mo><mrow id="S2.E7.m1.49.49.3.48.17.17.17.1.2.2"><mi id="S2.E7.m1.28.28.28.4.4.4" xref="S2.E7.m1.28.28.28.4.4.4.cmml">Cat</mi><mo id="S2.E7.m1.49.49.3.48.17.17.17.1.2.2a">⁡</mo><mrow id="S2.E7.m1.49.49.3.48.17.17.17.1.2.2.2"><mo id="S2.E7.m1.29.29.29.5.5.5">(</mo><msub id="S2.E7.m1.49.49.3.48.17.17.17.1.1.1.1.1"><mi id="S2.E7.m1.30.30.30.6.6.6" xref="S2.E7.m1.30.30.30.6.6.6.cmml">F</mi><mrow id="S2.E7.m1.31.31.31.7.7.7.1.4" xref="S2.E7.m1.31.31.31.7.7.7.1.3.cmml"><mi id="S2.E7.m1.31.31.31.7.7.7.1.1" xref="S2.E7.m1.31.31.31.7.7.7.1.1.cmml">x</mi><mo id="S2.E7.m1.31.31.31.7.7.7.1.4.1" xref="S2.E7.m1.31.31.31.7.7.7.1.3.cmml">,</mo><mi id="S2.E7.m1.31.31.31.7.7.7.1.2" xref="S2.E7.m1.31.31.31.7.7.7.1.2.cmml">y</mi></mrow></msub><mo id="S2.E7.m1.32.32.32.8.8.8">,</mo><mrow id="S2.E7.m1.49.49.3.48.17.17.17.1.2.2.2.2"><mi id="S2.E7.m1.33.33.33.9.9.9" xref="S2.E7.m1.33.33.33.9.9.9.cmml">PE</mi><mo id="S2.E7.m1.49.49.3.48.17.17.17.1.2.2.2.2a">⁡</mo><mrow id="S2.E7.m1.49.49.3.48.17.17.17.1.2.2.2.2.1"><mo stretchy="false" id="S2.E7.m1.34.34.34.10.10.10">(</mo><mi id="S2.E7.m1.35.35.35.11.11.11" xref="S2.E7.m1.35.35.35.11.11.11.cmml">x</mi><mo id="S2.E7.m1.36.36.36.12.12.12">,</mo><mi id="S2.E7.m1.37.37.37.13.13.13" xref="S2.E7.m1.37.37.37.13.13.13.cmml">y</mi><mo stretchy="false" id="S2.E7.m1.38.38.38.14.14.14">)</mo></mrow></mrow><mo id="S2.E7.m1.39.39.39.15.15.15">)</mo></mrow></mrow></mrow><mo id="S2.E7.m1.40.40.40.16.16.16">,</mo></mrow></mtd></mtr><mtr id="S2.E7.m1.50.50.4g"><mtd id="S2.E7.m1.50.50.4h"></mtd><mtd class="ltx_align_left" columnalign="left" id="S2.E7.m1.50.50.4i"><mrow id="S2.E7.m1.50.50.4.49.7.7.7"><mrow id="S2.E7.m1.50.50.4.49.7.7.7.1"><msub id="S2.E7.m1.50.50.4.49.7.7.7.1.1"><mi id="S2.E7.m1.41.41.41.1.1.1" xref="S2.E7.m1.41.41.41.1.1.1.cmml">V</mi><mrow id="S2.E7.m1.42.42.42.2.2.2.1.4" xref="S2.E7.m1.42.42.42.2.2.2.1.3.cmml"><mi id="S2.E7.m1.42.42.42.2.2.2.1.1" xref="S2.E7.m1.42.42.42.2.2.2.1.1.cmml">x</mi><mo id="S2.E7.m1.42.42.42.2.2.2.1.4.1" xref="S2.E7.m1.42.42.42.2.2.2.1.3.cmml">,</mo><mi id="S2.E7.m1.42.42.42.2.2.2.1.2" xref="S2.E7.m1.42.42.42.2.2.2.1.2.cmml">y</mi></mrow></msub><mo id="S2.E7.m1.43.43.43.3.3.3" xref="S2.E7.m1.43.43.43.3.3.3.cmml">=</mo><msub id="S2.E7.m1.50.50.4.49.7.7.7.1.2"><mi id="S2.E7.m1.44.44.44.4.4.4" xref="S2.E7.m1.44.44.44.4.4.4.cmml">F</mi><mrow id="S2.E7.m1.45.45.45.5.5.5.1.4" xref="S2.E7.m1.45.45.45.5.5.5.1.3.cmml"><mi id="S2.E7.m1.45.45.45.5.5.5.1.1" xref="S2.E7.m1.45.45.45.5.5.5.1.1.cmml">x</mi><mo id="S2.E7.m1.45.45.45.5.5.5.1.4.1" xref="S2.E7.m1.45.45.45.5.5.5.1.3.cmml">,</mo><mi id="S2.E7.m1.45.45.45.5.5.5.1.2" xref="S2.E7.m1.45.45.45.5.5.5.1.2.cmml">y</mi></mrow></msub></mrow><mo id="S2.E7.m1.46.46.46.6.6.6">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S2.E7.m1.50b"><apply id="S2.E7.m1.47.47.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S2.E7.m1.47.47.1.1.1.3a.cmml">formulae-sequence</csymbol><apply id="S2.E7.m1.47.47.1.1.1.1.1.cmml"><eq id="S2.E7.m1.3.3.3.3.3.3.cmml" xref="S2.E7.m1.3.3.3.3.3.3"></eq><apply id="S2.E7.m1.47.47.1.1.1.1.1.4.cmml"><csymbol cd="ambiguous" id="S2.E7.m1.47.47.1.1.1.1.1.4.1.cmml">subscript</csymbol><ci id="S2.E7.m1.1.1.1.1.1.1.cmml" xref="S2.E7.m1.1.1.1.1.1.1">𝑄</ci><ci id="S2.E7.m1.2.2.2.2.2.2.1.cmml" xref="S2.E7.m1.2.2.2.2.2.2.1">𝑞</ci></apply><apply id="S2.E7.m1.47.47.1.1.1.1.1.2.3.cmml"><ci id="S2.E7.m1.4.4.4.4.4.4.cmml" xref="S2.E7.m1.4.4.4.4.4.4">Cat</ci><apply id="S2.E7.m1.47.47.1.1.1.1.1.1.1.1.1.cmml"><csymbol cd="ambiguous" id="S2.E7.m1.47.47.1.1.1.1.1.1.1.1.1.1.cmml">subscript</csymbol><ci id="S2.E7.m1.6.6.6.6.6.6.cmml" xref="S2.E7.m1.6.6.6.6.6.6">𝐶</ci><ci id="S2.E7.m1.7.7.7.7.7.7.1.cmml" xref="S2.E7.m1.7.7.7.7.7.7.1">𝑞</ci></apply><apply id="S2.E7.m1.47.47.1.1.1.1.1.2.2.2.2.cmml"><ci id="S2.E7.m1.17.17.17.17.17.17.cmml" xref="S2.E7.m1.17.17.17.17.17.17">⋅</ci><apply id="S2.E7.m1.47.47.1.1.1.1.1.2.2.2.2.2.3.cmml"><ci id="S2.E7.m1.9.9.9.9.9.9.cmml" xref="S2.E7.m1.9.9.9.9.9.9">PE</ci><apply id="S2.E7.m1.47.47.1.1.1.1.1.2.2.2.2.1.1.1.1.cmml"><csymbol cd="ambiguous" id="S2.E7.m1.47.47.1.1.1.1.1.2.2.2.2.1.1.1.1.1.cmml">subscript</csymbol><ci id="S2.E7.m1.11.11.11.11.11.11.cmml" xref="S2.E7.m1.11.11.11.11.11.11">𝑥</ci><ci id="S2.E7.m1.12.12.12.12.12.12.1.cmml" xref="S2.E7.m1.12.12.12.12.12.12.1">𝑞</ci></apply><apply id="S2.E7.m1.47.47.1.1.1.1.1.2.2.2.2.2.2.2.2.cmml"><csymbol cd="ambiguous" id="S2.E7.m1.47.47.1.1.1.1.1.2.2.2.2.2.2.2.2.1.cmml">subscript</csymbol><ci id="S2.E7.m1.14.14.14.14.14.14.cmml" xref="S2.E7.m1.14.14.14.14.14.14">𝑦</ci><ci id="S2.E7.m1.15.15.15.15.15.15.1.cmml" xref="S2.E7.m1.15.15.15.15.15.15.1">𝑞</ci></apply></apply><apply id="S2.E7.m1.47.47.1.1.1.1.1.2.2.2.2.3.2.cmml"><ci id="S2.E7.m1.18.18.18.18.18.18.cmml" xref="S2.E7.m1.18.18.18.18.18.18">MLP</ci><apply id="S2.E7.m1.47.47.1.1.1.1.1.2.2.2.2.3.1.1.1.cmml"><csymbol cd="ambiguous" id="S2.E7.m1.47.47.1.1.1.1.1.2.2.2.2.3.1.1.1.1.cmml">subscript</csymbol><ci id="S2.E7.m1.20.20.20.20.20.20.cmml" xref="S2.E7.m1.20.20.20.20.20.20">𝐶</ci><ci id="S2.E7.m1.21.21.21.21.21.21.1.cmml" xref="S2.E7.m1.21.21.21.21.21.21.1">𝑞</ci></apply></apply></apply></apply></apply><apply id="S2.E7.m1.47.47.1.1.1.2.2.3.cmml"><csymbol cd="ambiguous" id="S2.E7.m1.47.47.1.1.1.2.2.3a.cmml">formulae-sequence</csymbol><apply id="S2.E7.m1.47.47.1.1.1.2.2.1.1.cmml"><eq id="S2.E7.m1.27.27.27.3.3.3.cmml" xref="S2.E7.m1.27.27.27.3.3.3"></eq><apply id="S2.E7.m1.47.47.1.1.1.2.2.1.1.4.cmml"><csymbol cd="ambiguous" id="S2.E7.m1.47.47.1.1.1.2.2.1.1.4.1.cmml">subscript</csymbol><ci id="S2.E7.m1.25.25.25.1.1.1.cmml" xref="S2.E7.m1.25.25.25.1.1.1">𝐾</ci><list id="S2.E7.m1.26.26.26.2.2.2.1.3.cmml" xref="S2.E7.m1.26.26.26.2.2.2.1.4"><ci id="S2.E7.m1.26.26.26.2.2.2.1.1.cmml" xref="S2.E7.m1.26.26.26.2.2.2.1.1">𝑥</ci><ci id="S2.E7.m1.26.26.26.2.2.2.1.2.cmml" xref="S2.E7.m1.26.26.26.2.2.2.1.2">𝑦</ci></list></apply><apply id="S2.E7.m1.47.47.1.1.1.2.2.1.1.2.3.cmml"><ci id="S2.E7.m1.28.28.28.4.4.4.cmml" xref="S2.E7.m1.28.28.28.4.4.4">Cat</ci><apply id="S2.E7.m1.47.47.1.1.1.2.2.1.1.1.1.1.1.cmml"><csymbol cd="ambiguous" id="S2.E7.m1.47.47.1.1.1.2.2.1.1.1.1.1.1.1.cmml">subscript</csymbol><ci id="S2.E7.m1.30.30.30.6.6.6.cmml" xref="S2.E7.m1.30.30.30.6.6.6">𝐹</ci><list id="S2.E7.m1.31.31.31.7.7.7.1.3.cmml" xref="S2.E7.m1.31.31.31.7.7.7.1.4"><ci id="S2.E7.m1.31.31.31.7.7.7.1.1.cmml" xref="S2.E7.m1.31.31.31.7.7.7.1.1">𝑥</ci><ci id="S2.E7.m1.31.31.31.7.7.7.1.2.cmml" xref="S2.E7.m1.31.31.31.7.7.7.1.2">𝑦</ci></list></apply><apply id="S2.E7.m1.47.47.1.1.1.2.2.1.1.2.2.2.2.cmml"><ci id="S2.E7.m1.33.33.33.9.9.9.cmml" xref="S2.E7.m1.33.33.33.9.9.9">PE</ci><ci id="S2.E7.m1.35.35.35.11.11.11.cmml" xref="S2.E7.m1.35.35.35.11.11.11">𝑥</ci><ci id="S2.E7.m1.37.37.37.13.13.13.cmml" xref="S2.E7.m1.37.37.37.13.13.13">𝑦</ci></apply></apply></apply><apply id="S2.E7.m1.47.47.1.1.1.2.2.2.2.cmml"><eq id="S2.E7.m1.43.43.43.3.3.3.cmml" xref="S2.E7.m1.43.43.43.3.3.3"></eq><apply id="S2.E7.m1.47.47.1.1.1.2.2.2.2.2.cmml"><csymbol cd="ambiguous" id="S2.E7.m1.47.47.1.1.1.2.2.2.2.2.1.cmml">subscript</csymbol><ci id="S2.E7.m1.41.41.41.1.1.1.cmml" xref="S2.E7.m1.41.41.41.1.1.1">𝑉</ci><list id="S2.E7.m1.42.42.42.2.2.2.1.3.cmml" xref="S2.E7.m1.42.42.42.2.2.2.1.4"><ci id="S2.E7.m1.42.42.42.2.2.2.1.1.cmml" xref="S2.E7.m1.42.42.42.2.2.2.1.1">𝑥</ci><ci id="S2.E7.m1.42.42.42.2.2.2.1.2.cmml" xref="S2.E7.m1.42.42.42.2.2.2.1.2">𝑦</ci></list></apply><apply id="S2.E7.m1.47.47.1.1.1.2.2.2.2.3.cmml"><csymbol cd="ambiguous" id="S2.E7.m1.47.47.1.1.1.2.2.2.2.3.1.cmml">subscript</csymbol><ci id="S2.E7.m1.44.44.44.4.4.4.cmml" xref="S2.E7.m1.44.44.44.4.4.4">𝐹</ci><list id="S2.E7.m1.45.45.45.5.5.5.1.3.cmml" xref="S2.E7.m1.45.45.45.5.5.5.1.4"><ci id="S2.E7.m1.45.45.45.5.5.5.1.1.cmml" xref="S2.E7.m1.45.45.45.5.5.5.1.1">𝑥</ci><ci id="S2.E7.m1.45.45.45.5.5.5.1.2.cmml" xref="S2.E7.m1.45.45.45.5.5.5.1.2">𝑦</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E7.m1.50c">\begin{split}&amp;Q_{q}=\operatorname{Cat}\left(C_{q},\operatorname{PE}\left(x_{q},y_{q}\right)\cdot\operatorname{MLP}\left(C_{q}\right)\right),\\
&amp;K_{x,y}=\operatorname{Cat}\left(F_{x,y},\operatorname{PE}(x,y)\right),\\
&amp;V_{x,y}=F_{x,y},\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S2.SS4.p4.3" class="ltx_p">where <math id="S2.SS4.p4.1.m1.1" class="ltx_Math" alttext="\operatorname{MLP}:\mathbb{R}^{D}\rightarrow\mathbb{R}^{D}" display="inline"><semantics id="S2.SS4.p4.1.m1.1a"><mrow id="S2.SS4.p4.1.m1.1.1" xref="S2.SS4.p4.1.m1.1.1.cmml"><mi id="S2.SS4.p4.1.m1.1.1.2" xref="S2.SS4.p4.1.m1.1.1.2.cmml">MLP</mi><mo lspace="0.278em" rspace="0.278em" id="S2.SS4.p4.1.m1.1.1.1" xref="S2.SS4.p4.1.m1.1.1.1.cmml">:</mo><mrow id="S2.SS4.p4.1.m1.1.1.3" xref="S2.SS4.p4.1.m1.1.1.3.cmml"><msup id="S2.SS4.p4.1.m1.1.1.3.2" xref="S2.SS4.p4.1.m1.1.1.3.2.cmml"><mi id="S2.SS4.p4.1.m1.1.1.3.2.2" xref="S2.SS4.p4.1.m1.1.1.3.2.2.cmml">ℝ</mi><mi id="S2.SS4.p4.1.m1.1.1.3.2.3" xref="S2.SS4.p4.1.m1.1.1.3.2.3.cmml">D</mi></msup><mo stretchy="false" id="S2.SS4.p4.1.m1.1.1.3.1" xref="S2.SS4.p4.1.m1.1.1.3.1.cmml">→</mo><msup id="S2.SS4.p4.1.m1.1.1.3.3" xref="S2.SS4.p4.1.m1.1.1.3.3.cmml"><mi id="S2.SS4.p4.1.m1.1.1.3.3.2" xref="S2.SS4.p4.1.m1.1.1.3.3.2.cmml">ℝ</mi><mi id="S2.SS4.p4.1.m1.1.1.3.3.3" xref="S2.SS4.p4.1.m1.1.1.3.3.3.cmml">D</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.1.m1.1b"><apply id="S2.SS4.p4.1.m1.1.1.cmml" xref="S2.SS4.p4.1.m1.1.1"><ci id="S2.SS4.p4.1.m1.1.1.1.cmml" xref="S2.SS4.p4.1.m1.1.1.1">:</ci><ci id="S2.SS4.p4.1.m1.1.1.2.cmml" xref="S2.SS4.p4.1.m1.1.1.2">MLP</ci><apply id="S2.SS4.p4.1.m1.1.1.3.cmml" xref="S2.SS4.p4.1.m1.1.1.3"><ci id="S2.SS4.p4.1.m1.1.1.3.1.cmml" xref="S2.SS4.p4.1.m1.1.1.3.1">→</ci><apply id="S2.SS4.p4.1.m1.1.1.3.2.cmml" xref="S2.SS4.p4.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS4.p4.1.m1.1.1.3.2.1.cmml" xref="S2.SS4.p4.1.m1.1.1.3.2">superscript</csymbol><ci id="S2.SS4.p4.1.m1.1.1.3.2.2.cmml" xref="S2.SS4.p4.1.m1.1.1.3.2.2">ℝ</ci><ci id="S2.SS4.p4.1.m1.1.1.3.2.3.cmml" xref="S2.SS4.p4.1.m1.1.1.3.2.3">𝐷</ci></apply><apply id="S2.SS4.p4.1.m1.1.1.3.3.cmml" xref="S2.SS4.p4.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS4.p4.1.m1.1.1.3.3.1.cmml" xref="S2.SS4.p4.1.m1.1.1.3.3">superscript</csymbol><ci id="S2.SS4.p4.1.m1.1.1.3.3.2.cmml" xref="S2.SS4.p4.1.m1.1.1.3.3.2">ℝ</ci><ci id="S2.SS4.p4.1.m1.1.1.3.3.3.cmml" xref="S2.SS4.p4.1.m1.1.1.3.3.3">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.1.m1.1c">\operatorname{MLP}:\mathbb{R}^{D}\rightarrow\mathbb{R}^{D}</annotation></semantics></math> is composed of two linear layers to learn a scale vector of the content information. We concatenate the position and content information together as queries and keys to consider both the content and position contributions so that the query matrix and key matrix can be expressed as <math id="S2.SS4.p4.2.m2.3" class="ltx_Math" alttext="Q=\operatorname{Cat}(Q_{C},Q_{P})" display="inline"><semantics id="S2.SS4.p4.2.m2.3a"><mrow id="S2.SS4.p4.2.m2.3.3" xref="S2.SS4.p4.2.m2.3.3.cmml"><mi id="S2.SS4.p4.2.m2.3.3.4" xref="S2.SS4.p4.2.m2.3.3.4.cmml">Q</mi><mo id="S2.SS4.p4.2.m2.3.3.3" xref="S2.SS4.p4.2.m2.3.3.3.cmml">=</mo><mrow id="S2.SS4.p4.2.m2.3.3.2.2" xref="S2.SS4.p4.2.m2.3.3.2.3.cmml"><mi id="S2.SS4.p4.2.m2.1.1" xref="S2.SS4.p4.2.m2.1.1.cmml">Cat</mi><mo id="S2.SS4.p4.2.m2.3.3.2.2a" xref="S2.SS4.p4.2.m2.3.3.2.3.cmml">⁡</mo><mrow id="S2.SS4.p4.2.m2.3.3.2.2.2" xref="S2.SS4.p4.2.m2.3.3.2.3.cmml"><mo stretchy="false" id="S2.SS4.p4.2.m2.3.3.2.2.2.3" xref="S2.SS4.p4.2.m2.3.3.2.3.cmml">(</mo><msub id="S2.SS4.p4.2.m2.2.2.1.1.1.1" xref="S2.SS4.p4.2.m2.2.2.1.1.1.1.cmml"><mi id="S2.SS4.p4.2.m2.2.2.1.1.1.1.2" xref="S2.SS4.p4.2.m2.2.2.1.1.1.1.2.cmml">Q</mi><mi id="S2.SS4.p4.2.m2.2.2.1.1.1.1.3" xref="S2.SS4.p4.2.m2.2.2.1.1.1.1.3.cmml">C</mi></msub><mo id="S2.SS4.p4.2.m2.3.3.2.2.2.4" xref="S2.SS4.p4.2.m2.3.3.2.3.cmml">,</mo><msub id="S2.SS4.p4.2.m2.3.3.2.2.2.2" xref="S2.SS4.p4.2.m2.3.3.2.2.2.2.cmml"><mi id="S2.SS4.p4.2.m2.3.3.2.2.2.2.2" xref="S2.SS4.p4.2.m2.3.3.2.2.2.2.2.cmml">Q</mi><mi id="S2.SS4.p4.2.m2.3.3.2.2.2.2.3" xref="S2.SS4.p4.2.m2.3.3.2.2.2.2.3.cmml">P</mi></msub><mo stretchy="false" id="S2.SS4.p4.2.m2.3.3.2.2.2.5" xref="S2.SS4.p4.2.m2.3.3.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.2.m2.3b"><apply id="S2.SS4.p4.2.m2.3.3.cmml" xref="S2.SS4.p4.2.m2.3.3"><eq id="S2.SS4.p4.2.m2.3.3.3.cmml" xref="S2.SS4.p4.2.m2.3.3.3"></eq><ci id="S2.SS4.p4.2.m2.3.3.4.cmml" xref="S2.SS4.p4.2.m2.3.3.4">𝑄</ci><apply id="S2.SS4.p4.2.m2.3.3.2.3.cmml" xref="S2.SS4.p4.2.m2.3.3.2.2"><ci id="S2.SS4.p4.2.m2.1.1.cmml" xref="S2.SS4.p4.2.m2.1.1">Cat</ci><apply id="S2.SS4.p4.2.m2.2.2.1.1.1.1.cmml" xref="S2.SS4.p4.2.m2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p4.2.m2.2.2.1.1.1.1.1.cmml" xref="S2.SS4.p4.2.m2.2.2.1.1.1.1">subscript</csymbol><ci id="S2.SS4.p4.2.m2.2.2.1.1.1.1.2.cmml" xref="S2.SS4.p4.2.m2.2.2.1.1.1.1.2">𝑄</ci><ci id="S2.SS4.p4.2.m2.2.2.1.1.1.1.3.cmml" xref="S2.SS4.p4.2.m2.2.2.1.1.1.1.3">𝐶</ci></apply><apply id="S2.SS4.p4.2.m2.3.3.2.2.2.2.cmml" xref="S2.SS4.p4.2.m2.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS4.p4.2.m2.3.3.2.2.2.2.1.cmml" xref="S2.SS4.p4.2.m2.3.3.2.2.2.2">subscript</csymbol><ci id="S2.SS4.p4.2.m2.3.3.2.2.2.2.2.cmml" xref="S2.SS4.p4.2.m2.3.3.2.2.2.2.2">𝑄</ci><ci id="S2.SS4.p4.2.m2.3.3.2.2.2.2.3.cmml" xref="S2.SS4.p4.2.m2.3.3.2.2.2.2.3">𝑃</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.2.m2.3c">Q=\operatorname{Cat}(Q_{C},Q_{P})</annotation></semantics></math> and <math id="S2.SS4.p4.3.m3.3" class="ltx_Math" alttext="K=\operatorname{Cat}(K_{C},K_{P})" display="inline"><semantics id="S2.SS4.p4.3.m3.3a"><mrow id="S2.SS4.p4.3.m3.3.3" xref="S2.SS4.p4.3.m3.3.3.cmml"><mi id="S2.SS4.p4.3.m3.3.3.4" xref="S2.SS4.p4.3.m3.3.3.4.cmml">K</mi><mo id="S2.SS4.p4.3.m3.3.3.3" xref="S2.SS4.p4.3.m3.3.3.3.cmml">=</mo><mrow id="S2.SS4.p4.3.m3.3.3.2.2" xref="S2.SS4.p4.3.m3.3.3.2.3.cmml"><mi id="S2.SS4.p4.3.m3.1.1" xref="S2.SS4.p4.3.m3.1.1.cmml">Cat</mi><mo id="S2.SS4.p4.3.m3.3.3.2.2a" xref="S2.SS4.p4.3.m3.3.3.2.3.cmml">⁡</mo><mrow id="S2.SS4.p4.3.m3.3.3.2.2.2" xref="S2.SS4.p4.3.m3.3.3.2.3.cmml"><mo stretchy="false" id="S2.SS4.p4.3.m3.3.3.2.2.2.3" xref="S2.SS4.p4.3.m3.3.3.2.3.cmml">(</mo><msub id="S2.SS4.p4.3.m3.2.2.1.1.1.1" xref="S2.SS4.p4.3.m3.2.2.1.1.1.1.cmml"><mi id="S2.SS4.p4.3.m3.2.2.1.1.1.1.2" xref="S2.SS4.p4.3.m3.2.2.1.1.1.1.2.cmml">K</mi><mi id="S2.SS4.p4.3.m3.2.2.1.1.1.1.3" xref="S2.SS4.p4.3.m3.2.2.1.1.1.1.3.cmml">C</mi></msub><mo id="S2.SS4.p4.3.m3.3.3.2.2.2.4" xref="S2.SS4.p4.3.m3.3.3.2.3.cmml">,</mo><msub id="S2.SS4.p4.3.m3.3.3.2.2.2.2" xref="S2.SS4.p4.3.m3.3.3.2.2.2.2.cmml"><mi id="S2.SS4.p4.3.m3.3.3.2.2.2.2.2" xref="S2.SS4.p4.3.m3.3.3.2.2.2.2.2.cmml">K</mi><mi id="S2.SS4.p4.3.m3.3.3.2.2.2.2.3" xref="S2.SS4.p4.3.m3.3.3.2.2.2.2.3.cmml">P</mi></msub><mo stretchy="false" id="S2.SS4.p4.3.m3.3.3.2.2.2.5" xref="S2.SS4.p4.3.m3.3.3.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.3.m3.3b"><apply id="S2.SS4.p4.3.m3.3.3.cmml" xref="S2.SS4.p4.3.m3.3.3"><eq id="S2.SS4.p4.3.m3.3.3.3.cmml" xref="S2.SS4.p4.3.m3.3.3.3"></eq><ci id="S2.SS4.p4.3.m3.3.3.4.cmml" xref="S2.SS4.p4.3.m3.3.3.4">𝐾</ci><apply id="S2.SS4.p4.3.m3.3.3.2.3.cmml" xref="S2.SS4.p4.3.m3.3.3.2.2"><ci id="S2.SS4.p4.3.m3.1.1.cmml" xref="S2.SS4.p4.3.m3.1.1">Cat</ci><apply id="S2.SS4.p4.3.m3.2.2.1.1.1.1.cmml" xref="S2.SS4.p4.3.m3.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p4.3.m3.2.2.1.1.1.1.1.cmml" xref="S2.SS4.p4.3.m3.2.2.1.1.1.1">subscript</csymbol><ci id="S2.SS4.p4.3.m3.2.2.1.1.1.1.2.cmml" xref="S2.SS4.p4.3.m3.2.2.1.1.1.1.2">𝐾</ci><ci id="S2.SS4.p4.3.m3.2.2.1.1.1.1.3.cmml" xref="S2.SS4.p4.3.m3.2.2.1.1.1.1.3">𝐶</ci></apply><apply id="S2.SS4.p4.3.m3.3.3.2.2.2.2.cmml" xref="S2.SS4.p4.3.m3.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS4.p4.3.m3.3.3.2.2.2.2.1.cmml" xref="S2.SS4.p4.3.m3.3.3.2.2.2.2">subscript</csymbol><ci id="S2.SS4.p4.3.m3.3.3.2.2.2.2.2.cmml" xref="S2.SS4.p4.3.m3.3.3.2.2.2.2.2">𝐾</ci><ci id="S2.SS4.p4.3.m3.3.3.2.2.2.2.3.cmml" xref="S2.SS4.p4.3.m3.3.3.2.2.2.2.3">𝑃</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.3.m3.3c">K=\operatorname{Cat}(K_{C},K_{P})</annotation></semantics></math>. Based on the above queries, keys, and values, the cross-attention module is formulated as follows:</p>
<table id="S2.E8" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S2.E8X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E8X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\operatorname{Cross}" display="inline"><semantics id="S2.E8X.2.1.1.m1.1a"><mi id="S2.E8X.2.1.1.m1.1.1" xref="S2.E8X.2.1.1.m1.1.1.cmml">Cross</mi><annotation-xml encoding="MathML-Content" id="S2.E8X.2.1.1.m1.1b"><ci id="S2.E8X.2.1.1.m1.1.1.cmml" xref="S2.E8X.2.1.1.m1.1.1">Cross</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.E8X.2.1.1.m1.1c">\displaystyle\operatorname{Cross}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E8X.3.2.2.m1.4" class="ltx_Math" alttext="\displaystyle\operatorname{Attn}(Q,K,V)=" display="inline"><semantics id="S2.E8X.3.2.2.m1.4a"><mrow id="S2.E8X.3.2.2.m1.4.5" xref="S2.E8X.3.2.2.m1.4.5.cmml"><mrow id="S2.E8X.3.2.2.m1.4.5.2.2" xref="S2.E8X.3.2.2.m1.4.5.2.1.cmml"><mi id="S2.E8X.3.2.2.m1.1.1" xref="S2.E8X.3.2.2.m1.1.1.cmml">Attn</mi><mo id="S2.E8X.3.2.2.m1.4.5.2.2a" xref="S2.E8X.3.2.2.m1.4.5.2.1.cmml">⁡</mo><mrow id="S2.E8X.3.2.2.m1.4.5.2.2.1" xref="S2.E8X.3.2.2.m1.4.5.2.1.cmml"><mo stretchy="false" id="S2.E8X.3.2.2.m1.4.5.2.2.1.1" xref="S2.E8X.3.2.2.m1.4.5.2.1.cmml">(</mo><mi id="S2.E8X.3.2.2.m1.2.2" xref="S2.E8X.3.2.2.m1.2.2.cmml">Q</mi><mo id="S2.E8X.3.2.2.m1.4.5.2.2.1.2" xref="S2.E8X.3.2.2.m1.4.5.2.1.cmml">,</mo><mi id="S2.E8X.3.2.2.m1.3.3" xref="S2.E8X.3.2.2.m1.3.3.cmml">K</mi><mo id="S2.E8X.3.2.2.m1.4.5.2.2.1.3" xref="S2.E8X.3.2.2.m1.4.5.2.1.cmml">,</mo><mi id="S2.E8X.3.2.2.m1.4.4" xref="S2.E8X.3.2.2.m1.4.4.cmml">V</mi><mo stretchy="false" id="S2.E8X.3.2.2.m1.4.5.2.2.1.4" xref="S2.E8X.3.2.2.m1.4.5.2.1.cmml">)</mo></mrow></mrow><mo id="S2.E8X.3.2.2.m1.4.5.1" xref="S2.E8X.3.2.2.m1.4.5.1.cmml">=</mo><mi id="S2.E8X.3.2.2.m1.4.5.3" xref="S2.E8X.3.2.2.m1.4.5.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S2.E8X.3.2.2.m1.4b"><apply id="S2.E8X.3.2.2.m1.4.5.cmml" xref="S2.E8X.3.2.2.m1.4.5"><eq id="S2.E8X.3.2.2.m1.4.5.1.cmml" xref="S2.E8X.3.2.2.m1.4.5.1"></eq><apply id="S2.E8X.3.2.2.m1.4.5.2.1.cmml" xref="S2.E8X.3.2.2.m1.4.5.2.2"><ci id="S2.E8X.3.2.2.m1.1.1.cmml" xref="S2.E8X.3.2.2.m1.1.1">Attn</ci><ci id="S2.E8X.3.2.2.m1.2.2.cmml" xref="S2.E8X.3.2.2.m1.2.2">𝑄</ci><ci id="S2.E8X.3.2.2.m1.3.3.cmml" xref="S2.E8X.3.2.2.m1.3.3">𝐾</ci><ci id="S2.E8X.3.2.2.m1.4.4.cmml" xref="S2.E8X.3.2.2.m1.4.4">𝑉</ci></apply><csymbol cd="latexml" id="S2.E8X.3.2.2.m1.4.5.3.cmml" xref="S2.E8X.3.2.2.m1.4.5.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E8X.3.2.2.m1.4c">\displaystyle\operatorname{Attn}(Q,K,V)=</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(8)</span></td>
</tr>
<tr id="S2.E8Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E8Xa.2.1.1.m1.5" class="ltx_Math" alttext="\displaystyle\operatorname{softmax}\left(\frac{Q_{C}K_{C}^{T}+\operatorname{ModAttn}(Q_{P},K_{P})}{\sqrt{d}}\right)V," display="inline"><semantics id="S2.E8Xa.2.1.1.m1.5a"><mrow id="S2.E8Xa.2.1.1.m1.5.5.1" xref="S2.E8Xa.2.1.1.m1.5.5.1.1.cmml"><mrow id="S2.E8Xa.2.1.1.m1.5.5.1.1" xref="S2.E8Xa.2.1.1.m1.5.5.1.1.cmml"><mrow id="S2.E8Xa.2.1.1.m1.5.5.1.1.2.2" xref="S2.E8Xa.2.1.1.m1.5.5.1.1.2.1.cmml"><mi id="S2.E8Xa.2.1.1.m1.4.4" xref="S2.E8Xa.2.1.1.m1.4.4.cmml">softmax</mi><mo id="S2.E8Xa.2.1.1.m1.5.5.1.1.2.2a" xref="S2.E8Xa.2.1.1.m1.5.5.1.1.2.1.cmml">⁡</mo><mrow id="S2.E8Xa.2.1.1.m1.5.5.1.1.2.2.1" xref="S2.E8Xa.2.1.1.m1.5.5.1.1.2.1.cmml"><mo id="S2.E8Xa.2.1.1.m1.5.5.1.1.2.2.1.1" xref="S2.E8Xa.2.1.1.m1.5.5.1.1.2.1.cmml">(</mo><mstyle displaystyle="true" id="S2.E8Xa.2.1.1.m1.3.3" xref="S2.E8Xa.2.1.1.m1.3.3.cmml"><mfrac id="S2.E8Xa.2.1.1.m1.3.3a" xref="S2.E8Xa.2.1.1.m1.3.3.cmml"><mrow id="S2.E8Xa.2.1.1.m1.3.3.3" xref="S2.E8Xa.2.1.1.m1.3.3.3.cmml"><mrow id="S2.E8Xa.2.1.1.m1.3.3.3.5" xref="S2.E8Xa.2.1.1.m1.3.3.3.5.cmml"><msub id="S2.E8Xa.2.1.1.m1.3.3.3.5.2" xref="S2.E8Xa.2.1.1.m1.3.3.3.5.2.cmml"><mi id="S2.E8Xa.2.1.1.m1.3.3.3.5.2.2" xref="S2.E8Xa.2.1.1.m1.3.3.3.5.2.2.cmml">Q</mi><mi id="S2.E8Xa.2.1.1.m1.3.3.3.5.2.3" xref="S2.E8Xa.2.1.1.m1.3.3.3.5.2.3.cmml">C</mi></msub><mo lspace="0em" rspace="0em" id="S2.E8Xa.2.1.1.m1.3.3.3.5.1" xref="S2.E8Xa.2.1.1.m1.3.3.3.5.1.cmml">​</mo><msubsup id="S2.E8Xa.2.1.1.m1.3.3.3.5.3" xref="S2.E8Xa.2.1.1.m1.3.3.3.5.3.cmml"><mi id="S2.E8Xa.2.1.1.m1.3.3.3.5.3.2.2" xref="S2.E8Xa.2.1.1.m1.3.3.3.5.3.2.2.cmml">K</mi><mi id="S2.E8Xa.2.1.1.m1.3.3.3.5.3.2.3" xref="S2.E8Xa.2.1.1.m1.3.3.3.5.3.2.3.cmml">C</mi><mi id="S2.E8Xa.2.1.1.m1.3.3.3.5.3.3" xref="S2.E8Xa.2.1.1.m1.3.3.3.5.3.3.cmml">T</mi></msubsup></mrow><mo id="S2.E8Xa.2.1.1.m1.3.3.3.4" xref="S2.E8Xa.2.1.1.m1.3.3.3.4.cmml">+</mo><mrow id="S2.E8Xa.2.1.1.m1.3.3.3.3.2" xref="S2.E8Xa.2.1.1.m1.3.3.3.3.3.cmml"><mi id="S2.E8Xa.2.1.1.m1.1.1.1.1" xref="S2.E8Xa.2.1.1.m1.1.1.1.1.cmml">ModAttn</mi><mo id="S2.E8Xa.2.1.1.m1.3.3.3.3.2a" xref="S2.E8Xa.2.1.1.m1.3.3.3.3.3.cmml">⁡</mo><mrow id="S2.E8Xa.2.1.1.m1.3.3.3.3.2.2" xref="S2.E8Xa.2.1.1.m1.3.3.3.3.3.cmml"><mo stretchy="false" id="S2.E8Xa.2.1.1.m1.3.3.3.3.2.2.3" xref="S2.E8Xa.2.1.1.m1.3.3.3.3.3.cmml">(</mo><msub id="S2.E8Xa.2.1.1.m1.2.2.2.2.1.1.1" xref="S2.E8Xa.2.1.1.m1.2.2.2.2.1.1.1.cmml"><mi id="S2.E8Xa.2.1.1.m1.2.2.2.2.1.1.1.2" xref="S2.E8Xa.2.1.1.m1.2.2.2.2.1.1.1.2.cmml">Q</mi><mi id="S2.E8Xa.2.1.1.m1.2.2.2.2.1.1.1.3" xref="S2.E8Xa.2.1.1.m1.2.2.2.2.1.1.1.3.cmml">P</mi></msub><mo id="S2.E8Xa.2.1.1.m1.3.3.3.3.2.2.4" xref="S2.E8Xa.2.1.1.m1.3.3.3.3.3.cmml">,</mo><msub id="S2.E8Xa.2.1.1.m1.3.3.3.3.2.2.2" xref="S2.E8Xa.2.1.1.m1.3.3.3.3.2.2.2.cmml"><mi id="S2.E8Xa.2.1.1.m1.3.3.3.3.2.2.2.2" xref="S2.E8Xa.2.1.1.m1.3.3.3.3.2.2.2.2.cmml">K</mi><mi id="S2.E8Xa.2.1.1.m1.3.3.3.3.2.2.2.3" xref="S2.E8Xa.2.1.1.m1.3.3.3.3.2.2.2.3.cmml">P</mi></msub><mo stretchy="false" id="S2.E8Xa.2.1.1.m1.3.3.3.3.2.2.5" xref="S2.E8Xa.2.1.1.m1.3.3.3.3.3.cmml">)</mo></mrow></mrow></mrow><msqrt id="S2.E8Xa.2.1.1.m1.3.3.5" xref="S2.E8Xa.2.1.1.m1.3.3.5.cmml"><mi id="S2.E8Xa.2.1.1.m1.3.3.5.2" xref="S2.E8Xa.2.1.1.m1.3.3.5.2.cmml">d</mi></msqrt></mfrac></mstyle><mo id="S2.E8Xa.2.1.1.m1.5.5.1.1.2.2.1.2" xref="S2.E8Xa.2.1.1.m1.5.5.1.1.2.1.cmml">)</mo></mrow></mrow><mo lspace="0em" rspace="0em" id="S2.E8Xa.2.1.1.m1.5.5.1.1.1" xref="S2.E8Xa.2.1.1.m1.5.5.1.1.1.cmml">​</mo><mi id="S2.E8Xa.2.1.1.m1.5.5.1.1.3" xref="S2.E8Xa.2.1.1.m1.5.5.1.1.3.cmml">V</mi></mrow><mo id="S2.E8Xa.2.1.1.m1.5.5.1.2" xref="S2.E8Xa.2.1.1.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E8Xa.2.1.1.m1.5b"><apply id="S2.E8Xa.2.1.1.m1.5.5.1.1.cmml" xref="S2.E8Xa.2.1.1.m1.5.5.1"><times id="S2.E8Xa.2.1.1.m1.5.5.1.1.1.cmml" xref="S2.E8Xa.2.1.1.m1.5.5.1.1.1"></times><apply id="S2.E8Xa.2.1.1.m1.5.5.1.1.2.1.cmml" xref="S2.E8Xa.2.1.1.m1.5.5.1.1.2.2"><ci id="S2.E8Xa.2.1.1.m1.4.4.cmml" xref="S2.E8Xa.2.1.1.m1.4.4">softmax</ci><apply id="S2.E8Xa.2.1.1.m1.3.3.cmml" xref="S2.E8Xa.2.1.1.m1.3.3"><divide id="S2.E8Xa.2.1.1.m1.3.3.4.cmml" xref="S2.E8Xa.2.1.1.m1.3.3"></divide><apply id="S2.E8Xa.2.1.1.m1.3.3.3.cmml" xref="S2.E8Xa.2.1.1.m1.3.3.3"><plus id="S2.E8Xa.2.1.1.m1.3.3.3.4.cmml" xref="S2.E8Xa.2.1.1.m1.3.3.3.4"></plus><apply id="S2.E8Xa.2.1.1.m1.3.3.3.5.cmml" xref="S2.E8Xa.2.1.1.m1.3.3.3.5"><times id="S2.E8Xa.2.1.1.m1.3.3.3.5.1.cmml" xref="S2.E8Xa.2.1.1.m1.3.3.3.5.1"></times><apply id="S2.E8Xa.2.1.1.m1.3.3.3.5.2.cmml" xref="S2.E8Xa.2.1.1.m1.3.3.3.5.2"><csymbol cd="ambiguous" id="S2.E8Xa.2.1.1.m1.3.3.3.5.2.1.cmml" xref="S2.E8Xa.2.1.1.m1.3.3.3.5.2">subscript</csymbol><ci id="S2.E8Xa.2.1.1.m1.3.3.3.5.2.2.cmml" xref="S2.E8Xa.2.1.1.m1.3.3.3.5.2.2">𝑄</ci><ci id="S2.E8Xa.2.1.1.m1.3.3.3.5.2.3.cmml" xref="S2.E8Xa.2.1.1.m1.3.3.3.5.2.3">𝐶</ci></apply><apply id="S2.E8Xa.2.1.1.m1.3.3.3.5.3.cmml" xref="S2.E8Xa.2.1.1.m1.3.3.3.5.3"><csymbol cd="ambiguous" id="S2.E8Xa.2.1.1.m1.3.3.3.5.3.1.cmml" xref="S2.E8Xa.2.1.1.m1.3.3.3.5.3">superscript</csymbol><apply id="S2.E8Xa.2.1.1.m1.3.3.3.5.3.2.cmml" xref="S2.E8Xa.2.1.1.m1.3.3.3.5.3"><csymbol cd="ambiguous" id="S2.E8Xa.2.1.1.m1.3.3.3.5.3.2.1.cmml" xref="S2.E8Xa.2.1.1.m1.3.3.3.5.3">subscript</csymbol><ci id="S2.E8Xa.2.1.1.m1.3.3.3.5.3.2.2.cmml" xref="S2.E8Xa.2.1.1.m1.3.3.3.5.3.2.2">𝐾</ci><ci id="S2.E8Xa.2.1.1.m1.3.3.3.5.3.2.3.cmml" xref="S2.E8Xa.2.1.1.m1.3.3.3.5.3.2.3">𝐶</ci></apply><ci id="S2.E8Xa.2.1.1.m1.3.3.3.5.3.3.cmml" xref="S2.E8Xa.2.1.1.m1.3.3.3.5.3.3">𝑇</ci></apply></apply><apply id="S2.E8Xa.2.1.1.m1.3.3.3.3.3.cmml" xref="S2.E8Xa.2.1.1.m1.3.3.3.3.2"><ci id="S2.E8Xa.2.1.1.m1.1.1.1.1.cmml" xref="S2.E8Xa.2.1.1.m1.1.1.1.1">ModAttn</ci><apply id="S2.E8Xa.2.1.1.m1.2.2.2.2.1.1.1.cmml" xref="S2.E8Xa.2.1.1.m1.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.E8Xa.2.1.1.m1.2.2.2.2.1.1.1.1.cmml" xref="S2.E8Xa.2.1.1.m1.2.2.2.2.1.1.1">subscript</csymbol><ci id="S2.E8Xa.2.1.1.m1.2.2.2.2.1.1.1.2.cmml" xref="S2.E8Xa.2.1.1.m1.2.2.2.2.1.1.1.2">𝑄</ci><ci id="S2.E8Xa.2.1.1.m1.2.2.2.2.1.1.1.3.cmml" xref="S2.E8Xa.2.1.1.m1.2.2.2.2.1.1.1.3">𝑃</ci></apply><apply id="S2.E8Xa.2.1.1.m1.3.3.3.3.2.2.2.cmml" xref="S2.E8Xa.2.1.1.m1.3.3.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.E8Xa.2.1.1.m1.3.3.3.3.2.2.2.1.cmml" xref="S2.E8Xa.2.1.1.m1.3.3.3.3.2.2.2">subscript</csymbol><ci id="S2.E8Xa.2.1.1.m1.3.3.3.3.2.2.2.2.cmml" xref="S2.E8Xa.2.1.1.m1.3.3.3.3.2.2.2.2">𝐾</ci><ci id="S2.E8Xa.2.1.1.m1.3.3.3.3.2.2.2.3.cmml" xref="S2.E8Xa.2.1.1.m1.3.3.3.3.2.2.2.3">𝑃</ci></apply></apply></apply><apply id="S2.E8Xa.2.1.1.m1.3.3.5.cmml" xref="S2.E8Xa.2.1.1.m1.3.3.5"><root id="S2.E8Xa.2.1.1.m1.3.3.5a.cmml" xref="S2.E8Xa.2.1.1.m1.3.3.5"></root><ci id="S2.E8Xa.2.1.1.m1.3.3.5.2.cmml" xref="S2.E8Xa.2.1.1.m1.3.3.5.2">𝑑</ci></apply></apply></apply><ci id="S2.E8Xa.2.1.1.m1.5.5.1.1.3.cmml" xref="S2.E8Xa.2.1.1.m1.5.5.1.1.3">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E8Xa.2.1.1.m1.5c">\displaystyle\operatorname{softmax}\left(\frac{Q_{C}K_{C}^{T}+\operatorname{ModAttn}(Q_{P},K_{P})}{\sqrt{d}}\right)V,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S2.SS4.p4.7" class="ltx_p">where the modulated positional attention helps us extract features of objects with different widths and heights, which can be expressed as</p>
<table id="S2.E9" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S2.E9X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E9X.2.1.1.m1.7" class="ltx_Math" alttext="\displaystyle\operatorname{ModAttn}(\operatorname{PE}(x_{q},y_{q}),\operatorname{PE}(x,y))" display="inline"><semantics id="S2.E9X.2.1.1.m1.7a"><mrow id="S2.E9X.2.1.1.m1.7.7.2" xref="S2.E9X.2.1.1.m1.7.7.3.cmml"><mi id="S2.E9X.2.1.1.m1.5.5" xref="S2.E9X.2.1.1.m1.5.5.cmml">ModAttn</mi><mo id="S2.E9X.2.1.1.m1.7.7.2a" xref="S2.E9X.2.1.1.m1.7.7.3.cmml">⁡</mo><mrow id="S2.E9X.2.1.1.m1.7.7.2.2" xref="S2.E9X.2.1.1.m1.7.7.3.cmml"><mo stretchy="false" id="S2.E9X.2.1.1.m1.7.7.2.2.3" xref="S2.E9X.2.1.1.m1.7.7.3.cmml">(</mo><mrow id="S2.E9X.2.1.1.m1.6.6.1.1.1.2" xref="S2.E9X.2.1.1.m1.6.6.1.1.1.3.cmml"><mi id="S2.E9X.2.1.1.m1.1.1" xref="S2.E9X.2.1.1.m1.1.1.cmml">PE</mi><mo id="S2.E9X.2.1.1.m1.6.6.1.1.1.2a" xref="S2.E9X.2.1.1.m1.6.6.1.1.1.3.cmml">⁡</mo><mrow id="S2.E9X.2.1.1.m1.6.6.1.1.1.2.2" xref="S2.E9X.2.1.1.m1.6.6.1.1.1.3.cmml"><mo stretchy="false" id="S2.E9X.2.1.1.m1.6.6.1.1.1.2.2.3" xref="S2.E9X.2.1.1.m1.6.6.1.1.1.3.cmml">(</mo><msub id="S2.E9X.2.1.1.m1.6.6.1.1.1.1.1.1" xref="S2.E9X.2.1.1.m1.6.6.1.1.1.1.1.1.cmml"><mi id="S2.E9X.2.1.1.m1.6.6.1.1.1.1.1.1.2" xref="S2.E9X.2.1.1.m1.6.6.1.1.1.1.1.1.2.cmml">x</mi><mi id="S2.E9X.2.1.1.m1.6.6.1.1.1.1.1.1.3" xref="S2.E9X.2.1.1.m1.6.6.1.1.1.1.1.1.3.cmml">q</mi></msub><mo id="S2.E9X.2.1.1.m1.6.6.1.1.1.2.2.4" xref="S2.E9X.2.1.1.m1.6.6.1.1.1.3.cmml">,</mo><msub id="S2.E9X.2.1.1.m1.6.6.1.1.1.2.2.2" xref="S2.E9X.2.1.1.m1.6.6.1.1.1.2.2.2.cmml"><mi id="S2.E9X.2.1.1.m1.6.6.1.1.1.2.2.2.2" xref="S2.E9X.2.1.1.m1.6.6.1.1.1.2.2.2.2.cmml">y</mi><mi id="S2.E9X.2.1.1.m1.6.6.1.1.1.2.2.2.3" xref="S2.E9X.2.1.1.m1.6.6.1.1.1.2.2.2.3.cmml">q</mi></msub><mo stretchy="false" id="S2.E9X.2.1.1.m1.6.6.1.1.1.2.2.5" xref="S2.E9X.2.1.1.m1.6.6.1.1.1.3.cmml">)</mo></mrow></mrow><mo id="S2.E9X.2.1.1.m1.7.7.2.2.4" xref="S2.E9X.2.1.1.m1.7.7.3.cmml">,</mo><mrow id="S2.E9X.2.1.1.m1.7.7.2.2.2.2" xref="S2.E9X.2.1.1.m1.7.7.2.2.2.1.cmml"><mi id="S2.E9X.2.1.1.m1.2.2" xref="S2.E9X.2.1.1.m1.2.2.cmml">PE</mi><mo id="S2.E9X.2.1.1.m1.7.7.2.2.2.2a" xref="S2.E9X.2.1.1.m1.7.7.2.2.2.1.cmml">⁡</mo><mrow id="S2.E9X.2.1.1.m1.7.7.2.2.2.2.1" xref="S2.E9X.2.1.1.m1.7.7.2.2.2.1.cmml"><mo stretchy="false" id="S2.E9X.2.1.1.m1.7.7.2.2.2.2.1.1" xref="S2.E9X.2.1.1.m1.7.7.2.2.2.1.cmml">(</mo><mi id="S2.E9X.2.1.1.m1.3.3" xref="S2.E9X.2.1.1.m1.3.3.cmml">x</mi><mo id="S2.E9X.2.1.1.m1.7.7.2.2.2.2.1.2" xref="S2.E9X.2.1.1.m1.7.7.2.2.2.1.cmml">,</mo><mi id="S2.E9X.2.1.1.m1.4.4" xref="S2.E9X.2.1.1.m1.4.4.cmml">y</mi><mo stretchy="false" id="S2.E9X.2.1.1.m1.7.7.2.2.2.2.1.3" xref="S2.E9X.2.1.1.m1.7.7.2.2.2.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.E9X.2.1.1.m1.7.7.2.2.5" xref="S2.E9X.2.1.1.m1.7.7.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E9X.2.1.1.m1.7b"><apply id="S2.E9X.2.1.1.m1.7.7.3.cmml" xref="S2.E9X.2.1.1.m1.7.7.2"><ci id="S2.E9X.2.1.1.m1.5.5.cmml" xref="S2.E9X.2.1.1.m1.5.5">ModAttn</ci><apply id="S2.E9X.2.1.1.m1.6.6.1.1.1.3.cmml" xref="S2.E9X.2.1.1.m1.6.6.1.1.1.2"><ci id="S2.E9X.2.1.1.m1.1.1.cmml" xref="S2.E9X.2.1.1.m1.1.1">PE</ci><apply id="S2.E9X.2.1.1.m1.6.6.1.1.1.1.1.1.cmml" xref="S2.E9X.2.1.1.m1.6.6.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E9X.2.1.1.m1.6.6.1.1.1.1.1.1.1.cmml" xref="S2.E9X.2.1.1.m1.6.6.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E9X.2.1.1.m1.6.6.1.1.1.1.1.1.2.cmml" xref="S2.E9X.2.1.1.m1.6.6.1.1.1.1.1.1.2">𝑥</ci><ci id="S2.E9X.2.1.1.m1.6.6.1.1.1.1.1.1.3.cmml" xref="S2.E9X.2.1.1.m1.6.6.1.1.1.1.1.1.3">𝑞</ci></apply><apply id="S2.E9X.2.1.1.m1.6.6.1.1.1.2.2.2.cmml" xref="S2.E9X.2.1.1.m1.6.6.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E9X.2.1.1.m1.6.6.1.1.1.2.2.2.1.cmml" xref="S2.E9X.2.1.1.m1.6.6.1.1.1.2.2.2">subscript</csymbol><ci id="S2.E9X.2.1.1.m1.6.6.1.1.1.2.2.2.2.cmml" xref="S2.E9X.2.1.1.m1.6.6.1.1.1.2.2.2.2">𝑦</ci><ci id="S2.E9X.2.1.1.m1.6.6.1.1.1.2.2.2.3.cmml" xref="S2.E9X.2.1.1.m1.6.6.1.1.1.2.2.2.3">𝑞</ci></apply></apply><apply id="S2.E9X.2.1.1.m1.7.7.2.2.2.1.cmml" xref="S2.E9X.2.1.1.m1.7.7.2.2.2.2"><ci id="S2.E9X.2.1.1.m1.2.2.cmml" xref="S2.E9X.2.1.1.m1.2.2">PE</ci><ci id="S2.E9X.2.1.1.m1.3.3.cmml" xref="S2.E9X.2.1.1.m1.3.3">𝑥</ci><ci id="S2.E9X.2.1.1.m1.4.4.cmml" xref="S2.E9X.2.1.1.m1.4.4">𝑦</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E9X.2.1.1.m1.7c">\displaystyle\operatorname{ModAttn}(\operatorname{PE}(x_{q},y_{q}),\operatorname{PE}(x,y))</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(9)</span></td>
</tr>
<tr id="S2.E9Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E9Xa.2.1.1.m1.3" class="ltx_math_unparsed" alttext="\displaystyle=\left(\operatorname{PE}\left(x_{q}\right)\operatorname{PE}\left(x\right)^{T}\frac{w_{\mathrm{ref}}}{w}+\operatorname{PE}\left(y_{q}\right)\operatorname{PE}\left(y\right)^{T}\frac{h_{\mathrm{ref}}}{h}\right)/\sqrt{D}," display="inline"><semantics id="S2.E9Xa.2.1.1.m1.3a"><mrow id="S2.E9Xa.2.1.1.m1.3b"><mo id="S2.E9Xa.2.1.1.m1.3.4">=</mo><mrow id="S2.E9Xa.2.1.1.m1.3.5"><mo id="S2.E9Xa.2.1.1.m1.3.5.1">(</mo><mi id="S2.E9Xa.2.1.1.m1.1.1">PE</mi><mrow id="S2.E9Xa.2.1.1.m1.3.5.2"><mo id="S2.E9Xa.2.1.1.m1.3.5.2.1">(</mo><msub id="S2.E9Xa.2.1.1.m1.3.5.2.2"><mi id="S2.E9Xa.2.1.1.m1.3.5.2.2.2">x</mi><mi id="S2.E9Xa.2.1.1.m1.3.5.2.2.3">q</mi></msub><mo rspace="0.167em" id="S2.E9Xa.2.1.1.m1.3.5.2.3">)</mo></mrow><mi id="S2.E9Xa.2.1.1.m1.2.2">PE</mi><msup id="S2.E9Xa.2.1.1.m1.3.5.3"><mrow id="S2.E9Xa.2.1.1.m1.3.5.3.2"><mo id="S2.E9Xa.2.1.1.m1.3.5.3.2.1">(</mo><mi id="S2.E9Xa.2.1.1.m1.3.3">x</mi><mo id="S2.E9Xa.2.1.1.m1.3.5.3.2.2">)</mo></mrow><mi id="S2.E9Xa.2.1.1.m1.3.5.3.3">T</mi></msup><mstyle displaystyle="true" id="S2.E9Xa.2.1.1.m1.3.5.4"><mfrac id="S2.E9Xa.2.1.1.m1.3.5.4a"><msub id="S2.E9Xa.2.1.1.m1.3.5.4.2"><mi id="S2.E9Xa.2.1.1.m1.3.5.4.2.2">w</mi><mi id="S2.E9Xa.2.1.1.m1.3.5.4.2.3">ref</mi></msub><mi id="S2.E9Xa.2.1.1.m1.3.5.4.3">w</mi></mfrac></mstyle><mo id="S2.E9Xa.2.1.1.m1.3.5.5">+</mo><mi id="S2.E9Xa.2.1.1.m1.3.5.6">PE</mi><mrow id="S2.E9Xa.2.1.1.m1.3.5.7"><mo id="S2.E9Xa.2.1.1.m1.3.5.7.1">(</mo><msub id="S2.E9Xa.2.1.1.m1.3.5.7.2"><mi id="S2.E9Xa.2.1.1.m1.3.5.7.2.2">y</mi><mi id="S2.E9Xa.2.1.1.m1.3.5.7.2.3">q</mi></msub><mo rspace="0.167em" id="S2.E9Xa.2.1.1.m1.3.5.7.3">)</mo></mrow><mi id="S2.E9Xa.2.1.1.m1.3.5.8">PE</mi><msup id="S2.E9Xa.2.1.1.m1.3.5.9"><mrow id="S2.E9Xa.2.1.1.m1.3.5.9.2"><mo id="S2.E9Xa.2.1.1.m1.3.5.9.2.1">(</mo><mi id="S2.E9Xa.2.1.1.m1.3.5.9.2.2">y</mi><mo id="S2.E9Xa.2.1.1.m1.3.5.9.2.3">)</mo></mrow><mi id="S2.E9Xa.2.1.1.m1.3.5.9.3">T</mi></msup><mstyle displaystyle="true" id="S2.E9Xa.2.1.1.m1.3.5.10"><mfrac id="S2.E9Xa.2.1.1.m1.3.5.10a"><msub id="S2.E9Xa.2.1.1.m1.3.5.10.2"><mi id="S2.E9Xa.2.1.1.m1.3.5.10.2.2">h</mi><mi id="S2.E9Xa.2.1.1.m1.3.5.10.2.3">ref</mi></msub><mi id="S2.E9Xa.2.1.1.m1.3.5.10.3">h</mi></mfrac></mstyle><mo id="S2.E9Xa.2.1.1.m1.3.5.11">)</mo></mrow><mo id="S2.E9Xa.2.1.1.m1.3.6">/</mo><msqrt id="S2.E9Xa.2.1.1.m1.3.7"><mi id="S2.E9Xa.2.1.1.m1.3.7.2">D</mi></msqrt><mo id="S2.E9Xa.2.1.1.m1.3.8">,</mo></mrow><annotation encoding="application/x-tex" id="S2.E9Xa.2.1.1.m1.3c">\displaystyle=\left(\operatorname{PE}\left(x_{q}\right)\operatorname{PE}\left(x\right)^{T}\frac{w_{\mathrm{ref}}}{w}+\operatorname{PE}\left(y_{q}\right)\operatorname{PE}\left(y\right)^{T}\frac{h_{\mathrm{ref}}}{h}\right)/\sqrt{D},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S2.SS4.p4.5" class="ltx_p">where <math id="S2.SS4.p4.4.m1.1" class="ltx_Math" alttext="1/\sqrt{D}" display="inline"><semantics id="S2.SS4.p4.4.m1.1a"><mrow id="S2.SS4.p4.4.m1.1.1" xref="S2.SS4.p4.4.m1.1.1.cmml"><mn id="S2.SS4.p4.4.m1.1.1.2" xref="S2.SS4.p4.4.m1.1.1.2.cmml">1</mn><mo id="S2.SS4.p4.4.m1.1.1.1" xref="S2.SS4.p4.4.m1.1.1.1.cmml">/</mo><msqrt id="S2.SS4.p4.4.m1.1.1.3" xref="S2.SS4.p4.4.m1.1.1.3.cmml"><mi id="S2.SS4.p4.4.m1.1.1.3.2" xref="S2.SS4.p4.4.m1.1.1.3.2.cmml">D</mi></msqrt></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.4.m1.1b"><apply id="S2.SS4.p4.4.m1.1.1.cmml" xref="S2.SS4.p4.4.m1.1.1"><divide id="S2.SS4.p4.4.m1.1.1.1.cmml" xref="S2.SS4.p4.4.m1.1.1.1"></divide><cn type="integer" id="S2.SS4.p4.4.m1.1.1.2.cmml" xref="S2.SS4.p4.4.m1.1.1.2">1</cn><apply id="S2.SS4.p4.4.m1.1.1.3.cmml" xref="S2.SS4.p4.4.m1.1.1.3"><root id="S2.SS4.p4.4.m1.1.1.3a.cmml" xref="S2.SS4.p4.4.m1.1.1.3"></root><ci id="S2.SS4.p4.4.m1.1.1.3.2.cmml" xref="S2.SS4.p4.4.m1.1.1.3.2">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.4.m1.1c">1/\sqrt{D}</annotation></semantics></math> is used for value rescaling <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite>, and the reference width and height that are calculated by <math id="S2.SS4.p4.5.m2.4" class="ltx_Math" alttext="w_{\mathrm{ref}},h_{\mathrm{ref}}=\sigma\left(\operatorname{MLP}\left(C_{q}\right)\right)" display="inline"><semantics id="S2.SS4.p4.5.m2.4a"><mrow id="S2.SS4.p4.5.m2.4.4" xref="S2.SS4.p4.5.m2.4.4.cmml"><mrow id="S2.SS4.p4.5.m2.3.3.2.2" xref="S2.SS4.p4.5.m2.3.3.2.3.cmml"><msub id="S2.SS4.p4.5.m2.2.2.1.1.1" xref="S2.SS4.p4.5.m2.2.2.1.1.1.cmml"><mi id="S2.SS4.p4.5.m2.2.2.1.1.1.2" xref="S2.SS4.p4.5.m2.2.2.1.1.1.2.cmml">w</mi><mi id="S2.SS4.p4.5.m2.2.2.1.1.1.3" xref="S2.SS4.p4.5.m2.2.2.1.1.1.3.cmml">ref</mi></msub><mo id="S2.SS4.p4.5.m2.3.3.2.2.3" xref="S2.SS4.p4.5.m2.3.3.2.3.cmml">,</mo><msub id="S2.SS4.p4.5.m2.3.3.2.2.2" xref="S2.SS4.p4.5.m2.3.3.2.2.2.cmml"><mi id="S2.SS4.p4.5.m2.3.3.2.2.2.2" xref="S2.SS4.p4.5.m2.3.3.2.2.2.2.cmml">h</mi><mi id="S2.SS4.p4.5.m2.3.3.2.2.2.3" xref="S2.SS4.p4.5.m2.3.3.2.2.2.3.cmml">ref</mi></msub></mrow><mo id="S2.SS4.p4.5.m2.4.4.4" xref="S2.SS4.p4.5.m2.4.4.4.cmml">=</mo><mrow id="S2.SS4.p4.5.m2.4.4.3" xref="S2.SS4.p4.5.m2.4.4.3.cmml"><mi id="S2.SS4.p4.5.m2.4.4.3.3" xref="S2.SS4.p4.5.m2.4.4.3.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S2.SS4.p4.5.m2.4.4.3.2" xref="S2.SS4.p4.5.m2.4.4.3.2.cmml">​</mo><mrow id="S2.SS4.p4.5.m2.4.4.3.1.1" xref="S2.SS4.p4.5.m2.4.4.3.cmml"><mo id="S2.SS4.p4.5.m2.4.4.3.1.1.2" xref="S2.SS4.p4.5.m2.4.4.3.cmml">(</mo><mrow id="S2.SS4.p4.5.m2.4.4.3.1.1.1.1" xref="S2.SS4.p4.5.m2.4.4.3.1.1.1.2.cmml"><mi id="S2.SS4.p4.5.m2.1.1" xref="S2.SS4.p4.5.m2.1.1.cmml">MLP</mi><mo id="S2.SS4.p4.5.m2.4.4.3.1.1.1.1a" xref="S2.SS4.p4.5.m2.4.4.3.1.1.1.2.cmml">⁡</mo><mrow id="S2.SS4.p4.5.m2.4.4.3.1.1.1.1.1" xref="S2.SS4.p4.5.m2.4.4.3.1.1.1.2.cmml"><mo id="S2.SS4.p4.5.m2.4.4.3.1.1.1.1.1.2" xref="S2.SS4.p4.5.m2.4.4.3.1.1.1.2.cmml">(</mo><msub id="S2.SS4.p4.5.m2.4.4.3.1.1.1.1.1.1" xref="S2.SS4.p4.5.m2.4.4.3.1.1.1.1.1.1.cmml"><mi id="S2.SS4.p4.5.m2.4.4.3.1.1.1.1.1.1.2" xref="S2.SS4.p4.5.m2.4.4.3.1.1.1.1.1.1.2.cmml">C</mi><mi id="S2.SS4.p4.5.m2.4.4.3.1.1.1.1.1.1.3" xref="S2.SS4.p4.5.m2.4.4.3.1.1.1.1.1.1.3.cmml">q</mi></msub><mo id="S2.SS4.p4.5.m2.4.4.3.1.1.1.1.1.3" xref="S2.SS4.p4.5.m2.4.4.3.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.SS4.p4.5.m2.4.4.3.1.1.3" xref="S2.SS4.p4.5.m2.4.4.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.5.m2.4b"><apply id="S2.SS4.p4.5.m2.4.4.cmml" xref="S2.SS4.p4.5.m2.4.4"><eq id="S2.SS4.p4.5.m2.4.4.4.cmml" xref="S2.SS4.p4.5.m2.4.4.4"></eq><list id="S2.SS4.p4.5.m2.3.3.2.3.cmml" xref="S2.SS4.p4.5.m2.3.3.2.2"><apply id="S2.SS4.p4.5.m2.2.2.1.1.1.cmml" xref="S2.SS4.p4.5.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p4.5.m2.2.2.1.1.1.1.cmml" xref="S2.SS4.p4.5.m2.2.2.1.1.1">subscript</csymbol><ci id="S2.SS4.p4.5.m2.2.2.1.1.1.2.cmml" xref="S2.SS4.p4.5.m2.2.2.1.1.1.2">𝑤</ci><ci id="S2.SS4.p4.5.m2.2.2.1.1.1.3.cmml" xref="S2.SS4.p4.5.m2.2.2.1.1.1.3">ref</ci></apply><apply id="S2.SS4.p4.5.m2.3.3.2.2.2.cmml" xref="S2.SS4.p4.5.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS4.p4.5.m2.3.3.2.2.2.1.cmml" xref="S2.SS4.p4.5.m2.3.3.2.2.2">subscript</csymbol><ci id="S2.SS4.p4.5.m2.3.3.2.2.2.2.cmml" xref="S2.SS4.p4.5.m2.3.3.2.2.2.2">ℎ</ci><ci id="S2.SS4.p4.5.m2.3.3.2.2.2.3.cmml" xref="S2.SS4.p4.5.m2.3.3.2.2.2.3">ref</ci></apply></list><apply id="S2.SS4.p4.5.m2.4.4.3.cmml" xref="S2.SS4.p4.5.m2.4.4.3"><times id="S2.SS4.p4.5.m2.4.4.3.2.cmml" xref="S2.SS4.p4.5.m2.4.4.3.2"></times><ci id="S2.SS4.p4.5.m2.4.4.3.3.cmml" xref="S2.SS4.p4.5.m2.4.4.3.3">𝜎</ci><apply id="S2.SS4.p4.5.m2.4.4.3.1.1.1.2.cmml" xref="S2.SS4.p4.5.m2.4.4.3.1.1.1.1"><ci id="S2.SS4.p4.5.m2.1.1.cmml" xref="S2.SS4.p4.5.m2.1.1">MLP</ci><apply id="S2.SS4.p4.5.m2.4.4.3.1.1.1.1.1.1.cmml" xref="S2.SS4.p4.5.m2.4.4.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p4.5.m2.4.4.3.1.1.1.1.1.1.1.cmml" xref="S2.SS4.p4.5.m2.4.4.3.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS4.p4.5.m2.4.4.3.1.1.1.1.1.1.2.cmml" xref="S2.SS4.p4.5.m2.4.4.3.1.1.1.1.1.1.2">𝐶</ci><ci id="S2.SS4.p4.5.m2.4.4.3.1.1.1.1.1.1.3.cmml" xref="S2.SS4.p4.5.m2.4.4.3.1.1.1.1.1.1.3">𝑞</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.5.m2.4c">w_{\mathrm{ref}},h_{\mathrm{ref}}=\sigma\left(\operatorname{MLP}\left(C_{q}\right)\right)</annotation></semantics></math> as shown in Figure <a href="#S2.F5" title="Figure 5 ‣ II-D Task-Aligned Dual-Head Block ‣ II Proposed Method ‣ Concealed Object Detection for Passive Millimeter-Wave Security Imaging Based on Task-Aligned Detection Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>.</p>
</div>
<div id="S2.SS4.p5" class="ltx_para">
<p id="S2.SS4.p5.1" class="ltx_p">The two content queries and spatial queries are updated layer by layer. Using coordinates as spatial queries for learning makes it have clear spatial meaning. As shown in Figure <a href="#S2.F5" title="Figure 5 ‣ II-D Task-Aligned Dual-Head Block ‣ II Proposed Method ‣ Concealed Object Detection for Passive Millimeter-Wave Security Imaging Based on Task-Aligned Detection Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, each anchor refines layer outputs an updated object anchor by predicting the relative positions <math id="S2.SS4.p5.1.m1.4" class="ltx_Math" alttext="(\Delta x,\Delta y,\Delta w,\Delta h)" display="inline"><semantics id="S2.SS4.p5.1.m1.4a"><mrow id="S2.SS4.p5.1.m1.4.4.4" xref="S2.SS4.p5.1.m1.4.4.5.cmml"><mo stretchy="false" id="S2.SS4.p5.1.m1.4.4.4.5" xref="S2.SS4.p5.1.m1.4.4.5.cmml">(</mo><mrow id="S2.SS4.p5.1.m1.1.1.1.1" xref="S2.SS4.p5.1.m1.1.1.1.1.cmml"><mi mathvariant="normal" id="S2.SS4.p5.1.m1.1.1.1.1.2" xref="S2.SS4.p5.1.m1.1.1.1.1.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S2.SS4.p5.1.m1.1.1.1.1.1" xref="S2.SS4.p5.1.m1.1.1.1.1.1.cmml">​</mo><mi id="S2.SS4.p5.1.m1.1.1.1.1.3" xref="S2.SS4.p5.1.m1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.SS4.p5.1.m1.4.4.4.6" xref="S2.SS4.p5.1.m1.4.4.5.cmml">,</mo><mrow id="S2.SS4.p5.1.m1.2.2.2.2" xref="S2.SS4.p5.1.m1.2.2.2.2.cmml"><mi mathvariant="normal" id="S2.SS4.p5.1.m1.2.2.2.2.2" xref="S2.SS4.p5.1.m1.2.2.2.2.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S2.SS4.p5.1.m1.2.2.2.2.1" xref="S2.SS4.p5.1.m1.2.2.2.2.1.cmml">​</mo><mi id="S2.SS4.p5.1.m1.2.2.2.2.3" xref="S2.SS4.p5.1.m1.2.2.2.2.3.cmml">y</mi></mrow><mo id="S2.SS4.p5.1.m1.4.4.4.7" xref="S2.SS4.p5.1.m1.4.4.5.cmml">,</mo><mrow id="S2.SS4.p5.1.m1.3.3.3.3" xref="S2.SS4.p5.1.m1.3.3.3.3.cmml"><mi mathvariant="normal" id="S2.SS4.p5.1.m1.3.3.3.3.2" xref="S2.SS4.p5.1.m1.3.3.3.3.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S2.SS4.p5.1.m1.3.3.3.3.1" xref="S2.SS4.p5.1.m1.3.3.3.3.1.cmml">​</mo><mi id="S2.SS4.p5.1.m1.3.3.3.3.3" xref="S2.SS4.p5.1.m1.3.3.3.3.3.cmml">w</mi></mrow><mo id="S2.SS4.p5.1.m1.4.4.4.8" xref="S2.SS4.p5.1.m1.4.4.5.cmml">,</mo><mrow id="S2.SS4.p5.1.m1.4.4.4.4" xref="S2.SS4.p5.1.m1.4.4.4.4.cmml"><mi mathvariant="normal" id="S2.SS4.p5.1.m1.4.4.4.4.2" xref="S2.SS4.p5.1.m1.4.4.4.4.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S2.SS4.p5.1.m1.4.4.4.4.1" xref="S2.SS4.p5.1.m1.4.4.4.4.1.cmml">​</mo><mi id="S2.SS4.p5.1.m1.4.4.4.4.3" xref="S2.SS4.p5.1.m1.4.4.4.4.3.cmml">h</mi></mrow><mo stretchy="false" id="S2.SS4.p5.1.m1.4.4.4.9" xref="S2.SS4.p5.1.m1.4.4.5.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p5.1.m1.4b"><vector id="S2.SS4.p5.1.m1.4.4.5.cmml" xref="S2.SS4.p5.1.m1.4.4.4"><apply id="S2.SS4.p5.1.m1.1.1.1.1.cmml" xref="S2.SS4.p5.1.m1.1.1.1.1"><times id="S2.SS4.p5.1.m1.1.1.1.1.1.cmml" xref="S2.SS4.p5.1.m1.1.1.1.1.1"></times><ci id="S2.SS4.p5.1.m1.1.1.1.1.2.cmml" xref="S2.SS4.p5.1.m1.1.1.1.1.2">Δ</ci><ci id="S2.SS4.p5.1.m1.1.1.1.1.3.cmml" xref="S2.SS4.p5.1.m1.1.1.1.1.3">𝑥</ci></apply><apply id="S2.SS4.p5.1.m1.2.2.2.2.cmml" xref="S2.SS4.p5.1.m1.2.2.2.2"><times id="S2.SS4.p5.1.m1.2.2.2.2.1.cmml" xref="S2.SS4.p5.1.m1.2.2.2.2.1"></times><ci id="S2.SS4.p5.1.m1.2.2.2.2.2.cmml" xref="S2.SS4.p5.1.m1.2.2.2.2.2">Δ</ci><ci id="S2.SS4.p5.1.m1.2.2.2.2.3.cmml" xref="S2.SS4.p5.1.m1.2.2.2.2.3">𝑦</ci></apply><apply id="S2.SS4.p5.1.m1.3.3.3.3.cmml" xref="S2.SS4.p5.1.m1.3.3.3.3"><times id="S2.SS4.p5.1.m1.3.3.3.3.1.cmml" xref="S2.SS4.p5.1.m1.3.3.3.3.1"></times><ci id="S2.SS4.p5.1.m1.3.3.3.3.2.cmml" xref="S2.SS4.p5.1.m1.3.3.3.3.2">Δ</ci><ci id="S2.SS4.p5.1.m1.3.3.3.3.3.cmml" xref="S2.SS4.p5.1.m1.3.3.3.3.3">𝑤</ci></apply><apply id="S2.SS4.p5.1.m1.4.4.4.4.cmml" xref="S2.SS4.p5.1.m1.4.4.4.4"><times id="S2.SS4.p5.1.m1.4.4.4.4.1.cmml" xref="S2.SS4.p5.1.m1.4.4.4.4.1"></times><ci id="S2.SS4.p5.1.m1.4.4.4.4.2.cmml" xref="S2.SS4.p5.1.m1.4.4.4.4.2">Δ</ci><ci id="S2.SS4.p5.1.m1.4.4.4.4.3.cmml" xref="S2.SS4.p5.1.m1.4.4.4.4.3">ℎ</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p5.1.m1.4c">(\Delta x,\Delta y,\Delta w,\Delta h)</annotation></semantics></math>. For the sake of decoupling the classification and regression tasks, we only consider the output of the class refine layer as the classification result. Further, we design a query sharing mechanism to enhance the collaboration between these two tasks, that is, the updated anchor of the anchor refine layer is used as the input spatial query of the sharing query cross attention in the class refine layer after being embedded by Eq.<a href="#S2.E6" title="In II-D Task-Aligned Dual-Head Block ‣ II Proposed Method ‣ Concealed Object Detection for Passive Millimeter-Wave Security Imaging Based on Task-Aligned Detection Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>. The calculation method of the sharing query cross attention is simple, which is the same as Eq.<a href="#S2.E4" title="In II-D Task-Aligned Dual-Head Block ‣ II Proposed Method ‣ Concealed Object Detection for Passive Millimeter-Wave Security Imaging Based on Task-Aligned Detection Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. However, the sharing query cross attention effectively mitigates the problem of inter-spatial variation by exploiting the property of attention aggregation target correlation, and further enhances the spatial consistency of the two branches, completing the task-aligned dual-head block. The validity of the query sharing is verified in Section <a href="#S3.SS4" title="III-D Ablation Study ‣ III Experiments and Results ‣ Concealed Object Detection for Passive Millimeter-Wave Security Imaging Based on Task-Aligned Detection Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">III-D</span></span></a>. In addition, we introduce the query denoising learning<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite>, which adds a denoising part containing a denoising indicator and denoising loss as a training shortcut to accelerate the training of PMMW-DETR.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span id="S3.1.1" class="ltx_text ltx_font_smallcaps">Experiments and Results</span>
</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS1.5.1.1" class="ltx_text">III-A</span> </span><span id="S3.SS1.6.2" class="ltx_text ltx_font_italic">Experimental Environments</span>
</h3>

<figure id="S3.F6" class="ltx_figure"><img src="/html/2212.00313/assets/x6.png" id="S3.F6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="257" height="144" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>The PMMW security screening system and Experimental Environments.</figcaption>
</figure>
<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">The dataset was acquired by our self-developed PMMW security system, as shown in Figure <a href="#S3.F6" title="Figure 6 ‣ III-A Experimental Environments ‣ III Experiments and Results ‣ Concealed Object Detection for Passive Millimeter-Wave Security Imaging Based on Task-Aligned Detection Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>. The system consists of a Cassegrain antenna, a radiometer consisting of an ortho-mode transducer, two direct detection modules, a data acquisition module, and a three-axis scanning turntable. The system operates in the 94±2 GHz band with a sensitivity of about 0.4 K. Using an antenna with a diameter of 0.6096 m, it can achieve a resolution of 0.36°. As a research-oriented rather than a commercial imaging system, the system uses a scanning imaging regime that trades a longer imaging time (approximately 5 min per image) for better imaging quality. Compared with existing publicly available datasets <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib21" title="" class="ltx_ref">21</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>, the image quality of our dataset is closer to or even surpasses that of reported commercial security systems, such as X250 and S350 of Millivision Inc., iPat imager of Trex Enterprises Inc., and SP0-NX of Qinetiq Inc. So our dataset is more representative and forward-looking than the existing datasets.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS2.5.1.1" class="ltx_text">III-B</span> </span><span id="S3.SS2.6.2" class="ltx_text ltx_font_italic">Security Dataset and Implementation Details</span>
</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">We collected a total of 247 security images, in which the types of concealed objects included the metal wrench, alcohol bottle, metal knife, and metal pistol. 186 PMMW security images formed the training set and the remaining 77 formed the test set. The training of the Transformer network requires a large amount of data, but the scanning imaging regime is too time-consuming to form a large-scale dataset. To compensate for the lack of data set, we added 379 simulated images to the original training set. The simulation image is implemented based on the ray tracing method <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite>. To sum, the above original dataset has a total of 715 images, of which 638 images form the training set and 77 images form the test set. After a series of data augmentation operations such as flipping, rotating, Gaussian degradation filtering, and changing the brightness, the training set can be expanded by a factor of seven to 4466 images. All our datasets will be available at https://github.com/Ch3ngguo/opening-source-PMMW-dataset.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.1" class="ltx_p">Several typical PMMW security images are given in Figure <a href="#S3.F7" title="Figure 7 ‣ III-B Security Dataset and Implementation Details ‣ III Experiments and Results ‣ Concealed Object Detection for Passive Millimeter-Wave Security Imaging Based on Task-Aligned Detection Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>, from which it can be seen as follows:</p>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.1" class="ltx_p">1) Due to the uneven ambient brightness, the human chest resembles the texture features of the alcohol bottle, which may lead to false alarms.</p>
</div>
<div id="S3.SS2.p4" class="ltx_para">
<p id="S3.SS2.p4.1" class="ltx_p">2) The metal wrench in the fourth image is thin and shares similar contour features with the scanning noise, and the brightness of the alcohol bottle in the second image is close to the human body, both of which may lead to missed detection.</p>
</div>
<div id="S3.SS2.p5" class="ltx_para">
<p id="S3.SS2.p5.1" class="ltx_p">3) Since the flat place of the human body will reflect the strong brightness, such as the central part in the first image, which may affect the detection of the central hidden objects.</p>
</div>
<div id="S3.SS2.p6" class="ltx_para">
<p id="S3.SS2.p6.1" class="ltx_p">Therefore, it is a difficult task to detect objects on such a low resolution, high noise, and low little texture information dataset.</p>
</div>
<figure id="S3.F7" class="ltx_figure"><img src="/html/2212.00313/assets/x7.png" id="S3.F7.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="266" height="181" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>(a) Optical schematic photos corresponding to human security screening. (b) Representative PMMW security images and the hidden objects we used, which include a metal wrench, alcohol bottle, metal knife, and metal pistol.</figcaption>
</figure>
<div id="S3.SS2.p7" class="ltx_para">
<p id="S3.SS2.p7.6" class="ltx_p">For the implementation details, we use 1, 3, 5, 7 as the size of <math id="S3.SS2.p7.1.m1.1" class="ltx_Math" alttext="n^{l}" display="inline"><semantics id="S3.SS2.p7.1.m1.1a"><msup id="S3.SS2.p7.1.m1.1.1" xref="S3.SS2.p7.1.m1.1.1.cmml"><mi id="S3.SS2.p7.1.m1.1.1.2" xref="S3.SS2.p7.1.m1.1.1.2.cmml">n</mi><mi id="S3.SS2.p7.1.m1.1.1.3" xref="S3.SS2.p7.1.m1.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p7.1.m1.1b"><apply id="S3.SS2.p7.1.m1.1.1.cmml" xref="S3.SS2.p7.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p7.1.m1.1.1.1.cmml" xref="S3.SS2.p7.1.m1.1.1">superscript</csymbol><ci id="S3.SS2.p7.1.m1.1.1.2.cmml" xref="S3.SS2.p7.1.m1.1.1.2">𝑛</ci><ci id="S3.SS2.p7.1.m1.1.1.3.cmml" xref="S3.SS2.p7.1.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p7.1.m1.1c">n^{l}</annotation></semantics></math> in the DCFT module. We add uniform noise on boxes and set the hyperparameters with respect to noise as <math id="S3.SS2.p7.2.m2.1" class="ltx_Math" alttext="\lambda_{1}=0.4" display="inline"><semantics id="S3.SS2.p7.2.m2.1a"><mrow id="S3.SS2.p7.2.m2.1.1" xref="S3.SS2.p7.2.m2.1.1.cmml"><msub id="S3.SS2.p7.2.m2.1.1.2" xref="S3.SS2.p7.2.m2.1.1.2.cmml"><mi id="S3.SS2.p7.2.m2.1.1.2.2" xref="S3.SS2.p7.2.m2.1.1.2.2.cmml">λ</mi><mn id="S3.SS2.p7.2.m2.1.1.2.3" xref="S3.SS2.p7.2.m2.1.1.2.3.cmml">1</mn></msub><mo id="S3.SS2.p7.2.m2.1.1.1" xref="S3.SS2.p7.2.m2.1.1.1.cmml">=</mo><mn id="S3.SS2.p7.2.m2.1.1.3" xref="S3.SS2.p7.2.m2.1.1.3.cmml">0.4</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p7.2.m2.1b"><apply id="S3.SS2.p7.2.m2.1.1.cmml" xref="S3.SS2.p7.2.m2.1.1"><eq id="S3.SS2.p7.2.m2.1.1.1.cmml" xref="S3.SS2.p7.2.m2.1.1.1"></eq><apply id="S3.SS2.p7.2.m2.1.1.2.cmml" xref="S3.SS2.p7.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p7.2.m2.1.1.2.1.cmml" xref="S3.SS2.p7.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS2.p7.2.m2.1.1.2.2.cmml" xref="S3.SS2.p7.2.m2.1.1.2.2">𝜆</ci><cn type="integer" id="S3.SS2.p7.2.m2.1.1.2.3.cmml" xref="S3.SS2.p7.2.m2.1.1.2.3">1</cn></apply><cn type="float" id="S3.SS2.p7.2.m2.1.1.3.cmml" xref="S3.SS2.p7.2.m2.1.1.3">0.4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p7.2.m2.1c">\lambda_{1}=0.4</annotation></semantics></math>, <math id="S3.SS2.p7.3.m3.1" class="ltx_Math" alttext="\lambda_{2}=0.4" display="inline"><semantics id="S3.SS2.p7.3.m3.1a"><mrow id="S3.SS2.p7.3.m3.1.1" xref="S3.SS2.p7.3.m3.1.1.cmml"><msub id="S3.SS2.p7.3.m3.1.1.2" xref="S3.SS2.p7.3.m3.1.1.2.cmml"><mi id="S3.SS2.p7.3.m3.1.1.2.2" xref="S3.SS2.p7.3.m3.1.1.2.2.cmml">λ</mi><mn id="S3.SS2.p7.3.m3.1.1.2.3" xref="S3.SS2.p7.3.m3.1.1.2.3.cmml">2</mn></msub><mo id="S3.SS2.p7.3.m3.1.1.1" xref="S3.SS2.p7.3.m3.1.1.1.cmml">=</mo><mn id="S3.SS2.p7.3.m3.1.1.3" xref="S3.SS2.p7.3.m3.1.1.3.cmml">0.4</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p7.3.m3.1b"><apply id="S3.SS2.p7.3.m3.1.1.cmml" xref="S3.SS2.p7.3.m3.1.1"><eq id="S3.SS2.p7.3.m3.1.1.1.cmml" xref="S3.SS2.p7.3.m3.1.1.1"></eq><apply id="S3.SS2.p7.3.m3.1.1.2.cmml" xref="S3.SS2.p7.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p7.3.m3.1.1.2.1.cmml" xref="S3.SS2.p7.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS2.p7.3.m3.1.1.2.2.cmml" xref="S3.SS2.p7.3.m3.1.1.2.2">𝜆</ci><cn type="integer" id="S3.SS2.p7.3.m3.1.1.2.3.cmml" xref="S3.SS2.p7.3.m3.1.1.2.3">2</cn></apply><cn type="float" id="S3.SS2.p7.3.m3.1.1.3.cmml" xref="S3.SS2.p7.3.m3.1.1.3">0.4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p7.3.m3.1c">\lambda_{2}=0.4</annotation></semantics></math>, and <math id="S3.SS2.p7.4.m4.1" class="ltx_Math" alttext="\gamma=0.4" display="inline"><semantics id="S3.SS2.p7.4.m4.1a"><mrow id="S3.SS2.p7.4.m4.1.1" xref="S3.SS2.p7.4.m4.1.1.cmml"><mi id="S3.SS2.p7.4.m4.1.1.2" xref="S3.SS2.p7.4.m4.1.1.2.cmml">γ</mi><mo id="S3.SS2.p7.4.m4.1.1.1" xref="S3.SS2.p7.4.m4.1.1.1.cmml">=</mo><mn id="S3.SS2.p7.4.m4.1.1.3" xref="S3.SS2.p7.4.m4.1.1.3.cmml">0.4</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p7.4.m4.1b"><apply id="S3.SS2.p7.4.m4.1.1.cmml" xref="S3.SS2.p7.4.m4.1.1"><eq id="S3.SS2.p7.4.m4.1.1.1.cmml" xref="S3.SS2.p7.4.m4.1.1.1"></eq><ci id="S3.SS2.p7.4.m4.1.1.2.cmml" xref="S3.SS2.p7.4.m4.1.1.2">𝛾</ci><cn type="float" id="S3.SS2.p7.4.m4.1.1.3.cmml" xref="S3.SS2.p7.4.m4.1.1.3">0.4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p7.4.m4.1c">\gamma=0.4</annotation></semantics></math> in the query denoising learning. We train the network for 50 epochs and initialized parameters by Xavier. We adopt AdamW <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite> as the optimizer with a weight decay of <math id="S3.SS2.p7.5.m5.1" class="ltx_Math" alttext="1\times 10^{-4}" display="inline"><semantics id="S3.SS2.p7.5.m5.1a"><mrow id="S3.SS2.p7.5.m5.1.1" xref="S3.SS2.p7.5.m5.1.1.cmml"><mn id="S3.SS2.p7.5.m5.1.1.2" xref="S3.SS2.p7.5.m5.1.1.2.cmml">1</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p7.5.m5.1.1.1" xref="S3.SS2.p7.5.m5.1.1.1.cmml">×</mo><msup id="S3.SS2.p7.5.m5.1.1.3" xref="S3.SS2.p7.5.m5.1.1.3.cmml"><mn id="S3.SS2.p7.5.m5.1.1.3.2" xref="S3.SS2.p7.5.m5.1.1.3.2.cmml">10</mn><mrow id="S3.SS2.p7.5.m5.1.1.3.3" xref="S3.SS2.p7.5.m5.1.1.3.3.cmml"><mo id="S3.SS2.p7.5.m5.1.1.3.3a" xref="S3.SS2.p7.5.m5.1.1.3.3.cmml">−</mo><mn id="S3.SS2.p7.5.m5.1.1.3.3.2" xref="S3.SS2.p7.5.m5.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p7.5.m5.1b"><apply id="S3.SS2.p7.5.m5.1.1.cmml" xref="S3.SS2.p7.5.m5.1.1"><times id="S3.SS2.p7.5.m5.1.1.1.cmml" xref="S3.SS2.p7.5.m5.1.1.1"></times><cn type="integer" id="S3.SS2.p7.5.m5.1.1.2.cmml" xref="S3.SS2.p7.5.m5.1.1.2">1</cn><apply id="S3.SS2.p7.5.m5.1.1.3.cmml" xref="S3.SS2.p7.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p7.5.m5.1.1.3.1.cmml" xref="S3.SS2.p7.5.m5.1.1.3">superscript</csymbol><cn type="integer" id="S3.SS2.p7.5.m5.1.1.3.2.cmml" xref="S3.SS2.p7.5.m5.1.1.3.2">10</cn><apply id="S3.SS2.p7.5.m5.1.1.3.3.cmml" xref="S3.SS2.p7.5.m5.1.1.3.3"><minus id="S3.SS2.p7.5.m5.1.1.3.3.1.cmml" xref="S3.SS2.p7.5.m5.1.1.3.3"></minus><cn type="integer" id="S3.SS2.p7.5.m5.1.1.3.3.2.cmml" xref="S3.SS2.p7.5.m5.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p7.5.m5.1c">1\times 10^{-4}</annotation></semantics></math>. The initial learning rate is <math id="S3.SS2.p7.6.m6.1" class="ltx_Math" alttext="1\times 10^{-4}" display="inline"><semantics id="S3.SS2.p7.6.m6.1a"><mrow id="S3.SS2.p7.6.m6.1.1" xref="S3.SS2.p7.6.m6.1.1.cmml"><mn id="S3.SS2.p7.6.m6.1.1.2" xref="S3.SS2.p7.6.m6.1.1.2.cmml">1</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p7.6.m6.1.1.1" xref="S3.SS2.p7.6.m6.1.1.1.cmml">×</mo><msup id="S3.SS2.p7.6.m6.1.1.3" xref="S3.SS2.p7.6.m6.1.1.3.cmml"><mn id="S3.SS2.p7.6.m6.1.1.3.2" xref="S3.SS2.p7.6.m6.1.1.3.2.cmml">10</mn><mrow id="S3.SS2.p7.6.m6.1.1.3.3" xref="S3.SS2.p7.6.m6.1.1.3.3.cmml"><mo id="S3.SS2.p7.6.m6.1.1.3.3a" xref="S3.SS2.p7.6.m6.1.1.3.3.cmml">−</mo><mn id="S3.SS2.p7.6.m6.1.1.3.3.2" xref="S3.SS2.p7.6.m6.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p7.6.m6.1b"><apply id="S3.SS2.p7.6.m6.1.1.cmml" xref="S3.SS2.p7.6.m6.1.1"><times id="S3.SS2.p7.6.m6.1.1.1.cmml" xref="S3.SS2.p7.6.m6.1.1.1"></times><cn type="integer" id="S3.SS2.p7.6.m6.1.1.2.cmml" xref="S3.SS2.p7.6.m6.1.1.2">1</cn><apply id="S3.SS2.p7.6.m6.1.1.3.cmml" xref="S3.SS2.p7.6.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p7.6.m6.1.1.3.1.cmml" xref="S3.SS2.p7.6.m6.1.1.3">superscript</csymbol><cn type="integer" id="S3.SS2.p7.6.m6.1.1.3.2.cmml" xref="S3.SS2.p7.6.m6.1.1.3.2">10</cn><apply id="S3.SS2.p7.6.m6.1.1.3.3.cmml" xref="S3.SS2.p7.6.m6.1.1.3.3"><minus id="S3.SS2.p7.6.m6.1.1.3.3.1.cmml" xref="S3.SS2.p7.6.m6.1.1.3.3"></minus><cn type="integer" id="S3.SS2.p7.6.m6.1.1.3.3.2.cmml" xref="S3.SS2.p7.6.m6.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p7.6.m6.1c">1\times 10^{-4}</annotation></semantics></math> and it drops by multiplying 0.1 at the 40-th epoch. The batch size is 4, and all the models are trained on a single NVIDIA TESLA A30 GPU.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS3.5.1.1" class="ltx_text">III-C</span> </span><span id="S3.SS3.6.2" class="ltx_text ltx_font_italic">Comparison with the State-of-the-Art</span>
</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">Following the mainstream approach of object detection evaluation, we use average precision (AP) and average recall (AR) to evaluate the performance of the proposed model. In order to show the detection results for all classes, the mAP/mAR is obtained by summing the AP/AR of each class and taking the average. Essentially, AR is twice the area under the recall-IOU curve, AP is the area under the precision-recall curve (PR curve), where recall is the ratio of detected samples to the actual total samples, and precision reflects the detection rate. The calculation of mAP and mAR is given as follows:</p>
</div>
<div id="S3.SS3.p2" class="ltx_para">
<table id="S3.E10" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E10X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E10X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\text{ mAP }=\frac{\sum_{k=1}^{K}\mathrm{AP}_{k}}{K},\quad\text{ mAR }=\frac{\sum_{k=1}^{K}\mathrm{AR}_{k}}{K}," display="inline"><semantics id="S3.E10X.2.1.1.m1.1a"><mrow id="S3.E10X.2.1.1.m1.1.1.1"><mrow id="S3.E10X.2.1.1.m1.1.1.1.1.2" xref="S3.E10X.2.1.1.m1.1.1.1.1.3.cmml"><mrow id="S3.E10X.2.1.1.m1.1.1.1.1.1.1" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.cmml"><mtext id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.2" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.2a.cmml">mAP </mtext><mo id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.1" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.1.cmml">=</mo><mstyle displaystyle="true" id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.cmml"><mfrac id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3a" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.cmml"><mrow id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.2" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.2.cmml"><msubsup id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.2.1" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.2.1.cmml"><mo id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.2.1.2.2" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.2.1.2.2.cmml">∑</mo><mrow id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.2.1.2.3" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.2.1.2.3.cmml"><mi id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.2.1.2.3.2" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.2.1.2.3.2.cmml">k</mi><mo id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.2.1.2.3.1" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.2.1.2.3.1.cmml">=</mo><mn id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.2.1.2.3.3" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.2.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.2.1.3" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.2.1.3.cmml">K</mi></msubsup><msub id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.2.2" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.2.2.cmml"><mi id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.2.2.2" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.2.2.2.cmml">AP</mi><mi id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.2.2.3" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.2.2.3.cmml">k</mi></msub></mrow><mi id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.3" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.3.cmml">K</mi></mfrac></mstyle></mrow><mo rspace="1.167em" id="S3.E10X.2.1.1.m1.1.1.1.1.2.3" xref="S3.E10X.2.1.1.m1.1.1.1.1.3a.cmml">,</mo><mrow id="S3.E10X.2.1.1.m1.1.1.1.1.2.2" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.cmml"><mtext id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2a.cmml"> mAR </mtext><mo id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.1" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.1.cmml">=</mo><mstyle displaystyle="true" id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.cmml"><mfrac id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3a" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.cmml"><mrow id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.2" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.2.cmml"><msubsup id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.2.1" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.2.1.cmml"><mo id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.2.1.2.2" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.2.1.2.2.cmml">∑</mo><mrow id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.2.1.2.3" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.2.1.2.3.cmml"><mi id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.2.1.2.3.2" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.2.1.2.3.2.cmml">k</mi><mo id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.2.1.2.3.1" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.2.1.2.3.1.cmml">=</mo><mn id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.2.1.2.3.3" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.2.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.2.1.3" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.2.1.3.cmml">K</mi></msubsup><msub id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.2.2" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.2.2.cmml"><mi id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.2.2.2" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.2.2.2.cmml">AR</mi><mi id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.2.2.3" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.2.2.3.cmml">k</mi></msub></mrow><mi id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.3" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.3.cmml">K</mi></mfrac></mstyle></mrow></mrow><mo id="S3.E10X.2.1.1.m1.1.1.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E10X.2.1.1.m1.1b"><apply id="S3.E10X.2.1.1.m1.1.1.1.1.3.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E10X.2.1.1.m1.1.1.1.1.3a.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1"><eq id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.1"></eq><ci id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.2a.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.2"><mtext id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.2">mAP </mtext></ci><apply id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3"><divide id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3"></divide><apply id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.2"><apply id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.2.1"><csymbol cd="ambiguous" id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.2.1.1.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.2.1">superscript</csymbol><apply id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.2.1.2.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.2.1"><csymbol cd="ambiguous" id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.2.1.2.1.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.2.1">subscript</csymbol><sum id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.2.1.2.2.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.2.1.2.2"></sum><apply id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.2.1.2.3.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.2.1.2.3"><eq id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.2.1.2.3.1.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.2.1.2.3.1"></eq><ci id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.2.1.2.3.2.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.2.1.2.3.2">𝑘</ci><cn type="integer" id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.2.1.2.3.3.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.2.1.2.3.3">1</cn></apply></apply><ci id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.2.1.3.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.2.1.3">𝐾</ci></apply><apply id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.2.2.1.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.2.2">subscript</csymbol><ci id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.2.2.2.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.2.2.2">AP</ci><ci id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.2.2.3.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.2.2.3">𝑘</ci></apply></apply><ci id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3.3">𝐾</ci></apply></apply><apply id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2"><eq id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.1.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.1"></eq><ci id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2a.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2"><mtext id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.2"> mAR </mtext></ci><apply id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3"><divide id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.1.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3"></divide><apply id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.2.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.2"><apply id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.2.1.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.2.1"><csymbol cd="ambiguous" id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.2.1.1.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.2.1">superscript</csymbol><apply id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.2.1.2.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.2.1"><csymbol cd="ambiguous" id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.2.1.2.1.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.2.1">subscript</csymbol><sum id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.2.1.2.2.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.2.1.2.2"></sum><apply id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.2.1.2.3.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.2.1.2.3"><eq id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.2.1.2.3.1.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.2.1.2.3.1"></eq><ci id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.2.1.2.3.2.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.2.1.2.3.2">𝑘</ci><cn type="integer" id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.2.1.2.3.3.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.2.1.2.3.3">1</cn></apply></apply><ci id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.2.1.3.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.2.1.3">𝐾</ci></apply><apply id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.2.2.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.2.2"><csymbol cd="ambiguous" id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.2.2.1.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.2.2">subscript</csymbol><ci id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.2.2.2.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.2.2.2">AR</ci><ci id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.2.2.3.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.2.2.3">𝑘</ci></apply></apply><ci id="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.3.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.2.3.3">𝐾</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10X.2.1.1.m1.1c">\displaystyle\text{ mAP }=\frac{\sum_{k=1}^{K}\mathrm{AP}_{k}}{K},\quad\text{ mAR }=\frac{\sum_{k=1}^{K}\mathrm{AR}_{k}}{K},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(10)</span></td>
</tr>
</tbody>
</table>
<p id="S3.SS3.p2.3" class="ltx_p">where <math id="S3.SS3.p2.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS3.p2.1.m1.1a"><mi id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><ci id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">K</annotation></semantics></math> is the number of classes, the AP<sub id="S3.SS3.p2.3.1" class="ltx_sub"><span id="S3.SS3.p2.3.1.1" class="ltx_text ltx_font_italic">k</span></sub> and AR<sub id="S3.SS3.p2.3.2" class="ltx_sub"><span id="S3.SS3.p2.3.2.1" class="ltx_text ltx_font_italic">k</span></sub> are given as follows:</p>
</div>
<div id="S3.SS3.p3" class="ltx_para">
<table id="S3.E11" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E11X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E11X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\text{ AP${}_{k}$ }=\sum_{i=1}^{n-1}\left(r_{i+1}-r_{i}\right)p_{\text{interp}}\left(r_{i+1}\right)," display="inline"><semantics id="S3.E11X.2.1.1.m1.1a"><mrow id="S3.E11X.2.1.1.m1.1.1.1" xref="S3.E11X.2.1.1.m1.1.1.1.1.cmml"><mrow id="S3.E11X.2.1.1.m1.1.1.1.1" xref="S3.E11X.2.1.1.m1.1.1.1.1.cmml"><mrow id="S3.E11.m1.1.1.1.1.1.1.1a" xref="S3.E11.m1.1.1.1.1.1.1.1af.cmml"><mtext id="S3.E11.m1.1.1.1.1.1.1.1aa" xref="S3.E11.m1.1.1.1.1.1.1.1af.cmml">AP</mtext><mtext id="S3.E11.m1.1.1.1.1.1.1.1ab" xref="S3.E11.m1.1.1.1.1.1.1.1af.cmml"><sub id="S3.E11.m1.1.1.1.1.1.1.1a.2nest" class="ltx_sub"><span id="S3.E11.m1.1.1.1.1.1.1.1a.2.1nest" class="ltx_text ltx_font_italic">k</span></sub></mtext><mtext id="S3.E11.m1.1.1.1.1.1.1.1ae" xref="S3.E11.m1.1.1.1.1.1.1.1af.cmml"> </mtext></mrow><mo id="S3.E11X.2.1.1.m1.1.1.1.1.3" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.cmml">=</mo><mrow id="S3.E11X.2.1.1.m1.1.1.1.1.2" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.cmml"><mstyle displaystyle="true" id="S3.E11X.2.1.1.m1.1.1.1.1.2.3" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.3.cmml"><munderover id="S3.E11X.2.1.1.m1.1.1.1.1.2.3a" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.3.cmml"><mo movablelimits="false" id="S3.E11X.2.1.1.m1.1.1.1.1.2.3.2.2" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.3.2.2.cmml">∑</mo><mrow id="S3.E11X.2.1.1.m1.1.1.1.1.2.3.2.3" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.3.2.3.cmml"><mi id="S3.E11X.2.1.1.m1.1.1.1.1.2.3.2.3.2" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.3.2.3.2.cmml">i</mi><mo id="S3.E11X.2.1.1.m1.1.1.1.1.2.3.2.3.1" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.3.2.3.1.cmml">=</mo><mn id="S3.E11X.2.1.1.m1.1.1.1.1.2.3.2.3.3" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.3.2.3.3.cmml">1</mn></mrow><mrow id="S3.E11X.2.1.1.m1.1.1.1.1.2.3.3" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.3.3.cmml"><mi id="S3.E11X.2.1.1.m1.1.1.1.1.2.3.3.2" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.3.3.2.cmml">n</mi><mo id="S3.E11X.2.1.1.m1.1.1.1.1.2.3.3.1" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.3.3.1.cmml">−</mo><mn id="S3.E11X.2.1.1.m1.1.1.1.1.2.3.3.3" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.3.3.3.cmml">1</mn></mrow></munderover></mstyle><mrow id="S3.E11X.2.1.1.m1.1.1.1.1.2.2" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.2.cmml"><mrow id="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.2" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">r</mi><mrow id="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.1" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">+</mo><mn id="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">r</mi><mi id="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.3" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E11X.2.1.1.m1.1.1.1.1.2.2.3" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.2.3.cmml">​</mo><msub id="S3.E11X.2.1.1.m1.1.1.1.1.2.2.4" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.2.4.cmml"><mi id="S3.E11X.2.1.1.m1.1.1.1.1.2.2.4.2" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.2.4.2.cmml">p</mi><mtext id="S3.E11X.2.1.1.m1.1.1.1.1.2.2.4.3" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.2.4.3a.cmml">interp</mtext></msub><mo lspace="0em" rspace="0em" id="S3.E11X.2.1.1.m1.1.1.1.1.2.2.3a" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.2.3.cmml">​</mo><mrow id="S3.E11X.2.1.1.m1.1.1.1.1.2.2.2.1" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.2.2.1.1.cmml"><mo id="S3.E11X.2.1.1.m1.1.1.1.1.2.2.2.1.2" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.2.2.1.1.cmml">(</mo><msub id="S3.E11X.2.1.1.m1.1.1.1.1.2.2.2.1.1" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.2.2.1.1.cmml"><mi id="S3.E11X.2.1.1.m1.1.1.1.1.2.2.2.1.1.2" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.2.2.1.1.2.cmml">r</mi><mrow id="S3.E11X.2.1.1.m1.1.1.1.1.2.2.2.1.1.3" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.2.2.1.1.3.cmml"><mi id="S3.E11X.2.1.1.m1.1.1.1.1.2.2.2.1.1.3.2" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.2.2.1.1.3.2.cmml">i</mi><mo id="S3.E11X.2.1.1.m1.1.1.1.1.2.2.2.1.1.3.1" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.2.2.1.1.3.1.cmml">+</mo><mn id="S3.E11X.2.1.1.m1.1.1.1.1.2.2.2.1.1.3.3" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.2.2.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.E11X.2.1.1.m1.1.1.1.1.2.2.2.1.3" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E11X.2.1.1.m1.1.1.1.2" xref="S3.E11X.2.1.1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E11X.2.1.1.m1.1b"><apply id="S3.E11X.2.1.1.m1.1.1.1.1.cmml" xref="S3.E11X.2.1.1.m1.1.1.1"><eq id="S3.E11X.2.1.1.m1.1.1.1.1.3.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.3"></eq><ci id="S3.E11.m1.1.1.1.1.1.1.1af.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1a"><mrow id="S3.E11.m1.1.1.1.1.1.1.1a.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1a"><mtext id="S3.E11.m1.1.1.1.1.1.1.1aa.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1a">AP</mtext><mtext id="S3.E11.m1.1.1.1.1.1.1.1ab.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1a"><sub id="S3.E11.m1.1.1.1.1.1.1.1a.2anest" class="ltx_sub"><span id="S3.E11.m1.1.1.1.1.1.1.1a.2.1anest" class="ltx_text ltx_font_italic">k</span></sub></mtext><mtext id="S3.E11.m1.1.1.1.1.1.1.1ae.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1a"> </mtext></mrow></ci><apply id="S3.E11X.2.1.1.m1.1.1.1.1.2.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.2"><apply id="S3.E11X.2.1.1.m1.1.1.1.1.2.3.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E11X.2.1.1.m1.1.1.1.1.2.3.1.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.3">superscript</csymbol><apply id="S3.E11X.2.1.1.m1.1.1.1.1.2.3.2.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E11X.2.1.1.m1.1.1.1.1.2.3.2.1.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.3">subscript</csymbol><sum id="S3.E11X.2.1.1.m1.1.1.1.1.2.3.2.2.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.3.2.2"></sum><apply id="S3.E11X.2.1.1.m1.1.1.1.1.2.3.2.3.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.3.2.3"><eq id="S3.E11X.2.1.1.m1.1.1.1.1.2.3.2.3.1.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.3.2.3.1"></eq><ci id="S3.E11X.2.1.1.m1.1.1.1.1.2.3.2.3.2.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.3.2.3.2">𝑖</ci><cn type="integer" id="S3.E11X.2.1.1.m1.1.1.1.1.2.3.2.3.3.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.3.2.3.3">1</cn></apply></apply><apply id="S3.E11X.2.1.1.m1.1.1.1.1.2.3.3.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.3.3"><minus id="S3.E11X.2.1.1.m1.1.1.1.1.2.3.3.1.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.3.3.1"></minus><ci id="S3.E11X.2.1.1.m1.1.1.1.1.2.3.3.2.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.3.3.2">𝑛</ci><cn type="integer" id="S3.E11X.2.1.1.m1.1.1.1.1.2.3.3.3.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.3.3.3">1</cn></apply></apply><apply id="S3.E11X.2.1.1.m1.1.1.1.1.2.2.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.2"><times id="S3.E11X.2.1.1.m1.1.1.1.1.2.2.3.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.2.3"></times><apply id="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1"><minus id="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2">𝑟</ci><apply id="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3"><plus id="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.1"></plus><ci id="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.2">𝑟</ci><ci id="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply><apply id="S3.E11X.2.1.1.m1.1.1.1.1.2.2.4.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.2.4"><csymbol cd="ambiguous" id="S3.E11X.2.1.1.m1.1.1.1.1.2.2.4.1.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.2.4">subscript</csymbol><ci id="S3.E11X.2.1.1.m1.1.1.1.1.2.2.4.2.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.2.4.2">𝑝</ci><ci id="S3.E11X.2.1.1.m1.1.1.1.1.2.2.4.3a.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.2.4.3"><mtext mathsize="70%" id="S3.E11X.2.1.1.m1.1.1.1.1.2.2.4.3.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.2.4.3">interp</mtext></ci></apply><apply id="S3.E11X.2.1.1.m1.1.1.1.1.2.2.2.1.1.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.2.2.1"><csymbol cd="ambiguous" id="S3.E11X.2.1.1.m1.1.1.1.1.2.2.2.1.1.1.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.2.2.1">subscript</csymbol><ci id="S3.E11X.2.1.1.m1.1.1.1.1.2.2.2.1.1.2.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.2.2.1.1.2">𝑟</ci><apply id="S3.E11X.2.1.1.m1.1.1.1.1.2.2.2.1.1.3.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.2.2.1.1.3"><plus id="S3.E11X.2.1.1.m1.1.1.1.1.2.2.2.1.1.3.1.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.2.2.1.1.3.1"></plus><ci id="S3.E11X.2.1.1.m1.1.1.1.1.2.2.2.1.1.3.2.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.2.2.1.1.3.2">𝑖</ci><cn type="integer" id="S3.E11X.2.1.1.m1.1.1.1.1.2.2.2.1.1.3.3.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.2.2.1.1.3.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11X.2.1.1.m1.1c">\displaystyle\text{ AP${}_{k}$ }=\sum_{i=1}^{n-1}\left(r_{i+1}-r_{i}\right)p_{\text{interp}}\left(r_{i+1}\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(11)</span></td>
</tr>
<tr id="S3.E11Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E11Xa.2.1.1.m1.4" class="ltx_Math" alttext="\displaystyle{\text{ AR${}_{k}$ }=\frac{1}{O}\sum_{o=1}^{O}\max\left\{\text{Recall}(\mathrm{c},t(o))\right\},}" display="inline"><semantics id="S3.E11Xa.2.1.1.m1.4a"><mrow id="S3.E11Xa.2.1.1.m1.4.4.1" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.cmml"><mrow id="S3.E11Xa.2.1.1.m1.4.4.1.1" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.cmml"><mrow id="S3.E11.m1.2.2.2.1.1.1.1a" xref="S3.E11.m1.2.2.2.1.1.1.1af.cmml"><mtext id="S3.E11.m1.2.2.2.1.1.1.1aa" xref="S3.E11.m1.2.2.2.1.1.1.1af.cmml">AR</mtext><mtext id="S3.E11.m1.2.2.2.1.1.1.1ab" xref="S3.E11.m1.2.2.2.1.1.1.1af.cmml"><sub id="S3.E11.m1.2.2.2.1.1.1.1a.2nest" class="ltx_sub"><span id="S3.E11.m1.2.2.2.1.1.1.1a.2.1nest" class="ltx_text ltx_font_italic">k</span></sub></mtext><mtext id="S3.E11.m1.2.2.2.1.1.1.1ae" xref="S3.E11.m1.2.2.2.1.1.1.1af.cmml"> </mtext></mrow><mo id="S3.E11Xa.2.1.1.m1.4.4.1.1.2" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.2.cmml">=</mo><mrow id="S3.E11Xa.2.1.1.m1.4.4.1.1.1" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.3" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.3.cmml"><mfrac id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.3a" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.3.cmml"><mn id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.3.2" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.3.2.cmml">1</mn><mi id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.3.3" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.3.3.cmml">O</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.2" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.2.cmml">​</mo><mrow id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.2" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.2.cmml"><munderover id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.2a" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.2.2.2" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.2.2.3" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.2.2.3.cmml"><mi id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.2.2.3.2" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.2.2.3.2.cmml">o</mi><mo id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.2.2.3.1" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.2.2.3.3" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.2.3" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.2.3.cmml">O</mi></munderover></mstyle><mrow id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.2.cmml"><mi id="S3.E11Xa.2.1.1.m1.3.3" xref="S3.E11Xa.2.1.1.m1.3.3.cmml">max</mi><mo id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1a" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.2.cmml"><mo id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.2" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.2.cmml">{</mo><mrow id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mtext id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3a.cmml">Recall</mtext><mo lspace="0em" rspace="0em" id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><mi mathvariant="normal" id="S3.E11Xa.2.1.1.m1.2.2" xref="S3.E11Xa.2.1.1.m1.2.2.cmml">c</mi><mo id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml">,</mo><mrow id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.2.1" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E11Xa.2.1.1.m1.1.1" xref="S3.E11Xa.2.1.1.m1.1.1.cmml">o</mi><mo stretchy="false" id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.4" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.3" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.2.cmml">}</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E11Xa.2.1.1.m1.4.4.1.2" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E11Xa.2.1.1.m1.4b"><apply id="S3.E11Xa.2.1.1.m1.4.4.1.1.cmml" xref="S3.E11Xa.2.1.1.m1.4.4.1"><eq id="S3.E11Xa.2.1.1.m1.4.4.1.1.2.cmml" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.2"></eq><ci id="S3.E11.m1.2.2.2.1.1.1.1af.cmml" xref="S3.E11.m1.2.2.2.1.1.1.1a"><mrow id="S3.E11.m1.2.2.2.1.1.1.1a.cmml" xref="S3.E11.m1.2.2.2.1.1.1.1a"><mtext id="S3.E11.m1.2.2.2.1.1.1.1aa.cmml" xref="S3.E11.m1.2.2.2.1.1.1.1a">AR</mtext><mtext id="S3.E11.m1.2.2.2.1.1.1.1ab.cmml" xref="S3.E11.m1.2.2.2.1.1.1.1a"><sub id="S3.E11.m1.2.2.2.1.1.1.1a.2anest" class="ltx_sub"><span id="S3.E11.m1.2.2.2.1.1.1.1a.2.1anest" class="ltx_text ltx_font_italic">k</span></sub></mtext><mtext id="S3.E11.m1.2.2.2.1.1.1.1ae.cmml" xref="S3.E11.m1.2.2.2.1.1.1.1a"> </mtext></mrow></ci><apply id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.cmml" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1"><times id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.2.cmml" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.2"></times><apply id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.3.cmml" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.3"><divide id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.3.1.cmml" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.3"></divide><cn type="integer" id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.3.2.cmml" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.3.2">1</cn><ci id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.3.3.cmml" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.3.3">𝑂</ci></apply><apply id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.cmml" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1"><apply id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.2.cmml" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.2.1.cmml" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.2">superscript</csymbol><apply id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.2.2.cmml" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.2.2.1.cmml" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.2">subscript</csymbol><sum id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.2.2.2.cmml" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.2.2.2"></sum><apply id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.2.2.3.cmml" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.2.2.3"><eq id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.2.2.3.1.cmml" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.2.2.3.1"></eq><ci id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.2.2.3.2.cmml" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.2.2.3.2">𝑜</ci><cn type="integer" id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.2.2.3.3.cmml" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.2.3.cmml" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.2.3">𝑂</ci></apply><apply id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.2.cmml" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1"><max id="S3.E11Xa.2.1.1.m1.3.3.cmml" xref="S3.E11Xa.2.1.1.m1.3.3"></max><apply id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1"><times id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2"></times><ci id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3a.cmml" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3"><mtext id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3">Recall</mtext></ci><interval closure="open" id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1"><ci id="S3.E11Xa.2.1.1.m1.2.2.cmml" xref="S3.E11Xa.2.1.1.m1.2.2">c</ci><apply id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1"><times id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1"></times><ci id="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E11Xa.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2">𝑡</ci><ci id="S3.E11Xa.2.1.1.m1.1.1.cmml" xref="S3.E11Xa.2.1.1.m1.1.1">𝑜</ci></apply></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11Xa.2.1.1.m1.4c">\displaystyle{\text{ AR${}_{k}$ }=\frac{1}{O}\sum_{o=1}^{O}\max\left\{\text{Recall}(\mathrm{c},t(o))\right\},}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S3.SS3.p3.6" class="ltx_p">where <math id="S3.SS3.p3.1.m1.1" class="ltx_Math" alttext="t(\textit{o})" display="inline"><semantics id="S3.SS3.p3.1.m1.1a"><mrow id="S3.SS3.p3.1.m1.1.2" xref="S3.SS3.p3.1.m1.1.2.cmml"><mi id="S3.SS3.p3.1.m1.1.2.2" xref="S3.SS3.p3.1.m1.1.2.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.1.m1.1.2.1" xref="S3.SS3.p3.1.m1.1.2.1.cmml">​</mo><mrow id="S3.SS3.p3.1.m1.1.2.3.2" xref="S3.SS3.p3.1.m1.1.1a.cmml"><mo stretchy="false" id="S3.SS3.p3.1.m1.1.2.3.2.1" xref="S3.SS3.p3.1.m1.1.1a.cmml">(</mo><mtext class="ltx_mathvariant_italic" id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml">o</mtext><mo stretchy="false" id="S3.SS3.p3.1.m1.1.2.3.2.2" xref="S3.SS3.p3.1.m1.1.1a.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><apply id="S3.SS3.p3.1.m1.1.2.cmml" xref="S3.SS3.p3.1.m1.1.2"><times id="S3.SS3.p3.1.m1.1.2.1.cmml" xref="S3.SS3.p3.1.m1.1.2.1"></times><ci id="S3.SS3.p3.1.m1.1.2.2.cmml" xref="S3.SS3.p3.1.m1.1.2.2">𝑡</ci><ci id="S3.SS3.p3.1.m1.1.1a.cmml" xref="S3.SS3.p3.1.m1.1.2.3.2"><mtext class="ltx_mathvariant_italic" id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1">o</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">t(\textit{o})</annotation></semantics></math> is a set of IoU thresholds and <math id="S3.SS3.p3.2.m2.1" class="ltx_Math" alttext="\mathrm{c}" display="inline"><semantics id="S3.SS3.p3.2.m2.1a"><mi mathvariant="normal" id="S3.SS3.p3.2.m2.1.1" xref="S3.SS3.p3.2.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.1b"><ci id="S3.SS3.p3.2.m2.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1">c</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.1c">\mathrm{c}</annotation></semantics></math> is the confidence values of all the detection results, <math id="S3.SS3.p3.3.m3.4" class="ltx_Math" alttext="r_{1},r_{2},\ldots,r_{n}" display="inline"><semantics id="S3.SS3.p3.3.m3.4a"><mrow id="S3.SS3.p3.3.m3.4.4.3" xref="S3.SS3.p3.3.m3.4.4.4.cmml"><msub id="S3.SS3.p3.3.m3.2.2.1.1" xref="S3.SS3.p3.3.m3.2.2.1.1.cmml"><mi id="S3.SS3.p3.3.m3.2.2.1.1.2" xref="S3.SS3.p3.3.m3.2.2.1.1.2.cmml">r</mi><mn id="S3.SS3.p3.3.m3.2.2.1.1.3" xref="S3.SS3.p3.3.m3.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS3.p3.3.m3.4.4.3.4" xref="S3.SS3.p3.3.m3.4.4.4.cmml">,</mo><msub id="S3.SS3.p3.3.m3.3.3.2.2" xref="S3.SS3.p3.3.m3.3.3.2.2.cmml"><mi id="S3.SS3.p3.3.m3.3.3.2.2.2" xref="S3.SS3.p3.3.m3.3.3.2.2.2.cmml">r</mi><mn id="S3.SS3.p3.3.m3.3.3.2.2.3" xref="S3.SS3.p3.3.m3.3.3.2.2.3.cmml">2</mn></msub><mo id="S3.SS3.p3.3.m3.4.4.3.5" xref="S3.SS3.p3.3.m3.4.4.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS3.p3.3.m3.1.1" xref="S3.SS3.p3.3.m3.1.1.cmml">…</mi><mo id="S3.SS3.p3.3.m3.4.4.3.6" xref="S3.SS3.p3.3.m3.4.4.4.cmml">,</mo><msub id="S3.SS3.p3.3.m3.4.4.3.3" xref="S3.SS3.p3.3.m3.4.4.3.3.cmml"><mi id="S3.SS3.p3.3.m3.4.4.3.3.2" xref="S3.SS3.p3.3.m3.4.4.3.3.2.cmml">r</mi><mi id="S3.SS3.p3.3.m3.4.4.3.3.3" xref="S3.SS3.p3.3.m3.4.4.3.3.3.cmml">n</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.3.m3.4b"><list id="S3.SS3.p3.3.m3.4.4.4.cmml" xref="S3.SS3.p3.3.m3.4.4.3"><apply id="S3.SS3.p3.3.m3.2.2.1.1.cmml" xref="S3.SS3.p3.3.m3.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.3.m3.2.2.1.1.1.cmml" xref="S3.SS3.p3.3.m3.2.2.1.1">subscript</csymbol><ci id="S3.SS3.p3.3.m3.2.2.1.1.2.cmml" xref="S3.SS3.p3.3.m3.2.2.1.1.2">𝑟</ci><cn type="integer" id="S3.SS3.p3.3.m3.2.2.1.1.3.cmml" xref="S3.SS3.p3.3.m3.2.2.1.1.3">1</cn></apply><apply id="S3.SS3.p3.3.m3.3.3.2.2.cmml" xref="S3.SS3.p3.3.m3.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS3.p3.3.m3.3.3.2.2.1.cmml" xref="S3.SS3.p3.3.m3.3.3.2.2">subscript</csymbol><ci id="S3.SS3.p3.3.m3.3.3.2.2.2.cmml" xref="S3.SS3.p3.3.m3.3.3.2.2.2">𝑟</ci><cn type="integer" id="S3.SS3.p3.3.m3.3.3.2.2.3.cmml" xref="S3.SS3.p3.3.m3.3.3.2.2.3">2</cn></apply><ci id="S3.SS3.p3.3.m3.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1">…</ci><apply id="S3.SS3.p3.3.m3.4.4.3.3.cmml" xref="S3.SS3.p3.3.m3.4.4.3.3"><csymbol cd="ambiguous" id="S3.SS3.p3.3.m3.4.4.3.3.1.cmml" xref="S3.SS3.p3.3.m3.4.4.3.3">subscript</csymbol><ci id="S3.SS3.p3.3.m3.4.4.3.3.2.cmml" xref="S3.SS3.p3.3.m3.4.4.3.3.2">𝑟</ci><ci id="S3.SS3.p3.3.m3.4.4.3.3.3.cmml" xref="S3.SS3.p3.3.m3.4.4.3.3.3">𝑛</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.3.m3.4c">r_{1},r_{2},\ldots,r_{n}</annotation></semantics></math> are the recall levels (in ascending order) at which the precision is first interpolated. The interpolated precision <math id="S3.SS3.p3.4.m4.2" class="ltx_Math" alttext="p_{\text{interp }}(r)=\max_{r^{\prime}\geq r}\text{Precision}\left(r^{\prime}\right)" display="inline"><semantics id="S3.SS3.p3.4.m4.2a"><mrow id="S3.SS3.p3.4.m4.2.2" xref="S3.SS3.p3.4.m4.2.2.cmml"><mrow id="S3.SS3.p3.4.m4.2.2.3" xref="S3.SS3.p3.4.m4.2.2.3.cmml"><msub id="S3.SS3.p3.4.m4.2.2.3.2" xref="S3.SS3.p3.4.m4.2.2.3.2.cmml"><mi id="S3.SS3.p3.4.m4.2.2.3.2.2" xref="S3.SS3.p3.4.m4.2.2.3.2.2.cmml">p</mi><mtext id="S3.SS3.p3.4.m4.2.2.3.2.3" xref="S3.SS3.p3.4.m4.2.2.3.2.3a.cmml">interp </mtext></msub><mo lspace="0em" rspace="0em" id="S3.SS3.p3.4.m4.2.2.3.1" xref="S3.SS3.p3.4.m4.2.2.3.1.cmml">​</mo><mrow id="S3.SS3.p3.4.m4.2.2.3.3.2" xref="S3.SS3.p3.4.m4.2.2.3.cmml"><mo stretchy="false" id="S3.SS3.p3.4.m4.2.2.3.3.2.1" xref="S3.SS3.p3.4.m4.2.2.3.cmml">(</mo><mi id="S3.SS3.p3.4.m4.1.1" xref="S3.SS3.p3.4.m4.1.1.cmml">r</mi><mo stretchy="false" id="S3.SS3.p3.4.m4.2.2.3.3.2.2" xref="S3.SS3.p3.4.m4.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p3.4.m4.2.2.2" xref="S3.SS3.p3.4.m4.2.2.2.cmml">=</mo><mrow id="S3.SS3.p3.4.m4.2.2.1" xref="S3.SS3.p3.4.m4.2.2.1.cmml"><mrow id="S3.SS3.p3.4.m4.2.2.1.3" xref="S3.SS3.p3.4.m4.2.2.1.3.cmml"><msub id="S3.SS3.p3.4.m4.2.2.1.3.1" xref="S3.SS3.p3.4.m4.2.2.1.3.1.cmml"><mi id="S3.SS3.p3.4.m4.2.2.1.3.1.2" xref="S3.SS3.p3.4.m4.2.2.1.3.1.2.cmml">max</mi><mrow id="S3.SS3.p3.4.m4.2.2.1.3.1.3" xref="S3.SS3.p3.4.m4.2.2.1.3.1.3.cmml"><msup id="S3.SS3.p3.4.m4.2.2.1.3.1.3.2" xref="S3.SS3.p3.4.m4.2.2.1.3.1.3.2.cmml"><mi id="S3.SS3.p3.4.m4.2.2.1.3.1.3.2.2" xref="S3.SS3.p3.4.m4.2.2.1.3.1.3.2.2.cmml">r</mi><mo id="S3.SS3.p3.4.m4.2.2.1.3.1.3.2.3" xref="S3.SS3.p3.4.m4.2.2.1.3.1.3.2.3.cmml">′</mo></msup><mo id="S3.SS3.p3.4.m4.2.2.1.3.1.3.1" xref="S3.SS3.p3.4.m4.2.2.1.3.1.3.1.cmml">≥</mo><mi id="S3.SS3.p3.4.m4.2.2.1.3.1.3.3" xref="S3.SS3.p3.4.m4.2.2.1.3.1.3.3.cmml">r</mi></mrow></msub><mo lspace="0.167em" id="S3.SS3.p3.4.m4.2.2.1.3a" xref="S3.SS3.p3.4.m4.2.2.1.3.cmml">⁡</mo><mtext id="S3.SS3.p3.4.m4.2.2.1.3.2" xref="S3.SS3.p3.4.m4.2.2.1.3.2a.cmml">Precision</mtext></mrow><mo lspace="0em" rspace="0em" id="S3.SS3.p3.4.m4.2.2.1.2" xref="S3.SS3.p3.4.m4.2.2.1.2.cmml">​</mo><mrow id="S3.SS3.p3.4.m4.2.2.1.1.1" xref="S3.SS3.p3.4.m4.2.2.1.1.1.1.cmml"><mo id="S3.SS3.p3.4.m4.2.2.1.1.1.2" xref="S3.SS3.p3.4.m4.2.2.1.1.1.1.cmml">(</mo><msup id="S3.SS3.p3.4.m4.2.2.1.1.1.1" xref="S3.SS3.p3.4.m4.2.2.1.1.1.1.cmml"><mi id="S3.SS3.p3.4.m4.2.2.1.1.1.1.2" xref="S3.SS3.p3.4.m4.2.2.1.1.1.1.2.cmml">r</mi><mo id="S3.SS3.p3.4.m4.2.2.1.1.1.1.3" xref="S3.SS3.p3.4.m4.2.2.1.1.1.1.3.cmml">′</mo></msup><mo id="S3.SS3.p3.4.m4.2.2.1.1.1.3" xref="S3.SS3.p3.4.m4.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.4.m4.2b"><apply id="S3.SS3.p3.4.m4.2.2.cmml" xref="S3.SS3.p3.4.m4.2.2"><eq id="S3.SS3.p3.4.m4.2.2.2.cmml" xref="S3.SS3.p3.4.m4.2.2.2"></eq><apply id="S3.SS3.p3.4.m4.2.2.3.cmml" xref="S3.SS3.p3.4.m4.2.2.3"><times id="S3.SS3.p3.4.m4.2.2.3.1.cmml" xref="S3.SS3.p3.4.m4.2.2.3.1"></times><apply id="S3.SS3.p3.4.m4.2.2.3.2.cmml" xref="S3.SS3.p3.4.m4.2.2.3.2"><csymbol cd="ambiguous" id="S3.SS3.p3.4.m4.2.2.3.2.1.cmml" xref="S3.SS3.p3.4.m4.2.2.3.2">subscript</csymbol><ci id="S3.SS3.p3.4.m4.2.2.3.2.2.cmml" xref="S3.SS3.p3.4.m4.2.2.3.2.2">𝑝</ci><ci id="S3.SS3.p3.4.m4.2.2.3.2.3a.cmml" xref="S3.SS3.p3.4.m4.2.2.3.2.3"><mtext mathsize="70%" id="S3.SS3.p3.4.m4.2.2.3.2.3.cmml" xref="S3.SS3.p3.4.m4.2.2.3.2.3">interp </mtext></ci></apply><ci id="S3.SS3.p3.4.m4.1.1.cmml" xref="S3.SS3.p3.4.m4.1.1">𝑟</ci></apply><apply id="S3.SS3.p3.4.m4.2.2.1.cmml" xref="S3.SS3.p3.4.m4.2.2.1"><times id="S3.SS3.p3.4.m4.2.2.1.2.cmml" xref="S3.SS3.p3.4.m4.2.2.1.2"></times><apply id="S3.SS3.p3.4.m4.2.2.1.3.cmml" xref="S3.SS3.p3.4.m4.2.2.1.3"><apply id="S3.SS3.p3.4.m4.2.2.1.3.1.cmml" xref="S3.SS3.p3.4.m4.2.2.1.3.1"><csymbol cd="ambiguous" id="S3.SS3.p3.4.m4.2.2.1.3.1.1.cmml" xref="S3.SS3.p3.4.m4.2.2.1.3.1">subscript</csymbol><max id="S3.SS3.p3.4.m4.2.2.1.3.1.2.cmml" xref="S3.SS3.p3.4.m4.2.2.1.3.1.2"></max><apply id="S3.SS3.p3.4.m4.2.2.1.3.1.3.cmml" xref="S3.SS3.p3.4.m4.2.2.1.3.1.3"><geq id="S3.SS3.p3.4.m4.2.2.1.3.1.3.1.cmml" xref="S3.SS3.p3.4.m4.2.2.1.3.1.3.1"></geq><apply id="S3.SS3.p3.4.m4.2.2.1.3.1.3.2.cmml" xref="S3.SS3.p3.4.m4.2.2.1.3.1.3.2"><csymbol cd="ambiguous" id="S3.SS3.p3.4.m4.2.2.1.3.1.3.2.1.cmml" xref="S3.SS3.p3.4.m4.2.2.1.3.1.3.2">superscript</csymbol><ci id="S3.SS3.p3.4.m4.2.2.1.3.1.3.2.2.cmml" xref="S3.SS3.p3.4.m4.2.2.1.3.1.3.2.2">𝑟</ci><ci id="S3.SS3.p3.4.m4.2.2.1.3.1.3.2.3.cmml" xref="S3.SS3.p3.4.m4.2.2.1.3.1.3.2.3">′</ci></apply><ci id="S3.SS3.p3.4.m4.2.2.1.3.1.3.3.cmml" xref="S3.SS3.p3.4.m4.2.2.1.3.1.3.3">𝑟</ci></apply></apply><ci id="S3.SS3.p3.4.m4.2.2.1.3.2a.cmml" xref="S3.SS3.p3.4.m4.2.2.1.3.2"><mtext id="S3.SS3.p3.4.m4.2.2.1.3.2.cmml" xref="S3.SS3.p3.4.m4.2.2.1.3.2">Precision</mtext></ci></apply><apply id="S3.SS3.p3.4.m4.2.2.1.1.1.1.cmml" xref="S3.SS3.p3.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.4.m4.2.2.1.1.1.1.1.cmml" xref="S3.SS3.p3.4.m4.2.2.1.1.1">superscript</csymbol><ci id="S3.SS3.p3.4.m4.2.2.1.1.1.1.2.cmml" xref="S3.SS3.p3.4.m4.2.2.1.1.1.1.2">𝑟</ci><ci id="S3.SS3.p3.4.m4.2.2.1.1.1.1.3.cmml" xref="S3.SS3.p3.4.m4.2.2.1.1.1.1.3">′</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.4.m4.2c">p_{\text{interp }}(r)=\max_{r^{\prime}\geq r}\text{Precision}\left(r^{\prime}\right)</annotation></semantics></math>, defined as the highest precision found at a certain recall level <math id="S3.SS3.p3.5.m5.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S3.SS3.p3.5.m5.1a"><mi id="S3.SS3.p3.5.m5.1.1" xref="S3.SS3.p3.5.m5.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.5.m5.1b"><ci id="S3.SS3.p3.5.m5.1.1.cmml" xref="S3.SS3.p3.5.m5.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.5.m5.1c">r</annotation></semantics></math>, for any recall level <math id="S3.SS3.p3.6.m6.1" class="ltx_Math" alttext="r^{\prime}\geq r" display="inline"><semantics id="S3.SS3.p3.6.m6.1a"><mrow id="S3.SS3.p3.6.m6.1.1" xref="S3.SS3.p3.6.m6.1.1.cmml"><msup id="S3.SS3.p3.6.m6.1.1.2" xref="S3.SS3.p3.6.m6.1.1.2.cmml"><mi id="S3.SS3.p3.6.m6.1.1.2.2" xref="S3.SS3.p3.6.m6.1.1.2.2.cmml">r</mi><mo id="S3.SS3.p3.6.m6.1.1.2.3" xref="S3.SS3.p3.6.m6.1.1.2.3.cmml">′</mo></msup><mo id="S3.SS3.p3.6.m6.1.1.1" xref="S3.SS3.p3.6.m6.1.1.1.cmml">≥</mo><mi id="S3.SS3.p3.6.m6.1.1.3" xref="S3.SS3.p3.6.m6.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.6.m6.1b"><apply id="S3.SS3.p3.6.m6.1.1.cmml" xref="S3.SS3.p3.6.m6.1.1"><geq id="S3.SS3.p3.6.m6.1.1.1.cmml" xref="S3.SS3.p3.6.m6.1.1.1"></geq><apply id="S3.SS3.p3.6.m6.1.1.2.cmml" xref="S3.SS3.p3.6.m6.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p3.6.m6.1.1.2.1.cmml" xref="S3.SS3.p3.6.m6.1.1.2">superscript</csymbol><ci id="S3.SS3.p3.6.m6.1.1.2.2.cmml" xref="S3.SS3.p3.6.m6.1.1.2.2">𝑟</ci><ci id="S3.SS3.p3.6.m6.1.1.2.3.cmml" xref="S3.SS3.p3.6.m6.1.1.2.3">′</ci></apply><ci id="S3.SS3.p3.6.m6.1.1.3.cmml" xref="S3.SS3.p3.6.m6.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.6.m6.1c">r^{\prime}\geq r</annotation></semantics></math>. The Precision and Recall are defined as:</p>
</div>
<div id="S3.SS3.p4" class="ltx_para">
<table id="S3.E12" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E12X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E12X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\text{Precision}=\frac{\mathrm{TP}}{\mathrm{TP}+\mathrm{FP}},\quad\text{Recall}=\frac{\mathrm{TP}}{\mathrm{TP}+\mathrm{FN}}," display="inline"><semantics id="S3.E12X.2.1.1.m1.1a"><mrow id="S3.E12X.2.1.1.m1.1.1.1"><mrow id="S3.E12X.2.1.1.m1.1.1.1.1.2" xref="S3.E12X.2.1.1.m1.1.1.1.1.3.cmml"><mrow id="S3.E12X.2.1.1.m1.1.1.1.1.1.1" xref="S3.E12X.2.1.1.m1.1.1.1.1.1.1.cmml"><mtext id="S3.E12X.2.1.1.m1.1.1.1.1.1.1.2" xref="S3.E12X.2.1.1.m1.1.1.1.1.1.1.2a.cmml">Precision</mtext><mo id="S3.E12X.2.1.1.m1.1.1.1.1.1.1.1" xref="S3.E12X.2.1.1.m1.1.1.1.1.1.1.1.cmml">=</mo><mstyle displaystyle="true" id="S3.E12X.2.1.1.m1.1.1.1.1.1.1.3" xref="S3.E12X.2.1.1.m1.1.1.1.1.1.1.3.cmml"><mfrac id="S3.E12X.2.1.1.m1.1.1.1.1.1.1.3a" xref="S3.E12X.2.1.1.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E12X.2.1.1.m1.1.1.1.1.1.1.3.2" xref="S3.E12X.2.1.1.m1.1.1.1.1.1.1.3.2.cmml">TP</mi><mrow id="S3.E12X.2.1.1.m1.1.1.1.1.1.1.3.3" xref="S3.E12X.2.1.1.m1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E12X.2.1.1.m1.1.1.1.1.1.1.3.3.2" xref="S3.E12X.2.1.1.m1.1.1.1.1.1.1.3.3.2.cmml">TP</mi><mo id="S3.E12X.2.1.1.m1.1.1.1.1.1.1.3.3.1" xref="S3.E12X.2.1.1.m1.1.1.1.1.1.1.3.3.1.cmml">+</mo><mi id="S3.E12X.2.1.1.m1.1.1.1.1.1.1.3.3.3" xref="S3.E12X.2.1.1.m1.1.1.1.1.1.1.3.3.3.cmml">FP</mi></mrow></mfrac></mstyle></mrow><mo rspace="1.167em" id="S3.E12X.2.1.1.m1.1.1.1.1.2.3" xref="S3.E12X.2.1.1.m1.1.1.1.1.3a.cmml">,</mo><mrow id="S3.E12X.2.1.1.m1.1.1.1.1.2.2" xref="S3.E12X.2.1.1.m1.1.1.1.1.2.2.cmml"><mtext id="S3.E12X.2.1.1.m1.1.1.1.1.2.2.2" xref="S3.E12X.2.1.1.m1.1.1.1.1.2.2.2a.cmml">Recall</mtext><mo id="S3.E12X.2.1.1.m1.1.1.1.1.2.2.1" xref="S3.E12X.2.1.1.m1.1.1.1.1.2.2.1.cmml">=</mo><mstyle displaystyle="true" id="S3.E12X.2.1.1.m1.1.1.1.1.2.2.3" xref="S3.E12X.2.1.1.m1.1.1.1.1.2.2.3.cmml"><mfrac id="S3.E12X.2.1.1.m1.1.1.1.1.2.2.3a" xref="S3.E12X.2.1.1.m1.1.1.1.1.2.2.3.cmml"><mi id="S3.E12X.2.1.1.m1.1.1.1.1.2.2.3.2" xref="S3.E12X.2.1.1.m1.1.1.1.1.2.2.3.2.cmml">TP</mi><mrow id="S3.E12X.2.1.1.m1.1.1.1.1.2.2.3.3" xref="S3.E12X.2.1.1.m1.1.1.1.1.2.2.3.3.cmml"><mi id="S3.E12X.2.1.1.m1.1.1.1.1.2.2.3.3.2" xref="S3.E12X.2.1.1.m1.1.1.1.1.2.2.3.3.2.cmml">TP</mi><mo id="S3.E12X.2.1.1.m1.1.1.1.1.2.2.3.3.1" xref="S3.E12X.2.1.1.m1.1.1.1.1.2.2.3.3.1.cmml">+</mo><mi id="S3.E12X.2.1.1.m1.1.1.1.1.2.2.3.3.3" xref="S3.E12X.2.1.1.m1.1.1.1.1.2.2.3.3.3.cmml">FN</mi></mrow></mfrac></mstyle></mrow></mrow><mo id="S3.E12X.2.1.1.m1.1.1.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E12X.2.1.1.m1.1b"><apply id="S3.E12X.2.1.1.m1.1.1.1.1.3.cmml" xref="S3.E12X.2.1.1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E12X.2.1.1.m1.1.1.1.1.3a.cmml" xref="S3.E12X.2.1.1.m1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E12X.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S3.E12X.2.1.1.m1.1.1.1.1.1.1"><eq id="S3.E12X.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.E12X.2.1.1.m1.1.1.1.1.1.1.1"></eq><ci id="S3.E12X.2.1.1.m1.1.1.1.1.1.1.2a.cmml" xref="S3.E12X.2.1.1.m1.1.1.1.1.1.1.2"><mtext id="S3.E12X.2.1.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.E12X.2.1.1.m1.1.1.1.1.1.1.2">Precision</mtext></ci><apply id="S3.E12X.2.1.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.E12X.2.1.1.m1.1.1.1.1.1.1.3"><divide id="S3.E12X.2.1.1.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E12X.2.1.1.m1.1.1.1.1.1.1.3"></divide><ci id="S3.E12X.2.1.1.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E12X.2.1.1.m1.1.1.1.1.1.1.3.2">TP</ci><apply id="S3.E12X.2.1.1.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E12X.2.1.1.m1.1.1.1.1.1.1.3.3"><plus id="S3.E12X.2.1.1.m1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E12X.2.1.1.m1.1.1.1.1.1.1.3.3.1"></plus><ci id="S3.E12X.2.1.1.m1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E12X.2.1.1.m1.1.1.1.1.1.1.3.3.2">TP</ci><ci id="S3.E12X.2.1.1.m1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E12X.2.1.1.m1.1.1.1.1.1.1.3.3.3">FP</ci></apply></apply></apply><apply id="S3.E12X.2.1.1.m1.1.1.1.1.2.2.cmml" xref="S3.E12X.2.1.1.m1.1.1.1.1.2.2"><eq id="S3.E12X.2.1.1.m1.1.1.1.1.2.2.1.cmml" xref="S3.E12X.2.1.1.m1.1.1.1.1.2.2.1"></eq><ci id="S3.E12X.2.1.1.m1.1.1.1.1.2.2.2a.cmml" xref="S3.E12X.2.1.1.m1.1.1.1.1.2.2.2"><mtext id="S3.E12X.2.1.1.m1.1.1.1.1.2.2.2.cmml" xref="S3.E12X.2.1.1.m1.1.1.1.1.2.2.2">Recall</mtext></ci><apply id="S3.E12X.2.1.1.m1.1.1.1.1.2.2.3.cmml" xref="S3.E12X.2.1.1.m1.1.1.1.1.2.2.3"><divide id="S3.E12X.2.1.1.m1.1.1.1.1.2.2.3.1.cmml" xref="S3.E12X.2.1.1.m1.1.1.1.1.2.2.3"></divide><ci id="S3.E12X.2.1.1.m1.1.1.1.1.2.2.3.2.cmml" xref="S3.E12X.2.1.1.m1.1.1.1.1.2.2.3.2">TP</ci><apply id="S3.E12X.2.1.1.m1.1.1.1.1.2.2.3.3.cmml" xref="S3.E12X.2.1.1.m1.1.1.1.1.2.2.3.3"><plus id="S3.E12X.2.1.1.m1.1.1.1.1.2.2.3.3.1.cmml" xref="S3.E12X.2.1.1.m1.1.1.1.1.2.2.3.3.1"></plus><ci id="S3.E12X.2.1.1.m1.1.1.1.1.2.2.3.3.2.cmml" xref="S3.E12X.2.1.1.m1.1.1.1.1.2.2.3.3.2">TP</ci><ci id="S3.E12X.2.1.1.m1.1.1.1.1.2.2.3.3.3.cmml" xref="S3.E12X.2.1.1.m1.1.1.1.1.2.2.3.3.3">FN</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12X.2.1.1.m1.1c">\displaystyle\text{Precision}=\frac{\mathrm{TP}}{\mathrm{TP}+\mathrm{FP}},\quad\text{Recall}=\frac{\mathrm{TP}}{\mathrm{TP}+\mathrm{FN}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(12)</span></td>
</tr>
</tbody>
</table>
<p id="S3.SS3.p4.1" class="ltx_p">where the TP is true positives, FN is false negatives, and FP is false positives.</p>
</div>
<figure id="S3.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE I: </span><span id="S3.T1.7.1" class="ltx_text ltx_font_bold">Comparison with the SOTA object detection models.</span></figcaption>
<table id="S3.T1.5" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T1.5.5" class="ltx_tr">
<th id="S3.T1.5.5.6" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" style="padding:1pt 5.7pt;">Method</th>
<th id="S3.T1.5.5.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" style="padding:1pt 5.7pt;">Epochs</th>
<th id="S3.T1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding:1pt 5.7pt;">mAP<sub id="S3.T1.1.1.1.1" class="ltx_sub"><span id="S3.T1.1.1.1.1.1" class="ltx_text ltx_font_italic">50</span></sub>
</th>
<th id="S3.T1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding:1pt 5.7pt;">mAP<sub id="S3.T1.2.2.2.1" class="ltx_sub"><span id="S3.T1.2.2.2.1.1" class="ltx_text ltx_font_italic">75</span></sub>
</th>
<th id="S3.T1.5.5.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding:1pt 5.7pt;">mAP</th>
<th id="S3.T1.3.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding:1pt 5.7pt;">mAP<sub id="S3.T1.3.3.3.1" class="ltx_sub"><span id="S3.T1.3.3.3.1.1" class="ltx_text ltx_font_italic">S</span></sub>
</th>
<th id="S3.T1.4.4.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding:1pt 5.7pt;">mAP<sub id="S3.T1.4.4.4.1" class="ltx_sub"><span id="S3.T1.4.4.4.1.1" class="ltx_text ltx_font_italic">M</span></sub>
</th>
<th id="S3.T1.5.5.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding:1pt 5.7pt;">AR<sub id="S3.T1.5.5.5.1" class="ltx_sub"><span id="S3.T1.5.5.5.1.1" class="ltx_text ltx_font_italic">100</span></sub>
</th>
<th id="S3.T1.5.5.9" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding:1pt 5.7pt;">End-to-End</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T1.5.6.1" class="ltx_tr">
<th id="S3.T1.5.6.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding:1pt 5.7pt;"><span id="S3.T1.5.6.1.1.1" class="ltx_text ltx_font_italic">One-stage model</span></th>
<th id="S3.T1.5.6.1.2" class="ltx_td ltx_th ltx_th_row ltx_border_t" style="padding:1pt 5.7pt;"></th>
<td id="S3.T1.5.6.1.3" class="ltx_td ltx_border_t" style="padding:1pt 5.7pt;"></td>
<td id="S3.T1.5.6.1.4" class="ltx_td ltx_border_t" style="padding:1pt 5.7pt;"></td>
<td id="S3.T1.5.6.1.5" class="ltx_td ltx_border_t" style="padding:1pt 5.7pt;"></td>
<td id="S3.T1.5.6.1.6" class="ltx_td ltx_border_t" style="padding:1pt 5.7pt;"></td>
<td id="S3.T1.5.6.1.7" class="ltx_td ltx_border_t" style="padding:1pt 5.7pt;"></td>
<td id="S3.T1.5.6.1.8" class="ltx_td ltx_border_t" style="padding:1pt 5.7pt;"></td>
<td id="S3.T1.5.6.1.9" class="ltx_td ltx_border_t" style="padding:1pt 5.7pt;"></td>
</tr>
<tr id="S3.T1.5.7.2" class="ltx_tr">
<th id="S3.T1.5.7.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding:1pt 5.7pt;">YOLOv3</th>
<th id="S3.T1.5.7.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_row" style="padding:1pt 5.7pt;">273</th>
<td id="S3.T1.5.7.2.3" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">95.0</td>
<td id="S3.T1.5.7.2.4" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">76.4</td>
<td id="S3.T1.5.7.2.5" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">61.0</td>
<td id="S3.T1.5.7.2.6" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">39.3</td>
<td id="S3.T1.5.7.2.7" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">62.8</td>
<td id="S3.T1.5.7.2.8" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">65.2</td>
<td id="S3.T1.5.7.2.9" class="ltx_td" style="padding:1pt 5.7pt;"></td>
</tr>
<tr id="S3.T1.5.8.3" class="ltx_tr">
<th id="S3.T1.5.8.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding:1pt 5.7pt;">SSD</th>
<th id="S3.T1.5.8.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_row" style="padding:1pt 5.7pt;">24</th>
<td id="S3.T1.5.8.3.3" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">95.5</td>
<td id="S3.T1.5.8.3.4" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">65.3</td>
<td id="S3.T1.5.8.3.5" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">59.5</td>
<td id="S3.T1.5.8.3.6" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">31.4</td>
<td id="S3.T1.5.8.3.7" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">62.7</td>
<td id="S3.T1.5.8.3.8" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">64.3</td>
<td id="S3.T1.5.8.3.9" class="ltx_td" style="padding:1pt 5.7pt;"></td>
</tr>
<tr id="S3.T1.5.9.4" class="ltx_tr">
<th id="S3.T1.5.9.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding:1pt 5.7pt;"><span id="S3.T1.5.9.4.1.1" class="ltx_text ltx_font_italic">Two-stage model</span></th>
<th id="S3.T1.5.9.4.2" class="ltx_td ltx_th ltx_th_row ltx_border_t" style="padding:1pt 5.7pt;"></th>
<td id="S3.T1.5.9.4.3" class="ltx_td ltx_border_t" style="padding:1pt 5.7pt;"></td>
<td id="S3.T1.5.9.4.4" class="ltx_td ltx_border_t" style="padding:1pt 5.7pt;"></td>
<td id="S3.T1.5.9.4.5" class="ltx_td ltx_border_t" style="padding:1pt 5.7pt;"></td>
<td id="S3.T1.5.9.4.6" class="ltx_td ltx_border_t" style="padding:1pt 5.7pt;"></td>
<td id="S3.T1.5.9.4.7" class="ltx_td ltx_border_t" style="padding:1pt 5.7pt;"></td>
<td id="S3.T1.5.9.4.8" class="ltx_td ltx_border_t" style="padding:1pt 5.7pt;"></td>
<td id="S3.T1.5.9.4.9" class="ltx_td ltx_border_t" style="padding:1pt 5.7pt;"></td>
</tr>
<tr id="S3.T1.5.10.5" class="ltx_tr">
<th id="S3.T1.5.10.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding:1pt 5.7pt;">Faster-RCNN</th>
<th id="S3.T1.5.10.5.2" class="ltx_td ltx_align_center ltx_th ltx_th_row" style="padding:1pt 5.7pt;">24</th>
<td id="S3.T1.5.10.5.3" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">95.7</td>
<td id="S3.T1.5.10.5.4" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">55.7</td>
<td id="S3.T1.5.10.5.5" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">56.1</td>
<td id="S3.T1.5.10.5.6" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">31.9</td>
<td id="S3.T1.5.10.5.7" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">58.4</td>
<td id="S3.T1.5.10.5.8" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">61.0</td>
<td id="S3.T1.5.10.5.9" class="ltx_td" style="padding:1pt 5.7pt;"></td>
</tr>
<tr id="S3.T1.5.11.6" class="ltx_tr">
<th id="S3.T1.5.11.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding:1pt 5.7pt;"><span id="S3.T1.5.11.6.1.1" class="ltx_text ltx_font_italic">Anchor-free model</span></th>
<th id="S3.T1.5.11.6.2" class="ltx_td ltx_th ltx_th_row ltx_border_t" style="padding:1pt 5.7pt;"></th>
<td id="S3.T1.5.11.6.3" class="ltx_td ltx_border_t" style="padding:1pt 5.7pt;"></td>
<td id="S3.T1.5.11.6.4" class="ltx_td ltx_border_t" style="padding:1pt 5.7pt;"></td>
<td id="S3.T1.5.11.6.5" class="ltx_td ltx_border_t" style="padding:1pt 5.7pt;"></td>
<td id="S3.T1.5.11.6.6" class="ltx_td ltx_border_t" style="padding:1pt 5.7pt;"></td>
<td id="S3.T1.5.11.6.7" class="ltx_td ltx_border_t" style="padding:1pt 5.7pt;"></td>
<td id="S3.T1.5.11.6.8" class="ltx_td ltx_border_t" style="padding:1pt 5.7pt;"></td>
<td id="S3.T1.5.11.6.9" class="ltx_td ltx_border_t" style="padding:1pt 5.7pt;"></td>
</tr>
<tr id="S3.T1.5.12.7" class="ltx_tr">
<th id="S3.T1.5.12.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding:1pt 5.7pt;">ATSS</th>
<th id="S3.T1.5.12.7.2" class="ltx_td ltx_align_center ltx_th ltx_th_row" style="padding:1pt 5.7pt;">24</th>
<td id="S3.T1.5.12.7.3" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">96.2</td>
<td id="S3.T1.5.12.7.4" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">74.1</td>
<td id="S3.T1.5.12.7.5" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">59.8</td>
<td id="S3.T1.5.12.7.6" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">32.2</td>
<td id="S3.T1.5.12.7.7" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">61.5</td>
<td id="S3.T1.5.12.7.8" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">64.0</td>
<td id="S3.T1.5.12.7.9" class="ltx_td" style="padding:1pt 5.7pt;"></td>
</tr>
<tr id="S3.T1.5.13.8" class="ltx_tr">
<th id="S3.T1.5.13.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding:1pt 5.7pt;">FCOS</th>
<th id="S3.T1.5.13.8.2" class="ltx_td ltx_align_center ltx_th ltx_th_row" style="padding:1pt 5.7pt;">24</th>
<td id="S3.T1.5.13.8.3" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">95.7</td>
<td id="S3.T1.5.13.8.4" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">60.0</td>
<td id="S3.T1.5.13.8.5" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">58.8</td>
<td id="S3.T1.5.13.8.6" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">34.4</td>
<td id="S3.T1.5.13.8.7" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">60.1</td>
<td id="S3.T1.5.13.8.8" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">62.1</td>
<td id="S3.T1.5.13.8.9" class="ltx_td" style="padding:1pt 5.7pt;"></td>
</tr>
<tr id="S3.T1.5.14.9" class="ltx_tr">
<th id="S3.T1.5.14.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding:1pt 5.7pt;"><span id="S3.T1.5.14.9.1.1" class="ltx_text ltx_font_italic">Transformer-based model</span></th>
<th id="S3.T1.5.14.9.2" class="ltx_td ltx_th ltx_th_row ltx_border_t" style="padding:1pt 5.7pt;"></th>
<td id="S3.T1.5.14.9.3" class="ltx_td ltx_border_t" style="padding:1pt 5.7pt;"></td>
<td id="S3.T1.5.14.9.4" class="ltx_td ltx_border_t" style="padding:1pt 5.7pt;"></td>
<td id="S3.T1.5.14.9.5" class="ltx_td ltx_border_t" style="padding:1pt 5.7pt;"></td>
<td id="S3.T1.5.14.9.6" class="ltx_td ltx_border_t" style="padding:1pt 5.7pt;"></td>
<td id="S3.T1.5.14.9.7" class="ltx_td ltx_border_t" style="padding:1pt 5.7pt;"></td>
<td id="S3.T1.5.14.9.8" class="ltx_td ltx_border_t" style="padding:1pt 5.7pt;"></td>
<td id="S3.T1.5.14.9.9" class="ltx_td ltx_border_t" style="padding:1pt 5.7pt;"></td>
</tr>
<tr id="S3.T1.5.15.10" class="ltx_tr">
<th id="S3.T1.5.15.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding:1pt 5.7pt;">PVT</th>
<th id="S3.T1.5.15.10.2" class="ltx_td ltx_align_center ltx_th ltx_th_row" style="padding:1pt 5.7pt;">24</th>
<td id="S3.T1.5.15.10.3" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">96.1</td>
<td id="S3.T1.5.15.10.4" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">80.4</td>
<td id="S3.T1.5.15.10.5" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">64.0</td>
<td id="S3.T1.5.15.10.6" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">39.8</td>
<td id="S3.T1.5.15.10.7" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">65.3</td>
<td id="S3.T1.5.15.10.8" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">69.1</td>
<td id="S3.T1.5.15.10.9" class="ltx_td" style="padding:1pt 5.7pt;"></td>
</tr>
<tr id="S3.T1.5.16.11" class="ltx_tr">
<th id="S3.T1.5.16.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding:1pt 5.7pt;">Dyhead</th>
<th id="S3.T1.5.16.11.2" class="ltx_td ltx_align_center ltx_th ltx_th_row" style="padding:1pt 5.7pt;">24</th>
<td id="S3.T1.5.16.11.3" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">96.3</td>
<td id="S3.T1.5.16.11.4" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">74.0</td>
<td id="S3.T1.5.16.11.5" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">64.2</td>
<td id="S3.T1.5.16.11.6" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">38.4</td>
<td id="S3.T1.5.16.11.7" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">66.9</td>
<td id="S3.T1.5.16.11.8" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">68.5</td>
<td id="S3.T1.5.16.11.9" class="ltx_td" style="padding:1pt 5.7pt;"></td>
</tr>
<tr id="S3.T1.5.17.12" class="ltx_tr">
<th id="S3.T1.5.17.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding:1pt 5.7pt;"><span id="S3.T1.5.17.12.1.1" class="ltx_text ltx_font_italic">Strong SOTA model</span></th>
<th id="S3.T1.5.17.12.2" class="ltx_td ltx_th ltx_th_row ltx_border_t" style="padding:1pt 5.7pt;"></th>
<td id="S3.T1.5.17.12.3" class="ltx_td ltx_border_t" style="padding:1pt 5.7pt;"></td>
<td id="S3.T1.5.17.12.4" class="ltx_td ltx_border_t" style="padding:1pt 5.7pt;"></td>
<td id="S3.T1.5.17.12.5" class="ltx_td ltx_border_t" style="padding:1pt 5.7pt;"></td>
<td id="S3.T1.5.17.12.6" class="ltx_td ltx_border_t" style="padding:1pt 5.7pt;"></td>
<td id="S3.T1.5.17.12.7" class="ltx_td ltx_border_t" style="padding:1pt 5.7pt;"></td>
<td id="S3.T1.5.17.12.8" class="ltx_td ltx_border_t" style="padding:1pt 5.7pt;"></td>
<td id="S3.T1.5.17.12.9" class="ltx_td ltx_border_t" style="padding:1pt 5.7pt;"></td>
</tr>
<tr id="S3.T1.5.18.13" class="ltx_tr">
<th id="S3.T1.5.18.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding:1pt 5.7pt;">YOLOv8</th>
<th id="S3.T1.5.18.13.2" class="ltx_td ltx_align_center ltx_th ltx_th_row" style="padding:1pt 5.7pt;">500</th>
<td id="S3.T1.5.18.13.3" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">95.6</td>
<td id="S3.T1.5.18.13.4" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">83.4</td>
<td id="S3.T1.5.18.13.5" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">65.6</td>
<td id="S3.T1.5.18.13.6" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">45.5</td>
<td id="S3.T1.5.18.13.7" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">67.6</td>
<td id="S3.T1.5.18.13.8" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">69.8</td>
<td id="S3.T1.5.18.13.9" class="ltx_td" style="padding:1pt 5.7pt;"></td>
</tr>
<tr id="S3.T1.5.19.14" class="ltx_tr">
<th id="S3.T1.5.19.14.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding:1pt 5.7pt;">PMMW-DETR</th>
<th id="S3.T1.5.19.14.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" style="padding:1pt 5.7pt;">24</th>
<td id="S3.T1.5.19.14.3" class="ltx_td ltx_align_center ltx_border_t" style="padding:1pt 5.7pt;">97.0</td>
<td id="S3.T1.5.19.14.4" class="ltx_td ltx_align_center ltx_border_t" style="padding:1pt 5.7pt;">87.1</td>
<td id="S3.T1.5.19.14.5" class="ltx_td ltx_align_center ltx_border_t" style="padding:1pt 5.7pt;">67.8</td>
<td id="S3.T1.5.19.14.6" class="ltx_td ltx_align_center ltx_border_t" style="padding:1pt 5.7pt;">45.7</td>
<td id="S3.T1.5.19.14.7" class="ltx_td ltx_align_center ltx_border_t" style="padding:1pt 5.7pt;">68.4</td>
<td id="S3.T1.5.19.14.8" class="ltx_td ltx_align_center ltx_border_t" style="padding:1pt 5.7pt;">75.5</td>
<td id="S3.T1.5.19.14.9" class="ltx_td ltx_align_center ltx_border_t" style="padding:1pt 5.7pt;">✓</td>
</tr>
<tr id="S3.T1.5.20.15" class="ltx_tr">
<th id="S3.T1.5.20.15.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="padding:1pt 5.7pt;">PMMW-DETR(Ours)</th>
<th id="S3.T1.5.20.15.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" style="padding:1pt 5.7pt;">50</th>
<td id="S3.T1.5.20.15.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding:1pt 5.7pt;"><span id="S3.T1.5.20.15.3.1" class="ltx_text ltx_font_bold">97.5</span></td>
<td id="S3.T1.5.20.15.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding:1pt 5.7pt;"><span id="S3.T1.5.20.15.4.1" class="ltx_text ltx_font_bold">91.8</span></td>
<td id="S3.T1.5.20.15.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding:1pt 5.7pt;"><span id="S3.T1.5.20.15.5.1" class="ltx_text ltx_font_bold">71.3</span></td>
<td id="S3.T1.5.20.15.6" class="ltx_td ltx_align_center ltx_border_bb" style="padding:1pt 5.7pt;"><span id="S3.T1.5.20.15.6.1" class="ltx_text ltx_font_bold">49.1</span></td>
<td id="S3.T1.5.20.15.7" class="ltx_td ltx_align_center ltx_border_bb" style="padding:1pt 5.7pt;"><span id="S3.T1.5.20.15.7.1" class="ltx_text ltx_font_bold">74.1</span></td>
<td id="S3.T1.5.20.15.8" class="ltx_td ltx_align_center ltx_border_bb" style="padding:1pt 5.7pt;"><span id="S3.T1.5.20.15.8.1" class="ltx_text ltx_font_bold">80.4</span></td>
<td id="S3.T1.5.20.15.9" class="ltx_td ltx_align_center ltx_border_bb" style="padding:1pt 5.7pt;">✓</td>
</tr>
</tbody>
</table>
</figure>
<div id="S3.SS3.p5" class="ltx_para">
<p id="S3.SS3.p5.1" class="ltx_p">To show the superior performance of our proposed model, we present experimental results comparison with six representative state-of-the-art (SOTA) detectors, including YOLOv3 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite> (one-stage detector), SSD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite> (one-stage detector), Faster-RCNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib45" title="" class="ltx_ref">45</a>]</cite> (two-stage detector), ATSS <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> (anchor-free detector), FCOS <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib46" title="" class="ltx_ref">46</a>]</cite> (anchor-free detector), PVT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib47" title="" class="ltx_ref">47</a>]</cite> (Transformer-based detector), and Dynamic Head (Transformer-based detector) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite>. In order to ensure the comprehensiveness of the comparison test, each of the six object detectors represents the different characteristics of object detectors in different periods. YOLOv3 and SSD are the most reliable one-stage detectors with the best small object detection ability in the industry and have recently been used to detect concealed objects <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>, which we introduce to compare with the work of predecessors. Faster-RCNN is one of the most classical two-stage detectors. Faster-RCNN proposed to use Region Proposal Net (RPN) to obtain accurate anchors and then match objects, which has certain similarities with the decoder structure of DETR. ATSS and FCOS are the two most pioneering anchor-free algorithms. FCOS first proposed the concept of the center-ness and achieved adaptive detection by regressing the distance from the center point to the boxes. Since no prior anchor boxes are required, FCOS has strong robustness to the complex concealed object detection working environment. ATSS further proposed adaptive positive and negative sample selection on the basis of FCOS, which also inspired Yang <span id="S3.SS3.p5.1.1" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>. To demonstrate the superiority of our proposed attention computation method on the backbone and head, we compare our PMMW-DETR with PVT and Dyhead, which introduce the attention mechanism into the backbone and head networks, respectively. In addition, we added the latest YOLOv8 detector from the YOLO series as a strong SOTA model to make our SOTA comparison experiments more convincing. To ensure the fair validity of the experiment, we adopt grid search <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib49" title="" class="ltx_ref">49</a>]</cite> to find the relatively optimal hyperparameters in the above networks, and the accuracy comparison experiments are given in Table <a href="#S3.T5" title="TABLE V ‣ III-E hyperparameters setting for SOTA models ‣ III Experiments and Results ‣ Concealed Object Detection for Passive Millimeter-Wave Security Imaging Based on Task-Aligned Detection Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">V</span></a>. All the experiments were run on the same dataset, and the above models are implemented based on the mmyolo and mmdetection <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib50" title="" class="ltx_ref">50</a>]</cite>.</p>
</div>
<figure id="S3.F8" class="ltx_figure"><img src="/html/2212.00313/assets/x8.png" id="S3.F8.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="266" height="110" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>The 24 epochs mAP<sub id="S3.F8.4.1" class="ltx_sub"><span id="S3.F8.4.1.1" class="ltx_text ltx_font_italic">75</span></sub> curves of PMMW-DETR and other models.</figcaption>
</figure>
<div id="S3.SS3.p6" class="ltx_para">
<p id="S3.SS3.p6.4" class="ltx_p">In the Table <a href="#S3.T1" title="TABLE I ‣ III-C Comparison with the State-of-the-Art ‣ III Experiments and Results ‣ Concealed Object Detection for Passive Millimeter-Wave Security Imaging Based on Task-Aligned Detection Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a>, the epoch is the metric used to measure the convergence speed, where an epoch is a process of sending all data into the network and completing a forward calculation and back propagation. To fairly compare the performance, we set up an experiment with 24 (2x schedule) epochs setup and drop the learning rate of our model by multiplying by 0.1 in the 20-th epoch. The mAP<sub id="S3.SS3.p6.4.1" class="ltx_sub"><span id="S3.SS3.p6.4.1.1" class="ltx_text ltx_font_italic">50</span></sub> is the standard metric for Pascal VOC, which defines the mapped metric using a single IoU threshold of 0.5. Similarly, the mAP<sub id="S3.SS3.p6.4.2" class="ltx_sub"><span id="S3.SS3.p6.4.2.1" class="ltx_text ltx_font_italic">75</span></sub> uses a single IoU threshold of 0.75. The mAP is the average of mAP under 10 IoU thresholds (i.e.,<math id="S3.SS3.p6.3.m3.5" class="ltx_Math" alttext="0.50,0.55,0.60,\ldots,0.95" display="inline"><semantics id="S3.SS3.p6.3.m3.5a"><mrow id="S3.SS3.p6.3.m3.5.6.2" xref="S3.SS3.p6.3.m3.5.6.1.cmml"><mn id="S3.SS3.p6.3.m3.1.1" xref="S3.SS3.p6.3.m3.1.1.cmml">0.50</mn><mo id="S3.SS3.p6.3.m3.5.6.2.1" xref="S3.SS3.p6.3.m3.5.6.1.cmml">,</mo><mn id="S3.SS3.p6.3.m3.2.2" xref="S3.SS3.p6.3.m3.2.2.cmml">0.55</mn><mo id="S3.SS3.p6.3.m3.5.6.2.2" xref="S3.SS3.p6.3.m3.5.6.1.cmml">,</mo><mn id="S3.SS3.p6.3.m3.3.3" xref="S3.SS3.p6.3.m3.3.3.cmml">0.60</mn><mo id="S3.SS3.p6.3.m3.5.6.2.3" xref="S3.SS3.p6.3.m3.5.6.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS3.p6.3.m3.4.4" xref="S3.SS3.p6.3.m3.4.4.cmml">…</mi><mo id="S3.SS3.p6.3.m3.5.6.2.4" xref="S3.SS3.p6.3.m3.5.6.1.cmml">,</mo><mn id="S3.SS3.p6.3.m3.5.5" xref="S3.SS3.p6.3.m3.5.5.cmml">0.95</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.3.m3.5b"><list id="S3.SS3.p6.3.m3.5.6.1.cmml" xref="S3.SS3.p6.3.m3.5.6.2"><cn type="float" id="S3.SS3.p6.3.m3.1.1.cmml" xref="S3.SS3.p6.3.m3.1.1">0.50</cn><cn type="float" id="S3.SS3.p6.3.m3.2.2.cmml" xref="S3.SS3.p6.3.m3.2.2">0.55</cn><cn type="float" id="S3.SS3.p6.3.m3.3.3.cmml" xref="S3.SS3.p6.3.m3.3.3">0.60</cn><ci id="S3.SS3.p6.3.m3.4.4.cmml" xref="S3.SS3.p6.3.m3.4.4">…</ci><cn type="float" id="S3.SS3.p6.3.m3.5.5.cmml" xref="S3.SS3.p6.3.m3.5.5">0.95</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.3.m3.5c">0.50,0.55,0.60,\ldots,0.95</annotation></semantics></math>), which is the most strict metric in the COCO challenge (The mAP of the SOTA model in COCO dataset is 63.3). The mAR<sub id="S3.SS3.p6.4.3" class="ltx_sub"><span id="S3.SS3.p6.4.3.1" class="ltx_text ltx_font_italic">100</span></sub> means the average recall calculated when one hundred anchor boxes are given to the images. The End-to-End indicates whether the model does not require NMS and manual design anchors.</p>
</div>
<div id="S3.SS3.p7" class="ltx_para">
<p id="S3.SS3.p7.1" class="ltx_p">Besides, Figure <a href="#S3.F8" title="Figure 8 ‣ III-C Comparison with the State-of-the-Art ‣ III Experiments and Results ‣ Concealed Object Detection for Passive Millimeter-Wave Security Imaging Based on Task-Aligned Detection Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a> shows the performance curves of ours and other models. It can be seen that we are superior to other methods after the fifth epoch.</p>
</div>
<figure id="S3.F9" class="ltx_figure"><img src="/html/2212.00313/assets/x9.png" id="S3.F9.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="484" height="300" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>Visualization detection results of SOTA models and our proposed model.</figcaption>
</figure>
<figure id="S3.F10" class="ltx_figure"><img src="/html/2212.00313/assets/x10.png" id="S3.F10.g1" class="ltx_graphics ltx_centering ltx_img_square" width="242" height="202" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span>The mAP<sub id="S3.F10.4.1" class="ltx_sub"><span id="S3.F10.4.1.1" class="ltx_text ltx_font_italic">75</span></sub> comparison of PMMW-DETR and other models.</figcaption>
</figure>
<div id="S3.SS3.p8" class="ltx_para">
<p id="S3.SS3.p8.1" class="ltx_p"><span id="S3.SS3.p8.1.1" class="ltx_text ltx_font_bold">YOLOv3</span> is a widely used one-stage detector, which was already adopted for PMMW security screening <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>. It directly learns the bounding box, confidence, and category probability by regression. YOLOv3 has a fast detection speed and a low false detection rate because it can see global information. However, the detection accuracy of YOLOv3 is lower than other SOTA detectors, especially for small objects.
It can be seen that our method is +10.4% mAP higher than YOLOv3. We believe that the low detection rate is closely related to the fact that the original YOLOv3 model does not include multi-scale detection. Besides, YOLOv3 often requires more than two hundred epochs to converge, which is unacceptable on PMMW datasets. <span id="S3.SS3.p8.1.2" class="ltx_text ltx_font_bold">YOLOv8</span> is the latest SOTA model of the YOLO series. With the introduction of new technologies such as decoupling head and distribution focal loss, YOLOv8 achieves fair AP performance. Nevertheless, YOLOv8 have to trained with 500 epochs, even longer than YOLOv3.</p>
</div>
<div id="S3.SS3.p9" class="ltx_para">
<p id="S3.SS3.p9.1" class="ltx_p"><span id="S3.SS3.p9.1.1" class="ltx_text ltx_font_bold">SSD</span> is another widely used one-stage detector It introduces the pyramid feature hierarchy, that is, objects are predicted on the feature maps of different receptive fields, thus improving the detection accuracy of the network. However, as shown in Table <a href="#S3.T1" title="TABLE I ‣ III-C Comparison with the State-of-the-Art ‣ III Experiments and Results ‣ Concealed Object Detection for Passive Millimeter-Wave Security Imaging Based on Task-Aligned Detection Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a>, the <math id="S3.SS3.p9.1.m1.1" class="ltx_Math" alttext="mAP_{S}" display="inline"><semantics id="S3.SS3.p9.1.m1.1a"><mrow id="S3.SS3.p9.1.m1.1.1" xref="S3.SS3.p9.1.m1.1.1.cmml"><mi id="S3.SS3.p9.1.m1.1.1.2" xref="S3.SS3.p9.1.m1.1.1.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p9.1.m1.1.1.1" xref="S3.SS3.p9.1.m1.1.1.1.cmml">​</mo><mi id="S3.SS3.p9.1.m1.1.1.3" xref="S3.SS3.p9.1.m1.1.1.3.cmml">A</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p9.1.m1.1.1.1a" xref="S3.SS3.p9.1.m1.1.1.1.cmml">​</mo><msub id="S3.SS3.p9.1.m1.1.1.4" xref="S3.SS3.p9.1.m1.1.1.4.cmml"><mi id="S3.SS3.p9.1.m1.1.1.4.2" xref="S3.SS3.p9.1.m1.1.1.4.2.cmml">P</mi><mi id="S3.SS3.p9.1.m1.1.1.4.3" xref="S3.SS3.p9.1.m1.1.1.4.3.cmml">S</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p9.1.m1.1b"><apply id="S3.SS3.p9.1.m1.1.1.cmml" xref="S3.SS3.p9.1.m1.1.1"><times id="S3.SS3.p9.1.m1.1.1.1.cmml" xref="S3.SS3.p9.1.m1.1.1.1"></times><ci id="S3.SS3.p9.1.m1.1.1.2.cmml" xref="S3.SS3.p9.1.m1.1.1.2">𝑚</ci><ci id="S3.SS3.p9.1.m1.1.1.3.cmml" xref="S3.SS3.p9.1.m1.1.1.3">𝐴</ci><apply id="S3.SS3.p9.1.m1.1.1.4.cmml" xref="S3.SS3.p9.1.m1.1.1.4"><csymbol cd="ambiguous" id="S3.SS3.p9.1.m1.1.1.4.1.cmml" xref="S3.SS3.p9.1.m1.1.1.4">subscript</csymbol><ci id="S3.SS3.p9.1.m1.1.1.4.2.cmml" xref="S3.SS3.p9.1.m1.1.1.4.2">𝑃</ci><ci id="S3.SS3.p9.1.m1.1.1.4.3.cmml" xref="S3.SS3.p9.1.m1.1.1.4.3">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p9.1.m1.1c">mAP_{S}</annotation></semantics></math> of SSD for small objects is very low, only 31.4% (18.9% lower than our method). At the same time, there are missed detection and wrong classification as shown in Figure <a href="#S3.F9" title="Figure 9 ‣ III-C Comparison with the State-of-the-Art ‣ III Experiments and Results ‣ Concealed Object Detection for Passive Millimeter-Wave Security Imaging Based on Task-Aligned Detection Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>. As in the fifth figure, the confidence level of the metal knife is only 0.16, which will be a false negative object in practical applications.</p>
</div>
<div id="S3.SS3.p10" class="ltx_para">
<p id="S3.SS3.p10.1" class="ltx_p"><span id="S3.SS3.p10.1.1" class="ltx_text ltx_font_bold">Faster-RCNN</span> is a classic two-stage detection network. It introduces RPN to generate anchor points and nine proposal anchors around each point. After screening, the effective proposal anchor is sent to the classification and regression network. As we can see from the Table <a href="#S3.T1" title="TABLE I ‣ III-C Comparison with the State-of-the-Art ‣ III Experiments and Results ‣ Concealed Object Detection for Passive Millimeter-Wave Security Imaging Based on Task-Aligned Detection Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a>, our model is 36.1% higher in <math id="S3.SS3.p10.1.m1.1" class="ltx_Math" alttext="mAP_{75}" display="inline"><semantics id="S3.SS3.p10.1.m1.1a"><mrow id="S3.SS3.p10.1.m1.1.1" xref="S3.SS3.p10.1.m1.1.1.cmml"><mi id="S3.SS3.p10.1.m1.1.1.2" xref="S3.SS3.p10.1.m1.1.1.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p10.1.m1.1.1.1" xref="S3.SS3.p10.1.m1.1.1.1.cmml">​</mo><mi id="S3.SS3.p10.1.m1.1.1.3" xref="S3.SS3.p10.1.m1.1.1.3.cmml">A</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p10.1.m1.1.1.1a" xref="S3.SS3.p10.1.m1.1.1.1.cmml">​</mo><msub id="S3.SS3.p10.1.m1.1.1.4" xref="S3.SS3.p10.1.m1.1.1.4.cmml"><mi id="S3.SS3.p10.1.m1.1.1.4.2" xref="S3.SS3.p10.1.m1.1.1.4.2.cmml">P</mi><mn id="S3.SS3.p10.1.m1.1.1.4.3" xref="S3.SS3.p10.1.m1.1.1.4.3.cmml">75</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p10.1.m1.1b"><apply id="S3.SS3.p10.1.m1.1.1.cmml" xref="S3.SS3.p10.1.m1.1.1"><times id="S3.SS3.p10.1.m1.1.1.1.cmml" xref="S3.SS3.p10.1.m1.1.1.1"></times><ci id="S3.SS3.p10.1.m1.1.1.2.cmml" xref="S3.SS3.p10.1.m1.1.1.2">𝑚</ci><ci id="S3.SS3.p10.1.m1.1.1.3.cmml" xref="S3.SS3.p10.1.m1.1.1.3">𝐴</ci><apply id="S3.SS3.p10.1.m1.1.1.4.cmml" xref="S3.SS3.p10.1.m1.1.1.4"><csymbol cd="ambiguous" id="S3.SS3.p10.1.m1.1.1.4.1.cmml" xref="S3.SS3.p10.1.m1.1.1.4">subscript</csymbol><ci id="S3.SS3.p10.1.m1.1.1.4.2.cmml" xref="S3.SS3.p10.1.m1.1.1.4.2">𝑃</ci><cn type="integer" id="S3.SS3.p10.1.m1.1.1.4.3.cmml" xref="S3.SS3.p10.1.m1.1.1.4.3">75</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p10.1.m1.1c">mAP_{75}</annotation></semantics></math> and 19.4% higher in AR than Faster-RCNN. It can be seen from Figure <a href="#S3.F9" title="Figure 9 ‣ III-C Comparison with the State-of-the-Art ‣ III Experiments and Results ‣ Concealed Object Detection for Passive Millimeter-Wave Security Imaging Based on Task-Aligned Detection Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a> that Faster-RCNN has fewer boxes with higher confidence and thus is easier to miss objects.</p>
</div>
<div id="S3.SS3.p11" class="ltx_para">
<p id="S3.SS3.p11.1" class="ltx_p">The above methods need manually designed anchors as prior information for the network. On the contrary, <span id="S3.SS3.p11.1.1" class="ltx_text ltx_font_bold">FCOS</span> is a famous anchor-free detector. It treats object detection as a regression of the distance between each position on the feature map and the bounding box. <span id="S3.SS3.p11.1.2" class="ltx_text ltx_font_bold">FCOS</span> avoids all the super parameters related to the proposal anchor, so saves the memory occupation and improves the calculation efficiency. <span id="S3.SS3.p11.1.3" class="ltx_text ltx_font_bold">ATSS</span> reveals the essential difference between anchor-free and anchor-based methods, that is, the selection of positive and negative samples, then it proposed a more reasonable sample selection strategy. FCOS and ATSS have implemented Anchor-Free by a similar approach, making them face similar problems. As shown in Figure <a href="#S3.F9" title="Figure 9 ‣ III-C Comparison with the State-of-the-Art ‣ III Experiments and Results ‣ Concealed Object Detection for Passive Millimeter-Wave Security Imaging Based on Task-Aligned Detection Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>, we show as many anchor boxes as possible to ensure that the experimental conclusions are complete. It can be seen that FCOS and ATSS do not perform well in regression anchor boxes, both of which failed to enclose the metal pistol in all of their anchor boxes, and many anchor boxes have low confidence. Meanwhile, in the ATSS detection results, there is a confusion between the gaps and the object resulting in false alarms as we mentioned in Section <a href="#S3.SS2" title="III-B Security Dataset and Implementation Details ‣ III Experiments and Results ‣ Concealed Object Detection for Passive Millimeter-Wave Security Imaging Based on Task-Aligned Detection Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">III-B</span></span></a>.</p>
</div>
<div id="S3.SS3.p12" class="ltx_para">
<p id="S3.SS3.p12.1" class="ltx_p"><span id="S3.SS3.p12.1.1" class="ltx_text ltx_font_bold">PVT</span> is a famous Transformer-based backbone, which combines the advantages of CNNs and Transformers. It introduces a step-by-step contraction pyramid to obtain multi-scale output similar to CNN. Meanwhile, thanks to the self-attention mechanism in Transformer, PVT maintains the global receptive field at different scales. <span id="S3.SS3.p12.1.2" class="ltx_text ltx_font_bold">Dyhead</span> is a novel detection head with the attention mechanism. It combines multiple self-attention mechanisms between feature levels, spatial locations, and output channels, and thus significantly improves the representation ability of object detection heads without the heavy computational overhead. Introducing the attention mechanism makes the results of PVT and Dyhead very competitive, being only 7.3% and 7.1% lower than ours in mAP, respectively. However, as shown in Figure <a href="#S3.F9" title="Figure 9 ‣ III-C Comparison with the State-of-the-Art ‣ III Experiments and Results ‣ Concealed Object Detection for Passive Millimeter-Wave Security Imaging Based on Task-Aligned Detection Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>, since the attention mechanism of PVT and Dyhead was carried out on a single head, they had some wrong classification in the detection results. And the performance comparison of all these models is visualized in Figure <a href="#S3.F10" title="Figure 10 ‣ III-C Comparison with the State-of-the-Art ‣ III Experiments and Results ‣ Concealed Object Detection for Passive Millimeter-Wave Security Imaging Based on Task-Aligned Detection Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>.</p>
</div>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS4.5.1.1" class="ltx_text">III-D</span> </span><span id="S3.SS4.6.2" class="ltx_text ltx_font_italic">Ablation Study</span>
</h3>

<div id="S3.SS4.p1" class="ltx_para">
<p id="S3.SS4.p1.1" class="ltx_p">In this section, we conduct a series of ablation studies to evaluate the contribution of the proposed modules. In the Tables <a href="#S3.T2" title="TABLE II ‣ III-D Ablation Study ‣ III Experiments and Results ‣ Concealed Object Detection for Passive Millimeter-Wave Security Imaging Based on Task-Aligned Detection Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a><math id="S3.SS4.p1.1.m1.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S3.SS4.p1.1.m1.1a"><mo id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.1b"><csymbol cd="latexml" id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.1c">\sim</annotation></semantics></math><a href="#S3.T3" title="TABLE III ‣ III-D Ablation Study ‣ III Experiments and Results ‣ Concealed Object Detection for Passive Millimeter-Wave Security Imaging Based on Task-Aligned Detection Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">III</span></a>, we use the terms ”QSE”, ”QSH”, ”DAM”, ”DAB”, and ”DN” to denote ”Query Selection”, ”Query Sharing”, ”Deformable Attention Module”, ”Dynamic Anchor Boxes”, and ”DeNoising learning”, and the ”R50”, ”Swin-T”, and ”DCFT” to denote ”Resnet-50”, ”Swin Transformer-Tiny”, ”Denoising Coarse-to-Fine Transformer”, respectively.</p>
</div>
<figure id="S3.T2" class="ltx_table">

<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE II: </span><span id="S3.T2.7.1" class="ltx_text ltx_font_bold">Ablation study of the proposed algorithm components. </span></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<table id="S3.T2.5" class="ltx_tabular ltx_centering ltx_figure_panel ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T2.5.5" class="ltx_tr">
<th id="S3.T2.5.5.6" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" style="padding:1pt 5.7pt;">#Row</th>
<th id="S3.T2.5.5.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding:1pt 5.7pt;">QSH</th>
<th id="S3.T2.5.5.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding:1pt 5.7pt;">QSE</th>
<th id="S3.T2.5.5.9" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding:1pt 5.7pt;">Backbone</th>
<th id="S3.T2.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding:1pt 5.7pt;">AP<sub id="S3.T2.1.1.1.1" class="ltx_sub"><span id="S3.T2.1.1.1.1.1" class="ltx_text ltx_font_italic">50</span></sub>
</th>
<th id="S3.T2.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding:1pt 5.7pt;">AP<sub id="S3.T2.2.2.2.1" class="ltx_sub"><span id="S3.T2.2.2.2.1.1" class="ltx_text ltx_font_italic">75</span></sub>
</th>
<th id="S3.T2.5.5.10" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding:1pt 5.7pt;">AP</th>
<th id="S3.T2.3.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding:1pt 5.7pt;">AP<sub id="S3.T2.3.3.3.1" class="ltx_sub"><span id="S3.T2.3.3.3.1.1" class="ltx_text ltx_font_italic">S</span></sub>
</th>
<th id="S3.T2.4.4.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding:1pt 5.7pt;">AP<sub id="S3.T2.4.4.4.1" class="ltx_sub"><span id="S3.T2.4.4.4.1.1" class="ltx_text ltx_font_italic">M</span></sub>
</th>
<th id="S3.T2.5.5.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding:1pt 5.7pt;">AR<sub id="S3.T2.5.5.5.1" class="ltx_sub"><span id="S3.T2.5.5.5.1.1" class="ltx_text ltx_font_italic">100</span></sub>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T2.5.6.1" class="ltx_tr">
<th id="S3.T2.5.6.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding:1pt 5.7pt;">1. DETR(baseline)</th>
<td id="S3.T2.5.6.1.2" class="ltx_td ltx_border_t" style="padding:1pt 5.7pt;"></td>
<td id="S3.T2.5.6.1.3" class="ltx_td ltx_border_t" style="padding:1pt 5.7pt;"></td>
<td id="S3.T2.5.6.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding:1pt 5.7pt;">R50</td>
<td id="S3.T2.5.6.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding:1pt 5.7pt;">92.9</td>
<td id="S3.T2.5.6.1.6" class="ltx_td ltx_align_center ltx_border_t" style="padding:1pt 5.7pt;">63.6</td>
<td id="S3.T2.5.6.1.7" class="ltx_td ltx_align_center ltx_border_t" style="padding:1pt 5.7pt;">49.1</td>
<td id="S3.T2.5.6.1.8" class="ltx_td ltx_align_center ltx_border_t" style="padding:1pt 5.7pt;">45.7</td>
<td id="S3.T2.5.6.1.9" class="ltx_td ltx_align_center ltx_border_t" style="padding:1pt 5.7pt;">54.7</td>
<td id="S3.T2.5.6.1.10" class="ltx_td ltx_align_center ltx_border_t" style="padding:1pt 5.7pt;">56.1</td>
</tr>
<tr id="S3.T2.5.7.2" class="ltx_tr">
<th id="S3.T2.5.7.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding:1pt 5.7pt;">2. Strong baseline<sup id="S3.T2.5.7.2.1.1" class="ltx_sup">1</sup>
</th>
<td id="S3.T2.5.7.2.2" class="ltx_td" style="padding:1pt 5.7pt;"></td>
<td id="S3.T2.5.7.2.3" class="ltx_td" style="padding:1pt 5.7pt;"></td>
<td id="S3.T2.5.7.2.4" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">R50</td>
<td id="S3.T2.5.7.2.5" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">95.8</td>
<td id="S3.T2.5.7.2.6" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">72.4</td>
<td id="S3.T2.5.7.2.7" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">58.0</td>
<td id="S3.T2.5.7.2.8" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">56.9</td>
<td id="S3.T2.5.7.2.9" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">63.8</td>
<td id="S3.T2.5.7.2.10" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">63.1</td>
</tr>
<tr id="S3.T2.5.8.3" class="ltx_tr">
<th id="S3.T2.5.8.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding:1pt 5.7pt;">3. PMMW-DETR</th>
<td id="S3.T2.5.8.3.2" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">✓</td>
<td id="S3.T2.5.8.3.3" class="ltx_td" style="padding:1pt 5.7pt;"></td>
<td id="S3.T2.5.8.3.4" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">R50</td>
<td id="S3.T2.5.8.3.5" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">97.0</td>
<td id="S3.T2.5.8.3.6" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">86.8</td>
<td id="S3.T2.5.8.3.7" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">65.7</td>
<td id="S3.T2.5.8.3.8" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">42.5</td>
<td id="S3.T2.5.8.3.9" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">67.4</td>
<td id="S3.T2.5.8.3.10" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">71.9</td>
</tr>
<tr id="S3.T2.5.9.4" class="ltx_tr">
<th id="S3.T2.5.9.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding:1pt 5.7pt;">4. PMMW-DETR</th>
<td id="S3.T2.5.9.4.2" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">✓</td>
<td id="S3.T2.5.9.4.3" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">✓</td>
<td id="S3.T2.5.9.4.4" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">R50</td>
<td id="S3.T2.5.9.4.5" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">97.1</td>
<td id="S3.T2.5.9.4.6" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">89.3</td>
<td id="S3.T2.5.9.4.7" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">68.7</td>
<td id="S3.T2.5.9.4.8" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">44.4</td>
<td id="S3.T2.5.9.4.9" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">70.5</td>
<td id="S3.T2.5.9.4.10" class="ltx_td ltx_align_center" style="padding:1pt 5.7pt;">77.1</td>
</tr>
<tr id="S3.T2.5.10.5" class="ltx_tr">
<th id="S3.T2.5.10.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="padding:1pt 5.7pt;">5. PMMW-DETR(Ours)</th>
<td id="S3.T2.5.10.5.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding:1pt 5.7pt;">✓</td>
<td id="S3.T2.5.10.5.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding:1pt 5.7pt;">✓</td>
<td id="S3.T2.5.10.5.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding:1pt 5.7pt;">DCFT</td>
<td id="S3.T2.5.10.5.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding:1pt 5.7pt;"><span id="S3.T2.5.10.5.5.1" class="ltx_text ltx_font_bold">97.5</span></td>
<td id="S3.T2.5.10.5.6" class="ltx_td ltx_align_center ltx_border_bb" style="padding:1pt 5.7pt;"><span id="S3.T2.5.10.5.6.1" class="ltx_text ltx_font_bold">91.8</span></td>
<td id="S3.T2.5.10.5.7" class="ltx_td ltx_align_center ltx_border_bb" style="padding:1pt 5.7pt;"><span id="S3.T2.5.10.5.7.1" class="ltx_text ltx_font_bold">71.3</span></td>
<td id="S3.T2.5.10.5.8" class="ltx_td ltx_align_center ltx_border_bb" style="padding:1pt 5.7pt;"><span id="S3.T2.5.10.5.8.1" class="ltx_text ltx_font_bold">49.1</span></td>
<td id="S3.T2.5.10.5.9" class="ltx_td ltx_align_center ltx_border_bb" style="padding:1pt 5.7pt;"><span id="S3.T2.5.10.5.9.1" class="ltx_text ltx_font_bold">74.1</span></td>
<td id="S3.T2.5.10.5.10" class="ltx_td ltx_align_center ltx_border_bb" style="padding:1pt 5.7pt;"><span id="S3.T2.5.10.5.10.1" class="ltx_text ltx_font_bold">80.4</span></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<ul id="S3.I1" class="ltx_itemize ltx_centering ltx_figure_panel">
<li id="S3.I1.ix1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1</span> 
<div id="S3.I1.ix1.p1" class="ltx_para">
<p id="S3.I1.ix1.p1.1" class="ltx_p"><span id="S3.I1.ix1.p1.1.1" class="ltx_text" style="font-size:80%;">The strong baseline is built on DETR with modules of DAM, DAB, and DN.</span></p>
</div>
</li>
</ul>
</div>
</div>
</figure>
<figure id="S3.F11" class="ltx_figure"><img src="/html/2212.00313/assets/x11.png" id="S3.F11.g1" class="ltx_graphics ltx_centering ltx_img_square" width="260" height="233" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 11: </span>The mAP<sub id="S3.F11.7.1" class="ltx_sub"><span id="S3.F11.7.1.1" class="ltx_text ltx_font_italic">75</span></sub> (a) and mAR<sub id="S3.F11.8.2" class="ltx_sub"><span id="S3.F11.8.2.1" class="ltx_text ltx_font_italic">100</span></sub> (b) curves for each component of PMMW-DETR.</figcaption>
</figure>
<div id="S3.SS4.p2" class="ltx_para">
<p id="S3.SS4.p2.1" class="ltx_p">We use the DETR as the baseline, and build a strong baseline with modules of DAM, DAB, and DN. Then we add QSE, QSH, and DCFT to the strong baseline in proper order to verify the performance of our proposed modules. The results are available in Table <a href="#S3.T2" title="TABLE II ‣ III-D Ablation Study ‣ III Experiments and Results ‣ Concealed Object Detection for Passive Millimeter-Wave Security Imaging Based on Task-Aligned Detection Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a> Rows 3<math id="S3.SS4.p2.1.m1.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S3.SS4.p2.1.m1.1a"><mo id="S3.SS4.p2.1.m1.1.1" xref="S3.SS4.p2.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.1.m1.1b"><csymbol cd="latexml" id="S3.SS4.p2.1.m1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.1.m1.1c">\sim</annotation></semantics></math>5. In addition, Figure <a href="#S3.F11" title="Figure 11 ‣ III-D Ablation Study ‣ III Experiments and Results ‣ Concealed Object Detection for Passive Millimeter-Wave Security Imaging Based on Task-Aligned Detection Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a> shows the performance curves of each component. We can see that QSE, QSH, and DCFT modules improve performance significantly.</p>
</div>
<figure id="S3.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE III: </span><span id="S3.T3.7.1" class="ltx_text ltx_font_bold">Comparison between different query initialization methods. </span></figcaption>
<table id="S3.T3.5" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T3.5.5" class="ltx_tr">
<th id="S3.T3.5.5.6" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" style="padding:1pt 4.3pt;">Method</th>
<th id="S3.T3.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding:1pt 4.3pt;">AP<sub id="S3.T3.1.1.1.1" class="ltx_sub"><span id="S3.T3.1.1.1.1.1" class="ltx_text ltx_font_italic">50</span></sub>
</th>
<th id="S3.T3.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding:1pt 4.3pt;">AP<sub id="S3.T3.2.2.2.1" class="ltx_sub"><span id="S3.T3.2.2.2.1.1" class="ltx_text ltx_font_italic">75</span></sub>
</th>
<th id="S3.T3.5.5.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding:1pt 4.3pt;">AP</th>
<th id="S3.T3.3.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding:1pt 4.3pt;">AP<sub id="S3.T3.3.3.3.1" class="ltx_sub"><span id="S3.T3.3.3.3.1.1" class="ltx_text ltx_font_italic">S</span></sub>
</th>
<th id="S3.T3.4.4.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding:1pt 4.3pt;">AP<sub id="S3.T3.4.4.4.1" class="ltx_sub"><span id="S3.T3.4.4.4.1.1" class="ltx_text ltx_font_italic">M</span></sub>
</th>
<th id="S3.T3.5.5.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding:1pt 4.3pt;">AR<sub id="S3.T3.5.5.5.1" class="ltx_sub"><span id="S3.T3.5.5.5.1.1" class="ltx_text ltx_font_italic">100</span></sub>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T3.5.6.1" class="ltx_tr">
<th id="S3.T3.5.6.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding:1pt 4.3pt;">Static</th>
<td id="S3.T3.5.6.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding:1pt 4.3pt;">97.0</td>
<td id="S3.T3.5.6.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding:1pt 4.3pt;">86.8</td>
<td id="S3.T3.5.6.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding:1pt 4.3pt;">65.7</td>
<td id="S3.T3.5.6.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding:1pt 4.3pt;">42.5</td>
<td id="S3.T3.5.6.1.6" class="ltx_td ltx_align_center ltx_border_t" style="padding:1pt 4.3pt;">67.4</td>
<td id="S3.T3.5.6.1.7" class="ltx_td ltx_align_center ltx_border_t" style="padding:1pt 4.3pt;">71.9</td>
</tr>
<tr id="S3.T3.5.7.2" class="ltx_tr">
<th id="S3.T3.5.7.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding:1pt 4.3pt;">Dynamic</th>
<td id="S3.T3.5.7.2.2" class="ltx_td ltx_align_center" style="padding:1pt 4.3pt;">97.1</td>
<td id="S3.T3.5.7.2.3" class="ltx_td ltx_align_center" style="padding:1pt 4.3pt;">88.3</td>
<td id="S3.T3.5.7.2.4" class="ltx_td ltx_align_center" style="padding:1pt 4.3pt;">67.9</td>
<td id="S3.T3.5.7.2.5" class="ltx_td ltx_align_center" style="padding:1pt 4.3pt;">43.1</td>
<td id="S3.T3.5.7.2.6" class="ltx_td ltx_align_center" style="padding:1pt 4.3pt;">68.9</td>
<td id="S3.T3.5.7.2.7" class="ltx_td ltx_align_center" style="padding:1pt 4.3pt;">75.8</td>
</tr>
<tr id="S3.T3.5.8.3" class="ltx_tr">
<th id="S3.T3.5.8.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="padding:1pt 4.3pt;">QSE</th>
<td id="S3.T3.5.8.3.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding:1pt 4.3pt;"><span id="S3.T3.5.8.3.2.1" class="ltx_text ltx_font_bold">97.1</span></td>
<td id="S3.T3.5.8.3.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding:1pt 4.3pt;"><span id="S3.T3.5.8.3.3.1" class="ltx_text ltx_font_bold">89.3</span></td>
<td id="S3.T3.5.8.3.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding:1pt 4.3pt;"><span id="S3.T3.5.8.3.4.1" class="ltx_text ltx_font_bold">68.7</span></td>
<td id="S3.T3.5.8.3.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding:1pt 4.3pt;"><span id="S3.T3.5.8.3.5.1" class="ltx_text ltx_font_bold">44.4</span></td>
<td id="S3.T3.5.8.3.6" class="ltx_td ltx_align_center ltx_border_bb" style="padding:1pt 4.3pt;"><span id="S3.T3.5.8.3.6.1" class="ltx_text ltx_font_bold">70.5</span></td>
<td id="S3.T3.5.8.3.7" class="ltx_td ltx_align_center ltx_border_bb" style="padding:1pt 4.3pt;"><span id="S3.T3.5.8.3.7.1" class="ltx_text ltx_font_bold">77.1</span></td>
</tr>
</tbody>
</table>
</figure>
<div id="S3.SS4.p3" class="ltx_para">
<p id="S3.SS4.p3.1" class="ltx_p">To verify the effectiveness of query selection and the impact of dynamic initialization, using static initialization as a baseline, we compare the performance of dynamic initialization and query selection. As can be seen from the Table <a href="#S3.T3" title="TABLE III ‣ III-D Ablation Study ‣ III Experiments and Results ‣ Concealed Object Detection for Passive Millimeter-Wave Security Imaging Based on Task-Aligned Detection Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">III</span></a>, we can find our query selection method outperforms other methods. The dynamic initialization method indeed limits the performance of the network to a certain extent.</p>
</div>
<figure id="S3.T4" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE IV: </span><span id="S3.T4.7.1" class="ltx_text ltx_font_bold">Comparison between different backbones. </span></figcaption>
<table id="S3.T4.5" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T4.5.5" class="ltx_tr">
<th id="S3.T4.5.5.6" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" style="padding:1pt 2.8pt;">backbone</th>
<th id="S3.T4.5.5.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding:1pt 2.8pt;">#Params(M)</th>
<th id="S3.T4.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding:1pt 2.8pt;">AP<sub id="S3.T4.1.1.1.1" class="ltx_sub"><span id="S3.T4.1.1.1.1.1" class="ltx_text ltx_font_italic">50</span></sub>
</th>
<th id="S3.T4.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding:1pt 2.8pt;">AP<sub id="S3.T4.2.2.2.1" class="ltx_sub"><span id="S3.T4.2.2.2.1.1" class="ltx_text ltx_font_italic">75</span></sub>
</th>
<th id="S3.T4.5.5.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding:1pt 2.8pt;">AP</th>
<th id="S3.T4.3.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding:1pt 2.8pt;">AP<sub id="S3.T4.3.3.3.1" class="ltx_sub"><span id="S3.T4.3.3.3.1.1" class="ltx_text ltx_font_italic">S</span></sub>
</th>
<th id="S3.T4.4.4.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding:1pt 2.8pt;">AP<sub id="S3.T4.4.4.4.1" class="ltx_sub"><span id="S3.T4.4.4.4.1.1" class="ltx_text ltx_font_italic">M</span></sub>
</th>
<th id="S3.T4.5.5.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding:1pt 2.8pt;">AR<sub id="S3.T4.5.5.5.1" class="ltx_sub"><span id="S3.T4.5.5.5.1.1" class="ltx_text ltx_font_italic">100</span></sub>
</th>
<th id="S3.T4.5.5.9" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding:1pt 2.8pt;">FPS</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T4.5.6.1" class="ltx_tr">
<td id="S3.T4.5.6.1.1" class="ltx_td ltx_align_left ltx_border_t" style="padding:1pt 2.8pt;">R50</td>
<td id="S3.T4.5.6.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding:1pt 2.8pt;">37.7</td>
<td id="S3.T4.5.6.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding:1pt 2.8pt;">95.8</td>
<td id="S3.T4.5.6.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding:1pt 2.8pt;">72.4</td>
<td id="S3.T4.5.6.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding:1pt 2.8pt;">58.0</td>
<td id="S3.T4.5.6.1.6" class="ltx_td ltx_align_center ltx_border_t" style="padding:1pt 2.8pt;">56.9</td>
<td id="S3.T4.5.6.1.7" class="ltx_td ltx_align_center ltx_border_t" style="padding:1pt 2.8pt;">63.8</td>
<td id="S3.T4.5.6.1.8" class="ltx_td ltx_align_center ltx_border_t" style="padding:1pt 2.8pt;">63.1</td>
<td id="S3.T4.5.6.1.9" class="ltx_td ltx_align_center ltx_border_t" style="padding:1pt 2.8pt;">30</td>
</tr>
<tr id="S3.T4.5.7.2" class="ltx_tr">
<td id="S3.T4.5.7.2.1" class="ltx_td ltx_align_left" style="padding:1pt 2.8pt;">PVT</td>
<td id="S3.T4.5.7.2.2" class="ltx_td ltx_align_center" style="padding:1pt 2.8pt;">34.2</td>
<td id="S3.T4.5.7.2.3" class="ltx_td ltx_align_center" style="padding:1pt 2.8pt;">96.1</td>
<td id="S3.T4.5.7.2.4" class="ltx_td ltx_align_center" style="padding:1pt 2.8pt;">80.4</td>
<td id="S3.T4.5.7.2.5" class="ltx_td ltx_align_center" style="padding:1pt 2.8pt;">64.0</td>
<td id="S3.T4.5.7.2.6" class="ltx_td ltx_align_center" style="padding:1pt 2.8pt;">39.8</td>
<td id="S3.T4.5.7.2.7" class="ltx_td ltx_align_center" style="padding:1pt 2.8pt;">65.3</td>
<td id="S3.T4.5.7.2.8" class="ltx_td ltx_align_center" style="padding:1pt 2.8pt;">69.1</td>
<td id="S3.T4.5.7.2.9" class="ltx_td ltx_align_center" style="padding:1pt 2.8pt;">26</td>
</tr>
<tr id="S3.T4.5.8.3" class="ltx_tr">
<td id="S3.T4.5.8.3.1" class="ltx_td ltx_align_left" style="padding:1pt 2.8pt;">Swin-T</td>
<td id="S3.T4.5.8.3.2" class="ltx_td ltx_align_center" style="padding:1pt 2.8pt;">38.5</td>
<td id="S3.T4.5.8.3.3" class="ltx_td ltx_align_center" style="padding:1pt 2.8pt;">97.4</td>
<td id="S3.T4.5.8.3.4" class="ltx_td ltx_align_center" style="padding:1pt 2.8pt;">87.1</td>
<td id="S3.T4.5.8.3.5" class="ltx_td ltx_align_center" style="padding:1pt 2.8pt;">68.7</td>
<td id="S3.T4.5.8.3.6" class="ltx_td ltx_align_center" style="padding:1pt 2.8pt;">43.9</td>
<td id="S3.T4.5.8.3.7" class="ltx_td ltx_align_center" style="padding:1pt 2.8pt;">70.4</td>
<td id="S3.T4.5.8.3.8" class="ltx_td ltx_align_center" style="padding:1pt 2.8pt;">75.5</td>
<td id="S3.T4.5.8.3.9" class="ltx_td ltx_align_center" style="padding:1pt 2.8pt;">20</td>
</tr>
<tr id="S3.T4.5.9.4" class="ltx_tr">
<td id="S3.T4.5.9.4.1" class="ltx_td ltx_align_left ltx_border_bb" style="padding:1pt 2.8pt;">DCFT</td>
<td id="S3.T4.5.9.4.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding:1pt 2.8pt;">39.4</td>
<td id="S3.T4.5.9.4.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding:1pt 2.8pt;"><span id="S3.T4.5.9.4.3.1" class="ltx_text ltx_font_bold">97.5</span></td>
<td id="S3.T4.5.9.4.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding:1pt 2.8pt;"><span id="S3.T4.5.9.4.4.1" class="ltx_text ltx_font_bold">91.8</span></td>
<td id="S3.T4.5.9.4.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding:1pt 2.8pt;"><span id="S3.T4.5.9.4.5.1" class="ltx_text ltx_font_bold">71.3</span></td>
<td id="S3.T4.5.9.4.6" class="ltx_td ltx_align_center ltx_border_bb" style="padding:1pt 2.8pt;"><span id="S3.T4.5.9.4.6.1" class="ltx_text ltx_font_bold">49.1</span></td>
<td id="S3.T4.5.9.4.7" class="ltx_td ltx_align_center ltx_border_bb" style="padding:1pt 2.8pt;"><span id="S3.T4.5.9.4.7.1" class="ltx_text ltx_font_bold">74.1</span></td>
<td id="S3.T4.5.9.4.8" class="ltx_td ltx_align_center ltx_border_bb" style="padding:1pt 2.8pt;"><span id="S3.T4.5.9.4.8.1" class="ltx_text ltx_font_bold">80.4</span></td>
<td id="S3.T4.5.9.4.9" class="ltx_td ltx_align_center ltx_border_bb" style="padding:1pt 2.8pt;">24</td>
</tr>
</tbody>
</table>
</figure>
<div id="S3.SS4.p4" class="ltx_para">
<p id="S3.SS4.p4.2" class="ltx_p">On the basis of Table <a href="#S3.T2" title="TABLE II ‣ III-D Ablation Study ‣ III Experiments and Results ‣ Concealed Object Detection for Passive Millimeter-Wave Security Imaging Based on Task-Aligned Detection Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a> Row 7, we replaced the DCFT with different backbones and compared their performance, and the results are shown in Table <a href="#S3.T4" title="TABLE IV ‣ III-D Ablation Study ‣ III Experiments and Results ‣ Concealed Object Detection for Passive Millimeter-Wave Security Imaging Based on Task-Aligned Detection Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">IV</span></a>. The parameters and FPS are calculated using the same network (RetinaNet). Since the multi-scale calculation is introduced in the backbone, the parameters of our proposed DCFT are slightly higher. However, our model outperforms mAP and mAR, which is important for security. And as we mentioned in Section <a href="#S2.SS2" title="II-B Denoising Coarse-to-Fine Transformer (DCFT) Attention-Based Backbone ‣ II Proposed Method ‣ Concealed Object Detection for Passive Millimeter-Wave Security Imaging Based on Task-Aligned Detection Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">II-B</span></span></a> the computational complexity of our model is lower than Swin Transformer, which leads to our FPS being higher than Swin-T. Due to the excessive computation of full map attention, it can only perform the image classification task that is less computational overhead but cannot complete the object detection task. Therefore, we added the PVT in the SOTA model to compare. The AP of R50 is poor because of the lack of global information. Similar to R50, PVT loses more long- and short-range information in the cascading reduction process, which results in the lower AP of PVT. Swin-T achieved competitive results with its compact design. However, its diminished distance to information resulted in 4.7% lower in mAP<sub id="S3.SS4.p4.2.1" class="ltx_sub"><span id="S3.SS4.p4.2.1.1" class="ltx_text ltx_font_italic">75</span></sub> and 4.9% lower in mAR<sub id="S3.SS4.p4.2.2" class="ltx_sub"><span id="S3.SS4.p4.2.2.1" class="ltx_text ltx_font_italic">100</span></sub> than ours.</p>
</div>
</section>
<section id="S3.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS5.5.1.1" class="ltx_text">III-E</span> </span><span id="S3.SS5.6.2" class="ltx_text ltx_font_italic">hyperparameters setting for SOTA models</span>
</h3>

<div id="S3.SS5.p1" class="ltx_para">
<p id="S3.SS5.p1.1" class="ltx_p">In order to explore the relationship between the training hyperparameter settings of PMMW concealed object detection and optical image detection, we organized some comparative experiments represented by ATSS in this section.</p>
</div>
<figure id="S3.T5" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE V: </span><span id="S3.T5.6.1" class="ltx_text ltx_font_bold">Comparison between different hyperparameters settings. </span></figcaption>
<table id="S3.T5.4" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T5.3.3" class="ltx_tr">
<th id="S3.T5.3.3.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" style="padding:1pt 2.8pt;">Learning rate</th>
<th id="S3.T5.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding:1pt 2.8pt;" colspan="2">10<sup id="S3.T5.1.1.1.1" class="ltx_sup"><span id="S3.T5.1.1.1.1.1" class="ltx_text ltx_font_italic">-1</span></sup>
</th>
<th id="S3.T5.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding:1pt 2.8pt;" colspan="3">10<sup id="S3.T5.2.2.2.1" class="ltx_sup"><span id="S3.T5.2.2.2.1.1" class="ltx_text ltx_font_italic">-2</span></sup>
</th>
<th id="S3.T5.3.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding:1pt 2.8pt;" colspan="3">10<sup id="S3.T5.3.3.3.1" class="ltx_sup"><span id="S3.T5.3.3.3.1.1" class="ltx_text ltx_font_italic">-3</span></sup>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T5.4.5.1" class="ltx_tr">
<th id="S3.T5.4.5.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding:1pt 2.8pt;">Momentum</th>
<td id="S3.T5.4.5.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding:1pt 2.8pt;">0.9</td>
<td id="S3.T5.4.5.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding:1pt 2.8pt;">0.5</td>
<td id="S3.T5.4.5.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding:1pt 2.8pt;">0.99</td>
<td id="S3.T5.4.5.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding:1pt 2.8pt;">0.9</td>
<td id="S3.T5.4.5.1.6" class="ltx_td ltx_align_center ltx_border_t" style="padding:1pt 2.8pt;">0.5</td>
<td id="S3.T5.4.5.1.7" class="ltx_td ltx_align_center ltx_border_t" style="padding:1pt 2.8pt;">0.99</td>
<td id="S3.T5.4.5.1.8" class="ltx_td ltx_align_center ltx_border_t" style="padding:1pt 2.8pt;">0.9</td>
<td id="S3.T5.4.5.1.9" class="ltx_td ltx_align_center ltx_border_t" style="padding:1pt 2.8pt;">0.5</td>
</tr>
<tr id="S3.T5.4.4" class="ltx_tr">
<th id="S3.T5.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" style="padding:1pt 2.8pt;">AP<sub id="S3.T5.4.4.1.1" class="ltx_sub"><span id="S3.T5.4.4.1.1.1" class="ltx_text ltx_font_italic">75</span></sub>
</th>
<td id="S3.T5.4.4.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding:1pt 2.8pt;">NaN</td>
<td id="S3.T5.4.4.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding:1pt 2.8pt;">55.4</td>
<td id="S3.T5.4.4.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding:1pt 2.8pt;">NaN</td>
<td id="S3.T5.4.4.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding:1pt 2.8pt;"><span id="S3.T5.4.4.5.1" class="ltx_text ltx_font_bold">74.1</span></td>
<td id="S3.T5.4.4.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding:1pt 2.8pt;">47.6</td>
<td id="S3.T5.4.4.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding:1pt 2.8pt;">55.1</td>
<td id="S3.T5.4.4.8" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding:1pt 2.8pt;">64.4</td>
<td id="S3.T5.4.4.9" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding:1pt 2.8pt;">57.3</td>
</tr>
</tbody>
</table>
</figure>
<div id="S3.SS5.p2" class="ltx_para">
<p id="S3.SS5.p2.4" class="ltx_p">We initially follow the setting of the original paper and mmdetection. We first tested the combined influence of Learning rate and Momentum on AP<sub id="S3.SS5.p2.4.1" class="ltx_sub"><span id="S3.SS5.p2.4.1.1" class="ltx_text ltx_font_italic">75</span></sub>, the initial setting of Learning rate and Momentum is 10<sup id="S3.SS5.p2.4.2" class="ltx_sup"><span id="S3.SS5.p2.4.2.1" class="ltx_text ltx_font_italic">-2</span></sup> and 0.9. Momentum is set to 0.5, 0.9, and 0.99, which represent 2 times, 10 times, and 100 times the maximum speed of the original gradient descent, respectively. We take the example data from ATSS, the other models tend to be similar. And as shown in Table <a href="#S3.T5" title="TABLE V ‣ III-E hyperparameters setting for SOTA models ‣ III Experiments and Results ‣ Concealed Object Detection for Passive Millimeter-Wave Security Imaging Based on Task-Aligned Detection Transformer" class="ltx_ref"><span class="ltx_text ltx_ref_tag">V</span></a>, we found that most of the original settings were consistent with the optimal results of the grid search. When we increase the learning rate to 10<sup id="S3.SS5.p2.4.3" class="ltx_sup"><span id="S3.SS5.p2.4.3.1" class="ltx_text ltx_font_italic">-1</span></sup> without reducing momentum, the model will experience gradient vanishing or gradient exploding during the training process, which is NaN in the table. When we then drop the Momentum to 0.5, the model finished 2x scheduled training but performance drops dramatically. We also tried reducing the learning rate, we think that the lower learning rate will lead to insufficient convergence. Changing the momentum will exacerbate the insufficiency, causing the AP<sub id="S3.SS5.p2.4.4" class="ltx_sub"><span id="S3.SS5.p2.4.4.1" class="ltx_text ltx_font_italic">75</span></sub> to be much lower than the original setting.</p>
</div>
<div id="S3.SS5.p3" class="ltx_para">
<p id="S3.SS5.p3.4" class="ltx_p">For the coefficients setting of the loss function, like Focal loss, we also explore the impact of hyperparameters. When we adjust the coefficient <math id="S3.SS5.p3.1.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S3.SS5.p3.1.m1.1a"><mi id="S3.SS5.p3.1.m1.1.1" xref="S3.SS5.p3.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p3.1.m1.1b"><ci id="S3.SS5.p3.1.m1.1.1.cmml" xref="S3.SS5.p3.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p3.1.m1.1c">\gamma</annotation></semantics></math> in the range of <math id="S3.SS5.p3.2.m2.1" class="ltx_Math" alttext="2\times 10^{-2}" display="inline"><semantics id="S3.SS5.p3.2.m2.1a"><mrow id="S3.SS5.p3.2.m2.1.1" xref="S3.SS5.p3.2.m2.1.1.cmml"><mn id="S3.SS5.p3.2.m2.1.1.2" xref="S3.SS5.p3.2.m2.1.1.2.cmml">2</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS5.p3.2.m2.1.1.1" xref="S3.SS5.p3.2.m2.1.1.1.cmml">×</mo><msup id="S3.SS5.p3.2.m2.1.1.3" xref="S3.SS5.p3.2.m2.1.1.3.cmml"><mn id="S3.SS5.p3.2.m2.1.1.3.2" xref="S3.SS5.p3.2.m2.1.1.3.2.cmml">10</mn><mrow id="S3.SS5.p3.2.m2.1.1.3.3" xref="S3.SS5.p3.2.m2.1.1.3.3.cmml"><mo id="S3.SS5.p3.2.m2.1.1.3.3a" xref="S3.SS5.p3.2.m2.1.1.3.3.cmml">−</mo><mn id="S3.SS5.p3.2.m2.1.1.3.3.2" xref="S3.SS5.p3.2.m2.1.1.3.3.2.cmml">2</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.p3.2.m2.1b"><apply id="S3.SS5.p3.2.m2.1.1.cmml" xref="S3.SS5.p3.2.m2.1.1"><times id="S3.SS5.p3.2.m2.1.1.1.cmml" xref="S3.SS5.p3.2.m2.1.1.1"></times><cn type="integer" id="S3.SS5.p3.2.m2.1.1.2.cmml" xref="S3.SS5.p3.2.m2.1.1.2">2</cn><apply id="S3.SS5.p3.2.m2.1.1.3.cmml" xref="S3.SS5.p3.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS5.p3.2.m2.1.1.3.1.cmml" xref="S3.SS5.p3.2.m2.1.1.3">superscript</csymbol><cn type="integer" id="S3.SS5.p3.2.m2.1.1.3.2.cmml" xref="S3.SS5.p3.2.m2.1.1.3.2">10</cn><apply id="S3.SS5.p3.2.m2.1.1.3.3.cmml" xref="S3.SS5.p3.2.m2.1.1.3.3"><minus id="S3.SS5.p3.2.m2.1.1.3.3.1.cmml" xref="S3.SS5.p3.2.m2.1.1.3.3"></minus><cn type="integer" id="S3.SS5.p3.2.m2.1.1.3.3.2.cmml" xref="S3.SS5.p3.2.m2.1.1.3.3.2">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p3.2.m2.1c">2\times 10^{-2}</annotation></semantics></math>, the AP<sub id="S3.SS5.p3.4.1" class="ltx_sub"><span id="S3.SS5.p3.4.1.1" class="ltx_text ltx_font_italic">75</span></sub> changes only slightly. And we find the performance dramatically dropped when we vary the coefficients of the original paper beyond <math id="S3.SS5.p3.4.m4.1" class="ltx_Math" alttext="5\times 10^{-2}" display="inline"><semantics id="S3.SS5.p3.4.m4.1a"><mrow id="S3.SS5.p3.4.m4.1.1" xref="S3.SS5.p3.4.m4.1.1.cmml"><mn id="S3.SS5.p3.4.m4.1.1.2" xref="S3.SS5.p3.4.m4.1.1.2.cmml">5</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS5.p3.4.m4.1.1.1" xref="S3.SS5.p3.4.m4.1.1.1.cmml">×</mo><msup id="S3.SS5.p3.4.m4.1.1.3" xref="S3.SS5.p3.4.m4.1.1.3.cmml"><mn id="S3.SS5.p3.4.m4.1.1.3.2" xref="S3.SS5.p3.4.m4.1.1.3.2.cmml">10</mn><mrow id="S3.SS5.p3.4.m4.1.1.3.3" xref="S3.SS5.p3.4.m4.1.1.3.3.cmml"><mo id="S3.SS5.p3.4.m4.1.1.3.3a" xref="S3.SS5.p3.4.m4.1.1.3.3.cmml">−</mo><mn id="S3.SS5.p3.4.m4.1.1.3.3.2" xref="S3.SS5.p3.4.m4.1.1.3.3.2.cmml">2</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.p3.4.m4.1b"><apply id="S3.SS5.p3.4.m4.1.1.cmml" xref="S3.SS5.p3.4.m4.1.1"><times id="S3.SS5.p3.4.m4.1.1.1.cmml" xref="S3.SS5.p3.4.m4.1.1.1"></times><cn type="integer" id="S3.SS5.p3.4.m4.1.1.2.cmml" xref="S3.SS5.p3.4.m4.1.1.2">5</cn><apply id="S3.SS5.p3.4.m4.1.1.3.cmml" xref="S3.SS5.p3.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS5.p3.4.m4.1.1.3.1.cmml" xref="S3.SS5.p3.4.m4.1.1.3">superscript</csymbol><cn type="integer" id="S3.SS5.p3.4.m4.1.1.3.2.cmml" xref="S3.SS5.p3.4.m4.1.1.3.2">10</cn><apply id="S3.SS5.p3.4.m4.1.1.3.3.cmml" xref="S3.SS5.p3.4.m4.1.1.3.3"><minus id="S3.SS5.p3.4.m4.1.1.3.3.1.cmml" xref="S3.SS5.p3.4.m4.1.1.3.3"></minus><cn type="integer" id="S3.SS5.p3.4.m4.1.1.3.3.2.cmml" xref="S3.SS5.p3.4.m4.1.1.3.3.2">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p3.4.m4.1c">5\times 10^{-2}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS5.p4" class="ltx_para">
<p id="S3.SS5.p4.1" class="ltx_p">Since the training strategy affects different neural networks similarly, the other models also exhibit similar distributions despite differences in hyperparameter settings between them. At the same time, due to the time-consuming training of deep learning and the complexity of grid search, we often get relatively optimal solutions.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span id="S4.1.1" class="ltx_text ltx_font_smallcaps">Conclusion</span>
</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this paper, we have presented a robust task-aligned Detection Transformer named PMMW-DETR for PMMW images with low resolution, sparse texture, and high noise. Different from popular neural networks, we perform the denoising coarse-to-fine Transformer backbone to deal with the problem of high noise and lack of texture information in the PMMW image, the query selection module to introduce spatial prior information, and the task-aligned dual-head block to enhance the ability of the network to identify object categories. Numerical experiments show that PMMW-DETR outperforms other SOTA methods. As far as we know, our network achieves the classification of different concealed objects for the first time. Moreover, PMMW-DETR is easy to generalize to other degraded image data where objects have prior location information. For the deployment and generalization ability of concealed object detection in the future, we will explore the potential of incremental learning and few-shot learning. Few-shot learning aims to maintain the same performance with few training samples, by pre-trained models or feature distillation, etc. Incremental learning focus on updating parameters based on the samples out of the distribution of the training set so that the model could renew knowledge in the working environment.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
N. A. Salmon, “Outdoor passive millimeter-wave imaging: Phenomenology and
scene simulation,” <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Antennas and Propagation</em>,
vol. 66, no. 2, pp. 897–908, 2017.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
L. Yujiri, M. Shoucri, and P. Moffa, “Passive millimeter wave imaging,”
<em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">IEEE microwave magazine</em>, vol. 4, no. 3, pp. 39–50, 2003.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
N. A. Salmon, “Indoor full-body security screening: Radiometric microwave
imaging phenomenology and polarimetric scene simulation,” <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">IEEE
Access</em>, vol. 8, pp. 144 621–144 637, 2020.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
D. Casella, G. Panegrossi, P. Sano, B. Rydberg, V. Mattioli, C. Accadia,
M. Papa, F. S. Marzano, and M. Montopoli, “Can we use atmospheric targets
for geolocating spaceborne millimeter-wave ice cloud imager (ici)
acquisitions?” <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Geoscience and Remote Sensing</em>,
vol. 60, p. 5302622, 2022.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
D. Cuadrado-Calle, P. Piironen, and N. Ayllon, “Solid-state diode technology
for millimeter and submillimeter-wave remote sensing applications: Current
status and future trends,” <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">IEEE Microwave Magazine</em>, vol. 23, no. 6,
pp. 44–56, 2022.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
J. Su, H. Wu, P. Li, Y. Hu, and F. Hu, “Detection for ship by
dual-polarization imaging radiometer,” <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">Optics Express</em>, vol. 29,
no. 17, pp. 27 830–27 844, 2021.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Y. Cheng, Y. Wang, Y. Niu, and Z. Zhao, “Concealed object enhancement using
multi-polarization information for passive millimeter and terahertz wave
security screening,” <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">Optics Express</em>, vol. 28, no. 5, pp. 6350–6366,
2020.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Y. Cheng, L. Qiao, D. Zhu, Y. Wang, and Z. Zhao, “Passive polarimetric imaging
of millimeter and terahertz waves for personnel,” <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on
Geoscience and Remote Sensing</em>, vol. 1, no. 15, 2020.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
A. Y. Owda, “Passive millimeter-wave imaging for burns diagnostics under
dressing materials,” <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">Sensors</em>, vol. 22, no. 7, p. 2428, 2022.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
G. Y. Tian, A. Al-Qubaa, and J. Wilson, “Design of an electromagnetic imaging
system for weapon detection based on gmr sensor arrays,” <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">Sensors and
Actuators A: Physical</em>, vol. 174, pp. 75–84, 2012.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
F. Gumbmann and A. Schiessl, “Short-range imaging system with a nonuniform
sfcw approach,” <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Microwave Theory and Techniques</em>,
vol. 65, no. 4, pp. 1345–1354, 2017.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Y. Cheng, L. Qiao, D. Zhu, Y. Wang, and Z. Zhao, “Passive polarimetric imaging
of millimeter and terahertz waves for personnel security screening,”
<em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">Optics Letters</em>, vol. 46, no. 6, pp. 1233–1236, 2021.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Y. Zhao, W. Si, B. Han, Z. Yang, A. Hu, and J. Miao, “A novel near field image
reconstruction method based on beamforming technique for real-time passive
millimeter wave imaging,” <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">IEEE Access</em>, vol. 10, pp. 32 879–32 888,
2022.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
O. Martínez, L. Ferraz, X. Binefa, I. Gómez, and C. Dorronsoro,
“Concealed object detection and segmentation over millimetric waves
images,” in <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">2010 IEEE Computer Society Conference on Computer Vision
and Pattern Recognition-Workshops</em>.   IEEE, 2010, pp. 31–37.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
D.-S. Lee, S. Yeom, J.-Y. Son, and S.-H. Kim, “Automatic image segmentation
for concealed object detection using the expectation-maximization
algorithm,” <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">Optics Express</em>, vol. 18, no. 10, pp. 10 659–10 667,
2010.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
S. Yeom, D.-S. Lee, J.-Y. Son, M.-K. Jung, Y. Jang, S.-W. Jung, and S.-J. Lee,
“Real-time outdoor concealed-object detection with passive millimeter wave
imaging,” <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">Optics Express</em>, vol. 19, no. 3, pp. 2530–2536, 2011.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
S. Yeom, D.-S. Lee, Y. Jang, M.-K. Lee, and S.-W. Jung, “Real-time
concealed-object detection and recognition with passive millimeter wave
imaging,” <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">Optics Express</em>, vol. 20, no. 9, pp. 9371–9381, 2012.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
S. López-Tapia, R. Molina, and N. P. de la Blanca, “Using machine learning
to detect and localize concealed objects in passive millimeter-wave images,”
<em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">Engineering Applications of Artificial Intelligence</em>, vol. 67, pp.
81–90, 2018.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
S. Lopez-Tapia, R. Molina, and N. P. de la Blanca, “Deep cnns for object
detection using passive millimeter sensors,” <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on
Circuits and Systems for Video Technology</em>, vol. 29, no. 9, pp. 2580–2589,
2017.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
M. Kowalski, “Real-time concealed object detection and recognition in passive
imaging at 250 ghz,” <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">Applied optics</em>, vol. 58, no. 12, pp. 3134–3140,
2019.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
L. Pang, H. Liu, Y. Chen, and J. Miao, “Real-time concealed object detection
from passive millimeter wave images based on the yolov3 algorithm,”
<em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">Sensors</em>, vol. 20, no. 6, p. 1678, 2020.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
M.-T. Luong, H. Pham, and C. D. Manning, “Effective approaches to
attention-based neural machine translation,” in <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">Proceedings of the
2015 Conference on Empirical Methods in Natural Language Processing</em>, 2015,
pp. 1412–1421.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
D. Bahdanau, K. Cho, and Y. Bengio, “Neural machine translation by jointly
learning to align and translate,” <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1409.0473</em>,
2017.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
A. Kolesnikov, A. Dosovitskiy, D. Weissenborn, G. Heigold, J. Uszkoreit,
L. Beyer, M. Minderer, M. Dehghani, N. Houlsby, S. Gelly <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">et al.</em>, “An
image is worth 16x16 words: Transformers for image recognition at scale,”
<em id="bib.bib24.2.2" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2010.11929</em>, 2021.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Z. Liu, Y. Lin, Y. Cao, H. Hu, Y. Wei, Z. Zhang, S. Lin, and B. Guo, “Swin
transformer: Hierarchical vision transformer using shifted windows,” in
<em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF International Conference on Computer
Vision</em>, 2021, pp. 10 012–10 022.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
N. Carion, F. Massa, G. Synnaeve, N. Usunier, A. Kirillov, and S. Zagoruyko,
“End-to-end object detection with transformers,” in <em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">European
conference on computer vision</em>.   Springer, 2020, pp. 213–229.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
H. Yang, D. Zhang, A. Hu, C. Liu, T. J. Cui, and J. Miao, “Transformer-based
anchor-free detection of concealed objects in passive millimeter wave
images,” <em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Instrumentation and Measurement</em>, 2022.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
X. Chu, Z. Tian, Y. Wang, B. Zhang, H. Ren, X. Wei, H. Xia, and C. Shen,
“Twins: Revisiting the design of spatial attention in vision transformers,”
<em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, vol. 34, pp.
9355–9366, 2021.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
S. Zhang, C. Chi, Y. Yao, Z. Lei, and S. Z. Li, “Bridging the gap between
anchor-based and anchor-free detection via adaptive training sample
selection,” in <em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF conference on computer
vision and pattern recognition</em>, 2020, pp. 9759–9768.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Y. Wu, Y. Chen, L. Yuan, Z. Liu, L. Wang, H. Li, and Y. Fu, “Rethinking
classification and localization for object detection,” in <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">Proceedings
of the IEEE/CVF conference on computer vision and pattern recognition</em>, 2020,
pp. 10 186–10 195.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
L. Xuhong, Y. Grandvalet, and F. Davoine, “Explicit inductive bias for
transfer learning with convolutional networks,” in <em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">International
Conference on Machine Learning</em>.   PMLR,
2018, pp. 2825–2834.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
W. Wang, J. Zhang, Y. Cao, Y. Shen, and D. Tao, “Towards data-efficient
detection transformers,” <em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2203.09507</em>, 2022.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
X. Zhu, W. Su, L. Lu, B. Li, X. Wang, and J. Dai, “Deformable detr: Deformable
transformers for end-to-end object detection,” <em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">arXiv preprint
arXiv:2010.04159</em>, 2020.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
D. Meng, X. Chen, Z. Fan, G. Zeng, H. Li, Y. Yuan, L. Sun, and J. Wang,
“Conditional detr for fast training convergence,” in <em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">Proceedings of
the IEEE/CVF International Conference on Computer Vision</em>, 2021, pp.
3651–3660.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
S. Liu, F. Li, H. Zhang, X. Yang, X. Qi, H. Su, J. Zhu, and L. Zhang,
“Dab-detr: Dynamic anchor boxes are better queries for detr,” <em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">arXiv
preprint arXiv:2201.12329</em>, 2022.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
Z. Yao, J. Ai, B. Li, and C. Zhang, “Efficient detr: improving end-to-end
object detector with dense prior,” <em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2104.01318</em>,
2021.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
G. Song, Y. Liu, and X. Wang, “Revisiting the sibling head in object
detector,” in <em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer
Vision and Pattern Recognition</em>, 2020, pp. 11 563–11 572.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
C. Feng, Y. Zhong, Y. Gao, M. R. Scott, and W. Huang, “Tood: Task-aligned
one-stage object detection,” in <em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">2021 IEEE/CVF International Conference
on Computer Vision (ICCV)</em>.   IEEE
Computer Society, 2021, pp. 3490–3499.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
A. Vaswani, N. Shazeer, N. Parmar, J. Uszkoreit, L. Jones, A. N. Gomez,
Ł. Kaiser, and I. Polosukhin, “Attention is all you need,”
<em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, vol. 30, 2017.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
F. Li, H. Zhang, S. Liu, J. Guo, L. M. Ni, and L. Zhang, “Dn-detr: Accelerate
detr training by introducing query denoising,” in <em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">Proceedings of the
IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, 2022, pp.
13 619–13 627.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
B. Qi, L. Lang, Y. Cheng, S. Liu, F. Hu, X. He, P. Deng, and L. Gui, “Passive
millimeter-wave scene imaging simulation based on fast ray-tracing,” in
<em id="bib.bib41.1.1" class="ltx_emph ltx_font_italic">2016 IEEE International Geoscience and Remote Sensing Symposium
(IGARSS)</em>.   IEEE, 2016, pp. 2642–2645.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
I. Loshchilov and F. Hutter, “Decoupled weight decay regularization,”
<em id="bib.bib42.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1711.05101</em>, 2017.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
J. Redmon and A. Farhadi, “Yolov3: An incremental improvement,” <em id="bib.bib43.1.1" class="ltx_emph ltx_font_italic">arXiv
preprint arXiv:1804.02767</em>, 2018.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock">
W. Liu, D. Anguelov, D. Erhan, C. Szegedy, S. Reed, C.-Y. Fu, and A. C. Berg,
“Ssd: Single shot multibox detector,” in <em id="bib.bib44.1.1" class="ltx_emph ltx_font_italic">European conference on
computer vision</em>.   Springer, 2016, pp.
21–37.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock">
S. Ren, K. He, R. Girshick, and J. Sun, “Faster r-cnn: Towards real-time
object detection with region proposal networks,” <em id="bib.bib45.1.1" class="ltx_emph ltx_font_italic">Advances in neural
information processing systems</em>, vol. 28, 2015.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock">
Z. Tian, C. Shen, H. Chen, and T. He, “Fcos: Fully convolutional one-stage
object detection,” in <em id="bib.bib46.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF international
conference on computer vision</em>, 2019, pp. 9627–9636.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock">
W. Wang, L. Yao, L. Chen, B. Lin, D. Cai, X. He, and W. Liu, “Crossformer: A
versatile vision transformer hinging on cross-scale attention,” in
<em id="bib.bib47.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2021.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock">
X. Dai, Y. Chen, B. Xiao, D. Chen, M. Liu, L. Yuan, and L. Zhang, “Dynamic
head: Unifying object detection heads with attentions,” in <em id="bib.bib48.1.1" class="ltx_emph ltx_font_italic">Proceedings
of the IEEE/CVF conference on computer vision and pattern recognition</em>, 2021,
pp. 7373–7382.

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock">
S. M. LaValle, M. S. Branicky, and S. R. Lindemann, “On the relationship
between classical grid search and probabilistic roadmaps,” <em id="bib.bib49.1.1" class="ltx_emph ltx_font_italic">The
International Journal of Robotics Research</em>, vol. 23, no. 7-8, pp. 673–692,
2004.

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock">
K. Chen, J. Wang, J. Pang, Y. Cao, Y. Xiong, X. Li, S. Sun, W. Feng, Z. Liu,
J. Xu <em id="bib.bib50.1.1" class="ltx_emph ltx_font_italic">et al.</em>, “Mmdetection: Open mmlab detection toolbox and
benchmark,” <em id="bib.bib50.2.2" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1906.07155</em>, 2019.

</span>
</li>
</ul>
</section>
<figure id="id1" class="ltx_float biography">
<table id="id1.1" class="ltx_tabular">
<tr id="id1.1.1" class="ltx_tr">
<td id="id1.1.1.1" class="ltx_td"><img src="/html/2212.00313/assets/ChengGuo.jpg" id="id1.1.1.1.g1" class="ltx_graphics ltx_img_portrait" width="94" height="125" alt="[Uncaptioned image]"></td>
<td id="id1.1.1.2" class="ltx_td">
<span id="id1.1.1.2.1" class="ltx_inline-block">
<span id="id1.1.1.2.1.1" class="ltx_p"><span id="id1.1.1.2.1.1.1" class="ltx_text ltx_font_bold">Cheng Guo</span>  was born in Hubei, China. He is currently pursuing the M.S. degree at the Huazhong University of Science and Technology (HUST), Wuhan, China. He received the B.E. degree in Electronic Information engineering from Wuhan University of Science and Technology, Wuhan, China, in 2021.</span>
<span id="id1.1.1.2.1.2" class="ltx_p">His research interests include image processing, passive imaging, and object detection.</span>
</span>
</td>
</tr>
</table>
</figure>
<figure id="id2" class="ltx_float biography">
<table id="id2.1" class="ltx_tabular">
<tr id="id2.1.1" class="ltx_tr">
<td id="id2.1.1.1" class="ltx_td"><img src="/html/2212.00313/assets/FeiHu.png" id="id2.1.1.1.g1" class="ltx_graphics ltx_img_portrait" width="100" height="125" alt="[Uncaptioned image]"></td>
<td id="id2.1.1.2" class="ltx_td">
<span id="id2.1.1.2.1" class="ltx_inline-block">
<span id="id2.1.1.2.1.1" class="ltx_p"><span id="id2.1.1.2.1.1.1" class="ltx_text ltx_font_bold">Fei Hu</span>  was born in Hubei, China. He received the M.S. degree in experimental mechanics and the Ph.D. degree in communication and information system from the Huazhong University of Science and Technology (HUST), Wuhan, China, in 1998 and 2002, respectively.</span>
<span id="id2.1.1.2.1.2" class="ltx_p">He was a Senior Researcher with the National Key Laboratory of Science and Technology on Multi-Spectral Information Processing Technologies, HUST. He is currently a Professor with the School of Electronic Information and Communications, HUST. He has authored or coauthored more than 40 technical articles. His research interests include microwave technique, microwave interferometric radiometers, microwave remote sensing, and passive microwave imaging.</span>
</span>
</td>
</tr>
</table>
</figure>
<figure id="id3" class="ltx_float biography">
<table id="id3.1" class="ltx_tabular">
<tr id="id3.1.1" class="ltx_tr">
<td id="id3.1.1.1" class="ltx_td"><img src="/html/2212.00313/assets/huyan.jpg" id="id3.1.1.1.g1" class="ltx_graphics ltx_img_portrait" width="88" height="125" alt="[Uncaptioned image]"></td>
<td id="id3.1.1.2" class="ltx_td">
<span id="id3.1.1.2.1" class="ltx_inline-block">
<span id="id3.1.1.2.1.1" class="ltx_p"><span id="id3.1.1.2.1.1.1" class="ltx_text ltx_font_bold">Yan Hu</span>  was born in Hubei, China in 1995. He received the B.S. degree in electronic and information engineering from the Huazhong University of Science and Technology (HUST), Wuhan, China, in 2017. He received his Ph.D. degree from HUST, in 2022.</span>
<span id="id3.1.1.2.1.2" class="ltx_p">His research interests include passive imaging, polarization characteristics, and image processing.</span>
</span>
</td>
</tr>
</table>
</figure>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2212.00312" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2212.00313" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2212.00313">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2212.00313" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2212.00314" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Fri Mar  1 08:57:05 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
