<!DOCTYPE html><html lang="en" data-theme="light"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<title>Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning</title>
<!--Generated on Sat Oct  5 16:29:34 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="https://arxiv.org/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css">
<link href="https://arxiv.org/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css">
<link href="https://arxiv.org/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css">




<base href="https://arxiv.org/html/2410.04223v1/"><link rel="stylesheet" href="https://use.typekit.net/rwr5zpx.css"><link rel="icon" type="image/png" href="https://static.arxiv.org/static/browse/0.3.4/images/icons/favicon-16x16.png" sizes="16x16"><link rel="icon" type="image/png" href="https://static.arxiv.org/static/browse/0.3.4/images/icons/favicon-32x32.png" sizes="32x32"></head>
<body><header class="mob_header">
    <div class="html-header-logo">
      <a href="https://arxiv.org/">
        <img alt="logo" class="logomark" role="presentation" width="100" src="https://services.dev.arxiv.org/html/static/arxiv-logomark-small-white.svg">
        <span class="sr-only">Back to arXiv</span>
      </a>
    </div>

    <!--TOC, dark mode, links-->
    <div class="html-header-nav">
      <!--back to abstract-->
      
        <a class="nav-link ar5iv-footer-button hover-effect" aria-label="Back to abstract page" href="https://arxiv.org/abs/2410.04223v1">
        <svg xmlns="http://www.w3.org/2000/svg" height="1.25em" viewBox="0 0 512 512" fill="#ffffff" aria-hidden="true">
            <path d="M502.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L402.7 224 192 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l210.7 0-73.4 73.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l128-128zM160 96c17.7 0 32-14.3 32-32s-14.3-32-32-32L96 32C43 32 0 75 0 128L0 384c0 53 43 96 96 96l64 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-64 0c-17.7 0-32-14.3-32-32l0-256c0-17.7 14.3-32 32-32l64 0z"></path>
        </svg>
        </a>
      <!--dark mode-->
      <a class="ar5iv-toggle-color-scheme" title="Toggle dark/light mode" aria-label="System preference">
        <label id="automatic-tog" class="toggle-icon" title="Switch to light mode" for="__palette_3">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"></path></svg>
        </label>
        
        
      </a>
      <!--nav-->
      <button class="navbar-toggler ar5iv-footer-button" type="button" data-bs-theme="dark" data-bs-toggle="collapse" aria-expanded="false" data-bs-target=".ltx_page_main >.ltx_TOC.mobile" aria-controls="navbarSupportedContent" aria-label="Toggle navigation" style="border:none; margin-right: 0em;">
        <svg xmlns="http://www.w3.org/2000/svg" height="1.25em" viewBox="0 0 448 512" aria-hidden="true" role="img" fill="#ffffff"><path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"></path></svg>
      </button>
    </div>
    </header><header class="desktop_header">
    <div class="html-header-logo">
      <a href="https://arxiv.org/">
          <img alt="logo" class="logo" role="presentation" width="100" src="https://services.dev.arxiv.org/html/static/arxiv-logo-one-color-white.svg">
          <span class="sr-only">Back to arXiv</span>
      </a>
    </div>
    <div class="html-header-message" role="banner">
        <p>This is <strong>experimental HTML</strong> to improve accessibility. We invite you to report rendering errors. <span class="sr-only">Use Alt+Y to toggle on accessible reporting links and Alt+Shift+Y to toggle off.</span> Learn more <a href="https://info.arxiv.org/about/accessible_HTML.html" target="_blank">about this project</a> and <a href="https://info.arxiv.org/help/submit_latex_best_practices.html" target="_blank">help improve conversions</a>.
        </p>
    </div>
    <nav class="html-header-nav">
      <a class="ar5iv-footer-button hover-effect" href="https://info.arxiv.org/about/accessible_HTML.html" target="_blank">Why HTML?</a>
      <a class="ar5iv-footer-button hover-effect" target="_blank" href="https://arxiv.org/html/2410.04223v1/#myForm">Report Issue</a>
      <a class="ar5iv-footer-button hover-effect" href="https://arxiv.org/abs/2410.04223v1">Back to Abstract</a>
      <a class="ar5iv-footer-button hover-effect" href="https://arxiv.org/pdf/2410.04223v1" target="_blank">Download PDF</a>
      <a class="ar5iv-toggle-color-scheme" title="Toggle dark/light mode">
        <label id="automatic-tog" class="toggle-icon" title="Switch to light mode" for="__palette_3">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"></path></svg>
        </label>
        
        
      </a>
    </nav></header>

<div class="ltx_page_main" id="main">
<nav class="ltx_TOC active" aria-labelledby="toc_header"><h2 id="toc_header" class="sr-only">Table of Contents</h2>

      <div id="listIcon" type="button" class="hide">
          <svg width="17px" height="17px" viewBox="0 0 512 512" style="pointer-events: none;">
          <path d="M40 48C26.7 48 16 58.7 16 72v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V72c0-13.3-10.7-24-24-24H40zM192 64c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zM16 232v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V232c0-13.3-10.7-24-24-24H40c-13.3 0-24 10.7-24 24zM40 368c-13.3 0-24 10.7-24 24v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V392c0-13.3-10.7-24-24-24H40z"></path>
          </svg>
      </div>
      <div id="arrowIcon" type="button">
          <svg width="17px" height="17px" viewBox="0 0 448 512" style="pointer-events: none;">
          <path d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.2 288 416 288c17.7 0 32-14.3 32-32s-14.3-32-32-32l-306.7 0L214.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"></path>
          </svg>
      </div><ol class="ltx_toclist"><li class="ltx_tocentry ltx_tocentry_section">
    <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#abstract" title="Abstract">
      <span class="ltx_text ltx_ref_title">
        <span class="ltx_tag ltx_tag_ref"></span>
        Abstract
      </span>
    </a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S1" title="In Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S2" title="In Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Preliminaries</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S2.SS1" title="In 2 Preliminaries ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Autoregressive Language Modeling</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S2.SS2" title="In 2 Preliminaries ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Molecular Design with Graph Diffusion Models</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S2.SS3" title="In 2 Preliminaries ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>One-Step Reaction Prediction with Graph Neural Networks</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S2.SS4" title="In 2 Preliminaries ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.4 </span>Retrosynthetic Planning with A* Search</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S3" title="In Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Llamole: Multimodal Large Language Model for Molecular Discovery</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S3.SS1" title="In 3 Llamole: Multimodal Large Language Model for Molecular Discovery ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Multimodal Autoregressive Modeling</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S3.SS2" title="In 3 Llamole: Multimodal Large Language Model for Molecular Discovery ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Llamole Design Space</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S3.SS3" title="In 3 Llamole: Multimodal Large Language Model for Molecular Discovery ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>End-to-End Model Fine-Tuning and Generation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S4" title="In Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Benchmarking for Multimodal Molecular Design</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S5" title="In Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Experiment</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S5.SS1" title="In 5 Experiment ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>RQ1: LLMs for Controllable and Synthesizable Molecular Design</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S5.SS2" title="In 5 Experiment ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>RQ2: Discussion on Controllable Molecular Generation</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S5.SS2.SSS1" title="In 5.2 RQ2: Discussion on Controllable Molecular Generation ‣ 5 Experiment ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2.1 </span>Ablation Studies on LLM and Graph DiT Synergy</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S5.SS2.SSS2" title="In 5.2 RQ2: Discussion on Controllable Molecular Generation ‣ 5 Experiment ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2.2 </span>Case Studies for Property and Structure Controllability</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S5.SS3" title="In 5 Experiment ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>RQ3: Discussion on Retrosynthetic Planning</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S5.SS3.SSS1" title="In 5.3 RQ3: Discussion on Retrosynthetic Planning ‣ 5 Experiment ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3.1 </span>One-step Reaction Generation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S5.SS3.SSS2" title="In 5.3 RQ3: Discussion on Retrosynthetic Planning ‣ 5 Experiment ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3.2 </span>Multi-step Retrosynthetic Planning</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S6" title="In Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Related Work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S7" title="In Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A1" title="In Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Additional Details for Llamole</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A1.SS1" title="In Appendix A Additional Details for Llamole ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1 </span>Details of Special Tokens</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A1.SS2" title="In Appendix A Additional Details for Llamole ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2 </span>Details of LLM-based A* Heuristics</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A2" title="In Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Additional Benchmarking and Datasets Details</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A2.SS1" title="In Appendix B Additional Benchmarking and Datasets Details ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.1 </span>Details of Quality Control</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A2.SS2" title="In Appendix B Additional Benchmarking and Datasets Details ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.2 </span>Details on the Creation of MolQA</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A2.SS2.SSS1" title="In B.2 Details on the Creation of MolQA ‣ Appendix B Additional Benchmarking and Datasets Details ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.2.1 </span>Creation of Synthesis Routes</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A2.SS2.SSS2" title="In B.2 Details on the Creation of MolQA ‣ Appendix B Additional Benchmarking and Datasets Details ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.2.2 </span>Creation of Property Annotations</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A2.SS2.SSS3" title="In B.2 Details on the Creation of MolQA ‣ Appendix B Additional Benchmarking and Datasets Details ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.2.3 </span>Creation of Text Data for Molecular Description</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A2.SS2.SSS4" title="In B.2 Details on the Creation of MolQA ‣ Appendix B Additional Benchmarking and Datasets Details ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.2.4 </span>Creation of Question Answering Data</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A2.SS3" title="In Appendix B Additional Benchmarking and Datasets Details ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.3 </span>Details on the Creation of MolPair</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A3" title="In Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>Additional Pre-training and Fine-tuning Details</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A3.SS1" title="In Appendix C Additional Pre-training and Fine-tuning Details ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.1 </span>Pre-training of Graph Diffusion Transformers</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A3.SS2" title="In Appendix C Additional Pre-training and Fine-tuning Details ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.2 </span>Pre-training of GNNs</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A3.SS3" title="In Appendix C Additional Pre-training and Fine-tuning Details ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.3 </span>Fine-tuning of Llamole</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A4" title="In Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D </span>Additional Experimental Details and Discussions</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A4.SS1" title="In Appendix D Additional Experimental Details and Discussions ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.1 </span>Additional Details on Experimental Set-ups</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A4.SS1.SSS1" title="In D.1 Additional Details on Experimental Set-ups ‣ Appendix D Additional Experimental Details and Discussions ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.1.1 </span>Set-ups for&nbsp;<span class="ltx_text ltx_ref_tag">Figure</span>&nbsp;<span class="ltx_text ltx_ref_tag">1</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A4.SS1.SSS2" title="In D.1 Additional Details on Experimental Set-ups ‣ Appendix D Additional Experimental Details and Discussions ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.1.2 </span>Extraction of SMILES from LLM Responses</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A4.SS2" title="In Appendix D Additional Experimental Details and Discussions ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.2 </span>Additional Discussion on One-Step Generation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A4.SS3" title="In Appendix D Additional Experimental Details and Discussions ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.3 </span>Additional Discussion on Case Studies</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
    <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib" title="References">
      <span class="ltx_text ltx_ref_title">
        <span class="ltx_tag ltx_tag_ref"></span>
        References
      </span>
    </a></li></ol></nav>

<div class="ltx_page_content"><div class="package-alerts ltx_document" role="status" aria-label="Conversion errors have been found">
      <button aria-label="Dismiss alert">
          <span aria-hidden="true"><svg role="presentation" width="20" height="20" viewBox="0 0 44 44" aria-hidden="true" focusable="false">
          <path d="M0.549989 4.44999L4.44999 0.549988L43.45 39.55L39.55 43.45L0.549989 4.44999Z"></path>
          <path d="M39.55 0.549988L43.45 4.44999L4.44999 43.45L0.549988 39.55L39.55 0.549988Z"></path>
          </svg></span>
      </button>
      <p>HTML conversions <a href="https://info.dev.arxiv.org/about/accessibility_html_error_messages.html" target="_blank">sometimes display errors</a> due to content that did not convert correctly from the source. This paper uses the following packages that are not yet supported by the HTML conversion tool. Feedback on these issues are not necessary; they are known and are being worked on.</p>
          <ul arial-label="Unsupported packages used in this paper">
              <li>failed: mhchem</li><li>failed: arydshln</li>
          </ul>
      <p>Authors: achieve the best HTML results from your LaTeX submissions by following these <a href="https://info.arxiv.org/help/submit_latex_best_practices.html" target="_blank">best practices</a>.</p>
    </div><div id="target-section" class="section"><a id="license-tr" href="https://info.arxiv.org/help/license/index.html#licenses-available">License: CC BY 4.0</a><div id="watermark-tr">arXiv:2410.04223v1 [cs.LG] 05 Oct 2024</div></div>
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning</h1><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Gang Liu<sup class="ltx_sup" id="id10.10.id1"><span class="ltx_text ltx_font_italic" id="id10.10.id1.1">1,4</span></sup>,  Michael Sun<sup class="ltx_sup" id="id11.11.id2"><span class="ltx_text ltx_font_italic" id="id11.11.id2.1">2,4</span></sup>,  Wojciech Matusik<sup class="ltx_sup" id="id12.12.id3">2</sup>,  Meng Jiang<sup class="ltx_sup" id="id13.13.id4">1</sup>,  Jie Chen<sup class="ltx_sup" id="id14.14.id5">3</sup>
<br class="ltx_break"><sup class="ltx_sup" id="id15.15.id6">1</sup>University of Notre Dame  <sup class="ltx_sup" id="id16.16.id7">2</sup>MIT CSAIL  <sup class="ltx_sup" id="id17.17.id8">3</sup> MIT-IBM Watson AI Lab 
<br class="ltx_break"><sup class="ltx_sup" id="id18.18.id9">4</sup> This work was done while GL and MS interned at 
<br class="ltx_break">the MIT-IBM Watson AI Lab, IBM Research 
<br class="ltx_break"><span class="ltx_text ltx_font_typewriter" id="id19.19.id10">{gliu7, mjiang2}@nd.edu</span>, 
<br class="ltx_break"><span class="ltx_text ltx_font_typewriter" id="id20.20.id11">{msun415, wojciech}@csail.mit.edu</span>, 
<br class="ltx_break"><span class="ltx_text ltx_font_typewriter" id="id21.21.id12">chenjie@us.ibm.com</span>
<br class="ltx_break">
</span></span>
</div><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_abstract" id="abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<p class="ltx_p" id="id22.id1">While large language models (LLMs) have integrated images, adapting them to graphs remains challenging, limiting their applications in materials and drug design. This difficulty stems from the need for coherent autoregressive generation across texts and graphs. To address this, we introduce Llamole, the first multimodal LLM capable of interleaved text and graph generation, enabling molecular inverse design with retrosynthetic planning.
Llamole integrates a base LLM with the Graph Diffusion Transformer and Graph Neural Networks for multi-conditional molecular generation and reaction inference within texts, while the LLM, with enhanced molecular understanding, flexibly controls activation among the different graph modules.
Additionally, Llamole integrates A* search with LLM-based cost functions for efficient retrosynthetic planning. We create benchmarking datasets and conduct extensive experiments to evaluate Llamole against in-context learning and supervised fine-tuning. Llamole significantly outperforms 14 adapted LLMs across 12 metrics for controllable molecular design and retrosynthetic planning.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure ltx_align_floatright" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="332" id="S1.F1.g1" src="https://arxiv.org/html/2410.04223v1/x1.png" width="290">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Comparison of Controllability: Results are averaged from the best numbers from&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S5.T1" title="In 5 Experiment ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Table</span>&nbsp;<span class="ltx_text ltx_ref_tag">1</span></a>.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Large language models (LLMs) are transforming machine learning across many domains&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Achiam et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib2" title="">2023</a>)</cite>. Their success in natural language processing has extended to areas handling not only text but also image and speech data&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Dong et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib9" title="">2023</a>; Wu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib42" title="">2024</a>)</cite>, thanks to the development of multimodal capabilities. Recently, the potential of LLMs for molecular discovery has been actively explored&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Jablonka et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib17" title="">2023</a>)</cite>. However, LLMs struggle in the chemical domain, exhibiting poor generation quality and planning capability&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Guo et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib14" title="">2023</a>)</cite>. This is due to the unique, graph structures of molecular data, which are challenging for LLMs that typically handle sequential texts.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Inverse molecular design requires LLMs to be controllable for generating molecular structures that meet multi-property and synthesizability requirements&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Chen et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib5" title="">2020</a>; Gao et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib12" title="">2021</a>)</cite>. These requirements can be detailed as questions for LLM input, as shown in&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S1.F2" title="In 1 Introduction ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Figure</span>&nbsp;<span class="ltx_text ltx_ref_tag">2</span></a>.
Answering these questions demands a comprehensive understanding of molecular structures and their relationship to properties. However, sequence-based LLMs struggle with this because they are pre-trained or fine-tuned solely on text representations of molecules, e.g., SMILES&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Weininger, <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib41" title="">1988</a>)</cite>.
To illustrate this, we investigate 14 LLMs for molecular generation in&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S1.F1" title="In 1 Introduction ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Figure</span>&nbsp;<span class="ltx_text ltx_ref_tag">1</span></a> across 10K drug and material questions: ten using in-context learning (ICL) and four with supervised fine-tuning (SFT). LLMs generate molecular structures based on the questions, and their properties are obtained through oracles to assess the differences between requirements and generated outputs. Details of the experimental set-ups and results can be found in <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S5" title="5 Experiment ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Section</span>&nbsp;<span class="ltx_text ltx_ref_tag">5</span></a>. In summary, even the best LLMs perform worse than GraphGA&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Gao et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib13" title="">2022</a>)</cite>, a simple yet effective graph-based method, in designing molecules with satisfactory properties.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="S1.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="373" id="S1.F2.g1" src="https://arxiv.org/html/2410.04223v1/x2.png" width="747">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Three LLM-based methods for molecular design. The question outlines requirements for properties, structures, and synthesis, addressed as follows: (a) In-Context Learning and (b) Supervised Fine-Tuning use text-only data for demonstrations and instruction tuning, respectively. (c) The proposed Llamole uses graph-text multimodal data to fine-tune the LLM, integrating parameter-frozen graph models for interleaved text and graph generation with reaction inference.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">As illustrated in&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S1.F2" title="In 1 Introduction ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Figure</span>&nbsp;<span class="ltx_text ltx_ref_tag">2</span></a>, practical answers for molecular design are more complex than what can be achieved by using graph methods or LLMs alone. The generation begins with a paragraph describing the intended molecule for multi-conditional generation, followed by retrosynthetic planning, detailing each synthesis step—one reaction per paragraph—in reverse order, from the target molecule to purchasable reactants. Thus, multimodal LLMs (MLLMs) are essential, with LLMs handling text generation and graph models managing molecular design.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">In this work, we propose the multimodal <span class="ltx_text ltx_font_bold" id="S1.p4.1.1">L</span>arge <span class="ltx_text ltx_font_bold" id="S1.p4.1.2">la</span>nguage model for <span class="ltx_text ltx_font_bold" id="S1.p4.1.3">mole</span>cular discovery (<span class="ltx_text ltx_font_bold" id="S1.p4.1.4">Llamole</span>). As shown in&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S1.F2" title="In 1 Introduction ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Figure</span>&nbsp;<span class="ltx_text ltx_ref_tag">2</span></a> (c), the model seamlessly integrates LLMs and graph models within a multimodal autoregressive framework, enabling the interleaved generation of text, molecules, and reactions. It predicts the next token across both word and chemical spaces, framed as multi-class prediction tasks for word vocabulary, atom/bond types, and reaction templates. For retrosynthetic planning, Llamole integrates A* search to efficiently identify synthesis pathways for the designed molecule.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">To implement Llamole, we augment a base LLM with two pre-trained graph modules: the Graph Diffusion Transformer (Graph DiT) for multi-conditional molecule generation&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Liu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib27" title="">2024c</a>)</cite> and a GNN for reaction template prediction. The base LLM controls the generation flow using a trigger-query-prediction approach with two sets of trigger tokens for the Graph DiT and GNN, respectively. Upon predicting a trigger token, one or a few query tokens summarize the prior text as vectors, activating the corresponding graph modules and generating molecules or predicting reaction templates. Afterward, the base LLM can resume text generation, aided by a graph encoder that encodes the previously generated molecule. In retrosynthetic planning, the LLM computes heuristics to efficiently assist the A* search in navigating the vast reaction space for multi-step generation.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">Our work has several highlights. First, Llamole is the first MLLM for molecular design, capable of interleaved generation of text and graphs. Second, we curated a dataset along with fine-tuning instructions to benchmark complex yet realistic molecular design outcomes, including human conversation. Third, we present compelling experimental results that demonstrate the competitiveness of Llamole against 14 LLMs and GraphGA, as shown in <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S1.F1" title="In 1 Introduction ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Figure</span>&nbsp;<span class="ltx_text ltx_ref_tag">1</span></a>. With details in&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S5.T1" title="In 5 Experiment ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Tables</span>&nbsp;<span class="ltx_text ltx_ref_tag">1</span></a> and&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S5.T2" title="Table 2 ‣ 5.1 RQ1: LLMs for Controllable and Synthesizable Molecular Design ‣ 5 Experiment ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">2</span></a>, Llamole improves LLM performance by up to 80.9% across 12 metrics for controllable molecular generation and increases the success rate for retrosynthetic planning from 5.5% to 35%.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Preliminaries</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Autoregressive Language Modeling</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.7">Given a sequence of word tokens <math alttext="W=\{w_{1},w_{2},\dots,w_{L}\}" class="ltx_Math" display="inline" id="S2.SS1.p1.1.m1.4"><semantics id="S2.SS1.p1.1.m1.4a"><mrow id="S2.SS1.p1.1.m1.4.4" xref="S2.SS1.p1.1.m1.4.4.cmml"><mi id="S2.SS1.p1.1.m1.4.4.5" xref="S2.SS1.p1.1.m1.4.4.5.cmml">W</mi><mo id="S2.SS1.p1.1.m1.4.4.4" xref="S2.SS1.p1.1.m1.4.4.4.cmml">=</mo><mrow id="S2.SS1.p1.1.m1.4.4.3.3" xref="S2.SS1.p1.1.m1.4.4.3.4.cmml"><mo id="S2.SS1.p1.1.m1.4.4.3.3.4" stretchy="false" xref="S2.SS1.p1.1.m1.4.4.3.4.cmml">{</mo><msub id="S2.SS1.p1.1.m1.2.2.1.1.1" xref="S2.SS1.p1.1.m1.2.2.1.1.1.cmml"><mi id="S2.SS1.p1.1.m1.2.2.1.1.1.2" xref="S2.SS1.p1.1.m1.2.2.1.1.1.2.cmml">w</mi><mn id="S2.SS1.p1.1.m1.2.2.1.1.1.3" xref="S2.SS1.p1.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS1.p1.1.m1.4.4.3.3.5" xref="S2.SS1.p1.1.m1.4.4.3.4.cmml">,</mo><msub id="S2.SS1.p1.1.m1.3.3.2.2.2" xref="S2.SS1.p1.1.m1.3.3.2.2.2.cmml"><mi id="S2.SS1.p1.1.m1.3.3.2.2.2.2" xref="S2.SS1.p1.1.m1.3.3.2.2.2.2.cmml">w</mi><mn id="S2.SS1.p1.1.m1.3.3.2.2.2.3" xref="S2.SS1.p1.1.m1.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S2.SS1.p1.1.m1.4.4.3.3.6" xref="S2.SS1.p1.1.m1.4.4.3.4.cmml">,</mo><mi id="S2.SS1.p1.1.m1.1.1" mathvariant="normal" xref="S2.SS1.p1.1.m1.1.1.cmml">…</mi><mo id="S2.SS1.p1.1.m1.4.4.3.3.7" xref="S2.SS1.p1.1.m1.4.4.3.4.cmml">,</mo><msub id="S2.SS1.p1.1.m1.4.4.3.3.3" xref="S2.SS1.p1.1.m1.4.4.3.3.3.cmml"><mi id="S2.SS1.p1.1.m1.4.4.3.3.3.2" xref="S2.SS1.p1.1.m1.4.4.3.3.3.2.cmml">w</mi><mi id="S2.SS1.p1.1.m1.4.4.3.3.3.3" xref="S2.SS1.p1.1.m1.4.4.3.3.3.3.cmml">L</mi></msub><mo id="S2.SS1.p1.1.m1.4.4.3.3.8" stretchy="false" xref="S2.SS1.p1.1.m1.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.4b"><apply id="S2.SS1.p1.1.m1.4.4.cmml" xref="S2.SS1.p1.1.m1.4.4"><eq id="S2.SS1.p1.1.m1.4.4.4.cmml" xref="S2.SS1.p1.1.m1.4.4.4"></eq><ci id="S2.SS1.p1.1.m1.4.4.5.cmml" xref="S2.SS1.p1.1.m1.4.4.5">𝑊</ci><set id="S2.SS1.p1.1.m1.4.4.3.4.cmml" xref="S2.SS1.p1.1.m1.4.4.3.3"><apply id="S2.SS1.p1.1.m1.2.2.1.1.1.cmml" xref="S2.SS1.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.1.m1.2.2.1.1.1.1.cmml" xref="S2.SS1.p1.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.1.m1.2.2.1.1.1.2.cmml" xref="S2.SS1.p1.1.m1.2.2.1.1.1.2">𝑤</ci><cn id="S2.SS1.p1.1.m1.2.2.1.1.1.3.cmml" type="integer" xref="S2.SS1.p1.1.m1.2.2.1.1.1.3">1</cn></apply><apply id="S2.SS1.p1.1.m1.3.3.2.2.2.cmml" xref="S2.SS1.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.1.m1.3.3.2.2.2.1.cmml" xref="S2.SS1.p1.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S2.SS1.p1.1.m1.3.3.2.2.2.2.cmml" xref="S2.SS1.p1.1.m1.3.3.2.2.2.2">𝑤</ci><cn id="S2.SS1.p1.1.m1.3.3.2.2.2.3.cmml" type="integer" xref="S2.SS1.p1.1.m1.3.3.2.2.2.3">2</cn></apply><ci id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">…</ci><apply id="S2.SS1.p1.1.m1.4.4.3.3.3.cmml" xref="S2.SS1.p1.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.1.m1.4.4.3.3.3.1.cmml" xref="S2.SS1.p1.1.m1.4.4.3.3.3">subscript</csymbol><ci id="S2.SS1.p1.1.m1.4.4.3.3.3.2.cmml" xref="S2.SS1.p1.1.m1.4.4.3.3.3.2">𝑤</ci><ci id="S2.SS1.p1.1.m1.4.4.3.3.3.3.cmml" xref="S2.SS1.p1.1.m1.4.4.3.3.3.3">𝐿</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.4c">W=\{w_{1},w_{2},\dots,w_{L}\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.1.m1.4d">italic_W = { italic_w start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_w start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_w start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT }</annotation></semantics></math> of length <math alttext="L" class="ltx_Math" display="inline" id="S2.SS1.p1.2.m2.1"><semantics id="S2.SS1.p1.2.m2.1a"><mi id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><ci id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">L</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.2.m2.1d">italic_L</annotation></semantics></math> from the vocabulary <math alttext="\mathcal{W}" class="ltx_Math" display="inline" id="S2.SS1.p1.3.m3.1"><semantics id="S2.SS1.p1.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml">𝒲</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><ci id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1">𝒲</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">\mathcal{W}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.3.m3.1d">caligraphic_W</annotation></semantics></math>, LLMs parameterized by <math alttext="\theta_{1}" class="ltx_Math" display="inline" id="S2.SS1.p1.4.m4.1"><semantics id="S2.SS1.p1.4.m4.1a"><msub id="S2.SS1.p1.4.m4.1.1" xref="S2.SS1.p1.4.m4.1.1.cmml"><mi id="S2.SS1.p1.4.m4.1.1.2" xref="S2.SS1.p1.4.m4.1.1.2.cmml">θ</mi><mn id="S2.SS1.p1.4.m4.1.1.3" xref="S2.SS1.p1.4.m4.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.1b"><apply id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.1.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S2.SS1.p1.4.m4.1.1.2.cmml" xref="S2.SS1.p1.4.m4.1.1.2">𝜃</ci><cn id="S2.SS1.p1.4.m4.1.1.3.cmml" type="integer" xref="S2.SS1.p1.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.1c">\theta_{1}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.4.m4.1d">italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> decompose the joint distribution as <math alttext="p_{\theta_{1}}({W})=\prod_{i=1}^{L}p_{\theta_{1}}(w_{i}|{W}_{<i})" class="ltx_Math" display="inline" id="S2.SS1.p1.5.m5.2"><semantics id="S2.SS1.p1.5.m5.2a"><mrow id="S2.SS1.p1.5.m5.2.2" xref="S2.SS1.p1.5.m5.2.2.cmml"><mrow id="S2.SS1.p1.5.m5.2.2.3" xref="S2.SS1.p1.5.m5.2.2.3.cmml"><msub id="S2.SS1.p1.5.m5.2.2.3.2" xref="S2.SS1.p1.5.m5.2.2.3.2.cmml"><mi id="S2.SS1.p1.5.m5.2.2.3.2.2" xref="S2.SS1.p1.5.m5.2.2.3.2.2.cmml">p</mi><msub id="S2.SS1.p1.5.m5.2.2.3.2.3" xref="S2.SS1.p1.5.m5.2.2.3.2.3.cmml"><mi id="S2.SS1.p1.5.m5.2.2.3.2.3.2" xref="S2.SS1.p1.5.m5.2.2.3.2.3.2.cmml">θ</mi><mn id="S2.SS1.p1.5.m5.2.2.3.2.3.3" xref="S2.SS1.p1.5.m5.2.2.3.2.3.3.cmml">1</mn></msub></msub><mo id="S2.SS1.p1.5.m5.2.2.3.1" xref="S2.SS1.p1.5.m5.2.2.3.1.cmml">⁢</mo><mrow id="S2.SS1.p1.5.m5.2.2.3.3.2" xref="S2.SS1.p1.5.m5.2.2.3.cmml"><mo id="S2.SS1.p1.5.m5.2.2.3.3.2.1" stretchy="false" xref="S2.SS1.p1.5.m5.2.2.3.cmml">(</mo><mi id="S2.SS1.p1.5.m5.1.1" xref="S2.SS1.p1.5.m5.1.1.cmml">W</mi><mo id="S2.SS1.p1.5.m5.2.2.3.3.2.2" stretchy="false" xref="S2.SS1.p1.5.m5.2.2.3.cmml">)</mo></mrow></mrow><mo id="S2.SS1.p1.5.m5.2.2.2" rspace="0.111em" xref="S2.SS1.p1.5.m5.2.2.2.cmml">=</mo><mrow id="S2.SS1.p1.5.m5.2.2.1" xref="S2.SS1.p1.5.m5.2.2.1.cmml"><msubsup id="S2.SS1.p1.5.m5.2.2.1.2" xref="S2.SS1.p1.5.m5.2.2.1.2.cmml"><mo id="S2.SS1.p1.5.m5.2.2.1.2.2.2" xref="S2.SS1.p1.5.m5.2.2.1.2.2.2.cmml">∏</mo><mrow id="S2.SS1.p1.5.m5.2.2.1.2.2.3" xref="S2.SS1.p1.5.m5.2.2.1.2.2.3.cmml"><mi id="S2.SS1.p1.5.m5.2.2.1.2.2.3.2" xref="S2.SS1.p1.5.m5.2.2.1.2.2.3.2.cmml">i</mi><mo id="S2.SS1.p1.5.m5.2.2.1.2.2.3.1" xref="S2.SS1.p1.5.m5.2.2.1.2.2.3.1.cmml">=</mo><mn id="S2.SS1.p1.5.m5.2.2.1.2.2.3.3" xref="S2.SS1.p1.5.m5.2.2.1.2.2.3.3.cmml">1</mn></mrow><mi id="S2.SS1.p1.5.m5.2.2.1.2.3" xref="S2.SS1.p1.5.m5.2.2.1.2.3.cmml">L</mi></msubsup><mrow id="S2.SS1.p1.5.m5.2.2.1.1" xref="S2.SS1.p1.5.m5.2.2.1.1.cmml"><msub id="S2.SS1.p1.5.m5.2.2.1.1.3" xref="S2.SS1.p1.5.m5.2.2.1.1.3.cmml"><mi id="S2.SS1.p1.5.m5.2.2.1.1.3.2" xref="S2.SS1.p1.5.m5.2.2.1.1.3.2.cmml">p</mi><msub id="S2.SS1.p1.5.m5.2.2.1.1.3.3" xref="S2.SS1.p1.5.m5.2.2.1.1.3.3.cmml"><mi id="S2.SS1.p1.5.m5.2.2.1.1.3.3.2" xref="S2.SS1.p1.5.m5.2.2.1.1.3.3.2.cmml">θ</mi><mn id="S2.SS1.p1.5.m5.2.2.1.1.3.3.3" xref="S2.SS1.p1.5.m5.2.2.1.1.3.3.3.cmml">1</mn></msub></msub><mo id="S2.SS1.p1.5.m5.2.2.1.1.2" xref="S2.SS1.p1.5.m5.2.2.1.1.2.cmml">⁢</mo><mrow id="S2.SS1.p1.5.m5.2.2.1.1.1.1" xref="S2.SS1.p1.5.m5.2.2.1.1.1.1.1.cmml"><mo id="S2.SS1.p1.5.m5.2.2.1.1.1.1.2" stretchy="false" xref="S2.SS1.p1.5.m5.2.2.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p1.5.m5.2.2.1.1.1.1.1" xref="S2.SS1.p1.5.m5.2.2.1.1.1.1.1.cmml"><msub id="S2.SS1.p1.5.m5.2.2.1.1.1.1.1.2" xref="S2.SS1.p1.5.m5.2.2.1.1.1.1.1.2.cmml"><mi id="S2.SS1.p1.5.m5.2.2.1.1.1.1.1.2.2" xref="S2.SS1.p1.5.m5.2.2.1.1.1.1.1.2.2.cmml">w</mi><mi id="S2.SS1.p1.5.m5.2.2.1.1.1.1.1.2.3" xref="S2.SS1.p1.5.m5.2.2.1.1.1.1.1.2.3.cmml">i</mi></msub><mo fence="false" id="S2.SS1.p1.5.m5.2.2.1.1.1.1.1.1" xref="S2.SS1.p1.5.m5.2.2.1.1.1.1.1.1.cmml">|</mo><msub id="S2.SS1.p1.5.m5.2.2.1.1.1.1.1.3" xref="S2.SS1.p1.5.m5.2.2.1.1.1.1.1.3.cmml"><mi id="S2.SS1.p1.5.m5.2.2.1.1.1.1.1.3.2" xref="S2.SS1.p1.5.m5.2.2.1.1.1.1.1.3.2.cmml">W</mi><mrow id="S2.SS1.p1.5.m5.2.2.1.1.1.1.1.3.3" xref="S2.SS1.p1.5.m5.2.2.1.1.1.1.1.3.3.cmml"><mi id="S2.SS1.p1.5.m5.2.2.1.1.1.1.1.3.3.2" xref="S2.SS1.p1.5.m5.2.2.1.1.1.1.1.3.3.2.cmml"></mi><mo id="S2.SS1.p1.5.m5.2.2.1.1.1.1.1.3.3.1" xref="S2.SS1.p1.5.m5.2.2.1.1.1.1.1.3.3.1.cmml">&lt;</mo><mi id="S2.SS1.p1.5.m5.2.2.1.1.1.1.1.3.3.3" xref="S2.SS1.p1.5.m5.2.2.1.1.1.1.1.3.3.3.cmml">i</mi></mrow></msub></mrow><mo id="S2.SS1.p1.5.m5.2.2.1.1.1.1.3" stretchy="false" xref="S2.SS1.p1.5.m5.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m5.2b"><apply id="S2.SS1.p1.5.m5.2.2.cmml" xref="S2.SS1.p1.5.m5.2.2"><eq id="S2.SS1.p1.5.m5.2.2.2.cmml" xref="S2.SS1.p1.5.m5.2.2.2"></eq><apply id="S2.SS1.p1.5.m5.2.2.3.cmml" xref="S2.SS1.p1.5.m5.2.2.3"><times id="S2.SS1.p1.5.m5.2.2.3.1.cmml" xref="S2.SS1.p1.5.m5.2.2.3.1"></times><apply id="S2.SS1.p1.5.m5.2.2.3.2.cmml" xref="S2.SS1.p1.5.m5.2.2.3.2"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m5.2.2.3.2.1.cmml" xref="S2.SS1.p1.5.m5.2.2.3.2">subscript</csymbol><ci id="S2.SS1.p1.5.m5.2.2.3.2.2.cmml" xref="S2.SS1.p1.5.m5.2.2.3.2.2">𝑝</ci><apply id="S2.SS1.p1.5.m5.2.2.3.2.3.cmml" xref="S2.SS1.p1.5.m5.2.2.3.2.3"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m5.2.2.3.2.3.1.cmml" xref="S2.SS1.p1.5.m5.2.2.3.2.3">subscript</csymbol><ci id="S2.SS1.p1.5.m5.2.2.3.2.3.2.cmml" xref="S2.SS1.p1.5.m5.2.2.3.2.3.2">𝜃</ci><cn id="S2.SS1.p1.5.m5.2.2.3.2.3.3.cmml" type="integer" xref="S2.SS1.p1.5.m5.2.2.3.2.3.3">1</cn></apply></apply><ci id="S2.SS1.p1.5.m5.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1">𝑊</ci></apply><apply id="S2.SS1.p1.5.m5.2.2.1.cmml" xref="S2.SS1.p1.5.m5.2.2.1"><apply id="S2.SS1.p1.5.m5.2.2.1.2.cmml" xref="S2.SS1.p1.5.m5.2.2.1.2"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m5.2.2.1.2.1.cmml" xref="S2.SS1.p1.5.m5.2.2.1.2">superscript</csymbol><apply id="S2.SS1.p1.5.m5.2.2.1.2.2.cmml" xref="S2.SS1.p1.5.m5.2.2.1.2"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m5.2.2.1.2.2.1.cmml" xref="S2.SS1.p1.5.m5.2.2.1.2">subscript</csymbol><csymbol cd="latexml" id="S2.SS1.p1.5.m5.2.2.1.2.2.2.cmml" xref="S2.SS1.p1.5.m5.2.2.1.2.2.2">product</csymbol><apply id="S2.SS1.p1.5.m5.2.2.1.2.2.3.cmml" xref="S2.SS1.p1.5.m5.2.2.1.2.2.3"><eq id="S2.SS1.p1.5.m5.2.2.1.2.2.3.1.cmml" xref="S2.SS1.p1.5.m5.2.2.1.2.2.3.1"></eq><ci id="S2.SS1.p1.5.m5.2.2.1.2.2.3.2.cmml" xref="S2.SS1.p1.5.m5.2.2.1.2.2.3.2">𝑖</ci><cn id="S2.SS1.p1.5.m5.2.2.1.2.2.3.3.cmml" type="integer" xref="S2.SS1.p1.5.m5.2.2.1.2.2.3.3">1</cn></apply></apply><ci id="S2.SS1.p1.5.m5.2.2.1.2.3.cmml" xref="S2.SS1.p1.5.m5.2.2.1.2.3">𝐿</ci></apply><apply id="S2.SS1.p1.5.m5.2.2.1.1.cmml" xref="S2.SS1.p1.5.m5.2.2.1.1"><times id="S2.SS1.p1.5.m5.2.2.1.1.2.cmml" xref="S2.SS1.p1.5.m5.2.2.1.1.2"></times><apply id="S2.SS1.p1.5.m5.2.2.1.1.3.cmml" xref="S2.SS1.p1.5.m5.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m5.2.2.1.1.3.1.cmml" xref="S2.SS1.p1.5.m5.2.2.1.1.3">subscript</csymbol><ci id="S2.SS1.p1.5.m5.2.2.1.1.3.2.cmml" xref="S2.SS1.p1.5.m5.2.2.1.1.3.2">𝑝</ci><apply id="S2.SS1.p1.5.m5.2.2.1.1.3.3.cmml" xref="S2.SS1.p1.5.m5.2.2.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m5.2.2.1.1.3.3.1.cmml" xref="S2.SS1.p1.5.m5.2.2.1.1.3.3">subscript</csymbol><ci id="S2.SS1.p1.5.m5.2.2.1.1.3.3.2.cmml" xref="S2.SS1.p1.5.m5.2.2.1.1.3.3.2">𝜃</ci><cn id="S2.SS1.p1.5.m5.2.2.1.1.3.3.3.cmml" type="integer" xref="S2.SS1.p1.5.m5.2.2.1.1.3.3.3">1</cn></apply></apply><apply id="S2.SS1.p1.5.m5.2.2.1.1.1.1.1.cmml" xref="S2.SS1.p1.5.m5.2.2.1.1.1.1"><csymbol cd="latexml" id="S2.SS1.p1.5.m5.2.2.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.5.m5.2.2.1.1.1.1.1.1">conditional</csymbol><apply id="S2.SS1.p1.5.m5.2.2.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.5.m5.2.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m5.2.2.1.1.1.1.1.2.1.cmml" xref="S2.SS1.p1.5.m5.2.2.1.1.1.1.1.2">subscript</csymbol><ci id="S2.SS1.p1.5.m5.2.2.1.1.1.1.1.2.2.cmml" xref="S2.SS1.p1.5.m5.2.2.1.1.1.1.1.2.2">𝑤</ci><ci id="S2.SS1.p1.5.m5.2.2.1.1.1.1.1.2.3.cmml" xref="S2.SS1.p1.5.m5.2.2.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S2.SS1.p1.5.m5.2.2.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.5.m5.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m5.2.2.1.1.1.1.1.3.1.cmml" xref="S2.SS1.p1.5.m5.2.2.1.1.1.1.1.3">subscript</csymbol><ci id="S2.SS1.p1.5.m5.2.2.1.1.1.1.1.3.2.cmml" xref="S2.SS1.p1.5.m5.2.2.1.1.1.1.1.3.2">𝑊</ci><apply id="S2.SS1.p1.5.m5.2.2.1.1.1.1.1.3.3.cmml" xref="S2.SS1.p1.5.m5.2.2.1.1.1.1.1.3.3"><lt id="S2.SS1.p1.5.m5.2.2.1.1.1.1.1.3.3.1.cmml" xref="S2.SS1.p1.5.m5.2.2.1.1.1.1.1.3.3.1"></lt><csymbol cd="latexml" id="S2.SS1.p1.5.m5.2.2.1.1.1.1.1.3.3.2.cmml" xref="S2.SS1.p1.5.m5.2.2.1.1.1.1.1.3.3.2">absent</csymbol><ci id="S2.SS1.p1.5.m5.2.2.1.1.1.1.1.3.3.3.cmml" xref="S2.SS1.p1.5.m5.2.2.1.1.1.1.1.3.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m5.2c">p_{\theta_{1}}({W})=\prod_{i=1}^{L}p_{\theta_{1}}(w_{i}|{W}_{&lt;i})</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.5.m5.2d">italic_p start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_W ) = ∏ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT italic_p start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_w start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | italic_W start_POSTSUBSCRIPT &lt; italic_i end_POSTSUBSCRIPT )</annotation></semantics></math>, where <math alttext="W_{<i}" class="ltx_Math" display="inline" id="S2.SS1.p1.6.m6.1"><semantics id="S2.SS1.p1.6.m6.1a"><msub id="S2.SS1.p1.6.m6.1.1" xref="S2.SS1.p1.6.m6.1.1.cmml"><mi id="S2.SS1.p1.6.m6.1.1.2" xref="S2.SS1.p1.6.m6.1.1.2.cmml">W</mi><mrow id="S2.SS1.p1.6.m6.1.1.3" xref="S2.SS1.p1.6.m6.1.1.3.cmml"><mi id="S2.SS1.p1.6.m6.1.1.3.2" xref="S2.SS1.p1.6.m6.1.1.3.2.cmml"></mi><mo id="S2.SS1.p1.6.m6.1.1.3.1" xref="S2.SS1.p1.6.m6.1.1.3.1.cmml">&lt;</mo><mi id="S2.SS1.p1.6.m6.1.1.3.3" xref="S2.SS1.p1.6.m6.1.1.3.3.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m6.1b"><apply id="S2.SS1.p1.6.m6.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.6.m6.1.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1">subscript</csymbol><ci id="S2.SS1.p1.6.m6.1.1.2.cmml" xref="S2.SS1.p1.6.m6.1.1.2">𝑊</ci><apply id="S2.SS1.p1.6.m6.1.1.3.cmml" xref="S2.SS1.p1.6.m6.1.1.3"><lt id="S2.SS1.p1.6.m6.1.1.3.1.cmml" xref="S2.SS1.p1.6.m6.1.1.3.1"></lt><csymbol cd="latexml" id="S2.SS1.p1.6.m6.1.1.3.2.cmml" xref="S2.SS1.p1.6.m6.1.1.3.2">absent</csymbol><ci id="S2.SS1.p1.6.m6.1.1.3.3.cmml" xref="S2.SS1.p1.6.m6.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m6.1c">W_{&lt;i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.6.m6.1d">italic_W start_POSTSUBSCRIPT &lt; italic_i end_POSTSUBSCRIPT</annotation></semantics></math> represents the tokens preceding the <math alttext="i" class="ltx_Math" display="inline" id="S2.SS1.p1.7.m7.1"><semantics id="S2.SS1.p1.7.m7.1a"><mi id="S2.SS1.p1.7.m7.1.1" xref="S2.SS1.p1.7.m7.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.7.m7.1b"><ci id="S2.SS1.p1.7.m7.1.1.cmml" xref="S2.SS1.p1.7.m7.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.7.m7.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.7.m7.1d">italic_i</annotation></semantics></math>-th position.
These models are optimized by minimizing the negative log-likelihood between their predictions and the empirical data distribution, resulting in:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\text{LM}}=\sum_{i}-\log p_{\theta_{1}}(w_{i}|{W}_{<i})." class="ltx_Math" display="block" id="S2.E1.m1.1"><semantics id="S2.E1.m1.1a"><mrow id="S2.E1.m1.1.1.1" xref="S2.E1.m1.1.1.1.1.cmml"><mrow id="S2.E1.m1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.cmml"><msub id="S2.E1.m1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.1.1.1.1.3.2" xref="S2.E1.m1.1.1.1.1.3.2.cmml">ℒ</mi><mtext id="S2.E1.m1.1.1.1.1.3.3" xref="S2.E1.m1.1.1.1.1.3.3a.cmml">LM</mtext></msub><mo id="S2.E1.m1.1.1.1.1.2" rspace="0.111em" xref="S2.E1.m1.1.1.1.1.2.cmml">=</mo><mrow id="S2.E1.m1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.cmml"><munder id="S2.E1.m1.1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.3.cmml"><mo id="S2.E1.m1.1.1.1.1.1.3.2" movablelimits="false" rspace="0em" xref="S2.E1.m1.1.1.1.1.1.3.2.cmml">∑</mo><mi id="S2.E1.m1.1.1.1.1.1.3.3" xref="S2.E1.m1.1.1.1.1.1.3.3.cmml">i</mi></munder><mo id="S2.E1.m1.1.1.1.1.1.2" lspace="0em" xref="S2.E1.m1.1.1.1.1.1.2.cmml">−</mo><mrow id="S2.E1.m1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.cmml"><mrow id="S2.E1.m1.1.1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.1.3.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.3.1" xref="S2.E1.m1.1.1.1.1.1.1.3.1.cmml">log</mi><mo id="S2.E1.m1.1.1.1.1.1.1.3a" lspace="0.167em" xref="S2.E1.m1.1.1.1.1.1.1.3.cmml">⁡</mo><msub id="S2.E1.m1.1.1.1.1.1.1.3.2" xref="S2.E1.m1.1.1.1.1.1.1.3.2.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.3.2.2" xref="S2.E1.m1.1.1.1.1.1.1.3.2.2.cmml">p</mi><msub id="S2.E1.m1.1.1.1.1.1.1.3.2.3" xref="S2.E1.m1.1.1.1.1.1.1.3.2.3.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.3.2.3.2" xref="S2.E1.m1.1.1.1.1.1.1.3.2.3.2.cmml">θ</mi><mn id="S2.E1.m1.1.1.1.1.1.1.3.2.3.3" xref="S2.E1.m1.1.1.1.1.1.1.3.2.3.3.cmml">1</mn></msub></msub></mrow><mo id="S2.E1.m1.1.1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E1.m1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E1.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E1.m1.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E1.m1.1.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">w</mi><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo fence="false" id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S2.E1.m1.1.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">W</mi><mrow id="S2.E1.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.3.3.2.cmml"></mi><mo id="S2.E1.m1.1.1.1.1.1.1.1.1.1.3.3.1" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">&lt;</mo><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">i</mi></mrow></msub></mrow><mo id="S2.E1.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E1.m1.1.1.1.2" lspace="0em" xref="S2.E1.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.1b"><apply id="S2.E1.m1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1"><eq id="S2.E1.m1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.2"></eq><apply id="S2.E1.m1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.1.1.1.1.3">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.1.1.1.1.3.2">ℒ</ci><ci id="S2.E1.m1.1.1.1.1.3.3a.cmml" xref="S2.E1.m1.1.1.1.1.3.3"><mtext id="S2.E1.m1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S2.E1.m1.1.1.1.1.3.3">LM</mtext></ci></apply><apply id="S2.E1.m1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1"><minus id="S2.E1.m1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.2"></minus><apply id="S2.E1.m1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.1.1.1.1.1.3">subscript</csymbol><sum id="S2.E1.m1.1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.1.1.1.1.1.3.2"></sum><ci id="S2.E1.m1.1.1.1.1.1.3.3.cmml" xref="S2.E1.m1.1.1.1.1.1.3.3">𝑖</ci></apply><apply id="S2.E1.m1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1"><times id="S2.E1.m1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.2"></times><apply id="S2.E1.m1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3"><log id="S2.E1.m1.1.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.1"></log><apply id="S2.E1.m1.1.1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.2.2">𝑝</ci><apply id="S2.E1.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.1.3.2.3.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.2.3">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.1.1.3.2.3.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.2.3.2">𝜃</ci><cn id="S2.E1.m1.1.1.1.1.1.1.3.2.3.3.cmml" type="integer" xref="S2.E1.m1.1.1.1.1.1.1.3.2.3.3">1</cn></apply></apply></apply><apply id="S2.E1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S2.E1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.2.2">𝑤</ci><ci id="S2.E1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S2.E1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.3.2">𝑊</ci><apply id="S2.E1.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.3.3"><lt id="S2.E1.m1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.3.3.1"></lt><csymbol cd="latexml" id="S2.E1.m1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.3.3.2">absent</csymbol><ci id="S2.E1.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.3.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.1c">\mathcal{L}_{\text{LM}}=\sum_{i}-\log p_{\theta_{1}}(w_{i}|{W}_{&lt;i}).</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.1d">caligraphic_L start_POSTSUBSCRIPT LM end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT - roman_log italic_p start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_w start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | italic_W start_POSTSUBSCRIPT &lt; italic_i end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Molecular Design with Graph Diffusion Models</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.21">Molecular graphs can be modeled through diffusion in discrete spaces&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Austin et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib3" title="">2021</a>; Vignac et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib40" title="">2022</a>; Liu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib27" title="">2024c</a>)</cite>. Given a one-hot encoded data point <math alttext="\mathbf{x}\in\mathbb{R}^{F}" class="ltx_Math" display="inline" id="S2.SS2.p1.1.m1.1"><semantics id="S2.SS2.p1.1.m1.1a"><mrow id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml"><mi id="S2.SS2.p1.1.m1.1.1.2" xref="S2.SS2.p1.1.m1.1.1.2.cmml">𝐱</mi><mo id="S2.SS2.p1.1.m1.1.1.1" xref="S2.SS2.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S2.SS2.p1.1.m1.1.1.3" xref="S2.SS2.p1.1.m1.1.1.3.cmml"><mi id="S2.SS2.p1.1.m1.1.1.3.2" xref="S2.SS2.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mi id="S2.SS2.p1.1.m1.1.1.3.3" xref="S2.SS2.p1.1.m1.1.1.3.3.cmml">F</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><apply id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1"><in id="S2.SS2.p1.1.m1.1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1.1"></in><ci id="S2.SS2.p1.1.m1.1.1.2.cmml" xref="S2.SS2.p1.1.m1.1.1.2">𝐱</ci><apply id="S2.SS2.p1.1.m1.1.1.3.cmml" xref="S2.SS2.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.1.1.3.1.cmml" xref="S2.SS2.p1.1.m1.1.1.3">superscript</csymbol><ci id="S2.SS2.p1.1.m1.1.1.3.2.cmml" xref="S2.SS2.p1.1.m1.1.1.3.2">ℝ</ci><ci id="S2.SS2.p1.1.m1.1.1.3.3.cmml" xref="S2.SS2.p1.1.m1.1.1.3.3">𝐹</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">\mathbf{x}\in\mathbb{R}^{F}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.1.m1.1d">bold_x ∈ blackboard_R start_POSTSUPERSCRIPT italic_F end_POSTSUPERSCRIPT</annotation></semantics></math> with <math alttext="F" class="ltx_Math" display="inline" id="S2.SS2.p1.2.m2.1"><semantics id="S2.SS2.p1.2.m2.1a"><mi id="S2.SS2.p1.2.m2.1.1" xref="S2.SS2.p1.2.m2.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m2.1b"><ci id="S2.SS2.p1.2.m2.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m2.1c">F</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.2.m2.1d">italic_F</annotation></semantics></math> categories (e.g., a node or an edge), discrete models perform diffusion using a transition matrix <math alttext="\mathbf{Q}" class="ltx_Math" display="inline" id="S2.SS2.p1.3.m3.1"><semantics id="S2.SS2.p1.3.m3.1a"><mi id="S2.SS2.p1.3.m3.1.1" xref="S2.SS2.p1.3.m3.1.1.cmml">𝐐</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.3.m3.1b"><ci id="S2.SS2.p1.3.m3.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1">𝐐</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.3.m3.1c">\mathbf{Q}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.3.m3.1d">bold_Q</annotation></semantics></math>, where <math alttext="[\mathbf{Q}^{t}]_{ij}=q(\mathbf{x}^{t}_{j}\mid\mathbf{x}^{t-1}_{i})" class="ltx_Math" display="inline" id="S2.SS2.p1.4.m4.2"><semantics id="S2.SS2.p1.4.m4.2a"><mrow id="S2.SS2.p1.4.m4.2.2" xref="S2.SS2.p1.4.m4.2.2.cmml"><msub id="S2.SS2.p1.4.m4.1.1.1" xref="S2.SS2.p1.4.m4.1.1.1.cmml"><mrow id="S2.SS2.p1.4.m4.1.1.1.1.1" xref="S2.SS2.p1.4.m4.1.1.1.1.2.cmml"><mo id="S2.SS2.p1.4.m4.1.1.1.1.1.2" stretchy="false" xref="S2.SS2.p1.4.m4.1.1.1.1.2.1.cmml">[</mo><msup id="S2.SS2.p1.4.m4.1.1.1.1.1.1" xref="S2.SS2.p1.4.m4.1.1.1.1.1.1.cmml"><mi id="S2.SS2.p1.4.m4.1.1.1.1.1.1.2" xref="S2.SS2.p1.4.m4.1.1.1.1.1.1.2.cmml">𝐐</mi><mi id="S2.SS2.p1.4.m4.1.1.1.1.1.1.3" xref="S2.SS2.p1.4.m4.1.1.1.1.1.1.3.cmml">t</mi></msup><mo id="S2.SS2.p1.4.m4.1.1.1.1.1.3" stretchy="false" xref="S2.SS2.p1.4.m4.1.1.1.1.2.1.cmml">]</mo></mrow><mrow id="S2.SS2.p1.4.m4.1.1.1.3" xref="S2.SS2.p1.4.m4.1.1.1.3.cmml"><mi id="S2.SS2.p1.4.m4.1.1.1.3.2" xref="S2.SS2.p1.4.m4.1.1.1.3.2.cmml">i</mi><mo id="S2.SS2.p1.4.m4.1.1.1.3.1" xref="S2.SS2.p1.4.m4.1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS2.p1.4.m4.1.1.1.3.3" xref="S2.SS2.p1.4.m4.1.1.1.3.3.cmml">j</mi></mrow></msub><mo id="S2.SS2.p1.4.m4.2.2.3" xref="S2.SS2.p1.4.m4.2.2.3.cmml">=</mo><mrow id="S2.SS2.p1.4.m4.2.2.2" xref="S2.SS2.p1.4.m4.2.2.2.cmml"><mi id="S2.SS2.p1.4.m4.2.2.2.3" xref="S2.SS2.p1.4.m4.2.2.2.3.cmml">q</mi><mo id="S2.SS2.p1.4.m4.2.2.2.2" xref="S2.SS2.p1.4.m4.2.2.2.2.cmml">⁢</mo><mrow id="S2.SS2.p1.4.m4.2.2.2.1.1" xref="S2.SS2.p1.4.m4.2.2.2.1.1.1.cmml"><mo id="S2.SS2.p1.4.m4.2.2.2.1.1.2" stretchy="false" xref="S2.SS2.p1.4.m4.2.2.2.1.1.1.cmml">(</mo><mrow id="S2.SS2.p1.4.m4.2.2.2.1.1.1" xref="S2.SS2.p1.4.m4.2.2.2.1.1.1.cmml"><msubsup id="S2.SS2.p1.4.m4.2.2.2.1.1.1.2" xref="S2.SS2.p1.4.m4.2.2.2.1.1.1.2.cmml"><mi id="S2.SS2.p1.4.m4.2.2.2.1.1.1.2.2.2" xref="S2.SS2.p1.4.m4.2.2.2.1.1.1.2.2.2.cmml">𝐱</mi><mi id="S2.SS2.p1.4.m4.2.2.2.1.1.1.2.3" xref="S2.SS2.p1.4.m4.2.2.2.1.1.1.2.3.cmml">j</mi><mi id="S2.SS2.p1.4.m4.2.2.2.1.1.1.2.2.3" xref="S2.SS2.p1.4.m4.2.2.2.1.1.1.2.2.3.cmml">t</mi></msubsup><mo id="S2.SS2.p1.4.m4.2.2.2.1.1.1.1" xref="S2.SS2.p1.4.m4.2.2.2.1.1.1.1.cmml">∣</mo><msubsup id="S2.SS2.p1.4.m4.2.2.2.1.1.1.3" xref="S2.SS2.p1.4.m4.2.2.2.1.1.1.3.cmml"><mi id="S2.SS2.p1.4.m4.2.2.2.1.1.1.3.2.2" xref="S2.SS2.p1.4.m4.2.2.2.1.1.1.3.2.2.cmml">𝐱</mi><mi id="S2.SS2.p1.4.m4.2.2.2.1.1.1.3.3" xref="S2.SS2.p1.4.m4.2.2.2.1.1.1.3.3.cmml">i</mi><mrow id="S2.SS2.p1.4.m4.2.2.2.1.1.1.3.2.3" xref="S2.SS2.p1.4.m4.2.2.2.1.1.1.3.2.3.cmml"><mi id="S2.SS2.p1.4.m4.2.2.2.1.1.1.3.2.3.2" xref="S2.SS2.p1.4.m4.2.2.2.1.1.1.3.2.3.2.cmml">t</mi><mo id="S2.SS2.p1.4.m4.2.2.2.1.1.1.3.2.3.1" xref="S2.SS2.p1.4.m4.2.2.2.1.1.1.3.2.3.1.cmml">−</mo><mn id="S2.SS2.p1.4.m4.2.2.2.1.1.1.3.2.3.3" xref="S2.SS2.p1.4.m4.2.2.2.1.1.1.3.2.3.3.cmml">1</mn></mrow></msubsup></mrow><mo id="S2.SS2.p1.4.m4.2.2.2.1.1.3" stretchy="false" xref="S2.SS2.p1.4.m4.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.4.m4.2b"><apply id="S2.SS2.p1.4.m4.2.2.cmml" xref="S2.SS2.p1.4.m4.2.2"><eq id="S2.SS2.p1.4.m4.2.2.3.cmml" xref="S2.SS2.p1.4.m4.2.2.3"></eq><apply id="S2.SS2.p1.4.m4.1.1.1.cmml" xref="S2.SS2.p1.4.m4.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.4.m4.1.1.1.2.cmml" xref="S2.SS2.p1.4.m4.1.1.1">subscript</csymbol><apply id="S2.SS2.p1.4.m4.1.1.1.1.2.cmml" xref="S2.SS2.p1.4.m4.1.1.1.1.1"><csymbol cd="latexml" id="S2.SS2.p1.4.m4.1.1.1.1.2.1.cmml" xref="S2.SS2.p1.4.m4.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.SS2.p1.4.m4.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.4.m4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.4.m4.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.4.m4.1.1.1.1.1.1">superscript</csymbol><ci id="S2.SS2.p1.4.m4.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.4.m4.1.1.1.1.1.1.2">𝐐</ci><ci id="S2.SS2.p1.4.m4.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.4.m4.1.1.1.1.1.1.3">𝑡</ci></apply></apply><apply id="S2.SS2.p1.4.m4.1.1.1.3.cmml" xref="S2.SS2.p1.4.m4.1.1.1.3"><times id="S2.SS2.p1.4.m4.1.1.1.3.1.cmml" xref="S2.SS2.p1.4.m4.1.1.1.3.1"></times><ci id="S2.SS2.p1.4.m4.1.1.1.3.2.cmml" xref="S2.SS2.p1.4.m4.1.1.1.3.2">𝑖</ci><ci id="S2.SS2.p1.4.m4.1.1.1.3.3.cmml" xref="S2.SS2.p1.4.m4.1.1.1.3.3">𝑗</ci></apply></apply><apply id="S2.SS2.p1.4.m4.2.2.2.cmml" xref="S2.SS2.p1.4.m4.2.2.2"><times id="S2.SS2.p1.4.m4.2.2.2.2.cmml" xref="S2.SS2.p1.4.m4.2.2.2.2"></times><ci id="S2.SS2.p1.4.m4.2.2.2.3.cmml" xref="S2.SS2.p1.4.m4.2.2.2.3">𝑞</ci><apply id="S2.SS2.p1.4.m4.2.2.2.1.1.1.cmml" xref="S2.SS2.p1.4.m4.2.2.2.1.1"><csymbol cd="latexml" id="S2.SS2.p1.4.m4.2.2.2.1.1.1.1.cmml" xref="S2.SS2.p1.4.m4.2.2.2.1.1.1.1">conditional</csymbol><apply id="S2.SS2.p1.4.m4.2.2.2.1.1.1.2.cmml" xref="S2.SS2.p1.4.m4.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p1.4.m4.2.2.2.1.1.1.2.1.cmml" xref="S2.SS2.p1.4.m4.2.2.2.1.1.1.2">subscript</csymbol><apply id="S2.SS2.p1.4.m4.2.2.2.1.1.1.2.2.cmml" xref="S2.SS2.p1.4.m4.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p1.4.m4.2.2.2.1.1.1.2.2.1.cmml" xref="S2.SS2.p1.4.m4.2.2.2.1.1.1.2">superscript</csymbol><ci id="S2.SS2.p1.4.m4.2.2.2.1.1.1.2.2.2.cmml" xref="S2.SS2.p1.4.m4.2.2.2.1.1.1.2.2.2">𝐱</ci><ci id="S2.SS2.p1.4.m4.2.2.2.1.1.1.2.2.3.cmml" xref="S2.SS2.p1.4.m4.2.2.2.1.1.1.2.2.3">𝑡</ci></apply><ci id="S2.SS2.p1.4.m4.2.2.2.1.1.1.2.3.cmml" xref="S2.SS2.p1.4.m4.2.2.2.1.1.1.2.3">𝑗</ci></apply><apply id="S2.SS2.p1.4.m4.2.2.2.1.1.1.3.cmml" xref="S2.SS2.p1.4.m4.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p1.4.m4.2.2.2.1.1.1.3.1.cmml" xref="S2.SS2.p1.4.m4.2.2.2.1.1.1.3">subscript</csymbol><apply id="S2.SS2.p1.4.m4.2.2.2.1.1.1.3.2.cmml" xref="S2.SS2.p1.4.m4.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p1.4.m4.2.2.2.1.1.1.3.2.1.cmml" xref="S2.SS2.p1.4.m4.2.2.2.1.1.1.3">superscript</csymbol><ci id="S2.SS2.p1.4.m4.2.2.2.1.1.1.3.2.2.cmml" xref="S2.SS2.p1.4.m4.2.2.2.1.1.1.3.2.2">𝐱</ci><apply id="S2.SS2.p1.4.m4.2.2.2.1.1.1.3.2.3.cmml" xref="S2.SS2.p1.4.m4.2.2.2.1.1.1.3.2.3"><minus id="S2.SS2.p1.4.m4.2.2.2.1.1.1.3.2.3.1.cmml" xref="S2.SS2.p1.4.m4.2.2.2.1.1.1.3.2.3.1"></minus><ci id="S2.SS2.p1.4.m4.2.2.2.1.1.1.3.2.3.2.cmml" xref="S2.SS2.p1.4.m4.2.2.2.1.1.1.3.2.3.2">𝑡</ci><cn id="S2.SS2.p1.4.m4.2.2.2.1.1.1.3.2.3.3.cmml" type="integer" xref="S2.SS2.p1.4.m4.2.2.2.1.1.1.3.2.3.3">1</cn></apply></apply><ci id="S2.SS2.p1.4.m4.2.2.2.1.1.1.3.3.cmml" xref="S2.SS2.p1.4.m4.2.2.2.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.4.m4.2c">[\mathbf{Q}^{t}]_{ij}=q(\mathbf{x}^{t}_{j}\mid\mathbf{x}^{t-1}_{i})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.4.m4.2d">[ bold_Q start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ] start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT = italic_q ( bold_x start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∣ bold_x start_POSTSUPERSCRIPT italic_t - 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math> for <math alttext="i,j\in[1,F]" class="ltx_Math" display="inline" id="S2.SS2.p1.5.m5.4"><semantics id="S2.SS2.p1.5.m5.4a"><mrow id="S2.SS2.p1.5.m5.4.5" xref="S2.SS2.p1.5.m5.4.5.cmml"><mrow id="S2.SS2.p1.5.m5.4.5.2.2" xref="S2.SS2.p1.5.m5.4.5.2.1.cmml"><mi id="S2.SS2.p1.5.m5.3.3" xref="S2.SS2.p1.5.m5.3.3.cmml">i</mi><mo id="S2.SS2.p1.5.m5.4.5.2.2.1" xref="S2.SS2.p1.5.m5.4.5.2.1.cmml">,</mo><mi id="S2.SS2.p1.5.m5.4.4" xref="S2.SS2.p1.5.m5.4.4.cmml">j</mi></mrow><mo id="S2.SS2.p1.5.m5.4.5.1" xref="S2.SS2.p1.5.m5.4.5.1.cmml">∈</mo><mrow id="S2.SS2.p1.5.m5.4.5.3.2" xref="S2.SS2.p1.5.m5.4.5.3.1.cmml"><mo id="S2.SS2.p1.5.m5.4.5.3.2.1" stretchy="false" xref="S2.SS2.p1.5.m5.4.5.3.1.cmml">[</mo><mn id="S2.SS2.p1.5.m5.1.1" xref="S2.SS2.p1.5.m5.1.1.cmml">1</mn><mo id="S2.SS2.p1.5.m5.4.5.3.2.2" xref="S2.SS2.p1.5.m5.4.5.3.1.cmml">,</mo><mi id="S2.SS2.p1.5.m5.2.2" xref="S2.SS2.p1.5.m5.2.2.cmml">F</mi><mo id="S2.SS2.p1.5.m5.4.5.3.2.3" stretchy="false" xref="S2.SS2.p1.5.m5.4.5.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.5.m5.4b"><apply id="S2.SS2.p1.5.m5.4.5.cmml" xref="S2.SS2.p1.5.m5.4.5"><in id="S2.SS2.p1.5.m5.4.5.1.cmml" xref="S2.SS2.p1.5.m5.4.5.1"></in><list id="S2.SS2.p1.5.m5.4.5.2.1.cmml" xref="S2.SS2.p1.5.m5.4.5.2.2"><ci id="S2.SS2.p1.5.m5.3.3.cmml" xref="S2.SS2.p1.5.m5.3.3">𝑖</ci><ci id="S2.SS2.p1.5.m5.4.4.cmml" xref="S2.SS2.p1.5.m5.4.4">𝑗</ci></list><interval closure="closed" id="S2.SS2.p1.5.m5.4.5.3.1.cmml" xref="S2.SS2.p1.5.m5.4.5.3.2"><cn id="S2.SS2.p1.5.m5.1.1.cmml" type="integer" xref="S2.SS2.p1.5.m5.1.1">1</cn><ci id="S2.SS2.p1.5.m5.2.2.cmml" xref="S2.SS2.p1.5.m5.2.2">𝐹</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.5.m5.4c">i,j\in[1,F]</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.5.m5.4d">italic_i , italic_j ∈ [ 1 , italic_F ]</annotation></semantics></math>.
The forward diffusion with <math alttext="\mathbf{Q}" class="ltx_Math" display="inline" id="S2.SS2.p1.6.m6.1"><semantics id="S2.SS2.p1.6.m6.1a"><mi id="S2.SS2.p1.6.m6.1.1" xref="S2.SS2.p1.6.m6.1.1.cmml">𝐐</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.6.m6.1b"><ci id="S2.SS2.p1.6.m6.1.1.cmml" xref="S2.SS2.p1.6.m6.1.1">𝐐</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.6.m6.1c">\mathbf{Q}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.6.m6.1d">bold_Q</annotation></semantics></math> is: <math alttext="q(\mathbf{x}^{t}\mid\mathbf{x}^{t-1})=\operatorname{Cat}(\mathbf{x}_{t};%
\mathbf{p}=\mathbf{x}^{t-1}\mathbf{Q}^{t})" class="ltx_Math" display="inline" id="S2.SS2.p1.7.m7.4"><semantics id="S2.SS2.p1.7.m7.4a"><mrow id="S2.SS2.p1.7.m7.4.4" xref="S2.SS2.p1.7.m7.4.4.cmml"><mrow id="S2.SS2.p1.7.m7.2.2.1" xref="S2.SS2.p1.7.m7.2.2.1.cmml"><mi id="S2.SS2.p1.7.m7.2.2.1.3" xref="S2.SS2.p1.7.m7.2.2.1.3.cmml">q</mi><mo id="S2.SS2.p1.7.m7.2.2.1.2" xref="S2.SS2.p1.7.m7.2.2.1.2.cmml">⁢</mo><mrow id="S2.SS2.p1.7.m7.2.2.1.1.1" xref="S2.SS2.p1.7.m7.2.2.1.1.1.1.cmml"><mo id="S2.SS2.p1.7.m7.2.2.1.1.1.2" stretchy="false" xref="S2.SS2.p1.7.m7.2.2.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p1.7.m7.2.2.1.1.1.1" xref="S2.SS2.p1.7.m7.2.2.1.1.1.1.cmml"><msup id="S2.SS2.p1.7.m7.2.2.1.1.1.1.2" xref="S2.SS2.p1.7.m7.2.2.1.1.1.1.2.cmml"><mi id="S2.SS2.p1.7.m7.2.2.1.1.1.1.2.2" xref="S2.SS2.p1.7.m7.2.2.1.1.1.1.2.2.cmml">𝐱</mi><mi id="S2.SS2.p1.7.m7.2.2.1.1.1.1.2.3" xref="S2.SS2.p1.7.m7.2.2.1.1.1.1.2.3.cmml">t</mi></msup><mo id="S2.SS2.p1.7.m7.2.2.1.1.1.1.1" xref="S2.SS2.p1.7.m7.2.2.1.1.1.1.1.cmml">∣</mo><msup id="S2.SS2.p1.7.m7.2.2.1.1.1.1.3" xref="S2.SS2.p1.7.m7.2.2.1.1.1.1.3.cmml"><mi id="S2.SS2.p1.7.m7.2.2.1.1.1.1.3.2" xref="S2.SS2.p1.7.m7.2.2.1.1.1.1.3.2.cmml">𝐱</mi><mrow id="S2.SS2.p1.7.m7.2.2.1.1.1.1.3.3" xref="S2.SS2.p1.7.m7.2.2.1.1.1.1.3.3.cmml"><mi id="S2.SS2.p1.7.m7.2.2.1.1.1.1.3.3.2" xref="S2.SS2.p1.7.m7.2.2.1.1.1.1.3.3.2.cmml">t</mi><mo id="S2.SS2.p1.7.m7.2.2.1.1.1.1.3.3.1" xref="S2.SS2.p1.7.m7.2.2.1.1.1.1.3.3.1.cmml">−</mo><mn id="S2.SS2.p1.7.m7.2.2.1.1.1.1.3.3.3" xref="S2.SS2.p1.7.m7.2.2.1.1.1.1.3.3.3.cmml">1</mn></mrow></msup></mrow><mo id="S2.SS2.p1.7.m7.2.2.1.1.1.3" stretchy="false" xref="S2.SS2.p1.7.m7.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.SS2.p1.7.m7.4.4.4" xref="S2.SS2.p1.7.m7.4.4.4.cmml">=</mo><mrow id="S2.SS2.p1.7.m7.4.4.3.2" xref="S2.SS2.p1.7.m7.4.4.3.3.cmml"><mi id="S2.SS2.p1.7.m7.1.1" xref="S2.SS2.p1.7.m7.1.1.cmml">Cat</mi><mo id="S2.SS2.p1.7.m7.4.4.3.2a" xref="S2.SS2.p1.7.m7.4.4.3.3.cmml">⁡</mo><mrow id="S2.SS2.p1.7.m7.4.4.3.2.2" xref="S2.SS2.p1.7.m7.4.4.3.3.cmml"><mo id="S2.SS2.p1.7.m7.4.4.3.2.2.3" stretchy="false" xref="S2.SS2.p1.7.m7.4.4.3.3.cmml">(</mo><msub id="S2.SS2.p1.7.m7.3.3.2.1.1.1" xref="S2.SS2.p1.7.m7.3.3.2.1.1.1.cmml"><mi id="S2.SS2.p1.7.m7.3.3.2.1.1.1.2" xref="S2.SS2.p1.7.m7.3.3.2.1.1.1.2.cmml">𝐱</mi><mi id="S2.SS2.p1.7.m7.3.3.2.1.1.1.3" xref="S2.SS2.p1.7.m7.3.3.2.1.1.1.3.cmml">t</mi></msub><mo id="S2.SS2.p1.7.m7.4.4.3.2.2.4" xref="S2.SS2.p1.7.m7.4.4.3.3.cmml">;</mo><mrow id="S2.SS2.p1.7.m7.4.4.3.2.2.2" xref="S2.SS2.p1.7.m7.4.4.3.2.2.2.cmml"><mi id="S2.SS2.p1.7.m7.4.4.3.2.2.2.2" xref="S2.SS2.p1.7.m7.4.4.3.2.2.2.2.cmml">𝐩</mi><mo id="S2.SS2.p1.7.m7.4.4.3.2.2.2.1" xref="S2.SS2.p1.7.m7.4.4.3.2.2.2.1.cmml">=</mo><mrow id="S2.SS2.p1.7.m7.4.4.3.2.2.2.3" xref="S2.SS2.p1.7.m7.4.4.3.2.2.2.3.cmml"><msup id="S2.SS2.p1.7.m7.4.4.3.2.2.2.3.2" xref="S2.SS2.p1.7.m7.4.4.3.2.2.2.3.2.cmml"><mi id="S2.SS2.p1.7.m7.4.4.3.2.2.2.3.2.2" xref="S2.SS2.p1.7.m7.4.4.3.2.2.2.3.2.2.cmml">𝐱</mi><mrow id="S2.SS2.p1.7.m7.4.4.3.2.2.2.3.2.3" xref="S2.SS2.p1.7.m7.4.4.3.2.2.2.3.2.3.cmml"><mi id="S2.SS2.p1.7.m7.4.4.3.2.2.2.3.2.3.2" xref="S2.SS2.p1.7.m7.4.4.3.2.2.2.3.2.3.2.cmml">t</mi><mo id="S2.SS2.p1.7.m7.4.4.3.2.2.2.3.2.3.1" xref="S2.SS2.p1.7.m7.4.4.3.2.2.2.3.2.3.1.cmml">−</mo><mn id="S2.SS2.p1.7.m7.4.4.3.2.2.2.3.2.3.3" xref="S2.SS2.p1.7.m7.4.4.3.2.2.2.3.2.3.3.cmml">1</mn></mrow></msup><mo id="S2.SS2.p1.7.m7.4.4.3.2.2.2.3.1" xref="S2.SS2.p1.7.m7.4.4.3.2.2.2.3.1.cmml">⁢</mo><msup id="S2.SS2.p1.7.m7.4.4.3.2.2.2.3.3" xref="S2.SS2.p1.7.m7.4.4.3.2.2.2.3.3.cmml"><mi id="S2.SS2.p1.7.m7.4.4.3.2.2.2.3.3.2" xref="S2.SS2.p1.7.m7.4.4.3.2.2.2.3.3.2.cmml">𝐐</mi><mi id="S2.SS2.p1.7.m7.4.4.3.2.2.2.3.3.3" xref="S2.SS2.p1.7.m7.4.4.3.2.2.2.3.3.3.cmml">t</mi></msup></mrow></mrow><mo id="S2.SS2.p1.7.m7.4.4.3.2.2.5" stretchy="false" xref="S2.SS2.p1.7.m7.4.4.3.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.7.m7.4b"><apply id="S2.SS2.p1.7.m7.4.4.cmml" xref="S2.SS2.p1.7.m7.4.4"><eq id="S2.SS2.p1.7.m7.4.4.4.cmml" xref="S2.SS2.p1.7.m7.4.4.4"></eq><apply id="S2.SS2.p1.7.m7.2.2.1.cmml" xref="S2.SS2.p1.7.m7.2.2.1"><times id="S2.SS2.p1.7.m7.2.2.1.2.cmml" xref="S2.SS2.p1.7.m7.2.2.1.2"></times><ci id="S2.SS2.p1.7.m7.2.2.1.3.cmml" xref="S2.SS2.p1.7.m7.2.2.1.3">𝑞</ci><apply id="S2.SS2.p1.7.m7.2.2.1.1.1.1.cmml" xref="S2.SS2.p1.7.m7.2.2.1.1.1"><csymbol cd="latexml" id="S2.SS2.p1.7.m7.2.2.1.1.1.1.1.cmml" xref="S2.SS2.p1.7.m7.2.2.1.1.1.1.1">conditional</csymbol><apply id="S2.SS2.p1.7.m7.2.2.1.1.1.1.2.cmml" xref="S2.SS2.p1.7.m7.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p1.7.m7.2.2.1.1.1.1.2.1.cmml" xref="S2.SS2.p1.7.m7.2.2.1.1.1.1.2">superscript</csymbol><ci id="S2.SS2.p1.7.m7.2.2.1.1.1.1.2.2.cmml" xref="S2.SS2.p1.7.m7.2.2.1.1.1.1.2.2">𝐱</ci><ci id="S2.SS2.p1.7.m7.2.2.1.1.1.1.2.3.cmml" xref="S2.SS2.p1.7.m7.2.2.1.1.1.1.2.3">𝑡</ci></apply><apply id="S2.SS2.p1.7.m7.2.2.1.1.1.1.3.cmml" xref="S2.SS2.p1.7.m7.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p1.7.m7.2.2.1.1.1.1.3.1.cmml" xref="S2.SS2.p1.7.m7.2.2.1.1.1.1.3">superscript</csymbol><ci id="S2.SS2.p1.7.m7.2.2.1.1.1.1.3.2.cmml" xref="S2.SS2.p1.7.m7.2.2.1.1.1.1.3.2">𝐱</ci><apply id="S2.SS2.p1.7.m7.2.2.1.1.1.1.3.3.cmml" xref="S2.SS2.p1.7.m7.2.2.1.1.1.1.3.3"><minus id="S2.SS2.p1.7.m7.2.2.1.1.1.1.3.3.1.cmml" xref="S2.SS2.p1.7.m7.2.2.1.1.1.1.3.3.1"></minus><ci id="S2.SS2.p1.7.m7.2.2.1.1.1.1.3.3.2.cmml" xref="S2.SS2.p1.7.m7.2.2.1.1.1.1.3.3.2">𝑡</ci><cn id="S2.SS2.p1.7.m7.2.2.1.1.1.1.3.3.3.cmml" type="integer" xref="S2.SS2.p1.7.m7.2.2.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply><apply id="S2.SS2.p1.7.m7.4.4.3.3.cmml" xref="S2.SS2.p1.7.m7.4.4.3.2"><ci id="S2.SS2.p1.7.m7.1.1.cmml" xref="S2.SS2.p1.7.m7.1.1">Cat</ci><apply id="S2.SS2.p1.7.m7.3.3.2.1.1.1.cmml" xref="S2.SS2.p1.7.m7.3.3.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.7.m7.3.3.2.1.1.1.1.cmml" xref="S2.SS2.p1.7.m7.3.3.2.1.1.1">subscript</csymbol><ci id="S2.SS2.p1.7.m7.3.3.2.1.1.1.2.cmml" xref="S2.SS2.p1.7.m7.3.3.2.1.1.1.2">𝐱</ci><ci id="S2.SS2.p1.7.m7.3.3.2.1.1.1.3.cmml" xref="S2.SS2.p1.7.m7.3.3.2.1.1.1.3">𝑡</ci></apply><apply id="S2.SS2.p1.7.m7.4.4.3.2.2.2.cmml" xref="S2.SS2.p1.7.m7.4.4.3.2.2.2"><eq id="S2.SS2.p1.7.m7.4.4.3.2.2.2.1.cmml" xref="S2.SS2.p1.7.m7.4.4.3.2.2.2.1"></eq><ci id="S2.SS2.p1.7.m7.4.4.3.2.2.2.2.cmml" xref="S2.SS2.p1.7.m7.4.4.3.2.2.2.2">𝐩</ci><apply id="S2.SS2.p1.7.m7.4.4.3.2.2.2.3.cmml" xref="S2.SS2.p1.7.m7.4.4.3.2.2.2.3"><times id="S2.SS2.p1.7.m7.4.4.3.2.2.2.3.1.cmml" xref="S2.SS2.p1.7.m7.4.4.3.2.2.2.3.1"></times><apply id="S2.SS2.p1.7.m7.4.4.3.2.2.2.3.2.cmml" xref="S2.SS2.p1.7.m7.4.4.3.2.2.2.3.2"><csymbol cd="ambiguous" id="S2.SS2.p1.7.m7.4.4.3.2.2.2.3.2.1.cmml" xref="S2.SS2.p1.7.m7.4.4.3.2.2.2.3.2">superscript</csymbol><ci id="S2.SS2.p1.7.m7.4.4.3.2.2.2.3.2.2.cmml" xref="S2.SS2.p1.7.m7.4.4.3.2.2.2.3.2.2">𝐱</ci><apply id="S2.SS2.p1.7.m7.4.4.3.2.2.2.3.2.3.cmml" xref="S2.SS2.p1.7.m7.4.4.3.2.2.2.3.2.3"><minus id="S2.SS2.p1.7.m7.4.4.3.2.2.2.3.2.3.1.cmml" xref="S2.SS2.p1.7.m7.4.4.3.2.2.2.3.2.3.1"></minus><ci id="S2.SS2.p1.7.m7.4.4.3.2.2.2.3.2.3.2.cmml" xref="S2.SS2.p1.7.m7.4.4.3.2.2.2.3.2.3.2">𝑡</ci><cn id="S2.SS2.p1.7.m7.4.4.3.2.2.2.3.2.3.3.cmml" type="integer" xref="S2.SS2.p1.7.m7.4.4.3.2.2.2.3.2.3.3">1</cn></apply></apply><apply id="S2.SS2.p1.7.m7.4.4.3.2.2.2.3.3.cmml" xref="S2.SS2.p1.7.m7.4.4.3.2.2.2.3.3"><csymbol cd="ambiguous" id="S2.SS2.p1.7.m7.4.4.3.2.2.2.3.3.1.cmml" xref="S2.SS2.p1.7.m7.4.4.3.2.2.2.3.3">superscript</csymbol><ci id="S2.SS2.p1.7.m7.4.4.3.2.2.2.3.3.2.cmml" xref="S2.SS2.p1.7.m7.4.4.3.2.2.2.3.3.2">𝐐</ci><ci id="S2.SS2.p1.7.m7.4.4.3.2.2.2.3.3.3.cmml" xref="S2.SS2.p1.7.m7.4.4.3.2.2.2.3.3.3">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.7.m7.4c">q(\mathbf{x}^{t}\mid\mathbf{x}^{t-1})=\operatorname{Cat}(\mathbf{x}_{t};%
\mathbf{p}=\mathbf{x}^{t-1}\mathbf{Q}^{t})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.7.m7.4d">italic_q ( bold_x start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ∣ bold_x start_POSTSUPERSCRIPT italic_t - 1 end_POSTSUPERSCRIPT ) = roman_Cat ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ; bold_p = bold_x start_POSTSUPERSCRIPT italic_t - 1 end_POSTSUPERSCRIPT bold_Q start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT )</annotation></semantics></math>, where <math alttext="\operatorname{Cat}(\mathbf{x};\mathbf{p})" class="ltx_Math" display="inline" id="S2.SS2.p1.8.m8.3"><semantics id="S2.SS2.p1.8.m8.3a"><mrow id="S2.SS2.p1.8.m8.3.4.2" xref="S2.SS2.p1.8.m8.3.4.1.cmml"><mi id="S2.SS2.p1.8.m8.1.1" xref="S2.SS2.p1.8.m8.1.1.cmml">Cat</mi><mo id="S2.SS2.p1.8.m8.3.4.2a" xref="S2.SS2.p1.8.m8.3.4.1.cmml">⁡</mo><mrow id="S2.SS2.p1.8.m8.3.4.2.1" xref="S2.SS2.p1.8.m8.3.4.1.cmml"><mo id="S2.SS2.p1.8.m8.3.4.2.1.1" stretchy="false" xref="S2.SS2.p1.8.m8.3.4.1.cmml">(</mo><mi id="S2.SS2.p1.8.m8.2.2" xref="S2.SS2.p1.8.m8.2.2.cmml">𝐱</mi><mo id="S2.SS2.p1.8.m8.3.4.2.1.2" xref="S2.SS2.p1.8.m8.3.4.1.cmml">;</mo><mi id="S2.SS2.p1.8.m8.3.3" xref="S2.SS2.p1.8.m8.3.3.cmml">𝐩</mi><mo id="S2.SS2.p1.8.m8.3.4.2.1.3" stretchy="false" xref="S2.SS2.p1.8.m8.3.4.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.8.m8.3b"><apply id="S2.SS2.p1.8.m8.3.4.1.cmml" xref="S2.SS2.p1.8.m8.3.4.2"><ci id="S2.SS2.p1.8.m8.1.1.cmml" xref="S2.SS2.p1.8.m8.1.1">Cat</ci><ci id="S2.SS2.p1.8.m8.2.2.cmml" xref="S2.SS2.p1.8.m8.2.2">𝐱</ci><ci id="S2.SS2.p1.8.m8.3.3.cmml" xref="S2.SS2.p1.8.m8.3.3">𝐩</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.8.m8.3c">\operatorname{Cat}(\mathbf{x};\mathbf{p})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.8.m8.3d">roman_Cat ( bold_x ; bold_p )</annotation></semantics></math> denotes the categorical distribution over <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="S2.SS2.p1.9.m9.1"><semantics id="S2.SS2.p1.9.m9.1a"><mi id="S2.SS2.p1.9.m9.1.1" xref="S2.SS2.p1.9.m9.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.9.m9.1b"><ci id="S2.SS2.p1.9.m9.1.1.cmml" xref="S2.SS2.p1.9.m9.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.9.m9.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.9.m9.1d">bold_x</annotation></semantics></math> with probabilities given by <math alttext="\mathbf{p}" class="ltx_Math" display="inline" id="S2.SS2.p1.10.m10.1"><semantics id="S2.SS2.p1.10.m10.1a"><mi id="S2.SS2.p1.10.m10.1.1" xref="S2.SS2.p1.10.m10.1.1.cmml">𝐩</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.10.m10.1b"><ci id="S2.SS2.p1.10.m10.1.1.cmml" xref="S2.SS2.p1.10.m10.1.1">𝐩</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.10.m10.1c">\mathbf{p}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.10.m10.1d">bold_p</annotation></semantics></math>.
Starting from the original data point <math alttext="\mathbf{x}=\mathbf{x}^{0}" class="ltx_Math" display="inline" id="S2.SS2.p1.11.m11.1"><semantics id="S2.SS2.p1.11.m11.1a"><mrow id="S2.SS2.p1.11.m11.1.1" xref="S2.SS2.p1.11.m11.1.1.cmml"><mi id="S2.SS2.p1.11.m11.1.1.2" xref="S2.SS2.p1.11.m11.1.1.2.cmml">𝐱</mi><mo id="S2.SS2.p1.11.m11.1.1.1" xref="S2.SS2.p1.11.m11.1.1.1.cmml">=</mo><msup id="S2.SS2.p1.11.m11.1.1.3" xref="S2.SS2.p1.11.m11.1.1.3.cmml"><mi id="S2.SS2.p1.11.m11.1.1.3.2" xref="S2.SS2.p1.11.m11.1.1.3.2.cmml">𝐱</mi><mn id="S2.SS2.p1.11.m11.1.1.3.3" xref="S2.SS2.p1.11.m11.1.1.3.3.cmml">0</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.11.m11.1b"><apply id="S2.SS2.p1.11.m11.1.1.cmml" xref="S2.SS2.p1.11.m11.1.1"><eq id="S2.SS2.p1.11.m11.1.1.1.cmml" xref="S2.SS2.p1.11.m11.1.1.1"></eq><ci id="S2.SS2.p1.11.m11.1.1.2.cmml" xref="S2.SS2.p1.11.m11.1.1.2">𝐱</ci><apply id="S2.SS2.p1.11.m11.1.1.3.cmml" xref="S2.SS2.p1.11.m11.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p1.11.m11.1.1.3.1.cmml" xref="S2.SS2.p1.11.m11.1.1.3">superscript</csymbol><ci id="S2.SS2.p1.11.m11.1.1.3.2.cmml" xref="S2.SS2.p1.11.m11.1.1.3.2">𝐱</ci><cn id="S2.SS2.p1.11.m11.1.1.3.3.cmml" type="integer" xref="S2.SS2.p1.11.m11.1.1.3.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.11.m11.1c">\mathbf{x}=\mathbf{x}^{0}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.11.m11.1d">bold_x = bold_x start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT</annotation></semantics></math>, we have <math alttext="q(\mathbf{x}^{t}\mid\mathbf{x}^{0})=\operatorname{Cat}\left(\mathbf{x}^{t};%
\mathbf{p}=\mathbf{x}^{0}\bar{\mathbf{Q}}^{t}\right)" class="ltx_Math" display="inline" id="S2.SS2.p1.12.m12.4"><semantics id="S2.SS2.p1.12.m12.4a"><mrow id="S2.SS2.p1.12.m12.4.4" xref="S2.SS2.p1.12.m12.4.4.cmml"><mrow id="S2.SS2.p1.12.m12.2.2.1" xref="S2.SS2.p1.12.m12.2.2.1.cmml"><mi id="S2.SS2.p1.12.m12.2.2.1.3" xref="S2.SS2.p1.12.m12.2.2.1.3.cmml">q</mi><mo id="S2.SS2.p1.12.m12.2.2.1.2" xref="S2.SS2.p1.12.m12.2.2.1.2.cmml">⁢</mo><mrow id="S2.SS2.p1.12.m12.2.2.1.1.1" xref="S2.SS2.p1.12.m12.2.2.1.1.1.1.cmml"><mo id="S2.SS2.p1.12.m12.2.2.1.1.1.2" stretchy="false" xref="S2.SS2.p1.12.m12.2.2.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p1.12.m12.2.2.1.1.1.1" xref="S2.SS2.p1.12.m12.2.2.1.1.1.1.cmml"><msup id="S2.SS2.p1.12.m12.2.2.1.1.1.1.2" xref="S2.SS2.p1.12.m12.2.2.1.1.1.1.2.cmml"><mi id="S2.SS2.p1.12.m12.2.2.1.1.1.1.2.2" xref="S2.SS2.p1.12.m12.2.2.1.1.1.1.2.2.cmml">𝐱</mi><mi id="S2.SS2.p1.12.m12.2.2.1.1.1.1.2.3" xref="S2.SS2.p1.12.m12.2.2.1.1.1.1.2.3.cmml">t</mi></msup><mo id="S2.SS2.p1.12.m12.2.2.1.1.1.1.1" xref="S2.SS2.p1.12.m12.2.2.1.1.1.1.1.cmml">∣</mo><msup id="S2.SS2.p1.12.m12.2.2.1.1.1.1.3" xref="S2.SS2.p1.12.m12.2.2.1.1.1.1.3.cmml"><mi id="S2.SS2.p1.12.m12.2.2.1.1.1.1.3.2" xref="S2.SS2.p1.12.m12.2.2.1.1.1.1.3.2.cmml">𝐱</mi><mn id="S2.SS2.p1.12.m12.2.2.1.1.1.1.3.3" xref="S2.SS2.p1.12.m12.2.2.1.1.1.1.3.3.cmml">0</mn></msup></mrow><mo id="S2.SS2.p1.12.m12.2.2.1.1.1.3" stretchy="false" xref="S2.SS2.p1.12.m12.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.SS2.p1.12.m12.4.4.4" xref="S2.SS2.p1.12.m12.4.4.4.cmml">=</mo><mrow id="S2.SS2.p1.12.m12.4.4.3.2" xref="S2.SS2.p1.12.m12.4.4.3.3.cmml"><mi id="S2.SS2.p1.12.m12.1.1" xref="S2.SS2.p1.12.m12.1.1.cmml">Cat</mi><mo id="S2.SS2.p1.12.m12.4.4.3.2a" xref="S2.SS2.p1.12.m12.4.4.3.3.cmml">⁡</mo><mrow id="S2.SS2.p1.12.m12.4.4.3.2.2" xref="S2.SS2.p1.12.m12.4.4.3.3.cmml"><mo id="S2.SS2.p1.12.m12.4.4.3.2.2.3" xref="S2.SS2.p1.12.m12.4.4.3.3.cmml">(</mo><msup id="S2.SS2.p1.12.m12.3.3.2.1.1.1" xref="S2.SS2.p1.12.m12.3.3.2.1.1.1.cmml"><mi id="S2.SS2.p1.12.m12.3.3.2.1.1.1.2" xref="S2.SS2.p1.12.m12.3.3.2.1.1.1.2.cmml">𝐱</mi><mi id="S2.SS2.p1.12.m12.3.3.2.1.1.1.3" xref="S2.SS2.p1.12.m12.3.3.2.1.1.1.3.cmml">t</mi></msup><mo id="S2.SS2.p1.12.m12.4.4.3.2.2.4" xref="S2.SS2.p1.12.m12.4.4.3.3.cmml">;</mo><mrow id="S2.SS2.p1.12.m12.4.4.3.2.2.2" xref="S2.SS2.p1.12.m12.4.4.3.2.2.2.cmml"><mi id="S2.SS2.p1.12.m12.4.4.3.2.2.2.2" xref="S2.SS2.p1.12.m12.4.4.3.2.2.2.2.cmml">𝐩</mi><mo id="S2.SS2.p1.12.m12.4.4.3.2.2.2.1" xref="S2.SS2.p1.12.m12.4.4.3.2.2.2.1.cmml">=</mo><mrow id="S2.SS2.p1.12.m12.4.4.3.2.2.2.3" xref="S2.SS2.p1.12.m12.4.4.3.2.2.2.3.cmml"><msup id="S2.SS2.p1.12.m12.4.4.3.2.2.2.3.2" xref="S2.SS2.p1.12.m12.4.4.3.2.2.2.3.2.cmml"><mi id="S2.SS2.p1.12.m12.4.4.3.2.2.2.3.2.2" xref="S2.SS2.p1.12.m12.4.4.3.2.2.2.3.2.2.cmml">𝐱</mi><mn id="S2.SS2.p1.12.m12.4.4.3.2.2.2.3.2.3" xref="S2.SS2.p1.12.m12.4.4.3.2.2.2.3.2.3.cmml">0</mn></msup><mo id="S2.SS2.p1.12.m12.4.4.3.2.2.2.3.1" xref="S2.SS2.p1.12.m12.4.4.3.2.2.2.3.1.cmml">⁢</mo><msup id="S2.SS2.p1.12.m12.4.4.3.2.2.2.3.3" xref="S2.SS2.p1.12.m12.4.4.3.2.2.2.3.3.cmml"><mover accent="true" id="S2.SS2.p1.12.m12.4.4.3.2.2.2.3.3.2" xref="S2.SS2.p1.12.m12.4.4.3.2.2.2.3.3.2.cmml"><mi id="S2.SS2.p1.12.m12.4.4.3.2.2.2.3.3.2.2" xref="S2.SS2.p1.12.m12.4.4.3.2.2.2.3.3.2.2.cmml">𝐐</mi><mo id="S2.SS2.p1.12.m12.4.4.3.2.2.2.3.3.2.1" xref="S2.SS2.p1.12.m12.4.4.3.2.2.2.3.3.2.1.cmml">¯</mo></mover><mi id="S2.SS2.p1.12.m12.4.4.3.2.2.2.3.3.3" xref="S2.SS2.p1.12.m12.4.4.3.2.2.2.3.3.3.cmml">t</mi></msup></mrow></mrow><mo id="S2.SS2.p1.12.m12.4.4.3.2.2.5" xref="S2.SS2.p1.12.m12.4.4.3.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.12.m12.4b"><apply id="S2.SS2.p1.12.m12.4.4.cmml" xref="S2.SS2.p1.12.m12.4.4"><eq id="S2.SS2.p1.12.m12.4.4.4.cmml" xref="S2.SS2.p1.12.m12.4.4.4"></eq><apply id="S2.SS2.p1.12.m12.2.2.1.cmml" xref="S2.SS2.p1.12.m12.2.2.1"><times id="S2.SS2.p1.12.m12.2.2.1.2.cmml" xref="S2.SS2.p1.12.m12.2.2.1.2"></times><ci id="S2.SS2.p1.12.m12.2.2.1.3.cmml" xref="S2.SS2.p1.12.m12.2.2.1.3">𝑞</ci><apply id="S2.SS2.p1.12.m12.2.2.1.1.1.1.cmml" xref="S2.SS2.p1.12.m12.2.2.1.1.1"><csymbol cd="latexml" id="S2.SS2.p1.12.m12.2.2.1.1.1.1.1.cmml" xref="S2.SS2.p1.12.m12.2.2.1.1.1.1.1">conditional</csymbol><apply id="S2.SS2.p1.12.m12.2.2.1.1.1.1.2.cmml" xref="S2.SS2.p1.12.m12.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p1.12.m12.2.2.1.1.1.1.2.1.cmml" xref="S2.SS2.p1.12.m12.2.2.1.1.1.1.2">superscript</csymbol><ci id="S2.SS2.p1.12.m12.2.2.1.1.1.1.2.2.cmml" xref="S2.SS2.p1.12.m12.2.2.1.1.1.1.2.2">𝐱</ci><ci id="S2.SS2.p1.12.m12.2.2.1.1.1.1.2.3.cmml" xref="S2.SS2.p1.12.m12.2.2.1.1.1.1.2.3">𝑡</ci></apply><apply id="S2.SS2.p1.12.m12.2.2.1.1.1.1.3.cmml" xref="S2.SS2.p1.12.m12.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p1.12.m12.2.2.1.1.1.1.3.1.cmml" xref="S2.SS2.p1.12.m12.2.2.1.1.1.1.3">superscript</csymbol><ci id="S2.SS2.p1.12.m12.2.2.1.1.1.1.3.2.cmml" xref="S2.SS2.p1.12.m12.2.2.1.1.1.1.3.2">𝐱</ci><cn id="S2.SS2.p1.12.m12.2.2.1.1.1.1.3.3.cmml" type="integer" xref="S2.SS2.p1.12.m12.2.2.1.1.1.1.3.3">0</cn></apply></apply></apply><apply id="S2.SS2.p1.12.m12.4.4.3.3.cmml" xref="S2.SS2.p1.12.m12.4.4.3.2"><ci id="S2.SS2.p1.12.m12.1.1.cmml" xref="S2.SS2.p1.12.m12.1.1">Cat</ci><apply id="S2.SS2.p1.12.m12.3.3.2.1.1.1.cmml" xref="S2.SS2.p1.12.m12.3.3.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.12.m12.3.3.2.1.1.1.1.cmml" xref="S2.SS2.p1.12.m12.3.3.2.1.1.1">superscript</csymbol><ci id="S2.SS2.p1.12.m12.3.3.2.1.1.1.2.cmml" xref="S2.SS2.p1.12.m12.3.3.2.1.1.1.2">𝐱</ci><ci id="S2.SS2.p1.12.m12.3.3.2.1.1.1.3.cmml" xref="S2.SS2.p1.12.m12.3.3.2.1.1.1.3">𝑡</ci></apply><apply id="S2.SS2.p1.12.m12.4.4.3.2.2.2.cmml" xref="S2.SS2.p1.12.m12.4.4.3.2.2.2"><eq id="S2.SS2.p1.12.m12.4.4.3.2.2.2.1.cmml" xref="S2.SS2.p1.12.m12.4.4.3.2.2.2.1"></eq><ci id="S2.SS2.p1.12.m12.4.4.3.2.2.2.2.cmml" xref="S2.SS2.p1.12.m12.4.4.3.2.2.2.2">𝐩</ci><apply id="S2.SS2.p1.12.m12.4.4.3.2.2.2.3.cmml" xref="S2.SS2.p1.12.m12.4.4.3.2.2.2.3"><times id="S2.SS2.p1.12.m12.4.4.3.2.2.2.3.1.cmml" xref="S2.SS2.p1.12.m12.4.4.3.2.2.2.3.1"></times><apply id="S2.SS2.p1.12.m12.4.4.3.2.2.2.3.2.cmml" xref="S2.SS2.p1.12.m12.4.4.3.2.2.2.3.2"><csymbol cd="ambiguous" id="S2.SS2.p1.12.m12.4.4.3.2.2.2.3.2.1.cmml" xref="S2.SS2.p1.12.m12.4.4.3.2.2.2.3.2">superscript</csymbol><ci id="S2.SS2.p1.12.m12.4.4.3.2.2.2.3.2.2.cmml" xref="S2.SS2.p1.12.m12.4.4.3.2.2.2.3.2.2">𝐱</ci><cn id="S2.SS2.p1.12.m12.4.4.3.2.2.2.3.2.3.cmml" type="integer" xref="S2.SS2.p1.12.m12.4.4.3.2.2.2.3.2.3">0</cn></apply><apply id="S2.SS2.p1.12.m12.4.4.3.2.2.2.3.3.cmml" xref="S2.SS2.p1.12.m12.4.4.3.2.2.2.3.3"><csymbol cd="ambiguous" id="S2.SS2.p1.12.m12.4.4.3.2.2.2.3.3.1.cmml" xref="S2.SS2.p1.12.m12.4.4.3.2.2.2.3.3">superscript</csymbol><apply id="S2.SS2.p1.12.m12.4.4.3.2.2.2.3.3.2.cmml" xref="S2.SS2.p1.12.m12.4.4.3.2.2.2.3.3.2"><ci id="S2.SS2.p1.12.m12.4.4.3.2.2.2.3.3.2.1.cmml" xref="S2.SS2.p1.12.m12.4.4.3.2.2.2.3.3.2.1">¯</ci><ci id="S2.SS2.p1.12.m12.4.4.3.2.2.2.3.3.2.2.cmml" xref="S2.SS2.p1.12.m12.4.4.3.2.2.2.3.3.2.2">𝐐</ci></apply><ci id="S2.SS2.p1.12.m12.4.4.3.2.2.2.3.3.3.cmml" xref="S2.SS2.p1.12.m12.4.4.3.2.2.2.3.3.3">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.12.m12.4c">q(\mathbf{x}^{t}\mid\mathbf{x}^{0})=\operatorname{Cat}\left(\mathbf{x}^{t};%
\mathbf{p}=\mathbf{x}^{0}\bar{\mathbf{Q}}^{t}\right)</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.12.m12.4d">italic_q ( bold_x start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ∣ bold_x start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT ) = roman_Cat ( bold_x start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ; bold_p = bold_x start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT over¯ start_ARG bold_Q end_ARG start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT )</annotation></semantics></math>, where <math alttext="\bar{\mathbf{Q}}^{t}=\prod_{i\leq t}\mathbf{Q}^{i}" class="ltx_Math" display="inline" id="S2.SS2.p1.13.m13.1"><semantics id="S2.SS2.p1.13.m13.1a"><mrow id="S2.SS2.p1.13.m13.1.1" xref="S2.SS2.p1.13.m13.1.1.cmml"><msup id="S2.SS2.p1.13.m13.1.1.2" xref="S2.SS2.p1.13.m13.1.1.2.cmml"><mover accent="true" id="S2.SS2.p1.13.m13.1.1.2.2" xref="S2.SS2.p1.13.m13.1.1.2.2.cmml"><mi id="S2.SS2.p1.13.m13.1.1.2.2.2" xref="S2.SS2.p1.13.m13.1.1.2.2.2.cmml">𝐐</mi><mo id="S2.SS2.p1.13.m13.1.1.2.2.1" xref="S2.SS2.p1.13.m13.1.1.2.2.1.cmml">¯</mo></mover><mi id="S2.SS2.p1.13.m13.1.1.2.3" xref="S2.SS2.p1.13.m13.1.1.2.3.cmml">t</mi></msup><mo id="S2.SS2.p1.13.m13.1.1.1" rspace="0.111em" xref="S2.SS2.p1.13.m13.1.1.1.cmml">=</mo><mrow id="S2.SS2.p1.13.m13.1.1.3" xref="S2.SS2.p1.13.m13.1.1.3.cmml"><msub id="S2.SS2.p1.13.m13.1.1.3.1" xref="S2.SS2.p1.13.m13.1.1.3.1.cmml"><mo id="S2.SS2.p1.13.m13.1.1.3.1.2" xref="S2.SS2.p1.13.m13.1.1.3.1.2.cmml">∏</mo><mrow id="S2.SS2.p1.13.m13.1.1.3.1.3" xref="S2.SS2.p1.13.m13.1.1.3.1.3.cmml"><mi id="S2.SS2.p1.13.m13.1.1.3.1.3.2" xref="S2.SS2.p1.13.m13.1.1.3.1.3.2.cmml">i</mi><mo id="S2.SS2.p1.13.m13.1.1.3.1.3.1" xref="S2.SS2.p1.13.m13.1.1.3.1.3.1.cmml">≤</mo><mi id="S2.SS2.p1.13.m13.1.1.3.1.3.3" xref="S2.SS2.p1.13.m13.1.1.3.1.3.3.cmml">t</mi></mrow></msub><msup id="S2.SS2.p1.13.m13.1.1.3.2" xref="S2.SS2.p1.13.m13.1.1.3.2.cmml"><mi id="S2.SS2.p1.13.m13.1.1.3.2.2" xref="S2.SS2.p1.13.m13.1.1.3.2.2.cmml">𝐐</mi><mi id="S2.SS2.p1.13.m13.1.1.3.2.3" xref="S2.SS2.p1.13.m13.1.1.3.2.3.cmml">i</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.13.m13.1b"><apply id="S2.SS2.p1.13.m13.1.1.cmml" xref="S2.SS2.p1.13.m13.1.1"><eq id="S2.SS2.p1.13.m13.1.1.1.cmml" xref="S2.SS2.p1.13.m13.1.1.1"></eq><apply id="S2.SS2.p1.13.m13.1.1.2.cmml" xref="S2.SS2.p1.13.m13.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p1.13.m13.1.1.2.1.cmml" xref="S2.SS2.p1.13.m13.1.1.2">superscript</csymbol><apply id="S2.SS2.p1.13.m13.1.1.2.2.cmml" xref="S2.SS2.p1.13.m13.1.1.2.2"><ci id="S2.SS2.p1.13.m13.1.1.2.2.1.cmml" xref="S2.SS2.p1.13.m13.1.1.2.2.1">¯</ci><ci id="S2.SS2.p1.13.m13.1.1.2.2.2.cmml" xref="S2.SS2.p1.13.m13.1.1.2.2.2">𝐐</ci></apply><ci id="S2.SS2.p1.13.m13.1.1.2.3.cmml" xref="S2.SS2.p1.13.m13.1.1.2.3">𝑡</ci></apply><apply id="S2.SS2.p1.13.m13.1.1.3.cmml" xref="S2.SS2.p1.13.m13.1.1.3"><apply id="S2.SS2.p1.13.m13.1.1.3.1.cmml" xref="S2.SS2.p1.13.m13.1.1.3.1"><csymbol cd="ambiguous" id="S2.SS2.p1.13.m13.1.1.3.1.1.cmml" xref="S2.SS2.p1.13.m13.1.1.3.1">subscript</csymbol><csymbol cd="latexml" id="S2.SS2.p1.13.m13.1.1.3.1.2.cmml" xref="S2.SS2.p1.13.m13.1.1.3.1.2">product</csymbol><apply id="S2.SS2.p1.13.m13.1.1.3.1.3.cmml" xref="S2.SS2.p1.13.m13.1.1.3.1.3"><leq id="S2.SS2.p1.13.m13.1.1.3.1.3.1.cmml" xref="S2.SS2.p1.13.m13.1.1.3.1.3.1"></leq><ci id="S2.SS2.p1.13.m13.1.1.3.1.3.2.cmml" xref="S2.SS2.p1.13.m13.1.1.3.1.3.2">𝑖</ci><ci id="S2.SS2.p1.13.m13.1.1.3.1.3.3.cmml" xref="S2.SS2.p1.13.m13.1.1.3.1.3.3">𝑡</ci></apply></apply><apply id="S2.SS2.p1.13.m13.1.1.3.2.cmml" xref="S2.SS2.p1.13.m13.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS2.p1.13.m13.1.1.3.2.1.cmml" xref="S2.SS2.p1.13.m13.1.1.3.2">superscript</csymbol><ci id="S2.SS2.p1.13.m13.1.1.3.2.2.cmml" xref="S2.SS2.p1.13.m13.1.1.3.2.2">𝐐</ci><ci id="S2.SS2.p1.13.m13.1.1.3.2.3.cmml" xref="S2.SS2.p1.13.m13.1.1.3.2.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.13.m13.1c">\bar{\mathbf{Q}}^{t}=\prod_{i\leq t}\mathbf{Q}^{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.13.m13.1d">over¯ start_ARG bold_Q end_ARG start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT = ∏ start_POSTSUBSCRIPT italic_i ≤ italic_t end_POSTSUBSCRIPT bold_Q start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math>. The forward diffusion gradually corrupts data points. When the total timestep <math alttext="T" class="ltx_Math" display="inline" id="S2.SS2.p1.14.m14.1"><semantics id="S2.SS2.p1.14.m14.1a"><mi id="S2.SS2.p1.14.m14.1.1" xref="S2.SS2.p1.14.m14.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.14.m14.1b"><ci id="S2.SS2.p1.14.m14.1.1.cmml" xref="S2.SS2.p1.14.m14.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.14.m14.1c">T</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.14.m14.1d">italic_T</annotation></semantics></math> is large enough, <math alttext="q(\mathbf{x}^{T})" class="ltx_Math" display="inline" id="S2.SS2.p1.15.m15.1"><semantics id="S2.SS2.p1.15.m15.1a"><mrow id="S2.SS2.p1.15.m15.1.1" xref="S2.SS2.p1.15.m15.1.1.cmml"><mi id="S2.SS2.p1.15.m15.1.1.3" xref="S2.SS2.p1.15.m15.1.1.3.cmml">q</mi><mo id="S2.SS2.p1.15.m15.1.1.2" xref="S2.SS2.p1.15.m15.1.1.2.cmml">⁢</mo><mrow id="S2.SS2.p1.15.m15.1.1.1.1" xref="S2.SS2.p1.15.m15.1.1.1.1.1.cmml"><mo id="S2.SS2.p1.15.m15.1.1.1.1.2" stretchy="false" xref="S2.SS2.p1.15.m15.1.1.1.1.1.cmml">(</mo><msup id="S2.SS2.p1.15.m15.1.1.1.1.1" xref="S2.SS2.p1.15.m15.1.1.1.1.1.cmml"><mi id="S2.SS2.p1.15.m15.1.1.1.1.1.2" xref="S2.SS2.p1.15.m15.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S2.SS2.p1.15.m15.1.1.1.1.1.3" xref="S2.SS2.p1.15.m15.1.1.1.1.1.3.cmml">T</mi></msup><mo id="S2.SS2.p1.15.m15.1.1.1.1.3" stretchy="false" xref="S2.SS2.p1.15.m15.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.15.m15.1b"><apply id="S2.SS2.p1.15.m15.1.1.cmml" xref="S2.SS2.p1.15.m15.1.1"><times id="S2.SS2.p1.15.m15.1.1.2.cmml" xref="S2.SS2.p1.15.m15.1.1.2"></times><ci id="S2.SS2.p1.15.m15.1.1.3.cmml" xref="S2.SS2.p1.15.m15.1.1.3">𝑞</ci><apply id="S2.SS2.p1.15.m15.1.1.1.1.1.cmml" xref="S2.SS2.p1.15.m15.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.15.m15.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.15.m15.1.1.1.1">superscript</csymbol><ci id="S2.SS2.p1.15.m15.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.15.m15.1.1.1.1.1.2">𝐱</ci><ci id="S2.SS2.p1.15.m15.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.15.m15.1.1.1.1.1.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.15.m15.1c">q(\mathbf{x}^{T})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.15.m15.1d">italic_q ( bold_x start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT )</annotation></semantics></math> converges to a stationary distribution.
The reverse process samples from <math alttext="q(\mathbf{x}^{T})" class="ltx_Math" display="inline" id="S2.SS2.p1.16.m16.1"><semantics id="S2.SS2.p1.16.m16.1a"><mrow id="S2.SS2.p1.16.m16.1.1" xref="S2.SS2.p1.16.m16.1.1.cmml"><mi id="S2.SS2.p1.16.m16.1.1.3" xref="S2.SS2.p1.16.m16.1.1.3.cmml">q</mi><mo id="S2.SS2.p1.16.m16.1.1.2" xref="S2.SS2.p1.16.m16.1.1.2.cmml">⁢</mo><mrow id="S2.SS2.p1.16.m16.1.1.1.1" xref="S2.SS2.p1.16.m16.1.1.1.1.1.cmml"><mo id="S2.SS2.p1.16.m16.1.1.1.1.2" stretchy="false" xref="S2.SS2.p1.16.m16.1.1.1.1.1.cmml">(</mo><msup id="S2.SS2.p1.16.m16.1.1.1.1.1" xref="S2.SS2.p1.16.m16.1.1.1.1.1.cmml"><mi id="S2.SS2.p1.16.m16.1.1.1.1.1.2" xref="S2.SS2.p1.16.m16.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S2.SS2.p1.16.m16.1.1.1.1.1.3" xref="S2.SS2.p1.16.m16.1.1.1.1.1.3.cmml">T</mi></msup><mo id="S2.SS2.p1.16.m16.1.1.1.1.3" stretchy="false" xref="S2.SS2.p1.16.m16.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.16.m16.1b"><apply id="S2.SS2.p1.16.m16.1.1.cmml" xref="S2.SS2.p1.16.m16.1.1"><times id="S2.SS2.p1.16.m16.1.1.2.cmml" xref="S2.SS2.p1.16.m16.1.1.2"></times><ci id="S2.SS2.p1.16.m16.1.1.3.cmml" xref="S2.SS2.p1.16.m16.1.1.3">𝑞</ci><apply id="S2.SS2.p1.16.m16.1.1.1.1.1.cmml" xref="S2.SS2.p1.16.m16.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.16.m16.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.16.m16.1.1.1.1">superscript</csymbol><ci id="S2.SS2.p1.16.m16.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.16.m16.1.1.1.1.1.2">𝐱</ci><ci id="S2.SS2.p1.16.m16.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.16.m16.1.1.1.1.1.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.16.m16.1c">q(\mathbf{x}^{T})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.16.m16.1d">italic_q ( bold_x start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT )</annotation></semantics></math> and gradually removes noise. The posterior distribution <math alttext="q(\mathbf{x}^{t-1}\mid\mathbf{x}^{t})" class="ltx_Math" display="inline" id="S2.SS2.p1.17.m17.1"><semantics id="S2.SS2.p1.17.m17.1a"><mrow id="S2.SS2.p1.17.m17.1.1" xref="S2.SS2.p1.17.m17.1.1.cmml"><mi id="S2.SS2.p1.17.m17.1.1.3" xref="S2.SS2.p1.17.m17.1.1.3.cmml">q</mi><mo id="S2.SS2.p1.17.m17.1.1.2" xref="S2.SS2.p1.17.m17.1.1.2.cmml">⁢</mo><mrow id="S2.SS2.p1.17.m17.1.1.1.1" xref="S2.SS2.p1.17.m17.1.1.1.1.1.cmml"><mo id="S2.SS2.p1.17.m17.1.1.1.1.2" stretchy="false" xref="S2.SS2.p1.17.m17.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p1.17.m17.1.1.1.1.1" xref="S2.SS2.p1.17.m17.1.1.1.1.1.cmml"><msup id="S2.SS2.p1.17.m17.1.1.1.1.1.2" xref="S2.SS2.p1.17.m17.1.1.1.1.1.2.cmml"><mi id="S2.SS2.p1.17.m17.1.1.1.1.1.2.2" xref="S2.SS2.p1.17.m17.1.1.1.1.1.2.2.cmml">𝐱</mi><mrow id="S2.SS2.p1.17.m17.1.1.1.1.1.2.3" xref="S2.SS2.p1.17.m17.1.1.1.1.1.2.3.cmml"><mi id="S2.SS2.p1.17.m17.1.1.1.1.1.2.3.2" xref="S2.SS2.p1.17.m17.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="S2.SS2.p1.17.m17.1.1.1.1.1.2.3.1" xref="S2.SS2.p1.17.m17.1.1.1.1.1.2.3.1.cmml">−</mo><mn id="S2.SS2.p1.17.m17.1.1.1.1.1.2.3.3" xref="S2.SS2.p1.17.m17.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msup><mo id="S2.SS2.p1.17.m17.1.1.1.1.1.1" xref="S2.SS2.p1.17.m17.1.1.1.1.1.1.cmml">∣</mo><msup id="S2.SS2.p1.17.m17.1.1.1.1.1.3" xref="S2.SS2.p1.17.m17.1.1.1.1.1.3.cmml"><mi id="S2.SS2.p1.17.m17.1.1.1.1.1.3.2" xref="S2.SS2.p1.17.m17.1.1.1.1.1.3.2.cmml">𝐱</mi><mi id="S2.SS2.p1.17.m17.1.1.1.1.1.3.3" xref="S2.SS2.p1.17.m17.1.1.1.1.1.3.3.cmml">t</mi></msup></mrow><mo id="S2.SS2.p1.17.m17.1.1.1.1.3" stretchy="false" xref="S2.SS2.p1.17.m17.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.17.m17.1b"><apply id="S2.SS2.p1.17.m17.1.1.cmml" xref="S2.SS2.p1.17.m17.1.1"><times id="S2.SS2.p1.17.m17.1.1.2.cmml" xref="S2.SS2.p1.17.m17.1.1.2"></times><ci id="S2.SS2.p1.17.m17.1.1.3.cmml" xref="S2.SS2.p1.17.m17.1.1.3">𝑞</ci><apply id="S2.SS2.p1.17.m17.1.1.1.1.1.cmml" xref="S2.SS2.p1.17.m17.1.1.1.1"><csymbol cd="latexml" id="S2.SS2.p1.17.m17.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.17.m17.1.1.1.1.1.1">conditional</csymbol><apply id="S2.SS2.p1.17.m17.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.17.m17.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p1.17.m17.1.1.1.1.1.2.1.cmml" xref="S2.SS2.p1.17.m17.1.1.1.1.1.2">superscript</csymbol><ci id="S2.SS2.p1.17.m17.1.1.1.1.1.2.2.cmml" xref="S2.SS2.p1.17.m17.1.1.1.1.1.2.2">𝐱</ci><apply id="S2.SS2.p1.17.m17.1.1.1.1.1.2.3.cmml" xref="S2.SS2.p1.17.m17.1.1.1.1.1.2.3"><minus id="S2.SS2.p1.17.m17.1.1.1.1.1.2.3.1.cmml" xref="S2.SS2.p1.17.m17.1.1.1.1.1.2.3.1"></minus><ci id="S2.SS2.p1.17.m17.1.1.1.1.1.2.3.2.cmml" xref="S2.SS2.p1.17.m17.1.1.1.1.1.2.3.2">𝑡</ci><cn id="S2.SS2.p1.17.m17.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S2.SS2.p1.17.m17.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S2.SS2.p1.17.m17.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.17.m17.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p1.17.m17.1.1.1.1.1.3.1.cmml" xref="S2.SS2.p1.17.m17.1.1.1.1.1.3">superscript</csymbol><ci id="S2.SS2.p1.17.m17.1.1.1.1.1.3.2.cmml" xref="S2.SS2.p1.17.m17.1.1.1.1.1.3.2">𝐱</ci><ci id="S2.SS2.p1.17.m17.1.1.1.1.1.3.3.cmml" xref="S2.SS2.p1.17.m17.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.17.m17.1c">q(\mathbf{x}^{t-1}\mid\mathbf{x}^{t})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.17.m17.1d">italic_q ( bold_x start_POSTSUPERSCRIPT italic_t - 1 end_POSTSUPERSCRIPT ∣ bold_x start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT )</annotation></semantics></math> is calculated as <math alttext="q(\mathbf{x}^{t-1}|\mathbf{x}^{t},\mathbf{x}^{0})\propto\mathbf{x}^{t}(\mathbf%
{Q}^{t})^{\top}\odot\mathbf{x}^{0}\bar{\mathbf{Q}}^{t-1}" class="ltx_Math" display="inline" id="S2.SS2.p1.18.m18.2"><semantics id="S2.SS2.p1.18.m18.2a"><mrow id="S2.SS2.p1.18.m18.2.2" xref="S2.SS2.p1.18.m18.2.2.cmml"><mrow id="S2.SS2.p1.18.m18.1.1.1" xref="S2.SS2.p1.18.m18.1.1.1.cmml"><mi id="S2.SS2.p1.18.m18.1.1.1.3" xref="S2.SS2.p1.18.m18.1.1.1.3.cmml">q</mi><mo id="S2.SS2.p1.18.m18.1.1.1.2" xref="S2.SS2.p1.18.m18.1.1.1.2.cmml">⁢</mo><mrow id="S2.SS2.p1.18.m18.1.1.1.1.1" xref="S2.SS2.p1.18.m18.1.1.1.1.1.1.cmml"><mo id="S2.SS2.p1.18.m18.1.1.1.1.1.2" stretchy="false" xref="S2.SS2.p1.18.m18.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p1.18.m18.1.1.1.1.1.1" xref="S2.SS2.p1.18.m18.1.1.1.1.1.1.cmml"><msup id="S2.SS2.p1.18.m18.1.1.1.1.1.1.4" xref="S2.SS2.p1.18.m18.1.1.1.1.1.1.4.cmml"><mi id="S2.SS2.p1.18.m18.1.1.1.1.1.1.4.2" xref="S2.SS2.p1.18.m18.1.1.1.1.1.1.4.2.cmml">𝐱</mi><mrow id="S2.SS2.p1.18.m18.1.1.1.1.1.1.4.3" xref="S2.SS2.p1.18.m18.1.1.1.1.1.1.4.3.cmml"><mi id="S2.SS2.p1.18.m18.1.1.1.1.1.1.4.3.2" xref="S2.SS2.p1.18.m18.1.1.1.1.1.1.4.3.2.cmml">t</mi><mo id="S2.SS2.p1.18.m18.1.1.1.1.1.1.4.3.1" xref="S2.SS2.p1.18.m18.1.1.1.1.1.1.4.3.1.cmml">−</mo><mn id="S2.SS2.p1.18.m18.1.1.1.1.1.1.4.3.3" xref="S2.SS2.p1.18.m18.1.1.1.1.1.1.4.3.3.cmml">1</mn></mrow></msup><mo fence="false" id="S2.SS2.p1.18.m18.1.1.1.1.1.1.3" xref="S2.SS2.p1.18.m18.1.1.1.1.1.1.3.cmml">|</mo><mrow id="S2.SS2.p1.18.m18.1.1.1.1.1.1.2.2" xref="S2.SS2.p1.18.m18.1.1.1.1.1.1.2.3.cmml"><msup id="S2.SS2.p1.18.m18.1.1.1.1.1.1.1.1.1" xref="S2.SS2.p1.18.m18.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.SS2.p1.18.m18.1.1.1.1.1.1.1.1.1.2" xref="S2.SS2.p1.18.m18.1.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S2.SS2.p1.18.m18.1.1.1.1.1.1.1.1.1.3" xref="S2.SS2.p1.18.m18.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msup><mo id="S2.SS2.p1.18.m18.1.1.1.1.1.1.2.2.3" xref="S2.SS2.p1.18.m18.1.1.1.1.1.1.2.3.cmml">,</mo><msup id="S2.SS2.p1.18.m18.1.1.1.1.1.1.2.2.2" xref="S2.SS2.p1.18.m18.1.1.1.1.1.1.2.2.2.cmml"><mi id="S2.SS2.p1.18.m18.1.1.1.1.1.1.2.2.2.2" xref="S2.SS2.p1.18.m18.1.1.1.1.1.1.2.2.2.2.cmml">𝐱</mi><mn id="S2.SS2.p1.18.m18.1.1.1.1.1.1.2.2.2.3" xref="S2.SS2.p1.18.m18.1.1.1.1.1.1.2.2.2.3.cmml">0</mn></msup></mrow></mrow><mo id="S2.SS2.p1.18.m18.1.1.1.1.1.3" stretchy="false" xref="S2.SS2.p1.18.m18.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.SS2.p1.18.m18.2.2.3" xref="S2.SS2.p1.18.m18.2.2.3.cmml">∝</mo><mrow id="S2.SS2.p1.18.m18.2.2.2" xref="S2.SS2.p1.18.m18.2.2.2.cmml"><mrow id="S2.SS2.p1.18.m18.2.2.2.1" xref="S2.SS2.p1.18.m18.2.2.2.1.cmml"><mrow id="S2.SS2.p1.18.m18.2.2.2.1.1" xref="S2.SS2.p1.18.m18.2.2.2.1.1.cmml"><msup id="S2.SS2.p1.18.m18.2.2.2.1.1.3" xref="S2.SS2.p1.18.m18.2.2.2.1.1.3.cmml"><mi id="S2.SS2.p1.18.m18.2.2.2.1.1.3.2" xref="S2.SS2.p1.18.m18.2.2.2.1.1.3.2.cmml">𝐱</mi><mi id="S2.SS2.p1.18.m18.2.2.2.1.1.3.3" xref="S2.SS2.p1.18.m18.2.2.2.1.1.3.3.cmml">t</mi></msup><mo id="S2.SS2.p1.18.m18.2.2.2.1.1.2" xref="S2.SS2.p1.18.m18.2.2.2.1.1.2.cmml">⁢</mo><msup id="S2.SS2.p1.18.m18.2.2.2.1.1.1" xref="S2.SS2.p1.18.m18.2.2.2.1.1.1.cmml"><mrow id="S2.SS2.p1.18.m18.2.2.2.1.1.1.1.1" xref="S2.SS2.p1.18.m18.2.2.2.1.1.1.1.1.1.cmml"><mo id="S2.SS2.p1.18.m18.2.2.2.1.1.1.1.1.2" stretchy="false" xref="S2.SS2.p1.18.m18.2.2.2.1.1.1.1.1.1.cmml">(</mo><msup id="S2.SS2.p1.18.m18.2.2.2.1.1.1.1.1.1" xref="S2.SS2.p1.18.m18.2.2.2.1.1.1.1.1.1.cmml"><mi id="S2.SS2.p1.18.m18.2.2.2.1.1.1.1.1.1.2" xref="S2.SS2.p1.18.m18.2.2.2.1.1.1.1.1.1.2.cmml">𝐐</mi><mi id="S2.SS2.p1.18.m18.2.2.2.1.1.1.1.1.1.3" xref="S2.SS2.p1.18.m18.2.2.2.1.1.1.1.1.1.3.cmml">t</mi></msup><mo id="S2.SS2.p1.18.m18.2.2.2.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S2.SS2.p1.18.m18.2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.SS2.p1.18.m18.2.2.2.1.1.1.3" xref="S2.SS2.p1.18.m18.2.2.2.1.1.1.3.cmml">⊤</mo></msup></mrow><mo id="S2.SS2.p1.18.m18.2.2.2.1.2" rspace="0.222em" xref="S2.SS2.p1.18.m18.2.2.2.1.2.cmml">⊙</mo><msup id="S2.SS2.p1.18.m18.2.2.2.1.3" xref="S2.SS2.p1.18.m18.2.2.2.1.3.cmml"><mi id="S2.SS2.p1.18.m18.2.2.2.1.3.2" xref="S2.SS2.p1.18.m18.2.2.2.1.3.2.cmml">𝐱</mi><mn id="S2.SS2.p1.18.m18.2.2.2.1.3.3" xref="S2.SS2.p1.18.m18.2.2.2.1.3.3.cmml">0</mn></msup></mrow><mo id="S2.SS2.p1.18.m18.2.2.2.2" xref="S2.SS2.p1.18.m18.2.2.2.2.cmml">⁢</mo><msup id="S2.SS2.p1.18.m18.2.2.2.3" xref="S2.SS2.p1.18.m18.2.2.2.3.cmml"><mover accent="true" id="S2.SS2.p1.18.m18.2.2.2.3.2" xref="S2.SS2.p1.18.m18.2.2.2.3.2.cmml"><mi id="S2.SS2.p1.18.m18.2.2.2.3.2.2" xref="S2.SS2.p1.18.m18.2.2.2.3.2.2.cmml">𝐐</mi><mo id="S2.SS2.p1.18.m18.2.2.2.3.2.1" xref="S2.SS2.p1.18.m18.2.2.2.3.2.1.cmml">¯</mo></mover><mrow id="S2.SS2.p1.18.m18.2.2.2.3.3" xref="S2.SS2.p1.18.m18.2.2.2.3.3.cmml"><mi id="S2.SS2.p1.18.m18.2.2.2.3.3.2" xref="S2.SS2.p1.18.m18.2.2.2.3.3.2.cmml">t</mi><mo id="S2.SS2.p1.18.m18.2.2.2.3.3.1" xref="S2.SS2.p1.18.m18.2.2.2.3.3.1.cmml">−</mo><mn id="S2.SS2.p1.18.m18.2.2.2.3.3.3" xref="S2.SS2.p1.18.m18.2.2.2.3.3.3.cmml">1</mn></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.18.m18.2b"><apply id="S2.SS2.p1.18.m18.2.2.cmml" xref="S2.SS2.p1.18.m18.2.2"><csymbol cd="latexml" id="S2.SS2.p1.18.m18.2.2.3.cmml" xref="S2.SS2.p1.18.m18.2.2.3">proportional-to</csymbol><apply id="S2.SS2.p1.18.m18.1.1.1.cmml" xref="S2.SS2.p1.18.m18.1.1.1"><times id="S2.SS2.p1.18.m18.1.1.1.2.cmml" xref="S2.SS2.p1.18.m18.1.1.1.2"></times><ci id="S2.SS2.p1.18.m18.1.1.1.3.cmml" xref="S2.SS2.p1.18.m18.1.1.1.3">𝑞</ci><apply id="S2.SS2.p1.18.m18.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.18.m18.1.1.1.1.1"><csymbol cd="latexml" id="S2.SS2.p1.18.m18.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.18.m18.1.1.1.1.1.1.3">conditional</csymbol><apply id="S2.SS2.p1.18.m18.1.1.1.1.1.1.4.cmml" xref="S2.SS2.p1.18.m18.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.SS2.p1.18.m18.1.1.1.1.1.1.4.1.cmml" xref="S2.SS2.p1.18.m18.1.1.1.1.1.1.4">superscript</csymbol><ci id="S2.SS2.p1.18.m18.1.1.1.1.1.1.4.2.cmml" xref="S2.SS2.p1.18.m18.1.1.1.1.1.1.4.2">𝐱</ci><apply id="S2.SS2.p1.18.m18.1.1.1.1.1.1.4.3.cmml" xref="S2.SS2.p1.18.m18.1.1.1.1.1.1.4.3"><minus id="S2.SS2.p1.18.m18.1.1.1.1.1.1.4.3.1.cmml" xref="S2.SS2.p1.18.m18.1.1.1.1.1.1.4.3.1"></minus><ci id="S2.SS2.p1.18.m18.1.1.1.1.1.1.4.3.2.cmml" xref="S2.SS2.p1.18.m18.1.1.1.1.1.1.4.3.2">𝑡</ci><cn id="S2.SS2.p1.18.m18.1.1.1.1.1.1.4.3.3.cmml" type="integer" xref="S2.SS2.p1.18.m18.1.1.1.1.1.1.4.3.3">1</cn></apply></apply><list id="S2.SS2.p1.18.m18.1.1.1.1.1.1.2.3.cmml" xref="S2.SS2.p1.18.m18.1.1.1.1.1.1.2.2"><apply id="S2.SS2.p1.18.m18.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.18.m18.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.18.m18.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.18.m18.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.SS2.p1.18.m18.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.18.m18.1.1.1.1.1.1.1.1.1.2">𝐱</ci><ci id="S2.SS2.p1.18.m18.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.18.m18.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S2.SS2.p1.18.m18.1.1.1.1.1.1.2.2.2.cmml" xref="S2.SS2.p1.18.m18.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.18.m18.1.1.1.1.1.1.2.2.2.1.cmml" xref="S2.SS2.p1.18.m18.1.1.1.1.1.1.2.2.2">superscript</csymbol><ci id="S2.SS2.p1.18.m18.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.SS2.p1.18.m18.1.1.1.1.1.1.2.2.2.2">𝐱</ci><cn id="S2.SS2.p1.18.m18.1.1.1.1.1.1.2.2.2.3.cmml" type="integer" xref="S2.SS2.p1.18.m18.1.1.1.1.1.1.2.2.2.3">0</cn></apply></list></apply></apply><apply id="S2.SS2.p1.18.m18.2.2.2.cmml" xref="S2.SS2.p1.18.m18.2.2.2"><times id="S2.SS2.p1.18.m18.2.2.2.2.cmml" xref="S2.SS2.p1.18.m18.2.2.2.2"></times><apply id="S2.SS2.p1.18.m18.2.2.2.1.cmml" xref="S2.SS2.p1.18.m18.2.2.2.1"><csymbol cd="latexml" id="S2.SS2.p1.18.m18.2.2.2.1.2.cmml" xref="S2.SS2.p1.18.m18.2.2.2.1.2">direct-product</csymbol><apply id="S2.SS2.p1.18.m18.2.2.2.1.1.cmml" xref="S2.SS2.p1.18.m18.2.2.2.1.1"><times id="S2.SS2.p1.18.m18.2.2.2.1.1.2.cmml" xref="S2.SS2.p1.18.m18.2.2.2.1.1.2"></times><apply id="S2.SS2.p1.18.m18.2.2.2.1.1.3.cmml" xref="S2.SS2.p1.18.m18.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p1.18.m18.2.2.2.1.1.3.1.cmml" xref="S2.SS2.p1.18.m18.2.2.2.1.1.3">superscript</csymbol><ci id="S2.SS2.p1.18.m18.2.2.2.1.1.3.2.cmml" xref="S2.SS2.p1.18.m18.2.2.2.1.1.3.2">𝐱</ci><ci id="S2.SS2.p1.18.m18.2.2.2.1.1.3.3.cmml" xref="S2.SS2.p1.18.m18.2.2.2.1.1.3.3">𝑡</ci></apply><apply id="S2.SS2.p1.18.m18.2.2.2.1.1.1.cmml" xref="S2.SS2.p1.18.m18.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.18.m18.2.2.2.1.1.1.2.cmml" xref="S2.SS2.p1.18.m18.2.2.2.1.1.1">superscript</csymbol><apply id="S2.SS2.p1.18.m18.2.2.2.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.18.m18.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.18.m18.2.2.2.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.18.m18.2.2.2.1.1.1.1.1">superscript</csymbol><ci id="S2.SS2.p1.18.m18.2.2.2.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.18.m18.2.2.2.1.1.1.1.1.1.2">𝐐</ci><ci id="S2.SS2.p1.18.m18.2.2.2.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.18.m18.2.2.2.1.1.1.1.1.1.3">𝑡</ci></apply><csymbol cd="latexml" id="S2.SS2.p1.18.m18.2.2.2.1.1.1.3.cmml" xref="S2.SS2.p1.18.m18.2.2.2.1.1.1.3">top</csymbol></apply></apply><apply id="S2.SS2.p1.18.m18.2.2.2.1.3.cmml" xref="S2.SS2.p1.18.m18.2.2.2.1.3"><csymbol cd="ambiguous" id="S2.SS2.p1.18.m18.2.2.2.1.3.1.cmml" xref="S2.SS2.p1.18.m18.2.2.2.1.3">superscript</csymbol><ci id="S2.SS2.p1.18.m18.2.2.2.1.3.2.cmml" xref="S2.SS2.p1.18.m18.2.2.2.1.3.2">𝐱</ci><cn id="S2.SS2.p1.18.m18.2.2.2.1.3.3.cmml" type="integer" xref="S2.SS2.p1.18.m18.2.2.2.1.3.3">0</cn></apply></apply><apply id="S2.SS2.p1.18.m18.2.2.2.3.cmml" xref="S2.SS2.p1.18.m18.2.2.2.3"><csymbol cd="ambiguous" id="S2.SS2.p1.18.m18.2.2.2.3.1.cmml" xref="S2.SS2.p1.18.m18.2.2.2.3">superscript</csymbol><apply id="S2.SS2.p1.18.m18.2.2.2.3.2.cmml" xref="S2.SS2.p1.18.m18.2.2.2.3.2"><ci id="S2.SS2.p1.18.m18.2.2.2.3.2.1.cmml" xref="S2.SS2.p1.18.m18.2.2.2.3.2.1">¯</ci><ci id="S2.SS2.p1.18.m18.2.2.2.3.2.2.cmml" xref="S2.SS2.p1.18.m18.2.2.2.3.2.2">𝐐</ci></apply><apply id="S2.SS2.p1.18.m18.2.2.2.3.3.cmml" xref="S2.SS2.p1.18.m18.2.2.2.3.3"><minus id="S2.SS2.p1.18.m18.2.2.2.3.3.1.cmml" xref="S2.SS2.p1.18.m18.2.2.2.3.3.1"></minus><ci id="S2.SS2.p1.18.m18.2.2.2.3.3.2.cmml" xref="S2.SS2.p1.18.m18.2.2.2.3.3.2">𝑡</ci><cn id="S2.SS2.p1.18.m18.2.2.2.3.3.3.cmml" type="integer" xref="S2.SS2.p1.18.m18.2.2.2.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.18.m18.2c">q(\mathbf{x}^{t-1}|\mathbf{x}^{t},\mathbf{x}^{0})\propto\mathbf{x}^{t}(\mathbf%
{Q}^{t})^{\top}\odot\mathbf{x}^{0}\bar{\mathbf{Q}}^{t-1}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.18.m18.2d">italic_q ( bold_x start_POSTSUPERSCRIPT italic_t - 1 end_POSTSUPERSCRIPT | bold_x start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT , bold_x start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT ) ∝ bold_x start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ( bold_Q start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ⊙ bold_x start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT over¯ start_ARG bold_Q end_ARG start_POSTSUPERSCRIPT italic_t - 1 end_POSTSUPERSCRIPT</annotation></semantics></math>. Using a denoising model parameterized by <math alttext="\theta_{2}" class="ltx_Math" display="inline" id="S2.SS2.p1.19.m19.1"><semantics id="S2.SS2.p1.19.m19.1a"><msub id="S2.SS2.p1.19.m19.1.1" xref="S2.SS2.p1.19.m19.1.1.cmml"><mi id="S2.SS2.p1.19.m19.1.1.2" xref="S2.SS2.p1.19.m19.1.1.2.cmml">θ</mi><mn id="S2.SS2.p1.19.m19.1.1.3" xref="S2.SS2.p1.19.m19.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.19.m19.1b"><apply id="S2.SS2.p1.19.m19.1.1.cmml" xref="S2.SS2.p1.19.m19.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.19.m19.1.1.1.cmml" xref="S2.SS2.p1.19.m19.1.1">subscript</csymbol><ci id="S2.SS2.p1.19.m19.1.1.2.cmml" xref="S2.SS2.p1.19.m19.1.1.2">𝜃</ci><cn id="S2.SS2.p1.19.m19.1.1.3.cmml" type="integer" xref="S2.SS2.p1.19.m19.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.19.m19.1c">\theta_{2}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.19.m19.1d">italic_θ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, this posterior can be approximated by <math alttext="p_{\theta_{2}}(\mathbf{x}^{t-1}|\mathbf{x}^{t},\mathbf{x}^{0})" class="ltx_Math" display="inline" id="S2.SS2.p1.20.m20.1"><semantics id="S2.SS2.p1.20.m20.1a"><mrow id="S2.SS2.p1.20.m20.1.1" xref="S2.SS2.p1.20.m20.1.1.cmml"><msub id="S2.SS2.p1.20.m20.1.1.3" xref="S2.SS2.p1.20.m20.1.1.3.cmml"><mi id="S2.SS2.p1.20.m20.1.1.3.2" xref="S2.SS2.p1.20.m20.1.1.3.2.cmml">p</mi><msub id="S2.SS2.p1.20.m20.1.1.3.3" xref="S2.SS2.p1.20.m20.1.1.3.3.cmml"><mi id="S2.SS2.p1.20.m20.1.1.3.3.2" xref="S2.SS2.p1.20.m20.1.1.3.3.2.cmml">θ</mi><mn id="S2.SS2.p1.20.m20.1.1.3.3.3" xref="S2.SS2.p1.20.m20.1.1.3.3.3.cmml">2</mn></msub></msub><mo id="S2.SS2.p1.20.m20.1.1.2" xref="S2.SS2.p1.20.m20.1.1.2.cmml">⁢</mo><mrow id="S2.SS2.p1.20.m20.1.1.1.1" xref="S2.SS2.p1.20.m20.1.1.1.1.1.cmml"><mo id="S2.SS2.p1.20.m20.1.1.1.1.2" stretchy="false" xref="S2.SS2.p1.20.m20.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p1.20.m20.1.1.1.1.1" xref="S2.SS2.p1.20.m20.1.1.1.1.1.cmml"><msup id="S2.SS2.p1.20.m20.1.1.1.1.1.4" xref="S2.SS2.p1.20.m20.1.1.1.1.1.4.cmml"><mi id="S2.SS2.p1.20.m20.1.1.1.1.1.4.2" xref="S2.SS2.p1.20.m20.1.1.1.1.1.4.2.cmml">𝐱</mi><mrow id="S2.SS2.p1.20.m20.1.1.1.1.1.4.3" xref="S2.SS2.p1.20.m20.1.1.1.1.1.4.3.cmml"><mi id="S2.SS2.p1.20.m20.1.1.1.1.1.4.3.2" xref="S2.SS2.p1.20.m20.1.1.1.1.1.4.3.2.cmml">t</mi><mo id="S2.SS2.p1.20.m20.1.1.1.1.1.4.3.1" xref="S2.SS2.p1.20.m20.1.1.1.1.1.4.3.1.cmml">−</mo><mn id="S2.SS2.p1.20.m20.1.1.1.1.1.4.3.3" xref="S2.SS2.p1.20.m20.1.1.1.1.1.4.3.3.cmml">1</mn></mrow></msup><mo fence="false" id="S2.SS2.p1.20.m20.1.1.1.1.1.3" xref="S2.SS2.p1.20.m20.1.1.1.1.1.3.cmml">|</mo><mrow id="S2.SS2.p1.20.m20.1.1.1.1.1.2.2" xref="S2.SS2.p1.20.m20.1.1.1.1.1.2.3.cmml"><msup id="S2.SS2.p1.20.m20.1.1.1.1.1.1.1.1" xref="S2.SS2.p1.20.m20.1.1.1.1.1.1.1.1.cmml"><mi id="S2.SS2.p1.20.m20.1.1.1.1.1.1.1.1.2" xref="S2.SS2.p1.20.m20.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S2.SS2.p1.20.m20.1.1.1.1.1.1.1.1.3" xref="S2.SS2.p1.20.m20.1.1.1.1.1.1.1.1.3.cmml">t</mi></msup><mo id="S2.SS2.p1.20.m20.1.1.1.1.1.2.2.3" xref="S2.SS2.p1.20.m20.1.1.1.1.1.2.3.cmml">,</mo><msup id="S2.SS2.p1.20.m20.1.1.1.1.1.2.2.2" xref="S2.SS2.p1.20.m20.1.1.1.1.1.2.2.2.cmml"><mi id="S2.SS2.p1.20.m20.1.1.1.1.1.2.2.2.2" xref="S2.SS2.p1.20.m20.1.1.1.1.1.2.2.2.2.cmml">𝐱</mi><mn id="S2.SS2.p1.20.m20.1.1.1.1.1.2.2.2.3" xref="S2.SS2.p1.20.m20.1.1.1.1.1.2.2.2.3.cmml">0</mn></msup></mrow></mrow><mo id="S2.SS2.p1.20.m20.1.1.1.1.3" stretchy="false" xref="S2.SS2.p1.20.m20.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.20.m20.1b"><apply id="S2.SS2.p1.20.m20.1.1.cmml" xref="S2.SS2.p1.20.m20.1.1"><times id="S2.SS2.p1.20.m20.1.1.2.cmml" xref="S2.SS2.p1.20.m20.1.1.2"></times><apply id="S2.SS2.p1.20.m20.1.1.3.cmml" xref="S2.SS2.p1.20.m20.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p1.20.m20.1.1.3.1.cmml" xref="S2.SS2.p1.20.m20.1.1.3">subscript</csymbol><ci id="S2.SS2.p1.20.m20.1.1.3.2.cmml" xref="S2.SS2.p1.20.m20.1.1.3.2">𝑝</ci><apply id="S2.SS2.p1.20.m20.1.1.3.3.cmml" xref="S2.SS2.p1.20.m20.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS2.p1.20.m20.1.1.3.3.1.cmml" xref="S2.SS2.p1.20.m20.1.1.3.3">subscript</csymbol><ci id="S2.SS2.p1.20.m20.1.1.3.3.2.cmml" xref="S2.SS2.p1.20.m20.1.1.3.3.2">𝜃</ci><cn id="S2.SS2.p1.20.m20.1.1.3.3.3.cmml" type="integer" xref="S2.SS2.p1.20.m20.1.1.3.3.3">2</cn></apply></apply><apply id="S2.SS2.p1.20.m20.1.1.1.1.1.cmml" xref="S2.SS2.p1.20.m20.1.1.1.1"><csymbol cd="latexml" id="S2.SS2.p1.20.m20.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.20.m20.1.1.1.1.1.3">conditional</csymbol><apply id="S2.SS2.p1.20.m20.1.1.1.1.1.4.cmml" xref="S2.SS2.p1.20.m20.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.SS2.p1.20.m20.1.1.1.1.1.4.1.cmml" xref="S2.SS2.p1.20.m20.1.1.1.1.1.4">superscript</csymbol><ci id="S2.SS2.p1.20.m20.1.1.1.1.1.4.2.cmml" xref="S2.SS2.p1.20.m20.1.1.1.1.1.4.2">𝐱</ci><apply id="S2.SS2.p1.20.m20.1.1.1.1.1.4.3.cmml" xref="S2.SS2.p1.20.m20.1.1.1.1.1.4.3"><minus id="S2.SS2.p1.20.m20.1.1.1.1.1.4.3.1.cmml" xref="S2.SS2.p1.20.m20.1.1.1.1.1.4.3.1"></minus><ci id="S2.SS2.p1.20.m20.1.1.1.1.1.4.3.2.cmml" xref="S2.SS2.p1.20.m20.1.1.1.1.1.4.3.2">𝑡</ci><cn id="S2.SS2.p1.20.m20.1.1.1.1.1.4.3.3.cmml" type="integer" xref="S2.SS2.p1.20.m20.1.1.1.1.1.4.3.3">1</cn></apply></apply><list id="S2.SS2.p1.20.m20.1.1.1.1.1.2.3.cmml" xref="S2.SS2.p1.20.m20.1.1.1.1.1.2.2"><apply id="S2.SS2.p1.20.m20.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.20.m20.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.20.m20.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.20.m20.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.SS2.p1.20.m20.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.20.m20.1.1.1.1.1.1.1.1.2">𝐱</ci><ci id="S2.SS2.p1.20.m20.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.20.m20.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S2.SS2.p1.20.m20.1.1.1.1.1.2.2.2.cmml" xref="S2.SS2.p1.20.m20.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.20.m20.1.1.1.1.1.2.2.2.1.cmml" xref="S2.SS2.p1.20.m20.1.1.1.1.1.2.2.2">superscript</csymbol><ci id="S2.SS2.p1.20.m20.1.1.1.1.1.2.2.2.2.cmml" xref="S2.SS2.p1.20.m20.1.1.1.1.1.2.2.2.2">𝐱</ci><cn id="S2.SS2.p1.20.m20.1.1.1.1.1.2.2.2.3.cmml" type="integer" xref="S2.SS2.p1.20.m20.1.1.1.1.1.2.2.2.3">0</cn></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.20.m20.1c">p_{\theta_{2}}(\mathbf{x}^{t-1}|\mathbf{x}^{t},\mathbf{x}^{0})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.20.m20.1d">italic_p start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_x start_POSTSUPERSCRIPT italic_t - 1 end_POSTSUPERSCRIPT | bold_x start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT , bold_x start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT )</annotation></semantics></math>. For inverse molecular design with multi-property constraints, the denoising model can be optimized by minimizing the negative log-likelihood for <math alttext="\mathbf{x}^{0}" class="ltx_Math" display="inline" id="S2.SS2.p1.21.m21.1"><semantics id="S2.SS2.p1.21.m21.1a"><msup id="S2.SS2.p1.21.m21.1.1" xref="S2.SS2.p1.21.m21.1.1.cmml"><mi id="S2.SS2.p1.21.m21.1.1.2" xref="S2.SS2.p1.21.m21.1.1.2.cmml">𝐱</mi><mn id="S2.SS2.p1.21.m21.1.1.3" xref="S2.SS2.p1.21.m21.1.1.3.cmml">0</mn></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.21.m21.1b"><apply id="S2.SS2.p1.21.m21.1.1.cmml" xref="S2.SS2.p1.21.m21.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.21.m21.1.1.1.cmml" xref="S2.SS2.p1.21.m21.1.1">superscript</csymbol><ci id="S2.SS2.p1.21.m21.1.1.2.cmml" xref="S2.SS2.p1.21.m21.1.1.2">𝐱</ci><cn id="S2.SS2.p1.21.m21.1.1.3.cmml" type="integer" xref="S2.SS2.p1.21.m21.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.21.m21.1c">\mathbf{x}^{0}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.21.m21.1d">bold_x start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT</annotation></semantics></math>:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\text{DM}}=\mathbb{E}_{q(\mathbf{x}^{0})}\mathbb{E}_{q(\mathbf{x}%
^{t}\mid\mathbf{x}^{0})}\left[-\log p_{\theta_{2}}\left(\mathbf{x}^{0}\mid c_{%
1},c_{2},\dots,c_{M},\mathbf{c}_{\text{text}},\mathbf{x}^{t}\right)\right]," class="ltx_Math" display="block" id="S2.E2.m1.4"><semantics id="S2.E2.m1.4a"><mrow id="S2.E2.m1.4.4.1" xref="S2.E2.m1.4.4.1.1.cmml"><mrow id="S2.E2.m1.4.4.1.1" xref="S2.E2.m1.4.4.1.1.cmml"><msub id="S2.E2.m1.4.4.1.1.3" xref="S2.E2.m1.4.4.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.4.4.1.1.3.2" xref="S2.E2.m1.4.4.1.1.3.2.cmml">ℒ</mi><mtext id="S2.E2.m1.4.4.1.1.3.3" xref="S2.E2.m1.4.4.1.1.3.3a.cmml">DM</mtext></msub><mo id="S2.E2.m1.4.4.1.1.2" xref="S2.E2.m1.4.4.1.1.2.cmml">=</mo><mrow id="S2.E2.m1.4.4.1.1.1" xref="S2.E2.m1.4.4.1.1.1.cmml"><msub id="S2.E2.m1.4.4.1.1.1.3" xref="S2.E2.m1.4.4.1.1.1.3.cmml"><mi id="S2.E2.m1.4.4.1.1.1.3.2" xref="S2.E2.m1.4.4.1.1.1.3.2.cmml">𝔼</mi><mrow id="S2.E2.m1.1.1.1" xref="S2.E2.m1.1.1.1.cmml"><mi id="S2.E2.m1.1.1.1.3" xref="S2.E2.m1.1.1.1.3.cmml">q</mi><mo id="S2.E2.m1.1.1.1.2" xref="S2.E2.m1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E2.m1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.cmml"><mo id="S2.E2.m1.1.1.1.1.1.2" stretchy="false" xref="S2.E2.m1.1.1.1.1.1.1.cmml">(</mo><msup id="S2.E2.m1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.1.2.cmml">𝐱</mi><mn id="S2.E2.m1.1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.1.3.cmml">0</mn></msup><mo id="S2.E2.m1.1.1.1.1.1.3" stretchy="false" xref="S2.E2.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msub><mo id="S2.E2.m1.4.4.1.1.1.2" xref="S2.E2.m1.4.4.1.1.1.2.cmml">⁢</mo><msub id="S2.E2.m1.4.4.1.1.1.4" xref="S2.E2.m1.4.4.1.1.1.4.cmml"><mi id="S2.E2.m1.4.4.1.1.1.4.2" xref="S2.E2.m1.4.4.1.1.1.4.2.cmml">𝔼</mi><mrow id="S2.E2.m1.2.2.1" xref="S2.E2.m1.2.2.1.cmml"><mi id="S2.E2.m1.2.2.1.3" xref="S2.E2.m1.2.2.1.3.cmml">q</mi><mo id="S2.E2.m1.2.2.1.2" xref="S2.E2.m1.2.2.1.2.cmml">⁢</mo><mrow id="S2.E2.m1.2.2.1.1.1" xref="S2.E2.m1.2.2.1.1.1.1.cmml"><mo id="S2.E2.m1.2.2.1.1.1.2" stretchy="false" xref="S2.E2.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.2.2.1.1.1.1" xref="S2.E2.m1.2.2.1.1.1.1.cmml"><msup id="S2.E2.m1.2.2.1.1.1.1.2" xref="S2.E2.m1.2.2.1.1.1.1.2.cmml"><mi id="S2.E2.m1.2.2.1.1.1.1.2.2" xref="S2.E2.m1.2.2.1.1.1.1.2.2.cmml">𝐱</mi><mi id="S2.E2.m1.2.2.1.1.1.1.2.3" xref="S2.E2.m1.2.2.1.1.1.1.2.3.cmml">t</mi></msup><mo id="S2.E2.m1.2.2.1.1.1.1.1" xref="S2.E2.m1.2.2.1.1.1.1.1.cmml">∣</mo><msup id="S2.E2.m1.2.2.1.1.1.1.3" xref="S2.E2.m1.2.2.1.1.1.1.3.cmml"><mi id="S2.E2.m1.2.2.1.1.1.1.3.2" xref="S2.E2.m1.2.2.1.1.1.1.3.2.cmml">𝐱</mi><mn id="S2.E2.m1.2.2.1.1.1.1.3.3" xref="S2.E2.m1.2.2.1.1.1.1.3.3.cmml">0</mn></msup></mrow><mo id="S2.E2.m1.2.2.1.1.1.3" stretchy="false" xref="S2.E2.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></msub><mo id="S2.E2.m1.4.4.1.1.1.2a" xref="S2.E2.m1.4.4.1.1.1.2.cmml">⁢</mo><mrow id="S2.E2.m1.4.4.1.1.1.1.1" xref="S2.E2.m1.4.4.1.1.1.1.2.cmml"><mo id="S2.E2.m1.4.4.1.1.1.1.1.2" xref="S2.E2.m1.4.4.1.1.1.1.2.1.cmml">[</mo><mrow id="S2.E2.m1.4.4.1.1.1.1.1.1" xref="S2.E2.m1.4.4.1.1.1.1.1.1.cmml"><mo id="S2.E2.m1.4.4.1.1.1.1.1.1a" rspace="0.167em" xref="S2.E2.m1.4.4.1.1.1.1.1.1.cmml">−</mo><mrow id="S2.E2.m1.4.4.1.1.1.1.1.1.1" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.cmml"><mrow id="S2.E2.m1.4.4.1.1.1.1.1.1.1.3" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E2.m1.4.4.1.1.1.1.1.1.1.3.1" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.3.1.cmml">log</mi><mo id="S2.E2.m1.4.4.1.1.1.1.1.1.1.3a" lspace="0.167em" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.3.cmml">⁡</mo><msub id="S2.E2.m1.4.4.1.1.1.1.1.1.1.3.2" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.3.2.cmml"><mi id="S2.E2.m1.4.4.1.1.1.1.1.1.1.3.2.2" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.3.2.2.cmml">p</mi><msub id="S2.E2.m1.4.4.1.1.1.1.1.1.1.3.2.3" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.3.2.3.cmml"><mi id="S2.E2.m1.4.4.1.1.1.1.1.1.1.3.2.3.2" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.3.2.3.2.cmml">θ</mi><mn id="S2.E2.m1.4.4.1.1.1.1.1.1.1.3.2.3.3" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.3.2.3.3.cmml">2</mn></msub></msub></mrow><mo id="S2.E2.m1.4.4.1.1.1.1.1.1.1.2" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml"><msup id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.7" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.7.cmml"><mi id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.7.2" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.7.2.cmml">𝐱</mi><mn id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.7.3" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.7.3.cmml">0</mn></msup><mo id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.6" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.6.cmml">∣</mo><mrow id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.5.5" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.5.6.cmml"><msub id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">c</mi><mn id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.5.5.6" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.5.6.cmml">,</mo><msub id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">c</mi><mn id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2.3" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">2</mn></msub><mo id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.5.5.7" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.5.6.cmml">,</mo><mi id="S2.E2.m1.3.3" mathvariant="normal" xref="S2.E2.m1.3.3.cmml">…</mi><mo id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.5.5.8" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.5.6.cmml">,</mo><msub id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml"><mi id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3.3.2" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3.3.2.cmml">c</mi><mi id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3.3.3" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3.3.3.cmml">M</mi></msub><mo id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.5.5.9" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.5.6.cmml">,</mo><msub id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.4.4.4" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.4.4.4.cmml"><mi id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.4.4.4.2" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.4.4.4.2.cmml">𝐜</mi><mtext id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.4.4.4.3" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.4.4.4.3a.cmml">text</mtext></msub><mo id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.5.5.10" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.5.6.cmml">,</mo><msup id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.5.5.5" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.5.5.5.cmml"><mi id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.5.5.5.2" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.5.5.5.2.cmml">𝐱</mi><mi id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.5.5.5.3" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.5.5.5.3.cmml">t</mi></msup></mrow></mrow><mo id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E2.m1.4.4.1.1.1.1.1.3" xref="S2.E2.m1.4.4.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S2.E2.m1.4.4.1.2" xref="S2.E2.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.4b"><apply id="S2.E2.m1.4.4.1.1.cmml" xref="S2.E2.m1.4.4.1"><eq id="S2.E2.m1.4.4.1.1.2.cmml" xref="S2.E2.m1.4.4.1.1.2"></eq><apply id="S2.E2.m1.4.4.1.1.3.cmml" xref="S2.E2.m1.4.4.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.1.1.3.1.cmml" xref="S2.E2.m1.4.4.1.1.3">subscript</csymbol><ci id="S2.E2.m1.4.4.1.1.3.2.cmml" xref="S2.E2.m1.4.4.1.1.3.2">ℒ</ci><ci id="S2.E2.m1.4.4.1.1.3.3a.cmml" xref="S2.E2.m1.4.4.1.1.3.3"><mtext id="S2.E2.m1.4.4.1.1.3.3.cmml" mathsize="70%" xref="S2.E2.m1.4.4.1.1.3.3">DM</mtext></ci></apply><apply id="S2.E2.m1.4.4.1.1.1.cmml" xref="S2.E2.m1.4.4.1.1.1"><times id="S2.E2.m1.4.4.1.1.1.2.cmml" xref="S2.E2.m1.4.4.1.1.1.2"></times><apply id="S2.E2.m1.4.4.1.1.1.3.cmml" xref="S2.E2.m1.4.4.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.1.1.1.3.1.cmml" xref="S2.E2.m1.4.4.1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.4.4.1.1.1.3.2.cmml" xref="S2.E2.m1.4.4.1.1.1.3.2">𝔼</ci><apply id="S2.E2.m1.1.1.1.cmml" xref="S2.E2.m1.1.1.1"><times id="S2.E2.m1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.2"></times><ci id="S2.E2.m1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.3">𝑞</ci><apply id="S2.E2.m1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1">superscript</csymbol><ci id="S2.E2.m1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2">𝐱</ci><cn id="S2.E2.m1.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.E2.m1.1.1.1.1.1.1.3">0</cn></apply></apply></apply><apply id="S2.E2.m1.4.4.1.1.1.4.cmml" xref="S2.E2.m1.4.4.1.1.1.4"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.1.1.1.4.1.cmml" xref="S2.E2.m1.4.4.1.1.1.4">subscript</csymbol><ci id="S2.E2.m1.4.4.1.1.1.4.2.cmml" xref="S2.E2.m1.4.4.1.1.1.4.2">𝔼</ci><apply id="S2.E2.m1.2.2.1.cmml" xref="S2.E2.m1.2.2.1"><times id="S2.E2.m1.2.2.1.2.cmml" xref="S2.E2.m1.2.2.1.2"></times><ci id="S2.E2.m1.2.2.1.3.cmml" xref="S2.E2.m1.2.2.1.3">𝑞</ci><apply id="S2.E2.m1.2.2.1.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.1"><csymbol cd="latexml" id="S2.E2.m1.2.2.1.1.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1">conditional</csymbol><apply id="S2.E2.m1.2.2.1.1.1.1.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.1.1.2.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.2">superscript</csymbol><ci id="S2.E2.m1.2.2.1.1.1.1.2.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.2.2">𝐱</ci><ci id="S2.E2.m1.2.2.1.1.1.1.2.3.cmml" xref="S2.E2.m1.2.2.1.1.1.1.2.3">𝑡</ci></apply><apply id="S2.E2.m1.2.2.1.1.1.1.3.cmml" xref="S2.E2.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.1.1.3.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.3">superscript</csymbol><ci id="S2.E2.m1.2.2.1.1.1.1.3.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.3.2">𝐱</ci><cn id="S2.E2.m1.2.2.1.1.1.1.3.3.cmml" type="integer" xref="S2.E2.m1.2.2.1.1.1.1.3.3">0</cn></apply></apply></apply></apply><apply id="S2.E2.m1.4.4.1.1.1.1.2.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1"><csymbol cd="latexml" id="S2.E2.m1.4.4.1.1.1.1.2.1.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.E2.m1.4.4.1.1.1.1.1.1.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1"><minus id="S2.E2.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1"></minus><apply id="S2.E2.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1"><times id="S2.E2.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.2"></times><apply id="S2.E2.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.3"><log id="S2.E2.m1.4.4.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.3.1"></log><apply id="S2.E2.m1.4.4.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.1.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S2.E2.m1.4.4.1.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.3.2.2">𝑝</ci><apply id="S2.E2.m1.4.4.1.1.1.1.1.1.1.3.2.3.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.1.1.1.1.1.1.1.3.2.3.1.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.3.2.3">subscript</csymbol><ci id="S2.E2.m1.4.4.1.1.1.1.1.1.1.3.2.3.2.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.3.2.3.2">𝜃</ci><cn id="S2.E2.m1.4.4.1.1.1.1.1.1.1.3.2.3.3.cmml" type="integer" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.3.2.3.3">2</cn></apply></apply></apply><apply id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.6.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.6">conditional</csymbol><apply id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.7.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.7"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.7.1.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.7">superscript</csymbol><ci id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.7.2.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.7.2">𝐱</ci><cn id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.7.3.cmml" type="integer" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.7.3">0</cn></apply><list id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.5.6.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.5.5"><apply id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑐</ci><cn id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3">1</cn></apply><apply id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2.2">𝑐</ci><cn id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" type="integer" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2.3">2</cn></apply><ci id="S2.E2.m1.3.3.cmml" xref="S2.E2.m1.3.3">…</ci><apply id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3.3.1.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3.3.2.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3.3.2">𝑐</ci><ci id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3.3.3.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3.3.3">𝑀</ci></apply><apply id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.4.4.4.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.4.4.4"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.4.4.4.1.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.4.4.4">subscript</csymbol><ci id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.4.4.4.2.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.4.4.4.2">𝐜</ci><ci id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.4.4.4.3a.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.4.4.4.3"><mtext id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.4.4.4.3.cmml" mathsize="70%" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.4.4.4.3">text</mtext></ci></apply><apply id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.5.5.5.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.5.5.5"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.5.5.5.1.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.5.5.5">superscript</csymbol><ci id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.5.5.5.2.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.5.5.5.2">𝐱</ci><ci id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.5.5.5.3.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.5.5.5.3">𝑡</ci></apply></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.4c">\mathcal{L}_{\text{DM}}=\mathbb{E}_{q(\mathbf{x}^{0})}\mathbb{E}_{q(\mathbf{x}%
^{t}\mid\mathbf{x}^{0})}\left[-\log p_{\theta_{2}}\left(\mathbf{x}^{0}\mid c_{%
1},c_{2},\dots,c_{M},\mathbf{c}_{\text{text}},\mathbf{x}^{t}\right)\right],</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.4d">caligraphic_L start_POSTSUBSCRIPT DM end_POSTSUBSCRIPT = blackboard_E start_POSTSUBSCRIPT italic_q ( bold_x start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT ) end_POSTSUBSCRIPT blackboard_E start_POSTSUBSCRIPT italic_q ( bold_x start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ∣ bold_x start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT ) end_POSTSUBSCRIPT [ - roman_log italic_p start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_x start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT ∣ italic_c start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_c start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_c start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT , bold_c start_POSTSUBSCRIPT text end_POSTSUBSCRIPT , bold_x start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ) ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.p1.24">where <math alttext="M" class="ltx_Math" display="inline" id="S2.SS2.p1.22.m1.1"><semantics id="S2.SS2.p1.22.m1.1a"><mi id="S2.SS2.p1.22.m1.1.1" xref="S2.SS2.p1.22.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.22.m1.1b"><ci id="S2.SS2.p1.22.m1.1.1.cmml" xref="S2.SS2.p1.22.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.22.m1.1c">M</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.22.m1.1d">italic_M</annotation></semantics></math> molecular properties are denoted by <math alttext="\{c_{i}\}_{i=1}^{M}" class="ltx_Math" display="inline" id="S2.SS2.p1.23.m2.1"><semantics id="S2.SS2.p1.23.m2.1a"><msubsup id="S2.SS2.p1.23.m2.1.1" xref="S2.SS2.p1.23.m2.1.1.cmml"><mrow id="S2.SS2.p1.23.m2.1.1.1.1.1" xref="S2.SS2.p1.23.m2.1.1.1.1.2.cmml"><mo id="S2.SS2.p1.23.m2.1.1.1.1.1.2" stretchy="false" xref="S2.SS2.p1.23.m2.1.1.1.1.2.cmml">{</mo><msub id="S2.SS2.p1.23.m2.1.1.1.1.1.1" xref="S2.SS2.p1.23.m2.1.1.1.1.1.1.cmml"><mi id="S2.SS2.p1.23.m2.1.1.1.1.1.1.2" xref="S2.SS2.p1.23.m2.1.1.1.1.1.1.2.cmml">c</mi><mi id="S2.SS2.p1.23.m2.1.1.1.1.1.1.3" xref="S2.SS2.p1.23.m2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.SS2.p1.23.m2.1.1.1.1.1.3" stretchy="false" xref="S2.SS2.p1.23.m2.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.SS2.p1.23.m2.1.1.1.3" xref="S2.SS2.p1.23.m2.1.1.1.3.cmml"><mi id="S2.SS2.p1.23.m2.1.1.1.3.2" xref="S2.SS2.p1.23.m2.1.1.1.3.2.cmml">i</mi><mo id="S2.SS2.p1.23.m2.1.1.1.3.1" xref="S2.SS2.p1.23.m2.1.1.1.3.1.cmml">=</mo><mn id="S2.SS2.p1.23.m2.1.1.1.3.3" xref="S2.SS2.p1.23.m2.1.1.1.3.3.cmml">1</mn></mrow><mi id="S2.SS2.p1.23.m2.1.1.3" xref="S2.SS2.p1.23.m2.1.1.3.cmml">M</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.23.m2.1b"><apply id="S2.SS2.p1.23.m2.1.1.cmml" xref="S2.SS2.p1.23.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.23.m2.1.1.2.cmml" xref="S2.SS2.p1.23.m2.1.1">superscript</csymbol><apply id="S2.SS2.p1.23.m2.1.1.1.cmml" xref="S2.SS2.p1.23.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.23.m2.1.1.1.2.cmml" xref="S2.SS2.p1.23.m2.1.1">subscript</csymbol><set id="S2.SS2.p1.23.m2.1.1.1.1.2.cmml" xref="S2.SS2.p1.23.m2.1.1.1.1.1"><apply id="S2.SS2.p1.23.m2.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.23.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.23.m2.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.23.m2.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p1.23.m2.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.23.m2.1.1.1.1.1.1.2">𝑐</ci><ci id="S2.SS2.p1.23.m2.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.23.m2.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S2.SS2.p1.23.m2.1.1.1.3.cmml" xref="S2.SS2.p1.23.m2.1.1.1.3"><eq id="S2.SS2.p1.23.m2.1.1.1.3.1.cmml" xref="S2.SS2.p1.23.m2.1.1.1.3.1"></eq><ci id="S2.SS2.p1.23.m2.1.1.1.3.2.cmml" xref="S2.SS2.p1.23.m2.1.1.1.3.2">𝑖</ci><cn id="S2.SS2.p1.23.m2.1.1.1.3.3.cmml" type="integer" xref="S2.SS2.p1.23.m2.1.1.1.3.3">1</cn></apply></apply><ci id="S2.SS2.p1.23.m2.1.1.3.cmml" xref="S2.SS2.p1.23.m2.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.23.m2.1c">\{c_{i}\}_{i=1}^{M}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.23.m2.1d">{ italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT</annotation></semantics></math>, and the text embedding is <math alttext="\mathbf{c}_{\text{text}}" class="ltx_Math" display="inline" id="S2.SS2.p1.24.m3.1"><semantics id="S2.SS2.p1.24.m3.1a"><msub id="S2.SS2.p1.24.m3.1.1" xref="S2.SS2.p1.24.m3.1.1.cmml"><mi id="S2.SS2.p1.24.m3.1.1.2" xref="S2.SS2.p1.24.m3.1.1.2.cmml">𝐜</mi><mtext id="S2.SS2.p1.24.m3.1.1.3" xref="S2.SS2.p1.24.m3.1.1.3a.cmml">text</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.24.m3.1b"><apply id="S2.SS2.p1.24.m3.1.1.cmml" xref="S2.SS2.p1.24.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.24.m3.1.1.1.cmml" xref="S2.SS2.p1.24.m3.1.1">subscript</csymbol><ci id="S2.SS2.p1.24.m3.1.1.2.cmml" xref="S2.SS2.p1.24.m3.1.1.2">𝐜</ci><ci id="S2.SS2.p1.24.m3.1.1.3a.cmml" xref="S2.SS2.p1.24.m3.1.1.3"><mtext id="S2.SS2.p1.24.m3.1.1.3.cmml" mathsize="70%" xref="S2.SS2.p1.24.m3.1.1.3">text</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.24.m3.1c">\mathbf{c}_{\text{text}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.24.m3.1d">bold_c start_POSTSUBSCRIPT text end_POSTSUBSCRIPT</annotation></semantics></math>. These conditions can be handled by Graph DiT&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Liu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib27" title="">2024c</a>)</cite> without introducing additional predictors for guidance&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Ho and Salimans, <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib15" title="">2022</a>)</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>One-Step Reaction Prediction with Graph Neural Networks</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.6">Retrosynthesis needs to predict the reverse of a synthetic reaction, which decomposes chemical products into reactants. A GNN parameterized by <math alttext="\theta_{3}" class="ltx_Math" display="inline" id="S2.SS3.p1.1.m1.1"><semantics id="S2.SS3.p1.1.m1.1a"><msub id="S2.SS3.p1.1.m1.1.1" xref="S2.SS3.p1.1.m1.1.1.cmml"><mi id="S2.SS3.p1.1.m1.1.1.2" xref="S2.SS3.p1.1.m1.1.1.2.cmml">θ</mi><mn id="S2.SS3.p1.1.m1.1.1.3" xref="S2.SS3.p1.1.m1.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.1.m1.1b"><apply id="S2.SS3.p1.1.m1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.1.m1.1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS3.p1.1.m1.1.1.2.cmml" xref="S2.SS3.p1.1.m1.1.1.2">𝜃</ci><cn id="S2.SS3.p1.1.m1.1.1.3.cmml" type="integer" xref="S2.SS3.p1.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.1.m1.1c">\theta_{3}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.1.m1.1d">italic_θ start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT</annotation></semantics></math> takes the product <math alttext="G_{\text{product}}" class="ltx_Math" display="inline" id="S2.SS3.p1.2.m2.1"><semantics id="S2.SS3.p1.2.m2.1a"><msub id="S2.SS3.p1.2.m2.1.1" xref="S2.SS3.p1.2.m2.1.1.cmml"><mi id="S2.SS3.p1.2.m2.1.1.2" xref="S2.SS3.p1.2.m2.1.1.2.cmml">G</mi><mtext id="S2.SS3.p1.2.m2.1.1.3" xref="S2.SS3.p1.2.m2.1.1.3a.cmml">product</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.2.m2.1b"><apply id="S2.SS3.p1.2.m2.1.1.cmml" xref="S2.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.2.m2.1.1.1.cmml" xref="S2.SS3.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SS3.p1.2.m2.1.1.2.cmml" xref="S2.SS3.p1.2.m2.1.1.2">𝐺</ci><ci id="S2.SS3.p1.2.m2.1.1.3a.cmml" xref="S2.SS3.p1.2.m2.1.1.3"><mtext id="S2.SS3.p1.2.m2.1.1.3.cmml" mathsize="70%" xref="S2.SS3.p1.2.m2.1.1.3">product</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.2.m2.1c">G_{\text{product}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.2.m2.1d">italic_G start_POSTSUBSCRIPT product end_POSTSUBSCRIPT</annotation></semantics></math> to predict the label <math alttext="r\in\mathcal{R}" class="ltx_Math" display="inline" id="S2.SS3.p1.3.m3.1"><semantics id="S2.SS3.p1.3.m3.1a"><mrow id="S2.SS3.p1.3.m3.1.1" xref="S2.SS3.p1.3.m3.1.1.cmml"><mi id="S2.SS3.p1.3.m3.1.1.2" xref="S2.SS3.p1.3.m3.1.1.2.cmml">r</mi><mo id="S2.SS3.p1.3.m3.1.1.1" xref="S2.SS3.p1.3.m3.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS3.p1.3.m3.1.1.3" xref="S2.SS3.p1.3.m3.1.1.3.cmml">ℛ</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.3.m3.1b"><apply id="S2.SS3.p1.3.m3.1.1.cmml" xref="S2.SS3.p1.3.m3.1.1"><in id="S2.SS3.p1.3.m3.1.1.1.cmml" xref="S2.SS3.p1.3.m3.1.1.1"></in><ci id="S2.SS3.p1.3.m3.1.1.2.cmml" xref="S2.SS3.p1.3.m3.1.1.2">𝑟</ci><ci id="S2.SS3.p1.3.m3.1.1.3.cmml" xref="S2.SS3.p1.3.m3.1.1.3">ℛ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.3.m3.1c">r\in\mathcal{R}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.3.m3.1d">italic_r ∈ caligraphic_R</annotation></semantics></math> in the reaction space <math alttext="\mathcal{R}" class="ltx_Math" display="inline" id="S2.SS3.p1.4.m4.1"><semantics id="S2.SS3.p1.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.p1.4.m4.1.1" xref="S2.SS3.p1.4.m4.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.4.m4.1b"><ci id="S2.SS3.p1.4.m4.1.1.cmml" xref="S2.SS3.p1.4.m4.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.4.m4.1c">\mathcal{R}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.4.m4.1d">caligraphic_R</annotation></semantics></math>. This label is interpreted as the template and determines the reactants. With the text condition <math alttext="\mathbf{c}_{\text{text}}" class="ltx_Math" display="inline" id="S2.SS3.p1.5.m5.1"><semantics id="S2.SS3.p1.5.m5.1a"><msub id="S2.SS3.p1.5.m5.1.1" xref="S2.SS3.p1.5.m5.1.1.cmml"><mi id="S2.SS3.p1.5.m5.1.1.2" xref="S2.SS3.p1.5.m5.1.1.2.cmml">𝐜</mi><mtext id="S2.SS3.p1.5.m5.1.1.3" xref="S2.SS3.p1.5.m5.1.1.3a.cmml">text</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.5.m5.1b"><apply id="S2.SS3.p1.5.m5.1.1.cmml" xref="S2.SS3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.5.m5.1.1.1.cmml" xref="S2.SS3.p1.5.m5.1.1">subscript</csymbol><ci id="S2.SS3.p1.5.m5.1.1.2.cmml" xref="S2.SS3.p1.5.m5.1.1.2">𝐜</ci><ci id="S2.SS3.p1.5.m5.1.1.3a.cmml" xref="S2.SS3.p1.5.m5.1.1.3"><mtext id="S2.SS3.p1.5.m5.1.1.3.cmml" mathsize="70%" xref="S2.SS3.p1.5.m5.1.1.3">text</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.5.m5.1c">\mathbf{c}_{\text{text}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.5.m5.1d">bold_c start_POSTSUBSCRIPT text end_POSTSUBSCRIPT</annotation></semantics></math>, we minimize the negative log-likelihood of the label distribution <math alttext="q(r)" class="ltx_Math" display="inline" id="S2.SS3.p1.6.m6.1"><semantics id="S2.SS3.p1.6.m6.1a"><mrow id="S2.SS3.p1.6.m6.1.2" xref="S2.SS3.p1.6.m6.1.2.cmml"><mi id="S2.SS3.p1.6.m6.1.2.2" xref="S2.SS3.p1.6.m6.1.2.2.cmml">q</mi><mo id="S2.SS3.p1.6.m6.1.2.1" xref="S2.SS3.p1.6.m6.1.2.1.cmml">⁢</mo><mrow id="S2.SS3.p1.6.m6.1.2.3.2" xref="S2.SS3.p1.6.m6.1.2.cmml"><mo id="S2.SS3.p1.6.m6.1.2.3.2.1" stretchy="false" xref="S2.SS3.p1.6.m6.1.2.cmml">(</mo><mi id="S2.SS3.p1.6.m6.1.1" xref="S2.SS3.p1.6.m6.1.1.cmml">r</mi><mo id="S2.SS3.p1.6.m6.1.2.3.2.2" stretchy="false" xref="S2.SS3.p1.6.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.6.m6.1b"><apply id="S2.SS3.p1.6.m6.1.2.cmml" xref="S2.SS3.p1.6.m6.1.2"><times id="S2.SS3.p1.6.m6.1.2.1.cmml" xref="S2.SS3.p1.6.m6.1.2.1"></times><ci id="S2.SS3.p1.6.m6.1.2.2.cmml" xref="S2.SS3.p1.6.m6.1.2.2">𝑞</ci><ci id="S2.SS3.p1.6.m6.1.1.cmml" xref="S2.SS3.p1.6.m6.1.1">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.6.m6.1c">q(r)</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.6.m6.1d">italic_q ( italic_r )</annotation></semantics></math>:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S2.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\text{predictor}}=\mathbb{E}_{q(r)}\left[-\log p_{\theta_{3}}(r%
\mid\mathbf{c}_{\text{text}},G_{\text{product}})\right]." class="ltx_Math" display="block" id="S2.E3.m1.2"><semantics id="S2.E3.m1.2a"><mrow id="S2.E3.m1.2.2.1" xref="S2.E3.m1.2.2.1.1.cmml"><mrow id="S2.E3.m1.2.2.1.1" xref="S2.E3.m1.2.2.1.1.cmml"><msub id="S2.E3.m1.2.2.1.1.3" xref="S2.E3.m1.2.2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E3.m1.2.2.1.1.3.2" xref="S2.E3.m1.2.2.1.1.3.2.cmml">ℒ</mi><mtext id="S2.E3.m1.2.2.1.1.3.3" xref="S2.E3.m1.2.2.1.1.3.3a.cmml">predictor</mtext></msub><mo id="S2.E3.m1.2.2.1.1.2" xref="S2.E3.m1.2.2.1.1.2.cmml">=</mo><mrow id="S2.E3.m1.2.2.1.1.1" xref="S2.E3.m1.2.2.1.1.1.cmml"><msub id="S2.E3.m1.2.2.1.1.1.3" xref="S2.E3.m1.2.2.1.1.1.3.cmml"><mi id="S2.E3.m1.2.2.1.1.1.3.2" xref="S2.E3.m1.2.2.1.1.1.3.2.cmml">𝔼</mi><mrow id="S2.E3.m1.1.1.1" xref="S2.E3.m1.1.1.1.cmml"><mi id="S2.E3.m1.1.1.1.3" xref="S2.E3.m1.1.1.1.3.cmml">q</mi><mo id="S2.E3.m1.1.1.1.2" xref="S2.E3.m1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E3.m1.1.1.1.4.2" xref="S2.E3.m1.1.1.1.cmml"><mo id="S2.E3.m1.1.1.1.4.2.1" stretchy="false" xref="S2.E3.m1.1.1.1.cmml">(</mo><mi id="S2.E3.m1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.cmml">r</mi><mo id="S2.E3.m1.1.1.1.4.2.2" stretchy="false" xref="S2.E3.m1.1.1.1.cmml">)</mo></mrow></mrow></msub><mo id="S2.E3.m1.2.2.1.1.1.2" xref="S2.E3.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S2.E3.m1.2.2.1.1.1.1.1" xref="S2.E3.m1.2.2.1.1.1.1.2.cmml"><mo id="S2.E3.m1.2.2.1.1.1.1.1.2" xref="S2.E3.m1.2.2.1.1.1.1.2.1.cmml">[</mo><mrow id="S2.E3.m1.2.2.1.1.1.1.1.1" xref="S2.E3.m1.2.2.1.1.1.1.1.1.cmml"><mo id="S2.E3.m1.2.2.1.1.1.1.1.1a" rspace="0.167em" xref="S2.E3.m1.2.2.1.1.1.1.1.1.cmml">−</mo><mrow id="S2.E3.m1.2.2.1.1.1.1.1.1.1" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.cmml"><mrow id="S2.E3.m1.2.2.1.1.1.1.1.1.1.3" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.1" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.1.cmml">log</mi><mo id="S2.E3.m1.2.2.1.1.1.1.1.1.1.3a" lspace="0.167em" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.cmml">⁡</mo><msub id="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.2" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.2.cmml"><mi id="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.2.2" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.2.2.cmml">p</mi><msub id="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.2.3" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.2.3.cmml"><mi id="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.2.3.2" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.2.3.2.cmml">θ</mi><mn id="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.2.3.3" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.2.3.3.cmml">3</mn></msub></msub></mrow><mo id="S2.E3.m1.2.2.1.1.1.1.1.1.1.2" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.4" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.4.cmml">r</mi><mo id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml">∣</mo><mrow id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><msub id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐜</mi><mtext id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.3a.cmml">text</mtext></msub><mo id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">G</mi><mtext id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.2.3" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.2.3a.cmml">product</mtext></msub></mrow></mrow><mo id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E3.m1.2.2.1.1.1.1.1.3" xref="S2.E3.m1.2.2.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S2.E3.m1.2.2.1.2" lspace="0em" xref="S2.E3.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.2b"><apply id="S2.E3.m1.2.2.1.1.cmml" xref="S2.E3.m1.2.2.1"><eq id="S2.E3.m1.2.2.1.1.2.cmml" xref="S2.E3.m1.2.2.1.1.2"></eq><apply id="S2.E3.m1.2.2.1.1.3.cmml" xref="S2.E3.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.1.1.3.1.cmml" xref="S2.E3.m1.2.2.1.1.3">subscript</csymbol><ci id="S2.E3.m1.2.2.1.1.3.2.cmml" xref="S2.E3.m1.2.2.1.1.3.2">ℒ</ci><ci id="S2.E3.m1.2.2.1.1.3.3a.cmml" xref="S2.E3.m1.2.2.1.1.3.3"><mtext id="S2.E3.m1.2.2.1.1.3.3.cmml" mathsize="70%" xref="S2.E3.m1.2.2.1.1.3.3">predictor</mtext></ci></apply><apply id="S2.E3.m1.2.2.1.1.1.cmml" xref="S2.E3.m1.2.2.1.1.1"><times id="S2.E3.m1.2.2.1.1.1.2.cmml" xref="S2.E3.m1.2.2.1.1.1.2"></times><apply id="S2.E3.m1.2.2.1.1.1.3.cmml" xref="S2.E3.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.1.1.1.3.1.cmml" xref="S2.E3.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S2.E3.m1.2.2.1.1.1.3.2.cmml" xref="S2.E3.m1.2.2.1.1.1.3.2">𝔼</ci><apply id="S2.E3.m1.1.1.1.cmml" xref="S2.E3.m1.1.1.1"><times id="S2.E3.m1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.2"></times><ci id="S2.E3.m1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.3">𝑞</ci><ci id="S2.E3.m1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1">𝑟</ci></apply></apply><apply id="S2.E3.m1.2.2.1.1.1.1.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1"><csymbol cd="latexml" id="S2.E3.m1.2.2.1.1.1.1.2.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.E3.m1.2.2.1.1.1.1.1.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1"><minus id="S2.E3.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1"></minus><apply id="S2.E3.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1"><times id="S2.E3.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.2"></times><apply id="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.3"><log id="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.1"></log><apply id="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.2.2">𝑝</ci><apply id="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.2.3.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.2.3.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.2.3">subscript</csymbol><ci id="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.2.3.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.2.3.2">𝜃</ci><cn id="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.2.3.3.cmml" type="integer" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.2.3.3">3</cn></apply></apply></apply><apply id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.3">conditional</csymbol><ci id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.4">𝑟</ci><list id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2"><apply id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐜</ci><ci id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.3a.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><mtext id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" mathsize="70%" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.3">text</mtext></ci></apply><apply id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.2.2">𝐺</ci><ci id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.2.3a.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.2.3"><mtext id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" mathsize="70%" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.2.3">product</mtext></ci></apply></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.2c">\mathcal{L}_{\text{predictor}}=\mathbb{E}_{q(r)}\left[-\log p_{\theta_{3}}(r%
\mid\mathbf{c}_{\text{text}},G_{\text{product}})\right].</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m1.2d">caligraphic_L start_POSTSUBSCRIPT predictor end_POSTSUBSCRIPT = blackboard_E start_POSTSUBSCRIPT italic_q ( italic_r ) end_POSTSUBSCRIPT [ - roman_log italic_p start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_r ∣ bold_c start_POSTSUBSCRIPT text end_POSTSUBSCRIPT , italic_G start_POSTSUBSCRIPT product end_POSTSUBSCRIPT ) ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsection" id="S2.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.4 </span>Retrosynthetic Planning with A* Search</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S2.SS4.p1">
<p class="ltx_p" id="S2.SS4.p1.6">Given molecules from the structure space <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="S2.SS4.p1.1.m1.1"><semantics id="S2.SS4.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.p1.1.m1.1.1" xref="S2.SS4.p1.1.m1.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.1.m1.1b"><ci id="S2.SS4.p1.1.m1.1.1.cmml" xref="S2.SS4.p1.1.m1.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.1.m1.1c">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p1.1.m1.1d">caligraphic_G</annotation></semantics></math>, a subset <math alttext="\mathcal{G}_{\text{avail}}" class="ltx_Math" display="inline" id="S2.SS4.p1.2.m2.1"><semantics id="S2.SS4.p1.2.m2.1a"><msub id="S2.SS4.p1.2.m2.1.1" xref="S2.SS4.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.p1.2.m2.1.1.2" xref="S2.SS4.p1.2.m2.1.1.2.cmml">𝒢</mi><mtext id="S2.SS4.p1.2.m2.1.1.3" xref="S2.SS4.p1.2.m2.1.1.3a.cmml">avail</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.2.m2.1b"><apply id="S2.SS4.p1.2.m2.1.1.cmml" xref="S2.SS4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS4.p1.2.m2.1.1.1.cmml" xref="S2.SS4.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SS4.p1.2.m2.1.1.2.cmml" xref="S2.SS4.p1.2.m2.1.1.2">𝒢</ci><ci id="S2.SS4.p1.2.m2.1.1.3a.cmml" xref="S2.SS4.p1.2.m2.1.1.3"><mtext id="S2.SS4.p1.2.m2.1.1.3.cmml" mathsize="70%" xref="S2.SS4.p1.2.m2.1.1.3">avail</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.2.m2.1c">\mathcal{G}_{\text{avail}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p1.2.m2.1d">caligraphic_G start_POSTSUBSCRIPT avail end_POSTSUBSCRIPT</annotation></semantics></math> represents available molecular structures that can be purchased as building blocks for synthesis. For any target <math alttext="G_{\text{target}}" class="ltx_Math" display="inline" id="S2.SS4.p1.3.m3.1"><semantics id="S2.SS4.p1.3.m3.1a"><msub id="S2.SS4.p1.3.m3.1.1" xref="S2.SS4.p1.3.m3.1.1.cmml"><mi id="S2.SS4.p1.3.m3.1.1.2" xref="S2.SS4.p1.3.m3.1.1.2.cmml">G</mi><mtext id="S2.SS4.p1.3.m3.1.1.3" xref="S2.SS4.p1.3.m3.1.1.3a.cmml">target</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.3.m3.1b"><apply id="S2.SS4.p1.3.m3.1.1.cmml" xref="S2.SS4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS4.p1.3.m3.1.1.1.cmml" xref="S2.SS4.p1.3.m3.1.1">subscript</csymbol><ci id="S2.SS4.p1.3.m3.1.1.2.cmml" xref="S2.SS4.p1.3.m3.1.1.2">𝐺</ci><ci id="S2.SS4.p1.3.m3.1.1.3a.cmml" xref="S2.SS4.p1.3.m3.1.1.3"><mtext id="S2.SS4.p1.3.m3.1.1.3.cmml" mathsize="70%" xref="S2.SS4.p1.3.m3.1.1.3">target</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.3.m3.1c">G_{\text{target}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p1.3.m3.1d">italic_G start_POSTSUBSCRIPT target end_POSTSUBSCRIPT</annotation></semantics></math>, one-step prediction of the reversed reaction may not yield reactants within <math alttext="\mathcal{G}_{\text{avail}}" class="ltx_Math" display="inline" id="S2.SS4.p1.4.m4.1"><semantics id="S2.SS4.p1.4.m4.1a"><msub id="S2.SS4.p1.4.m4.1.1" xref="S2.SS4.p1.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.p1.4.m4.1.1.2" xref="S2.SS4.p1.4.m4.1.1.2.cmml">𝒢</mi><mtext id="S2.SS4.p1.4.m4.1.1.3" xref="S2.SS4.p1.4.m4.1.1.3a.cmml">avail</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.4.m4.1b"><apply id="S2.SS4.p1.4.m4.1.1.cmml" xref="S2.SS4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS4.p1.4.m4.1.1.1.cmml" xref="S2.SS4.p1.4.m4.1.1">subscript</csymbol><ci id="S2.SS4.p1.4.m4.1.1.2.cmml" xref="S2.SS4.p1.4.m4.1.1.2">𝒢</ci><ci id="S2.SS4.p1.4.m4.1.1.3a.cmml" xref="S2.SS4.p1.4.m4.1.1.3"><mtext id="S2.SS4.p1.4.m4.1.1.3.cmml" mathsize="70%" xref="S2.SS4.p1.4.m4.1.1.3">avail</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.4.m4.1c">\mathcal{G}_{\text{avail}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p1.4.m4.1d">caligraphic_G start_POSTSUBSCRIPT avail end_POSTSUBSCRIPT</annotation></semantics></math>. Thus, retrosynthesis typically requires multi-step planning to find pathways from building blocks to the target in reverse order. The search space of chemical reactions can be navigated using A* on an AND-OR tree <math alttext="\mathcal{T}" class="ltx_Math" display="inline" id="S2.SS4.p1.5.m5.1"><semantics id="S2.SS4.p1.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.p1.5.m5.1.1" xref="S2.SS4.p1.5.m5.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.5.m5.1b"><ci id="S2.SS4.p1.5.m5.1.1.cmml" xref="S2.SS4.p1.5.m5.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.5.m5.1c">\mathcal{T}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p1.5.m5.1d">caligraphic_T</annotation></semantics></math>, with <math alttext="G_{\text{target}}" class="ltx_Math" display="inline" id="S2.SS4.p1.6.m6.1"><semantics id="S2.SS4.p1.6.m6.1a"><msub id="S2.SS4.p1.6.m6.1.1" xref="S2.SS4.p1.6.m6.1.1.cmml"><mi id="S2.SS4.p1.6.m6.1.1.2" xref="S2.SS4.p1.6.m6.1.1.2.cmml">G</mi><mtext id="S2.SS4.p1.6.m6.1.1.3" xref="S2.SS4.p1.6.m6.1.1.3a.cmml">target</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.6.m6.1b"><apply id="S2.SS4.p1.6.m6.1.1.cmml" xref="S2.SS4.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS4.p1.6.m6.1.1.1.cmml" xref="S2.SS4.p1.6.m6.1.1">subscript</csymbol><ci id="S2.SS4.p1.6.m6.1.1.2.cmml" xref="S2.SS4.p1.6.m6.1.1.2">𝐺</ci><ci id="S2.SS4.p1.6.m6.1.1.3a.cmml" xref="S2.SS4.p1.6.m6.1.1.3"><mtext id="S2.SS4.p1.6.m6.1.1.3.cmml" mathsize="70%" xref="S2.SS4.p1.6.m6.1.1.3">target</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.6.m6.1c">G_{\text{target}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p1.6.m6.1d">italic_G start_POSTSUBSCRIPT target end_POSTSUBSCRIPT</annotation></semantics></math> as the root. Reaction nodes follow an “AND” relation, requiring all child reactants, while molecule nodes follow an “OR” relation, meaning the product can be synthesized by any child reaction&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Chen et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib5" title="">2020</a>)</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS4.p2">
<p class="ltx_p" id="S2.SS4.p2.4"><span class="ltx_text ltx_font_bold" id="S2.SS4.p2.4.1">Selection:</span> We select nodes from the frontier <math alttext="\mathcal{F}(\mathcal{T})" class="ltx_Math" display="inline" id="S2.SS4.p2.1.m1.1"><semantics id="S2.SS4.p2.1.m1.1a"><mrow id="S2.SS4.p2.1.m1.1.2" xref="S2.SS4.p2.1.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.p2.1.m1.1.2.2" xref="S2.SS4.p2.1.m1.1.2.2.cmml">ℱ</mi><mo id="S2.SS4.p2.1.m1.1.2.1" xref="S2.SS4.p2.1.m1.1.2.1.cmml">⁢</mo><mrow id="S2.SS4.p2.1.m1.1.2.3.2" xref="S2.SS4.p2.1.m1.1.2.cmml"><mo id="S2.SS4.p2.1.m1.1.2.3.2.1" stretchy="false" xref="S2.SS4.p2.1.m1.1.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS4.p2.1.m1.1.1" xref="S2.SS4.p2.1.m1.1.1.cmml">𝒯</mi><mo id="S2.SS4.p2.1.m1.1.2.3.2.2" stretchy="false" xref="S2.SS4.p2.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.1.m1.1b"><apply id="S2.SS4.p2.1.m1.1.2.cmml" xref="S2.SS4.p2.1.m1.1.2"><times id="S2.SS4.p2.1.m1.1.2.1.cmml" xref="S2.SS4.p2.1.m1.1.2.1"></times><ci id="S2.SS4.p2.1.m1.1.2.2.cmml" xref="S2.SS4.p2.1.m1.1.2.2">ℱ</ci><ci id="S2.SS4.p2.1.m1.1.1.cmml" xref="S2.SS4.p2.1.m1.1.1">𝒯</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.1.m1.1c">\mathcal{F}(\mathcal{T})</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p2.1.m1.1d">caligraphic_F ( caligraphic_T )</annotation></semantics></math> containing unexplored molecule nodes to expand the tree. Given an oracle cost function <math alttext="J(\cdot)" class="ltx_Math" display="inline" id="S2.SS4.p2.2.m2.1"><semantics id="S2.SS4.p2.2.m2.1a"><mrow id="S2.SS4.p2.2.m2.1.2" xref="S2.SS4.p2.2.m2.1.2.cmml"><mi id="S2.SS4.p2.2.m2.1.2.2" xref="S2.SS4.p2.2.m2.1.2.2.cmml">J</mi><mo id="S2.SS4.p2.2.m2.1.2.1" xref="S2.SS4.p2.2.m2.1.2.1.cmml">⁢</mo><mrow id="S2.SS4.p2.2.m2.1.2.3.2" xref="S2.SS4.p2.2.m2.1.2.cmml"><mo id="S2.SS4.p2.2.m2.1.2.3.2.1" stretchy="false" xref="S2.SS4.p2.2.m2.1.2.cmml">(</mo><mo id="S2.SS4.p2.2.m2.1.1" lspace="0em" rspace="0em" xref="S2.SS4.p2.2.m2.1.1.cmml">⋅</mo><mo id="S2.SS4.p2.2.m2.1.2.3.2.2" stretchy="false" xref="S2.SS4.p2.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.2.m2.1b"><apply id="S2.SS4.p2.2.m2.1.2.cmml" xref="S2.SS4.p2.2.m2.1.2"><times id="S2.SS4.p2.2.m2.1.2.1.cmml" xref="S2.SS4.p2.2.m2.1.2.1"></times><ci id="S2.SS4.p2.2.m2.1.2.2.cmml" xref="S2.SS4.p2.2.m2.1.2.2">𝐽</ci><ci id="S2.SS4.p2.2.m2.1.1.cmml" xref="S2.SS4.p2.2.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.2.m2.1c">J(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p2.2.m2.1d">italic_J ( ⋅ )</annotation></semantics></math>, the next node is selected as <math alttext="G_{\text{next}}=\arg\min_{G\in\mathcal{F}(\mathcal{T})}J(G)" class="ltx_Math" display="inline" id="S2.SS4.p2.3.m3.2"><semantics id="S2.SS4.p2.3.m3.2a"><mrow id="S2.SS4.p2.3.m3.2.3" xref="S2.SS4.p2.3.m3.2.3.cmml"><msub id="S2.SS4.p2.3.m3.2.3.2" xref="S2.SS4.p2.3.m3.2.3.2.cmml"><mi id="S2.SS4.p2.3.m3.2.3.2.2" xref="S2.SS4.p2.3.m3.2.3.2.2.cmml">G</mi><mtext id="S2.SS4.p2.3.m3.2.3.2.3" xref="S2.SS4.p2.3.m3.2.3.2.3a.cmml">next</mtext></msub><mo id="S2.SS4.p2.3.m3.2.3.1" xref="S2.SS4.p2.3.m3.2.3.1.cmml">=</mo><mrow id="S2.SS4.p2.3.m3.2.3.3" xref="S2.SS4.p2.3.m3.2.3.3.cmml"><mrow id="S2.SS4.p2.3.m3.2.3.3.2" xref="S2.SS4.p2.3.m3.2.3.3.2.cmml"><mi id="S2.SS4.p2.3.m3.2.3.3.2.1" xref="S2.SS4.p2.3.m3.2.3.3.2.1.cmml">arg</mi><mo id="S2.SS4.p2.3.m3.2.3.3.2a" lspace="0.167em" xref="S2.SS4.p2.3.m3.2.3.3.2.cmml">⁡</mo><mrow id="S2.SS4.p2.3.m3.2.3.3.2.2" xref="S2.SS4.p2.3.m3.2.3.3.2.2.cmml"><msub id="S2.SS4.p2.3.m3.2.3.3.2.2.1" xref="S2.SS4.p2.3.m3.2.3.3.2.2.1.cmml"><mi id="S2.SS4.p2.3.m3.2.3.3.2.2.1.2" xref="S2.SS4.p2.3.m3.2.3.3.2.2.1.2.cmml">min</mi><mrow id="S2.SS4.p2.3.m3.1.1.1" xref="S2.SS4.p2.3.m3.1.1.1.cmml"><mi id="S2.SS4.p2.3.m3.1.1.1.3" xref="S2.SS4.p2.3.m3.1.1.1.3.cmml">G</mi><mo id="S2.SS4.p2.3.m3.1.1.1.2" xref="S2.SS4.p2.3.m3.1.1.1.2.cmml">∈</mo><mrow id="S2.SS4.p2.3.m3.1.1.1.4" xref="S2.SS4.p2.3.m3.1.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.p2.3.m3.1.1.1.4.2" xref="S2.SS4.p2.3.m3.1.1.1.4.2.cmml">ℱ</mi><mo id="S2.SS4.p2.3.m3.1.1.1.4.1" xref="S2.SS4.p2.3.m3.1.1.1.4.1.cmml">⁢</mo><mrow id="S2.SS4.p2.3.m3.1.1.1.4.3.2" xref="S2.SS4.p2.3.m3.1.1.1.4.cmml"><mo id="S2.SS4.p2.3.m3.1.1.1.4.3.2.1" stretchy="false" xref="S2.SS4.p2.3.m3.1.1.1.4.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS4.p2.3.m3.1.1.1.1" xref="S2.SS4.p2.3.m3.1.1.1.1.cmml">𝒯</mi><mo id="S2.SS4.p2.3.m3.1.1.1.4.3.2.2" stretchy="false" xref="S2.SS4.p2.3.m3.1.1.1.4.cmml">)</mo></mrow></mrow></mrow></msub><mo id="S2.SS4.p2.3.m3.2.3.3.2.2a" lspace="0.167em" xref="S2.SS4.p2.3.m3.2.3.3.2.2.cmml">⁡</mo><mi id="S2.SS4.p2.3.m3.2.3.3.2.2.2" xref="S2.SS4.p2.3.m3.2.3.3.2.2.2.cmml">J</mi></mrow></mrow><mo id="S2.SS4.p2.3.m3.2.3.3.1" xref="S2.SS4.p2.3.m3.2.3.3.1.cmml">⁢</mo><mrow id="S2.SS4.p2.3.m3.2.3.3.3.2" xref="S2.SS4.p2.3.m3.2.3.3.cmml"><mo id="S2.SS4.p2.3.m3.2.3.3.3.2.1" stretchy="false" xref="S2.SS4.p2.3.m3.2.3.3.cmml">(</mo><mi id="S2.SS4.p2.3.m3.2.2" xref="S2.SS4.p2.3.m3.2.2.cmml">G</mi><mo id="S2.SS4.p2.3.m3.2.3.3.3.2.2" stretchy="false" xref="S2.SS4.p2.3.m3.2.3.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.3.m3.2b"><apply id="S2.SS4.p2.3.m3.2.3.cmml" xref="S2.SS4.p2.3.m3.2.3"><eq id="S2.SS4.p2.3.m3.2.3.1.cmml" xref="S2.SS4.p2.3.m3.2.3.1"></eq><apply id="S2.SS4.p2.3.m3.2.3.2.cmml" xref="S2.SS4.p2.3.m3.2.3.2"><csymbol cd="ambiguous" id="S2.SS4.p2.3.m3.2.3.2.1.cmml" xref="S2.SS4.p2.3.m3.2.3.2">subscript</csymbol><ci id="S2.SS4.p2.3.m3.2.3.2.2.cmml" xref="S2.SS4.p2.3.m3.2.3.2.2">𝐺</ci><ci id="S2.SS4.p2.3.m3.2.3.2.3a.cmml" xref="S2.SS4.p2.3.m3.2.3.2.3"><mtext id="S2.SS4.p2.3.m3.2.3.2.3.cmml" mathsize="70%" xref="S2.SS4.p2.3.m3.2.3.2.3">next</mtext></ci></apply><apply id="S2.SS4.p2.3.m3.2.3.3.cmml" xref="S2.SS4.p2.3.m3.2.3.3"><times id="S2.SS4.p2.3.m3.2.3.3.1.cmml" xref="S2.SS4.p2.3.m3.2.3.3.1"></times><apply id="S2.SS4.p2.3.m3.2.3.3.2.cmml" xref="S2.SS4.p2.3.m3.2.3.3.2"><arg id="S2.SS4.p2.3.m3.2.3.3.2.1.cmml" xref="S2.SS4.p2.3.m3.2.3.3.2.1"></arg><apply id="S2.SS4.p2.3.m3.2.3.3.2.2.cmml" xref="S2.SS4.p2.3.m3.2.3.3.2.2"><apply id="S2.SS4.p2.3.m3.2.3.3.2.2.1.cmml" xref="S2.SS4.p2.3.m3.2.3.3.2.2.1"><csymbol cd="ambiguous" id="S2.SS4.p2.3.m3.2.3.3.2.2.1.1.cmml" xref="S2.SS4.p2.3.m3.2.3.3.2.2.1">subscript</csymbol><min id="S2.SS4.p2.3.m3.2.3.3.2.2.1.2.cmml" xref="S2.SS4.p2.3.m3.2.3.3.2.2.1.2"></min><apply id="S2.SS4.p2.3.m3.1.1.1.cmml" xref="S2.SS4.p2.3.m3.1.1.1"><in id="S2.SS4.p2.3.m3.1.1.1.2.cmml" xref="S2.SS4.p2.3.m3.1.1.1.2"></in><ci id="S2.SS4.p2.3.m3.1.1.1.3.cmml" xref="S2.SS4.p2.3.m3.1.1.1.3">𝐺</ci><apply id="S2.SS4.p2.3.m3.1.1.1.4.cmml" xref="S2.SS4.p2.3.m3.1.1.1.4"><times id="S2.SS4.p2.3.m3.1.1.1.4.1.cmml" xref="S2.SS4.p2.3.m3.1.1.1.4.1"></times><ci id="S2.SS4.p2.3.m3.1.1.1.4.2.cmml" xref="S2.SS4.p2.3.m3.1.1.1.4.2">ℱ</ci><ci id="S2.SS4.p2.3.m3.1.1.1.1.cmml" xref="S2.SS4.p2.3.m3.1.1.1.1">𝒯</ci></apply></apply></apply><ci id="S2.SS4.p2.3.m3.2.3.3.2.2.2.cmml" xref="S2.SS4.p2.3.m3.2.3.3.2.2.2">𝐽</ci></apply></apply><ci id="S2.SS4.p2.3.m3.2.2.cmml" xref="S2.SS4.p2.3.m3.2.2">𝐺</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.3.m3.2c">G_{\text{next}}=\arg\min_{G\in\mathcal{F}(\mathcal{T})}J(G)</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p2.3.m3.2d">italic_G start_POSTSUBSCRIPT next end_POSTSUBSCRIPT = roman_arg roman_min start_POSTSUBSCRIPT italic_G ∈ caligraphic_F ( caligraphic_T ) end_POSTSUBSCRIPT italic_J ( italic_G )</annotation></semantics></math> to minimize the cost. A well-designed <math alttext="J(\cdot)" class="ltx_Math" display="inline" id="S2.SS4.p2.4.m4.1"><semantics id="S2.SS4.p2.4.m4.1a"><mrow id="S2.SS4.p2.4.m4.1.2" xref="S2.SS4.p2.4.m4.1.2.cmml"><mi id="S2.SS4.p2.4.m4.1.2.2" xref="S2.SS4.p2.4.m4.1.2.2.cmml">J</mi><mo id="S2.SS4.p2.4.m4.1.2.1" xref="S2.SS4.p2.4.m4.1.2.1.cmml">⁢</mo><mrow id="S2.SS4.p2.4.m4.1.2.3.2" xref="S2.SS4.p2.4.m4.1.2.cmml"><mo id="S2.SS4.p2.4.m4.1.2.3.2.1" stretchy="false" xref="S2.SS4.p2.4.m4.1.2.cmml">(</mo><mo id="S2.SS4.p2.4.m4.1.1" lspace="0em" rspace="0em" xref="S2.SS4.p2.4.m4.1.1.cmml">⋅</mo><mo id="S2.SS4.p2.4.m4.1.2.3.2.2" stretchy="false" xref="S2.SS4.p2.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.4.m4.1b"><apply id="S2.SS4.p2.4.m4.1.2.cmml" xref="S2.SS4.p2.4.m4.1.2"><times id="S2.SS4.p2.4.m4.1.2.1.cmml" xref="S2.SS4.p2.4.m4.1.2.1"></times><ci id="S2.SS4.p2.4.m4.1.2.2.cmml" xref="S2.SS4.p2.4.m4.1.2.2">𝐽</ci><ci id="S2.SS4.p2.4.m4.1.1.cmml" xref="S2.SS4.p2.4.m4.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.4.m4.1c">J(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p2.4.m4.1d">italic_J ( ⋅ )</annotation></semantics></math> improves search efficiency and aids in global optimality.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS4.p3">
<p class="ltx_p" id="S2.SS4.p3.1"><span class="ltx_text ltx_font_bold" id="S2.SS4.p3.1.1">Expansion:</span> After selecting <math alttext="G_{\text{next}}" class="ltx_Math" display="inline" id="S2.SS4.p3.1.m1.1"><semantics id="S2.SS4.p3.1.m1.1a"><msub id="S2.SS4.p3.1.m1.1.1" xref="S2.SS4.p3.1.m1.1.1.cmml"><mi id="S2.SS4.p3.1.m1.1.1.2" xref="S2.SS4.p3.1.m1.1.1.2.cmml">G</mi><mtext id="S2.SS4.p3.1.m1.1.1.3" xref="S2.SS4.p3.1.m1.1.1.3a.cmml">next</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p3.1.m1.1b"><apply id="S2.SS4.p3.1.m1.1.1.cmml" xref="S2.SS4.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p3.1.m1.1.1.1.cmml" xref="S2.SS4.p3.1.m1.1.1">subscript</csymbol><ci id="S2.SS4.p3.1.m1.1.1.2.cmml" xref="S2.SS4.p3.1.m1.1.1.2">𝐺</ci><ci id="S2.SS4.p3.1.m1.1.1.3a.cmml" xref="S2.SS4.p3.1.m1.1.1.3"><mtext id="S2.SS4.p3.1.m1.1.1.3.cmml" mathsize="70%" xref="S2.SS4.p3.1.m1.1.1.3">next</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p3.1.m1.1c">G_{\text{next}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p3.1.m1.1d">italic_G start_POSTSUBSCRIPT next end_POSTSUBSCRIPT</annotation></semantics></math>, a single GNN predictor call can generate many one-step retrosynthesis proposals. The GNN provides top-candidate reaction templates, each linked to different reactants. Thus we can form molecule nodes under the reaction node as an AND-OR stump.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS4.p4">
<p class="ltx_p" id="S2.SS4.p4.8"><span class="ltx_text ltx_font_bold" id="S2.SS4.p4.8.1">Update and Cost:</span> After expanding <math alttext="G_{\text{next}}" class="ltx_Math" display="inline" id="S2.SS4.p4.1.m1.1"><semantics id="S2.SS4.p4.1.m1.1a"><msub id="S2.SS4.p4.1.m1.1.1" xref="S2.SS4.p4.1.m1.1.1.cmml"><mi id="S2.SS4.p4.1.m1.1.1.2" xref="S2.SS4.p4.1.m1.1.1.2.cmml">G</mi><mtext id="S2.SS4.p4.1.m1.1.1.3" xref="S2.SS4.p4.1.m1.1.1.3a.cmml">next</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.1.m1.1b"><apply id="S2.SS4.p4.1.m1.1.1.cmml" xref="S2.SS4.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p4.1.m1.1.1.1.cmml" xref="S2.SS4.p4.1.m1.1.1">subscript</csymbol><ci id="S2.SS4.p4.1.m1.1.1.2.cmml" xref="S2.SS4.p4.1.m1.1.1.2">𝐺</ci><ci id="S2.SS4.p4.1.m1.1.1.3a.cmml" xref="S2.SS4.p4.1.m1.1.1.3"><mtext id="S2.SS4.p4.1.m1.1.1.3.cmml" mathsize="70%" xref="S2.SS4.p4.1.m1.1.1.3">next</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.1.m1.1c">G_{\text{next}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p4.1.m1.1d">italic_G start_POSTSUBSCRIPT next end_POSTSUBSCRIPT</annotation></semantics></math>, the tree becomes <math alttext="\mathcal{T}^{\prime}" class="ltx_Math" display="inline" id="S2.SS4.p4.2.m2.1"><semantics id="S2.SS4.p4.2.m2.1a"><msup id="S2.SS4.p4.2.m2.1.1" xref="S2.SS4.p4.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.p4.2.m2.1.1.2" xref="S2.SS4.p4.2.m2.1.1.2.cmml">𝒯</mi><mo id="S2.SS4.p4.2.m2.1.1.3" xref="S2.SS4.p4.2.m2.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.2.m2.1b"><apply id="S2.SS4.p4.2.m2.1.1.cmml" xref="S2.SS4.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS4.p4.2.m2.1.1.1.cmml" xref="S2.SS4.p4.2.m2.1.1">superscript</csymbol><ci id="S2.SS4.p4.2.m2.1.1.2.cmml" xref="S2.SS4.p4.2.m2.1.1.2">𝒯</ci><ci id="S2.SS4.p4.2.m2.1.1.3.cmml" xref="S2.SS4.p4.2.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.2.m2.1c">\mathcal{T}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p4.2.m2.1d">caligraphic_T start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>. We update the nodes in <math alttext="\mathcal{T}^{\prime}" class="ltx_Math" display="inline" id="S2.SS4.p4.3.m3.1"><semantics id="S2.SS4.p4.3.m3.1a"><msup id="S2.SS4.p4.3.m3.1.1" xref="S2.SS4.p4.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.p4.3.m3.1.1.2" xref="S2.SS4.p4.3.m3.1.1.2.cmml">𝒯</mi><mo id="S2.SS4.p4.3.m3.1.1.3" xref="S2.SS4.p4.3.m3.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.3.m3.1b"><apply id="S2.SS4.p4.3.m3.1.1.cmml" xref="S2.SS4.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS4.p4.3.m3.1.1.1.cmml" xref="S2.SS4.p4.3.m3.1.1">superscript</csymbol><ci id="S2.SS4.p4.3.m3.1.1.2.cmml" xref="S2.SS4.p4.3.m3.1.1.2">𝒯</ci><ci id="S2.SS4.p4.3.m3.1.1.3.cmml" xref="S2.SS4.p4.3.m3.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.3.m3.1c">\mathcal{T}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p4.3.m3.1d">caligraphic_T start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> for the next iteration. A* selects the path that minimizes <math alttext="J(\cdot)=J_{\text{current}}(\cdot)+J_{\text{heuristic}}(\cdot)" class="ltx_Math" display="inline" id="S2.SS4.p4.4.m4.3"><semantics id="S2.SS4.p4.4.m4.3a"><mrow id="S2.SS4.p4.4.m4.3.4" xref="S2.SS4.p4.4.m4.3.4.cmml"><mrow id="S2.SS4.p4.4.m4.3.4.2" xref="S2.SS4.p4.4.m4.3.4.2.cmml"><mi id="S2.SS4.p4.4.m4.3.4.2.2" xref="S2.SS4.p4.4.m4.3.4.2.2.cmml">J</mi><mo id="S2.SS4.p4.4.m4.3.4.2.1" xref="S2.SS4.p4.4.m4.3.4.2.1.cmml">⁢</mo><mrow id="S2.SS4.p4.4.m4.3.4.2.3.2" xref="S2.SS4.p4.4.m4.3.4.2.cmml"><mo id="S2.SS4.p4.4.m4.3.4.2.3.2.1" stretchy="false" xref="S2.SS4.p4.4.m4.3.4.2.cmml">(</mo><mo id="S2.SS4.p4.4.m4.1.1" lspace="0em" rspace="0em" xref="S2.SS4.p4.4.m4.1.1.cmml">⋅</mo><mo id="S2.SS4.p4.4.m4.3.4.2.3.2.2" stretchy="false" xref="S2.SS4.p4.4.m4.3.4.2.cmml">)</mo></mrow></mrow><mo id="S2.SS4.p4.4.m4.3.4.1" xref="S2.SS4.p4.4.m4.3.4.1.cmml">=</mo><mrow id="S2.SS4.p4.4.m4.3.4.3" xref="S2.SS4.p4.4.m4.3.4.3.cmml"><mrow id="S2.SS4.p4.4.m4.3.4.3.2" xref="S2.SS4.p4.4.m4.3.4.3.2.cmml"><msub id="S2.SS4.p4.4.m4.3.4.3.2.2" xref="S2.SS4.p4.4.m4.3.4.3.2.2.cmml"><mi id="S2.SS4.p4.4.m4.3.4.3.2.2.2" xref="S2.SS4.p4.4.m4.3.4.3.2.2.2.cmml">J</mi><mtext id="S2.SS4.p4.4.m4.3.4.3.2.2.3" xref="S2.SS4.p4.4.m4.3.4.3.2.2.3a.cmml">current</mtext></msub><mo id="S2.SS4.p4.4.m4.3.4.3.2.1" xref="S2.SS4.p4.4.m4.3.4.3.2.1.cmml">⁢</mo><mrow id="S2.SS4.p4.4.m4.3.4.3.2.3.2" xref="S2.SS4.p4.4.m4.3.4.3.2.cmml"><mo id="S2.SS4.p4.4.m4.3.4.3.2.3.2.1" stretchy="false" xref="S2.SS4.p4.4.m4.3.4.3.2.cmml">(</mo><mo id="S2.SS4.p4.4.m4.2.2" lspace="0em" rspace="0em" xref="S2.SS4.p4.4.m4.2.2.cmml">⋅</mo><mo id="S2.SS4.p4.4.m4.3.4.3.2.3.2.2" stretchy="false" xref="S2.SS4.p4.4.m4.3.4.3.2.cmml">)</mo></mrow></mrow><mo id="S2.SS4.p4.4.m4.3.4.3.1" xref="S2.SS4.p4.4.m4.3.4.3.1.cmml">+</mo><mrow id="S2.SS4.p4.4.m4.3.4.3.3" xref="S2.SS4.p4.4.m4.3.4.3.3.cmml"><msub id="S2.SS4.p4.4.m4.3.4.3.3.2" xref="S2.SS4.p4.4.m4.3.4.3.3.2.cmml"><mi id="S2.SS4.p4.4.m4.3.4.3.3.2.2" xref="S2.SS4.p4.4.m4.3.4.3.3.2.2.cmml">J</mi><mtext id="S2.SS4.p4.4.m4.3.4.3.3.2.3" xref="S2.SS4.p4.4.m4.3.4.3.3.2.3a.cmml">heuristic</mtext></msub><mo id="S2.SS4.p4.4.m4.3.4.3.3.1" xref="S2.SS4.p4.4.m4.3.4.3.3.1.cmml">⁢</mo><mrow id="S2.SS4.p4.4.m4.3.4.3.3.3.2" xref="S2.SS4.p4.4.m4.3.4.3.3.cmml"><mo id="S2.SS4.p4.4.m4.3.4.3.3.3.2.1" stretchy="false" xref="S2.SS4.p4.4.m4.3.4.3.3.cmml">(</mo><mo id="S2.SS4.p4.4.m4.3.3" lspace="0em" rspace="0em" xref="S2.SS4.p4.4.m4.3.3.cmml">⋅</mo><mo id="S2.SS4.p4.4.m4.3.4.3.3.3.2.2" stretchy="false" xref="S2.SS4.p4.4.m4.3.4.3.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.4.m4.3b"><apply id="S2.SS4.p4.4.m4.3.4.cmml" xref="S2.SS4.p4.4.m4.3.4"><eq id="S2.SS4.p4.4.m4.3.4.1.cmml" xref="S2.SS4.p4.4.m4.3.4.1"></eq><apply id="S2.SS4.p4.4.m4.3.4.2.cmml" xref="S2.SS4.p4.4.m4.3.4.2"><times id="S2.SS4.p4.4.m4.3.4.2.1.cmml" xref="S2.SS4.p4.4.m4.3.4.2.1"></times><ci id="S2.SS4.p4.4.m4.3.4.2.2.cmml" xref="S2.SS4.p4.4.m4.3.4.2.2">𝐽</ci><ci id="S2.SS4.p4.4.m4.1.1.cmml" xref="S2.SS4.p4.4.m4.1.1">⋅</ci></apply><apply id="S2.SS4.p4.4.m4.3.4.3.cmml" xref="S2.SS4.p4.4.m4.3.4.3"><plus id="S2.SS4.p4.4.m4.3.4.3.1.cmml" xref="S2.SS4.p4.4.m4.3.4.3.1"></plus><apply id="S2.SS4.p4.4.m4.3.4.3.2.cmml" xref="S2.SS4.p4.4.m4.3.4.3.2"><times id="S2.SS4.p4.4.m4.3.4.3.2.1.cmml" xref="S2.SS4.p4.4.m4.3.4.3.2.1"></times><apply id="S2.SS4.p4.4.m4.3.4.3.2.2.cmml" xref="S2.SS4.p4.4.m4.3.4.3.2.2"><csymbol cd="ambiguous" id="S2.SS4.p4.4.m4.3.4.3.2.2.1.cmml" xref="S2.SS4.p4.4.m4.3.4.3.2.2">subscript</csymbol><ci id="S2.SS4.p4.4.m4.3.4.3.2.2.2.cmml" xref="S2.SS4.p4.4.m4.3.4.3.2.2.2">𝐽</ci><ci id="S2.SS4.p4.4.m4.3.4.3.2.2.3a.cmml" xref="S2.SS4.p4.4.m4.3.4.3.2.2.3"><mtext id="S2.SS4.p4.4.m4.3.4.3.2.2.3.cmml" mathsize="70%" xref="S2.SS4.p4.4.m4.3.4.3.2.2.3">current</mtext></ci></apply><ci id="S2.SS4.p4.4.m4.2.2.cmml" xref="S2.SS4.p4.4.m4.2.2">⋅</ci></apply><apply id="S2.SS4.p4.4.m4.3.4.3.3.cmml" xref="S2.SS4.p4.4.m4.3.4.3.3"><times id="S2.SS4.p4.4.m4.3.4.3.3.1.cmml" xref="S2.SS4.p4.4.m4.3.4.3.3.1"></times><apply id="S2.SS4.p4.4.m4.3.4.3.3.2.cmml" xref="S2.SS4.p4.4.m4.3.4.3.3.2"><csymbol cd="ambiguous" id="S2.SS4.p4.4.m4.3.4.3.3.2.1.cmml" xref="S2.SS4.p4.4.m4.3.4.3.3.2">subscript</csymbol><ci id="S2.SS4.p4.4.m4.3.4.3.3.2.2.cmml" xref="S2.SS4.p4.4.m4.3.4.3.3.2.2">𝐽</ci><ci id="S2.SS4.p4.4.m4.3.4.3.3.2.3a.cmml" xref="S2.SS4.p4.4.m4.3.4.3.3.2.3"><mtext id="S2.SS4.p4.4.m4.3.4.3.3.2.3.cmml" mathsize="70%" xref="S2.SS4.p4.4.m4.3.4.3.3.2.3">heuristic</mtext></ci></apply><ci id="S2.SS4.p4.4.m4.3.3.cmml" xref="S2.SS4.p4.4.m4.3.3">⋅</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.4.m4.3c">J(\cdot)=J_{\text{current}}(\cdot)+J_{\text{heuristic}}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p4.4.m4.3d">italic_J ( ⋅ ) = italic_J start_POSTSUBSCRIPT current end_POSTSUBSCRIPT ( ⋅ ) + italic_J start_POSTSUBSCRIPT heuristic end_POSTSUBSCRIPT ( ⋅ )</annotation></semantics></math>, which includes the cost from the start to the current node <math alttext="J_{\text{current}}(\cdot)" class="ltx_Math" display="inline" id="S2.SS4.p4.5.m5.1"><semantics id="S2.SS4.p4.5.m5.1a"><mrow id="S2.SS4.p4.5.m5.1.2" xref="S2.SS4.p4.5.m5.1.2.cmml"><msub id="S2.SS4.p4.5.m5.1.2.2" xref="S2.SS4.p4.5.m5.1.2.2.cmml"><mi id="S2.SS4.p4.5.m5.1.2.2.2" xref="S2.SS4.p4.5.m5.1.2.2.2.cmml">J</mi><mtext id="S2.SS4.p4.5.m5.1.2.2.3" xref="S2.SS4.p4.5.m5.1.2.2.3a.cmml">current</mtext></msub><mo id="S2.SS4.p4.5.m5.1.2.1" xref="S2.SS4.p4.5.m5.1.2.1.cmml">⁢</mo><mrow id="S2.SS4.p4.5.m5.1.2.3.2" xref="S2.SS4.p4.5.m5.1.2.cmml"><mo id="S2.SS4.p4.5.m5.1.2.3.2.1" stretchy="false" xref="S2.SS4.p4.5.m5.1.2.cmml">(</mo><mo id="S2.SS4.p4.5.m5.1.1" lspace="0em" rspace="0em" xref="S2.SS4.p4.5.m5.1.1.cmml">⋅</mo><mo id="S2.SS4.p4.5.m5.1.2.3.2.2" stretchy="false" xref="S2.SS4.p4.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.5.m5.1b"><apply id="S2.SS4.p4.5.m5.1.2.cmml" xref="S2.SS4.p4.5.m5.1.2"><times id="S2.SS4.p4.5.m5.1.2.1.cmml" xref="S2.SS4.p4.5.m5.1.2.1"></times><apply id="S2.SS4.p4.5.m5.1.2.2.cmml" xref="S2.SS4.p4.5.m5.1.2.2"><csymbol cd="ambiguous" id="S2.SS4.p4.5.m5.1.2.2.1.cmml" xref="S2.SS4.p4.5.m5.1.2.2">subscript</csymbol><ci id="S2.SS4.p4.5.m5.1.2.2.2.cmml" xref="S2.SS4.p4.5.m5.1.2.2.2">𝐽</ci><ci id="S2.SS4.p4.5.m5.1.2.2.3a.cmml" xref="S2.SS4.p4.5.m5.1.2.2.3"><mtext id="S2.SS4.p4.5.m5.1.2.2.3.cmml" mathsize="70%" xref="S2.SS4.p4.5.m5.1.2.2.3">current</mtext></ci></apply><ci id="S2.SS4.p4.5.m5.1.1.cmml" xref="S2.SS4.p4.5.m5.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.5.m5.1c">J_{\text{current}}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p4.5.m5.1d">italic_J start_POSTSUBSCRIPT current end_POSTSUBSCRIPT ( ⋅ )</annotation></semantics></math> and a heuristic estimate of the cost to the goal <math alttext="J_{\text{heuristic}}(\cdot)" class="ltx_Math" display="inline" id="S2.SS4.p4.6.m6.1"><semantics id="S2.SS4.p4.6.m6.1a"><mrow id="S2.SS4.p4.6.m6.1.2" xref="S2.SS4.p4.6.m6.1.2.cmml"><msub id="S2.SS4.p4.6.m6.1.2.2" xref="S2.SS4.p4.6.m6.1.2.2.cmml"><mi id="S2.SS4.p4.6.m6.1.2.2.2" xref="S2.SS4.p4.6.m6.1.2.2.2.cmml">J</mi><mtext id="S2.SS4.p4.6.m6.1.2.2.3" xref="S2.SS4.p4.6.m6.1.2.2.3a.cmml">heuristic</mtext></msub><mo id="S2.SS4.p4.6.m6.1.2.1" xref="S2.SS4.p4.6.m6.1.2.1.cmml">⁢</mo><mrow id="S2.SS4.p4.6.m6.1.2.3.2" xref="S2.SS4.p4.6.m6.1.2.cmml"><mo id="S2.SS4.p4.6.m6.1.2.3.2.1" stretchy="false" xref="S2.SS4.p4.6.m6.1.2.cmml">(</mo><mo id="S2.SS4.p4.6.m6.1.1" lspace="0em" rspace="0em" xref="S2.SS4.p4.6.m6.1.1.cmml">⋅</mo><mo id="S2.SS4.p4.6.m6.1.2.3.2.2" stretchy="false" xref="S2.SS4.p4.6.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.6.m6.1b"><apply id="S2.SS4.p4.6.m6.1.2.cmml" xref="S2.SS4.p4.6.m6.1.2"><times id="S2.SS4.p4.6.m6.1.2.1.cmml" xref="S2.SS4.p4.6.m6.1.2.1"></times><apply id="S2.SS4.p4.6.m6.1.2.2.cmml" xref="S2.SS4.p4.6.m6.1.2.2"><csymbol cd="ambiguous" id="S2.SS4.p4.6.m6.1.2.2.1.cmml" xref="S2.SS4.p4.6.m6.1.2.2">subscript</csymbol><ci id="S2.SS4.p4.6.m6.1.2.2.2.cmml" xref="S2.SS4.p4.6.m6.1.2.2.2">𝐽</ci><ci id="S2.SS4.p4.6.m6.1.2.2.3a.cmml" xref="S2.SS4.p4.6.m6.1.2.2.3"><mtext id="S2.SS4.p4.6.m6.1.2.2.3.cmml" mathsize="70%" xref="S2.SS4.p4.6.m6.1.2.2.3">heuristic</mtext></ci></apply><ci id="S2.SS4.p4.6.m6.1.1.cmml" xref="S2.SS4.p4.6.m6.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.6.m6.1c">J_{\text{heuristic}}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p4.6.m6.1d">italic_J start_POSTSUBSCRIPT heuristic end_POSTSUBSCRIPT ( ⋅ )</annotation></semantics></math>. With the GNN predictor, the negative log-likelihood of the reaction can be used to compute path cost <math alttext="J_{\text{current}}(\cdot)" class="ltx_Math" display="inline" id="S2.SS4.p4.7.m7.1"><semantics id="S2.SS4.p4.7.m7.1a"><mrow id="S2.SS4.p4.7.m7.1.2" xref="S2.SS4.p4.7.m7.1.2.cmml"><msub id="S2.SS4.p4.7.m7.1.2.2" xref="S2.SS4.p4.7.m7.1.2.2.cmml"><mi id="S2.SS4.p4.7.m7.1.2.2.2" xref="S2.SS4.p4.7.m7.1.2.2.2.cmml">J</mi><mtext id="S2.SS4.p4.7.m7.1.2.2.3" xref="S2.SS4.p4.7.m7.1.2.2.3a.cmml">current</mtext></msub><mo id="S2.SS4.p4.7.m7.1.2.1" xref="S2.SS4.p4.7.m7.1.2.1.cmml">⁢</mo><mrow id="S2.SS4.p4.7.m7.1.2.3.2" xref="S2.SS4.p4.7.m7.1.2.cmml"><mo id="S2.SS4.p4.7.m7.1.2.3.2.1" stretchy="false" xref="S2.SS4.p4.7.m7.1.2.cmml">(</mo><mo id="S2.SS4.p4.7.m7.1.1" lspace="0em" rspace="0em" xref="S2.SS4.p4.7.m7.1.1.cmml">⋅</mo><mo id="S2.SS4.p4.7.m7.1.2.3.2.2" stretchy="false" xref="S2.SS4.p4.7.m7.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.7.m7.1b"><apply id="S2.SS4.p4.7.m7.1.2.cmml" xref="S2.SS4.p4.7.m7.1.2"><times id="S2.SS4.p4.7.m7.1.2.1.cmml" xref="S2.SS4.p4.7.m7.1.2.1"></times><apply id="S2.SS4.p4.7.m7.1.2.2.cmml" xref="S2.SS4.p4.7.m7.1.2.2"><csymbol cd="ambiguous" id="S2.SS4.p4.7.m7.1.2.2.1.cmml" xref="S2.SS4.p4.7.m7.1.2.2">subscript</csymbol><ci id="S2.SS4.p4.7.m7.1.2.2.2.cmml" xref="S2.SS4.p4.7.m7.1.2.2.2">𝐽</ci><ci id="S2.SS4.p4.7.m7.1.2.2.3a.cmml" xref="S2.SS4.p4.7.m7.1.2.2.3"><mtext id="S2.SS4.p4.7.m7.1.2.2.3.cmml" mathsize="70%" xref="S2.SS4.p4.7.m7.1.2.2.3">current</mtext></ci></apply><ci id="S2.SS4.p4.7.m7.1.1.cmml" xref="S2.SS4.p4.7.m7.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.7.m7.1c">J_{\text{current}}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p4.7.m7.1d">italic_J start_POSTSUBSCRIPT current end_POSTSUBSCRIPT ( ⋅ )</annotation></semantics></math> to the leaf molecule node, we design <math alttext="J_{\text{heuristic}}(\cdot)" class="ltx_Math" display="inline" id="S2.SS4.p4.8.m8.1"><semantics id="S2.SS4.p4.8.m8.1a"><mrow id="S2.SS4.p4.8.m8.1.2" xref="S2.SS4.p4.8.m8.1.2.cmml"><msub id="S2.SS4.p4.8.m8.1.2.2" xref="S2.SS4.p4.8.m8.1.2.2.cmml"><mi id="S2.SS4.p4.8.m8.1.2.2.2" xref="S2.SS4.p4.8.m8.1.2.2.2.cmml">J</mi><mtext id="S2.SS4.p4.8.m8.1.2.2.3" xref="S2.SS4.p4.8.m8.1.2.2.3a.cmml">heuristic</mtext></msub><mo id="S2.SS4.p4.8.m8.1.2.1" xref="S2.SS4.p4.8.m8.1.2.1.cmml">⁢</mo><mrow id="S2.SS4.p4.8.m8.1.2.3.2" xref="S2.SS4.p4.8.m8.1.2.cmml"><mo id="S2.SS4.p4.8.m8.1.2.3.2.1" stretchy="false" xref="S2.SS4.p4.8.m8.1.2.cmml">(</mo><mo id="S2.SS4.p4.8.m8.1.1" lspace="0em" rspace="0em" xref="S2.SS4.p4.8.m8.1.1.cmml">⋅</mo><mo id="S2.SS4.p4.8.m8.1.2.3.2.2" stretchy="false" xref="S2.SS4.p4.8.m8.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.8.m8.1b"><apply id="S2.SS4.p4.8.m8.1.2.cmml" xref="S2.SS4.p4.8.m8.1.2"><times id="S2.SS4.p4.8.m8.1.2.1.cmml" xref="S2.SS4.p4.8.m8.1.2.1"></times><apply id="S2.SS4.p4.8.m8.1.2.2.cmml" xref="S2.SS4.p4.8.m8.1.2.2"><csymbol cd="ambiguous" id="S2.SS4.p4.8.m8.1.2.2.1.cmml" xref="S2.SS4.p4.8.m8.1.2.2">subscript</csymbol><ci id="S2.SS4.p4.8.m8.1.2.2.2.cmml" xref="S2.SS4.p4.8.m8.1.2.2.2">𝐽</ci><ci id="S2.SS4.p4.8.m8.1.2.2.3a.cmml" xref="S2.SS4.p4.8.m8.1.2.2.3"><mtext id="S2.SS4.p4.8.m8.1.2.2.3.cmml" mathsize="70%" xref="S2.SS4.p4.8.m8.1.2.2.3">heuristic</mtext></ci></apply><ci id="S2.SS4.p4.8.m8.1.1.cmml" xref="S2.SS4.p4.8.m8.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.8.m8.1c">J_{\text{heuristic}}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p4.8.m8.1d">italic_J start_POSTSUBSCRIPT heuristic end_POSTSUBSCRIPT ( ⋅ )</annotation></semantics></math> with the LLM in Llamole.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Llamole: Multimodal Large Language Model for Molecular Discovery</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="S3.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="392" id="S3.F3.g1" src="https://arxiv.org/html/2410.04223v1/x3.png" width="747">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>
Overview of Llamole: Trigger tokens (<span class="ltx_text ltx_font_typewriter" id="S3.F3.4.1">&lt;design&gt;</span> and <span class="ltx_text ltx_font_typewriter" id="S3.F3.5.2">&lt;retro&gt;</span>) switch active modules from the base LLM to the respective graph component. The subsequent <span class="ltx_text ltx_font_typewriter" id="S3.F3.6.3">&lt;query&gt;</span> token utilizes output vectors from the LLM to summarize past texts as conditions. Using these, Llamole generates molecules and predicts one-step reactions. Enhanced with a graph encoder and A* search, Llamole efficiently plans synthesis routes through selection and expansion iterations on the AND-OR Tree.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Multimodal Autoregressive Modeling</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.5">In molecular discovery, the sequence may include molecular structures <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">caligraphic_G</annotation></semantics></math> and retrosynthetic reactions <math alttext="\mathcal{R}" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">\mathcal{R}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">caligraphic_R</annotation></semantics></math>
with each molecule or reaction tokenized. The sequence <math alttext="Y=\{y_{1},y_{2},\dots,y_{N}\}" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.4"><semantics id="S3.SS1.p1.3.m3.4a"><mrow id="S3.SS1.p1.3.m3.4.4" xref="S3.SS1.p1.3.m3.4.4.cmml"><mi id="S3.SS1.p1.3.m3.4.4.5" xref="S3.SS1.p1.3.m3.4.4.5.cmml">Y</mi><mo id="S3.SS1.p1.3.m3.4.4.4" xref="S3.SS1.p1.3.m3.4.4.4.cmml">=</mo><mrow id="S3.SS1.p1.3.m3.4.4.3.3" xref="S3.SS1.p1.3.m3.4.4.3.4.cmml"><mo id="S3.SS1.p1.3.m3.4.4.3.3.4" stretchy="false" xref="S3.SS1.p1.3.m3.4.4.3.4.cmml">{</mo><msub id="S3.SS1.p1.3.m3.2.2.1.1.1" xref="S3.SS1.p1.3.m3.2.2.1.1.1.cmml"><mi id="S3.SS1.p1.3.m3.2.2.1.1.1.2" xref="S3.SS1.p1.3.m3.2.2.1.1.1.2.cmml">y</mi><mn id="S3.SS1.p1.3.m3.2.2.1.1.1.3" xref="S3.SS1.p1.3.m3.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.3.m3.4.4.3.3.5" xref="S3.SS1.p1.3.m3.4.4.3.4.cmml">,</mo><msub id="S3.SS1.p1.3.m3.3.3.2.2.2" xref="S3.SS1.p1.3.m3.3.3.2.2.2.cmml"><mi id="S3.SS1.p1.3.m3.3.3.2.2.2.2" xref="S3.SS1.p1.3.m3.3.3.2.2.2.2.cmml">y</mi><mn id="S3.SS1.p1.3.m3.3.3.2.2.2.3" xref="S3.SS1.p1.3.m3.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS1.p1.3.m3.4.4.3.3.6" xref="S3.SS1.p1.3.m3.4.4.3.4.cmml">,</mo><mi id="S3.SS1.p1.3.m3.1.1" mathvariant="normal" xref="S3.SS1.p1.3.m3.1.1.cmml">…</mi><mo id="S3.SS1.p1.3.m3.4.4.3.3.7" xref="S3.SS1.p1.3.m3.4.4.3.4.cmml">,</mo><msub id="S3.SS1.p1.3.m3.4.4.3.3.3" xref="S3.SS1.p1.3.m3.4.4.3.3.3.cmml"><mi id="S3.SS1.p1.3.m3.4.4.3.3.3.2" xref="S3.SS1.p1.3.m3.4.4.3.3.3.2.cmml">y</mi><mi id="S3.SS1.p1.3.m3.4.4.3.3.3.3" xref="S3.SS1.p1.3.m3.4.4.3.3.3.3.cmml">N</mi></msub><mo id="S3.SS1.p1.3.m3.4.4.3.3.8" stretchy="false" xref="S3.SS1.p1.3.m3.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.4b"><apply id="S3.SS1.p1.3.m3.4.4.cmml" xref="S3.SS1.p1.3.m3.4.4"><eq id="S3.SS1.p1.3.m3.4.4.4.cmml" xref="S3.SS1.p1.3.m3.4.4.4"></eq><ci id="S3.SS1.p1.3.m3.4.4.5.cmml" xref="S3.SS1.p1.3.m3.4.4.5">𝑌</ci><set id="S3.SS1.p1.3.m3.4.4.3.4.cmml" xref="S3.SS1.p1.3.m3.4.4.3.3"><apply id="S3.SS1.p1.3.m3.2.2.1.1.1.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.3.m3.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1.1.2">𝑦</ci><cn id="S3.SS1.p1.3.m3.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS1.p1.3.m3.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS1.p1.3.m3.3.3.2.2.2.cmml" xref="S3.SS1.p1.3.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.3.3.2.2.2.1.cmml" xref="S3.SS1.p1.3.m3.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.3.m3.3.3.2.2.2.2.cmml" xref="S3.SS1.p1.3.m3.3.3.2.2.2.2">𝑦</ci><cn id="S3.SS1.p1.3.m3.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS1.p1.3.m3.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">…</ci><apply id="S3.SS1.p1.3.m3.4.4.3.3.3.cmml" xref="S3.SS1.p1.3.m3.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.4.4.3.3.3.1.cmml" xref="S3.SS1.p1.3.m3.4.4.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.3.m3.4.4.3.3.3.2.cmml" xref="S3.SS1.p1.3.m3.4.4.3.3.3.2">𝑦</ci><ci id="S3.SS1.p1.3.m3.4.4.3.3.3.3.cmml" xref="S3.SS1.p1.3.m3.4.4.3.3.3.3">𝑁</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.4c">Y=\{y_{1},y_{2},\dots,y_{N}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.4d">italic_Y = { italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_y start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT }</annotation></semantics></math>, where <math alttext="y_{i}\in\mathcal{W}\cup\mathcal{G}\cup\mathcal{R}" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.1"><semantics id="S3.SS1.p1.4.m4.1a"><mrow id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml"><msub id="S3.SS1.p1.4.m4.1.1.2" xref="S3.SS1.p1.4.m4.1.1.2.cmml"><mi id="S3.SS1.p1.4.m4.1.1.2.2" xref="S3.SS1.p1.4.m4.1.1.2.2.cmml">y</mi><mi id="S3.SS1.p1.4.m4.1.1.2.3" xref="S3.SS1.p1.4.m4.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS1.p1.4.m4.1.1.1" xref="S3.SS1.p1.4.m4.1.1.1.cmml">∈</mo><mrow id="S3.SS1.p1.4.m4.1.1.3" xref="S3.SS1.p1.4.m4.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.4.m4.1.1.3.2" xref="S3.SS1.p1.4.m4.1.1.3.2.cmml">𝒲</mi><mo id="S3.SS1.p1.4.m4.1.1.3.1" xref="S3.SS1.p1.4.m4.1.1.3.1.cmml">∪</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.4.m4.1.1.3.3" xref="S3.SS1.p1.4.m4.1.1.3.3.cmml">𝒢</mi><mo id="S3.SS1.p1.4.m4.1.1.3.1a" xref="S3.SS1.p1.4.m4.1.1.3.1.cmml">∪</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.4.m4.1.1.3.4" xref="S3.SS1.p1.4.m4.1.1.3.4.cmml">ℛ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1"><in id="S3.SS1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1.1"></in><apply id="S3.SS1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.2.1.cmml" xref="S3.SS1.p1.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.2.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2.2">𝑦</ci><ci id="S3.SS1.p1.4.m4.1.1.2.3.cmml" xref="S3.SS1.p1.4.m4.1.1.2.3">𝑖</ci></apply><apply id="S3.SS1.p1.4.m4.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3"><union id="S3.SS1.p1.4.m4.1.1.3.1.cmml" xref="S3.SS1.p1.4.m4.1.1.3.1"></union><ci id="S3.SS1.p1.4.m4.1.1.3.2.cmml" xref="S3.SS1.p1.4.m4.1.1.3.2">𝒲</ci><ci id="S3.SS1.p1.4.m4.1.1.3.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3.3">𝒢</ci><ci id="S3.SS1.p1.4.m4.1.1.3.4.cmml" xref="S3.SS1.p1.4.m4.1.1.3.4">ℛ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">y_{i}\in\mathcal{W}\cup\mathcal{G}\cup\mathcal{R}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ caligraphic_W ∪ caligraphic_G ∪ caligraphic_R</annotation></semantics></math>, combines these tokens. The sequence is interleaved with tokens in different spaces.
Suppose the molecule appears at position <math alttext="i" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.1"><semantics id="S3.SS1.p1.5.m5.1a"><mi id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><ci id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m5.1d">italic_i</annotation></semantics></math>; then, we typically see:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\ldots,\quad Y_{i}\in\mathcal{G},\quad Y_{i+1:i+L}\in\mathcal{W},\quad Y_{i+L+%
1}\in\mathcal{R},\quad\ldots" class="ltx_Math" display="block" id="S3.Ex1.m1.5"><semantics id="S3.Ex1.m1.5a"><mrow id="S3.Ex1.m1.5.5.2" xref="S3.Ex1.m1.5.5.3.cmml"><mrow id="S3.Ex1.m1.4.4.1.1" xref="S3.Ex1.m1.4.4.1.1.cmml"><mrow id="S3.Ex1.m1.4.4.1.1.1.1" xref="S3.Ex1.m1.4.4.1.1.1.2.cmml"><mi id="S3.Ex1.m1.1.1" mathvariant="normal" xref="S3.Ex1.m1.1.1.cmml">…</mi><mo id="S3.Ex1.m1.4.4.1.1.1.1.2" rspace="1.167em" xref="S3.Ex1.m1.4.4.1.1.1.2.cmml">,</mo><msub id="S3.Ex1.m1.4.4.1.1.1.1.1" xref="S3.Ex1.m1.4.4.1.1.1.1.1.cmml"><mi id="S3.Ex1.m1.4.4.1.1.1.1.1.2" xref="S3.Ex1.m1.4.4.1.1.1.1.1.2.cmml">Y</mi><mi id="S3.Ex1.m1.4.4.1.1.1.1.1.3" xref="S3.Ex1.m1.4.4.1.1.1.1.1.3.cmml">i</mi></msub></mrow><mo id="S3.Ex1.m1.4.4.1.1.2" xref="S3.Ex1.m1.4.4.1.1.2.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.Ex1.m1.4.4.1.1.3" xref="S3.Ex1.m1.4.4.1.1.3.cmml">𝒢</mi></mrow><mo id="S3.Ex1.m1.5.5.2.3" rspace="1.167em" xref="S3.Ex1.m1.5.5.3a.cmml">,</mo><mrow id="S3.Ex1.m1.5.5.2.2.2" xref="S3.Ex1.m1.5.5.2.2.3.cmml"><mrow id="S3.Ex1.m1.5.5.2.2.1.1" xref="S3.Ex1.m1.5.5.2.2.1.1.cmml"><msub id="S3.Ex1.m1.5.5.2.2.1.1.2" xref="S3.Ex1.m1.5.5.2.2.1.1.2.cmml"><mi id="S3.Ex1.m1.5.5.2.2.1.1.2.2" xref="S3.Ex1.m1.5.5.2.2.1.1.2.2.cmml">Y</mi><mrow id="S3.Ex1.m1.5.5.2.2.1.1.2.3" xref="S3.Ex1.m1.5.5.2.2.1.1.2.3.cmml"><mrow id="S3.Ex1.m1.5.5.2.2.1.1.2.3.2" xref="S3.Ex1.m1.5.5.2.2.1.1.2.3.2.cmml"><mi id="S3.Ex1.m1.5.5.2.2.1.1.2.3.2.2" xref="S3.Ex1.m1.5.5.2.2.1.1.2.3.2.2.cmml">i</mi><mo id="S3.Ex1.m1.5.5.2.2.1.1.2.3.2.1" xref="S3.Ex1.m1.5.5.2.2.1.1.2.3.2.1.cmml">+</mo><mn id="S3.Ex1.m1.5.5.2.2.1.1.2.3.2.3" xref="S3.Ex1.m1.5.5.2.2.1.1.2.3.2.3.cmml">1</mn></mrow><mo id="S3.Ex1.m1.5.5.2.2.1.1.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.Ex1.m1.5.5.2.2.1.1.2.3.1.cmml">:</mo><mrow id="S3.Ex1.m1.5.5.2.2.1.1.2.3.3" xref="S3.Ex1.m1.5.5.2.2.1.1.2.3.3.cmml"><mi id="S3.Ex1.m1.5.5.2.2.1.1.2.3.3.2" xref="S3.Ex1.m1.5.5.2.2.1.1.2.3.3.2.cmml">i</mi><mo id="S3.Ex1.m1.5.5.2.2.1.1.2.3.3.1" xref="S3.Ex1.m1.5.5.2.2.1.1.2.3.3.1.cmml">+</mo><mi id="S3.Ex1.m1.5.5.2.2.1.1.2.3.3.3" xref="S3.Ex1.m1.5.5.2.2.1.1.2.3.3.3.cmml">L</mi></mrow></mrow></msub><mo id="S3.Ex1.m1.5.5.2.2.1.1.1" xref="S3.Ex1.m1.5.5.2.2.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.Ex1.m1.5.5.2.2.1.1.3" xref="S3.Ex1.m1.5.5.2.2.1.1.3.cmml">𝒲</mi></mrow><mo id="S3.Ex1.m1.5.5.2.2.2.3" rspace="1.167em" xref="S3.Ex1.m1.5.5.2.2.3a.cmml">,</mo><mrow id="S3.Ex1.m1.5.5.2.2.2.2" xref="S3.Ex1.m1.5.5.2.2.2.2.cmml"><msub id="S3.Ex1.m1.5.5.2.2.2.2.2" xref="S3.Ex1.m1.5.5.2.2.2.2.2.cmml"><mi id="S3.Ex1.m1.5.5.2.2.2.2.2.2" xref="S3.Ex1.m1.5.5.2.2.2.2.2.2.cmml">Y</mi><mrow id="S3.Ex1.m1.5.5.2.2.2.2.2.3" xref="S3.Ex1.m1.5.5.2.2.2.2.2.3.cmml"><mi id="S3.Ex1.m1.5.5.2.2.2.2.2.3.2" xref="S3.Ex1.m1.5.5.2.2.2.2.2.3.2.cmml">i</mi><mo id="S3.Ex1.m1.5.5.2.2.2.2.2.3.1" xref="S3.Ex1.m1.5.5.2.2.2.2.2.3.1.cmml">+</mo><mi id="S3.Ex1.m1.5.5.2.2.2.2.2.3.3" xref="S3.Ex1.m1.5.5.2.2.2.2.2.3.3.cmml">L</mi><mo id="S3.Ex1.m1.5.5.2.2.2.2.2.3.1a" xref="S3.Ex1.m1.5.5.2.2.2.2.2.3.1.cmml">+</mo><mn id="S3.Ex1.m1.5.5.2.2.2.2.2.3.4" xref="S3.Ex1.m1.5.5.2.2.2.2.2.3.4.cmml">1</mn></mrow></msub><mo id="S3.Ex1.m1.5.5.2.2.2.2.1" xref="S3.Ex1.m1.5.5.2.2.2.2.1.cmml">∈</mo><mrow id="S3.Ex1.m1.5.5.2.2.2.2.3.2" xref="S3.Ex1.m1.5.5.2.2.2.2.3.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex1.m1.2.2" xref="S3.Ex1.m1.2.2.cmml">ℛ</mi><mo id="S3.Ex1.m1.5.5.2.2.2.2.3.2.1" rspace="1.167em" xref="S3.Ex1.m1.5.5.2.2.2.2.3.1.cmml">,</mo><mi id="S3.Ex1.m1.3.3" mathvariant="normal" xref="S3.Ex1.m1.3.3.cmml">…</mi></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.5b"><apply id="S3.Ex1.m1.5.5.3.cmml" xref="S3.Ex1.m1.5.5.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.5.5.3a.cmml" xref="S3.Ex1.m1.5.5.2.3">formulae-sequence</csymbol><apply id="S3.Ex1.m1.4.4.1.1.cmml" xref="S3.Ex1.m1.4.4.1.1"><in id="S3.Ex1.m1.4.4.1.1.2.cmml" xref="S3.Ex1.m1.4.4.1.1.2"></in><list id="S3.Ex1.m1.4.4.1.1.1.2.cmml" xref="S3.Ex1.m1.4.4.1.1.1.1"><ci id="S3.Ex1.m1.1.1.cmml" xref="S3.Ex1.m1.1.1">…</ci><apply id="S3.Ex1.m1.4.4.1.1.1.1.1.cmml" xref="S3.Ex1.m1.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.4.4.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex1.m1.4.4.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.4.4.1.1.1.1.1.2">𝑌</ci><ci id="S3.Ex1.m1.4.4.1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.4.4.1.1.1.1.1.3">𝑖</ci></apply></list><ci id="S3.Ex1.m1.4.4.1.1.3.cmml" xref="S3.Ex1.m1.4.4.1.1.3">𝒢</ci></apply><apply id="S3.Ex1.m1.5.5.2.2.3.cmml" xref="S3.Ex1.m1.5.5.2.2.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.5.5.2.2.3a.cmml" xref="S3.Ex1.m1.5.5.2.2.2.3">formulae-sequence</csymbol><apply id="S3.Ex1.m1.5.5.2.2.1.1.cmml" xref="S3.Ex1.m1.5.5.2.2.1.1"><in id="S3.Ex1.m1.5.5.2.2.1.1.1.cmml" xref="S3.Ex1.m1.5.5.2.2.1.1.1"></in><apply id="S3.Ex1.m1.5.5.2.2.1.1.2.cmml" xref="S3.Ex1.m1.5.5.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.5.5.2.2.1.1.2.1.cmml" xref="S3.Ex1.m1.5.5.2.2.1.1.2">subscript</csymbol><ci id="S3.Ex1.m1.5.5.2.2.1.1.2.2.cmml" xref="S3.Ex1.m1.5.5.2.2.1.1.2.2">𝑌</ci><apply id="S3.Ex1.m1.5.5.2.2.1.1.2.3.cmml" xref="S3.Ex1.m1.5.5.2.2.1.1.2.3"><ci id="S3.Ex1.m1.5.5.2.2.1.1.2.3.1.cmml" xref="S3.Ex1.m1.5.5.2.2.1.1.2.3.1">:</ci><apply id="S3.Ex1.m1.5.5.2.2.1.1.2.3.2.cmml" xref="S3.Ex1.m1.5.5.2.2.1.1.2.3.2"><plus id="S3.Ex1.m1.5.5.2.2.1.1.2.3.2.1.cmml" xref="S3.Ex1.m1.5.5.2.2.1.1.2.3.2.1"></plus><ci id="S3.Ex1.m1.5.5.2.2.1.1.2.3.2.2.cmml" xref="S3.Ex1.m1.5.5.2.2.1.1.2.3.2.2">𝑖</ci><cn id="S3.Ex1.m1.5.5.2.2.1.1.2.3.2.3.cmml" type="integer" xref="S3.Ex1.m1.5.5.2.2.1.1.2.3.2.3">1</cn></apply><apply id="S3.Ex1.m1.5.5.2.2.1.1.2.3.3.cmml" xref="S3.Ex1.m1.5.5.2.2.1.1.2.3.3"><plus id="S3.Ex1.m1.5.5.2.2.1.1.2.3.3.1.cmml" xref="S3.Ex1.m1.5.5.2.2.1.1.2.3.3.1"></plus><ci id="S3.Ex1.m1.5.5.2.2.1.1.2.3.3.2.cmml" xref="S3.Ex1.m1.5.5.2.2.1.1.2.3.3.2">𝑖</ci><ci id="S3.Ex1.m1.5.5.2.2.1.1.2.3.3.3.cmml" xref="S3.Ex1.m1.5.5.2.2.1.1.2.3.3.3">𝐿</ci></apply></apply></apply><ci id="S3.Ex1.m1.5.5.2.2.1.1.3.cmml" xref="S3.Ex1.m1.5.5.2.2.1.1.3">𝒲</ci></apply><apply id="S3.Ex1.m1.5.5.2.2.2.2.cmml" xref="S3.Ex1.m1.5.5.2.2.2.2"><in id="S3.Ex1.m1.5.5.2.2.2.2.1.cmml" xref="S3.Ex1.m1.5.5.2.2.2.2.1"></in><apply id="S3.Ex1.m1.5.5.2.2.2.2.2.cmml" xref="S3.Ex1.m1.5.5.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.5.5.2.2.2.2.2.1.cmml" xref="S3.Ex1.m1.5.5.2.2.2.2.2">subscript</csymbol><ci id="S3.Ex1.m1.5.5.2.2.2.2.2.2.cmml" xref="S3.Ex1.m1.5.5.2.2.2.2.2.2">𝑌</ci><apply id="S3.Ex1.m1.5.5.2.2.2.2.2.3.cmml" xref="S3.Ex1.m1.5.5.2.2.2.2.2.3"><plus id="S3.Ex1.m1.5.5.2.2.2.2.2.3.1.cmml" xref="S3.Ex1.m1.5.5.2.2.2.2.2.3.1"></plus><ci id="S3.Ex1.m1.5.5.2.2.2.2.2.3.2.cmml" xref="S3.Ex1.m1.5.5.2.2.2.2.2.3.2">𝑖</ci><ci id="S3.Ex1.m1.5.5.2.2.2.2.2.3.3.cmml" xref="S3.Ex1.m1.5.5.2.2.2.2.2.3.3">𝐿</ci><cn id="S3.Ex1.m1.5.5.2.2.2.2.2.3.4.cmml" type="integer" xref="S3.Ex1.m1.5.5.2.2.2.2.2.3.4">1</cn></apply></apply><list id="S3.Ex1.m1.5.5.2.2.2.2.3.1.cmml" xref="S3.Ex1.m1.5.5.2.2.2.2.3.2"><ci id="S3.Ex1.m1.2.2.cmml" xref="S3.Ex1.m1.2.2">ℛ</ci><ci id="S3.Ex1.m1.3.3.cmml" xref="S3.Ex1.m1.3.3">…</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.5c">\ldots,\quad Y_{i}\in\mathcal{G},\quad Y_{i+1:i+L}\in\mathcal{W},\quad Y_{i+L+%
1}\in\mathcal{R},\quad\ldots</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1.m1.5d">… , italic_Y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ caligraphic_G , italic_Y start_POSTSUBSCRIPT italic_i + 1 : italic_i + italic_L end_POSTSUBSCRIPT ∈ caligraphic_W , italic_Y start_POSTSUBSCRIPT italic_i + italic_L + 1 end_POSTSUBSCRIPT ∈ caligraphic_R , …</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p1.11">where <math alttext="L" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m1.1"><semantics id="S3.SS1.p1.6.m1.1a"><mi id="S3.SS1.p1.6.m1.1.1" xref="S3.SS1.p1.6.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m1.1b"><ci id="S3.SS1.p1.6.m1.1.1.cmml" xref="S3.SS1.p1.6.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m1.1c">L</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m1.1d">italic_L</annotation></semantics></math> is the length of the text following the molecule at position <math alttext="i" class="ltx_Math" display="inline" id="S3.SS1.p1.7.m2.1"><semantics id="S3.SS1.p1.7.m2.1a"><mi id="S3.SS1.p1.7.m2.1.1" xref="S3.SS1.p1.7.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m2.1b"><ci id="S3.SS1.p1.7.m2.1.1.cmml" xref="S3.SS1.p1.7.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.7.m2.1d">italic_i</annotation></semantics></math>. The sequence starts with text. If position <math alttext="i" class="ltx_Math" display="inline" id="S3.SS1.p1.8.m3.1"><semantics id="S3.SS1.p1.8.m3.1a"><mi id="S3.SS1.p1.8.m3.1.1" xref="S3.SS1.p1.8.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m3.1b"><ci id="S3.SS1.p1.8.m3.1.1.cmml" xref="S3.SS1.p1.8.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.8.m3.1d">italic_i</annotation></semantics></math> denotes the first molecule in the sequence, then <math alttext="Y_{<i}\in\mathcal{W}" class="ltx_Math" display="inline" id="S3.SS1.p1.9.m4.1"><semantics id="S3.SS1.p1.9.m4.1a"><mrow id="S3.SS1.p1.9.m4.1.1" xref="S3.SS1.p1.9.m4.1.1.cmml"><msub id="S3.SS1.p1.9.m4.1.1.2" xref="S3.SS1.p1.9.m4.1.1.2.cmml"><mi id="S3.SS1.p1.9.m4.1.1.2.2" xref="S3.SS1.p1.9.m4.1.1.2.2.cmml">Y</mi><mrow id="S3.SS1.p1.9.m4.1.1.2.3" xref="S3.SS1.p1.9.m4.1.1.2.3.cmml"><mi id="S3.SS1.p1.9.m4.1.1.2.3.2" xref="S3.SS1.p1.9.m4.1.1.2.3.2.cmml"></mi><mo id="S3.SS1.p1.9.m4.1.1.2.3.1" xref="S3.SS1.p1.9.m4.1.1.2.3.1.cmml">&lt;</mo><mi id="S3.SS1.p1.9.m4.1.1.2.3.3" xref="S3.SS1.p1.9.m4.1.1.2.3.3.cmml">i</mi></mrow></msub><mo id="S3.SS1.p1.9.m4.1.1.1" xref="S3.SS1.p1.9.m4.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.9.m4.1.1.3" xref="S3.SS1.p1.9.m4.1.1.3.cmml">𝒲</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m4.1b"><apply id="S3.SS1.p1.9.m4.1.1.cmml" xref="S3.SS1.p1.9.m4.1.1"><in id="S3.SS1.p1.9.m4.1.1.1.cmml" xref="S3.SS1.p1.9.m4.1.1.1"></in><apply id="S3.SS1.p1.9.m4.1.1.2.cmml" xref="S3.SS1.p1.9.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m4.1.1.2.1.cmml" xref="S3.SS1.p1.9.m4.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.9.m4.1.1.2.2.cmml" xref="S3.SS1.p1.9.m4.1.1.2.2">𝑌</ci><apply id="S3.SS1.p1.9.m4.1.1.2.3.cmml" xref="S3.SS1.p1.9.m4.1.1.2.3"><lt id="S3.SS1.p1.9.m4.1.1.2.3.1.cmml" xref="S3.SS1.p1.9.m4.1.1.2.3.1"></lt><csymbol cd="latexml" id="S3.SS1.p1.9.m4.1.1.2.3.2.cmml" xref="S3.SS1.p1.9.m4.1.1.2.3.2">absent</csymbol><ci id="S3.SS1.p1.9.m4.1.1.2.3.3.cmml" xref="S3.SS1.p1.9.m4.1.1.2.3.3">𝑖</ci></apply></apply><ci id="S3.SS1.p1.9.m4.1.1.3.cmml" xref="S3.SS1.p1.9.m4.1.1.3">𝒲</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m4.1c">Y_{&lt;i}\in\mathcal{W}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.9.m4.1d">italic_Y start_POSTSUBSCRIPT &lt; italic_i end_POSTSUBSCRIPT ∈ caligraphic_W</annotation></semantics></math>; otherwise, <math alttext="y_{i-1}\in\mathcal{R}" class="ltx_Math" display="inline" id="S3.SS1.p1.10.m5.1"><semantics id="S3.SS1.p1.10.m5.1a"><mrow id="S3.SS1.p1.10.m5.1.1" xref="S3.SS1.p1.10.m5.1.1.cmml"><msub id="S3.SS1.p1.10.m5.1.1.2" xref="S3.SS1.p1.10.m5.1.1.2.cmml"><mi id="S3.SS1.p1.10.m5.1.1.2.2" xref="S3.SS1.p1.10.m5.1.1.2.2.cmml">y</mi><mrow id="S3.SS1.p1.10.m5.1.1.2.3" xref="S3.SS1.p1.10.m5.1.1.2.3.cmml"><mi id="S3.SS1.p1.10.m5.1.1.2.3.2" xref="S3.SS1.p1.10.m5.1.1.2.3.2.cmml">i</mi><mo id="S3.SS1.p1.10.m5.1.1.2.3.1" xref="S3.SS1.p1.10.m5.1.1.2.3.1.cmml">−</mo><mn id="S3.SS1.p1.10.m5.1.1.2.3.3" xref="S3.SS1.p1.10.m5.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS1.p1.10.m5.1.1.1" xref="S3.SS1.p1.10.m5.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.10.m5.1.1.3" xref="S3.SS1.p1.10.m5.1.1.3.cmml">ℛ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m5.1b"><apply id="S3.SS1.p1.10.m5.1.1.cmml" xref="S3.SS1.p1.10.m5.1.1"><in id="S3.SS1.p1.10.m5.1.1.1.cmml" xref="S3.SS1.p1.10.m5.1.1.1"></in><apply id="S3.SS1.p1.10.m5.1.1.2.cmml" xref="S3.SS1.p1.10.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m5.1.1.2.1.cmml" xref="S3.SS1.p1.10.m5.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.10.m5.1.1.2.2.cmml" xref="S3.SS1.p1.10.m5.1.1.2.2">𝑦</ci><apply id="S3.SS1.p1.10.m5.1.1.2.3.cmml" xref="S3.SS1.p1.10.m5.1.1.2.3"><minus id="S3.SS1.p1.10.m5.1.1.2.3.1.cmml" xref="S3.SS1.p1.10.m5.1.1.2.3.1"></minus><ci id="S3.SS1.p1.10.m5.1.1.2.3.2.cmml" xref="S3.SS1.p1.10.m5.1.1.2.3.2">𝑖</ci><cn id="S3.SS1.p1.10.m5.1.1.2.3.3.cmml" type="integer" xref="S3.SS1.p1.10.m5.1.1.2.3.3">1</cn></apply></apply><ci id="S3.SS1.p1.10.m5.1.1.3.cmml" xref="S3.SS1.p1.10.m5.1.1.3">ℛ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m5.1c">y_{i-1}\in\mathcal{R}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.10.m5.1d">italic_y start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT ∈ caligraphic_R</annotation></semantics></math>.
To handle non-word tokens, we integrate domain-specific Graph DiT and GNN with the LLM, forming a multimodal LLM, i.e., Llamole. Parameterized by <math alttext="\Theta" class="ltx_Math" display="inline" id="S3.SS1.p1.11.m6.1"><semantics id="S3.SS1.p1.11.m6.1a"><mi id="S3.SS1.p1.11.m6.1.1" mathvariant="normal" xref="S3.SS1.p1.11.m6.1.1.cmml">Θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m6.1b"><ci id="S3.SS1.p1.11.m6.1.1.cmml" xref="S3.SS1.p1.11.m6.1.1">Θ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m6.1c">\Theta</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.11.m6.1d">roman_Θ</annotation></semantics></math>, Llamole unifies the cross-entropy losses from&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S2.E1" title="In 2.1 Autoregressive Language Modeling ‣ 2 Preliminaries ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Eqs.</span>&nbsp;<span class="ltx_text ltx_ref_tag">1</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S2.E2" title="Eq. 2 ‣ 2.2 Molecular Design with Graph Diffusion Models ‣ 2 Preliminaries ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">2</span></a> and&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S2.E3" title="Eq. 3 ‣ 2.3 One-Step Reaction Prediction with Graph Neural Networks ‣ 2 Preliminaries ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">3</span></a> into autoregressive modeling:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\text{Llamole}}=\mathcal{L}_{\text{LM}}+\mathcal{L}_{\text{DM}}+%
\mathcal{L}_{\text{predictor}}=\sum_{i}-\log p_{\Theta}(y_{i}|Y_{<i})." class="ltx_Math" display="block" id="S3.E4.m1.1"><semantics id="S3.E4.m1.1a"><mrow id="S3.E4.m1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml"><mrow id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml"><msub id="S3.E4.m1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.1.1.1.1.3.2" xref="S3.E4.m1.1.1.1.1.3.2.cmml">ℒ</mi><mtext id="S3.E4.m1.1.1.1.1.3.3" xref="S3.E4.m1.1.1.1.1.3.3a.cmml">Llamole</mtext></msub><mo id="S3.E4.m1.1.1.1.1.4" xref="S3.E4.m1.1.1.1.1.4.cmml">=</mo><mrow id="S3.E4.m1.1.1.1.1.5" xref="S3.E4.m1.1.1.1.1.5.cmml"><msub id="S3.E4.m1.1.1.1.1.5.2" xref="S3.E4.m1.1.1.1.1.5.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.1.1.1.1.5.2.2" xref="S3.E4.m1.1.1.1.1.5.2.2.cmml">ℒ</mi><mtext id="S3.E4.m1.1.1.1.1.5.2.3" xref="S3.E4.m1.1.1.1.1.5.2.3a.cmml">LM</mtext></msub><mo id="S3.E4.m1.1.1.1.1.5.1" xref="S3.E4.m1.1.1.1.1.5.1.cmml">+</mo><msub id="S3.E4.m1.1.1.1.1.5.3" xref="S3.E4.m1.1.1.1.1.5.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.1.1.1.1.5.3.2" xref="S3.E4.m1.1.1.1.1.5.3.2.cmml">ℒ</mi><mtext id="S3.E4.m1.1.1.1.1.5.3.3" xref="S3.E4.m1.1.1.1.1.5.3.3a.cmml">DM</mtext></msub><mo id="S3.E4.m1.1.1.1.1.5.1a" xref="S3.E4.m1.1.1.1.1.5.1.cmml">+</mo><msub id="S3.E4.m1.1.1.1.1.5.4" xref="S3.E4.m1.1.1.1.1.5.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.1.1.1.1.5.4.2" xref="S3.E4.m1.1.1.1.1.5.4.2.cmml">ℒ</mi><mtext id="S3.E4.m1.1.1.1.1.5.4.3" xref="S3.E4.m1.1.1.1.1.5.4.3a.cmml">predictor</mtext></msub></mrow><mo id="S3.E4.m1.1.1.1.1.6" rspace="0.111em" xref="S3.E4.m1.1.1.1.1.6.cmml">=</mo><mrow id="S3.E4.m1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.cmml"><munder id="S3.E4.m1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.3.cmml"><mo id="S3.E4.m1.1.1.1.1.1.3.2" movablelimits="false" rspace="0em" xref="S3.E4.m1.1.1.1.1.1.3.2.cmml">∑</mo><mi id="S3.E4.m1.1.1.1.1.1.3.3" xref="S3.E4.m1.1.1.1.1.1.3.3.cmml">i</mi></munder><mo id="S3.E4.m1.1.1.1.1.1.2" lspace="0em" xref="S3.E4.m1.1.1.1.1.1.2.cmml">−</mo><mrow id="S3.E4.m1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.cmml"><mrow id="S3.E4.m1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.3.1" xref="S3.E4.m1.1.1.1.1.1.1.3.1.cmml">log</mi><mo id="S3.E4.m1.1.1.1.1.1.1.3a" lspace="0.167em" xref="S3.E4.m1.1.1.1.1.1.1.3.cmml">⁡</mo><msub id="S3.E4.m1.1.1.1.1.1.1.3.2" xref="S3.E4.m1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.3.2.2" xref="S3.E4.m1.1.1.1.1.1.1.3.2.2.cmml">p</mi><mi id="S3.E4.m1.1.1.1.1.1.1.3.2.3" mathvariant="normal" xref="S3.E4.m1.1.1.1.1.1.1.3.2.3.cmml">Θ</mi></msub></mrow><mo id="S3.E4.m1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E4.m1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E4.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E4.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">y</mi><mi id="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo fence="false" id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S3.E4.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">Y</mi><mrow id="S3.E4.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.3.3.2.cmml"></mi><mo id="S3.E4.m1.1.1.1.1.1.1.1.1.1.3.3.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">&lt;</mo><mi id="S3.E4.m1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">i</mi></mrow></msub></mrow><mo id="S3.E4.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E4.m1.1.1.1.2" lspace="0em" xref="S3.E4.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.1b"><apply id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1"><and id="S3.E4.m1.1.1.1.1a.cmml" xref="S3.E4.m1.1.1.1"></and><apply id="S3.E4.m1.1.1.1.1b.cmml" xref="S3.E4.m1.1.1.1"><eq id="S3.E4.m1.1.1.1.1.4.cmml" xref="S3.E4.m1.1.1.1.1.4"></eq><apply id="S3.E4.m1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.1.1.3.2">ℒ</ci><ci id="S3.E4.m1.1.1.1.1.3.3a.cmml" xref="S3.E4.m1.1.1.1.1.3.3"><mtext id="S3.E4.m1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S3.E4.m1.1.1.1.1.3.3">Llamole</mtext></ci></apply><apply id="S3.E4.m1.1.1.1.1.5.cmml" xref="S3.E4.m1.1.1.1.1.5"><plus id="S3.E4.m1.1.1.1.1.5.1.cmml" xref="S3.E4.m1.1.1.1.1.5.1"></plus><apply id="S3.E4.m1.1.1.1.1.5.2.cmml" xref="S3.E4.m1.1.1.1.1.5.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.5.2.1.cmml" xref="S3.E4.m1.1.1.1.1.5.2">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.5.2.2.cmml" xref="S3.E4.m1.1.1.1.1.5.2.2">ℒ</ci><ci id="S3.E4.m1.1.1.1.1.5.2.3a.cmml" xref="S3.E4.m1.1.1.1.1.5.2.3"><mtext id="S3.E4.m1.1.1.1.1.5.2.3.cmml" mathsize="70%" xref="S3.E4.m1.1.1.1.1.5.2.3">LM</mtext></ci></apply><apply id="S3.E4.m1.1.1.1.1.5.3.cmml" xref="S3.E4.m1.1.1.1.1.5.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.5.3.1.cmml" xref="S3.E4.m1.1.1.1.1.5.3">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.5.3.2.cmml" xref="S3.E4.m1.1.1.1.1.5.3.2">ℒ</ci><ci id="S3.E4.m1.1.1.1.1.5.3.3a.cmml" xref="S3.E4.m1.1.1.1.1.5.3.3"><mtext id="S3.E4.m1.1.1.1.1.5.3.3.cmml" mathsize="70%" xref="S3.E4.m1.1.1.1.1.5.3.3">DM</mtext></ci></apply><apply id="S3.E4.m1.1.1.1.1.5.4.cmml" xref="S3.E4.m1.1.1.1.1.5.4"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.5.4.1.cmml" xref="S3.E4.m1.1.1.1.1.5.4">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.5.4.2.cmml" xref="S3.E4.m1.1.1.1.1.5.4.2">ℒ</ci><ci id="S3.E4.m1.1.1.1.1.5.4.3a.cmml" xref="S3.E4.m1.1.1.1.1.5.4.3"><mtext id="S3.E4.m1.1.1.1.1.5.4.3.cmml" mathsize="70%" xref="S3.E4.m1.1.1.1.1.5.4.3">predictor</mtext></ci></apply></apply></apply><apply id="S3.E4.m1.1.1.1.1c.cmml" xref="S3.E4.m1.1.1.1"><eq id="S3.E4.m1.1.1.1.1.6.cmml" xref="S3.E4.m1.1.1.1.1.6"></eq><share href="https://arxiv.org/html/2410.04223v1#S3.E4.m1.1.1.1.1.5.cmml" id="S3.E4.m1.1.1.1.1d.cmml" xref="S3.E4.m1.1.1.1"></share><apply id="S3.E4.m1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1"><minus id="S3.E4.m1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.2"></minus><apply id="S3.E4.m1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.1.1.1.3">subscript</csymbol><sum id="S3.E4.m1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.1.1.1.3.2"></sum><ci id="S3.E4.m1.1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.1.1.1.1.1.3.3">𝑖</ci></apply><apply id="S3.E4.m1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1"><times id="S3.E4.m1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.2"></times><apply id="S3.E4.m1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.3"><log id="S3.E4.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.3.1"></log><apply id="S3.E4.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.3.2.2">𝑝</ci><ci id="S3.E4.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.3.2.3">Θ</ci></apply></apply><apply id="S3.E4.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.2">𝑦</ci><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E4.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.3.2">𝑌</ci><apply id="S3.E4.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.3.3"><lt id="S3.E4.m1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.3.3.1"></lt><csymbol cd="latexml" id="S3.E4.m1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.3.3.2">absent</csymbol><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.3.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.1c">\mathcal{L}_{\text{Llamole}}=\mathcal{L}_{\text{LM}}+\mathcal{L}_{\text{DM}}+%
\mathcal{L}_{\text{predictor}}=\sum_{i}-\log p_{\Theta}(y_{i}|Y_{&lt;i}).</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.1d">caligraphic_L start_POSTSUBSCRIPT Llamole end_POSTSUBSCRIPT = caligraphic_L start_POSTSUBSCRIPT LM end_POSTSUBSCRIPT + caligraphic_L start_POSTSUBSCRIPT DM end_POSTSUBSCRIPT + caligraphic_L start_POSTSUBSCRIPT predictor end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT - roman_log italic_p start_POSTSUBSCRIPT roman_Θ end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | italic_Y start_POSTSUBSCRIPT &lt; italic_i end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p1.24"><math alttext="\mathcal{L}_{\text{DM}}" class="ltx_Math" display="inline" id="S3.SS1.p1.12.m1.1"><semantics id="S3.SS1.p1.12.m1.1a"><msub id="S3.SS1.p1.12.m1.1.1" xref="S3.SS1.p1.12.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.12.m1.1.1.2" xref="S3.SS1.p1.12.m1.1.1.2.cmml">ℒ</mi><mtext id="S3.SS1.p1.12.m1.1.1.3" xref="S3.SS1.p1.12.m1.1.1.3a.cmml">DM</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.12.m1.1b"><apply id="S3.SS1.p1.12.m1.1.1.cmml" xref="S3.SS1.p1.12.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.12.m1.1.1.1.cmml" xref="S3.SS1.p1.12.m1.1.1">subscript</csymbol><ci id="S3.SS1.p1.12.m1.1.1.2.cmml" xref="S3.SS1.p1.12.m1.1.1.2">ℒ</ci><ci id="S3.SS1.p1.12.m1.1.1.3a.cmml" xref="S3.SS1.p1.12.m1.1.1.3"><mtext id="S3.SS1.p1.12.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS1.p1.12.m1.1.1.3">DM</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.12.m1.1c">\mathcal{L}_{\text{DM}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.12.m1.1d">caligraphic_L start_POSTSUBSCRIPT DM end_POSTSUBSCRIPT</annotation></semantics></math> interprets <math alttext="{Y}_{<i}" class="ltx_Math" display="inline" id="S3.SS1.p1.13.m2.1"><semantics id="S3.SS1.p1.13.m2.1a"><msub id="S3.SS1.p1.13.m2.1.1" xref="S3.SS1.p1.13.m2.1.1.cmml"><mi id="S3.SS1.p1.13.m2.1.1.2" xref="S3.SS1.p1.13.m2.1.1.2.cmml">Y</mi><mrow id="S3.SS1.p1.13.m2.1.1.3" xref="S3.SS1.p1.13.m2.1.1.3.cmml"><mi id="S3.SS1.p1.13.m2.1.1.3.2" xref="S3.SS1.p1.13.m2.1.1.3.2.cmml"></mi><mo id="S3.SS1.p1.13.m2.1.1.3.1" xref="S3.SS1.p1.13.m2.1.1.3.1.cmml">&lt;</mo><mi id="S3.SS1.p1.13.m2.1.1.3.3" xref="S3.SS1.p1.13.m2.1.1.3.3.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.13.m2.1b"><apply id="S3.SS1.p1.13.m2.1.1.cmml" xref="S3.SS1.p1.13.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.13.m2.1.1.1.cmml" xref="S3.SS1.p1.13.m2.1.1">subscript</csymbol><ci id="S3.SS1.p1.13.m2.1.1.2.cmml" xref="S3.SS1.p1.13.m2.1.1.2">𝑌</ci><apply id="S3.SS1.p1.13.m2.1.1.3.cmml" xref="S3.SS1.p1.13.m2.1.1.3"><lt id="S3.SS1.p1.13.m2.1.1.3.1.cmml" xref="S3.SS1.p1.13.m2.1.1.3.1"></lt><csymbol cd="latexml" id="S3.SS1.p1.13.m2.1.1.3.2.cmml" xref="S3.SS1.p1.13.m2.1.1.3.2">absent</csymbol><ci id="S3.SS1.p1.13.m2.1.1.3.3.cmml" xref="S3.SS1.p1.13.m2.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.13.m2.1c">{Y}_{&lt;i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.13.m2.1d">italic_Y start_POSTSUBSCRIPT &lt; italic_i end_POSTSUBSCRIPT</annotation></semantics></math> as the input conditions, including desirable molecular properties and text conditions <math alttext="\{c_{i}\}_{i=1}^{M}\cup\{\mathbf{c}_{\text{text}}\}" class="ltx_Math" display="inline" id="S3.SS1.p1.14.m3.2"><semantics id="S3.SS1.p1.14.m3.2a"><mrow id="S3.SS1.p1.14.m3.2.2" xref="S3.SS1.p1.14.m3.2.2.cmml"><msubsup id="S3.SS1.p1.14.m3.1.1.1" xref="S3.SS1.p1.14.m3.1.1.1.cmml"><mrow id="S3.SS1.p1.14.m3.1.1.1.1.1.1" xref="S3.SS1.p1.14.m3.1.1.1.1.1.2.cmml"><mo id="S3.SS1.p1.14.m3.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS1.p1.14.m3.1.1.1.1.1.2.cmml">{</mo><msub id="S3.SS1.p1.14.m3.1.1.1.1.1.1.1" xref="S3.SS1.p1.14.m3.1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.14.m3.1.1.1.1.1.1.1.2" xref="S3.SS1.p1.14.m3.1.1.1.1.1.1.1.2.cmml">c</mi><mi id="S3.SS1.p1.14.m3.1.1.1.1.1.1.1.3" xref="S3.SS1.p1.14.m3.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS1.p1.14.m3.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS1.p1.14.m3.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS1.p1.14.m3.1.1.1.1.3" xref="S3.SS1.p1.14.m3.1.1.1.1.3.cmml"><mi id="S3.SS1.p1.14.m3.1.1.1.1.3.2" xref="S3.SS1.p1.14.m3.1.1.1.1.3.2.cmml">i</mi><mo id="S3.SS1.p1.14.m3.1.1.1.1.3.1" xref="S3.SS1.p1.14.m3.1.1.1.1.3.1.cmml">=</mo><mn id="S3.SS1.p1.14.m3.1.1.1.1.3.3" xref="S3.SS1.p1.14.m3.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS1.p1.14.m3.1.1.1.3" xref="S3.SS1.p1.14.m3.1.1.1.3.cmml">M</mi></msubsup><mo id="S3.SS1.p1.14.m3.2.2.3" xref="S3.SS1.p1.14.m3.2.2.3.cmml">∪</mo><mrow id="S3.SS1.p1.14.m3.2.2.2.1" xref="S3.SS1.p1.14.m3.2.2.2.2.cmml"><mo id="S3.SS1.p1.14.m3.2.2.2.1.2" stretchy="false" xref="S3.SS1.p1.14.m3.2.2.2.2.cmml">{</mo><msub id="S3.SS1.p1.14.m3.2.2.2.1.1" xref="S3.SS1.p1.14.m3.2.2.2.1.1.cmml"><mi id="S3.SS1.p1.14.m3.2.2.2.1.1.2" xref="S3.SS1.p1.14.m3.2.2.2.1.1.2.cmml">𝐜</mi><mtext id="S3.SS1.p1.14.m3.2.2.2.1.1.3" xref="S3.SS1.p1.14.m3.2.2.2.1.1.3a.cmml">text</mtext></msub><mo id="S3.SS1.p1.14.m3.2.2.2.1.3" stretchy="false" xref="S3.SS1.p1.14.m3.2.2.2.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.14.m3.2b"><apply id="S3.SS1.p1.14.m3.2.2.cmml" xref="S3.SS1.p1.14.m3.2.2"><union id="S3.SS1.p1.14.m3.2.2.3.cmml" xref="S3.SS1.p1.14.m3.2.2.3"></union><apply id="S3.SS1.p1.14.m3.1.1.1.cmml" xref="S3.SS1.p1.14.m3.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m3.1.1.1.2.cmml" xref="S3.SS1.p1.14.m3.1.1.1">superscript</csymbol><apply id="S3.SS1.p1.14.m3.1.1.1.1.cmml" xref="S3.SS1.p1.14.m3.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m3.1.1.1.1.2.cmml" xref="S3.SS1.p1.14.m3.1.1.1">subscript</csymbol><set id="S3.SS1.p1.14.m3.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.14.m3.1.1.1.1.1.1"><apply id="S3.SS1.p1.14.m3.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.14.m3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m3.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.14.m3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.14.m3.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.14.m3.1.1.1.1.1.1.1.2">𝑐</ci><ci id="S3.SS1.p1.14.m3.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.14.m3.1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S3.SS1.p1.14.m3.1.1.1.1.3.cmml" xref="S3.SS1.p1.14.m3.1.1.1.1.3"><eq id="S3.SS1.p1.14.m3.1.1.1.1.3.1.cmml" xref="S3.SS1.p1.14.m3.1.1.1.1.3.1"></eq><ci id="S3.SS1.p1.14.m3.1.1.1.1.3.2.cmml" xref="S3.SS1.p1.14.m3.1.1.1.1.3.2">𝑖</ci><cn id="S3.SS1.p1.14.m3.1.1.1.1.3.3.cmml" type="integer" xref="S3.SS1.p1.14.m3.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS1.p1.14.m3.1.1.1.3.cmml" xref="S3.SS1.p1.14.m3.1.1.1.3">𝑀</ci></apply><set id="S3.SS1.p1.14.m3.2.2.2.2.cmml" xref="S3.SS1.p1.14.m3.2.2.2.1"><apply id="S3.SS1.p1.14.m3.2.2.2.1.1.cmml" xref="S3.SS1.p1.14.m3.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m3.2.2.2.1.1.1.cmml" xref="S3.SS1.p1.14.m3.2.2.2.1.1">subscript</csymbol><ci id="S3.SS1.p1.14.m3.2.2.2.1.1.2.cmml" xref="S3.SS1.p1.14.m3.2.2.2.1.1.2">𝐜</ci><ci id="S3.SS1.p1.14.m3.2.2.2.1.1.3a.cmml" xref="S3.SS1.p1.14.m3.2.2.2.1.1.3"><mtext id="S3.SS1.p1.14.m3.2.2.2.1.1.3.cmml" mathsize="70%" xref="S3.SS1.p1.14.m3.2.2.2.1.1.3">text</mtext></ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.14.m3.2c">\{c_{i}\}_{i=1}^{M}\cup\{\mathbf{c}_{\text{text}}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.14.m3.2d">{ italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT ∪ { bold_c start_POSTSUBSCRIPT text end_POSTSUBSCRIPT }</annotation></semantics></math> for the autoregression of <math alttext="Y_{i}" class="ltx_Math" display="inline" id="S3.SS1.p1.15.m4.1"><semantics id="S3.SS1.p1.15.m4.1a"><msub id="S3.SS1.p1.15.m4.1.1" xref="S3.SS1.p1.15.m4.1.1.cmml"><mi id="S3.SS1.p1.15.m4.1.1.2" xref="S3.SS1.p1.15.m4.1.1.2.cmml">Y</mi><mi id="S3.SS1.p1.15.m4.1.1.3" xref="S3.SS1.p1.15.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.15.m4.1b"><apply id="S3.SS1.p1.15.m4.1.1.cmml" xref="S3.SS1.p1.15.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.15.m4.1.1.1.cmml" xref="S3.SS1.p1.15.m4.1.1">subscript</csymbol><ci id="S3.SS1.p1.15.m4.1.1.2.cmml" xref="S3.SS1.p1.15.m4.1.1.2">𝑌</ci><ci id="S3.SS1.p1.15.m4.1.1.3.cmml" xref="S3.SS1.p1.15.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.15.m4.1c">Y_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.15.m4.1d">italic_Y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> in <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="S3.SS1.p1.16.m5.1"><semantics id="S3.SS1.p1.16.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.16.m5.1.1" xref="S3.SS1.p1.16.m5.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.16.m5.1b"><ci id="S3.SS1.p1.16.m5.1.1.cmml" xref="S3.SS1.p1.16.m5.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.16.m5.1c">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.16.m5.1d">caligraphic_G</annotation></semantics></math>.
In <math alttext="\mathcal{L}_{\text{predictor}}" class="ltx_Math" display="inline" id="S3.SS1.p1.17.m6.1"><semantics id="S3.SS1.p1.17.m6.1a"><msub id="S3.SS1.p1.17.m6.1.1" xref="S3.SS1.p1.17.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.17.m6.1.1.2" xref="S3.SS1.p1.17.m6.1.1.2.cmml">ℒ</mi><mtext id="S3.SS1.p1.17.m6.1.1.3" xref="S3.SS1.p1.17.m6.1.1.3a.cmml">predictor</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.17.m6.1b"><apply id="S3.SS1.p1.17.m6.1.1.cmml" xref="S3.SS1.p1.17.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.17.m6.1.1.1.cmml" xref="S3.SS1.p1.17.m6.1.1">subscript</csymbol><ci id="S3.SS1.p1.17.m6.1.1.2.cmml" xref="S3.SS1.p1.17.m6.1.1.2">ℒ</ci><ci id="S3.SS1.p1.17.m6.1.1.3a.cmml" xref="S3.SS1.p1.17.m6.1.1.3"><mtext id="S3.SS1.p1.17.m6.1.1.3.cmml" mathsize="70%" xref="S3.SS1.p1.17.m6.1.1.3">predictor</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.17.m6.1c">\mathcal{L}_{\text{predictor}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.17.m6.1d">caligraphic_L start_POSTSUBSCRIPT predictor end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="{Y}_{<i}" class="ltx_Math" display="inline" id="S3.SS1.p1.18.m7.1"><semantics id="S3.SS1.p1.18.m7.1a"><msub id="S3.SS1.p1.18.m7.1.1" xref="S3.SS1.p1.18.m7.1.1.cmml"><mi id="S3.SS1.p1.18.m7.1.1.2" xref="S3.SS1.p1.18.m7.1.1.2.cmml">Y</mi><mrow id="S3.SS1.p1.18.m7.1.1.3" xref="S3.SS1.p1.18.m7.1.1.3.cmml"><mi id="S3.SS1.p1.18.m7.1.1.3.2" xref="S3.SS1.p1.18.m7.1.1.3.2.cmml"></mi><mo id="S3.SS1.p1.18.m7.1.1.3.1" xref="S3.SS1.p1.18.m7.1.1.3.1.cmml">&lt;</mo><mi id="S3.SS1.p1.18.m7.1.1.3.3" xref="S3.SS1.p1.18.m7.1.1.3.3.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.18.m7.1b"><apply id="S3.SS1.p1.18.m7.1.1.cmml" xref="S3.SS1.p1.18.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.18.m7.1.1.1.cmml" xref="S3.SS1.p1.18.m7.1.1">subscript</csymbol><ci id="S3.SS1.p1.18.m7.1.1.2.cmml" xref="S3.SS1.p1.18.m7.1.1.2">𝑌</ci><apply id="S3.SS1.p1.18.m7.1.1.3.cmml" xref="S3.SS1.p1.18.m7.1.1.3"><lt id="S3.SS1.p1.18.m7.1.1.3.1.cmml" xref="S3.SS1.p1.18.m7.1.1.3.1"></lt><csymbol cd="latexml" id="S3.SS1.p1.18.m7.1.1.3.2.cmml" xref="S3.SS1.p1.18.m7.1.1.3.2">absent</csymbol><ci id="S3.SS1.p1.18.m7.1.1.3.3.cmml" xref="S3.SS1.p1.18.m7.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.18.m7.1c">{Y}_{&lt;i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.18.m7.1d">italic_Y start_POSTSUBSCRIPT &lt; italic_i end_POSTSUBSCRIPT</annotation></semantics></math> represents <math alttext="G_{\text{product}}" class="ltx_Math" display="inline" id="S3.SS1.p1.19.m8.1"><semantics id="S3.SS1.p1.19.m8.1a"><msub id="S3.SS1.p1.19.m8.1.1" xref="S3.SS1.p1.19.m8.1.1.cmml"><mi id="S3.SS1.p1.19.m8.1.1.2" xref="S3.SS1.p1.19.m8.1.1.2.cmml">G</mi><mtext id="S3.SS1.p1.19.m8.1.1.3" xref="S3.SS1.p1.19.m8.1.1.3a.cmml">product</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.19.m8.1b"><apply id="S3.SS1.p1.19.m8.1.1.cmml" xref="S3.SS1.p1.19.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.19.m8.1.1.1.cmml" xref="S3.SS1.p1.19.m8.1.1">subscript</csymbol><ci id="S3.SS1.p1.19.m8.1.1.2.cmml" xref="S3.SS1.p1.19.m8.1.1.2">𝐺</ci><ci id="S3.SS1.p1.19.m8.1.1.3a.cmml" xref="S3.SS1.p1.19.m8.1.1.3"><mtext id="S3.SS1.p1.19.m8.1.1.3.cmml" mathsize="70%" xref="S3.SS1.p1.19.m8.1.1.3">product</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.19.m8.1c">G_{\text{product}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.19.m8.1d">italic_G start_POSTSUBSCRIPT product end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{c}_{\text{text}}" class="ltx_Math" display="inline" id="S3.SS1.p1.20.m9.1"><semantics id="S3.SS1.p1.20.m9.1a"><msub id="S3.SS1.p1.20.m9.1.1" xref="S3.SS1.p1.20.m9.1.1.cmml"><mi id="S3.SS1.p1.20.m9.1.1.2" xref="S3.SS1.p1.20.m9.1.1.2.cmml">𝐜</mi><mtext id="S3.SS1.p1.20.m9.1.1.3" xref="S3.SS1.p1.20.m9.1.1.3a.cmml">text</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.20.m9.1b"><apply id="S3.SS1.p1.20.m9.1.1.cmml" xref="S3.SS1.p1.20.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.20.m9.1.1.1.cmml" xref="S3.SS1.p1.20.m9.1.1">subscript</csymbol><ci id="S3.SS1.p1.20.m9.1.1.2.cmml" xref="S3.SS1.p1.20.m9.1.1.2">𝐜</ci><ci id="S3.SS1.p1.20.m9.1.1.3a.cmml" xref="S3.SS1.p1.20.m9.1.1.3"><mtext id="S3.SS1.p1.20.m9.1.1.3.cmml" mathsize="70%" xref="S3.SS1.p1.20.m9.1.1.3">text</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.20.m9.1c">\mathbf{c}_{\text{text}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.20.m9.1d">bold_c start_POSTSUBSCRIPT text end_POSTSUBSCRIPT</annotation></semantics></math>.
Here, <math alttext="G_{\text{product}}" class="ltx_Math" display="inline" id="S3.SS1.p1.21.m10.1"><semantics id="S3.SS1.p1.21.m10.1a"><msub id="S3.SS1.p1.21.m10.1.1" xref="S3.SS1.p1.21.m10.1.1.cmml"><mi id="S3.SS1.p1.21.m10.1.1.2" xref="S3.SS1.p1.21.m10.1.1.2.cmml">G</mi><mtext id="S3.SS1.p1.21.m10.1.1.3" xref="S3.SS1.p1.21.m10.1.1.3a.cmml">product</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.21.m10.1b"><apply id="S3.SS1.p1.21.m10.1.1.cmml" xref="S3.SS1.p1.21.m10.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.21.m10.1.1.1.cmml" xref="S3.SS1.p1.21.m10.1.1">subscript</csymbol><ci id="S3.SS1.p1.21.m10.1.1.2.cmml" xref="S3.SS1.p1.21.m10.1.1.2">𝐺</ci><ci id="S3.SS1.p1.21.m10.1.1.3a.cmml" xref="S3.SS1.p1.21.m10.1.1.3"><mtext id="S3.SS1.p1.21.m10.1.1.3.cmml" mathsize="70%" xref="S3.SS1.p1.21.m10.1.1.3">product</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.21.m10.1c">G_{\text{product}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.21.m10.1d">italic_G start_POSTSUBSCRIPT product end_POSTSUBSCRIPT</annotation></semantics></math> is generated from previous diffusion models or as intermediate <math alttext="G\notin\mathcal{G}_{\text{avail}}" class="ltx_Math" display="inline" id="S3.SS1.p1.22.m11.1"><semantics id="S3.SS1.p1.22.m11.1a"><mrow id="S3.SS1.p1.22.m11.1.1" xref="S3.SS1.p1.22.m11.1.1.cmml"><mi id="S3.SS1.p1.22.m11.1.1.2" xref="S3.SS1.p1.22.m11.1.1.2.cmml">G</mi><mo id="S3.SS1.p1.22.m11.1.1.1" xref="S3.SS1.p1.22.m11.1.1.1.cmml">∉</mo><msub id="S3.SS1.p1.22.m11.1.1.3" xref="S3.SS1.p1.22.m11.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.22.m11.1.1.3.2" xref="S3.SS1.p1.22.m11.1.1.3.2.cmml">𝒢</mi><mtext id="S3.SS1.p1.22.m11.1.1.3.3" xref="S3.SS1.p1.22.m11.1.1.3.3a.cmml">avail</mtext></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.22.m11.1b"><apply id="S3.SS1.p1.22.m11.1.1.cmml" xref="S3.SS1.p1.22.m11.1.1"><notin id="S3.SS1.p1.22.m11.1.1.1.cmml" xref="S3.SS1.p1.22.m11.1.1.1"></notin><ci id="S3.SS1.p1.22.m11.1.1.2.cmml" xref="S3.SS1.p1.22.m11.1.1.2">𝐺</ci><apply id="S3.SS1.p1.22.m11.1.1.3.cmml" xref="S3.SS1.p1.22.m11.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.22.m11.1.1.3.1.cmml" xref="S3.SS1.p1.22.m11.1.1.3">subscript</csymbol><ci id="S3.SS1.p1.22.m11.1.1.3.2.cmml" xref="S3.SS1.p1.22.m11.1.1.3.2">𝒢</ci><ci id="S3.SS1.p1.22.m11.1.1.3.3a.cmml" xref="S3.SS1.p1.22.m11.1.1.3.3"><mtext id="S3.SS1.p1.22.m11.1.1.3.3.cmml" mathsize="70%" xref="S3.SS1.p1.22.m11.1.1.3.3">avail</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.22.m11.1c">G\notin\mathcal{G}_{\text{avail}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.22.m11.1d">italic_G ∉ caligraphic_G start_POSTSUBSCRIPT avail end_POSTSUBSCRIPT</annotation></semantics></math> in retrosynthesis. The autoregression for the label <math alttext="Y_{i}" class="ltx_Math" display="inline" id="S3.SS1.p1.23.m12.1"><semantics id="S3.SS1.p1.23.m12.1a"><msub id="S3.SS1.p1.23.m12.1.1" xref="S3.SS1.p1.23.m12.1.1.cmml"><mi id="S3.SS1.p1.23.m12.1.1.2" xref="S3.SS1.p1.23.m12.1.1.2.cmml">Y</mi><mi id="S3.SS1.p1.23.m12.1.1.3" xref="S3.SS1.p1.23.m12.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.23.m12.1b"><apply id="S3.SS1.p1.23.m12.1.1.cmml" xref="S3.SS1.p1.23.m12.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.23.m12.1.1.1.cmml" xref="S3.SS1.p1.23.m12.1.1">subscript</csymbol><ci id="S3.SS1.p1.23.m12.1.1.2.cmml" xref="S3.SS1.p1.23.m12.1.1.2">𝑌</ci><ci id="S3.SS1.p1.23.m12.1.1.3.cmml" xref="S3.SS1.p1.23.m12.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.23.m12.1c">Y_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.23.m12.1d">italic_Y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is performed in the reaction space <math alttext="\mathcal{R}" class="ltx_Math" display="inline" id="S3.SS1.p1.24.m13.1"><semantics id="S3.SS1.p1.24.m13.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.24.m13.1.1" xref="S3.SS1.p1.24.m13.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.24.m13.1b"><ci id="S3.SS1.p1.24.m13.1.1.cmml" xref="S3.SS1.p1.24.m13.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.24.m13.1c">\mathcal{R}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.24.m13.1d">caligraphic_R</annotation></semantics></math>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.5">We present an overview of multimodal autoregression with Llamole in&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S3.F3" title="In 3 Llamole: Multimodal Large Language Model for Molecular Discovery ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Figure</span>&nbsp;<span class="ltx_text ltx_ref_tag">3</span></a>, divided into controllable molecular generation and retrosynthetic planning. The base LLMs perform multiple roles: generating text, controlling the switch of active modules, and providing cost functions for A* search. Augmented with the graph models, the overall parameters in Llamole are <math alttext="\Theta=\{\theta_{1},\theta_{2},\theta_{3},\phi_{1},\phi_{2},\phi_{3}\}" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.6"><semantics id="S3.SS1.p2.1.m1.6a"><mrow id="S3.SS1.p2.1.m1.6.6" xref="S3.SS1.p2.1.m1.6.6.cmml"><mi id="S3.SS1.p2.1.m1.6.6.8" mathvariant="normal" xref="S3.SS1.p2.1.m1.6.6.8.cmml">Θ</mi><mo id="S3.SS1.p2.1.m1.6.6.7" xref="S3.SS1.p2.1.m1.6.6.7.cmml">=</mo><mrow id="S3.SS1.p2.1.m1.6.6.6.6" xref="S3.SS1.p2.1.m1.6.6.6.7.cmml"><mo id="S3.SS1.p2.1.m1.6.6.6.6.7" stretchy="false" xref="S3.SS1.p2.1.m1.6.6.6.7.cmml">{</mo><msub id="S3.SS1.p2.1.m1.1.1.1.1.1" xref="S3.SS1.p2.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS1.p2.1.m1.1.1.1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.1.1.1.2.cmml">θ</mi><mn id="S3.SS1.p2.1.m1.1.1.1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p2.1.m1.6.6.6.6.8" xref="S3.SS1.p2.1.m1.6.6.6.7.cmml">,</mo><msub id="S3.SS1.p2.1.m1.2.2.2.2.2" xref="S3.SS1.p2.1.m1.2.2.2.2.2.cmml"><mi id="S3.SS1.p2.1.m1.2.2.2.2.2.2" xref="S3.SS1.p2.1.m1.2.2.2.2.2.2.cmml">θ</mi><mn id="S3.SS1.p2.1.m1.2.2.2.2.2.3" xref="S3.SS1.p2.1.m1.2.2.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS1.p2.1.m1.6.6.6.6.9" xref="S3.SS1.p2.1.m1.6.6.6.7.cmml">,</mo><msub id="S3.SS1.p2.1.m1.3.3.3.3.3" xref="S3.SS1.p2.1.m1.3.3.3.3.3.cmml"><mi id="S3.SS1.p2.1.m1.3.3.3.3.3.2" xref="S3.SS1.p2.1.m1.3.3.3.3.3.2.cmml">θ</mi><mn id="S3.SS1.p2.1.m1.3.3.3.3.3.3" xref="S3.SS1.p2.1.m1.3.3.3.3.3.3.cmml">3</mn></msub><mo id="S3.SS1.p2.1.m1.6.6.6.6.10" xref="S3.SS1.p2.1.m1.6.6.6.7.cmml">,</mo><msub id="S3.SS1.p2.1.m1.4.4.4.4.4" xref="S3.SS1.p2.1.m1.4.4.4.4.4.cmml"><mi id="S3.SS1.p2.1.m1.4.4.4.4.4.2" xref="S3.SS1.p2.1.m1.4.4.4.4.4.2.cmml">ϕ</mi><mn id="S3.SS1.p2.1.m1.4.4.4.4.4.3" xref="S3.SS1.p2.1.m1.4.4.4.4.4.3.cmml">1</mn></msub><mo id="S3.SS1.p2.1.m1.6.6.6.6.11" xref="S3.SS1.p2.1.m1.6.6.6.7.cmml">,</mo><msub id="S3.SS1.p2.1.m1.5.5.5.5.5" xref="S3.SS1.p2.1.m1.5.5.5.5.5.cmml"><mi id="S3.SS1.p2.1.m1.5.5.5.5.5.2" xref="S3.SS1.p2.1.m1.5.5.5.5.5.2.cmml">ϕ</mi><mn id="S3.SS1.p2.1.m1.5.5.5.5.5.3" xref="S3.SS1.p2.1.m1.5.5.5.5.5.3.cmml">2</mn></msub><mo id="S3.SS1.p2.1.m1.6.6.6.6.12" xref="S3.SS1.p2.1.m1.6.6.6.7.cmml">,</mo><msub id="S3.SS1.p2.1.m1.6.6.6.6.6" xref="S3.SS1.p2.1.m1.6.6.6.6.6.cmml"><mi id="S3.SS1.p2.1.m1.6.6.6.6.6.2" xref="S3.SS1.p2.1.m1.6.6.6.6.6.2.cmml">ϕ</mi><mn id="S3.SS1.p2.1.m1.6.6.6.6.6.3" xref="S3.SS1.p2.1.m1.6.6.6.6.6.3.cmml">3</mn></msub><mo id="S3.SS1.p2.1.m1.6.6.6.6.13" stretchy="false" xref="S3.SS1.p2.1.m1.6.6.6.7.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.6b"><apply id="S3.SS1.p2.1.m1.6.6.cmml" xref="S3.SS1.p2.1.m1.6.6"><eq id="S3.SS1.p2.1.m1.6.6.7.cmml" xref="S3.SS1.p2.1.m1.6.6.7"></eq><ci id="S3.SS1.p2.1.m1.6.6.8.cmml" xref="S3.SS1.p2.1.m1.6.6.8">Θ</ci><set id="S3.SS1.p2.1.m1.6.6.6.7.cmml" xref="S3.SS1.p2.1.m1.6.6.6.6"><apply id="S3.SS1.p2.1.m1.1.1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.2">𝜃</ci><cn id="S3.SS1.p2.1.m1.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS1.p2.1.m1.1.1.1.1.1.3">1</cn></apply><apply id="S3.SS1.p2.1.m1.2.2.2.2.2.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.2.2.2.2.2.1.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p2.1.m1.2.2.2.2.2.2.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.2.2">𝜃</ci><cn id="S3.SS1.p2.1.m1.2.2.2.2.2.3.cmml" type="integer" xref="S3.SS1.p2.1.m1.2.2.2.2.2.3">2</cn></apply><apply id="S3.SS1.p2.1.m1.3.3.3.3.3.cmml" xref="S3.SS1.p2.1.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.3.3.3.3.3.1.cmml" xref="S3.SS1.p2.1.m1.3.3.3.3.3">subscript</csymbol><ci id="S3.SS1.p2.1.m1.3.3.3.3.3.2.cmml" xref="S3.SS1.p2.1.m1.3.3.3.3.3.2">𝜃</ci><cn id="S3.SS1.p2.1.m1.3.3.3.3.3.3.cmml" type="integer" xref="S3.SS1.p2.1.m1.3.3.3.3.3.3">3</cn></apply><apply id="S3.SS1.p2.1.m1.4.4.4.4.4.cmml" xref="S3.SS1.p2.1.m1.4.4.4.4.4"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.4.4.4.4.4.1.cmml" xref="S3.SS1.p2.1.m1.4.4.4.4.4">subscript</csymbol><ci id="S3.SS1.p2.1.m1.4.4.4.4.4.2.cmml" xref="S3.SS1.p2.1.m1.4.4.4.4.4.2">italic-ϕ</ci><cn id="S3.SS1.p2.1.m1.4.4.4.4.4.3.cmml" type="integer" xref="S3.SS1.p2.1.m1.4.4.4.4.4.3">1</cn></apply><apply id="S3.SS1.p2.1.m1.5.5.5.5.5.cmml" xref="S3.SS1.p2.1.m1.5.5.5.5.5"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.5.5.5.5.5.1.cmml" xref="S3.SS1.p2.1.m1.5.5.5.5.5">subscript</csymbol><ci id="S3.SS1.p2.1.m1.5.5.5.5.5.2.cmml" xref="S3.SS1.p2.1.m1.5.5.5.5.5.2">italic-ϕ</ci><cn id="S3.SS1.p2.1.m1.5.5.5.5.5.3.cmml" type="integer" xref="S3.SS1.p2.1.m1.5.5.5.5.5.3">2</cn></apply><apply id="S3.SS1.p2.1.m1.6.6.6.6.6.cmml" xref="S3.SS1.p2.1.m1.6.6.6.6.6"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.6.6.6.6.6.1.cmml" xref="S3.SS1.p2.1.m1.6.6.6.6.6">subscript</csymbol><ci id="S3.SS1.p2.1.m1.6.6.6.6.6.2.cmml" xref="S3.SS1.p2.1.m1.6.6.6.6.6.2">italic-ϕ</ci><cn id="S3.SS1.p2.1.m1.6.6.6.6.6.3.cmml" type="integer" xref="S3.SS1.p2.1.m1.6.6.6.6.6.3">3</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.6c">\Theta=\{\theta_{1},\theta_{2},\theta_{3},\phi_{1},\phi_{2},\phi_{3}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.6d">roman_Θ = { italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_θ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_θ start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT , italic_ϕ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_ϕ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_ϕ start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT }</annotation></semantics></math>, where <math alttext="\phi_{1}" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.1"><semantics id="S3.SS1.p2.2.m2.1a"><msub id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml"><mi id="S3.SS1.p2.2.m2.1.1.2" xref="S3.SS1.p2.2.m2.1.1.2.cmml">ϕ</mi><mn id="S3.SS1.p2.2.m2.1.1.3" xref="S3.SS1.p2.2.m2.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><apply id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p2.2.m2.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.2">italic-ϕ</ci><cn id="S3.SS1.p2.2.m2.1.1.3.cmml" type="integer" xref="S3.SS1.p2.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">\phi_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.1d">italic_ϕ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\phi_{2}" class="ltx_Math" display="inline" id="S3.SS1.p2.3.m3.1"><semantics id="S3.SS1.p2.3.m3.1a"><msub id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml"><mi id="S3.SS1.p2.3.m3.1.1.2" xref="S3.SS1.p2.3.m3.1.1.2.cmml">ϕ</mi><mn id="S3.SS1.p2.3.m3.1.1.3" xref="S3.SS1.p2.3.m3.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><apply id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p2.3.m3.1.1.2.cmml" xref="S3.SS1.p2.3.m3.1.1.2">italic-ϕ</ci><cn id="S3.SS1.p2.3.m3.1.1.3.cmml" type="integer" xref="S3.SS1.p2.3.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">\phi_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.3.m3.1d">italic_ϕ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> project text into <math alttext="\mathbf{c}_{\text{text}}" class="ltx_Math" display="inline" id="S3.SS1.p2.4.m4.1"><semantics id="S3.SS1.p2.4.m4.1a"><msub id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml"><mi id="S3.SS1.p2.4.m4.1.1.2" xref="S3.SS1.p2.4.m4.1.1.2.cmml">𝐜</mi><mtext id="S3.SS1.p2.4.m4.1.1.3" xref="S3.SS1.p2.4.m4.1.1.3a.cmml">text</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><apply id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p2.4.m4.1.1.2.cmml" xref="S3.SS1.p2.4.m4.1.1.2">𝐜</ci><ci id="S3.SS1.p2.4.m4.1.1.3a.cmml" xref="S3.SS1.p2.4.m4.1.1.3"><mtext id="S3.SS1.p2.4.m4.1.1.3.cmml" mathsize="70%" xref="S3.SS1.p2.4.m4.1.1.3">text</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">\mathbf{c}_{\text{text}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.4.m4.1d">bold_c start_POSTSUBSCRIPT text end_POSTSUBSCRIPT</annotation></semantics></math> for the Graph DiT and GNN predictor, respectively. The graph encoder with <math alttext="\phi_{3}" class="ltx_Math" display="inline" id="S3.SS1.p2.5.m5.1"><semantics id="S3.SS1.p2.5.m5.1a"><msub id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml"><mi id="S3.SS1.p2.5.m5.1.1.2" xref="S3.SS1.p2.5.m5.1.1.2.cmml">ϕ</mi><mn id="S3.SS1.p2.5.m5.1.1.3" xref="S3.SS1.p2.5.m5.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><apply id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.1.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.p2.5.m5.1.1.2.cmml" xref="S3.SS1.p2.5.m5.1.1.2">italic-ϕ</ci><cn id="S3.SS1.p2.5.m5.1.1.3.cmml" type="integer" xref="S3.SS1.p2.5.m5.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">\phi_{3}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.5.m5.1d">italic_ϕ start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT</annotation></semantics></math> projects molecule tokens into the LLM.
Next, we detail the design space of Llamole.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Llamole Design Space</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">Llamole consists of a base LLM and two pre-trained graph modules: the Graph DiT for molecule generation and the GNN for one-step reaction prediction. The base LLM employs a trigger-query-prediction approach using two sets of special tokens to switch between modules.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.1"><span class="ltx_text ltx_font_bold" id="S3.SS2.p2.1.1">Trigger Tokens.</span>
Llamole defines two special trigger tokens to augment the word vocabulary <math alttext="\mathcal{W}" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.1"><semantics id="S3.SS2.p2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml">𝒲</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><ci id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">𝒲</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">\mathcal{W}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.1.m1.1d">caligraphic_W</annotation></semantics></math>: <span class="ltx_text ltx_font_typewriter" id="S3.SS2.p2.1.2">&lt;design&gt;</span> for switching between the LLM and Graph DiT, and <span class="ltx_text ltx_font_typewriter" id="S3.SS2.p2.1.3">&lt;retro&gt;</span> for switching between the LLM and GNN predictor. When a trigger token is predicted, Llamole activates the corresponding graph model. After molecule generation or reaction prediction, the active modules revert to the LLM.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.6"><span class="ltx_text ltx_font_bold" id="S3.SS2.p3.6.1">Query Tokens.</span>
We introduce another set of special tokens, named query tokens <span class="ltx_text ltx_font_typewriter" id="S3.SS2.p3.6.2">&lt;query&gt;</span> automatically placed after triggers. They use the LLM to query previous tokens and output hidden states as <math alttext="\mathbf{c}_{\text{hidden}}" class="ltx_Math" display="inline" id="S3.SS2.p3.1.m1.1"><semantics id="S3.SS2.p3.1.m1.1a"><msub id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml"><mi id="S3.SS2.p3.1.m1.1.1.2" xref="S3.SS2.p3.1.m1.1.1.2.cmml">𝐜</mi><mtext id="S3.SS2.p3.1.m1.1.1.3" xref="S3.SS2.p3.1.m1.1.1.3a.cmml">hidden</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><apply id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p3.1.m1.1.1.2.cmml" xref="S3.SS2.p3.1.m1.1.1.2">𝐜</ci><ci id="S3.SS2.p3.1.m1.1.1.3a.cmml" xref="S3.SS2.p3.1.m1.1.1.3"><mtext id="S3.SS2.p3.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS2.p3.1.m1.1.1.3">hidden</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">\mathbf{c}_{\text{hidden}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.1.m1.1d">bold_c start_POSTSUBSCRIPT hidden end_POSTSUBSCRIPT</annotation></semantics></math>. A linear layer is applied: <math alttext="\mathbf{c}_{\text{text}}=\operatorname{Linear}(\mathbf{c}_{\text{hidden}})" class="ltx_Math" display="inline" id="S3.SS2.p3.2.m2.2"><semantics id="S3.SS2.p3.2.m2.2a"><mrow id="S3.SS2.p3.2.m2.2.2" xref="S3.SS2.p3.2.m2.2.2.cmml"><msub id="S3.SS2.p3.2.m2.2.2.3" xref="S3.SS2.p3.2.m2.2.2.3.cmml"><mi id="S3.SS2.p3.2.m2.2.2.3.2" xref="S3.SS2.p3.2.m2.2.2.3.2.cmml">𝐜</mi><mtext id="S3.SS2.p3.2.m2.2.2.3.3" xref="S3.SS2.p3.2.m2.2.2.3.3a.cmml">text</mtext></msub><mo id="S3.SS2.p3.2.m2.2.2.2" xref="S3.SS2.p3.2.m2.2.2.2.cmml">=</mo><mrow id="S3.SS2.p3.2.m2.2.2.1.1" xref="S3.SS2.p3.2.m2.2.2.1.2.cmml"><mi id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml">Linear</mi><mo id="S3.SS2.p3.2.m2.2.2.1.1a" xref="S3.SS2.p3.2.m2.2.2.1.2.cmml">⁡</mo><mrow id="S3.SS2.p3.2.m2.2.2.1.1.1" xref="S3.SS2.p3.2.m2.2.2.1.2.cmml"><mo id="S3.SS2.p3.2.m2.2.2.1.1.1.2" stretchy="false" xref="S3.SS2.p3.2.m2.2.2.1.2.cmml">(</mo><msub id="S3.SS2.p3.2.m2.2.2.1.1.1.1" xref="S3.SS2.p3.2.m2.2.2.1.1.1.1.cmml"><mi id="S3.SS2.p3.2.m2.2.2.1.1.1.1.2" xref="S3.SS2.p3.2.m2.2.2.1.1.1.1.2.cmml">𝐜</mi><mtext id="S3.SS2.p3.2.m2.2.2.1.1.1.1.3" xref="S3.SS2.p3.2.m2.2.2.1.1.1.1.3a.cmml">hidden</mtext></msub><mo id="S3.SS2.p3.2.m2.2.2.1.1.1.3" stretchy="false" xref="S3.SS2.p3.2.m2.2.2.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.2b"><apply id="S3.SS2.p3.2.m2.2.2.cmml" xref="S3.SS2.p3.2.m2.2.2"><eq id="S3.SS2.p3.2.m2.2.2.2.cmml" xref="S3.SS2.p3.2.m2.2.2.2"></eq><apply id="S3.SS2.p3.2.m2.2.2.3.cmml" xref="S3.SS2.p3.2.m2.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.2.2.3.1.cmml" xref="S3.SS2.p3.2.m2.2.2.3">subscript</csymbol><ci id="S3.SS2.p3.2.m2.2.2.3.2.cmml" xref="S3.SS2.p3.2.m2.2.2.3.2">𝐜</ci><ci id="S3.SS2.p3.2.m2.2.2.3.3a.cmml" xref="S3.SS2.p3.2.m2.2.2.3.3"><mtext id="S3.SS2.p3.2.m2.2.2.3.3.cmml" mathsize="70%" xref="S3.SS2.p3.2.m2.2.2.3.3">text</mtext></ci></apply><apply id="S3.SS2.p3.2.m2.2.2.1.2.cmml" xref="S3.SS2.p3.2.m2.2.2.1.1"><ci id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1">Linear</ci><apply id="S3.SS2.p3.2.m2.2.2.1.1.1.1.cmml" xref="S3.SS2.p3.2.m2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.2.2.1.1.1.1.1.cmml" xref="S3.SS2.p3.2.m2.2.2.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p3.2.m2.2.2.1.1.1.1.2.cmml" xref="S3.SS2.p3.2.m2.2.2.1.1.1.1.2">𝐜</ci><ci id="S3.SS2.p3.2.m2.2.2.1.1.1.1.3a.cmml" xref="S3.SS2.p3.2.m2.2.2.1.1.1.1.3"><mtext id="S3.SS2.p3.2.m2.2.2.1.1.1.1.3.cmml" mathsize="70%" xref="S3.SS2.p3.2.m2.2.2.1.1.1.1.3">hidden</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.2c">\mathbf{c}_{\text{text}}=\operatorname{Linear}(\mathbf{c}_{\text{hidden}})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.2.m2.2d">bold_c start_POSTSUBSCRIPT text end_POSTSUBSCRIPT = roman_Linear ( bold_c start_POSTSUBSCRIPT hidden end_POSTSUBSCRIPT )</annotation></semantics></math>, adjusting the input size for the graph models. We use different query tokens for different triggers. Query tokens allow us to share parameters <math alttext="\phi_{1}" class="ltx_Math" display="inline" id="S3.SS2.p3.3.m3.1"><semantics id="S3.SS2.p3.3.m3.1a"><msub id="S3.SS2.p3.3.m3.1.1" xref="S3.SS2.p3.3.m3.1.1.cmml"><mi id="S3.SS2.p3.3.m3.1.1.2" xref="S3.SS2.p3.3.m3.1.1.2.cmml">ϕ</mi><mn id="S3.SS2.p3.3.m3.1.1.3" xref="S3.SS2.p3.3.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.1b"><apply id="S3.SS2.p3.3.m3.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.1.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p3.3.m3.1.1.2.cmml" xref="S3.SS2.p3.3.m3.1.1.2">italic-ϕ</ci><cn id="S3.SS2.p3.3.m3.1.1.3.cmml" type="integer" xref="S3.SS2.p3.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.1c">\phi_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.3.m3.1d">italic_ϕ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\phi_{2}" class="ltx_Math" display="inline" id="S3.SS2.p3.4.m4.1"><semantics id="S3.SS2.p3.4.m4.1a"><msub id="S3.SS2.p3.4.m4.1.1" xref="S3.SS2.p3.4.m4.1.1.cmml"><mi id="S3.SS2.p3.4.m4.1.1.2" xref="S3.SS2.p3.4.m4.1.1.2.cmml">ϕ</mi><mn id="S3.SS2.p3.4.m4.1.1.3" xref="S3.SS2.p3.4.m4.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.4.m4.1b"><apply id="S3.SS2.p3.4.m4.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.1.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p3.4.m4.1.1.2.cmml" xref="S3.SS2.p3.4.m4.1.1.2">italic-ϕ</ci><cn id="S3.SS2.p3.4.m4.1.1.3.cmml" type="integer" xref="S3.SS2.p3.4.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.4.m4.1c">\phi_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.4.m4.1d">italic_ϕ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> with <math alttext="\theta_{1}" class="ltx_Math" display="inline" id="S3.SS2.p3.5.m5.1"><semantics id="S3.SS2.p3.5.m5.1a"><msub id="S3.SS2.p3.5.m5.1.1" xref="S3.SS2.p3.5.m5.1.1.cmml"><mi id="S3.SS2.p3.5.m5.1.1.2" xref="S3.SS2.p3.5.m5.1.1.2.cmml">θ</mi><mn id="S3.SS2.p3.5.m5.1.1.3" xref="S3.SS2.p3.5.m5.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.5.m5.1b"><apply id="S3.SS2.p3.5.m5.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.5.m5.1.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.p3.5.m5.1.1.2.cmml" xref="S3.SS2.p3.5.m5.1.1.2">𝜃</ci><cn id="S3.SS2.p3.5.m5.1.1.3.cmml" type="integer" xref="S3.SS2.p3.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.5.m5.1c">\theta_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.5.m5.1d">italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>, enhancing both efficiency and effectiveness. We can apply ensemble methods by repeating the query tokens multiple times and averaging the <math alttext="\mathbf{c}_{\text{hidden}}" class="ltx_Math" display="inline" id="S3.SS2.p3.6.m6.1"><semantics id="S3.SS2.p3.6.m6.1a"><msub id="S3.SS2.p3.6.m6.1.1" xref="S3.SS2.p3.6.m6.1.1.cmml"><mi id="S3.SS2.p3.6.m6.1.1.2" xref="S3.SS2.p3.6.m6.1.1.2.cmml">𝐜</mi><mtext id="S3.SS2.p3.6.m6.1.1.3" xref="S3.SS2.p3.6.m6.1.1.3a.cmml">hidden</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.6.m6.1b"><apply id="S3.SS2.p3.6.m6.1.1.cmml" xref="S3.SS2.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.6.m6.1.1.1.cmml" xref="S3.SS2.p3.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.p3.6.m6.1.1.2.cmml" xref="S3.SS2.p3.6.m6.1.1.2">𝐜</ci><ci id="S3.SS2.p3.6.m6.1.1.3a.cmml" xref="S3.SS2.p3.6.m6.1.1.3"><mtext id="S3.SS2.p3.6.m6.1.1.3.cmml" mathsize="70%" xref="S3.SS2.p3.6.m6.1.1.3">hidden</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.6.m6.1c">\mathbf{c}_{\text{hidden}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.6.m6.1d">bold_c start_POSTSUBSCRIPT hidden end_POSTSUBSCRIPT</annotation></semantics></math> values&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Dong et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib9" title="">2023</a>)</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p4">
<p class="ltx_p" id="S3.SS2.p4.1">Besides the special tokens, Llamole enhances molecule understanding with a graph encoder and uses the LLM to provide the cost function in A* search for retrosynthetic planning.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p5">
<p class="ltx_p" id="S3.SS2.p5.1"><span class="ltx_text ltx_font_bold" id="S3.SS2.p5.1.1">Graph Encoder.</span>
The graph encoder parameterized by <math alttext="\phi_{3}" class="ltx_Math" display="inline" id="S3.SS2.p5.1.m1.1"><semantics id="S3.SS2.p5.1.m1.1a"><msub id="S3.SS2.p5.1.m1.1.1" xref="S3.SS2.p5.1.m1.1.1.cmml"><mi id="S3.SS2.p5.1.m1.1.1.2" xref="S3.SS2.p5.1.m1.1.1.2.cmml">ϕ</mi><mn id="S3.SS2.p5.1.m1.1.1.3" xref="S3.SS2.p5.1.m1.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.1.m1.1b"><apply id="S3.SS2.p5.1.m1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.1.m1.1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p5.1.m1.1.1.2.cmml" xref="S3.SS2.p5.1.m1.1.1.2">italic-ϕ</ci><cn id="S3.SS2.p5.1.m1.1.1.3.cmml" type="integer" xref="S3.SS2.p5.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.1.m1.1c">\phi_{3}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.1.m1.1d">italic_ϕ start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT</annotation></semantics></math> replaces the word encoder in the LLM tokenizer for molecule tokens. The LLM decoder takes molecule embeddings from the graph encoder, along with text embeddings from the tokenizer, into the Transformer layers for next token generation. We use a pre-trained Graph Isomorphism Network (GIN)&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Xu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib44" title="">2018</a>)</cite> as the graph encoder, optimized via molecule-text contrastive learning similar to CLIP&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Radford et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib33" title="">2021</a>)</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p6">
<p class="ltx_p" id="S3.SS2.p6.6"><span class="ltx_text ltx_font_bold" id="S3.SS2.p6.6.1">A* Cost Function with LLM.</span>
We define <math alttext="J_{\text{heuristic}}" class="ltx_Math" display="inline" id="S3.SS2.p6.1.m1.1"><semantics id="S3.SS2.p6.1.m1.1a"><msub id="S3.SS2.p6.1.m1.1.1" xref="S3.SS2.p6.1.m1.1.1.cmml"><mi id="S3.SS2.p6.1.m1.1.1.2" xref="S3.SS2.p6.1.m1.1.1.2.cmml">J</mi><mtext id="S3.SS2.p6.1.m1.1.1.3" xref="S3.SS2.p6.1.m1.1.1.3a.cmml">heuristic</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.1.m1.1b"><apply id="S3.SS2.p6.1.m1.1.1.cmml" xref="S3.SS2.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p6.1.m1.1.1.1.cmml" xref="S3.SS2.p6.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p6.1.m1.1.1.2.cmml" xref="S3.SS2.p6.1.m1.1.1.2">𝐽</ci><ci id="S3.SS2.p6.1.m1.1.1.3a.cmml" xref="S3.SS2.p6.1.m1.1.1.3"><mtext id="S3.SS2.p6.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS2.p6.1.m1.1.1.3">heuristic</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.1.m1.1c">J_{\text{heuristic}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p6.1.m1.1d">italic_J start_POSTSUBSCRIPT heuristic end_POSTSUBSCRIPT</annotation></semantics></math> as a multi-choice problem, where each choice, assigned a score, represents synthesis complexity, from few to many steps. The LLM estimates the remaining synthesis steps for the leaf molecule node <math alttext="G\in\mathcal{F}(\mathcal{T})\setminus\mathcal{G}_{\text{avail}}" class="ltx_Math" display="inline" id="S3.SS2.p6.2.m2.1"><semantics id="S3.SS2.p6.2.m2.1a"><mrow id="S3.SS2.p6.2.m2.1.2" xref="S3.SS2.p6.2.m2.1.2.cmml"><mi id="S3.SS2.p6.2.m2.1.2.2" xref="S3.SS2.p6.2.m2.1.2.2.cmml">G</mi><mo id="S3.SS2.p6.2.m2.1.2.1" xref="S3.SS2.p6.2.m2.1.2.1.cmml">∈</mo><mrow id="S3.SS2.p6.2.m2.1.2.3" xref="S3.SS2.p6.2.m2.1.2.3.cmml"><mrow id="S3.SS2.p6.2.m2.1.2.3.2" xref="S3.SS2.p6.2.m2.1.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p6.2.m2.1.2.3.2.2" xref="S3.SS2.p6.2.m2.1.2.3.2.2.cmml">ℱ</mi><mo id="S3.SS2.p6.2.m2.1.2.3.2.1" xref="S3.SS2.p6.2.m2.1.2.3.2.1.cmml">⁢</mo><mrow id="S3.SS2.p6.2.m2.1.2.3.2.3.2" xref="S3.SS2.p6.2.m2.1.2.3.2.cmml"><mo id="S3.SS2.p6.2.m2.1.2.3.2.3.2.1" stretchy="false" xref="S3.SS2.p6.2.m2.1.2.3.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p6.2.m2.1.1" xref="S3.SS2.p6.2.m2.1.1.cmml">𝒯</mi><mo id="S3.SS2.p6.2.m2.1.2.3.2.3.2.2" stretchy="false" xref="S3.SS2.p6.2.m2.1.2.3.2.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p6.2.m2.1.2.3.1" xref="S3.SS2.p6.2.m2.1.2.3.1.cmml">∖</mo><msub id="S3.SS2.p6.2.m2.1.2.3.3" xref="S3.SS2.p6.2.m2.1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p6.2.m2.1.2.3.3.2" xref="S3.SS2.p6.2.m2.1.2.3.3.2.cmml">𝒢</mi><mtext id="S3.SS2.p6.2.m2.1.2.3.3.3" xref="S3.SS2.p6.2.m2.1.2.3.3.3a.cmml">avail</mtext></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.2.m2.1b"><apply id="S3.SS2.p6.2.m2.1.2.cmml" xref="S3.SS2.p6.2.m2.1.2"><in id="S3.SS2.p6.2.m2.1.2.1.cmml" xref="S3.SS2.p6.2.m2.1.2.1"></in><ci id="S3.SS2.p6.2.m2.1.2.2.cmml" xref="S3.SS2.p6.2.m2.1.2.2">𝐺</ci><apply id="S3.SS2.p6.2.m2.1.2.3.cmml" xref="S3.SS2.p6.2.m2.1.2.3"><setdiff id="S3.SS2.p6.2.m2.1.2.3.1.cmml" xref="S3.SS2.p6.2.m2.1.2.3.1"></setdiff><apply id="S3.SS2.p6.2.m2.1.2.3.2.cmml" xref="S3.SS2.p6.2.m2.1.2.3.2"><times id="S3.SS2.p6.2.m2.1.2.3.2.1.cmml" xref="S3.SS2.p6.2.m2.1.2.3.2.1"></times><ci id="S3.SS2.p6.2.m2.1.2.3.2.2.cmml" xref="S3.SS2.p6.2.m2.1.2.3.2.2">ℱ</ci><ci id="S3.SS2.p6.2.m2.1.1.cmml" xref="S3.SS2.p6.2.m2.1.1">𝒯</ci></apply><apply id="S3.SS2.p6.2.m2.1.2.3.3.cmml" xref="S3.SS2.p6.2.m2.1.2.3.3"><csymbol cd="ambiguous" id="S3.SS2.p6.2.m2.1.2.3.3.1.cmml" xref="S3.SS2.p6.2.m2.1.2.3.3">subscript</csymbol><ci id="S3.SS2.p6.2.m2.1.2.3.3.2.cmml" xref="S3.SS2.p6.2.m2.1.2.3.3.2">𝒢</ci><ci id="S3.SS2.p6.2.m2.1.2.3.3.3a.cmml" xref="S3.SS2.p6.2.m2.1.2.3.3.3"><mtext id="S3.SS2.p6.2.m2.1.2.3.3.3.cmml" mathsize="70%" xref="S3.SS2.p6.2.m2.1.2.3.3.3">avail</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.2.m2.1c">G\in\mathcal{F}(\mathcal{T})\setminus\mathcal{G}_{\text{avail}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p6.2.m2.1d">italic_G ∈ caligraphic_F ( caligraphic_T ) ∖ caligraphic_G start_POSTSUBSCRIPT avail end_POSTSUBSCRIPT</annotation></semantics></math> in the search tree <math alttext="\mathcal{T}" class="ltx_Math" display="inline" id="S3.SS2.p6.3.m3.1"><semantics id="S3.SS2.p6.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p6.3.m3.1.1" xref="S3.SS2.p6.3.m3.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.3.m3.1b"><ci id="S3.SS2.p6.3.m3.1.1.cmml" xref="S3.SS2.p6.3.m3.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.3.m3.1c">\mathcal{T}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p6.3.m3.1d">caligraphic_T</annotation></semantics></math>. It outputs probabilities for each choice, and <math alttext="J_{\text{heuristic}}" class="ltx_Math" display="inline" id="S3.SS2.p6.4.m4.1"><semantics id="S3.SS2.p6.4.m4.1a"><msub id="S3.SS2.p6.4.m4.1.1" xref="S3.SS2.p6.4.m4.1.1.cmml"><mi id="S3.SS2.p6.4.m4.1.1.2" xref="S3.SS2.p6.4.m4.1.1.2.cmml">J</mi><mtext id="S3.SS2.p6.4.m4.1.1.3" xref="S3.SS2.p6.4.m4.1.1.3a.cmml">heuristic</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.4.m4.1b"><apply id="S3.SS2.p6.4.m4.1.1.cmml" xref="S3.SS2.p6.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p6.4.m4.1.1.1.cmml" xref="S3.SS2.p6.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p6.4.m4.1.1.2.cmml" xref="S3.SS2.p6.4.m4.1.1.2">𝐽</ci><ci id="S3.SS2.p6.4.m4.1.1.3a.cmml" xref="S3.SS2.p6.4.m4.1.1.3"><mtext id="S3.SS2.p6.4.m4.1.1.3.cmml" mathsize="70%" xref="S3.SS2.p6.4.m4.1.1.3">heuristic</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.4.m4.1c">J_{\text{heuristic}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p6.4.m4.1d">italic_J start_POSTSUBSCRIPT heuristic end_POSTSUBSCRIPT</annotation></semantics></math> is computed as the weighted score by averaging the scores with their probabilities. For <math alttext="G\in\mathcal{F}(\mathcal{T})\cap\mathcal{G}_{\text{avail}}" class="ltx_Math" display="inline" id="S3.SS2.p6.5.m5.1"><semantics id="S3.SS2.p6.5.m5.1a"><mrow id="S3.SS2.p6.5.m5.1.2" xref="S3.SS2.p6.5.m5.1.2.cmml"><mi id="S3.SS2.p6.5.m5.1.2.2" xref="S3.SS2.p6.5.m5.1.2.2.cmml">G</mi><mo id="S3.SS2.p6.5.m5.1.2.1" xref="S3.SS2.p6.5.m5.1.2.1.cmml">∈</mo><mrow id="S3.SS2.p6.5.m5.1.2.3" xref="S3.SS2.p6.5.m5.1.2.3.cmml"><mrow id="S3.SS2.p6.5.m5.1.2.3.2" xref="S3.SS2.p6.5.m5.1.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p6.5.m5.1.2.3.2.2" xref="S3.SS2.p6.5.m5.1.2.3.2.2.cmml">ℱ</mi><mo id="S3.SS2.p6.5.m5.1.2.3.2.1" xref="S3.SS2.p6.5.m5.1.2.3.2.1.cmml">⁢</mo><mrow id="S3.SS2.p6.5.m5.1.2.3.2.3.2" xref="S3.SS2.p6.5.m5.1.2.3.2.cmml"><mo id="S3.SS2.p6.5.m5.1.2.3.2.3.2.1" stretchy="false" xref="S3.SS2.p6.5.m5.1.2.3.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p6.5.m5.1.1" xref="S3.SS2.p6.5.m5.1.1.cmml">𝒯</mi><mo id="S3.SS2.p6.5.m5.1.2.3.2.3.2.2" stretchy="false" xref="S3.SS2.p6.5.m5.1.2.3.2.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p6.5.m5.1.2.3.1" xref="S3.SS2.p6.5.m5.1.2.3.1.cmml">∩</mo><msub id="S3.SS2.p6.5.m5.1.2.3.3" xref="S3.SS2.p6.5.m5.1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p6.5.m5.1.2.3.3.2" xref="S3.SS2.p6.5.m5.1.2.3.3.2.cmml">𝒢</mi><mtext id="S3.SS2.p6.5.m5.1.2.3.3.3" xref="S3.SS2.p6.5.m5.1.2.3.3.3a.cmml">avail</mtext></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.5.m5.1b"><apply id="S3.SS2.p6.5.m5.1.2.cmml" xref="S3.SS2.p6.5.m5.1.2"><in id="S3.SS2.p6.5.m5.1.2.1.cmml" xref="S3.SS2.p6.5.m5.1.2.1"></in><ci id="S3.SS2.p6.5.m5.1.2.2.cmml" xref="S3.SS2.p6.5.m5.1.2.2">𝐺</ci><apply id="S3.SS2.p6.5.m5.1.2.3.cmml" xref="S3.SS2.p6.5.m5.1.2.3"><intersect id="S3.SS2.p6.5.m5.1.2.3.1.cmml" xref="S3.SS2.p6.5.m5.1.2.3.1"></intersect><apply id="S3.SS2.p6.5.m5.1.2.3.2.cmml" xref="S3.SS2.p6.5.m5.1.2.3.2"><times id="S3.SS2.p6.5.m5.1.2.3.2.1.cmml" xref="S3.SS2.p6.5.m5.1.2.3.2.1"></times><ci id="S3.SS2.p6.5.m5.1.2.3.2.2.cmml" xref="S3.SS2.p6.5.m5.1.2.3.2.2">ℱ</ci><ci id="S3.SS2.p6.5.m5.1.1.cmml" xref="S3.SS2.p6.5.m5.1.1">𝒯</ci></apply><apply id="S3.SS2.p6.5.m5.1.2.3.3.cmml" xref="S3.SS2.p6.5.m5.1.2.3.3"><csymbol cd="ambiguous" id="S3.SS2.p6.5.m5.1.2.3.3.1.cmml" xref="S3.SS2.p6.5.m5.1.2.3.3">subscript</csymbol><ci id="S3.SS2.p6.5.m5.1.2.3.3.2.cmml" xref="S3.SS2.p6.5.m5.1.2.3.3.2">𝒢</ci><ci id="S3.SS2.p6.5.m5.1.2.3.3.3a.cmml" xref="S3.SS2.p6.5.m5.1.2.3.3.3"><mtext id="S3.SS2.p6.5.m5.1.2.3.3.3.cmml" mathsize="70%" xref="S3.SS2.p6.5.m5.1.2.3.3.3">avail</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.5.m5.1c">G\in\mathcal{F}(\mathcal{T})\cap\mathcal{G}_{\text{avail}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p6.5.m5.1d">italic_G ∈ caligraphic_F ( caligraphic_T ) ∩ caligraphic_G start_POSTSUBSCRIPT avail end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="J_{\text{heuristic}}=0" class="ltx_Math" display="inline" id="S3.SS2.p6.6.m6.1"><semantics id="S3.SS2.p6.6.m6.1a"><mrow id="S3.SS2.p6.6.m6.1.1" xref="S3.SS2.p6.6.m6.1.1.cmml"><msub id="S3.SS2.p6.6.m6.1.1.2" xref="S3.SS2.p6.6.m6.1.1.2.cmml"><mi id="S3.SS2.p6.6.m6.1.1.2.2" xref="S3.SS2.p6.6.m6.1.1.2.2.cmml">J</mi><mtext id="S3.SS2.p6.6.m6.1.1.2.3" xref="S3.SS2.p6.6.m6.1.1.2.3a.cmml">heuristic</mtext></msub><mo id="S3.SS2.p6.6.m6.1.1.1" xref="S3.SS2.p6.6.m6.1.1.1.cmml">=</mo><mn id="S3.SS2.p6.6.m6.1.1.3" xref="S3.SS2.p6.6.m6.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.6.m6.1b"><apply id="S3.SS2.p6.6.m6.1.1.cmml" xref="S3.SS2.p6.6.m6.1.1"><eq id="S3.SS2.p6.6.m6.1.1.1.cmml" xref="S3.SS2.p6.6.m6.1.1.1"></eq><apply id="S3.SS2.p6.6.m6.1.1.2.cmml" xref="S3.SS2.p6.6.m6.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p6.6.m6.1.1.2.1.cmml" xref="S3.SS2.p6.6.m6.1.1.2">subscript</csymbol><ci id="S3.SS2.p6.6.m6.1.1.2.2.cmml" xref="S3.SS2.p6.6.m6.1.1.2.2">𝐽</ci><ci id="S3.SS2.p6.6.m6.1.1.2.3a.cmml" xref="S3.SS2.p6.6.m6.1.1.2.3"><mtext id="S3.SS2.p6.6.m6.1.1.2.3.cmml" mathsize="70%" xref="S3.SS2.p6.6.m6.1.1.2.3">heuristic</mtext></ci></apply><cn id="S3.SS2.p6.6.m6.1.1.3.cmml" type="integer" xref="S3.SS2.p6.6.m6.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.6.m6.1c">J_{\text{heuristic}}=0</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p6.6.m6.1d">italic_J start_POSTSUBSCRIPT heuristic end_POSTSUBSCRIPT = 0</annotation></semantics></math>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>End-to-End Model Fine-Tuning and Generation</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.6"><span class="ltx_text ltx_font_bold" id="S3.SS3.p1.6.1">Supervised Fine-Tuning.</span>
We use multimodal SFT to connect the base LLM and other graph modules in Llamole&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Ouyang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib32" title="">2022</a>)</cite>. Specifically, we freeze the parameters for the graph modules (<math alttext="\theta_{2}" class="ltx_Math" display="inline" id="S3.SS3.p1.1.m1.1"><semantics id="S3.SS3.p1.1.m1.1a"><msub id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml"><mi id="S3.SS3.p1.1.m1.1.1.2" xref="S3.SS3.p1.1.m1.1.1.2.cmml">θ</mi><mn id="S3.SS3.p1.1.m1.1.1.3" xref="S3.SS3.p1.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><apply id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p1.1.m1.1.1.2.cmml" xref="S3.SS3.p1.1.m1.1.1.2">𝜃</ci><cn id="S3.SS3.p1.1.m1.1.1.3.cmml" type="integer" xref="S3.SS3.p1.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">\theta_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.1.m1.1d">italic_θ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\theta_{3}" class="ltx_Math" display="inline" id="S3.SS3.p1.2.m2.1"><semantics id="S3.SS3.p1.2.m2.1a"><msub id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml"><mi id="S3.SS3.p1.2.m2.1.1.2" xref="S3.SS3.p1.2.m2.1.1.2.cmml">θ</mi><mn id="S3.SS3.p1.2.m2.1.1.3" xref="S3.SS3.p1.2.m2.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><apply id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.1.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p1.2.m2.1.1.2.cmml" xref="S3.SS3.p1.2.m2.1.1.2">𝜃</ci><cn id="S3.SS3.p1.2.m2.1.1.3.cmml" type="integer" xref="S3.SS3.p1.2.m2.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">\theta_{3}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.2.m2.1d">italic_θ start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT</annotation></semantics></math>) and fine-tune the LLM parameters <math alttext="\theta_{1}" class="ltx_Math" display="inline" id="S3.SS3.p1.3.m3.1"><semantics id="S3.SS3.p1.3.m3.1a"><msub id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml"><mi id="S3.SS3.p1.3.m3.1.1.2" xref="S3.SS3.p1.3.m3.1.1.2.cmml">θ</mi><mn id="S3.SS3.p1.3.m3.1.1.3" xref="S3.SS3.p1.3.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><apply id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.3.m3.1.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p1.3.m3.1.1.2.cmml" xref="S3.SS3.p1.3.m3.1.1.2">𝜃</ci><cn id="S3.SS3.p1.3.m3.1.1.3.cmml" type="integer" xref="S3.SS3.p1.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">\theta_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.3.m3.1d">italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>, the learnable special tokens, and the linear layers for the query tokens (<math alttext="\phi_{1}" class="ltx_Math" display="inline" id="S3.SS3.p1.4.m4.1"><semantics id="S3.SS3.p1.4.m4.1a"><msub id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml"><mi id="S3.SS3.p1.4.m4.1.1.2" xref="S3.SS3.p1.4.m4.1.1.2.cmml">ϕ</mi><mn id="S3.SS3.p1.4.m4.1.1.3" xref="S3.SS3.p1.4.m4.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b"><apply id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m4.1.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.p1.4.m4.1.1.2.cmml" xref="S3.SS3.p1.4.m4.1.1.2">italic-ϕ</ci><cn id="S3.SS3.p1.4.m4.1.1.3.cmml" type="integer" xref="S3.SS3.p1.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">\phi_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.4.m4.1d">italic_ϕ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\phi_{2}" class="ltx_Math" display="inline" id="S3.SS3.p1.5.m5.1"><semantics id="S3.SS3.p1.5.m5.1a"><msub id="S3.SS3.p1.5.m5.1.1" xref="S3.SS3.p1.5.m5.1.1.cmml"><mi id="S3.SS3.p1.5.m5.1.1.2" xref="S3.SS3.p1.5.m5.1.1.2.cmml">ϕ</mi><mn id="S3.SS3.p1.5.m5.1.1.3" xref="S3.SS3.p1.5.m5.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m5.1b"><apply id="S3.SS3.p1.5.m5.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.1.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS3.p1.5.m5.1.1.2.cmml" xref="S3.SS3.p1.5.m5.1.1.2">italic-ϕ</ci><cn id="S3.SS3.p1.5.m5.1.1.3.cmml" type="integer" xref="S3.SS3.p1.5.m5.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m5.1c">\phi_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.5.m5.1d">italic_ϕ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>). We freeze the parameters of the pre-trained graph encoder (<math alttext="\phi_{3}" class="ltx_Math" display="inline" id="S3.SS3.p1.6.m6.1"><semantics id="S3.SS3.p1.6.m6.1a"><msub id="S3.SS3.p1.6.m6.1.1" xref="S3.SS3.p1.6.m6.1.1.cmml"><mi id="S3.SS3.p1.6.m6.1.1.2" xref="S3.SS3.p1.6.m6.1.1.2.cmml">ϕ</mi><mn id="S3.SS3.p1.6.m6.1.1.3" xref="S3.SS3.p1.6.m6.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.6.m6.1b"><apply id="S3.SS3.p1.6.m6.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.6.m6.1.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS3.p1.6.m6.1.1.2.cmml" xref="S3.SS3.p1.6.m6.1.1.2">italic-ϕ</ci><cn id="S3.SS3.p1.6.m6.1.1.3.cmml" type="integer" xref="S3.SS3.p1.6.m6.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.6.m6.1c">\phi_{3}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.6.m6.1d">italic_ϕ start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT</annotation></semantics></math>) and add a tunable linear layer between it and the LLM decoder. The optimization can be conducted end-to-end with&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S3.E4" title="In 3.1 Multimodal Autoregressive Modeling ‣ 3 Llamole: Multimodal Large Language Model for Molecular Discovery ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Eq.</span>&nbsp;<span class="ltx_text ltx_ref_tag">4</span></a>. The SFT aligns the LLM with domain-specific graph models. To maintain generality in the base LLM, we employ parameter-efficient LoRA&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Hu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib16" title="">2021</a>)</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.8"><span class="ltx_text ltx_font_bold" id="S3.SS3.p2.8.1">Interleaved Generation.</span>
Given a question as shown in&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S1.F2" title="In 1 Introduction ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Figure</span>&nbsp;<span class="ltx_text ltx_ref_tag">2</span></a>, Llamole performs controllable and synthesizable molecular designs, as presented in&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S3.F3" title="In 3 Llamole: Multimodal Large Language Model for Molecular Discovery ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Figure</span>&nbsp;<span class="ltx_text ltx_ref_tag">3</span></a>. For the controllable generation, Llamole uses the base LLM to analyze the requirements and switches to the Graph DiT for generating <math alttext="G_{\text{target}}" class="ltx_Math" display="inline" id="S3.SS3.p2.1.m1.1"><semantics id="S3.SS3.p2.1.m1.1a"><msub id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml"><mi id="S3.SS3.p2.1.m1.1.1.2" xref="S3.SS3.p2.1.m1.1.1.2.cmml">G</mi><mtext id="S3.SS3.p2.1.m1.1.1.3" xref="S3.SS3.p2.1.m1.1.1.3a.cmml">target</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><apply id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p2.1.m1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.1.2">𝐺</ci><ci id="S3.SS3.p2.1.m1.1.1.3a.cmml" xref="S3.SS3.p2.1.m1.1.1.3"><mtext id="S3.SS3.p2.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS3.p2.1.m1.1.1.3">target</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">G_{\text{target}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.1.m1.1d">italic_G start_POSTSUBSCRIPT target end_POSTSUBSCRIPT</annotation></semantics></math> when the trigger is predicted. For the synthesizable generation, Llamole plans synthesis routes for <math alttext="G_{\text{target}}" class="ltx_Math" display="inline" id="S3.SS3.p2.2.m2.1"><semantics id="S3.SS3.p2.2.m2.1a"><msub id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml"><mi id="S3.SS3.p2.2.m2.1.1.2" xref="S3.SS3.p2.2.m2.1.1.2.cmml">G</mi><mtext id="S3.SS3.p2.2.m2.1.1.3" xref="S3.SS3.p2.2.m2.1.1.3a.cmml">target</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><apply id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p2.2.m2.1.1.2.cmml" xref="S3.SS3.p2.2.m2.1.1.2">𝐺</ci><ci id="S3.SS3.p2.2.m2.1.1.3a.cmml" xref="S3.SS3.p2.2.m2.1.1.3"><mtext id="S3.SS3.p2.2.m2.1.1.3.cmml" mathsize="70%" xref="S3.SS3.p2.2.m2.1.1.3">target</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">G_{\text{target}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.2.m2.1d">italic_G start_POSTSUBSCRIPT target end_POSTSUBSCRIPT</annotation></semantics></math>.
A* search on the AND-OR tree <math alttext="\mathcal{T}" class="ltx_Math" display="inline" id="S3.SS3.p2.3.m3.1"><semantics id="S3.SS3.p2.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><ci id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">\mathcal{T}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.3.m3.1d">caligraphic_T</annotation></semantics></math> aids in multi-step generation, interleaving molecule and reaction nodes, with <math alttext="G_{\text{target}}" class="ltx_Math" display="inline" id="S3.SS3.p2.4.m4.1"><semantics id="S3.SS3.p2.4.m4.1a"><msub id="S3.SS3.p2.4.m4.1.1" xref="S3.SS3.p2.4.m4.1.1.cmml"><mi id="S3.SS3.p2.4.m4.1.1.2" xref="S3.SS3.p2.4.m4.1.1.2.cmml">G</mi><mtext id="S3.SS3.p2.4.m4.1.1.3" xref="S3.SS3.p2.4.m4.1.1.3a.cmml">target</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.1b"><apply id="S3.SS3.p2.4.m4.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m4.1.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.p2.4.m4.1.1.2.cmml" xref="S3.SS3.p2.4.m4.1.1.2">𝐺</ci><ci id="S3.SS3.p2.4.m4.1.1.3a.cmml" xref="S3.SS3.p2.4.m4.1.1.3"><mtext id="S3.SS3.p2.4.m4.1.1.3.cmml" mathsize="70%" xref="S3.SS3.p2.4.m4.1.1.3">target</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.1c">G_{\text{target}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.4.m4.1d">italic_G start_POSTSUBSCRIPT target end_POSTSUBSCRIPT</annotation></semantics></math> as the root. During each selection-expansion iteration, A* selects <math alttext="G_{\text{next}}=\arg\min_{G\in\mathcal{F}(\mathcal{T})}J(G)" class="ltx_Math" display="inline" id="S3.SS3.p2.5.m5.2"><semantics id="S3.SS3.p2.5.m5.2a"><mrow id="S3.SS3.p2.5.m5.2.3" xref="S3.SS3.p2.5.m5.2.3.cmml"><msub id="S3.SS3.p2.5.m5.2.3.2" xref="S3.SS3.p2.5.m5.2.3.2.cmml"><mi id="S3.SS3.p2.5.m5.2.3.2.2" xref="S3.SS3.p2.5.m5.2.3.2.2.cmml">G</mi><mtext id="S3.SS3.p2.5.m5.2.3.2.3" xref="S3.SS3.p2.5.m5.2.3.2.3a.cmml">next</mtext></msub><mo id="S3.SS3.p2.5.m5.2.3.1" xref="S3.SS3.p2.5.m5.2.3.1.cmml">=</mo><mrow id="S3.SS3.p2.5.m5.2.3.3" xref="S3.SS3.p2.5.m5.2.3.3.cmml"><mrow id="S3.SS3.p2.5.m5.2.3.3.2" xref="S3.SS3.p2.5.m5.2.3.3.2.cmml"><mi id="S3.SS3.p2.5.m5.2.3.3.2.1" xref="S3.SS3.p2.5.m5.2.3.3.2.1.cmml">arg</mi><mo id="S3.SS3.p2.5.m5.2.3.3.2a" lspace="0.167em" xref="S3.SS3.p2.5.m5.2.3.3.2.cmml">⁡</mo><mrow id="S3.SS3.p2.5.m5.2.3.3.2.2" xref="S3.SS3.p2.5.m5.2.3.3.2.2.cmml"><msub id="S3.SS3.p2.5.m5.2.3.3.2.2.1" xref="S3.SS3.p2.5.m5.2.3.3.2.2.1.cmml"><mi id="S3.SS3.p2.5.m5.2.3.3.2.2.1.2" xref="S3.SS3.p2.5.m5.2.3.3.2.2.1.2.cmml">min</mi><mrow id="S3.SS3.p2.5.m5.1.1.1" xref="S3.SS3.p2.5.m5.1.1.1.cmml"><mi id="S3.SS3.p2.5.m5.1.1.1.3" xref="S3.SS3.p2.5.m5.1.1.1.3.cmml">G</mi><mo id="S3.SS3.p2.5.m5.1.1.1.2" xref="S3.SS3.p2.5.m5.1.1.1.2.cmml">∈</mo><mrow id="S3.SS3.p2.5.m5.1.1.1.4" xref="S3.SS3.p2.5.m5.1.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.5.m5.1.1.1.4.2" xref="S3.SS3.p2.5.m5.1.1.1.4.2.cmml">ℱ</mi><mo id="S3.SS3.p2.5.m5.1.1.1.4.1" xref="S3.SS3.p2.5.m5.1.1.1.4.1.cmml">⁢</mo><mrow id="S3.SS3.p2.5.m5.1.1.1.4.3.2" xref="S3.SS3.p2.5.m5.1.1.1.4.cmml"><mo id="S3.SS3.p2.5.m5.1.1.1.4.3.2.1" stretchy="false" xref="S3.SS3.p2.5.m5.1.1.1.4.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.5.m5.1.1.1.1" xref="S3.SS3.p2.5.m5.1.1.1.1.cmml">𝒯</mi><mo id="S3.SS3.p2.5.m5.1.1.1.4.3.2.2" stretchy="false" xref="S3.SS3.p2.5.m5.1.1.1.4.cmml">)</mo></mrow></mrow></mrow></msub><mo id="S3.SS3.p2.5.m5.2.3.3.2.2a" lspace="0.167em" xref="S3.SS3.p2.5.m5.2.3.3.2.2.cmml">⁡</mo><mi id="S3.SS3.p2.5.m5.2.3.3.2.2.2" xref="S3.SS3.p2.5.m5.2.3.3.2.2.2.cmml">J</mi></mrow></mrow><mo id="S3.SS3.p2.5.m5.2.3.3.1" xref="S3.SS3.p2.5.m5.2.3.3.1.cmml">⁢</mo><mrow id="S3.SS3.p2.5.m5.2.3.3.3.2" xref="S3.SS3.p2.5.m5.2.3.3.cmml"><mo id="S3.SS3.p2.5.m5.2.3.3.3.2.1" stretchy="false" xref="S3.SS3.p2.5.m5.2.3.3.cmml">(</mo><mi id="S3.SS3.p2.5.m5.2.2" xref="S3.SS3.p2.5.m5.2.2.cmml">G</mi><mo id="S3.SS3.p2.5.m5.2.3.3.3.2.2" stretchy="false" xref="S3.SS3.p2.5.m5.2.3.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m5.2b"><apply id="S3.SS3.p2.5.m5.2.3.cmml" xref="S3.SS3.p2.5.m5.2.3"><eq id="S3.SS3.p2.5.m5.2.3.1.cmml" xref="S3.SS3.p2.5.m5.2.3.1"></eq><apply id="S3.SS3.p2.5.m5.2.3.2.cmml" xref="S3.SS3.p2.5.m5.2.3.2"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m5.2.3.2.1.cmml" xref="S3.SS3.p2.5.m5.2.3.2">subscript</csymbol><ci id="S3.SS3.p2.5.m5.2.3.2.2.cmml" xref="S3.SS3.p2.5.m5.2.3.2.2">𝐺</ci><ci id="S3.SS3.p2.5.m5.2.3.2.3a.cmml" xref="S3.SS3.p2.5.m5.2.3.2.3"><mtext id="S3.SS3.p2.5.m5.2.3.2.3.cmml" mathsize="70%" xref="S3.SS3.p2.5.m5.2.3.2.3">next</mtext></ci></apply><apply id="S3.SS3.p2.5.m5.2.3.3.cmml" xref="S3.SS3.p2.5.m5.2.3.3"><times id="S3.SS3.p2.5.m5.2.3.3.1.cmml" xref="S3.SS3.p2.5.m5.2.3.3.1"></times><apply id="S3.SS3.p2.5.m5.2.3.3.2.cmml" xref="S3.SS3.p2.5.m5.2.3.3.2"><arg id="S3.SS3.p2.5.m5.2.3.3.2.1.cmml" xref="S3.SS3.p2.5.m5.2.3.3.2.1"></arg><apply id="S3.SS3.p2.5.m5.2.3.3.2.2.cmml" xref="S3.SS3.p2.5.m5.2.3.3.2.2"><apply id="S3.SS3.p2.5.m5.2.3.3.2.2.1.cmml" xref="S3.SS3.p2.5.m5.2.3.3.2.2.1"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m5.2.3.3.2.2.1.1.cmml" xref="S3.SS3.p2.5.m5.2.3.3.2.2.1">subscript</csymbol><min id="S3.SS3.p2.5.m5.2.3.3.2.2.1.2.cmml" xref="S3.SS3.p2.5.m5.2.3.3.2.2.1.2"></min><apply id="S3.SS3.p2.5.m5.1.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1.1"><in id="S3.SS3.p2.5.m5.1.1.1.2.cmml" xref="S3.SS3.p2.5.m5.1.1.1.2"></in><ci id="S3.SS3.p2.5.m5.1.1.1.3.cmml" xref="S3.SS3.p2.5.m5.1.1.1.3">𝐺</ci><apply id="S3.SS3.p2.5.m5.1.1.1.4.cmml" xref="S3.SS3.p2.5.m5.1.1.1.4"><times id="S3.SS3.p2.5.m5.1.1.1.4.1.cmml" xref="S3.SS3.p2.5.m5.1.1.1.4.1"></times><ci id="S3.SS3.p2.5.m5.1.1.1.4.2.cmml" xref="S3.SS3.p2.5.m5.1.1.1.4.2">ℱ</ci><ci id="S3.SS3.p2.5.m5.1.1.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1.1.1">𝒯</ci></apply></apply></apply><ci id="S3.SS3.p2.5.m5.2.3.3.2.2.2.cmml" xref="S3.SS3.p2.5.m5.2.3.3.2.2.2">𝐽</ci></apply></apply><ci id="S3.SS3.p2.5.m5.2.2.cmml" xref="S3.SS3.p2.5.m5.2.2">𝐺</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m5.2c">G_{\text{next}}=\arg\min_{G\in\mathcal{F}(\mathcal{T})}J(G)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.5.m5.2d">italic_G start_POSTSUBSCRIPT next end_POSTSUBSCRIPT = roman_arg roman_min start_POSTSUBSCRIPT italic_G ∈ caligraphic_F ( caligraphic_T ) end_POSTSUBSCRIPT italic_J ( italic_G )</annotation></semantics></math> from the leaf nodes <math alttext="\mathcal{F}(\mathcal{T})" class="ltx_Math" display="inline" id="S3.SS3.p2.6.m6.1"><semantics id="S3.SS3.p2.6.m6.1a"><mrow id="S3.SS3.p2.6.m6.1.2" xref="S3.SS3.p2.6.m6.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.6.m6.1.2.2" xref="S3.SS3.p2.6.m6.1.2.2.cmml">ℱ</mi><mo id="S3.SS3.p2.6.m6.1.2.1" xref="S3.SS3.p2.6.m6.1.2.1.cmml">⁢</mo><mrow id="S3.SS3.p2.6.m6.1.2.3.2" xref="S3.SS3.p2.6.m6.1.2.cmml"><mo id="S3.SS3.p2.6.m6.1.2.3.2.1" stretchy="false" xref="S3.SS3.p2.6.m6.1.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.6.m6.1.1" xref="S3.SS3.p2.6.m6.1.1.cmml">𝒯</mi><mo id="S3.SS3.p2.6.m6.1.2.3.2.2" stretchy="false" xref="S3.SS3.p2.6.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.6.m6.1b"><apply id="S3.SS3.p2.6.m6.1.2.cmml" xref="S3.SS3.p2.6.m6.1.2"><times id="S3.SS3.p2.6.m6.1.2.1.cmml" xref="S3.SS3.p2.6.m6.1.2.1"></times><ci id="S3.SS3.p2.6.m6.1.2.2.cmml" xref="S3.SS3.p2.6.m6.1.2.2">ℱ</ci><ci id="S3.SS3.p2.6.m6.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1">𝒯</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.6.m6.1c">\mathcal{F}(\mathcal{T})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.6.m6.1d">caligraphic_F ( caligraphic_T )</annotation></semantics></math>. The graph encoder embeds molecule tokens into the LLM, which generates reaction conditions until the token <span class="ltx_text ltx_font_typewriter" id="S3.SS3.p2.8.2">&lt;retro&gt;</span> is triggered, activating the GNN predictor. The predictor then predicts the top-50 templates as reaction nodes, along with corresponding reactants as molecule nodes for the next iteration.
A* stops after finding a route from <math alttext="G_{\text{target}}" class="ltx_Math" display="inline" id="S3.SS3.p2.7.m7.1"><semantics id="S3.SS3.p2.7.m7.1a"><msub id="S3.SS3.p2.7.m7.1.1" xref="S3.SS3.p2.7.m7.1.1.cmml"><mi id="S3.SS3.p2.7.m7.1.1.2" xref="S3.SS3.p2.7.m7.1.1.2.cmml">G</mi><mtext id="S3.SS3.p2.7.m7.1.1.3" xref="S3.SS3.p2.7.m7.1.1.3a.cmml">target</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.7.m7.1b"><apply id="S3.SS3.p2.7.m7.1.1.cmml" xref="S3.SS3.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.7.m7.1.1.1.cmml" xref="S3.SS3.p2.7.m7.1.1">subscript</csymbol><ci id="S3.SS3.p2.7.m7.1.1.2.cmml" xref="S3.SS3.p2.7.m7.1.1.2">𝐺</ci><ci id="S3.SS3.p2.7.m7.1.1.3a.cmml" xref="S3.SS3.p2.7.m7.1.1.3"><mtext id="S3.SS3.p2.7.m7.1.1.3.cmml" mathsize="70%" xref="S3.SS3.p2.7.m7.1.1.3">target</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.7.m7.1c">G_{\text{target}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.7.m7.1d">italic_G start_POSTSUBSCRIPT target end_POSTSUBSCRIPT</annotation></semantics></math> to <math alttext="\mathcal{G}_{\text{avail}}" class="ltx_Math" display="inline" id="S3.SS3.p2.8.m8.1"><semantics id="S3.SS3.p2.8.m8.1a"><msub id="S3.SS3.p2.8.m8.1.1" xref="S3.SS3.p2.8.m8.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.8.m8.1.1.2" xref="S3.SS3.p2.8.m8.1.1.2.cmml">𝒢</mi><mtext id="S3.SS3.p2.8.m8.1.1.3" xref="S3.SS3.p2.8.m8.1.1.3a.cmml">avail</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.8.m8.1b"><apply id="S3.SS3.p2.8.m8.1.1.cmml" xref="S3.SS3.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.8.m8.1.1.1.cmml" xref="S3.SS3.p2.8.m8.1.1">subscript</csymbol><ci id="S3.SS3.p2.8.m8.1.1.2.cmml" xref="S3.SS3.p2.8.m8.1.1.2">𝒢</ci><ci id="S3.SS3.p2.8.m8.1.1.3a.cmml" xref="S3.SS3.p2.8.m8.1.1.3"><mtext id="S3.SS3.p2.8.m8.1.1.3.cmml" mathsize="70%" xref="S3.SS3.p2.8.m8.1.1.3">avail</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.8.m8.1c">\mathcal{G}_{\text{avail}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.8.m8.1d">caligraphic_G start_POSTSUBSCRIPT avail end_POSTSUBSCRIPT</annotation></semantics></math> with satisfying all AND-OR constraints, or if it fails after 30 seconds or 300 iterations. Upon success, the text with the corresponding reaction along the route is returned for retrosynthesis; otherwise, the base LLM directly generates texts.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Benchmarking for Multimodal Molecular Design</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="S4.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="297" id="S4.F4.g1" src="https://arxiv.org/html/2410.04223v1/x4.png" width="714">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Creation of MolQA and MolPair: MolQA comprises two sets: a training set for ICL and (multimodal) SFT, and a test set for evaluation. MolPair consists of graph-text and reaction-text pairs, with red highlights indicating synthetic complexity, structure, and properties information.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">To train Llamole, we need instruction data that provide detailed language supervision and evaluation covering synthetic complexity, drug and material utility, and reaction conditions. However, existing data based on PubChem&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Kim et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib22" title="">2021</a>)</cite> are only usable for small molecules and lack such details. Thus, we create MolQA, a large-scale graph-text multimodal instruction dataset for systematic LLM benchmarking used in&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S5" title="5 Experiment ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Section</span>&nbsp;<span class="ltx_text ltx_ref_tag">5</span></a>. We also create MolPair with graph-text and reaction-text pairwise data to pre-train graph modules, as detailed in&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A3" title="Appendix C Additional Pre-training and Fine-tuning Details ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">appendix</span>&nbsp;<span class="ltx_text ltx_ref_tag">C</span></a>. To this end, we first collect multisource molecule data (<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S4.F4" title="In 4 Benchmarking for Multimodal Molecular Design ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Figure</span>&nbsp;<span class="ltx_text ltx_ref_tag">4</span></a>), with details in&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A2" title="Appendix B Additional Benchmarking and Datasets Details ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">appendix</span>&nbsp;<span class="ltx_text ltx_ref_tag">B</span></a>. Then we create MolQA and MolPair.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S4.p2">
<p class="ltx_p" id="S4.p2.8"><span class="ltx_text ltx_font_bold" id="S4.p2.8.1">MolQA: Instruction Data Creation.</span>
USPTO reactions include text descriptions. We use Enamine’s 1.3 million small molecules as <math alttext="\mathcal{G}_{\text{avail}}" class="ltx_Math" display="inline" id="S4.p2.1.m1.1"><semantics id="S4.p2.1.m1.1a"><msub id="S4.p2.1.m1.1.1" xref="S4.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.p2.1.m1.1.1.2" xref="S4.p2.1.m1.1.1.2.cmml">𝒢</mi><mtext id="S4.p2.1.m1.1.1.3" xref="S4.p2.1.m1.1.1.3a.cmml">avail</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.p2.1.m1.1b"><apply id="S4.p2.1.m1.1.1.cmml" xref="S4.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.p2.1.m1.1.1.1.cmml" xref="S4.p2.1.m1.1.1">subscript</csymbol><ci id="S4.p2.1.m1.1.1.2.cmml" xref="S4.p2.1.m1.1.1.2">𝒢</ci><ci id="S4.p2.1.m1.1.1.3a.cmml" xref="S4.p2.1.m1.1.1.3"><mtext id="S4.p2.1.m1.1.1.3.cmml" mathsize="70%" xref="S4.p2.1.m1.1.1.3">avail</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.1.m1.1c">\mathcal{G}_{\text{avail}}</annotation><annotation encoding="application/x-llamapun" id="S4.p2.1.m1.1d">caligraphic_G start_POSTSUBSCRIPT avail end_POSTSUBSCRIPT</annotation></semantics></math>. The depth-first search identifies routes from reaction products (i.e. target molecules) to molecules within <math alttext="\mathcal{G}_{\text{avail}}" class="ltx_Math" display="inline" id="S4.p2.2.m2.1"><semantics id="S4.p2.2.m2.1a"><msub id="S4.p2.2.m2.1.1" xref="S4.p2.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.p2.2.m2.1.1.2" xref="S4.p2.2.m2.1.1.2.cmml">𝒢</mi><mtext id="S4.p2.2.m2.1.1.3" xref="S4.p2.2.m2.1.1.3a.cmml">avail</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.p2.2.m2.1b"><apply id="S4.p2.2.m2.1.1.cmml" xref="S4.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.p2.2.m2.1.1.1.cmml" xref="S4.p2.2.m2.1.1">subscript</csymbol><ci id="S4.p2.2.m2.1.1.2.cmml" xref="S4.p2.2.m2.1.1.2">𝒢</ci><ci id="S4.p2.2.m2.1.1.3a.cmml" xref="S4.p2.2.m2.1.1.3"><mtext id="S4.p2.2.m2.1.1.3.cmml" mathsize="70%" xref="S4.p2.2.m2.1.1.3">avail</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.2.m2.1c">\mathcal{G}_{\text{avail}}</annotation><annotation encoding="application/x-llamapun" id="S4.p2.2.m2.1d">caligraphic_G start_POSTSUBSCRIPT avail end_POSTSUBSCRIPT</annotation></semantics></math>, resulting in about 139K routes with lengths ranging from 1 to 10. We sample around 11K routes (750 for materials and 9986 for drugs) for testing and use the rest for instruction tuning. We focus on eight popular properties for benchmarking (i.e, <math alttext="M=8" class="ltx_Math" display="inline" id="S4.p2.3.m3.1"><semantics id="S4.p2.3.m3.1a"><mrow id="S4.p2.3.m3.1.1" xref="S4.p2.3.m3.1.1.cmml"><mi id="S4.p2.3.m3.1.1.2" xref="S4.p2.3.m3.1.1.2.cmml">M</mi><mo id="S4.p2.3.m3.1.1.1" xref="S4.p2.3.m3.1.1.1.cmml">=</mo><mn id="S4.p2.3.m3.1.1.3" xref="S4.p2.3.m3.1.1.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.3.m3.1b"><apply id="S4.p2.3.m3.1.1.cmml" xref="S4.p2.3.m3.1.1"><eq id="S4.p2.3.m3.1.1.1.cmml" xref="S4.p2.3.m3.1.1.1"></eq><ci id="S4.p2.3.m3.1.1.2.cmml" xref="S4.p2.3.m3.1.1.2">𝑀</ci><cn id="S4.p2.3.m3.1.1.3.cmml" type="integer" xref="S4.p2.3.m3.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.3.m3.1c">M=8</annotation><annotation encoding="application/x-llamapun" id="S4.p2.3.m3.1d">italic_M = 8</annotation></semantics></math> for <math alttext="\{c_{i}\}_{1}^{M}" class="ltx_Math" display="inline" id="S4.p2.4.m4.1"><semantics id="S4.p2.4.m4.1a"><msubsup id="S4.p2.4.m4.1.1" xref="S4.p2.4.m4.1.1.cmml"><mrow id="S4.p2.4.m4.1.1.1.1.1" xref="S4.p2.4.m4.1.1.1.1.2.cmml"><mo id="S4.p2.4.m4.1.1.1.1.1.2" stretchy="false" xref="S4.p2.4.m4.1.1.1.1.2.cmml">{</mo><msub id="S4.p2.4.m4.1.1.1.1.1.1" xref="S4.p2.4.m4.1.1.1.1.1.1.cmml"><mi id="S4.p2.4.m4.1.1.1.1.1.1.2" xref="S4.p2.4.m4.1.1.1.1.1.1.2.cmml">c</mi><mi id="S4.p2.4.m4.1.1.1.1.1.1.3" xref="S4.p2.4.m4.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.p2.4.m4.1.1.1.1.1.3" stretchy="false" xref="S4.p2.4.m4.1.1.1.1.2.cmml">}</mo></mrow><mn id="S4.p2.4.m4.1.1.1.3" xref="S4.p2.4.m4.1.1.1.3.cmml">1</mn><mi id="S4.p2.4.m4.1.1.3" xref="S4.p2.4.m4.1.1.3.cmml">M</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.p2.4.m4.1b"><apply id="S4.p2.4.m4.1.1.cmml" xref="S4.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S4.p2.4.m4.1.1.2.cmml" xref="S4.p2.4.m4.1.1">superscript</csymbol><apply id="S4.p2.4.m4.1.1.1.cmml" xref="S4.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S4.p2.4.m4.1.1.1.2.cmml" xref="S4.p2.4.m4.1.1">subscript</csymbol><set id="S4.p2.4.m4.1.1.1.1.2.cmml" xref="S4.p2.4.m4.1.1.1.1.1"><apply id="S4.p2.4.m4.1.1.1.1.1.1.cmml" xref="S4.p2.4.m4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.p2.4.m4.1.1.1.1.1.1.1.cmml" xref="S4.p2.4.m4.1.1.1.1.1.1">subscript</csymbol><ci id="S4.p2.4.m4.1.1.1.1.1.1.2.cmml" xref="S4.p2.4.m4.1.1.1.1.1.1.2">𝑐</ci><ci id="S4.p2.4.m4.1.1.1.1.1.1.3.cmml" xref="S4.p2.4.m4.1.1.1.1.1.1.3">𝑖</ci></apply></set><cn id="S4.p2.4.m4.1.1.1.3.cmml" type="integer" xref="S4.p2.4.m4.1.1.1.3">1</cn></apply><ci id="S4.p2.4.m4.1.1.3.cmml" xref="S4.p2.4.m4.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.4.m4.1c">\{c_{i}\}_{1}^{M}</annotation><annotation encoding="application/x-llamapun" id="S4.p2.4.m4.1d">{ italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT</annotation></semantics></math> in&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S2.E2" title="In 2.2 Molecular Design with Graph Diffusion Models ‣ 2 Preliminaries ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Eq.</span>&nbsp;<span class="ltx_text ltx_ref_tag">2</span></a>). They include three drug-related categorical properties&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Wu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib43" title="">2018</a>)</cite>: (1) HIV virus replication inhibition (HIV), (2) blood-brain barrier permeability (BBBP), and (3) human <math alttext="\beta" class="ltx_Math" display="inline" id="S4.p2.5.m5.1"><semantics id="S4.p2.5.m5.1a"><mi id="S4.p2.5.m5.1.1" xref="S4.p2.5.m5.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.p2.5.m5.1b"><ci id="S4.p2.5.m5.1.1.cmml" xref="S4.p2.5.m5.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.5.m5.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S4.p2.5.m5.1d">italic_β</annotation></semantics></math>-secretase 1 inhibition (BACE) and five continuous material properties&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Thornton et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib39" title="">2012</a>)</cite>: (4) CO<sub class="ltx_sub" id="S4.p2.8.2">2</sub> permeability, (5) N<sub class="ltx_sub" id="S4.p2.8.3">2</sub> permeability, (6) O<sub class="ltx_sub" id="S4.p2.8.4">2</sub> permeability, (7) fractional free volume (FFV), and (8) thermal conductivity (TC).
Not all target molecules have these properties. To enrich properties and texts, two supervised GNNs predict drug and material properties with confidence scores as in&nbsp;<cite class="ltx_cite ltx_citemacro_citet">Liu et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib23" title="">2022</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib24" title="">2023a</a>)</cite>. Only high-confident predictions are selected for annotation. Llama-3-70B then generates descriptions using a template that incorporates these properties with structural and synthesis information from toolkits like RDKit.
There are no polymerization reactions; we consider the monomer structure of the polymer as the synthesis target.
We assemble molecule descriptions, text, and reactions from synthesis routes as answer data. Then Llama-3-70B is prompted to generate questions, resulting in MolQA with the example as shown in&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S1.F2" title="In 1 Introduction ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Figure</span>&nbsp;<span class="ltx_text ltx_ref_tag">2</span></a>. Details are in&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A2.SS2" title="B.2 Details on the Creation of MolQA ‣ Appendix B Additional Benchmarking and Datasets Details ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Section</span>&nbsp;<span class="ltx_text ltx_ref_tag">B.2</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S4.p3">
<p class="ltx_p" id="S4.p3.1"><span class="ltx_text ltx_font_bold" id="S4.p3.1.1">MolPair: Pairwise Data Creation.</span>
After excluding the target molecules from the instruction data, we use the remaining text-reaction data from USPTO to pre-train the GNN reaction predictor. Similarly, we utilize all other small molecules and polymers to pre-train the Graph DiT and graph encoder. For generalization, we expand beyond the eight properties used in the instruction data. For drug utility, we train another GNN to predict 41 properties, including toxicity, safety, enzyme interaction, absorption, distribution, metabolism, excretion (ADME), and biological activity&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Swanson et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib38" title="">2024</a>)</cite>. For material utility, we consider 14 properties, such as thermal, physical, thermodynamic, permeability, solubility, and dielectric properties. Llama-3-70B generates related texts for these properties, incorporating structural and synthetic information. Finally, there are around 600K graph-text pairs for both small molecules and polymers to support pre-training. Details are in&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A2.SS3" title="B.3 Details on the Creation of MolPair ‣ Appendix B Additional Benchmarking and Datasets Details ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Section</span>&nbsp;<span class="ltx_text ltx_ref_tag">B.3</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiment</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">We conduct a systematic evaluation to demonstrate Llamole’s superior performance in controllable and synthesizable molecular design (RQ1). We investigate Llamole’s performance in controllable molecular generation through ablation and case studies (RQ2). We analyze retrosynthetic performance of LLMs, focusing on error analysis and the efficiency and effectiveness of Llamole (RQ3).</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S5.p2">
<p class="ltx_p" id="S5.p2.1"><span class="ltx_text ltx_font_bold" id="S5.p2.1.1">Set-ups:</span>
We include LLM baselines from 7B to 70B, such as Llama, Mistral, Qwen, Granite, and Flan-T5, using either ICL or LoRA-based SFT. The MolQA test set contains 9,986 QA pairs for material design and 750 for drug design. LLMs are prompted with questions to generate responses for texts, molecules, and reactions. For controllability, we evaluate up to 12 metrics across four aspects: (1) chemical validity, (2) similarity to the reference based on Morgan fingerprints&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Rogers and Hahn, <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib34" title="">2010</a>)</cite>, (3) BLEU-4 and ROUGE-L scores against reference texts, and (4) deviation from desired properties. We follow&nbsp;<cite class="ltx_cite ltx_citemacro_cite">Gao et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib13" title="">2022</a>)</cite> to use well-trained random forests as the oracle functions for obtaining properties of designed molecules. We focus on three drug-related categorical properties assessed by balanced accuracy (BA) and five continuous material properties assessed by mean absolute error (MAE). For retrosynthesis, we evaluate the success rate of designed molecules against those available in <math alttext="\mathcal{G}_{\text{avail}}" class="ltx_Math" display="inline" id="S5.p2.1.m1.1"><semantics id="S5.p2.1.m1.1a"><msub id="S5.p2.1.m1.1.1" xref="S5.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.p2.1.m1.1.1.2" xref="S5.p2.1.m1.1.1.2.cmml">𝒢</mi><mtext id="S5.p2.1.m1.1.1.3" xref="S5.p2.1.m1.1.1.3a.cmml">avail</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.p2.1.m1.1b"><apply id="S5.p2.1.m1.1.1.cmml" xref="S5.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S5.p2.1.m1.1.1.1.cmml" xref="S5.p2.1.m1.1.1">subscript</csymbol><ci id="S5.p2.1.m1.1.1.2.cmml" xref="S5.p2.1.m1.1.1.2">𝒢</ci><ci id="S5.p2.1.m1.1.1.3a.cmml" xref="S5.p2.1.m1.1.1.3"><mtext id="S5.p2.1.m1.1.1.3.cmml" mathsize="70%" xref="S5.p2.1.m1.1.1.3">avail</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.1.m1.1c">\mathcal{G}_{\text{avail}}</annotation><annotation encoding="application/x-llamapun" id="S5.p2.1.m1.1d">caligraphic_G start_POSTSUBSCRIPT avail end_POSTSUBSCRIPT</annotation></semantics></math> from Enamine. Details are in&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A4.SS1" title="D.1 Additional Details on Experimental Set-ups ‣ Appendix D Additional Experimental Details and Discussions ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Section</span>&nbsp;<span class="ltx_text ltx_ref_tag">D.1</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="S5.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span>Multi-Conditional Molecular Design with LLMs: Best overall results in each metric are in <span class="ltx_text ltx_font_bold" id="S5.T1.12.1" style="background-color:#FFD9D9;">bold</span>, best baseline results are in <span class="ltx_text ltx_font_italic" id="S5.T1.13.2" style="background-color:#EBEBEB;">italic</span>. Balanced Accuracy (BA) <math alttext="=\frac{\text{True Positive Rate}+\text{True Negative Rate}}{2}" class="ltx_Math" display="inline" id="S5.T1.2.m1.1"><semantics id="S5.T1.2.m1.1b"><mrow id="S5.T1.2.m1.1.1" xref="S5.T1.2.m1.1.1.cmml"><mi id="S5.T1.2.m1.1.1.2" xref="S5.T1.2.m1.1.1.2.cmml"></mi><mo id="S5.T1.2.m1.1.1.1" xref="S5.T1.2.m1.1.1.1.cmml">=</mo><mfrac id="S5.T1.2.m1.1.1.3" xref="S5.T1.2.m1.1.1.3.cmml"><mrow id="S5.T1.2.m1.1.1.3.2" xref="S5.T1.2.m1.1.1.3.2.cmml"><mtext id="S5.T1.2.m1.1.1.3.2.2" xref="S5.T1.2.m1.1.1.3.2.2a.cmml">True Positive Rate</mtext><mo id="S5.T1.2.m1.1.1.3.2.1" xref="S5.T1.2.m1.1.1.3.2.1.cmml">+</mo><mtext id="S5.T1.2.m1.1.1.3.2.3" xref="S5.T1.2.m1.1.1.3.2.3a.cmml">True Negative Rate</mtext></mrow><mn id="S5.T1.2.m1.1.1.3.3" xref="S5.T1.2.m1.1.1.3.3.cmml">2</mn></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.2.m1.1c"><apply id="S5.T1.2.m1.1.1.cmml" xref="S5.T1.2.m1.1.1"><eq id="S5.T1.2.m1.1.1.1.cmml" xref="S5.T1.2.m1.1.1.1"></eq><csymbol cd="latexml" id="S5.T1.2.m1.1.1.2.cmml" xref="S5.T1.2.m1.1.1.2">absent</csymbol><apply id="S5.T1.2.m1.1.1.3.cmml" xref="S5.T1.2.m1.1.1.3"><divide id="S5.T1.2.m1.1.1.3.1.cmml" xref="S5.T1.2.m1.1.1.3"></divide><apply id="S5.T1.2.m1.1.1.3.2.cmml" xref="S5.T1.2.m1.1.1.3.2"><plus id="S5.T1.2.m1.1.1.3.2.1.cmml" xref="S5.T1.2.m1.1.1.3.2.1"></plus><ci id="S5.T1.2.m1.1.1.3.2.2a.cmml" xref="S5.T1.2.m1.1.1.3.2.2"><mtext id="S5.T1.2.m1.1.1.3.2.2.cmml" mathsize="70%" xref="S5.T1.2.m1.1.1.3.2.2">True Positive Rate</mtext></ci><ci id="S5.T1.2.m1.1.1.3.2.3a.cmml" xref="S5.T1.2.m1.1.1.3.2.3"><mtext id="S5.T1.2.m1.1.1.3.2.3.cmml" mathsize="70%" xref="S5.T1.2.m1.1.1.3.2.3">True Negative Rate</mtext></ci></apply><cn id="S5.T1.2.m1.1.1.3.3.cmml" type="integer" xref="S5.T1.2.m1.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.2.m1.1d">=\frac{\text{True Positive Rate}+\text{True Negative Rate}}{2}</annotation><annotation encoding="application/x-llamapun" id="S5.T1.2.m1.1e">= divide start_ARG True Positive Rate + True Negative Rate end_ARG start_ARG 2 end_ARG</annotation></semantics></math>.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S5.T1.9" style="width:461.2pt;height:469pt;vertical-align:-1.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<p class="ltx_p" id="S5.T1.9.7"><span class="ltx_text" id="S5.T1.9.7.7">
<span class="ltx_tabular ltx_align_middle" id="S5.T1.9.7.7.7">
<span class="ltx_tr" id="S5.T1.6.4.4.4.4">
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_tt ltx_rowspan ltx_rowspan_2" id="S5.T1.6.4.4.4.4.5" style="padding:1pt 0.0pt;"><span class="ltx_text" id="S5.T1.6.4.4.4.4.5.1">
<span class="ltx_inline-block" id="S5.T1.6.4.4.4.4.5.1.1">
<span class="ltx_p" id="S5.T1.6.4.4.4.4.5.1.1.1">Base LLM</span>
<span class="ltx_p" id="S5.T1.6.4.4.4.4.5.1.1.2">or Method</span>
</span></span></span>
<span class="ltx_td ltx_nopad_l ltx_align_center ltx_border_tt ltx_colspan ltx_colspan_2" id="S5.T1.3.1.1.1.1.1" style="padding:1pt 0.0pt;">Structure (<math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.T1.3.1.1.1.1.1.m1.1"><semantics id="S5.T1.3.1.1.1.1.1.m1.1a"><mo id="S5.T1.3.1.1.1.1.1.m1.1.1" stretchy="false" xref="S5.T1.3.1.1.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T1.3.1.1.1.1.1.m1.1b"><ci id="S5.T1.3.1.1.1.1.1.m1.1.1.cmml" xref="S5.T1.3.1.1.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.3.1.1.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T1.3.1.1.1.1.1.m1.1d">↑</annotation></semantics></math>)</span>
<span class="ltx_td ltx_nopad_l ltx_align_center ltx_border_tt ltx_colspan ltx_colspan_2" id="S5.T1.4.2.2.2.2.2" style="padding:1pt 0.0pt;">Text (<math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.T1.4.2.2.2.2.2.m1.1"><semantics id="S5.T1.4.2.2.2.2.2.m1.1a"><mo id="S5.T1.4.2.2.2.2.2.m1.1.1" stretchy="false" xref="S5.T1.4.2.2.2.2.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T1.4.2.2.2.2.2.m1.1b"><ci id="S5.T1.4.2.2.2.2.2.m1.1.1.cmml" xref="S5.T1.4.2.2.2.2.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.4.2.2.2.2.2.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T1.4.2.2.2.2.2.m1.1d">↑</annotation></semantics></math>)</span>
<span class="ltx_td ltx_nopad_l ltx_align_center ltx_border_tt ltx_colspan ltx_colspan_3" id="S5.T1.5.3.3.3.3.3" style="padding:1pt 0.0pt;">Drug (BA <math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.T1.5.3.3.3.3.3.m1.1"><semantics id="S5.T1.5.3.3.3.3.3.m1.1a"><mo id="S5.T1.5.3.3.3.3.3.m1.1.1" stretchy="false" xref="S5.T1.5.3.3.3.3.3.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T1.5.3.3.3.3.3.m1.1b"><ci id="S5.T1.5.3.3.3.3.3.m1.1.1.cmml" xref="S5.T1.5.3.3.3.3.3.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.5.3.3.3.3.3.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T1.5.3.3.3.3.3.m1.1d">↑</annotation></semantics></math>)</span>
<span class="ltx_td ltx_nopad_l ltx_align_center ltx_border_tt ltx_colspan ltx_colspan_5" id="S5.T1.6.4.4.4.4.4" style="padding:1pt 0.0pt;">Material (MAE <math alttext="\downarrow" class="ltx_Math" display="inline" id="S5.T1.6.4.4.4.4.4.m1.1"><semantics id="S5.T1.6.4.4.4.4.4.m1.1a"><mo id="S5.T1.6.4.4.4.4.4.m1.1.1" stretchy="false" xref="S5.T1.6.4.4.4.4.4.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T1.6.4.4.4.4.4.m1.1b"><ci id="S5.T1.6.4.4.4.4.4.m1.1.1.cmml" xref="S5.T1.6.4.4.4.4.4.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.6.4.4.4.4.4.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T1.6.4.4.4.4.4.m1.1d">↓</annotation></semantics></math>)</span></span>
<span class="ltx_tr" id="S5.T1.9.7.7.7.7">
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T1.9.7.7.7.7.4" style="padding:1pt 0.0pt;">Validity</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T1.9.7.7.7.7.5" style="padding:1pt 0.0pt;">Similarity</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T1.9.7.7.7.7.6" style="padding:1pt 0.0pt;">BLEU-4</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T1.9.7.7.7.7.7" style="padding:1pt 0.0pt;">ROUGE-L</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T1.9.7.7.7.7.8" style="padding:1pt 0.0pt;">HIV</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T1.9.7.7.7.7.9" style="padding:1pt 0.0pt;">BBBP</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T1.9.7.7.7.7.10" style="padding:1pt 0.0pt;">BACE</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T1.7.5.5.5.5.1" style="padding:1pt 0.0pt;">CO<sub class="ltx_sub" id="S5.T1.7.5.5.5.5.1.1">2</sub>Perm</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T1.8.6.6.6.6.2" style="padding:1pt 0.0pt;">N<sub class="ltx_sub" id="S5.T1.8.6.6.6.6.2.1">2</sub>Perm</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T1.9.7.7.7.7.3" style="padding:1pt 0.0pt;">O<sub class="ltx_sub" id="S5.T1.9.7.7.7.7.3.1">2</sub>Perm</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T1.9.7.7.7.7.11" style="padding:1pt 0.0pt;">FFV</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T1.9.7.7.7.7.12" style="padding:1pt 0.0pt;">TC</span></span>
<span class="ltx_tr" id="S5.T1.9.7.7.7.8">
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_t" id="S5.T1.9.7.7.7.8.1" style="padding:1pt 0.0pt;">GraphGA</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T1.9.7.7.7.8.2" style="background-color:#EBEBEB;padding:1pt 0.0pt;"><span class="ltx_text ltx_font_italic" id="S5.T1.9.7.7.7.8.2.1" style="background-color:#EBEBEB;">0.885</span></span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T1.9.7.7.7.8.3" style="padding:1pt 0.0pt;">0.112</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T1.9.7.7.7.8.4" style="padding:1pt 0.0pt;">NA</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T1.9.7.7.7.8.5" style="padding:1pt 0.0pt;">NA</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T1.9.7.7.7.8.6" style="background-color:#EBEBEB;padding:1pt 0.0pt;"><span class="ltx_text ltx_font_italic" id="S5.T1.9.7.7.7.8.6.1" style="background-color:#EBEBEB;">0.536</span></span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T1.9.7.7.7.8.7" style="background-color:#EBEBEB;padding:1pt 0.0pt;"><span class="ltx_text ltx_font_italic" id="S5.T1.9.7.7.7.8.7.1" style="background-color:#EBEBEB;">0.515</span></span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T1.9.7.7.7.8.8" style="padding:1pt 0.0pt;">0.560</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T1.9.7.7.7.8.9" style="background-color:#EBEBEB;padding:1pt 0.0pt;"><span class="ltx_text ltx_font_italic" id="S5.T1.9.7.7.7.8.9.1" style="background-color:#EBEBEB;">0.847</span></span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T1.9.7.7.7.8.10" style="background-color:#EBEBEB;padding:1pt 0.0pt;"><span class="ltx_text ltx_font_italic" id="S5.T1.9.7.7.7.8.10.1" style="background-color:#EBEBEB;">1.556</span></span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T1.9.7.7.7.8.11" style="background-color:#EBEBEB;padding:1pt 0.0pt;"><span class="ltx_text ltx_font_italic" id="S5.T1.9.7.7.7.8.11.1" style="background-color:#EBEBEB;">0.747</span></span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T1.9.7.7.7.8.12" style="background-color:#FFD9D9;padding:1pt 0.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T1.9.7.7.7.8.12.1" style="background-color:#FFD9D9;">0.020</span></span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T1.9.7.7.7.8.13" style="background-color:#EBEBEB;padding:1pt 0.0pt;"><span class="ltx_text ltx_font_italic" id="S5.T1.9.7.7.7.8.13.1" style="background-color:#EBEBEB;">0.042</span></span></span>
<span class="ltx_tr" id="S5.T1.9.7.7.7.9">
<span class="ltx_td ltx_nopad_l ltx_align_left ltx_border_t ltx_colspan ltx_colspan_13" id="S5.T1.9.7.7.7.9.1" style="background-color:#FBFBFB;padding:1pt 0.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T1.9.7.7.7.9.1.1" style="background-color:#FBFBFB;">In-Context Learning</span></span></span>
<span class="ltx_tr" id="S5.T1.9.7.7.7.10">
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" id="S5.T1.9.7.7.7.10.1" style="padding:1pt 0.0pt;">Llama-2-7B</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.10.2" style="padding:1pt 0.0pt;">0.167</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.10.3" style="padding:1pt 0.0pt;">0.024</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.10.4" style="padding:1pt 0.0pt;">0.030</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.10.5" style="padding:1pt 0.0pt;">0.141</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.10.6" style="padding:1pt 0.0pt;">0.051</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.10.7" style="padding:1pt 0.0pt;">0.060</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.10.8" style="padding:1pt 0.0pt;">0.053</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.10.9" style="padding:1pt 0.0pt;">5.463</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.10.10" style="padding:1pt 0.0pt;">3.982</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.10.11" style="padding:1pt 0.0pt;">4.943</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.10.12" style="padding:1pt 0.0pt;">0.308</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.10.13" style="padding:1pt 0.0pt;">0.199</span></span>
<span class="ltx_tr" id="S5.T1.9.7.7.7.11">
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" id="S5.T1.9.7.7.7.11.1" style="padding:1pt 0.0pt;">Mistral-7B</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.11.2" style="padding:1pt 0.0pt;">0.251</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.11.3" style="padding:1pt 0.0pt;">0.044</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.11.4" style="padding:1pt 0.0pt;">0.066</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.11.5" style="padding:1pt 0.0pt;">0.203</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.11.6" style="padding:1pt 0.0pt;">0.163</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.11.7" style="padding:1pt 0.0pt;">0.153</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.11.8" style="padding:1pt 0.0pt;">0.200</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.11.9" style="padding:1pt 0.0pt;">5.062</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.11.10" style="padding:1pt 0.0pt;">3.824</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.11.11" style="padding:1pt 0.0pt;">4.657</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.11.12" style="padding:1pt 0.0pt;">0.289</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.11.13" style="padding:1pt 0.0pt;">0.186</span></span>
<span class="ltx_tr" id="S5.T1.9.7.7.7.12">
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" id="S5.T1.9.7.7.7.12.1" style="padding:1pt 0.0pt;">Qwen2-7B</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.12.2" style="padding:1pt 0.0pt;">0.180</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.12.3" style="padding:1pt 0.0pt;">0.012</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.12.4" style="padding:1pt 0.0pt;">0.030</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.12.5" style="padding:1pt 0.0pt;">0.147</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.12.6" style="padding:1pt 0.0pt;">0.089</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.12.7" style="padding:1pt 0.0pt;">0.091</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.12.8" style="padding:1pt 0.0pt;">0.085</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.12.9" style="padding:1pt 0.0pt;">5.552</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.12.10" style="padding:1pt 0.0pt;">4.251</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.12.11" style="padding:1pt 0.0pt;">5.068</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.12.12" style="padding:1pt 0.0pt;">0.322</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.12.13" style="padding:1pt 0.0pt;">0.211</span></span>
<span class="ltx_tr" id="S5.T1.9.7.7.7.13">
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" id="S5.T1.9.7.7.7.13.1" style="padding:1pt 0.0pt;">Llama-3-8B</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.13.2" style="padding:1pt 0.0pt;">0.656</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.13.3" style="padding:1pt 0.0pt;">0.112</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.13.4" style="padding:1pt 0.0pt;">0.155</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.13.5" style="padding:1pt 0.0pt;">0.307</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.13.6" style="padding:1pt 0.0pt;">0.471</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.13.7" style="padding:1pt 0.0pt;">0.473</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.13.8" style="background-color:#EBEBEB;padding:1pt 0.0pt;"><span class="ltx_text ltx_font_italic" id="S5.T1.9.7.7.7.13.8.1" style="background-color:#EBEBEB;">0.562</span></span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.13.9" style="padding:1pt 0.0pt;">3.233</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.13.10" style="padding:1pt 0.0pt;">3.106</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.13.11" style="padding:1pt 0.0pt;">2.924</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.13.12" style="padding:1pt 0.0pt;">0.171</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.13.13" style="padding:1pt 0.0pt;">0.123</span></span>
<span class="ltx_tr" id="S5.T1.9.7.7.7.14">
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" id="S5.T1.9.7.7.7.14.1" style="padding:1pt 0.0pt;">Flan-T5-XXL</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.14.2" style="padding:1pt 0.0pt;">0.570</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.14.3" style="padding:1pt 0.0pt;">0.094</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.14.4" style="background-color:#EBEBEB;padding:1pt 0.0pt;"><span class="ltx_text ltx_font_italic" id="S5.T1.9.7.7.7.14.4.1" style="background-color:#EBEBEB;">0.226</span></span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.14.5" style="background-color:#EBEBEB;padding:1pt 0.0pt;"><span class="ltx_text ltx_font_italic" id="S5.T1.9.7.7.7.14.5.1" style="background-color:#EBEBEB;">0.388</span></span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.14.6" style="padding:1pt 0.0pt;">0.329</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.14.7" style="padding:1pt 0.0pt;">0.333</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.14.8" style="padding:1pt 0.0pt;">0.403</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.14.9" style="padding:1pt 0.0pt;">2.869</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.14.10" style="padding:1pt 0.0pt;">3.039</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.14.11" style="padding:1pt 0.0pt;">2.799</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.14.12" style="padding:1pt 0.0pt;">0.165</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.14.13" style="padding:1pt 0.0pt;">0.120</span></span>
<span class="ltx_tr" id="S5.T1.9.7.7.7.15">
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" id="S5.T1.9.7.7.7.15.1" style="padding:1pt 0.0pt;">Granite-13B</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.15.2" style="padding:1pt 0.0pt;">0.498</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.15.3" style="padding:1pt 0.0pt;">0.079</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.15.4" style="padding:1pt 0.0pt;">0.170</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.15.5" style="padding:1pt 0.0pt;">0.326</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.15.6" style="padding:1pt 0.0pt;">0.260</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.15.7" style="padding:1pt 0.0pt;">0.293</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.15.8" style="padding:1pt 0.0pt;">0.285</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.15.9" style="padding:1pt 0.0pt;">2.994</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.15.10" style="padding:1pt 0.0pt;">3.165</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.15.11" style="padding:1pt 0.0pt;">2.993</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.15.12" style="padding:1pt 0.0pt;">0.180</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.15.13" style="padding:1pt 0.0pt;">0.123</span></span>
<span class="ltx_tr" id="S5.T1.9.7.7.7.16">
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" id="S5.T1.9.7.7.7.16.1" style="padding:1pt 0.0pt;">Llama-2-13B</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.16.2" style="padding:1pt 0.0pt;">0.346</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.16.3" style="padding:1pt 0.0pt;">0.058</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.16.4" style="padding:1pt 0.0pt;">0.121</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.16.5" style="padding:1pt 0.0pt;">0.279</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.16.6" style="padding:1pt 0.0pt;">0.236</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.16.7" style="padding:1pt 0.0pt;">0.250</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.16.8" style="padding:1pt 0.0pt;">0.259</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.16.9" style="padding:1pt 0.0pt;">5.031</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.16.10" style="padding:1pt 0.0pt;">4.285</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.16.11" style="padding:1pt 0.0pt;">4.816</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.16.12" style="padding:1pt 0.0pt;">0.291</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.16.13" style="padding:1pt 0.0pt;">0.184</span></span>
<span class="ltx_tr" id="S5.T1.9.7.7.7.17">
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" id="S5.T1.9.7.7.7.17.1" style="padding:1pt 0.0pt;">Mistral-8x7B</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.17.2" style="padding:1pt 0.0pt;">0.546</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.17.3" style="padding:1pt 0.0pt;">0.094</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.17.4" style="padding:1pt 0.0pt;">0.181</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.17.5" style="padding:1pt 0.0pt;">0.345</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.17.6" style="padding:1pt 0.0pt;">0.345</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.17.7" style="padding:1pt 0.0pt;">0.346</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.17.8" style="padding:1pt 0.0pt;">0.388</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.17.9" style="padding:1pt 0.0pt;">3.695</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.17.10" style="padding:1pt 0.0pt;">3.150</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.17.11" style="padding:1pt 0.0pt;">3.440</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.17.12" style="padding:1pt 0.0pt;">0.191</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.17.13" style="padding:1pt 0.0pt;">0.138</span></span>
<span class="ltx_tr" id="S5.T1.9.7.7.7.18">
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" id="S5.T1.9.7.7.7.18.1" style="padding:1pt 0.0pt;">Llama-2-70B</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.18.2" style="padding:1pt 0.0pt;">0.299</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.18.3" style="padding:1pt 0.0pt;">0.045</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.18.4" style="padding:1pt 0.0pt;">0.099</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.18.5" style="padding:1pt 0.0pt;">0.222</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.18.6" style="padding:1pt 0.0pt;">0.237</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.18.7" style="padding:1pt 0.0pt;">0.242</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.18.8" style="padding:1pt 0.0pt;">0.274</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.18.9" style="padding:1pt 0.0pt;">5.368</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.18.10" style="padding:1pt 0.0pt;">4.336</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.18.11" style="padding:1pt 0.0pt;">5.017</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.18.12" style="padding:1pt 0.0pt;">0.319</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.18.13" style="padding:1pt 0.0pt;">0.202</span></span>
<span class="ltx_tr" id="S5.T1.9.7.7.7.19">
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" id="S5.T1.9.7.7.7.19.1" style="padding:1pt 0.0pt;">Llama-3-70B</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.19.2" style="padding:1pt 0.0pt;">0.706</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.19.3" style="padding:1pt 0.0pt;">0.124</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.19.4" style="padding:1pt 0.0pt;">0.210</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.19.5" style="padding:1pt 0.0pt;">0.367</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.19.6" style="padding:1pt 0.0pt;">0.415</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.19.7" style="padding:1pt 0.0pt;">0.403</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.19.8" style="padding:1pt 0.0pt;">0.484</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.19.9" style="padding:1pt 0.0pt;">2.659</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.19.10" style="padding:1pt 0.0pt;">2.848</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.19.11" style="padding:1pt 0.0pt;">2.421</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.19.12" style="padding:1pt 0.0pt;">0.135</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.19.13" style="padding:1pt 0.0pt;">0.099</span></span>
<span class="ltx_tr" id="S5.T1.9.7.7.7.20">
<span class="ltx_td ltx_nopad_l ltx_align_left ltx_border_t ltx_colspan ltx_colspan_13" id="S5.T1.9.7.7.7.20.1" style="background-color:#FBFBFB;padding:1pt 0.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T1.9.7.7.7.20.1.1" style="background-color:#FBFBFB;">Supervised Fine-tuning</span></span></span>
<span class="ltx_tr" id="S5.T1.9.7.7.7.21">
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" id="S5.T1.9.7.7.7.21.1" style="padding:1pt 0.0pt;">Mistral-7B</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.21.2" style="padding:1pt 0.0pt;">0.718</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.21.3" style="padding:1pt 0.0pt;">0.125</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.21.4" style="padding:1pt 0.0pt;">0.105</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.21.5" style="padding:1pt 0.0pt;">0.216</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.21.6" style="padding:1pt 0.0pt;">0.460</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.21.7" style="padding:1pt 0.0pt;">0.483</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.21.8" style="padding:1pt 0.0pt;">0.515</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.21.9" style="padding:1pt 0.0pt;">3.269</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.21.10" style="padding:1pt 0.0pt;">3.094</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.21.11" style="padding:1pt 0.0pt;">2.985</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.21.12" style="padding:1pt 0.0pt;">0.184</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.21.13" style="padding:1pt 0.0pt;">0.128</span></span>
<span class="ltx_tr" id="S5.T1.9.7.7.7.22">
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" id="S5.T1.9.7.7.7.22.1" style="padding:1pt 0.0pt;">Qwen2-7B</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.22.2" style="padding:1pt 0.0pt;">0.768</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.22.3" style="padding:1pt 0.0pt;">0.133</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.22.4" style="padding:1pt 0.0pt;">0.221</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.22.5" style="padding:1pt 0.0pt;">0.377</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.22.6" style="padding:1pt 0.0pt;">0.436</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.22.7" style="padding:1pt 0.0pt;">0.457</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.22.8" style="padding:1pt 0.0pt;">0.457</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.22.9" style="padding:1pt 0.0pt;">2.691</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.22.10" style="padding:1pt 0.0pt;">2.562</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.22.11" style="padding:1pt 0.0pt;">2.721</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.22.12" style="padding:1pt 0.0pt;">0.147</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.22.13" style="padding:1pt 0.0pt;">0.106</span></span>
<span class="ltx_tr" id="S5.T1.9.7.7.7.23">
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" id="S5.T1.9.7.7.7.23.1" style="padding:1pt 0.0pt;">Llama-3-8B</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.23.2" style="padding:1pt 0.0pt;">0.797</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.23.3" style="background-color:#EBEBEB;padding:1pt 0.0pt;"><span class="ltx_text ltx_font_italic" id="S5.T1.9.7.7.7.23.3.1" style="background-color:#EBEBEB;">0.136</span></span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.23.4" style="padding:1pt 0.0pt;">0.093</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.23.5" style="padding:1pt 0.0pt;">0.206</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.23.6" style="padding:1pt 0.0pt;">0.426</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.23.7" style="padding:1pt 0.0pt;">0.445</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.23.8" style="padding:1pt 0.0pt;">0.440</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.23.9" style="padding:1pt 0.0pt;">2.222</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.23.10" style="padding:1pt 0.0pt;">2.322</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.23.11" style="padding:1pt 0.0pt;">2.119</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.23.12" style="padding:1pt 0.0pt;">0.110</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.23.13" style="padding:1pt 0.0pt;">0.086</span></span>
<span class="ltx_tr" id="S5.T1.9.7.7.7.24">
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" id="S5.T1.9.7.7.7.24.1" style="padding:1pt 0.0pt;">Llama-3.1-8B</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.24.2" style="padding:1pt 0.0pt;">0.692</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.24.3" style="padding:1pt 0.0pt;">0.121</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.24.4" style="padding:1pt 0.0pt;">0.121</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.24.5" style="padding:1pt 0.0pt;">0.250</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.24.6" style="padding:1pt 0.0pt;">0.417</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.24.7" style="padding:1pt 0.0pt;">0.432</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.24.8" style="padding:1pt 0.0pt;">0.433</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.24.9" style="padding:1pt 0.0pt;">3.210</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.24.10" style="padding:1pt 0.0pt;">2.991</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.24.11" style="padding:1pt 0.0pt;">2.974</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.24.12" style="padding:1pt 0.0pt;">0.179</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.24.13" style="padding:1pt 0.0pt;">0.122</span></span>
<span class="ltx_tr" id="S5.T1.9.7.7.7.25">
<span class="ltx_td ltx_nopad_l ltx_align_left ltx_border_t ltx_colspan ltx_colspan_13" id="S5.T1.9.7.7.7.25.1" style="background-color:#FBFBFB;padding:1pt 0.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T1.9.7.7.7.25.1.1" style="background-color:#FBFBFB;">Llamole</span></span></span>
<span class="ltx_tr" id="S5.T1.9.7.7.7.26">
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" id="S5.T1.9.7.7.7.26.1" style="padding:1pt 0.0pt;">Mistral-7B</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.26.2" style="padding:1pt 0.0pt;">0.900</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.26.3" style="padding:1pt 0.0pt;">0.139</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.26.4" style="background-color:#FFD9D9;padding:1pt 0.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T1.9.7.7.7.26.4.1" style="background-color:#FFD9D9;">0.262</span></span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.26.5" style="background-color:#FFD9D9;padding:1pt 0.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T1.9.7.7.7.26.5.1" style="background-color:#FFD9D9;">0.434</span></span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.26.6" style="padding:1pt 0.0pt;">0.596</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.26.7" style="padding:1pt 0.0pt;">0.617</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.26.8" style="padding:1pt 0.0pt;">0.740</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.26.9" style="background-color:#FFD9D9;padding:1pt 0.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T1.9.7.7.7.26.9.1" style="background-color:#FFD9D9;">0.593</span></span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.26.10" style="padding:1pt 0.0pt;">1.409</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.26.11" style="padding:1pt 0.0pt;">0.565</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.26.12" style="padding:1pt 0.0pt;">0.021</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.26.13" style="padding:1pt 0.0pt;">0.028</span></span>
<span class="ltx_tr" id="S5.T1.9.7.7.7.27">
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" id="S5.T1.9.7.7.7.27.1" style="padding:1pt 0.0pt;">Qwen2-7B</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.27.2" style="padding:1pt 0.0pt;">0.888</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.27.3" style="padding:1pt 0.0pt;">0.135</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.27.4" style="padding:1pt 0.0pt;">0.261</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.27.5" style="padding:1pt 0.0pt;">0.432</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.27.6" style="padding:1pt 0.0pt;">0.600</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.27.7" style="background-color:#FFD9D9;padding:1pt 0.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T1.9.7.7.7.27.7.1" style="background-color:#FFD9D9;">0.639</span></span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.27.8" style="background-color:#FFD9D9;padding:1pt 0.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T1.9.7.7.7.27.8.1" style="background-color:#FFD9D9;">0.746</span></span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.27.9" style="padding:1pt 0.0pt;">0.645</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.27.10" style="padding:1pt 0.0pt;">1.452</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.27.11" style="padding:1pt 0.0pt;">0.581</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.27.12" style="padding:1pt 0.0pt;">0.021</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.27.13" style="background-color:#FFD9D9;padding:1pt 0.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T1.9.7.7.7.27.13.1" style="background-color:#FFD9D9;">0.026</span></span></span>
<span class="ltx_tr" id="S5.T1.9.7.7.7.28">
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" id="S5.T1.9.7.7.7.28.1" style="padding:1pt 0.0pt;">Llama-3.1-8B</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.28.2" style="background-color:#FFD9D9;padding:1pt 0.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T1.9.7.7.7.28.2.1" style="background-color:#FFD9D9;">0.913</span></span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.28.3" style="background-color:#FFD9D9;padding:1pt 0.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T1.9.7.7.7.28.3.1" style="background-color:#FFD9D9;">0.142</span></span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.28.4" style="padding:1pt 0.0pt;">0.254</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.28.5" style="padding:1pt 0.0pt;">0.427</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.28.6" style="background-color:#FFD9D9;padding:1pt 0.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T1.9.7.7.7.28.6.1" style="background-color:#FFD9D9;">0.623</span></span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.28.7" style="padding:1pt 0.0pt;">0.629</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.28.8" style="padding:1pt 0.0pt;">0.713</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.28.9" style="padding:1pt 0.0pt;">0.653</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.28.10" style="background-color:#FFD9D9;padding:1pt 0.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T1.9.7.7.7.28.10.1" style="background-color:#FFD9D9;">1.344</span></span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.28.11" style="background-color:#FFD9D9;padding:1pt 0.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T1.9.7.7.7.28.11.1" style="background-color:#FFD9D9;">0.549</span></span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.28.12" style="padding:1pt 0.0pt;">0.021</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.28.13" style="padding:1pt 0.0pt;">0.030</span></span>
<span class="ltx_tr" id="S5.T1.9.7.7.7.29">
<span class="ltx_td ltx_nopad_l ltx_align_left ltx_border_t ltx_colspan ltx_colspan_13" id="S5.T1.9.7.7.7.29.1" style="background-color:#FBFBFB;padding:1pt 0.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T1.9.7.7.7.29.1.1" style="background-color:#FBFBFB;">Improvement of Llamole (%)</span></span></span>
<span class="ltx_tr" id="S5.T1.9.7.7.7.30">
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" id="S5.T1.9.7.7.7.30.1" style="padding:1pt 0.0pt;">vs. All</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.30.2" style="padding:1pt 0.0pt;">+3.2</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.30.3" style="padding:1pt 0.0pt;">+4.4</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.30.4" style="padding:1pt 0.0pt;">+15.9</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.30.5" style="padding:1pt 0.0pt;">+11.9</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.30.6" style="padding:1pt 0.0pt;">+16.2</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.30.7" style="padding:1pt 0.0pt;">+24.1</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.30.8" style="padding:1pt 0.0pt;">+32.7</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.30.9" style="padding:1pt 0.0pt;">+22.9</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.30.10" style="padding:1pt 0.0pt;">+6.7</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.30.11" style="padding:1pt 0.0pt;">+22.2</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.30.12" style="padding:1pt 0.0pt;">-5.0</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T1.9.7.7.7.30.13" style="padding:1pt 0.0pt;">+28.6</span></span>
<span class="ltx_tr" id="S5.T1.9.7.7.7.31">
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_bb" id="S5.T1.9.7.7.7.31.1" style="padding:1pt 0.0pt;">vs. LLMs</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" id="S5.T1.9.7.7.7.31.2" style="padding:1pt 0.0pt;">+14.6</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" id="S5.T1.9.7.7.7.31.3" style="padding:1pt 0.0pt;">+4.4</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" id="S5.T1.9.7.7.7.31.4" style="padding:1pt 0.0pt;">+15.9</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" id="S5.T1.9.7.7.7.31.5" style="padding:1pt 0.0pt;">+11.9</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" id="S5.T1.9.7.7.7.31.6" style="padding:1pt 0.0pt;">+32.3</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" id="S5.T1.9.7.7.7.31.7" style="padding:1pt 0.0pt;">+32.3</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" id="S5.T1.9.7.7.7.31.8" style="padding:1pt 0.0pt;">+32.7</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" id="S5.T1.9.7.7.7.31.9" style="padding:1pt 0.0pt;">+70.6</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" id="S5.T1.9.7.7.7.31.10" style="padding:1pt 0.0pt;">+37.5</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" id="S5.T1.9.7.7.7.31.11" style="padding:1pt 0.0pt;">+72.6</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" id="S5.T1.9.7.7.7.31.12" style="padding:1pt 0.0pt;">+80.9</span>
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" id="S5.T1.9.7.7.7.31.13" style="padding:1pt 0.0pt;">+65.1</span></span>
</span></span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</span></div>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="S5.F5">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F5.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="832" id="S5.F5.sf1.g1" src="https://arxiv.org/html/2410.04223v1/x5.png" width="830">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span>LLM for Drug (Small Molecule) Design</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F5.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="832" id="S5.F5.sf2.g1" src="https://arxiv.org/html/2410.04223v1/x6.png" width="830">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span>LLM for Material (Polymer) Design</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Overall Comparison of LLMs for Controllability and Synthesizability: Performance is ranked by averaged BA/MAE (x-axis) and retrosynthesis success rate (y-axis). Circle size indicates model size. LLMs with ICL, SFT, and Llamole are highlighted in blue, orange, and red, respectively.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>RQ1: LLMs for Controllable and Synthesizable Molecular Design</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.1"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S5.T1" title="In 5 Experiment ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Table</span>&nbsp;<span class="ltx_text ltx_ref_tag">1</span></a> and&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S5.T2" title="In 5.1 RQ1: LLMs for Controllable and Synthesizable Molecular Design ‣ 5 Experiment ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Table</span>&nbsp;<span class="ltx_text ltx_ref_tag">2</span></a> detail LLM performance in controllability and retrosynthesis success rate. The overall performance rankings are summarized in&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S5.F5" title="In 5 Experiment ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Figure</span>&nbsp;<span class="ltx_text ltx_ref_tag">5</span></a>. Our key observations are:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS1.p2">
<p class="ltx_p" id="S5.SS1.p2.1">(1) <span class="ltx_text ltx_font_bold" id="S5.SS1.p2.1.1">Llamole significantly outperforms other LLMs in text generation, controllable molecule generation, and retrosynthetic planning.</span> Llamole fine-tuned on various 7B-parameter LLMs, as shown in&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S5.T2" title="In 5.1 RQ1: LLMs for Controllable and Synthesizable Molecular Design ‣ 5 Experiment ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Table</span>&nbsp;<span class="ltx_text ltx_ref_tag">2</span></a>, results in top-3 rankings, surpassing 70B models that are 10<math alttext="\times" class="ltx_Math" display="inline" id="S5.SS1.p2.1.m1.1"><semantics id="S5.SS1.p2.1.m1.1a"><mo id="S5.SS1.p2.1.m1.1.1" xref="S5.SS1.p2.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.1.m1.1b"><times id="S5.SS1.p2.1.m1.1.1.cmml" xref="S5.SS1.p2.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p2.1.m1.1d">×</annotation></semantics></math> larger across all 12 metrics for controllability and planning success. Specifically, Llamole enhances chemical structure validity by 14.6%, structure controllability by 4.4%, and text generation by 11.9%-15.9%. Additionally, Llamole improves property controllability by 32% to 80%. In retrosynthesis, <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S5.T2" title="In 5.1 RQ1: LLMs for Controllable and Synthesizable Molecular Design ‣ 5 Experiment ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Table</span>&nbsp;<span class="ltx_text ltx_ref_tag">2</span></a> indicates Llamole increases the success ratio from 5% to 35% for drugs and to 17.9% for polymers.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS1.p3">
<p class="ltx_p" id="S5.SS1.p3.1">(2) <span class="ltx_text ltx_font_bold" id="S5.SS1.p3.1.1">SFT improves molecular design but may not always enhance retrosynthesis.</span> According to&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S5.F5" title="In 5 Experiment ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Figures</span>&nbsp;<span class="ltx_text ltx_ref_tag">5</span></a> and&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S5.T1" title="Table 1 ‣ 5 Experiment ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">1</span></a>, SFT enables 7B LLMs to achieve chemical validity, structure, and property control comparable to 70B LLMs with ICL. However, it offers minimal improvement in planning ability for the generated target molecule. A notable example is Llama-3-8B from&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S5.T2" title="In 5.1 RQ1: LLMs for Controllable and Synthesizable Molecular Design ‣ 5 Experiment ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Table</span>&nbsp;<span class="ltx_text ltx_ref_tag">2</span></a>, where SFT reduces its retrosynthesis planning success from 5.5% to below 1%. Except for Llama-3-8B, we connect LLM performance with the same baseline but different learning methods in&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S5.F5" title="In 5 Experiment ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Figure</span>&nbsp;<span class="ltx_text ltx_ref_tag">5</span></a>. The results show that SFT methods still outperform ICL with the same base 7B models in most cases.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="S5.T2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>Retrosynthetic Success Rate: Best results are in <span class="ltx_text ltx_font_bold" id="S5.T2.3.1" style="background-color:#FFD9D9;">bold</span>, best baseline results are in <span class="ltx_text ltx_font_italic" id="S5.T2.4.2" style="background-color:#EBEBEB;">italic</span>.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S5.T2.5" style="width:433.6pt;height:125.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-50.1pt,14.5pt) scale(0.812168459996765,0.812168459996765) ;">
<table class="ltx_tabular ltx_align_middle" id="S5.T2.5.1">
<tbody><tr class="ltx_tr" id="S5.T2.5.1.1">
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_tt" id="S5.T2.5.1.1.1" style="background-color:#EBEBEB;padding-left:0.0pt;padding-right:0.0pt;">
<table class="ltx_tabular ltx_align_middle" id="S5.T2.5.1.1.1.1">
<tbody><tr class="ltx_tr" id="S5.T2.5.1.1.1.1.1">
<td class="ltx_td ltx_nopad_l ltx_nopad_r" id="S5.T2.5.1.1.1.1.1.1" style="padding-left:0.0pt;padding-right:0.0pt;"></td>
<td class="ltx_td ltx_nopad_l ltx_align_center" colspan="9" id="S5.T2.5.1.1.1.1.1.2" style="padding-left:0.0pt;padding-right:0.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.5.1.1.1.1.1.2.1">In-Context Learning</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.5.1.1.1.1.2">
<td class="ltx_td ltx_nopad_l ltx_nopad_r" id="S5.T2.5.1.1.1.1.2.1" style="padding-left:0.0pt;padding-right:0.0pt;"></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T2.5.1.1.1.1.2.2" style="padding-left:0.0pt;padding-right:0.0pt;">Llama-2-7B</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T2.5.1.1.1.1.2.3" style="padding-left:0.0pt;padding-right:0.0pt;">Mistral-7B</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T2.5.1.1.1.1.2.4" style="padding-left:0.0pt;padding-right:0.0pt;">Qwen2-7B</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T2.5.1.1.1.1.2.5" style="padding-left:0.0pt;padding-right:0.0pt;">Llama-3-8B</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T2.5.1.1.1.1.2.6" style="padding-left:0.0pt;padding-right:0.0pt;">Flan-T5-XXL</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T2.5.1.1.1.1.2.7" style="padding-left:0.0pt;padding-right:0.0pt;">Granite-13B</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T2.5.1.1.1.1.2.8" style="padding-left:0.0pt;padding-right:0.0pt;">Llama-2-13B</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T2.5.1.1.1.1.2.9" style="padding-left:0.0pt;padding-right:0.0pt;">Mistral-8x7B</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T2.5.1.1.1.1.2.10" style="padding-left:0.0pt;padding-right:0.0pt;">Llama-2-70B</td>
</tr>
<tr class="ltx_tr" id="S5.T2.5.1.1.1.1.3">
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_t" id="S5.T2.5.1.1.1.1.3.1" style="padding-left:0.0pt;padding-right:0.0pt;">Drug (%)</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T2.5.1.1.1.1.3.2" style="padding-left:0.0pt;padding-right:0.0pt;">0.1</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T2.5.1.1.1.1.3.3" style="padding-left:0.0pt;padding-right:0.0pt;">0.2</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T2.5.1.1.1.1.3.4" style="padding-left:0.0pt;padding-right:0.0pt;">0.0</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T2.5.1.1.1.1.3.5" style="padding-left:0.0pt;padding-right:0.0pt;"><span class="ltx_text ltx_font_italic" id="S5.T2.5.1.1.1.1.3.5.1" style="background-color:#EBEBEB;">5.5</span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T2.5.1.1.1.1.3.6" style="padding-left:0.0pt;padding-right:0.0pt;">0.4</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T2.5.1.1.1.1.3.7" style="padding-left:0.0pt;padding-right:0.0pt;">0.6</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T2.5.1.1.1.1.3.8" style="padding-left:0.0pt;padding-right:0.0pt;">1.2</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T2.5.1.1.1.1.3.9" style="padding-left:0.0pt;padding-right:0.0pt;">1.6</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T2.5.1.1.1.1.3.10" style="padding-left:0.0pt;padding-right:0.0pt;">1.0</td>
</tr>
<tr class="ltx_tr" id="S5.T2.5.1.1.1.1.4">
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" id="S5.T2.5.1.1.1.1.4.1" style="padding-left:0.0pt;padding-right:0.0pt;">Material (%)</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T2.5.1.1.1.1.4.2" style="padding-left:0.0pt;padding-right:0.0pt;">0.3</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T2.5.1.1.1.1.4.3" style="padding-left:0.0pt;padding-right:0.0pt;">0.4</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T2.5.1.1.1.1.4.4" style="padding-left:0.0pt;padding-right:0.0pt;">0.0</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T2.5.1.1.1.1.4.5" style="padding-left:0.0pt;padding-right:0.0pt;"><span class="ltx_text ltx_font_italic" id="S5.T2.5.1.1.1.1.4.5.1" style="background-color:#EBEBEB;">4.8</span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T2.5.1.1.1.1.4.6" style="padding-left:0.0pt;padding-right:0.0pt;">0.8</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T2.5.1.1.1.1.4.7" style="padding-left:0.0pt;padding-right:0.0pt;">1.6</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T2.5.1.1.1.1.4.8" style="padding-left:0.0pt;padding-right:0.0pt;">1.2</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T2.5.1.1.1.1.4.9" style="padding-left:0.0pt;padding-right:0.0pt;">1.7</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T2.5.1.1.1.1.4.10" style="padding-left:0.0pt;padding-right:0.0pt;">0.8</td>
</tr>
</tbody></table>
</td>
</tr>
<tr class="ltx_tr" id="S5.T2.5.1.2">
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb ltx_border_t" id="S5.T2.5.1.2.1" style="background-color:#FFD9D9;padding-left:0.0pt;padding-right:0.0pt;">
<table class="ltx_tabular ltx_align_middle" id="S5.T2.5.1.2.1.1">
<tbody><tr class="ltx_tr" id="S5.T2.5.1.2.1.1.1">
<td class="ltx_td ltx_nopad_l ltx_nopad_r" id="S5.T2.5.1.2.1.1.1.1" style="padding-left:0.0pt;padding-right:0.0pt;"></td>
<td class="ltx_td ltx_nopad_l ltx_align_center" colspan="4" id="S5.T2.5.1.2.1.1.1.2" style="padding-left:0.0pt;padding-right:0.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.5.1.2.1.1.1.2.1">Supervised Fine-tuning</span></td>
<td class="ltx_td ltx_nopad_l ltx_align_center" colspan="3" id="S5.T2.5.1.2.1.1.1.3" style="padding-left:0.0pt;padding-right:0.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.5.1.2.1.1.1.3.1">Llamole</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.5.1.2.1.1.2">
<td class="ltx_td ltx_nopad_l ltx_nopad_r" id="S5.T2.5.1.2.1.1.2.1" style="padding-left:0.0pt;padding-right:0.0pt;"></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T2.5.1.2.1.1.2.2" style="padding-left:0.0pt;padding-right:0.0pt;">Mistral-7B</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T2.5.1.2.1.1.2.3" style="padding-left:0.0pt;padding-right:0.0pt;">Qwen2-7B</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T2.5.1.2.1.1.2.4" style="padding-left:0.0pt;padding-right:0.0pt;">Llama-3-8B</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T2.5.1.2.1.1.2.5" style="padding-left:0.0pt;padding-right:0.0pt;">Llama-3.1-8B</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T2.5.1.2.1.1.2.6" style="padding-left:0.0pt;padding-right:0.0pt;">Mistral-7B</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T2.5.1.2.1.1.2.7" style="padding-left:0.0pt;padding-right:0.0pt;">Qwen2-7B</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T2.5.1.2.1.1.2.8" style="padding-left:0.0pt;padding-right:0.0pt;">Llama-3.1-8B</td>
</tr>
<tr class="ltx_tr" id="S5.T2.5.1.2.1.1.3">
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_t" id="S5.T2.5.1.2.1.1.3.1" style="padding-left:0.0pt;padding-right:0.0pt;">Drug (%)</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T2.5.1.2.1.1.3.2" style="padding-left:0.0pt;padding-right:0.0pt;">1.5</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T2.5.1.2.1.1.3.3" style="padding-left:0.0pt;padding-right:0.0pt;">0.2</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T2.5.1.2.1.1.3.4" style="padding-left:0.0pt;padding-right:0.0pt;">0.6</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T2.5.1.2.1.1.3.5" style="padding-left:0.0pt;padding-right:0.0pt;">0.8</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T2.5.1.2.1.1.3.6" style="padding-left:0.0pt;padding-right:0.0pt;">29.9</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T2.5.1.2.1.1.3.7" style="padding-left:0.0pt;padding-right:0.0pt;">33.7</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T2.5.1.2.1.1.3.8" style="padding-left:0.0pt;padding-right:0.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.5.1.2.1.1.3.8.1" style="background-color:#FFD9D9;">35.1</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.5.1.2.1.1.4">
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" id="S5.T2.5.1.2.1.1.4.1" style="padding-left:0.0pt;padding-right:0.0pt;">Material (%)</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T2.5.1.2.1.1.4.2" style="padding-left:0.0pt;padding-right:0.0pt;">0.8</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T2.5.1.2.1.1.4.3" style="padding-left:0.0pt;padding-right:0.0pt;">0.1</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T2.5.1.2.1.1.4.4" style="padding-left:0.0pt;padding-right:0.0pt;">0.7</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T2.5.1.2.1.1.4.5" style="padding-left:0.0pt;padding-right:0.0pt;">0.8</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T2.5.1.2.1.1.4.6" style="padding-left:0.0pt;padding-right:0.0pt;">14.3</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T2.5.1.2.1.1.4.7" style="padding-left:0.0pt;padding-right:0.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.5.1.2.1.1.4.7.1" style="background-color:#FFD9D9;">17.9</span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S5.T2.5.1.2.1.1.4.8" style="padding-left:0.0pt;padding-right:0.0pt;">17.6</td>
</tr>
</tbody></table>
</td>
</tr>
</tbody></table>
</span></div>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S5.SS1.p4">
<p class="ltx_p" id="S5.SS1.p4.1">(3) <span class="ltx_text ltx_font_bold" id="S5.SS1.p4.1.1">Larger models without domain-specific adaptation do not necessarily perform better in molecular designs.</span> We calculate the average Pearson correlation coefficient between model size and molecular design metrics, yielding a value of 0.366, indicating a weak correlation (below 0.5) between size and performance. We also compare LLM performance with GraphGA, which has been shown to be simple yet powerful&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Gao et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib13" title="">2022</a>; Liu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib27" title="">2024c</a>)</cite>. Our observations confirm that GraphGA serves as a strong molecular design baseline, challenging most LLM models with ICL and SFT in generating molecules with precise multi-condition control.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>RQ2: Discussion on Controllable Molecular Generation</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="S5.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="189" id="S5.F6.g1" src="https://arxiv.org/html/2410.04223v1/x7.png" width="747">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Ablation Studies for the Graph DiT Module in Llamole: First, we remove the text conditions from the input, i.e., <math alttext="\mathbf{c}_{\text{text}}=\emptyset" class="ltx_Math" display="inline" id="S5.F6.3.m1.1"><semantics id="S5.F6.3.m1.1b"><mrow id="S5.F6.3.m1.1.1" xref="S5.F6.3.m1.1.1.cmml"><msub id="S5.F6.3.m1.1.1.2" xref="S5.F6.3.m1.1.1.2.cmml"><mi id="S5.F6.3.m1.1.1.2.2" xref="S5.F6.3.m1.1.1.2.2.cmml">𝐜</mi><mtext id="S5.F6.3.m1.1.1.2.3" xref="S5.F6.3.m1.1.1.2.3a.cmml">text</mtext></msub><mo id="S5.F6.3.m1.1.1.1" xref="S5.F6.3.m1.1.1.1.cmml">=</mo><mi id="S5.F6.3.m1.1.1.3" mathvariant="normal" xref="S5.F6.3.m1.1.1.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.F6.3.m1.1c"><apply id="S5.F6.3.m1.1.1.cmml" xref="S5.F6.3.m1.1.1"><eq id="S5.F6.3.m1.1.1.1.cmml" xref="S5.F6.3.m1.1.1.1"></eq><apply id="S5.F6.3.m1.1.1.2.cmml" xref="S5.F6.3.m1.1.1.2"><csymbol cd="ambiguous" id="S5.F6.3.m1.1.1.2.1.cmml" xref="S5.F6.3.m1.1.1.2">subscript</csymbol><ci id="S5.F6.3.m1.1.1.2.2.cmml" xref="S5.F6.3.m1.1.1.2.2">𝐜</ci><ci id="S5.F6.3.m1.1.1.2.3a.cmml" xref="S5.F6.3.m1.1.1.2.3"><mtext id="S5.F6.3.m1.1.1.2.3.cmml" mathsize="70%" xref="S5.F6.3.m1.1.1.2.3">text</mtext></ci></apply><emptyset id="S5.F6.3.m1.1.1.3.cmml" xref="S5.F6.3.m1.1.1.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F6.3.m1.1d">\mathbf{c}_{\text{text}}=\emptyset</annotation><annotation encoding="application/x-llamapun" id="S5.F6.3.m1.1e">bold_c start_POSTSUBSCRIPT text end_POSTSUBSCRIPT = ∅</annotation></semantics></math>. Next, we remove both text and property conditions, <math alttext="\{c_{i}\}_{i}^{M}\cup\mathbf{c}_{\text{text}}" class="ltx_Math" display="inline" id="S5.F6.4.m2.1"><semantics id="S5.F6.4.m2.1b"><mrow id="S5.F6.4.m2.1.1" xref="S5.F6.4.m2.1.1.cmml"><msubsup id="S5.F6.4.m2.1.1.1" xref="S5.F6.4.m2.1.1.1.cmml"><mrow id="S5.F6.4.m2.1.1.1.1.1.1" xref="S5.F6.4.m2.1.1.1.1.1.2.cmml"><mo id="S5.F6.4.m2.1.1.1.1.1.1.2" stretchy="false" xref="S5.F6.4.m2.1.1.1.1.1.2.cmml">{</mo><msub id="S5.F6.4.m2.1.1.1.1.1.1.1" xref="S5.F6.4.m2.1.1.1.1.1.1.1.cmml"><mi id="S5.F6.4.m2.1.1.1.1.1.1.1.2" xref="S5.F6.4.m2.1.1.1.1.1.1.1.2.cmml">c</mi><mi id="S5.F6.4.m2.1.1.1.1.1.1.1.3" xref="S5.F6.4.m2.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S5.F6.4.m2.1.1.1.1.1.1.3" stretchy="false" xref="S5.F6.4.m2.1.1.1.1.1.2.cmml">}</mo></mrow><mi id="S5.F6.4.m2.1.1.1.1.3" xref="S5.F6.4.m2.1.1.1.1.3.cmml">i</mi><mi id="S5.F6.4.m2.1.1.1.3" xref="S5.F6.4.m2.1.1.1.3.cmml">M</mi></msubsup><mo id="S5.F6.4.m2.1.1.2" xref="S5.F6.4.m2.1.1.2.cmml">∪</mo><msub id="S5.F6.4.m2.1.1.3" xref="S5.F6.4.m2.1.1.3.cmml"><mi id="S5.F6.4.m2.1.1.3.2" xref="S5.F6.4.m2.1.1.3.2.cmml">𝐜</mi><mtext id="S5.F6.4.m2.1.1.3.3" xref="S5.F6.4.m2.1.1.3.3a.cmml">text</mtext></msub></mrow><annotation-xml encoding="MathML-Content" id="S5.F6.4.m2.1c"><apply id="S5.F6.4.m2.1.1.cmml" xref="S5.F6.4.m2.1.1"><union id="S5.F6.4.m2.1.1.2.cmml" xref="S5.F6.4.m2.1.1.2"></union><apply id="S5.F6.4.m2.1.1.1.cmml" xref="S5.F6.4.m2.1.1.1"><csymbol cd="ambiguous" id="S5.F6.4.m2.1.1.1.2.cmml" xref="S5.F6.4.m2.1.1.1">superscript</csymbol><apply id="S5.F6.4.m2.1.1.1.1.cmml" xref="S5.F6.4.m2.1.1.1"><csymbol cd="ambiguous" id="S5.F6.4.m2.1.1.1.1.2.cmml" xref="S5.F6.4.m2.1.1.1">subscript</csymbol><set id="S5.F6.4.m2.1.1.1.1.1.2.cmml" xref="S5.F6.4.m2.1.1.1.1.1.1"><apply id="S5.F6.4.m2.1.1.1.1.1.1.1.cmml" xref="S5.F6.4.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.F6.4.m2.1.1.1.1.1.1.1.1.cmml" xref="S5.F6.4.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S5.F6.4.m2.1.1.1.1.1.1.1.2.cmml" xref="S5.F6.4.m2.1.1.1.1.1.1.1.2">𝑐</ci><ci id="S5.F6.4.m2.1.1.1.1.1.1.1.3.cmml" xref="S5.F6.4.m2.1.1.1.1.1.1.1.3">𝑖</ci></apply></set><ci id="S5.F6.4.m2.1.1.1.1.3.cmml" xref="S5.F6.4.m2.1.1.1.1.3">𝑖</ci></apply><ci id="S5.F6.4.m2.1.1.1.3.cmml" xref="S5.F6.4.m2.1.1.1.3">𝑀</ci></apply><apply id="S5.F6.4.m2.1.1.3.cmml" xref="S5.F6.4.m2.1.1.3"><csymbol cd="ambiguous" id="S5.F6.4.m2.1.1.3.1.cmml" xref="S5.F6.4.m2.1.1.3">subscript</csymbol><ci id="S5.F6.4.m2.1.1.3.2.cmml" xref="S5.F6.4.m2.1.1.3.2">𝐜</ci><ci id="S5.F6.4.m2.1.1.3.3a.cmml" xref="S5.F6.4.m2.1.1.3.3"><mtext id="S5.F6.4.m2.1.1.3.3.cmml" mathsize="70%" xref="S5.F6.4.m2.1.1.3.3">text</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F6.4.m2.1d">\{c_{i}\}_{i}^{M}\cup\mathbf{c}_{\text{text}}</annotation><annotation encoding="application/x-llamapun" id="S5.F6.4.m2.1e">{ italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT ∪ bold_c start_POSTSUBSCRIPT text end_POSTSUBSCRIPT</annotation></semantics></math>. There are learned embeddings that represent the “null” value for different conditions.
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsubsection" id="S5.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.2.1 </span>Ablation Studies on LLM and Graph DiT Synergy</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S5.SS2.SSS1.p1">
<p class="ltx_p" id="S5.SS2.SSS1.p1.3">We investigate the synergy effect of Graph DiT and LLM in Llamole for molecule controllability.
We first remove text conditions <math alttext="\mathbf{c}_{\text{text}}" class="ltx_Math" display="inline" id="S5.SS2.SSS1.p1.1.m1.1"><semantics id="S5.SS2.SSS1.p1.1.m1.1a"><msub id="S5.SS2.SSS1.p1.1.m1.1.1" xref="S5.SS2.SSS1.p1.1.m1.1.1.cmml"><mi id="S5.SS2.SSS1.p1.1.m1.1.1.2" xref="S5.SS2.SSS1.p1.1.m1.1.1.2.cmml">𝐜</mi><mtext id="S5.SS2.SSS1.p1.1.m1.1.1.3" xref="S5.SS2.SSS1.p1.1.m1.1.1.3a.cmml">text</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS1.p1.1.m1.1b"><apply id="S5.SS2.SSS1.p1.1.m1.1.1.cmml" xref="S5.SS2.SSS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS2.SSS1.p1.1.m1.1.1.1.cmml" xref="S5.SS2.SSS1.p1.1.m1.1.1">subscript</csymbol><ci id="S5.SS2.SSS1.p1.1.m1.1.1.2.cmml" xref="S5.SS2.SSS1.p1.1.m1.1.1.2">𝐜</ci><ci id="S5.SS2.SSS1.p1.1.m1.1.1.3a.cmml" xref="S5.SS2.SSS1.p1.1.m1.1.1.3"><mtext id="S5.SS2.SSS1.p1.1.m1.1.1.3.cmml" mathsize="70%" xref="S5.SS2.SSS1.p1.1.m1.1.1.3">text</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS1.p1.1.m1.1c">\mathbf{c}_{\text{text}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.SSS1.p1.1.m1.1d">bold_c start_POSTSUBSCRIPT text end_POSTSUBSCRIPT</annotation></semantics></math>. In this case, Graph DiT uses a learned “null” embedding to represent the dropped condition <math alttext="\mathbf{c}_{\text{text}}=\emptyset" class="ltx_Math" display="inline" id="S5.SS2.SSS1.p1.2.m2.1"><semantics id="S5.SS2.SSS1.p1.2.m2.1a"><mrow id="S5.SS2.SSS1.p1.2.m2.1.1" xref="S5.SS2.SSS1.p1.2.m2.1.1.cmml"><msub id="S5.SS2.SSS1.p1.2.m2.1.1.2" xref="S5.SS2.SSS1.p1.2.m2.1.1.2.cmml"><mi id="S5.SS2.SSS1.p1.2.m2.1.1.2.2" xref="S5.SS2.SSS1.p1.2.m2.1.1.2.2.cmml">𝐜</mi><mtext id="S5.SS2.SSS1.p1.2.m2.1.1.2.3" xref="S5.SS2.SSS1.p1.2.m2.1.1.2.3a.cmml">text</mtext></msub><mo id="S5.SS2.SSS1.p1.2.m2.1.1.1" xref="S5.SS2.SSS1.p1.2.m2.1.1.1.cmml">=</mo><mi id="S5.SS2.SSS1.p1.2.m2.1.1.3" mathvariant="normal" xref="S5.SS2.SSS1.p1.2.m2.1.1.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS1.p1.2.m2.1b"><apply id="S5.SS2.SSS1.p1.2.m2.1.1.cmml" xref="S5.SS2.SSS1.p1.2.m2.1.1"><eq id="S5.SS2.SSS1.p1.2.m2.1.1.1.cmml" xref="S5.SS2.SSS1.p1.2.m2.1.1.1"></eq><apply id="S5.SS2.SSS1.p1.2.m2.1.1.2.cmml" xref="S5.SS2.SSS1.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S5.SS2.SSS1.p1.2.m2.1.1.2.1.cmml" xref="S5.SS2.SSS1.p1.2.m2.1.1.2">subscript</csymbol><ci id="S5.SS2.SSS1.p1.2.m2.1.1.2.2.cmml" xref="S5.SS2.SSS1.p1.2.m2.1.1.2.2">𝐜</ci><ci id="S5.SS2.SSS1.p1.2.m2.1.1.2.3a.cmml" xref="S5.SS2.SSS1.p1.2.m2.1.1.2.3"><mtext id="S5.SS2.SSS1.p1.2.m2.1.1.2.3.cmml" mathsize="70%" xref="S5.SS2.SSS1.p1.2.m2.1.1.2.3">text</mtext></ci></apply><emptyset id="S5.SS2.SSS1.p1.2.m2.1.1.3.cmml" xref="S5.SS2.SSS1.p1.2.m2.1.1.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS1.p1.2.m2.1c">\mathbf{c}_{\text{text}}=\emptyset</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.SSS1.p1.2.m2.1d">bold_c start_POSTSUBSCRIPT text end_POSTSUBSCRIPT = ∅</annotation></semantics></math>.
Next, we remove the drug or material property conditions <math alttext="\{c_{i}\}_{i}^{M}" class="ltx_Math" display="inline" id="S5.SS2.SSS1.p1.3.m3.1"><semantics id="S5.SS2.SSS1.p1.3.m3.1a"><msubsup id="S5.SS2.SSS1.p1.3.m3.1.1" xref="S5.SS2.SSS1.p1.3.m3.1.1.cmml"><mrow id="S5.SS2.SSS1.p1.3.m3.1.1.1.1.1" xref="S5.SS2.SSS1.p1.3.m3.1.1.1.1.2.cmml"><mo id="S5.SS2.SSS1.p1.3.m3.1.1.1.1.1.2" stretchy="false" xref="S5.SS2.SSS1.p1.3.m3.1.1.1.1.2.cmml">{</mo><msub id="S5.SS2.SSS1.p1.3.m3.1.1.1.1.1.1" xref="S5.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.cmml"><mi id="S5.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.2" xref="S5.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.2.cmml">c</mi><mi id="S5.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.3" xref="S5.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S5.SS2.SSS1.p1.3.m3.1.1.1.1.1.3" stretchy="false" xref="S5.SS2.SSS1.p1.3.m3.1.1.1.1.2.cmml">}</mo></mrow><mi id="S5.SS2.SSS1.p1.3.m3.1.1.1.3" xref="S5.SS2.SSS1.p1.3.m3.1.1.1.3.cmml">i</mi><mi id="S5.SS2.SSS1.p1.3.m3.1.1.3" xref="S5.SS2.SSS1.p1.3.m3.1.1.3.cmml">M</mi></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS1.p1.3.m3.1b"><apply id="S5.SS2.SSS1.p1.3.m3.1.1.cmml" xref="S5.SS2.SSS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS2.SSS1.p1.3.m3.1.1.2.cmml" xref="S5.SS2.SSS1.p1.3.m3.1.1">superscript</csymbol><apply id="S5.SS2.SSS1.p1.3.m3.1.1.1.cmml" xref="S5.SS2.SSS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS2.SSS1.p1.3.m3.1.1.1.2.cmml" xref="S5.SS2.SSS1.p1.3.m3.1.1">subscript</csymbol><set id="S5.SS2.SSS1.p1.3.m3.1.1.1.1.2.cmml" xref="S5.SS2.SSS1.p1.3.m3.1.1.1.1.1"><apply id="S5.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.cmml" xref="S5.SS2.SSS1.p1.3.m3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.1.cmml" xref="S5.SS2.SSS1.p1.3.m3.1.1.1.1.1.1">subscript</csymbol><ci id="S5.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.2.cmml" xref="S5.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.2">𝑐</ci><ci id="S5.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.3.cmml" xref="S5.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.3">𝑖</ci></apply></set><ci id="S5.SS2.SSS1.p1.3.m3.1.1.1.3.cmml" xref="S5.SS2.SSS1.p1.3.m3.1.1.1.3">𝑖</ci></apply><ci id="S5.SS2.SSS1.p1.3.m3.1.1.3.cmml" xref="S5.SS2.SSS1.p1.3.m3.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS1.p1.3.m3.1c">\{c_{i}\}_{i}^{M}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.SSS1.p1.3.m3.1d">{ italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT</annotation></semantics></math> associated with the question.
Results in&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S5.F6" title="In 5.2 RQ2: Discussion on Controllable Molecular Generation ‣ 5 Experiment ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Figure</span>&nbsp;<span class="ltx_text ltx_ref_tag">6</span></a> show that text instructions enhance the chemical structure understanding ability of Graph DiT, while Llamole leverages Graph DiT’s capabilities with property inputs to generate molecules with desirable properties.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="S5.F7"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="395" id="S5.F7.g1" src="https://arxiv.org/html/2410.04223v1/x8.png" width="830">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Interleaved generation with the base Qwen2-7B: Red indicates positions where molecules and reactions (with templates) are generated, forming three parts. The properties of the designed molecules are obtained from the oracle. Reference and other LLM responses are shown in&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A4.F9" title="In D.3 Additional Discussion on Case Studies ‣ Appendix D Additional Experimental Details and Discussions ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Figure</span>&nbsp;<span class="ltx_text ltx_ref_tag">9</span></a>.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_subsubsection" id="S5.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.2.2 </span>Case Studies for Property and Structure Controllability</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S5.SS2.SSS2.p1">
<p class="ltx_p" id="S5.SS2.SSS2.p1.1">In&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S5.F7" title="In 5.2.1 Ablation Studies on LLM and Graph DiT Synergy ‣ 5.2 RQ2: Discussion on Controllable Molecular Generation ‣ 5 Experiment ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Figure</span>&nbsp;<span class="ltx_text ltx_ref_tag">7</span></a>, Llamole can design a satisfactory molecule that meets both functional and structural constraints. Functionally, the oracle function confirms that the properties of BACE and HIV align with the criteria. Structurally, all key criteria are satisfied, including molecular weight, “two aromatic rings,” and “connected to aliphatic chains.” Llamole also adds details for structure design, such as a carboxyl (<span class="ltx_ERROR undefined" id="S5.SS2.SSS2.p1.1.1">\ce</span>-COOH) group and an amino group (<span class="ltx_ERROR undefined" id="S5.SS2.SSS2.p1.1.2">\ce</span>-NH2). While the amino group is present in the structure, it is connected to the carbonyl group (<span class="ltx_ERROR undefined" id="S5.SS2.SSS2.p1.1.3">\ce</span>-C(=O)-) instead of the carboxyl group. This subtle difference may require precise control based on the text condition. More results are in&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A4.SS3" title="D.3 Additional Discussion on Case Studies ‣ Appendix D Additional Experimental Details and Discussions ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Section</span>&nbsp;<span class="ltx_text ltx_ref_tag">D.3</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>RQ3: Discussion on Retrosynthetic Planning</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure ltx_align_floatright" id="S5.F8"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="260" id="S5.F8.g1" src="https://arxiv.org/html/2410.04223v1/x9.png" width="415">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Error Analysis in Reaction Generation</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.1">Retrosynthesis challenges LLMs in two aspects: (1) one-step reaction generation and (2) multi-step planning. <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S5.T2" title="In 5.1 RQ1: LLMs for Controllable and Synthesizable Molecular Design ‣ 5 Experiment ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Table</span>&nbsp;<span class="ltx_text ltx_ref_tag">2</span></a> highlights the weaknesses of LLMs with ICL and SFT in overall planning ability and the promise of Llamole.
We examine the failure reasons in LLMs and the synergy between the GNN and LLMs to avoid them.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_subsubsection" id="S5.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.3.1 </span>One-step Reaction Generation</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S5.SS3.SSS1.p1">
<p class="ltx_p" id="S5.SS3.SSS1.p1.1">We conduct error analysis for LLMs in reaction generation. Results in&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S5.F8" title="In 5.3 RQ3: Discussion on Retrosynthetic Planning ‣ 5 Experiment ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Figure</span>&nbsp;<span class="ltx_text ltx_ref_tag">8</span></a> average performance across all LLMs using ICL or SFT methods. We identify five types of errors related to instruction adherence, format compliance, and template matching. We find that LLMs using ICL frequently fail to follow instructions for generating reactions in text format, with a high probability (68.4%) of not producing valid formats and templates. In contrast, LLMs with SFT reduce this probability to 57.6%. However, neither ICL nor SFT guarantees that the templates are correct or match the generated reactions.
In comparison, Llamole avoids these errors by using GNN predictors, which estimate probabilities for over 300K templates derived from USPTO reactions. This enables Llamole to apply templates directly to derive reactions in retrosynthesis, avoiding hallucination.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsubsection" id="S5.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.3.2 </span>Multi-step Retrosynthetic Planning</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S5.SS3.SSS2.p1">
<p class="ltx_p" id="S5.SS3.SSS2.p1.1">From the success cases in&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S5.T2" title="In 5.1 RQ1: LLMs for Controllable and Synthesizable Molecular Design ‣ 5 Experiment ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Table</span>&nbsp;<span class="ltx_text ltx_ref_tag">2</span></a>, we find that 96.40% of 777 success cases in ICL-adapted LLMs and 94.14% of 324 success cases in SFT-adapted LLMs arise from one-step reaction generation. However, not all designed molecules can be synthesized via one-step reactions. Compared to LLMs, Llamole achieves over 10K success cases, with 40.48% resulting from two or more steps.
<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S5.F7" title="In 5.2.1 Ablation Studies on LLM and Graph DiT Synergy ‣ 5.2 RQ2: Discussion on Controllable Molecular Generation ‣ 5 Experiment ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Figure</span>&nbsp;<span class="ltx_text ltx_ref_tag">7</span></a> illustrates a two-step planning case for the designed molecule. The generation interleaves reaction conditions and specific formulas based on the template in both steps.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table ltx_align_floatright" id="S5.T3">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Analysis of <math alttext="J_{\text{heuristics}}" class="ltx_Math" display="inline" id="S5.T3.2.m1.1"><semantics id="S5.T3.2.m1.1b"><msub id="S5.T3.2.m1.1.1" xref="S5.T3.2.m1.1.1.cmml"><mi id="S5.T3.2.m1.1.1.2" xref="S5.T3.2.m1.1.1.2.cmml">J</mi><mtext id="S5.T3.2.m1.1.1.3" xref="S5.T3.2.m1.1.1.3a.cmml">heuristics</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.T3.2.m1.1c"><apply id="S5.T3.2.m1.1.1.cmml" xref="S5.T3.2.m1.1.1"><csymbol cd="ambiguous" id="S5.T3.2.m1.1.1.1.cmml" xref="S5.T3.2.m1.1.1">subscript</csymbol><ci id="S5.T3.2.m1.1.1.2.cmml" xref="S5.T3.2.m1.1.1.2">𝐽</ci><ci id="S5.T3.2.m1.1.1.3a.cmml" xref="S5.T3.2.m1.1.1.3"><mtext id="S5.T3.2.m1.1.1.3.cmml" mathsize="70%" xref="S5.T3.2.m1.1.1.3">heuristics</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.2.m1.1d">J_{\text{heuristics}}</annotation><annotation encoding="application/x-llamapun" id="S5.T3.2.m1.1e">italic_J start_POSTSUBSCRIPT heuristics end_POSTSUBSCRIPT</annotation></semantics></math> and Planning Time on Material Questions</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S5.T3.3" style="width:242.9pt;height:79.2pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<p class="ltx_p" id="S5.T3.3.1"><span class="ltx_text" id="S5.T3.3.1.1">
<span class="ltx_tabular ltx_align_middle" id="S5.T3.3.1.1.1">
<span class="ltx_tr" id="S5.T3.3.1.1.1.1">
<span class="ltx_td ltx_align_left ltx_border_tt" id="S5.T3.3.1.1.1.1.1">
<span class="ltx_inline-block" id="S5.T3.3.1.1.1.1.1.1">
<span class="ltx_p" id="S5.T3.3.1.1.1.1.1.1.1">Base</span>
<span class="ltx_p" id="S5.T3.3.1.1.1.1.1.1.2">LLM</span>
</span></span>
<span class="ltx_td ltx_align_center ltx_border_tt" id="S5.T3.3.1.1.1.1.2">Default</span>
<span class="ltx_td ltx_align_center ltx_border_tt" id="S5.T3.3.1.1.1.1.3">
<span class="ltx_inline-block" id="S5.T3.3.1.1.1.1.3.1">
<span class="ltx_p" id="S5.T3.3.1.1.1.1.3.1.1">w/ Domain</span>
<span class="ltx_p" id="S5.T3.3.1.1.1.1.3.1.2">Heuristics</span>
</span></span>
<span class="ltx_td ltx_align_center ltx_border_tt" id="S5.T3.3.1.1.1.1.4">
<span class="ltx_inline-block" id="S5.T3.3.1.1.1.1.4.1">
<span class="ltx_p" id="S5.T3.3.1.1.1.1.4.1.1">w/ Unlimited</span>
<span class="ltx_p" id="S5.T3.3.1.1.1.1.4.1.2">Time</span>
</span></span></span>
<span class="ltx_tr" id="S5.T3.3.1.1.1.2">
<span class="ltx_td ltx_align_left ltx_border_t" id="S5.T3.3.1.1.1.2.1">Llama-3.1</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.1.1.1.2.2">0.176</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.1.1.1.2.3">0.176</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.1.1.1.2.4">0.312</span></span>
<span class="ltx_tr" id="S5.T3.3.1.1.1.3">
<span class="ltx_td ltx_align_left" id="S5.T3.3.1.1.1.3.1">Mistral</span>
<span class="ltx_td ltx_align_center" id="S5.T3.3.1.1.1.3.2">0.143</span>
<span class="ltx_td ltx_align_center" id="S5.T3.3.1.1.1.3.3">0.147</span>
<span class="ltx_td ltx_align_center" id="S5.T3.3.1.1.1.3.4">0.273</span></span>
<span class="ltx_tr" id="S5.T3.3.1.1.1.4">
<span class="ltx_td ltx_align_left ltx_border_bb" id="S5.T3.3.1.1.1.4.1">Qwen2</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.3.1.1.1.4.2">0.179</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.3.1.1.1.4.3">0.181</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.3.1.1.1.4.4">0.273</span></span>
</span></span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</span></div>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S5.SS3.SSS2.p2">
<p class="ltx_p" id="S5.SS3.SSS2.p2.2">Llamole is influenced by two factors for retrosynthesis: (1) the size of the search space and (2) the quality of the cost <math alttext="J_{\text{heuristic}}" class="ltx_Math" display="inline" id="S5.SS3.SSS2.p2.1.m1.1"><semantics id="S5.SS3.SSS2.p2.1.m1.1a"><msub id="S5.SS3.SSS2.p2.1.m1.1.1" xref="S5.SS3.SSS2.p2.1.m1.1.1.cmml"><mi id="S5.SS3.SSS2.p2.1.m1.1.1.2" xref="S5.SS3.SSS2.p2.1.m1.1.1.2.cmml">J</mi><mtext id="S5.SS3.SSS2.p2.1.m1.1.1.3" xref="S5.SS3.SSS2.p2.1.m1.1.1.3a.cmml">heuristic</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.SSS2.p2.1.m1.1b"><apply id="S5.SS3.SSS2.p2.1.m1.1.1.cmml" xref="S5.SS3.SSS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS3.SSS2.p2.1.m1.1.1.1.cmml" xref="S5.SS3.SSS2.p2.1.m1.1.1">subscript</csymbol><ci id="S5.SS3.SSS2.p2.1.m1.1.1.2.cmml" xref="S5.SS3.SSS2.p2.1.m1.1.1.2">𝐽</ci><ci id="S5.SS3.SSS2.p2.1.m1.1.1.3a.cmml" xref="S5.SS3.SSS2.p2.1.m1.1.1.3"><mtext id="S5.SS3.SSS2.p2.1.m1.1.1.3.cmml" mathsize="70%" xref="S5.SS3.SSS2.p2.1.m1.1.1.3">heuristic</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSS2.p2.1.m1.1c">J_{\text{heuristic}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSS2.p2.1.m1.1d">italic_J start_POSTSUBSCRIPT heuristic end_POSTSUBSCRIPT</annotation></semantics></math>. The results reported in&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S5.T2" title="In 5.1 RQ1: LLMs for Controllable and Synthesizable Molecular Design ‣ 5 Experiment ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Table</span>&nbsp;<span class="ltx_text ltx_ref_tag">2</span></a> limited the total planning time to 30 seconds (on an A6000 card). We remove this time constraint and report comparisons for material tasks in&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S5.T3" title="In 5.3.2 Multi-step Retrosynthetic Planning ‣ 5.3 RQ3: Discussion on Retrosynthetic Planning ‣ 5 Experiment ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Table</span>&nbsp;<span class="ltx_text ltx_ref_tag">3</span></a>. We find that success rates for all base LLMs significantly improve, but this comes at the cost of long inference time.
While there is a trade-off between efficiency and effectiveness, extending response time by a few minutes is often acceptable to improve the success rate of finding synthesis paths for a single designed molecule. In&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S5.T3" title="In 5.3.2 Multi-step Retrosynthetic Planning ‣ 5.3 RQ3: Discussion on Retrosynthetic Planning ‣ 5 Experiment ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Table</span>&nbsp;<span class="ltx_text ltx_ref_tag">3</span></a>, we also compare the <math alttext="J_{\text{heuristics}}" class="ltx_Math" display="inline" id="S5.SS3.SSS2.p2.2.m2.1"><semantics id="S5.SS3.SSS2.p2.2.m2.1a"><msub id="S5.SS3.SSS2.p2.2.m2.1.1" xref="S5.SS3.SSS2.p2.2.m2.1.1.cmml"><mi id="S5.SS3.SSS2.p2.2.m2.1.1.2" xref="S5.SS3.SSS2.p2.2.m2.1.1.2.cmml">J</mi><mtext id="S5.SS3.SSS2.p2.2.m2.1.1.3" xref="S5.SS3.SSS2.p2.2.m2.1.1.3a.cmml">heuristics</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.SSS2.p2.2.m2.1b"><apply id="S5.SS3.SSS2.p2.2.m2.1.1.cmml" xref="S5.SS3.SSS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS3.SSS2.p2.2.m2.1.1.1.cmml" xref="S5.SS3.SSS2.p2.2.m2.1.1">subscript</csymbol><ci id="S5.SS3.SSS2.p2.2.m2.1.1.2.cmml" xref="S5.SS3.SSS2.p2.2.m2.1.1.2">𝐽</ci><ci id="S5.SS3.SSS2.p2.2.m2.1.1.3a.cmml" xref="S5.SS3.SSS2.p2.2.m2.1.1.3"><mtext id="S5.SS3.SSS2.p2.2.m2.1.1.3.cmml" mathsize="70%" xref="S5.SS3.SSS2.p2.2.m2.1.1.3">heuristics</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSS2.p2.2.m2.1c">J_{\text{heuristics}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSS2.p2.2.m2.1d">italic_J start_POSTSUBSCRIPT heuristics end_POSTSUBSCRIPT</annotation></semantics></math> designed by LLMs (default) with the domain model trained from&nbsp;<cite class="ltx_cite ltx_citemacro_cite">Chen et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib5" title="">2020</a>)</cite>. we find that LLMs are competitive with these domain models in providing the cost function for A*, contrasting with previous observations where LLMs struggled with retrosynthetic planning.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Related Work</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">Since the emergence of ChatGPT&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Achiam et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib2" title="">2023</a>)</cite>, LLMs&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Dubey et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib10" title="">2024</a>)</cite> have become foundation models for text-based problems and are revolutionizing domains like vision and speech&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Dong et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib9" title="">2023</a>; Wu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib42" title="">2024</a>)</cite>. These advancements extend to chemistry, biology, and material sciences, focusing on molecules&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Guo et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib14" title="">2023</a>; Jablonka et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib17" title="">2023</a>; Jin et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib19" title="">2023</a>)</cite>. Prior work explores LLMs in molecular generation, property prediction, and one-step reaction prediction in retrosynthesis&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Guo et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib14" title="">2023</a>; Jablonka et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib17" title="">2023</a>)</cite>. A key lesson is the limitation of LLMs in sequential modeling of molecules (e.g., SMILES or SELFIES)&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Guo et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib14" title="">2023</a>)</cite>. Multimodal LMs have been developed in combination with GNNs&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Zhao et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib47" title="">2023</a>; Liu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib28" title="">2023b</a>)</cite>, but they have not been scaled up to leverage LLMs with at least 7 billion parameters.
Additionally, LLMs struggle with planning tasks&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Kambhampati et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib21" title="">2024</a>)</cite>, which are essential for retrosynthesis. We address these issues using graph-text multimodal LLMs, augmented by A* for efficient planning.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S6.p2">
<p class="ltx_p" id="S6.p2.1">Domain-specific molecular design methods have evolved from sequential models&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Segler et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib35" title="">2018</a>)</cite> to graph diffusion models&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Jo et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib20" title="">2022</a>; Vignac et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib40" title="">2022</a>; Liu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib27" title="">2024c</a>)</cite>. Studies show that older graph-based methods like GraphGA remain competitive&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Gao et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib13" title="">2022</a>)</cite>. To incorporate property constraints, one can use molecular optimization approaches such as Bayesian optimization or REINFORCE&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Gao et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib13" title="">2022</a>)</cite>, or employ diffusion models with or without predictor guidance&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Vignac et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib40" title="">2022</a>; Liu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib27" title="">2024c</a>)</cite>.
For synthesizable molecular design, prior work has focused on bottom-up methods&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Gao et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib12" title="">2021</a>; Sun et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib37" title="">2024</a>)</cite>. These methods explore a chemical space defined by a discrete action space of reaction templates and purchasable starting materials, which may limit flexibility. Thus, retrosynthesis algorithms&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Chen et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib5" title="">2020</a>)</cite> are also studied as separate solutions to find synthesis routes for generated molecules in a top-down manner.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_section" id="S7">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Conclusion</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S7.p1">
<p class="ltx_p" id="S7.p1.1">We have presented the first graph-text MLLM, Llamole, for multi-conditional molecular generation and retrosynthetic planning. By integrating a base LLM with specialized graph modules, Llamole interleaved the generation of text, molecular graphs, and reactions, enabling controllable and synthesizable designs. Extensive benchmarking against 14 LLMs revealed their limitations in controlling molecular structures and planning synthesis routes. In contrast, Llamole significantly outperformed these LLMs. These findings underscored the value of multimodal approaches in molecular discovery and highlighted Llamole’s potential to connect text and chemical structures. The new benchmarking dataset also laid the groundwork for future MLLM research in molecular applications.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Abdelaziz et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Ibrahim Abdelaziz, Kinjal Basu, Mayank Agarwal, Sadhana Kumaravel, Matthew Stallone, Rameswar Panda, Yara Rizk, GP&nbsp;Bhargav, Maxwell Crouse, Chulaka Gunasekara, et&nbsp;al.

</span>
<span class="ltx_bibblock">Granite-function calling model: Introducing function calling abilities via multi-task learning of granular tasks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">arXiv preprint arXiv:2407.00121</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Achiam et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Josh Achiam, Steven Adler, Sandhini Agarwal, Lama Ahmad, Ilge Akkaya, Florencia&nbsp;Leoni Aleman, Diogo Almeida, Janko Altenschmidt, Sam Altman, Shyamal Anadkat, et&nbsp;al.

</span>
<span class="ltx_bibblock">Gpt-4 technical report.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">arXiv preprint arXiv:2303.08774</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Austin et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jacob Austin, Daniel&nbsp;D Johnson, Jonathan Ho, Daniel Tarlow, and Rianne Van Den&nbsp;Berg.

</span>
<span class="ltx_bibblock">Structured denoising diffusion models in discrete state-spaces.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">Advances in Neural Information Processing Systems</em>, 34:17981–17993, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Beltagy et&nbsp;al. (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Iz&nbsp;Beltagy, Kyle Lo, and Arman Cohan.

</span>
<span class="ltx_bibblock">Scibert: A pretrained language model for scientific text.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">arXiv preprint arXiv:1903.10676</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Binghong Chen, Chengtao Li, Hanjun Dai, and Le&nbsp;Song.

</span>
<span class="ltx_bibblock">Retro*: learning retrosynthetic planning with neural guided a* search.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">International conference on machine learning</em>, pages 1608–1616. PMLR, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chung et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Hyung&nbsp;Won Chung, Le&nbsp;Hou, Shayne Longpre, Barret Zoph, Yi&nbsp;Tay, William Fedus, Yunxuan Li, Xuezhi Wang, Mostafa Dehghani, Siddhartha Brahma, et&nbsp;al.

</span>
<span class="ltx_bibblock">Scaling instruction-finetuned language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">Journal of Machine Learning Research</em>, 25(70):1–53, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Coley et&nbsp;al. (2018)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Connor&nbsp;W Coley, Luke Rogers, William&nbsp;H Green, and Klavs&nbsp;F Jensen.

</span>
<span class="ltx_bibblock">Scscore: synthetic complexity learned from a reaction corpus.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">Journal of chemical information and modeling</em>, 58(2):252–261, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Coley et&nbsp;al. (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Connor&nbsp;W Coley, William&nbsp;H Green, and Klavs&nbsp;F Jensen.

</span>
<span class="ltx_bibblock">Rdchiral: An rdkit wrapper for handling stereochemistry in retrosynthetic template extraction and application.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">Journal of chemical information and modeling</em>, 59(6):2529–2537, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dong et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Runpei Dong, Chunrui Han, Yuang Peng, Zekun Qi, Zheng Ge, Jinrong Yang, Liang Zhao, Jianjian Sun, Hongyu Zhou, Haoran Wei, et&nbsp;al.

</span>
<span class="ltx_bibblock">Dreamllm: Synergistic multimodal comprehension and creation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">arXiv preprint arXiv:2309.11499</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dubey et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Abhimanyu Dubey, Abhinav Jauhri, Abhinav Pandey, Abhishek Kadian, Ahmad Al-Dahle, Aiesha Letman, Akhil Mathur, Alan Schelten, Amy Yang, Angela Fan, et&nbsp;al.

</span>
<span class="ltx_bibblock">The llama 3 herd of models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">arXiv preprint arXiv:2407.21783</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ertl and Schuffenhauer (2009)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Peter Ertl and Ansgar Schuffenhauer.

</span>
<span class="ltx_bibblock">Estimation of synthetic accessibility score of drug-like molecules based on molecular complexity and fragment contributions.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">Journal of cheminformatics</em>, 1:1–11, 2009.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gao et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Wenhao Gao, Rocío Mercado, and Connor&nbsp;W Coley.

</span>
<span class="ltx_bibblock">Amortized tree generation for bottom-up synthesis planning and synthesizable molecular design.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">arXiv preprint arXiv:2110.06389</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gao et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Wenhao Gao, Tianfan Fu, Jimeng Sun, and Connor Coley.

</span>
<span class="ltx_bibblock">Sample efficiency matters: a benchmark for practical molecular optimization.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">Advances in neural information processing systems</em>, 35:21342–21357, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Taicheng Guo, Bozhao Nan, Zhenwen Liang, Zhichun Guo, Nitesh Chawla, Olaf Wiest, Xiangliang Zhang, et&nbsp;al.

</span>
<span class="ltx_bibblock">What can large language models do in chemistry? a comprehensive benchmark on eight tasks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">Advances in Neural Information Processing Systems</em>, 36:59662–59688, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ho and Salimans (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jonathan Ho and Tim Salimans.

</span>
<span class="ltx_bibblock">Classifier-free diffusion guidance.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">arXiv preprint arXiv:2207.12598</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Edward&nbsp;J Hu, Yelong Shen, Phillip Wallis, Zeyuan Allen-Zhu, Yuanzhi Li, Shean Wang, Lu&nbsp;Wang, and Weizhu Chen.

</span>
<span class="ltx_bibblock">Lora: Low-rank adaptation of large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">arXiv preprint arXiv:2106.09685</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jablonka et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Kevin&nbsp;Maik Jablonka, Qianxiang Ai, Alexander Al-Feghali, Shruti Badhwar, Joshua&nbsp;D Bocarsly, Andres&nbsp;M Bran, Stefan Bringuier, L&nbsp;Catherine Brinson, Kamal Choudhary, Defne Circi, et&nbsp;al.

</span>
<span class="ltx_bibblock">14 examples of how llms can transform materials science and chemistry: a reflection on a large language model hackathon.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">Digital Discovery</em>, 2(5):1233–1250, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Albert&nbsp;Q Jiang, Alexandre Sablayrolles, Arthur Mensch, Chris Bamford, Devendra&nbsp;Singh Chaplot, Diego de&nbsp;las Casas, Florian Bressand, Gianna Lengyel, Guillaume Lample, Lucile Saulnier, et&nbsp;al.

</span>
<span class="ltx_bibblock">Mistral 7b.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">arXiv preprint arXiv:2310.06825</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jin et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Bowen Jin, Gang Liu, Chi Han, Meng Jiang, Heng Ji, and Jiawei Han.

</span>
<span class="ltx_bibblock">Large language models on graphs: A comprehensive survey.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">arXiv preprint arXiv:2312.02783</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jo et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jaehyeong Jo, Seul Lee, and Sung&nbsp;Ju Hwang.

</span>
<span class="ltx_bibblock">Score-based generative modeling of graphs via the system of stochastic differential equations.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">International Conference on Machine Learning</em>, volume 162, pages 10362–10383. PMLR, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kambhampati et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Subbarao Kambhampati, Karthik Valmeekam, Lin Guan, Kaya Stechly, Mudit Verma, Siddhant Bhambri, Lucas Saldyt, and Anil Murthy.

</span>
<span class="ltx_bibblock">Llms can’t plan, but can help planning in llm-modulo frameworks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">arXiv preprint arXiv:2402.01817</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kim et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Sunghwan Kim, Jie Chen, Tiejun Cheng, Asta Gindulyte, Jia He, Siqian He, Qingliang Li, Benjamin&nbsp;A Shoemaker, Paul&nbsp;A Thiessen, Bo&nbsp;Yu, et&nbsp;al.

</span>
<span class="ltx_bibblock">Pubchem in 2021: new data content and improved web interfaces.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">Nucleic acids research</em>, 49(D1):D1388–D1395, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Gang Liu, Tong Zhao, Jiaxin Xu, Tengfei Luo, and Meng Jiang.

</span>
<span class="ltx_bibblock">Graph rationalization with environment-based augmentations.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">Proceedings of the 28th ACM SIGKDD Conference on Knowledge Discovery and Data Mining</em>, pages 1069–1078, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et&nbsp;al. (2023a)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Gang Liu, Tong Zhao, Eric Inae, Tengfei Luo, and Meng Jiang.

</span>
<span class="ltx_bibblock">Semi-supervised graph imbalanced regression.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">Proceedings of the 29th ACM SIGKDD Conference on Knowledge Discovery and Data Mining</em>, pages 1453–1465, 2023a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et&nbsp;al. (2024a)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Gang Liu, Eric Inae, Tengfei Luo, and Meng Jiang.

</span>
<span class="ltx_bibblock">Rationalizing graph neural networks with data augmentation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">ACM Transactions on Knowledge Discovery from Data</em>, 18(4):1–23, 2024a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et&nbsp;al. (2024b)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Gang Liu, Eric Inae, Tong Zhao, Jiaxin Xu, Tengfei Luo, and Meng Jiang.

</span>
<span class="ltx_bibblock">Data-centric learning from unlabeled graphs with diffusion model.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">Advances in neural information processing systems</em>, 36, 2024b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et&nbsp;al. (2024c)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Gang Liu, Jiaxin Xu, Tengfei Luo, and Meng Jiang.

</span>
<span class="ltx_bibblock">Inverse molecular design with multi-conditional diffusion guidance.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">arXiv preprint arXiv:2401.13858</em>, 2024c.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et&nbsp;al. (2023b)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Zhiyuan Liu, Sihang Li, Yanchen Luo, Hao Fei, Yixin Cao, Kenji Kawaguchi, Xiang Wang, and Tat-Seng Chua.

</span>
<span class="ltx_bibblock">Molca: Molecular graph-language modeling with cross-modal projector and uni-modal adapter.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">Proceedings of the 2023 Conference on Empirical Methods in Natural Language Processing</em>, pages 15623–15638, 2023b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lowe (2017)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Daniel Lowe.

</span>
<span class="ltx_bibblock">Chemical reactions from US patents (1976 Sep2016).

</span>
<span class="ltx_bibblock">6 2017.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.6084/m9.figshare.5104873.v1</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://figshare.com/articles/dataset/Chemical_reactions_from_US_patents_1976-Sep2016_/5104873" title="">https://figshare.com/articles/dataset/Chemical_reactions_from_US_patents_1976-Sep2016_/5104873</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ma and Luo (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Ruimin Ma and Tengfei Luo.

</span>
<span class="ltx_bibblock">Pi1m: a benchmark database for polymer informatics.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">Journal of Chemical Information and Modeling</em>, 60(10):4684–4690, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Otsuka et&nbsp;al. (2011)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Shingo Otsuka, Isao Kuwajima, Junko Hosoya, Yibin Xu, and Masayoshi Yamazaki.

</span>
<span class="ltx_bibblock">Polyinfo: Polymer database for polymeric materials design.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">2011 International Conference on Emerging Intelligent Data and Web Technologies</em>, pages 22–29. IEEE, 2011.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ouyang et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Long Ouyang, Jeffrey Wu, Xu&nbsp;Jiang, Diogo Almeida, Carroll Wainwright, Pamela Mishkin, Chong Zhang, Sandhini Agarwal, Katarina Slama, Alex Ray, et&nbsp;al.

</span>
<span class="ltx_bibblock">Training language models to follow instructions with human feedback.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">Advances in neural information processing systems</em>, 35:27730–27744, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Radford et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Alec Radford, Jong&nbsp;Wook Kim, Chris Hallacy, Aditya Ramesh, Gabriel Goh, Sandhini Agarwal, Girish Sastry, Amanda Askell, Pamela Mishkin, Jack Clark, et&nbsp;al.

</span>
<span class="ltx_bibblock">Learning transferable visual models from natural language supervision.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">International conference on machine learning</em>, pages 8748–8763. PMLR, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rogers and Hahn (2010)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
David Rogers and Mathew Hahn.

</span>
<span class="ltx_bibblock">Extended-connectivity fingerprints.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">Journal of chemical information and modeling</em>, 50(5):742–754, 2010.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Segler et&nbsp;al. (2018)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Marwin&nbsp;HS Segler, Thierry Kogej, Christian Tyrchan, and Mark&nbsp;P Waller.

</span>
<span class="ltx_bibblock">Generating focused molecule libraries for drug discovery with recurrent neural networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">ACS central science</em>, 4(1):120–131, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sterling and Irwin (2015)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Teague Sterling and John&nbsp;J Irwin.

</span>
<span class="ltx_bibblock">Zinc 15–ligand discovery for everyone.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">Journal of chemical information and modeling</em>, 55(11):2324–2337, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Michael Sun, Alston Lo, Wenhao Gao, Minghao Guo, Veronika Thost, Jie Chen, Connor Coley, and Wojciech Matusik.

</span>
<span class="ltx_bibblock">Syntax-guided procedural synthesis of molecules.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">arXiv preprint arXiv:2409.05873</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Swanson et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Kyle Swanson, Parker Walther, Jeremy Leitz, Souhrid Mukherjee, Joseph&nbsp;C Wu, Rabindra&nbsp;V Shivnaraine, and James Zou.

</span>
<span class="ltx_bibblock">Admet-ai: a machine learning admet platform for evaluation of large-scale chemical libraries.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">Bioinformatics</em>, 40(7):btae416, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Thornton et&nbsp;al. (2012)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
A&nbsp;Thornton, L&nbsp;Robeson, B&nbsp;Freeman, and D&nbsp;Uhlmann.

</span>
<span class="ltx_bibblock">Polymer gas separation membrane database, 2012.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://research.csiro.au/virtualscreening/membrane-database-polymer-gas-separation-membranes/" title="">https://research.csiro.au/virtualscreening/membrane-database-polymer-gas-separation-membranes/</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vignac et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Clement Vignac, Igor Krawczuk, Antoine Siraudin, Bohan Wang, Volkan Cevher, and Pascal Frossard.

</span>
<span class="ltx_bibblock">Digress: Discrete denoising diffusion for graph generation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">arXiv preprint arXiv:2209.14734</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Weininger (1988)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
David Weininger.

</span>
<span class="ltx_bibblock">Smiles, a chemical language and information system. 1. introduction to methodology and encoding rules.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">Journal of chemical information and computer sciences</em>, 28(1):31–36, 1988.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Shengqiong Wu, Hao Fei, Leigang Qu, Wei Ji, and Tat-Seng Chua.

</span>
<span class="ltx_bibblock">NExt-GPT: Any-to-any multimodal LLM.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">Forty-first International Conference on Machine Learning</em>, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=NZQkumsNlf" title="">https://openreview.net/forum?id=NZQkumsNlf</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et&nbsp;al. (2018)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Zhenqin Wu, Bharath Ramsundar, Evan&nbsp;N Feinberg, Joseph Gomes, Caleb Geniesse, Aneesh&nbsp;S Pappu, Karl Leswing, and Vijay Pande.

</span>
<span class="ltx_bibblock">Moleculenet: a benchmark for molecular machine learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">Chemical science</em>, 9(2):513–530, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et&nbsp;al. (2018)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Keyulu Xu, Weihua Hu, Jure Leskovec, and Stefanie Jegelka.

</span>
<span class="ltx_bibblock">How powerful are graph neural networks?

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">arXiv preprint arXiv:1810.00826</em>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
An&nbsp;Yang, Baosong Yang, Binyuan Hui, Bo&nbsp;Zheng, Bowen Yu, Chang Zhou, Chengpeng Li, Chengyuan Li, Dayiheng Liu, Fei Huang, et&nbsp;al.

</span>
<span class="ltx_bibblock">Qwen2 technical report.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">arXiv preprint arXiv:2407.10671</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zdrazil et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Barbara Zdrazil, Eloy Felix, Fiona Hunter, Emma&nbsp;J Manners, James Blackshaw, Sybilla Corbett, Marleen de&nbsp;Veij, Harris Ioannidis, David&nbsp;Mendez Lopez, Juan&nbsp;F Mosquera, et&nbsp;al.

</span>
<span class="ltx_bibblock">The chembl database in 2023: a drug discovery platform spanning multiple bioactivity data types and time periods.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib46.1.1">Nucleic acids research</em>, 52(D1):D1180–D1192, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Haiteng Zhao, Shengchao Liu, Ma&nbsp;Chang, Hannan Xu, Jie Fu, Zhihong Deng, Lingpeng Kong, and Qi&nbsp;Liu.

</span>
<span class="ltx_bibblock">Gimlet: A unified graph-text model for instruction-based molecule zero-shot learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib47.1.1">Advances in Neural Information Processing Systems</em>, 36:5850–5887, 2023.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<nav class="ltx_TOC ltx_list_toc ltx_toc_toc"><h6 class="ltx_title ltx_title_contents">Contents</h6><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S1" title="In Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S2" title="In Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Preliminaries</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S2.SS1" title="In 2 Preliminaries ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Autoregressive Language Modeling</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S2.SS2" title="In 2 Preliminaries ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Molecular Design with Graph Diffusion Models</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S2.SS3" title="In 2 Preliminaries ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>One-Step Reaction Prediction with Graph Neural Networks</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S2.SS4" title="In 2 Preliminaries ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.4 </span>Retrosynthetic Planning with A* Search</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S3" title="In Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Llamole: Multimodal Large Language Model for Molecular Discovery</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S3.SS1" title="In 3 Llamole: Multimodal Large Language Model for Molecular Discovery ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Multimodal Autoregressive Modeling</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S3.SS2" title="In 3 Llamole: Multimodal Large Language Model for Molecular Discovery ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Llamole Design Space</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S3.SS3" title="In 3 Llamole: Multimodal Large Language Model for Molecular Discovery ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>End-to-End Model Fine-Tuning and Generation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S4" title="In Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Benchmarking for Multimodal Molecular Design</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S5" title="In Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Experiment</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S5.SS1" title="In 5 Experiment ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>RQ1: LLMs for Controllable and Synthesizable Molecular Design</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S5.SS2" title="In 5 Experiment ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>RQ2: Discussion on Controllable Molecular Generation</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S5.SS2.SSS1" title="In 5.2 RQ2: Discussion on Controllable Molecular Generation ‣ 5 Experiment ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2.1 </span>Ablation Studies on LLM and Graph DiT Synergy</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S5.SS2.SSS2" title="In 5.2 RQ2: Discussion on Controllable Molecular Generation ‣ 5 Experiment ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2.2 </span>Case Studies for Property and Structure Controllability</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S5.SS3" title="In 5 Experiment ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>RQ3: Discussion on Retrosynthetic Planning</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S5.SS3.SSS1" title="In 5.3 RQ3: Discussion on Retrosynthetic Planning ‣ 5 Experiment ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3.1 </span>One-step Reaction Generation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S5.SS3.SSS2" title="In 5.3 RQ3: Discussion on Retrosynthetic Planning ‣ 5 Experiment ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3.2 </span>Multi-step Retrosynthetic Planning</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S6" title="In Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Related Work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S7" title="In Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A1" title="In Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Additional Details for Llamole</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A1.SS1" title="In Appendix A Additional Details for Llamole ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1 </span>Details of Special Tokens</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A1.SS2" title="In Appendix A Additional Details for Llamole ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2 </span>Details of LLM-based A* Heuristics</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A2" title="In Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Additional Benchmarking and Datasets Details</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A2.SS1" title="In Appendix B Additional Benchmarking and Datasets Details ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.1 </span>Details of Quality Control</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A2.SS2" title="In Appendix B Additional Benchmarking and Datasets Details ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.2 </span>Details on the Creation of MolQA</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A2.SS2.SSS1" title="In B.2 Details on the Creation of MolQA ‣ Appendix B Additional Benchmarking and Datasets Details ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.2.1 </span>Creation of Synthesis Routes</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A2.SS2.SSS2" title="In B.2 Details on the Creation of MolQA ‣ Appendix B Additional Benchmarking and Datasets Details ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.2.2 </span>Creation of Property Annotations</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A2.SS2.SSS3" title="In B.2 Details on the Creation of MolQA ‣ Appendix B Additional Benchmarking and Datasets Details ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.2.3 </span>Creation of Text Data for Molecular Description</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A2.SS2.SSS4" title="In B.2 Details on the Creation of MolQA ‣ Appendix B Additional Benchmarking and Datasets Details ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.2.4 </span>Creation of Question Answering Data</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A2.SS3" title="In Appendix B Additional Benchmarking and Datasets Details ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.3 </span>Details on the Creation of MolPair</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A3" title="In Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>Additional Pre-training and Fine-tuning Details</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A3.SS1" title="In Appendix C Additional Pre-training and Fine-tuning Details ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.1 </span>Pre-training of Graph Diffusion Transformers</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A3.SS2" title="In Appendix C Additional Pre-training and Fine-tuning Details ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.2 </span>Pre-training of GNNs</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A3.SS3" title="In Appendix C Additional Pre-training and Fine-tuning Details ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.3 </span>Fine-tuning of Llamole</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A4" title="In Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D </span>Additional Experimental Details and Discussions</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A4.SS1" title="In Appendix D Additional Experimental Details and Discussions ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.1 </span>Additional Details on Experimental Set-ups</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A4.SS1.SSS1" title="In D.1 Additional Details on Experimental Set-ups ‣ Appendix D Additional Experimental Details and Discussions ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.1.1 </span>Set-ups for&nbsp;<span class="ltx_text ltx_ref_tag">Figure</span>&nbsp;<span class="ltx_text ltx_ref_tag">1</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A4.SS1.SSS2" title="In D.1 Additional Details on Experimental Set-ups ‣ Appendix D Additional Experimental Details and Discussions ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.1.2 </span>Extraction of SMILES from LLM Responses</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A4.SS2" title="In Appendix D Additional Experimental Details and Discussions ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.2 </span>Additional Discussion on One-Step Generation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A4.SS3" title="In Appendix D Additional Experimental Details and Discussions ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.3 </span>Additional Discussion on Case Studies</span></a></li>
</ol>
</li>
</ol></nav>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Additional Details for Llamole</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsection" id="A1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Details of Special Tokens</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A1.SS1.p1">
<p class="ltx_p" id="A1.SS1.p1.1">In total, there are nine special tokens divided into three groups. These tokens augment the word vocabulary <math alttext="\mathcal{W}" class="ltx_Math" display="inline" id="A1.SS1.p1.1.m1.1"><semantics id="A1.SS1.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="A1.SS1.p1.1.m1.1.1" xref="A1.SS1.p1.1.m1.1.1.cmml">𝒲</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.1.m1.1b"><ci id="A1.SS1.p1.1.m1.1.1.cmml" xref="A1.SS1.p1.1.m1.1.1">𝒲</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.1.m1.1c">\mathcal{W}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.1.m1.1d">caligraphic_W</annotation></semantics></math>, enabling flexible control of the generation flow:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS1.p2">
<ul class="ltx_itemize" id="A1.I1">
<li class="ltx_item" id="A1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I1.i1.p1">
<p class="ltx_p" id="A1.I1.i1.p1.1">Trigger and Query tokens: <span class="ltx_text ltx_font_typewriter" id="A1.I1.i1.p1.1.1">&lt;design_start&gt;</span>, <span class="ltx_text ltx_font_typewriter" id="A1.I1.i1.p1.1.2">&lt;design_body&gt;</span>, <span class="ltx_text ltx_font_typewriter" id="A1.I1.i1.p1.1.3">&lt;design_end&gt;</span>, <span class="ltx_text ltx_font_typewriter" id="A1.I1.i1.p1.1.4">&lt;retro_start&gt;</span>, <span class="ltx_text ltx_font_typewriter" id="A1.I1.i1.p1.1.5">&lt;retro_body&gt;</span>, <span class="ltx_text ltx_font_typewriter" id="A1.I1.i1.p1.1.6">&lt;retro_end&gt;</span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I1.i2.p1">
<p class="ltx_p" id="A1.I1.i2.p1.1">Molecule token: <span class="ltx_text ltx_font_typewriter" id="A1.I1.i2.p1.1.1">&lt;molecule&gt;</span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I1.i3.p1">
<p class="ltx_p" id="A1.I1.i3.p1.1">Callback tokens: <span class="ltx_text ltx_font_typewriter" id="A1.I1.i3.p1.1.1">&lt;callback_start&gt;</span>, <span class="ltx_text ltx_font_typewriter" id="A1.I1.i3.p1.1.2">&lt;callback_end&gt;</span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ul>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS1.p3">
<p class="ltx_p" id="A1.SS1.p3.1">The tokens <span class="ltx_text ltx_font_typewriter" id="A1.SS1.p3.1.1">&lt;design_start&gt;</span> and <span class="ltx_text ltx_font_typewriter" id="A1.SS1.p3.1.2">&lt;retro_start&gt;</span> switch between the LLM and the Graph DiT or GNN, respectively. The tokens <span class="ltx_text ltx_font_typewriter" id="A1.SS1.p3.1.3">&lt;design_body&gt;</span> and <span class="ltx_text ltx_font_typewriter" id="A1.SS1.p3.1.4">&lt;retro_body&gt;</span> serve as query tokens, repeated eight times. After tokenization, the LLM takes their embeddings as input and outputs a vector from the last layer. The tokens <span class="ltx_text ltx_font_typewriter" id="A1.SS1.p3.1.5">&lt;design_end&gt;</span> and <span class="ltx_text ltx_font_typewriter" id="A1.SS1.p3.1.6">&lt;retro_end&gt;</span> indicate the end of these switches.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS1.p4">
<p class="ltx_p" id="A1.SS1.p4.1">The <span class="ltx_text ltx_font_typewriter" id="A1.SS1.p4.1.1">&lt;molecule&gt;</span> token marks the position of the molecular graph where the graph encoder is applied. In the instruction dataset, the segment “<span class="ltx_text ltx_font_typewriter" id="A1.SS1.p4.1.2">&lt;mol_start&gt;</span>SMILES<span class="ltx_text ltx_font_typewriter" id="A1.SS1.p4.1.3">&lt;mol_end&gt;</span>” denotes the position and identity of the molecule. SMILES will be converted to molecular graphs using RDKit, and this segment will be replaced by the <span class="ltx_text ltx_font_typewriter" id="A1.SS1.p4.1.4">&lt;molecule&gt;</span> token for Llamole inputs.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS1.p5">
<p class="ltx_p" id="A1.SS1.p5.1">Finally, callback tokens control the LLM to generate backup results as complements to the specialized graph modules. For instance, if the Graph DiT fails to produce a valid molecule, the base LLM can generate an alternative, regardless of validity.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="A1.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Details of LLM-based A* Heuristics</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A1.SS2.p1">
<p class="ltx_p" id="A1.SS2.p1.1">Llamole models <math alttext="J_{\text{heuristics}}" class="ltx_Math" display="inline" id="A1.SS2.p1.1.m1.1"><semantics id="A1.SS2.p1.1.m1.1a"><msub id="A1.SS2.p1.1.m1.1.1" xref="A1.SS2.p1.1.m1.1.1.cmml"><mi id="A1.SS2.p1.1.m1.1.1.2" xref="A1.SS2.p1.1.m1.1.1.2.cmml">J</mi><mtext id="A1.SS2.p1.1.m1.1.1.3" xref="A1.SS2.p1.1.m1.1.1.3a.cmml">heuristics</mtext></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.1.m1.1b"><apply id="A1.SS2.p1.1.m1.1.1.cmml" xref="A1.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p1.1.m1.1.1.1.cmml" xref="A1.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="A1.SS2.p1.1.m1.1.1.2.cmml" xref="A1.SS2.p1.1.m1.1.1.2">𝐽</ci><ci id="A1.SS2.p1.1.m1.1.1.3a.cmml" xref="A1.SS2.p1.1.m1.1.1.3"><mtext id="A1.SS2.p1.1.m1.1.1.3.cmml" mathsize="70%" xref="A1.SS2.p1.1.m1.1.1.3">heuristics</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.1.m1.1c">J_{\text{heuristics}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.1.m1.1d">italic_J start_POSTSUBSCRIPT heuristics end_POSTSUBSCRIPT</annotation></semantics></math> in A* search as a multi-choice problem, filling in information from the molecule node, its parent reaction nodes and siblings using the template below. Parameters such as step, reaction template, and reactants are optional.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS2.p2">
<div class="ltx_listing ltx_lstlisting ltx_listing" id="A1.SS2.p2.1">
<div class="ltx_listing_data"><a download="" href="data:text/plain;base64,RXN0aW1hdGUgcmVtYWluaW5nIHN0ZXBzIGZvciB0aGUgdGFyZ2V0IHtzbWlsZXN9IGdpdmVuIHRoZSBmb2xsb3dpbmcgcGFyYW1ldGVyczoKQ3VycmVudCBzdGVwIHtzdGVwfSwKQ3VycmVudCB0ZW1wbGF0ZToge3RlbXBsYXRlfSwKUmVhY3RhbnRzOiB7cmVhY3RhbnRzfS4KQ29uc2lkZXIgdGhlIGZvbGxvd2luZyBmYWN0b3JzOgoxLiBJbnRlcm1lZGlhdGUgY29tcGxleGl0eQoyLiBSZWFnZW50IGF2YWlsYWJpbGl0eQozLiBTaWRlIHJlYWN0aW9ucwo0LiBTdGVyZW9jaGVtaXN0cnkgY2hhbGxlbmdlcy4=">⬇</a></div>
<div class="ltx_listingline" id="lstnumberx1">
<span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx1.1" style="color:#0000FF;">Estimate</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx1.2" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx1.3" style="color:#0000FF;">remaining</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx1.4" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx1.5" style="color:#0000FF;">steps</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx1.6" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx1.7" style="color:#0000FF;">for</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx1.8" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx1.9" style="color:#0000FF;">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx1.10" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx1.11" style="color:#0000FF;">target</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx1.12" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx1.13" style="color:#0000FF;">{</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx1.14" style="color:#0000FF;">smiles</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx1.15" style="color:#0000FF;">}</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx1.16" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx1.17" style="color:#0000FF;">given</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx1.18" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx1.19" style="color:#0000FF;">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx1.20" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx1.21" style="color:#0000FF;">following</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx1.22" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx1.23" style="color:#0000FF;">parameters</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx1.24" style="color:#0000FF;">:</span>
</div>
<div class="ltx_listingline" id="lstnumberx2">
<span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx2.1" style="color:#0000FF;">Current</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx2.2" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx2.3" style="color:#0000FF;">step</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx2.4" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx2.5" style="color:#0000FF;">{</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx2.6" style="color:#0000FF;">step</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx2.7" style="color:#0000FF;">},</span>
</div>
<div class="ltx_listingline" id="lstnumberx3">
<span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx3.1" style="color:#0000FF;">Current</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx3.2" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx3.3" style="color:#0000FF;">template</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx3.4" style="color:#0000FF;">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx3.5" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx3.6" style="color:#0000FF;">{</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx3.7" style="color:#0000FF;">template</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx3.8" style="color:#0000FF;">},</span>
</div>
<div class="ltx_listingline" id="lstnumberx4">
<span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx4.1" style="color:#0000FF;">Reactants</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx4.2" style="color:#0000FF;">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx4.3" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx4.4" style="color:#0000FF;">{</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx4.5" style="color:#0000FF;">reactants</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx4.6" style="color:#0000FF;">}.</span>
</div>
<div class="ltx_listingline" id="lstnumberx5">
<span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx5.1" style="color:#0000FF;">Consider</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx5.2" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx5.3" style="color:#0000FF;">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx5.4" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx5.5" style="color:#0000FF;">following</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx5.6" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx5.7" style="color:#0000FF;">factors</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx5.8" style="color:#0000FF;">:</span>
</div>
<div class="ltx_listingline" id="lstnumberx6">
<span class="ltx_text ltx_font_typewriter" id="lstnumberx6.1" style="color:#0000FF;">1.</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx6.2" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx6.3" style="color:#0000FF;">Intermediate</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx6.4" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx6.5" style="color:#0000FF;">complexity</span>
</div>
<div class="ltx_listingline" id="lstnumberx7">
<span class="ltx_text ltx_font_typewriter" id="lstnumberx7.1" style="color:#0000FF;">2.</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx7.2" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx7.3" style="color:#0000FF;">Reagent</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx7.4" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx7.5" style="color:#0000FF;">availability</span>
</div>
<div class="ltx_listingline" id="lstnumberx8">
<span class="ltx_text ltx_font_typewriter" id="lstnumberx8.1" style="color:#0000FF;">3.</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx8.2" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx8.3" style="color:#0000FF;">Side</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx8.4" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx8.5" style="color:#0000FF;">reactions</span>
</div>
<div class="ltx_listingline" id="lstnumberx9">
<span class="ltx_text ltx_font_typewriter" id="lstnumberx9.1" style="color:#0000FF;">4.</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx9.2" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx9.3" style="color:#0000FF;">Stereochemistry</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx9.4" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx9.5" style="color:#0000FF;">challenges</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx9.6" style="color:#0000FF;">.</span>
</div>
</div>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS2.p3">
<p class="ltx_p" id="A1.SS2.p3.1">Using this question to estimate remaining steps, we input the text into the base LLM and formulate five choices with corresponding scores:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS2.p4">
<div class="ltx_listing ltx_lstlisting ltx_listing" id="A1.SS2.p4.1">
<div class="ltx_listing_data"><a download="" href="data:text/plain;base64,QS4gQWxsIHJlYWRpbHkgYXZhaWxhYmxlIC8vIFNjb3JlOiAwCkIuIFNvbWUgY29tbWVyY2lhbCwgc29tZSBuZWVkIDEtMiBzdGVwcyAvLyBTY29yZTogMQpDLiBNaXggb2YgY29tbWVyY2lhbCBhbmQgbXVsdGktc3RlcCBzeW50aGVzaXMgLy8gU2NvcmU6IDIuNQpELiBNb3N0bHkgcmVxdWlyZSBjb21wbGV4IHN5bnRoZXNpcyAvLyBTY29yZTogNC41CkUuIEFsbCByZXF1aXJlIGV4dGVuc2l2ZSBtdWx0aS1zdGVwIHN5bnRoZXNpcyAvLyBTY29yZTogNw==">⬇</a></div>
<div class="ltx_listingline" id="lstnumberx10">
<span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx10.1" style="color:#0000FF;">A</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx10.2" style="color:#0000FF;">.</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx10.3" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx10.4" style="color:#0000FF;">All</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx10.5" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx10.6" style="color:#0000FF;">readily</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx10.7" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx10.8" style="color:#0000FF;">available</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx10.9" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx10.10" style="color:#0000FF;">//</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx10.11" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx10.12" style="color:#0000FF;">Score</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx10.13" style="color:#0000FF;">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx10.14" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx10.15" style="color:#0000FF;">0</span>
</div>
<div class="ltx_listingline" id="lstnumberx11">
<span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx11.1" style="color:#0000FF;">B</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx11.2" style="color:#0000FF;">.</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx11.3" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx11.4" style="color:#0000FF;">Some</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx11.5" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx11.6" style="color:#0000FF;">commercial</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx11.7" style="color:#0000FF;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx11.8" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx11.9" style="color:#0000FF;">some</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx11.10" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx11.11" style="color:#0000FF;">need</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx11.12" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx11.13" style="color:#0000FF;">1-2</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx11.14" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx11.15" style="color:#0000FF;">steps</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx11.16" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx11.17" style="color:#0000FF;">//</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx11.18" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx11.19" style="color:#0000FF;">Score</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx11.20" style="color:#0000FF;">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx11.21" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx11.22" style="color:#0000FF;">1</span>
</div>
<div class="ltx_listingline" id="lstnumberx12">
<span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx12.1" style="color:#0000FF;">C</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx12.2" style="color:#0000FF;">.</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx12.3" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx12.4" style="color:#0000FF;">Mix</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx12.5" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx12.6" style="color:#0000FF;">of</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx12.7" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx12.8" style="color:#0000FF;">commercial</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx12.9" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx12.10" style="color:#0000FF;">and</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx12.11" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx12.12" style="color:#0000FF;">multi</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx12.13" style="color:#0000FF;">-</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx12.14" style="color:#0000FF;">step</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx12.15" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx12.16" style="color:#0000FF;">synthesis</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx12.17" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx12.18" style="color:#0000FF;">//</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx12.19" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx12.20" style="color:#0000FF;">Score</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx12.21" style="color:#0000FF;">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx12.22" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx12.23" style="color:#0000FF;">2.5</span>
</div>
<div class="ltx_listingline" id="lstnumberx13">
<span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx13.1" style="color:#0000FF;">D</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx13.2" style="color:#0000FF;">.</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx13.3" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx13.4" style="color:#0000FF;">Mostly</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx13.5" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx13.6" style="color:#0000FF;">require</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx13.7" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx13.8" style="color:#0000FF;">complex</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx13.9" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx13.10" style="color:#0000FF;">synthesis</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx13.11" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx13.12" style="color:#0000FF;">//</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx13.13" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx13.14" style="color:#0000FF;">Score</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx13.15" style="color:#0000FF;">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx13.16" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx13.17" style="color:#0000FF;">4.5</span>
</div>
<div class="ltx_listingline" id="lstnumberx14">
<span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx14.1" style="color:#0000FF;">E</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx14.2" style="color:#0000FF;">.</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx14.3" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx14.4" style="color:#0000FF;">All</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx14.5" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx14.6" style="color:#0000FF;">require</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx14.7" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx14.8" style="color:#0000FF;">extensive</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx14.9" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx14.10" style="color:#0000FF;">multi</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx14.11" style="color:#0000FF;">-</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx14.12" style="color:#0000FF;">step</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx14.13" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx14.14" style="color:#0000FF;">synthesis</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx14.15" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx14.16" style="color:#0000FF;">//</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx14.17" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx14.18" style="color:#0000FF;">Score</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx14.19" style="color:#0000FF;">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx14.20" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx14.21" style="color:#0000FF;">7</span>
</div>
</div>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS2.p5">
<p class="ltx_p" id="A1.SS2.p5.1">The LLM outputs logits for the next token, which we average for each choice to obtain overall probabilities. The <math alttext="J_{\text{heuristics}}" class="ltx_Math" display="inline" id="A1.SS2.p5.1.m1.1"><semantics id="A1.SS2.p5.1.m1.1a"><msub id="A1.SS2.p5.1.m1.1.1" xref="A1.SS2.p5.1.m1.1.1.cmml"><mi id="A1.SS2.p5.1.m1.1.1.2" xref="A1.SS2.p5.1.m1.1.1.2.cmml">J</mi><mtext id="A1.SS2.p5.1.m1.1.1.3" xref="A1.SS2.p5.1.m1.1.1.3a.cmml">heuristics</mtext></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p5.1.m1.1b"><apply id="A1.SS2.p5.1.m1.1.1.cmml" xref="A1.SS2.p5.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p5.1.m1.1.1.1.cmml" xref="A1.SS2.p5.1.m1.1.1">subscript</csymbol><ci id="A1.SS2.p5.1.m1.1.1.2.cmml" xref="A1.SS2.p5.1.m1.1.1.2">𝐽</ci><ci id="A1.SS2.p5.1.m1.1.1.3a.cmml" xref="A1.SS2.p5.1.m1.1.1.3"><mtext id="A1.SS2.p5.1.m1.1.1.3.cmml" mathsize="70%" xref="A1.SS2.p5.1.m1.1.1.3">heuristics</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p5.1.m1.1c">J_{\text{heuristics}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p5.1.m1.1d">italic_J start_POSTSUBSCRIPT heuristics end_POSTSUBSCRIPT</annotation></semantics></math> is calculated as the weighted score using these probabilities.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Additional Benchmarking and Datasets Details</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A2.p1">
<p class="ltx_p" id="A2.p1.1">We collect small drug molecules from PubChem&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[Kim et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib22" title="">2021</a>]</cite>, MoleculeNet&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[Wu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib43" title="">2018</a>]</cite>, ChEMBL&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[Zdrazil et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib46" title="">2024</a>]</cite>, and ZINC&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[Sterling and Irwin, <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib36" title="">2015</a>]</cite>.
Polymers are macromolecules with one repeating unit called monomers. We collect polymers from PI1M&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[Ma and Luo, <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib30" title="">2020</a>]</cite>, the Membrane Society of Australia (MSA)&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[Thornton et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib39" title="">2012</a>]</cite>, and others&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[Liu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib26" title="">2024b</a>]</cite>.
Additionally, we collect 3.8 million patent chemical reactions with descriptions from USPTO&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[Lowe, <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib29" title="">2017</a>]</cite>, spanning from 1976 to 2016.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_subsection" id="A2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.1 </span>Details of Quality Control</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A2.SS1.p1">
<p class="ltx_p" id="A2.SS1.p1.1">After collecting molecules and polymers from various sources, we deduplicate and merge the label information for identical molecules. We use RDKit to obtain canonical SMILES. For small molecules, we calculate the first 14 characters of the InChIKey as the unique identifier, while for polymers, where the polymerization point is represented by “*”, we use the canonical SMILES directly.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS1.p2">
<p class="ltx_p" id="A2.SS1.p2.1">For drug-like small molecules, we apply the following rules to filter out alert structures, known as the Rule of Five (Ro5):</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS1.p3">
<ul class="ltx_itemize" id="A2.I1">
<li class="ltx_item" id="A2.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I1.i1.p1">
<p class="ltx_p" id="A2.I1.i1.p1.1">Molecular Weight (MW): Must be <math alttext="\leq" class="ltx_Math" display="inline" id="A2.I1.i1.p1.1.m1.1"><semantics id="A2.I1.i1.p1.1.m1.1a"><mo id="A2.I1.i1.p1.1.m1.1.1" xref="A2.I1.i1.p1.1.m1.1.1.cmml">≤</mo><annotation-xml encoding="MathML-Content" id="A2.I1.i1.p1.1.m1.1b"><leq id="A2.I1.i1.p1.1.m1.1.1.cmml" xref="A2.I1.i1.p1.1.m1.1.1"></leq></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i1.p1.1.m1.1c">\leq</annotation><annotation encoding="application/x-llamapun" id="A2.I1.i1.p1.1.m1.1d">≤</annotation></semantics></math> 500 Da.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A2.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I1.i2.p1">
<p class="ltx_p" id="A2.I1.i2.p1.1">Hydrogen Bond Acceptors (HBA): Must not exceed 10.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A2.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I1.i3.p1">
<p class="ltx_p" id="A2.I1.i3.p1.1">Hydrogen Bond Donors (HBD): Must not exceed 5.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A2.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I1.i4.p1">
<p class="ltx_p" id="A2.I1.i4.p1.1">LogP: Must be <math alttext="\leq" class="ltx_Math" display="inline" id="A2.I1.i4.p1.1.m1.1"><semantics id="A2.I1.i4.p1.1.m1.1a"><mo id="A2.I1.i4.p1.1.m1.1.1" xref="A2.I1.i4.p1.1.m1.1.1.cmml">≤</mo><annotation-xml encoding="MathML-Content" id="A2.I1.i4.p1.1.m1.1b"><leq id="A2.I1.i4.p1.1.m1.1.1.cmml" xref="A2.I1.i4.p1.1.m1.1.1"></leq></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i4.p1.1.m1.1c">\leq</annotation><annotation encoding="application/x-llamapun" id="A2.I1.i4.p1.1.m1.1d">≤</annotation></semantics></math> 5, indicating lipophilicity.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ul>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS1.p4">
<p class="ltx_p" id="A2.SS1.p4.1">A molecule passes the Ro5 test if at least three of these four conditions are met, indicating potential oral bioavailability.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS1.p5">
<p class="ltx_p" id="A2.SS1.p5.1">We also apply 15 filter rules from the RDKit package, including the following from the FilterCatalogs Class: BRENK, CHEMBL, CHEMBL_BMS, CHEMBL_Dundee, CHEMBL_Glaxo, CHEMBL_Inpharmatica, CHEMBL_LINT, CHEMBL_MLSMR, CHEMBL_SureChEMBL, NIH, PAINS, PAINS_A, PAINS_B, PAINS_C, and ZINC.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="A2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.2 </span>Details on the Creation of MolQA</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsubsection" id="A2.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">B.2.1 </span>Creation of Synthesis Routes</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A2.SS2.SSS1.p1">
<p class="ltx_p" id="A2.SS2.SSS1.p1.1">The USPTO has 3.7 million reactions. There are approximately 1.3 million unique product molecules. The purchasable compounds come from the Enamine Building Block (June 2024 version), supplemented with other common ions and starting materials, totaling around 1.3 million. We check each product from USPTO as a target molecule in the retrosynthesis task, exploring whether they can be synthesized using existing USPTO reactions through depth-first search (DFS). Ultimately, we identify about 139K target molecules with synthesis routes, supporting the creation of MolQA.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS2.SSS1.p2">
<p class="ltx_p" id="A2.SS2.SSS1.p2.1">Since there are no polymerization reactions, we consider only monomer structures by replacing the * point with hydrogen. Among the 139K small molecules with synthesis routes, 2196 fit the monomer structures and serve as target molecules for polymer retrosynthesis. The length of synthesis routes ranges from 1 to 10. For each length of the routes, we split half of the molecules into the testing set, with a maximum of 3000, while the remainder is retained in the training set.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS2.SSS1.p3">
<p class="ltx_p" id="A2.SS2.SSS1.p3.1">It results in around 11K routes (750 for materials and 9986 for drugs) for testing and 126K target molecules for training.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsubsection" id="A2.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">B.2.2 </span>Creation of Property Annotations</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A2.SS2.SSS2.p1">
<p class="ltx_p" id="A2.SS2.SSS2.p1.7">We focus on eight benchmarking properties: three drug-related categorical properties&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[Wu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib43" title="">2018</a>]</cite>—(1) HIV virus replication inhibition (HIV), (2) blood-brain barrier permeability (BBBP), and (3) human <math alttext="\beta" class="ltx_Math" display="inline" id="A2.SS2.SSS2.p1.1.m1.1"><semantics id="A2.SS2.SSS2.p1.1.m1.1a"><mi id="A2.SS2.SSS2.p1.1.m1.1.1" xref="A2.SS2.SSS2.p1.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="A2.SS2.SSS2.p1.1.m1.1b"><ci id="A2.SS2.SSS2.p1.1.m1.1.1.cmml" xref="A2.SS2.SSS2.p1.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.SSS2.p1.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="A2.SS2.SSS2.p1.1.m1.1d">italic_β</annotation></semantics></math>-secretase 1 inhibition (BACE)—and five continuous material properties&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[Thornton et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib39" title="">2012</a>]</cite>—(4) CO<sub class="ltx_sub" id="A2.SS2.SSS2.p1.7.1">2</sub> permeability (CO<sub class="ltx_sub" id="A2.SS2.SSS2.p1.7.2">2</sub>Perm), (5) N<sub class="ltx_sub" id="A2.SS2.SSS2.p1.7.3">2</sub> permeability (N<sub class="ltx_sub" id="A2.SS2.SSS2.p1.7.4">2</sub>Perm), (6) O<sub class="ltx_sub" id="A2.SS2.SSS2.p1.7.5">2</sub> permeability (O<sub class="ltx_sub" id="A2.SS2.SSS2.p1.7.6">2</sub>Perm), (7) fractional free volume (FFV), and (8) thermal conductivity (TC).</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS2.SSS2.p2">
<p class="ltx_p" id="A2.SS2.SSS2.p2.1">First, we check existing sources for annotations of these properties.
To enrich the label space, we use well-trained GNN models&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[Liu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib23" title="">2022</a>]</cite> to generate confident pseudo-labels, following the method in&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[Liu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib24" title="">2023a</a>]</cite>. We collect all labeled data to train two supervised multi-task GIN models for drug and material property annotation. The GIN models employ rationalization techniques&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[Liu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib25" title="">2024a</a>]</cite> to split the molecular graph into rationale and environment subgraphs in the latent space, predicting labels from the rationale subgraph. The confidence score is computed by combining the rationale subgraph with various environment subgraphs, using the reciprocal of prediction variance. We annotate properties when prediction confidence exceeds the median threshold.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsubsection" id="A2.SS2.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">B.2.3 </span>Creation of Text Data for Molecular Description</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A2.SS2.SSS3.p1">
<p class="ltx_p" id="A2.SS2.SSS3.p1.1">In addition to property annotations, we consider structural and synthesis information of the molecules using RDKit and heuristic complexity estimation scores. First, for any molecule, we extract the following structural information:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul class="ltx_itemize" id="A2.I2">
<li class="ltx_item" id="A2.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I2.i1.p1">
<p class="ltx_p" id="A2.I2.i1.p1.1"><span class="ltx_text ltx_font_bold" id="A2.I2.i1.p1.1.1">Scaffold:</span> Extracted scaffold from the molecule structure.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A2.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I2.i2.p1">
<p class="ltx_p" id="A2.I2.i2.p1.1"><span class="ltx_text ltx_font_bold" id="A2.I2.i2.p1.1.1">Molecular Weight:</span> Calculated using the molecular weight descriptor.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A2.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I2.i3.p1">
<p class="ltx_p" id="A2.I2.i3.p1.1"><span class="ltx_text ltx_font_bold" id="A2.I2.i3.p1.1.1">Number of Rings:</span> Total number of rings in the molecule.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A2.I2.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I2.i4.p1">
<p class="ltx_p" id="A2.I2.i4.p1.1"><span class="ltx_text ltx_font_bold" id="A2.I2.i4.p1.1.1">Number of Aromatic Rings:</span> Total number of aromatic rings in the molecule.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A2.I2.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I2.i5.p1">
<p class="ltx_p" id="A2.I2.i5.p1.1"><span class="ltx_text ltx_font_bold" id="A2.I2.i5.p1.1.1">Number of Aliphatic Rings:</span> Total number of aliphatic rings in the molecule.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A2.I2.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I2.i6.p1">
<p class="ltx_p" id="A2.I2.i6.p1.1"><span class="ltx_text ltx_font_bold" id="A2.I2.i6.p1.1.1">Number of Rotatable Bonds:</span> Total number of rotatable bonds in the molecule.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A2.I2.i7" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I2.i7.p1">
<p class="ltx_p" id="A2.I2.i7.p1.1"><span class="ltx_text ltx_font_bold" id="A2.I2.i7.p1.1.1">Number of Hydrogen Bond Donors:</span> Total number of hydrogen bond donors.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A2.I2.i8" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I2.i8.p1">
<p class="ltx_p" id="A2.I2.i8.p1.1"><span class="ltx_text ltx_font_bold" id="A2.I2.i8.p1.1.1">Number of Hydrogen Bond Acceptors:</span> Total number of hydrogen bond acceptors.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ul>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS2.SSS3.p2">
<p class="ltx_p" id="A2.SS2.SSS3.p2.1">Next, we compute the synthetic accessibility score (SAScore)&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[Ertl and Schuffenhauer, <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib11" title="">2009</a>]</cite> and SCScore&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[Coley et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib7" title="">2018</a>]</cite>. Based on this information, we use the following template:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS2.SSS3.p3">
<div class="ltx_listing ltx_lstlisting ltx_listing" id="A2.SS2.SSS3.p3.1">
<div class="ltx_listing_data"><a download="" href="data:text/plain;base64,R2VuZXJhdGUgYSBzdW1tYXJ5IGRlc2NyaXB0aW9uIHRoYXQgc3RhcnRzIGRpcmVjdGx5IHdpdGggIlRoZSBtb2xlY3VsZS9wb2x5bWVyIC4uLiIgYmFzZWQgb24gdGhlIHByZWRpY3RlZCBjaGVtaWNhbCBwcm9wZXJ0aWVzLCBzeW50aGV0aWMgY29tcGxleGl0eSBzY29yZXMsIGFuZCBzdHJ1Y3R1cmFsIGluZm9ybWF0aW9uIGZvciB0aGUgbW9sZWN1bGUgd2l0aCBTTUlMRVM6IHt7c21pbGVzfX0uIFVzZSB5b3VyIG93biBrbm93bGVkZ2UsIGZvY3VzIG9uIGZ1bmN0aW9ucywgYW5kIGF2b2lkIHVzaW5nIG51bWJlcnMsIHJlZHVuZGFudCB3b3Jkcywgb3IgbWVudGlvbmluZyBTTUlMRVMuIEVuc3VyZSB0aGUgb3V0cHV0IHNlbnRlbmNlIGlzIGNvbXBsZXRlIGFuZCBlbmRzIHdpdGggYSBwZXJpb2QuIFRoaXMgaXMgZm9yIERydWcvTWF0ZXJpYWwgVXRpbGl0eSBvZiBhIE1vbGVjdWxlL1BvbHltZXI6CgpUaGUgc3RydWN0dXJhbCBjb250ZXh0IG9mIGEgbW9sZWN1bGUgaW5jbHVkZXMgaXRzIHNjYWZmb2xkLCB3aGljaCBpcyB0aGUgY29yZSBzdHJ1Y3R1cmUgYXJvdW5kIHdoaWNoIHRoZSBtb2xlY3VsZSBpcyBidWlsdC4gS2V5IHN0cnVjdHVyYWwgZmVhdHVyZXMgaW5jbHVkZSB0aGUgcHJlc2VuY2Ugb2YgYXJvbWF0aWMgcmluZ3MsIGFsaXBoYXRpYyBjaGFpbnMsIGFuZCBjb21tb24gZnVuY3Rpb25hbCBncm91cHMgc3VjaCBhcyBoeWRyb3h5bCwgY2FyYm94eWwsIGFuZCBhbWlubyBncm91cHMuIFRoZSBjb21wbGV4aXR5IG9mIHRoZSBtb2xlY3VsZSdzIHN0cnVjdHVyZSBjYW4gc2lnbmlmaWNhbnRseSBpbmZsdWVuY2UgaXRzIHBoeXNpY2FsIGFuZCBjaGVtaWNhbCBwcm9wZXJ0aWVzLgpTY2FmZm9sZDoge3tzY2FmZm9sZH19Ck1vbGVjdWxhciBXZWlnaHQ6IHt7bXd9fQpOdW1iZXIgb2YgUmluZ3M6IHt7bnVtX3JpbmdzfX0KTnVtYmVyIG9mIEFyb21hdGljIFJpbmdzOiB7e251bV9hcm9tX3JpbmdzfX0KTnVtYmVyIG9mIEFsaXBoYXRpYyBSaW5nczoge3tudW1fYWxpcGhfcmluZ3N9fQpOdW1iZXIgb2YgUm90YXRhYmxlIEJvbmRzOiB7e251bV9yb3RfYm9uZHN9fQpOdW1iZXIgb2YgSHlkcm9nZW4gQm9uZCBEb25vcnM6IHt7bnVtX2hfZG9ub3JzfX0KTnVtYmVyIG9mIEh5ZHJvZ2VuIEJvbmQgQWNjZXB0b3JzOiB7e251bV9oX2FjY2VwdG9yc319Cgp7dXRpbGl0eV9jb250ZXh0fQp7e3Byb3BlcnRpZXN9fQ==">⬇</a></div>
<div class="ltx_listingline" id="lstnumberx15">
<span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.1" style="color:#0000FF;">Generate</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.2" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.3" style="color:#0000FF;">a</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.4" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.5" style="color:#0000FF;">summary</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.6" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.7" style="color:#0000FF;">description</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.8" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.9" style="color:#0000FF;">that</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.10" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.11" style="color:#0000FF;">starts</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.12" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.13" style="color:#0000FF;">directly</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.14" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.15" style="color:#0000FF;">with</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.16" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx15.17" style="color:#0000FF;">"</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.18" style="color:#0000FF;">The</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.19" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.20" style="color:#0000FF;">molecule</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx15.21" style="color:#0000FF;">/</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.22" style="color:#0000FF;">polymer</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.23" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx15.24" style="color:#0000FF;">..."</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.25" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.26" style="color:#0000FF;">based</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.27" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.28" style="color:#0000FF;">on</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.29" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.30" style="color:#0000FF;">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.31" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.32" style="color:#0000FF;">predicted</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.33" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.34" style="color:#0000FF;">chemical</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.35" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.36" style="color:#0000FF;">properties</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx15.37" style="color:#0000FF;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.38" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.39" style="color:#0000FF;">synthetic</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.40" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.41" style="color:#0000FF;">complexity</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.42" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.43" style="color:#0000FF;">scores</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx15.44" style="color:#0000FF;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.45" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.46" style="color:#0000FF;">and</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.47" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.48" style="color:#0000FF;">structural</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.49" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.50" style="color:#0000FF;">information</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.51" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.52" style="color:#0000FF;">for</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.53" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.54" style="color:#0000FF;">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.55" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.56" style="color:#0000FF;">molecule</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.57" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.58" style="color:#0000FF;">with</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.59" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.60" style="color:#0000FF;">SMILES</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx15.61" style="color:#0000FF;">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.62" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx15.63" style="color:#0000FF;">{{</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.64" style="color:#0000FF;">smiles</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx15.65" style="color:#0000FF;">}}.</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.66" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.67" style="color:#0000FF;">Use</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.68" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.69" style="color:#0000FF;">your</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.70" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.71" style="color:#0000FF;">own</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.72" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.73" style="color:#0000FF;">knowledge</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx15.74" style="color:#0000FF;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.75" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.76" style="color:#0000FF;">focus</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.77" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.78" style="color:#0000FF;">on</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.79" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.80" style="color:#0000FF;">functions</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx15.81" style="color:#0000FF;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.82" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.83" style="color:#0000FF;">and</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.84" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.85" style="color:#0000FF;">avoid</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.86" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.87" style="color:#0000FF;">using</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.88" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.89" style="color:#0000FF;">numbers</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx15.90" style="color:#0000FF;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.91" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.92" style="color:#0000FF;">redundant</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.93" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.94" style="color:#0000FF;">words</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx15.95" style="color:#0000FF;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.96" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.97" style="color:#0000FF;">or</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.98" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.99" style="color:#0000FF;">mentioning</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.100" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.101" style="color:#0000FF;">SMILES</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx15.102" style="color:#0000FF;">.</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.103" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.104" style="color:#0000FF;">Ensure</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.105" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.106" style="color:#0000FF;">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.107" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.108" style="color:#0000FF;">output</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.109" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.110" style="color:#0000FF;">sentence</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.111" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.112" style="color:#0000FF;">is</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.113" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.114" style="color:#0000FF;">complete</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.115" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.116" style="color:#0000FF;">and</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.117" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.118" style="color:#0000FF;">ends</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.119" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.120" style="color:#0000FF;">with</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.121" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.122" style="color:#0000FF;">a</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.123" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.124" style="color:#0000FF;">period</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx15.125" style="color:#0000FF;">.</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.126" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.127" style="color:#0000FF;">This</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.128" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.129" style="color:#0000FF;">is</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.130" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.131" style="color:#0000FF;">for</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.132" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.133" style="color:#0000FF;">Drug</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx15.134" style="color:#0000FF;">/</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.135" style="color:#0000FF;">Material</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.136" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.137" style="color:#0000FF;">Utility</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.138" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.139" style="color:#0000FF;">of</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.140" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.141" style="color:#0000FF;">a</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.142" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.143" style="color:#0000FF;">Molecule</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx15.144" style="color:#0000FF;">/</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.145" style="color:#0000FF;">Polymer</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx15.146" style="color:#0000FF;">:</span>
</div>
<div class="ltx_listingline" id="lstnumberx16">
</div>
<div class="ltx_listingline" id="lstnumberx17">
<span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.1" style="color:#0000FF;">The</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.2" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.3" style="color:#0000FF;">structural</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.4" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.5" style="color:#0000FF;">context</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.6" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.7" style="color:#0000FF;">of</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.8" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.9" style="color:#0000FF;">a</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.10" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.11" style="color:#0000FF;">molecule</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.12" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.13" style="color:#0000FF;">includes</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.14" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.15" style="color:#0000FF;">its</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.16" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.17" style="color:#0000FF;">scaffold</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx17.18" style="color:#0000FF;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.19" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.20" style="color:#0000FF;">which</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.21" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.22" style="color:#0000FF;">is</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.23" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.24" style="color:#0000FF;">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.25" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.26" style="color:#0000FF;">core</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.27" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.28" style="color:#0000FF;">structure</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.29" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.30" style="color:#0000FF;">around</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.31" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.32" style="color:#0000FF;">which</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.33" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.34" style="color:#0000FF;">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.35" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.36" style="color:#0000FF;">molecule</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.37" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.38" style="color:#0000FF;">is</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.39" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.40" style="color:#0000FF;">built</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx17.41" style="color:#0000FF;">.</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.42" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.43" style="color:#0000FF;">Key</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.44" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.45" style="color:#0000FF;">structural</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.46" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.47" style="color:#0000FF;">features</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.48" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.49" style="color:#0000FF;">include</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.50" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.51" style="color:#0000FF;">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.52" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.53" style="color:#0000FF;">presence</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.54" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.55" style="color:#0000FF;">of</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.56" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.57" style="color:#0000FF;">aromatic</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.58" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.59" style="color:#0000FF;">rings</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx17.60" style="color:#0000FF;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.61" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.62" style="color:#0000FF;">aliphatic</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.63" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.64" style="color:#0000FF;">chains</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx17.65" style="color:#0000FF;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.66" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.67" style="color:#0000FF;">and</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.68" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.69" style="color:#0000FF;">common</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.70" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.71" style="color:#0000FF;">functional</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.72" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.73" style="color:#0000FF;">groups</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.74" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.75" style="color:#0000FF;">such</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.76" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.77" style="color:#0000FF;">as</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.78" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.79" style="color:#0000FF;">hydroxyl</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx17.80" style="color:#0000FF;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.81" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.82" style="color:#0000FF;">carboxyl</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx17.83" style="color:#0000FF;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.84" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.85" style="color:#0000FF;">and</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.86" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.87" style="color:#0000FF;">amino</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.88" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.89" style="color:#0000FF;">groups</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx17.90" style="color:#0000FF;">.</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.91" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.92" style="color:#0000FF;">The</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.93" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.94" style="color:#0000FF;">complexity</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.95" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.96" style="color:#0000FF;">of</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.97" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.98" style="color:#0000FF;">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.99" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.100" style="color:#0000FF;">molecule</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx17.101" style="color:#0000FF;">’</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.102" style="color:#0000FF;">s</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.103" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.104" style="color:#0000FF;">structure</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.105" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.106" style="color:#0000FF;">can</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.107" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.108" style="color:#0000FF;">significantly</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.109" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.110" style="color:#0000FF;">influence</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.111" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.112" style="color:#0000FF;">its</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.113" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.114" style="color:#0000FF;">physical</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.115" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.116" style="color:#0000FF;">and</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.117" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.118" style="color:#0000FF;">chemical</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.119" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.120" style="color:#0000FF;">properties</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx17.121" style="color:#0000FF;">.</span>
</div>
<div class="ltx_listingline" id="lstnumberx18">
<span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx18.1" style="color:#0000FF;">Scaffold</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx18.2" style="color:#0000FF;">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx18.3" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx18.4" style="color:#0000FF;">{{</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx18.5" style="color:#0000FF;">scaffold</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx18.6" style="color:#0000FF;">}}</span>
</div>
<div class="ltx_listingline" id="lstnumberx19">
<span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx19.1" style="color:#0000FF;">Molecular</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx19.2" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx19.3" style="color:#0000FF;">Weight</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx19.4" style="color:#0000FF;">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx19.5" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx19.6" style="color:#0000FF;">{{</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx19.7" style="color:#0000FF;">mw</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx19.8" style="color:#0000FF;">}}</span>
</div>
<div class="ltx_listingline" id="lstnumberx20">
<span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx20.1" style="color:#0000FF;">Number</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx20.2" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx20.3" style="color:#0000FF;">of</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx20.4" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx20.5" style="color:#0000FF;">Rings</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx20.6" style="color:#0000FF;">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx20.7" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx20.8" style="color:#0000FF;">{{</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx20.9" style="color:#0000FF;">num_rings</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx20.10" style="color:#0000FF;">}}</span>
</div>
<div class="ltx_listingline" id="lstnumberx21">
<span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx21.1" style="color:#0000FF;">Number</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx21.2" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx21.3" style="color:#0000FF;">of</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx21.4" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx21.5" style="color:#0000FF;">Aromatic</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx21.6" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx21.7" style="color:#0000FF;">Rings</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx21.8" style="color:#0000FF;">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx21.9" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx21.10" style="color:#0000FF;">{{</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx21.11" style="color:#0000FF;">num_arom_rings</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx21.12" style="color:#0000FF;">}}</span>
</div>
<div class="ltx_listingline" id="lstnumberx22">
<span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx22.1" style="color:#0000FF;">Number</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx22.2" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx22.3" style="color:#0000FF;">of</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx22.4" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx22.5" style="color:#0000FF;">Aliphatic</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx22.6" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx22.7" style="color:#0000FF;">Rings</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx22.8" style="color:#0000FF;">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx22.9" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx22.10" style="color:#0000FF;">{{</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx22.11" style="color:#0000FF;">num_aliph_rings</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx22.12" style="color:#0000FF;">}}</span>
</div>
<div class="ltx_listingline" id="lstnumberx23">
<span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx23.1" style="color:#0000FF;">Number</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx23.2" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx23.3" style="color:#0000FF;">of</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx23.4" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx23.5" style="color:#0000FF;">Rotatable</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx23.6" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx23.7" style="color:#0000FF;">Bonds</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx23.8" style="color:#0000FF;">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx23.9" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx23.10" style="color:#0000FF;">{{</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx23.11" style="color:#0000FF;">num_rot_bonds</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx23.12" style="color:#0000FF;">}}</span>
</div>
<div class="ltx_listingline" id="lstnumberx24">
<span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx24.1" style="color:#0000FF;">Number</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx24.2" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx24.3" style="color:#0000FF;">of</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx24.4" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx24.5" style="color:#0000FF;">Hydrogen</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx24.6" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx24.7" style="color:#0000FF;">Bond</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx24.8" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx24.9" style="color:#0000FF;">Donors</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx24.10" style="color:#0000FF;">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx24.11" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx24.12" style="color:#0000FF;">{{</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx24.13" style="color:#0000FF;">num_h_donors</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx24.14" style="color:#0000FF;">}}</span>
</div>
<div class="ltx_listingline" id="lstnumberx25">
<span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx25.1" style="color:#0000FF;">Number</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx25.2" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx25.3" style="color:#0000FF;">of</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx25.4" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx25.5" style="color:#0000FF;">Hydrogen</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx25.6" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx25.7" style="color:#0000FF;">Bond</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx25.8" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx25.9" style="color:#0000FF;">Acceptors</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx25.10" style="color:#0000FF;">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx25.11" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx25.12" style="color:#0000FF;">{{</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx25.13" style="color:#0000FF;">num_h_acceptors</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx25.14" style="color:#0000FF;">}}</span>
</div>
<div class="ltx_listingline" id="lstnumberx26">
</div>
<div class="ltx_listingline" id="lstnumberx27">
<span class="ltx_text ltx_font_typewriter" id="lstnumberx27.1" style="color:#0000FF;">{</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx27.2" style="color:#0000FF;">utility_context</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx27.3" style="color:#0000FF;">}</span>
</div>
<div class="ltx_listingline" id="lstnumberx28">
<span class="ltx_text ltx_font_typewriter" id="lstnumberx28.1" style="color:#0000FF;">{{</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx28.2" style="color:#0000FF;">properties</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx28.3" style="color:#0000FF;">}}</span>
</div>
</div>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS2.SSS3.p4">
<p class="ltx_p" id="A2.SS2.SSS3.p4.1">The pre-defined utility context for the small molecule is as follows:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_listing ltx_lstlisting ltx_listing" id="A2.SS2.SSS3.p4.2">
<div class="ltx_listing_data"><a download="" href="data:text/plain;base64,VGhlIGRydWcgdXRpbGl0eSBvZiBhIG1vbGVjdWxlIGlzIGFzc2Vzc2VkIGJhc2VkIG9uIGl0cyBwb3RlbnRpYWwgdG8gc2VydmUgYXMgYSB0aGVyYXBldXRpYyBhZ2VudC4gS2V5IHByb3BlcnRpZXMgY29uc2lkZXJlZCBpbmNsdWRlIHBoYXJtYWNva2luZXRpY3MsIHdoaWNoIGVuY29tcGFzc2VzIGFic29ycHRpb24sIGRpc3RyaWJ1dGlvbiwgbWV0YWJvbGlzbSwgZXhjcmV0aW9uIChBRE1FKSwgYW5kIHRveGljaXR5LiBCaW9hY3Rpdml0eSBpcyBhbm90aGVyIGNyaXRpY2FsIGZhY3RvciwgbWVhc3VyZWQgYnkgdGhlIG1vbGVjdWxlJ3MgYWJpbGl0eSB0byBpbnRlcmFjdCB3aXRoIGJpb2xvZ2ljYWwgdGFyZ2V0cywgdHlwaWNhbGx5IHRocm91Z2ggYmluZGluZyBhZmZpbml0eS4gQWRkaXRpb25hbGx5LCBkcnVnLWxpa2VuZXNzLCB3aGljaCByZWZlcnMgdG8gdGhlIG1vbGVjdWxlJ3MgYWRoZXJlbmNlIHRvIGVzdGFibGlzaGVkIHJ1bGVzIHN1Y2ggYXMgTGlwaW5za2kncyBSdWxlIG9mIEZpdmUsIGlzIGVzc2VudGlhbC4gVGhpcyBydWxlIGV2YWx1YXRlcyBtb2xlY3VsYXIgd2VpZ2h0LCBoeWRyb2dlbiBib25kIGRvbm9ycyBhbmQgYWNjZXB0b3JzLCBhbmQgbGlwb3BoaWxpY2l0eSB0byBwcmVkaWN0IGEgbW9sZWN1bGUncyBzdWl0YWJpbGl0eSBhcyBhbiBvcmFsIGRydWcu">⬇</a></div>
<div class="ltx_listingline" id="lstnumberx29">
<span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.1" style="color:#0000FF;">The</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.2" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.3" style="color:#0000FF;">drug</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.4" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.5" style="color:#0000FF;">utility</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.6" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.7" style="color:#0000FF;">of</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.8" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.9" style="color:#0000FF;">a</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.10" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.11" style="color:#0000FF;">molecule</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.12" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.13" style="color:#0000FF;">is</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.14" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.15" style="color:#0000FF;">assessed</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.16" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.17" style="color:#0000FF;">based</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.18" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.19" style="color:#0000FF;">on</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.20" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.21" style="color:#0000FF;">its</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.22" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.23" style="color:#0000FF;">potential</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.24" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.25" style="color:#0000FF;">to</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.26" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.27" style="color:#0000FF;">serve</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.28" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.29" style="color:#0000FF;">as</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.30" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.31" style="color:#0000FF;">a</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.32" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.33" style="color:#0000FF;">therapeutic</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.34" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.35" style="color:#0000FF;">agent</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx29.36" style="color:#0000FF;">.</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.37" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.38" style="color:#0000FF;">Key</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.39" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.40" style="color:#0000FF;">properties</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.41" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.42" style="color:#0000FF;">considered</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.43" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.44" style="color:#0000FF;">include</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.45" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.46" style="color:#0000FF;">pharmacokinetics</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx29.47" style="color:#0000FF;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.48" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.49" style="color:#0000FF;">which</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.50" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.51" style="color:#0000FF;">encompasses</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.52" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.53" style="color:#0000FF;">absorption</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx29.54" style="color:#0000FF;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.55" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.56" style="color:#0000FF;">distribution</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx29.57" style="color:#0000FF;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.58" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.59" style="color:#0000FF;">metabolism</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx29.60" style="color:#0000FF;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.61" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.62" style="color:#0000FF;">excretion</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.63" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx29.64" style="color:#0000FF;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.65" style="color:#0000FF;">ADME</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx29.66" style="color:#0000FF;">),</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.67" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.68" style="color:#0000FF;">and</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.69" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.70" style="color:#0000FF;">toxicity</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx29.71" style="color:#0000FF;">.</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.72" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.73" style="color:#0000FF;">Bioactivity</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.74" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.75" style="color:#0000FF;">is</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.76" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.77" style="color:#0000FF;">another</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.78" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.79" style="color:#0000FF;">critical</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.80" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.81" style="color:#0000FF;">factor</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx29.82" style="color:#0000FF;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.83" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.84" style="color:#0000FF;">measured</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.85" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.86" style="color:#0000FF;">by</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.87" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.88" style="color:#0000FF;">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.89" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.90" style="color:#0000FF;">molecule</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx29.91" style="color:#0000FF;">’</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.92" style="color:#0000FF;">s</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.93" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.94" style="color:#0000FF;">ability</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.95" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.96" style="color:#0000FF;">to</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.97" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.98" style="color:#0000FF;">interact</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.99" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.100" style="color:#0000FF;">with</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.101" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.102" style="color:#0000FF;">biological</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.103" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.104" style="color:#0000FF;">targets</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx29.105" style="color:#0000FF;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.106" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.107" style="color:#0000FF;">typically</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.108" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.109" style="color:#0000FF;">through</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.110" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.111" style="color:#0000FF;">binding</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.112" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.113" style="color:#0000FF;">affinity</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx29.114" style="color:#0000FF;">.</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.115" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.116" style="color:#0000FF;">Additionally</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx29.117" style="color:#0000FF;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.118" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.119" style="color:#0000FF;">drug</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx29.120" style="color:#0000FF;">-</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.121" style="color:#0000FF;">likeness</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx29.122" style="color:#0000FF;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.123" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.124" style="color:#0000FF;">which</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.125" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.126" style="color:#0000FF;">refers</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.127" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.128" style="color:#0000FF;">to</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.129" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.130" style="color:#0000FF;">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.131" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.132" style="color:#0000FF;">molecule</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx29.133" style="color:#0000FF;">’</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.134" style="color:#0000FF;">s</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.135" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.136" style="color:#0000FF;">adherence</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.137" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.138" style="color:#0000FF;">to</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.139" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.140" style="color:#0000FF;">established</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.141" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.142" style="color:#0000FF;">rules</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.143" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.144" style="color:#0000FF;">such</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.145" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.146" style="color:#0000FF;">as</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.147" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.148" style="color:#0000FF;">Lipinski</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx29.149" style="color:#0000FF;">’</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.150" style="color:#0000FF;">s</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.151" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.152" style="color:#0000FF;">Rule</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.153" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.154" style="color:#0000FF;">of</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.155" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.156" style="color:#0000FF;">Five</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx29.157" style="color:#0000FF;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.158" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.159" style="color:#0000FF;">is</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.160" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.161" style="color:#0000FF;">essential</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx29.162" style="color:#0000FF;">.</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.163" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.164" style="color:#0000FF;">This</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.165" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.166" style="color:#0000FF;">rule</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.167" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.168" style="color:#0000FF;">evaluates</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.169" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.170" style="color:#0000FF;">molecular</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.171" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.172" style="color:#0000FF;">weight</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx29.173" style="color:#0000FF;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.174" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.175" style="color:#0000FF;">hydrogen</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.176" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.177" style="color:#0000FF;">bond</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.178" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.179" style="color:#0000FF;">donors</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.180" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.181" style="color:#0000FF;">and</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.182" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.183" style="color:#0000FF;">acceptors</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx29.184" style="color:#0000FF;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.185" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.186" style="color:#0000FF;">and</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.187" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.188" style="color:#0000FF;">lipophilicity</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.189" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.190" style="color:#0000FF;">to</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.191" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.192" style="color:#0000FF;">predict</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.193" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.194" style="color:#0000FF;">a</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.195" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.196" style="color:#0000FF;">molecule</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx29.197" style="color:#0000FF;">’</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.198" style="color:#0000FF;">s</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.199" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.200" style="color:#0000FF;">suitability</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.201" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.202" style="color:#0000FF;">as</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.203" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.204" style="color:#0000FF;">an</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.205" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.206" style="color:#0000FF;">oral</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx29.207" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx29.208" style="color:#0000FF;">drug</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx29.209" style="color:#0000FF;">.</span>
</div>
</div>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS2.SSS3.p5">
<p class="ltx_p" id="A2.SS2.SSS3.p5.1">The pre-defined utility context for the polymer is as follows:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_listing ltx_lstlisting ltx_listing" id="A2.SS2.SSS3.p5.2">
<div class="ltx_listing_data"><a download="" href="data:text/plain;base64,VGhlIG1hdGVyaWFsIHV0aWxpdHkgb2YgYSBtb2xlY3VsZSwgcGFydGljdWxhcmx5IGZvciBjcmVhdGluZyBwb2x5bWVyaWMgbWF0ZXJpYWxzLCBpcyBldmFsdWF0ZWQgYmFzZWQgb24gcHJvcGVydGllcyBsaWtlIG1lY2hhbmljYWwgc3RyZW5ndGgsIGZsZXhpYmlsaXR5LCBhbmQgdGhlcm1hbCBhbmQgZWxlY3RyaWNhbCBiZWhhdmlvci4gRm9yIHBvbHltZXIgbWVtYnJhbmVzIHVzZWQgaW4gZ2FzIHNlcGFyYXRpb24sIGNydWNpYWwgZmFjdG9ycyBpbmNsdWRlIGdhcyBwZXJtZWFiaWxpdHksIHdoaWNoIGRldGVybWluZXMgdGhlIGVmZmljaWVuY3kgb2YgZ2FzIGRpZmZ1c2lvbiwgYW5kIGNoZW1pY2FsIHN0YWJpbGl0eSwgZW5zdXJpbmcgcmVzaXN0YW5jZSB0byBkZWdyYWRhdGlvbi4gQWRkaXRpb25hbGx5LCB0aGVybWFsIHByb3BlcnRpZXMgc3VjaCBhcyBtZWx0aW5nIHBvaW50IGFuZCB0aGVybWFsIGNvbmR1Y3Rpdml0eSBhcmUgdml0YWwsIGFzIHRoZXkgYWZmZWN0IHRoZSBtYXRlcmlhbCdzIHBlcmZvcm1hbmNlIHVuZGVyIHZhcmlvdXMgdGVtcGVyYXR1cmUgY29uZGl0aW9ucy4gRWxlY3RyaWNhbCBwcm9wZXJ0aWVzLCBzdWNoIGFzIGNvbmR1Y3Rpdml0eSBhbmQgZGllbGVjdHJpYyBjb25zdGFudCwgbWF5IGFsc28gYmUgc2lnbmlmaWNhbnQgZGVwZW5kaW5nIG9uIHRoZSBpbnRlbmRlZCBhcHBsaWNhdGlvbi4=">⬇</a></div>
<div class="ltx_listingline" id="lstnumberx30">
<span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.1" style="color:#0000FF;">The</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.2" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.3" style="color:#0000FF;">material</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.4" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.5" style="color:#0000FF;">utility</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.6" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.7" style="color:#0000FF;">of</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.8" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.9" style="color:#0000FF;">a</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.10" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.11" style="color:#0000FF;">molecule</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx30.12" style="color:#0000FF;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.13" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.14" style="color:#0000FF;">particularly</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.15" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.16" style="color:#0000FF;">for</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.17" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.18" style="color:#0000FF;">creating</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.19" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.20" style="color:#0000FF;">polymeric</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.21" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.22" style="color:#0000FF;">materials</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx30.23" style="color:#0000FF;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.24" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.25" style="color:#0000FF;">is</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.26" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.27" style="color:#0000FF;">evaluated</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.28" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.29" style="color:#0000FF;">based</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.30" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.31" style="color:#0000FF;">on</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.32" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.33" style="color:#0000FF;">properties</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.34" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.35" style="color:#0000FF;">like</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.36" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.37" style="color:#0000FF;">mechanical</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.38" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.39" style="color:#0000FF;">strength</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx30.40" style="color:#0000FF;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.41" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.42" style="color:#0000FF;">flexibility</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx30.43" style="color:#0000FF;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.44" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.45" style="color:#0000FF;">and</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.46" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.47" style="color:#0000FF;">thermal</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.48" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.49" style="color:#0000FF;">and</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.50" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.51" style="color:#0000FF;">electrical</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.52" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.53" style="color:#0000FF;">behavior</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx30.54" style="color:#0000FF;">.</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.55" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.56" style="color:#0000FF;">For</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.57" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.58" style="color:#0000FF;">polymer</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.59" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.60" style="color:#0000FF;">membranes</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.61" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.62" style="color:#0000FF;">used</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.63" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.64" style="color:#0000FF;">in</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.65" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.66" style="color:#0000FF;">gas</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.67" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.68" style="color:#0000FF;">separation</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx30.69" style="color:#0000FF;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.70" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.71" style="color:#0000FF;">crucial</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.72" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.73" style="color:#0000FF;">factors</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.74" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.75" style="color:#0000FF;">include</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.76" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.77" style="color:#0000FF;">gas</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.78" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.79" style="color:#0000FF;">permeability</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx30.80" style="color:#0000FF;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.81" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.82" style="color:#0000FF;">which</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.83" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.84" style="color:#0000FF;">determines</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.85" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.86" style="color:#0000FF;">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.87" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.88" style="color:#0000FF;">efficiency</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.89" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.90" style="color:#0000FF;">of</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.91" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.92" style="color:#0000FF;">gas</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.93" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.94" style="color:#0000FF;">diffusion</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx30.95" style="color:#0000FF;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.96" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.97" style="color:#0000FF;">and</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.98" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.99" style="color:#0000FF;">chemical</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.100" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.101" style="color:#0000FF;">stability</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx30.102" style="color:#0000FF;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.103" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.104" style="color:#0000FF;">ensuring</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.105" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.106" style="color:#0000FF;">resistance</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.107" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.108" style="color:#0000FF;">to</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.109" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.110" style="color:#0000FF;">degradation</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx30.111" style="color:#0000FF;">.</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.112" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.113" style="color:#0000FF;">Additionally</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx30.114" style="color:#0000FF;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.115" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.116" style="color:#0000FF;">thermal</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.117" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.118" style="color:#0000FF;">properties</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.119" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.120" style="color:#0000FF;">such</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.121" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.122" style="color:#0000FF;">as</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.123" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.124" style="color:#0000FF;">melting</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.125" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.126" style="color:#0000FF;">point</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.127" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.128" style="color:#0000FF;">and</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.129" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.130" style="color:#0000FF;">thermal</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.131" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.132" style="color:#0000FF;">conductivity</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.133" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.134" style="color:#0000FF;">are</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.135" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.136" style="color:#0000FF;">vital</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx30.137" style="color:#0000FF;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.138" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.139" style="color:#0000FF;">as</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.140" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.141" style="color:#0000FF;">they</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.142" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.143" style="color:#0000FF;">affect</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.144" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.145" style="color:#0000FF;">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.146" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.147" style="color:#0000FF;">material</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx30.148" style="color:#0000FF;">’</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.149" style="color:#0000FF;">s</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.150" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.151" style="color:#0000FF;">performance</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.152" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.153" style="color:#0000FF;">under</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.154" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.155" style="color:#0000FF;">various</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.156" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.157" style="color:#0000FF;">temperature</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.158" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.159" style="color:#0000FF;">conditions</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx30.160" style="color:#0000FF;">.</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.161" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.162" style="color:#0000FF;">Electrical</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.163" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.164" style="color:#0000FF;">properties</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx30.165" style="color:#0000FF;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.166" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.167" style="color:#0000FF;">such</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.168" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.169" style="color:#0000FF;">as</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.170" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.171" style="color:#0000FF;">conductivity</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.172" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.173" style="color:#0000FF;">and</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.174" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.175" style="color:#0000FF;">dielectric</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.176" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.177" style="color:#0000FF;">constant</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx30.178" style="color:#0000FF;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.179" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.180" style="color:#0000FF;">may</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.181" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.182" style="color:#0000FF;">also</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.183" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.184" style="color:#0000FF;">be</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.185" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.186" style="color:#0000FF;">significant</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.187" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.188" style="color:#0000FF;">depending</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.189" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.190" style="color:#0000FF;">on</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.191" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.192" style="color:#0000FF;">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.193" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.194" style="color:#0000FF;">intended</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx30.195" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx30.196" style="color:#0000FF;">application</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx30.197" style="color:#0000FF;">.</span>
</div>
</div>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS2.SSS3.p6">
<p class="ltx_p" id="A2.SS2.SSS3.p6.1">For the property variable, we include the property name with values, as well as the minimum, maximum, and percentile among the labels in the template. We repeat all annotated properties in the property variable. The estimated synthesis complexity scores are included among them.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS2.SSS3.p7">
<p class="ltx_p" id="A2.SS2.SSS3.p7.1">We also prompt Llama-3-70B to generate short responses of 50-70 words, producing a molecular description for each molecule based on its properties, structures, and synthesis estimation. If a molecule has a description from PubChem&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[Kim et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib22" title="">2021</a>]</cite>, we concatenate these descriptions.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS2.SSS3.p8">
<p class="ltx_p" id="A2.SS2.SSS3.p8.1">The generated texts may not always be meaningful or valid. We can establish filter rules based on patterns observed in poorly generated texts to remove them. We then regenerate texts for these items. After several iterations, we obtain the final text data for molecular utility descriptions, improving overall text quality. We also apply this strategy to other steps that involves prompting LLMs for synthetic data creation.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsubsection" id="A2.SS2.SSS4">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">B.2.4 </span>Creation of Question Answering Data</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A2.SS2.SSS4.p1">
<p class="ltx_p" id="A2.SS2.SSS4.p1.1">After annotating molecular description texts from&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A2.SS2.SSS3" title="B.2.3 Creation of Text Data for Molecular Description ‣ B.2 Details on the Creation of MolQA ‣ Appendix B Additional Benchmarking and Datasets Details ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Section</span>&nbsp;<span class="ltx_text ltx_ref_tag">B.2.3</span></a>, we combine them with reaction descriptions, including the reaction formula and template from synthesis routes in&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A2.SS2.SSS1" title="B.2.1 Creation of Synthesis Routes ‣ B.2 Details on the Creation of MolQA ‣ Appendix B Additional Benchmarking and Datasets Details ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Section</span>&nbsp;<span class="ltx_text ltx_ref_tag">B.2.1</span></a>. This forms the answer data in a QA data pair.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS2.SSS4.p2">
<p class="ltx_p" id="A2.SS2.SSS4.p2.1">Next, we prompt Llame-3-70B to generate questions for each answer based on the following template.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS2.SSS4.p3">
<div class="ltx_listing ltx_lstlisting ltx_listing" id="A2.SS2.SSS4.p3.1">
<div class="ltx_listing_data"><a download="" href="data:text/plain;base64,SSdtIGNyZWF0aW5nIGEgcXVlc3Rpb24tYW5zd2VyIGRhdGFzZXQgZm9yIExMTSBmaW5lLXR1bmluZy4KVGhlIHF1ZXN0aW9uIGlzIGFib3V0IGRlc2lnbmluZyBhIG1vbGVjdWxlL3BvbHltZXIgd2l0aCB0aGVzZSBwcm9wZXJ0aWVzOiB7cHJvcGVydHlfaW5mb30gYW5kIHRoZSBmb2xsb3dpbmcgc3RydWN0dXJlIGluZm9ybWF0aW9uOiB7c3RydWN0dXJlX2luZm99LgpUaGUgZXhwZWN0ZWQgYW5zd2VyIGZvciB0aGUgcXVlc3Rpb24gaXM6IHthbnN3ZXJ9CkdlbmVyYXRlIGEgU0lOR0xFIHF1ZXN0aW9uIGFib3V0IGRlc2lnbmluZyBhbmQgc3ludGhlc2l6aW5nIHN1Y2ggYSBtb2xlY3VsZS9wb2x5bWVyIHRoYXQgbWVldHMgdGhlc2UgY3JpdGVyaWE6CigxKSBTdGFydCB3aXRoICdRdWVzdGlvbjonOyAoMikgRW5kIHdpdGggYSBxdWVzdGlvbiBtYXJrOwooMykgU291bmQgbmF0dXJhbDsgKDQpIEJlIGRpdmVyc2U7ICg1KSBBdm9pZCByZWR1bmRhbmN5IGFuZCBpbnRyb2R1Y3Rvcnkgd29yZHMgKGxpa2UgJ0hlcmUgaXMgYSBxdWVzdGlvbiB0aGF0IG1lZXRzIHRoZSBjcml0ZXJpYTonKQooNikgRG8gbm90IGluY2x1ZGUgdGhlIGFuc3dlcjsgKDcpIERvIG5vdCBpbmNsdWRlIGluY29ycmVjdCBpbmZvcm1hdGlvbi4KCkV4YW1wbGUgcXVlc3Rpb25zOgooMSkgSG93IGNhbiBJIGRlc2lnbiBhbmQgc3ludGhlc2l6ZSBhIG1vbGVjdWxlIHdpdGggWCwgWSwgYW5kIFogcHJvcGVydGllcz8KKDIpIFdoYXQgaXMgdGhlIGJlc3Qgd2F5IHRvIGNyZWF0ZSBhIHBvbHltZXIgd2l0aCBYLCBZLCBhbmQgWiBjaGFyYWN0ZXJpc3RpY3M/CigzKSBIb3cgdG8gZGVzaWduIGEgbW9sZWN1bGUgd2l0aCBYLCBZLCBhbmQgWiBmZWF0dXJlcyBhbmQgc3ludGhlc2l6ZSBpdD8KKDQpIEkgd2FudCBhIG1vbGVjdWxlIHdpdGggWCwgWSBwcm9wZXJ0aWVzIGFuZCBaIHN0cnVjdHVyZXMuIFBsZWFzZSBkZXNpZ24gaXQgYW5kIGRlc2NyaWJlIHRoZSBzeW50aGVzaXMgcGF0aC4=">⬇</a></div>
<div class="ltx_listingline" id="lstnumberx31">
<span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx31.1" style="color:#0000FF;">I</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx31.2" style="color:#0000FF;">’</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx31.3" style="color:#0000FF;">m</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx31.4" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx31.5" style="color:#0000FF;">creating</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx31.6" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx31.7" style="color:#0000FF;">a</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx31.8" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx31.9" style="color:#0000FF;">question</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx31.10" style="color:#0000FF;">-</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx31.11" style="color:#0000FF;">answer</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx31.12" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx31.13" style="color:#0000FF;">dataset</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx31.14" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx31.15" style="color:#0000FF;">for</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx31.16" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx31.17" style="color:#0000FF;">LLM</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx31.18" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx31.19" style="color:#0000FF;">fine</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx31.20" style="color:#0000FF;">-</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx31.21" style="color:#0000FF;">tuning</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx31.22" style="color:#0000FF;">.</span>
</div>
<div class="ltx_listingline" id="lstnumberx32">
<span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx32.1" style="color:#0000FF;">The</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx32.2" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx32.3" style="color:#0000FF;">question</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx32.4" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx32.5" style="color:#0000FF;">is</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx32.6" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx32.7" style="color:#0000FF;">about</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx32.8" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx32.9" style="color:#0000FF;">designing</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx32.10" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx32.11" style="color:#0000FF;">a</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx32.12" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx32.13" style="color:#0000FF;">molecule</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx32.14" style="color:#0000FF;">/</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx32.15" style="color:#0000FF;">polymer</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx32.16" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx32.17" style="color:#0000FF;">with</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx32.18" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx32.19" style="color:#0000FF;">these</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx32.20" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx32.21" style="color:#0000FF;">properties</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx32.22" style="color:#0000FF;">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx32.23" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx32.24" style="color:#0000FF;">{</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx32.25" style="color:#0000FF;">property_info</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx32.26" style="color:#0000FF;">}</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx32.27" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx32.28" style="color:#0000FF;">and</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx32.29" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx32.30" style="color:#0000FF;">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx32.31" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx32.32" style="color:#0000FF;">following</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx32.33" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx32.34" style="color:#0000FF;">structure</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx32.35" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx32.36" style="color:#0000FF;">information</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx32.37" style="color:#0000FF;">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx32.38" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx32.39" style="color:#0000FF;">{</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx32.40" style="color:#0000FF;">structure_info</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx32.41" style="color:#0000FF;">}.</span>
</div>
<div class="ltx_listingline" id="lstnumberx33">
<span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx33.1" style="color:#0000FF;">The</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx33.2" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx33.3" style="color:#0000FF;">expected</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx33.4" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx33.5" style="color:#0000FF;">answer</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx33.6" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx33.7" style="color:#0000FF;">for</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx33.8" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx33.9" style="color:#0000FF;">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx33.10" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx33.11" style="color:#0000FF;">question</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx33.12" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx33.13" style="color:#0000FF;">is</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx33.14" style="color:#0000FF;">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx33.15" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx33.16" style="color:#0000FF;">{</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx33.17" style="color:#0000FF;">answer</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx33.18" style="color:#0000FF;">}</span>
</div>
<div class="ltx_listingline" id="lstnumberx34">
<span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx34.1" style="color:#0000FF;">Generate</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx34.2" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx34.3" style="color:#0000FF;">a</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx34.4" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx34.5" style="color:#0000FF;">SINGLE</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx34.6" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx34.7" style="color:#0000FF;">question</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx34.8" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx34.9" style="color:#0000FF;">about</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx34.10" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx34.11" style="color:#0000FF;">designing</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx34.12" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx34.13" style="color:#0000FF;">and</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx34.14" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx34.15" style="color:#0000FF;">synthesizing</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx34.16" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx34.17" style="color:#0000FF;">such</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx34.18" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx34.19" style="color:#0000FF;">a</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx34.20" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx34.21" style="color:#0000FF;">molecule</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx34.22" style="color:#0000FF;">/</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx34.23" style="color:#0000FF;">polymer</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx34.24" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx34.25" style="color:#0000FF;">that</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx34.26" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx34.27" style="color:#0000FF;">meets</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx34.28" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx34.29" style="color:#0000FF;">these</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx34.30" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx34.31" style="color:#0000FF;">criteria</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx34.32" style="color:#0000FF;">:</span>
</div>
<div class="ltx_listingline" id="lstnumberx35">
<span class="ltx_text ltx_font_typewriter" id="lstnumberx35.1" style="color:#0000FF;">(1)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx35.2" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx35.3" style="color:#0000FF;">Start</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx35.4" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx35.5" style="color:#0000FF;">with</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx35.6" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx35.7" style="color:#0000FF;">’</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx35.8" style="color:#0000FF;">Question</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx35.9" style="color:#0000FF;">:’;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx35.10" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx35.11" style="color:#0000FF;">(2)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx35.12" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx35.13" style="color:#0000FF;">End</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx35.14" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx35.15" style="color:#0000FF;">with</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx35.16" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx35.17" style="color:#0000FF;">a</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx35.18" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx35.19" style="color:#0000FF;">question</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx35.20" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx35.21" style="color:#0000FF;">mark</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx35.22" style="color:#0000FF;">;</span>
</div>
<div class="ltx_listingline" id="lstnumberx36">
<span class="ltx_text ltx_font_typewriter" id="lstnumberx36.1" style="color:#0000FF;">(3)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx36.2" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx36.3" style="color:#0000FF;">Sound</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx36.4" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx36.5" style="color:#0000FF;">natural</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx36.6" style="color:#0000FF;">;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx36.7" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx36.8" style="color:#0000FF;">(4)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx36.9" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx36.10" style="color:#0000FF;">Be</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx36.11" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx36.12" style="color:#0000FF;">diverse</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx36.13" style="color:#0000FF;">;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx36.14" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx36.15" style="color:#0000FF;">(5)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx36.16" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx36.17" style="color:#0000FF;">Avoid</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx36.18" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx36.19" style="color:#0000FF;">redundancy</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx36.20" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx36.21" style="color:#0000FF;">and</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx36.22" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx36.23" style="color:#0000FF;">introductory</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx36.24" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx36.25" style="color:#0000FF;">words</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx36.26" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx36.27" style="color:#0000FF;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx36.28" style="color:#0000FF;">like</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx36.29" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx36.30" style="color:#0000FF;">’</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx36.31" style="color:#0000FF;">Here</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx36.32" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx36.33" style="color:#0000FF;">is</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx36.34" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx36.35" style="color:#0000FF;">a</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx36.36" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx36.37" style="color:#0000FF;">question</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx36.38" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx36.39" style="color:#0000FF;">that</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx36.40" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx36.41" style="color:#0000FF;">meets</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx36.42" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx36.43" style="color:#0000FF;">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx36.44" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx36.45" style="color:#0000FF;">criteria</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx36.46" style="color:#0000FF;">:’)</span>
</div>
<div class="ltx_listingline" id="lstnumberx37">
<span class="ltx_text ltx_font_typewriter" id="lstnumberx37.1" style="color:#0000FF;">(6)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx37.2" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx37.3" style="color:#0000FF;">Do</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx37.4" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx37.5" style="color:#0000FF;">not</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx37.6" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx37.7" style="color:#0000FF;">include</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx37.8" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx37.9" style="color:#0000FF;">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx37.10" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx37.11" style="color:#0000FF;">answer</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx37.12" style="color:#0000FF;">;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx37.13" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx37.14" style="color:#0000FF;">(7)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx37.15" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx37.16" style="color:#0000FF;">Do</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx37.17" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx37.18" style="color:#0000FF;">not</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx37.19" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx37.20" style="color:#0000FF;">include</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx37.21" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx37.22" style="color:#0000FF;">incorrect</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx37.23" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx37.24" style="color:#0000FF;">information</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx37.25" style="color:#0000FF;">.</span>
</div>
<div class="ltx_listingline" id="lstnumberx38">
</div>
<div class="ltx_listingline" id="lstnumberx39">
<span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx39.1" style="color:#0000FF;">Example</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx39.2" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx39.3" style="color:#0000FF;">questions</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx39.4" style="color:#0000FF;">:</span>
</div>
<div class="ltx_listingline" id="lstnumberx40">
<span class="ltx_text ltx_font_typewriter" id="lstnumberx40.1" style="color:#0000FF;">(1)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx40.2" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx40.3" style="color:#0000FF;">How</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx40.4" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx40.5" style="color:#0000FF;">can</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx40.6" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx40.7" style="color:#0000FF;">I</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx40.8" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx40.9" style="color:#0000FF;">design</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx40.10" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx40.11" style="color:#0000FF;">and</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx40.12" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx40.13" style="color:#0000FF;">synthesize</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx40.14" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx40.15" style="color:#0000FF;">a</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx40.16" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx40.17" style="color:#0000FF;">molecule</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx40.18" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx40.19" style="color:#0000FF;">with</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx40.20" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx40.21" style="color:#0000FF;">X</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx40.22" style="color:#0000FF;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx40.23" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx40.24" style="color:#0000FF;">Y</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx40.25" style="color:#0000FF;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx40.26" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx40.27" style="color:#0000FF;">and</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx40.28" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx40.29" style="color:#0000FF;">Z</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx40.30" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx40.31" style="color:#0000FF;">properties</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx40.32" style="color:#0000FF;">?</span>
</div>
<div class="ltx_listingline" id="lstnumberx41">
<span class="ltx_text ltx_font_typewriter" id="lstnumberx41.1" style="color:#0000FF;">(2)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx41.2" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx41.3" style="color:#0000FF;">What</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx41.4" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx41.5" style="color:#0000FF;">is</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx41.6" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx41.7" style="color:#0000FF;">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx41.8" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx41.9" style="color:#0000FF;">best</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx41.10" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx41.11" style="color:#0000FF;">way</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx41.12" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx41.13" style="color:#0000FF;">to</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx41.14" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx41.15" style="color:#0000FF;">create</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx41.16" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx41.17" style="color:#0000FF;">a</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx41.18" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx41.19" style="color:#0000FF;">polymer</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx41.20" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx41.21" style="color:#0000FF;">with</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx41.22" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx41.23" style="color:#0000FF;">X</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx41.24" style="color:#0000FF;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx41.25" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx41.26" style="color:#0000FF;">Y</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx41.27" style="color:#0000FF;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx41.28" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx41.29" style="color:#0000FF;">and</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx41.30" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx41.31" style="color:#0000FF;">Z</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx41.32" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx41.33" style="color:#0000FF;">characteristics</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx41.34" style="color:#0000FF;">?</span>
</div>
<div class="ltx_listingline" id="lstnumberx42">
<span class="ltx_text ltx_font_typewriter" id="lstnumberx42.1" style="color:#0000FF;">(3)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx42.2" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx42.3" style="color:#0000FF;">How</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx42.4" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx42.5" style="color:#0000FF;">to</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx42.6" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx42.7" style="color:#0000FF;">design</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx42.8" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx42.9" style="color:#0000FF;">a</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx42.10" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx42.11" style="color:#0000FF;">molecule</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx42.12" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx42.13" style="color:#0000FF;">with</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx42.14" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx42.15" style="color:#0000FF;">X</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx42.16" style="color:#0000FF;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx42.17" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx42.18" style="color:#0000FF;">Y</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx42.19" style="color:#0000FF;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx42.20" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx42.21" style="color:#0000FF;">and</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx42.22" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx42.23" style="color:#0000FF;">Z</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx42.24" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx42.25" style="color:#0000FF;">features</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx42.26" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx42.27" style="color:#0000FF;">and</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx42.28" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx42.29" style="color:#0000FF;">synthesize</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx42.30" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx42.31" style="color:#0000FF;">it</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx42.32" style="color:#0000FF;">?</span>
</div>
<div class="ltx_listingline" id="lstnumberx43">
<span class="ltx_text ltx_font_typewriter" id="lstnumberx43.1" style="color:#0000FF;">(4)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx43.2" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx43.3" style="color:#0000FF;">I</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx43.4" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx43.5" style="color:#0000FF;">want</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx43.6" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx43.7" style="color:#0000FF;">a</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx43.8" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx43.9" style="color:#0000FF;">molecule</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx43.10" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx43.11" style="color:#0000FF;">with</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx43.12" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx43.13" style="color:#0000FF;">X</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx43.14" style="color:#0000FF;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx43.15" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx43.16" style="color:#0000FF;">Y</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx43.17" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx43.18" style="color:#0000FF;">properties</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx43.19" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx43.20" style="color:#0000FF;">and</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx43.21" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx43.22" style="color:#0000FF;">Z</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx43.23" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx43.24" style="color:#0000FF;">structures</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx43.25" style="color:#0000FF;">.</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx43.26" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx43.27" style="color:#0000FF;">Please</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx43.28" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx43.29" style="color:#0000FF;">design</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx43.30" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx43.31" style="color:#0000FF;">it</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx43.32" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx43.33" style="color:#0000FF;">and</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx43.34" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx43.35" style="color:#0000FF;">describe</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx43.36" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx43.37" style="color:#0000FF;">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx43.38" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx43.39" style="color:#0000FF;">synthesis</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx43.40" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx43.41" style="color:#0000FF;">path</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx43.42" style="color:#0000FF;">.</span>
</div>
</div>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS2.SSS4.p4">
<p class="ltx_p" id="A2.SS2.SSS4.p4.1">The template is applied to any answer with the corresponding structure, property information, and complete answer texts.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_subsection" id="A2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.3 </span>Details on the Creation of MolPair</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A2.SS3.p1">
<p class="ltx_p" id="A2.SS3.p1.1">MolPair consists of two parts: reaction-text pairs and graph-text pairs.
We curate reaction-text pairs from USPTO&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[Lowe, <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib29" title="">2017</a>]</cite>, pairing each reaction with its corresponding description of the reaction conditions. We first deduplicate product molecules in reactions, obtaining input data as the product molecule alongside the reaction condition texts. Next, we extract reaction templates from the reaction formula using rdchiral&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[Coley et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib8" title="">2019</a>]</cite>, resulting in approximately 300K templates, which will serve as labels for predictions. Finally, we have approximately 1.6 million training examples.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS3.p2">
<p class="ltx_p" id="A2.SS3.p2.1">For the graph-text pairs, we use small molecules and polymers from the multisource collection, excluding those in MolQA. We follow the same pipeline used to create property and text annotations for the MolQA data, focusing on broader properties that describe drug-related utility with 41 small molecule properties&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[Swanson et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib38" title="">2024</a>]</cite>. Besides the three used in MolQA, others include:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul class="ltx_itemize" id="A2.I3">
<li class="ltx_item" id="A2.I3.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I3.i1.p1">
<p class="ltx_p" id="A2.I3.i1.p1.1">Toxicity and Safety: AMES, Carcinogens Lagunin, ClinTox, DILI, Skin Reaction, hERG</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A2.I3.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I3.i2.p1">
<p class="ltx_p" id="A2.I3.i2.p1.1">Enzyme Interaction: CYP1A2 Veith, CYP2C19 Veith, CYP2C9 Substrate CarbonMangels, CYP2C9 Veith, CYP2D6 Substrate CarbonMangels, CYP2D6 Veith, CYP3A4 Substrate CarbonMangels, CYP3A4 Veith</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A2.I3.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I3.i3.p1">
<p class="ltx_p" id="A2.I3.i3.p1.1">Absorption, Distribution, Metabolism, and Excretion (ADME): BBB Martins, Bioavailability Ma, Caco2 Wang, Clearance Hepatocyte AZ, Clearance Microsome AZ, HIA Hou, Half Life Obach, Hydration Free Energy FreeSolv, Lipophilicity AstraZeneca, PAMPA NCATS, PPBR AZ, Pgp Broccatelli, Solubility AqSolDB, VDss Lombardo</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A2.I3.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I3.i4.p1">
<p class="ltx_p" id="A2.I3.i4.p1.1">Stress Response: SR-ARE, SR-ATAD5, SR-HSE, SR-MMP, SR-p53</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A2.I3.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I3.i5.p1">
<p class="ltx_p" id="A2.I3.i5.p1.1">Nuclear Receptor Interaction: NR-AR-LBD, NR-AR, NR-AhR, NR-Aromatase, NR-ER-LBD, NR-ER, NR-PPAR-gamma</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ul>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS3.p3">
<p class="ltx_p" id="A2.SS3.p3.1">We describe polymeric material utility based on 14 polymer properties collected from&nbsp;<cite class="ltx_cite ltx_citemacro_citet">Otsuka et&nbsp;al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib31" title="">2011</a>]</cite>:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul class="ltx_itemize" id="A2.I4">
<li class="ltx_item" id="A2.I4.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I4.i1.p1">
<p class="ltx_p" id="A2.I4.i1.p1.2">Thermal Properties: Melting temperature [°C]; Specific heat capacity at constant pressure (<math alttext="C_{p}" class="ltx_Math" display="inline" id="A2.I4.i1.p1.1.m1.1"><semantics id="A2.I4.i1.p1.1.m1.1a"><msub id="A2.I4.i1.p1.1.m1.1.1" xref="A2.I4.i1.p1.1.m1.1.1.cmml"><mi id="A2.I4.i1.p1.1.m1.1.1.2" xref="A2.I4.i1.p1.1.m1.1.1.2.cmml">C</mi><mi id="A2.I4.i1.p1.1.m1.1.1.3" xref="A2.I4.i1.p1.1.m1.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="A2.I4.i1.p1.1.m1.1b"><apply id="A2.I4.i1.p1.1.m1.1.1.cmml" xref="A2.I4.i1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A2.I4.i1.p1.1.m1.1.1.1.cmml" xref="A2.I4.i1.p1.1.m1.1.1">subscript</csymbol><ci id="A2.I4.i1.p1.1.m1.1.1.2.cmml" xref="A2.I4.i1.p1.1.m1.1.1.2">𝐶</ci><ci id="A2.I4.i1.p1.1.m1.1.1.3.cmml" xref="A2.I4.i1.p1.1.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.I4.i1.p1.1.m1.1c">C_{p}</annotation><annotation encoding="application/x-llamapun" id="A2.I4.i1.p1.1.m1.1d">italic_C start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math>) [cal/(g·°C)]; Specific heat capacity at constant volume (<math alttext="C_{v}" class="ltx_Math" display="inline" id="A2.I4.i1.p1.2.m2.1"><semantics id="A2.I4.i1.p1.2.m2.1a"><msub id="A2.I4.i1.p1.2.m2.1.1" xref="A2.I4.i1.p1.2.m2.1.1.cmml"><mi id="A2.I4.i1.p1.2.m2.1.1.2" xref="A2.I4.i1.p1.2.m2.1.1.2.cmml">C</mi><mi id="A2.I4.i1.p1.2.m2.1.1.3" xref="A2.I4.i1.p1.2.m2.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="A2.I4.i1.p1.2.m2.1b"><apply id="A2.I4.i1.p1.2.m2.1.1.cmml" xref="A2.I4.i1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A2.I4.i1.p1.2.m2.1.1.1.cmml" xref="A2.I4.i1.p1.2.m2.1.1">subscript</csymbol><ci id="A2.I4.i1.p1.2.m2.1.1.2.cmml" xref="A2.I4.i1.p1.2.m2.1.1.2">𝐶</ci><ci id="A2.I4.i1.p1.2.m2.1.1.3.cmml" xref="A2.I4.i1.p1.2.m2.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.I4.i1.p1.2.m2.1c">C_{v}</annotation><annotation encoding="application/x-llamapun" id="A2.I4.i1.p1.2.m2.1d">italic_C start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math>) [cal/(g·°C)]; Thermal conductivity [W/(m·K)]</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A2.I4.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I4.i2.p1">
<p class="ltx_p" id="A2.I4.i2.p1.2">Physical &amp; Thermodynamic Properties: Density [g/cm<sup class="ltx_sup" id="A2.I4.i2.p1.2.1">3</sup>]; Fractional Free Volume (dimensionless); Radius of Gyration (<math alttext="R_{g}" class="ltx_Math" display="inline" id="A2.I4.i2.p1.2.m2.1"><semantics id="A2.I4.i2.p1.2.m2.1a"><msub id="A2.I4.i2.p1.2.m2.1.1" xref="A2.I4.i2.p1.2.m2.1.1.cmml"><mi id="A2.I4.i2.p1.2.m2.1.1.2" xref="A2.I4.i2.p1.2.m2.1.1.2.cmml">R</mi><mi id="A2.I4.i2.p1.2.m2.1.1.3" xref="A2.I4.i2.p1.2.m2.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="A2.I4.i2.p1.2.m2.1b"><apply id="A2.I4.i2.p1.2.m2.1.1.cmml" xref="A2.I4.i2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A2.I4.i2.p1.2.m2.1.1.1.cmml" xref="A2.I4.i2.p1.2.m2.1.1">subscript</csymbol><ci id="A2.I4.i2.p1.2.m2.1.1.2.cmml" xref="A2.I4.i2.p1.2.m2.1.1.2">𝑅</ci><ci id="A2.I4.i2.p1.2.m2.1.1.3.cmml" xref="A2.I4.i2.p1.2.m2.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.I4.i2.p1.2.m2.1c">R_{g}</annotation><annotation encoding="application/x-llamapun" id="A2.I4.i2.p1.2.m2.1d">italic_R start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT</annotation></semantics></math>) [nm]</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A2.I4.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I4.i3.p1">
<p class="ltx_p" id="A2.I4.i3.p1.8">Permeability Properties: Gas diffusion coefficient (<math alttext="D" class="ltx_Math" display="inline" id="A2.I4.i3.p1.1.m1.1"><semantics id="A2.I4.i3.p1.1.m1.1a"><mi id="A2.I4.i3.p1.1.m1.1.1" xref="A2.I4.i3.p1.1.m1.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="A2.I4.i3.p1.1.m1.1b"><ci id="A2.I4.i3.p1.1.m1.1.1.cmml" xref="A2.I4.i3.p1.1.m1.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.I4.i3.p1.1.m1.1c">D</annotation><annotation encoding="application/x-llamapun" id="A2.I4.i3.p1.1.m1.1d">italic_D</annotation></semantics></math>) [cm<sup class="ltx_sup" id="A2.I4.i3.p1.8.1">2</sup>/s]; Gas permeability coefficient (<math alttext="P" class="ltx_Math" display="inline" id="A2.I4.i3.p1.3.m3.1"><semantics id="A2.I4.i3.p1.3.m3.1a"><mi id="A2.I4.i3.p1.3.m3.1.1" xref="A2.I4.i3.p1.3.m3.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="A2.I4.i3.p1.3.m3.1b"><ci id="A2.I4.i3.p1.3.m3.1.1.cmml" xref="A2.I4.i3.p1.3.m3.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.I4.i3.p1.3.m3.1c">P</annotation><annotation encoding="application/x-llamapun" id="A2.I4.i3.p1.3.m3.1d">italic_P</annotation></semantics></math>) [cm<sup class="ltx_sup" id="A2.I4.i3.p1.8.2">3</sup> (STP)·cm/(cm<sup class="ltx_sup" id="A2.I4.i3.p1.8.3">2</sup>·s·Pa)]; Oxygen (<math alttext="\text{O}_{2}" class="ltx_Math" display="inline" id="A2.I4.i3.p1.6.m6.1"><semantics id="A2.I4.i3.p1.6.m6.1a"><msub id="A2.I4.i3.p1.6.m6.1.1" xref="A2.I4.i3.p1.6.m6.1.1.cmml"><mtext id="A2.I4.i3.p1.6.m6.1.1.2" xref="A2.I4.i3.p1.6.m6.1.1.2a.cmml">O</mtext><mn id="A2.I4.i3.p1.6.m6.1.1.3" xref="A2.I4.i3.p1.6.m6.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A2.I4.i3.p1.6.m6.1b"><apply id="A2.I4.i3.p1.6.m6.1.1.cmml" xref="A2.I4.i3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="A2.I4.i3.p1.6.m6.1.1.1.cmml" xref="A2.I4.i3.p1.6.m6.1.1">subscript</csymbol><ci id="A2.I4.i3.p1.6.m6.1.1.2a.cmml" xref="A2.I4.i3.p1.6.m6.1.1.2"><mtext id="A2.I4.i3.p1.6.m6.1.1.2.cmml" xref="A2.I4.i3.p1.6.m6.1.1.2">O</mtext></ci><cn id="A2.I4.i3.p1.6.m6.1.1.3.cmml" type="integer" xref="A2.I4.i3.p1.6.m6.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.I4.i3.p1.6.m6.1c">\text{O}_{2}</annotation><annotation encoding="application/x-llamapun" id="A2.I4.i3.p1.6.m6.1d">O start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>) Gas Permeability (Barrer); Nitrogen (<math alttext="\text{N}_{2}" class="ltx_Math" display="inline" id="A2.I4.i3.p1.7.m7.1"><semantics id="A2.I4.i3.p1.7.m7.1a"><msub id="A2.I4.i3.p1.7.m7.1.1" xref="A2.I4.i3.p1.7.m7.1.1.cmml"><mtext id="A2.I4.i3.p1.7.m7.1.1.2" xref="A2.I4.i3.p1.7.m7.1.1.2a.cmml">N</mtext><mn id="A2.I4.i3.p1.7.m7.1.1.3" xref="A2.I4.i3.p1.7.m7.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A2.I4.i3.p1.7.m7.1b"><apply id="A2.I4.i3.p1.7.m7.1.1.cmml" xref="A2.I4.i3.p1.7.m7.1.1"><csymbol cd="ambiguous" id="A2.I4.i3.p1.7.m7.1.1.1.cmml" xref="A2.I4.i3.p1.7.m7.1.1">subscript</csymbol><ci id="A2.I4.i3.p1.7.m7.1.1.2a.cmml" xref="A2.I4.i3.p1.7.m7.1.1.2"><mtext id="A2.I4.i3.p1.7.m7.1.1.2.cmml" xref="A2.I4.i3.p1.7.m7.1.1.2">N</mtext></ci><cn id="A2.I4.i3.p1.7.m7.1.1.3.cmml" type="integer" xref="A2.I4.i3.p1.7.m7.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.I4.i3.p1.7.m7.1c">\text{N}_{2}</annotation><annotation encoding="application/x-llamapun" id="A2.I4.i3.p1.7.m7.1d">N start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>) Gas Permeability (Barrer); Carbon Dioxide (<math alttext="\text{CO}_{2}" class="ltx_Math" display="inline" id="A2.I4.i3.p1.8.m8.1"><semantics id="A2.I4.i3.p1.8.m8.1a"><msub id="A2.I4.i3.p1.8.m8.1.1" xref="A2.I4.i3.p1.8.m8.1.1.cmml"><mtext id="A2.I4.i3.p1.8.m8.1.1.2" xref="A2.I4.i3.p1.8.m8.1.1.2a.cmml">CO</mtext><mn id="A2.I4.i3.p1.8.m8.1.1.3" xref="A2.I4.i3.p1.8.m8.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A2.I4.i3.p1.8.m8.1b"><apply id="A2.I4.i3.p1.8.m8.1.1.cmml" xref="A2.I4.i3.p1.8.m8.1.1"><csymbol cd="ambiguous" id="A2.I4.i3.p1.8.m8.1.1.1.cmml" xref="A2.I4.i3.p1.8.m8.1.1">subscript</csymbol><ci id="A2.I4.i3.p1.8.m8.1.1.2a.cmml" xref="A2.I4.i3.p1.8.m8.1.1.2"><mtext id="A2.I4.i3.p1.8.m8.1.1.2.cmml" xref="A2.I4.i3.p1.8.m8.1.1.2">CO</mtext></ci><cn id="A2.I4.i3.p1.8.m8.1.1.3.cmml" type="integer" xref="A2.I4.i3.p1.8.m8.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.I4.i3.p1.8.m8.1c">\text{CO}_{2}</annotation><annotation encoding="application/x-llamapun" id="A2.I4.i3.p1.8.m8.1d">CO start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>) Gas Permeability (Barrer)</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A2.I4.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I4.i4.p1">
<p class="ltx_p" id="A2.I4.i4.p1.3">Solubility Properties: Gas solubility coefficient (<math alttext="S" class="ltx_Math" display="inline" id="A2.I4.i4.p1.1.m1.1"><semantics id="A2.I4.i4.p1.1.m1.1a"><mi id="A2.I4.i4.p1.1.m1.1.1" xref="A2.I4.i4.p1.1.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="A2.I4.i4.p1.1.m1.1b"><ci id="A2.I4.i4.p1.1.m1.1.1.cmml" xref="A2.I4.i4.p1.1.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.I4.i4.p1.1.m1.1c">S</annotation><annotation encoding="application/x-llamapun" id="A2.I4.i4.p1.1.m1.1d">italic_S</annotation></semantics></math>) [cm<sup class="ltx_sup" id="A2.I4.i4.p1.3.1">3</sup> (STP)·cm/(cm<sup class="ltx_sup" id="A2.I4.i4.p1.3.2">2</sup>·s·Pa)]</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A2.I4.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I4.i5.p1">
<p class="ltx_p" id="A2.I4.i5.p1.1">Dielectric &amp; Optical Properties: Dielectric constant.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ul>
<p class="ltx_p" id="A2.SS3.p3.2">We train two multi-task GIN models based on the rationalization method&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[Liu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib23" title="">2022</a>]</cite> using all existing labeled data for drug and material property prediction, respectively. We use these models to predict properties for millions of small molecules and polymers, retaining the top ten thousand predictions by confidence score for each property. These are then used to prompt Llama-3-70B to create molecular descriptions, using the same prompt template as in&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A2.SS2.SSS3" title="B.2.3 Creation of Text Data for Molecular Description ‣ B.2 Details on the Creation of MolQA ‣ Appendix B Additional Benchmarking and Datasets Details ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Section</span>&nbsp;<span class="ltx_text ltx_ref_tag">B.2.3</span></a>. Additionally, we apply the same strategy as in&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A2.SS2.SSS3" title="B.2.3 Creation of Text Data for Molecular Description ‣ B.2 Details on the Creation of MolQA ‣ Appendix B Additional Benchmarking and Datasets Details ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Section</span>&nbsp;<span class="ltx_text ltx_ref_tag">B.2.3</span></a> to annotate labels for the eight studied properties, which can serve as input for pretraining the multi-conditional Graph DiT. Finally, we have approximately 300K graph-text pairs for small molecules and 300K graph-text pairs for polymers.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_appendix" id="A3">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Additional Pre-training and Fine-tuning Details</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A3.p1">
<p class="ltx_p" id="A3.p1.1">We pre-train three graph models including Graph DiT&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[Liu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib27" title="">2024c</a>]</cite> for multi-conditional molecular generation, a GIN-based GNN predictor for reaction template prediction, and a GIN-based graph encoder for molecule understanding&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[Xu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib44" title="">2018</a>]</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_subsection" id="A3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.1 </span>Pre-training of Graph Diffusion Transformers</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A3.SS1.p1">
<p class="ltx_p" id="A3.SS1.p1.6">Suppose the node has <math alttext="F_{V}" class="ltx_Math" display="inline" id="A3.SS1.p1.1.m1.1"><semantics id="A3.SS1.p1.1.m1.1a"><msub id="A3.SS1.p1.1.m1.1.1" xref="A3.SS1.p1.1.m1.1.1.cmml"><mi id="A3.SS1.p1.1.m1.1.1.2" xref="A3.SS1.p1.1.m1.1.1.2.cmml">F</mi><mi id="A3.SS1.p1.1.m1.1.1.3" xref="A3.SS1.p1.1.m1.1.1.3.cmml">V</mi></msub><annotation-xml encoding="MathML-Content" id="A3.SS1.p1.1.m1.1b"><apply id="A3.SS1.p1.1.m1.1.1.cmml" xref="A3.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A3.SS1.p1.1.m1.1.1.1.cmml" xref="A3.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="A3.SS1.p1.1.m1.1.1.2.cmml" xref="A3.SS1.p1.1.m1.1.1.2">𝐹</ci><ci id="A3.SS1.p1.1.m1.1.1.3.cmml" xref="A3.SS1.p1.1.m1.1.1.3">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p1.1.m1.1c">F_{V}</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.p1.1.m1.1d">italic_F start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT</annotation></semantics></math> categories and the edge has <math alttext="F_{E}" class="ltx_Math" display="inline" id="A3.SS1.p1.2.m2.1"><semantics id="A3.SS1.p1.2.m2.1a"><msub id="A3.SS1.p1.2.m2.1.1" xref="A3.SS1.p1.2.m2.1.1.cmml"><mi id="A3.SS1.p1.2.m2.1.1.2" xref="A3.SS1.p1.2.m2.1.1.2.cmml">F</mi><mi id="A3.SS1.p1.2.m2.1.1.3" xref="A3.SS1.p1.2.m2.1.1.3.cmml">E</mi></msub><annotation-xml encoding="MathML-Content" id="A3.SS1.p1.2.m2.1b"><apply id="A3.SS1.p1.2.m2.1.1.cmml" xref="A3.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A3.SS1.p1.2.m2.1.1.1.cmml" xref="A3.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="A3.SS1.p1.2.m2.1.1.2.cmml" xref="A3.SS1.p1.2.m2.1.1.2">𝐹</ci><ci id="A3.SS1.p1.2.m2.1.1.3.cmml" xref="A3.SS1.p1.2.m2.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p1.2.m2.1c">F_{E}</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.p1.2.m2.1d">italic_F start_POSTSUBSCRIPT italic_E end_POSTSUBSCRIPT</annotation></semantics></math> categories (including non-bond). Graph DiT models the node token by concatenating all its edge configurations to other nodes. For each node <math alttext="\mathbf{x}\in\mathbb{R}^{F}" class="ltx_Math" display="inline" id="A3.SS1.p1.3.m3.1"><semantics id="A3.SS1.p1.3.m3.1a"><mrow id="A3.SS1.p1.3.m3.1.1" xref="A3.SS1.p1.3.m3.1.1.cmml"><mi id="A3.SS1.p1.3.m3.1.1.2" xref="A3.SS1.p1.3.m3.1.1.2.cmml">𝐱</mi><mo id="A3.SS1.p1.3.m3.1.1.1" xref="A3.SS1.p1.3.m3.1.1.1.cmml">∈</mo><msup id="A3.SS1.p1.3.m3.1.1.3" xref="A3.SS1.p1.3.m3.1.1.3.cmml"><mi id="A3.SS1.p1.3.m3.1.1.3.2" xref="A3.SS1.p1.3.m3.1.1.3.2.cmml">ℝ</mi><mi id="A3.SS1.p1.3.m3.1.1.3.3" xref="A3.SS1.p1.3.m3.1.1.3.3.cmml">F</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.p1.3.m3.1b"><apply id="A3.SS1.p1.3.m3.1.1.cmml" xref="A3.SS1.p1.3.m3.1.1"><in id="A3.SS1.p1.3.m3.1.1.1.cmml" xref="A3.SS1.p1.3.m3.1.1.1"></in><ci id="A3.SS1.p1.3.m3.1.1.2.cmml" xref="A3.SS1.p1.3.m3.1.1.2">𝐱</ci><apply id="A3.SS1.p1.3.m3.1.1.3.cmml" xref="A3.SS1.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="A3.SS1.p1.3.m3.1.1.3.1.cmml" xref="A3.SS1.p1.3.m3.1.1.3">superscript</csymbol><ci id="A3.SS1.p1.3.m3.1.1.3.2.cmml" xref="A3.SS1.p1.3.m3.1.1.3.2">ℝ</ci><ci id="A3.SS1.p1.3.m3.1.1.3.3.cmml" xref="A3.SS1.p1.3.m3.1.1.3.3">𝐹</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p1.3.m3.1c">\mathbf{x}\in\mathbb{R}^{F}</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.p1.3.m3.1d">bold_x ∈ blackboard_R start_POSTSUPERSCRIPT italic_F end_POSTSUPERSCRIPT</annotation></semantics></math>, we have <math alttext="F=F_{V}+N_{G}\times F_{E}" class="ltx_Math" display="inline" id="A3.SS1.p1.4.m4.1"><semantics id="A3.SS1.p1.4.m4.1a"><mrow id="A3.SS1.p1.4.m4.1.1" xref="A3.SS1.p1.4.m4.1.1.cmml"><mi id="A3.SS1.p1.4.m4.1.1.2" xref="A3.SS1.p1.4.m4.1.1.2.cmml">F</mi><mo id="A3.SS1.p1.4.m4.1.1.1" xref="A3.SS1.p1.4.m4.1.1.1.cmml">=</mo><mrow id="A3.SS1.p1.4.m4.1.1.3" xref="A3.SS1.p1.4.m4.1.1.3.cmml"><msub id="A3.SS1.p1.4.m4.1.1.3.2" xref="A3.SS1.p1.4.m4.1.1.3.2.cmml"><mi id="A3.SS1.p1.4.m4.1.1.3.2.2" xref="A3.SS1.p1.4.m4.1.1.3.2.2.cmml">F</mi><mi id="A3.SS1.p1.4.m4.1.1.3.2.3" xref="A3.SS1.p1.4.m4.1.1.3.2.3.cmml">V</mi></msub><mo id="A3.SS1.p1.4.m4.1.1.3.1" xref="A3.SS1.p1.4.m4.1.1.3.1.cmml">+</mo><mrow id="A3.SS1.p1.4.m4.1.1.3.3" xref="A3.SS1.p1.4.m4.1.1.3.3.cmml"><msub id="A3.SS1.p1.4.m4.1.1.3.3.2" xref="A3.SS1.p1.4.m4.1.1.3.3.2.cmml"><mi id="A3.SS1.p1.4.m4.1.1.3.3.2.2" xref="A3.SS1.p1.4.m4.1.1.3.3.2.2.cmml">N</mi><mi id="A3.SS1.p1.4.m4.1.1.3.3.2.3" xref="A3.SS1.p1.4.m4.1.1.3.3.2.3.cmml">G</mi></msub><mo id="A3.SS1.p1.4.m4.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="A3.SS1.p1.4.m4.1.1.3.3.1.cmml">×</mo><msub id="A3.SS1.p1.4.m4.1.1.3.3.3" xref="A3.SS1.p1.4.m4.1.1.3.3.3.cmml"><mi id="A3.SS1.p1.4.m4.1.1.3.3.3.2" xref="A3.SS1.p1.4.m4.1.1.3.3.3.2.cmml">F</mi><mi id="A3.SS1.p1.4.m4.1.1.3.3.3.3" xref="A3.SS1.p1.4.m4.1.1.3.3.3.3.cmml">E</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.p1.4.m4.1b"><apply id="A3.SS1.p1.4.m4.1.1.cmml" xref="A3.SS1.p1.4.m4.1.1"><eq id="A3.SS1.p1.4.m4.1.1.1.cmml" xref="A3.SS1.p1.4.m4.1.1.1"></eq><ci id="A3.SS1.p1.4.m4.1.1.2.cmml" xref="A3.SS1.p1.4.m4.1.1.2">𝐹</ci><apply id="A3.SS1.p1.4.m4.1.1.3.cmml" xref="A3.SS1.p1.4.m4.1.1.3"><plus id="A3.SS1.p1.4.m4.1.1.3.1.cmml" xref="A3.SS1.p1.4.m4.1.1.3.1"></plus><apply id="A3.SS1.p1.4.m4.1.1.3.2.cmml" xref="A3.SS1.p1.4.m4.1.1.3.2"><csymbol cd="ambiguous" id="A3.SS1.p1.4.m4.1.1.3.2.1.cmml" xref="A3.SS1.p1.4.m4.1.1.3.2">subscript</csymbol><ci id="A3.SS1.p1.4.m4.1.1.3.2.2.cmml" xref="A3.SS1.p1.4.m4.1.1.3.2.2">𝐹</ci><ci id="A3.SS1.p1.4.m4.1.1.3.2.3.cmml" xref="A3.SS1.p1.4.m4.1.1.3.2.3">𝑉</ci></apply><apply id="A3.SS1.p1.4.m4.1.1.3.3.cmml" xref="A3.SS1.p1.4.m4.1.1.3.3"><times id="A3.SS1.p1.4.m4.1.1.3.3.1.cmml" xref="A3.SS1.p1.4.m4.1.1.3.3.1"></times><apply id="A3.SS1.p1.4.m4.1.1.3.3.2.cmml" xref="A3.SS1.p1.4.m4.1.1.3.3.2"><csymbol cd="ambiguous" id="A3.SS1.p1.4.m4.1.1.3.3.2.1.cmml" xref="A3.SS1.p1.4.m4.1.1.3.3.2">subscript</csymbol><ci id="A3.SS1.p1.4.m4.1.1.3.3.2.2.cmml" xref="A3.SS1.p1.4.m4.1.1.3.3.2.2">𝑁</ci><ci id="A3.SS1.p1.4.m4.1.1.3.3.2.3.cmml" xref="A3.SS1.p1.4.m4.1.1.3.3.2.3">𝐺</ci></apply><apply id="A3.SS1.p1.4.m4.1.1.3.3.3.cmml" xref="A3.SS1.p1.4.m4.1.1.3.3.3"><csymbol cd="ambiguous" id="A3.SS1.p1.4.m4.1.1.3.3.3.1.cmml" xref="A3.SS1.p1.4.m4.1.1.3.3.3">subscript</csymbol><ci id="A3.SS1.p1.4.m4.1.1.3.3.3.2.cmml" xref="A3.SS1.p1.4.m4.1.1.3.3.3.2">𝐹</ci><ci id="A3.SS1.p1.4.m4.1.1.3.3.3.3.cmml" xref="A3.SS1.p1.4.m4.1.1.3.3.3.3">𝐸</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p1.4.m4.1c">F=F_{V}+N_{G}\times F_{E}</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.p1.4.m4.1d">italic_F = italic_F start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT + italic_N start_POSTSUBSCRIPT italic_G end_POSTSUBSCRIPT × italic_F start_POSTSUBSCRIPT italic_E end_POSTSUBSCRIPT</annotation></semantics></math>, where <math alttext="N_{G}" class="ltx_Math" display="inline" id="A3.SS1.p1.5.m5.1"><semantics id="A3.SS1.p1.5.m5.1a"><msub id="A3.SS1.p1.5.m5.1.1" xref="A3.SS1.p1.5.m5.1.1.cmml"><mi id="A3.SS1.p1.5.m5.1.1.2" xref="A3.SS1.p1.5.m5.1.1.2.cmml">N</mi><mi id="A3.SS1.p1.5.m5.1.1.3" xref="A3.SS1.p1.5.m5.1.1.3.cmml">G</mi></msub><annotation-xml encoding="MathML-Content" id="A3.SS1.p1.5.m5.1b"><apply id="A3.SS1.p1.5.m5.1.1.cmml" xref="A3.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="A3.SS1.p1.5.m5.1.1.1.cmml" xref="A3.SS1.p1.5.m5.1.1">subscript</csymbol><ci id="A3.SS1.p1.5.m5.1.1.2.cmml" xref="A3.SS1.p1.5.m5.1.1.2">𝑁</ci><ci id="A3.SS1.p1.5.m5.1.1.3.cmml" xref="A3.SS1.p1.5.m5.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p1.5.m5.1c">N_{G}</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.p1.5.m5.1d">italic_N start_POSTSUBSCRIPT italic_G end_POSTSUBSCRIPT</annotation></semantics></math> denotes the graph size. This facilitates defining the transition matrix <math alttext="\mathbf{Q}" class="ltx_Math" display="inline" id="A3.SS1.p1.6.m6.1"><semantics id="A3.SS1.p1.6.m6.1a"><mi id="A3.SS1.p1.6.m6.1.1" xref="A3.SS1.p1.6.m6.1.1.cmml">𝐐</mi><annotation-xml encoding="MathML-Content" id="A3.SS1.p1.6.m6.1b"><ci id="A3.SS1.p1.6.m6.1.1.cmml" xref="A3.SS1.p1.6.m6.1.1">𝐐</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p1.6.m6.1c">\mathbf{Q}</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.p1.6.m6.1d">bold_Q</annotation></semantics></math> for the joint distribution of nodes and edges&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[Liu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib27" title="">2024c</a>]</cite>. Graph DiT uses Transformer layers, replacing layer normalization with adaptive layer normalization (AdaLN):</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="A3.Ex2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\operatorname{AdaLN}\left(\mathbf{h},\mathbf{c}\right)=\gamma_{\theta}(\mathbf%
{c})\odot\frac{\mathbf{h}-\mu\left(\mathbf{h}\right)}{\sigma\left(\mathbf{h}%
\right)}+\beta_{\theta}(\mathbf{c})," class="ltx_Math" display="block" id="A3.Ex2.m1.8"><semantics id="A3.Ex2.m1.8a"><mrow id="A3.Ex2.m1.8.8.1" xref="A3.Ex2.m1.8.8.1.1.cmml"><mrow id="A3.Ex2.m1.8.8.1.1" xref="A3.Ex2.m1.8.8.1.1.cmml"><mrow id="A3.Ex2.m1.8.8.1.1.2.2" xref="A3.Ex2.m1.8.8.1.1.2.1.cmml"><mi id="A3.Ex2.m1.3.3" xref="A3.Ex2.m1.3.3.cmml">AdaLN</mi><mo id="A3.Ex2.m1.8.8.1.1.2.2a" xref="A3.Ex2.m1.8.8.1.1.2.1.cmml">⁡</mo><mrow id="A3.Ex2.m1.8.8.1.1.2.2.1" xref="A3.Ex2.m1.8.8.1.1.2.1.cmml"><mo id="A3.Ex2.m1.8.8.1.1.2.2.1.1" xref="A3.Ex2.m1.8.8.1.1.2.1.cmml">(</mo><mi id="A3.Ex2.m1.4.4" xref="A3.Ex2.m1.4.4.cmml">𝐡</mi><mo id="A3.Ex2.m1.8.8.1.1.2.2.1.2" xref="A3.Ex2.m1.8.8.1.1.2.1.cmml">,</mo><mi id="A3.Ex2.m1.5.5" xref="A3.Ex2.m1.5.5.cmml">𝐜</mi><mo id="A3.Ex2.m1.8.8.1.1.2.2.1.3" xref="A3.Ex2.m1.8.8.1.1.2.1.cmml">)</mo></mrow></mrow><mo id="A3.Ex2.m1.8.8.1.1.1" xref="A3.Ex2.m1.8.8.1.1.1.cmml">=</mo><mrow id="A3.Ex2.m1.8.8.1.1.3" xref="A3.Ex2.m1.8.8.1.1.3.cmml"><mrow id="A3.Ex2.m1.8.8.1.1.3.2" xref="A3.Ex2.m1.8.8.1.1.3.2.cmml"><mrow id="A3.Ex2.m1.8.8.1.1.3.2.2" xref="A3.Ex2.m1.8.8.1.1.3.2.2.cmml"><msub id="A3.Ex2.m1.8.8.1.1.3.2.2.2" xref="A3.Ex2.m1.8.8.1.1.3.2.2.2.cmml"><mi id="A3.Ex2.m1.8.8.1.1.3.2.2.2.2" xref="A3.Ex2.m1.8.8.1.1.3.2.2.2.2.cmml">γ</mi><mi id="A3.Ex2.m1.8.8.1.1.3.2.2.2.3" xref="A3.Ex2.m1.8.8.1.1.3.2.2.2.3.cmml">θ</mi></msub><mo id="A3.Ex2.m1.8.8.1.1.3.2.2.1" xref="A3.Ex2.m1.8.8.1.1.3.2.2.1.cmml">⁢</mo><mrow id="A3.Ex2.m1.8.8.1.1.3.2.2.3.2" xref="A3.Ex2.m1.8.8.1.1.3.2.2.cmml"><mo id="A3.Ex2.m1.8.8.1.1.3.2.2.3.2.1" stretchy="false" xref="A3.Ex2.m1.8.8.1.1.3.2.2.cmml">(</mo><mi id="A3.Ex2.m1.6.6" xref="A3.Ex2.m1.6.6.cmml">𝐜</mi><mo id="A3.Ex2.m1.8.8.1.1.3.2.2.3.2.2" rspace="0.055em" stretchy="false" xref="A3.Ex2.m1.8.8.1.1.3.2.2.cmml">)</mo></mrow></mrow><mo id="A3.Ex2.m1.8.8.1.1.3.2.1" rspace="0.222em" xref="A3.Ex2.m1.8.8.1.1.3.2.1.cmml">⊙</mo><mfrac id="A3.Ex2.m1.2.2" xref="A3.Ex2.m1.2.2.cmml"><mrow id="A3.Ex2.m1.1.1.1" xref="A3.Ex2.m1.1.1.1.cmml"><mi id="A3.Ex2.m1.1.1.1.3" xref="A3.Ex2.m1.1.1.1.3.cmml">𝐡</mi><mo id="A3.Ex2.m1.1.1.1.2" xref="A3.Ex2.m1.1.1.1.2.cmml">−</mo><mrow id="A3.Ex2.m1.1.1.1.4" xref="A3.Ex2.m1.1.1.1.4.cmml"><mi id="A3.Ex2.m1.1.1.1.4.2" xref="A3.Ex2.m1.1.1.1.4.2.cmml">μ</mi><mo id="A3.Ex2.m1.1.1.1.4.1" xref="A3.Ex2.m1.1.1.1.4.1.cmml">⁢</mo><mrow id="A3.Ex2.m1.1.1.1.4.3.2" xref="A3.Ex2.m1.1.1.1.4.cmml"><mo id="A3.Ex2.m1.1.1.1.4.3.2.1" xref="A3.Ex2.m1.1.1.1.4.cmml">(</mo><mi id="A3.Ex2.m1.1.1.1.1" xref="A3.Ex2.m1.1.1.1.1.cmml">𝐡</mi><mo id="A3.Ex2.m1.1.1.1.4.3.2.2" xref="A3.Ex2.m1.1.1.1.4.cmml">)</mo></mrow></mrow></mrow><mrow id="A3.Ex2.m1.2.2.2" xref="A3.Ex2.m1.2.2.2.cmml"><mi id="A3.Ex2.m1.2.2.2.3" xref="A3.Ex2.m1.2.2.2.3.cmml">σ</mi><mo id="A3.Ex2.m1.2.2.2.2" xref="A3.Ex2.m1.2.2.2.2.cmml">⁢</mo><mrow id="A3.Ex2.m1.2.2.2.4.2" xref="A3.Ex2.m1.2.2.2.cmml"><mo id="A3.Ex2.m1.2.2.2.4.2.1" xref="A3.Ex2.m1.2.2.2.cmml">(</mo><mi id="A3.Ex2.m1.2.2.2.1" xref="A3.Ex2.m1.2.2.2.1.cmml">𝐡</mi><mo id="A3.Ex2.m1.2.2.2.4.2.2" xref="A3.Ex2.m1.2.2.2.cmml">)</mo></mrow></mrow></mfrac></mrow><mo id="A3.Ex2.m1.8.8.1.1.3.1" xref="A3.Ex2.m1.8.8.1.1.3.1.cmml">+</mo><mrow id="A3.Ex2.m1.8.8.1.1.3.3" xref="A3.Ex2.m1.8.8.1.1.3.3.cmml"><msub id="A3.Ex2.m1.8.8.1.1.3.3.2" xref="A3.Ex2.m1.8.8.1.1.3.3.2.cmml"><mi id="A3.Ex2.m1.8.8.1.1.3.3.2.2" xref="A3.Ex2.m1.8.8.1.1.3.3.2.2.cmml">β</mi><mi id="A3.Ex2.m1.8.8.1.1.3.3.2.3" xref="A3.Ex2.m1.8.8.1.1.3.3.2.3.cmml">θ</mi></msub><mo id="A3.Ex2.m1.8.8.1.1.3.3.1" xref="A3.Ex2.m1.8.8.1.1.3.3.1.cmml">⁢</mo><mrow id="A3.Ex2.m1.8.8.1.1.3.3.3.2" xref="A3.Ex2.m1.8.8.1.1.3.3.cmml"><mo id="A3.Ex2.m1.8.8.1.1.3.3.3.2.1" stretchy="false" xref="A3.Ex2.m1.8.8.1.1.3.3.cmml">(</mo><mi id="A3.Ex2.m1.7.7" xref="A3.Ex2.m1.7.7.cmml">𝐜</mi><mo id="A3.Ex2.m1.8.8.1.1.3.3.3.2.2" stretchy="false" xref="A3.Ex2.m1.8.8.1.1.3.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A3.Ex2.m1.8.8.1.2" xref="A3.Ex2.m1.8.8.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.Ex2.m1.8b"><apply id="A3.Ex2.m1.8.8.1.1.cmml" xref="A3.Ex2.m1.8.8.1"><eq id="A3.Ex2.m1.8.8.1.1.1.cmml" xref="A3.Ex2.m1.8.8.1.1.1"></eq><apply id="A3.Ex2.m1.8.8.1.1.2.1.cmml" xref="A3.Ex2.m1.8.8.1.1.2.2"><ci id="A3.Ex2.m1.3.3.cmml" xref="A3.Ex2.m1.3.3">AdaLN</ci><ci id="A3.Ex2.m1.4.4.cmml" xref="A3.Ex2.m1.4.4">𝐡</ci><ci id="A3.Ex2.m1.5.5.cmml" xref="A3.Ex2.m1.5.5">𝐜</ci></apply><apply id="A3.Ex2.m1.8.8.1.1.3.cmml" xref="A3.Ex2.m1.8.8.1.1.3"><plus id="A3.Ex2.m1.8.8.1.1.3.1.cmml" xref="A3.Ex2.m1.8.8.1.1.3.1"></plus><apply id="A3.Ex2.m1.8.8.1.1.3.2.cmml" xref="A3.Ex2.m1.8.8.1.1.3.2"><csymbol cd="latexml" id="A3.Ex2.m1.8.8.1.1.3.2.1.cmml" xref="A3.Ex2.m1.8.8.1.1.3.2.1">direct-product</csymbol><apply id="A3.Ex2.m1.8.8.1.1.3.2.2.cmml" xref="A3.Ex2.m1.8.8.1.1.3.2.2"><times id="A3.Ex2.m1.8.8.1.1.3.2.2.1.cmml" xref="A3.Ex2.m1.8.8.1.1.3.2.2.1"></times><apply id="A3.Ex2.m1.8.8.1.1.3.2.2.2.cmml" xref="A3.Ex2.m1.8.8.1.1.3.2.2.2"><csymbol cd="ambiguous" id="A3.Ex2.m1.8.8.1.1.3.2.2.2.1.cmml" xref="A3.Ex2.m1.8.8.1.1.3.2.2.2">subscript</csymbol><ci id="A3.Ex2.m1.8.8.1.1.3.2.2.2.2.cmml" xref="A3.Ex2.m1.8.8.1.1.3.2.2.2.2">𝛾</ci><ci id="A3.Ex2.m1.8.8.1.1.3.2.2.2.3.cmml" xref="A3.Ex2.m1.8.8.1.1.3.2.2.2.3">𝜃</ci></apply><ci id="A3.Ex2.m1.6.6.cmml" xref="A3.Ex2.m1.6.6">𝐜</ci></apply><apply id="A3.Ex2.m1.2.2.cmml" xref="A3.Ex2.m1.2.2"><divide id="A3.Ex2.m1.2.2.3.cmml" xref="A3.Ex2.m1.2.2"></divide><apply id="A3.Ex2.m1.1.1.1.cmml" xref="A3.Ex2.m1.1.1.1"><minus id="A3.Ex2.m1.1.1.1.2.cmml" xref="A3.Ex2.m1.1.1.1.2"></minus><ci id="A3.Ex2.m1.1.1.1.3.cmml" xref="A3.Ex2.m1.1.1.1.3">𝐡</ci><apply id="A3.Ex2.m1.1.1.1.4.cmml" xref="A3.Ex2.m1.1.1.1.4"><times id="A3.Ex2.m1.1.1.1.4.1.cmml" xref="A3.Ex2.m1.1.1.1.4.1"></times><ci id="A3.Ex2.m1.1.1.1.4.2.cmml" xref="A3.Ex2.m1.1.1.1.4.2">𝜇</ci><ci id="A3.Ex2.m1.1.1.1.1.cmml" xref="A3.Ex2.m1.1.1.1.1">𝐡</ci></apply></apply><apply id="A3.Ex2.m1.2.2.2.cmml" xref="A3.Ex2.m1.2.2.2"><times id="A3.Ex2.m1.2.2.2.2.cmml" xref="A3.Ex2.m1.2.2.2.2"></times><ci id="A3.Ex2.m1.2.2.2.3.cmml" xref="A3.Ex2.m1.2.2.2.3">𝜎</ci><ci id="A3.Ex2.m1.2.2.2.1.cmml" xref="A3.Ex2.m1.2.2.2.1">𝐡</ci></apply></apply></apply><apply id="A3.Ex2.m1.8.8.1.1.3.3.cmml" xref="A3.Ex2.m1.8.8.1.1.3.3"><times id="A3.Ex2.m1.8.8.1.1.3.3.1.cmml" xref="A3.Ex2.m1.8.8.1.1.3.3.1"></times><apply id="A3.Ex2.m1.8.8.1.1.3.3.2.cmml" xref="A3.Ex2.m1.8.8.1.1.3.3.2"><csymbol cd="ambiguous" id="A3.Ex2.m1.8.8.1.1.3.3.2.1.cmml" xref="A3.Ex2.m1.8.8.1.1.3.3.2">subscript</csymbol><ci id="A3.Ex2.m1.8.8.1.1.3.3.2.2.cmml" xref="A3.Ex2.m1.8.8.1.1.3.3.2.2">𝛽</ci><ci id="A3.Ex2.m1.8.8.1.1.3.3.2.3.cmml" xref="A3.Ex2.m1.8.8.1.1.3.3.2.3">𝜃</ci></apply><ci id="A3.Ex2.m1.7.7.cmml" xref="A3.Ex2.m1.7.7">𝐜</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.Ex2.m1.8c">\operatorname{AdaLN}\left(\mathbf{h},\mathbf{c}\right)=\gamma_{\theta}(\mathbf%
{c})\odot\frac{\mathbf{h}-\mu\left(\mathbf{h}\right)}{\sigma\left(\mathbf{h}%
\right)}+\beta_{\theta}(\mathbf{c}),</annotation><annotation encoding="application/x-llamapun" id="A3.Ex2.m1.8d">roman_AdaLN ( bold_h , bold_c ) = italic_γ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_c ) ⊙ divide start_ARG bold_h - italic_μ ( bold_h ) end_ARG start_ARG italic_σ ( bold_h ) end_ARG + italic_β start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_c ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A3.SS1.p1.9">where <math alttext="\mathbf{h}" class="ltx_Math" display="inline" id="A3.SS1.p1.7.m1.1"><semantics id="A3.SS1.p1.7.m1.1a"><mi id="A3.SS1.p1.7.m1.1.1" xref="A3.SS1.p1.7.m1.1.1.cmml">𝐡</mi><annotation-xml encoding="MathML-Content" id="A3.SS1.p1.7.m1.1b"><ci id="A3.SS1.p1.7.m1.1.1.cmml" xref="A3.SS1.p1.7.m1.1.1">𝐡</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p1.7.m1.1c">\mathbf{h}</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.p1.7.m1.1d">bold_h</annotation></semantics></math> denotes the hidden state of <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="A3.SS1.p1.8.m2.1"><semantics id="A3.SS1.p1.8.m2.1a"><mi id="A3.SS1.p1.8.m2.1.1" xref="A3.SS1.p1.8.m2.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="A3.SS1.p1.8.m2.1b"><ci id="A3.SS1.p1.8.m2.1.1.cmml" xref="A3.SS1.p1.8.m2.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p1.8.m2.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.p1.8.m2.1d">bold_x</annotation></semantics></math> and <math alttext="\mathbf{c}" class="ltx_Math" display="inline" id="A3.SS1.p1.9.m3.1"><semantics id="A3.SS1.p1.9.m3.1a"><mi id="A3.SS1.p1.9.m3.1.1" xref="A3.SS1.p1.9.m3.1.1.cmml">𝐜</mi><annotation-xml encoding="MathML-Content" id="A3.SS1.p1.9.m3.1b"><ci id="A3.SS1.p1.9.m3.1.1.cmml" xref="A3.SS1.p1.9.m3.1.1">𝐜</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p1.9.m3.1c">\mathbf{c}</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.p1.9.m3.1d">bold_c</annotation></semantics></math> is the vector representing the input conditions.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A3.SS1.p2">
<p class="ltx_p" id="A3.SS1.p2.3">Given multiple conditions with categorical, continuous properties, and text, Graph DiT uses one-hot encoding for categorical properties and a clustering-based approach with <math alttext="\operatorname{Linear}\left(\operatorname{Softmax}\left(\operatorname{Linear}(c%
)\right)\right)" class="ltx_Math" display="inline" id="A3.SS1.p2.1.m1.5"><semantics id="A3.SS1.p2.1.m1.5a"><mrow id="A3.SS1.p2.1.m1.5.5.1" xref="A3.SS1.p2.1.m1.5.5.2.cmml"><mi id="A3.SS1.p2.1.m1.4.4" xref="A3.SS1.p2.1.m1.4.4.cmml">Linear</mi><mo id="A3.SS1.p2.1.m1.5.5.1a" xref="A3.SS1.p2.1.m1.5.5.2.cmml">⁡</mo><mrow id="A3.SS1.p2.1.m1.5.5.1.1" xref="A3.SS1.p2.1.m1.5.5.2.cmml"><mo id="A3.SS1.p2.1.m1.5.5.1.1.2" xref="A3.SS1.p2.1.m1.5.5.2.cmml">(</mo><mrow id="A3.SS1.p2.1.m1.5.5.1.1.1.1" xref="A3.SS1.p2.1.m1.5.5.1.1.1.2.cmml"><mi id="A3.SS1.p2.1.m1.3.3" xref="A3.SS1.p2.1.m1.3.3.cmml">Softmax</mi><mo id="A3.SS1.p2.1.m1.5.5.1.1.1.1a" xref="A3.SS1.p2.1.m1.5.5.1.1.1.2.cmml">⁡</mo><mrow id="A3.SS1.p2.1.m1.5.5.1.1.1.1.1" xref="A3.SS1.p2.1.m1.5.5.1.1.1.2.cmml"><mo id="A3.SS1.p2.1.m1.5.5.1.1.1.1.1.2" xref="A3.SS1.p2.1.m1.5.5.1.1.1.2.cmml">(</mo><mrow id="A3.SS1.p2.1.m1.5.5.1.1.1.1.1.1.2" xref="A3.SS1.p2.1.m1.5.5.1.1.1.1.1.1.1.cmml"><mi id="A3.SS1.p2.1.m1.1.1" xref="A3.SS1.p2.1.m1.1.1.cmml">Linear</mi><mo id="A3.SS1.p2.1.m1.5.5.1.1.1.1.1.1.2a" xref="A3.SS1.p2.1.m1.5.5.1.1.1.1.1.1.1.cmml">⁡</mo><mrow id="A3.SS1.p2.1.m1.5.5.1.1.1.1.1.1.2.1" xref="A3.SS1.p2.1.m1.5.5.1.1.1.1.1.1.1.cmml"><mo id="A3.SS1.p2.1.m1.5.5.1.1.1.1.1.1.2.1.1" stretchy="false" xref="A3.SS1.p2.1.m1.5.5.1.1.1.1.1.1.1.cmml">(</mo><mi id="A3.SS1.p2.1.m1.2.2" xref="A3.SS1.p2.1.m1.2.2.cmml">c</mi><mo id="A3.SS1.p2.1.m1.5.5.1.1.1.1.1.1.2.1.2" stretchy="false" xref="A3.SS1.p2.1.m1.5.5.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A3.SS1.p2.1.m1.5.5.1.1.1.1.1.3" xref="A3.SS1.p2.1.m1.5.5.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A3.SS1.p2.1.m1.5.5.1.1.3" xref="A3.SS1.p2.1.m1.5.5.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.p2.1.m1.5b"><apply id="A3.SS1.p2.1.m1.5.5.2.cmml" xref="A3.SS1.p2.1.m1.5.5.1"><ci id="A3.SS1.p2.1.m1.4.4.cmml" xref="A3.SS1.p2.1.m1.4.4">Linear</ci><apply id="A3.SS1.p2.1.m1.5.5.1.1.1.2.cmml" xref="A3.SS1.p2.1.m1.5.5.1.1.1.1"><ci id="A3.SS1.p2.1.m1.3.3.cmml" xref="A3.SS1.p2.1.m1.3.3">Softmax</ci><apply id="A3.SS1.p2.1.m1.5.5.1.1.1.1.1.1.1.cmml" xref="A3.SS1.p2.1.m1.5.5.1.1.1.1.1.1.2"><ci id="A3.SS1.p2.1.m1.1.1.cmml" xref="A3.SS1.p2.1.m1.1.1">Linear</ci><ci id="A3.SS1.p2.1.m1.2.2.cmml" xref="A3.SS1.p2.1.m1.2.2">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p2.1.m1.5c">\operatorname{Linear}\left(\operatorname{Softmax}\left(\operatorname{Linear}(c%
)\right)\right)</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.p2.1.m1.5d">roman_Linear ( roman_Softmax ( roman_Linear ( italic_c ) ) )</annotation></semantics></math> to embed continuous condition values <math alttext="c" class="ltx_Math" display="inline" id="A3.SS1.p2.2.m2.1"><semantics id="A3.SS1.p2.2.m2.1a"><mi id="A3.SS1.p2.2.m2.1.1" xref="A3.SS1.p2.2.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="A3.SS1.p2.2.m2.1b"><ci id="A3.SS1.p2.2.m2.1.1.cmml" xref="A3.SS1.p2.2.m2.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p2.2.m2.1c">c</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.p2.2.m2.1d">italic_c</annotation></semantics></math>. We employ pre-trained SciBERT&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[Beltagy et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib4" title="">2019</a>]</cite> to embed input texts into a 768-dimensional vector by averaging the representations of all text tokens in the sentence, then using a linear layer to adjust the dimension for Graph DiT. For each condition, the model also learns a drop embedding. The drop embedding is used when no values are provided.
Finally, the model sums the representation vectors of different conditions as input for <math alttext="\mathbf{c}" class="ltx_Math" display="inline" id="A3.SS1.p2.3.m3.1"><semantics id="A3.SS1.p2.3.m3.1a"><mi id="A3.SS1.p2.3.m3.1.1" xref="A3.SS1.p2.3.m3.1.1.cmml">𝐜</mi><annotation-xml encoding="MathML-Content" id="A3.SS1.p2.3.m3.1b"><ci id="A3.SS1.p2.3.m3.1.1.cmml" xref="A3.SS1.p2.3.m3.1.1">𝐜</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p2.3.m3.1c">\mathbf{c}</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.p2.3.m3.1d">bold_c</annotation></semantics></math>. In the reverse diffusion process, the denoising model uses predictor-free guidance to sample molecular graphs given multiple conditions.
We pre-train the denoising model with the loss function in&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S2.E2" title="In 2.2 Molecular Design with Graph Diffusion Models ‣ 2 Preliminaries ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Eq.</span>&nbsp;<span class="ltx_text ltx_ref_tag">2</span></a> using 600K graph-text pairwise data and the eight properties defined in&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A2.SS3" title="B.3 Details on the Creation of MolPair ‣ Appendix B Additional Benchmarking and Datasets Details ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Section</span>&nbsp;<span class="ltx_text ltx_ref_tag">B.3</span></a>. The model employs the following hyperparameters: depth of 28, hidden size of 1024, 16 heads, and MLP hidden size of 4096. The total model size is around 574 million parameters. We pre-train the model for 45 epochs, which takes approximately one week on a single A100 card.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="A3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.2 </span>Pre-training of GNNs</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A3.SS2.p1">
<p class="ltx_p" id="A3.SS2.p1.1">We pre-train a three-layer GIN to predict reaction templates among 30,124 labels, using a hidden size of 512. Reaction template prediction is a multi-class classification task.
Given reaction-text pairs from MolPair, we extract the product molecular graph from the reaction formula, using the reaction condition text as input. SciBERT&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[Beltagy et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib4" title="">2019</a>]</cite> is used as the text encoder with frozen parameters. We average the text representations to obtain a sentence-level representation.
The prediction target is the reaction template extracted from the reaction&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[Coley et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib8" title="">2019</a>]</cite>. GIN naturally uses molecular graphs, employing the AdaLN approach as the normalization layer added after each message-passing layer to incorporate text conditions. We pre-train the model for 5 epochs on a single V100 card, with 632 million parameters. This model serves as the reaction predictor to suggest reaction templates for Llamole.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A3.SS2.p2">
<p class="ltx_p" id="A3.SS2.p2.1">For molecular understanding, we pre-train a five-layer GIN model with a hidden size of 768. SciBERT&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[Beltagy et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib4" title="">2019</a>]</cite> is used as the text encoder with frozen parameters. We average the text representations to obtain a sentence-level representation, while the GIN model uses sum pooling to produce the graph representation. For each graph-text pair from MolPair, we optimize the graph encoder using the CLIP loss&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[Radford et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib33" title="">2021</a>]</cite> for 40 epochs. The CLIP loss consists of two contrastive losses: it first computes the similarity score between graph-text pairs, then contrasts it with all other similarity scores by pairing the graph with other texts and pairing the text with other graphs as negative pairs. The model has around 43 million parameters. The model can be pre-trained on a single V100 card in a few days. This graph encoder will replace the word encoder in the LLM tokenizer module for molecules indicated by the token <span class="ltx_text ltx_font_typewriter" id="A3.SS2.p2.1.1">&lt;molecule&gt;</span> as shown in&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A1" title="Appendix A Additional Details for Llamole ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">appendix</span>&nbsp;<span class="ltx_text ltx_ref_tag">A</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="A3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.3 </span>Fine-tuning of Llamole</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A3.SS3.p1">
<p class="ltx_p" id="A3.SS3.p1.1">Llamole is fine-tuned on graph-text multimodal instruction data, freezing the parameters of the Graph DiT, GNN predictor, and graph encoder. It automatically adds eight query tokens to the sequence once the trigger tokens are predicted, allowing the base LLM to continue autoregression and output vectors for all eight query tokens. We average these output vectors as queries for prior generated texts and use them as input text vectors for the subsequent Graph DiT or GNN predictor module via a tunable linear layer. For the <span class="ltx_text ltx_font_typewriter" id="A3.SS3.p1.1.1">&lt;molecule&gt;</span> token, we add a tunable linear layer on top of the token embedding after the graph encoder outputs it. Without loss of generality, we study three variants of Llamole with different base LLMs: Llama-3.1-8B&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[Dubey et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib10" title="">2024</a>]</cite>, Mistral-7B&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[Jiang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib18" title="">2023</a>]</cite>, and Qwen2-7B&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[Yang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib45" title="">2024</a>]</cite>. All LLMs are fine-tuned using LoRA&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[Hu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib16" title="">2021</a>]</cite> for four epochs, taking approximately two days on a single A100 card.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_appendix" id="A4">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Additional Experimental Details and Discussions</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsection" id="A4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.1 </span>Additional Details on Experimental Set-ups</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A4.SS1.p1">
<p class="ltx_p" id="A4.SS1.p1.1">In <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S5.T1" title="In 5 Experiment ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Tables</span>&nbsp;<span class="ltx_text ltx_ref_tag">1</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S5.T2" title="Table 2 ‣ 5.1 RQ1: LLMs for Controllable and Synthesizable Molecular Design ‣ 5 Experiment ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">2</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">1</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S5.F5.sf1" title="Figure 5(a) ‣ Figure 5 ‣ 5 Experiment ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">5(a)</span></a> and&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S5.F5.sf2" title="Figure 5(b) ‣ Figure 5 ‣ 5 Experiment ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">5(b)</span></a>, Llamole is compared with fourteen LLMs with sizes ranging from 7B to 70B, including Llama&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[Dubey et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib10" title="">2024</a>]</cite>, Mistral&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[Jiang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib18" title="">2023</a>]</cite>, Qwen&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[Yang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib45" title="">2024</a>]</cite>, Granite&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[Abdelaziz et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib1" title="">2024</a>]</cite>, and Flan-T5&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[Chung et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib6" title="">2024</a>]</cite>. We prefer the instruct version of the model when available.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A4.SS1.p2">
<p class="ltx_p" id="A4.SS1.p2.1">Using the MolQA training set, previous work can implement these LLMs in two ways: in-context learning (ICL) and text-only supervised fine-tuning (SFT). For ICL, we retrieve five closest QA pairs from the training set based on the average property difference from desired properties. The template used to construct the prompt with demonstrations is:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_listing ltx_lstlisting ltx_listing" id="A4.SS1.p2.2">
<div class="ltx_listing_data"><a download="" href="data:text/plain;base64,SSdtIHdvcmtpbmcgb24gZGVzaWduaW5nIGFuZCBzeW50aGVzaXppbmcgbW9sZWN1bGVzLiBIZXJlIGFyZSBzb21lIGV4YW1wbGUgcXVlc3Rpb25zIGFuZCBhbnN3ZXJzIGFib3V0IG1vbGVjdWxhciByZXF1aXJlbWVudHMsIGRlc2lnbiwgYW5kIHN5bnRoZXNpczoge3tleGFtcGxlc319Ck5vdywgYmFzZWQgb24gdGhlc2UgZXhhbXBsZXMsIHBsZWFzZSBhbnN3ZXIgdGhlIGZvbGxvd2luZyBxdWVzdGlvbiBhYm91dCBtb2xlY3VsYXIgZGVzaWduIGFuZCBzeW50aGVzaXM6IHt7cXVlc3Rpb259fQ==">⬇</a></div>
<div class="ltx_listingline" id="lstnumberx44">
<span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx44.1" style="color:#0000FF;">I</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx44.2" style="color:#0000FF;">’</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx44.3" style="color:#0000FF;">m</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx44.4" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx44.5" style="color:#0000FF;">working</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx44.6" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx44.7" style="color:#0000FF;">on</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx44.8" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx44.9" style="color:#0000FF;">designing</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx44.10" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx44.11" style="color:#0000FF;">and</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx44.12" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx44.13" style="color:#0000FF;">synthesizing</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx44.14" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx44.15" style="color:#0000FF;">molecules</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx44.16" style="color:#0000FF;">.</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx44.17" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx44.18" style="color:#0000FF;">Here</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx44.19" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx44.20" style="color:#0000FF;">are</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx44.21" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx44.22" style="color:#0000FF;">some</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx44.23" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx44.24" style="color:#0000FF;">example</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx44.25" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx44.26" style="color:#0000FF;">questions</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx44.27" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx44.28" style="color:#0000FF;">and</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx44.29" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx44.30" style="color:#0000FF;">answers</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx44.31" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx44.32" style="color:#0000FF;">about</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx44.33" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx44.34" style="color:#0000FF;">molecular</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx44.35" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx44.36" style="color:#0000FF;">requirements</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx44.37" style="color:#0000FF;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx44.38" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx44.39" style="color:#0000FF;">design</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx44.40" style="color:#0000FF;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx44.41" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx44.42" style="color:#0000FF;">and</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx44.43" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx44.44" style="color:#0000FF;">synthesis</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx44.45" style="color:#0000FF;">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx44.46" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx44.47" style="color:#0000FF;">{{</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx44.48" style="color:#0000FF;">examples</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx44.49" style="color:#0000FF;">}}</span>
</div>
<div class="ltx_listingline" id="lstnumberx45">
<span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx45.1" style="color:#0000FF;">Now</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx45.2" style="color:#0000FF;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx45.3" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx45.4" style="color:#0000FF;">based</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx45.5" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx45.6" style="color:#0000FF;">on</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx45.7" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx45.8" style="color:#0000FF;">these</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx45.9" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx45.10" style="color:#0000FF;">examples</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx45.11" style="color:#0000FF;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx45.12" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx45.13" style="color:#0000FF;">please</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx45.14" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx45.15" style="color:#0000FF;">answer</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx45.16" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx45.17" style="color:#0000FF;">the</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx45.18" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx45.19" style="color:#0000FF;">following</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx45.20" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx45.21" style="color:#0000FF;">question</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx45.22" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx45.23" style="color:#0000FF;">about</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx45.24" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx45.25" style="color:#0000FF;">molecular</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx45.26" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx45.27" style="color:#0000FF;">design</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx45.28" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx45.29" style="color:#0000FF;">and</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx45.30" style="color:#0000FF;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx45.31" style="color:#0000FF;">synthesis</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx45.32" style="color:#0000FF;">:</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx45.33" style="color:#0000FF;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx45.34" style="color:#0000FF;">{{</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx45.35" style="color:#0000FF;">question</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx45.36" style="color:#0000FF;">}}</span>
</div>
</div>
<p class="ltx_p" id="A4.SS1.p2.3">For SFT, we fine-tune the LLMs with LoRA after converting molecules into SMILES strings.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A4.SS1.p3">
<p class="ltx_p" id="A4.SS1.p3.1">The MolQA test set contains 9,986 QA pairs for small molecules in drug applications and 750 pairs for polymeric materials. The questions serve as input to prompt the LLMs to generate responses.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A4.SS1.p4">
<p class="ltx_p" id="A4.SS1.p4.1">For the controllability of multi-conditional molecular generation, we evaluate up to 12 metrics across four aspects: (1) chemical validity, (2) similarity to the truth based on Morgan fingerprints, (3) BLEU-4 and ROUGE-L scores compared to reference texts, and (4) deviation from desired properties. For polymer validity, we further examine whether the generated molecular structures contain at least two polymerization points (“*”). To obtain the properties of the designed structure, we define an oracle function based on well-trained random forests from all annotated molecules, following previous work&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[Gao et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib13" title="">2022</a>, Liu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib27" title="">2024c</a>]</cite>. We evaluate three drug-related categorical properties using balanced accuracy (BA) and five continuous material properties using mean absolute error (MAE). As a baseline, we consider GraphGA&nbsp;<cite class="ltx_cite ltx_citemacro_citep">[Gao et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#bib.bib13" title="">2022</a>]</cite> to reference the performance of LLMs compared to domain-specific methods.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A4.SS1.p5">
<p class="ltx_p" id="A4.SS1.p5.1">For retrosynthesis, we evaluate the success rate from the designed molecule to those available in <math alttext="\mathcal{G}_{\text{avail}}" class="ltx_Math" display="inline" id="A4.SS1.p5.1.m1.1"><semantics id="A4.SS1.p5.1.m1.1a"><msub id="A4.SS1.p5.1.m1.1.1" xref="A4.SS1.p5.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.SS1.p5.1.m1.1.1.2" xref="A4.SS1.p5.1.m1.1.1.2.cmml">𝒢</mi><mtext id="A4.SS1.p5.1.m1.1.1.3" xref="A4.SS1.p5.1.m1.1.1.3a.cmml">avail</mtext></msub><annotation-xml encoding="MathML-Content" id="A4.SS1.p5.1.m1.1b"><apply id="A4.SS1.p5.1.m1.1.1.cmml" xref="A4.SS1.p5.1.m1.1.1"><csymbol cd="ambiguous" id="A4.SS1.p5.1.m1.1.1.1.cmml" xref="A4.SS1.p5.1.m1.1.1">subscript</csymbol><ci id="A4.SS1.p5.1.m1.1.1.2.cmml" xref="A4.SS1.p5.1.m1.1.1.2">𝒢</ci><ci id="A4.SS1.p5.1.m1.1.1.3a.cmml" xref="A4.SS1.p5.1.m1.1.1.3"><mtext id="A4.SS1.p5.1.m1.1.1.3.cmml" mathsize="70%" xref="A4.SS1.p5.1.m1.1.1.3">avail</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p5.1.m1.1c">\mathcal{G}_{\text{avail}}</annotation><annotation encoding="application/x-llamapun" id="A4.SS1.p5.1.m1.1d">caligraphic_G start_POSTSUBSCRIPT avail end_POSTSUBSCRIPT</annotation></semantics></math>, purchasable from the Enamine Building Block (June 2024 version), supplemented with other common ions and starting materials, totaling around 1.3 million.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_subsubsection" id="A4.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">D.1.1 </span>Set-ups for&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S1.F1" title="In 1 Introduction ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Figure</span>&nbsp;<span class="ltx_text ltx_ref_tag">1</span></a>
</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A4.SS1.SSS1.p1">
<p class="ltx_p" id="A4.SS1.SSS1.p1.1">For&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S1.F1" title="In 1 Introduction ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Figure</span>&nbsp;<span class="ltx_text ltx_ref_tag">1</span></a>, we average the balanced accuracy for three drug-related properties and five MAEs for the polymeric material properties. We then select the model with the best performance in each category based on these average metrics. For drug tasks, the best ICL model is Llama-3-8B-ICL, the best SFT model is Mistral-7B-SFT, and the best Llamole variant is based on Qwen2-7B. For material tasks, the best ICL model is Llama-3-70B-ICL, the best SFT model is Llama-3-8B-SFT, and the best Llamole variant is based on Llama-3.1-8B. Their average performance is visualized in <a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S1.F1" title="In 1 Introduction ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Figure</span>&nbsp;<span class="ltx_text ltx_ref_tag">1</span></a> in comparison with GraphGA.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsubsection" id="A4.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">D.1.2 </span>Extraction of SMILES from LLM Responses</h4><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A4.SS1.SSS2.p1">
<p class="ltx_p" id="A4.SS1.SSS2.p1.1">ICL or SFT-based LLMs generate free-form text that includes both natural language and SMILES-represented molecular structures. We need a method to automatically extract SMILES strings from LLM outputs for evaluation. Practically, one can observe generation patterns to summarize rules for regular expressions to accomplish this. In the MolQA training set, the designed molecular structures typically follow the phrase ”the designed molecule is:” as shown in examples&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A4.F9" title="In D.3 Additional Discussion on Case Studies ‣ Appendix D Additional Experimental Details and Discussions ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Figures</span>&nbsp;<span class="ltx_text ltx_ref_tag">9</span></a> and&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A4.F10" title="Figure 10 ‣ D.3 Additional Discussion on Case Studies ‣ Appendix D Additional Experimental Details and Discussions ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">10</span></a>. LLMs may not always adhere strictly to this pattern, so we may need to extend this rule to cover more cases. In the future, more sophisticated regular expressions could be developed to extract SMILES strings from text directly. However, these will still need to be combined with additional rules to identify the designed molecules, as LLMs may generate intermediate SMILES strings before and after the designed molecule. Compared to them, Llamole uses <span class="ltx_text ltx_font_typewriter" id="A4.SS1.SSS2.p1.1.1">&lt;design_start&gt;</span> or <span class="ltx_text ltx_font_typewriter" id="A4.SS1.SSS2.p1.1.2">&lt;retro_start&gt;</span> to indicate the position of generated molecular structures.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_subsection" id="A4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.2 </span>Additional Discussion on One-Step Generation</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_table" id="A4.T4">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 4: </span>Text Generation for Reaction Conditions: <span class="ltx_text ltx_font_bold" id="A4.T4.3.1" style="background-color:#FFD9D9;">Best results</span> and <span class="ltx_text ltx_font_italic" id="A4.T4.4.2" style="background-color:#EBEBEB;">best baselines</span> are highlighted.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="A4.T4.5" style="width:433.6pt;height:106.3pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-98.8pt,24.2pt) scale(0.686860752221207,0.686860752221207) ;">
<table class="ltx_tabular ltx_align_middle" id="A4.T4.5.1">
<tbody><tr class="ltx_tr" id="A4.T4.5.1.1">
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_tt" id="A4.T4.5.1.1.1" style="background-color:#EBEBEB;padding-left:0.0pt;padding-right:0.0pt;">
<table class="ltx_tabular ltx_align_middle" id="A4.T4.5.1.1.1.1">
<tbody><tr class="ltx_tr" id="A4.T4.5.1.1.1.1.1">
<td class="ltx_td ltx_nopad_l ltx_nopad_r" id="A4.T4.5.1.1.1.1.1.1" style="padding-left:0.0pt;padding-right:0.0pt;"></td>
<td class="ltx_td ltx_nopad_l ltx_align_center" colspan="11" id="A4.T4.5.1.1.1.1.1.2" style="padding-left:0.0pt;padding-right:0.0pt;"><span class="ltx_text ltx_font_bold" id="A4.T4.5.1.1.1.1.1.2.1">In-Context Learning</span></td>
</tr>
<tr class="ltx_tr" id="A4.T4.5.1.1.1.1.2">
<td class="ltx_td ltx_nopad_l ltx_nopad_r" id="A4.T4.5.1.1.1.1.2.1" style="padding-left:0.0pt;padding-right:0.0pt;"></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A4.T4.5.1.1.1.1.2.2" style="padding-left:0.0pt;padding-right:0.0pt;">Llama-2-7B</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A4.T4.5.1.1.1.1.2.3" style="padding-left:0.0pt;padding-right:0.0pt;">Mistral-7B</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A4.T4.5.1.1.1.1.2.4" style="padding-left:0.0pt;padding-right:0.0pt;">Qwen2-7B</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A4.T4.5.1.1.1.1.2.5" style="padding-left:0.0pt;padding-right:0.0pt;">Llama-3-8B</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A4.T4.5.1.1.1.1.2.6" style="padding-left:0.0pt;padding-right:0.0pt;">Llama-3-8B</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A4.T4.5.1.1.1.1.2.7" style="padding-left:0.0pt;padding-right:0.0pt;">Flan-T5-XXL</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A4.T4.5.1.1.1.1.2.8" style="padding-left:0.0pt;padding-right:0.0pt;">Granite-13B</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A4.T4.5.1.1.1.1.2.9" style="padding-left:0.0pt;padding-right:0.0pt;">Llama-2-13B</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A4.T4.5.1.1.1.1.2.10" style="padding-left:0.0pt;padding-right:0.0pt;">Mistral-8x7B</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A4.T4.5.1.1.1.1.2.11" style="padding-left:0.0pt;padding-right:0.0pt;">Llama-2-70B</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A4.T4.5.1.1.1.1.2.12" style="padding-left:0.0pt;padding-right:0.0pt;">Llama-2-70B</td>
</tr>
<tr class="ltx_tr" id="A4.T4.5.1.1.1.1.3">
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_t" id="A4.T4.5.1.1.1.1.3.1" style="padding-left:0.0pt;padding-right:0.0pt;">BLEU-4</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A4.T4.5.1.1.1.1.3.2" style="padding-left:0.0pt;padding-right:0.0pt;">0.021</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A4.T4.5.1.1.1.1.3.3" style="padding-left:0.0pt;padding-right:0.0pt;">0.036</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A4.T4.5.1.1.1.1.3.4" style="padding-left:0.0pt;padding-right:0.0pt;">0.005</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A4.T4.5.1.1.1.1.3.5" style="padding-left:0.0pt;padding-right:0.0pt;">0.107</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A4.T4.5.1.1.1.1.3.6" style="padding-left:0.0pt;padding-right:0.0pt;">0.130</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A4.T4.5.1.1.1.1.3.7" style="padding-left:0.0pt;padding-right:0.0pt;">0.077</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A4.T4.5.1.1.1.1.3.8" style="padding-left:0.0pt;padding-right:0.0pt;">0.051</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A4.T4.5.1.1.1.1.3.9" style="padding-left:0.0pt;padding-right:0.0pt;">0.048</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A4.T4.5.1.1.1.1.3.10" style="padding-left:0.0pt;padding-right:0.0pt;">0.136</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A4.T4.5.1.1.1.1.3.11" style="padding-left:0.0pt;padding-right:0.0pt;">0.054</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A4.T4.5.1.1.1.1.3.12" style="padding-left:0.0pt;padding-right:0.0pt;">0.059</td>
</tr>
<tr class="ltx_tr" id="A4.T4.5.1.1.1.1.4">
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" id="A4.T4.5.1.1.1.1.4.1" style="padding-left:0.0pt;padding-right:0.0pt;">ROUGE-L</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A4.T4.5.1.1.1.1.4.2" style="padding-left:0.0pt;padding-right:0.0pt;">0.112</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A4.T4.5.1.1.1.1.4.3" style="padding-left:0.0pt;padding-right:0.0pt;">0.141</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A4.T4.5.1.1.1.1.4.4" style="padding-left:0.0pt;padding-right:0.0pt;">0.095</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A4.T4.5.1.1.1.1.4.5" style="padding-left:0.0pt;padding-right:0.0pt;">0.205</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A4.T4.5.1.1.1.1.4.6" style="padding-left:0.0pt;padding-right:0.0pt;"><span class="ltx_text ltx_font_italic" id="A4.T4.5.1.1.1.1.4.6.1" style="background-color:#EBEBEB;">0.250</span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A4.T4.5.1.1.1.1.4.7" style="padding-left:0.0pt;padding-right:0.0pt;">0.202</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A4.T4.5.1.1.1.1.4.8" style="padding-left:0.0pt;padding-right:0.0pt;">0.159</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A4.T4.5.1.1.1.1.4.9" style="padding-left:0.0pt;padding-right:0.0pt;">0.149</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A4.T4.5.1.1.1.1.4.10" style="padding-left:0.0pt;padding-right:0.0pt;">0.248</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A4.T4.5.1.1.1.1.4.11" style="padding-left:0.0pt;padding-right:0.0pt;">0.152</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A4.T4.5.1.1.1.1.4.12" style="padding-left:0.0pt;padding-right:0.0pt;">0.164</td>
</tr>
</tbody></table>
</td>
</tr>
<tr class="ltx_tr" id="A4.T4.5.1.2">
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb ltx_border_t" id="A4.T4.5.1.2.1" style="background-color:#FFD9D9;padding-left:0.0pt;padding-right:0.0pt;">
<table class="ltx_tabular ltx_align_middle" id="A4.T4.5.1.2.1.1">
<tbody><tr class="ltx_tr" id="A4.T4.5.1.2.1.1.1">
<td class="ltx_td ltx_nopad_l ltx_nopad_r" id="A4.T4.5.1.2.1.1.1.1" style="padding-left:0.0pt;padding-right:0.0pt;"></td>
<td class="ltx_td ltx_nopad_l ltx_align_center" colspan="4" id="A4.T4.5.1.2.1.1.1.2" style="padding-left:0.0pt;padding-right:0.0pt;"><span class="ltx_text ltx_font_bold" id="A4.T4.5.1.2.1.1.1.2.1">Supervised Fine-tuning</span></td>
<td class="ltx_td ltx_nopad_l ltx_align_center" colspan="3" id="A4.T4.5.1.2.1.1.1.3" style="padding-left:0.0pt;padding-right:0.0pt;"><span class="ltx_text ltx_font_bold" id="A4.T4.5.1.2.1.1.1.3.1">Llamole</span></td>
</tr>
<tr class="ltx_tr" id="A4.T4.5.1.2.1.1.2">
<td class="ltx_td ltx_nopad_l ltx_nopad_r" id="A4.T4.5.1.2.1.1.2.1" style="padding-left:0.0pt;padding-right:0.0pt;"></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A4.T4.5.1.2.1.1.2.2" style="padding-left:0.0pt;padding-right:0.0pt;">Mistral-7B</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A4.T4.5.1.2.1.1.2.3" style="padding-left:0.0pt;padding-right:0.0pt;">Qwen2-7B</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A4.T4.5.1.2.1.1.2.4" style="padding-left:0.0pt;padding-right:0.0pt;">Llama-3-8B</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A4.T4.5.1.2.1.1.2.5" style="padding-left:0.0pt;padding-right:0.0pt;">Llama-3.1-8B</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A4.T4.5.1.2.1.1.2.6" style="padding-left:0.0pt;padding-right:0.0pt;">Mistral-7B</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A4.T4.5.1.2.1.1.2.7" style="padding-left:0.0pt;padding-right:0.0pt;">Qwen2-7B</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A4.T4.5.1.2.1.1.2.8" style="padding-left:0.0pt;padding-right:0.0pt;">Llama-3.1-8B</td>
</tr>
<tr class="ltx_tr" id="A4.T4.5.1.2.1.1.3">
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_t" id="A4.T4.5.1.2.1.1.3.1" style="padding-left:0.0pt;padding-right:0.0pt;">BLEU-4</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A4.T4.5.1.2.1.1.3.2" style="padding-left:0.0pt;padding-right:0.0pt;">0.085</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A4.T4.5.1.2.1.1.3.3" style="padding-left:0.0pt;padding-right:0.0pt;"><span class="ltx_text ltx_font_bold" id="A4.T4.5.1.2.1.1.3.3.1" style="background-color:#FFD9D9;">0.141</span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A4.T4.5.1.2.1.1.3.4" style="padding-left:0.0pt;padding-right:0.0pt;">0.114</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A4.T4.5.1.2.1.1.3.5" style="padding-left:0.0pt;padding-right:0.0pt;">0.111</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A4.T4.5.1.2.1.1.3.6" style="padding-left:0.0pt;padding-right:0.0pt;">0.049</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A4.T4.5.1.2.1.1.3.7" style="padding-left:0.0pt;padding-right:0.0pt;">0.074</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A4.T4.5.1.2.1.1.3.8" style="padding-left:0.0pt;padding-right:0.0pt;">0.085</td>
</tr>
<tr class="ltx_tr" id="A4.T4.5.1.2.1.1.4">
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" id="A4.T4.5.1.2.1.1.4.1" style="padding-left:0.0pt;padding-right:0.0pt;">ROUGE-L</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A4.T4.5.1.2.1.1.4.2" style="padding-left:0.0pt;padding-right:0.0pt;">0.191</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A4.T4.5.1.2.1.1.4.3" style="padding-left:0.0pt;padding-right:0.0pt;">0.222</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A4.T4.5.1.2.1.1.4.4" style="padding-left:0.0pt;padding-right:0.0pt;">0.195</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A4.T4.5.1.2.1.1.4.5" style="padding-left:0.0pt;padding-right:0.0pt;">0.201</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A4.T4.5.1.2.1.1.4.6" style="padding-left:0.0pt;padding-right:0.0pt;">0.192</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A4.T4.5.1.2.1.1.4.7" style="padding-left:0.0pt;padding-right:0.0pt;">0.262</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A4.T4.5.1.2.1.1.4.8" style="padding-left:0.0pt;padding-right:0.0pt;"><span class="ltx_text ltx_font_bold" id="A4.T4.5.1.2.1.1.4.8.1" style="background-color:#FFD9D9;">0.268</span></td>
</tr>
</tbody></table>
</td>
</tr>
</tbody></table>
</span></div>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A4.SS2.p1">
<p class="ltx_p" id="A4.SS2.p1.1">We further examine the text generation results for reaction conditions. Since the answer represents just one possibility in retrosynthesis, we use the template to retrieve the best-matching reaction condition descriptions as references for&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A4.T4" title="In D.2 Additional Discussion on One-Step Generation ‣ Appendix D Additional Experimental Details and Discussions ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Table</span>&nbsp;<span class="ltx_text ltx_ref_tag">4</span></a>, based on the available templates within the USPTO reaction space. One template may correspond to thousands of reactions, so we limit our search to five items to manage costs while identifying the best matching generated and reference pairs.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A4.SS2.p2">
<p class="ltx_p" id="A4.SS2.p2.1">The results of generating reaction texts are shown in&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A4.T4" title="In D.2 Additional Discussion on One-Step Generation ‣ Appendix D Additional Experimental Details and Discussions ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Table</span>&nbsp;<span class="ltx_text ltx_ref_tag">4</span></a>, where Llamole achieves the highest ROUGE-L but low BLEU-4 scores. The best ROUGE-L score for Llamole indicates its capacity to understand and maintain the overall structure of the answer after fine-tuning. The lower BLEU-4 scores may result from the A* search nature in Llamole, which explores a vast space (300K) of possible reactions, leading to fewer exact n-gram matches with reference sentences. The many-to-many relationships between products and reactants, along with various conditions for the same reaction, diminish BLEU-4’s effectiveness in evaluating Llamole’s capabilities. Overall, Llamole is not merely memorizing reaction conditions but actively exploring possibilities, yielding more contextually coherent and meaningful outputs.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="A4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.3 </span>Additional Discussion on Case Studies</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="A4.F9">
<p class="ltx_p" id="A4.F9.1"><span class="ltx_text ltx_inline-block" id="A4.F9.1.1" style="width:433.6pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_portrait" height="1281" id="A4.F9.1.1.g1" src="https://arxiv.org/html/2410.04223v1/x10.png" width="847">
</span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>Reference Answer with Generation Results from ICL or SFT Using the base LLM Qwen2-7B. The question is the same as in&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S5.F7" title="In 5.2.1 Ablation Studies on LLM and Graph DiT Synergy ‣ 5.2 RQ2: Discussion on Controllable Molecular Generation ‣ 5 Experiment ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Figure</span>&nbsp;<span class="ltx_text ltx_ref_tag">7</span></a>.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="A4.F10">
<p class="ltx_p" id="A4.F10.1"><span class="ltx_text ltx_inline-block" id="A4.F10.1.1" style="width:433.6pt;"><img alt="Refer to caption" class="ltx_graphics ltx_missing ltx_missing_image" id="A4.F10.1.1.g1" src="https://arxiv.org/html/2410.04223v1/">
</span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 10: </span>A Case Study for the Small Molecule: We include the reference answer and the generation results from ICL with Llama-3-8B and SFT and Llamole with Llama-3.1-8B.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="A4.F11">
<p class="ltx_p" id="A4.F11.1"><span class="ltx_text ltx_inline-block" id="A4.F11.1.1" style="width:433.6pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_portrait" height="1281" id="A4.F11.1.1.g1" src="https://arxiv.org/html/2410.04223v1/x12.png" width="847">
</span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 11: </span>A Case Study for the Polymer: We include the reference answer and the generation results from ICL, SFT, and Llamole with Qwen2-7B.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A4.SS3.p1">
<p class="ltx_p" id="A4.SS3.p1.1">We present case studies for baseline LLMs using the same question as in&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S5.F7" title="In 5.2.1 Ablation Studies on LLM and Graph DiT Synergy ‣ 5.2 RQ2: Discussion on Controllable Molecular Generation ‣ 5 Experiment ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Figure</span>&nbsp;<span class="ltx_text ltx_ref_tag">7</span></a>. Results are shown in&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S5.F7" title="In 5.2.1 Ablation Studies on LLM and Graph DiT Synergy ‣ 5.2 RQ2: Discussion on Controllable Molecular Generation ‣ 5 Experiment ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Figure</span>&nbsp;<span class="ltx_text ltx_ref_tag">7</span></a>. The reference indicates one possible ground truth for molecular design with retrosynthetic pathways, noting that many alternatives exist. Compared to the reference, results in&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#S5.F7" title="In 5.2.1 Ablation Studies on LLM and Graph DiT Synergy ‣ 5.2 RQ2: Discussion on Controllable Molecular Generation ‣ 5 Experiment ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Figure</span>&nbsp;<span class="ltx_text ltx_ref_tag">7</span></a> demonstrate that Llamole designs another molecule with similar structures, properties, and shorter synthesis routes, showcasing its potential for controllability and generating synthesizable molecules.
Using ICL, Qwen2-7B fails to generate meaningful responses, despite indicating it possesses rich knowledge about molecular design. SFT allows Qwen2-7B to more strictly follow instructions, producing meaningful responses. However, text-only generation leads to hallucinations, as the generated templates do not yield expected products in retrosynthetic planning.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A4.SS3.p2">
<p class="ltx_p" id="A4.SS3.p2.1">Another example based on Llama-3.1/3-8B is provided in&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A4.F10" title="In D.3 Additional Discussion on Case Studies ‣ Appendix D Additional Experimental Details and Discussions ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Figure</span>&nbsp;<span class="ltx_text ltx_ref_tag">10</span></a>. The ICL method may copy from the demonstrations to get the SMILES string <span class="ltx_text ltx_font_typewriter" id="A4.SS3.p2.1.1">CC(=O)C=Cc1cc(Cl)ccc1Cl</span>.
It also includes one SMILES string before the designed molecule, such as <span class="ltx_text ltx_font_typewriter" id="A4.SS3.p2.1.2">CN(C)c1ccc(C=NNc2ccc(I)cc2)cc1</span>. However, it does not follow the instruction pattern and is therefore not automatically extracted for evaluation, as illustrated in&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A4.SS1.SSS2" title="D.1.2 Extraction of SMILES from LLM Responses ‣ D.1 Additional Details on Experimental Set-ups ‣ Appendix D Additional Experimental Details and Discussions ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Section</span>&nbsp;<span class="ltx_text ltx_ref_tag">D.1.2</span></a>.
SFT follows the instructions through fine-tuning, using the pattern ”the designed molecule is:” but generates invalid structures with meaninglessly repeated sentences. In contrast, Llamole generates meaningful and valid molecular structures that generally satisfy the question’s requirements. During text generation for molecular design, Llamole analyzes the question and includes more details about desirable structures, such as “aromatic rings” and “aliphatic chains”. Some functional groups, like hydroxyl, may not be precisely represented in the structure. This indicates a need for enhanced text instruction adherence in Graph DiT.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A4.SS3.p3">
<p class="ltx_p" id="A4.SS3.p3.3">In addition to small molecules, we present a polymer inverse design case in&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A4.F11" title="In D.3 Additional Discussion on Case Studies ‣ Appendix D Additional Experimental Details and Discussions ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Figure</span>&nbsp;<span class="ltx_text ltx_ref_tag">11</span></a> based on Qwen2-7B. The polymer has polymerization points denoted by “*” in the reference structure. Since polymerization reactions are not considered, we focus on the retrosynthetic routes to the monomer structures by replacing polymerization points with hydrogen atoms. In this case, ICL-based Qwen2-7B fails molecular design due to the same issue as in&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.04223v1#A4.F9" title="In D.3 Additional Discussion on Case Studies ‣ Appendix D Additional Experimental Details and Discussions ‣ Multimodal Large Language Models for Inverse Molecular Design with Retrosynthetic Planning"><span class="ltx_text ltx_ref_tag">Figure</span>&nbsp;<span class="ltx_text ltx_ref_tag">9</span></a>, not following instructions to generate polymer structures. SFT-based Qwen2-7B generates a polymer in SMILES format but invalid in chemical space. In contrast, Llamole successfully generates valid molecular structures through Graph DiT, satisfying the requirements of ”high CO<sub class="ltx_sub" id="A4.SS3.p3.3.1">2</sub> permeability and low permeability to N<sub class="ltx_sub" id="A4.SS3.p3.3.2">2</sub> and O<sub class="ltx_sub" id="A4.SS3.p3.3.3">2</sub>,” and suggests a two-step retrosynthetic pathway for the monomer structure.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
</article>
</div>

</div>


<button type="button" class="btn btn-primary hover-rp-button" id="openForm">Report Issue</button><div class="modal" id="myForm" role="dialog" aria-labelledby="modal-title"><div class="modal-dialog"><form class="modal-content" id="myFormContent" enctype="multipart/form-data"><div class="modal-header" id="modal-header"><h5 class="modal-title">Report Github Issue</h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div><div class="modal-body"><label for="form_title" id="modalTitle">Title:</label><input class="form-control" id="form_title" name="form_title" required="required" placeholder="Enter title"><label for="description" id="selectedTextModalDescription" style="display: none;">Content selection saved. Describe the issue below:</label><label for="description" id="nomralModalDescription">Description:</label><textarea class="form-control" id="description" name="description" required="required" style="height: 80px;" maxlength="500" placeholder="500 characters maximum"></textarea></div><div class="modal-footer d-flex justify-content-end"><button type="submit" class="sr-only button" id="modal-submit-sr">Submit without Github</button><button type="submit" class="btn btn-primary" id="modal-submit">Submit in Github</button></div></form></div></div><button id="small-report-button" type="button" class="btn btn-secondary btn-sm" style="background-color: rgb(179, 27, 27); position: fixed;">Report Issue for Selection</button><div class="ltx_page_footer">
        <div class="ltx_page_logo">
            Generated by
            <a href="https://math.nist.gov/~BMiller/LaTeXML/" class="ltx_LaTeXML_logo">
                <span style="letter-spacing: -0.2em; margin-right: 0.1em;">
                    L
                    <span style="font-size: 70%; position: relative; bottom: 2.2pt;">A</span>
                    T
                    <span style="position: relative; bottom: -0.4ex;">E</span>
                </span>
                <span class="ltx_font_smallcaps">xml</span>
                <img alt="[LOGO]" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==">
            </a>
        </div></div><footer id="footer" class="ltx_document">
        <div class="keyboard-glossary">
            <h2>Instructions for reporting errors</h2>
            <p>We are continuing to improve HTML versions of papers, and your feedback helps enhance accessibility and mobile support. To report errors in the HTML that will help us improve conversion and rendering, choose any of the methods listed below:</p>
            <ul>
                <li>Click the "Report Issue" button.</li>
                <li>Open a report feedback form via keyboard, use "<strong>Ctrl + ?</strong>".</li>
                <li>Make a text selection and click the "Report Issue for Selection" button near your cursor.</li>
                <li class="sr-only">You can use Alt+Y to toggle on and Alt+Shift+Y to toggle off accessible reporting links at each section.</li>
            </ul>
            <p>Our team has already identified <a class="ltx_ref" href="https://github.com/arXiv/html_feedback/issues" target="_blank">the following issues</a>. We appreciate your time reviewing and reporting rendering errors we may not have found yet. Your efforts will help us improve the HTML versions for all readers, because disability should not be a barrier to accessing research. Thank you for your continued support in championing open access for all.</p>
            <p>Have a free development cycle? Help support accessibility at arXiv! Our collaborators at LaTeXML maintain a <a class="ltx_ref" href="https://github.com/brucemiller/LaTeXML/wiki/Porting-LaTeX-packages-for-LaTeXML" target="_blank">list of packages that need conversion</a>, and welcome <a class="ltx_ref" href="https://github.com/brucemiller/LaTeXML/issues" target="_blank">developer contributions</a>.</p>
        </div>
    </footer></body></html>