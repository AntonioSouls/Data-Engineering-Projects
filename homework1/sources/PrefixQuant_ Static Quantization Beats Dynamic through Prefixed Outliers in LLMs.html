<!DOCTYPE html><html lang="en" data-theme="light"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<title>PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs</title>
<!--Generated on Wed Oct  2 13:49:02 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="https://arxiv.org/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css">
<link href="https://arxiv.org/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css">
<link href="https://arxiv.org/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css">




<base href="https://arxiv.org/html/2410.05265v1/"><link rel="stylesheet" href="https://use.typekit.net/rwr5zpx.css"><link rel="icon" type="image/png" href="https://static.arxiv.org/static/browse/0.3.4/images/icons/favicon-16x16.png" sizes="16x16"><link rel="icon" type="image/png" href="https://static.arxiv.org/static/browse/0.3.4/images/icons/favicon-32x32.png" sizes="32x32"></head>
<body><header class="mob_header">
    <div class="html-header-logo">
      <a href="https://arxiv.org/">
        <img alt="logo" class="logomark" role="presentation" width="100" src="https://services.dev.arxiv.org/html/static/arxiv-logomark-small-white.svg">
        <span class="sr-only">Back to arXiv</span>
      </a>
    </div>

    <!--TOC, dark mode, links-->
    <div class="html-header-nav">
      <!--back to abstract-->
      
        <a class="nav-link ar5iv-footer-button hover-effect" aria-label="Back to abstract page" href="https://arxiv.org/abs/2410.05265v1">
        <svg xmlns="http://www.w3.org/2000/svg" height="1.25em" viewBox="0 0 512 512" fill="#ffffff" aria-hidden="true">
            <path d="M502.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L402.7 224 192 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l210.7 0-73.4 73.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l128-128zM160 96c17.7 0 32-14.3 32-32s-14.3-32-32-32L96 32C43 32 0 75 0 128L0 384c0 53 43 96 96 96l64 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-64 0c-17.7 0-32-14.3-32-32l0-256c0-17.7 14.3-32 32-32l64 0z"></path>
        </svg>
        </a>
      <!--dark mode-->
      <a class="ar5iv-toggle-color-scheme" title="Toggle dark/light mode" aria-label="System preference">
        <label id="automatic-tog" class="toggle-icon" title="Switch to light mode" for="__palette_3">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"></path></svg>
        </label>
        
        
      </a>
      <!--nav-->
      <button class="navbar-toggler ar5iv-footer-button" type="button" data-bs-theme="dark" data-bs-toggle="collapse" aria-expanded="false" data-bs-target=".ltx_page_main >.ltx_TOC.mobile" aria-controls="navbarSupportedContent" aria-label="Toggle navigation" style="border:none; margin-right: 0em;">
        <svg xmlns="http://www.w3.org/2000/svg" height="1.25em" viewBox="0 0 448 512" aria-hidden="true" role="img" fill="#ffffff"><path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"></path></svg>
      </button>
    </div>
    </header><header class="desktop_header">
    <div class="html-header-logo">
      <a href="https://arxiv.org/">
          <img alt="logo" class="logo" role="presentation" width="100" src="https://services.dev.arxiv.org/html/static/arxiv-logo-one-color-white.svg">
          <span class="sr-only">Back to arXiv</span>
      </a>
    </div>
    <div class="html-header-message" role="banner">
        <p>This is <strong>experimental HTML</strong> to improve accessibility. We invite you to report rendering errors. <span class="sr-only">Use Alt+Y to toggle on accessible reporting links and Alt+Shift+Y to toggle off.</span> Learn more <a href="https://info.arxiv.org/about/accessible_HTML.html" target="_blank">about this project</a> and <a href="https://info.arxiv.org/help/submit_latex_best_practices.html" target="_blank">help improve conversions</a>.
        </p>
    </div>
    <nav class="html-header-nav">
      <a class="ar5iv-footer-button hover-effect" href="https://info.arxiv.org/about/accessible_HTML.html" target="_blank">Why HTML?</a>
      <a class="ar5iv-footer-button hover-effect" target="_blank" href="https://arxiv.org/html/2410.05265v1/#myForm">Report Issue</a>
      <a class="ar5iv-footer-button hover-effect" href="https://arxiv.org/abs/2410.05265v1">Back to Abstract</a>
      <a class="ar5iv-footer-button hover-effect" href="https://arxiv.org/pdf/2410.05265v1" target="_blank">Download PDF</a>
      <a class="ar5iv-toggle-color-scheme" title="Toggle dark/light mode">
        <label id="automatic-tog" class="toggle-icon" title="Switch to light mode" for="__palette_3">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"></path></svg>
        </label>
        
        
      </a>
    </nav></header>

<div class="ltx_page_main" id="main">
<nav class="ltx_TOC active" aria-labelledby="toc_header"><h2 id="toc_header" class="sr-only">Table of Contents</h2>

      <div id="listIcon" type="button" class="hide">
          <svg width="17px" height="17px" viewBox="0 0 512 512" style="pointer-events: none;">
          <path d="M40 48C26.7 48 16 58.7 16 72v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V72c0-13.3-10.7-24-24-24H40zM192 64c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zM16 232v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V232c0-13.3-10.7-24-24-24H40c-13.3 0-24 10.7-24 24zM40 368c-13.3 0-24 10.7-24 24v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V392c0-13.3-10.7-24-24-24H40z"></path>
          </svg>
      </div>
      <div id="arrowIcon" type="button">
          <svg width="17px" height="17px" viewBox="0 0 448 512" style="pointer-events: none;">
          <path d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.2 288 416 288c17.7 0 32-14.3 32-32s-14.3-32-32-32l-306.7 0L214.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"></path>
          </svg>
      </div><ol class="ltx_toclist"><li class="ltx_tocentry ltx_tocentry_section">
    <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#abstract" title="Abstract">
      <span class="ltx_text ltx_ref_title">
        <span class="ltx_tag ltx_tag_ref"></span>
        Abstract
      </span>
    </a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#S1" title="In PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#S2" title="In PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Works</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#S3" title="In PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Preliminaries</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#S4" title="In PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Difficulty of Static Quantization</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#S5" title="In PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>PrefixQuant</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#S5.SS1" title="In 5 PrefixQuant ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Prefixed Outliers</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#S5.SS2" title="In 5 PrefixQuant ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Block-wise Fine-tuning</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#S6" title="In PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#S6.SS1" title="In 6 Experiments ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.1 </span>Setups</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#S6.SS2" title="In 6 Experiments ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.2 </span>Comparison Results</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#S6.SS3" title="In 6 Experiments ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.3 </span>Inference Speed</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#S6.SS4" title="In 6 Experiments ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.4 </span>Ablation Studies</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#S7" title="In PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A1" title="In PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Reproducibility Statement</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A2" title="In PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Configuration and Data Sources of Comparison Methods</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A3" title="In PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>Details of Rotation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A4" title="In PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D </span>Inference Efficiency Details</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A5" title="In PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E </span>Quantization Time</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A6" title="In PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">F </span>More Ablation Results</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A7" title="In PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">G </span>Extend to Weight-only Quantization</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A8" title="In PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">H </span>Full Results of Weight-Activation quantization</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A8.SS1" title="In Appendix H Full Results of Weight-Activation quantization ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">H.1 </span>Comparisons with Related Works</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A8.SS2" title="In Appendix H Full Results of Weight-Activation quantization ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">H.2 </span>Detailed Accuracy Results</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A8.SS3" title="In Appendix H Full Results of Weight-Activation quantization ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">H.3 </span>Results on More Models</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A9" title="In PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">I </span>More Visualizations</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A9.SS1" title="In Appendix I More Visualizations ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">I.1 </span>Outlier Token</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A9.SS2" title="In Appendix I More Visualizations ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">I.2 </span>Magnitude Distribution</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
    <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib" title="References">
      <span class="ltx_text ltx_ref_title">
        <span class="ltx_tag ltx_tag_ref"></span>
        References
      </span>
    </a></li></ol></nav>

<div class="ltx_page_content"><div class="package-alerts ltx_document" role="status" aria-label="Conversion errors have been found">
      <button aria-label="Dismiss alert">
          <span aria-hidden="true"><svg role="presentation" width="20" height="20" viewBox="0 0 44 44" aria-hidden="true" focusable="false">
          <path d="M0.549989 4.44999L4.44999 0.549988L43.45 39.55L39.55 43.45L0.549989 4.44999Z"></path>
          <path d="M39.55 0.549988L43.45 4.44999L4.44999 43.45L0.549988 39.55L39.55 0.549988Z"></path>
          </svg></span>
      </button>
      <p>HTML conversions <a href="https://info.dev.arxiv.org/about/accessibility_html_error_messages.html" target="_blank">sometimes display errors</a> due to content that did not convert correctly from the source. This paper uses the following packages that are not yet supported by the HTML conversion tool. Feedback on these issues are not necessary; they are known and are being worked on.</p>
          <ul arial-label="Unsupported packages used in this paper">
              <li>failed: arydshln</li>
          </ul>
      <p>Authors: achieve the best HTML results from your LaTeX submissions by following these <a href="https://info.arxiv.org/help/submit_latex_best_practices.html" target="_blank">best practices</a>.</p>
    </div><div id="target-section" class="section"><a id="license-tr" href="https://info.arxiv.org/help/license/index.html#licenses-available">License: CC BY 4.0</a><div id="watermark-tr">arXiv:2410.05265v1 [cs.LG] 07 Oct 2024</div></div>
<article class="ltx_document ltx_authors_1line"><span class="ltx_note ltx_role_footnotetext" id="footnotex1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">footnotetext: </span>
<sup class="ltx_sup" id="footnotex1.1">∗</sup>Corresponding author: shaowenqi@pjlab.org.cn, pluo@cs.hku.hk</span></span></span>
<h1 class="ltx_title ltx_title_document">PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs</h1><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Mengzhao Chen<sup class="ltx_sup" id="id15.9.id1"><span class="ltx_text ltx_font_italic" id="id15.9.id1.1">1,2</span></sup>, Yi Liu, Jiahao Wang<sup class="ltx_sup" id="id16.10.id2"><span class="ltx_text ltx_font_italic" id="id16.10.id2.1">1</span></sup>,
Yi Bin<sup class="ltx_sup" id="id17.11.id3"><span class="ltx_text ltx_font_italic" id="id17.11.id3.1">3</span></sup>, Wenqi Shao<sup class="ltx_sup" id="id18.12.id4"><span class="ltx_text ltx_font_italic" id="id18.12.id4.1">∗2</span></sup>, Ping Luo<sup class="ltx_sup" id="id19.13.id5"><span class="ltx_text ltx_font_italic" id="id19.13.id5.1">∗1</span></sup>
<br class="ltx_break"><sup class="ltx_sup" id="id20.14.id6">1</sup>The University of Hong Kong <sup class="ltx_sup" id="id21.15.id7">2</sup>Shanghai AI Laboratory <sup class="ltx_sup" id="id22.16.id8">3</sup>Tongji University 
<br class="ltx_break"><span class="ltx_text ltx_font_typewriter" id="id23.17.id9">chenmnz@connect.hku.hk</span>, <span class="ltx_text ltx_font_typewriter" id="id24.18.id10">randall.liu30@gmail.com</span>,
<br class="ltx_break"><span class="ltx_text ltx_font_typewriter" id="id25.19.id11">shaowenqi@pjlab.org.cn</span>,<span class="ltx_text ltx_font_typewriter" id="id26.20.id12">pluo@cs.hku.hk</span>
<br class="ltx_break">
</span></span>
</div><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_abstract" id="abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<p class="ltx_p" id="id14.6">Quantization is essential for deploying Large Language Models (LLMs) by enhancing memory efficiency and inference speed. Existing methods for activation quantization mainly address channel-wise outliers, often neglecting token-wise outliers, leading to reliance on costly per-token dynamic quantization.
To address this, we introduce PrefixQuant, a novel technique that isolates outlier tokens offline without re-training. Specifically, PrefixQuant identifies high-frequency outlier tokens and prefixes them in the KV cache, preventing the generation of outlier tokens during inference and simplifying quantization. To our knowledge, PrefixQuant is the first to enable efficient per-tensor static quantization to outperform expensive per-token dynamic quantization.
For instance, in W4A4KV4 (4-bit weight, 4-bit activation, and 4-bit KV cache) Llama-3-8B, PrefixQuant with per-tensor static quantization achieves a 7.43 WikiText2 perplexity and 71.08% average accuracy on 5 common-sense reasoning tasks, outperforming previous per-token dynamic quantization methods like QuaRot with <math alttext="0.98" class="ltx_Math" display="inline" id="id9.1.m1.1"><semantics id="id9.1.m1.1a"><mn id="id9.1.m1.1.1" xref="id9.1.m1.1.1.cmml">0.98</mn><annotation-xml encoding="MathML-Content" id="id9.1.m1.1b"><cn id="id9.1.m1.1.1.cmml" type="float" xref="id9.1.m1.1.1">0.98</cn></annotation-xml><annotation encoding="application/x-tex" id="id9.1.m1.1c">0.98</annotation><annotation encoding="application/x-llamapun" id="id9.1.m1.1d">0.98</annotation></semantics></math> perplexity improvement and <math alttext="+5.98" class="ltx_Math" display="inline" id="id10.2.m2.1"><semantics id="id10.2.m2.1a"><mrow id="id10.2.m2.1.1" xref="id10.2.m2.1.1.cmml"><mo id="id10.2.m2.1.1a" xref="id10.2.m2.1.1.cmml">+</mo><mn id="id10.2.m2.1.1.2" xref="id10.2.m2.1.1.2.cmml">5.98</mn></mrow><annotation-xml encoding="MathML-Content" id="id10.2.m2.1b"><apply id="id10.2.m2.1.1.cmml" xref="id10.2.m2.1.1"><plus id="id10.2.m2.1.1.1.cmml" xref="id10.2.m2.1.1"></plus><cn id="id10.2.m2.1.1.2.cmml" type="float" xref="id10.2.m2.1.1.2">5.98</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id10.2.m2.1c">+5.98</annotation><annotation encoding="application/x-llamapun" id="id10.2.m2.1d">+ 5.98</annotation></semantics></math> points accuracy.
Additionally, the inference speed of W4A4 quantized models using PrefixQuant is <math alttext="1.60\times" class="ltx_math_unparsed" display="inline" id="id11.3.m3.1"><semantics id="id11.3.m3.1a"><mrow id="id11.3.m3.1b"><mn id="id11.3.m3.1.1">1.60</mn><mo id="id11.3.m3.1.2" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="id11.3.m3.1c">1.60\times</annotation><annotation encoding="application/x-llamapun" id="id11.3.m3.1d">1.60 ×</annotation></semantics></math> to <math alttext="2.81\times" class="ltx_math_unparsed" display="inline" id="id12.4.m4.1"><semantics id="id12.4.m4.1a"><mrow id="id12.4.m4.1b"><mn id="id12.4.m4.1.1">2.81</mn><mo id="id12.4.m4.1.2" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="id12.4.m4.1c">2.81\times</annotation><annotation encoding="application/x-llamapun" id="id12.4.m4.1d">2.81 ×</annotation></semantics></math> faster than FP16 models and exceeds QuaRot models by <math alttext="1.2\times" class="ltx_math_unparsed" display="inline" id="id13.5.m5.1"><semantics id="id13.5.m5.1a"><mrow id="id13.5.m5.1b"><mn id="id13.5.m5.1.1">1.2</mn><mo id="id13.5.m5.1.2" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="id13.5.m5.1c">1.2\times</annotation><annotation encoding="application/x-llamapun" id="id13.5.m5.1d">1.2 ×</annotation></semantics></math> to <math alttext="1.3\times" class="ltx_math_unparsed" display="inline" id="id14.6.m6.1"><semantics id="id14.6.m6.1a"><mrow id="id14.6.m6.1b"><mn id="id14.6.m6.1.1">1.3</mn><mo id="id14.6.m6.1.2" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="id14.6.m6.1c">1.3\times</annotation><annotation encoding="application/x-llamapun" id="id14.6.m6.1d">1.3 ×</annotation></semantics></math>.
Our code is available at <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/ChenMnZ/PrefixQuant" title="">https://github.com/ChenMnZ/PrefixQuant</a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Recently, Large Language Models (LLMs)<cite class="ltx_cite ltx_citemacro_citep">(Touvron et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib33" title="">2023</a>; Bubeck et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib6" title="">2023</a>)</cite> demonstrate remarkable capabilities across various tasks, significantly improving the convenience of daily work and life.
However, their large parameters and computational demands pose significant challenges for deployment. This makes quantization&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Frantar et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib12" title="">2022</a>; Lin et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib19" title="">2023</a>; Shao et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib29" title="">2023</a>)</cite> a crucial technology for reducing memory usage and speeding up inference&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Yuan et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib41" title="">2024</a>)</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Despite advancements, large outliers in LLMs activations can lead to significant quantization errors and accuracy loss. Many current methods address this by focusing on alleviating channel-wise outliers <cite class="ltx_cite ltx_citemacro_citep">(Dettmers et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib11" title="">2022</a>)</cite> through techniques like channel-wise scaling <cite class="ltx_cite ltx_citemacro_citep">(Xiao et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib38" title="">2023a</a>; Shao et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib29" title="">2023</a>; Wei et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib36" title="">2023a</a>)</cite>, mixed-precision quantization <cite class="ltx_cite ltx_citemacro_citep">(Dettmers et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib11" title="">2022</a>; Zhao et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib43" title="">2023</a>)</cite>, Hadamard rotation <cite class="ltx_cite ltx_citemacro_citep">(Ashkboos et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib3" title="">2024b</a>; Liu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib22" title="">2024a</a>)</cite>, and channel-level assembly <cite class="ltx_cite ltx_citemacro_citep">(Liu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib21" title="">2023</a>)</cite>. However, activations of LLMs include not only channel-wise but also token-wise outliers. For example, Figure&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">1</span></a> (a) shows that some tokens, can be termed as outlier tokens, have extreme values exceeding 1,000, making it impractical to share quantization scales between outlier and normal tokens.
The current leading method, Hadamard rotation&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Ashkboos et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib3" title="">2024b</a>)</cite>, redistributes outlier values across all channels, reducing the maximum value in outlier tokens from over 1,000 to about 15 (see Figure&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">1</span></a> (b)). Nevertheless, the magnitude of outlier tokens remains hundreds of times greater than that of normal tokens, still suffering significant performance degradation when sharing quantization scales across different tokens.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Due to such dramatic discrepancies between normal and outlier tokens, previous quantization methods have to rely on per-token dynamic quantization to adjust quantization scales on-the-fly for each token.
While per-token dynamic quantization adapts better to distribution changes, it faces more computational effort&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Xiao et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib38" title="">2023a</a>)</cite> and less compatible with operator fusion&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Nagel et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib25" title="">2021</a>)</cite> than per-tensor static quantization which use a fixed quantization parameter for all token.
This leads to an important question: <span class="ltx_text ltx_font_bold ltx_font_italic" id="S1.p3.1.1">Can we eliminate token-wise outliers to enhance the precision of efficient per-tensor static quantization?</span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="197" id="S1.F1.g1" src="https://arxiv.org/html/2410.05265v1/x1.png" width="747">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span><span class="ltx_text ltx_font_bold" id="S1.F1.2.1">Comparison of PrefixQuant with existing methods.</span> This figure shows the input activation of the down_proj linear layer in Llama-2-7B using different methods. Perplexity is measured with Llama-2-7B under 16-bit weight and 4-bit activation using per-tensor static quantization without any re-training. The original distribution has significant outliers larger than 1,000 (left). The previous method with Hadamard rotation&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Ashkboos et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib3" title="">2024b</a>)</cite> reduces outliers to nearly 15 (middle) but still suffers from poor perplexity due to a non-uniform distribution. We propose PrefixQuant (right), which prefixes some specific tokens in KV cache to isolate outliers, reducing the maximum to nearly 0.07, significantly improving quantization performance.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S1.p4">
<p class="ltx_p" id="S1.p4.2">In this paper, we propose PrefixQuant, an efficient solution for static activation quantization in LLMs. PrefixQuant is based on a key observation: outlier tokens usually appear at fixed positions in the token sequence (such as the initial token) or in tokens with low semantic value (such as “\n”, “.”, “the”, <em class="ltx_emph ltx_font_italic" id="S1.p4.2.1">etc</em>).
Based on this observation, PrefixQuant pre-processes the outlier tokens offline in the KV cache to prevent generate new outlier tokens during inference. Specifically, given a LLM, PrefixQuant firstly counts the number <math alttext="N" class="ltx_Math" display="inline" id="S1.p4.1.m1.1"><semantics id="S1.p4.1.m1.1a"><mi id="S1.p4.1.m1.1.1" xref="S1.p4.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S1.p4.1.m1.1b"><ci id="S1.p4.1.m1.1.1.cmml" xref="S1.p4.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S1.p4.1.m1.1d">italic_N</annotation></semantics></math> of outlier tokens, and selects the Top-<math alttext="N" class="ltx_Math" display="inline" id="S1.p4.2.m2.1"><semantics id="S1.p4.2.m2.1a"><mi id="S1.p4.2.m2.1.1" xref="S1.p4.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S1.p4.2.m2.1b"><ci id="S1.p4.2.m2.1.1.cmml" xref="S1.p4.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.2.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="S1.p4.2.m2.1d">italic_N</annotation></semantics></math> high-frequency outlier tokens to prefix in the KV cache. This process is efficient and does not require any retraining, unlike previous methods&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Sun et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib32" title="">2024</a>; Bondarenko et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib5" title="">2024</a>)</cite>, and can be completed quickly, such as in 12 seconds for Llama-2-7B.
As illustrated in Figure&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">1</span></a> (c), PrefixQuant effectively eliminates outlier tokens, achieving excellent performance with per-tensor static activation quantization. For example, with 4-bit per-tensor static activation quantization on Llama-2-7B, PrefixQuant achieves 5.91 perplexity, significantly outperforms QuaRot which has a perplexity of 17.95.
Furthermore, we introduce a block-wise fine-tuning optimization&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Shao et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib29" title="">2023</a>; Chen et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib7" title="">2024a</a>)</cite> to improve performance by simultaneously training the quantization parameters of both weight and activation.
Additionally, we also find that isolating the outlier tokens enhances the convergence stability of training through avoiding large outliers magnitude during the calculation of Mean Square Error (MSE) loss. Thus, the proposed method of prefixed outliers can also serve as a plug-and-play enhancement for existing optimization-based quantization methods&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Shao et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib29" title="">2023</a>; Chen et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib7" title="">2024a</a>)</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S1.p5">
<p class="ltx_p" id="S1.p5.6">Experiments demonstrate that, without any fine-tuning, PrefixQuant achieves comparable or better performance than previous per-token dynamic quantization methods&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Ashkboos et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib3" title="">2024b</a>; Xiao et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib38" title="">2023a</a>; Lin et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib20" title="">2024b</a>)</cite> using coarser per-tensor static quantization. Furthermore, fine-tuning significantly enhances PrefixQuant’s performance. For example, PrefixQuant with fine-tuning achieves a 7.43 WikiText2&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Merity et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib24" title="">2016</a>)</cite> perplexity and 71.08% average accuracy across five common-sense reasoning tasks in W4A4KV4 Llama-3-8B, significantly outperforming previous QuaRot&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Ashkboos et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib3" title="">2024b</a>)</cite> with <math alttext="0.98" class="ltx_Math" display="inline" id="S1.p5.1.m1.1"><semantics id="S1.p5.1.m1.1a"><mn id="S1.p5.1.m1.1.1" xref="S1.p5.1.m1.1.1.cmml">0.98</mn><annotation-xml encoding="MathML-Content" id="S1.p5.1.m1.1b"><cn id="S1.p5.1.m1.1.1.cmml" type="float" xref="S1.p5.1.m1.1.1">0.98</cn></annotation-xml><annotation encoding="application/x-tex" id="S1.p5.1.m1.1c">0.98</annotation><annotation encoding="application/x-llamapun" id="S1.p5.1.m1.1d">0.98</annotation></semantics></math> perplexity benefit and <math alttext="+5.98" class="ltx_Math" display="inline" id="S1.p5.2.m2.1"><semantics id="S1.p5.2.m2.1a"><mrow id="S1.p5.2.m2.1.1" xref="S1.p5.2.m2.1.1.cmml"><mo id="S1.p5.2.m2.1.1a" xref="S1.p5.2.m2.1.1.cmml">+</mo><mn id="S1.p5.2.m2.1.1.2" xref="S1.p5.2.m2.1.1.2.cmml">5.98</mn></mrow><annotation-xml encoding="MathML-Content" id="S1.p5.2.m2.1b"><apply id="S1.p5.2.m2.1.1.cmml" xref="S1.p5.2.m2.1.1"><plus id="S1.p5.2.m2.1.1.1.cmml" xref="S1.p5.2.m2.1.1"></plus><cn id="S1.p5.2.m2.1.1.2.cmml" type="float" xref="S1.p5.2.m2.1.1.2">5.98</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p5.2.m2.1c">+5.98</annotation><annotation encoding="application/x-llamapun" id="S1.p5.2.m2.1d">+ 5.98</annotation></semantics></math> points accuracy.
To the best of our knowledge, PrefixQuant is the first to outperform previous per-token dynamic quantization methods&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Ashkboos et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib3" title="">2024b</a>; Xiao et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib38" title="">2023a</a>; Lin et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib20" title="">2024b</a>)</cite> using coarse per-tensor static quantization.
We also benchmark the end-to-end inference of W4A4 quantization, where PrefixQuant achieves a <math alttext="1.60\times" class="ltx_math_unparsed" display="inline" id="S1.p5.3.m3.1"><semantics id="S1.p5.3.m3.1a"><mrow id="S1.p5.3.m3.1b"><mn id="S1.p5.3.m3.1.1">1.60</mn><mo id="S1.p5.3.m3.1.2" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="S1.p5.3.m3.1c">1.60\times</annotation><annotation encoding="application/x-llamapun" id="S1.p5.3.m3.1d">1.60 ×</annotation></semantics></math> to <math alttext="2.81\times" class="ltx_math_unparsed" display="inline" id="S1.p5.4.m4.1"><semantics id="S1.p5.4.m4.1a"><mrow id="S1.p5.4.m4.1b"><mn id="S1.p5.4.m4.1.1">2.81</mn><mo id="S1.p5.4.m4.1.2" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="S1.p5.4.m4.1c">2.81\times</annotation><annotation encoding="application/x-llamapun" id="S1.p5.4.m4.1d">2.81 ×</annotation></semantics></math> speedup over FP16 models, and surpasses QuaRot models by <math alttext="1.2\times" class="ltx_math_unparsed" display="inline" id="S1.p5.5.m5.1"><semantics id="S1.p5.5.m5.1a"><mrow id="S1.p5.5.m5.1b"><mn id="S1.p5.5.m5.1.1">1.2</mn><mo id="S1.p5.5.m5.1.2" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="S1.p5.5.m5.1c">1.2\times</annotation><annotation encoding="application/x-llamapun" id="S1.p5.5.m5.1d">1.2 ×</annotation></semantics></math> to <math alttext="1.3\times" class="ltx_math_unparsed" display="inline" id="S1.p5.6.m6.1"><semantics id="S1.p5.6.m6.1a"><mrow id="S1.p5.6.m6.1b"><mn id="S1.p5.6.m6.1.1">1.3</mn><mo id="S1.p5.6.m6.1.2" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="S1.p5.6.m6.1c">1.3\times</annotation><annotation encoding="application/x-llamapun" id="S1.p5.6.m6.1d">1.3 ×</annotation></semantics></math>.
We hope PrefixQuant inspires future developments in LLM compression.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Works</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">In this section, we discuss works related to outliers in LLMs, including quantization methods that enhance performance by eliminating activation outliers.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S2.p2">
<p class="ltx_p" id="S2.p2.1"><span class="ltx_text ltx_font_bold" id="S2.p2.1.1">Channel-Wise Outliers.</span> <cite class="ltx_cite ltx_citemacro_cite">Dettmers et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib11" title="">2022</a>)</cite> identifies that outliers in activation consistently occur in the same channels across different input tokens and proposes isolating these outlier channels with 16-bit precision. Other works, such as Atom&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Zhao et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib43" title="">2023</a>)</cite> and QUIK&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Ashkboos et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib1" title="">2023</a>)</cite>, follow a similar mixed-precision approach to handle outliers. Instead of introducing mixed-precision matrix manipulation, which lacks native hardware support, another line of work addresses outliers through mathematically equivalent transformations. For example, SmoothQuant&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Xiao et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib38" title="">2023a</a>)</cite>, OmniQuant&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Shao et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib29" title="">2023</a>)</cite>, and Outlier Suppression&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Wei et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib35" title="">2022</a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib37" title="">2023b</a>)</cite> mitigate outliers by scaling activations to weights on a channel-wise basis. QLLM&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Liu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib21" title="">2023</a>)</cite> reduces outlier values by dividing each outlier channel into multiple sub-channels. Recently, QuaRot&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Ashkboos et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib3" title="">2024b</a>)</cite> proposed a simple and effective method, random Hadamard rotation, to redistribute outliers across all channels. Building on QuaRot, SpinQuant&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Liu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib22" title="">2024a</a>)</cite> suggests training the orthogonal matrix instead of using a random Hadamard matrix to further enhance performance.
DuQuant&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Lin et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib18" title="">2024a</a>)</cite> leverages channel permutation to evenly distribute outlier to each block and uses block-rotation to smoothen outliers.
Although these methods significantly improve activation quantization performance, they all rely on fine-grained per-token dynamic quantization, which incurs additional overhead to manage token-wise fluctuations.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S2.p3">
<p class="ltx_p" id="S2.p3.1"><span class="ltx_text ltx_font_bold" id="S2.p3.1.1">Token-Wise Outliers.</span> The SoftMax function used in the self-attention mechanism naturally prevents producing zero attention scores. As a result, the model tends to assign unnecessary scores to special tokens, leading to token-wise outliers (or termed as massive activation)&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Sun et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib32" title="">2024</a>; Xiao et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib39" title="">2023b</a>)</cite>. Based on this, StreamingLLM&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Xiao et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib39" title="">2023b</a>)</cite> and LM-infinite&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Han et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib16" title="">2023</a>)</cite> support infinite sequences by retaining the initial token.
Unlike StreamingLLM and LM-infinite, which simply preserve initial tokens in the KV-cache for long-context generation, our PrefixQuant carefully selects prefixed tokens in the KV-cache to isolate outliers for quantization.
Some studies explore eliminating outliers with training techniques. For example, <cite class="ltx_cite ltx_citemacro_cite">Bondarenko et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib5" title="">2024</a>)</cite> allows SoftMax to produce zero values, and <cite class="ltx_cite ltx_citemacro_cite">Sun et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib32" title="">2024</a>)</cite> shows that adding attention bias in the KV cache during training can effectively reduce outliers.
Our PrefixQuant efficiently isolates outlier tokens without needing retraining.
The works closest to our approach are QFeP&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Yang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib40" title="">2024</a>)</cite> and CushionCache&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Son et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib30" title="">2024</a>)</cite>, which also set prefixed tokens in the KV cache. However, CushionCache&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Son et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib30" title="">2024</a>)</cite> takes 12 hours to find the prefixed tokens for Llama-3-8B through a greedy search, while our method completes this process in 12 seconds. QFeP&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Yang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib40" title="">2024</a>)</cite> fixes the outlier token number for all models at 3, which lacks flexibility. Additionally, both QFeP and CushionCache suffer significant performance degradation when using per-tensor static quantization instead of per-token dynamic quantization. Our PrefixQuant is the first to make per-tensor static quantization outperform per-token dynamic quantization.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Preliminaries</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S3.p1">
<p class="ltx_p" id="S3.p1.9">Quantization in LLMs involves weight, activation, and KV cache quantization. Weight quantization&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Chen et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib7" title="">2024a</a>)</cite> and KV cache quantization&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Liu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib23" title="">2024b</a>)</cite> reduce memory usage and speed up memory-bound computations&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Yuan et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib41" title="">2024</a>)</cite>. Combining weight and activation quantization enables low-bit matrix manipulation to accelerate computation-bound tasks&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Yuan et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib41" title="">2024</a>)</cite>. Specifically, the symmetric quantization process is:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{X}_{\texttt{INT}}=\mathrm{clamp}(\lfloor\frac{\mathbf{X}}{\mathbf{s}_{%
\texttt{X}}}\rceil,-2^{N-1},2^{N-1}-1)," class="ltx_math_unparsed" display="block" id="S3.E1.m1.1"><semantics id="S3.E1.m1.1a"><mrow id="S3.E1.m1.1b"><msub id="S3.E1.m1.1.1"><mi id="S3.E1.m1.1.1.2">𝐗</mi><mtext class="ltx_mathvariant_monospace" id="S3.E1.m1.1.1.3">INT</mtext></msub><mo id="S3.E1.m1.1.2">=</mo><mi id="S3.E1.m1.1.3">clamp</mi><mrow id="S3.E1.m1.1.4"><mo id="S3.E1.m1.1.4.1" stretchy="false">(</mo><mrow id="S3.E1.m1.1.4.2"><mo id="S3.E1.m1.1.4.2.1" stretchy="false">⌊</mo><mfrac id="S3.E1.m1.1.4.2.2"><mi id="S3.E1.m1.1.4.2.2.2">𝐗</mi><msub id="S3.E1.m1.1.4.2.2.3"><mi id="S3.E1.m1.1.4.2.2.3.2">𝐬</mi><mtext class="ltx_mathvariant_monospace" id="S3.E1.m1.1.4.2.2.3.3">X</mtext></msub></mfrac><mo id="S3.E1.m1.1.4.2.3" stretchy="false">⌉</mo></mrow><mo id="S3.E1.m1.1.4.3" rspace="0em">,</mo><mo id="S3.E1.m1.1.4.4" lspace="0em">−</mo><msup id="S3.E1.m1.1.4.5"><mn id="S3.E1.m1.1.4.5.2">2</mn><mrow id="S3.E1.m1.1.4.5.3"><mi id="S3.E1.m1.1.4.5.3.2">N</mi><mo id="S3.E1.m1.1.4.5.3.1">−</mo><mn id="S3.E1.m1.1.4.5.3.3">1</mn></mrow></msup><mo id="S3.E1.m1.1.4.6">,</mo><msup id="S3.E1.m1.1.4.7"><mn id="S3.E1.m1.1.4.7.2">2</mn><mrow id="S3.E1.m1.1.4.7.3"><mi id="S3.E1.m1.1.4.7.3.2">N</mi><mo id="S3.E1.m1.1.4.7.3.1">−</mo><mn id="S3.E1.m1.1.4.7.3.3">1</mn></mrow></msup><mo id="S3.E1.m1.1.4.8">−</mo><mn id="S3.E1.m1.1.4.9">1</mn><mo id="S3.E1.m1.1.4.10" stretchy="false">)</mo></mrow><mo id="S3.E1.m1.1.5">,</mo></mrow><annotation encoding="application/x-tex" id="S3.E1.m1.1c">\mathbf{X}_{\texttt{INT}}=\mathrm{clamp}(\lfloor\frac{\mathbf{X}}{\mathbf{s}_{%
\texttt{X}}}\rceil,-2^{N-1},2^{N-1}-1),</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.1d">bold_X start_POSTSUBSCRIPT INT end_POSTSUBSCRIPT = roman_clamp ( ⌊ divide start_ARG bold_X end_ARG start_ARG bold_s start_POSTSUBSCRIPT X end_POSTSUBSCRIPT end_ARG ⌉ , - 2 start_POSTSUPERSCRIPT italic_N - 1 end_POSTSUPERSCRIPT , 2 start_POSTSUPERSCRIPT italic_N - 1 end_POSTSUPERSCRIPT - 1 ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.p1.8">where <math alttext="\lfloor\cdot\rceil" class="ltx_Math" display="inline" id="S3.p1.1.m1.1"><semantics id="S3.p1.1.m1.1a"><mrow id="S3.p1.1.m1.1.2.2" xref="S3.p1.1.m1.1.2.1.cmml"><mo id="S3.p1.1.m1.1.2.2.1" stretchy="false" xref="S3.p1.1.m1.1.2.1.1.cmml">⌊</mo><mo id="S3.p1.1.m1.1.1" lspace="0em" rspace="0em" xref="S3.p1.1.m1.1.1.cmml">⋅</mo><mo id="S3.p1.1.m1.1.2.2.2" stretchy="false" xref="S3.p1.1.m1.1.2.1.1.cmml">⌉</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><apply id="S3.p1.1.m1.1.2.1.cmml" xref="S3.p1.1.m1.1.2.2"><csymbol cd="latexml" id="S3.p1.1.m1.1.2.1.1.cmml" xref="S3.p1.1.m1.1.2.2.1">delimited-⌊⌉</csymbol><ci id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">\lfloor\cdot\rceil</annotation><annotation encoding="application/x-llamapun" id="S3.p1.1.m1.1d">⌊ ⋅ ⌉</annotation></semantics></math> denotes rounding operation, <math alttext="N" class="ltx_Math" display="inline" id="S3.p1.2.m2.1"><semantics id="S3.p1.2.m2.1a"><mi id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><ci id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.p1.2.m2.1d">italic_N</annotation></semantics></math> is the target bit number, <math alttext="\mathbf{X}_{\texttt{INT}}" class="ltx_Math" display="inline" id="S3.p1.3.m3.1"><semantics id="S3.p1.3.m3.1a"><msub id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml"><mi id="S3.p1.3.m3.1.1.2" xref="S3.p1.3.m3.1.1.2.cmml">𝐗</mi><mtext class="ltx_mathvariant_monospace" id="S3.p1.3.m3.1.1.3" xref="S3.p1.3.m3.1.1.3a.cmml">INT</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.1b"><apply id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p1.3.m3.1.1.1.cmml" xref="S3.p1.3.m3.1.1">subscript</csymbol><ci id="S3.p1.3.m3.1.1.2.cmml" xref="S3.p1.3.m3.1.1.2">𝐗</ci><ci id="S3.p1.3.m3.1.1.3a.cmml" xref="S3.p1.3.m3.1.1.3"><mtext class="ltx_mathvariant_monospace" id="S3.p1.3.m3.1.1.3.cmml" mathsize="70%" xref="S3.p1.3.m3.1.1.3">INT</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.1c">\mathbf{X}_{\texttt{INT}}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.3.m3.1d">bold_X start_POSTSUBSCRIPT INT end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{X}" class="ltx_Math" display="inline" id="S3.p1.4.m4.1"><semantics id="S3.p1.4.m4.1a"><mi id="S3.p1.4.m4.1.1" xref="S3.p1.4.m4.1.1.cmml">𝐗</mi><annotation-xml encoding="MathML-Content" id="S3.p1.4.m4.1b"><ci id="S3.p1.4.m4.1.1.cmml" xref="S3.p1.4.m4.1.1">𝐗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m4.1c">\mathbf{X}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.4.m4.1d">bold_X</annotation></semantics></math> are the quantized integer and full-precision activation, respectively. <math alttext="\mathbf{s}_{\texttt{X}}" class="ltx_Math" display="inline" id="S3.p1.5.m5.1"><semantics id="S3.p1.5.m5.1a"><msub id="S3.p1.5.m5.1.1" xref="S3.p1.5.m5.1.1.cmml"><mi id="S3.p1.5.m5.1.1.2" xref="S3.p1.5.m5.1.1.2.cmml">𝐬</mi><mtext class="ltx_mathvariant_monospace" id="S3.p1.5.m5.1.1.3" xref="S3.p1.5.m5.1.1.3a.cmml">X</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.p1.5.m5.1b"><apply id="S3.p1.5.m5.1.1.cmml" xref="S3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.p1.5.m5.1.1.1.cmml" xref="S3.p1.5.m5.1.1">subscript</csymbol><ci id="S3.p1.5.m5.1.1.2.cmml" xref="S3.p1.5.m5.1.1.2">𝐬</ci><ci id="S3.p1.5.m5.1.1.3a.cmml" xref="S3.p1.5.m5.1.1.3"><mtext class="ltx_mathvariant_monospace" id="S3.p1.5.m5.1.1.3.cmml" mathsize="70%" xref="S3.p1.5.m5.1.1.3">X</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.5.m5.1c">\mathbf{s}_{\texttt{X}}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.5.m5.1d">bold_s start_POSTSUBSCRIPT X end_POSTSUBSCRIPT</annotation></semantics></math> is the step size. Full precision weight <math alttext="\mathbf{W}" class="ltx_Math" display="inline" id="S3.p1.6.m6.1"><semantics id="S3.p1.6.m6.1a"><mi id="S3.p1.6.m6.1.1" xref="S3.p1.6.m6.1.1.cmml">𝐖</mi><annotation-xml encoding="MathML-Content" id="S3.p1.6.m6.1b"><ci id="S3.p1.6.m6.1.1.cmml" xref="S3.p1.6.m6.1.1">𝐖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.6.m6.1c">\mathbf{W}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.6.m6.1d">bold_W</annotation></semantics></math> can also be quantized into <math alttext="\mathbf{W}_{\texttt{INT}}" class="ltx_Math" display="inline" id="S3.p1.7.m7.1"><semantics id="S3.p1.7.m7.1a"><msub id="S3.p1.7.m7.1.1" xref="S3.p1.7.m7.1.1.cmml"><mi id="S3.p1.7.m7.1.1.2" xref="S3.p1.7.m7.1.1.2.cmml">𝐖</mi><mtext class="ltx_mathvariant_monospace" id="S3.p1.7.m7.1.1.3" xref="S3.p1.7.m7.1.1.3a.cmml">INT</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.p1.7.m7.1b"><apply id="S3.p1.7.m7.1.1.cmml" xref="S3.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.p1.7.m7.1.1.1.cmml" xref="S3.p1.7.m7.1.1">subscript</csymbol><ci id="S3.p1.7.m7.1.1.2.cmml" xref="S3.p1.7.m7.1.1.2">𝐖</ci><ci id="S3.p1.7.m7.1.1.3a.cmml" xref="S3.p1.7.m7.1.1.3"><mtext class="ltx_mathvariant_monospace" id="S3.p1.7.m7.1.1.3.cmml" mathsize="70%" xref="S3.p1.7.m7.1.1.3">INT</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.7.m7.1c">\mathbf{W}_{\texttt{INT}}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.7.m7.1d">bold_W start_POSTSUBSCRIPT INT end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{s}_{\texttt{W}}" class="ltx_Math" display="inline" id="S3.p1.8.m8.1"><semantics id="S3.p1.8.m8.1a"><msub id="S3.p1.8.m8.1.1" xref="S3.p1.8.m8.1.1.cmml"><mi id="S3.p1.8.m8.1.1.2" xref="S3.p1.8.m8.1.1.2.cmml">𝐬</mi><mtext class="ltx_mathvariant_monospace" id="S3.p1.8.m8.1.1.3" xref="S3.p1.8.m8.1.1.3a.cmml">W</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.p1.8.m8.1b"><apply id="S3.p1.8.m8.1.1.cmml" xref="S3.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.p1.8.m8.1.1.1.cmml" xref="S3.p1.8.m8.1.1">subscript</csymbol><ci id="S3.p1.8.m8.1.1.2.cmml" xref="S3.p1.8.m8.1.1.2">𝐬</ci><ci id="S3.p1.8.m8.1.1.3a.cmml" xref="S3.p1.8.m8.1.1.3"><mtext class="ltx_mathvariant_monospace" id="S3.p1.8.m8.1.1.3.cmml" mathsize="70%" xref="S3.p1.8.m8.1.1.3">W</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.8.m8.1c">\mathbf{s}_{\texttt{W}}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.8.m8.1d">bold_s start_POSTSUBSCRIPT W end_POSTSUBSCRIPT</annotation></semantics></math> similarly. Then, full-precision matrix manipulation transfer into efficient low-bit matrix manipulation:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{X}\mathbf{W}\approx(\mathbf{s}_{\texttt{W}}\cdot\mathbf{s}_{\texttt{X}%
})\cdot\mathbf{X}_{\texttt{INT}}\mathbf{W}_{\texttt{INT}}" class="ltx_Math" display="block" id="S3.E2.m1.1"><semantics id="S3.E2.m1.1a"><mrow id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml"><mi id="S3.E2.m1.1.1.3" xref="S3.E2.m1.1.1.3.cmml">𝐗𝐖</mi><mo id="S3.E2.m1.1.1.2" xref="S3.E2.m1.1.1.2.cmml">≈</mo><mrow id="S3.E2.m1.1.1.1" xref="S3.E2.m1.1.1.1.cmml"><mrow id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml"><mrow id="S3.E2.m1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.cmml"><mo id="S3.E2.m1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E2.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.cmml"><msub id="S3.E2.m1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.2.2" xref="S3.E2.m1.1.1.1.1.1.1.1.2.2.cmml">𝐬</mi><mtext class="ltx_mathvariant_monospace" id="S3.E2.m1.1.1.1.1.1.1.1.2.3" xref="S3.E2.m1.1.1.1.1.1.1.1.2.3a.cmml">W</mtext></msub><mo id="S3.E2.m1.1.1.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.E2.m1.1.1.1.1.1.1.1.1.cmml">⋅</mo><msub id="S3.E2.m1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.3.2" xref="S3.E2.m1.1.1.1.1.1.1.1.3.2.cmml">𝐬</mi><mtext class="ltx_mathvariant_monospace" id="S3.E2.m1.1.1.1.1.1.1.1.3.3" xref="S3.E2.m1.1.1.1.1.1.1.1.3.3a.cmml">X</mtext></msub></mrow><mo id="S3.E2.m1.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.E2.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E2.m1.1.1.1.1.2" rspace="0.222em" xref="S3.E2.m1.1.1.1.1.2.cmml">⋅</mo><msub id="S3.E2.m1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.1.1.1.1.3.2" xref="S3.E2.m1.1.1.1.1.3.2.cmml">𝐗</mi><mtext class="ltx_mathvariant_monospace" id="S3.E2.m1.1.1.1.1.3.3" xref="S3.E2.m1.1.1.1.1.3.3a.cmml">INT</mtext></msub></mrow><mo id="S3.E2.m1.1.1.1.2" xref="S3.E2.m1.1.1.1.2.cmml">⁢</mo><msub id="S3.E2.m1.1.1.1.3" xref="S3.E2.m1.1.1.1.3.cmml"><mi id="S3.E2.m1.1.1.1.3.2" xref="S3.E2.m1.1.1.1.3.2.cmml">𝐖</mi><mtext class="ltx_mathvariant_monospace" id="S3.E2.m1.1.1.1.3.3" xref="S3.E2.m1.1.1.1.3.3a.cmml">INT</mtext></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.1b"><apply id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1"><approx id="S3.E2.m1.1.1.2.cmml" xref="S3.E2.m1.1.1.2"></approx><ci id="S3.E2.m1.1.1.3.cmml" xref="S3.E2.m1.1.1.3">𝐗𝐖</ci><apply id="S3.E2.m1.1.1.1.cmml" xref="S3.E2.m1.1.1.1"><times id="S3.E2.m1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.2"></times><apply id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1"><ci id="S3.E2.m1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.2">⋅</ci><apply id="S3.E2.m1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1"><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1">⋅</ci><apply id="S3.E2.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.2.2">𝐬</ci><ci id="S3.E2.m1.1.1.1.1.1.1.1.2.3a.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.2.3"><mtext class="ltx_mathvariant_monospace" id="S3.E2.m1.1.1.1.1.1.1.1.2.3.cmml" mathsize="70%" xref="S3.E2.m1.1.1.1.1.1.1.1.2.3">W</mtext></ci></apply><apply id="S3.E2.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.3.2">𝐬</ci><ci id="S3.E2.m1.1.1.1.1.1.1.1.3.3a.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.3.3"><mtext class="ltx_mathvariant_monospace" id="S3.E2.m1.1.1.1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S3.E2.m1.1.1.1.1.1.1.1.3.3">X</mtext></ci></apply></apply><apply id="S3.E2.m1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.1.1.3.2">𝐗</ci><ci id="S3.E2.m1.1.1.1.1.3.3a.cmml" xref="S3.E2.m1.1.1.1.1.3.3"><mtext class="ltx_mathvariant_monospace" id="S3.E2.m1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S3.E2.m1.1.1.1.1.3.3">INT</mtext></ci></apply></apply><apply id="S3.E2.m1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.1.3.2">𝐖</ci><ci id="S3.E2.m1.1.1.1.3.3a.cmml" xref="S3.E2.m1.1.1.1.3.3"><mtext class="ltx_mathvariant_monospace" id="S3.E2.m1.1.1.1.3.3.cmml" mathsize="70%" xref="S3.E2.m1.1.1.1.3.3">INT</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.1c">\mathbf{X}\mathbf{W}\approx(\mathbf{s}_{\texttt{W}}\cdot\mathbf{s}_{\texttt{X}%
})\cdot\mathbf{X}_{\texttt{INT}}\mathbf{W}_{\texttt{INT}}</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.1d">bold_XW ≈ ( bold_s start_POSTSUBSCRIPT W end_POSTSUBSCRIPT ⋅ bold_s start_POSTSUBSCRIPT X end_POSTSUBSCRIPT ) ⋅ bold_X start_POSTSUBSCRIPT INT end_POSTSUBSCRIPT bold_W start_POSTSUBSCRIPT INT end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.p2">
<p class="ltx_p" id="S3.p2.2"><span class="ltx_text ltx_font_bold" id="S3.p2.2.1">Granularity.</span> Finer granularity in quantization results in more overhead but less information loss. Per-tensor quantization shares <math alttext="\mathbf{s}" class="ltx_Math" display="inline" id="S3.p2.1.m1.1"><semantics id="S3.p2.1.m1.1a"><mi id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml">𝐬</mi><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.1b"><ci id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1">𝐬</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.1c">\mathbf{s}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.1.m1.1d">bold_s</annotation></semantics></math> across the entire tensor. Per-channel quantization of weight and per-token quantization of activation means <math alttext="\mathbf{s}" class="ltx_Math" display="inline" id="S3.p2.2.m2.1"><semantics id="S3.p2.2.m2.1a"><mi id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml">𝐬</mi><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.1b"><ci id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1">𝐬</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.1c">\mathbf{s}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.2.m2.1d">bold_s</annotation></semantics></math> is shared within each row of the tensor.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.p3">
<p class="ltx_p" id="S3.p3.6"><span class="ltx_text ltx_font_bold" id="S3.p3.6.1">Dynamic and Static.</span>
Activation quantization divides into dynamic and static quantization based on how quantization parameters are calculated. Specifically, dynamic quantization calculates <math alttext="\mathbf{s}_{\texttt{X}}=\frac{\text{max}(|X|)}{2^{N-1}-1}" class="ltx_Math" display="inline" id="S3.p3.1.m1.2"><semantics id="S3.p3.1.m1.2a"><mrow id="S3.p3.1.m1.2.3" xref="S3.p3.1.m1.2.3.cmml"><msub id="S3.p3.1.m1.2.3.2" xref="S3.p3.1.m1.2.3.2.cmml"><mi id="S3.p3.1.m1.2.3.2.2" xref="S3.p3.1.m1.2.3.2.2.cmml">𝐬</mi><mtext class="ltx_mathvariant_monospace" id="S3.p3.1.m1.2.3.2.3" xref="S3.p3.1.m1.2.3.2.3a.cmml">X</mtext></msub><mo id="S3.p3.1.m1.2.3.1" xref="S3.p3.1.m1.2.3.1.cmml">=</mo><mfrac id="S3.p3.1.m1.2.2" xref="S3.p3.1.m1.2.2.cmml"><mrow id="S3.p3.1.m1.2.2.2" xref="S3.p3.1.m1.2.2.2.cmml"><mtext id="S3.p3.1.m1.2.2.2.4" xref="S3.p3.1.m1.2.2.2.4a.cmml">max</mtext><mo id="S3.p3.1.m1.2.2.2.3" xref="S3.p3.1.m1.2.2.2.3.cmml">⁢</mo><mrow id="S3.p3.1.m1.2.2.2.2.1" xref="S3.p3.1.m1.2.2.2.cmml"><mo id="S3.p3.1.m1.2.2.2.2.1.2" stretchy="false" xref="S3.p3.1.m1.2.2.2.cmml">(</mo><mrow id="S3.p3.1.m1.2.2.2.2.1.1.2" xref="S3.p3.1.m1.2.2.2.2.1.1.1.cmml"><mo id="S3.p3.1.m1.2.2.2.2.1.1.2.1" stretchy="false" xref="S3.p3.1.m1.2.2.2.2.1.1.1.1.cmml">|</mo><mi id="S3.p3.1.m1.1.1.1.1" xref="S3.p3.1.m1.1.1.1.1.cmml">X</mi><mo id="S3.p3.1.m1.2.2.2.2.1.1.2.2" stretchy="false" xref="S3.p3.1.m1.2.2.2.2.1.1.1.1.cmml">|</mo></mrow><mo id="S3.p3.1.m1.2.2.2.2.1.3" stretchy="false" xref="S3.p3.1.m1.2.2.2.cmml">)</mo></mrow></mrow><mrow id="S3.p3.1.m1.2.2.4" xref="S3.p3.1.m1.2.2.4.cmml"><msup id="S3.p3.1.m1.2.2.4.2" xref="S3.p3.1.m1.2.2.4.2.cmml"><mn id="S3.p3.1.m1.2.2.4.2.2" xref="S3.p3.1.m1.2.2.4.2.2.cmml">2</mn><mrow id="S3.p3.1.m1.2.2.4.2.3" xref="S3.p3.1.m1.2.2.4.2.3.cmml"><mi id="S3.p3.1.m1.2.2.4.2.3.2" xref="S3.p3.1.m1.2.2.4.2.3.2.cmml">N</mi><mo id="S3.p3.1.m1.2.2.4.2.3.1" xref="S3.p3.1.m1.2.2.4.2.3.1.cmml">−</mo><mn id="S3.p3.1.m1.2.2.4.2.3.3" xref="S3.p3.1.m1.2.2.4.2.3.3.cmml">1</mn></mrow></msup><mo id="S3.p3.1.m1.2.2.4.1" xref="S3.p3.1.m1.2.2.4.1.cmml">−</mo><mn id="S3.p3.1.m1.2.2.4.3" xref="S3.p3.1.m1.2.2.4.3.cmml">1</mn></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.1.m1.2b"><apply id="S3.p3.1.m1.2.3.cmml" xref="S3.p3.1.m1.2.3"><eq id="S3.p3.1.m1.2.3.1.cmml" xref="S3.p3.1.m1.2.3.1"></eq><apply id="S3.p3.1.m1.2.3.2.cmml" xref="S3.p3.1.m1.2.3.2"><csymbol cd="ambiguous" id="S3.p3.1.m1.2.3.2.1.cmml" xref="S3.p3.1.m1.2.3.2">subscript</csymbol><ci id="S3.p3.1.m1.2.3.2.2.cmml" xref="S3.p3.1.m1.2.3.2.2">𝐬</ci><ci id="S3.p3.1.m1.2.3.2.3a.cmml" xref="S3.p3.1.m1.2.3.2.3"><mtext class="ltx_mathvariant_monospace" id="S3.p3.1.m1.2.3.2.3.cmml" mathsize="70%" xref="S3.p3.1.m1.2.3.2.3">X</mtext></ci></apply><apply id="S3.p3.1.m1.2.2.cmml" xref="S3.p3.1.m1.2.2"><divide id="S3.p3.1.m1.2.2.3.cmml" xref="S3.p3.1.m1.2.2"></divide><apply id="S3.p3.1.m1.2.2.2.cmml" xref="S3.p3.1.m1.2.2.2"><times id="S3.p3.1.m1.2.2.2.3.cmml" xref="S3.p3.1.m1.2.2.2.3"></times><ci id="S3.p3.1.m1.2.2.2.4a.cmml" xref="S3.p3.1.m1.2.2.2.4"><mtext id="S3.p3.1.m1.2.2.2.4.cmml" mathsize="70%" xref="S3.p3.1.m1.2.2.2.4">max</mtext></ci><apply id="S3.p3.1.m1.2.2.2.2.1.1.1.cmml" xref="S3.p3.1.m1.2.2.2.2.1.1.2"><abs id="S3.p3.1.m1.2.2.2.2.1.1.1.1.cmml" xref="S3.p3.1.m1.2.2.2.2.1.1.2.1"></abs><ci id="S3.p3.1.m1.1.1.1.1.cmml" xref="S3.p3.1.m1.1.1.1.1">𝑋</ci></apply></apply><apply id="S3.p3.1.m1.2.2.4.cmml" xref="S3.p3.1.m1.2.2.4"><minus id="S3.p3.1.m1.2.2.4.1.cmml" xref="S3.p3.1.m1.2.2.4.1"></minus><apply id="S3.p3.1.m1.2.2.4.2.cmml" xref="S3.p3.1.m1.2.2.4.2"><csymbol cd="ambiguous" id="S3.p3.1.m1.2.2.4.2.1.cmml" xref="S3.p3.1.m1.2.2.4.2">superscript</csymbol><cn id="S3.p3.1.m1.2.2.4.2.2.cmml" type="integer" xref="S3.p3.1.m1.2.2.4.2.2">2</cn><apply id="S3.p3.1.m1.2.2.4.2.3.cmml" xref="S3.p3.1.m1.2.2.4.2.3"><minus id="S3.p3.1.m1.2.2.4.2.3.1.cmml" xref="S3.p3.1.m1.2.2.4.2.3.1"></minus><ci id="S3.p3.1.m1.2.2.4.2.3.2.cmml" xref="S3.p3.1.m1.2.2.4.2.3.2">𝑁</ci><cn id="S3.p3.1.m1.2.2.4.2.3.3.cmml" type="integer" xref="S3.p3.1.m1.2.2.4.2.3.3">1</cn></apply></apply><cn id="S3.p3.1.m1.2.2.4.3.cmml" type="integer" xref="S3.p3.1.m1.2.2.4.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.1.m1.2c">\mathbf{s}_{\texttt{X}}=\frac{\text{max}(|X|)}{2^{N-1}-1}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.1.m1.2d">bold_s start_POSTSUBSCRIPT X end_POSTSUBSCRIPT = divide start_ARG max ( | italic_X | ) end_ARG start_ARG 2 start_POSTSUPERSCRIPT italic_N - 1 end_POSTSUPERSCRIPT - 1 end_ARG</annotation></semantics></math> during inference, offering better adaptability to different distributions. In contrast, static quantization precomputes <math alttext="\mathbf{s}_{\texttt{X}}" class="ltx_Math" display="inline" id="S3.p3.2.m2.1"><semantics id="S3.p3.2.m2.1a"><msub id="S3.p3.2.m2.1.1" xref="S3.p3.2.m2.1.1.cmml"><mi id="S3.p3.2.m2.1.1.2" xref="S3.p3.2.m2.1.1.2.cmml">𝐬</mi><mtext class="ltx_mathvariant_monospace" id="S3.p3.2.m2.1.1.3" xref="S3.p3.2.m2.1.1.3a.cmml">X</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.p3.2.m2.1b"><apply id="S3.p3.2.m2.1.1.cmml" xref="S3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p3.2.m2.1.1.1.cmml" xref="S3.p3.2.m2.1.1">subscript</csymbol><ci id="S3.p3.2.m2.1.1.2.cmml" xref="S3.p3.2.m2.1.1.2">𝐬</ci><ci id="S3.p3.2.m2.1.1.3a.cmml" xref="S3.p3.2.m2.1.1.3"><mtext class="ltx_mathvariant_monospace" id="S3.p3.2.m2.1.1.3.cmml" mathsize="70%" xref="S3.p3.2.m2.1.1.3">X</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.2.m2.1c">\mathbf{s}_{\texttt{X}}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.2.m2.1d">bold_s start_POSTSUBSCRIPT X end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="(\mathbf{s}_{\texttt{W}}\cdot\mathbf{s}_{\texttt{X}})" class="ltx_Math" display="inline" id="S3.p3.3.m3.1"><semantics id="S3.p3.3.m3.1a"><mrow id="S3.p3.3.m3.1.1.1" xref="S3.p3.3.m3.1.1.1.1.cmml"><mo id="S3.p3.3.m3.1.1.1.2" stretchy="false" xref="S3.p3.3.m3.1.1.1.1.cmml">(</mo><mrow id="S3.p3.3.m3.1.1.1.1" xref="S3.p3.3.m3.1.1.1.1.cmml"><msub id="S3.p3.3.m3.1.1.1.1.2" xref="S3.p3.3.m3.1.1.1.1.2.cmml"><mi id="S3.p3.3.m3.1.1.1.1.2.2" xref="S3.p3.3.m3.1.1.1.1.2.2.cmml">𝐬</mi><mtext class="ltx_mathvariant_monospace" id="S3.p3.3.m3.1.1.1.1.2.3" xref="S3.p3.3.m3.1.1.1.1.2.3a.cmml">W</mtext></msub><mo id="S3.p3.3.m3.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.p3.3.m3.1.1.1.1.1.cmml">⋅</mo><msub id="S3.p3.3.m3.1.1.1.1.3" xref="S3.p3.3.m3.1.1.1.1.3.cmml"><mi id="S3.p3.3.m3.1.1.1.1.3.2" xref="S3.p3.3.m3.1.1.1.1.3.2.cmml">𝐬</mi><mtext class="ltx_mathvariant_monospace" id="S3.p3.3.m3.1.1.1.1.3.3" xref="S3.p3.3.m3.1.1.1.1.3.3a.cmml">X</mtext></msub></mrow><mo id="S3.p3.3.m3.1.1.1.3" stretchy="false" xref="S3.p3.3.m3.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.3.m3.1b"><apply id="S3.p3.3.m3.1.1.1.1.cmml" xref="S3.p3.3.m3.1.1.1"><ci id="S3.p3.3.m3.1.1.1.1.1.cmml" xref="S3.p3.3.m3.1.1.1.1.1">⋅</ci><apply id="S3.p3.3.m3.1.1.1.1.2.cmml" xref="S3.p3.3.m3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.p3.3.m3.1.1.1.1.2.1.cmml" xref="S3.p3.3.m3.1.1.1.1.2">subscript</csymbol><ci id="S3.p3.3.m3.1.1.1.1.2.2.cmml" xref="S3.p3.3.m3.1.1.1.1.2.2">𝐬</ci><ci id="S3.p3.3.m3.1.1.1.1.2.3a.cmml" xref="S3.p3.3.m3.1.1.1.1.2.3"><mtext class="ltx_mathvariant_monospace" id="S3.p3.3.m3.1.1.1.1.2.3.cmml" mathsize="70%" xref="S3.p3.3.m3.1.1.1.1.2.3">W</mtext></ci></apply><apply id="S3.p3.3.m3.1.1.1.1.3.cmml" xref="S3.p3.3.m3.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.p3.3.m3.1.1.1.1.3.1.cmml" xref="S3.p3.3.m3.1.1.1.1.3">subscript</csymbol><ci id="S3.p3.3.m3.1.1.1.1.3.2.cmml" xref="S3.p3.3.m3.1.1.1.1.3.2">𝐬</ci><ci id="S3.p3.3.m3.1.1.1.1.3.3a.cmml" xref="S3.p3.3.m3.1.1.1.1.3.3"><mtext class="ltx_mathvariant_monospace" id="S3.p3.3.m3.1.1.1.1.3.3.cmml" mathsize="70%" xref="S3.p3.3.m3.1.1.1.1.3.3">X</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.3.m3.1c">(\mathbf{s}_{\texttt{W}}\cdot\mathbf{s}_{\texttt{X}})</annotation><annotation encoding="application/x-llamapun" id="S3.p3.3.m3.1d">( bold_s start_POSTSUBSCRIPT W end_POSTSUBSCRIPT ⋅ bold_s start_POSTSUBSCRIPT X end_POSTSUBSCRIPT )</annotation></semantics></math> in Eq.(<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#S3.E2" title="In 3 Preliminaries ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">2</span></a>) offline, leading to more efficient inference and more feasible operator fusion&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Nagel et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib25" title="">2021</a>)</cite>. Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A3.T8.st2" title="In Table 8 ‣ Appendix C Details of Rotation ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">8(b)</span></a> shows that the overhead of static quantization is nearly <math alttext="3\times" class="ltx_math_unparsed" display="inline" id="S3.p3.4.m4.1"><semantics id="S3.p3.4.m4.1a"><mrow id="S3.p3.4.m4.1b"><mn id="S3.p3.4.m4.1.1">3</mn><mo id="S3.p3.4.m4.1.2" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="S3.p3.4.m4.1c">3\times</annotation><annotation encoding="application/x-llamapun" id="S3.p3.4.m4.1d">3 ×</annotation></semantics></math> lower than dynamic quantization. Additionally, we initialize both <math alttext="\mathbf{s}_{\texttt{W}}" class="ltx_Math" display="inline" id="S3.p3.5.m5.1"><semantics id="S3.p3.5.m5.1a"><msub id="S3.p3.5.m5.1.1" xref="S3.p3.5.m5.1.1.cmml"><mi id="S3.p3.5.m5.1.1.2" xref="S3.p3.5.m5.1.1.2.cmml">𝐬</mi><mtext class="ltx_mathvariant_monospace" id="S3.p3.5.m5.1.1.3" xref="S3.p3.5.m5.1.1.3a.cmml">W</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.p3.5.m5.1b"><apply id="S3.p3.5.m5.1.1.cmml" xref="S3.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.p3.5.m5.1.1.1.cmml" xref="S3.p3.5.m5.1.1">subscript</csymbol><ci id="S3.p3.5.m5.1.1.2.cmml" xref="S3.p3.5.m5.1.1.2">𝐬</ci><ci id="S3.p3.5.m5.1.1.3a.cmml" xref="S3.p3.5.m5.1.1.3"><mtext class="ltx_mathvariant_monospace" id="S3.p3.5.m5.1.1.3.cmml" mathsize="70%" xref="S3.p3.5.m5.1.1.3">W</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.5.m5.1c">\mathbf{s}_{\texttt{W}}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.5.m5.1d">bold_s start_POSTSUBSCRIPT W end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{s}_{\texttt{X}}" class="ltx_Math" display="inline" id="S3.p3.6.m6.1"><semantics id="S3.p3.6.m6.1a"><msub id="S3.p3.6.m6.1.1" xref="S3.p3.6.m6.1.1.cmml"><mi id="S3.p3.6.m6.1.1.2" xref="S3.p3.6.m6.1.1.2.cmml">𝐬</mi><mtext class="ltx_mathvariant_monospace" id="S3.p3.6.m6.1.1.3" xref="S3.p3.6.m6.1.1.3a.cmml">X</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.p3.6.m6.1b"><apply id="S3.p3.6.m6.1.1.cmml" xref="S3.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S3.p3.6.m6.1.1.1.cmml" xref="S3.p3.6.m6.1.1">subscript</csymbol><ci id="S3.p3.6.m6.1.1.2.cmml" xref="S3.p3.6.m6.1.1.2">𝐬</ci><ci id="S3.p3.6.m6.1.1.3a.cmml" xref="S3.p3.6.m6.1.1.3"><mtext class="ltx_mathvariant_monospace" id="S3.p3.6.m6.1.1.3.cmml" mathsize="70%" xref="S3.p3.6.m6.1.1.3">X</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.6.m6.1c">\mathbf{s}_{\texttt{X}}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.6.m6.1d">bold_s start_POSTSUBSCRIPT X end_POSTSUBSCRIPT</annotation></semantics></math> through grid search&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Lin et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib19" title="">2023</a>; Gong et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib15" title="">2024</a>)</cite> on a small calibration dataset for all experiments with static quantization.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S3.p4">
<p class="ltx_p" id="S3.p4.1"><span class="ltx_text ltx_font_bold" id="S3.p4.1.1">Hadamard Rotation.</span>
Random Hadamard rotation&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Ashkboos et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib3" title="">2024b</a>; Liu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib22" title="">2024a</a>)</cite> addresses channel-wise outliers. Our method focus on removing token-wise outliers. Therefore, We build our method upon the Hadamard rotation technique, and the detailed is provided in Sec.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A3" title="Appendix C Details of Rotation ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">C</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="S3.F2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F2.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="142" id="S3.F2.sf1.g1" src="https://arxiv.org/html/2410.05265v1/x2.png" width="685">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span>Original distribution</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F2.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="125" id="S3.F2.sf2.g1" src="https://arxiv.org/html/2410.05265v1/x3.png" width="685">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span>Rotation</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F2.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="125" id="S3.F2.sf3.g1" src="https://arxiv.org/html/2410.05265v1/x4.png" width="685">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(c) </span>PrefixQuant (ours)</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span><span class="ltx_text ltx_font_bold" id="S3.F2.10.1">Distribution of token-wise maximum values for linear layers inputs in Llama-2-7B.</span> Top-<math alttext="N" class="ltx_Math" display="inline" id="S3.F2.5.m1.1"><semantics id="S3.F2.5.m1.1b"><mi id="S3.F2.5.m1.1.1" xref="S3.F2.5.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.F2.5.m1.1c"><ci id="S3.F2.5.m1.1.1.cmml" xref="S3.F2.5.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.5.m1.1d">N</annotation><annotation encoding="application/x-llamapun" id="S3.F2.5.m1.1e">italic_N</annotation></semantics></math> indicates the <math alttext="N" class="ltx_Math" display="inline" id="S3.F2.6.m2.1"><semantics id="S3.F2.6.m2.1b"><mi id="S3.F2.6.m2.1.1" xref="S3.F2.6.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.F2.6.m2.1c"><ci id="S3.F2.6.m2.1.1.cmml" xref="S3.F2.6.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.6.m2.1d">N</annotation><annotation encoding="application/x-llamapun" id="S3.F2.6.m2.1e">italic_N</annotation></semantics></math>-th largest value, Min-<math alttext="N" class="ltx_Math" display="inline" id="S3.F2.7.m3.1"><semantics id="S3.F2.7.m3.1b"><mi id="S3.F2.7.m3.1.1" xref="S3.F2.7.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.F2.7.m3.1c"><ci id="S3.F2.7.m3.1.1.cmml" xref="S3.F2.7.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.7.m3.1d">N</annotation><annotation encoding="application/x-llamapun" id="S3.F2.7.m3.1e">italic_N</annotation></semantics></math> indicates the <math alttext="N" class="ltx_Math" display="inline" id="S3.F2.8.m4.1"><semantics id="S3.F2.8.m4.1b"><mi id="S3.F2.8.m4.1.1" xref="S3.F2.8.m4.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.F2.8.m4.1c"><ci id="S3.F2.8.m4.1.1.cmml" xref="S3.F2.8.m4.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.8.m4.1d">N</annotation><annotation encoding="application/x-llamapun" id="S3.F2.8.m4.1e">italic_N</annotation></semantics></math>-th smallest value. We also report the maximum ratio between Top-1 value and median value, as well as the maximum ratio between median value and Min-1 value (Ratios greater than 10 are marked with red, and the rest are green). Lower ratio indicate similar maximum values across different tokens, leading compatibility with per-tensor static activation quantization.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Difficulty of Static Quantization</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">Both channel-wise and token-wise outliers can cause information loss during quantization. While channel-wise outliers have been thoroughly explored and addressed in prior research&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Ashkboos et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib3" title="">2024b</a>)</cite>, this discussion focuses on token-wise outliers, which occur within specific tokens.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S4.p2">
<p class="ltx_p" id="S4.p2.12">Let <math alttext="\mathbf{X}\in\mathbb{R}^{T\times C}" class="ltx_Math" display="inline" id="S4.p2.1.m1.1"><semantics id="S4.p2.1.m1.1a"><mrow id="S4.p2.1.m1.1.1" xref="S4.p2.1.m1.1.1.cmml"><mi id="S4.p2.1.m1.1.1.2" xref="S4.p2.1.m1.1.1.2.cmml">𝐗</mi><mo id="S4.p2.1.m1.1.1.1" xref="S4.p2.1.m1.1.1.1.cmml">∈</mo><msup id="S4.p2.1.m1.1.1.3" xref="S4.p2.1.m1.1.1.3.cmml"><mi id="S4.p2.1.m1.1.1.3.2" xref="S4.p2.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S4.p2.1.m1.1.1.3.3" xref="S4.p2.1.m1.1.1.3.3.cmml"><mi id="S4.p2.1.m1.1.1.3.3.2" xref="S4.p2.1.m1.1.1.3.3.2.cmml">T</mi><mo id="S4.p2.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.p2.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S4.p2.1.m1.1.1.3.3.3" xref="S4.p2.1.m1.1.1.3.3.3.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.1.m1.1b"><apply id="S4.p2.1.m1.1.1.cmml" xref="S4.p2.1.m1.1.1"><in id="S4.p2.1.m1.1.1.1.cmml" xref="S4.p2.1.m1.1.1.1"></in><ci id="S4.p2.1.m1.1.1.2.cmml" xref="S4.p2.1.m1.1.1.2">𝐗</ci><apply id="S4.p2.1.m1.1.1.3.cmml" xref="S4.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.p2.1.m1.1.1.3.1.cmml" xref="S4.p2.1.m1.1.1.3">superscript</csymbol><ci id="S4.p2.1.m1.1.1.3.2.cmml" xref="S4.p2.1.m1.1.1.3.2">ℝ</ci><apply id="S4.p2.1.m1.1.1.3.3.cmml" xref="S4.p2.1.m1.1.1.3.3"><times id="S4.p2.1.m1.1.1.3.3.1.cmml" xref="S4.p2.1.m1.1.1.3.3.1"></times><ci id="S4.p2.1.m1.1.1.3.3.2.cmml" xref="S4.p2.1.m1.1.1.3.3.2">𝑇</ci><ci id="S4.p2.1.m1.1.1.3.3.3.cmml" xref="S4.p2.1.m1.1.1.3.3.3">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.1.m1.1c">\mathbf{X}\in\mathbb{R}^{T\times C}</annotation><annotation encoding="application/x-llamapun" id="S4.p2.1.m1.1d">bold_X ∈ blackboard_R start_POSTSUPERSCRIPT italic_T × italic_C end_POSTSUPERSCRIPT</annotation></semantics></math> represent the token sequence, with <math alttext="T" class="ltx_Math" display="inline" id="S4.p2.2.m2.1"><semantics id="S4.p2.2.m2.1a"><mi id="S4.p2.2.m2.1.1" xref="S4.p2.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.p2.2.m2.1b"><ci id="S4.p2.2.m2.1.1.cmml" xref="S4.p2.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.2.m2.1c">T</annotation><annotation encoding="application/x-llamapun" id="S4.p2.2.m2.1d">italic_T</annotation></semantics></math> tokens and a dimension size of <math alttext="C" class="ltx_Math" display="inline" id="S4.p2.3.m3.1"><semantics id="S4.p2.3.m3.1a"><mi id="S4.p2.3.m3.1.1" xref="S4.p2.3.m3.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.p2.3.m3.1b"><ci id="S4.p2.3.m3.1.1.cmml" xref="S4.p2.3.m3.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.3.m3.1c">C</annotation><annotation encoding="application/x-llamapun" id="S4.p2.3.m3.1d">italic_C</annotation></semantics></math>. We calculate token-wise maximum values <math alttext="\mathbf{M}\in\mathbb{R}^{T}" class="ltx_Math" display="inline" id="S4.p2.4.m4.1"><semantics id="S4.p2.4.m4.1a"><mrow id="S4.p2.4.m4.1.1" xref="S4.p2.4.m4.1.1.cmml"><mi id="S4.p2.4.m4.1.1.2" xref="S4.p2.4.m4.1.1.2.cmml">𝐌</mi><mo id="S4.p2.4.m4.1.1.1" xref="S4.p2.4.m4.1.1.1.cmml">∈</mo><msup id="S4.p2.4.m4.1.1.3" xref="S4.p2.4.m4.1.1.3.cmml"><mi id="S4.p2.4.m4.1.1.3.2" xref="S4.p2.4.m4.1.1.3.2.cmml">ℝ</mi><mi id="S4.p2.4.m4.1.1.3.3" xref="S4.p2.4.m4.1.1.3.3.cmml">T</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.4.m4.1b"><apply id="S4.p2.4.m4.1.1.cmml" xref="S4.p2.4.m4.1.1"><in id="S4.p2.4.m4.1.1.1.cmml" xref="S4.p2.4.m4.1.1.1"></in><ci id="S4.p2.4.m4.1.1.2.cmml" xref="S4.p2.4.m4.1.1.2">𝐌</ci><apply id="S4.p2.4.m4.1.1.3.cmml" xref="S4.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="S4.p2.4.m4.1.1.3.1.cmml" xref="S4.p2.4.m4.1.1.3">superscript</csymbol><ci id="S4.p2.4.m4.1.1.3.2.cmml" xref="S4.p2.4.m4.1.1.3.2">ℝ</ci><ci id="S4.p2.4.m4.1.1.3.3.cmml" xref="S4.p2.4.m4.1.1.3.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.4.m4.1c">\mathbf{M}\in\mathbb{R}^{T}</annotation><annotation encoding="application/x-llamapun" id="S4.p2.4.m4.1d">bold_M ∈ blackboard_R start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math>, indicating the maximum value of each token.
Per-tensor static quantization uses one pre-computed scale for all tokens. If the token-wise maximum values <math alttext="\mathbf{M}" class="ltx_Math" display="inline" id="S4.p2.5.m5.1"><semantics id="S4.p2.5.m5.1a"><mi id="S4.p2.5.m5.1.1" xref="S4.p2.5.m5.1.1.cmml">𝐌</mi><annotation-xml encoding="MathML-Content" id="S4.p2.5.m5.1b"><ci id="S4.p2.5.m5.1.1.cmml" xref="S4.p2.5.m5.1.1">𝐌</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.5.m5.1c">\mathbf{M}</annotation><annotation encoding="application/x-llamapun" id="S4.p2.5.m5.1d">bold_M</annotation></semantics></math> vary significantly across tokens, this can lead to substantial information loss after per-tensor static quantization. To analyze the distribution of token-wise maximum values <math alttext="\mathbf{M}" class="ltx_Math" display="inline" id="S4.p2.6.m6.1"><semantics id="S4.p2.6.m6.1a"><mi id="S4.p2.6.m6.1.1" xref="S4.p2.6.m6.1.1.cmml">𝐌</mi><annotation-xml encoding="MathML-Content" id="S4.p2.6.m6.1b"><ci id="S4.p2.6.m6.1.1.cmml" xref="S4.p2.6.m6.1.1">𝐌</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.6.m6.1c">\mathbf{M}</annotation><annotation encoding="application/x-llamapun" id="S4.p2.6.m6.1d">bold_M</annotation></semantics></math> and understand the challenges for per-tensor static quantization, we define top-1, median, and min-1 as the largest, median, and smallest values of <math alttext="\mathbf{M}" class="ltx_Math" display="inline" id="S4.p2.7.m7.1"><semantics id="S4.p2.7.m7.1a"><mi id="S4.p2.7.m7.1.1" xref="S4.p2.7.m7.1.1.cmml">𝐌</mi><annotation-xml encoding="MathML-Content" id="S4.p2.7.m7.1b"><ci id="S4.p2.7.m7.1.1.cmml" xref="S4.p2.7.m7.1.1">𝐌</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.7.m7.1c">\mathbf{M}</annotation><annotation encoding="application/x-llamapun" id="S4.p2.7.m7.1d">bold_M</annotation></semantics></math>, respectively. We then measure discrepancies using the ratios <math alttext="\frac{\text{top-1}}{\text{median}}" class="ltx_Math" display="inline" id="S4.p2.8.m8.1"><semantics id="S4.p2.8.m8.1a"><mfrac id="S4.p2.8.m8.1.1" xref="S4.p2.8.m8.1.1.cmml"><mtext id="S4.p2.8.m8.1.1.2" xref="S4.p2.8.m8.1.1.2a.cmml">top-1</mtext><mtext id="S4.p2.8.m8.1.1.3" xref="S4.p2.8.m8.1.1.3a.cmml">median</mtext></mfrac><annotation-xml encoding="MathML-Content" id="S4.p2.8.m8.1b"><apply id="S4.p2.8.m8.1.1.cmml" xref="S4.p2.8.m8.1.1"><divide id="S4.p2.8.m8.1.1.1.cmml" xref="S4.p2.8.m8.1.1"></divide><ci id="S4.p2.8.m8.1.1.2a.cmml" xref="S4.p2.8.m8.1.1.2"><mtext id="S4.p2.8.m8.1.1.2.cmml" mathsize="70%" xref="S4.p2.8.m8.1.1.2">top-1</mtext></ci><ci id="S4.p2.8.m8.1.1.3a.cmml" xref="S4.p2.8.m8.1.1.3"><mtext id="S4.p2.8.m8.1.1.3.cmml" mathsize="70%" xref="S4.p2.8.m8.1.1.3">median</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.8.m8.1c">\frac{\text{top-1}}{\text{median}}</annotation><annotation encoding="application/x-llamapun" id="S4.p2.8.m8.1d">divide start_ARG top-1 end_ARG start_ARG median end_ARG</annotation></semantics></math> and <math alttext="\frac{\text{median}}{\text{min-1}}" class="ltx_Math" display="inline" id="S4.p2.9.m9.1"><semantics id="S4.p2.9.m9.1a"><mfrac id="S4.p2.9.m9.1.1" xref="S4.p2.9.m9.1.1.cmml"><mtext id="S4.p2.9.m9.1.1.2" xref="S4.p2.9.m9.1.1.2a.cmml">median</mtext><mtext id="S4.p2.9.m9.1.1.3" xref="S4.p2.9.m9.1.1.3a.cmml">min-1</mtext></mfrac><annotation-xml encoding="MathML-Content" id="S4.p2.9.m9.1b"><apply id="S4.p2.9.m9.1.1.cmml" xref="S4.p2.9.m9.1.1"><divide id="S4.p2.9.m9.1.1.1.cmml" xref="S4.p2.9.m9.1.1"></divide><ci id="S4.p2.9.m9.1.1.2a.cmml" xref="S4.p2.9.m9.1.1.2"><mtext id="S4.p2.9.m9.1.1.2.cmml" mathsize="70%" xref="S4.p2.9.m9.1.1.2">median</mtext></ci><ci id="S4.p2.9.m9.1.1.3a.cmml" xref="S4.p2.9.m9.1.1.3"><mtext id="S4.p2.9.m9.1.1.3.cmml" mathsize="70%" xref="S4.p2.9.m9.1.1.3">min-1</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.9.m9.1c">\frac{\text{median}}{\text{min-1}}</annotation><annotation encoding="application/x-llamapun" id="S4.p2.9.m9.1d">divide start_ARG median end_ARG start_ARG min-1 end_ARG</annotation></semantics></math>.
Specifically, a larger <math alttext="\frac{\text{top-1}}{\text{median}}" class="ltx_Math" display="inline" id="S4.p2.10.m10.1"><semantics id="S4.p2.10.m10.1a"><mfrac id="S4.p2.10.m10.1.1" xref="S4.p2.10.m10.1.1.cmml"><mtext id="S4.p2.10.m10.1.1.2" xref="S4.p2.10.m10.1.1.2a.cmml">top-1</mtext><mtext id="S4.p2.10.m10.1.1.3" xref="S4.p2.10.m10.1.1.3a.cmml">median</mtext></mfrac><annotation-xml encoding="MathML-Content" id="S4.p2.10.m10.1b"><apply id="S4.p2.10.m10.1.1.cmml" xref="S4.p2.10.m10.1.1"><divide id="S4.p2.10.m10.1.1.1.cmml" xref="S4.p2.10.m10.1.1"></divide><ci id="S4.p2.10.m10.1.1.2a.cmml" xref="S4.p2.10.m10.1.1.2"><mtext id="S4.p2.10.m10.1.1.2.cmml" mathsize="70%" xref="S4.p2.10.m10.1.1.2">top-1</mtext></ci><ci id="S4.p2.10.m10.1.1.3a.cmml" xref="S4.p2.10.m10.1.1.3"><mtext id="S4.p2.10.m10.1.1.3.cmml" mathsize="70%" xref="S4.p2.10.m10.1.1.3">median</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.10.m10.1c">\frac{\text{top-1}}{\text{median}}</annotation><annotation encoding="application/x-llamapun" id="S4.p2.10.m10.1d">divide start_ARG top-1 end_ARG start_ARG median end_ARG</annotation></semantics></math> indicates upper outliers, while a larger <math alttext="\frac{\text{median}}{\text{min-1}}" class="ltx_Math" display="inline" id="S4.p2.11.m11.1"><semantics id="S4.p2.11.m11.1a"><mfrac id="S4.p2.11.m11.1.1" xref="S4.p2.11.m11.1.1.cmml"><mtext id="S4.p2.11.m11.1.1.2" xref="S4.p2.11.m11.1.1.2a.cmml">median</mtext><mtext id="S4.p2.11.m11.1.1.3" xref="S4.p2.11.m11.1.1.3a.cmml">min-1</mtext></mfrac><annotation-xml encoding="MathML-Content" id="S4.p2.11.m11.1b"><apply id="S4.p2.11.m11.1.1.cmml" xref="S4.p2.11.m11.1.1"><divide id="S4.p2.11.m11.1.1.1.cmml" xref="S4.p2.11.m11.1.1"></divide><ci id="S4.p2.11.m11.1.1.2a.cmml" xref="S4.p2.11.m11.1.1.2"><mtext id="S4.p2.11.m11.1.1.2.cmml" mathsize="70%" xref="S4.p2.11.m11.1.1.2">median</mtext></ci><ci id="S4.p2.11.m11.1.1.3a.cmml" xref="S4.p2.11.m11.1.1.3"><mtext id="S4.p2.11.m11.1.1.3.cmml" mathsize="70%" xref="S4.p2.11.m11.1.1.3">min-1</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.11.m11.1c">\frac{\text{median}}{\text{min-1}}</annotation><annotation encoding="application/x-llamapun" id="S4.p2.11.m11.1d">divide start_ARG median end_ARG start_ARG min-1 end_ARG</annotation></semantics></math> represents lower outliers. Both ratios highlight the variability in <math alttext="\mathbf{M}" class="ltx_Math" display="inline" id="S4.p2.12.m12.1"><semantics id="S4.p2.12.m12.1a"><mi id="S4.p2.12.m12.1.1" xref="S4.p2.12.m12.1.1.cmml">𝐌</mi><annotation-xml encoding="MathML-Content" id="S4.p2.12.m12.1b"><ci id="S4.p2.12.m12.1.1.cmml" xref="S4.p2.12.m12.1.1">𝐌</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.12.m12.1c">\mathbf{M}</annotation><annotation encoding="application/x-llamapun" id="S4.p2.12.m12.1d">bold_M</annotation></semantics></math>.
Specifically, we identify the following patterns that motivate our method.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S4.p3">
<p class="ltx_p" id="S4.p3.1"><span class="ltx_text ltx_font_bold" id="S4.p3.1.1">1. Upper Outlier Tokens in Inputs.</span> As shown in Figure&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#S3.F2.sf1" title="In Figure 2 ‣ 3 Preliminaries ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">2(a)</span></a>, the input activation of down_proj layers exhibits significant outliers with <math alttext="\frac{\text{top-1}}{\text{median}}=4127" class="ltx_Math" display="inline" id="S4.p3.1.m1.1"><semantics id="S4.p3.1.m1.1a"><mrow id="S4.p3.1.m1.1.1" xref="S4.p3.1.m1.1.1.cmml"><mfrac id="S4.p3.1.m1.1.1.2" xref="S4.p3.1.m1.1.1.2.cmml"><mtext id="S4.p3.1.m1.1.1.2.2" xref="S4.p3.1.m1.1.1.2.2a.cmml">top-1</mtext><mtext id="S4.p3.1.m1.1.1.2.3" xref="S4.p3.1.m1.1.1.2.3a.cmml">median</mtext></mfrac><mo id="S4.p3.1.m1.1.1.1" xref="S4.p3.1.m1.1.1.1.cmml">=</mo><mn id="S4.p3.1.m1.1.1.3" xref="S4.p3.1.m1.1.1.3.cmml">4127</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p3.1.m1.1b"><apply id="S4.p3.1.m1.1.1.cmml" xref="S4.p3.1.m1.1.1"><eq id="S4.p3.1.m1.1.1.1.cmml" xref="S4.p3.1.m1.1.1.1"></eq><apply id="S4.p3.1.m1.1.1.2.cmml" xref="S4.p3.1.m1.1.1.2"><divide id="S4.p3.1.m1.1.1.2.1.cmml" xref="S4.p3.1.m1.1.1.2"></divide><ci id="S4.p3.1.m1.1.1.2.2a.cmml" xref="S4.p3.1.m1.1.1.2.2"><mtext id="S4.p3.1.m1.1.1.2.2.cmml" mathsize="70%" xref="S4.p3.1.m1.1.1.2.2">top-1</mtext></ci><ci id="S4.p3.1.m1.1.1.2.3a.cmml" xref="S4.p3.1.m1.1.1.2.3"><mtext id="S4.p3.1.m1.1.1.2.3.cmml" mathsize="70%" xref="S4.p3.1.m1.1.1.2.3">median</mtext></ci></apply><cn id="S4.p3.1.m1.1.1.3.cmml" type="integer" xref="S4.p3.1.m1.1.1.3">4127</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.1.m1.1c">\frac{\text{top-1}}{\text{median}}=4127</annotation><annotation encoding="application/x-llamapun" id="S4.p3.1.m1.1d">divide start_ARG top-1 end_ARG start_ARG median end_ARG = 4127</annotation></semantics></math>. Although Hadamard rotation (Figure&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#S3.F2.sf2" title="In Figure 2 ‣ 3 Preliminaries ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">2(b)</span></a>) reduces the ratio to 478, it remains impractical to share a quantization scaling factor across tokens due to the large gap in maximum values.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S4.p4">
<p class="ltx_p" id="S4.p4.14"><span class="ltx_text ltx_font_bold" id="S4.p4.3.3">2. Lower Outlier Tokens in <math alttext="\mathbf{Q}" class="ltx_Math" display="inline" id="S4.p4.1.1.m1.1"><semantics id="S4.p4.1.1.m1.1a"><mi id="S4.p4.1.1.m1.1.1" xref="S4.p4.1.1.m1.1.1.cmml">𝐐</mi><annotation-xml encoding="MathML-Content" id="S4.p4.1.1.m1.1b"><ci id="S4.p4.1.1.m1.1.1.cmml" xref="S4.p4.1.1.m1.1.1">𝐐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.1.1.m1.1c">\mathbf{Q}</annotation><annotation encoding="application/x-llamapun" id="S4.p4.1.1.m1.1d">bold_Q</annotation></semantics></math>/<math alttext="\mathbf{K}" class="ltx_Math" display="inline" id="S4.p4.2.2.m2.1"><semantics id="S4.p4.2.2.m2.1a"><mi id="S4.p4.2.2.m2.1.1" xref="S4.p4.2.2.m2.1.1.cmml">𝐊</mi><annotation-xml encoding="MathML-Content" id="S4.p4.2.2.m2.1b"><ci id="S4.p4.2.2.m2.1.1.cmml" xref="S4.p4.2.2.m2.1.1">𝐊</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.2.2.m2.1c">\mathbf{K}</annotation><annotation encoding="application/x-llamapun" id="S4.p4.2.2.m2.1d">bold_K</annotation></semantics></math>/<math alttext="\mathbf{V}" class="ltx_Math" display="inline" id="S4.p4.3.3.m3.1"><semantics id="S4.p4.3.3.m3.1a"><mi id="S4.p4.3.3.m3.1.1" xref="S4.p4.3.3.m3.1.1.cmml">𝐕</mi><annotation-xml encoding="MathML-Content" id="S4.p4.3.3.m3.1b"><ci id="S4.p4.3.3.m3.1.1.cmml" xref="S4.p4.3.3.m3.1.1">𝐕</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.3.3.m3.1c">\mathbf{V}</annotation><annotation encoding="application/x-llamapun" id="S4.p4.3.3.m3.1d">bold_V</annotation></semantics></math>.</span> We also investigate the distribution of <math alttext="\mathbf{Q}" class="ltx_Math" display="inline" id="S4.p4.4.m1.1"><semantics id="S4.p4.4.m1.1a"><mi id="S4.p4.4.m1.1.1" xref="S4.p4.4.m1.1.1.cmml">𝐐</mi><annotation-xml encoding="MathML-Content" id="S4.p4.4.m1.1b"><ci id="S4.p4.4.m1.1.1.cmml" xref="S4.p4.4.m1.1.1">𝐐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.4.m1.1c">\mathbf{Q}</annotation><annotation encoding="application/x-llamapun" id="S4.p4.4.m1.1d">bold_Q</annotation></semantics></math>/<math alttext="\mathbf{K}" class="ltx_Math" display="inline" id="S4.p4.5.m2.1"><semantics id="S4.p4.5.m2.1a"><mi id="S4.p4.5.m2.1.1" xref="S4.p4.5.m2.1.1.cmml">𝐊</mi><annotation-xml encoding="MathML-Content" id="S4.p4.5.m2.1b"><ci id="S4.p4.5.m2.1.1.cmml" xref="S4.p4.5.m2.1.1">𝐊</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.5.m2.1c">\mathbf{K}</annotation><annotation encoding="application/x-llamapun" id="S4.p4.5.m2.1d">bold_K</annotation></semantics></math>/<math alttext="\mathbf{V}" class="ltx_Math" display="inline" id="S4.p4.6.m3.1"><semantics id="S4.p4.6.m3.1a"><mi id="S4.p4.6.m3.1.1" xref="S4.p4.6.m3.1.1.cmml">𝐕</mi><annotation-xml encoding="MathML-Content" id="S4.p4.6.m3.1b"><ci id="S4.p4.6.m3.1.1.cmml" xref="S4.p4.6.m3.1.1">𝐕</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.6.m3.1c">\mathbf{V}</annotation><annotation encoding="application/x-llamapun" id="S4.p4.6.m3.1d">bold_V</annotation></semantics></math> within the self-attention mechanism. We only quantize the KV cache for fair comparisons with previous works&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Ashkboos et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib3" title="">2024b</a>; Lin et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib20" title="">2024b</a>)</cite>. However, quantization of <math alttext="\mathbf{Q}" class="ltx_Math" display="inline" id="S4.p4.7.m4.1"><semantics id="S4.p4.7.m4.1a"><mi id="S4.p4.7.m4.1.1" xref="S4.p4.7.m4.1.1.cmml">𝐐</mi><annotation-xml encoding="MathML-Content" id="S4.p4.7.m4.1b"><ci id="S4.p4.7.m4.1.1.cmml" xref="S4.p4.7.m4.1.1">𝐐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.7.m4.1c">\mathbf{Q}</annotation><annotation encoding="application/x-llamapun" id="S4.p4.7.m4.1d">bold_Q</annotation></semantics></math> is also crucial, as used in FlashAttention-3&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Shah et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib28" title="">2024</a>)</cite>. In Figure&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#S4.F3" title="Figure 3 ‣ 4 Difficulty of Static Quantization ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">3</span></a>, <math alttext="\mathbf{Q}" class="ltx_Math" display="inline" id="S4.p4.8.m5.1"><semantics id="S4.p4.8.m5.1a"><mi id="S4.p4.8.m5.1.1" xref="S4.p4.8.m5.1.1.cmml">𝐐</mi><annotation-xml encoding="MathML-Content" id="S4.p4.8.m5.1b"><ci id="S4.p4.8.m5.1.1.cmml" xref="S4.p4.8.m5.1.1">𝐐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.8.m5.1c">\mathbf{Q}</annotation><annotation encoding="application/x-llamapun" id="S4.p4.8.m5.1d">bold_Q</annotation></semantics></math>/<math alttext="\mathbf{K}" class="ltx_Math" display="inline" id="S4.p4.9.m6.1"><semantics id="S4.p4.9.m6.1a"><mi id="S4.p4.9.m6.1.1" xref="S4.p4.9.m6.1.1.cmml">𝐊</mi><annotation-xml encoding="MathML-Content" id="S4.p4.9.m6.1b"><ci id="S4.p4.9.m6.1.1.cmml" xref="S4.p4.9.m6.1.1">𝐊</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.9.m6.1c">\mathbf{K}</annotation><annotation encoding="application/x-llamapun" id="S4.p4.9.m6.1d">bold_K</annotation></semantics></math>/<math alttext="\mathbf{V}" class="ltx_Math" display="inline" id="S4.p4.10.m7.1"><semantics id="S4.p4.10.m7.1a"><mi id="S4.p4.10.m7.1.1" xref="S4.p4.10.m7.1.1.cmml">𝐕</mi><annotation-xml encoding="MathML-Content" id="S4.p4.10.m7.1b"><ci id="S4.p4.10.m7.1.1.cmml" xref="S4.p4.10.m7.1.1">𝐕</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.10.m7.1c">\mathbf{V}</annotation><annotation encoding="application/x-llamapun" id="S4.p4.10.m7.1d">bold_V</annotation></semantics></math> display a different outlier pattern than the inputs of linear layers, with some tokens having extremely small magnitudes instead of large ones. Specifically, <math alttext="\mathbf{Q}" class="ltx_Math" display="inline" id="S4.p4.11.m8.1"><semantics id="S4.p4.11.m8.1a"><mi id="S4.p4.11.m8.1.1" xref="S4.p4.11.m8.1.1.cmml">𝐐</mi><annotation-xml encoding="MathML-Content" id="S4.p4.11.m8.1b"><ci id="S4.p4.11.m8.1.1.cmml" xref="S4.p4.11.m8.1.1">𝐐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.11.m8.1c">\mathbf{Q}</annotation><annotation encoding="application/x-llamapun" id="S4.p4.11.m8.1d">bold_Q</annotation></semantics></math>/<math alttext="\mathbf{K}" class="ltx_Math" display="inline" id="S4.p4.12.m9.1"><semantics id="S4.p4.12.m9.1a"><mi id="S4.p4.12.m9.1.1" xref="S4.p4.12.m9.1.1.cmml">𝐊</mi><annotation-xml encoding="MathML-Content" id="S4.p4.12.m9.1b"><ci id="S4.p4.12.m9.1.1.cmml" xref="S4.p4.12.m9.1.1">𝐊</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.12.m9.1c">\mathbf{K}</annotation><annotation encoding="application/x-llamapun" id="S4.p4.12.m9.1d">bold_K</annotation></semantics></math> have <math alttext="\frac{\text{top-1}}{\text{median}}\approx 1.5" class="ltx_Math" display="inline" id="S4.p4.13.m10.1"><semantics id="S4.p4.13.m10.1a"><mrow id="S4.p4.13.m10.1.1" xref="S4.p4.13.m10.1.1.cmml"><mfrac id="S4.p4.13.m10.1.1.2" xref="S4.p4.13.m10.1.1.2.cmml"><mtext id="S4.p4.13.m10.1.1.2.2" xref="S4.p4.13.m10.1.1.2.2a.cmml">top-1</mtext><mtext id="S4.p4.13.m10.1.1.2.3" xref="S4.p4.13.m10.1.1.2.3a.cmml">median</mtext></mfrac><mo id="S4.p4.13.m10.1.1.1" xref="S4.p4.13.m10.1.1.1.cmml">≈</mo><mn id="S4.p4.13.m10.1.1.3" xref="S4.p4.13.m10.1.1.3.cmml">1.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.13.m10.1b"><apply id="S4.p4.13.m10.1.1.cmml" xref="S4.p4.13.m10.1.1"><approx id="S4.p4.13.m10.1.1.1.cmml" xref="S4.p4.13.m10.1.1.1"></approx><apply id="S4.p4.13.m10.1.1.2.cmml" xref="S4.p4.13.m10.1.1.2"><divide id="S4.p4.13.m10.1.1.2.1.cmml" xref="S4.p4.13.m10.1.1.2"></divide><ci id="S4.p4.13.m10.1.1.2.2a.cmml" xref="S4.p4.13.m10.1.1.2.2"><mtext id="S4.p4.13.m10.1.1.2.2.cmml" mathsize="70%" xref="S4.p4.13.m10.1.1.2.2">top-1</mtext></ci><ci id="S4.p4.13.m10.1.1.2.3a.cmml" xref="S4.p4.13.m10.1.1.2.3"><mtext id="S4.p4.13.m10.1.1.2.3.cmml" mathsize="70%" xref="S4.p4.13.m10.1.1.2.3">median</mtext></ci></apply><cn id="S4.p4.13.m10.1.1.3.cmml" type="float" xref="S4.p4.13.m10.1.1.3">1.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.13.m10.1c">\frac{\text{top-1}}{\text{median}}\approx 1.5</annotation><annotation encoding="application/x-llamapun" id="S4.p4.13.m10.1d">divide start_ARG top-1 end_ARG start_ARG median end_ARG ≈ 1.5</annotation></semantics></math>, but <math alttext="\frac{\text{median}}{\text{min-1}}>9" class="ltx_Math" display="inline" id="S4.p4.14.m11.1"><semantics id="S4.p4.14.m11.1a"><mrow id="S4.p4.14.m11.1.1" xref="S4.p4.14.m11.1.1.cmml"><mfrac id="S4.p4.14.m11.1.1.2" xref="S4.p4.14.m11.1.1.2.cmml"><mtext id="S4.p4.14.m11.1.1.2.2" xref="S4.p4.14.m11.1.1.2.2a.cmml">median</mtext><mtext id="S4.p4.14.m11.1.1.2.3" xref="S4.p4.14.m11.1.1.2.3a.cmml">min-1</mtext></mfrac><mo id="S4.p4.14.m11.1.1.1" xref="S4.p4.14.m11.1.1.1.cmml">&gt;</mo><mn id="S4.p4.14.m11.1.1.3" xref="S4.p4.14.m11.1.1.3.cmml">9</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.14.m11.1b"><apply id="S4.p4.14.m11.1.1.cmml" xref="S4.p4.14.m11.1.1"><gt id="S4.p4.14.m11.1.1.1.cmml" xref="S4.p4.14.m11.1.1.1"></gt><apply id="S4.p4.14.m11.1.1.2.cmml" xref="S4.p4.14.m11.1.1.2"><divide id="S4.p4.14.m11.1.1.2.1.cmml" xref="S4.p4.14.m11.1.1.2"></divide><ci id="S4.p4.14.m11.1.1.2.2a.cmml" xref="S4.p4.14.m11.1.1.2.2"><mtext id="S4.p4.14.m11.1.1.2.2.cmml" mathsize="70%" xref="S4.p4.14.m11.1.1.2.2">median</mtext></ci><ci id="S4.p4.14.m11.1.1.2.3a.cmml" xref="S4.p4.14.m11.1.1.2.3"><mtext id="S4.p4.14.m11.1.1.2.3.cmml" mathsize="70%" xref="S4.p4.14.m11.1.1.2.3">min-1</mtext></ci></apply><cn id="S4.p4.14.m11.1.1.3.cmml" type="integer" xref="S4.p4.14.m11.1.1.3">9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.14.m11.1c">\frac{\text{median}}{\text{min-1}}&gt;9</annotation><annotation encoding="application/x-llamapun" id="S4.p4.14.m11.1d">divide start_ARG median end_ARG start_ARG min-1 end_ARG &gt; 9</annotation></semantics></math>. Additionally, as shown in Figure&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#S4.F3.sf2" title="In Figure 3 ‣ 4 Difficulty of Static Quantization ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">3(b)</span></a>, Hadamard rotation has no effect on these outliers.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="S4.F3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F3.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="157" id="S4.F3.sf1.g1" src="https://arxiv.org/html/2410.05265v1/x5.png" width="571">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span>Original distribution</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F3.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="137" id="S4.F3.sf2.g1" src="https://arxiv.org/html/2410.05265v1/x6.png" width="571">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span>Rotation</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F3.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="136" id="S4.F3.sf3.g1" src="https://arxiv.org/html/2410.05265v1/x7.png" width="571">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(c) </span>PrefixQuant (ours)</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span><span class="ltx_text ltx_font_bold" id="S4.F3.6.3">Distribution of token-wise maximum values for <math alttext="\mathbf{Q}" class="ltx_Math" display="inline" id="S4.F3.4.1.m1.1"><semantics id="S4.F3.4.1.m1.1b"><mi id="S4.F3.4.1.m1.1.1" xref="S4.F3.4.1.m1.1.1.cmml">𝐐</mi><annotation-xml encoding="MathML-Content" id="S4.F3.4.1.m1.1c"><ci id="S4.F3.4.1.m1.1.1.cmml" xref="S4.F3.4.1.m1.1.1">𝐐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.4.1.m1.1d">\mathbf{Q}</annotation><annotation encoding="application/x-llamapun" id="S4.F3.4.1.m1.1e">bold_Q</annotation></semantics></math>/<math alttext="\mathbf{K}" class="ltx_Math" display="inline" id="S4.F3.5.2.m2.1"><semantics id="S4.F3.5.2.m2.1b"><mi id="S4.F3.5.2.m2.1.1" xref="S4.F3.5.2.m2.1.1.cmml">𝐊</mi><annotation-xml encoding="MathML-Content" id="S4.F3.5.2.m2.1c"><ci id="S4.F3.5.2.m2.1.1.cmml" xref="S4.F3.5.2.m2.1.1">𝐊</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.5.2.m2.1d">\mathbf{K}</annotation><annotation encoding="application/x-llamapun" id="S4.F3.5.2.m2.1e">bold_K</annotation></semantics></math>/<math alttext="\mathbf{V}" class="ltx_Math" display="inline" id="S4.F3.6.3.m3.1"><semantics id="S4.F3.6.3.m3.1b"><mi id="S4.F3.6.3.m3.1.1" xref="S4.F3.6.3.m3.1.1.cmml">𝐕</mi><annotation-xml encoding="MathML-Content" id="S4.F3.6.3.m3.1c"><ci id="S4.F3.6.3.m3.1.1.cmml" xref="S4.F3.6.3.m3.1.1">𝐕</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.6.3.m3.1d">\mathbf{V}</annotation><annotation encoding="application/x-llamapun" id="S4.F3.6.3.m3.1e">bold_V</annotation></semantics></math> in Llama-2-7B.</span> Same present rules as Figure &nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#S3.F2.sf1" title="In Figure 2 ‣ 3 Preliminaries ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">2(a)</span></a> except that ratios greater than 5 are marked with red.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="S4.F4">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F4.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="448" id="S4.F4.sf1.g1" src="https://arxiv.org/html/2410.05265v1/x8.png" width="761">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span>Content</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F4.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="448" id="S4.F4.sf2.g1" src="https://arxiv.org/html/2410.05265v1/x9.png" width="761">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span>Index</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F4.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="448" id="S4.F4.sf3.g1" src="https://arxiv.org/html/2410.05265v1/x10.png" width="761">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(c) </span>Index with prefixed tokens</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span><span class="ltx_text ltx_font_bold" id="S4.F4.2.1">Illustration the content and index of outlier token in the input sequence of Llama-2-7B.</span> (a) counts the outlier tokens except
in the initial token, shows that the outliers only exit in “.” and “\n” tokens. (b) illustrates the sequence index of outlier tokens. (c) demonstrates that prefix the input sequence with “.\n[BOS]” can constraint the outlier token in the first three tokens. </figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S4.p5">
<p class="ltx_p" id="S4.p5.3"><span class="ltx_text ltx_font_bold" id="S4.p5.3.1">3. Outlier Tokens in Initial or Low-Semantic Tokens.</span> Though outlier tokens occur in different patterns, we find that they are the same tokens in inputs of linear layers and <math alttext="\mathbf{Q}" class="ltx_Math" display="inline" id="S4.p5.1.m1.1"><semantics id="S4.p5.1.m1.1a"><mi id="S4.p5.1.m1.1.1" xref="S4.p5.1.m1.1.1.cmml">𝐐</mi><annotation-xml encoding="MathML-Content" id="S4.p5.1.m1.1b"><ci id="S4.p5.1.m1.1.1.cmml" xref="S4.p5.1.m1.1.1">𝐐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.1.m1.1c">\mathbf{Q}</annotation><annotation encoding="application/x-llamapun" id="S4.p5.1.m1.1d">bold_Q</annotation></semantics></math>/<math alttext="\mathbf{K}" class="ltx_Math" display="inline" id="S4.p5.2.m2.1"><semantics id="S4.p5.2.m2.1a"><mi id="S4.p5.2.m2.1.1" xref="S4.p5.2.m2.1.1.cmml">𝐊</mi><annotation-xml encoding="MathML-Content" id="S4.p5.2.m2.1b"><ci id="S4.p5.2.m2.1.1.cmml" xref="S4.p5.2.m2.1.1">𝐊</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.2.m2.1c">\mathbf{K}</annotation><annotation encoding="application/x-llamapun" id="S4.p5.2.m2.1d">bold_K</annotation></semantics></math>/<math alttext="\mathbf{V}" class="ltx_Math" display="inline" id="S4.p5.3.m3.1"><semantics id="S4.p5.3.m3.1a"><mi id="S4.p5.3.m3.1.1" xref="S4.p5.3.m3.1.1.cmml">𝐕</mi><annotation-xml encoding="MathML-Content" id="S4.p5.3.m3.1b"><ci id="S4.p5.3.m3.1.1.cmml" xref="S4.p5.3.m3.1.1">𝐕</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.3.m3.1c">\mathbf{V}</annotation><annotation encoding="application/x-llamapun" id="S4.p5.3.m3.1d">bold_V</annotation></semantics></math>. Consistent with Massive Attention&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Sun et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib32" title="">2024</a>)</cite>, we find that outlier tokens appear only in small fractions (nearly 1 to 4 tokens in the input sequence) with fixed patterns. For example, Llama-2-7B has outlier tokens in both initial and delimiter tokens (“.” or “\n” as shown in Figure&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#S4.F4.sf1" title="In Figure 4 ‣ 4 Difficulty of Static Quantization ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">4(a)</span></a>). However, unlike outlier channels that exist in some fixed channel indexes&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Dettmers et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib11" title="">2022</a>)</cite>, the position indexes of outlier tokens relate to the input sequence and are diverse, as shown in Figure&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#S4.F4.sf2" title="In Figure 4 ‣ 4 Difficulty of Static Quantization ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">4(b)</span></a>. Therefore, it is not feasible to decide offline on the outlier token to achieve mixed-precision quantization like previous works on outlier channels&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Dettmers et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib11" title="">2022</a>; Zhao et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib43" title="">2023</a>)</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S4.p6">
<p class="ltx_p" id="S4.p6.1">Previous works&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Ashkboos et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib3" title="">2024b</a>; Lin et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib20" title="">2024b</a>; Liu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib23" title="">2024b</a>)</cite> take per-token dynamic quantization for inputs of linear layers and KV cache to deal with outlier tokens. In this paper, we focus on eliminating outlier tokens to facilitate per-tensor static quantization.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="S4.F5">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F5.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="577" id="S4.F5.sf1.g1" src="https://arxiv.org/html/2410.05265v1/x11.png" width="762">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span>Original</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F5.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="575" id="S4.F5.sf2.g1" src="https://arxiv.org/html/2410.05265v1/x12.png" width="761">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span>PrefixQuant</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span><span class="ltx_text ltx_font_bold" id="S4.F5.8.1">Comparison of Original and PrefixQuant Inference.</span> Both methods use Hadamard rotation to remove channel-wise outliers. PrefixQuant differs by setting specific prefixed tokens in the KV cache, which eliminates token-wise outliers in linear inputs and <math alttext="\mathbf{Q}" class="ltx_Math" display="inline" id="S4.F5.4.m1.1"><semantics id="S4.F5.4.m1.1b"><mi id="S4.F5.4.m1.1.1" xref="S4.F5.4.m1.1.1.cmml">𝐐</mi><annotation-xml encoding="MathML-Content" id="S4.F5.4.m1.1c"><ci id="S4.F5.4.m1.1.1.cmml" xref="S4.F5.4.m1.1.1">𝐐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.4.m1.1d">\mathbf{Q}</annotation><annotation encoding="application/x-llamapun" id="S4.F5.4.m1.1e">bold_Q</annotation></semantics></math>/<math alttext="\mathbf{K}" class="ltx_Math" display="inline" id="S4.F5.5.m2.1"><semantics id="S4.F5.5.m2.1b"><mi id="S4.F5.5.m2.1.1" xref="S4.F5.5.m2.1.1.cmml">𝐊</mi><annotation-xml encoding="MathML-Content" id="S4.F5.5.m2.1c"><ci id="S4.F5.5.m2.1.1.cmml" xref="S4.F5.5.m2.1.1">𝐊</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.5.m2.1d">\mathbf{K}</annotation><annotation encoding="application/x-llamapun" id="S4.F5.5.m2.1e">bold_K</annotation></semantics></math>/<math alttext="\mathbf{V}" class="ltx_Math" display="inline" id="S4.F5.6.m3.1"><semantics id="S4.F5.6.m3.1b"><mi id="S4.F5.6.m3.1.1" xref="S4.F5.6.m3.1.1.cmml">𝐕</mi><annotation-xml encoding="MathML-Content" id="S4.F5.6.m3.1c"><ci id="S4.F5.6.m3.1.1.cmml" xref="S4.F5.6.m3.1.1">𝐕</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.6.m3.1d">\mathbf{V}</annotation><annotation encoding="application/x-llamapun" id="S4.F5.6.m3.1e">bold_V</annotation></semantics></math>, enhancing compatibility with per-tensor static quantization. Llama-2-7B serves as an example; additional prefixed tokens for other models are listed in Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#S5.T1" title="Table 1 ‣ 5.1 Prefixed Outliers ‣ 5 PrefixQuant ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">1</span></a>.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>PrefixQuant</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">As shown in Figure&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#S4.F5" title="Figure 5 ‣ 4 Difficulty of Static Quantization ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">5</span></a>, we propose prefixing outlier tokens in the KV cache to improve the performance of more efficient per-tensor static quantization, instead of using costly per-token dynamic quantization. Section&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#S5.SS1" title="5.1 Prefixed Outliers ‣ 5 PrefixQuant ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">5.1</span></a> explains how to find these prefixed outliers. Section&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#S5.SS2" title="5.2 Block-wise Fine-tuning ‣ 5 PrefixQuant ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">5.2</span></a> introduces block-wise fine-tuning to further enhance performance.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Prefixed Outliers</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_table ltx_align_floatright" id="S5.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Prefixed tokens in KV cache across different models. [BOS] indicates the special token for beginning of sequence(<em class="ltx_emph ltx_font_italic" id="S5.T1.10.1">e.g.</em> “<math alttext="<" class="ltx_Math" display="inline" id="S5.T1.5.m1.1"><semantics id="S5.T1.5.m1.1b"><mo id="S5.T1.5.m1.1.1" xref="S5.T1.5.m1.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S5.T1.5.m1.1c"><lt id="S5.T1.5.m1.1.1.cmml" xref="S5.T1.5.m1.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.5.m1.1d">&lt;</annotation><annotation encoding="application/x-llamapun" id="S5.T1.5.m1.1e">&lt;</annotation></semantics></math>s<math alttext=">" class="ltx_Math" display="inline" id="S5.T1.6.m2.1"><semantics id="S5.T1.6.m2.1b"><mo id="S5.T1.6.m2.1.1" xref="S5.T1.6.m2.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="S5.T1.6.m2.1c"><gt id="S5.T1.6.m2.1.1.cmml" xref="S5.T1.6.m2.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.6.m2.1d">&gt;</annotation><annotation encoding="application/x-llamapun" id="S5.T1.6.m2.1e">&gt;</annotation></semantics></math>” for Llama-2 and “<math alttext="|" class="ltx_Math" display="inline" id="S5.T1.7.m3.1"><semantics id="S5.T1.7.m3.1b"><mo fence="false" id="S5.T1.7.m3.1.1" stretchy="false" xref="S5.T1.7.m3.1.1.cmml">|</mo><annotation-xml encoding="MathML-Content" id="S5.T1.7.m3.1c"><ci id="S5.T1.7.m3.1.1.cmml" xref="S5.T1.7.m3.1.1">|</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.7.m3.1d">|</annotation><annotation encoding="application/x-llamapun" id="S5.T1.7.m3.1e">|</annotation></semantics></math>begin_of_text<math alttext="|" class="ltx_Math" display="inline" id="S5.T1.8.m4.1"><semantics id="S5.T1.8.m4.1b"><mo fence="false" id="S5.T1.8.m4.1.1" stretchy="false" xref="S5.T1.8.m4.1.1.cmml">|</mo><annotation-xml encoding="MathML-Content" id="S5.T1.8.m4.1c"><ci id="S5.T1.8.m4.1.1.cmml" xref="S5.T1.8.m4.1.1">|</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.8.m4.1d">|</annotation><annotation encoding="application/x-llamapun" id="S5.T1.8.m4.1e">|</annotation></semantics></math>“ for Llama-3). Note that the following “<span class="ltx_rule" style="width:5.0pt;height:0.5pt;background:black;display:inline-block;">&nbsp;</span>” represents space.</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S5.T1.11">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T1.11.1.1">
<td class="ltx_td ltx_align_left ltx_border_tt" id="S5.T1.11.1.1.1" rowspan="2" style="padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text ltx_font_bold" id="S5.T1.11.1.1.1.1">Model</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S5.T1.11.1.1.2" style="padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text ltx_font_bold" id="S5.T1.11.1.1.2.1">Prefixed token</span></td>
</tr>
<tr class="ltx_tr" id="S5.T1.11.2.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.11.2.2.1" style="padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text ltx_font_bold" id="S5.T1.11.2.2.1.1">Number</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T1.11.2.2.2" style="padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text ltx_font_bold" id="S5.T1.11.2.2.2.1">Content</span></td>
</tr>
<tr class="ltx_tr" id="S5.T1.11.3.3">
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T1.11.3.3.1" style="padding-top:-3pt;padding-bottom:-3pt;">Llama-2-7B</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.11.3.3.2" style="padding-top:-3pt;padding-bottom:-3pt;">3</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T1.11.3.3.3" style="padding-top:-3pt;padding-bottom:-3pt;">.\n[BOS]</td>
</tr>
<tr class="ltx_tr" id="S5.T1.11.4.4">
<td class="ltx_td ltx_align_left" id="S5.T1.11.4.4.1" style="padding-top:-3pt;padding-bottom:-3pt;">Llama-2-13B</td>
<td class="ltx_td ltx_align_center" id="S5.T1.11.4.4.2" style="padding-top:-3pt;padding-bottom:-3pt;">3</td>
<td class="ltx_td ltx_align_right" id="S5.T1.11.4.4.3" style="padding-top:-3pt;padding-bottom:-3pt;">the.[BOS]</td>
</tr>
<tr class="ltx_tr" id="S5.T1.11.5.5">
<td class="ltx_td ltx_align_left" id="S5.T1.11.5.5.1" style="padding-top:-3pt;padding-bottom:-3pt;">Llama-2-70B</td>
<td class="ltx_td ltx_align_center" id="S5.T1.11.5.5.2" style="padding-top:-3pt;padding-bottom:-3pt;">4</td>
<td class="ltx_td ltx_align_right" id="S5.T1.11.5.5.3" style="padding-top:-3pt;padding-bottom:-3pt;">\n”[BOS]</td>
</tr>
<tr class="ltx_tr" id="S5.T1.11.6.6">
<td class="ltx_td ltx_align_left" id="S5.T1.11.6.6.1" style="padding-top:-3pt;padding-bottom:-3pt;">Llama-3-8B(-Instruct)</td>
<td class="ltx_td ltx_align_center" id="S5.T1.11.6.6.2" style="padding-top:-3pt;padding-bottom:-3pt;">1</td>
<td class="ltx_td ltx_align_right" id="S5.T1.11.6.6.3" style="padding-top:-3pt;padding-bottom:-3pt;">[BOS]</td>
</tr>
<tr class="ltx_tr" id="S5.T1.11.7.7">
<td class="ltx_td ltx_align_left" id="S5.T1.11.7.7.1" style="padding-top:-3pt;padding-bottom:-3pt;">Llama-3-70B(-Instruct)</td>
<td class="ltx_td ltx_align_center" id="S5.T1.11.7.7.2" style="padding-top:-3pt;padding-bottom:-3pt;">3</td>
<td class="ltx_td ltx_align_right" id="S5.T1.11.7.7.3" style="padding-top:-3pt;padding-bottom:-3pt;">,<span class="ltx_rule" style="width:5.0pt;height:0.5pt;background:black;display:inline-block;">&nbsp;</span>[BOS]</td>
</tr>
<tr class="ltx_tr" id="S5.T1.11.8.8">
<td class="ltx_td ltx_align_left" id="S5.T1.11.8.8.1" style="padding-top:-3pt;padding-bottom:-3pt;">Mistral-v0.3-7B</td>
<td class="ltx_td ltx_align_center" id="S5.T1.11.8.8.2" style="padding-top:-3pt;padding-bottom:-3pt;">4</td>
<td class="ltx_td ltx_align_right" id="S5.T1.11.8.8.3" style="padding-top:-3pt;padding-bottom:-3pt;">\n.to[BOS]</td>
</tr>
<tr class="ltx_tr" id="S5.T1.11.9.9">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S5.T1.11.9.9.1" style="padding-top:-3pt;padding-bottom:-3pt;">Qwen-2-7B</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.11.9.9.2" style="padding-top:-3pt;padding-bottom:-3pt;">1</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S5.T1.11.9.9.3" style="padding-top:-3pt;padding-bottom:-3pt;">[BOS]</td>
</tr>
</tbody>
</table>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.6"><span class="ltx_text ltx_font_bold" id="S5.SS1.p1.6.1">Definition of Outlier Token.</span> Given that both upper outlier tokens in the inputs of the linear layer and lower outlier tokens in <math alttext="\mathbf{Q}" class="ltx_Math" display="inline" id="S5.SS1.p1.1.m1.1"><semantics id="S5.SS1.p1.1.m1.1a"><mi id="S5.SS1.p1.1.m1.1.1" xref="S5.SS1.p1.1.m1.1.1.cmml">𝐐</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.1.m1.1b"><ci id="S5.SS1.p1.1.m1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1">𝐐</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.1.m1.1c">\mathbf{Q}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.1.m1.1d">bold_Q</annotation></semantics></math>/<math alttext="\mathbf{K}" class="ltx_Math" display="inline" id="S5.SS1.p1.2.m2.1"><semantics id="S5.SS1.p1.2.m2.1a"><mi id="S5.SS1.p1.2.m2.1.1" xref="S5.SS1.p1.2.m2.1.1.cmml">𝐊</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.2.m2.1b"><ci id="S5.SS1.p1.2.m2.1.1.cmml" xref="S5.SS1.p1.2.m2.1.1">𝐊</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.2.m2.1c">\mathbf{K}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.2.m2.1d">bold_K</annotation></semantics></math>/<math alttext="\mathbf{V}" class="ltx_Math" display="inline" id="S5.SS1.p1.3.m3.1"><semantics id="S5.SS1.p1.3.m3.1a"><mi id="S5.SS1.p1.3.m3.1.1" xref="S5.SS1.p1.3.m3.1.1.cmml">𝐕</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.3.m3.1b"><ci id="S5.SS1.p1.3.m3.1.1.cmml" xref="S5.SS1.p1.3.m3.1.1">𝐕</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.3.m3.1c">\mathbf{V}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.3.m3.1d">bold_V</annotation></semantics></math> are same tokens, we choose to identify outlier tokens using the upper outliers in the inputs of the down_proj layers due to the outlier in down_proj is more highlight and easier to be detected. Given token-wise maximum values <math alttext="\mathbf{M}\in\mathbb{R}^{T}" class="ltx_Math" display="inline" id="S5.SS1.p1.4.m4.1"><semantics id="S5.SS1.p1.4.m4.1a"><mrow id="S5.SS1.p1.4.m4.1.1" xref="S5.SS1.p1.4.m4.1.1.cmml"><mi id="S5.SS1.p1.4.m4.1.1.2" xref="S5.SS1.p1.4.m4.1.1.2.cmml">𝐌</mi><mo id="S5.SS1.p1.4.m4.1.1.1" xref="S5.SS1.p1.4.m4.1.1.1.cmml">∈</mo><msup id="S5.SS1.p1.4.m4.1.1.3" xref="S5.SS1.p1.4.m4.1.1.3.cmml"><mi id="S5.SS1.p1.4.m4.1.1.3.2" xref="S5.SS1.p1.4.m4.1.1.3.2.cmml">ℝ</mi><mi id="S5.SS1.p1.4.m4.1.1.3.3" xref="S5.SS1.p1.4.m4.1.1.3.3.cmml">T</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.4.m4.1b"><apply id="S5.SS1.p1.4.m4.1.1.cmml" xref="S5.SS1.p1.4.m4.1.1"><in id="S5.SS1.p1.4.m4.1.1.1.cmml" xref="S5.SS1.p1.4.m4.1.1.1"></in><ci id="S5.SS1.p1.4.m4.1.1.2.cmml" xref="S5.SS1.p1.4.m4.1.1.2">𝐌</ci><apply id="S5.SS1.p1.4.m4.1.1.3.cmml" xref="S5.SS1.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S5.SS1.p1.4.m4.1.1.3.1.cmml" xref="S5.SS1.p1.4.m4.1.1.3">superscript</csymbol><ci id="S5.SS1.p1.4.m4.1.1.3.2.cmml" xref="S5.SS1.p1.4.m4.1.1.3.2">ℝ</ci><ci id="S5.SS1.p1.4.m4.1.1.3.3.cmml" xref="S5.SS1.p1.4.m4.1.1.3.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.4.m4.1c">\mathbf{M}\in\mathbb{R}^{T}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.4.m4.1d">bold_M ∈ blackboard_R start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math>, which represents the maximum values of each token. Then, outlier token in the <math alttext="i" class="ltx_Math" display="inline" id="S5.SS1.p1.5.m5.1"><semantics id="S5.SS1.p1.5.m5.1a"><mi id="S5.SS1.p1.5.m5.1.1" xref="S5.SS1.p1.5.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.5.m5.1b"><ci id="S5.SS1.p1.5.m5.1.1.cmml" xref="S5.SS1.p1.5.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.5.m5.1c">i</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.5.m5.1d">italic_i</annotation></semantics></math>-th index of token sequence is identified when the ratio of their maximum values to the median of all maximum values exceeds a threshold <math alttext="\eta" class="ltx_Math" display="inline" id="S5.SS1.p1.6.m6.1"><semantics id="S5.SS1.p1.6.m6.1a"><mi id="S5.SS1.p1.6.m6.1.1" xref="S5.SS1.p1.6.m6.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.6.m6.1b"><ci id="S5.SS1.p1.6.m6.1.1.cmml" xref="S5.SS1.p1.6.m6.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.6.m6.1c">\eta</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.6.m6.1d">italic_η</annotation></semantics></math>:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S5.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\frac{\mathbf{M}_{i}}{\text{median}(\mathbf{M})}>\eta," class="ltx_Math" display="block" id="S5.E3.m1.2"><semantics id="S5.E3.m1.2a"><mrow id="S5.E3.m1.2.2.1" xref="S5.E3.m1.2.2.1.1.cmml"><mrow id="S5.E3.m1.2.2.1.1" xref="S5.E3.m1.2.2.1.1.cmml"><mfrac id="S5.E3.m1.1.1" xref="S5.E3.m1.1.1.cmml"><msub id="S5.E3.m1.1.1.3" xref="S5.E3.m1.1.1.3.cmml"><mi id="S5.E3.m1.1.1.3.2" xref="S5.E3.m1.1.1.3.2.cmml">𝐌</mi><mi id="S5.E3.m1.1.1.3.3" xref="S5.E3.m1.1.1.3.3.cmml">i</mi></msub><mrow id="S5.E3.m1.1.1.1" xref="S5.E3.m1.1.1.1.cmml"><mtext id="S5.E3.m1.1.1.1.3" xref="S5.E3.m1.1.1.1.3a.cmml">median</mtext><mo id="S5.E3.m1.1.1.1.2" xref="S5.E3.m1.1.1.1.2.cmml">⁢</mo><mrow id="S5.E3.m1.1.1.1.4.2" xref="S5.E3.m1.1.1.1.cmml"><mo id="S5.E3.m1.1.1.1.4.2.1" stretchy="false" xref="S5.E3.m1.1.1.1.cmml">(</mo><mi id="S5.E3.m1.1.1.1.1" xref="S5.E3.m1.1.1.1.1.cmml">𝐌</mi><mo id="S5.E3.m1.1.1.1.4.2.2" stretchy="false" xref="S5.E3.m1.1.1.1.cmml">)</mo></mrow></mrow></mfrac><mo id="S5.E3.m1.2.2.1.1.1" xref="S5.E3.m1.2.2.1.1.1.cmml">&gt;</mo><mi id="S5.E3.m1.2.2.1.1.2" xref="S5.E3.m1.2.2.1.1.2.cmml">η</mi></mrow><mo id="S5.E3.m1.2.2.1.2" xref="S5.E3.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E3.m1.2b"><apply id="S5.E3.m1.2.2.1.1.cmml" xref="S5.E3.m1.2.2.1"><gt id="S5.E3.m1.2.2.1.1.1.cmml" xref="S5.E3.m1.2.2.1.1.1"></gt><apply id="S5.E3.m1.1.1.cmml" xref="S5.E3.m1.1.1"><divide id="S5.E3.m1.1.1.2.cmml" xref="S5.E3.m1.1.1"></divide><apply id="S5.E3.m1.1.1.3.cmml" xref="S5.E3.m1.1.1.3"><csymbol cd="ambiguous" id="S5.E3.m1.1.1.3.1.cmml" xref="S5.E3.m1.1.1.3">subscript</csymbol><ci id="S5.E3.m1.1.1.3.2.cmml" xref="S5.E3.m1.1.1.3.2">𝐌</ci><ci id="S5.E3.m1.1.1.3.3.cmml" xref="S5.E3.m1.1.1.3.3">𝑖</ci></apply><apply id="S5.E3.m1.1.1.1.cmml" xref="S5.E3.m1.1.1.1"><times id="S5.E3.m1.1.1.1.2.cmml" xref="S5.E3.m1.1.1.1.2"></times><ci id="S5.E3.m1.1.1.1.3a.cmml" xref="S5.E3.m1.1.1.1.3"><mtext id="S5.E3.m1.1.1.1.3.cmml" xref="S5.E3.m1.1.1.1.3">median</mtext></ci><ci id="S5.E3.m1.1.1.1.1.cmml" xref="S5.E3.m1.1.1.1.1">𝐌</ci></apply></apply><ci id="S5.E3.m1.2.2.1.1.2.cmml" xref="S5.E3.m1.2.2.1.1.2">𝜂</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E3.m1.2c">\frac{\mathbf{M}_{i}}{\text{median}(\mathbf{M})}&gt;\eta,</annotation><annotation encoding="application/x-llamapun" id="S5.E3.m1.2d">divide start_ARG bold_M start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG start_ARG median ( bold_M ) end_ARG &gt; italic_η ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S5.SS1.p1.11">where <math alttext="\mathbf{M}_{i}" class="ltx_Math" display="inline" id="S5.SS1.p1.7.m1.1"><semantics id="S5.SS1.p1.7.m1.1a"><msub id="S5.SS1.p1.7.m1.1.1" xref="S5.SS1.p1.7.m1.1.1.cmml"><mi id="S5.SS1.p1.7.m1.1.1.2" xref="S5.SS1.p1.7.m1.1.1.2.cmml">𝐌</mi><mi id="S5.SS1.p1.7.m1.1.1.3" xref="S5.SS1.p1.7.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.7.m1.1b"><apply id="S5.SS1.p1.7.m1.1.1.cmml" xref="S5.SS1.p1.7.m1.1.1"><csymbol cd="ambiguous" id="S5.SS1.p1.7.m1.1.1.1.cmml" xref="S5.SS1.p1.7.m1.1.1">subscript</csymbol><ci id="S5.SS1.p1.7.m1.1.1.2.cmml" xref="S5.SS1.p1.7.m1.1.1.2">𝐌</ci><ci id="S5.SS1.p1.7.m1.1.1.3.cmml" xref="S5.SS1.p1.7.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.7.m1.1c">\mathbf{M}_{i}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.7.m1.1d">bold_M start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is the maximum value of the <math alttext="i" class="ltx_Math" display="inline" id="S5.SS1.p1.8.m2.1"><semantics id="S5.SS1.p1.8.m2.1a"><mi id="S5.SS1.p1.8.m2.1.1" xref="S5.SS1.p1.8.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.8.m2.1b"><ci id="S5.SS1.p1.8.m2.1.1.cmml" xref="S5.SS1.p1.8.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.8.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.8.m2.1d">italic_i</annotation></semantics></math>-th token, <math alttext="\text{median}()" class="ltx_Math" display="inline" id="S5.SS1.p1.9.m3.1"><semantics id="S5.SS1.p1.9.m3.1a"><mrow id="S5.SS1.p1.9.m3.1.1" xref="S5.SS1.p1.9.m3.1.1.cmml"><mtext id="S5.SS1.p1.9.m3.1.1.2" xref="S5.SS1.p1.9.m3.1.1.2a.cmml">median</mtext><mo id="S5.SS1.p1.9.m3.1.1.1" xref="S5.SS1.p1.9.m3.1.1.1.cmml">⁢</mo><mrow id="S5.SS1.p1.9.m3.1.1.3.2" xref="S5.SS1.p1.9.m3.1.1.cmml"><mo id="S5.SS1.p1.9.m3.1.1.3.2.1" stretchy="false" xref="S5.SS1.p1.9.m3.1.1.3.1.cmml">(</mo><mo id="S5.SS1.p1.9.m3.1.1.3.2.2" stretchy="false" xref="S5.SS1.p1.9.m3.1.1.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.9.m3.1b"><apply id="S5.SS1.p1.9.m3.1.1.cmml" xref="S5.SS1.p1.9.m3.1.1"><times id="S5.SS1.p1.9.m3.1.1.1.cmml" xref="S5.SS1.p1.9.m3.1.1.1"></times><ci id="S5.SS1.p1.9.m3.1.1.2a.cmml" xref="S5.SS1.p1.9.m3.1.1.2"><mtext id="S5.SS1.p1.9.m3.1.1.2.cmml" xref="S5.SS1.p1.9.m3.1.1.2">median</mtext></ci><list id="S5.SS1.p1.9.m3.1.1.3.1.cmml" xref="S5.SS1.p1.9.m3.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.9.m3.1c">\text{median}()</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.9.m3.1d">median ( )</annotation></semantics></math> denotes the function to find the median value from the vector, and the threshold <math alttext="\eta" class="ltx_Math" display="inline" id="S5.SS1.p1.10.m4.1"><semantics id="S5.SS1.p1.10.m4.1a"><mi id="S5.SS1.p1.10.m4.1.1" xref="S5.SS1.p1.10.m4.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.10.m4.1b"><ci id="S5.SS1.p1.10.m4.1.1.cmml" xref="S5.SS1.p1.10.m4.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.10.m4.1c">\eta</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.10.m4.1d">italic_η</annotation></semantics></math> is empirically set to <math alttext="64" class="ltx_Math" display="inline" id="S5.SS1.p1.11.m5.1"><semantics id="S5.SS1.p1.11.m5.1a"><mn id="S5.SS1.p1.11.m5.1.1" xref="S5.SS1.p1.11.m5.1.1.cmml">64</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.11.m5.1b"><cn id="S5.SS1.p1.11.m5.1.1.cmml" type="integer" xref="S5.SS1.p1.11.m5.1.1">64</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.11.m5.1c">64</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.11.m5.1d">64</annotation></semantics></math> in our experiments.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS1.p2">
<p class="ltx_p" id="S5.SS1.p2.3"><span class="ltx_text ltx_font_bold" id="S5.SS1.p2.3.1">Number of Outlier Tokens.</span> We determine the number of outlier tokens by calculating the average number of outlier tokens in a small calibration dataset. Specifically, we compute the average outlier token count <math alttext="\mathbf{O}\in\mathbb{R}^{b}" class="ltx_Math" display="inline" id="S5.SS1.p2.1.m1.1"><semantics id="S5.SS1.p2.1.m1.1a"><mrow id="S5.SS1.p2.1.m1.1.1" xref="S5.SS1.p2.1.m1.1.1.cmml"><mi id="S5.SS1.p2.1.m1.1.1.2" xref="S5.SS1.p2.1.m1.1.1.2.cmml">𝐎</mi><mo id="S5.SS1.p2.1.m1.1.1.1" xref="S5.SS1.p2.1.m1.1.1.1.cmml">∈</mo><msup id="S5.SS1.p2.1.m1.1.1.3" xref="S5.SS1.p2.1.m1.1.1.3.cmml"><mi id="S5.SS1.p2.1.m1.1.1.3.2" xref="S5.SS1.p2.1.m1.1.1.3.2.cmml">ℝ</mi><mi id="S5.SS1.p2.1.m1.1.1.3.3" xref="S5.SS1.p2.1.m1.1.1.3.3.cmml">b</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.1.m1.1b"><apply id="S5.SS1.p2.1.m1.1.1.cmml" xref="S5.SS1.p2.1.m1.1.1"><in id="S5.SS1.p2.1.m1.1.1.1.cmml" xref="S5.SS1.p2.1.m1.1.1.1"></in><ci id="S5.SS1.p2.1.m1.1.1.2.cmml" xref="S5.SS1.p2.1.m1.1.1.2">𝐎</ci><apply id="S5.SS1.p2.1.m1.1.1.3.cmml" xref="S5.SS1.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S5.SS1.p2.1.m1.1.1.3.1.cmml" xref="S5.SS1.p2.1.m1.1.1.3">superscript</csymbol><ci id="S5.SS1.p2.1.m1.1.1.3.2.cmml" xref="S5.SS1.p2.1.m1.1.1.3.2">ℝ</ci><ci id="S5.SS1.p2.1.m1.1.1.3.3.cmml" xref="S5.SS1.p2.1.m1.1.1.3.3">𝑏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.1.m1.1c">\mathbf{O}\in\mathbb{R}^{b}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p2.1.m1.1d">bold_O ∈ blackboard_R start_POSTSUPERSCRIPT italic_b end_POSTSUPERSCRIPT</annotation></semantics></math> for each transformer block according to Eq&nbsp;(<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#S5.E3" title="In 5.1 Prefixed Outliers ‣ 5 PrefixQuant ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">3</span></a>), where <math alttext="b" class="ltx_Math" display="inline" id="S5.SS1.p2.2.m2.1"><semantics id="S5.SS1.p2.2.m2.1a"><mi id="S5.SS1.p2.2.m2.1.1" xref="S5.SS1.p2.2.m2.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.2.m2.1b"><ci id="S5.SS1.p2.2.m2.1.1.cmml" xref="S5.SS1.p2.2.m2.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.2.m2.1c">b</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p2.2.m2.1d">italic_b</annotation></semantics></math> is the total number of transformer blocks. Since outlier tokens are nearly consistent across layers that contain them, we set the number of outlier tokens as <math alttext="o=\lceil\max(\mathbf{O})\rceil" class="ltx_Math" display="inline" id="S5.SS1.p2.3.m3.3"><semantics id="S5.SS1.p2.3.m3.3a"><mrow id="S5.SS1.p2.3.m3.3.3" xref="S5.SS1.p2.3.m3.3.3.cmml"><mi id="S5.SS1.p2.3.m3.3.3.3" xref="S5.SS1.p2.3.m3.3.3.3.cmml">o</mi><mo id="S5.SS1.p2.3.m3.3.3.2" xref="S5.SS1.p2.3.m3.3.3.2.cmml">=</mo><mrow id="S5.SS1.p2.3.m3.3.3.1.1" xref="S5.SS1.p2.3.m3.3.3.1.2.cmml"><mo id="S5.SS1.p2.3.m3.3.3.1.1.2" stretchy="false" xref="S5.SS1.p2.3.m3.3.3.1.2.1.cmml">⌈</mo><mrow id="S5.SS1.p2.3.m3.3.3.1.1.1.2" xref="S5.SS1.p2.3.m3.3.3.1.1.1.1.cmml"><mi id="S5.SS1.p2.3.m3.1.1" xref="S5.SS1.p2.3.m3.1.1.cmml">max</mi><mo id="S5.SS1.p2.3.m3.3.3.1.1.1.2a" xref="S5.SS1.p2.3.m3.3.3.1.1.1.1.cmml">⁡</mo><mrow id="S5.SS1.p2.3.m3.3.3.1.1.1.2.1" xref="S5.SS1.p2.3.m3.3.3.1.1.1.1.cmml"><mo id="S5.SS1.p2.3.m3.3.3.1.1.1.2.1.1" stretchy="false" xref="S5.SS1.p2.3.m3.3.3.1.1.1.1.cmml">(</mo><mi id="S5.SS1.p2.3.m3.2.2" xref="S5.SS1.p2.3.m3.2.2.cmml">𝐎</mi><mo id="S5.SS1.p2.3.m3.3.3.1.1.1.2.1.2" stretchy="false" xref="S5.SS1.p2.3.m3.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S5.SS1.p2.3.m3.3.3.1.1.3" stretchy="false" xref="S5.SS1.p2.3.m3.3.3.1.2.1.cmml">⌉</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.3.m3.3b"><apply id="S5.SS1.p2.3.m3.3.3.cmml" xref="S5.SS1.p2.3.m3.3.3"><eq id="S5.SS1.p2.3.m3.3.3.2.cmml" xref="S5.SS1.p2.3.m3.3.3.2"></eq><ci id="S5.SS1.p2.3.m3.3.3.3.cmml" xref="S5.SS1.p2.3.m3.3.3.3">𝑜</ci><apply id="S5.SS1.p2.3.m3.3.3.1.2.cmml" xref="S5.SS1.p2.3.m3.3.3.1.1"><ceiling id="S5.SS1.p2.3.m3.3.3.1.2.1.cmml" xref="S5.SS1.p2.3.m3.3.3.1.1.2"></ceiling><apply id="S5.SS1.p2.3.m3.3.3.1.1.1.1.cmml" xref="S5.SS1.p2.3.m3.3.3.1.1.1.2"><max id="S5.SS1.p2.3.m3.1.1.cmml" xref="S5.SS1.p2.3.m3.1.1"></max><ci id="S5.SS1.p2.3.m3.2.2.cmml" xref="S5.SS1.p2.3.m3.2.2">𝐎</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.3.m3.3c">o=\lceil\max(\mathbf{O})\rceil</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p2.3.m3.3d">italic_o = ⌈ roman_max ( bold_O ) ⌉</annotation></semantics></math>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS1.p3">
<p class="ltx_p" id="S5.SS1.p3.9"><span class="ltx_text ltx_font_bold" id="S5.SS1.p3.9.1">Which Tokens to Prefix?</span> Outlier tokens act as attention sinks&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Xiao et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib39" title="">2023b</a>)</cite>, occupying only a few tokens (<math alttext="1\sim 4" class="ltx_Math" display="inline" id="S5.SS1.p3.1.m1.1"><semantics id="S5.SS1.p3.1.m1.1a"><mrow id="S5.SS1.p3.1.m1.1.1" xref="S5.SS1.p3.1.m1.1.1.cmml"><mn id="S5.SS1.p3.1.m1.1.1.2" xref="S5.SS1.p3.1.m1.1.1.2.cmml">1</mn><mo id="S5.SS1.p3.1.m1.1.1.1" xref="S5.SS1.p3.1.m1.1.1.1.cmml">∼</mo><mn id="S5.SS1.p3.1.m1.1.1.3" xref="S5.SS1.p3.1.m1.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.1.m1.1b"><apply id="S5.SS1.p3.1.m1.1.1.cmml" xref="S5.SS1.p3.1.m1.1.1"><csymbol cd="latexml" id="S5.SS1.p3.1.m1.1.1.1.cmml" xref="S5.SS1.p3.1.m1.1.1.1">similar-to</csymbol><cn id="S5.SS1.p3.1.m1.1.1.2.cmml" type="integer" xref="S5.SS1.p3.1.m1.1.1.2">1</cn><cn id="S5.SS1.p3.1.m1.1.1.3.cmml" type="integer" xref="S5.SS1.p3.1.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.1.m1.1c">1\sim 4</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p3.1.m1.1d">1 ∼ 4</annotation></semantics></math>) to help the attention mechanism do nothing&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Bondarenko et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib5" title="">2024</a>; Sun et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib32" title="">2024</a>)</cite>. Given the outlier token number <math alttext="o" class="ltx_Math" display="inline" id="S5.SS1.p3.2.m2.1"><semantics id="S5.SS1.p3.2.m2.1a"><mi id="S5.SS1.p3.2.m2.1.1" xref="S5.SS1.p3.2.m2.1.1.cmml">o</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.2.m2.1b"><ci id="S5.SS1.p3.2.m2.1.1.cmml" xref="S5.SS1.p3.2.m2.1.1">𝑜</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.2.m2.1c">o</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p3.2.m2.1d">italic_o</annotation></semantics></math>, we find that prefixing the top-<math alttext="o" class="ltx_Math" display="inline" id="S5.SS1.p3.3.m3.1"><semantics id="S5.SS1.p3.3.m3.1a"><mi id="S5.SS1.p3.3.m3.1.1" xref="S5.SS1.p3.3.m3.1.1.cmml">o</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.3.m3.1b"><ci id="S5.SS1.p3.3.m3.1.1.cmml" xref="S5.SS1.p3.3.m3.1.1">𝑜</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.3.m3.1c">o</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p3.3.m3.1d">italic_o</annotation></semantics></math> high-frequency<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">*</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">*</sup><span class="ltx_tag ltx_tag_note">*</span>The frequencies are calculated without considering initial token.</span></span></span> outlier tokens and the special ‘[BOS]‘ token can successfully constrains the outliers in prefixed tokens as shown in Figure&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#S4.F4.sf3" title="In Figure 4 ‣ 4 Difficulty of Static Quantization ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">4(c)</span></a>. For special models (such as Llama-3-8B and Qwen-2-7B) with outlier tokens only in the initial tokens, we simply set the prefix token as “[BOS]”.
The detailed prefixed tokens for different models are illustrate in Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#S5.T1" title="Table 1 ‣ 5.1 Prefixed Outliers ‣ 5 PrefixQuant ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">1</span></a>. Considering the auto-regressive inference pipeline of LLMs, we store these prefix tokens in the KV cache to prevent generating new outlier tokens during inference. As shown in Figure&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#S3.F2.sf3" title="In Figure 2 ‣ 3 Preliminaries ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">2(c)</span></a> and Figure&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#S4.F3.sf3" title="In Figure 3 ‣ 4 Difficulty of Static Quantization ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">3(c)</span></a>, prefixing outliers in the KV cache reduces the <math alttext="\frac{\text{top-1}}{\text{median}}" class="ltx_Math" display="inline" id="S5.SS1.p3.4.m4.1"><semantics id="S5.SS1.p3.4.m4.1a"><mfrac id="S5.SS1.p3.4.m4.1.1" xref="S5.SS1.p3.4.m4.1.1.cmml"><mtext id="S5.SS1.p3.4.m4.1.1.2" xref="S5.SS1.p3.4.m4.1.1.2a.cmml">top-1</mtext><mtext id="S5.SS1.p3.4.m4.1.1.3" xref="S5.SS1.p3.4.m4.1.1.3a.cmml">median</mtext></mfrac><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.4.m4.1b"><apply id="S5.SS1.p3.4.m4.1.1.cmml" xref="S5.SS1.p3.4.m4.1.1"><divide id="S5.SS1.p3.4.m4.1.1.1.cmml" xref="S5.SS1.p3.4.m4.1.1"></divide><ci id="S5.SS1.p3.4.m4.1.1.2a.cmml" xref="S5.SS1.p3.4.m4.1.1.2"><mtext id="S5.SS1.p3.4.m4.1.1.2.cmml" mathsize="70%" xref="S5.SS1.p3.4.m4.1.1.2">top-1</mtext></ci><ci id="S5.SS1.p3.4.m4.1.1.3a.cmml" xref="S5.SS1.p3.4.m4.1.1.3"><mtext id="S5.SS1.p3.4.m4.1.1.3.cmml" mathsize="70%" xref="S5.SS1.p3.4.m4.1.1.3">median</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.4.m4.1c">\frac{\text{top-1}}{\text{median}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p3.4.m4.1d">divide start_ARG top-1 end_ARG start_ARG median end_ARG</annotation></semantics></math> ratio of down_proj inputs from 476 to 2.7 and the <math alttext="\frac{\text{median}}{\text{min-1}}" class="ltx_Math" display="inline" id="S5.SS1.p3.5.m5.1"><semantics id="S5.SS1.p3.5.m5.1a"><mfrac id="S5.SS1.p3.5.m5.1.1" xref="S5.SS1.p3.5.m5.1.1.cmml"><mtext id="S5.SS1.p3.5.m5.1.1.2" xref="S5.SS1.p3.5.m5.1.1.2a.cmml">median</mtext><mtext id="S5.SS1.p3.5.m5.1.1.3" xref="S5.SS1.p3.5.m5.1.1.3a.cmml">min-1</mtext></mfrac><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.5.m5.1b"><apply id="S5.SS1.p3.5.m5.1.1.cmml" xref="S5.SS1.p3.5.m5.1.1"><divide id="S5.SS1.p3.5.m5.1.1.1.cmml" xref="S5.SS1.p3.5.m5.1.1"></divide><ci id="S5.SS1.p3.5.m5.1.1.2a.cmml" xref="S5.SS1.p3.5.m5.1.1.2"><mtext id="S5.SS1.p3.5.m5.1.1.2.cmml" mathsize="70%" xref="S5.SS1.p3.5.m5.1.1.2">median</mtext></ci><ci id="S5.SS1.p3.5.m5.1.1.3a.cmml" xref="S5.SS1.p3.5.m5.1.1.3"><mtext id="S5.SS1.p3.5.m5.1.1.3.cmml" mathsize="70%" xref="S5.SS1.p3.5.m5.1.1.3">min-1</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.5.m5.1c">\frac{\text{median}}{\text{min-1}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p3.5.m5.1d">divide start_ARG median end_ARG start_ARG min-1 end_ARG</annotation></semantics></math> ratio of <math alttext="\mathbf{Q}" class="ltx_Math" display="inline" id="S5.SS1.p3.6.m6.1"><semantics id="S5.SS1.p3.6.m6.1a"><mi id="S5.SS1.p3.6.m6.1.1" xref="S5.SS1.p3.6.m6.1.1.cmml">𝐐</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.6.m6.1b"><ci id="S5.SS1.p3.6.m6.1.1.cmml" xref="S5.SS1.p3.6.m6.1.1">𝐐</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.6.m6.1c">\mathbf{Q}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p3.6.m6.1d">bold_Q</annotation></semantics></math>/<math alttext="\mathbf{K}" class="ltx_Math" display="inline" id="S5.SS1.p3.7.m7.1"><semantics id="S5.SS1.p3.7.m7.1a"><mi id="S5.SS1.p3.7.m7.1.1" xref="S5.SS1.p3.7.m7.1.1.cmml">𝐊</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.7.m7.1b"><ci id="S5.SS1.p3.7.m7.1.1.cmml" xref="S5.SS1.p3.7.m7.1.1">𝐊</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.7.m7.1c">\mathbf{K}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p3.7.m7.1d">bold_K</annotation></semantics></math> from <math alttext=">9" class="ltx_Math" display="inline" id="S5.SS1.p3.8.m8.1"><semantics id="S5.SS1.p3.8.m8.1a"><mrow id="S5.SS1.p3.8.m8.1.1" xref="S5.SS1.p3.8.m8.1.1.cmml"><mi id="S5.SS1.p3.8.m8.1.1.2" xref="S5.SS1.p3.8.m8.1.1.2.cmml"></mi><mo id="S5.SS1.p3.8.m8.1.1.1" xref="S5.SS1.p3.8.m8.1.1.1.cmml">&gt;</mo><mn id="S5.SS1.p3.8.m8.1.1.3" xref="S5.SS1.p3.8.m8.1.1.3.cmml">9</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.8.m8.1b"><apply id="S5.SS1.p3.8.m8.1.1.cmml" xref="S5.SS1.p3.8.m8.1.1"><gt id="S5.SS1.p3.8.m8.1.1.1.cmml" xref="S5.SS1.p3.8.m8.1.1.1"></gt><csymbol cd="latexml" id="S5.SS1.p3.8.m8.1.1.2.cmml" xref="S5.SS1.p3.8.m8.1.1.2">absent</csymbol><cn id="S5.SS1.p3.8.m8.1.1.3.cmml" type="integer" xref="S5.SS1.p3.8.m8.1.1.3">9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.8.m8.1c">&gt;9</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p3.8.m8.1d">&gt; 9</annotation></semantics></math> to <math alttext="<3.5" class="ltx_Math" display="inline" id="S5.SS1.p3.9.m9.1"><semantics id="S5.SS1.p3.9.m9.1a"><mrow id="S5.SS1.p3.9.m9.1.1" xref="S5.SS1.p3.9.m9.1.1.cmml"><mi id="S5.SS1.p3.9.m9.1.1.2" xref="S5.SS1.p3.9.m9.1.1.2.cmml"></mi><mo id="S5.SS1.p3.9.m9.1.1.1" xref="S5.SS1.p3.9.m9.1.1.1.cmml">&lt;</mo><mn id="S5.SS1.p3.9.m9.1.1.3" xref="S5.SS1.p3.9.m9.1.1.3.cmml">3.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.9.m9.1b"><apply id="S5.SS1.p3.9.m9.1.1.cmml" xref="S5.SS1.p3.9.m9.1.1"><lt id="S5.SS1.p3.9.m9.1.1.1.cmml" xref="S5.SS1.p3.9.m9.1.1.1"></lt><csymbol cd="latexml" id="S5.SS1.p3.9.m9.1.1.2.cmml" xref="S5.SS1.p3.9.m9.1.1.2">absent</csymbol><cn id="S5.SS1.p3.9.m9.1.1.3.cmml" type="float" xref="S5.SS1.p3.9.m9.1.1.3">3.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.9.m9.1c">&lt;3.5</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p3.9.m9.1d">&lt; 3.5</annotation></semantics></math>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="S5.T2">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T2.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T2.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S5.T2.1.1.1" rowspan="2" style="padding:-3pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.1.1.1.1">PPL <math alttext="\downarrow" class="ltx_Math" display="inline" id="S5.T2.1.1.1.1.1.m1.1"><semantics id="S5.T2.1.1.1.1.1.m1.1a"><mo id="S5.T2.1.1.1.1.1.m1.1.1" stretchy="false" xref="S5.T2.1.1.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T2.1.1.1.1.1.m1.1b"><ci id="S5.T2.1.1.1.1.1.m1.1.1.cmml" xref="S5.T2.1.1.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.1.1.1.1.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T2.1.1.1.1.1.m1.1d">↓</annotation></semantics></math></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T2.1.1.2" rowspan="2" style="padding:-3pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.1.1.2.1">FP16</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3" id="S5.T2.1.1.3" style="padding:-3pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.1.1.3.1">W16A4KV16 (static)</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3" id="S5.T2.1.1.4" style="padding:-3pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.1.1.4.1">W16A16KV4 (static)</span></th>
</tr>
<tr class="ltx_tr" id="S5.T2.1.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T2.1.2.1.1" style="padding:-3pt 2.0pt;">original</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T2.1.2.1.2" style="padding:-3pt 2.0pt;">+ rotation</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T2.1.2.1.3" style="padding:-3pt 2.0pt;">+ prefixed</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T2.1.2.1.4" style="padding:-3pt 2.0pt;">original</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T2.1.2.1.5" style="padding:-3pt 2.0pt;">+ rotation</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T2.1.2.1.6" style="padding:-3pt 2.0pt;">+ prefixed</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T2.1.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T2.1.3.1.1" style="padding:-3pt 2.0pt;">Llama-2-7B</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.3.1.2" style="padding:-3pt 2.0pt;">5.47</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.3.1.3" style="padding:-3pt 2.0pt;">3024.77</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.3.1.4" style="padding:-3pt 2.0pt;">17.95</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.3.1.5" style="padding:-3pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.1.3.1.5.1">5.91</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.3.1.6" style="padding:-3pt 2.0pt;">6.46</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.3.1.7" style="padding:-3pt 2.0pt;">5.95</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.3.1.8" style="padding:-3pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.1.3.1.8.1">5.56</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.4.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S5.T2.1.4.2.1" style="padding:-3pt 2.0pt;">Llama-3-8B</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.1.4.2.2" style="padding:-3pt 2.0pt;">6.14</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.1.4.2.3" style="padding:-3pt 2.0pt;">1816.57</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.1.4.2.4" style="padding:-3pt 2.0pt;">22.14</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.1.4.2.5" style="padding:-3pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.1.4.2.5.1">7.23</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.1.4.2.6" style="padding:-3pt 2.0pt;">7.37</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.1.4.2.7" style="padding:-3pt 2.0pt;">8.12</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.1.4.2.8" style="padding:-3pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.1.4.2.8.1">6.30</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span> Proposed prefixed outliers in KV cache significantly improves the performance of the static quantized models over hadamard rotation&nbsp;<cite class="ltx_cite ltx_citemacro_cite">Ashkboos et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib3" title="">2024b</a>); Liu et&nbsp;al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib22" title="">2024a</a>)</cite>. W16A4KV16 indicates 4-bit per-tensor static quantization of all linear layer inputs. W16A16KV4 indicates 4-bit per-head static KV cache quantization. WikiText2 perplexity with 2048 context length is reported.
</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S5.SS1.p4">
<p class="ltx_p" id="S5.SS1.p4.1"><span class="ltx_text ltx_font_bold" id="S5.SS1.p4.1.1">Quantitative Analysis.</span> Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#S5.T2" title="Table 2 ‣ 5.1 Prefixed Outliers ‣ 5 PrefixQuant ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">2</span></a> presents separate performance of static quantization on input activation and KV cache quantization. We can find that the model suffers significant performance degradation with static quantization becuase of outlier tokens. For example, in Llama-3-8B, WikiText2 perplexity increases from 6.14 to 22.14 with 4-bit per-tensor activation quantization and from 6.14 to 8.12 with 4-bit per-head static KV cache quantization even with Hadamard rotation. After further setting prefix outliers in the KV cache, performance significantly improves: perplexity of 4-bit per-tensor activation decreases to 7.23 and perplexity of 4-bit per-head static KV cache quantization decreases to 6.30, demonstrating the effectiveness of prefixed outlier
tokens for static quantization.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Block-wise Fine-tuning</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1">Recent studies demonstrate that block-wise fine-tuning&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Shao et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib29" title="">2023</a>; Chen et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib7" title="">2024a</a>)</cite> enhances performance by considering inter-layer interactions&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Li et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib17" title="">2021</a>)</cite>. We initialize all quantization parameters using grid search&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Lin et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib19" title="">2023</a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib20" title="">2024b</a>)</cite> and then fine-tune each transformer block with mean square error loss sequentially.
For trainable parameters, we follow EfficientQAT&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Chen et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib7" title="">2024a</a>)</cite> by activating the training of all quantization parameters and original full-precision weights. Additionally, unlike dynamic activation quantization, the offline pre-computed quantization parameters of static activation quantization are inherently trainable.
To maintain simplicity, we use block-wise quantization in this work and leave the end-to-end finr-tuning of EfficientQAT&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Chen et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib7" title="">2024a</a>)</cite> for future performance improvements.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="S5.T3">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3: </span>W4A4KV4 results. Perplexity is measured with context length 2048. “Avg. Acc.” indicates the average zero-shot accuracy on 5 common-sense reasoning tasks. “Quant Type” is used to indicate whether the activation and kv cache quantization are dynamic or static.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T3.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T3.1.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_tt" id="S5.T3.1.2.1.1" style="padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.2.1.1.1">Model</span></th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T3.1.2.1.2" style="padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.2.1.2.1">Method</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T3.1.2.1.3" style="padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.2.1.3.1">Quant Type</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T3.1.2.1.4" style="padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.2.1.4.1">Wiki PPl</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T3.1.2.1.5" style="padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.2.1.5.1">Avg. Acc.</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.3.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S5.T3.1.3.2.1" style="padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S5.T3.1.3.2.1.1">Llama-2-7B</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.3.2.2" style="padding-top:-3pt;padding-bottom:-3pt;">FP16</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.3.2.3" style="padding-top:-3pt;padding-bottom:-3pt;">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.3.2.4" style="padding-top:-3pt;padding-bottom:-3pt;">5.47</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.3.2.5" style="padding-top:-3pt;padding-bottom:-3pt;">69.04</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.4.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S5.T3.1.4.3.1" style="padding-top:-3pt;padding-bottom:-3pt;">
<span class="ltx_ERROR undefined" id="S5.T3.1.4.3.1.1">\cdashline</span>2-5</th>
<td class="ltx_td ltx_align_center" id="S5.T3.1.4.3.2" style="padding-top:-3pt;padding-bottom:-3pt;">Atom</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.4.3.3" style="padding-top:-3pt;padding-bottom:-3pt;">dynamic</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.4.3.4" style="padding-top:-3pt;padding-bottom:-3pt;">6.12</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.4.3.5" style="padding-top:-3pt;padding-bottom:-3pt;">59.73</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.5.4">
<th class="ltx_td ltx_th ltx_th_row" id="S5.T3.1.5.4.1" style="padding-top:-3pt;padding-bottom:-3pt;"></th>
<td class="ltx_td ltx_align_center" id="S5.T3.1.5.4.2" style="padding-top:-3pt;padding-bottom:-3pt;">QuaRot</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.5.4.3" style="padding-top:-3pt;padding-bottom:-3pt;">dynamic</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.5.4.4" style="padding-top:-3pt;padding-bottom:-3pt;">6.19</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.5.4.5" style="padding-top:-3pt;padding-bottom:-3pt;">64.69</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.6.5">
<th class="ltx_td ltx_th ltx_th_row" id="S5.T3.1.6.5.1" style="padding-top:-3pt;padding-bottom:-3pt;"></th>
<td class="ltx_td ltx_align_center" id="S5.T3.1.6.5.2" style="padding-top:-3pt;padding-bottom:-3pt;">DuQuant</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.6.5.3" style="padding-top:-3pt;padding-bottom:-3pt;">dynamic</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.6.5.4" style="padding-top:-3pt;padding-bottom:-3pt;">6.20</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.6.5.5" style="padding-top:-3pt;padding-bottom:-3pt;">66.25</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.7.6">
<th class="ltx_td ltx_th ltx_th_row" id="S5.T3.1.7.6.1" style="padding-top:-3pt;padding-bottom:-3pt;"></th>
<td class="ltx_td ltx_align_center" id="S5.T3.1.7.6.2" style="padding-top:-3pt;padding-bottom:-3pt;">SpinQuant</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.7.6.3" style="padding-top:-3pt;padding-bottom:-3pt;">dynamic</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.7.6.4" style="padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S5.T3.1.7.6.4.1" style="color:#808080;">5.95</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.7.6.5" style="padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S5.T3.1.7.6.5.1" style="color:#808080;">65.35</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.8.7">
<th class="ltx_td ltx_th ltx_th_row" id="S5.T3.1.8.7.1" style="padding-top:-3pt;padding-bottom:-3pt;"></th>
<td class="ltx_td ltx_align_center" id="S5.T3.1.8.7.2" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S5.T3.1.8.7.2.1" style="background-color:#D3EFF1;">PrefixQuant w/o FT</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.8.7.3" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S5.T3.1.8.7.3.1" style="background-color:#D3EFF1;">static</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.8.7.4" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S5.T3.1.8.7.4.1" style="background-color:#D3EFF1;">6.22</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.8.7.5" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S5.T3.1.8.7.5.1" style="background-color:#D3EFF1;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.8.7.5.1.1">66.84</span></span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.9.8">
<th class="ltx_td ltx_th ltx_th_row" id="S5.T3.1.9.8.1" style="padding-top:-3pt;padding-bottom:-3pt;"></th>
<td class="ltx_td ltx_align_center" id="S5.T3.1.9.8.2" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S5.T3.1.9.8.2.1" style="background-color:#D3EFF1;">PrefixQuant</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.9.8.3" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S5.T3.1.9.8.3.1" style="background-color:#D3EFF1;">static</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.9.8.4" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S5.T3.1.9.8.4.1" style="background-color:#D3EFF1;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.9.8.4.1.1">6.01</span></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.9.8.5" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S5.T3.1.9.8.5.1" style="background-color:#D3EFF1;">66.37</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.10.9">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S5.T3.1.10.9.1" style="padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S5.T3.1.10.9.1.1">Llama-2-13B</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.10.9.2" style="padding-top:-3pt;padding-bottom:-3pt;">FP16</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.10.9.3" style="padding-top:-3pt;padding-bottom:-3pt;">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.10.9.4" style="padding-top:-3pt;padding-bottom:-3pt;">4.88</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.10.9.5" style="padding-top:-3pt;padding-bottom:-3pt;">71.73</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.11.10">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S5.T3.1.11.10.1" style="padding-top:-3pt;padding-bottom:-3pt;">
<span class="ltx_ERROR undefined" id="S5.T3.1.11.10.1.1">\cdashline</span>2-5</th>
<td class="ltx_td ltx_align_center" id="S5.T3.1.11.10.2" style="padding-top:-3pt;padding-bottom:-3pt;">Atom</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.11.10.3" style="padding-top:-3pt;padding-bottom:-3pt;">dynamic</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.11.10.4" style="padding-top:-3pt;padding-bottom:-3pt;">5.31</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.11.10.5" style="padding-top:-3pt;padding-bottom:-3pt;">63.51</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.12.11">
<th class="ltx_td ltx_th ltx_th_row" id="S5.T3.1.12.11.1" style="padding-top:-3pt;padding-bottom:-3pt;"></th>
<td class="ltx_td ltx_align_center" id="S5.T3.1.12.11.2" style="padding-top:-3pt;padding-bottom:-3pt;">QuaRot</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.12.11.3" style="padding-top:-3pt;padding-bottom:-3pt;">dynamic</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.12.11.4" style="padding-top:-3pt;padding-bottom:-3pt;">5.45</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.12.11.5" style="padding-top:-3pt;padding-bottom:-3pt;">69.01</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.13.12">
<th class="ltx_td ltx_th ltx_th_row" id="S5.T3.1.13.12.1" style="padding-top:-3pt;padding-bottom:-3pt;"></th>
<td class="ltx_td ltx_align_center" id="S5.T3.1.13.12.2" style="padding-top:-3pt;padding-bottom:-3pt;">DuQuant</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.13.12.3" style="padding-top:-3pt;padding-bottom:-3pt;">dynamic</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.13.12.4" style="padding-top:-3pt;padding-bottom:-3pt;">5.39</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.13.12.5" style="padding-top:-3pt;padding-bottom:-3pt;">69.13</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.14.13">
<th class="ltx_td ltx_th ltx_th_row" id="S5.T3.1.14.13.1" style="padding-top:-3pt;padding-bottom:-3pt;"></th>
<td class="ltx_td ltx_align_center" id="S5.T3.1.14.13.2" style="padding-top:-3pt;padding-bottom:-3pt;">SpinQuant</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.14.13.3" style="padding-top:-3pt;padding-bottom:-3pt;">dynamic</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.14.13.4" style="padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S5.T3.1.14.13.4.1" style="color:#808080;">5.24</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.14.13.5" style="padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S5.T3.1.14.13.5.1" style="color:#808080;">69.24</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.15.14">
<th class="ltx_td ltx_th ltx_th_row" id="S5.T3.1.15.14.1" style="padding-top:-3pt;padding-bottom:-3pt;"></th>
<td class="ltx_td ltx_align_center" id="S5.T3.1.15.14.2" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S5.T3.1.15.14.2.1" style="background-color:#D3EFF1;">PrefixQuant w/o FT</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.15.14.3" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S5.T3.1.15.14.3.1" style="background-color:#D3EFF1;">static</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.15.14.4" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S5.T3.1.15.14.4.1" style="background-color:#D3EFF1;">5.50</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.15.14.5" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;">&nbsp;<span class="ltx_text" id="S5.T3.1.15.14.5.1" style="background-color:#D3EFF1;"> 69.92</span>
</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.16.15">
<th class="ltx_td ltx_th ltx_th_row" id="S5.T3.1.16.15.1" style="padding-top:-3pt;padding-bottom:-3pt;"></th>
<td class="ltx_td ltx_align_center" id="S5.T3.1.16.15.2" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S5.T3.1.16.15.2.1" style="background-color:#D3EFF1;">PrefixQuant</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.16.15.3" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S5.T3.1.16.15.3.1" style="background-color:#D3EFF1;">static</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.16.15.4" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S5.T3.1.16.15.4.1" style="background-color:#D3EFF1;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.16.15.4.1.1">5.32</span></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.16.15.5" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S5.T3.1.16.15.5.1" style="background-color:#D3EFF1;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.16.15.5.1.1">70.36</span></span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.17.16">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S5.T3.1.17.16.1" style="padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S5.T3.1.17.16.1.1">Llama-2-70B</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.17.16.2" style="padding-top:-3pt;padding-bottom:-3pt;">FP16</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.17.16.3" style="padding-top:-3pt;padding-bottom:-3pt;">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.17.16.4" style="padding-top:-3pt;padding-bottom:-3pt;">3.32</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.17.16.5" style="padding-top:-3pt;padding-bottom:-3pt;">76.72</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.18.17">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S5.T3.1.18.17.1" style="padding-top:-3pt;padding-bottom:-3pt;">
<span class="ltx_ERROR undefined" id="S5.T3.1.18.17.1.1">\cdashline</span>2-5</th>
<td class="ltx_td ltx_align_center" id="S5.T3.1.18.17.2" style="padding-top:-3pt;padding-bottom:-3pt;">Atom</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.18.17.3" style="padding-top:-3pt;padding-bottom:-3pt;">dynamic</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.18.17.4" style="padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.18.17.4.1">3.73</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.18.17.5" style="padding-top:-3pt;padding-bottom:-3pt;">67.52</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.19.18">
<th class="ltx_td ltx_th ltx_th_row" id="S5.T3.1.19.18.1" style="padding-top:-3pt;padding-bottom:-3pt;"></th>
<td class="ltx_td ltx_align_center" id="S5.T3.1.19.18.2" style="padding-top:-3pt;padding-bottom:-3pt;">QuaRot</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.19.18.3" style="padding-top:-3pt;padding-bottom:-3pt;">dynamic</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.19.18.4" style="padding-top:-3pt;padding-bottom:-3pt;">3.83</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.19.18.5" style="padding-top:-3pt;padding-bottom:-3pt;">75.43</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.20.19">
<th class="ltx_td ltx_th ltx_th_row" id="S5.T3.1.20.19.1" style="padding-top:-3pt;padding-bottom:-3pt;"></th>
<td class="ltx_td ltx_align_center" id="S5.T3.1.20.19.2" style="padding-top:-3pt;padding-bottom:-3pt;">DuQuant</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.20.19.3" style="padding-top:-3pt;padding-bottom:-3pt;">dynamic</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.20.19.4" style="padding-top:-3pt;padding-bottom:-3pt;">3.77</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.20.19.5" style="padding-top:-3pt;padding-bottom:-3pt;">74.75</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.21.20">
<th class="ltx_td ltx_th ltx_th_row" id="S5.T3.1.21.20.1" style="padding-top:-3pt;padding-bottom:-3pt;"></th>
<td class="ltx_td ltx_align_center" id="S5.T3.1.21.20.2" style="padding-top:-3pt;padding-bottom:-3pt;">SpinQuant</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.21.20.3" style="padding-top:-3pt;padding-bottom:-3pt;">dynamic</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.21.20.4" style="padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S5.T3.1.21.20.4.1" style="color:#808080;">3.70</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.21.20.5" style="padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S5.T3.1.21.20.5.1" style="color:#808080;">75.19</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.22.21">
<th class="ltx_td ltx_th ltx_th_row" id="S5.T3.1.22.21.1" style="padding-top:-3pt;padding-bottom:-3pt;"></th>
<td class="ltx_td ltx_align_center" id="S5.T3.1.22.21.2" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S5.T3.1.22.21.2.1" style="background-color:#D3EFF1;">PrefixQuant w/o FT</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.22.21.3" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S5.T3.1.22.21.3.1" style="background-color:#D3EFF1;">static</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.22.21.4" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S5.T3.1.22.21.4.1" style="background-color:#D3EFF1;">4.41</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.22.21.5" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S5.T3.1.22.21.5.1" style="background-color:#D3EFF1;">73.29</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.23.22">
<th class="ltx_td ltx_th ltx_th_row" id="S5.T3.1.23.22.1" style="padding-top:-3pt;padding-bottom:-3pt;"></th>
<td class="ltx_td ltx_align_center" id="S5.T3.1.23.22.2" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S5.T3.1.23.22.2.1" style="background-color:#D3EFF1;">PrefixQuant</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.23.22.3" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S5.T3.1.23.22.3.1" style="background-color:#D3EFF1;">static</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.23.22.4" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S5.T3.1.23.22.4.1" style="background-color:#D3EFF1;">3.81</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.23.22.5" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S5.T3.1.23.22.5.1" style="background-color:#D3EFF1;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.23.22.5.1.1">75.48</span></span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.24.23">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S5.T3.1.24.23.1" style="padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S5.T3.1.24.23.1.1">Llama-3-8B</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.24.23.2" style="padding-top:-3pt;padding-bottom:-3pt;">FP16</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.24.23.3" style="padding-top:-3pt;padding-bottom:-3pt;">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.24.23.4" style="padding-top:-3pt;padding-bottom:-3pt;">6.14</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.24.23.5" style="padding-top:-3pt;padding-bottom:-3pt;">72.71</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.25.24">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S5.T3.1.25.24.1" style="padding-top:-3pt;padding-bottom:-3pt;">
<span class="ltx_ERROR undefined" id="S5.T3.1.25.24.1.1">\cdashline</span>2-5</th>
<td class="ltx_td ltx_align_center" id="S5.T3.1.25.24.2" style="padding-top:-3pt;padding-bottom:-3pt;">Atom</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.25.24.3" style="padding-top:-3pt;padding-bottom:-3pt;">dynamic</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.25.24.4" style="padding-top:-3pt;padding-bottom:-3pt;">7.76</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.25.24.5" style="padding-top:-3pt;padding-bottom:-3pt;">-</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.26.25">
<th class="ltx_td ltx_th ltx_th_row" id="S5.T3.1.26.25.1" style="padding-top:-3pt;padding-bottom:-3pt;"></th>
<td class="ltx_td ltx_align_center" id="S5.T3.1.26.25.2" style="padding-top:-3pt;padding-bottom:-3pt;">QuaRot</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.26.25.3" style="padding-top:-3pt;padding-bottom:-3pt;">dynamic</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.26.25.4" style="padding-top:-3pt;padding-bottom:-3pt;">8.41</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.26.25.5" style="padding-top:-3pt;padding-bottom:-3pt;">65.15</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.27.26">
<th class="ltx_td ltx_th ltx_th_row" id="S5.T3.1.27.26.1" style="padding-top:-3pt;padding-bottom:-3pt;"></th>
<td class="ltx_td ltx_align_center" id="S5.T3.1.27.26.2" style="padding-top:-3pt;padding-bottom:-3pt;">DuQuant</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.27.26.3" style="padding-top:-3pt;padding-bottom:-3pt;">dynamic</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.27.26.4" style="padding-top:-3pt;padding-bottom:-3pt;">8.14</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.27.26.5" style="padding-top:-3pt;padding-bottom:-3pt;">67.13</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.28.27">
<th class="ltx_td ltx_th ltx_th_row" id="S5.T3.1.28.27.1" style="padding-top:-3pt;padding-bottom:-3pt;"></th>
<td class="ltx_td ltx_align_center" id="S5.T3.1.28.27.2" style="padding-top:-3pt;padding-bottom:-3pt;">SpinQuant</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.28.27.3" style="padding-top:-3pt;padding-bottom:-3pt;">dynamic</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.28.27.4" style="padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S5.T3.1.28.27.4.1" style="color:#808080;">7.36</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.28.27.5" style="padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S5.T3.1.28.27.5.1" style="color:#808080;">68.23</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.29.28">
<th class="ltx_td ltx_th ltx_th_row" id="S5.T3.1.29.28.1" style="padding-top:-3pt;padding-bottom:-3pt;"></th>
<td class="ltx_td ltx_align_center" id="S5.T3.1.29.28.2" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S5.T3.1.29.28.2.1" style="background-color:#D3EFF1;">PrefixQuant w/o FT</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.29.28.3" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S5.T3.1.29.28.3.1" style="background-color:#D3EFF1;">static</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.29.28.4" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S5.T3.1.29.28.4.1" style="background-color:#D3EFF1;">7.93</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.29.28.5" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S5.T3.1.29.28.5.1" style="background-color:#D3EFF1;">68.37</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.30.29">
<th class="ltx_td ltx_th ltx_th_row" id="S5.T3.1.30.29.1" style="padding-top:-3pt;padding-bottom:-3pt;"></th>
<td class="ltx_td ltx_align_center" id="S5.T3.1.30.29.2" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S5.T3.1.30.29.2.1" style="background-color:#D3EFF1;">PrefixQuant</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.30.29.3" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S5.T3.1.30.29.3.1" style="background-color:#D3EFF1;">static</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.30.29.4" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S5.T3.1.30.29.4.1" style="background-color:#D3EFF1;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.30.29.4.1.1">7.43</span></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.30.29.5" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S5.T3.1.30.29.5.1" style="background-color:#D3EFF1;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.30.29.5.1.1">71.08</span></span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.31.30">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S5.T3.1.31.30.1" style="padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S5.T3.1.31.30.1.1">Llama-3-70B</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.31.30.2" style="padding-top:-3pt;padding-bottom:-3pt;">FP16</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.31.30.3" style="padding-top:-3pt;padding-bottom:-3pt;">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.31.30.4" style="padding-top:-3pt;padding-bottom:-3pt;">2.85</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.31.30.5" style="padding-top:-3pt;padding-bottom:-3pt;">80.03</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.32.31">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S5.T3.1.32.31.1" style="padding-top:-3pt;padding-bottom:-3pt;">
<span class="ltx_ERROR undefined" id="S5.T3.1.32.31.1.1">\cdashline</span>2-5</th>
<td class="ltx_td ltx_align_center" id="S5.T3.1.32.31.2" style="padding-top:-3pt;padding-bottom:-3pt;">QuaRot</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.32.31.3" style="padding-top:-3pt;padding-bottom:-3pt;">dynamic</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.32.31.4" style="padding-top:-3pt;padding-bottom:-3pt;">6.82</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.32.31.5" style="padding-top:-3pt;padding-bottom:-3pt;">68.39</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.33.32">
<th class="ltx_td ltx_th ltx_th_row" id="S5.T3.1.33.32.1" style="padding-top:-3pt;padding-bottom:-3pt;"></th>
<td class="ltx_td ltx_align_center" id="S5.T3.1.33.32.2" style="padding-top:-3pt;padding-bottom:-3pt;">DuQuant</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.33.32.3" style="padding-top:-3pt;padding-bottom:-3pt;">dynamic</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.33.32.4" style="padding-top:-3pt;padding-bottom:-3pt;">5.67</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.33.32.5" style="padding-top:-3pt;padding-bottom:-3pt;">74.89</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.34.33">
<th class="ltx_td ltx_th ltx_th_row" id="S5.T3.1.34.33.1" style="padding-top:-3pt;padding-bottom:-3pt;"></th>
<td class="ltx_td ltx_align_center" id="S5.T3.1.34.33.2" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S5.T3.1.34.33.2.1" style="background-color:#D3EFF1;">PrefixQuant w/o FT</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.34.33.3" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S5.T3.1.34.33.3.1" style="background-color:#D3EFF1;">static</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.34.33.4" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S5.T3.1.34.33.4.1" style="background-color:#D3EFF1;">5.23</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.34.33.5" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S5.T3.1.34.33.5.1" style="background-color:#D3EFF1;">76.40</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.35.34">
<th class="ltx_td ltx_th ltx_th_row" id="S5.T3.1.35.34.1" style="padding-top:-3pt;padding-bottom:-3pt;"></th>
<td class="ltx_td ltx_align_center" id="S5.T3.1.35.34.2" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S5.T3.1.35.34.2.1" style="background-color:#D3EFF1;">PrefixQuant</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.35.34.3" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S5.T3.1.35.34.3.1" style="background-color:#D3EFF1;">static</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.35.34.4" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S5.T3.1.35.34.4.1" style="background-color:#D3EFF1;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.35.34.4.1.1">4.41</span></span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.35.34.5" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S5.T3.1.35.34.5.1" style="background-color:#D3EFF1;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.35.34.5.1.1">77.18</span></span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.36.35">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" colspan="4" id="S5.T3.1.36.35.1" style="padding-top:-3pt;padding-bottom:-3pt;">* Grayed results use Wikitext2 as calibaration dataset.</th>
<td class="ltx_td ltx_border_tt" id="S5.T3.1.36.35.2" style="padding-top:-3pt;padding-bottom:-3pt;"></td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" colspan="4" id="S5.T3.1.1.1" style="padding-top:-3pt;padding-bottom:-3pt;">
<math alttext="\dagger" class="ltx_Math" display="inline" id="S5.T3.1.1.1.m1.1"><semantics id="S5.T3.1.1.1.m1.1a"><mo id="S5.T3.1.1.1.m1.1.1" xref="S5.T3.1.1.1.m1.1.1.cmml">†</mo><annotation-xml encoding="MathML-Content" id="S5.T3.1.1.1.m1.1b"><ci id="S5.T3.1.1.1.m1.1.1.cmml" xref="S5.T3.1.1.1.m1.1.1">†</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.1.1.1.m1.1c">\dagger</annotation><annotation encoding="application/x-llamapun" id="S5.T3.1.1.1.m1.1d">†</annotation></semantics></math> Atom apply 128 group size quantization to both weight and activations.</th>
<td class="ltx_td" id="S5.T3.1.1.2" style="padding-top:-3pt;padding-bottom:-3pt;"></td>
</tr>
</tbody>
</table>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Experiments</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsection" id="S6.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.1 </span>Setups</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S6.SS1.p1">
<p class="ltx_p" id="S6.SS1.p1.1"><span class="ltx_text ltx_font_bold" id="S6.SS1.p1.1.1">Baseline.</span> PrefixQuant is a versatile method applicable to any precision. We conduct experiments on three precisions: W8A8KV8, W4A8KV4, and W4A4KV4. In PrefixQuant, weight uses per-channel symmetric quantization. KV cache uses per-head symmetric static quantization for 4-bit and per-tensor symmetric static quantization for 8-bit. Activation (inputs of linear layers) uses per-tensor static quantization. We compare PrefixQuant with QuaRot&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Ashkboos et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib3" title="">2024b</a>)</cite>, Atom&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Zhao et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib43" title="">2023</a>)</cite>, DuQuant&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Lin et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib18" title="">2024a</a>)</cite>, QoQ&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Lin et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib20" title="">2024b</a>)</cite>, SmoothQuant&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Xiao et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib38" title="">2023a</a>)</cite> and SpinQuant&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Liu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib22" title="">2024a</a>)</cite>. Following QoQ, we reproduce all these methods except SpinQuant
with Pile&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Gao et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib13" title="">2020</a>)</cite> calibration dataset to avoid over-fitting for fair comparisons. The detailed quantization configuration and results sources of these comparison methods can be found at Sec.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A2" title="Appendix B Configuration and Data Sources of Comparison Methods ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">B</span></a>. Note that all comparison methods use dynamic quantization if without specific mentioned, and would suffer dramatic performance degeneration likes “+ static quantization” in Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#S6.T6" title="Table 6 ‣ 6.3 Inference Speed ‣ 6 Experiments ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">6</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S6.SS1.p2">
<p class="ltx_p" id="S6.SS1.p2.1"><span class="ltx_text ltx_font_bold" id="S6.SS1.p2.1.1">Models and datasets.</span> We evaluate PrefixQuant on the Llama-2, Llama-3, Llama-3-Instruct families, Mistral-7B-v0.3, and Qwen-2-7B models. Following previous literature&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Shao et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib29" title="">2023</a>; Lin et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib20" title="">2024b</a>)</cite>, we assess PrefixQuant quantized models on language modeling and zero-shot tasks. Specifically, we evaluate on WikiText2&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Merity et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib24" title="">2016</a>)</cite> with a 2048 context length for perplexity, and on PIQA&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Bisk et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib4" title="">2020</a>)</cite>, ARC&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Clark et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib9" title="">2018</a>)</cite>, HellaSwag&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Zellers et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib42" title="">2019</a>)</cite>, and WinoGrande&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Sakaguchi et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib27" title="">2021</a>)</cite> using <span class="ltx_text ltx_font_typewriter" id="S6.SS1.p2.1.2">lm_eval v0.4.2</span>&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Gao et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib14" title="">2024</a>)</cite>. For accuracy, we report <span class="ltx_text ltx_font_typewriter" id="S6.SS1.p2.1.3">acc</span> for WinoGrande and <span class="ltx_text ltx_font_typewriter" id="S6.SS1.p2.1.4">acc_norm</span> for HellaSwag, Arc_Challenge, Arc_Easy, and PIQA, following Qserve&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Lin et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib20" title="">2024b</a>)</cite><span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_tag ltx_tag_note">†</span>Some weight-only quantization works such as EfficientQAT&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Chen et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib7" title="">2024a</a>)</cite> and QuiP#&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Tseng et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib34" title="">2024</a>)</cite> report <span class="ltx_text ltx_font_typewriter" id="footnote2.1">acc</span> for all tasks.</span></span></span>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S6.SS1.p3">
<p class="ltx_p" id="S6.SS1.p3.1"><span class="ltx_text ltx_font_bold" id="S6.SS1.p3.1.1">Grid Search Setting.</span> For all experiments with static quantization, we initialize the quantization parameters through grid search on 8 Pile&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Gao et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib13" title="">2020</a>)</cite> samples with a 1024 sequence length. We minimize the layer outputs for fine-grained quantization (per-channel/per-head) and block outputs for per-tensor quantization. In the performance comparison tables, “PrefixQunt w/o FT” indicates finishing the quantization only with grid search and without fine-tuning.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S6.SS1.p4">
<p class="ltx_p" id="S6.SS1.p4.1"><span class="ltx_text ltx_font_bold" id="S6.SS1.p4.1.1">Fine-Tuning Setting.</span> During fine-tuning, we optimize block output mean square error following existing works&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Shao et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib29" title="">2023</a>; Chen et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib7" title="">2024a</a>)</cite>. The dataset for fine-tuning consists of 512 samples from Pile with a 1024 context length. The learning rates for quantization parameters (step sizes) and full-precision weights are set to 5e-5 and 5e-6, respectively, and to 2e-5 and 2e-6 for Llama-3-70B(-Instruct) models. The fine-tuning batch size is set to 4, and the number of epochs is set to 10 for W4A8KV4 and 20 for W4A4KV4.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="S6.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.2 </span>Comparison Results</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S6.SS2.p1">
<p class="ltx_p" id="S6.SS2.p1.4"><span class="ltx_text ltx_font_bold" id="S6.SS2.p1.4.1">Results on W4A4KV4.</span> Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#S5.T3" title="Table 3 ‣ 5.2 Block-wise Fine-tuning ‣ 5 PrefixQuant ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">3</span></a> shows the comparison results for W4A4KV4. PrefixQuant with static quantization significantly outperforms the previous state-of-the-art QuaRot, which uses dynamic quantization. For instance, in Llama-3-8B, PrefixQuant without fine-tuning surpasses QuaRot by <math alttext="0.48" class="ltx_Math" display="inline" id="S6.SS2.p1.1.m1.1"><semantics id="S6.SS2.p1.1.m1.1a"><mn id="S6.SS2.p1.1.m1.1.1" xref="S6.SS2.p1.1.m1.1.1.cmml">0.48</mn><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.1.m1.1b"><cn id="S6.SS2.p1.1.m1.1.1.cmml" type="float" xref="S6.SS2.p1.1.m1.1.1">0.48</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.1.m1.1c">0.48</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p1.1.m1.1d">0.48</annotation></semantics></math> in WikiText2 perplexity and <math alttext="+3.22" class="ltx_Math" display="inline" id="S6.SS2.p1.2.m2.1"><semantics id="S6.SS2.p1.2.m2.1a"><mrow id="S6.SS2.p1.2.m2.1.1" xref="S6.SS2.p1.2.m2.1.1.cmml"><mo id="S6.SS2.p1.2.m2.1.1a" xref="S6.SS2.p1.2.m2.1.1.cmml">+</mo><mn id="S6.SS2.p1.2.m2.1.1.2" xref="S6.SS2.p1.2.m2.1.1.2.cmml">3.22</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.2.m2.1b"><apply id="S6.SS2.p1.2.m2.1.1.cmml" xref="S6.SS2.p1.2.m2.1.1"><plus id="S6.SS2.p1.2.m2.1.1.1.cmml" xref="S6.SS2.p1.2.m2.1.1"></plus><cn id="S6.SS2.p1.2.m2.1.1.2.cmml" type="float" xref="S6.SS2.p1.2.m2.1.1.2">3.22</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.2.m2.1c">+3.22</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p1.2.m2.1d">+ 3.22</annotation></semantics></math> points in average accuracy. Fine-tuning further improves these results to <math alttext="0.98" class="ltx_Math" display="inline" id="S6.SS2.p1.3.m3.1"><semantics id="S6.SS2.p1.3.m3.1a"><mn id="S6.SS2.p1.3.m3.1.1" xref="S6.SS2.p1.3.m3.1.1.cmml">0.98</mn><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.3.m3.1b"><cn id="S6.SS2.p1.3.m3.1.1.cmml" type="float" xref="S6.SS2.p1.3.m3.1.1">0.98</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.3.m3.1c">0.98</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p1.3.m3.1d">0.98</annotation></semantics></math> in WikiText2 perplexity and <math alttext="+5.98" class="ltx_Math" display="inline" id="S6.SS2.p1.4.m4.1"><semantics id="S6.SS2.p1.4.m4.1a"><mrow id="S6.SS2.p1.4.m4.1.1" xref="S6.SS2.p1.4.m4.1.1.cmml"><mo id="S6.SS2.p1.4.m4.1.1a" xref="S6.SS2.p1.4.m4.1.1.cmml">+</mo><mn id="S6.SS2.p1.4.m4.1.1.2" xref="S6.SS2.p1.4.m4.1.1.2.cmml">5.98</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.4.m4.1b"><apply id="S6.SS2.p1.4.m4.1.1.cmml" xref="S6.SS2.p1.4.m4.1.1"><plus id="S6.SS2.p1.4.m4.1.1.1.cmml" xref="S6.SS2.p1.4.m4.1.1"></plus><cn id="S6.SS2.p1.4.m4.1.1.2.cmml" type="float" xref="S6.SS2.p1.4.m4.1.1.2">5.98</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.4.m4.1c">+5.98</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p1.4.m4.1d">+ 5.98</annotation></semantics></math> points in average accuracy.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="S6.T4">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>W4A8KV4 results. Refer Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#S5.T3" title="Table 3 ‣ 5.2 Block-wise Fine-tuning ‣ 5 PrefixQuant ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">3</span></a> for the metric setting and performance of full-precision models.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S6.T4.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S6.T4.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T4.1.1.1.1" style="padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text ltx_font_bold" id="S6.T4.1.1.1.1.1">Model</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T4.1.1.1.2" style="padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text ltx_font_bold" id="S6.T4.1.1.1.2.1">Method</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T4.1.1.1.3" style="padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text ltx_font_bold" id="S6.T4.1.1.1.3.1">Activation Quant</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T4.1.1.1.4" style="padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text ltx_font_bold" id="S6.T4.1.1.1.4.1">Wiki PPl</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T4.1.1.1.5" style="padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text ltx_font_bold" id="S6.T4.1.1.1.5.1">Avg. Acc.</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T4.1.2.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.1.2.1.1" rowspan="4" style="padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S6.T4.1.2.1.1.1">Llama-2-7B</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.1.2.1.2" style="padding-top:-3pt;padding-bottom:-3pt;">QoQ</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.1.2.1.3" style="padding-top:-3pt;padding-bottom:-3pt;">dynamic</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.1.2.1.4" style="padding-top:-3pt;padding-bottom:-3pt;">5.75</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.1.2.1.5" style="padding-top:-3pt;padding-bottom:-3pt;">67.22</td>
</tr>
<tr class="ltx_tr" id="S6.T4.1.3.2">
<td class="ltx_td ltx_align_center" id="S6.T4.1.3.2.1" style="padding-top:-3pt;padding-bottom:-3pt;">QuaRot</td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.3.2.2" style="padding-top:-3pt;padding-bottom:-3pt;">dynamic</td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.3.2.3" style="padding-top:-3pt;padding-bottom:-3pt;">5.73</td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.3.2.4" style="padding-top:-3pt;padding-bottom:-3pt;">67.11</td>
</tr>
<tr class="ltx_tr" id="S6.T4.1.4.3">
<td class="ltx_td ltx_align_center" id="S6.T4.1.4.3.1" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S6.T4.1.4.3.1.1" style="background-color:#D3EFF1;">PrefixQuant w/o FT</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.4.3.2" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S6.T4.1.4.3.2.1" style="background-color:#D3EFF1;">static</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.4.3.3" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S6.T4.1.4.3.3.1" style="background-color:#D3EFF1;">5.76</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.4.3.4" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S6.T4.1.4.3.4.1" style="background-color:#D3EFF1;">67.86</span></td>
</tr>
<tr class="ltx_tr" id="S6.T4.1.5.4">
<td class="ltx_td ltx_align_center" id="S6.T4.1.5.4.1" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S6.T4.1.5.4.1.1" style="background-color:#D3EFF1;">PrefixQuant</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.5.4.2" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S6.T4.1.5.4.2.1" style="background-color:#D3EFF1;">static</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.5.4.3" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S6.T4.1.5.4.3.1" style="background-color:#D3EFF1;"><span class="ltx_text ltx_font_bold" id="S6.T4.1.5.4.3.1.1">5.68</span></span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.5.4.4" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S6.T4.1.5.4.4.1" style="background-color:#D3EFF1;"><span class="ltx_text ltx_font_bold" id="S6.T4.1.5.4.4.1.1">68.90</span></span></td>
</tr>
<tr class="ltx_tr" id="S6.T4.1.6.5">
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.1.6.5.1" rowspan="4" style="padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S6.T4.1.6.5.1.1">Llama-2-13B</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.1.6.5.2" style="padding-top:-3pt;padding-bottom:-3pt;">QoQ</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.1.6.5.3" style="padding-top:-3pt;padding-bottom:-3pt;">dynamic</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.1.6.5.4" style="padding-top:-3pt;padding-bottom:-3pt;">5.12</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.1.6.5.5" style="padding-top:-3pt;padding-bottom:-3pt;">70.56</td>
</tr>
<tr class="ltx_tr" id="S6.T4.1.7.6">
<td class="ltx_td ltx_align_center" id="S6.T4.1.7.6.1" style="padding-top:-3pt;padding-bottom:-3pt;">QuaRot</td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.7.6.2" style="padding-top:-3pt;padding-bottom:-3pt;">dynamic</td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.7.6.3" style="padding-top:-3pt;padding-bottom:-3pt;">5.07</td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.7.6.4" style="padding-top:-3pt;padding-bottom:-3pt;">69.96</td>
</tr>
<tr class="ltx_tr" id="S6.T4.1.8.7">
<td class="ltx_td ltx_align_center" id="S6.T4.1.8.7.1" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S6.T4.1.8.7.1.1" style="background-color:#D3EFF1;">PrefixQuant w/o FT</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.8.7.2" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S6.T4.1.8.7.2.1" style="background-color:#D3EFF1;">static</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.8.7.3" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S6.T4.1.8.7.3.1" style="background-color:#D3EFF1;">5.08</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.8.7.4" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S6.T4.1.8.7.4.1" style="background-color:#D3EFF1;">71.07</span></td>
</tr>
<tr class="ltx_tr" id="S6.T4.1.9.8">
<td class="ltx_td ltx_align_center" id="S6.T4.1.9.8.1" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S6.T4.1.9.8.1.1" style="background-color:#D3EFF1;">PrefixQuant</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.9.8.2" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S6.T4.1.9.8.2.1" style="background-color:#D3EFF1;">static</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.9.8.3" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S6.T4.1.9.8.3.1" style="background-color:#D3EFF1;"><span class="ltx_text ltx_font_bold" id="S6.T4.1.9.8.3.1.1">5.07</span></span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.9.8.4" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S6.T4.1.9.8.4.1" style="background-color:#D3EFF1;"><span class="ltx_text ltx_font_bold" id="S6.T4.1.9.8.4.1.1">71.25</span></span></td>
</tr>
<tr class="ltx_tr" id="S6.T4.1.10.9">
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.1.10.9.1" rowspan="4" style="padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S6.T4.1.10.9.1.1">Llama-2-70B</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.1.10.9.2" style="padding-top:-3pt;padding-bottom:-3pt;">QoQ</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.1.10.9.3" style="padding-top:-3pt;padding-bottom:-3pt;">dynamic</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.1.10.9.4" style="padding-top:-3pt;padding-bottom:-3pt;">3.52</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.1.10.9.5" style="padding-top:-3pt;padding-bottom:-3pt;">75.91</td>
</tr>
<tr class="ltx_tr" id="S6.T4.1.11.10">
<td class="ltx_td ltx_align_center" id="S6.T4.1.11.10.1" style="padding-top:-3pt;padding-bottom:-3pt;">QuaRot</td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.11.10.2" style="padding-top:-3pt;padding-bottom:-3pt;">dynamic</td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.11.10.3" style="padding-top:-3pt;padding-bottom:-3pt;">3.46</td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.11.10.4" style="padding-top:-3pt;padding-bottom:-3pt;">76.31</td>
</tr>
<tr class="ltx_tr" id="S6.T4.1.12.11">
<td class="ltx_td ltx_align_center" id="S6.T4.1.12.11.1" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S6.T4.1.12.11.1.1" style="background-color:#D3EFF1;">PrefixQuant w/o FT</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.12.11.2" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S6.T4.1.12.11.2.1" style="background-color:#D3EFF1;">static</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.12.11.3" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S6.T4.1.12.11.3.1" style="background-color:#D3EFF1;">3.60</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.12.11.4" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S6.T4.1.12.11.4.1" style="background-color:#D3EFF1;">75.00</span></td>
</tr>
<tr class="ltx_tr" id="S6.T4.1.13.12">
<td class="ltx_td ltx_align_center" id="S6.T4.1.13.12.1" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S6.T4.1.13.12.1.1" style="background-color:#D3EFF1;">PrefixQuant</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.13.12.2" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S6.T4.1.13.12.2.1" style="background-color:#D3EFF1;">static</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.13.12.3" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S6.T4.1.13.12.3.1" style="background-color:#D3EFF1;">3.50</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.13.12.4" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S6.T4.1.13.12.4.1" style="background-color:#D3EFF1;">76.50</span></td>
</tr>
<tr class="ltx_tr" id="S6.T4.1.14.13">
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.1.14.13.1" rowspan="4" style="padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S6.T4.1.14.13.1.1">Llama-3-8B</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.1.14.13.2" style="padding-top:-3pt;padding-bottom:-3pt;">QoQ</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.1.14.13.3" style="padding-top:-3pt;padding-bottom:-3pt;">dynamic</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.1.14.13.4" style="padding-top:-3pt;padding-bottom:-3pt;">6.89</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.1.14.13.5" style="padding-top:-3pt;padding-bottom:-3pt;">71.35</td>
</tr>
<tr class="ltx_tr" id="S6.T4.1.15.14">
<td class="ltx_td ltx_align_center" id="S6.T4.1.15.14.1" style="padding-top:-3pt;padding-bottom:-3pt;">QuaRot</td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.15.14.2" style="padding-top:-3pt;padding-bottom:-3pt;">dynamic</td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.15.14.3" style="padding-top:-3pt;padding-bottom:-3pt;">6.80</td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.15.14.4" style="padding-top:-3pt;padding-bottom:-3pt;">71.68</td>
</tr>
<tr class="ltx_tr" id="S6.T4.1.16.15">
<td class="ltx_td ltx_align_center" id="S6.T4.1.16.15.1" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S6.T4.1.16.15.1.1" style="background-color:#D3EFF1;">PrefixQuant w/o FT</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.16.15.2" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S6.T4.1.16.15.2.1" style="background-color:#D3EFF1;">static</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.16.15.3" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S6.T4.1.16.15.3.1" style="background-color:#D3EFF1;">6.90</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.16.15.4" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S6.T4.1.16.15.4.1" style="background-color:#D3EFF1;">70.29</span></td>
</tr>
<tr class="ltx_tr" id="S6.T4.1.17.16">
<td class="ltx_td ltx_align_center" id="S6.T4.1.17.16.1" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S6.T4.1.17.16.1.1" style="background-color:#D3EFF1;">PrefixQuant</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.17.16.2" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S6.T4.1.17.16.2.1" style="background-color:#D3EFF1;">static</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.17.16.3" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S6.T4.1.17.16.3.1" style="background-color:#D3EFF1;"><span class="ltx_text ltx_font_bold" id="S6.T4.1.17.16.3.1.1">6.62</span></span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.17.16.4" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S6.T4.1.17.16.4.1" style="background-color:#D3EFF1;"><span class="ltx_text ltx_font_bold" id="S6.T4.1.17.16.4.1.1">72.46</span></span></td>
</tr>
<tr class="ltx_tr" id="S6.T4.1.18.17">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.T4.1.18.17.1" rowspan="4" style="padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S6.T4.1.18.17.1.1">Llama-3-70B</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.1.18.17.2" style="padding-top:-3pt;padding-bottom:-3pt;">QoQ</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.1.18.17.3" style="padding-top:-3pt;padding-bottom:-3pt;">dynamic</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.1.18.17.4" style="padding-top:-3pt;padding-bottom:-3pt;">4.36</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.1.18.17.5" style="padding-top:-3pt;padding-bottom:-3pt;">78.12</td>
</tr>
<tr class="ltx_tr" id="S6.T4.1.19.18">
<td class="ltx_td ltx_align_center" id="S6.T4.1.19.18.1" style="padding-top:-3pt;padding-bottom:-3pt;">QuaRot</td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.19.18.2" style="padding-top:-3pt;padding-bottom:-3pt;">dynamic</td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.19.18.3" style="padding-top:-3pt;padding-bottom:-3pt;">3.73</td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.19.18.4" style="padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text ltx_font_bold" id="S6.T4.1.19.18.4.1">78.92</span></td>
</tr>
<tr class="ltx_tr" id="S6.T4.1.20.19">
<td class="ltx_td ltx_align_center" id="S6.T4.1.20.19.1" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S6.T4.1.20.19.1.1" style="background-color:#D3EFF1;">PrefixQuant w/o FT</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.20.19.2" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S6.T4.1.20.19.2.1" style="background-color:#D3EFF1;">static</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.20.19.3" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S6.T4.1.20.19.3.1" style="background-color:#D3EFF1;">3.55</span></td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.20.19.4" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S6.T4.1.20.19.4.1" style="background-color:#D3EFF1;">77.82</span></td>
</tr>
<tr class="ltx_tr" id="S6.T4.1.21.20">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T4.1.21.20.1" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S6.T4.1.21.20.1.1" style="background-color:#D3EFF1;">PrefixQuant</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T4.1.21.20.2" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S6.T4.1.21.20.2.1" style="background-color:#D3EFF1;">static</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T4.1.21.20.3" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S6.T4.1.21.20.3.1" style="background-color:#D3EFF1;"><span class="ltx_text ltx_font_bold" id="S6.T4.1.21.20.3.1.1">3.43</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T4.1.21.20.4" style="background-color:#D3EFF1;padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S6.T4.1.21.20.4.1" style="background-color:#D3EFF1;">78.70</span></td>
</tr>
</tbody>
</table>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S6.SS2.p2">
<p class="ltx_p" id="S6.SS2.p2.2"><span class="ltx_text ltx_font_bold" id="S6.SS2.p2.2.1">Results on W4A8KV8.</span> Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#S6.T4" title="Table 4 ‣ 6.2 Comparison Results ‣ 6 Experiments ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">4</span></a> presents the comparison results for W4A8KV8. Without fine-tuning, PrefixQuant performs comparably to QoQ&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Lin et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib20" title="">2024b</a>)</cite>. After fine-tuning, PrefixQuant outperforms both QoQ and QuaRot in most models. For instance, PrefixQuant surpasses QoQ&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Lin et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib20" title="">2024b</a>)</cite> by <math alttext="0.27" class="ltx_Math" display="inline" id="S6.SS2.p2.1.m1.1"><semantics id="S6.SS2.p2.1.m1.1a"><mn id="S6.SS2.p2.1.m1.1.1" xref="S6.SS2.p2.1.m1.1.1.cmml">0.27</mn><annotation-xml encoding="MathML-Content" id="S6.SS2.p2.1.m1.1b"><cn id="S6.SS2.p2.1.m1.1.1.cmml" type="float" xref="S6.SS2.p2.1.m1.1.1">0.27</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p2.1.m1.1c">0.27</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p2.1.m1.1d">0.27</annotation></semantics></math> perplexity and <math alttext="+1.11" class="ltx_Math" display="inline" id="S6.SS2.p2.2.m2.1"><semantics id="S6.SS2.p2.2.m2.1a"><mrow id="S6.SS2.p2.2.m2.1.1" xref="S6.SS2.p2.2.m2.1.1.cmml"><mo id="S6.SS2.p2.2.m2.1.1a" xref="S6.SS2.p2.2.m2.1.1.cmml">+</mo><mn id="S6.SS2.p2.2.m2.1.1.2" xref="S6.SS2.p2.2.m2.1.1.2.cmml">1.11</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.p2.2.m2.1b"><apply id="S6.SS2.p2.2.m2.1.1.cmml" xref="S6.SS2.p2.2.m2.1.1"><plus id="S6.SS2.p2.2.m2.1.1.1.cmml" xref="S6.SS2.p2.2.m2.1.1"></plus><cn id="S6.SS2.p2.2.m2.1.1.2.cmml" type="float" xref="S6.SS2.p2.2.m2.1.1.2">1.11</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p2.2.m2.1c">+1.11</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p2.2.m2.1d">+ 1.11</annotation></semantics></math> accuracy points in Llama-3-8B.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S6.SS2.p3">
<p class="ltx_p" id="S6.SS2.p3.1"><span class="ltx_text ltx_font_bold" id="S6.SS2.p3.1.1">Results on W8A8KV8.</span> Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A8.T18" title="Table 18 ‣ H.3 Results on More Models ‣ Appendix H Full Results of Weight-Activation quantization ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">18</span></a> includes the comparison with various methods in W8A8KV8 quantization. We can find that SmoothQuant, QuaRot, and PrefixQuant all attain near lossless performance without fine-tuning. Notably, our PrefixQuant is unique in employing static quantization, which enhances inference efficiency. Additionally, earlier methods like CushionCache&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Son et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib30" title="">2024</a>)</cite> and QFeP&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Yang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib40" title="">2024</a>)</cite>, despite also using prefixed tokens in the KV cache to support coarser quantization, exhibit marked performance decline even under W8A8 as illustrated in Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A8.T17" title="Table 17 ‣ Appendix H Full Results of Weight-Activation quantization ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">17</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S6.SS2.p4">
<p class="ltx_p" id="S6.SS2.p4.1"><span class="ltx_text ltx_font_bold" id="S6.SS2.p4.1.1">Results on more models.</span> The results in Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A8.T19" title="Table 19 ‣ H.3 Results on More Models ‣ Appendix H Full Results of Weight-Activation quantization ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">19</span></a> demonstrate that PrefixQuant consistently achieves excellent performance on other models such as Mistral-7b-v0.3 and Qwen-2-7B, as well as instruction-tuned models like Llama-3-{7B,70B}-Instruct.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="S6.SS2.p5">
<p class="ltx_p" id="S6.SS2.p5.2"><span class="ltx_text ltx_font_bold" id="S6.SS2.p5.2.1">Results on weight-only quantization.</span>
PrefixQuant can also improve existing weight-only quantization methods by reducing outlier noise in MSE loss calculations. As shown in Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A6.T16" title="Table 16 ‣ Appendix F More Ablation Results ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">16</span></a>, PrefixQuant enhances the average accuracy by <math alttext="+5.05" class="ltx_Math" display="inline" id="S6.SS2.p5.1.m1.1"><semantics id="S6.SS2.p5.1.m1.1a"><mrow id="S6.SS2.p5.1.m1.1.1" xref="S6.SS2.p5.1.m1.1.1.cmml"><mo id="S6.SS2.p5.1.m1.1.1a" xref="S6.SS2.p5.1.m1.1.1.cmml">+</mo><mn id="S6.SS2.p5.1.m1.1.1.2" xref="S6.SS2.p5.1.m1.1.1.2.cmml">5.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.p5.1.m1.1b"><apply id="S6.SS2.p5.1.m1.1.1.cmml" xref="S6.SS2.p5.1.m1.1.1"><plus id="S6.SS2.p5.1.m1.1.1.1.cmml" xref="S6.SS2.p5.1.m1.1.1"></plus><cn id="S6.SS2.p5.1.m1.1.1.2.cmml" type="float" xref="S6.SS2.p5.1.m1.1.1.2">5.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p5.1.m1.1c">+5.05</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p5.1.m1.1d">+ 5.05</annotation></semantics></math> and <math alttext="+4.73" class="ltx_Math" display="inline" id="S6.SS2.p5.2.m2.1"><semantics id="S6.SS2.p5.2.m2.1a"><mrow id="S6.SS2.p5.2.m2.1.1" xref="S6.SS2.p5.2.m2.1.1.cmml"><mo id="S6.SS2.p5.2.m2.1.1a" xref="S6.SS2.p5.2.m2.1.1.cmml">+</mo><mn id="S6.SS2.p5.2.m2.1.1.2" xref="S6.SS2.p5.2.m2.1.1.2.cmml">4.73</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.p5.2.m2.1b"><apply id="S6.SS2.p5.2.m2.1.1.cmml" xref="S6.SS2.p5.2.m2.1.1"><plus id="S6.SS2.p5.2.m2.1.1.1.cmml" xref="S6.SS2.p5.2.m2.1.1"></plus><cn id="S6.SS2.p5.2.m2.1.1.2.cmml" type="float" xref="S6.SS2.p5.2.m2.1.1.2">4.73</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p5.2.m2.1c">+4.73</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p5.2.m2.1d">+ 4.73</annotation></semantics></math> points on W2A16g128 Llama-3-8B and Llama-3-70B, respectively, based on the state-of-the-art uniform quantization method EfficientQAT&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Chen et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib7" title="">2024a</a>)</cite>. See Sec.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A7" title="Appendix G Extend to Weight-only Quantization ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">G</span></a> for more details.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table ltx_align_floatright" id="S6.T5">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span>Time-to-first-token (prefilling) speedup of W4A4 Llama-3-8B model over the FP16 model. We use 2048 sequence length with different batch size. </figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S6.T5.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T5.1.1.1">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_right ltx_th ltx_th_row ltx_border_tt" id="S6.T5.1.1.1.1" style="padding:-3pt 1.5pt;">Batchsize</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_tt" id="S6.T5.1.1.1.2" style="padding:-3pt 1.5pt;">1</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_tt" id="S6.T5.1.1.1.3" style="padding:-3pt 1.5pt;">4</td>
</tr>
<tr class="ltx_tr" id="S6.T5.1.2.2">
<th class="ltx_td ltx_nopad_l ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="3" id="S6.T5.1.2.2.1" style="padding:-3pt 1.5pt;">on a RTX 3090 GPU (ms)</th>
</tr>
<tr class="ltx_tr" id="S6.T5.1.3.3">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_right ltx_th ltx_th_row" id="S6.T5.1.3.3.1" style="padding:-3pt 1.5pt;">
<span class="ltx_ERROR undefined" id="S6.T5.1.3.3.1.1">\cdashline</span>1-3
FP16</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" id="S6.T5.1.3.3.2" style="padding:-3pt 1.5pt;">509</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" id="S6.T5.1.3.3.3" style="padding:-3pt 1.5pt;">OOM</td>
</tr>
<tr class="ltx_tr" id="S6.T5.1.4.4">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_right ltx_th ltx_th_row" id="S6.T5.1.4.4.1" style="padding:-3pt 1.5pt;">Quarot (W4A4)</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" id="S6.T5.1.4.4.2" style="padding:-3pt 1.5pt;">221 (2.30x)</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" id="S6.T5.1.4.4.3" style="padding:-3pt 1.5pt;">851</td>
</tr>
<tr class="ltx_tr" id="S6.T5.1.5.5">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_right ltx_th ltx_th_row" id="S6.T5.1.5.5.1" style="padding:-3pt 1.5pt;">PrefixQuant (W4A4)</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" id="S6.T5.1.5.5.2" style="padding:-3pt 1.5pt;">181 (<span class="ltx_text ltx_font_bold" id="S6.T5.1.5.5.2.1">2.81x)</span>
</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" id="S6.T5.1.5.5.3" style="padding:-3pt 1.5pt;"><span class="ltx_text ltx_font_bold" id="S6.T5.1.5.5.3.1">725</span></td>
</tr>
<tr class="ltx_tr" id="S6.T5.1.6.6">
<th class="ltx_td ltx_nopad_l ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="3" id="S6.T5.1.6.6.1" style="padding:-3pt 1.5pt;">on an A100-80GB GPU (ms)</th>
</tr>
<tr class="ltx_tr" id="S6.T5.1.7.7">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_right ltx_th ltx_th_row" id="S6.T5.1.7.7.1" style="padding:-3pt 1.5pt;">
<span class="ltx_ERROR undefined" id="S6.T5.1.7.7.1.1">\cdashline</span>1-3
FP16</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" id="S6.T5.1.7.7.2" style="padding:-3pt 1.5pt;">172</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" id="S6.T5.1.7.7.3" style="padding:-3pt 1.5pt;">661</td>
</tr>
<tr class="ltx_tr" id="S6.T5.1.8.8">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_right ltx_th ltx_th_row" id="S6.T5.1.8.8.1" style="padding:-3pt 1.5pt;">Quarot (W4A4)</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" id="S6.T5.1.8.8.2" style="padding:-3pt 1.5pt;">130 (1.31x)</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" id="S6.T5.1.8.8.3" style="padding:-3pt 1.5pt;">477 (1.39x)</td>
</tr>
<tr class="ltx_tr" id="S6.T5.1.9.9">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_right ltx_th ltx_th_row ltx_border_bb" id="S6.T5.1.9.9.1" style="padding:-3pt 1.5pt;">PrefixQuant (W4A4)</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_bb" id="S6.T5.1.9.9.2" style="padding:-3pt 1.5pt;">107 (<span class="ltx_text ltx_font_bold" id="S6.T5.1.9.9.2.1">1.60x)</span>
</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_bb" id="S6.T5.1.9.9.3" style="padding:-3pt 1.5pt;">362 (<span class="ltx_text ltx_font_bold" id="S6.T5.1.9.9.3.1">1.82x)</span>
</td>
</tr>
</tbody>
</table>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_subsection" id="S6.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.3 </span>Inference Speed</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S6.SS3.p1">
<p class="ltx_p" id="S6.SS3.p1.4">In this section, we evaluate the end-to-end inference speed of PrefixQuant in the W4A4 quantization scenario. We do not consider KV quantization here because it saves memory footprint through more computation overhead and only achieves speedup with large batch sizes&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Liu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib23" title="">2024b</a>)</cite>. Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#S6.T5" title="Table 5 ‣ 6.2 Comparison Results ‣ 6 Experiments ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">5</span></a> shows the speedup of W4A4 quantization in the prefilling stage. Our PrefixQuant improves the QuaRot speedup from <math alttext="2.30\times" class="ltx_math_unparsed" display="inline" id="S6.SS3.p1.1.m1.1"><semantics id="S6.SS3.p1.1.m1.1a"><mrow id="S6.SS3.p1.1.m1.1b"><mn id="S6.SS3.p1.1.m1.1.1">2.30</mn><mo id="S6.SS3.p1.1.m1.1.2" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="S6.SS3.p1.1.m1.1c">2.30\times</annotation><annotation encoding="application/x-llamapun" id="S6.SS3.p1.1.m1.1d">2.30 ×</annotation></semantics></math> to <math alttext="2.81\times" class="ltx_math_unparsed" display="inline" id="S6.SS3.p1.2.m2.1"><semantics id="S6.SS3.p1.2.m2.1a"><mrow id="S6.SS3.p1.2.m2.1b"><mn id="S6.SS3.p1.2.m2.1.1">2.81</mn><mo id="S6.SS3.p1.2.m2.1.2" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="S6.SS3.p1.2.m2.1c">2.81\times</annotation><annotation encoding="application/x-llamapun" id="S6.SS3.p1.2.m2.1d">2.81 ×</annotation></semantics></math> on the A100-80GB GPU, and from <math alttext="1.31\times\sim 1.39\times" class="ltx_math_unparsed" display="inline" id="S6.SS3.p1.3.m3.1"><semantics id="S6.SS3.p1.3.m3.1a"><mrow id="S6.SS3.p1.3.m3.1b"><mn id="S6.SS3.p1.3.m3.1.1">1.31</mn><mo id="S6.SS3.p1.3.m3.1.2" lspace="0.222em" rspace="0em">×</mo><mo id="S6.SS3.p1.3.m3.1.3" lspace="0em">∼</mo><mn id="S6.SS3.p1.3.m3.1.4">1.39</mn><mo id="S6.SS3.p1.3.m3.1.5" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="S6.SS3.p1.3.m3.1c">1.31\times\sim 1.39\times</annotation><annotation encoding="application/x-llamapun" id="S6.SS3.p1.3.m3.1d">1.31 × ∼ 1.39 ×</annotation></semantics></math> to <math alttext="1.60\times\sim 1.82\times" class="ltx_math_unparsed" display="inline" id="S6.SS3.p1.4.m4.1"><semantics id="S6.SS3.p1.4.m4.1a"><mrow id="S6.SS3.p1.4.m4.1b"><mn id="S6.SS3.p1.4.m4.1.1">1.60</mn><mo id="S6.SS3.p1.4.m4.1.2" lspace="0.222em" rspace="0em">×</mo><mo id="S6.SS3.p1.4.m4.1.3" lspace="0em">∼</mo><mn id="S6.SS3.p1.4.m4.1.4">1.82</mn><mo id="S6.SS3.p1.4.m4.1.5" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="S6.SS3.p1.4.m4.1c">1.60\times\sim 1.82\times</annotation><annotation encoding="application/x-llamapun" id="S6.SS3.p1.4.m4.1d">1.60 × ∼ 1.82 ×</annotation></semantics></math> on the RTX 3090 GPU.
In Sec.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A4" title="Appendix D Inference Efficiency Details ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">D</span></a>, we also provide comprehensive apple-to-apple comparisons of sub-modules, such as quantization kernels and quantized linears, demonstrating the significant superiority of PrefixQuant over the existing dynamic quantization approach QuaRot&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Ashkboos et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib3" title="">2024b</a>)</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="S6.T6">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 6: </span>Ablation study on quantization techniques used in PrefixQuant. The model used here is Llama-3-8B, and WikiText2 perplexity with 2048 context length is reported.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S6.T6.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S6.T6.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S6.T6.1.1.1.1" style="padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text ltx_font_bold" id="S6.T6.1.1.1.1.1">Method</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T6.1.1.1.2" style="padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text ltx_font_bold" id="S6.T6.1.1.1.2.1">Activation Quant.</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T6.1.1.1.3" style="padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text ltx_font_bold" id="S6.T6.1.1.1.3.1">W8A8KV8</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T6.1.1.1.4" style="padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text ltx_font_bold" id="S6.T6.1.1.1.4.1">W4A8KV4</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T6.1.1.1.5" style="padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text ltx_font_bold" id="S6.T6.1.1.1.5.1">W4A4KV4</span></th>
</tr>
<tr class="ltx_tr" id="S6.T6.1.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t" id="S6.T6.1.2.2.1" style="padding-top:-3pt;padding-bottom:-3pt;">QuaRot</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T6.1.2.2.2" style="padding-top:-3pt;padding-bottom:-3pt;">dynamic</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T6.1.2.2.3" style="padding-top:-3pt;padding-bottom:-3pt;">6.17</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T6.1.2.2.4" style="padding-top:-3pt;padding-bottom:-3pt;">6.75</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T6.1.2.2.5" style="padding-top:-3pt;padding-bottom:-3pt;">8.33</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T6.1.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S6.T6.1.3.1.1" style="padding-top:-3pt;padding-bottom:-3pt;">RTN</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T6.1.3.1.2" style="padding-top:-3pt;padding-bottom:-3pt;">dynamic</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T6.1.3.1.3" style="padding-top:-3pt;padding-bottom:-3pt;">6.26</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T6.1.3.1.4" style="padding-top:-3pt;padding-bottom:-3pt;">12.66</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T6.1.3.1.5" style="padding-top:-3pt;padding-bottom:-3pt;">1282.34</td>
</tr>
<tr class="ltx_tr" id="S6.T6.1.4.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T6.1.4.2.1" style="padding-top:-3pt;padding-bottom:-3pt;">+ rotation</th>
<td class="ltx_td ltx_align_center" id="S6.T6.1.4.2.2" style="padding-top:-3pt;padding-bottom:-3pt;">dynamic</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.4.2.3" style="padding-top:-3pt;padding-bottom:-3pt;">6.17</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.4.2.4" style="padding-top:-3pt;padding-bottom:-3pt;">10.88</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.4.2.5" style="padding-top:-3pt;padding-bottom:-3pt;">24.98</td>
</tr>
<tr class="ltx_tr" id="S6.T6.1.5.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T6.1.5.3.1" style="padding-top:-3pt;padding-bottom:-3pt;">+ grid search</th>
<td class="ltx_td ltx_align_center" id="S6.T6.1.5.3.2" style="padding-top:-3pt;padding-bottom:-3pt;">dynamic</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.5.3.3" style="padding-top:-3pt;padding-bottom:-3pt;">6.17</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.5.3.4" style="padding-top:-3pt;padding-bottom:-3pt;">8.91</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.5.3.5" style="padding-top:-3pt;padding-bottom:-3pt;">16.47</td>
</tr>
<tr class="ltx_tr" id="S6.T6.1.6.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T6.1.6.4.1" style="padding-top:-3pt;padding-bottom:-3pt;">+ static quantization</th>
<td class="ltx_td ltx_align_center" id="S6.T6.1.6.4.2" style="padding-top:-3pt;padding-bottom:-3pt;">static</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.6.4.3" style="padding-top:-3pt;padding-bottom:-3pt;">7.27</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.6.4.4" style="padding-top:-3pt;padding-bottom:-3pt;">29.07</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.6.4.5" style="padding-top:-3pt;padding-bottom:-3pt;">141.02</td>
</tr>
<tr class="ltx_tr" id="S6.T6.1.7.5" style="background-color:#D3EFF1;">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T6.1.7.5.1" style="padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S6.T6.1.7.5.1.1" style="background-color:#D3EFF1;">+ <span class="ltx_text ltx_font_bold" id="S6.T6.1.7.5.1.1.1">prefixed outliers</span></span></th>
<td class="ltx_td ltx_align_center" id="S6.T6.1.7.5.2" style="padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text ltx_font_bold" id="S6.T6.1.7.5.2.1" style="background-color:#D3EFF1;">static</span></td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.7.5.3" style="padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text ltx_font_bold" id="S6.T6.1.7.5.3.1" style="background-color:#D3EFF1;">6.17</span></td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.7.5.4" style="padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text ltx_font_bold" id="S6.T6.1.7.5.4.1" style="background-color:#D3EFF1;">6.90</span></td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.7.5.5" style="padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text ltx_font_bold" id="S6.T6.1.7.5.5.1" style="background-color:#D3EFF1;">7.93</span></td>
</tr>
<tr class="ltx_tr" id="S6.T6.1.8.6" style="background-color:#D3EFF1;">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S6.T6.1.8.6.1" style="padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text" id="S6.T6.1.8.6.1.1" style="background-color:#D3EFF1;">+ <span class="ltx_text ltx_font_bold" id="S6.T6.1.8.6.1.1.1">block-wise fine-tuning</span></span></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T6.1.8.6.2" style="padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text ltx_font_bold" id="S6.T6.1.8.6.2.1" style="background-color:#D3EFF1;">static</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T6.1.8.6.3" style="padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text ltx_font_bold" id="S6.T6.1.8.6.3.1" style="background-color:#D3EFF1;">6.17</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T6.1.8.6.4" style="padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text ltx_font_bold" id="S6.T6.1.8.6.4.1" style="background-color:#D3EFF1;">6.63</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T6.1.8.6.5" style="padding-top:-3pt;padding-bottom:-3pt;"><span class="ltx_text ltx_font_bold" id="S6.T6.1.8.6.5.1" style="background-color:#D3EFF1;">7.41</span></td>
</tr>
</tbody>
</table>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_subsection" id="S6.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.4 </span>Ablation Studies</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S6.SS4.p1">
<p class="ltx_p" id="S6.SS4.p1.1">We examine the impact of various quantization techniques implemented in PrefixQuant. Our analysis starts with W4A4KV4 round-to-nearest (RTN) quantization on Llama-3-8B, involving per-channel weight quantization, per-token dynamic activation quantization, and per-head dynamic KV-cache quantization. We apply different techniques step-by-step and report the WikiText2 perplexity in Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#S6.T6" title="Table 6 ‣ 6.3 Inference Speed ‣ 6 Experiments ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">6</span></a>. We find that both Hadamard rotation and grid search initialization improve performance. Then, perplexity collapses due to static quantization of activation and KV cache, but introducing prefixed outliers significantly recovers performance, even surpassing results before introducing static quantization. These benefits arise not only by reducing information loss from outlier tokens but also by helping to find accurate quantization parameters in grid searches through isolating extremely large outliers (<math alttext=">1e3" class="ltx_Math" display="inline" id="S6.SS4.p1.1.m1.1"><semantics id="S6.SS4.p1.1.m1.1a"><mrow id="S6.SS4.p1.1.m1.1.1" xref="S6.SS4.p1.1.m1.1.1.cmml"><mi id="S6.SS4.p1.1.m1.1.1.2" xref="S6.SS4.p1.1.m1.1.1.2.cmml"></mi><mo id="S6.SS4.p1.1.m1.1.1.1" xref="S6.SS4.p1.1.m1.1.1.1.cmml">&gt;</mo><mrow id="S6.SS4.p1.1.m1.1.1.3" xref="S6.SS4.p1.1.m1.1.1.3.cmml"><mn id="S6.SS4.p1.1.m1.1.1.3.2" xref="S6.SS4.p1.1.m1.1.1.3.2.cmml">1</mn><mo id="S6.SS4.p1.1.m1.1.1.3.1" xref="S6.SS4.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S6.SS4.p1.1.m1.1.1.3.3" xref="S6.SS4.p1.1.m1.1.1.3.3.cmml">e</mi><mo id="S6.SS4.p1.1.m1.1.1.3.1a" xref="S6.SS4.p1.1.m1.1.1.3.1.cmml">⁢</mo><mn id="S6.SS4.p1.1.m1.1.1.3.4" xref="S6.SS4.p1.1.m1.1.1.3.4.cmml">3</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS4.p1.1.m1.1b"><apply id="S6.SS4.p1.1.m1.1.1.cmml" xref="S6.SS4.p1.1.m1.1.1"><gt id="S6.SS4.p1.1.m1.1.1.1.cmml" xref="S6.SS4.p1.1.m1.1.1.1"></gt><csymbol cd="latexml" id="S6.SS4.p1.1.m1.1.1.2.cmml" xref="S6.SS4.p1.1.m1.1.1.2">absent</csymbol><apply id="S6.SS4.p1.1.m1.1.1.3.cmml" xref="S6.SS4.p1.1.m1.1.1.3"><times id="S6.SS4.p1.1.m1.1.1.3.1.cmml" xref="S6.SS4.p1.1.m1.1.1.3.1"></times><cn id="S6.SS4.p1.1.m1.1.1.3.2.cmml" type="integer" xref="S6.SS4.p1.1.m1.1.1.3.2">1</cn><ci id="S6.SS4.p1.1.m1.1.1.3.3.cmml" xref="S6.SS4.p1.1.m1.1.1.3.3">𝑒</ci><cn id="S6.SS4.p1.1.m1.1.1.3.4.cmml" type="integer" xref="S6.SS4.p1.1.m1.1.1.3.4">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS4.p1.1.m1.1c">&gt;1e3</annotation><annotation encoding="application/x-llamapun" id="S6.SS4.p1.1.m1.1d">&gt; 1 italic_e 3</annotation></semantics></math>) in activation. Additionally, block-wise fine-tuning improves performance except on W8A8KV8, which is nearly lossless without fine-tuning. More ablation results related to the training dataset, training epochs, dynamic quantization, the number of prefixed tokens, and the content of prefixed tokens are in Sec.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A6" title="Appendix F More Ablation Results ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">F</span></a> in the Appendix.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_section" id="S7">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Conclusion</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="S7.p1">
<p class="ltx_p" id="S7.p1.1">We propose PrefixQuant, which enables static quantization to outperform dynamic quantization by effectively handling token-wise outliers through a novel prefixing approach. This technique also stabilizes model training, making it a plug-and-play module that enhances the performance of other optimization-based methods. The simplicity and broad applicability of PrefixQuant make it a promising direction for future LLM compression and optimization research.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ashkboos et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Saleh Ashkboos, Ilia Markov, Elias Frantar, Tingxuan Zhong, Xincheng Wang, Jie Ren, Torsten Hoefler, and Dan Alistarh.

</span>
<span class="ltx_bibblock">Towards end-to-end 4-bit inference on generative large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">arXiv preprint arXiv:2310.09259</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ashkboos et&nbsp;al. (2024a)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Saleh Ashkboos, Maximilian&nbsp;L Croci, Marcelo Gennari&nbsp;do Nascimento, Torsten Hoefler, and James Hensman.

</span>
<span class="ltx_bibblock">Slicegpt: Compress large language models by deleting rows and columns.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">arXiv preprint arXiv:2401.15024</em>, 2024a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ashkboos et&nbsp;al. (2024b)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Saleh Ashkboos, Amirkeivan Mohtashami, Maximilian&nbsp;L Croci, Bo&nbsp;Li, Martin Jaggi, Dan Alistarh, Torsten Hoefler, and James Hensman.

</span>
<span class="ltx_bibblock">Quarot: Outlier-free 4-bit inference in rotated llms.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">arXiv preprint arXiv:2404.00456</em>, 2024b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bisk et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yonatan Bisk, Rowan Zellers, Jianfeng Gao, Yejin Choi, et&nbsp;al.

</span>
<span class="ltx_bibblock">Piqa: Reasoning about physical commonsense in natural language.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">Proceedings of the AAAI conference on artificial intelligence</em>, pp.&nbsp; 7432–7439, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bondarenko et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yelysei Bondarenko, Markus Nagel, and Tijmen Blankevoort.

</span>
<span class="ltx_bibblock">Quantizable transformers: Removing outliers by helping attention heads do nothing.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bubeck et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Sébastien Bubeck, Varun Chandrasekaran, Ronen Eldan, Johannes Gehrke, Eric Horvitz, Ece Kamar, Peter Lee, Yin&nbsp;Tat Lee, Yuanzhi Li, Scott Lundberg, et&nbsp;al.

</span>
<span class="ltx_bibblock">Sparks of artificial general intelligence: Early experiments with gpt-4.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">arXiv preprint arXiv:2303.12712</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et&nbsp;al. (2024a)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Mengzhao Chen, Wenqi Shao, Peng Xu, Jiahao Wang, Peng Gao, Kaipeng Zhang, Yu&nbsp;Qiao, and Ping Luo.

</span>
<span class="ltx_bibblock">Efficientqat: Efficient quantization-aware training for large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">arXiv preprint arXiv:2407.11062</em>, 2024a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et&nbsp;al. (2024b)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Tianqi Chen, Zhe Li, Weixiang Xu, Zeyu Zhu, Dong Li, Lu&nbsp;Tian, Emad Barsoum, Peisong Wang, and Jian Cheng.

</span>
<span class="ltx_bibblock">Ternaryllm: Ternarized large language model.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">arXiv preprint arXiv:2406.07177</em>, 2024b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Clark et&nbsp;al. (2018)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Peter Clark, Isaac Cowhey, Oren Etzioni, Tushar Khot, Ashish Sabharwal, Carissa Schoenick, and Oyvind Tafjord.

</span>
<span class="ltx_bibblock">Think you have solved question answering? try arc, the ai2 reasoning challenge.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">arXiv preprint arXiv:1803.05457</em>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Computer (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Together Computer.

</span>
<span class="ltx_bibblock">Redpajama: an open dataset for training large language models, 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/togethercomputer/RedPajama-Data" title="">https://github.com/togethercomputer/RedPajama-Data</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dettmers et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Tim Dettmers, Mike Lewis, Younes Belkada, and Luke Zettlemoyer.

</span>
<span class="ltx_bibblock">Gpt3. int8 (): 8-bit matrix multiplication for transformers at scale.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">Advances in Neural Information Processing Systems</em>, 35:30318–30332, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Frantar et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Elias Frantar, Saleh Ashkboos, Torsten Hoefler, and Dan Alistarh.

</span>
<span class="ltx_bibblock">Gptq: Accurate post-training quantization for generative pre-trained transformers.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">arXiv preprint arXiv:2210.17323</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gao et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Leo Gao, Stella Biderman, Sid Black, Laurence Golding, Travis Hoppe, Charles Foster, Jason Phang, Horace He, Anish Thite, Noa Nabeshima, et&nbsp;al.

</span>
<span class="ltx_bibblock">The pile: An 800gb dataset of diverse text for language modeling.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">arXiv preprint arXiv:2101.00027</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gao et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Leo Gao, Jonathan Tow, Baber Abbasi, Stella Biderman, Sid Black, Anthony DiPofi, Charles Foster, Laurence Golding, Jeffrey Hsu, Alain Le&nbsp;Noac’h, Haonan Li, Kyle McDonell, Niklas Muennighoff, Chris Ociepa, Jason Phang, Laria Reynolds, Hailey Schoelkopf, Aviya Skowron, Lintang Sutawika, Eric Tang, Anish Thite, Ben Wang, Kevin Wang, and Andy Zou.

</span>
<span class="ltx_bibblock">A framework for few-shot language model evaluation, 07 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://zenodo.org/records/12608602" title="">https://zenodo.org/records/12608602</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gong et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Ruihao Gong, Yang Yong, Shiqiao Gu, Yushi Huang, Yunchen Zhang, Xianglong Liu, and Dacheng Tao.

</span>
<span class="ltx_bibblock">Llm-qbench: A benchmark towards the best practice for post-training quantization of large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">arXiv preprint arXiv:2405.06001</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Han et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Chi Han, Qifan Wang, Wenhan Xiong, Yu&nbsp;Chen, Heng Ji, and Sinong Wang.

</span>
<span class="ltx_bibblock">Lm-infinite: Simple on-the-fly length generalization for large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">arXiv preprint arXiv:2308.16137</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yuhang Li, Ruihao Gong, Xu&nbsp;Tan, Yang Yang, Peng Hu, Qi&nbsp;Zhang, Fengwei Yu, Wei Wang, and Shi Gu.

</span>
<span class="ltx_bibblock">Brecq: Pushing the limit of post-training quantization by block reconstruction.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">arXiv preprint arXiv:2102.05426</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et&nbsp;al. (2024a)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Haokun Lin, Haobo Xu, Yichen Wu, Jingzhi Cui, Yingtao Zhang, Linzhan Mou, Linqi Song, Zhenan Sun, and Ying Wei.

</span>
<span class="ltx_bibblock">Duquant: Distributing outliers via dual transformation makes stronger quantized llms.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">arXiv preprint arXiv:2406.01721</em>, 2024a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Ji&nbsp;Lin, Jiaming Tang, Haotian Tang, Shang Yang, Xingyu Dang, and Song Han.

</span>
<span class="ltx_bibblock">Awq: Activation-aware weight quantization for llm compression and acceleration.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">arXiv preprint arXiv:2306.00978</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et&nbsp;al. (2024b)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yujun Lin, Haotian Tang, Shang Yang, Zhekai Zhang, Guangxuan Xiao, Chuang Gan, and Song Han.

</span>
<span class="ltx_bibblock">Qserve: W4a8kv4 quantization and system co-design for efficient llm serving.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">arXiv preprint arXiv:2405.04532</em>, 2024b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jing Liu, Ruihao Gong, Xiuying Wei, Zhiwei Dong, Jianfei Cai, and Bohan Zhuang.

</span>
<span class="ltx_bibblock">Qllm: Accurate and efficient low-bitwidth quantization for large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">arXiv preprint arXiv:2310.08041</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et&nbsp;al. (2024a)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Zechun Liu, Changsheng Zhao, Igor Fedorov, Bilge Soran, Dhruv Choudhary, Raghuraman Krishnamoorthi, Vikas Chandra, Yuandong Tian, and Tijmen Blankevoort.

</span>
<span class="ltx_bibblock">Spinquant–llm quantization with learned rotations.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">arXiv preprint arXiv:2405.16406</em>, 2024a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et&nbsp;al. (2024b)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Zirui Liu, Jiayi Yuan, Hongye Jin, Shaochen Zhong, Zhaozhuo Xu, Vladimir Braverman, Beidi Chen, and Xia Hu.

</span>
<span class="ltx_bibblock">Kivi: A tuning-free asymmetric 2bit quantization for kv cache.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">arXiv preprint arXiv:2402.02750</em>, 2024b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Merity et&nbsp;al. (2016)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Stephen Merity, Caiming Xiong, James Bradbury, and Richard Socher.

</span>
<span class="ltx_bibblock">Pointer sentinel mixture models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">arXiv preprint arXiv:1609.07843</em>, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nagel et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Markus Nagel, Marios Fournarakis, Rana&nbsp;Ali Amjad, Yelysei Bondarenko, Mart Van&nbsp;Baalen, and Tijmen Blankevoort.

</span>
<span class="ltx_bibblock">A white paper on neural network quantization.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">arXiv preprint arXiv:2106.08295</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Raffel et&nbsp;al. (2020)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Colin Raffel, Noam Shazeer, Adam Roberts, Katherine Lee, Sharan Narang, Michael Matena, Yanqi Zhou, Wei Li, and Peter&nbsp;J Liu.

</span>
<span class="ltx_bibblock">Exploring the limits of transfer learning with a unified text-to-text transformer.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">The Journal of Machine Learning Research</em>, 21(1):5485–5551, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sakaguchi et&nbsp;al. (2021)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Keisuke Sakaguchi, Ronan&nbsp;Le Bras, Chandra Bhagavatula, and Yejin Choi.

</span>
<span class="ltx_bibblock">Winogrande: An adversarial winograd schema challenge at scale.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">Communications of the ACM</em>, 64(9):99–106, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shah et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jay Shah, Ganesh Bikshandi, Ying Zhang, Vijay Thakkar, Pradeep Ramani, and Tri Dao.

</span>
<span class="ltx_bibblock">Flashattention-3: Fast and accurate attention with asynchrony and low-precision.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">arXiv preprint arXiv:2407.08608</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shao et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Wenqi Shao, Mengzhao Chen, Zhaoyang Zhang, Peng Xu, Lirui Zhao, Zhiqian Li, Kaipeng Zhang, Peng Gao, Yu&nbsp;Qiao, and Ping Luo.

</span>
<span class="ltx_bibblock">Omniquant: Omnidirectionally calibrated quantization for large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">arXiv preprint arXiv:2308.13137</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Son et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Seungwoo Son, Wonpyo Park, Woohyun Han, Kyuyeun Kim, and Jaeho Lee.

</span>
<span class="ltx_bibblock">Prefixing attention sinks can mitigate activation outliers for large language model quantization.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">arXiv preprint arXiv:2406.12016</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Su et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jianlin Su, Murtadha Ahmed, Yu&nbsp;Lu, Shengfeng Pan, Wen Bo, and Yunfeng Liu.

</span>
<span class="ltx_bibblock">Roformer: Enhanced transformer with rotary position embedding.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">Neurocomputing</em>, 568:127063, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Mingjie Sun, Xinlei Chen, J&nbsp;Zico Kolter, and Zhuang Liu.

</span>
<span class="ltx_bibblock">Massive activations in large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">arXiv preprint arXiv:2402.17762</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Hugo Touvron, Thibaut Lavril, Gautier Izacard, Xavier Martinet, Marie-Anne Lachaux, Timothée Lacroix, Baptiste Rozière, Naman Goyal, Eric Hambro, Faisal Azhar, et&nbsp;al.

</span>
<span class="ltx_bibblock">Llama: Open and efficient foundation language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">arXiv preprint arXiv:2302.13971</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tseng et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Albert Tseng, Jerry Chee, Qingyao Sun, Volodymyr Kuleshov, and Christopher De&nbsp;Sa.

</span>
<span class="ltx_bibblock">Quip#: Even better llm quantization with hadamard incoherence and lattice codebooks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">arXiv preprint arXiv:2402.04396</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wei et&nbsp;al. (2022)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Xiuying Wei, Yunchen Zhang, Xiangguo Zhang, Ruihao Gong, Shanghang Zhang, Qi&nbsp;Zhang, Fengwei Yu, and Xianglong Liu.

</span>
<span class="ltx_bibblock">Outlier suppression: Pushing the limit of low-bit transformer language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">Advances in Neural Information Processing Systems</em>, 35:17402–17414, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wei et&nbsp;al. (2023a)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Xiuying Wei, Yunchen Zhang, Yuhang Li, Xiangguo Zhang, Ruihao Gong, Jinyang Guo, and Xianglong Liu.

</span>
<span class="ltx_bibblock">Outlier suppression+: Accurate quantization of large language models by equivalent and optimal shifting and scaling.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">arXiv preprint arXiv:2304.09145</em>, 2023a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wei et&nbsp;al. (2023b)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Xiuying Wei, Yunchen Zhang, Yuhang Li, Xiangguo Zhang, Ruihao Gong, Jinyang Guo, and Xianglong Liu.

</span>
<span class="ltx_bibblock">Outlier suppression+: Accurate quantization of large language models by equivalent and optimal shifting and scaling.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">arXiv preprint arXiv:2304.09145</em>, 2023b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiao et&nbsp;al. (2023a)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Guangxuan Xiao, Ji&nbsp;Lin, Mickael Seznec, Hao Wu, Julien Demouth, and Song Han.

</span>
<span class="ltx_bibblock">Smoothquant: Accurate and efficient post-training quantization for large language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">International Conference on Machine Learning</em>, pp.&nbsp; 38087–38099. PMLR, 2023a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiao et&nbsp;al. (2023b)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Guangxuan Xiao, Yuandong Tian, Beidi Chen, Song Han, and Mike Lewis.

</span>
<span class="ltx_bibblock">Efficient streaming language models with attention sinks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">arXiv preprint arXiv:2309.17453</em>, 2023b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jaewoo Yang, Hayun Kim, and Younghoon Kim.

</span>
<span class="ltx_bibblock">Mitigating quantization errors due to activation spikes in glu-based llms.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">arXiv preprint arXiv:2405.14428</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yuan et&nbsp;al. (2024)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Zhihang Yuan, Yuzhang Shang, Yang Zhou, Zhen Dong, Chenhao Xue, Bingzhe Wu, Zhikai Li, Qingyi Gu, Yong&nbsp;Jae Lee, Yan Yan, et&nbsp;al.

</span>
<span class="ltx_bibblock">Llm inference unveiled: Survey and roofline model insights.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">arXiv preprint arXiv:2402.16363</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zellers et&nbsp;al. (2019)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Rowan Zellers, Ari Holtzman, Yonatan Bisk, Ali Farhadi, and Yejin Choi.

</span>
<span class="ltx_bibblock">Hellaswag: Can a machine really finish your sentence?

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">arXiv preprint arXiv:1905.07830</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et&nbsp;al. (2023)<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yilong Zhao, Chien-Yu Lin, Kan Zhu, Zihao Ye, Lequn Chen, Size Zheng, Luis Ceze, Arvind Krishnamurthy, Tianqi Chen, and Baris Kasikci.

</span>
<span class="ltx_bibblock">Atom: Low-bit quantization for efficient and accurate llm serving.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">arXiv preprint arXiv:2310.19102</em>, 2023.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="Ax1">
<h2 class="ltx_title ltx_title_appendix">Overview of Appendix</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="Ax1.p1">
<p class="ltx_p" id="Ax1.p1.1">We detailed the content of Appendix here:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul class="ltx_itemize" id="Ax1.I1">
<li class="ltx_item" id="Ax1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax1.I1.i1.p1">
<p class="ltx_p" id="Ax1.I1.i1.p1.1">Sec&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A1" title="Appendix A Reproducibility Statement ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">A</span></a> gives the reproducibility statement to summarize the information related to the reproduction of our method.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="Ax1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax1.I1.i2.p1">
<p class="ltx_p" id="Ax1.I1.i2.p1.1">Sec&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A2" title="Appendix B Configuration and Data Sources of Comparison Methods ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">B</span></a> details the quantization configuration and data sources of comparison methods.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="Ax1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax1.I1.i3.p1">
<p class="ltx_p" id="Ax1.I1.i3.p1.1">Sec.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A3" title="Appendix C Details of Rotation ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">C</span></a> illustrates the detailed image of hadamaed rotation within a transformer block.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="Ax1.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax1.I1.i4.p1">
<p class="ltx_p" id="Ax1.I1.i4.p1.1">Sec.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A4" title="Appendix D Inference Efficiency Details ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">D</span></a> presents the apple-to-apple sub-module comparisons of PrefixQuant and QuaRot.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="Ax1.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax1.I1.i5.p1">
<p class="ltx_p" id="Ax1.I1.i5.p1.1">Sec.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A5" title="Appendix E Quantization Time ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">E</span></a> details the quantization time of PrefixQuant.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="Ax1.I1.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax1.I1.i6.p1">
<p class="ltx_p" id="Ax1.I1.i6.p1.1">Sec.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A6" title="Appendix F More Ablation Results ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">F</span></a> gives more ablation studies of PrefixQuant, including the fine-tuning dataset, training epoch, dynamic quantiztaion and number of prefixed tokens.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="Ax1.I1.i7" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax1.I1.i7.p1">
<p class="ltx_p" id="Ax1.I1.i7.p1.1">Sec.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A7" title="Appendix G Extend to Weight-only Quantization ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">G</span></a> demonstrates that proposed PrefixQuant can also play as a plug-in to enhance the performance of existing weight-only quantization methods.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="Ax1.I1.i8" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax1.I1.i8.p1">
<p class="ltx_p" id="Ax1.I1.i8.p1.1">Sec.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A8" title="Appendix H Full Results of Weight-Activation quantization ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">H</span></a> presents the detailed accuracy number of each zero-shot task, and provide more results of PrefixQuant on Mistral-v0.3-7B, Qwen-2-7B, and Llama-3-{8B,70B}-Instruct.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="Ax1.I1.i9" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="Ax1.I1.i9.p1">
<p class="ltx_p" id="Ax1.I1.i9.p1.3">Sec.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A9" title="Appendix I More Visualizations ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">I</span></a> illustrate more visualization of inputs of linear layer and <math alttext="\mathbf{Q}" class="ltx_Math" display="inline" id="Ax1.I1.i9.p1.1.m1.1"><semantics id="Ax1.I1.i9.p1.1.m1.1a"><mi id="Ax1.I1.i9.p1.1.m1.1.1" xref="Ax1.I1.i9.p1.1.m1.1.1.cmml">𝐐</mi><annotation-xml encoding="MathML-Content" id="Ax1.I1.i9.p1.1.m1.1b"><ci id="Ax1.I1.i9.p1.1.m1.1.1.cmml" xref="Ax1.I1.i9.p1.1.m1.1.1">𝐐</ci></annotation-xml><annotation encoding="application/x-tex" id="Ax1.I1.i9.p1.1.m1.1c">\mathbf{Q}</annotation><annotation encoding="application/x-llamapun" id="Ax1.I1.i9.p1.1.m1.1d">bold_Q</annotation></semantics></math>/<math alttext="\mathbf{K}" class="ltx_Math" display="inline" id="Ax1.I1.i9.p1.2.m2.1"><semantics id="Ax1.I1.i9.p1.2.m2.1a"><mi id="Ax1.I1.i9.p1.2.m2.1.1" xref="Ax1.I1.i9.p1.2.m2.1.1.cmml">𝐊</mi><annotation-xml encoding="MathML-Content" id="Ax1.I1.i9.p1.2.m2.1b"><ci id="Ax1.I1.i9.p1.2.m2.1.1.cmml" xref="Ax1.I1.i9.p1.2.m2.1.1">𝐊</ci></annotation-xml><annotation encoding="application/x-tex" id="Ax1.I1.i9.p1.2.m2.1c">\mathbf{K}</annotation><annotation encoding="application/x-llamapun" id="Ax1.I1.i9.p1.2.m2.1d">bold_K</annotation></semantics></math>/<math alttext="\mathbf{V}" class="ltx_Math" display="inline" id="Ax1.I1.i9.p1.3.m3.1"><semantics id="Ax1.I1.i9.p1.3.m3.1a"><mi id="Ax1.I1.i9.p1.3.m3.1.1" xref="Ax1.I1.i9.p1.3.m3.1.1.cmml">𝐕</mi><annotation-xml encoding="MathML-Content" id="Ax1.I1.i9.p1.3.m3.1b"><ci id="Ax1.I1.i9.p1.3.m3.1.1.cmml" xref="Ax1.I1.i9.p1.3.m3.1.1">𝐕</ci></annotation-xml><annotation encoding="application/x-tex" id="Ax1.I1.i9.p1.3.m3.1c">\mathbf{V}</annotation><annotation encoding="application/x-llamapun" id="Ax1.I1.i9.p1.3.m3.1d">bold_V</annotation></semantics></math> on more models, including Llama-3-{8B,70B}, Mistral-7B-v0.3, Qwen-2-7B.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Reproducibility Statement</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A1.p1">
<p class="ltx_p" id="A1.p1.1">In this section, we summarize the necessary information to reproduce our results. First, PrefixQuant is based on Hadamard rotation, as detailed in Sec.<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A3" title="Appendix C Details of Rotation ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">C</span></a>. Our main contribution, setting prefixed outliers, is discussed in Sec.<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#S5.SS1" title="5.1 Prefixed Outliers ‣ 5 PrefixQuant ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">5.1</span></a>. After configuring prefixed outliers in the KV-cache, we initialize the quantization parameters using grid search. We also offer optional block-wise fine-tuning to enhance performance. Detailed setups for grid search and fine-tuning are available in Sec.<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#S6.SS1" title="6.1 Setups ‣ 6 Experiments ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">6.1</span></a>. Additionally, we provide the source of detailed results for each compared method in Sec.<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A2" title="Appendix B Configuration and Data Sources of Comparison Methods ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">B</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Configuration and Data Sources of Comparison Methods</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A2.p1">
<p class="ltx_p" id="A2.p1.1"><span class="ltx_text ltx_font_bold" id="A2.p1.1.1">Quantization Configurations.</span> In this study, we establish the quantization granularity for each comparison method based on the specifications provided in the original papers. Details on these settings are given in Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A2.T7" title="Table 7 ‣ Appendix B Configuration and Data Sources of Comparison Methods ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">7</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="A2.T7">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 7: </span>Detailed quantization setting of comparison methods. All per-group quantization set group size as 128.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A2.T7.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A2.T7.1.1.1">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T7.1.1.1.1" style="padding-left:0.5pt;padding-right:0.5pt;"><span class="ltx_text ltx_font_bold" id="A2.T7.1.1.1.1.1">Method</span></th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T7.1.1.1.2" style="padding-left:0.5pt;padding-right:0.5pt;"><span class="ltx_text ltx_font_bold" id="A2.T7.1.1.1.2.1">Weight</span></th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T7.1.1.1.3" style="padding-left:0.5pt;padding-right:0.5pt;"><span class="ltx_text ltx_font_bold" id="A2.T7.1.1.1.3.1">Activation</span></th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T7.1.1.1.4" style="padding-left:0.5pt;padding-right:0.5pt;"><span class="ltx_text ltx_font_bold" id="A2.T7.1.1.1.4.1">KV Cache</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A2.T7.1.2.1">
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A2.T7.1.2.1.1" style="padding-left:0.5pt;padding-right:0.5pt;">SmoothQuant</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A2.T7.1.2.1.2" style="padding-left:0.5pt;padding-right:0.5pt;">per-channel symmetric</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A2.T7.1.2.1.3" style="padding-left:0.5pt;padding-right:0.5pt;">per-token symmetric dynamic</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A2.T7.1.2.1.4" style="padding-left:0.5pt;padding-right:0.5pt;">per-tensor symmetric static</td>
</tr>
<tr class="ltx_tr" id="A2.T7.1.3.2">
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A2.T7.1.3.2.1" style="padding-left:0.5pt;padding-right:0.5pt;">Atom</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A2.T7.1.3.2.2" style="padding-left:0.5pt;padding-right:0.5pt;">per-group symmetric</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A2.T7.1.3.2.3" style="padding-left:0.5pt;padding-right:0.5pt;">per-group symmetric dynamic</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A2.T7.1.3.2.4" style="padding-left:0.5pt;padding-right:0.5pt;">per-group asymmetric dynamic</td>
</tr>
<tr class="ltx_tr" id="A2.T7.1.4.3">
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A2.T7.1.4.3.1" style="padding-left:0.5pt;padding-right:0.5pt;">QoQ</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A2.T7.1.4.3.2" style="padding-left:0.5pt;padding-right:0.5pt;">per-channel asymmetric</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A2.T7.1.4.3.3" style="padding-left:0.5pt;padding-right:0.5pt;">per-token symmetric dynamic</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A2.T7.1.4.3.4" style="padding-left:0.5pt;padding-right:0.5pt;">per-group asymmetric dynamic</td>
</tr>
<tr class="ltx_tr" id="A2.T7.1.5.4">
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A2.T7.1.5.4.1" style="padding-left:0.5pt;padding-right:0.5pt;">QuaRot</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A2.T7.1.5.4.2" style="padding-left:0.5pt;padding-right:0.5pt;">per-channel symmetric</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A2.T7.1.5.4.3" style="padding-left:0.5pt;padding-right:0.5pt;">per-token dynamic symmetric</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A2.T7.1.5.4.4" style="padding-left:0.5pt;padding-right:0.5pt;">per-group asymmetric dynamic</td>
</tr>
<tr class="ltx_tr" id="A2.T7.1.6.5">
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A2.T7.1.6.5.1" style="padding-left:0.5pt;padding-right:0.5pt;">DuQuant</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A2.T7.1.6.5.2" style="padding-left:0.5pt;padding-right:0.5pt;">per-channel asymmetric</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A2.T7.1.6.5.3" style="padding-left:0.5pt;padding-right:0.5pt;">per-token dynamic asymmetric</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A2.T7.1.6.5.4" style="padding-left:0.5pt;padding-right:0.5pt;">per-token asymmetric dynamic</td>
</tr>
<tr class="ltx_tr" id="A2.T7.1.7.6">
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" id="A2.T7.1.7.6.1" style="padding-left:0.5pt;padding-right:0.5pt;"><span class="ltx_text ltx_font_bold" id="A2.T7.1.7.6.1.1">PrefixQuant</span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" id="A2.T7.1.7.6.2" style="padding-left:0.5pt;padding-right:0.5pt;">per-channel symmetric</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" id="A2.T7.1.7.6.3" style="padding-left:0.5pt;padding-right:0.5pt;">per-tensor symmetric static</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" id="A2.T7.1.7.6.4" style="padding-left:0.5pt;padding-right:0.5pt;">per-head symmetric static</td>
</tr>
</tbody>
</table>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A2.p2">
<p class="ltx_p" id="A2.p2.1"><span class="ltx_text ltx_font_bold" id="A2.p2.1.1">Data Sources.</span> We compare our proposed PrefixQuant with several other methods: QuaRot&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Ashkboos et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib3" title="">2024b</a>)</cite>, Atom&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Zhao et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib43" title="">2023</a>)</cite>, QoQ&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Lin et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib20" title="">2024b</a>)</cite>, SmoothQuant&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Xiao et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib38" title="">2023a</a>)</cite>, SpinQuant&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Liu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib22" title="">2024a</a>)</cite>, and EfficientQAT&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Chen et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib7" title="">2024a</a>)</cite>. The data for our comparisons either come directly from the official publications of these methods, from other papers, or from our own reproduction of the methods. The source of the data for each method is outlined as follows:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul class="ltx_itemize" id="A2.I1">
<li class="ltx_item" id="A2.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I1.i1.p1">
<p class="ltx_p" id="A2.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="A2.I1.i1.p1.1.1">QuaRot</span>: We present the performance of QuaRot using the Pile calibration dataset. The results for Llama-2 models with W4A4KV4 come from QoQ&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Lin et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib20" title="">2024b</a>)</cite>, while the rest are reproduced using the official open-source code.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A2.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I1.i2.p1">
<p class="ltx_p" id="A2.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="A2.I1.i2.p1.1.1">DuQuant</span>: We reproduce DuQuant with Pild calibration dataset through their official open-source code. Note that we change the evaluation toolbox to lm-eval v0.4.2 for more accurate evaluation.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A2.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I1.i3.p1">
<p class="ltx_p" id="A2.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="A2.I1.i3.p1.1.1">Atom</span>: We present the performance of Atom using the Pile calibration dataset. The results are sourced from QoQ&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Lin et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib20" title="">2024b</a>)</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A2.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I1.i4.p1">
<p class="ltx_p" id="A2.I1.i4.p1.1"><span class="ltx_text ltx_font_bold" id="A2.I1.i4.p1.1.1">QoQ</span>: We present the performance of QoQ using the Pile calibration dataset. The results for Llama-2 come from QoQ&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Lin et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib20" title="">2024b</a>)</cite>, and the Llama-3 results are reproduced using the official open-source code.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A2.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I1.i5.p1">
<p class="ltx_p" id="A2.I1.i5.p1.1"><span class="ltx_text ltx_font_bold" id="A2.I1.i5.p1.1.1">SmoothQuant</span>: We present the performance of SmoothQuant using the Pile calibration dataset. All results are reproduced using the open-source code from QoQ&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Lin et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib20" title="">2024b</a>)</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A2.I1.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I1.i6.p1">
<p class="ltx_p" id="A2.I1.i6.p1.1"><span class="ltx_text ltx_font_bold" id="A2.I1.i6.p1.1.1">SpinQuant</span>: All results are reproduced using the official open-source code and the pre-trained rotation matrix. Note that SpinQuant directly trains on the WikiText2 dataset.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A2.I1.i7" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="A2.I1.i7.p1">
<p class="ltx_p" id="A2.I1.i7.p1.1"><span class="ltx_text ltx_font_bold" id="A2.I1.i7.p1.1.1">EfficientQAT</span>: All results are reproduced using the official open-source code and the pre-quantized models.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_appendix" id="A3">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Details of Rotation</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A3.p1">
<p class="ltx_p" id="A3.p1.7">Hadamard rotation&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Ashkboos et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib3" title="">2024b</a>; Liu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib22" title="">2024a</a>)</cite> redistributes outlier channels across all channels, achieving uniform distribution within each token. The Hadamard matrix <math alttext="\mathbf{H}" class="ltx_Math" display="inline" id="A3.p1.1.m1.1"><semantics id="A3.p1.1.m1.1a"><mi id="A3.p1.1.m1.1.1" xref="A3.p1.1.m1.1.1.cmml">𝐇</mi><annotation-xml encoding="MathML-Content" id="A3.p1.1.m1.1b"><ci id="A3.p1.1.m1.1.1.cmml" xref="A3.p1.1.m1.1.1">𝐇</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.1.m1.1c">\mathbf{H}</annotation><annotation encoding="application/x-llamapun" id="A3.p1.1.m1.1d">bold_H</annotation></semantics></math> is an orthogonal matrix with <math alttext="\mathbf{H}\mathbf{H}^{T}=\mathbf{I}" class="ltx_Math" display="inline" id="A3.p1.2.m2.1"><semantics id="A3.p1.2.m2.1a"><mrow id="A3.p1.2.m2.1.1" xref="A3.p1.2.m2.1.1.cmml"><msup id="A3.p1.2.m2.1.1.2" xref="A3.p1.2.m2.1.1.2.cmml"><mi id="A3.p1.2.m2.1.1.2.2" xref="A3.p1.2.m2.1.1.2.2.cmml">𝐇𝐇</mi><mi id="A3.p1.2.m2.1.1.2.3" xref="A3.p1.2.m2.1.1.2.3.cmml">T</mi></msup><mo id="A3.p1.2.m2.1.1.1" xref="A3.p1.2.m2.1.1.1.cmml">=</mo><mi id="A3.p1.2.m2.1.1.3" xref="A3.p1.2.m2.1.1.3.cmml">𝐈</mi></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.2.m2.1b"><apply id="A3.p1.2.m2.1.1.cmml" xref="A3.p1.2.m2.1.1"><eq id="A3.p1.2.m2.1.1.1.cmml" xref="A3.p1.2.m2.1.1.1"></eq><apply id="A3.p1.2.m2.1.1.2.cmml" xref="A3.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="A3.p1.2.m2.1.1.2.1.cmml" xref="A3.p1.2.m2.1.1.2">superscript</csymbol><ci id="A3.p1.2.m2.1.1.2.2.cmml" xref="A3.p1.2.m2.1.1.2.2">𝐇𝐇</ci><ci id="A3.p1.2.m2.1.1.2.3.cmml" xref="A3.p1.2.m2.1.1.2.3">𝑇</ci></apply><ci id="A3.p1.2.m2.1.1.3.cmml" xref="A3.p1.2.m2.1.1.3">𝐈</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.2.m2.1c">\mathbf{H}\mathbf{H}^{T}=\mathbf{I}</annotation><annotation encoding="application/x-llamapun" id="A3.p1.2.m2.1d">bold_HH start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT = bold_I</annotation></semantics></math>, and its entries are <math alttext="\{+1,-1\}" class="ltx_Math" display="inline" id="A3.p1.3.m3.2"><semantics id="A3.p1.3.m3.2a"><mrow id="A3.p1.3.m3.2.2.2" xref="A3.p1.3.m3.2.2.3.cmml"><mo id="A3.p1.3.m3.2.2.2.3" stretchy="false" xref="A3.p1.3.m3.2.2.3.cmml">{</mo><mrow id="A3.p1.3.m3.1.1.1.1" xref="A3.p1.3.m3.1.1.1.1.cmml"><mo id="A3.p1.3.m3.1.1.1.1a" xref="A3.p1.3.m3.1.1.1.1.cmml">+</mo><mn id="A3.p1.3.m3.1.1.1.1.2" xref="A3.p1.3.m3.1.1.1.1.2.cmml">1</mn></mrow><mo id="A3.p1.3.m3.2.2.2.4" xref="A3.p1.3.m3.2.2.3.cmml">,</mo><mrow id="A3.p1.3.m3.2.2.2.2" xref="A3.p1.3.m3.2.2.2.2.cmml"><mo id="A3.p1.3.m3.2.2.2.2a" xref="A3.p1.3.m3.2.2.2.2.cmml">−</mo><mn id="A3.p1.3.m3.2.2.2.2.2" xref="A3.p1.3.m3.2.2.2.2.2.cmml">1</mn></mrow><mo id="A3.p1.3.m3.2.2.2.5" stretchy="false" xref="A3.p1.3.m3.2.2.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.3.m3.2b"><set id="A3.p1.3.m3.2.2.3.cmml" xref="A3.p1.3.m3.2.2.2"><apply id="A3.p1.3.m3.1.1.1.1.cmml" xref="A3.p1.3.m3.1.1.1.1"><plus id="A3.p1.3.m3.1.1.1.1.1.cmml" xref="A3.p1.3.m3.1.1.1.1"></plus><cn id="A3.p1.3.m3.1.1.1.1.2.cmml" type="integer" xref="A3.p1.3.m3.1.1.1.1.2">1</cn></apply><apply id="A3.p1.3.m3.2.2.2.2.cmml" xref="A3.p1.3.m3.2.2.2.2"><minus id="A3.p1.3.m3.2.2.2.2.1.cmml" xref="A3.p1.3.m3.2.2.2.2"></minus><cn id="A3.p1.3.m3.2.2.2.2.2.cmml" type="integer" xref="A3.p1.3.m3.2.2.2.2.2">1</cn></apply></set></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.3.m3.2c">\{+1,-1\}</annotation><annotation encoding="application/x-llamapun" id="A3.p1.3.m3.2d">{ + 1 , - 1 }</annotation></semantics></math> at the same scale.
Hadamard rotation can be applied to all activations and use inverse rotation on corresponding weights to maintain computational invariance&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Ashkboos et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib2" title="">2024a</a>)</cite>. Specifically, the rotation includes absorbable and online rotations. As shown in Figure&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A3.F6" title="Figure 6 ‣ Appendix C Details of Rotation ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">6</span></a>, we follow SpinQuant&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Liu et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib22" title="">2024a</a>)</cite> to set <math alttext="R1" class="ltx_Math" display="inline" id="A3.p1.4.m4.1"><semantics id="A3.p1.4.m4.1a"><mrow id="A3.p1.4.m4.1.1" xref="A3.p1.4.m4.1.1.cmml"><mi id="A3.p1.4.m4.1.1.2" xref="A3.p1.4.m4.1.1.2.cmml">R</mi><mo id="A3.p1.4.m4.1.1.1" xref="A3.p1.4.m4.1.1.1.cmml">⁢</mo><mn id="A3.p1.4.m4.1.1.3" xref="A3.p1.4.m4.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.4.m4.1b"><apply id="A3.p1.4.m4.1.1.cmml" xref="A3.p1.4.m4.1.1"><times id="A3.p1.4.m4.1.1.1.cmml" xref="A3.p1.4.m4.1.1.1"></times><ci id="A3.p1.4.m4.1.1.2.cmml" xref="A3.p1.4.m4.1.1.2">𝑅</ci><cn id="A3.p1.4.m4.1.1.3.cmml" type="integer" xref="A3.p1.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.4.m4.1c">R1</annotation><annotation encoding="application/x-llamapun" id="A3.p1.4.m4.1d">italic_R 1</annotation></semantics></math>, <math alttext="R2" class="ltx_Math" display="inline" id="A3.p1.5.m5.1"><semantics id="A3.p1.5.m5.1a"><mrow id="A3.p1.5.m5.1.1" xref="A3.p1.5.m5.1.1.cmml"><mi id="A3.p1.5.m5.1.1.2" xref="A3.p1.5.m5.1.1.2.cmml">R</mi><mo id="A3.p1.5.m5.1.1.1" xref="A3.p1.5.m5.1.1.1.cmml">⁢</mo><mn id="A3.p1.5.m5.1.1.3" xref="A3.p1.5.m5.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.5.m5.1b"><apply id="A3.p1.5.m5.1.1.cmml" xref="A3.p1.5.m5.1.1"><times id="A3.p1.5.m5.1.1.1.cmml" xref="A3.p1.5.m5.1.1.1"></times><ci id="A3.p1.5.m5.1.1.2.cmml" xref="A3.p1.5.m5.1.1.2">𝑅</ci><cn id="A3.p1.5.m5.1.1.3.cmml" type="integer" xref="A3.p1.5.m5.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.5.m5.1c">R2</annotation><annotation encoding="application/x-llamapun" id="A3.p1.5.m5.1d">italic_R 2</annotation></semantics></math>, <math alttext="R3" class="ltx_Math" display="inline" id="A3.p1.6.m6.1"><semantics id="A3.p1.6.m6.1a"><mrow id="A3.p1.6.m6.1.1" xref="A3.p1.6.m6.1.1.cmml"><mi id="A3.p1.6.m6.1.1.2" xref="A3.p1.6.m6.1.1.2.cmml">R</mi><mo id="A3.p1.6.m6.1.1.1" xref="A3.p1.6.m6.1.1.1.cmml">⁢</mo><mn id="A3.p1.6.m6.1.1.3" xref="A3.p1.6.m6.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.6.m6.1b"><apply id="A3.p1.6.m6.1.1.cmml" xref="A3.p1.6.m6.1.1"><times id="A3.p1.6.m6.1.1.1.cmml" xref="A3.p1.6.m6.1.1.1"></times><ci id="A3.p1.6.m6.1.1.2.cmml" xref="A3.p1.6.m6.1.1.2">𝑅</ci><cn id="A3.p1.6.m6.1.1.3.cmml" type="integer" xref="A3.p1.6.m6.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.6.m6.1c">R3</annotation><annotation encoding="application/x-llamapun" id="A3.p1.6.m6.1d">italic_R 3</annotation></semantics></math> and <math alttext="R4" class="ltx_Math" display="inline" id="A3.p1.7.m7.1"><semantics id="A3.p1.7.m7.1a"><mrow id="A3.p1.7.m7.1.1" xref="A3.p1.7.m7.1.1.cmml"><mi id="A3.p1.7.m7.1.1.2" xref="A3.p1.7.m7.1.1.2.cmml">R</mi><mo id="A3.p1.7.m7.1.1.1" xref="A3.p1.7.m7.1.1.1.cmml">⁢</mo><mn id="A3.p1.7.m7.1.1.3" xref="A3.p1.7.m7.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.7.m7.1b"><apply id="A3.p1.7.m7.1.1.cmml" xref="A3.p1.7.m7.1.1"><times id="A3.p1.7.m7.1.1.1.cmml" xref="A3.p1.7.m7.1.1.1"></times><ci id="A3.p1.7.m7.1.1.2.cmml" xref="A3.p1.7.m7.1.1.2">𝑅</ci><cn id="A3.p1.7.m7.1.1.3.cmml" type="integer" xref="A3.p1.7.m7.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.7.m7.1c">R4</annotation><annotation encoding="application/x-llamapun" id="A3.p1.7.m7.1d">italic_R 4</annotation></semantics></math> rotations, details as follows.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A3.p2">
<p class="ltx_p" id="A3.p2.2"><span class="ltx_text ltx_font_bold" id="A3.p2.2.1">Absorbable Rotation.</span> Hadamard rotation of activation can be absorbed into the previous linear layer if there is no intervening non-linear operation. Thus, the rotation of input activations for q/k/v/gate/up_proj (<math alttext="R_{1}" class="ltx_Math" display="inline" id="A3.p2.1.m1.1"><semantics id="A3.p2.1.m1.1a"><msub id="A3.p2.1.m1.1.1" xref="A3.p2.1.m1.1.1.cmml"><mi id="A3.p2.1.m1.1.1.2" xref="A3.p2.1.m1.1.1.2.cmml">R</mi><mn id="A3.p2.1.m1.1.1.3" xref="A3.p2.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="A3.p2.1.m1.1b"><apply id="A3.p2.1.m1.1.1.cmml" xref="A3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="A3.p2.1.m1.1.1.1.cmml" xref="A3.p2.1.m1.1.1">subscript</csymbol><ci id="A3.p2.1.m1.1.1.2.cmml" xref="A3.p2.1.m1.1.1.2">𝑅</ci><cn id="A3.p2.1.m1.1.1.3.cmml" type="integer" xref="A3.p2.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.1.m1.1c">R_{1}</annotation><annotation encoding="application/x-llamapun" id="A3.p2.1.m1.1d">italic_R start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>) and head-wise rotation for o_proj input activations (<math alttext="R_{2}" class="ltx_Math" display="inline" id="A3.p2.2.m2.1"><semantics id="A3.p2.2.m2.1a"><msub id="A3.p2.2.m2.1.1" xref="A3.p2.2.m2.1.1.cmml"><mi id="A3.p2.2.m2.1.1.2" xref="A3.p2.2.m2.1.1.2.cmml">R</mi><mn id="A3.p2.2.m2.1.1.3" xref="A3.p2.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A3.p2.2.m2.1b"><apply id="A3.p2.2.m2.1.1.cmml" xref="A3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="A3.p2.2.m2.1.1.1.cmml" xref="A3.p2.2.m2.1.1">subscript</csymbol><ci id="A3.p2.2.m2.1.1.2.cmml" xref="A3.p2.2.m2.1.1.2">𝑅</ci><cn id="A3.p2.2.m2.1.1.3.cmml" type="integer" xref="A3.p2.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.2.m2.1c">R_{2}</annotation><annotation encoding="application/x-llamapun" id="A3.p2.2.m2.1d">italic_R start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>) can be fully absorbed without adding computation during inference.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A3.p3">
<p class="ltx_p" id="A3.p3.2"><span class="ltx_text ltx_font_bold" id="A3.p3.2.1">Online Rotation.</span> Some rotations must be executed online, including output activations of q_proj and k_proj after RoPE&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Su et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib31" title="">2024</a>)</cite> (<math alttext="R_{3}" class="ltx_Math" display="inline" id="A3.p3.1.m1.1"><semantics id="A3.p3.1.m1.1a"><msub id="A3.p3.1.m1.1.1" xref="A3.p3.1.m1.1.1.cmml"><mi id="A3.p3.1.m1.1.1.2" xref="A3.p3.1.m1.1.1.2.cmml">R</mi><mn id="A3.p3.1.m1.1.1.3" xref="A3.p3.1.m1.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="A3.p3.1.m1.1b"><apply id="A3.p3.1.m1.1.1.cmml" xref="A3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="A3.p3.1.m1.1.1.1.cmml" xref="A3.p3.1.m1.1.1">subscript</csymbol><ci id="A3.p3.1.m1.1.1.2.cmml" xref="A3.p3.1.m1.1.1.2">𝑅</ci><cn id="A3.p3.1.m1.1.1.3.cmml" type="integer" xref="A3.p3.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p3.1.m1.1c">R_{3}</annotation><annotation encoding="application/x-llamapun" id="A3.p3.1.m1.1d">italic_R start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT</annotation></semantics></math>), and the input activation of down_proj (<math alttext="R_{4}" class="ltx_Math" display="inline" id="A3.p3.2.m2.1"><semantics id="A3.p3.2.m2.1a"><msub id="A3.p3.2.m2.1.1" xref="A3.p3.2.m2.1.1.cmml"><mi id="A3.p3.2.m2.1.1.2" xref="A3.p3.2.m2.1.1.2.cmml">R</mi><mn id="A3.p3.2.m2.1.1.3" xref="A3.p3.2.m2.1.1.3.cmml">4</mn></msub><annotation-xml encoding="MathML-Content" id="A3.p3.2.m2.1b"><apply id="A3.p3.2.m2.1.1.cmml" xref="A3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="A3.p3.2.m2.1.1.1.cmml" xref="A3.p3.2.m2.1.1">subscript</csymbol><ci id="A3.p3.2.m2.1.1.2.cmml" xref="A3.p3.2.m2.1.1.2">𝑅</ci><cn id="A3.p3.2.m2.1.1.3.cmml" type="integer" xref="A3.p3.2.m2.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p3.2.m2.1c">R_{4}</annotation><annotation encoding="application/x-llamapun" id="A3.p3.2.m2.1d">italic_R start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT</annotation></semantics></math>). These online rotations are efficiently implemented using the Walsh-Hadamard transform without significant overhead.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A3.p4">
<p class="ltx_p" id="A3.p4.6">If not specifically mentioned, we activate all rotation (<math alttext="R_{1}" class="ltx_Math" display="inline" id="A3.p4.1.m1.1"><semantics id="A3.p4.1.m1.1a"><msub id="A3.p4.1.m1.1.1" xref="A3.p4.1.m1.1.1.cmml"><mi id="A3.p4.1.m1.1.1.2" xref="A3.p4.1.m1.1.1.2.cmml">R</mi><mn id="A3.p4.1.m1.1.1.3" xref="A3.p4.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="A3.p4.1.m1.1b"><apply id="A3.p4.1.m1.1.1.cmml" xref="A3.p4.1.m1.1.1"><csymbol cd="ambiguous" id="A3.p4.1.m1.1.1.1.cmml" xref="A3.p4.1.m1.1.1">subscript</csymbol><ci id="A3.p4.1.m1.1.1.2.cmml" xref="A3.p4.1.m1.1.1.2">𝑅</ci><cn id="A3.p4.1.m1.1.1.3.cmml" type="integer" xref="A3.p4.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p4.1.m1.1c">R_{1}</annotation><annotation encoding="application/x-llamapun" id="A3.p4.1.m1.1d">italic_R start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="R_{2}" class="ltx_Math" display="inline" id="A3.p4.2.m2.1"><semantics id="A3.p4.2.m2.1a"><msub id="A3.p4.2.m2.1.1" xref="A3.p4.2.m2.1.1.cmml"><mi id="A3.p4.2.m2.1.1.2" xref="A3.p4.2.m2.1.1.2.cmml">R</mi><mn id="A3.p4.2.m2.1.1.3" xref="A3.p4.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A3.p4.2.m2.1b"><apply id="A3.p4.2.m2.1.1.cmml" xref="A3.p4.2.m2.1.1"><csymbol cd="ambiguous" id="A3.p4.2.m2.1.1.1.cmml" xref="A3.p4.2.m2.1.1">subscript</csymbol><ci id="A3.p4.2.m2.1.1.2.cmml" xref="A3.p4.2.m2.1.1.2">𝑅</ci><cn id="A3.p4.2.m2.1.1.3.cmml" type="integer" xref="A3.p4.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p4.2.m2.1c">R_{2}</annotation><annotation encoding="application/x-llamapun" id="A3.p4.2.m2.1d">italic_R start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="R_{3}" class="ltx_Math" display="inline" id="A3.p4.3.m3.1"><semantics id="A3.p4.3.m3.1a"><msub id="A3.p4.3.m3.1.1" xref="A3.p4.3.m3.1.1.cmml"><mi id="A3.p4.3.m3.1.1.2" xref="A3.p4.3.m3.1.1.2.cmml">R</mi><mn id="A3.p4.3.m3.1.1.3" xref="A3.p4.3.m3.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="A3.p4.3.m3.1b"><apply id="A3.p4.3.m3.1.1.cmml" xref="A3.p4.3.m3.1.1"><csymbol cd="ambiguous" id="A3.p4.3.m3.1.1.1.cmml" xref="A3.p4.3.m3.1.1">subscript</csymbol><ci id="A3.p4.3.m3.1.1.2.cmml" xref="A3.p4.3.m3.1.1.2">𝑅</ci><cn id="A3.p4.3.m3.1.1.3.cmml" type="integer" xref="A3.p4.3.m3.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p4.3.m3.1c">R_{3}</annotation><annotation encoding="application/x-llamapun" id="A3.p4.3.m3.1d">italic_R start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="R_{4}" class="ltx_Math" display="inline" id="A3.p4.4.m4.1"><semantics id="A3.p4.4.m4.1a"><msub id="A3.p4.4.m4.1.1" xref="A3.p4.4.m4.1.1.cmml"><mi id="A3.p4.4.m4.1.1.2" xref="A3.p4.4.m4.1.1.2.cmml">R</mi><mn id="A3.p4.4.m4.1.1.3" xref="A3.p4.4.m4.1.1.3.cmml">4</mn></msub><annotation-xml encoding="MathML-Content" id="A3.p4.4.m4.1b"><apply id="A3.p4.4.m4.1.1.cmml" xref="A3.p4.4.m4.1.1"><csymbol cd="ambiguous" id="A3.p4.4.m4.1.1.1.cmml" xref="A3.p4.4.m4.1.1">subscript</csymbol><ci id="A3.p4.4.m4.1.1.2.cmml" xref="A3.p4.4.m4.1.1.2">𝑅</ci><cn id="A3.p4.4.m4.1.1.3.cmml" type="integer" xref="A3.p4.4.m4.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p4.4.m4.1c">R_{4}</annotation><annotation encoding="application/x-llamapun" id="A3.p4.4.m4.1d">italic_R start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT</annotation></semantics></math>) in weight-activation quantization scenes, and only activate absorbable rotation (<math alttext="R_{1}" class="ltx_Math" display="inline" id="A3.p4.5.m5.1"><semantics id="A3.p4.5.m5.1a"><msub id="A3.p4.5.m5.1.1" xref="A3.p4.5.m5.1.1.cmml"><mi id="A3.p4.5.m5.1.1.2" xref="A3.p4.5.m5.1.1.2.cmml">R</mi><mn id="A3.p4.5.m5.1.1.3" xref="A3.p4.5.m5.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="A3.p4.5.m5.1b"><apply id="A3.p4.5.m5.1.1.cmml" xref="A3.p4.5.m5.1.1"><csymbol cd="ambiguous" id="A3.p4.5.m5.1.1.1.cmml" xref="A3.p4.5.m5.1.1">subscript</csymbol><ci id="A3.p4.5.m5.1.1.2.cmml" xref="A3.p4.5.m5.1.1.2">𝑅</ci><cn id="A3.p4.5.m5.1.1.3.cmml" type="integer" xref="A3.p4.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p4.5.m5.1c">R_{1}</annotation><annotation encoding="application/x-llamapun" id="A3.p4.5.m5.1d">italic_R start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="R_{2}" class="ltx_Math" display="inline" id="A3.p4.6.m6.1"><semantics id="A3.p4.6.m6.1a"><msub id="A3.p4.6.m6.1.1" xref="A3.p4.6.m6.1.1.cmml"><mi id="A3.p4.6.m6.1.1.2" xref="A3.p4.6.m6.1.1.2.cmml">R</mi><mn id="A3.p4.6.m6.1.1.3" xref="A3.p4.6.m6.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A3.p4.6.m6.1b"><apply id="A3.p4.6.m6.1.1.cmml" xref="A3.p4.6.m6.1.1"><csymbol cd="ambiguous" id="A3.p4.6.m6.1.1.1.cmml" xref="A3.p4.6.m6.1.1">subscript</csymbol><ci id="A3.p4.6.m6.1.1.2.cmml" xref="A3.p4.6.m6.1.1.2">𝑅</ci><cn id="A3.p4.6.m6.1.1.3.cmml" type="integer" xref="A3.p4.6.m6.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p4.6.m6.1c">R_{2}</annotation><annotation encoding="application/x-llamapun" id="A3.p4.6.m6.1d">italic_R start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>) in weight-only quantization.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="A3.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="173" id="A3.F6.g1" src="https://arxiv.org/html/2410.05265v1/x13.png" width="747">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Illustrate of hadamard rotation within a transformer block of Llama&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Touvron et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib33" title="">2023</a>)</cite> model.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_table" id="A3.T8">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 8: </span>Speedup of per-tensor static quantization compared to per-token dynamic quantization in 4-bit activation quantization. </figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_table ltx_figure_panel ltx_align_center" id="A3.T8.st1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">(a) </span><span class="ltx_text ltx_font_bold" id="A3.T8.st1.2.1">Nvidia RTX 3090 GPU</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A3.T8.st1.3">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A3.T8.st1.3.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A3.T8.st1.3.1.1.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="A3.T8.st1.3.1.1.1.1">(Seq_len,dimension)</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="A3.T8.st1.3.1.1.2">
<span class="ltx_text ltx_font_bold" id="A3.T8.st1.3.1.1.2.1">Quantization Time</span> (ms)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A3.T8.st1.3.1.1.3" rowspan="2"><span class="ltx_text ltx_font_bold" id="A3.T8.st1.3.1.1.3.1">Speedup</span></th>
</tr>
<tr class="ltx_tr" id="A3.T8.st1.3.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A3.T8.st1.3.2.2.1"><span class="ltx_text ltx_font_bold" id="A3.T8.st1.3.2.2.1.1">Per-token Dynamic</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A3.T8.st1.3.2.2.2"><span class="ltx_text ltx_font_bold" id="A3.T8.st1.3.2.2.2.1">Per-tensor static</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A3.T8.st1.3.3.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T8.st1.3.3.1.1">(1,4096)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T8.st1.3.3.1.2">0.0127</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T8.st1.3.3.1.3">0.0038</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T8.st1.3.3.1.4">3.34x</td>
</tr>
<tr class="ltx_tr" id="A3.T8.st1.3.4.2">
<td class="ltx_td ltx_align_center" id="A3.T8.st1.3.4.2.1">(1,8192)</td>
<td class="ltx_td ltx_align_center" id="A3.T8.st1.3.4.2.2">0.0144</td>
<td class="ltx_td ltx_align_center" id="A3.T8.st1.3.4.2.3">0.004</td>
<td class="ltx_td ltx_align_center" id="A3.T8.st1.3.4.2.4">3.60x</td>
</tr>
<tr class="ltx_tr" id="A3.T8.st1.3.5.3">
<td class="ltx_td ltx_align_center" id="A3.T8.st1.3.5.3.1">(2048,4096)</td>
<td class="ltx_td ltx_align_center" id="A3.T8.st1.3.5.3.2">0.1073</td>
<td class="ltx_td ltx_align_center" id="A3.T8.st1.3.5.3.3">0.0344</td>
<td class="ltx_td ltx_align_center" id="A3.T8.st1.3.5.3.4">3.12x</td>
</tr>
<tr class="ltx_tr" id="A3.T8.st1.3.6.4">
<td class="ltx_td ltx_align_center" id="A3.T8.st1.3.6.4.1">(2048,8192)</td>
<td class="ltx_td ltx_align_center" id="A3.T8.st1.3.6.4.2">0.2084</td>
<td class="ltx_td ltx_align_center" id="A3.T8.st1.3.6.4.3">0.0652</td>
<td class="ltx_td ltx_align_center" id="A3.T8.st1.3.6.4.4">3.19x</td>
</tr>
<tr class="ltx_tr" id="A3.T8.st1.3.7.5">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A3.T8.st1.3.7.5.1"><span class="ltx_text ltx_font_bold" id="A3.T8.st1.3.7.5.1.1">Average Speedup</span></td>
<td class="ltx_td ltx_border_bb ltx_border_t" id="A3.T8.st1.3.7.5.2"></td>
<td class="ltx_td ltx_border_bb ltx_border_t" id="A3.T8.st1.3.7.5.3"></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A3.T8.st1.3.7.5.4"><span class="ltx_text ltx_font_bold" id="A3.T8.st1.3.7.5.4.1">3.31x</span></td>
</tr>
</tbody>
</table>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_table ltx_figure_panel ltx_align_center" id="A3.T8.st2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">(b) </span><span class="ltx_text ltx_font_bold" id="A3.T8.st2.2.1">Nvidia A100-80GB GPU</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A3.T8.st2.3">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A3.T8.st2.3.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A3.T8.st2.3.1.1.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="A3.T8.st2.3.1.1.1.1">(Seq_len,dimension)</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="A3.T8.st2.3.1.1.2">
<span class="ltx_text ltx_font_bold" id="A3.T8.st2.3.1.1.2.1">Quantization Time</span> (ms)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A3.T8.st2.3.1.1.3" rowspan="2"><span class="ltx_text ltx_font_bold" id="A3.T8.st2.3.1.1.3.1">Speedup</span></th>
</tr>
<tr class="ltx_tr" id="A3.T8.st2.3.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A3.T8.st2.3.2.2.1"><span class="ltx_text ltx_font_bold" id="A3.T8.st2.3.2.2.1.1">Per-token Dynamic</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A3.T8.st2.3.2.2.2"><span class="ltx_text ltx_font_bold" id="A3.T8.st2.3.2.2.2.1">Per-tensor static</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A3.T8.st2.3.3.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T8.st2.3.3.1.1">(1,4096)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T8.st2.3.3.1.2">0.020</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T8.st2.3.3.1.3">0.0072</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T8.st2.3.3.1.4">2.81x</td>
</tr>
<tr class="ltx_tr" id="A3.T8.st2.3.4.2">
<td class="ltx_td ltx_align_center" id="A3.T8.st2.3.4.2.1">(1,8192)</td>
<td class="ltx_td ltx_align_center" id="A3.T8.st2.3.4.2.2">0.022</td>
<td class="ltx_td ltx_align_center" id="A3.T8.st2.3.4.2.3">0.0075</td>
<td class="ltx_td ltx_align_center" id="A3.T8.st2.3.4.2.4">2.88x</td>
</tr>
<tr class="ltx_tr" id="A3.T8.st2.3.5.3">
<td class="ltx_td ltx_align_center" id="A3.T8.st2.3.5.3.1">(2048,4096)</td>
<td class="ltx_td ltx_align_center" id="A3.T8.st2.3.5.3.2">0.095</td>
<td class="ltx_td ltx_align_center" id="A3.T8.st2.3.5.3.3">0.033</td>
<td class="ltx_td ltx_align_center" id="A3.T8.st2.3.5.3.4">2.88x</td>
</tr>
<tr class="ltx_tr" id="A3.T8.st2.3.6.4">
<td class="ltx_td ltx_align_center" id="A3.T8.st2.3.6.4.1">(2048,8192)</td>
<td class="ltx_td ltx_align_center" id="A3.T8.st2.3.6.4.2">0.157</td>
<td class="ltx_td ltx_align_center" id="A3.T8.st2.3.6.4.3">0.058</td>
<td class="ltx_td ltx_align_center" id="A3.T8.st2.3.6.4.4">2.71x</td>
</tr>
<tr class="ltx_tr" id="A3.T8.st2.3.7.5">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A3.T8.st2.3.7.5.1"><span class="ltx_text ltx_font_bold" id="A3.T8.st2.3.7.5.1.1">Average Speedup</span></td>
<td class="ltx_td ltx_border_bb ltx_border_t" id="A3.T8.st2.3.7.5.2"></td>
<td class="ltx_td ltx_border_bb ltx_border_t" id="A3.T8.st2.3.7.5.3"></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A3.T8.st2.3.7.5.4"><span class="ltx_text ltx_font_bold" id="A3.T8.st2.3.7.5.4.1">2.82x</span></td>
</tr>
</tbody>
</table>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_table" id="A3.T9">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 9: </span>Speedup of W4A4 quantized linear layers compared to FP16 linear layer. Numbers in brackets indicate the speedup compared to FP16.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_table ltx_figure_panel ltx_align_center" id="A3.T9.st1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">(a) </span><span class="ltx_text ltx_font_bold" id="A3.T9.st1.2.1">Nvidia RTX 3090 GPU</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A3.T9.st1.3">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A3.T9.st1.3.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A3.T9.st1.3.1.1.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="A3.T9.st1.3.1.1.1.1">(Seq_len,input_c, output_c)</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A3.T9.st1.3.1.1.2" rowspan="2"><span class="ltx_text" id="A3.T9.st1.3.1.1.2.1"><span class="ltx_text ltx_font_bold" id="A3.T9.st1.3.1.1.2.1.1">FP16</span> (ms)</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3" id="A3.T9.st1.3.1.1.3">
<span class="ltx_text ltx_font_bold" id="A3.T9.st1.3.1.1.3.1">W4A4</span> (ms)</th>
</tr>
<tr class="ltx_tr" id="A3.T9.st1.3.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A3.T9.st1.3.2.2.1">Quarot</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A3.T9.st1.3.2.2.2">+ static quant</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A3.T9.st1.3.2.2.3">+ improved GEMV</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A3.T9.st1.3.3.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T9.st1.3.3.1.1">(1,4096,4096)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T9.st1.3.3.1.2">0.0512</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T9.st1.3.3.1.3">0.0578 (0.89x)</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T9.st1.3.3.1.4">0.0472 (1.08x)</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T9.st1.3.3.1.5">0.0223 (<span class="ltx_text ltx_font_bold" id="A3.T9.st1.3.3.1.5.1">2.30x</span>)</td>
</tr>
<tr class="ltx_tr" id="A3.T9.st1.3.4.2">
<td class="ltx_td ltx_align_center" id="A3.T9.st1.3.4.2.1">(1,4096,14336)</td>
<td class="ltx_td ltx_align_center" id="A3.T9.st1.3.4.2.2">0.1548</td>
<td class="ltx_td ltx_align_left" id="A3.T9.st1.3.4.2.3">0.0641 (2.42x)</td>
<td class="ltx_td ltx_align_left" id="A3.T9.st1.3.4.2.4">0.0549 (2.83x)</td>
<td class="ltx_td ltx_align_left" id="A3.T9.st1.3.4.2.5">0.0475 (<span class="ltx_text ltx_font_bold" id="A3.T9.st1.3.4.2.5.1">3.27x</span>)</td>
</tr>
<tr class="ltx_tr" id="A3.T9.st1.3.5.3">
<td class="ltx_td ltx_align_center" id="A3.T9.st1.3.5.3.1">(1,8192,8192)</td>
<td class="ltx_td ltx_align_center" id="A3.T9.st1.3.5.3.2">0.1080</td>
<td class="ltx_td ltx_align_left" id="A3.T9.st1.3.5.3.3">0.0957 (1.77x)</td>
<td class="ltx_td ltx_align_left" id="A3.T9.st1.3.5.3.4">0.0863 (1.97x)</td>
<td class="ltx_td ltx_align_left" id="A3.T9.st1.3.5.3.5">0.0561 (<span class="ltx_text ltx_font_bold" id="A3.T9.st1.3.5.3.5.1">3.02x</span>)</td>
</tr>
<tr class="ltx_tr" id="A3.T9.st1.3.6.4">
<td class="ltx_td ltx_align_center" id="A3.T9.st1.3.6.4.1">(1,8192,28672)</td>
<td class="ltx_td ltx_align_center" id="A3.T9.st1.3.6.4.2">0.5762</td>
<td class="ltx_td ltx_align_left" id="A3.T9.st1.3.6.4.3">0.2087 (2.76x)</td>
<td class="ltx_td ltx_align_left" id="A3.T9.st1.3.6.4.4">0.1977 (2.91x)</td>
<td class="ltx_td ltx_align_left" id="A3.T9.st1.3.6.4.5">0.1503 (<span class="ltx_text ltx_font_bold" id="A3.T9.st1.3.6.4.5.1">3.83x</span>)</td>
</tr>
<tr class="ltx_tr" id="A3.T9.st1.3.7.5">
<td class="ltx_td ltx_align_center" id="A3.T9.st1.3.7.5.1">(2048,4096,4096)</td>
<td class="ltx_td ltx_align_center" id="A3.T9.st1.3.7.5.2">1.0666</td>
<td class="ltx_td ltx_align_left" id="A3.T9.st1.3.7.5.3">0.3699 (2.88x)</td>
<td class="ltx_td ltx_align_left" id="A3.T9.st1.3.7.5.4">0.2965 (<span class="ltx_text ltx_font_bold" id="A3.T9.st1.3.7.5.4.1">3.59x</span>)</td>
<td class="ltx_td ltx_align_left" id="A3.T9.st1.3.7.5.5">-</td>
</tr>
<tr class="ltx_tr" id="A3.T9.st1.3.8.6">
<td class="ltx_td ltx_align_center" id="A3.T9.st1.3.8.6.1">(2048,4096,14336)</td>
<td class="ltx_td ltx_align_center" id="A3.T9.st1.3.8.6.2">3.5766</td>
<td class="ltx_td ltx_align_left" id="A3.T9.st1.3.8.6.3">0.9358 (3.93x)</td>
<td class="ltx_td ltx_align_left" id="A3.T9.st1.3.8.6.4">0.8618 (<span class="ltx_text ltx_font_bold" id="A3.T9.st1.3.8.6.4.1">4.27x</span>)</td>
<td class="ltx_td ltx_align_left" id="A3.T9.st1.3.8.6.5">-</td>
</tr>
<tr class="ltx_tr" id="A3.T9.st1.3.9.7">
<td class="ltx_td ltx_align_center" id="A3.T9.st1.3.9.7.1">(2048,8192,8192)</td>
<td class="ltx_td ltx_align_center" id="A3.T9.st1.3.9.7.2">3.9986</td>
<td class="ltx_td ltx_align_left" id="A3.T9.st1.3.9.7.3">1.0211 (4.03x)</td>
<td class="ltx_td ltx_align_left" id="A3.T9.st1.3.9.7.4">0.8718 (<span class="ltx_text ltx_font_bold" id="A3.T9.st1.3.9.7.4.1">4.72x</span>)</td>
<td class="ltx_td ltx_align_left" id="A3.T9.st1.3.9.7.5">-</td>
</tr>
<tr class="ltx_tr" id="A3.T9.st1.3.10.8">
<td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T9.st1.3.10.8.1">(2048,8192,28672)</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T9.st1.3.10.8.2">13.1607</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A3.T9.st1.3.10.8.3">2.8609 (4.74x)</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A3.T9.st1.3.10.8.4">2.7177 (<span class="ltx_text ltx_font_bold" id="A3.T9.st1.3.10.8.4.1">4.99x</span>)</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A3.T9.st1.3.10.8.5">-</td>
</tr>
</tbody>
</table>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_table ltx_figure_panel ltx_align_center" id="A3.T9.st2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">(b) </span><span class="ltx_text ltx_font_bold" id="A3.T9.st2.2.1">Nvidia A100-80GB GPU</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A3.T9.st2.3">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A3.T9.st2.3.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A3.T9.st2.3.1.1.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="A3.T9.st2.3.1.1.1.1">(Seq_len,input_c, output_c)</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A3.T9.st2.3.1.1.2" rowspan="2"><span class="ltx_text" id="A3.T9.st2.3.1.1.2.1"><span class="ltx_text ltx_font_bold" id="A3.T9.st2.3.1.1.2.1.1">FP16</span> (ms)</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3" id="A3.T9.st2.3.1.1.3">
<span class="ltx_text ltx_font_bold" id="A3.T9.st2.3.1.1.3.1">INT4</span> (ms)</th>
</tr>
<tr class="ltx_tr" id="A3.T9.st2.3.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A3.T9.st2.3.2.2.1">Quarot</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A3.T9.st2.3.2.2.2">+ static quant</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A3.T9.st2.3.2.2.3">+ improved GEMV</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A3.T9.st2.3.3.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T9.st2.3.3.1.1">(1,4096,4096)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T9.st2.3.3.1.2">0.0418</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T9.st2.3.3.1.3">0.0588 (0.71x)</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T9.st2.3.3.1.4">0.0455 (0.92x)</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T9.st2.3.3.1.5">0.0235 (<span class="ltx_text ltx_font_bold" id="A3.T9.st2.3.3.1.5.1">1.78x</span>)</td>
</tr>
<tr class="ltx_tr" id="A3.T9.st2.3.4.2">
<td class="ltx_td ltx_align_center" id="A3.T9.st2.3.4.2.1">(1,4096,14336)</td>
<td class="ltx_td ltx_align_center" id="A3.T9.st2.3.4.2.2">0.1026</td>
<td class="ltx_td ltx_align_left" id="A3.T9.st2.3.4.2.3">0.0679 (1.51x)</td>
<td class="ltx_td ltx_align_left" id="A3.T9.st2.3.4.2.4">0.0556 (1.85x)</td>
<td class="ltx_td ltx_align_left" id="A3.T9.st2.3.4.2.5">0.0441 (<span class="ltx_text ltx_font_bold" id="A3.T9.st2.3.4.2.5.1">2.33x</span>)</td>
</tr>
<tr class="ltx_tr" id="A3.T9.st2.3.5.3">
<td class="ltx_td ltx_align_center" id="A3.T9.st2.3.5.3.1">(1,8192,8192)</td>
<td class="ltx_td ltx_align_center" id="A3.T9.st2.3.5.3.2">0.1080</td>
<td class="ltx_td ltx_align_left" id="A3.T9.st2.3.5.3.3">0.0888 (1.22x)</td>
<td class="ltx_td ltx_align_left" id="A3.T9.st2.3.5.3.4">0.0735 (1.47x)</td>
<td class="ltx_td ltx_align_left" id="A3.T9.st2.3.5.3.5">0.0508 (<span class="ltx_text ltx_font_bold" id="A3.T9.st2.3.5.3.5.1">2.13x</span>)</td>
</tr>
<tr class="ltx_tr" id="A3.T9.st2.3.6.4">
<td class="ltx_td ltx_align_center" id="A3.T9.st2.3.6.4.1">(1,8192,28672)</td>
<td class="ltx_td ltx_align_center" id="A3.T9.st2.3.6.4.2">0.3036</td>
<td class="ltx_td ltx_align_left" id="A3.T9.st2.3.6.4.3">0.1668 (1.82x)</td>
<td class="ltx_td ltx_align_left" id="A3.T9.st2.3.6.4.4">0.1534 (1.97x)</td>
<td class="ltx_td ltx_align_left" id="A3.T9.st2.3.6.4.5">0.1114 (<span class="ltx_text ltx_font_bold" id="A3.T9.st2.3.6.4.5.1">2.72x</span>)</td>
</tr>
<tr class="ltx_tr" id="A3.T9.st2.3.7.5">
<td class="ltx_td ltx_align_center" id="A3.T9.st2.3.7.5.1">(2048,4096,4096)</td>
<td class="ltx_td ltx_align_center" id="A3.T9.st2.3.7.5.2">0.2762</td>
<td class="ltx_td ltx_align_left" id="A3.T9.st2.3.7.5.3">0.2408 (1.15x)</td>
<td class="ltx_td ltx_align_left" id="A3.T9.st2.3.7.5.4">0.1799 (<span class="ltx_text ltx_font_bold" id="A3.T9.st2.3.7.5.4.1">1.54x</span>)</td>
<td class="ltx_td ltx_align_left" id="A3.T9.st2.3.7.5.5">-</td>
</tr>
<tr class="ltx_tr" id="A3.T9.st2.3.8.6">
<td class="ltx_td ltx_align_center" id="A3.T9.st2.3.8.6.1">(2048,4096,14336)</td>
<td class="ltx_td ltx_align_center" id="A3.T9.st2.3.8.6.2">1.0092</td>
<td class="ltx_td ltx_align_left" id="A3.T9.st2.3.8.6.3">0.5461 (1.85x)</td>
<td class="ltx_td ltx_align_left" id="A3.T9.st2.3.8.6.4">0.4850 (<span class="ltx_text ltx_font_bold" id="A3.T9.st2.3.8.6.4.1">2.08x</span>)</td>
<td class="ltx_td ltx_align_left" id="A3.T9.st2.3.8.6.5">-</td>
</tr>
<tr class="ltx_tr" id="A3.T9.st2.3.9.7">
<td class="ltx_td ltx_align_center" id="A3.T9.st2.3.9.7.1">(2048,8192,8192)</td>
<td class="ltx_td ltx_align_center" id="A3.T9.st2.3.9.7.2">1.0583</td>
<td class="ltx_td ltx_align_left" id="A3.T9.st2.3.9.7.3">0.5298 (2.00x)</td>
<td class="ltx_td ltx_align_left" id="A3.T9.st2.3.9.7.4">0.4349 (<span class="ltx_text ltx_font_bold" id="A3.T9.st2.3.9.7.4.1">2.43x</span>)</td>
<td class="ltx_td ltx_align_left" id="A3.T9.st2.3.9.7.5">-</td>
</tr>
<tr class="ltx_tr" id="A3.T9.st2.3.10.8">
<td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T9.st2.3.10.8.1">(2048,8192,28672)</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T9.st2.3.10.8.2">3.6897</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A3.T9.st2.3.10.8.3">1.4686 (2.51x)</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A3.T9.st2.3.10.8.4">1.3857 (<span class="ltx_text ltx_font_bold" id="A3.T9.st2.3.10.8.4.1">2.66x</span>)</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A3.T9.st2.3.10.8.5">-</td>
</tr>
</tbody>
</table>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_appendix" id="A4">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Inference Efficiency Details</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A4.p1">
<p class="ltx_p" id="A4.p1.1">In this section, we examine the inference efficiency of PrefixQuant. We conduct tests on Nvidia RTX 3090 and A100-80GB GPUs, considering sequence lengths of 1 and 2048, with a batch size of 1. We detail the speedup ratios for quantization overhead, quantized linear layers, and end-to-end inference below.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A4.p2">
<p class="ltx_p" id="A4.p2.2"><span class="ltx_text ltx_font_bold" id="A4.p2.2.1">Reduced Quantization Overhead.</span> Activations are quantized and packed into low-bit formats for matrix manipulations. We define the time for this process during inference as quantization overhead. The per-token dynamic quantization kernel is sourced from QuaRot&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Ashkboos et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib3" title="">2024b</a>)</cite>. Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A3.T8.st2" title="In Table 8 ‣ Appendix C Details of Rotation ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">8(b)</span></a> shows the speedup of per-tensor static quantization over per-token dynamic quantization. We can find that the per-tensor static quantization kernel achieves speedups of <math alttext="3.31\times" class="ltx_math_unparsed" display="inline" id="A4.p2.1.m1.1"><semantics id="A4.p2.1.m1.1a"><mrow id="A4.p2.1.m1.1b"><mn id="A4.p2.1.m1.1.1">3.31</mn><mo id="A4.p2.1.m1.1.2" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="A4.p2.1.m1.1c">3.31\times</annotation><annotation encoding="application/x-llamapun" id="A4.p2.1.m1.1d">3.31 ×</annotation></semantics></math> on the RTX 3090 and <math alttext="2.82\times" class="ltx_math_unparsed" display="inline" id="A4.p2.2.m2.1"><semantics id="A4.p2.2.m2.1a"><mrow id="A4.p2.2.m2.1b"><mn id="A4.p2.2.m2.1.1">2.82</mn><mo id="A4.p2.2.m2.1.2" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="A4.p2.2.m2.1c">2.82\times</annotation><annotation encoding="application/x-llamapun" id="A4.p2.2.m2.1d">2.82 ×</annotation></semantics></math> on the A100-80GB.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A4.p3">
<p class="ltx_p" id="A4.p3.8"><span class="ltx_text ltx_font_bold" id="A4.p3.8.1">Accelerated Quantized Linear Layer.</span> The quantized linear layer consists of quantization, low-bit matrix multiplication, and de-quantization. The speedup for the quantization process is in Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A3.T8.st2" title="In Table 8 ‣ Appendix C Details of Rotation ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">8(b)</span></a>. For low-bit matrix multiplication, we use the 4-bit GEMM kernel from CUTLASS and design a custom kernel for W4A4 GEMV. We also integrate the de-quantization process into the GEMM and GEMV kernels. Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A3.T9.st2" title="In Table 9 ‣ Appendix C Details of Rotation ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">9(b)</span></a> presents the speedup ratios of the QuaRot kernel and our kernel compared to FP16. With a sequence length of 1, our quantized linear layer improves the QuaRot speedup from <math alttext="0.89\times\sim 2.76\times" class="ltx_math_unparsed" display="inline" id="A4.p3.1.m1.1"><semantics id="A4.p3.1.m1.1a"><mrow id="A4.p3.1.m1.1b"><mn id="A4.p3.1.m1.1.1">0.89</mn><mo id="A4.p3.1.m1.1.2" lspace="0.222em" rspace="0em">×</mo><mo id="A4.p3.1.m1.1.3" lspace="0em">∼</mo><mn id="A4.p3.1.m1.1.4">2.76</mn><mo id="A4.p3.1.m1.1.5" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="A4.p3.1.m1.1c">0.89\times\sim 2.76\times</annotation><annotation encoding="application/x-llamapun" id="A4.p3.1.m1.1d">0.89 × ∼ 2.76 ×</annotation></semantics></math> to <math alttext="2.30\times\sim 3.83\times" class="ltx_math_unparsed" display="inline" id="A4.p3.2.m2.1"><semantics id="A4.p3.2.m2.1a"><mrow id="A4.p3.2.m2.1b"><mn id="A4.p3.2.m2.1.1">2.30</mn><mo id="A4.p3.2.m2.1.2" lspace="0.222em" rspace="0em">×</mo><mo id="A4.p3.2.m2.1.3" lspace="0em">∼</mo><mn id="A4.p3.2.m2.1.4">3.83</mn><mo id="A4.p3.2.m2.1.5" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="A4.p3.2.m2.1c">2.30\times\sim 3.83\times</annotation><annotation encoding="application/x-llamapun" id="A4.p3.2.m2.1d">2.30 × ∼ 3.83 ×</annotation></semantics></math> on the RTX 3090, and from <math alttext="0.71\times\sim 1.82\times" class="ltx_math_unparsed" display="inline" id="A4.p3.3.m3.1"><semantics id="A4.p3.3.m3.1a"><mrow id="A4.p3.3.m3.1b"><mn id="A4.p3.3.m3.1.1">0.71</mn><mo id="A4.p3.3.m3.1.2" lspace="0.222em" rspace="0em">×</mo><mo id="A4.p3.3.m3.1.3" lspace="0em">∼</mo><mn id="A4.p3.3.m3.1.4">1.82</mn><mo id="A4.p3.3.m3.1.5" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="A4.p3.3.m3.1c">0.71\times\sim 1.82\times</annotation><annotation encoding="application/x-llamapun" id="A4.p3.3.m3.1d">0.71 × ∼ 1.82 ×</annotation></semantics></math> to <math alttext="1.78\times\sim 2.72\times" class="ltx_math_unparsed" display="inline" id="A4.p3.4.m4.1"><semantics id="A4.p3.4.m4.1a"><mrow id="A4.p3.4.m4.1b"><mn id="A4.p3.4.m4.1.1">1.78</mn><mo id="A4.p3.4.m4.1.2" lspace="0.222em" rspace="0em">×</mo><mo id="A4.p3.4.m4.1.3" lspace="0em">∼</mo><mn id="A4.p3.4.m4.1.4">2.72</mn><mo id="A4.p3.4.m4.1.5" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="A4.p3.4.m4.1c">1.78\times\sim 2.72\times</annotation><annotation encoding="application/x-llamapun" id="A4.p3.4.m4.1d">1.78 × ∼ 2.72 ×</annotation></semantics></math> on the A100-80GB. With a sequence length of 2048, our layer enhances the QuaRot speedup from <math alttext="2.88\times\sim 4.74\times" class="ltx_math_unparsed" display="inline" id="A4.p3.5.m5.1"><semantics id="A4.p3.5.m5.1a"><mrow id="A4.p3.5.m5.1b"><mn id="A4.p3.5.m5.1.1">2.88</mn><mo id="A4.p3.5.m5.1.2" lspace="0.222em" rspace="0em">×</mo><mo id="A4.p3.5.m5.1.3" lspace="0em">∼</mo><mn id="A4.p3.5.m5.1.4">4.74</mn><mo id="A4.p3.5.m5.1.5" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="A4.p3.5.m5.1c">2.88\times\sim 4.74\times</annotation><annotation encoding="application/x-llamapun" id="A4.p3.5.m5.1d">2.88 × ∼ 4.74 ×</annotation></semantics></math> to <math alttext="3.59\times\sim 4.99\times" class="ltx_math_unparsed" display="inline" id="A4.p3.6.m6.1"><semantics id="A4.p3.6.m6.1a"><mrow id="A4.p3.6.m6.1b"><mn id="A4.p3.6.m6.1.1">3.59</mn><mo id="A4.p3.6.m6.1.2" lspace="0.222em" rspace="0em">×</mo><mo id="A4.p3.6.m6.1.3" lspace="0em">∼</mo><mn id="A4.p3.6.m6.1.4">4.99</mn><mo id="A4.p3.6.m6.1.5" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="A4.p3.6.m6.1c">3.59\times\sim 4.99\times</annotation><annotation encoding="application/x-llamapun" id="A4.p3.6.m6.1d">3.59 × ∼ 4.99 ×</annotation></semantics></math> on the RTX 3090, and from <math alttext="1.15\times\sim 2.51\times" class="ltx_math_unparsed" display="inline" id="A4.p3.7.m7.1"><semantics id="A4.p3.7.m7.1a"><mrow id="A4.p3.7.m7.1b"><mn id="A4.p3.7.m7.1.1">1.15</mn><mo id="A4.p3.7.m7.1.2" lspace="0.222em" rspace="0em">×</mo><mo id="A4.p3.7.m7.1.3" lspace="0em">∼</mo><mn id="A4.p3.7.m7.1.4">2.51</mn><mo id="A4.p3.7.m7.1.5" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="A4.p3.7.m7.1c">1.15\times\sim 2.51\times</annotation><annotation encoding="application/x-llamapun" id="A4.p3.7.m7.1d">1.15 × ∼ 2.51 ×</annotation></semantics></math> to <math alttext="1.54\times\sim 2.66\times" class="ltx_math_unparsed" display="inline" id="A4.p3.8.m8.1"><semantics id="A4.p3.8.m8.1a"><mrow id="A4.p3.8.m8.1b"><mn id="A4.p3.8.m8.1.1">1.54</mn><mo id="A4.p3.8.m8.1.2" lspace="0.222em" rspace="0em">×</mo><mo id="A4.p3.8.m8.1.3" lspace="0em">∼</mo><mn id="A4.p3.8.m8.1.4">2.66</mn><mo id="A4.p3.8.m8.1.5" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="A4.p3.8.m8.1c">1.54\times\sim 2.66\times</annotation><annotation encoding="application/x-llamapun" id="A4.p3.8.m8.1d">1.54 × ∼ 2.66 ×</annotation></semantics></math> on the A100-80GB.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_appendix" id="A5">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix E </span>Quantization Time</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="A5.p1">
<p class="ltx_p" id="A5.p1.1">Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A5.T10" title="Table 10 ‣ Appendix E Quantization Time ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">10</span></a> shows the quantization time for PrefixQuant. PrefixQuant identifies prefixed tokens quickly, taking only 0.2 minutes for Llama-3-8B and 1 minute for Llama-3-70B. In contrast, the recent CushionCache&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Son et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib30" title="">2024</a>)</cite> requires 12 hours for the same task on Llama-3-8B. Additionally, the grid-search initialization is efficient, taking 0.7 minutes for Llama-3-8B and 12 minutes for Llama-3-70B.
Experiments in Tables&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#S5.T3" title="Table 3 ‣ 5.2 Block-wise Fine-tuning ‣ 5 PrefixQuant ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">3</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#S6.T4" title="Table 4 ‣ 6.2 Comparison Results ‣ 6 Experiments ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">4</span></a> demonstrate that PrefixQuant, even without fine-tuning, outperforms previous methods&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Lin et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib20" title="">2024b</a>; Ashkboos et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib3" title="">2024b</a>)</cite>. Fine-tuning requires more time, taking 2.2 hours for Llama-3-8B and 17 hours for Llama-3-70B, but it can successfully enhances the potential of low-bit quantization.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="A5.T10">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 10: </span>The quantization time of PrefixQuant on single NVIDIA-A100-80GB GPU. Fine-tuning indicates the time of 20 fine-tuning epochs of W4A4KV4.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A5.T10.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A5.T10.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A5.T10.1.1.1.1"><span class="ltx_text ltx_font_bold" id="A5.T10.1.1.1.1.1">Model</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A5.T10.1.1.1.2"><span class="ltx_text ltx_font_bold" id="A5.T10.1.1.1.2.1">Find Prefixed Outliers</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A5.T10.1.1.1.3"><span class="ltx_text ltx_font_bold" id="A5.T10.1.1.1.3.1">Grid-search initialization</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A5.T10.1.1.1.4"><span class="ltx_text ltx_font_bold" id="A5.T10.1.1.1.4.1">Fine-tuning</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A5.T10.1.2.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T10.1.2.1.1">Llama-3-8B</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T10.1.2.1.2">0.2 m</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T10.1.2.1.3">0.7 m</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T10.1.2.1.4">2.2 h</td>
</tr>
<tr class="ltx_tr" id="A5.T10.1.3.2">
<td class="ltx_td ltx_align_center ltx_border_bb" id="A5.T10.1.3.2.1">Llama-3-70B</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A5.T10.1.3.2.2">1 m</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A5.T10.1.3.2.3">12 m</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A5.T10.1.3.2.4">17 h</td>
</tr>
</tbody>
</table>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_appendix" id="A6">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix F </span>More Ablation Results</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_table" id="A6.T11">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 11: </span>Ablation studies on calibration dataset, including (a) Dataset type, (b) Training sequence length and (c) Total training tokens. “N” indicates number of training samples, and “S” is the length of each samples. The model used here is Llama-3-8B with W4A4KV4 quantization. Our default settings are marked in <span class="ltx_text" id="A6.T11.2.1" style="background-color:#D9D9D9;">gray</span>.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_table ltx_figure_panel ltx_align_center" id="A6.T11.st1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">(a) </span>Dataset</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A6.T11.st1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A6.T11.st1.1.1.1">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A6.T11.st1.1.1.1.1" style="padding-left:0.0pt;padding-right:0.0pt;"><span class="ltx_text ltx_font_bold" id="A6.T11.st1.1.1.1.1.1">Dataset</span></th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A6.T11.st1.1.1.1.2" style="padding-left:0.0pt;padding-right:0.0pt;"><span class="ltx_text ltx_font_bold" id="A6.T11.st1.1.1.1.2.1">Wiki PPL</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A6.T11.st1.1.2.1">
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A6.T11.st1.1.2.1.1" style="padding-left:0.0pt;padding-right:0.0pt;">C4</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A6.T11.st1.1.2.1.2" style="padding-left:0.0pt;padding-right:0.0pt;">7.60</td>
</tr>
<tr class="ltx_tr" id="A6.T11.st1.1.3.2">
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A6.T11.st1.1.3.2.1" style="padding-left:0.0pt;padding-right:0.0pt;">RedPajama</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A6.T11.st1.1.3.2.2" style="padding-left:0.0pt;padding-right:0.0pt;">7.49</td>
</tr>
<tr class="ltx_tr" id="A6.T11.st1.1.4.3">
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" id="A6.T11.st1.1.4.3.1" style="background-color:#D9D9D9;padding-left:0.0pt;padding-right:0.0pt;"><span class="ltx_text" id="A6.T11.st1.1.4.3.1.1" style="background-color:#D9D9D9;">Pile</span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" id="A6.T11.st1.1.4.3.2" style="padding-left:0.0pt;padding-right:0.0pt;"><span class="ltx_text ltx_font_bold" id="A6.T11.st1.1.4.3.2.1">7.42</span></td>
</tr>
</tbody>
</table>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_table ltx_figure_panel ltx_align_center" id="A6.T11.st2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">(b) </span>Sequence length</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A6.T11.st2.4">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A6.T11.st2.1.1">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A6.T11.st2.1.1.1" style="padding-left:0.0pt;padding-right:0.0pt;"><span class="ltx_text ltx_font_bold" id="A6.T11.st2.1.1.1.1">N <math alttext="\times" class="ltx_Math" display="inline" id="A6.T11.st2.1.1.1.1.m1.1"><semantics id="A6.T11.st2.1.1.1.1.m1.1a"><mo id="A6.T11.st2.1.1.1.1.m1.1.1" xref="A6.T11.st2.1.1.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A6.T11.st2.1.1.1.1.m1.1b"><times id="A6.T11.st2.1.1.1.1.m1.1.1.cmml" xref="A6.T11.st2.1.1.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A6.T11.st2.1.1.1.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="A6.T11.st2.1.1.1.1.m1.1d">×</annotation></semantics></math> S</span></th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A6.T11.st2.1.1.2" style="padding-left:0.0pt;padding-right:0.0pt;"><span class="ltx_text ltx_font_bold" id="A6.T11.st2.1.1.2.1">Wiki PPL</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A6.T11.st2.2.2">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row ltx_border_t" id="A6.T11.st2.2.2.1" style="padding-left:0.0pt;padding-right:0.0pt;">256 <math alttext="\times" class="ltx_Math" display="inline" id="A6.T11.st2.2.2.1.m1.1"><semantics id="A6.T11.st2.2.2.1.m1.1a"><mo id="A6.T11.st2.2.2.1.m1.1.1" xref="A6.T11.st2.2.2.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A6.T11.st2.2.2.1.m1.1b"><times id="A6.T11.st2.2.2.1.m1.1.1.cmml" xref="A6.T11.st2.2.2.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A6.T11.st2.2.2.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="A6.T11.st2.2.2.1.m1.1d">×</annotation></semantics></math>2048</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A6.T11.st2.2.2.2" style="padding-left:0.0pt;padding-right:0.0pt;">7.65</td>
</tr>
<tr class="ltx_tr" id="A6.T11.st2.3.3">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row" id="A6.T11.st2.3.3.1" style="background-color:#D9D9D9;padding-left:0.0pt;padding-right:0.0pt;"><span class="ltx_text" id="A6.T11.st2.3.3.1.1" style="background-color:#D9D9D9;">512<math alttext="\times" class="ltx_Math" display="inline" id="A6.T11.st2.3.3.1.1.m1.1"><semantics id="A6.T11.st2.3.3.1.1.m1.1a"><mo id="A6.T11.st2.3.3.1.1.m1.1.1" mathbackground="#D9D9D9" xref="A6.T11.st2.3.3.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A6.T11.st2.3.3.1.1.m1.1b"><times id="A6.T11.st2.3.3.1.1.m1.1.1.cmml" xref="A6.T11.st2.3.3.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A6.T11.st2.3.3.1.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="A6.T11.st2.3.3.1.1.m1.1d">×</annotation></semantics></math>1024</span></th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A6.T11.st2.3.3.2" style="padding-left:0.0pt;padding-right:0.0pt;"><span class="ltx_text ltx_font_bold" id="A6.T11.st2.3.3.2.1">7.42</span></td>
</tr>
<tr class="ltx_tr" id="A6.T11.st2.4.4">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="A6.T11.st2.4.4.1" style="padding-left:0.0pt;padding-right:0.0pt;">1024<math alttext="\times" class="ltx_Math" display="inline" id="A6.T11.st2.4.4.1.m1.1"><semantics id="A6.T11.st2.4.4.1.m1.1a"><mo id="A6.T11.st2.4.4.1.m1.1.1" xref="A6.T11.st2.4.4.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A6.T11.st2.4.4.1.m1.1b"><times id="A6.T11.st2.4.4.1.m1.1.1.cmml" xref="A6.T11.st2.4.4.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A6.T11.st2.4.4.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="A6.T11.st2.4.4.1.m1.1d">×</annotation></semantics></math>512</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" id="A6.T11.st2.4.4.2" style="padding-left:0.0pt;padding-right:0.0pt;">7.65</td>
</tr>
</tbody>
</table>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_table ltx_figure_panel ltx_align_center" id="A6.T11.st3">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">(c) </span>Total token number</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A6.T11.st3.4">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A6.T11.st3.1.1">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A6.T11.st3.1.1.1" style="padding-left:0.0pt;padding-right:0.0pt;"><span class="ltx_text ltx_font_bold" id="A6.T11.st3.1.1.1.1">N <math alttext="\times" class="ltx_Math" display="inline" id="A6.T11.st3.1.1.1.1.m1.1"><semantics id="A6.T11.st3.1.1.1.1.m1.1a"><mo id="A6.T11.st3.1.1.1.1.m1.1.1" xref="A6.T11.st3.1.1.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A6.T11.st3.1.1.1.1.m1.1b"><times id="A6.T11.st3.1.1.1.1.m1.1.1.cmml" xref="A6.T11.st3.1.1.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A6.T11.st3.1.1.1.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="A6.T11.st3.1.1.1.1.m1.1d">×</annotation></semantics></math> S</span></th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A6.T11.st3.1.1.2" style="padding-left:0.0pt;padding-right:0.0pt;"><span class="ltx_text ltx_font_bold" id="A6.T11.st3.1.1.2.1">Wiki PPL</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A6.T11.st3.2.2">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row ltx_border_t" id="A6.T11.st3.2.2.1" style="padding-left:0.0pt;padding-right:0.0pt;">256 <math alttext="\times" class="ltx_Math" display="inline" id="A6.T11.st3.2.2.1.m1.1"><semantics id="A6.T11.st3.2.2.1.m1.1a"><mo id="A6.T11.st3.2.2.1.m1.1.1" xref="A6.T11.st3.2.2.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A6.T11.st3.2.2.1.m1.1b"><times id="A6.T11.st3.2.2.1.m1.1.1.cmml" xref="A6.T11.st3.2.2.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A6.T11.st3.2.2.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="A6.T11.st3.2.2.1.m1.1d">×</annotation></semantics></math>1024</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A6.T11.st3.2.2.2" style="padding-left:0.0pt;padding-right:0.0pt;">7.46</td>
</tr>
<tr class="ltx_tr" id="A6.T11.st3.3.3">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row" id="A6.T11.st3.3.3.1" style="background-color:#D9D9D9;padding-left:0.0pt;padding-right:0.0pt;"><span class="ltx_text" id="A6.T11.st3.3.3.1.1" style="background-color:#D9D9D9;">512 <math alttext="\times" class="ltx_Math" display="inline" id="A6.T11.st3.3.3.1.1.m1.1"><semantics id="A6.T11.st3.3.3.1.1.m1.1a"><mo id="A6.T11.st3.3.3.1.1.m1.1.1" mathbackground="#D9D9D9" xref="A6.T11.st3.3.3.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A6.T11.st3.3.3.1.1.m1.1b"><times id="A6.T11.st3.3.3.1.1.m1.1.1.cmml" xref="A6.T11.st3.3.3.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A6.T11.st3.3.3.1.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="A6.T11.st3.3.3.1.1.m1.1d">×</annotation></semantics></math>1024</span></th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A6.T11.st3.3.3.2" style="padding-left:0.0pt;padding-right:0.0pt;">7.42</td>
</tr>
<tr class="ltx_tr" id="A6.T11.st3.4.4">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="A6.T11.st3.4.4.1" style="padding-left:0.0pt;padding-right:0.0pt;">1024<math alttext="\times" class="ltx_Math" display="inline" id="A6.T11.st3.4.4.1.m1.1"><semantics id="A6.T11.st3.4.4.1.m1.1a"><mo id="A6.T11.st3.4.4.1.m1.1.1" xref="A6.T11.st3.4.4.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A6.T11.st3.4.4.1.m1.1b"><times id="A6.T11.st3.4.4.1.m1.1.1.cmml" xref="A6.T11.st3.4.4.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A6.T11.st3.4.4.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="A6.T11.st3.4.4.1.m1.1d">×</annotation></semantics></math>1024</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" id="A6.T11.st3.4.4.2" style="padding-left:0.0pt;padding-right:0.0pt;"><span class="ltx_text ltx_font_bold" id="A6.T11.st3.4.4.2.1">7.41</span></td>
</tr>
</tbody>
</table>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_table" id="A6.T12">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 12: </span>Ablation study about training epochs. The model used here is Llama-3-8B, and WikiText2 perplexity with 2048 context length is reported. Our default settings are marked in <span class="ltx_text" id="A6.T12.2.1" style="background-color:#D9D9D9;">gray</span>.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A6.T12.3">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A6.T12.3.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A6.T12.3.1.1.1"><span class="ltx_text ltx_font_bold" id="A6.T12.3.1.1.1.1">Epochs</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A6.T12.3.1.1.2"><span class="ltx_text ltx_font_bold" id="A6.T12.3.1.1.2.1">W4A8KV4</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A6.T12.3.1.1.3"><span class="ltx_text ltx_font_bold" id="A6.T12.3.1.1.3.1">W4A4KV4</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A6.T12.3.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="A6.T12.3.2.1.1">0 (w/o FT)</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T12.3.2.1.2">6.90</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T12.3.2.1.3">7.93</td>
</tr>
<tr class="ltx_tr" id="A6.T12.3.3.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A6.T12.3.3.2.1">5</th>
<td class="ltx_td ltx_align_center" id="A6.T12.3.3.2.2">6.66</td>
<td class="ltx_td ltx_align_center" id="A6.T12.3.3.2.3">7.53</td>
</tr>
<tr class="ltx_tr" id="A6.T12.3.4.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A6.T12.3.4.3.1">10</th>
<td class="ltx_td ltx_align_center" id="A6.T12.3.4.3.2" style="background-color:#D9D9D9;"><span class="ltx_text ltx_font_bold" id="A6.T12.3.4.3.2.1" style="background-color:#D9D9D9;">6.63</span></td>
<td class="ltx_td ltx_align_center" id="A6.T12.3.4.3.3">7.47</td>
</tr>
<tr class="ltx_tr" id="A6.T12.3.5.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A6.T12.3.5.4.1">20</th>
<td class="ltx_td ltx_align_center" id="A6.T12.3.5.4.2">6.63</td>
<td class="ltx_td ltx_align_center" id="A6.T12.3.5.4.3" style="background-color:#D9D9D9;"><span class="ltx_text" id="A6.T12.3.5.4.3.1" style="background-color:#D9D9D9;">7.42</span></td>
</tr>
<tr class="ltx_tr" id="A6.T12.3.6.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="A6.T12.3.6.5.1">30</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T12.3.6.5.2">6.63</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T12.3.6.5.3"><span class="ltx_text ltx_font_bold" id="A6.T12.3.6.5.3.1">7.41</span></td>
</tr>
</tbody>
</table>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A6.p1">
<p class="ltx_p" id="A6.p1.3"><span class="ltx_text ltx_font_bold" id="A6.p1.3.1">Fine-tuning Datasets.</span>
Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A6.T11.st1" title="In Table 11 ‣ Appendix F More Ablation Results ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">11(a)</span></a> shows results with different fine-tuning datasets, including C4&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Raffel et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib26" title="">2020</a>)</cite>, RedPajama&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Computer, <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib10" title="">2023</a>)</cite>, and Pile&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Gao et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib13" title="">2020</a>)</cite>. We find that Pile achieves the best performance. Additionally, we ablate the sequence length of each training sample and the total training tokens. Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A6.T11.st2" title="In Table 11 ‣ Appendix F More Ablation Results ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">11(b)</span></a> shows that a sequence length of 1024 achieves the best performance. Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A6.T11.st3" title="In Table 11 ‣ Appendix F More Ablation Results ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">11(c)</span></a> demonstrates that fine-tuning on <math alttext="512\times 1024" class="ltx_Math" display="inline" id="A6.p1.1.m1.1"><semantics id="A6.p1.1.m1.1a"><mrow id="A6.p1.1.m1.1.1" xref="A6.p1.1.m1.1.1.cmml"><mn id="A6.p1.1.m1.1.1.2" xref="A6.p1.1.m1.1.1.2.cmml">512</mn><mo id="A6.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A6.p1.1.m1.1.1.1.cmml">×</mo><mn id="A6.p1.1.m1.1.1.3" xref="A6.p1.1.m1.1.1.3.cmml">1024</mn></mrow><annotation-xml encoding="MathML-Content" id="A6.p1.1.m1.1b"><apply id="A6.p1.1.m1.1.1.cmml" xref="A6.p1.1.m1.1.1"><times id="A6.p1.1.m1.1.1.1.cmml" xref="A6.p1.1.m1.1.1.1"></times><cn id="A6.p1.1.m1.1.1.2.cmml" type="integer" xref="A6.p1.1.m1.1.1.2">512</cn><cn id="A6.p1.1.m1.1.1.3.cmml" type="integer" xref="A6.p1.1.m1.1.1.3">1024</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.p1.1.m1.1c">512\times 1024</annotation><annotation encoding="application/x-llamapun" id="A6.p1.1.m1.1d">512 × 1024</annotation></semantics></math> tokens achieves satisfactory performance, with further increases in training samples only marginally improving performance.
Note that the optimal token number for fine-tuning datasets may change with quantization precision. Generally, lower precision requires more training data. For example, EfficientQAT shows that <math alttext="4096\times 2048" class="ltx_Math" display="inline" id="A6.p1.2.m2.1"><semantics id="A6.p1.2.m2.1a"><mrow id="A6.p1.2.m2.1.1" xref="A6.p1.2.m2.1.1.cmml"><mn id="A6.p1.2.m2.1.1.2" xref="A6.p1.2.m2.1.1.2.cmml">4096</mn><mo id="A6.p1.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="A6.p1.2.m2.1.1.1.cmml">×</mo><mn id="A6.p1.2.m2.1.1.3" xref="A6.p1.2.m2.1.1.3.cmml">2048</mn></mrow><annotation-xml encoding="MathML-Content" id="A6.p1.2.m2.1b"><apply id="A6.p1.2.m2.1.1.cmml" xref="A6.p1.2.m2.1.1"><times id="A6.p1.2.m2.1.1.1.cmml" xref="A6.p1.2.m2.1.1.1"></times><cn id="A6.p1.2.m2.1.1.2.cmml" type="integer" xref="A6.p1.2.m2.1.1.2">4096</cn><cn id="A6.p1.2.m2.1.1.3.cmml" type="integer" xref="A6.p1.2.m2.1.1.3">2048</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.p1.2.m2.1c">4096\times 2048</annotation><annotation encoding="application/x-llamapun" id="A6.p1.2.m2.1d">4096 × 2048</annotation></semantics></math> tokens are needed for W2A16 quantization, while our paper shows that only <math alttext="512\times 1024" class="ltx_Math" display="inline" id="A6.p1.3.m3.1"><semantics id="A6.p1.3.m3.1a"><mrow id="A6.p1.3.m3.1.1" xref="A6.p1.3.m3.1.1.cmml"><mn id="A6.p1.3.m3.1.1.2" xref="A6.p1.3.m3.1.1.2.cmml">512</mn><mo id="A6.p1.3.m3.1.1.1" lspace="0.222em" rspace="0.222em" xref="A6.p1.3.m3.1.1.1.cmml">×</mo><mn id="A6.p1.3.m3.1.1.3" xref="A6.p1.3.m3.1.1.3.cmml">1024</mn></mrow><annotation-xml encoding="MathML-Content" id="A6.p1.3.m3.1b"><apply id="A6.p1.3.m3.1.1.cmml" xref="A6.p1.3.m3.1.1"><times id="A6.p1.3.m3.1.1.1.cmml" xref="A6.p1.3.m3.1.1.1"></times><cn id="A6.p1.3.m3.1.1.2.cmml" type="integer" xref="A6.p1.3.m3.1.1.2">512</cn><cn id="A6.p1.3.m3.1.1.3.cmml" type="integer" xref="A6.p1.3.m3.1.1.3">1024</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.p1.3.m3.1c">512\times 1024</annotation><annotation encoding="application/x-llamapun" id="A6.p1.3.m3.1d">512 × 1024</annotation></semantics></math> tokens are needed for W4A4 quantization.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A6.p2">
<p class="ltx_p" id="A6.p2.1"><span class="ltx_text ltx_font_bold" id="A6.p2.1.1">Training Epochs.</span>
Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A6.T12" title="Table 12 ‣ Appendix F More Ablation Results ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">12</span></a> demonstrates that 10 and 20 epochs are sufficient for the convergence of fine-tuning on W4A8KV4 and W4A4KV4.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="A6.T13">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 13: </span>Ablation study about quantization type of activation. The model used here is Llama-3-8B with W4A4KV4 quantization. WikiText2 perplexity with 2048 context length is reported.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A6.T13.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A6.T13.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A6.T13.1.1.1.1"><span class="ltx_text ltx_font_bold" id="A6.T13.1.1.1.1.1">Fine-Tuning</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A6.T13.1.1.1.2"><span class="ltx_text ltx_font_bold" id="A6.T13.1.1.1.2.1">Quant Type</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A6.T13.1.1.1.3"><span class="ltx_text ltx_font_bold" id="A6.T13.1.1.1.3.1">W4A8KV4</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A6.T13.1.1.1.4"><span class="ltx_text ltx_font_bold" id="A6.T13.1.1.1.4.1">W4A4KV4</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A6.T13.1.2.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T13.1.2.1.1">No</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T13.1.2.1.2">token-wise dynamic</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T13.1.2.1.3"><span class="ltx_text ltx_font_bold" id="A6.T13.1.2.1.3.1">6.84</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T13.1.2.1.4">8.29</td>
</tr>
<tr class="ltx_tr" id="A6.T13.1.3.2">
<td class="ltx_td ltx_align_center" id="A6.T13.1.3.2.1">No</td>
<td class="ltx_td ltx_align_center" id="A6.T13.1.3.2.2">tensor-wise static</td>
<td class="ltx_td ltx_align_center" id="A6.T13.1.3.2.3">6.90</td>
<td class="ltx_td ltx_align_center" id="A6.T13.1.3.2.4"><span class="ltx_text ltx_font_bold" id="A6.T13.1.3.2.4.1">7.93</span></td>
</tr>
<tr class="ltx_tr" id="A6.T13.1.4.3">
<td class="ltx_td ltx_align_center" id="A6.T13.1.4.3.1">Yes</td>
<td class="ltx_td ltx_align_center" id="A6.T13.1.4.3.2">token-wise dynamic</td>
<td class="ltx_td ltx_align_center" id="A6.T13.1.4.3.3"><span class="ltx_text ltx_font_bold" id="A6.T13.1.4.3.3.1">6.60</span></td>
<td class="ltx_td ltx_align_center" id="A6.T13.1.4.3.4">7.88</td>
</tr>
<tr class="ltx_tr" id="A6.T13.1.5.4">
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T13.1.5.4.1">Yes</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T13.1.5.4.2">tensor-wise static</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T13.1.5.4.3">6.63</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T13.1.5.4.4"><span class="ltx_text ltx_font_bold" id="A6.T13.1.5.4.4.1">7.41</span></td>
</tr>
</tbody>
</table>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A6.p3">
<p class="ltx_p" id="A6.p3.1"><span class="ltx_text ltx_font_bold" id="A6.p3.1.1">Dynamic Quantization.</span>
Tables&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#S5.T3" title="Table 3 ‣ 5.2 Block-wise Fine-tuning ‣ 5 PrefixQuant ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">3</span></a> and&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#S6.T4" title="Table 4 ‣ 6.2 Comparison Results ‣ 6 Experiments ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">4</span></a> show that PrefixQuant with static quantization can surpass previous state-of-the-art methods&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Xiao et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib38" title="">2023a</a>; Ashkboos et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib3" title="">2024b</a>; Lin et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib20" title="">2024b</a>)</cite> with dynamic quantization. Note that without prefixed outliers, per-token dynamic quantization consistently outperforms per-tensor static quantization across different precisions, as shown in Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#S6.T6" title="Table 6 ‣ 6.3 Inference Speed ‣ 6 Experiments ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">6</span></a>.
Therefore, a question arises: can dynamic quantization further improve the performance of PrefixQuant? We replace per-tensor static activation quantization in PrefixQuant with per-token dynamic quantization and report the results in Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A6.T13" title="Table 13 ‣ Appendix F More Ablation Results ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">13</span></a>. We find that the winner varies with different precision. Specifically, per-token dynamic quantization marginally surpasses per-tensor static quantization in W4A8KV4 quantization, while per-tensor static quantization significantly outperforms per-token dynamic quantization in W4A4KV4 quantization. This is because, in high-precision quantization such as 8-bit, clipping is not necessary&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Gong et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib15" title="">2024</a>)</cite>, and the MAX-MIN initialization of dynamic quantization adapts to a more diverse range flexibly. However, in low-precision quantization such as 4-bit, clipping is crucial to balance clipping error and rounding error&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Lin et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib19" title="">2023</a>)</cite>, resulting in per-tensor static quantization outperforming per-token dynamic quantization.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="A6.T14">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 14: </span>Ablation study about the number of prefixed tokens. WikiText2 perplexity with 2048 context length and W4A4KV4 quantization is reported. Number <math alttext="n" class="ltx_Math" display="inline" id="A6.T14.3.m1.1"><semantics id="A6.T14.3.m1.1b"><mi id="A6.T14.3.m1.1.1" xref="A6.T14.3.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="A6.T14.3.m1.1c"><ci id="A6.T14.3.m1.1.1.cmml" xref="A6.T14.3.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.T14.3.m1.1d">n</annotation><annotation encoding="application/x-llamapun" id="A6.T14.3.m1.1e">italic_n</annotation></semantics></math> indicates the first <math alttext="n" class="ltx_Math" display="inline" id="A6.T14.4.m2.1"><semantics id="A6.T14.4.m2.1b"><mi id="A6.T14.4.m2.1.1" xref="A6.T14.4.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="A6.T14.4.m2.1c"><ci id="A6.T14.4.m2.1.1.cmml" xref="A6.T14.4.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.T14.4.m2.1d">n</annotation><annotation encoding="application/x-llamapun" id="A6.T14.4.m2.1e">italic_n</annotation></semantics></math> tokens in Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#S5.T1" title="Table 1 ‣ 5.1 Prefixed Outliers ‣ 5 PrefixQuant ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">1</span></a> are set as the prefixed tokens.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A6.T14.5">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A6.T14.5.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A6.T14.5.1.1.1"><span class="ltx_text ltx_font_bold" id="A6.T14.5.1.1.1.1">Model</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A6.T14.5.1.1.2"><span class="ltx_text ltx_font_bold" id="A6.T14.5.1.1.2.1">Method</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A6.T14.5.1.1.3"><span class="ltx_text ltx_font_bold" id="A6.T14.5.1.1.3.1">0</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A6.T14.5.1.1.4"><span class="ltx_text ltx_font_bold" id="A6.T14.5.1.1.4.1">1</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A6.T14.5.1.1.5"><span class="ltx_text ltx_font_bold" id="A6.T14.5.1.1.5.1">2</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A6.T14.5.1.1.6"><span class="ltx_text ltx_font_bold" id="A6.T14.5.1.1.6.1">3</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A6.T14.5.1.1.7"><span class="ltx_text ltx_font_bold" id="A6.T14.5.1.1.7.1">4</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A6.T14.5.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="A6.T14.5.2.1.1">Llama-2-7B</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="A6.T14.5.2.1.2">PrefixQuant w/o FT</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T14.5.2.1.3">333.52</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T14.5.2.1.4">74.37</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T14.5.2.1.5">6.21</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T14.5.2.1.6">6.22</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T14.5.2.1.7">-</td>
</tr>
<tr class="ltx_tr" id="A6.T14.5.3.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A6.T14.5.3.2.1">Llama-2-7B</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A6.T14.5.3.2.2">PrefixQuant</th>
<td class="ltx_td ltx_align_center" id="A6.T14.5.3.2.3">17.63</td>
<td class="ltx_td ltx_align_center" id="A6.T14.5.3.2.4">10.71</td>
<td class="ltx_td ltx_align_center" id="A6.T14.5.3.2.5"><span class="ltx_text ltx_font_bold" id="A6.T14.5.3.2.5.1">6.01</span></td>
<td class="ltx_td ltx_align_center" id="A6.T14.5.3.2.6"><span class="ltx_text ltx_font_bold" id="A6.T14.5.3.2.6.1">6.01</span></td>
<td class="ltx_td" id="A6.T14.5.3.2.7"></td>
</tr>
<tr class="ltx_tr" id="A6.T14.5.4.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A6.T14.5.4.3.1">
<span class="ltx_ERROR undefined" id="A6.T14.5.4.3.1.1">\cdashline</span>1-7
Mistral-7B-v0.3</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A6.T14.5.4.3.2">PrefixQuant w/o FT</th>
<td class="ltx_td ltx_align_center" id="A6.T14.5.4.3.3">90.02</td>
<td class="ltx_td ltx_align_center" id="A6.T14.5.4.3.4">6.12</td>
<td class="ltx_td ltx_align_center" id="A6.T14.5.4.3.5">5.84</td>
<td class="ltx_td ltx_align_center" id="A6.T14.5.4.3.6">6.43</td>
<td class="ltx_td ltx_align_center" id="A6.T14.5.4.3.7">5.89</td>
</tr>
<tr class="ltx_tr" id="A6.T14.5.5.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="A6.T14.5.5.4.1">Mistral-7B-v0.3</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="A6.T14.5.5.4.2">PrefixQuant</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T14.5.5.4.3">15.97</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T14.5.5.4.4">7.08</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T14.5.5.4.5">5.83</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T14.5.5.4.6">5.95</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T14.5.5.4.7"><span class="ltx_text ltx_font_bold" id="A6.T14.5.5.4.7.1">5.79</span></td>
</tr>
</tbody>
</table>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_table" id="A6.T15">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 15: </span>Ablation study about the content of prefixed tokens. WikiText2 perplexity with 2048 context length and W4A4KV4 quantization is reported. “default” refers to the prefixed tokens obtained through the proposed method. “random” represents the average performance of 10 times with randomly selected prefixed tokens.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A6.T15.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A6.T15.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A6.T15.1.1.1.1">Model</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A6.T15.1.1.1.2">Type</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A6.T15.1.1.1.3">Prefixed</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A6.T15.1.1.1.4">Wiki PPL (PrefixQuant w/o FT)</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A6.T15.1.2.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T15.1.2.1.1">Llama-2-7B</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T15.1.2.1.2">default</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A6.T15.1.2.1.3">.\n[BOS]</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T15.1.2.1.4">6.22</td>
</tr>
<tr class="ltx_tr" id="A6.T15.1.3.2">
<td class="ltx_td ltx_align_center" id="A6.T15.1.3.2.1">Llama-2-7B</td>
<td class="ltx_td ltx_align_center" id="A6.T15.1.3.2.2">only highest frequency</td>
<td class="ltx_td ltx_align_left" id="A6.T15.1.3.2.3">…</td>
<td class="ltx_td ltx_align_center" id="A6.T15.1.3.2.4">12.07</td>
</tr>
<tr class="ltx_tr" id="A6.T15.1.4.3">
<td class="ltx_td ltx_align_center" id="A6.T15.1.4.3.1">Llama-2-7B</td>
<td class="ltx_td ltx_align_center" id="A6.T15.1.4.3.2">random</td>
<td class="ltx_td ltx_align_left" id="A6.T15.1.4.3.3">-</td>
<td class="ltx_td ltx_align_center" id="A6.T15.1.4.3.4">66.51</td>
</tr>
<tr class="ltx_tr" id="A6.T15.1.5.4">
<td class="ltx_td ltx_align_center" id="A6.T15.1.5.4.1">
<span class="ltx_ERROR undefined" id="A6.T15.1.5.4.1.1">\cdashline</span>1-4
Mistral-7B-v0.3</td>
<td class="ltx_td ltx_align_center" id="A6.T15.1.5.4.2">default</td>
<td class="ltx_td ltx_align_left" id="A6.T15.1.5.4.3">\n.to[BOS]</td>
<td class="ltx_td ltx_align_center" id="A6.T15.1.5.4.4">5.89</td>
</tr>
<tr class="ltx_tr" id="A6.T15.1.6.5">
<td class="ltx_td ltx_align_center" id="A6.T15.1.6.5.1">Mistral-7B-v0.3</td>
<td class="ltx_td ltx_align_center" id="A6.T15.1.6.5.2">only highest frequency</td>
<td class="ltx_td ltx_align_left" id="A6.T15.1.6.5.3">\n\n\n\n</td>
<td class="ltx_td ltx_align_center" id="A6.T15.1.6.5.4">6.23</td>
</tr>
<tr class="ltx_tr" id="A6.T15.1.7.6">
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T15.1.7.6.1">Mistral-7B-v0.3</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T15.1.7.6.2">random</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A6.T15.1.7.6.3">-</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T15.1.7.6.4">80.05</td>
</tr>
</tbody>
</table>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A6.p4">
<p class="ltx_p" id="A6.p4.1"><span class="ltx_text ltx_font_bold" id="A6.p4.1.1">Number of Prefixed Tokens.</span> In Sec.&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#S5.SS1" title="5.1 Prefixed Outliers ‣ 5 PrefixQuant ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">5.1</span></a>, we determine the number of prefixed tokens by calculating the average number of outlier tokens and adding an additional [BOS] token. Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#S5.T1" title="Table 1 ‣ 5.1 Prefixed Outliers ‣ 5 PrefixQuant ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">1</span></a> illustrates the specific number and content of these tokens. We use Llama-2-7B (3 outlier tokens) and Mistral-7B-v0.3 (4 outlier tokens) to study the impact of the number of prefixed tokens. Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A6.T14" title="Table 14 ‣ Appendix F More Ablation Results ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">14</span></a> shows that the adaptively calculated number of prefixed tokens achieves the best performance. Notably, for models like Llama-2-7B, using 2 prefixed tokens without the additional [BOS] token also yields excellent performance. For consistency and simplicity, we include the [BOS] token in the prefixed tokens in our experiments.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para ltx_noindent" id="A6.p5">
<p class="ltx_p" id="A6.p5.3"><span class="ltx_text ltx_font_bold" id="A6.p5.3.1">Content of Prefixed Tokens.</span> PrefixQuant determines the number of outlier tokens <math alttext="N" class="ltx_Math" display="inline" id="A6.p5.1.m1.1"><semantics id="A6.p5.1.m1.1a"><mi id="A6.p5.1.m1.1.1" xref="A6.p5.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="A6.p5.1.m1.1b"><ci id="A6.p5.1.m1.1.1.cmml" xref="A6.p5.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.p5.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="A6.p5.1.m1.1d">italic_N</annotation></semantics></math> and designates the top-<math alttext="N" class="ltx_Math" display="inline" id="A6.p5.2.m2.1"><semantics id="A6.p5.2.m2.1a"><mi id="A6.p5.2.m2.1.1" xref="A6.p5.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="A6.p5.2.m2.1b"><ci id="A6.p5.2.m2.1.1.cmml" xref="A6.p5.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.p5.2.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="A6.p5.2.m2.1d">italic_N</annotation></semantics></math> high-frequency outlier tokens as prefixes in the KV cache. Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A6.T15" title="Table 15 ‣ Appendix F More Ablation Results ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">15</span></a> examines various prefixed tokens with the same token count. The results show that using the top-<math alttext="N" class="ltx_Math" display="inline" id="A6.p5.3.m3.1"><semantics id="A6.p5.3.m3.1a"><mi id="A6.p5.3.m3.1.1" xref="A6.p5.3.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="A6.p5.3.m3.1b"><ci id="A6.p5.3.m3.1.1.cmml" xref="A6.p5.3.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.p5.3.m3.1c">N</annotation><annotation encoding="application/x-llamapun" id="A6.p5.3.m3.1d">italic_N</annotation></semantics></math> high-frequency tokens as prefixed tokens significantly outperforms using only the highest-frequency or randomly selected tokens.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="A6.T16">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 16: </span>Weight-only quantization results. “g” indicates group size for weight quantization. EfficientQAT only execute Block-AP and without E2E-QP for the fair comparisons in block-wise reconstruction scenario. We providing WikiText2 perplexity with 2048 context length and detailed zero-shot accuracy of weight-only quantization by <span class="ltx_text ltx_font_typewriter" id="A6.T16.4.1">lm_eval v0.4.2</span>. We report <span class="ltx_text ltx_font_typewriter" id="A6.T16.5.2">acc</span> for WinoGrande and <span class="ltx_text ltx_font_typewriter" id="A6.T16.6.3">acc_norm</span> for HellaSwag, ArcC, ArcE, and PIQA.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A6.T16.7">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A6.T16.7.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A6.T16.7.1.1.1" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_font_bold" id="A6.T16.7.1.1.1.1">Model</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A6.T16.7.1.1.2" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_font_bold" id="A6.T16.7.1.1.2.1">Method</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="A6.T16.7.1.1.3" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_font_bold" id="A6.T16.7.1.1.3.1">Precision</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A6.T16.7.1.1.4" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_font_bold" id="A6.T16.7.1.1.4.1">Wiki PPL</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A6.T16.7.1.1.5" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_font_bold" id="A6.T16.7.1.1.5.1">WinoGrande</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A6.T16.7.1.1.6" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_font_bold" id="A6.T16.7.1.1.6.1">HellaSwag</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A6.T16.7.1.1.7" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_font_bold" id="A6.T16.7.1.1.7.1">ArcC</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A6.T16.7.1.1.8" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_font_bold" id="A6.T16.7.1.1.8.1">ArcE</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A6.T16.7.1.1.9" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_font_bold" id="A6.T16.7.1.1.9.1">PiQA</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A6.T16.7.1.1.10" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_font_bold" id="A6.T16.7.1.1.10.1">Avg. Acc.</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A6.T16.7.2.1">
<td class="ltx_td ltx_align_left ltx_border_t" id="A6.T16.7.2.1.1" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A6.T16.7.2.1.1.1">3-8B</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T16.7.2.1.2" style="padding-left:2.0pt;padding-right:2.0pt;">Baseline</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A6.T16.7.2.1.3" style="padding-left:2.0pt;padding-right:2.0pt;">FP16</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T16.7.2.1.4" style="padding-left:2.0pt;padding-right:2.0pt;">6.14</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T16.7.2.1.5" style="padding-left:2.0pt;padding-right:2.0pt;">72.61</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T16.7.2.1.6" style="padding-left:2.0pt;padding-right:2.0pt;">79.17</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T16.7.2.1.7" style="padding-left:2.0pt;padding-right:2.0pt;">53.41</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T16.7.2.1.8" style="padding-left:2.0pt;padding-right:2.0pt;">77.69</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T16.7.2.1.9" style="padding-left:2.0pt;padding-right:2.0pt;">80.69</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T16.7.2.1.10" style="padding-left:2.0pt;padding-right:2.0pt;">72.71</td>
</tr>
<tr class="ltx_tr" id="A6.T16.7.3.2">
<td class="ltx_td ltx_align_left" id="A6.T16.7.3.2.1" style="padding-left:2.0pt;padding-right:2.0pt;">
<span class="ltx_ERROR undefined" id="A6.T16.7.3.2.1.1">\cdashline</span>2-10</td>
<td class="ltx_td ltx_align_center" id="A6.T16.7.3.2.2" style="padding-left:2.0pt;padding-right:2.0pt;">EfficientQAT</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A6.T16.7.3.2.3" style="padding-left:2.0pt;padding-right:2.0pt;">W3A16g128</td>
<td class="ltx_td ltx_align_center" id="A6.T16.7.3.2.4" style="padding-left:2.0pt;padding-right:2.0pt;">7.34</td>
<td class="ltx_td ltx_align_center" id="A6.T16.7.3.2.5" style="padding-left:2.0pt;padding-right:2.0pt;">70.48</td>
<td class="ltx_td ltx_align_center" id="A6.T16.7.3.2.6" style="padding-left:2.0pt;padding-right:2.0pt;">75.09</td>
<td class="ltx_td ltx_align_center" id="A6.T16.7.3.2.7" style="padding-left:2.0pt;padding-right:2.0pt;">51.37</td>
<td class="ltx_td ltx_align_center" id="A6.T16.7.3.2.8" style="padding-left:2.0pt;padding-right:2.0pt;">77.9</td>
<td class="ltx_td ltx_align_center" id="A6.T16.7.3.2.9" style="padding-left:2.0pt;padding-right:2.0pt;">79.16</td>
<td class="ltx_td ltx_align_center" id="A6.T16.7.3.2.10" style="padding-left:2.0pt;padding-right:2.0pt;">70.80</td>
</tr>
<tr class="ltx_tr" id="A6.T16.7.4.3">
<td class="ltx_td" id="A6.T16.7.4.3.1" style="padding-left:2.0pt;padding-right:2.0pt;"></td>
<td class="ltx_td ltx_align_center" id="A6.T16.7.4.3.2" style="background-color:#D3EFF1;padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A6.T16.7.4.3.2.1" style="background-color:#D3EFF1;">PrefixQuant</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A6.T16.7.4.3.3" style="background-color:#D3EFF1;padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A6.T16.7.4.3.3.1" style="background-color:#D3EFF1;">W3A16g128</span></td>
<td class="ltx_td ltx_align_center" id="A6.T16.7.4.3.4" style="background-color:#D3EFF1;padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A6.T16.7.4.3.4.1" style="background-color:#D3EFF1;">7.17</span></td>
<td class="ltx_td ltx_align_center" id="A6.T16.7.4.3.5" style="background-color:#D3EFF1;padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A6.T16.7.4.3.5.1" style="background-color:#D3EFF1;">72.38</span></td>
<td class="ltx_td ltx_align_center" id="A6.T16.7.4.3.6" style="background-color:#D3EFF1;padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A6.T16.7.4.3.6.1" style="background-color:#D3EFF1;">76.54</span></td>
<td class="ltx_td ltx_align_center" id="A6.T16.7.4.3.7" style="background-color:#D3EFF1;padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A6.T16.7.4.3.7.1" style="background-color:#D3EFF1;">52.65</span></td>
<td class="ltx_td ltx_align_center" id="A6.T16.7.4.3.8" style="background-color:#D3EFF1;padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A6.T16.7.4.3.8.1" style="background-color:#D3EFF1;">78.37</span></td>
<td class="ltx_td ltx_align_center" id="A6.T16.7.4.3.9" style="background-color:#D3EFF1;padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A6.T16.7.4.3.9.1" style="background-color:#D3EFF1;">80.58</span></td>
<td class="ltx_td ltx_align_center" id="A6.T16.7.4.3.10" style="background-color:#D3EFF1;padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A6.T16.7.4.3.10.1" style="background-color:#D3EFF1;">72.10</span></td>
</tr>
<tr class="ltx_tr" id="A6.T16.7.5.4">
<td class="ltx_td ltx_align_left" id="A6.T16.7.5.4.1" style="padding-left:2.0pt;padding-right:2.0pt;">
<span class="ltx_ERROR undefined" id="A6.T16.7.5.4.1.1">\cdashline</span>2-10</td>
<td class="ltx_td ltx_align_center" id="A6.T16.7.5.4.2" style="padding-left:2.0pt;padding-right:2.0pt;">EfficientQAT</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A6.T16.7.5.4.3" style="padding-left:2.0pt;padding-right:2.0pt;">W2A16g128</td>
<td class="ltx_td ltx_align_center" id="A6.T16.7.5.4.4" style="padding-left:2.0pt;padding-right:2.0pt;">13.55</td>
<td class="ltx_td ltx_align_center" id="A6.T16.7.5.4.5" style="padding-left:2.0pt;padding-right:2.0pt;">62.04</td>
<td class="ltx_td ltx_align_center" id="A6.T16.7.5.4.6" style="padding-left:2.0pt;padding-right:2.0pt;">62.49</td>
<td class="ltx_td ltx_align_center" id="A6.T16.7.5.4.7" style="padding-left:2.0pt;padding-right:2.0pt;">36.6</td>
<td class="ltx_td ltx_align_center" id="A6.T16.7.5.4.8" style="padding-left:2.0pt;padding-right:2.0pt;">60.44</td>
<td class="ltx_td ltx_align_center" id="A6.T16.7.5.4.9" style="padding-left:2.0pt;padding-right:2.0pt;">73.18</td>
<td class="ltx_td ltx_align_center" id="A6.T16.7.5.4.10" style="padding-left:2.0pt;padding-right:2.0pt;">58.95</td>
</tr>
<tr class="ltx_tr" id="A6.T16.7.6.5">
<td class="ltx_td" id="A6.T16.7.6.5.1" style="padding-left:2.0pt;padding-right:2.0pt;"></td>
<td class="ltx_td ltx_align_center" id="A6.T16.7.6.5.2" style="background-color:#D3EFF1;padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A6.T16.7.6.5.2.1" style="background-color:#D3EFF1;">PrefixQuant</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A6.T16.7.6.5.3" style="background-color:#D3EFF1;padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A6.T16.7.6.5.3.1" style="background-color:#D3EFF1;">W2A16g128</span></td>
<td class="ltx_td ltx_align_center" id="A6.T16.7.6.5.4" style="background-color:#D3EFF1;padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A6.T16.7.6.5.4.1" style="background-color:#D3EFF1;">11.97</span></td>
<td class="ltx_td ltx_align_center" id="A6.T16.7.6.5.5" style="background-color:#D3EFF1;padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A6.T16.7.6.5.5.1" style="background-color:#D3EFF1;">66.22</span></td>
<td class="ltx_td ltx_align_center" id="A6.T16.7.6.5.6" style="background-color:#D3EFF1;padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A6.T16.7.6.5.6.1" style="background-color:#D3EFF1;">66.54</span></td>
<td class="ltx_td ltx_align_center" id="A6.T16.7.6.5.7" style="background-color:#D3EFF1;padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A6.T16.7.6.5.7.1" style="background-color:#D3EFF1;">41.81</span></td>
<td class="ltx_td ltx_align_center" id="A6.T16.7.6.5.8" style="background-color:#D3EFF1;padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A6.T16.7.6.5.8.1" style="background-color:#D3EFF1;">69.61</span></td>
<td class="ltx_td ltx_align_center" id="A6.T16.7.6.5.9" style="background-color:#D3EFF1;padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A6.T16.7.6.5.9.1" style="background-color:#D3EFF1;">75.84</span></td>
<td class="ltx_td ltx_align_center" id="A6.T16.7.6.5.10" style="background-color:#D3EFF1;padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A6.T16.7.6.5.10.1" style="background-color:#D3EFF1;">64.00</span></td>
</tr>
<tr class="ltx_tr" id="A6.T16.7.7.6">
<td class="ltx_td ltx_align_left ltx_border_t" id="A6.T16.7.7.6.1" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A6.T16.7.7.6.1.1">3-70B</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T16.7.7.6.2" style="padding-left:2.0pt;padding-right:2.0pt;">Baseline</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A6.T16.7.7.6.3" style="padding-left:2.0pt;padding-right:2.0pt;">FP16</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T16.7.7.6.4" style="padding-left:2.0pt;padding-right:2.0pt;">2.85</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T16.7.7.6.5" style="padding-left:2.0pt;padding-right:2.0pt;">80.51</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T16.7.7.6.6" style="padding-left:2.0pt;padding-right:2.0pt;">84.9</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T16.7.7.6.7" style="padding-left:2.0pt;padding-right:2.0pt;">64.33</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T16.7.7.6.8" style="padding-left:2.0pt;padding-right:2.0pt;">85.9</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T16.7.7.6.9" style="padding-left:2.0pt;padding-right:2.0pt;">84.49</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T16.7.7.6.10" style="padding-left:2.0pt;padding-right:2.0pt;">80.03</td>
</tr>
<tr class="ltx_tr" id="A6.T16.7.8.7">
<td class="ltx_td ltx_align_left" id="A6.T16.7.8.7.1" style="padding-left:2.0pt;padding-right:2.0pt;">
<span class="ltx_ERROR undefined" id="A6.T16.7.8.7.1.1">\cdashline</span>2-10</td>
<td class="ltx_td ltx_align_center" id="A6.T16.7.8.7.2" style="padding-left:2.0pt;padding-right:2.0pt;">EfficientQAT</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A6.T16.7.8.7.3" style="padding-left:2.0pt;padding-right:2.0pt;">W3A16g128</td>
<td class="ltx_td ltx_align_center" id="A6.T16.7.8.7.4" style="padding-left:2.0pt;padding-right:2.0pt;">4.89</td>
<td class="ltx_td ltx_align_center" id="A6.T16.7.8.7.5" style="padding-left:2.0pt;padding-right:2.0pt;">78.77</td>
<td class="ltx_td ltx_align_center" id="A6.T16.7.8.7.6" style="padding-left:2.0pt;padding-right:2.0pt;">83.74</td>
<td class="ltx_td ltx_align_center" id="A6.T16.7.8.7.7" style="padding-left:2.0pt;padding-right:2.0pt;">55.03</td>
<td class="ltx_td ltx_align_center" id="A6.T16.7.8.7.8" style="padding-left:2.0pt;padding-right:2.0pt;">78.66</td>
<td class="ltx_td ltx_align_center" id="A6.T16.7.8.7.9" style="padding-left:2.0pt;padding-right:2.0pt;">82.05</td>
<td class="ltx_td ltx_align_center" id="A6.T16.7.8.7.10" style="padding-left:2.0pt;padding-right:2.0pt;">75.65</td>
</tr>
<tr class="ltx_tr" id="A6.T16.7.9.8">
<td class="ltx_td" id="A6.T16.7.9.8.1" style="padding-left:2.0pt;padding-right:2.0pt;"></td>
<td class="ltx_td ltx_align_center" id="A6.T16.7.9.8.2" style="background-color:#D3EFF1;padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A6.T16.7.9.8.2.1" style="background-color:#D3EFF1;">PrefixQuant</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A6.T16.7.9.8.3" style="background-color:#D3EFF1;padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A6.T16.7.9.8.3.1" style="background-color:#D3EFF1;">W3A16g128</span></td>
<td class="ltx_td ltx_align_center" id="A6.T16.7.9.8.4" style="background-color:#D3EFF1;padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A6.T16.7.9.8.4.1" style="background-color:#D3EFF1;">4.79</span></td>
<td class="ltx_td ltx_align_center" id="A6.T16.7.9.8.5" style="background-color:#D3EFF1;padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A6.T16.7.9.8.5.1" style="background-color:#D3EFF1;">78.22</span></td>
<td class="ltx_td ltx_align_center" id="A6.T16.7.9.8.6" style="background-color:#D3EFF1;padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A6.T16.7.9.8.6.1" style="background-color:#D3EFF1;">84.03</span></td>
<td class="ltx_td ltx_align_center" id="A6.T16.7.9.8.7" style="background-color:#D3EFF1;padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A6.T16.7.9.8.7.1" style="background-color:#D3EFF1;">60.15</span></td>
<td class="ltx_td ltx_align_center" id="A6.T16.7.9.8.8" style="background-color:#D3EFF1;padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A6.T16.7.9.8.8.1" style="background-color:#D3EFF1;">83.00</span></td>
<td class="ltx_td ltx_align_center" id="A6.T16.7.9.8.9" style="background-color:#D3EFF1;padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A6.T16.7.9.8.9.1" style="background-color:#D3EFF1;">83.35</span></td>
<td class="ltx_td ltx_align_center" id="A6.T16.7.9.8.10" style="background-color:#D3EFF1;padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A6.T16.7.9.8.10.1" style="background-color:#D3EFF1;">77.75</span></td>
</tr>
<tr class="ltx_tr" id="A6.T16.7.10.9">
<td class="ltx_td ltx_align_left" id="A6.T16.7.10.9.1" style="padding-left:2.0pt;padding-right:2.0pt;">
<span class="ltx_ERROR undefined" id="A6.T16.7.10.9.1.1">\cdashline</span>2-10</td>
<td class="ltx_td ltx_align_center" id="A6.T16.7.10.9.2" style="padding-left:2.0pt;padding-right:2.0pt;">EfficientQAT</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A6.T16.7.10.9.3" style="padding-left:2.0pt;padding-right:2.0pt;">W2A16g128</td>
<td class="ltx_td ltx_align_center" id="A6.T16.7.10.9.4" style="padding-left:2.0pt;padding-right:2.0pt;">16.79</td>
<td class="ltx_td ltx_align_center" id="A6.T16.7.10.9.5" style="padding-left:2.0pt;padding-right:2.0pt;">66.14</td>
<td class="ltx_td ltx_align_center" id="A6.T16.7.10.9.6" style="padding-left:2.0pt;padding-right:2.0pt;">73.01</td>
<td class="ltx_td ltx_align_center" id="A6.T16.7.10.9.7" style="padding-left:2.0pt;padding-right:2.0pt;">48.21</td>
<td class="ltx_td ltx_align_center" id="A6.T16.7.10.9.8" style="padding-left:2.0pt;padding-right:2.0pt;">73.57</td>
<td class="ltx_td ltx_align_center" id="A6.T16.7.10.9.9" style="padding-left:2.0pt;padding-right:2.0pt;">78.45</td>
<td class="ltx_td ltx_align_center" id="A6.T16.7.10.9.10" style="padding-left:2.0pt;padding-right:2.0pt;">67.88</td>
</tr>
<tr class="ltx_tr" id="A6.T16.7.11.10">
<td class="ltx_td ltx_border_bb" id="A6.T16.7.11.10.1" style="padding-left:2.0pt;padding-right:2.0pt;"></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T16.7.11.10.2" style="background-color:#D3EFF1;padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A6.T16.7.11.10.2.1" style="background-color:#D3EFF1;">PrefixQuant</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="A6.T16.7.11.10.3" style="background-color:#D3EFF1;padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A6.T16.7.11.10.3.1" style="background-color:#D3EFF1;">W2A16g128</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T16.7.11.10.4" style="background-color:#D3EFF1;padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A6.T16.7.11.10.4.1" style="background-color:#D3EFF1;">11.01</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T16.7.11.10.5" style="background-color:#D3EFF1;padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A6.T16.7.11.10.5.1" style="background-color:#D3EFF1;">72.3</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T16.7.11.10.6" style="background-color:#D3EFF1;padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A6.T16.7.11.10.6.1" style="background-color:#D3EFF1;">78.55</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T16.7.11.10.7" style="background-color:#D3EFF1;padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A6.T16.7.11.10.7.1" style="background-color:#D3EFF1;">53.67</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T16.7.11.10.8" style="background-color:#D3EFF1;padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A6.T16.7.11.10.8.1" style="background-color:#D3EFF1;">77.9</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T16.7.11.10.9" style="background-color:#D3EFF1;padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A6.T16.7.11.10.9.1" style="background-color:#D3EFF1;">80.63</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T16.7.11.10.10" style="background-color:#D3EFF1;padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A6.T16.7.11.10.10.1" style="background-color:#D3EFF1;">72.61</span></td>
</tr>
</tbody>
</table>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
<section class="ltx_appendix" id="A7">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix G </span>Extend to Weight-only Quantization</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A7.p1">
<p class="ltx_p" id="A7.p1.2">In addition to static activation quantization, setting prefixed outliers in the KV-cache improves training stability&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Chen et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib8" title="">2024b</a>)</cite> and reduces information loss from outlier tokens, can also enhancing weight-only quantization performance. To verify this, we compare PrefixQuant with the recent state-of-the-art weight-only quantization method, EfficientQAT&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Chen et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib7" title="">2024a</a>)</cite>, in a block-wise fine-tuning scenario. Following EfficientQAT, we use 4096 RedPajama&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Computer, <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib10" title="">2023</a>)</cite> with a 2048 context length to train for 2 epochs. The learning rates for quantization parameters and full-precision weights are set to 5e-5 and 5e-6, except for W2A16g128 Llama-3-8B, where they are 1e-4 and 2e-5, respectively. As shown in Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A6.T16" title="Table 16 ‣ Appendix F More Ablation Results ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">16</span></a>, PrefixQuant significantly surpasses EfficientQAT with <math alttext="+5.05" class="ltx_Math" display="inline" id="A7.p1.1.m1.1"><semantics id="A7.p1.1.m1.1a"><mrow id="A7.p1.1.m1.1.1" xref="A7.p1.1.m1.1.1.cmml"><mo id="A7.p1.1.m1.1.1a" xref="A7.p1.1.m1.1.1.cmml">+</mo><mn id="A7.p1.1.m1.1.1.2" xref="A7.p1.1.m1.1.1.2.cmml">5.05</mn></mrow><annotation-xml encoding="MathML-Content" id="A7.p1.1.m1.1b"><apply id="A7.p1.1.m1.1.1.cmml" xref="A7.p1.1.m1.1.1"><plus id="A7.p1.1.m1.1.1.1.cmml" xref="A7.p1.1.m1.1.1"></plus><cn id="A7.p1.1.m1.1.1.2.cmml" type="float" xref="A7.p1.1.m1.1.1.2">5.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p1.1.m1.1c">+5.05</annotation><annotation encoding="application/x-llamapun" id="A7.p1.1.m1.1d">+ 5.05</annotation></semantics></math> and <math alttext="+4.73" class="ltx_Math" display="inline" id="A7.p1.2.m2.1"><semantics id="A7.p1.2.m2.1a"><mrow id="A7.p1.2.m2.1.1" xref="A7.p1.2.m2.1.1.cmml"><mo id="A7.p1.2.m2.1.1a" xref="A7.p1.2.m2.1.1.cmml">+</mo><mn id="A7.p1.2.m2.1.1.2" xref="A7.p1.2.m2.1.1.2.cmml">4.73</mn></mrow><annotation-xml encoding="MathML-Content" id="A7.p1.2.m2.1b"><apply id="A7.p1.2.m2.1.1.cmml" xref="A7.p1.2.m2.1.1"><plus id="A7.p1.2.m2.1.1.1.cmml" xref="A7.p1.2.m2.1.1"></plus><cn id="A7.p1.2.m2.1.1.2.cmml" type="float" xref="A7.p1.2.m2.1.1.2">4.73</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p1.2.m2.1c">+4.73</annotation><annotation encoding="application/x-llamapun" id="A7.p1.2.m2.1d">+ 4.73</annotation></semantics></math> points in average accuracy on W2A16g128 Llama-3-8B and Llama-3-70B, respectively.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_appendix" id="A8">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix H </span>Full Results of Weight-Activation quantization</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_table" id="A8.T17">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 17: </span>W8A8 performance comparisons with other methods that also set prefixed tokens in KV cache.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A8.T17.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A8.T17.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A8.T17.1.1.1.1">Model</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A8.T17.1.1.1.2">Method</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A8.T17.1.1.1.3">Activation Quant</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A8.T17.1.1.1.4">Wiki PPL</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A8.T17.1.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="A8.T17.1.2.1.1" rowspan="3"><span class="ltx_text" id="A8.T17.1.2.1.1.1">2-7B</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A8.T17.1.2.1.2">QFeP</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A8.T17.1.2.1.3">per-tensor dynamic</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A8.T17.1.2.1.4">5.75</td>
</tr>
<tr class="ltx_tr" id="A8.T17.1.3.2">
<td class="ltx_td ltx_align_center" id="A8.T17.1.3.2.1">CushionCache</td>
<td class="ltx_td ltx_align_center" id="A8.T17.1.3.2.2">per-tensor static</td>
<td class="ltx_td ltx_align_center" id="A8.T17.1.3.2.3">5.87</td>
</tr>
<tr class="ltx_tr" id="A8.T17.1.4.3">
<td class="ltx_td ltx_align_center" id="A8.T17.1.4.3.1" style="background-color:#D3EFF1;"><span class="ltx_text" id="A8.T17.1.4.3.1.1" style="background-color:#D3EFF1;">PrefixQuant</span></td>
<td class="ltx_td ltx_align_center" id="A8.T17.1.4.3.2" style="background-color:#D3EFF1;"><span class="ltx_text" id="A8.T17.1.4.3.2.1" style="background-color:#D3EFF1;">per-tensor static</span></td>
<td class="ltx_td ltx_align_center" id="A8.T17.1.4.3.3" style="background-color:#D3EFF1;"><span class="ltx_text ltx_font_bold" id="A8.T17.1.4.3.3.1" style="background-color:#D3EFF1;">5.48</span></td>
</tr>
<tr class="ltx_tr" id="A8.T17.1.5.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A8.T17.1.5.4.1" rowspan="2">
<span class="ltx_ERROR undefined" id="A8.T17.1.5.4.1.1">\cdashline</span>1-4
<span class="ltx_text" id="A8.T17.1.5.4.1.2">2-13B</span>
</th>
<td class="ltx_td ltx_align_center" id="A8.T17.1.5.4.2">QFeP</td>
<td class="ltx_td ltx_align_center" id="A8.T17.1.5.4.3">per-tensor dynamic</td>
<td class="ltx_td ltx_align_center" id="A8.T17.1.5.4.4">6.00</td>
</tr>
<tr class="ltx_tr" id="A8.T17.1.6.5">
<td class="ltx_td ltx_align_center" id="A8.T17.1.6.5.1" style="background-color:#D3EFF1;"><span class="ltx_text" id="A8.T17.1.6.5.1.1" style="background-color:#D3EFF1;">PrefixQuant</span></td>
<td class="ltx_td ltx_align_center" id="A8.T17.1.6.5.2" style="background-color:#D3EFF1;"><span class="ltx_text" id="A8.T17.1.6.5.2.1" style="background-color:#D3EFF1;">per-tensor static</span></td>
<td class="ltx_td ltx_align_center" id="A8.T17.1.6.5.3" style="background-color:#D3EFF1;"><span class="ltx_text ltx_font_bold" id="A8.T17.1.6.5.3.1" style="background-color:#D3EFF1;">4.89</span></td>
</tr>
<tr class="ltx_tr" id="A8.T17.1.7.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A8.T17.1.7.6.1" rowspan="2">
<span class="ltx_ERROR undefined" id="A8.T17.1.7.6.1.1">\cdashline</span>1-4
<span class="ltx_text" id="A8.T17.1.7.6.1.2">2-70B</span>
</th>
<td class="ltx_td ltx_align_center" id="A8.T17.1.7.6.2">QFeP</td>
<td class="ltx_td ltx_align_center" id="A8.T17.1.7.6.3">per-tensor dynamic</td>
<td class="ltx_td ltx_align_center" id="A8.T17.1.7.6.4">6.01</td>
</tr>
<tr class="ltx_tr" id="A8.T17.1.8.7">
<td class="ltx_td ltx_align_center" id="A8.T17.1.8.7.1" style="background-color:#D3EFF1;"><span class="ltx_text" id="A8.T17.1.8.7.1.1" style="background-color:#D3EFF1;">PrefixQuant</span></td>
<td class="ltx_td ltx_align_center" id="A8.T17.1.8.7.2" style="background-color:#D3EFF1;"><span class="ltx_text" id="A8.T17.1.8.7.2.1" style="background-color:#D3EFF1;">per-tensor static</span></td>
<td class="ltx_td ltx_align_center" id="A8.T17.1.8.7.3" style="background-color:#D3EFF1;"><span class="ltx_text ltx_font_bold" id="A8.T17.1.8.7.3.1" style="background-color:#D3EFF1;">3.39</span></td>
</tr>
<tr class="ltx_tr" id="A8.T17.1.9.8">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="A8.T17.1.9.8.1" rowspan="2">
<span class="ltx_ERROR undefined" id="A8.T17.1.9.8.1.1">\cdashline</span>1-4
<span class="ltx_text" id="A8.T17.1.9.8.1.2">3-8B</span>
</th>
<td class="ltx_td ltx_align_center" id="A8.T17.1.9.8.2">CushionCache</td>
<td class="ltx_td ltx_align_center" id="A8.T17.1.9.8.3">per-tensor static</td>
<td class="ltx_td ltx_align_center" id="A8.T17.1.9.8.4">7.37</td>
</tr>
<tr class="ltx_tr" id="A8.T17.1.10.9">
<td class="ltx_td ltx_align_center ltx_border_bb" id="A8.T17.1.10.9.1" style="background-color:#D3EFF1;"><span class="ltx_text" id="A8.T17.1.10.9.1.1" style="background-color:#D3EFF1;">PrefixQuant</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A8.T17.1.10.9.2" style="background-color:#D3EFF1;"><span class="ltx_text" id="A8.T17.1.10.9.2.1" style="background-color:#D3EFF1;">per-tensor static</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A8.T17.1.10.9.3" style="background-color:#D3EFF1;"><span class="ltx_text ltx_font_bold" id="A8.T17.1.10.9.3.1" style="background-color:#D3EFF1;">6.17</span></td>
</tr>
</tbody>
</table>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsection" id="A8.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">H.1 </span>Comparisons with Related Works</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A8.SS1.p1">
<p class="ltx_p" id="A8.SS1.p1.1">CushionCache&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Son et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib30" title="">2024</a>)</cite> and QFeP&nbsp;<cite class="ltx_cite ltx_citemacro_citep">(Yang et&nbsp;al., <a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#bib.bib40" title="">2024</a>)</cite> also set prefixed tokens in the KV cache to reduce outliers. However, they experience significant performance degradation even with W8A8 quantization. Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A8.T17" title="Table 17 ‣ Appendix H Full Results of Weight-Activation quantization ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">17</span></a> shows that PrefixQuant outperforms QFeP by 2.62 perplexity on Llama-2-70B and surpasses CushionCache by 1.20 perplexity on Llama-3-8B.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="A8.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">H.2 </span>Detailed Accuracy Results</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A8.SS2.p1">
<p class="ltx_p" id="A8.SS2.p1.1">In the main paper, we present the average accuracy of five common reasoning tasks for brevity. Here, we provide detailed results for each task in Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A8.T18" title="Table 18 ‣ H.3 Results on More Models ‣ Appendix H Full Results of Weight-Activation quantization ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">18</span></a>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="A8.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">H.3 </span>Results on More Models</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A8.SS3.p1">
<p class="ltx_p" id="A8.SS3.p1.1">Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A8.T19" title="Table 19 ‣ H.3 Results on More Models ‣ Appendix H Full Results of Weight-Activation quantization ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">19</span></a> shows the effectiveness of the proposed PrefixQuant in other models, including Mistral-v0.3-7B and Qwen-2-7B. It also includes instruction-tuned models such as Llama-3-{8B,70B}-Instruct.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_table" id="A8.T18">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 18: </span>Continuation of Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#S5.T3" title="Table 3 ‣ 5.2 Block-wise Fine-tuning ‣ 5 PrefixQuant ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">3</span></a> and Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#S6.T4" title="Table 4 ‣ 6.2 Comparison Results ‣ 6 Experiments ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">4</span></a>, providing detailed zero-shot accuracy of weight-activation quantization of Llama models by <span class="ltx_text ltx_font_typewriter" id="A8.T18.4.1">lm_eval v0.4.2</span>. We report <span class="ltx_text ltx_font_typewriter" id="A8.T18.5.2">acc</span> for WinoGrande and <span class="ltx_text ltx_font_typewriter" id="A8.T18.6.3">acc_norm</span> for HellaSwag, ArcC, ArcE, and PIQA.).</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="A8.T18.7">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A8.T18.7.1.1">
<td class="ltx_td ltx_align_left ltx_border_tt" id="A8.T18.7.1.1.1" style="padding:-2.5pt 2.4pt;"><span class="ltx_text ltx_font_bold" id="A8.T18.7.1.1.1.1">Model</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A8.T18.7.1.1.2" style="padding:-2.5pt 2.4pt;"><span class="ltx_text ltx_font_bold" id="A8.T18.7.1.1.2.1">Method</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="A8.T18.7.1.1.3" style="padding:-2.5pt 2.4pt;"><span class="ltx_text ltx_font_bold" id="A8.T18.7.1.1.3.1">Precision</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A8.T18.7.1.1.4" style="padding:-2.5pt 2.4pt;"><span class="ltx_text ltx_font_bold" id="A8.T18.7.1.1.4.1">WinoGrande</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A8.T18.7.1.1.5" style="padding:-2.5pt 2.4pt;"><span class="ltx_text ltx_font_bold" id="A8.T18.7.1.1.5.1">HellaSwag</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A8.T18.7.1.1.6" style="padding:-2.5pt 2.4pt;"><span class="ltx_text ltx_font_bold" id="A8.T18.7.1.1.6.1">ArcC</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A8.T18.7.1.1.7" style="padding:-2.5pt 2.4pt;"><span class="ltx_text ltx_font_bold" id="A8.T18.7.1.1.7.1">ArcE</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A8.T18.7.1.1.8" style="padding:-2.5pt 2.4pt;"><span class="ltx_text ltx_font_bold" id="A8.T18.7.1.1.8.1">PiQA</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A8.T18.7.1.1.9" style="padding:-2.5pt 2.4pt;"><span class="ltx_text ltx_font_bold" id="A8.T18.7.1.1.9.1">Avg. Acc.</span></td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.2.2">
<td class="ltx_td ltx_align_left ltx_border_t" id="A8.T18.7.2.2.1" style="padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.2.2.1.1">2-7B</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A8.T18.7.2.2.2" style="padding:-2.5pt 2.4pt;">Baseline</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A8.T18.7.2.2.3" style="padding:-2.5pt 2.4pt;">FP16</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A8.T18.7.2.2.4" style="padding:-2.5pt 2.4pt;">69.22</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A8.T18.7.2.2.5" style="padding:-2.5pt 2.4pt;">76.00</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A8.T18.7.2.2.6" style="padding:-2.5pt 2.4pt;">46.25</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A8.T18.7.2.2.7" style="padding:-2.5pt 2.4pt;">74.62</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A8.T18.7.2.2.8" style="padding:-2.5pt 2.4pt;">79.11</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A8.T18.7.2.2.9" style="padding:-2.5pt 2.4pt;">69.04</td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.3.3">
<td class="ltx_td ltx_align_left" id="A8.T18.7.3.3.1" style="padding:-2.5pt 2.4pt;">
<span class="ltx_ERROR undefined" id="A8.T18.7.3.3.1.1">\cdashline</span>2-9</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.3.3.2" style="padding:-2.5pt 2.4pt;">Atom</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.3.3.3" style="padding:-2.5pt 2.4pt;">W4A4KV4</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.3.3.4" style="padding:-2.5pt 2.4pt;">62.75</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.3.3.5" style="padding:-2.5pt 2.4pt;">69.37</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.3.3.6" style="padding:-2.5pt 2.4pt;">38.40</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.3.3.7" style="padding:-2.5pt 2.4pt;">52.99</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.3.3.8" style="padding:-2.5pt 2.4pt;">75.14</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.3.3.9" style="padding:-2.5pt 2.4pt;">59.73</td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.4.4">
<td class="ltx_td" id="A8.T18.7.4.4.1" style="padding:-2.5pt 2.4pt;"></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.4.4.2" style="padding:-2.5pt 2.4pt;">QuaRot</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.4.4.3" style="padding:-2.5pt 2.4pt;">W4A4KV4</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.4.4.4" style="padding:-2.5pt 2.4pt;">64.40</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.4.4.5" style="padding:-2.5pt 2.4pt;">72.3</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.4.4.6" style="padding:-2.5pt 2.4pt;">41.47</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.4.4.7" style="padding:-2.5pt 2.4pt;">68.06</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.4.4.8" style="padding:-2.5pt 2.4pt;">76.17</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.4.4.9" style="padding:-2.5pt 2.4pt;">64.48</td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.5.5">
<td class="ltx_td" id="A8.T18.7.5.5.1" style="padding:-2.5pt 2.4pt;"></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.5.5.2" style="padding:-2.5pt 2.4pt;">DuQuant</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.5.5.3" style="padding:-2.5pt 2.4pt;">W4A4KV4</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.5.5.4" style="padding:-2.5pt 2.4pt;">67.09</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.5.5.5" style="padding:-2.5pt 2.4pt;">72.53</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.5.5.6" style="padding:-2.5pt 2.4pt;">43.26</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.5.5.7" style="padding:-2.5pt 2.4pt;">71.38</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.5.5.8" style="padding:-2.5pt 2.4pt;">76.99</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.5.5.9" style="padding:-2.5pt 2.4pt;">66.25</td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.6.6">
<td class="ltx_td" id="A8.T18.7.6.6.1" style="padding:-2.5pt 2.4pt;"></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.6.6.2" style="padding:-2.5pt 2.4pt;">SpinQuant</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.6.6.3" style="padding:-2.5pt 2.4pt;">W4A4KV4</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.6.6.4" style="padding:-2.5pt 2.4pt;">66.54</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.6.6.5" style="padding:-2.5pt 2.4pt;">73.15</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.6.6.6" style="padding:-2.5pt 2.4pt;">41.64</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.6.6.7" style="padding:-2.5pt 2.4pt;">69.32</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.6.6.8" style="padding:-2.5pt 2.4pt;">76.12</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.6.6.9" style="padding:-2.5pt 2.4pt;">65.35</td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.7.7">
<td class="ltx_td" id="A8.T18.7.7.7.1" style="padding:-2.5pt 2.4pt;"></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.7.7.2" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.7.7.2.1" style="background-color:#D3EFF1;">PrefixQuant w/o FT</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.7.7.3" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.7.7.3.1" style="background-color:#D3EFF1;">W4A4KV4</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.7.7.4" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.7.7.4.1" style="background-color:#D3EFF1;">67.80</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.7.7.5" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.7.7.5.1" style="background-color:#D3EFF1;">73.75</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.7.7.6" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.7.7.6.1" style="background-color:#D3EFF1;">43.94</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.7.7.7" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.7.7.7.1" style="background-color:#D3EFF1;">71.51</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.7.7.8" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.7.7.8.1" style="background-color:#D3EFF1;">77.2</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.7.7.9" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.7.7.9.1" style="background-color:#D3EFF1;">66.84</span></td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.8.8">
<td class="ltx_td" id="A8.T18.7.8.8.1" style="padding:-2.5pt 2.4pt;"></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.8.8.2" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.8.8.2.1" style="background-color:#D3EFF1;">PrefixQuant</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.8.8.3" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.8.8.3.1" style="background-color:#D3EFF1;">W4A4KV4</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.8.8.4" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.8.8.4.1" style="background-color:#D3EFF1;">66.54</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.8.8.5" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.8.8.5.1" style="background-color:#D3EFF1;">73.42</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.8.8.6" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.8.8.6.1" style="background-color:#D3EFF1;">43.09</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.8.8.7" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.8.8.7.1" style="background-color:#D3EFF1;">71.17</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.8.8.8" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.8.8.8.1" style="background-color:#D3EFF1;">77.64</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.8.8.9" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.8.8.9.1" style="background-color:#D3EFF1;">66.37</span></td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.9.9">
<td class="ltx_td ltx_align_left" id="A8.T18.7.9.9.1" style="padding:-2.5pt 2.4pt;">
<span class="ltx_ERROR undefined" id="A8.T18.7.9.9.1.1">\cdashline</span>2-9</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.9.9.2" style="padding:-2.5pt 2.4pt;">QoQ</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.9.9.3" style="padding:-2.5pt 2.4pt;">W4A8KV8</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.9.9.4" style="padding:-2.5pt 2.4pt;">68.03</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.9.9.5" style="padding:-2.5pt 2.4pt;">74.00</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.9.9.6" style="padding:-2.5pt 2.4pt;">43.60</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.9.9.7" style="padding:-2.5pt 2.4pt;">72.81</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.9.9.8" style="padding:-2.5pt 2.4pt;">77.64</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.9.9.9" style="padding:-2.5pt 2.4pt;">67.22</td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.10.10">
<td class="ltx_td" id="A8.T18.7.10.10.1" style="padding:-2.5pt 2.4pt;"></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.10.10.2" style="padding:-2.5pt 2.4pt;">QuaRot</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.10.10.3" style="padding:-2.5pt 2.4pt;">W4A8KV8</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.10.10.4" style="padding:-2.5pt 2.4pt;">66.77</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.10.10.5" style="padding:-2.5pt 2.4pt;">74.56</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.10.10.6" style="padding:-2.5pt 2.4pt;">43.86</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.10.10.7" style="padding:-2.5pt 2.4pt;">72.39</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.10.10.8" style="padding:-2.5pt 2.4pt;">77.97</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.10.10.9" style="padding:-2.5pt 2.4pt;">67.11</td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.11.11">
<td class="ltx_td" id="A8.T18.7.11.11.1" style="padding:-2.5pt 2.4pt;"></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.11.11.2" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.11.11.2.1" style="background-color:#D3EFF1;">PrefixQuant w/o FT</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.11.11.3" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.11.11.3.1" style="background-color:#D3EFF1;">W4A8KV8</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.11.11.4" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.11.11.4.1" style="background-color:#D3EFF1;">69.14</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.11.11.5" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.11.11.5.1" style="background-color:#D3EFF1;">75.12</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.11.11.6" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.11.11.6.1" style="background-color:#D3EFF1;">44.45</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.11.11.7" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.11.11.7.1" style="background-color:#D3EFF1;">73.06</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.11.11.8" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.11.11.8.1" style="background-color:#D3EFF1;">77.53</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.11.11.9" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.11.11.9.1" style="background-color:#D3EFF1;">67.86</span></td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.12.12">
<td class="ltx_td" id="A8.T18.7.12.12.1" style="padding:-2.5pt 2.4pt;"></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.12.12.2" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.12.12.2.1" style="background-color:#D3EFF1;">PrefixQuant</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.12.12.3" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.12.12.3.1" style="background-color:#D3EFF1;">W4A8KV8</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.12.12.4" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.12.12.4.1" style="background-color:#D3EFF1;">69.06</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.12.12.5" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.12.12.5.1" style="background-color:#D3EFF1;">75.25</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.12.12.6" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.12.12.6.1" style="background-color:#D3EFF1;">44.8</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.12.12.7" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.12.12.7.1" style="background-color:#D3EFF1;">73.19</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.12.12.8" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.12.12.8.1" style="background-color:#D3EFF1;">78.13</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.12.12.9" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.12.12.9.1" style="background-color:#D3EFF1;">68.09</span></td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.13.13">
<td class="ltx_td ltx_align_left" id="A8.T18.7.13.13.1" style="padding:-2.5pt 2.4pt;">
<span class="ltx_ERROR undefined" id="A8.T18.7.13.13.1.1">\cdashline</span>2-9</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.13.13.2" style="padding:-2.5pt 2.4pt;">SmoothQuant</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.13.13.3" style="padding:-2.5pt 2.4pt;">W8A8KV8</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.13.13.4" style="padding:-2.5pt 2.4pt;">69.22</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.13.13.5" style="padding:-2.5pt 2.4pt;">76.32</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.13.13.6" style="padding:-2.5pt 2.4pt;">45.56</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.13.13.7" style="padding:-2.5pt 2.4pt;">74.71</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.13.13.8" style="padding:-2.5pt 2.4pt;">78.78</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.13.13.9" style="padding:-2.5pt 2.4pt;">68.92</td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.14.14">
<td class="ltx_td" id="A8.T18.7.14.14.1" style="padding:-2.5pt 2.4pt;"></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.14.14.2" style="padding:-2.5pt 2.4pt;">QuaRot</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.14.14.3" style="padding:-2.5pt 2.4pt;">W8A8KV8</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.14.14.4" style="padding:-2.5pt 2.4pt;">68.98</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.14.14.5" style="padding:-2.5pt 2.4pt;">75.96</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.14.14.6" style="padding:-2.5pt 2.4pt;">46.59</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.14.14.7" style="padding:-2.5pt 2.4pt;">74.41</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.14.14.8" style="padding:-2.5pt 2.4pt;">79.11</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.14.14.9" style="padding:-2.5pt 2.4pt;">69.01</td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.15.15">
<td class="ltx_td" id="A8.T18.7.15.15.1" style="padding:-2.5pt 2.4pt;"></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.15.15.2" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.15.15.2.1" style="background-color:#D3EFF1;">PrefixQuant w/o FT</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.15.15.3" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.15.15.3.1" style="background-color:#D3EFF1;">W8A8KV8</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.15.15.4" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.15.15.4.1" style="background-color:#D3EFF1;">70.48</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.15.15.5" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.15.15.5.1" style="background-color:#D3EFF1;">76.62</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.15.15.6" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.15.15.6.1" style="background-color:#D3EFF1;">45.65</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.15.15.7" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.15.15.7.1" style="background-color:#D3EFF1;">73.91</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.15.15.8" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.15.15.8.1" style="background-color:#D3EFF1;">78.18</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.15.15.9" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.15.15.9.1" style="background-color:#D3EFF1;">68.97</span></td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.16.16">
<td class="ltx_td ltx_align_left ltx_border_t" id="A8.T18.7.16.16.1" style="padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.16.16.1.1">2-13B</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A8.T18.7.16.16.2" style="padding:-2.5pt 2.4pt;">Baseline</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A8.T18.7.16.16.3" style="padding:-2.5pt 2.4pt;">FP16</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A8.T18.7.16.16.4" style="padding:-2.5pt 2.4pt;">72.22</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A8.T18.7.16.16.5" style="padding:-2.5pt 2.4pt;">79.37</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A8.T18.7.16.16.6" style="padding:-2.5pt 2.4pt;">49.06</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A8.T18.7.16.16.7" style="padding:-2.5pt 2.4pt;">77.48</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A8.T18.7.16.16.8" style="padding:-2.5pt 2.4pt;">80.52</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A8.T18.7.16.16.9" style="padding:-2.5pt 2.4pt;">71.73</td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.17.17">
<td class="ltx_td ltx_align_left" id="A8.T18.7.17.17.1" style="padding:-2.5pt 2.4pt;">
<span class="ltx_ERROR undefined" id="A8.T18.7.17.17.1.1">\cdashline</span>2-9</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.17.17.2" style="padding:-2.5pt 2.4pt;">Atom</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.17.17.3" style="padding:-2.5pt 2.4pt;">W4A4KV4</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.17.17.4" style="padding:-2.5pt 2.4pt;">67.40</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.17.17.5" style="padding:-2.5pt 2.4pt;">73.84</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.17.17.6" style="padding:-2.5pt 2.4pt;">42.32</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.17.17.7" style="padding:-2.5pt 2.4pt;">57.49</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.17.17.8" style="padding:-2.5pt 2.4pt;">76.50</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.17.17.9" style="padding:-2.5pt 2.4pt;">63.51</td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.18.18">
<td class="ltx_td" id="A8.T18.7.18.18.1" style="padding:-2.5pt 2.4pt;"></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.18.18.2" style="padding:-2.5pt 2.4pt;">QuaRot</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.18.18.3" style="padding:-2.5pt 2.4pt;">W4A4KV4</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.18.18.4" style="padding:-2.5pt 2.4pt;">67.88</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.18.18.5" style="padding:-2.5pt 2.4pt;">75.28</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.18.18.6" style="padding:-2.5pt 2.4pt;">45.65</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.18.18.7" style="padding:-2.5pt 2.4pt;">72.35</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.18.18.8" style="padding:-2.5pt 2.4pt;">77.48</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.18.18.9" style="padding:-2.5pt 2.4pt;">67.73</td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.19.19">
<td class="ltx_td" id="A8.T18.7.19.19.1" style="padding:-2.5pt 2.4pt;"></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.19.19.2" style="padding:-2.5pt 2.4pt;">DuQuant</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.19.19.3" style="padding:-2.5pt 2.4pt;">W4A4KV4</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.19.19.4" style="padding:-2.5pt 2.4pt;">68.9</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.19.19.5" style="padding:-2.5pt 2.4pt;">76.65</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.19.19.6" style="padding:-2.5pt 2.4pt;">47.7</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.19.19.7" style="padding:-2.5pt 2.4pt;">74.24</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.19.19.8" style="padding:-2.5pt 2.4pt;">78.18</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.19.19.9" style="padding:-2.5pt 2.4pt;">69.13</td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.20.20">
<td class="ltx_td" id="A8.T18.7.20.20.1" style="padding:-2.5pt 2.4pt;"></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.20.20.2" style="padding:-2.5pt 2.4pt;">SpinQuant</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.20.20.3" style="padding:-2.5pt 2.4pt;">W4A4KV4</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.20.20.4" style="padding:-2.5pt 2.4pt;">67.88</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.20.20.5" style="padding:-2.5pt 2.4pt;">77.01</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.20.20.6" style="padding:-2.5pt 2.4pt;">46.76</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.20.20.7" style="padding:-2.5pt 2.4pt;">75.97</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.20.20.8" style="padding:-2.5pt 2.4pt;">78.56</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.20.20.9" style="padding:-2.5pt 2.4pt;">69.24</td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.21.21">
<td class="ltx_td" id="A8.T18.7.21.21.1" style="padding:-2.5pt 2.4pt;"></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.21.21.2" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.21.21.2.1" style="background-color:#D3EFF1;">PrefixQuant w/o FT</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.21.21.3" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.21.21.3.1" style="background-color:#D3EFF1;">W4A4KV4</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.21.21.4" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.21.21.4.1" style="background-color:#D3EFF1;">72.06</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.21.21.5" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.21.21.5.1" style="background-color:#D3EFF1;">76.54</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.21.21.6" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.21.21.6.1" style="background-color:#D3EFF1;">46.67</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.21.21.7" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.21.21.7.1" style="background-color:#D3EFF1;">75.8</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.21.21.8" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.21.21.8.1" style="background-color:#D3EFF1;">78.51</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.21.21.9" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.21.21.9.1" style="background-color:#D3EFF1;">69.92</span></td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.22.22">
<td class="ltx_td" id="A8.T18.7.22.22.1" style="padding:-2.5pt 2.4pt;"></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.22.22.2" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.22.22.2.1" style="background-color:#D3EFF1;">PrefixQuant</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.22.22.3" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.22.22.3.1" style="background-color:#D3EFF1;">W4A4KV4</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.22.22.4" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.22.22.4.1" style="background-color:#D3EFF1;">72.53</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.22.22.5" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.22.22.5.1" style="background-color:#D3EFF1;">76.12</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.22.22.6" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.22.22.6.1" style="background-color:#D3EFF1;">47.70</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.22.22.7" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.22.22.7.1" style="background-color:#D3EFF1;">76.09</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.22.22.8" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.22.22.8.1" style="background-color:#D3EFF1;">79.38</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.22.22.9" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.22.22.9.1" style="background-color:#D3EFF1;">70.36</span></td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.23.23">
<td class="ltx_td ltx_align_left" id="A8.T18.7.23.23.1" style="padding:-2.5pt 2.4pt;">
<span class="ltx_ERROR undefined" id="A8.T18.7.23.23.1.1">\cdashline</span>2-9</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.23.23.2" style="padding:-2.5pt 2.4pt;">QoQ</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.23.23.3" style="padding:-2.5pt 2.4pt;">W4A8KV8</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.23.23.4" style="padding:-2.5pt 2.4pt;">70.96</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.23.23.5" style="padding:-2.5pt 2.4pt;">77.80</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.23.23.6" style="padding:-2.5pt 2.4pt;">48.38</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.23.23.7" style="padding:-2.5pt 2.4pt;">75.97</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.23.23.8" style="padding:-2.5pt 2.4pt;">79.71</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.23.23.9" style="padding:-2.5pt 2.4pt;">70.56</td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.24.24">
<td class="ltx_td" id="A8.T18.7.24.24.1" style="padding:-2.5pt 2.4pt;"></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.24.24.2" style="padding:-2.5pt 2.4pt;">QuaRot</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.24.24.3" style="padding:-2.5pt 2.4pt;">W4A8KV8</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.24.24.4" style="padding:-2.5pt 2.4pt;">70.24</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.24.24.5" style="padding:-2.5pt 2.4pt;">78.21</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.24.24.6" style="padding:-2.5pt 2.4pt;">47.01</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.24.24.7" style="padding:-2.5pt 2.4pt;">74.49</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.24.24.8" style="padding:-2.5pt 2.4pt;">79.87</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.24.24.9" style="padding:-2.5pt 2.4pt;">69.96</td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.25.25">
<td class="ltx_td" id="A8.T18.7.25.25.1" style="padding:-2.5pt 2.4pt;"></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.25.25.2" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.25.25.2.1" style="background-color:#D3EFF1;">PrefixQuant w/o FT</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.25.25.3" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.25.25.3.1" style="background-color:#D3EFF1;">W4A8KV8</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.25.25.4" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.25.25.4.1" style="background-color:#D3EFF1;">72.77</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.25.25.5" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.25.25.5.1" style="background-color:#D3EFF1;">77.49</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.25.25.6" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.25.25.6.1" style="background-color:#D3EFF1;">48.12</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.25.25.7" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.25.25.7.1" style="background-color:#D3EFF1;">77.06</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.25.25.8" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.25.25.8.1" style="background-color:#D3EFF1;">79.92</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.25.25.9" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.25.25.9.1" style="background-color:#D3EFF1;">71.07</span></td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.26.26">
<td class="ltx_td" id="A8.T18.7.26.26.1" style="padding:-2.5pt 2.4pt;"></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.26.26.2" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.26.26.2.1" style="background-color:#D3EFF1;">PrefixQuant</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.26.26.3" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.26.26.3.1" style="background-color:#D3EFF1;">W4A8KV8</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.26.26.4" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.26.26.4.1" style="background-color:#D3EFF1;">72.77</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.26.26.5" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.26.26.5.1" style="background-color:#D3EFF1;">77.54</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.26.26.6" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.26.26.6.1" style="background-color:#D3EFF1;">48.72</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.26.26.7" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.26.26.7.1" style="background-color:#D3EFF1;">76.81</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.26.26.8" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.26.26.8.1" style="background-color:#D3EFF1;">80.41</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.26.26.9" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.26.26.9.1" style="background-color:#D3EFF1;">71.25</span></td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.27.27">
<td class="ltx_td ltx_align_left" id="A8.T18.7.27.27.1" style="padding:-2.5pt 2.4pt;">
<span class="ltx_ERROR undefined" id="A8.T18.7.27.27.1.1">\cdashline</span>2-9</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.27.27.2" style="padding:-2.5pt 2.4pt;">SmoothQuant</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.27.27.3" style="padding:-2.5pt 2.4pt;">W8A8KV8</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.27.27.4" style="padding:-2.5pt 2.4pt;">72.14</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.27.27.5" style="padding:-2.5pt 2.4pt;">79.34</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.27.27.6" style="padding:-2.5pt 2.4pt;">48.89</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.27.27.7" style="padding:-2.5pt 2.4pt;">77.31</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.27.27.8" style="padding:-2.5pt 2.4pt;">80.2</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.27.27.9" style="padding:-2.5pt 2.4pt;">71.58</td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.28.28">
<td class="ltx_td" id="A8.T18.7.28.28.1" style="padding:-2.5pt 2.4pt;"></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.28.28.2" style="padding:-2.5pt 2.4pt;">QuaRot</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.28.28.3" style="padding:-2.5pt 2.4pt;">W8A8KV8</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.28.28.4" style="padding:-2.5pt 2.4pt;">71.98</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.28.28.5" style="padding:-2.5pt 2.4pt;">79.35</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.28.28.6" style="padding:-2.5pt 2.4pt;">49.23</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.28.28.7" style="padding:-2.5pt 2.4pt;">77.4</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.28.28.8" style="padding:-2.5pt 2.4pt;">80.47</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.28.28.9" style="padding:-2.5pt 2.4pt;">71.69</td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.29.29">
<td class="ltx_td" id="A8.T18.7.29.29.1" style="padding:-2.5pt 2.4pt;"></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.29.29.2" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.29.29.2.1" style="background-color:#D3EFF1;">PrefixQuant w/o FT</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.29.29.3" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.29.29.3.1" style="background-color:#D3EFF1;">W8A8KV8</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.29.29.4" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.29.29.4.1" style="background-color:#D3EFF1;">72.53</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.29.29.5" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.29.29.5.1" style="background-color:#D3EFF1;">78.38</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.29.29.6" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.29.29.6.1" style="background-color:#D3EFF1;">48.98</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.29.29.7" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.29.29.7.1" style="background-color:#D3EFF1;">76.81</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.29.29.8" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.29.29.8.1" style="background-color:#D3EFF1;">80.9</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.29.29.9" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.29.29.9.1" style="background-color:#D3EFF1;">71.52</span></td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.30.30">
<td class="ltx_td ltx_align_left ltx_border_t" id="A8.T18.7.30.30.1" style="padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.30.30.1.1">2-70B</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A8.T18.7.30.30.2" style="padding:-2.5pt 2.4pt;">Baseline</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A8.T18.7.30.30.3" style="padding:-2.5pt 2.4pt;">FP16</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A8.T18.7.30.30.4" style="padding:-2.5pt 2.4pt;">79.48</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A8.T18.7.30.30.5" style="padding:-2.5pt 2.4pt;">84.31</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A8.T18.7.30.30.6" style="padding:-2.5pt 2.4pt;">56.91</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A8.T18.7.30.30.7" style="padding:-2.5pt 2.4pt;">80.30</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A8.T18.7.30.30.8" style="padding:-2.5pt 2.4pt;">82.54</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A8.T18.7.30.30.9" style="padding:-2.5pt 2.4pt;">76.71</td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.31.31">
<td class="ltx_td ltx_align_left" id="A8.T18.7.31.31.1" style="padding:-2.5pt 2.4pt;">
<span class="ltx_ERROR undefined" id="A8.T18.7.31.31.1.1">\cdashline</span>2-9</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.31.31.2" style="padding:-2.5pt 2.4pt;">Atom</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.31.31.3" style="padding:-2.5pt 2.4pt;">W4A4KV4</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.31.31.4" style="padding:-2.5pt 2.4pt;">74.27</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.31.31.5" style="padding:-2.5pt 2.4pt;">79.06</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.31.31.6" style="padding:-2.5pt 2.4pt;">46.08</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.31.31.7" style="padding:-2.5pt 2.4pt;">58.25</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.31.31.8" style="padding:-2.5pt 2.4pt;">79.92</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.31.31.9" style="padding:-2.5pt 2.4pt;">67.52</td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.32.32">
<td class="ltx_td" id="A8.T18.7.32.32.1" style="padding:-2.5pt 2.4pt;"></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.32.32.2" style="padding:-2.5pt 2.4pt;">QuaRot</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.32.32.3" style="padding:-2.5pt 2.4pt;">W4A4KV4</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.32.32.4" style="padding:-2.5pt 2.4pt;">76.24</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.32.32.5" style="padding:-2.5pt 2.4pt;">81.82</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.32.32.6" style="padding:-2.5pt 2.4pt;">56.23</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.32.32.7" style="padding:-2.5pt 2.4pt;">80.43</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.32.32.8" style="padding:-2.5pt 2.4pt;">82.43</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.32.32.9" style="padding:-2.5pt 2.4pt;">75.43</td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.33.33">
<td class="ltx_td" id="A8.T18.7.33.33.1" style="padding:-2.5pt 2.4pt;"></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.33.33.2" style="padding:-2.5pt 2.4pt;">DuQuant</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.33.33.3" style="padding:-2.5pt 2.4pt;">W4A4KV4</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.33.33.4" style="padding:-2.5pt 2.4pt;">75.45</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.33.33.5" style="padding:-2.5pt 2.4pt;">81.95</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.33.33.6" style="padding:-2.5pt 2.4pt;">55.03</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.33.33.7" style="padding:-2.5pt 2.4pt;">79</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.33.33.8" style="padding:-2.5pt 2.4pt;">82.32</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.33.33.9" style="padding:-2.5pt 2.4pt;">74.75</td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.34.34">
<td class="ltx_td" id="A8.T18.7.34.34.1" style="padding:-2.5pt 2.4pt;"></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.34.34.2" style="padding:-2.5pt 2.4pt;">SpinQuant</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.34.34.3" style="padding:-2.5pt 2.4pt;">W4A4KV4</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.34.34.4" style="padding:-2.5pt 2.4pt;">75.85</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.34.34.5" style="padding:-2.5pt 2.4pt;">82.36</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.34.34.6" style="padding:-2.5pt 2.4pt;">56.31</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.34.34.7" style="padding:-2.5pt 2.4pt;">79.17</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.34.34.8" style="padding:-2.5pt 2.4pt;">81.61</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.34.34.9" style="padding:-2.5pt 2.4pt;">75.19</td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.35.35">
<td class="ltx_td" id="A8.T18.7.35.35.1" style="padding:-2.5pt 2.4pt;"></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.35.35.2" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.35.35.2.1" style="background-color:#D3EFF1;">PrefixQuant w/o FT</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.35.35.3" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.35.35.3.1" style="background-color:#D3EFF1;">W4A4KV4</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.35.35.4" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.35.35.4.1" style="background-color:#D3EFF1;">75.45</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.35.35.5" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.35.35.5.1" style="background-color:#D3EFF1;">80.51</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.35.35.6" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.35.35.6.1" style="background-color:#D3EFF1;">52.3</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.35.35.7" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.35.35.7.1" style="background-color:#D3EFF1;">77.06</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.35.35.8" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.35.35.8.1" style="background-color:#D3EFF1;">81.12</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.35.35.9" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.35.35.9.1" style="background-color:#D3EFF1;">73.29</span></td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.36.36">
<td class="ltx_td" id="A8.T18.7.36.36.1" style="padding:-2.5pt 2.4pt;"></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.36.36.2" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.36.36.2.1" style="background-color:#D3EFF1;">PrefixQuant</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.36.36.3" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.36.36.3.1" style="background-color:#D3EFF1;">W4A4KV4</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.36.36.4" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.36.36.4.1" style="background-color:#D3EFF1;">77.35</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.36.36.5" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.36.36.5.1" style="background-color:#D3EFF1;">82.3</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.36.36.6" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.36.36.6.1" style="background-color:#D3EFF1;">56.4</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.36.36.7" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.36.36.7.1" style="background-color:#D3EFF1;">79.29</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.36.36.8" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.36.36.8.1" style="background-color:#D3EFF1;">82.05</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.36.36.9" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.36.36.9.1" style="background-color:#D3EFF1;">75.48</span></td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.37.37">
<td class="ltx_td ltx_align_left" id="A8.T18.7.37.37.1" style="padding:-2.5pt 2.4pt;">
<span class="ltx_ERROR undefined" id="A8.T18.7.37.37.1.1">\cdashline</span>2-9</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.37.37.2" style="padding:-2.5pt 2.4pt;">QoQ</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.37.37.3" style="padding:-2.5pt 2.4pt;">W4A8KV8</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.37.37.4" style="padding:-2.5pt 2.4pt;">77.51</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.37.37.5" style="padding:-2.5pt 2.4pt;">82.78</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.37.37.6" style="padding:-2.5pt 2.4pt;">56.83</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.37.37.7" style="padding:-2.5pt 2.4pt;">79.80</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.37.37.8" style="padding:-2.5pt 2.4pt;">82.64</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.37.37.9" style="padding:-2.5pt 2.4pt;">75.91</td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.38.38">
<td class="ltx_td" id="A8.T18.7.38.38.1" style="padding:-2.5pt 2.4pt;"></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.38.38.2" style="padding:-2.5pt 2.4pt;">QuaRot</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.38.38.3" style="padding:-2.5pt 2.4pt;">W4A8KV8</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.38.38.4" style="padding:-2.5pt 2.4pt;">77.03</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.38.38.5" style="padding:-2.5pt 2.4pt;">83.30</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.38.38.6" style="padding:-2.5pt 2.4pt;">57.08</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.38.38.7" style="padding:-2.5pt 2.4pt;">81.27</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.38.38.8" style="padding:-2.5pt 2.4pt;">82.86</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.38.38.9" style="padding:-2.5pt 2.4pt;">76.31</td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.39.39">
<td class="ltx_td" id="A8.T18.7.39.39.1" style="padding:-2.5pt 2.4pt;"></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.39.39.2" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.39.39.2.1" style="background-color:#D3EFF1;">PrefixQuant w/o FT</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.39.39.3" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.39.39.3.1" style="background-color:#D3EFF1;">W4A8KV8</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.39.39.4" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.39.39.4.1" style="background-color:#D3EFF1;">77.35</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.39.39.5" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.39.39.5.1" style="background-color:#D3EFF1;">82.79</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.39.39.6" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.39.39.6.1" style="background-color:#D3EFF1;">54.35</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.39.39.7" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.39.39.7.1" style="background-color:#D3EFF1;">78.28</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.39.39.8" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.39.39.8.1" style="background-color:#D3EFF1;">82.21</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.39.39.9" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.39.39.9.1" style="background-color:#D3EFF1;">75.00</span></td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.40.40">
<td class="ltx_td" id="A8.T18.7.40.40.1" style="padding:-2.5pt 2.4pt;"></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.40.40.2" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.40.40.2.1" style="background-color:#D3EFF1;">PrefixQuant</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.40.40.3" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.40.40.3.1" style="background-color:#D3EFF1;">W4A8KV8</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.40.40.4" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.40.40.4.1" style="background-color:#D3EFF1;">79.08</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.40.40.5" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.40.40.5.1" style="background-color:#D3EFF1;">83.56</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.40.40.6" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.40.40.6.1" style="background-color:#D3EFF1;">57.42</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.40.40.7" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.40.40.7.1" style="background-color:#D3EFF1;">80.39</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.40.40.8" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.40.40.8.1" style="background-color:#D3EFF1;">82.05</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.40.40.9" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.40.40.9.1" style="background-color:#D3EFF1;">76.50</span></td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.41.41">
<td class="ltx_td ltx_align_left" id="A8.T18.7.41.41.1" style="padding:-2.5pt 2.4pt;">
<span class="ltx_ERROR undefined" id="A8.T18.7.41.41.1.1">\cdashline</span>2-9</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.41.41.2" style="padding:-2.5pt 2.4pt;">SmoothQuant</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.41.41.3" style="padding:-2.5pt 2.4pt;">W8A8KV8</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.41.41.4" style="padding:-2.5pt 2.4pt;">77.03</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.41.41.5" style="padding:-2.5pt 2.4pt;">83.38</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.41.41.6" style="padding:-2.5pt 2.4pt;">56.91</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.41.41.7" style="padding:-2.5pt 2.4pt;">80.72</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.41.41.8" style="padding:-2.5pt 2.4pt;">82.92</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.41.41.9" style="padding:-2.5pt 2.4pt;">76.19</td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.42.42">
<td class="ltx_td" id="A8.T18.7.42.42.1" style="padding:-2.5pt 2.4pt;"></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.42.42.2" style="padding:-2.5pt 2.4pt;">QuaRot</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.42.42.3" style="padding:-2.5pt 2.4pt;">W8A8KV8</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.42.42.4" style="padding:-2.5pt 2.4pt;">77.82</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.42.42.5" style="padding:-2.5pt 2.4pt;">83.8</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.42.42.6" style="padding:-2.5pt 2.4pt;">57.34</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.42.42.7" style="padding:-2.5pt 2.4pt;">80.93</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.42.42.8" style="padding:-2.5pt 2.4pt;">82.75</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.42.42.9" style="padding:-2.5pt 2.4pt;">76.53</td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.43.43">
<td class="ltx_td" id="A8.T18.7.43.43.1" style="padding:-2.5pt 2.4pt;"></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.43.43.2" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.43.43.2.1" style="background-color:#D3EFF1;">PrefixQuant w/o FT</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.43.43.3" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.43.43.3.1" style="background-color:#D3EFF1;">W8A8KV8</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.43.43.4" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.43.43.4.1" style="background-color:#D3EFF1;">79.16</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.43.43.5" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.43.43.5.1" style="background-color:#D3EFF1;">84.14</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.43.43.6" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.43.43.6.1" style="background-color:#D3EFF1;">55.8</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.43.43.7" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.43.43.7.1" style="background-color:#D3EFF1;">78.87</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.43.43.8" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.43.43.8.1" style="background-color:#D3EFF1;">82.59</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.43.43.9" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.43.43.9.1" style="background-color:#D3EFF1;">76.11</span></td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.44.44">
<td class="ltx_td ltx_align_left ltx_border_t" id="A8.T18.7.44.44.1" style="padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.44.44.1.1">3-8B</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A8.T18.7.44.44.2" style="padding:-2.5pt 2.4pt;">Baseline</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A8.T18.7.44.44.3" style="padding:-2.5pt 2.4pt;">FP16</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A8.T18.7.44.44.4" style="padding:-2.5pt 2.4pt;">72.61</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A8.T18.7.44.44.5" style="padding:-2.5pt 2.4pt;">79.17</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A8.T18.7.44.44.6" style="padding:-2.5pt 2.4pt;">53.41</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A8.T18.7.44.44.7" style="padding:-2.5pt 2.4pt;">77.69</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A8.T18.7.44.44.8" style="padding:-2.5pt 2.4pt;">80.69</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A8.T18.7.44.44.9" style="padding:-2.5pt 2.4pt;">72.71</td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.45.45">
<td class="ltx_td ltx_align_left" id="A8.T18.7.45.45.1" style="padding:-2.5pt 2.4pt;">
<span class="ltx_ERROR undefined" id="A8.T18.7.45.45.1.1">\cdashline</span>2-9</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.45.45.2" style="padding:-2.5pt 2.4pt;">QuaRot</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.45.45.3" style="padding:-2.5pt 2.4pt;">W4A4KV4</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.45.45.4" style="padding:-2.5pt 2.4pt;">65.98</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.45.45.5" style="padding:-2.5pt 2.4pt;">72.38</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.45.45.6" style="padding:-2.5pt 2.4pt;">44.45</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.45.45.7" style="padding:-2.5pt 2.4pt;">67.3</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.45.45.8" style="padding:-2.5pt 2.4pt;">75.63</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.45.45.9" style="padding:-2.5pt 2.4pt;">65.15</td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.46.46">
<td class="ltx_td" id="A8.T18.7.46.46.1" style="padding:-2.5pt 2.4pt;"></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.46.46.2" style="padding:-2.5pt 2.4pt;">DuQuant</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.46.46.3" style="padding:-2.5pt 2.4pt;">W4A4KV4</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.46.46.4" style="padding:-2.5pt 2.4pt;">68.59</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.46.46.5" style="padding:-2.5pt 2.4pt;">74.27</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.46.46.6" style="padding:-2.5pt 2.4pt;">46.5</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.46.46.7" style="padding:-2.5pt 2.4pt;">70.41</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.46.46.8" style="padding:-2.5pt 2.4pt;">75.9</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.46.46.9" style="padding:-2.5pt 2.4pt;">67.13</td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.47.47">
<td class="ltx_td" id="A8.T18.7.47.47.1" style="padding:-2.5pt 2.4pt;"></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.47.47.2" style="padding:-2.5pt 2.4pt;">SpinQuant</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.47.47.3" style="padding:-2.5pt 2.4pt;">W4A4KV4</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.47.47.4" style="padding:-2.5pt 2.4pt;">69.22</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.47.47.5" style="padding:-2.5pt 2.4pt;">74.83</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.47.47.6" style="padding:-2.5pt 2.4pt;">45.99</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.47.47.7" style="padding:-2.5pt 2.4pt;">74.07</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.47.47.8" style="padding:-2.5pt 2.4pt;">77.04</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.47.47.9" style="padding:-2.5pt 2.4pt;">68.23</td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.48.48">
<td class="ltx_td" id="A8.T18.7.48.48.1" style="padding:-2.5pt 2.4pt;"></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.48.48.2" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.48.48.2.1" style="background-color:#D3EFF1;">PrefixQuant w/o FT</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.48.48.3" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.48.48.3.1" style="background-color:#D3EFF1;">W4A4KV4</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.48.48.4" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.48.48.4.1" style="background-color:#D3EFF1;">69.14</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.48.48.5" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.48.48.5.1" style="background-color:#D3EFF1;">75.46</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.48.48.6" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.48.48.6.1" style="background-color:#D3EFF1;">47.1</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.48.48.7" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.48.48.7.1" style="background-color:#D3EFF1;">72.94</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.48.48.8" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.48.48.8.1" style="background-color:#D3EFF1;">77.2</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.48.48.9" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.48.48.9.1" style="background-color:#D3EFF1;">68.37</span></td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.49.49">
<td class="ltx_td" id="A8.T18.7.49.49.1" style="padding:-2.5pt 2.4pt;"></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.49.49.2" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.49.49.2.1" style="background-color:#D3EFF1;">PrefixQuant</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.49.49.3" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.49.49.3.1" style="background-color:#D3EFF1;">W4A4KV4</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.49.49.4" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.49.49.4.1" style="background-color:#D3EFF1;">71.9</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.49.49.5" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.49.49.5.1" style="background-color:#D3EFF1;">75.44</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.49.49.6" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.49.49.6.1" style="background-color:#D3EFF1;">50.68</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.49.49.7" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.49.49.7.1" style="background-color:#D3EFF1;">78.32</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.49.49.8" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.49.49.8.1" style="background-color:#D3EFF1;">79.05</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.49.49.9" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.49.49.9.1" style="background-color:#D3EFF1;">71.08</span></td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.50.50">
<td class="ltx_td ltx_align_left" id="A8.T18.7.50.50.1" style="padding:-2.5pt 2.4pt;">
<span class="ltx_ERROR undefined" id="A8.T18.7.50.50.1.1">\cdashline</span>2-9</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.50.50.2" style="padding:-2.5pt 2.4pt;">QoQ</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.50.50.3" style="padding:-2.5pt 2.4pt;">W4A8KV8</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.50.50.4" style="padding:-2.5pt 2.4pt;">73.4</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.50.50.5" style="padding:-2.5pt 2.4pt;">77.23</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.50.50.6" style="padding:-2.5pt 2.4pt;">50.87</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.50.50.7" style="padding:-2.5pt 2.4pt;">75.59</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.50.50.8" style="padding:-2.5pt 2.4pt;">79.65</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.50.50.9" style="padding:-2.5pt 2.4pt;">71.35</td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.51.51">
<td class="ltx_td" id="A8.T18.7.51.51.1" style="padding:-2.5pt 2.4pt;"></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.51.51.2" style="padding:-2.5pt 2.4pt;">QuaRot</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.51.51.3" style="padding:-2.5pt 2.4pt;">W4A8KV8</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.51.51.4" style="padding:-2.5pt 2.4pt;">72.74</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.51.51.5" style="padding:-2.5pt 2.4pt;">77.35</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.51.51.6" style="padding:-2.5pt 2.4pt;">51.62</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.51.51.7" style="padding:-2.5pt 2.4pt;">77.48</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.51.51.8" style="padding:-2.5pt 2.4pt;">79.22</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.51.51.9" style="padding:-2.5pt 2.4pt;">71.68</td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.52.52">
<td class="ltx_td" id="A8.T18.7.52.52.1" style="padding:-2.5pt 2.4pt;"></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.52.52.2" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.52.52.2.1" style="background-color:#D3EFF1;">PrefixQuant w/o FT</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.52.52.3" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.52.52.3.1" style="background-color:#D3EFF1;">W4A8KV8</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.52.52.4" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.52.52.4.1" style="background-color:#D3EFF1;">71.19</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.52.52.5" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.52.52.5.1" style="background-color:#D3EFF1;">77.65</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.52.52.6" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.52.52.6.1" style="background-color:#D3EFF1;">48.98</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.52.52.7" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.52.52.7.1" style="background-color:#D3EFF1;">73.99</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.52.52.8" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.52.52.8.1" style="background-color:#D3EFF1;">79.65</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.52.52.9" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.52.52.9.1" style="background-color:#D3EFF1;">70.29</span></td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.53.53">
<td class="ltx_td" id="A8.T18.7.53.53.1" style="padding:-2.5pt 2.4pt;"></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.53.53.2" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.53.53.2.1" style="background-color:#D3EFF1;">PrefixQuant</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.53.53.3" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.53.53.3.1" style="background-color:#D3EFF1;">W4A8KV8</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.53.53.4" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.53.53.4.1" style="background-color:#D3EFF1;">72.53</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.53.53.5" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.53.53.5.1" style="background-color:#D3EFF1;">77.97</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.53.53.6" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.53.53.6.1" style="background-color:#D3EFF1;">52.65</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.53.53.7" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.53.53.7.1" style="background-color:#D3EFF1;">79.25</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.53.53.8" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.53.53.8.1" style="background-color:#D3EFF1;">79.92</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.53.53.9" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.53.53.9.1" style="background-color:#D3EFF1;">72.46</span></td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.54.54">
<td class="ltx_td ltx_align_left" id="A8.T18.7.54.54.1" style="padding:-2.5pt 2.4pt;">
<span class="ltx_ERROR undefined" id="A8.T18.7.54.54.1.1">\cdashline</span>2-9</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.54.54.2" style="padding:-2.5pt 2.4pt;">SmoothQuant</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.54.54.3" style="padding:-2.5pt 2.4pt;">W8A8KV8</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.54.54.4" style="padding:-2.5pt 2.4pt;">73.01</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.54.54.5" style="padding:-2.5pt 2.4pt;">78.99</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.54.54.6" style="padding:-2.5pt 2.4pt;">53.07</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.54.54.7" style="padding:-2.5pt 2.4pt;">77.82</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.54.54.8" style="padding:-2.5pt 2.4pt;">80.74</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.54.54.9" style="padding:-2.5pt 2.4pt;">72.73</td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.55.55">
<td class="ltx_td" id="A8.T18.7.55.55.1" style="padding:-2.5pt 2.4pt;"></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.55.55.2" style="padding:-2.5pt 2.4pt;">QuaRot</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.55.55.3" style="padding:-2.5pt 2.4pt;">W8A8KV8</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.55.55.4" style="padding:-2.5pt 2.4pt;">72.53</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.55.55.5" style="padding:-2.5pt 2.4pt;">78.99</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.55.55.6" style="padding:-2.5pt 2.4pt;">53.67</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.55.55.7" style="padding:-2.5pt 2.4pt;">78.03</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.55.55.8" style="padding:-2.5pt 2.4pt;">80.63</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.55.55.9" style="padding:-2.5pt 2.4pt;">72.77</td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.56.56">
<td class="ltx_td" id="A8.T18.7.56.56.1" style="padding:-2.5pt 2.4pt;"></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.56.56.2" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.56.56.2.1" style="background-color:#D3EFF1;">PrefixQuant w/o FT</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.56.56.3" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.56.56.3.1" style="background-color:#D3EFF1;">W8A8KV8</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.56.56.4" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.56.56.4.1" style="background-color:#D3EFF1;">74.11</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.56.56.5" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.56.56.5.1" style="background-color:#D3EFF1;">79.25</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.56.56.6" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.56.56.6.1" style="background-color:#D3EFF1;">53.75</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.56.56.7" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.56.56.7.1" style="background-color:#D3EFF1;">78.03</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.56.56.8" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.56.56.8.1" style="background-color:#D3EFF1;">80.36</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.56.56.9" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.56.56.9.1" style="background-color:#D3EFF1;">73.10</span></td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.57.57">
<td class="ltx_td ltx_align_left ltx_border_t" id="A8.T18.7.57.57.1" style="padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.57.57.1.1">3-70B</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A8.T18.7.57.57.2" style="padding:-2.5pt 2.4pt;">Baseline</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A8.T18.7.57.57.3" style="padding:-2.5pt 2.4pt;">FP16</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A8.T18.7.57.57.4" style="padding:-2.5pt 2.4pt;">80.51</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A8.T18.7.57.57.5" style="padding:-2.5pt 2.4pt;">84.9</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A8.T18.7.57.57.6" style="padding:-2.5pt 2.4pt;">64.33</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A8.T18.7.57.57.7" style="padding:-2.5pt 2.4pt;">85.9</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A8.T18.7.57.57.8" style="padding:-2.5pt 2.4pt;">84.49</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A8.T18.7.57.57.9" style="padding:-2.5pt 2.4pt;">80.03</td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.58.58">
<td class="ltx_td ltx_align_left" id="A8.T18.7.58.58.1" style="padding:-2.5pt 2.4pt;">
<span class="ltx_ERROR undefined" id="A8.T18.7.58.58.1.1">\cdashline</span>2-9</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.58.58.2" style="padding:-2.5pt 2.4pt;">QuaRot</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.58.58.3" style="padding:-2.5pt 2.4pt;">W4A4KV4</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.58.58.4" style="padding:-2.5pt 2.4pt;">68.51</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.58.58.5" style="padding:-2.5pt 2.4pt;">76.75</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.58.58.6" style="padding:-2.5pt 2.4pt;">47.01</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.58.58.7" style="padding:-2.5pt 2.4pt;">72.31</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.58.58.8" style="padding:-2.5pt 2.4pt;">77.37</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.58.58.9" style="padding:-2.5pt 2.4pt;">68.39</td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.59.59">
<td class="ltx_td" id="A8.T18.7.59.59.1" style="padding:-2.5pt 2.4pt;"></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.59.59.2" style="padding:-2.5pt 2.4pt;">DuQuant</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.59.59.3" style="padding:-2.5pt 2.4pt;">W4A4KV4</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.59.59.4" style="padding:-2.5pt 2.4pt;">70.8</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.59.59.5" style="padding:-2.5pt 2.4pt;">79.89</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.59.59.6" style="padding:-2.5pt 2.4pt;">59.04</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.59.59.7" style="padding:-2.5pt 2.4pt;">82.91</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.59.59.8" style="padding:-2.5pt 2.4pt;">81.83</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.59.59.9" style="padding:-2.5pt 2.4pt;">74.89</td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.60.60">
<td class="ltx_td" id="A8.T18.7.60.60.1" style="padding:-2.5pt 2.4pt;"></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.60.60.2" style="padding:-2.5pt 2.4pt;">SpinQuant</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.60.60.3" style="padding:-2.5pt 2.4pt;">W4A4KV4</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.60.60.4" style="padding:-2.5pt 2.4pt;">76.4</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.60.60.5" style="padding:-2.5pt 2.4pt;">80.9</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.60.60.6" style="padding:-2.5pt 2.4pt;">56</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.60.60.7" style="padding:-2.5pt 2.4pt;">77.3</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.60.60.8" style="padding:-2.5pt 2.4pt;">80.8</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.60.60.9" style="padding:-2.5pt 2.4pt;">74.28</td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.61.61">
<td class="ltx_td" id="A8.T18.7.61.61.1" style="padding:-2.5pt 2.4pt;"></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.61.61.2" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.61.61.2.1" style="background-color:#D3EFF1;">PrefixQuant w/o FT</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.61.61.3" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.61.61.3.1" style="background-color:#D3EFF1;">W4A4KV4</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.61.61.4" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.61.61.4.1" style="background-color:#D3EFF1;">77.43</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.61.61.5" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.61.61.5.1" style="background-color:#D3EFF1;">83.48</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.61.61.6" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.61.61.6.1" style="background-color:#D3EFF1;">58.87</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.61.61.7" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.61.61.7.1" style="background-color:#D3EFF1;">79.88</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.61.61.8" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.61.61.8.1" style="background-color:#D3EFF1;">82.32</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.61.61.9" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.61.61.9.1" style="background-color:#D3EFF1;">76.40</span></td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.62.62">
<td class="ltx_td" id="A8.T18.7.62.62.1" style="padding:-2.5pt 2.4pt;"></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.62.62.2" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.62.62.2.1" style="background-color:#D3EFF1;">PrefixQuant</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.62.62.3" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.62.62.3.1" style="background-color:#D3EFF1;">W4A4KV4</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.62.62.4" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.62.62.4.1" style="background-color:#D3EFF1;">77.35</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.62.62.5" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.62.62.5.1" style="background-color:#D3EFF1;">83.79</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.62.62.6" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.62.62.6.1" style="background-color:#D3EFF1;">60.15</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.62.62.7" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.62.62.7.1" style="background-color:#D3EFF1;">81.31</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.62.62.8" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.62.62.8.1" style="background-color:#D3EFF1;">83.3</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.62.62.9" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.62.62.9.1" style="background-color:#D3EFF1;">77.18</span></td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.63.63">
<td class="ltx_td ltx_align_left" id="A8.T18.7.63.63.1" style="padding:-2.5pt 2.4pt;">
<span class="ltx_ERROR undefined" id="A8.T18.7.63.63.1.1">\cdashline</span>2-9</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.63.63.2" style="padding:-2.5pt 2.4pt;">QoQ</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.63.63.3" style="padding:-2.5pt 2.4pt;">W4A8KV8</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.63.63.4" style="padding:-2.5pt 2.4pt;">80.11</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.63.63.5" style="padding:-2.5pt 2.4pt;">83.7</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.63.63.6" style="padding:-2.5pt 2.4pt;">61.01</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.63.63.7" style="padding:-2.5pt 2.4pt;">82.79</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.63.63.8" style="padding:-2.5pt 2.4pt;">83</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.63.63.9" style="padding:-2.5pt 2.4pt;">78.12</td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.64.64">
<td class="ltx_td" id="A8.T18.7.64.64.1" style="padding:-2.5pt 2.4pt;"></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.64.64.2" style="padding:-2.5pt 2.4pt;">QuaRot</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.64.64.3" style="padding:-2.5pt 2.4pt;">W4A8KV8</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.64.64.4" style="padding:-2.5pt 2.4pt;">80.35</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.64.64.5" style="padding:-2.5pt 2.4pt;">84.03</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.64.64.6" style="padding:-2.5pt 2.4pt;">62.12</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.64.64.7" style="padding:-2.5pt 2.4pt;">84.64</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.64.64.8" style="padding:-2.5pt 2.4pt;">83.46</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.64.64.9" style="padding:-2.5pt 2.4pt;">78.92</td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.65.65">
<td class="ltx_td" id="A8.T18.7.65.65.1" style="padding:-2.5pt 2.4pt;"></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.65.65.2" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.65.65.2.1" style="background-color:#D3EFF1;">PrefixQuant w/o FT</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.65.65.3" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.65.65.3.1" style="background-color:#D3EFF1;">W4A8KV8</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.65.65.4" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.65.65.4.1" style="background-color:#D3EFF1;">79.23</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.65.65.5" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.65.65.5.1" style="background-color:#D3EFF1;">84.71</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.65.65.6" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.65.65.6.1" style="background-color:#D3EFF1;">59.39</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.65.65.7" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.65.65.7.1" style="background-color:#D3EFF1;">81.57</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.65.65.8" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.65.65.8.1" style="background-color:#D3EFF1;">84.22</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.65.65.9" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.65.65.9.1" style="background-color:#D3EFF1;">77.82</span></td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.66.66">
<td class="ltx_td" id="A8.T18.7.66.66.1" style="padding:-2.5pt 2.4pt;"></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.66.66.2" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.66.66.2.1" style="background-color:#D3EFF1;">PrefixQuant</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.66.66.3" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.66.66.3.1" style="background-color:#D3EFF1;">W4A8KV8</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.66.66.4" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.66.66.4.1" style="background-color:#D3EFF1;">79.48</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.66.66.5" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.66.66.5.1" style="background-color:#D3EFF1;">84.86</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.66.66.6" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.66.66.6.1" style="background-color:#D3EFF1;">62.29</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.66.66.7" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.66.66.7.1" style="background-color:#D3EFF1;">82.53</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.66.66.8" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.66.66.8.1" style="background-color:#D3EFF1;">84.33</span></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.66.66.9" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.66.66.9.1" style="background-color:#D3EFF1;">78.70</span></td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.67.67">
<td class="ltx_td ltx_align_left" id="A8.T18.7.67.67.1" style="padding:-2.5pt 2.4pt;">
<span class="ltx_ERROR undefined" id="A8.T18.7.67.67.1.1">\cdashline</span>2-9</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.67.67.2" style="padding:-2.5pt 2.4pt;">SmoothQuant</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.67.67.3" style="padding:-2.5pt 2.4pt;">W8A8KV8</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.67.67.4" style="padding:-2.5pt 2.4pt;">79.40</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.67.67.5" style="padding:-2.5pt 2.4pt;">84.64</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.67.67.6" style="padding:-2.5pt 2.4pt;">63.14</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.67.67.7" style="padding:-2.5pt 2.4pt;">85.35</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.67.67.8" style="padding:-2.5pt 2.4pt;">83.9</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.67.67.9" style="padding:-2.5pt 2.4pt;">79.29</td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.68.68">
<td class="ltx_td" id="A8.T18.7.68.68.1" style="padding:-2.5pt 2.4pt;"></td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.68.68.2" style="padding:-2.5pt 2.4pt;">QuaRot</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A8.T18.7.68.68.3" style="padding:-2.5pt 2.4pt;">W8A8KV8</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.68.68.4" style="padding:-2.5pt 2.4pt;">80.66</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.68.68.5" style="padding:-2.5pt 2.4pt;">84.84</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.68.68.6" style="padding:-2.5pt 2.4pt;">63.65</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.68.68.7" style="padding:-2.5pt 2.4pt;">85.56</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.68.68.8" style="padding:-2.5pt 2.4pt;">84.44</td>
<td class="ltx_td ltx_align_center" id="A8.T18.7.68.68.9" style="padding:-2.5pt 2.4pt;">79.83</td>
</tr>
<tr class="ltx_tr" id="A8.T18.7.69.69">
<td class="ltx_td ltx_border_bb" id="A8.T18.7.69.69.1" style="padding:-2.5pt 2.4pt;"></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A8.T18.7.69.69.2" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.69.69.2.1" style="background-color:#D3EFF1;">PrefixQuant w/o FT</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="A8.T18.7.69.69.3" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.69.69.3.1" style="background-color:#D3EFF1;">W8A8KV8</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A8.T18.7.69.69.4" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.69.69.4.1" style="background-color:#D3EFF1;">79.40</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A8.T18.7.69.69.5" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.69.69.5.1" style="background-color:#D3EFF1;">85.5</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A8.T18.7.69.69.6" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.69.69.6.1" style="background-color:#D3EFF1;">61.43</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A8.T18.7.69.69.7" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.69.69.7.1" style="background-color:#D3EFF1;">82.49</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A8.T18.7.69.69.8" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.69.69.8.1" style="background-color:#D3EFF1;">84.22</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A8.T18.7.69.69.9" style="background-color:#D3EFF1;padding:-2.5pt 2.4pt;"><span class="ltx_text" id="A8.T18.7.69.69.9.1" style="background-color:#D3EFF1;">78.61</span></td>
</tr>
</tbody>
</table>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_table" id="A8.T19">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 19: </span>Results of proposed PrefixQuant on other models.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A8.T19.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A8.T19.1.1.1">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A8.T19.1.1.1.1" style="padding-left:1.0pt;padding-right:1.0pt;"><span class="ltx_text ltx_font_bold" id="A8.T19.1.1.1.1.1">Model</span></th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A8.T19.1.1.1.2" style="padding-left:1.0pt;padding-right:1.0pt;"><span class="ltx_text ltx_font_bold" id="A8.T19.1.1.1.2.1">Precision</span></th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A8.T19.1.1.1.3" style="padding-left:1.0pt;padding-right:1.0pt;"><span class="ltx_text ltx_font_bold" id="A8.T19.1.1.1.3.1">Wiki PPL</span></th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A8.T19.1.1.1.4" style="padding-left:1.0pt;padding-right:1.0pt;"><span class="ltx_text ltx_font_bold" id="A8.T19.1.1.1.4.1">WinoGrande</span></th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A8.T19.1.1.1.5" style="padding-left:1.0pt;padding-right:1.0pt;"><span class="ltx_text ltx_font_bold" id="A8.T19.1.1.1.5.1">HellaSwag</span></th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A8.T19.1.1.1.6" style="padding-left:1.0pt;padding-right:1.0pt;"><span class="ltx_text ltx_font_bold" id="A8.T19.1.1.1.6.1">ArcC</span></th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A8.T19.1.1.1.7" style="padding-left:1.0pt;padding-right:1.0pt;"><span class="ltx_text ltx_font_bold" id="A8.T19.1.1.1.7.1">ArcE</span></th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A8.T19.1.1.1.8" style="padding-left:1.0pt;padding-right:1.0pt;"><span class="ltx_text ltx_font_bold" id="A8.T19.1.1.1.8.1">PiQA</span></th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A8.T19.1.1.1.9" style="padding-left:1.0pt;padding-right:1.0pt;"><span class="ltx_text ltx_font_bold" id="A8.T19.1.1.1.9.1">Avg. Acc.</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A8.T19.1.2.1">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row ltx_border_t" id="A8.T19.1.2.1.1" style="padding-left:1.0pt;padding-right:1.0pt;"><span class="ltx_text" id="A8.T19.1.2.1.1.1">Mistral-v0.3-7B</span></th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A8.T19.1.2.1.2" style="padding-left:1.0pt;padding-right:1.0pt;">FP16</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A8.T19.1.2.1.3" style="padding-left:1.0pt;padding-right:1.0pt;">5.32</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A8.T19.1.2.1.4" style="padding-left:1.0pt;padding-right:1.0pt;">73.88</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A8.T19.1.2.1.5" style="padding-left:1.0pt;padding-right:1.0pt;">80.43</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A8.T19.1.2.1.6" style="padding-left:1.0pt;padding-right:1.0pt;">52.3</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A8.T19.1.2.1.7" style="padding-left:1.0pt;padding-right:1.0pt;">78.28</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A8.T19.1.2.1.8" style="padding-left:1.0pt;padding-right:1.0pt;">82.26</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A8.T19.1.2.1.9" style="padding-left:1.0pt;padding-right:1.0pt;">73.43</td>
</tr>
<tr class="ltx_tr" id="A8.T19.1.3.2">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row" id="A8.T19.1.3.2.1" style="padding-left:1.0pt;padding-right:1.0pt;">
<span class="ltx_ERROR undefined" id="A8.T19.1.3.2.1.1">\cdashline</span>2-9</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.3.2.2" style="padding-left:1.0pt;padding-right:1.0pt;">W8A8KV8</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.3.2.3" style="padding-left:1.0pt;padding-right:1.0pt;">5.34</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.3.2.4" style="padding-left:1.0pt;padding-right:1.0pt;">74.03</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.3.2.5" style="padding-left:1.0pt;padding-right:1.0pt;">80.8</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.3.2.6" style="padding-left:1.0pt;padding-right:1.0pt;">53.5</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.3.2.7" style="padding-left:1.0pt;padding-right:1.0pt;">79.76</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.3.2.8" style="padding-left:1.0pt;padding-right:1.0pt;">81.72</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.3.2.9" style="padding-left:1.0pt;padding-right:1.0pt;">73.96</td>
</tr>
<tr class="ltx_tr" id="A8.T19.1.4.3">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_th ltx_th_row" id="A8.T19.1.4.3.1" style="padding-left:1.0pt;padding-right:1.0pt;"></th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.4.3.2" style="padding-left:1.0pt;padding-right:1.0pt;">W4A8KV4</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.4.3.3" style="padding-left:1.0pt;padding-right:1.0pt;">5.51</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.4.3.4" style="padding-left:1.0pt;padding-right:1.0pt;">73.88</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.4.3.5" style="padding-left:1.0pt;padding-right:1.0pt;">79.8</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.4.3.6" style="padding-left:1.0pt;padding-right:1.0pt;">52.05</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.4.3.7" style="padding-left:1.0pt;padding-right:1.0pt;">79.42</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.4.3.8" style="padding-left:1.0pt;padding-right:1.0pt;">80.79</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.4.3.9" style="padding-left:1.0pt;padding-right:1.0pt;">73.19</td>
</tr>
<tr class="ltx_tr" id="A8.T19.1.5.4">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_th ltx_th_row" id="A8.T19.1.5.4.1" style="padding-left:1.0pt;padding-right:1.0pt;"></th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.5.4.2" style="padding-left:1.0pt;padding-right:1.0pt;">W4A4KV4</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.5.4.3" style="padding-left:1.0pt;padding-right:1.0pt;">5.79</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.5.4.4" style="padding-left:1.0pt;padding-right:1.0pt;">71.51</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.5.4.5" style="padding-left:1.0pt;padding-right:1.0pt;">78.12</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.5.4.6" style="padding-left:1.0pt;padding-right:1.0pt;">49.66</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.5.4.7" style="padding-left:1.0pt;padding-right:1.0pt;">78.03</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.5.4.8" style="padding-left:1.0pt;padding-right:1.0pt;">79.92</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.5.4.9" style="padding-left:1.0pt;padding-right:1.0pt;">71.45</td>
</tr>
<tr class="ltx_tr" id="A8.T19.1.6.5">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row ltx_border_t" id="A8.T19.1.6.5.1" style="padding-left:1.0pt;padding-right:1.0pt;"><span class="ltx_text" id="A8.T19.1.6.5.1.1">Qwen-2-7B</span></th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A8.T19.1.6.5.2" style="padding-left:1.0pt;padding-right:1.0pt;">FP16</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A8.T19.1.6.5.3" style="padding-left:1.0pt;padding-right:1.0pt;">7.14</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A8.T19.1.6.5.4" style="padding-left:1.0pt;padding-right:1.0pt;">72.3</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A8.T19.1.6.5.5" style="padding-left:1.0pt;padding-right:1.0pt;">78.96</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A8.T19.1.6.5.6" style="padding-left:1.0pt;padding-right:1.0pt;">52.65</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A8.T19.1.6.5.7" style="padding-left:1.0pt;padding-right:1.0pt;">78.75</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A8.T19.1.6.5.8" style="padding-left:1.0pt;padding-right:1.0pt;">80.96</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A8.T19.1.6.5.9" style="padding-left:1.0pt;padding-right:1.0pt;">72.72</td>
</tr>
<tr class="ltx_tr" id="A8.T19.1.7.6">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row" id="A8.T19.1.7.6.1" style="padding-left:1.0pt;padding-right:1.0pt;">
<span class="ltx_ERROR undefined" id="A8.T19.1.7.6.1.1">\cdashline</span>2-9</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.7.6.2" style="padding-left:1.0pt;padding-right:1.0pt;">W8A8KV8</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.7.6.3" style="padding-left:1.0pt;padding-right:1.0pt;">7.15</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.7.6.4" style="padding-left:1.0pt;padding-right:1.0pt;">72.22</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.7.6.5" style="padding-left:1.0pt;padding-right:1.0pt;">78.88</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.7.6.6" style="padding-left:1.0pt;padding-right:1.0pt;">52.9</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.7.6.7" style="padding-left:1.0pt;padding-right:1.0pt;">78.49</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.7.6.8" style="padding-left:1.0pt;padding-right:1.0pt;">80.85</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.7.6.9" style="padding-left:1.0pt;padding-right:1.0pt;">72.67</td>
</tr>
<tr class="ltx_tr" id="A8.T19.1.8.7">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_th ltx_th_row" id="A8.T19.1.8.7.1" style="padding-left:1.0pt;padding-right:1.0pt;"></th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.8.7.2" style="padding-left:1.0pt;padding-right:1.0pt;">W4A8KV4</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.8.7.3" style="padding-left:1.0pt;padding-right:1.0pt;">8.04</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.8.7.4" style="padding-left:1.0pt;padding-right:1.0pt;">71.43</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.8.7.5" style="padding-left:1.0pt;padding-right:1.0pt;">76.77</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.8.7.6" style="padding-left:1.0pt;padding-right:1.0pt;">53.67</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.8.7.7" style="padding-left:1.0pt;padding-right:1.0pt;">77.95</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.8.7.8" style="padding-left:1.0pt;padding-right:1.0pt;">78.45</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.8.7.9" style="padding-left:1.0pt;padding-right:1.0pt;">71.65</td>
</tr>
<tr class="ltx_tr" id="A8.T19.1.9.8">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_th ltx_th_row" id="A8.T19.1.9.8.1" style="padding-left:1.0pt;padding-right:1.0pt;"></th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.9.8.2" style="padding-left:1.0pt;padding-right:1.0pt;">W4A4KV4</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.9.8.3" style="padding-left:1.0pt;padding-right:1.0pt;">8.37</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.9.8.4" style="padding-left:1.0pt;padding-right:1.0pt;">68.75</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.9.8.5" style="padding-left:1.0pt;padding-right:1.0pt;">74.92</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.9.8.6" style="padding-left:1.0pt;padding-right:1.0pt;">48.21</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.9.8.7" style="padding-left:1.0pt;padding-right:1.0pt;">74.75</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.9.8.8" style="padding-left:1.0pt;padding-right:1.0pt;">79.49</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.9.8.9" style="padding-left:1.0pt;padding-right:1.0pt;">69.22</td>
</tr>
<tr class="ltx_tr" id="A8.T19.1.10.9">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row ltx_border_t" id="A8.T19.1.10.9.1" style="padding-left:1.0pt;padding-right:1.0pt;"><span class="ltx_text" id="A8.T19.1.10.9.1.1">Llama-3-8B-Instruct</span></th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A8.T19.1.10.9.2" style="padding-left:1.0pt;padding-right:1.0pt;">FP16</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A8.T19.1.10.9.3" style="padding-left:1.0pt;padding-right:1.0pt;">8.29</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A8.T19.1.10.9.4" style="padding-left:1.0pt;padding-right:1.0pt;">71.82</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A8.T19.1.10.9.5" style="padding-left:1.0pt;padding-right:1.0pt;">75.81</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A8.T19.1.10.9.6" style="padding-left:1.0pt;padding-right:1.0pt;">56.83</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A8.T19.1.10.9.7" style="padding-left:1.0pt;padding-right:1.0pt;">79.76</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A8.T19.1.10.9.8" style="padding-left:1.0pt;padding-right:1.0pt;">78.51</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A8.T19.1.10.9.9" style="padding-left:1.0pt;padding-right:1.0pt;">72.55</td>
</tr>
<tr class="ltx_tr" id="A8.T19.1.11.10">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row" id="A8.T19.1.11.10.1" style="padding-left:1.0pt;padding-right:1.0pt;">
<span class="ltx_ERROR undefined" id="A8.T19.1.11.10.1.1">\cdashline</span>2-9</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.11.10.2" style="padding-left:1.0pt;padding-right:1.0pt;">W8A8KV8</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.11.10.3" style="padding-left:1.0pt;padding-right:1.0pt;">8.21</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.11.10.4" style="padding-left:1.0pt;padding-right:1.0pt;">71.35</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.11.10.5" style="padding-left:1.0pt;padding-right:1.0pt;">75.54</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.11.10.6" style="padding-left:1.0pt;padding-right:1.0pt;">56.31</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.11.10.7" style="padding-left:1.0pt;padding-right:1.0pt;">78.75</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.11.10.8" style="padding-left:1.0pt;padding-right:1.0pt;">79.16</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.11.10.9" style="padding-left:1.0pt;padding-right:1.0pt;">72.22</td>
</tr>
<tr class="ltx_tr" id="A8.T19.1.12.11">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_th ltx_th_row" id="A8.T19.1.12.11.1" style="padding-left:1.0pt;padding-right:1.0pt;"></th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.12.11.2" style="padding-left:1.0pt;padding-right:1.0pt;">W4A8KV4</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.12.11.3" style="padding-left:1.0pt;padding-right:1.0pt;">8.74</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.12.11.4" style="padding-left:1.0pt;padding-right:1.0pt;">70.17</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.12.11.5" style="padding-left:1.0pt;padding-right:1.0pt;">74.6</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.12.11.6" style="padding-left:1.0pt;padding-right:1.0pt;">54.44</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.12.11.7" style="padding-left:1.0pt;padding-right:1.0pt;">77.65</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.12.11.8" style="padding-left:1.0pt;padding-right:1.0pt;">77.97</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.12.11.9" style="padding-left:1.0pt;padding-right:1.0pt;">70.97</td>
</tr>
<tr class="ltx_tr" id="A8.T19.1.13.12">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_th ltx_th_row" id="A8.T19.1.13.12.1" style="padding-left:1.0pt;padding-right:1.0pt;"></th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.13.12.2" style="padding-left:1.0pt;padding-right:1.0pt;">W4A4KV4</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.13.12.3" style="padding-left:1.0pt;padding-right:1.0pt;">8.96</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.13.12.4" style="padding-left:1.0pt;padding-right:1.0pt;">69.53</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.13.12.5" style="padding-left:1.0pt;padding-right:1.0pt;">74.66</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.13.12.6" style="padding-left:1.0pt;padding-right:1.0pt;">52.65</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.13.12.7" style="padding-left:1.0pt;padding-right:1.0pt;">76.35</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.13.12.8" style="padding-left:1.0pt;padding-right:1.0pt;">76.66</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.13.12.9" style="padding-left:1.0pt;padding-right:1.0pt;">69.97</td>
</tr>
<tr class="ltx_tr" id="A8.T19.1.14.13">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row ltx_border_t" id="A8.T19.1.14.13.1" style="padding-left:1.0pt;padding-right:1.0pt;"><span class="ltx_text" id="A8.T19.1.14.13.1.1">Llama-3-70B-Instruct</span></th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A8.T19.1.14.13.2" style="padding-left:1.0pt;padding-right:1.0pt;">FP16</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A8.T19.1.14.13.3" style="padding-left:1.0pt;padding-right:1.0pt;">5.33</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A8.T19.1.14.13.4" style="padding-left:1.0pt;padding-right:1.0pt;">75.69</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A8.T19.1.14.13.5" style="padding-left:1.0pt;padding-right:1.0pt;">82.58</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A8.T19.1.14.13.6" style="padding-left:1.0pt;padding-right:1.0pt;">64.42</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A8.T19.1.14.13.7" style="padding-left:1.0pt;padding-right:1.0pt;">84.97</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A8.T19.1.14.13.8" style="padding-left:1.0pt;padding-right:1.0pt;">82.15</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A8.T19.1.14.13.9" style="padding-left:1.0pt;padding-right:1.0pt;">77.96</td>
</tr>
<tr class="ltx_tr" id="A8.T19.1.15.14">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row" id="A8.T19.1.15.14.1" style="padding-left:1.0pt;padding-right:1.0pt;">
<span class="ltx_ERROR undefined" id="A8.T19.1.15.14.1.1">\cdashline</span>2-9</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.15.14.2" style="padding-left:1.0pt;padding-right:1.0pt;">W8A8KV8</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.15.14.3" style="padding-left:1.0pt;padding-right:1.0pt;">5.40</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.15.14.4" style="padding-left:1.0pt;padding-right:1.0pt;">78.06</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.15.14.5" style="padding-left:1.0pt;padding-right:1.0pt;">82.67</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.15.14.6" style="padding-left:1.0pt;padding-right:1.0pt;">66.72</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.15.14.7" style="padding-left:1.0pt;padding-right:1.0pt;">84.89</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.15.14.8" style="padding-left:1.0pt;padding-right:1.0pt;">82.21</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.15.14.9" style="padding-left:1.0pt;padding-right:1.0pt;">78.91</td>
</tr>
<tr class="ltx_tr" id="A8.T19.1.16.15">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_th ltx_th_row" id="A8.T19.1.16.15.1" style="padding-left:1.0pt;padding-right:1.0pt;"></th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.16.15.2" style="padding-left:1.0pt;padding-right:1.0pt;">W4A8KV4</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.16.15.3" style="padding-left:1.0pt;padding-right:1.0pt;">5.96</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.16.15.4" style="padding-left:1.0pt;padding-right:1.0pt;">77.74</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.16.15.5" style="padding-left:1.0pt;padding-right:1.0pt;">81.97</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.16.15.6" style="padding-left:1.0pt;padding-right:1.0pt;">65.87</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.16.15.7" style="padding-left:1.0pt;padding-right:1.0pt;">84.93</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.16.15.8" style="padding-left:1.0pt;padding-right:1.0pt;">81.56</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A8.T19.1.16.15.9" style="padding-left:1.0pt;padding-right:1.0pt;">78.41</td>
</tr>
<tr class="ltx_tr" id="A8.T19.1.17.16">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_th ltx_th_row ltx_border_b" id="A8.T19.1.17.16.1" style="padding-left:1.0pt;padding-right:1.0pt;"></th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_b" id="A8.T19.1.17.16.2" style="padding-left:1.0pt;padding-right:1.0pt;">W4A4KV4</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_b" id="A8.T19.1.17.16.3" style="padding-left:1.0pt;padding-right:1.0pt;">6.80</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_b" id="A8.T19.1.17.16.4" style="padding-left:1.0pt;padding-right:1.0pt;">75.93</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_b" id="A8.T19.1.17.16.5" style="padding-left:1.0pt;padding-right:1.0pt;">80.64</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_b" id="A8.T19.1.17.16.6" style="padding-left:1.0pt;padding-right:1.0pt;">64.76</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_b" id="A8.T19.1.17.16.7" style="padding-left:1.0pt;padding-right:1.0pt;">83.88</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_b" id="A8.T19.1.17.16.8" style="padding-left:1.0pt;padding-right:1.0pt;">81.23</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_b" id="A8.T19.1.17.16.9" style="padding-left:1.0pt;padding-right:1.0pt;">77.29</td>
</tr>
</tbody>
</table>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="A8.F7">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A8.F7.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="448" id="A8.F7.sf1.g1" src="https://arxiv.org/html/2410.05265v1/x14.png" width="761">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span>Llama-2-13B</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A8.F7.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="448" id="A8.F7.sf2.g1" src="https://arxiv.org/html/2410.05265v1/x15.png" width="761">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span>Llama-2-70B</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A8.F7.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="448" id="A8.F7.sf3.g1" src="https://arxiv.org/html/2410.05265v1/x16.png" width="761">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(c) </span>Llama-3-70B</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A8.F7.sf4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="448" id="A8.F7.sf4.g1" src="https://arxiv.org/html/2410.05265v1/x17.png" width="761">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(d) </span>Mistral-7B-v0.3</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span><span class="ltx_text ltx_font_bold" id="A8.F7.2.1">Content of outlier tokens in different models.</span> Note that we do not count the outlier tokens situated at the initial token.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
</section>
<section class="ltx_appendix" id="A9">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix I </span>More Visualizations</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsection" id="A9.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">I.1 </span>Outlier Token</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A9.SS1.p1">
<p class="ltx_p" id="A9.SS1.p1.1">In Figure&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A8.F7" title="Figure 7 ‣ H.3 Results on More Models ‣ Appendix H Full Results of Weight-Activation quantization ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">7</span></a>, we showcase the four most frequently occurring outlier tokens in Llama-2-{13B,70B}, Llama-3-70B, and Mistral-7B-v0.3.
Specifically, Table&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#S5.T1" title="Table 1 ‣ 5.1 Prefixed Outliers ‣ 5 PrefixQuant ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">1</span></a> selects the top-<math alttext="o" class="ltx_Math" display="inline" id="A9.SS1.p1.1.m1.1"><semantics id="A9.SS1.p1.1.m1.1a"><mi id="A9.SS1.p1.1.m1.1.1" xref="A9.SS1.p1.1.m1.1.1.cmml">o</mi><annotation-xml encoding="MathML-Content" id="A9.SS1.p1.1.m1.1b"><ci id="A9.SS1.p1.1.m1.1.1.cmml" xref="A9.SS1.p1.1.m1.1.1">𝑜</ci></annotation-xml><annotation encoding="application/x-tex" id="A9.SS1.p1.1.m1.1c">o</annotation><annotation encoding="application/x-llamapun" id="A9.SS1.p1.1.m1.1d">italic_o</annotation></semantics></math> high-frequent outlier tokens as the prefixed tokens.
It is important to note that we do not visualize the outlier tokens in Llama-3-8B and Qwen-2-7B because all the outlier tokens in these two models appear in the initial tokens.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="A9.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">I.2 </span>Magnitude Distribution</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para ltx_noindent" id="A9.SS2.p1">
<p class="ltx_p" id="A9.SS2.p1.1">We illustrate more token-wise maximum values distribution of other models. Details are as follows:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul class="ltx_itemize" id="A9.I1">
<li class="ltx_item" id="A9.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A9.I1.i1.p1">
<p class="ltx_p" id="A9.I1.i1.p1.3"><span class="ltx_text ltx_font_bold" id="A9.I1.i1.p1.3.1">Llama-2-13B</span>: Figure&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A9.F8" title="Figure 8 ‣ I.2 Magnitude Distribution ‣ Appendix I More Visualizations ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">8</span></a> and Figure&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A9.F9" title="Figure 9 ‣ I.2 Magnitude Distribution ‣ Appendix I More Visualizations ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">9</span></a> illustrate the distribution of input activation and <math alttext="\mathbf{Q}" class="ltx_Math" display="inline" id="A9.I1.i1.p1.1.m1.1"><semantics id="A9.I1.i1.p1.1.m1.1a"><mi id="A9.I1.i1.p1.1.m1.1.1" xref="A9.I1.i1.p1.1.m1.1.1.cmml">𝐐</mi><annotation-xml encoding="MathML-Content" id="A9.I1.i1.p1.1.m1.1b"><ci id="A9.I1.i1.p1.1.m1.1.1.cmml" xref="A9.I1.i1.p1.1.m1.1.1">𝐐</ci></annotation-xml><annotation encoding="application/x-tex" id="A9.I1.i1.p1.1.m1.1c">\mathbf{Q}</annotation><annotation encoding="application/x-llamapun" id="A9.I1.i1.p1.1.m1.1d">bold_Q</annotation></semantics></math>/<math alttext="\mathbf{K}" class="ltx_Math" display="inline" id="A9.I1.i1.p1.2.m2.1"><semantics id="A9.I1.i1.p1.2.m2.1a"><mi id="A9.I1.i1.p1.2.m2.1.1" xref="A9.I1.i1.p1.2.m2.1.1.cmml">𝐊</mi><annotation-xml encoding="MathML-Content" id="A9.I1.i1.p1.2.m2.1b"><ci id="A9.I1.i1.p1.2.m2.1.1.cmml" xref="A9.I1.i1.p1.2.m2.1.1">𝐊</ci></annotation-xml><annotation encoding="application/x-tex" id="A9.I1.i1.p1.2.m2.1c">\mathbf{K}</annotation><annotation encoding="application/x-llamapun" id="A9.I1.i1.p1.2.m2.1d">bold_K</annotation></semantics></math>/<math alttext="\mathbf{V}" class="ltx_Math" display="inline" id="A9.I1.i1.p1.3.m3.1"><semantics id="A9.I1.i1.p1.3.m3.1a"><mi id="A9.I1.i1.p1.3.m3.1.1" xref="A9.I1.i1.p1.3.m3.1.1.cmml">𝐕</mi><annotation-xml encoding="MathML-Content" id="A9.I1.i1.p1.3.m3.1b"><ci id="A9.I1.i1.p1.3.m3.1.1.cmml" xref="A9.I1.i1.p1.3.m3.1.1">𝐕</ci></annotation-xml><annotation encoding="application/x-tex" id="A9.I1.i1.p1.3.m3.1c">\mathbf{V}</annotation><annotation encoding="application/x-llamapun" id="A9.I1.i1.p1.3.m3.1d">bold_V</annotation></semantics></math>, respectively.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A9.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A9.I1.i2.p1">
<p class="ltx_p" id="A9.I1.i2.p1.3"><span class="ltx_text ltx_font_bold" id="A9.I1.i2.p1.3.1">Llama-3-8B</span>: Figure&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A9.F10" title="Figure 10 ‣ I.2 Magnitude Distribution ‣ Appendix I More Visualizations ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">10</span></a> and Figure&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A9.F11" title="Figure 11 ‣ I.2 Magnitude Distribution ‣ Appendix I More Visualizations ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">11</span></a> illustrate the distribution of input activation and <math alttext="\mathbf{Q}" class="ltx_Math" display="inline" id="A9.I1.i2.p1.1.m1.1"><semantics id="A9.I1.i2.p1.1.m1.1a"><mi id="A9.I1.i2.p1.1.m1.1.1" xref="A9.I1.i2.p1.1.m1.1.1.cmml">𝐐</mi><annotation-xml encoding="MathML-Content" id="A9.I1.i2.p1.1.m1.1b"><ci id="A9.I1.i2.p1.1.m1.1.1.cmml" xref="A9.I1.i2.p1.1.m1.1.1">𝐐</ci></annotation-xml><annotation encoding="application/x-tex" id="A9.I1.i2.p1.1.m1.1c">\mathbf{Q}</annotation><annotation encoding="application/x-llamapun" id="A9.I1.i2.p1.1.m1.1d">bold_Q</annotation></semantics></math>/<math alttext="\mathbf{K}" class="ltx_Math" display="inline" id="A9.I1.i2.p1.2.m2.1"><semantics id="A9.I1.i2.p1.2.m2.1a"><mi id="A9.I1.i2.p1.2.m2.1.1" xref="A9.I1.i2.p1.2.m2.1.1.cmml">𝐊</mi><annotation-xml encoding="MathML-Content" id="A9.I1.i2.p1.2.m2.1b"><ci id="A9.I1.i2.p1.2.m2.1.1.cmml" xref="A9.I1.i2.p1.2.m2.1.1">𝐊</ci></annotation-xml><annotation encoding="application/x-tex" id="A9.I1.i2.p1.2.m2.1c">\mathbf{K}</annotation><annotation encoding="application/x-llamapun" id="A9.I1.i2.p1.2.m2.1d">bold_K</annotation></semantics></math>/<math alttext="\mathbf{V}" class="ltx_Math" display="inline" id="A9.I1.i2.p1.3.m3.1"><semantics id="A9.I1.i2.p1.3.m3.1a"><mi id="A9.I1.i2.p1.3.m3.1.1" xref="A9.I1.i2.p1.3.m3.1.1.cmml">𝐕</mi><annotation-xml encoding="MathML-Content" id="A9.I1.i2.p1.3.m3.1b"><ci id="A9.I1.i2.p1.3.m3.1.1.cmml" xref="A9.I1.i2.p1.3.m3.1.1">𝐕</ci></annotation-xml><annotation encoding="application/x-tex" id="A9.I1.i2.p1.3.m3.1c">\mathbf{V}</annotation><annotation encoding="application/x-llamapun" id="A9.I1.i2.p1.3.m3.1d">bold_V</annotation></semantics></math>, respectively.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A9.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A9.I1.i3.p1">
<p class="ltx_p" id="A9.I1.i3.p1.3"><span class="ltx_text ltx_font_bold" id="A9.I1.i3.p1.3.1">Llama-3-70B</span>: Figure&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A9.F12" title="Figure 12 ‣ I.2 Magnitude Distribution ‣ Appendix I More Visualizations ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">12</span></a> and Figure&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A9.F13" title="Figure 13 ‣ I.2 Magnitude Distribution ‣ Appendix I More Visualizations ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">13</span></a> illustrate the distribution of input activation and <math alttext="\mathbf{Q}" class="ltx_Math" display="inline" id="A9.I1.i3.p1.1.m1.1"><semantics id="A9.I1.i3.p1.1.m1.1a"><mi id="A9.I1.i3.p1.1.m1.1.1" xref="A9.I1.i3.p1.1.m1.1.1.cmml">𝐐</mi><annotation-xml encoding="MathML-Content" id="A9.I1.i3.p1.1.m1.1b"><ci id="A9.I1.i3.p1.1.m1.1.1.cmml" xref="A9.I1.i3.p1.1.m1.1.1">𝐐</ci></annotation-xml><annotation encoding="application/x-tex" id="A9.I1.i3.p1.1.m1.1c">\mathbf{Q}</annotation><annotation encoding="application/x-llamapun" id="A9.I1.i3.p1.1.m1.1d">bold_Q</annotation></semantics></math>/<math alttext="\mathbf{K}" class="ltx_Math" display="inline" id="A9.I1.i3.p1.2.m2.1"><semantics id="A9.I1.i3.p1.2.m2.1a"><mi id="A9.I1.i3.p1.2.m2.1.1" xref="A9.I1.i3.p1.2.m2.1.1.cmml">𝐊</mi><annotation-xml encoding="MathML-Content" id="A9.I1.i3.p1.2.m2.1b"><ci id="A9.I1.i3.p1.2.m2.1.1.cmml" xref="A9.I1.i3.p1.2.m2.1.1">𝐊</ci></annotation-xml><annotation encoding="application/x-tex" id="A9.I1.i3.p1.2.m2.1c">\mathbf{K}</annotation><annotation encoding="application/x-llamapun" id="A9.I1.i3.p1.2.m2.1d">bold_K</annotation></semantics></math>/<math alttext="\mathbf{V}" class="ltx_Math" display="inline" id="A9.I1.i3.p1.3.m3.1"><semantics id="A9.I1.i3.p1.3.m3.1a"><mi id="A9.I1.i3.p1.3.m3.1.1" xref="A9.I1.i3.p1.3.m3.1.1.cmml">𝐕</mi><annotation-xml encoding="MathML-Content" id="A9.I1.i3.p1.3.m3.1b"><ci id="A9.I1.i3.p1.3.m3.1.1.cmml" xref="A9.I1.i3.p1.3.m3.1.1">𝐕</ci></annotation-xml><annotation encoding="application/x-tex" id="A9.I1.i3.p1.3.m3.1c">\mathbf{V}</annotation><annotation encoding="application/x-llamapun" id="A9.I1.i3.p1.3.m3.1d">bold_V</annotation></semantics></math>, respectively.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A9.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A9.I1.i4.p1">
<p class="ltx_p" id="A9.I1.i4.p1.3"><span class="ltx_text ltx_font_bold" id="A9.I1.i4.p1.3.1">Qwen-2-7B</span>: Figure&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A9.F14" title="Figure 14 ‣ I.2 Magnitude Distribution ‣ Appendix I More Visualizations ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">14</span></a> and Figure&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A9.F15" title="Figure 15 ‣ I.2 Magnitude Distribution ‣ Appendix I More Visualizations ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">15</span></a> illustrate the distribution of input activation and <math alttext="\mathbf{Q}" class="ltx_Math" display="inline" id="A9.I1.i4.p1.1.m1.1"><semantics id="A9.I1.i4.p1.1.m1.1a"><mi id="A9.I1.i4.p1.1.m1.1.1" xref="A9.I1.i4.p1.1.m1.1.1.cmml">𝐐</mi><annotation-xml encoding="MathML-Content" id="A9.I1.i4.p1.1.m1.1b"><ci id="A9.I1.i4.p1.1.m1.1.1.cmml" xref="A9.I1.i4.p1.1.m1.1.1">𝐐</ci></annotation-xml><annotation encoding="application/x-tex" id="A9.I1.i4.p1.1.m1.1c">\mathbf{Q}</annotation><annotation encoding="application/x-llamapun" id="A9.I1.i4.p1.1.m1.1d">bold_Q</annotation></semantics></math>/<math alttext="\mathbf{K}" class="ltx_Math" display="inline" id="A9.I1.i4.p1.2.m2.1"><semantics id="A9.I1.i4.p1.2.m2.1a"><mi id="A9.I1.i4.p1.2.m2.1.1" xref="A9.I1.i4.p1.2.m2.1.1.cmml">𝐊</mi><annotation-xml encoding="MathML-Content" id="A9.I1.i4.p1.2.m2.1b"><ci id="A9.I1.i4.p1.2.m2.1.1.cmml" xref="A9.I1.i4.p1.2.m2.1.1">𝐊</ci></annotation-xml><annotation encoding="application/x-tex" id="A9.I1.i4.p1.2.m2.1c">\mathbf{K}</annotation><annotation encoding="application/x-llamapun" id="A9.I1.i4.p1.2.m2.1d">bold_K</annotation></semantics></math>/<math alttext="\mathbf{V}" class="ltx_Math" display="inline" id="A9.I1.i4.p1.3.m3.1"><semantics id="A9.I1.i4.p1.3.m3.1a"><mi id="A9.I1.i4.p1.3.m3.1.1" xref="A9.I1.i4.p1.3.m3.1.1.cmml">𝐕</mi><annotation-xml encoding="MathML-Content" id="A9.I1.i4.p1.3.m3.1b"><ci id="A9.I1.i4.p1.3.m3.1.1.cmml" xref="A9.I1.i4.p1.3.m3.1.1">𝐕</ci></annotation-xml><annotation encoding="application/x-tex" id="A9.I1.i4.p1.3.m3.1c">\mathbf{V}</annotation><annotation encoding="application/x-llamapun" id="A9.I1.i4.p1.3.m3.1d">bold_V</annotation></semantics></math>, respectively.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="A9.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="A9.I1.i5.p1">
<p class="ltx_p" id="A9.I1.i5.p1.3"><span class="ltx_text ltx_font_bold" id="A9.I1.i5.p1.3.1">Mistral-7B-v0.3</span>: Figure&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A9.F16" title="Figure 16 ‣ I.2 Magnitude Distribution ‣ Appendix I More Visualizations ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">16</span></a> and Figure&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A9.F17" title="Figure 17 ‣ I.2 Magnitude Distribution ‣ Appendix I More Visualizations ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">17</span></a> illustrate the distribution of input activation and <math alttext="\mathbf{Q}" class="ltx_Math" display="inline" id="A9.I1.i5.p1.1.m1.1"><semantics id="A9.I1.i5.p1.1.m1.1a"><mi id="A9.I1.i5.p1.1.m1.1.1" xref="A9.I1.i5.p1.1.m1.1.1.cmml">𝐐</mi><annotation-xml encoding="MathML-Content" id="A9.I1.i5.p1.1.m1.1b"><ci id="A9.I1.i5.p1.1.m1.1.1.cmml" xref="A9.I1.i5.p1.1.m1.1.1">𝐐</ci></annotation-xml><annotation encoding="application/x-tex" id="A9.I1.i5.p1.1.m1.1c">\mathbf{Q}</annotation><annotation encoding="application/x-llamapun" id="A9.I1.i5.p1.1.m1.1d">bold_Q</annotation></semantics></math>/<math alttext="\mathbf{K}" class="ltx_Math" display="inline" id="A9.I1.i5.p1.2.m2.1"><semantics id="A9.I1.i5.p1.2.m2.1a"><mi id="A9.I1.i5.p1.2.m2.1.1" xref="A9.I1.i5.p1.2.m2.1.1.cmml">𝐊</mi><annotation-xml encoding="MathML-Content" id="A9.I1.i5.p1.2.m2.1b"><ci id="A9.I1.i5.p1.2.m2.1.1.cmml" xref="A9.I1.i5.p1.2.m2.1.1">𝐊</ci></annotation-xml><annotation encoding="application/x-tex" id="A9.I1.i5.p1.2.m2.1c">\mathbf{K}</annotation><annotation encoding="application/x-llamapun" id="A9.I1.i5.p1.2.m2.1d">bold_K</annotation></semantics></math>/<math alttext="\mathbf{V}" class="ltx_Math" display="inline" id="A9.I1.i5.p1.3.m3.1"><semantics id="A9.I1.i5.p1.3.m3.1a"><mi id="A9.I1.i5.p1.3.m3.1.1" xref="A9.I1.i5.p1.3.m3.1.1.cmml">𝐕</mi><annotation-xml encoding="MathML-Content" id="A9.I1.i5.p1.3.m3.1b"><ci id="A9.I1.i5.p1.3.m3.1.1.cmml" xref="A9.I1.i5.p1.3.m3.1.1">𝐕</ci></annotation-xml><annotation encoding="application/x-tex" id="A9.I1.i5.p1.3.m3.1c">\mathbf{V}</annotation><annotation encoding="application/x-llamapun" id="A9.I1.i5.p1.3.m3.1d">bold_V</annotation></semantics></math>, respectively.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ul>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
<figure class="ltx_figure" id="A9.F8">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A9.F8.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="142" id="A9.F8.sf1.g1" src="https://arxiv.org/html/2410.05265v1/x18.png" width="685">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span>Original distribution</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A9.F8.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="125" id="A9.F8.sf2.g1" src="https://arxiv.org/html/2410.05265v1/x19.png" width="685">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span>Rotation</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A9.F8.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="125" id="A9.F8.sf3.g1" src="https://arxiv.org/html/2410.05265v1/x20.png" width="685">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(c) </span>PrefixQuant (ours)</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span><span class="ltx_text ltx_font_bold" id="A9.F8.2.1">Distribution of token-wise maximum values for linear layers inputs in Llama-2-13b.</span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="A9.F9">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A9.F9.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="157" id="A9.F9.sf1.g1" src="https://arxiv.org/html/2410.05265v1/x21.png" width="571">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span>Original distribution</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A9.F9.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="137" id="A9.F9.sf2.g1" src="https://arxiv.org/html/2410.05265v1/x22.png" width="571">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span>Rotation</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A9.F9.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="135" id="A9.F9.sf3.g1" src="https://arxiv.org/html/2410.05265v1/x23.png" width="571">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(c) </span>PrefixQuant (ours)</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span><span class="ltx_text ltx_font_bold" id="A9.F9.6.3">Distribution of token-wise maximum values for <math alttext="\mathbf{Q}" class="ltx_Math" display="inline" id="A9.F9.4.1.m1.1"><semantics id="A9.F9.4.1.m1.1b"><mi id="A9.F9.4.1.m1.1.1" xref="A9.F9.4.1.m1.1.1.cmml">𝐐</mi><annotation-xml encoding="MathML-Content" id="A9.F9.4.1.m1.1c"><ci id="A9.F9.4.1.m1.1.1.cmml" xref="A9.F9.4.1.m1.1.1">𝐐</ci></annotation-xml><annotation encoding="application/x-tex" id="A9.F9.4.1.m1.1d">\mathbf{Q}</annotation><annotation encoding="application/x-llamapun" id="A9.F9.4.1.m1.1e">bold_Q</annotation></semantics></math>/<math alttext="\mathbf{K}" class="ltx_Math" display="inline" id="A9.F9.5.2.m2.1"><semantics id="A9.F9.5.2.m2.1b"><mi id="A9.F9.5.2.m2.1.1" xref="A9.F9.5.2.m2.1.1.cmml">𝐊</mi><annotation-xml encoding="MathML-Content" id="A9.F9.5.2.m2.1c"><ci id="A9.F9.5.2.m2.1.1.cmml" xref="A9.F9.5.2.m2.1.1">𝐊</ci></annotation-xml><annotation encoding="application/x-tex" id="A9.F9.5.2.m2.1d">\mathbf{K}</annotation><annotation encoding="application/x-llamapun" id="A9.F9.5.2.m2.1e">bold_K</annotation></semantics></math>/<math alttext="\mathbf{V}" class="ltx_Math" display="inline" id="A9.F9.6.3.m3.1"><semantics id="A9.F9.6.3.m3.1b"><mi id="A9.F9.6.3.m3.1.1" xref="A9.F9.6.3.m3.1.1.cmml">𝐕</mi><annotation-xml encoding="MathML-Content" id="A9.F9.6.3.m3.1c"><ci id="A9.F9.6.3.m3.1.1.cmml" xref="A9.F9.6.3.m3.1.1">𝐕</ci></annotation-xml><annotation encoding="application/x-tex" id="A9.F9.6.3.m3.1d">\mathbf{V}</annotation><annotation encoding="application/x-llamapun" id="A9.F9.6.3.m3.1e">bold_V</annotation></semantics></math> in Llama-2-13b.</span> Same present rules as Figure &nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2410.05265v1#A9.F8.sf1" title="In Figure 8 ‣ I.2 Magnitude Distribution ‣ Appendix I More Visualizations ‣ PrefixQuant: Static Quantization Beats Dynamic through Prefixed Outliers in LLMs"><span class="ltx_text ltx_ref_tag">8(a)</span></a> except that ratios greater than 5 are marked with red.</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="A9.F10">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A9.F10.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="142" id="A9.F10.sf1.g1" src="https://arxiv.org/html/2410.05265v1/x24.png" width="685">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span>Original distribution</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A9.F10.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="125" id="A9.F10.sf2.g1" src="https://arxiv.org/html/2410.05265v1/x25.png" width="685">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span>Rotation</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A9.F10.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="123" id="A9.F10.sf3.g1" src="https://arxiv.org/html/2410.05265v1/x26.png" width="685">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(c) </span>PrefixQuant (ours)</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span><span class="ltx_text ltx_font_bold" id="A9.F10.2.1">Distribution of token-wise maximum values for linear layers inputs in Llama-3-8b.</span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="A9.F11">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A9.F11.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="157" id="A9.F11.sf1.g1" src="https://arxiv.org/html/2410.05265v1/x27.png" width="571">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span>Original distribution</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A9.F11.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="137" id="A9.F11.sf2.g1" src="https://arxiv.org/html/2410.05265v1/x28.png" width="571">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span>Rotation</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A9.F11.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="137" id="A9.F11.sf3.g1" src="https://arxiv.org/html/2410.05265v1/x29.png" width="571">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(c) </span>PrefixQuant (ours)</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 11: </span><span class="ltx_text ltx_font_bold" id="A9.F11.6.3">Distribution of token-wise maximum values for <math alttext="\mathbf{Q}" class="ltx_Math" display="inline" id="A9.F11.4.1.m1.1"><semantics id="A9.F11.4.1.m1.1b"><mi id="A9.F11.4.1.m1.1.1" xref="A9.F11.4.1.m1.1.1.cmml">𝐐</mi><annotation-xml encoding="MathML-Content" id="A9.F11.4.1.m1.1c"><ci id="A9.F11.4.1.m1.1.1.cmml" xref="A9.F11.4.1.m1.1.1">𝐐</ci></annotation-xml><annotation encoding="application/x-tex" id="A9.F11.4.1.m1.1d">\mathbf{Q}</annotation><annotation encoding="application/x-llamapun" id="A9.F11.4.1.m1.1e">bold_Q</annotation></semantics></math>/<math alttext="\mathbf{K}" class="ltx_Math" display="inline" id="A9.F11.5.2.m2.1"><semantics id="A9.F11.5.2.m2.1b"><mi id="A9.F11.5.2.m2.1.1" xref="A9.F11.5.2.m2.1.1.cmml">𝐊</mi><annotation-xml encoding="MathML-Content" id="A9.F11.5.2.m2.1c"><ci id="A9.F11.5.2.m2.1.1.cmml" xref="A9.F11.5.2.m2.1.1">𝐊</ci></annotation-xml><annotation encoding="application/x-tex" id="A9.F11.5.2.m2.1d">\mathbf{K}</annotation><annotation encoding="application/x-llamapun" id="A9.F11.5.2.m2.1e">bold_K</annotation></semantics></math>/<math alttext="\mathbf{V}" class="ltx_Math" display="inline" id="A9.F11.6.3.m3.1"><semantics id="A9.F11.6.3.m3.1b"><mi id="A9.F11.6.3.m3.1.1" xref="A9.F11.6.3.m3.1.1.cmml">𝐕</mi><annotation-xml encoding="MathML-Content" id="A9.F11.6.3.m3.1c"><ci id="A9.F11.6.3.m3.1.1.cmml" xref="A9.F11.6.3.m3.1.1">𝐕</ci></annotation-xml><annotation encoding="application/x-tex" id="A9.F11.6.3.m3.1d">\mathbf{V}</annotation><annotation encoding="application/x-llamapun" id="A9.F11.6.3.m3.1e">bold_V</annotation></semantics></math> in Llama-3-8B.</span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="A9.F12">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A9.F12.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="142" id="A9.F12.sf1.g1" src="https://arxiv.org/html/2410.05265v1/x30.png" width="685">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span>Original distribution</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A9.F12.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="125" id="A9.F12.sf2.g1" src="https://arxiv.org/html/2410.05265v1/x31.png" width="685">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span>Rotation</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A9.F12.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="123" id="A9.F12.sf3.g1" src="https://arxiv.org/html/2410.05265v1/x32.png" width="685">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(c) </span>PrefixQuant (ours)</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 12: </span><span class="ltx_text ltx_font_bold" id="A9.F12.2.1">Distribution of token-wise maximum values for linear layers inputs in Llama-3-70B.</span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="A9.F13">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A9.F13.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="157" id="A9.F13.sf1.g1" src="https://arxiv.org/html/2410.05265v1/x33.png" width="571">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span>Original distribution</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A9.F13.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="137" id="A9.F13.sf2.g1" src="https://arxiv.org/html/2410.05265v1/x34.png" width="571">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span>Rotation</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A9.F13.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="137" id="A9.F13.sf3.g1" src="https://arxiv.org/html/2410.05265v1/x35.png" width="571">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(c) </span>PrefixQuant (ours)</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 13: </span><span class="ltx_text ltx_font_bold" id="A9.F13.6.3">Distribution of token-wise maximum values for <math alttext="\mathbf{Q}" class="ltx_Math" display="inline" id="A9.F13.4.1.m1.1"><semantics id="A9.F13.4.1.m1.1b"><mi id="A9.F13.4.1.m1.1.1" xref="A9.F13.4.1.m1.1.1.cmml">𝐐</mi><annotation-xml encoding="MathML-Content" id="A9.F13.4.1.m1.1c"><ci id="A9.F13.4.1.m1.1.1.cmml" xref="A9.F13.4.1.m1.1.1">𝐐</ci></annotation-xml><annotation encoding="application/x-tex" id="A9.F13.4.1.m1.1d">\mathbf{Q}</annotation><annotation encoding="application/x-llamapun" id="A9.F13.4.1.m1.1e">bold_Q</annotation></semantics></math>/<math alttext="\mathbf{K}" class="ltx_Math" display="inline" id="A9.F13.5.2.m2.1"><semantics id="A9.F13.5.2.m2.1b"><mi id="A9.F13.5.2.m2.1.1" xref="A9.F13.5.2.m2.1.1.cmml">𝐊</mi><annotation-xml encoding="MathML-Content" id="A9.F13.5.2.m2.1c"><ci id="A9.F13.5.2.m2.1.1.cmml" xref="A9.F13.5.2.m2.1.1">𝐊</ci></annotation-xml><annotation encoding="application/x-tex" id="A9.F13.5.2.m2.1d">\mathbf{K}</annotation><annotation encoding="application/x-llamapun" id="A9.F13.5.2.m2.1e">bold_K</annotation></semantics></math>/<math alttext="\mathbf{V}" class="ltx_Math" display="inline" id="A9.F13.6.3.m3.1"><semantics id="A9.F13.6.3.m3.1b"><mi id="A9.F13.6.3.m3.1.1" xref="A9.F13.6.3.m3.1.1.cmml">𝐕</mi><annotation-xml encoding="MathML-Content" id="A9.F13.6.3.m3.1c"><ci id="A9.F13.6.3.m3.1.1.cmml" xref="A9.F13.6.3.m3.1.1">𝐕</ci></annotation-xml><annotation encoding="application/x-tex" id="A9.F13.6.3.m3.1d">\mathbf{V}</annotation><annotation encoding="application/x-llamapun" id="A9.F13.6.3.m3.1e">bold_V</annotation></semantics></math> in Llama-3-70B.</span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="A9.F14">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A9.F14.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="141" id="A9.F14.sf1.g1" src="https://arxiv.org/html/2410.05265v1/x36.png" width="685">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span>Original distribution</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A9.F14.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="125" id="A9.F14.sf2.g1" src="https://arxiv.org/html/2410.05265v1/x37.png" width="685">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span>Rotation</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A9.F14.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="123" id="A9.F14.sf3.g1" src="https://arxiv.org/html/2410.05265v1/x38.png" width="685">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(c) </span>PrefixQuant (ours)</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 14: </span><span class="ltx_text ltx_font_bold" id="A9.F14.2.1">Distribution of token-wise maximum values for linear layers inputs in Qwen-2-7B.</span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="A9.F15">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A9.F15.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="156" id="A9.F15.sf1.g1" src="https://arxiv.org/html/2410.05265v1/x39.png" width="571">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span>Original distribution</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A9.F15.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="136" id="A9.F15.sf2.g1" src="https://arxiv.org/html/2410.05265v1/x40.png" width="571">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span>Rotation</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A9.F15.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="136" id="A9.F15.sf3.g1" src="https://arxiv.org/html/2410.05265v1/x41.png" width="571">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(c) </span>PrefixQuant (ours)</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 15: </span><span class="ltx_text ltx_font_bold" id="A9.F15.6.3">Distribution of token-wise maximum values for <math alttext="\mathbf{Q}" class="ltx_Math" display="inline" id="A9.F15.4.1.m1.1"><semantics id="A9.F15.4.1.m1.1b"><mi id="A9.F15.4.1.m1.1.1" xref="A9.F15.4.1.m1.1.1.cmml">𝐐</mi><annotation-xml encoding="MathML-Content" id="A9.F15.4.1.m1.1c"><ci id="A9.F15.4.1.m1.1.1.cmml" xref="A9.F15.4.1.m1.1.1">𝐐</ci></annotation-xml><annotation encoding="application/x-tex" id="A9.F15.4.1.m1.1d">\mathbf{Q}</annotation><annotation encoding="application/x-llamapun" id="A9.F15.4.1.m1.1e">bold_Q</annotation></semantics></math>/<math alttext="\mathbf{K}" class="ltx_Math" display="inline" id="A9.F15.5.2.m2.1"><semantics id="A9.F15.5.2.m2.1b"><mi id="A9.F15.5.2.m2.1.1" xref="A9.F15.5.2.m2.1.1.cmml">𝐊</mi><annotation-xml encoding="MathML-Content" id="A9.F15.5.2.m2.1c"><ci id="A9.F15.5.2.m2.1.1.cmml" xref="A9.F15.5.2.m2.1.1">𝐊</ci></annotation-xml><annotation encoding="application/x-tex" id="A9.F15.5.2.m2.1d">\mathbf{K}</annotation><annotation encoding="application/x-llamapun" id="A9.F15.5.2.m2.1e">bold_K</annotation></semantics></math>/<math alttext="\mathbf{V}" class="ltx_Math" display="inline" id="A9.F15.6.3.m3.1"><semantics id="A9.F15.6.3.m3.1b"><mi id="A9.F15.6.3.m3.1.1" xref="A9.F15.6.3.m3.1.1.cmml">𝐕</mi><annotation-xml encoding="MathML-Content" id="A9.F15.6.3.m3.1c"><ci id="A9.F15.6.3.m3.1.1.cmml" xref="A9.F15.6.3.m3.1.1">𝐕</ci></annotation-xml><annotation encoding="application/x-tex" id="A9.F15.6.3.m3.1d">\mathbf{V}</annotation><annotation encoding="application/x-llamapun" id="A9.F15.6.3.m3.1e">bold_V</annotation></semantics></math> in Qwen-2-7B.</span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="A9.F16">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A9.F16.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="142" id="A9.F16.sf1.g1" src="https://arxiv.org/html/2410.05265v1/x42.png" width="685">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span>Original distribution</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A9.F16.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="125" id="A9.F16.sf2.g1" src="https://arxiv.org/html/2410.05265v1/x43.png" width="685">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span>Rotation</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A9.F16.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="125" id="A9.F16.sf3.g1" src="https://arxiv.org/html/2410.05265v1/x44.png" width="685">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(c) </span>PrefixQuant (ours)</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 16: </span><span class="ltx_text ltx_font_bold" id="A9.F16.2.1">Distribution of token-wise maximum values for linear layers inputs in Mistral-7B-v0.3.</span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="A9.F17">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A9.F17.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="157" id="A9.F17.sf1.g1" src="https://arxiv.org/html/2410.05265v1/x45.png" width="571">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span>Original distribution</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A9.F17.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="137" id="A9.F17.sf2.g1" src="https://arxiv.org/html/2410.05265v1/x46.png" width="571">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span>Rotation</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A9.F17.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="135" id="A9.F17.sf3.g1" src="https://arxiv.org/html/2410.05265v1/x47.png" width="571">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(c) </span>PrefixQuant (ours)</figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 17: </span><span class="ltx_text ltx_font_bold" id="A9.F17.6.3">Distribution of token-wise maximum values for <math alttext="\mathbf{Q}" class="ltx_Math" display="inline" id="A9.F17.4.1.m1.1"><semantics id="A9.F17.4.1.m1.1b"><mi id="A9.F17.4.1.m1.1.1" xref="A9.F17.4.1.m1.1.1.cmml">𝐐</mi><annotation-xml encoding="MathML-Content" id="A9.F17.4.1.m1.1c"><ci id="A9.F17.4.1.m1.1.1.cmml" xref="A9.F17.4.1.m1.1.1">𝐐</ci></annotation-xml><annotation encoding="application/x-tex" id="A9.F17.4.1.m1.1d">\mathbf{Q}</annotation><annotation encoding="application/x-llamapun" id="A9.F17.4.1.m1.1e">bold_Q</annotation></semantics></math>/<math alttext="\mathbf{K}" class="ltx_Math" display="inline" id="A9.F17.5.2.m2.1"><semantics id="A9.F17.5.2.m2.1b"><mi id="A9.F17.5.2.m2.1.1" xref="A9.F17.5.2.m2.1.1.cmml">𝐊</mi><annotation-xml encoding="MathML-Content" id="A9.F17.5.2.m2.1c"><ci id="A9.F17.5.2.m2.1.1.cmml" xref="A9.F17.5.2.m2.1.1">𝐊</ci></annotation-xml><annotation encoding="application/x-tex" id="A9.F17.5.2.m2.1d">\mathbf{K}</annotation><annotation encoding="application/x-llamapun" id="A9.F17.5.2.m2.1e">bold_K</annotation></semantics></math>/<math alttext="\mathbf{V}" class="ltx_Math" display="inline" id="A9.F17.6.3.m3.1"><semantics id="A9.F17.6.3.m3.1b"><mi id="A9.F17.6.3.m3.1.1" xref="A9.F17.6.3.m3.1.1.cmml">𝐕</mi><annotation-xml encoding="MathML-Content" id="A9.F17.6.3.m3.1c"><ci id="A9.F17.6.3.m3.1.1.cmml" xref="A9.F17.6.3.m3.1.1">𝐕</ci></annotation-xml><annotation encoding="application/x-tex" id="A9.F17.6.3.m3.1d">\mathbf{V}</annotation><annotation encoding="application/x-llamapun" id="A9.F17.6.3.m3.1e">bold_V</annotation></semantics></math> in Mistral-7b-v0.3.</span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</section>
</section>
</article>
</div>

</div>


<button type="button" class="btn btn-primary hover-rp-button" id="openForm">Report Issue</button><div class="modal" id="myForm" role="dialog" aria-labelledby="modal-title"><div class="modal-dialog"><form class="modal-content" id="myFormContent" enctype="multipart/form-data"><div class="modal-header" id="modal-header"><h5 class="modal-title">Report Github Issue</h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div><div class="modal-body"><label for="form_title" id="modalTitle">Title:</label><input class="form-control" id="form_title" name="form_title" required="required" placeholder="Enter title"><label for="description" id="selectedTextModalDescription" style="display: none;">Content selection saved. Describe the issue below:</label><label for="description" id="nomralModalDescription">Description:</label><textarea class="form-control" id="description" name="description" required="required" style="height: 80px;" maxlength="500" placeholder="500 characters maximum"></textarea></div><div class="modal-footer d-flex justify-content-end"><button type="submit" class="sr-only button" id="modal-submit-sr">Submit without Github</button><button type="submit" class="btn btn-primary" id="modal-submit">Submit in Github</button></div></form></div></div><button id="small-report-button" type="button" class="btn btn-secondary btn-sm" style="background-color: rgb(179, 27, 27); position: fixed; display: none;">Report Issue for Selection</button><div class="ltx_page_footer">
        <div class="ltx_page_logo">
            Generated by
            <a href="https://math.nist.gov/~BMiller/LaTeXML/" class="ltx_LaTeXML_logo">
                <span style="letter-spacing: -0.2em; margin-right: 0.1em;">
                    L
                    <span style="font-size: 70%; position: relative; bottom: 2.2pt;">A</span>
                    T
                    <span style="position: relative; bottom: -0.4ex;">E</span>
                </span>
                <span class="ltx_font_smallcaps">xml</span>
                <img alt="[LOGO]" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==">
            </a>
        </div></div><footer id="footer" class="ltx_document">
        <div class="keyboard-glossary">
            <h2>Instructions for reporting errors</h2>
            <p>We are continuing to improve HTML versions of papers, and your feedback helps enhance accessibility and mobile support. To report errors in the HTML that will help us improve conversion and rendering, choose any of the methods listed below:</p>
            <ul>
                <li>Click the "Report Issue" button.</li>
                <li>Open a report feedback form via keyboard, use "<strong>Ctrl + ?</strong>".</li>
                <li>Make a text selection and click the "Report Issue for Selection" button near your cursor.</li>
                <li class="sr-only">You can use Alt+Y to toggle on and Alt+Shift+Y to toggle off accessible reporting links at each section.</li>
            </ul>
            <p>Our team has already identified <a class="ltx_ref" href="https://github.com/arXiv/html_feedback/issues" target="_blank">the following issues</a>. We appreciate your time reviewing and reporting rendering errors we may not have found yet. Your efforts will help us improve the HTML versions for all readers, because disability should not be a barrier to accessing research. Thank you for your continued support in championing open access for all.</p>
            <p>Have a free development cycle? Help support accessibility at arXiv! Our collaborators at LaTeXML maintain a <a class="ltx_ref" href="https://github.com/brucemiller/LaTeXML/wiki/Porting-LaTeX-packages-for-LaTeXML" target="_blank">list of packages that need conversion</a>, and welcome <a class="ltx_ref" href="https://github.com/brucemiller/LaTeXML/issues" target="_blank">developer contributions</a>.</p>
        </div>
    </footer></body></html>