<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Generative artificial intelligence for navigating synthesizable chemical space</title>
<!--Generated on Fri Oct  4 15:05:19 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2410.03494v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#S1" title="In Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#S2" title="In Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>SynFormer: a generative framework for synthesizable molecular design</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#S3" title="In Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Results</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#S3.SS1" title="In 3 Results ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Molecule reconstruction and chemical space coverage</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#S3.SS2" title="In 3 Results ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Local chemical space exploration with SynFormer</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#S3.SS2.SSS1" title="In 3.2 Local chemical space exploration with SynFormer ‣ 3 Results ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.1 </span>Synthesizable analog generation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#S3.SS2.SSS2" title="In 3.2 Local chemical space exploration with SynFormer ‣ 3 Results ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.2 </span>Hit expansion within synthesizable chemical space</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#S3.SS3" title="In 3 Results ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Global chemical space navigation with SynFormer</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#S3.SS3.SSS1" title="In 3.3 Global chemical space navigation with SynFormer ‣ 3 Results ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3.1 </span>Molecular optimization by fine-tuning SynFormer-D with reinforcement learning</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#S3.SS3.SSS2" title="In 3.3 Global chemical space navigation with SynFormer ‣ 3 Results ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3.2 </span>Molecular optimization by using SynFormer-ED as a mutation operator within a genetic algorithm</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#S4" title="In Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Discussion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#S5" title="In Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Methods</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#A1" title="In Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Additional method details</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#A1.SS1" title="In Appendix A Additional method details ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1 </span>Model architectures</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#A1.SS1.SSS1" title="In A.1 Model architectures ‣ Appendix A Additional method details ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1.1 </span>Transformer decoder</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#A1.SS1.SSS2" title="In A.1 Model architectures ‣ Appendix A Additional method details ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1.2 </span>Transformer encoder</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#A1.SS1.SSS3" title="In A.1 Model architectures ‣ Appendix A Additional method details ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1.3 </span>Scaling of model size</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#A1.SS1.SSS4" title="In A.1 Model architectures ‣ Appendix A Additional method details ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1.4 </span>Diffusion fingerprint head</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#A1.SS2" title="In Appendix A Additional method details ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2 </span>Training details</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#A1.SS2.SSS1" title="In A.2 Training details ‣ Appendix A Additional method details ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2.1 </span>Training data generation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#A1.SS2.SSS2" title="In A.2 Training details ‣ Appendix A Additional method details ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2.2 </span>Hyper-parameters</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#A1.SS3" title="In Appendix A Additional method details ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.3 </span>Inference details</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#A1.SS3.SSS1" title="In A.3 Inference details ‣ Appendix A Additional method details ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.3.1 </span>Sampling algorithm</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#A1.SS3.SSS2" title="In A.3 Inference details ‣ Appendix A Additional method details ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.3.2 </span>Branched sampling</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#A2" title="In Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Additional results</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#A2.SS1" title="In Appendix B Additional results ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.1 </span>Impact of enlarged fingerprint length on performance</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#A2.SS2" title="In Appendix B Additional results ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.2 </span>Synthesizable analog generation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#A2.SS3" title="In Appendix B Additional results ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.3 </span>Hit expansion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#A2.SS4" title="In Appendix B Additional results ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.4 </span>Global chemical space exploration by <span class="ltx_text ltx_font_italic">de novo</span> molecular optimization</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#A2.SS4.SSS1" title="In B.4 Global chemical space exploration by de novo molecular optimization ‣ Appendix B Additional results ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.4.1 </span>Molecular optimization using reinforcement learning</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#A2.SS4.SSS2" title="In B.4 Global chemical space exploration by de novo molecular optimization ‣ Appendix B Additional results ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.4.2 </span>Molecular optimization using genetic algorithm</span></a></li>
</ol>
</li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Generative artificial intelligence for 
<br class="ltx_break"/>navigating synthesizable chemical space
</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Wenhao Gao<sup class="ltx_sup" id="id4.4.id1"><span class="ltx_text ltx_font_italic" id="id4.4.id1.1">∗</span></sup>
<br class="ltx_break"/>Department of Chemical Engineering 
<br class="ltx_break"/>Massachusetts Institute of Technology 
<br class="ltx_break"/>Cambridge, MA 02139, USA
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id5.5.id2">whgao@mit.edu</span>
<br class="ltx_break"/>&amp;Shitong Luo<sup class="ltx_sup" id="id6.6.id3"><span class="ltx_text ltx_font_italic" id="id6.6.id3.1">∗</span></sup>
<br class="ltx_break"/>Department of Electrical Engineering and Computer Science 
<br class="ltx_break"/>Massachusetts Institute of Technology 
<br class="ltx_break"/>Cambridge, MA 02139, USA
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id7.7.id4">luost@mit.edu</span>
<br class="ltx_break"/>&amp;Connor W. Coley 
<br class="ltx_break"/>Department of Chemical Engineering 
<br class="ltx_break"/>Department of Electrical Engineering and Computer Science 
<br class="ltx_break"/>Massachusetts Institute of Technology 
<br class="ltx_break"/>Cambridge, MA 02139, USA
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id8.8.id5">ccoley@mit.edu</span>
<br class="ltx_break"/>
<br class="ltx_break"/><sup class="ltx_sup" id="id9.9.id6">∗</sup>Equal Contribution 
<br class="ltx_break"/>
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id10.id1">We introduce SynFormer, a generative modeling framework designed to efficiently explore and navigate synthesizable chemical space. Unlike traditional molecular generation approaches, we generate synthetic pathways for molecules to ensure that designs are synthetically tractable. By incorporating a scalable transformer architecture and a diffusion module for building block selection, SynFormer surpasses existing models in synthesizable molecular design. We demonstrate SynFormer’s effectiveness in two key applications: (1) local chemical space exploration, where the model generates synthesizable analogs of a reference molecule, and (2) global chemical space exploration, where the model aims to identify optimal molecules according to a black-box property prediction oracle. Additionally, we demonstrate the scalability of our approach via the improvement in performance as more computational resources become available. With our code and trained models openly available, we hope that SynFormer will find use across applications in drug discovery and materials science.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para ltx_noindent" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">The discovery of novel functional molecules is a central challenge in chemical science and engineering and is crucial for addressing key societal and technological challenges, including those related to healthcare <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib1" title="">1</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib2" title="">2</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib3" title="">3</a>]</cite>, energy <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib4" title="">4</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib5" title="">5</a>]</cite>, and sustainability <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib6" title="">6</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib7" title="">7</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib8" title="">8</a>]</cite>. However, the process of discovery is often risky, complex, time-consuming, and resource-intensive <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib9" title="">9</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib10" title="">10</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib11" title="">11</a>]</cite>. Recent advances in artificial intelligence (AI) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib12" title="">12</a>]</cite>, particularly in generative modeling <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib13" title="">13</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib14" title="">14</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib15" title="">15</a>]</cite>, have opened up new avenues for generative molecular design <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib16" title="">16</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib17" title="">17</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib18" title="">18</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib19" title="">19</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib20" title="">20</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib21" title="">21</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib22" title="">22</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib23" title="">23</a>]</cite>. The expressivity of deep learning models, coupled with automatic differentiation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib24" title="">24</a>]</cite> and increasingly affordable computational resources, have made it possible to model the complex distribution of molecular structures directly. This capability allows for efficient exploration of broader virtual chemical space than traditional virtual screening approaches <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib25" title="">25</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib26" title="">26</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib27" title="">27</a>]</cite>, with more fine-grained and controllable navigation compared to conventional combinatorial fragment-based methods <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib28" title="">28</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib29" title="">29</a>]</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Despite the promise of generative design methods, their adoption has remained somewhat limited. One major challenge is that most generative models often produce synthetically intractable molecular structures when targeting specific design goals, such as optimizing property scores <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib30" title="">30</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib31" title="">31</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib32" title="">32</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib33" title="">33</a>]</cite>. When designed molecules cannot be synthesized and validated in the lab at a reasonable cost, their practical value is limited. In addition, the actionability of computer-aided molecular design is crucial for achieving rapid design cycles in early-stage drug discovery <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib34" title="">34</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib35" title="">35</a>]</cite> and for enabling closed-loop autonomous discovery <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib36" title="">36</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib37" title="">37</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib38" title="">38</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib39" title="">39</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib40" title="">40</a>]</cite>.
This issue, though long-standing and observed in earlier combinatorial algorithms, has become more pronounced with the advent of deep generative AI models.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">There has been considerable interest in incorporating synthetic accessibility into molecular design methods <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib30" title="">30</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib33" title="">33</a>]</cite>. The most straightforward strategy is to incorporate a heuristic synthetic accessibility score as a design criterion <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib30" title="">30</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib41" title="">41</a>]</cite>. However, quantitatively estimating synthetic accessibility must account for factors such as regioselectivity, functional group compatibility, and building block availability, all of which contribute to a rugged structure-synthesizability landscape that makes the design of such scores an ongoing challenge. While notable efforts have been made to quantify synthetic accessibility <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib42" title="">42</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib43" title="">43</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib44" title="">44</a>]</cite>, achieving reliable quantification through a simple heuristic remains a distant goal. Advances in the sample efficiency of molecular optimization <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib45" title="">45</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib46" title="">46</a>]</cite> have made it feasible to conduct explicit retrosynthesis analysis for each designed molecule as a means of evaluating synthetic accessibility <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib47" title="">47</a>]</cite>. However, the computational overhead remains significant, making this approach impractical for most existing generative design models. Furthermore, unsynthesizable molecules provide no learning signal, and when a model continues to propose such molecules, the sparse feedback hinders effective learning.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">A more ideal and effective approach to synthesizable molecular design, in our opinion, involves constraining the design process to focus exclusively on synthesizable molecules by designing <em class="ltx_emph ltx_font_italic" id="S1.p4.1.1">synthetic pathways</em> rather than simply designing <em class="ltx_emph ltx_font_italic" id="S1.p4.1.2">structures</em>. With the growing role of massive make-on-demand libraries—whose sizes exceed what can be fully enumerated <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib27" title="">27</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib48" title="">48</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib49" title="">49</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib50" title="">50</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib51" title="">51</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib52" title="">52</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib53" title="">53</a>]</cite>-this class of methods has gained increasing interest, spanning both traditional Monte Carlo techniques <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib54" title="">54</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib55" title="">55</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib56" title="">56</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib57" title="">57</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib58" title="">58</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib59" title="">59</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib60" title="">60</a>]</cite> and more recent generative approaches <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib61" title="">61</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib62" title="">62</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib63" title="">63</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib64" title="">64</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib65" title="">65</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib66" title="">66</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib67" title="">67</a>]</cite>. Despite this progress, current synthesis-centric methods still fall short in terms of controllability and efficiency in navigating the chemical space, and as a result have not achieved widespread adoption. These methods that rely on property scores to guide the design process often exhibit lower efficiency in optimizing expensive oracles compared to structure-centric methods <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib45" title="">45</a>]</cite>, as they model the synthetic action sequence-property landscape, which is inherently more complex than the structure-property landscape. Some recent models offer a more controlled exploration of local chemical spaces by using a reference input molecule <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib61" title="">61</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib64" title="">64</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib65" title="">65</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib67" title="">67</a>]</cite>. However, the low reconstruction rates for theoretically feasible molecules suggest a risk of partial collapse during decoding, suggesting that the practical chemical space accessible to these models is smaller than the theoretically accessible space. This behavior leads to certain regions of the chemical space becoming inaccessible, regardless of the input, ultimately hindering the overall design process.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">Herein, we build upon our previous contributions <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib65" title="">65</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib67" title="">67</a>]</cite> to introduce SynFormer, a generative AI framework designed for efficient and controllable navigation within a synthesizable chemical space. Like earlier synthesizable design methods, SynFormer is a synthesis-centric approach, generating synthetic pathways by readily available building blocks through robust chemical transformations, ensuring synthetic traceability subject to the limitations of those transformation rules. SynFormer distinguishes itself from previous models with its compute-efficient and scalable transformer architecture <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib14" title="">14</a>]</cite>, which empirically shows improvements in performance as the training dataset grows. To select suitable molecular building blocks from the large, discrete, and multimodal space of commercially-available options, SynFormer incorporates a denoising diffusion model as a token head module <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib15" title="">15</a>]</cite>. The framework is fully end-to-end differentiable, enabling effective training and optimization.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">We demonstrate the utility and versatility of the SynFormer framework through two instantiations: (1) SynFormer-ED, an encoder-decoder model that generates synthetic pathways corresponding to a given input molecule for exact or approximate reconstruction of that input, and (2) SynFormer-D, a decoder-only model for generating synthetic pathways that is amenable to fine-tuning towards specific property goals. Both models are trained on a simulated chemical space derived from a curated set of 115 reaction templates and 223,244 commercially available building blocks, extending beyond Enamine’s REAL Space <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib50" title="">50</a>]</cite>. We validate SynFormer’s capabilities by demonstrating success on (a) reconstructing molecules within both the Enamine REAL and ChEMBL <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib68" title="">68</a>]</cite> chemical spaces; (b) local synthesizable chemical space exploration given a reference molecule; and (c) global synthesizable chemical space exploration guided by black-box property prediction model. These results not only highlight SynFormer’s ability to navigate synthesizable chemical space using varied control strategies but also demonstrate its practical applicability in real-world molecular design use cases. The scalability of the SynFormer framework with respect to both training data and model size suggests considerable potential for further performance enhancement. In conclusion, these findings underscore SynFormer’s flexibility and potential to impact molecular design across various domains, including drug development and materials science.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>SynFormer: a generative framework for synthesizable molecular design</h2>
<figure class="ltx_figure" id="S2.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="408" id="S2.F1.g1" src="extracted/5901987/figures/F1.png" width="509"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Schematic illustration of the SynFormer framework and architecture. (A) The SynFormer-ED architecture is an encoder-decoder that takes a molecule as input and outputs a synthetic route to the same or an analogous molecule. (B) SynFormer-D is a decoder-only framework designed to generate synthetic routes. (C) Synthetic routes are tokenized using a postfix notation to make them amenable to autoregressive generation. Routes are constructed by applying 115 reactions to a set of 223,244 molecular building blocks, covering a synthesizable chemical space estimated as <math alttext="&gt;10^{60}" class="ltx_Math" display="inline" id="S2.F1.2.m1.1"><semantics id="S2.F1.2.m1.1b"><mrow id="S2.F1.2.m1.1.1" xref="S2.F1.2.m1.1.1.cmml"><mi id="S2.F1.2.m1.1.1.2" xref="S2.F1.2.m1.1.1.2.cmml"></mi><mo id="S2.F1.2.m1.1.1.1" xref="S2.F1.2.m1.1.1.1.cmml">&gt;</mo><msup id="S2.F1.2.m1.1.1.3" xref="S2.F1.2.m1.1.1.3.cmml"><mn id="S2.F1.2.m1.1.1.3.2" xref="S2.F1.2.m1.1.1.3.2.cmml">10</mn><mn id="S2.F1.2.m1.1.1.3.3" xref="S2.F1.2.m1.1.1.3.3.cmml">60</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.F1.2.m1.1c"><apply id="S2.F1.2.m1.1.1.cmml" xref="S2.F1.2.m1.1.1"><gt id="S2.F1.2.m1.1.1.1.cmml" xref="S2.F1.2.m1.1.1.1"></gt><csymbol cd="latexml" id="S2.F1.2.m1.1.1.2.cmml" xref="S2.F1.2.m1.1.1.2">absent</csymbol><apply id="S2.F1.2.m1.1.1.3.cmml" xref="S2.F1.2.m1.1.1.3"><csymbol cd="ambiguous" id="S2.F1.2.m1.1.1.3.1.cmml" xref="S2.F1.2.m1.1.1.3">superscript</csymbol><cn id="S2.F1.2.m1.1.1.3.2.cmml" type="integer" xref="S2.F1.2.m1.1.1.3.2">10</cn><cn id="S2.F1.2.m1.1.1.3.3.cmml" type="integer" xref="S2.F1.2.m1.1.1.3.3">60</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.2.m1.1d">&gt;10^{60}</annotation><annotation encoding="application/x-llamapun" id="S2.F1.2.m1.1e">&gt; 10 start_POSTSUPERSCRIPT 60 end_POSTSUPERSCRIPT</annotation></semantics></math> molecules. (D) During generation, a token generated by the transformer is first classified by token type. If the token represents a reaction or reactant (building block), it undergoes an additional classification process to select the appropriate reactions or a denoising diffusion process followed by a nearest neighbor search to select the appropriate building block(s).</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">SynFormer is a generative framework designed for modeling synthesizable chemical spaces, as schematically illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#S2.F1" title="Figure 1 ‣ 2 SynFormer: a generative framework for synthesizable molecular design ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_tag">1</span></a>. Although it is challenging to predict which molecules can be synthesized without experimental validation, the progress of make-on-demand libraries such as Enamine REAL Space <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib50" title="">50</a>]</cite>, GalaXi <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib51" title="">51</a>]</cite>, and eXplore <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib52" title="">52</a>]</cite> has demonstrated that molecules constructed by connecting purchasable molecular building blocks through a series of curated, reliable reactions have a high likelihood of being synthesizable. Therefore, within the scope of this work, we define synthesizable chemical space as encompassing all molecules that can be formed within the reaction network by linking purchasable building blocks through up to five steps of known chemical transformations, though in principle, there is no limit to the length of pathways that can be generated, and building blocks and reactions beyond our selected list can also be utilized.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p2">
<p class="ltx_p" id="S2.p2.1">To effectively model chemically relevant and practically useful spaces, we adapted the reaction set used to construct REAL Space, which primarily focuses on bi- and tri-molecular reactions that couple multiple building blocks together. We further augment this set with additional common reactions, such as functional group interconversions, to better simulate a general organic synthesis endeavor, resulting in a total of 115 reaction templates. As the set of purchasable molecular building blocks, we use Enamine’s U.S. stock catalog to ensure high availability, which also approximates those used to generate REAL Space. Although the proportion of synthesizable molecules may vary due to the broader focus of the chemical space, our model theoretically covers a chemical space broader than then tens of billions currently represented in the Enamine REAL Space, making it suitable for extensive exploration during the molecular design stage. Both the choice of templates and the choice of building blocks can be straightforwardly modified prior to retraining and are not inherent to SynFormer’s approach.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p3">
<p class="ltx_p" id="S2.p3.1">Generating synthetic pathways requires careful consideration of their data structure. Bottom-up synthesis planning involves sequential decision-making with branches and merges, encompassing data modalities that span reaction templates and molecular building blocks, which represent small and very large discrete design spaces, respectively. To manage this complexity, we adopt the postfix notation to represent synthetic pathways linearly, as described in Luo et al.’s <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib67" title="">67</a>]</cite> (Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#S2.F1" title="Figure 1 ‣ 2 SynFormer: a generative framework for synthesizable molecular design ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_tag">1</span></a>C). Specifically, we use four types of tokens to represent synthetic paths: a start token [START], an end token [END], reaction tokens [RXN], and building block tokens [BB]. Similar to the postfix notation of mathematical formulae, the reactions are placed after the reagents, allowing the sequence to be processed in a step-by-step manner without loss of generality in the synthetic pathways (e.g., the ability to accommodate any linear or convergent sequence). This linear notation also enables the use of autoregressive decoding via a transformer architecture <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib14" title="">14</a>]</cite>, which is widely recognized as a scalable model backbone. A stack of standard transformer layers processes the sequence as it is decoded, taking the previous tokens and outputting the embedding for the next token. Each token embedding then passes through a multi-layer perceptron (MLP) classification head to determine the token type. If the token is [END], the generation process terminates. If the token is [RXN] or [BB], the embedding is used to select which building blocks to add and which reaction type to perform.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p4">
<p class="ltx_p" id="S2.p4.2">The selection of reactions can be relatively straightforward using an additional classification head; however, the number of purchasable building blocks can easily exceed hundreds of thousands, millions, or perhaps billions, and will continue to grow over time. Instead of relying on a static classification network, our past work <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib65" title="">65</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib67" title="">67</a>]</cite> has involved generating Morgan fingerprints <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib69" title="">69</a>]</cite> and then retrieving the nearest building block from a list of candidates to enable generalization to unseen building blocks. To further enhance this building block selection process, we adopt a denoising diffusion probabilistic module <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib15" title="">15</a>]</cite> to predict the posterior distribution of molecular fingerprints conditioned on the token embedding. Specifically, we model the molecular fingerprints using an <math alttext="n" class="ltx_Math" display="inline" id="S2.p4.1.m1.1"><semantics id="S2.p4.1.m1.1a"><mi id="S2.p4.1.m1.1.1" xref="S2.p4.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S2.p4.1.m1.1b"><ci id="S2.p4.1.m1.1.1.cmml" xref="S2.p4.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.1.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="S2.p4.1.m1.1d">italic_n</annotation></semantics></math>-dimensional joint Bernoulli distribution (where <math alttext="n" class="ltx_Math" display="inline" id="S2.p4.2.m2.1"><semantics id="S2.p4.2.m2.1a"><mi id="S2.p4.2.m2.1.1" xref="S2.p4.2.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S2.p4.2.m2.1b"><ci id="S2.p4.2.m2.1.1.cmml" xref="S2.p4.2.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.2.m2.1c">n</annotation><annotation encoding="application/x-llamapun" id="S2.p4.2.m2.1d">italic_n</annotation></semantics></math> is the length of the fingerprint) and employ a multinomial diffusion framework <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib70" title="">70</a>]</cite> to handle the discrete nature of the data. Using the denoising diffusion module as the building block token head offers several advantages: while maintaining the end-to-end differentiable nature, it allows for scaling to longer fingerprints (2048 in this work compared to 256 in previous studies), thereby avoiding bit collisions that can occur with shorter fingerprints and enabling generation at a finer resolution. Additionally, this approach more effectively handles multimodal distributions, where multiple “true" answers exist for a single decision–a particularly common scenario when modeling synthetic pathways.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p5">
<p class="ltx_p" id="S2.p5.1">Based on this generative modeling framework, we implemented two specific models: SynFormer-D, which straightforwardly implements a transformer decoder with the aforementioned reaction classification heads and building block diffusion heads (Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#S2.F1" title="Figure 1 ‣ 2 SynFormer: a generative framework for synthesizable molecular design ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_tag">1</span></a>B), and SynFormer-ED, which adds a standard transformer encoder to condition generation on an input SMILES string <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib71" title="">71</a>]</cite> (Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#S2.F1" title="Figure 1 ‣ 2 SynFormer: a generative framework for synthesizable molecular design ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_tag">1</span></a>A). To train the models, we uniformly sample synthetic pathways from the synthesizable chemical space simulated from the reaction templates and building block list as training data. Detailed descriptions of the model architectures, training protocols, and hyperparameter settings are provided in the Methods section and Supplementary Information.</p>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Results</h2>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Molecule reconstruction and chemical space coverage</h3>
<div class="ltx_para ltx_noindent" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">An important factor that affects a model’s performance in molecular design applications is its coverage of chemical space <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib72" title="">72</a>]</cite>. Even though the theoretical synthesizable chemical space constructed from reaction templates and building blocks is vast, previous models have shown that a trained model can struggle to generate molecules that are known to be synthesizable <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib64" title="">64</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib65" title="">65</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib57" title="">57</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib67" title="">67</a>]</cite>. This limitation can hinder the model’s effectiveness in molecular design if it cannot access the chemical space where the optimal design resides. To assess the coverage of chemical space, we tested the SynFormer-ED model on molecule reconstruction: how often SynFormer-ED can reconstruct a viable synthetic path given a large set of potential molecules of interest.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.1">We evaluated reconstruction on a randomly selected subset of 1,000 molecules from ChEMBL Database and Enamine’s REAL Diversity Set (Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#S3.F2" title="Figure 2 ‣ 3.1 Molecule reconstruction and chemical space coverage ‣ 3 Results ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_tag">2</span></a>A and B). SynFormer-ED successfully recovers 66% of molecules from REAL, notably higher than that achieved by ChemProjector <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib67" title="">67</a>]</cite> and SynNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib30" title="">30</a>]</cite>. ChEMBL, by comparison, is a curated database of bioactive molecules with drug-like properties, which includes molecules whose syntheses may require building blocks or reactions beyond SynFormer’s training set. This results in a reconstruction rate of 20%—lower than in REAL Space but still an improvement over previous models.</p>
</div>
<figure class="ltx_figure" id="S3.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="144" id="S3.F2.g1" src="extracted/5901987/figures/F2_arxiv.png" width="509"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Model performance on molecular reconstruction. (A and B) Comparison of the reconstruction rate and average structural (Tanimoto) similarity between input and output molecules for SynFormer-ED, ChemProjector <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib67" title="">67</a>]</cite>, and SynNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib65" title="">65</a>]</cite> on 1,000 randomly selected molecules from (A) REAL Diversity Set and (B) ChEMBL Database. (C)
Scaling of model performance is measured by the training loss (binary cross-entropy (BCE) of the molecular fingerprint (FP) prediction) as model size and training data size increase.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.1">We further demonstrate that the model’s performance, as measured by the binary cross-entropy (BCE) of the molecular fingerprints (FPs) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib69" title="">69</a>]</cite>, improves with increasing model size and training data (Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#S3.F2" title="Figure 2 ‣ 3.1 Molecule reconstruction and chemical space coverage ‣ 3 Results ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_tag">2</span></a>C). Notably, we also observed that the performance of the largest model did not outperform the second-largest model when insufficient data was available. This finding suggests that estimating training performance based on early epochs may not be an effective strategy when the model size surpasses a certain threshold <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib73" title="">73</a>]</cite>. These results emphasize the scalability of the architecture <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib74" title="">74</a>]</cite> and indicate that further performance improvements can be achieved by increasing both the amount of data and computational resources. They also underscore the importance of scaling model size and training data in tandem to fully realize performance gains. As SynFormer is trained using simulated pathways according to its building blocks and reaction rules, there is virtually no limit to the size of training data available.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Local chemical space exploration with SynFormer</h3>
<div class="ltx_para ltx_noindent" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">In this section, we present the application of SynFormer-ED in exploring the local chemical space around a given reference molecule, projecting it into a synthesizable chemical space. We demonstrate two use cases of our model in molecular design: (1) generating synthesizable analogs for unsynthesizable designs and (2) hit expansion within synthesizable chemical space.</p>
</div>
<figure class="ltx_figure" id="S3.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="529" id="S3.F3.g1" src="extracted/5901987/figures/F3.png" width="509"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Application of SynFormer in projecting unsynthesizable design into synthesizable chemical space. (A) Schematic illustration of SynFormer-ED generating synthesizable structural analogs for unsynthesizable molecules. (B) Normalized distribution of SA scores for the originally designed molecules and their corresponding synthesizable analogs. Note that the distributions are normalized to a peak value of 1 for a clearer comparison. (C) Scatter plot comparing objective scores of originally designed molecules versus their generated analogs. Points are colored by the structural similarity between them, showing that structurally similar analogs tend to possess close properties. (D) Examples of originally designed unsynthesizable molecules and their SynFormer-generated synthesizable analogs. Objective scores are shown beneath each molecule, demonstrating comparable activities for the generated analogs. The modified fragments or atoms are highlighted in light blue. (E) The workflow shows SynFormer-ED generating synthesizable analogs for ligands generated by structure-based drug design. (F) Scatter plot comparing the Vina docking scores of originally designed ligands and their generated analogs. Points are colored based on the structural (Tanimoto) similarity between the input and output, showing strong agreement in general and an ability to generate analogs with comparable scores. (G) The original design and generated analog for Estrogen receptor alpha, with their SA Score and Vina score below. The modified fragments or atoms are highlighted in light blue.</figcaption>
</figure>
<section class="ltx_subsubsection" id="S3.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.1 </span>Synthesizable analog generation</h4>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS1.p1">
<p class="ltx_p" id="S3.SS2.SSS1.p1.1">In molecule reconstruction experiments, we observed that SynFormer-ED is able to generate structurally similar outputs even when provided with unsynthesizable (according to its building blocks and reactions) molecules. This capability allows SynFormer-ED to be applied to generate synthesizable structural analogs of unsynthesizable designs, as illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#S3.F3" title="Figure 3 ‣ 3.2 Local chemical space exploration with SynFormer ‣ 3 Results ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_tag">3</span></a>A. The implicit goal is to preserve as much of the overall structure and key pharmacophores as possible, effectively transforming non-feasible molecules into synthesizable compounds, akin to “projecting” the input molecule onto the synthesizable space.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS1.p2">
<p class="ltx_p" id="S3.SS2.SSS1.p2.1">To evaluate the impact of synthesizable projection, we first followed the experimental setup of Luo et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib67" title="">67</a>]</cite> and used SynFormer-ED to generate synthesizable analogs for molecules identified as unsynthesizable by ASKCOS <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib75" title="">75</a>]</cite> in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib30" title="">30</a>]</cite>. The original molecules were optimized using <span class="ltx_text ltx_font_italic" id="S3.SS2.SSS1.p2.1.1">de novo</span> design methods targeting ten multi-objective scores, each ranging from 0 to 1, where higher values are preferable. These scores encompass structural features, physicochemical properties, and metrics related to similarity or dissimilarity to known drugs, as well as the presence of specific substructures <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib76" title="">76</a>]</cite>. After the generation of analogs, we evaluated them using the same objective scores that the original designs were optimized for. As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#S3.F3" title="Figure 3 ‣ 3.2 Local chemical space exploration with SynFormer ‣ 3 Results ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_tag">3</span></a>B, the synthesizable projection effectively eliminated the peak in synthetic accessibility (SA) scores <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib42" title="">42</a>]</cite> at around 6-7 observed in the original designs, shifting the distribution toward more easily synthesizable molecules. Additionally, a significant fraction of the generated analogs exhibited objective scores comparable to those of the original molecules (Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#S3.F3" title="Figure 3 ‣ 3.2 Local chemical space exploration with SynFormer ‣ 3 Results ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_tag">3</span></a>C and Figure S2 in the Supporting Information). We demonstrate two examples in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#S3.F3" title="Figure 3 ‣ 3.2 Local chemical space exploration with SynFormer ‣ 3 Results ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_tag">3</span></a>D. Starting with high-scoring but seemingly-unsynthesizable molecules, SynFormer-ED generated analogs that preserved key structural features while correcting the unsynthesizable fragments. The generated analogs retained objective scores comparable to those of the original molecules and are inherently synthesizable (Figure S4 in Supporting Information), demonstrating SynFormer-ED’s ability to transform an unsynthesizable molecule into a synthesizable analog while maintaining structural integrity.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS1.p3">
<p class="ltx_p" id="S3.SS2.SSS1.p3.1">To further validate the utility of SynFormer-ED in realistic drug discovery scenarios, we explored its application in structure-based drug design (SBDD) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib77" title="">77</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib78" title="">78</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib79" title="">79</a>]</cite>. While numerous SBDD algorithms can generate ligands with promising predicted binding affinities (e.g., via 3D pocket-conditioned generation), these methods are often criticized for overlooking synthetic accessibility <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib80" title="">80</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib81" title="">81</a>]</cite>. SynFormer-ED addresses this gap by projecting the outputs of such models into synthesizable chemical space (<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#S3.F3" title="Figure 3 ‣ 3.2 Local chemical space exploration with SynFormer ‣ 3 Results ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_tag">3</span></a>E). We demonstrate this approach using Pocket2Mol <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib82" title="">82</a>]</cite> as an exemplary SBDD generative model.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS1.p4">
<p class="ltx_p" id="S3.SS2.SSS1.p4.1">Targeting 15 protein targets from the LIT-PCBA dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib83" title="">83</a>]</cite>, we used SynFormer-ED to generate synthesizable analogs of molecules initially designed by Pocket2Mol. SynFormer-ED successfully produced analogs that preserve similar Vina docking scores <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib84" title="">84</a>]</cite> while ensuring that each design has a synthetic pathway (Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#S3.F3" title="Figure 3 ‣ 3.2 Local chemical space exploration with SynFormer ‣ 3 Results ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_tag">3</span></a>F). Two examples are shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#S3.F3" title="Figure 3 ‣ 3.2 Local chemical space exploration with SynFormer ‣ 3 Results ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_tag">3</span></a>G: in the first example, the original design had a Vina score of -11.2 kcal/mol but a high synthetic accessibility (SA) score of 5.84, indicating poor synthesizability. SynFormer-ED generated a structurally similar analog with an improved SA score of 2.99 while exhibiting a Vina score of -9.8 kcal/mol. In the second example, although the original design was likely synthesizable with access to the appropriate building blocks, SynFormer-ED further reduced the SA score from 2.44 to 1.99 with minor improvements in Vina score. These results demonstrate SynFormer-ED’s potential to complement existing SBDD algorithms by generating more practical and synthesizable drug candidates, suitable for experimental validation and further development.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.2 </span>Hit expansion within synthesizable chemical space</h4>
<figure class="ltx_figure" id="S3.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="542" id="S3.F4.g1" src="extracted/5901987/figures/F4.png" width="509"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Application of SynFormer in hit expansion. (A) Schematic illustrating SynFormer-ED expanding a known hit compound into structurally similar, synthesizable analogs. (B) Normalized distribution of predicted JNK3 inhibition scores for screening ZINC250k, nearest neighbors in Enamine REAL of the hits, and SynFormer-generated analogs of the hits, highlighting the enrichment of high-scoring ligands among SynFormer analogs. Note that the distributions are normalized to a peak value of 1 for a clearer comparison. (C) Examples of hits from screening ZINC250k and corresponding best-scored generated analogs, alongside the best-scored molecules identified in the nearest neighbor search within Enamine REAL, demonstrate SynFormer-ED’s ability to generate high scoring, synthesizable compounds. The motifs retained from the hits are colored in red. (D and E) Expanding experimentally validated ligands for the PKM2 target (PDB: 3ME3) (D) and the KAT2A target (PDB: 5MLJ) (E). Three representative analogs are shown for each target, along with their synthetic pathways. The structural motifs retained from the hits are colored in red. </figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS2.p1">
<p class="ltx_p" id="S3.SS2.SSS2.p1.1">Building on SynFormer-ED’s ability to explore local synthesizable chemical space around reference molecules, we applied it to hit expansion within synthesizable chemical space. By allowing the model to select sub-optimal intermediate choices of building blocks or reactions via a beam search, SynFormer-ED can generate sets of close analogs around known hits, as illustrated in <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#S3.F4" title="Figure 4 ‣ 3.2.2 Hit expansion within synthesizable chemical space ‣ 3.2 Local chemical space exploration with SynFormer ‣ 3 Results ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_tag">4</span></a>A. This approach aims to produce additional molecules that preserve the core motifs and overall structural integrity, potentially enhancing design objectives and expanding the pool of candidates for downstream processes, such as hit-to-lead optimization.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS2.p2">
<p class="ltx_p" id="S3.SS2.SSS2.p2.1">Following the setup in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib85" title="">85</a>]</cite>, we screened ZINC250k <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib86" title="">86</a>]</cite>, a subset of ZINC database <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib87" title="">87</a>]</cite>, using a predictive model for inhibition activity against c-Jun NH2-terminal kinase 3 (JNK3) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib88" title="">88</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib89" title="">89</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib90" title="">90</a>]</cite>. The top 10 scoring molecules, with scores ranging from 0.49 to 0.68 (the higher, the better), were selected as hits and input into SynFormer-ED to generate analogs, which were then evaluated with the JNK3 inhibition predictor. As a baseline, a nearest neighbor search within Enamine REAL (approximately 7 billion molecules) was performed for the hits, retrieving approximately 100 of the most similar molecules for each hit and evaluating them for JNK3 inhibition. While both SynFormer-ED and the nearest neighbor search identified additional molecules with scores higher than those from a simple screening of ZINC250k, SynFormer-generated analogs exhibited a larger enrichment in the high-scoring region (Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#S3.F4" title="Figure 4 ‣ 3.2.2 Hit expansion within synthesizable chemical space ‣ 3.2 Local chemical space exploration with SynFormer ‣ 3 Results ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_tag">4</span></a>B). We present two sets of examples in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#S3.F4" title="Figure 4 ‣ 3.2.2 Hit expansion within synthesizable chemical space ‣ 3.2 Local chemical space exploration with SynFormer ‣ 3 Results ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_tag">4</span></a>C. Though both methods produced analogs retaining the overall structure with higher predicted inhibition than the original hits, the SynFormer-ED analogs consistently achieved higher scores compared to those from the nearest neighbor search.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS2.p3">
<p class="ltx_p" id="S3.SS2.SSS2.p3.1">To further validate SynFormer-ED’s capability in a more realistic hit expansion scenario, we used experimentally verified ligands for Human Pyruvate Kinase M2 (PKM2, PDB ID: 3ME3) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib91" title="">91</a>]</cite> and Lysine Acetyltransferase 2A (KAT2A, PDB ID: 5MLJ) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib92" title="">92</a>]</cite> as reference molecules and evaluated their Vina docking scores. SynFormer-ED was used to expand the reported ligands, generating 191 analogs for PKM2, with 179 of them with Tanimoto similarities greater than 0.5 and Vina score changes lower than 1 kcal/mol. For KAT2A, SynFormer-ED generated 200 analogs, 111 of which met the criteria of Tanimoto similarity above 0.5 and Vina score changes lower than 1 kcal/mol. Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#S3.F4" title="Figure 4 ‣ 3.2.2 Hit expansion within synthesizable chemical space ‣ 3.2 Local chemical space exploration with SynFormer ‣ 3 Results ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_tag">4</span></a>D and E present three generated analogs for ligands targeting PKM2 and KAT2A, respectively, showing competitive Vina scores while preserving the overall structure, along with their synthetic pathways (see Figure S11 and 12 in the Supporting Information for more examples). Notably, in the case of KAT2A, the synthetic pathways of the generated analogs are diverse despite the structural similarity of the final analogs, highlighting that the SynFormer-based approach is not limited by the synthetic pathways of the input hits. This flexibility allows the generation of analogs with distinct synthetic routes, which traditional path-based enumeration strategies <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib93" title="">93</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib85" title="">85</a>]</cite> cannot achieve. Combined with these results, SynFormer-ED demonstrates significant potential in hit expansion, enabling the generation of practical, synthesizable analogs suitable for further drug development stages.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Global chemical space navigation with SynFormer</h3>
<div class="ltx_para ltx_noindent" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">In this section, we demonstrate the application of SynFormer to global chemical space navigation, enabling the optimization of molecular properties treated as a black-box function across broad chemical spaces <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib45" title="">45</a>]</cite>. This process, also known as <span class="ltx_text ltx_font_italic" id="S3.SS3.p1.1.1">de novo</span> molecular optimization, is key to exploring novel molecular designs. We first show that SynFormer-D can be fine-tuned using reinforcement learning to generate high-scoring molecules (Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#S3.F5" title="Figure 5 ‣ 3.3.1 Molecular optimization by fine-tuning SynFormer-D with reinforcement learning ‣ 3.3 Global chemical space navigation with SynFormer ‣ 3 Results ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_tag">5</span></a>A). Furthermore, we demonstrate how SynFormer-ED can be integrated as a mutation step within an evolutionary algorithm (Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#S3.F5" title="Figure 5 ‣ 3.3.1 Molecular optimization by fine-tuning SynFormer-D with reinforcement learning ‣ 3.3 Global chemical space navigation with SynFormer ‣ 3 Results ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_tag">5</span></a>C), achieving state-of-the-art sample efficiency while constraining the design space to synthesizable chemical space.</p>
</div>
<section class="ltx_subsubsection" id="S3.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.1 </span>Molecular optimization by fine-tuning SynFormer-D with reinforcement learning</h4>
<div class="ltx_para ltx_noindent" id="S3.SS3.SSS1.p1">
<p class="ltx_p" id="S3.SS3.SSS1.p1.1">We fine-tuned SynFormer-D using reinforcement learning (RL) to guide its generation toward high-scoring molecules. Specifically, we adopted a variant of the REINFORCE algorithm <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib94" title="">94</a>]</cite>, which iteratively generates a batch of molecules, evaluates their properties, and fine-tunes the model parameters with the goal of maximizing the desired properties (detailed methods can be found in the Methods section). In our experiments, we optimized predicted binding affinity against the dopamine receptor D<sub class="ltx_sub" id="S3.SS3.SSS1.p1.1.1">2</sub> (DRD2) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib95" title="">95</a>]</cite> as an exemplary oracle function. As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#S3.F5" title="Figure 5 ‣ 3.3.1 Molecular optimization by fine-tuning SynFormer-D with reinforcement learning ‣ 3.3 Global chemical space navigation with SynFormer ‣ 3 Results ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_tag">5</span></a>B, our method (denoted as SF-RL) successfully biases generation toward high-scoring molecules and outperforms several popular optimization methods <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib96" title="">96</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib29" title="">29</a>]</cite>. Although SF-RL’s sample efficiency is lower than the most efficient algorithms like GraphGA <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib29" title="">29</a>]</cite> and REINVENT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib19" title="">19</a>]</cite>, these results confirm the feasibility and effectiveness of fine-tuning SynFormer-D for <span class="ltx_text ltx_font_italic" id="S3.SS3.SSS1.p1.1.2">de novo</span> molecular optimization. Given that much of the algorithm’s design space of RL is yet to be explored, the potential for additional algorithmic improvements in RL-based fine-tuning remains substantial.</p>
</div>
<figure class="ltx_figure" id="S3.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="435" id="S3.F5.g1" src="extracted/5901987/figures/F5.png" width="509"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Application of SynFormer in global chemical space exploration. (A) Illustration of fine-tuning SynFormer-D with reinforcement learning. (B) Performance comparison of SynFormer fine-tuning with reinforcement learning (SF-RL) against other popular methods, showing the average top-10 molecule scores versus the number of oracle calls <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib45" title="">45</a>]</cite>. The plots represent the mean performance curves of 5 independent runs, with the shaded region for SF-RL indicating the range across these runs. (C) Illustration of a genetic algorithm with SynFormer-ED used for mutation steps. (D) AUC Top-10 performance comparison across different molecular design methods (GraphGA-SF, GraphGA <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib29" title="">29</a>]</cite>, AugMem <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib97" title="">97</a>]</cite>, SynNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib65" title="">65</a>]</cite>, DoG-Gen <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib64" title="">64</a>]</cite>) for four tasks from GuacaMol <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib76" title="">76</a>]</cite>. (E) Distribution of SA Scores <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib42" title="">42</a>]</cite> for the top 25 molecules at various optimization steps, with colors representing objective scores, demonstrating how SynFormer effectively constraints its design space to synthesizable space exclusively. (F) The best molecules generated by GraphGA (top) and GraphGA-SF (bottom) show that GraphGA-SF identifies a more synthetically tractable candidate with a reduced SA score, albeit with a minor sacrifice in the objective score.</figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="S3.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.2 </span>Molecular optimization by using SynFormer-ED as a mutation operator within a genetic algorithm</h4>
<div class="ltx_para ltx_noindent" id="S3.SS3.SSS2.p1">
<p class="ltx_p" id="S3.SS3.SSS2.p1.1">Lastly, we demonstrate a genetic algorithm framework incorporating SynFormer-ED projection as a mutation step. After the standard processes of crossover and mutation to diversify the candidate pool, SynFormer-ED projects all candidates into synthesizable chemical space. This step not only corrects unsynthesizable fragments and linkages, ensuring synthetic accessibility, but also introduces additional diversity into the candidate pool. Generated molecules are then scored and ranked, with the top-performing ones selected for further iterations (Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#S3.F5" title="Figure 5 ‣ 3.3.1 Molecular optimization by fine-tuning SynFormer-D with reinforcement learning ‣ 3.3 Global chemical space navigation with SynFormer ‣ 3 Results ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_tag">5</span></a>C). For crossover and mutation rules, we follow the GraphGA algorithm <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib29" title="">29</a>]</cite>, a well-established molecular optimization method that regularly performs well in molecular optimization benchmarks <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib45" title="">45</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib98" title="">98</a>]</cite> and real-world applications <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib41" title="">41</a>]</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.SSS2.p2">
<p class="ltx_p" id="S3.SS3.SSS2.p2.1">We evaluated the performance of this genetic algorithm, denoted as GraphGA-SF, across four tasks from the GuacaMol benchmark <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib76" title="">76</a>]</cite>: Sitagliptin MPO, Scaffold Hop, Perindopril MPO, and Ranolazine MPO. As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#S3.F5" title="Figure 5 ‣ 3.3.1 Molecular optimization by fine-tuning SynFormer-D with reinforcement learning ‣ 3.3 Global chemical space navigation with SynFormer ‣ 3 Results ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_tag">5</span></a>D, GraphGA-SF demonstrated optimization efficiency comparable to the original GraphGA and the state-of-the-art RL method, Augmented Memory (denoted as AugMem) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib97" title="">97</a>]</cite>, while significantly outperforming previous methods for synthesizable molecular optimization. Notably, in the Sitagliptin MPO task, where the primary objective score often favored unsynthesizable molecules, conventional methods without synthesizability constraints tended to generate exclusively unsynthesizable compounds (See SA Score in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#S3.F5" title="Figure 5 ‣ 3.3.1 Molecular optimization by fine-tuning SynFormer-D with reinforcement learning ‣ 3.3 Global chemical space navigation with SynFormer ‣ 3 Results ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_tag">5</span></a>E and structure in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#S3.F5" title="Figure 5 ‣ 3.3.1 Molecular optimization by fine-tuning SynFormer-D with reinforcement learning ‣ 3.3 Global chemical space navigation with SynFormer ‣ 3 Results ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_tag">5</span></a>F). On the other hand, synthesis-centric design methods, such as SynNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib65" title="">65</a>]</cite> and DoG-Gen <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib64" title="">64</a>]</cite>, struggled to find meaningful optimization signals due to the sparse signal and their limited coverage of chemical space. In contrast, GraphGA-SF matched the performance of GraphGA while ensuring each design has a synthetic pathway like other synthesis-centric methods. We highlight the best designs from each genetic algorithm in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#S3.F5" title="Figure 5 ‣ 3.3.1 Molecular optimization by fine-tuning SynFormer-D with reinforcement learning ‣ 3.3 Global chemical space navigation with SynFormer ‣ 3 Results ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_tag">5</span></a>F, showing that the molecules generated by GraphGA-SF were significantly more synthesizable, with only a modest sacrifice in the main objective score.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.SSS2.p3">
<p class="ltx_p" id="S3.SS3.SSS2.p3.1">Our results demonstrate that by combining the optimization capability of GraphGA with SynFormer-ED’s ability to restrict the design space to synthesizable compounds, GraphGA-SF can effectively and efficiently optimize molecular properties while maintaining synthetic feasibility. Furthermore, SynFormer-ED’s integration as a mutation operator exemplifies its potential as a generalizable component in molecular design algorithms, allowing these frameworks to confine their search to synthesizable chemical spaces. This adaptability enables SynFormer-ED to leverage ongoing advances in <span class="ltx_text ltx_font_italic" id="S3.SS3.SSS2.p3.1.1">de novo</span> molecular design algorithms, offering a versatile and robust solution to the problem of synthesizable molecular design.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Discussion</h2>
<div class="ltx_para ltx_noindent" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">In this paper, we introduced SynFormer, a generative modeling framework designed to efficiently explore and navigate synthesizable chemical space. We curated a set of reaction rules that allow the model to construct a synthesizable chemical space beyond Enamine REAL Space, ensuring that the designed molecules are feasible for synthesis subject to the reliability of such rules. By integrating transformer architectures with a diffusion module, SynFormer enhances the ability to make beneficial choices of building blocks and reactions during autoregressive bottom-up pathway generation, surpassing previous models for synthesizable molecular design. We demonstrated two key applications of SynFormer: local chemical space exploration and global optimization within synthesizable chemical space, both of which yielded successful results. Additionally, we showed that SynFormer is a scalable architecture, with the potential for further performance improvements with increased resources. While our focus was on applications in drug discovery, the models are readily applicable to other domains of small organic molecule design <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib4" title="">4</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib7" title="">7</a>]</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.p2">
<p class="ltx_p" id="S4.p2.1">There are several areas where we expect further improvements can be made. First, the reconstruction rate of SynFormer-ED is not perfect, suggesting that certain regions of synthesizable chemical space may remain inaccessible, even though the model possess the reaction templates and building blocks that should make it possible to reach them. Additionally, RL-based fine-tuning in SynFormer-D currently requires a relatively large number of oracle calls to achieve competitive results. Another limitation lies in the quality and coverage of reaction templates and building blocks. These templates do not account for stereochemistry, meaning that chiral centers can only be inherited from building blocks, not installed during synthesis. Furthermore, the Enamine building blocks we choose are designed for combinatorial library construction and do not comprehensively cover commercially available materials. These constraints may limit the model’s applicability to somewhat flat, linearly-constructed sp<sup class="ltx_sup" id="S4.p2.1.1">2</sup>-rich structures and restrict its use for more complex molecules like natural products <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib99" title="">99</a>]</cite>. Expanding the SynFormer framework to include more sophisticated reactions and a broader range of building blocks is possible, but will require further validation.</p>
</div>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Methods</h2>
<section class="ltx_subsection" id="S5.SSx1">
<h3 class="ltx_title ltx_title_subsection">Synthesizable Chemical Space Construction</h3>
<div class="ltx_para ltx_noindent" id="S5.SSx1.p1">
<p class="ltx_p" id="S5.SSx1.p1.1">A synthesizable chemical space is defined as a set of molecules that can be accessed from purchasable starting materials (building blocks) through a series of reliable chemical transformations. One well-known example of such a chemical space is Enamine REAL Space (REadily AccessibLe) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib50" title="">50</a>]</cite>, which consists of 48 billion molecules. These molecules can be synthesized by applying 1-3-step synthetic transformations derived from approximately 170 well-validated parallel synthesis protocols to over 143,000 qualified building blocks. The synthesis and delivery of molecules within the REAL Space typically takes 3-4 weeks, with an average synthesis success rate of 80%, which attests to the validity of the way of constructing synthesizable chemical space. In this work, we aim to cover the REAL Space and extend it further by incorporating additional reactions and a greater number of reaction steps to mimic a general organic synthesis endeavor.</p>
</div>
<section class="ltx_subsubsection" id="S5.SSx1.SSSx1">
<h4 class="ltx_title ltx_title_subsubsection">Reaction templates</h4>
<div class="ltx_para ltx_noindent" id="S5.SSx1.SSSx1.p1">
<p class="ltx_p" id="S5.SSx1.SSSx1.p1.1">Reaction rules are encoded as strings using the SMARTS grammar <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib100" title="">100</a>]</cite>, known as reaction templates. We created a set of 86 reaction templates, which directly implement the 169 reactions used in the January 2022 version of the REAL Space. This set includes both bi-molecular and tri-molecular reactions, with deprotection reactions treated as separate entities. Reactions that can be represented by the same transformation rule are encoded using a single SMARTS string. The combination of this reaction template set and the Enamine building block list should cover a space similar to the REAL Space.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SSx1.SSSx1.p2">
<p class="ltx_p" id="S5.SSx1.SSSx1.p2.1">In addition to linking building blocks, we also considered more general chemical synthesis processes. We manually selected 29 additional reaction templates from Hartenfeller et al.’s <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib101" title="">101</a>]</cite> and Button et al.’s <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib102" title="">102</a>]</cite> template collection, which were not covered by the initial 86 reactions. These reactions include well-known organic transformations such as the Wittig reaction <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib103" title="">103</a>]</cite>, Buchwald-Hartwig reaction <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib104" title="">104</a>]</cite>, and various functional group conversions. This expanded set of reactions complements the REAL reactions by providing a closer approximation to general laboratory organic synthesis.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SSx1.SSSx1.p3">
<p class="ltx_p" id="S5.SSx1.SSSx1.p3.1">We acknowledge certain limitations in our templates: no reaction conditions, regioselectivity, or functional group compatibility are currently considered. The templates represent potential transformations, meaning that the chemical space we constructed likely represents a superset of the actual synthesizable chemical space. Furthermore, stereochemistry is not considered in our reaction rules, so stereocenters can only be inherited from the building blocks and cannot be installed during synthesis.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S5.SSx1.SSSx2">
<h4 class="ltx_title ltx_title_subsubsection">Building blocks</h4>
<div class="ltx_para ltx_noindent" id="S5.SSx1.SSSx2.p1">
<p class="ltx_p" id="S5.SSx1.SSSx2.p1.1">The building block list comprises reagents or intermediates that are commercially available and can be directly purchased from the market. This list can include any set of purchasable molecules, including those found in Enamine REAL Space. For this study, we utilized Enamine’s U.S. in-stock collection of building blocks, which was available for delivery as of October 1st, 2023. The building block list contains a total of 223,244 molecules. This selection was made to ensure the accessibility and immediate availability of the building blocks for synthesis.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S5.SSx1.SSSx3">
<h4 class="ltx_title ltx_title_subsubsection">Representing synthetic pathways using postfix notation</h4>
<div class="ltx_para ltx_noindent" id="S5.SSx1.SSSx3.p1">
<p class="ltx_p" id="S5.SSx1.SSSx3.p1.1">In SynFormer, synthetic pathways are represented using the <span class="ltx_text ltx_font_italic" id="S5.SSx1.SSSx3.p1.1.1">postfix notation of synthesis</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib67" title="">67</a>]</cite>. In this format, the operators (chemical reactions) follow their operands (molecular building blocks), providing a structured and concise way to represent reaction sequences. Each synthesis pathway is encoded as a sequence of tokens, where each token represents either a reaction step or a building block. This linear sequence simplifies the representation of converging synthetic pathways by eliminating the need for “parentheses” to indicate the order of operations, making it particularly amenable to autoregressive modeling. This approach enables efficient handling of complex synthetic routes while ensuring that each step in the pathway is captured in the correct order.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S5.SSx2">
<h3 class="ltx_title ltx_title_subsection">SynFormer</h3>
<div class="ltx_para ltx_noindent" id="S5.SSx2.p1">
<p class="ltx_p" id="S5.SSx2.p1.1">The SynFormer framework is a generative modeling architecture designed to explore synthesizable chemical space by generating synthetic pathways for molecules rather than molecular graphs. SynFormer is based on a transformer architecture with a diffusion module to select molecular building blocks. We designed two variants of the model to handle distinct molecular design tasks:</p>
<ul class="ltx_itemize" id="S5.I1">
<li class="ltx_item" id="S5.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i1.p1">
<p class="ltx_p" id="S5.I1.i1.p1.1">SynFormer-D, a decoder-only model designed for generating new molecules or optimizing molecules based on feedback from a black-box objective function.</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S5.I1.i2.p1">
<p class="ltx_p" id="S5.I1.i2.p1.1">SynFormer-ED, an encoder-decoder model that generates synthetic pathways based on a given reference molecule, enabling local chemical space exploration.</p>
</div>
</li>
</ul>
</div>
<section class="ltx_subsubsection" id="S5.SSx2.SSSx1">
<h4 class="ltx_title ltx_title_subsubsection">Transformer decoder</h4>
<div class="ltx_para ltx_noindent" id="S5.SSx2.SSSx1.p1">
<p class="ltx_p" id="S5.SSx2.SSSx1.p1.1">SynFormer adopts the transformer decoder architecture as its backbone <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib14" title="">14</a>]</cite>.
The decoder generates postfix notations of synthesis in an auto-regressive manner, which is, predicting the next token according to previous tokens.
We assign embedding vectors to each reaction template and the [START] token, and convert building blocks fingerprint into continuous-valued vectors with a multi-layer perceptron (MLP) in the beginning.
To indicate the position of each token within the sequence, we add positional encodings <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib14" title="">14</a>]</cite> to the embedding vectors.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SSx2.SSSx1.p2">
<p class="ltx_p" id="S5.SSx2.SSSx1.p2.1">The transformer decoder gathers information for each token from its preceding tokens via the multi-head attention mechanism <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib14" title="">14</a>]</cite>, where each token’s embedding vector is first projected to query, key, and value vectors, and then updated by aggregating the values of other tokens weighted by the softmax-ed inner product of the query vector and the other token’s key vector.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SSx2.SSSx1.p3">
<p class="ltx_p" id="S5.SSx2.SSSx1.p3.1">Following the transformer decoder, we use a classifier based on an MLP to predict the next token’s type.
If it is predicted as an [END] token, the decoding process will be terminated.
If it is predicted as a reaction, another classifier is used to predict the probability of each reaction template being the next token.
When the next token is predicted as a building block, a diffusion module is used to generate molecular fingerprints which are subsequently used to retrieve building blocks from the database.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S5.SSx2.SSSx2">
<h4 class="ltx_title ltx_title_subsubsection">Transformer encoder</h4>
<div class="ltx_para ltx_noindent" id="S5.SSx2.SSSx2.p1">
<p class="ltx_p" id="S5.SSx2.SSSx2.p1.1">The transformer decoder can be conditioned by a transformer encoder, i.e., given reference molecule represented by a SMILES string.
The transformer encoder produces vector representations for each token in the SMILES string, which the decoder can attend to via the cross attention mechanism <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib14" title="">14</a>]</cite>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S5.SSx2.SSSx3">
<h4 class="ltx_title ltx_title_subsubsection">Diffusion module for building block fingerprints</h4>
<div class="ltx_para ltx_noindent" id="S5.SSx2.SSSx3.p1">
<p class="ltx_p" id="S5.SSx2.SSSx3.p1.3">We build a denoising diffusion model to learn the distribution of molecular fingerprints, represented as <math alttext="n" class="ltx_Math" display="inline" id="S5.SSx2.SSSx3.p1.1.m1.1"><semantics id="S5.SSx2.SSSx3.p1.1.m1.1a"><mi id="S5.SSx2.SSSx3.p1.1.m1.1.1" xref="S5.SSx2.SSSx3.p1.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S5.SSx2.SSSx3.p1.1.m1.1b"><ci id="S5.SSx2.SSSx3.p1.1.m1.1.1.cmml" xref="S5.SSx2.SSSx3.p1.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SSx2.SSSx3.p1.1.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="S5.SSx2.SSSx3.p1.1.m1.1d">italic_n</annotation></semantics></math>-dimensional binary vectors, where <math alttext="n" class="ltx_Math" display="inline" id="S5.SSx2.SSSx3.p1.2.m2.1"><semantics id="S5.SSx2.SSSx3.p1.2.m2.1a"><mi id="S5.SSx2.SSSx3.p1.2.m2.1.1" xref="S5.SSx2.SSSx3.p1.2.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S5.SSx2.SSSx3.p1.2.m2.1b"><ci id="S5.SSx2.SSSx3.p1.2.m2.1.1.cmml" xref="S5.SSx2.SSSx3.p1.2.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SSx2.SSSx3.p1.2.m2.1c">n</annotation><annotation encoding="application/x-llamapun" id="S5.SSx2.SSSx3.p1.2.m2.1d">italic_n</annotation></semantics></math> denotes the number of bits in the fingerprint. This distribution is modeled as a joint Bernoulli binary distribution of <math alttext="n" class="ltx_Math" display="inline" id="S5.SSx2.SSSx3.p1.3.m3.1"><semantics id="S5.SSx2.SSSx3.p1.3.m3.1a"><mi id="S5.SSx2.SSSx3.p1.3.m3.1.1" xref="S5.SSx2.SSSx3.p1.3.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S5.SSx2.SSSx3.p1.3.m3.1b"><ci id="S5.SSx2.SSSx3.p1.3.m3.1.1.cmml" xref="S5.SSx2.SSSx3.p1.3.m3.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SSx2.SSSx3.p1.3.m3.1c">n</annotation><annotation encoding="application/x-llamapun" id="S5.SSx2.SSSx3.p1.3.m3.1d">italic_n</annotation></semantics></math> dimensions.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SSx2.SSSx3.p2">
<p class="ltx_p" id="S5.SSx2.SSSx3.p2.8">During training, the forward diffusion process perturbs the fingerprint vector by randomly flipping each bit according to the following noise distribution:</p>
<table class="ltx_equation ltx_eqn_table" id="S5.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="q(x_{t}^{(j)}|x_{0}^{(j)})=\operatorname{Bernoulli}(x_{t}^{(j)}\mid\bar{\alpha%
_{t}}x_{0}^{(j)}+(1-\bar{\alpha_{t}})\cdot\frac{1}{2})," class="ltx_Math" display="block" id="S5.E1.m1.6"><semantics id="S5.E1.m1.6a"><mrow id="S5.E1.m1.6.6.1" xref="S5.E1.m1.6.6.1.1.cmml"><mrow id="S5.E1.m1.6.6.1.1" xref="S5.E1.m1.6.6.1.1.cmml"><mrow id="S5.E1.m1.6.6.1.1.1" xref="S5.E1.m1.6.6.1.1.1.cmml"><mi id="S5.E1.m1.6.6.1.1.1.3" xref="S5.E1.m1.6.6.1.1.1.3.cmml">q</mi><mo id="S5.E1.m1.6.6.1.1.1.2" xref="S5.E1.m1.6.6.1.1.1.2.cmml">⁢</mo><mrow id="S5.E1.m1.6.6.1.1.1.1.1" xref="S5.E1.m1.6.6.1.1.1.1.1.1.cmml"><mo id="S5.E1.m1.6.6.1.1.1.1.1.2" stretchy="false" xref="S5.E1.m1.6.6.1.1.1.1.1.1.cmml">(</mo><mrow id="S5.E1.m1.6.6.1.1.1.1.1.1" xref="S5.E1.m1.6.6.1.1.1.1.1.1.cmml"><msubsup id="S5.E1.m1.6.6.1.1.1.1.1.1.2" xref="S5.E1.m1.6.6.1.1.1.1.1.1.2.cmml"><mi id="S5.E1.m1.6.6.1.1.1.1.1.1.2.2.2" xref="S5.E1.m1.6.6.1.1.1.1.1.1.2.2.2.cmml">x</mi><mi id="S5.E1.m1.6.6.1.1.1.1.1.1.2.2.3" xref="S5.E1.m1.6.6.1.1.1.1.1.1.2.2.3.cmml">t</mi><mrow id="S5.E1.m1.1.1.1.3" xref="S5.E1.m1.6.6.1.1.1.1.1.1.2.cmml"><mo id="S5.E1.m1.1.1.1.3.1" stretchy="false" xref="S5.E1.m1.6.6.1.1.1.1.1.1.2.cmml">(</mo><mi id="S5.E1.m1.1.1.1.1" xref="S5.E1.m1.1.1.1.1.cmml">j</mi><mo id="S5.E1.m1.1.1.1.3.2" stretchy="false" xref="S5.E1.m1.6.6.1.1.1.1.1.1.2.cmml">)</mo></mrow></msubsup><mo fence="false" id="S5.E1.m1.6.6.1.1.1.1.1.1.1" xref="S5.E1.m1.6.6.1.1.1.1.1.1.1.cmml">|</mo><msubsup id="S5.E1.m1.6.6.1.1.1.1.1.1.3" xref="S5.E1.m1.6.6.1.1.1.1.1.1.3.cmml"><mi id="S5.E1.m1.6.6.1.1.1.1.1.1.3.2.2" xref="S5.E1.m1.6.6.1.1.1.1.1.1.3.2.2.cmml">x</mi><mn id="S5.E1.m1.6.6.1.1.1.1.1.1.3.2.3" xref="S5.E1.m1.6.6.1.1.1.1.1.1.3.2.3.cmml">0</mn><mrow id="S5.E1.m1.2.2.1.3" xref="S5.E1.m1.6.6.1.1.1.1.1.1.3.cmml"><mo id="S5.E1.m1.2.2.1.3.1" stretchy="false" xref="S5.E1.m1.6.6.1.1.1.1.1.1.3.cmml">(</mo><mi id="S5.E1.m1.2.2.1.1" xref="S5.E1.m1.2.2.1.1.cmml">j</mi><mo id="S5.E1.m1.2.2.1.3.2" stretchy="false" xref="S5.E1.m1.6.6.1.1.1.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo id="S5.E1.m1.6.6.1.1.1.1.1.3" stretchy="false" xref="S5.E1.m1.6.6.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S5.E1.m1.6.6.1.1.3" xref="S5.E1.m1.6.6.1.1.3.cmml">=</mo><mrow id="S5.E1.m1.6.6.1.1.2.1" xref="S5.E1.m1.6.6.1.1.2.2.cmml"><mi id="S5.E1.m1.5.5" xref="S5.E1.m1.5.5.cmml">Bernoulli</mi><mo id="S5.E1.m1.6.6.1.1.2.1a" xref="S5.E1.m1.6.6.1.1.2.2.cmml">⁡</mo><mrow id="S5.E1.m1.6.6.1.1.2.1.1" xref="S5.E1.m1.6.6.1.1.2.2.cmml"><mo id="S5.E1.m1.6.6.1.1.2.1.1.2" stretchy="false" xref="S5.E1.m1.6.6.1.1.2.2.cmml">(</mo><mrow id="S5.E1.m1.6.6.1.1.2.1.1.1" xref="S5.E1.m1.6.6.1.1.2.1.1.1.cmml"><msubsup id="S5.E1.m1.6.6.1.1.2.1.1.1.3" xref="S5.E1.m1.6.6.1.1.2.1.1.1.3.cmml"><mi id="S5.E1.m1.6.6.1.1.2.1.1.1.3.2.2" xref="S5.E1.m1.6.6.1.1.2.1.1.1.3.2.2.cmml">x</mi><mi id="S5.E1.m1.6.6.1.1.2.1.1.1.3.2.3" xref="S5.E1.m1.6.6.1.1.2.1.1.1.3.2.3.cmml">t</mi><mrow id="S5.E1.m1.3.3.1.3" xref="S5.E1.m1.6.6.1.1.2.1.1.1.3.cmml"><mo id="S5.E1.m1.3.3.1.3.1" stretchy="false" xref="S5.E1.m1.6.6.1.1.2.1.1.1.3.cmml">(</mo><mi id="S5.E1.m1.3.3.1.1" xref="S5.E1.m1.3.3.1.1.cmml">j</mi><mo id="S5.E1.m1.3.3.1.3.2" stretchy="false" xref="S5.E1.m1.6.6.1.1.2.1.1.1.3.cmml">)</mo></mrow></msubsup><mo id="S5.E1.m1.6.6.1.1.2.1.1.1.2" xref="S5.E1.m1.6.6.1.1.2.1.1.1.2.cmml">∣</mo><mrow id="S5.E1.m1.6.6.1.1.2.1.1.1.1" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.cmml"><mrow id="S5.E1.m1.6.6.1.1.2.1.1.1.1.3" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.3.cmml"><mover accent="true" id="S5.E1.m1.6.6.1.1.2.1.1.1.1.3.2" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.3.2.cmml"><msub id="S5.E1.m1.6.6.1.1.2.1.1.1.1.3.2.2" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.3.2.2.cmml"><mi id="S5.E1.m1.6.6.1.1.2.1.1.1.1.3.2.2.2" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.3.2.2.2.cmml">α</mi><mi id="S5.E1.m1.6.6.1.1.2.1.1.1.1.3.2.2.3" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.3.2.2.3.cmml">t</mi></msub><mo id="S5.E1.m1.6.6.1.1.2.1.1.1.1.3.2.1" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.3.2.1.cmml">¯</mo></mover><mo id="S5.E1.m1.6.6.1.1.2.1.1.1.1.3.1" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.3.1.cmml">⁢</mo><msubsup id="S5.E1.m1.6.6.1.1.2.1.1.1.1.3.3" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.3.3.cmml"><mi id="S5.E1.m1.6.6.1.1.2.1.1.1.1.3.3.2.2" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.3.3.2.2.cmml">x</mi><mn id="S5.E1.m1.6.6.1.1.2.1.1.1.1.3.3.2.3" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.3.3.2.3.cmml">0</mn><mrow id="S5.E1.m1.4.4.1.3" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.3.3.cmml"><mo id="S5.E1.m1.4.4.1.3.1" stretchy="false" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.3.3.cmml">(</mo><mi id="S5.E1.m1.4.4.1.1" xref="S5.E1.m1.4.4.1.1.cmml">j</mi><mo id="S5.E1.m1.4.4.1.3.2" stretchy="false" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.3.3.cmml">)</mo></mrow></msubsup></mrow><mo id="S5.E1.m1.6.6.1.1.2.1.1.1.1.2" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.2.cmml">+</mo><mrow id="S5.E1.m1.6.6.1.1.2.1.1.1.1.1" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.cmml"><mrow id="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.1.1" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.cmml"><mo id="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.1.1.2" stretchy="false" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.1.1.1" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.cmml"><mn id="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.2" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.1" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.1.cmml">−</mo><mover accent="true" id="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3.cmml"><msub id="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3.2" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3.2.2" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3.2.2.cmml">α</mi><mi id="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3.2.3" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3.2.3.cmml">t</mi></msub><mo id="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3.1" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3.1.cmml">¯</mo></mover></mrow><mo id="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.2" rspace="0.222em" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.2.cmml">⋅</mo><mfrac id="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.3" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.3.cmml"><mn id="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.3.2" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.3.2.cmml">1</mn><mn id="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.3.3" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.3.3.cmml">2</mn></mfrac></mrow></mrow></mrow><mo id="S5.E1.m1.6.6.1.1.2.1.1.3" stretchy="false" xref="S5.E1.m1.6.6.1.1.2.2.cmml">)</mo></mrow></mrow></mrow><mo id="S5.E1.m1.6.6.1.2" xref="S5.E1.m1.6.6.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E1.m1.6b"><apply id="S5.E1.m1.6.6.1.1.cmml" xref="S5.E1.m1.6.6.1"><eq id="S5.E1.m1.6.6.1.1.3.cmml" xref="S5.E1.m1.6.6.1.1.3"></eq><apply id="S5.E1.m1.6.6.1.1.1.cmml" xref="S5.E1.m1.6.6.1.1.1"><times id="S5.E1.m1.6.6.1.1.1.2.cmml" xref="S5.E1.m1.6.6.1.1.1.2"></times><ci id="S5.E1.m1.6.6.1.1.1.3.cmml" xref="S5.E1.m1.6.6.1.1.1.3">𝑞</ci><apply id="S5.E1.m1.6.6.1.1.1.1.1.1.cmml" xref="S5.E1.m1.6.6.1.1.1.1.1"><csymbol cd="latexml" id="S5.E1.m1.6.6.1.1.1.1.1.1.1.cmml" xref="S5.E1.m1.6.6.1.1.1.1.1.1.1">conditional</csymbol><apply id="S5.E1.m1.6.6.1.1.1.1.1.1.2.cmml" xref="S5.E1.m1.6.6.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.E1.m1.6.6.1.1.1.1.1.1.2.1.cmml" xref="S5.E1.m1.6.6.1.1.1.1.1.1.2">superscript</csymbol><apply id="S5.E1.m1.6.6.1.1.1.1.1.1.2.2.cmml" xref="S5.E1.m1.6.6.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.E1.m1.6.6.1.1.1.1.1.1.2.2.1.cmml" xref="S5.E1.m1.6.6.1.1.1.1.1.1.2">subscript</csymbol><ci id="S5.E1.m1.6.6.1.1.1.1.1.1.2.2.2.cmml" xref="S5.E1.m1.6.6.1.1.1.1.1.1.2.2.2">𝑥</ci><ci id="S5.E1.m1.6.6.1.1.1.1.1.1.2.2.3.cmml" xref="S5.E1.m1.6.6.1.1.1.1.1.1.2.2.3">𝑡</ci></apply><ci id="S5.E1.m1.1.1.1.1.cmml" xref="S5.E1.m1.1.1.1.1">𝑗</ci></apply><apply id="S5.E1.m1.6.6.1.1.1.1.1.1.3.cmml" xref="S5.E1.m1.6.6.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.E1.m1.6.6.1.1.1.1.1.1.3.1.cmml" xref="S5.E1.m1.6.6.1.1.1.1.1.1.3">superscript</csymbol><apply id="S5.E1.m1.6.6.1.1.1.1.1.1.3.2.cmml" xref="S5.E1.m1.6.6.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.E1.m1.6.6.1.1.1.1.1.1.3.2.1.cmml" xref="S5.E1.m1.6.6.1.1.1.1.1.1.3">subscript</csymbol><ci id="S5.E1.m1.6.6.1.1.1.1.1.1.3.2.2.cmml" xref="S5.E1.m1.6.6.1.1.1.1.1.1.3.2.2">𝑥</ci><cn id="S5.E1.m1.6.6.1.1.1.1.1.1.3.2.3.cmml" type="integer" xref="S5.E1.m1.6.6.1.1.1.1.1.1.3.2.3">0</cn></apply><ci id="S5.E1.m1.2.2.1.1.cmml" xref="S5.E1.m1.2.2.1.1">𝑗</ci></apply></apply></apply><apply id="S5.E1.m1.6.6.1.1.2.2.cmml" xref="S5.E1.m1.6.6.1.1.2.1"><ci id="S5.E1.m1.5.5.cmml" xref="S5.E1.m1.5.5">Bernoulli</ci><apply id="S5.E1.m1.6.6.1.1.2.1.1.1.cmml" xref="S5.E1.m1.6.6.1.1.2.1.1.1"><csymbol cd="latexml" id="S5.E1.m1.6.6.1.1.2.1.1.1.2.cmml" xref="S5.E1.m1.6.6.1.1.2.1.1.1.2">conditional</csymbol><apply id="S5.E1.m1.6.6.1.1.2.1.1.1.3.cmml" xref="S5.E1.m1.6.6.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="S5.E1.m1.6.6.1.1.2.1.1.1.3.1.cmml" xref="S5.E1.m1.6.6.1.1.2.1.1.1.3">superscript</csymbol><apply id="S5.E1.m1.6.6.1.1.2.1.1.1.3.2.cmml" xref="S5.E1.m1.6.6.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="S5.E1.m1.6.6.1.1.2.1.1.1.3.2.1.cmml" xref="S5.E1.m1.6.6.1.1.2.1.1.1.3">subscript</csymbol><ci id="S5.E1.m1.6.6.1.1.2.1.1.1.3.2.2.cmml" xref="S5.E1.m1.6.6.1.1.2.1.1.1.3.2.2">𝑥</ci><ci id="S5.E1.m1.6.6.1.1.2.1.1.1.3.2.3.cmml" xref="S5.E1.m1.6.6.1.1.2.1.1.1.3.2.3">𝑡</ci></apply><ci id="S5.E1.m1.3.3.1.1.cmml" xref="S5.E1.m1.3.3.1.1">𝑗</ci></apply><apply id="S5.E1.m1.6.6.1.1.2.1.1.1.1.cmml" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1"><plus id="S5.E1.m1.6.6.1.1.2.1.1.1.1.2.cmml" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.2"></plus><apply id="S5.E1.m1.6.6.1.1.2.1.1.1.1.3.cmml" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.3"><times id="S5.E1.m1.6.6.1.1.2.1.1.1.1.3.1.cmml" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.3.1"></times><apply id="S5.E1.m1.6.6.1.1.2.1.1.1.1.3.2.cmml" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.3.2"><ci id="S5.E1.m1.6.6.1.1.2.1.1.1.1.3.2.1.cmml" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.3.2.1">¯</ci><apply id="S5.E1.m1.6.6.1.1.2.1.1.1.1.3.2.2.cmml" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S5.E1.m1.6.6.1.1.2.1.1.1.1.3.2.2.1.cmml" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.3.2.2">subscript</csymbol><ci id="S5.E1.m1.6.6.1.1.2.1.1.1.1.3.2.2.2.cmml" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.3.2.2.2">𝛼</ci><ci id="S5.E1.m1.6.6.1.1.2.1.1.1.1.3.2.2.3.cmml" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.3.2.2.3">𝑡</ci></apply></apply><apply id="S5.E1.m1.6.6.1.1.2.1.1.1.1.3.3.cmml" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S5.E1.m1.6.6.1.1.2.1.1.1.1.3.3.1.cmml" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.3.3">superscript</csymbol><apply id="S5.E1.m1.6.6.1.1.2.1.1.1.1.3.3.2.cmml" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S5.E1.m1.6.6.1.1.2.1.1.1.1.3.3.2.1.cmml" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.3.3">subscript</csymbol><ci id="S5.E1.m1.6.6.1.1.2.1.1.1.1.3.3.2.2.cmml" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.3.3.2.2">𝑥</ci><cn id="S5.E1.m1.6.6.1.1.2.1.1.1.1.3.3.2.3.cmml" type="integer" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.3.3.2.3">0</cn></apply><ci id="S5.E1.m1.4.4.1.1.cmml" xref="S5.E1.m1.4.4.1.1">𝑗</ci></apply></apply><apply id="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.cmml" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.1"><ci id="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.2.cmml" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.2">⋅</ci><apply id="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.1.1"><minus id="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.1.cmml" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.1"></minus><cn id="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.2">1</cn><apply id="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3.cmml" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3"><ci id="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3.1">¯</ci><apply id="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3.2.2">𝛼</ci><ci id="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3.2.3">𝑡</ci></apply></apply></apply><apply id="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.3.cmml" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.3"><divide id="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.3.1.cmml" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.3"></divide><cn id="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.3.2.cmml" type="integer" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.3.2">1</cn><cn id="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.3.3.cmml" type="integer" xref="S5.E1.m1.6.6.1.1.2.1.1.1.1.1.3.3">2</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E1.m1.6c">q(x_{t}^{(j)}|x_{0}^{(j)})=\operatorname{Bernoulli}(x_{t}^{(j)}\mid\bar{\alpha%
_{t}}x_{0}^{(j)}+(1-\bar{\alpha_{t}})\cdot\frac{1}{2}),</annotation><annotation encoding="application/x-llamapun" id="S5.E1.m1.6d">italic_q ( italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT | italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT ) = roman_Bernoulli ( italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT ∣ over¯ start_ARG italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT + ( 1 - over¯ start_ARG italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG ) ⋅ divide start_ARG 1 end_ARG start_ARG 2 end_ARG ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S5.SSx2.SSSx3.p2.7">where <math alttext="x_{0}^{(j)}" class="ltx_Math" display="inline" id="S5.SSx2.SSSx3.p2.1.m1.1"><semantics id="S5.SSx2.SSSx3.p2.1.m1.1a"><msubsup id="S5.SSx2.SSSx3.p2.1.m1.1.2" xref="S5.SSx2.SSSx3.p2.1.m1.1.2.cmml"><mi id="S5.SSx2.SSSx3.p2.1.m1.1.2.2.2" xref="S5.SSx2.SSSx3.p2.1.m1.1.2.2.2.cmml">x</mi><mn id="S5.SSx2.SSSx3.p2.1.m1.1.2.2.3" xref="S5.SSx2.SSSx3.p2.1.m1.1.2.2.3.cmml">0</mn><mrow id="S5.SSx2.SSSx3.p2.1.m1.1.1.1.3" xref="S5.SSx2.SSSx3.p2.1.m1.1.2.cmml"><mo id="S5.SSx2.SSSx3.p2.1.m1.1.1.1.3.1" stretchy="false" xref="S5.SSx2.SSSx3.p2.1.m1.1.2.cmml">(</mo><mi id="S5.SSx2.SSSx3.p2.1.m1.1.1.1.1" xref="S5.SSx2.SSSx3.p2.1.m1.1.1.1.1.cmml">j</mi><mo id="S5.SSx2.SSSx3.p2.1.m1.1.1.1.3.2" stretchy="false" xref="S5.SSx2.SSSx3.p2.1.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S5.SSx2.SSSx3.p2.1.m1.1b"><apply id="S5.SSx2.SSSx3.p2.1.m1.1.2.cmml" xref="S5.SSx2.SSSx3.p2.1.m1.1.2"><csymbol cd="ambiguous" id="S5.SSx2.SSSx3.p2.1.m1.1.2.1.cmml" xref="S5.SSx2.SSSx3.p2.1.m1.1.2">superscript</csymbol><apply id="S5.SSx2.SSSx3.p2.1.m1.1.2.2.cmml" xref="S5.SSx2.SSSx3.p2.1.m1.1.2"><csymbol cd="ambiguous" id="S5.SSx2.SSSx3.p2.1.m1.1.2.2.1.cmml" xref="S5.SSx2.SSSx3.p2.1.m1.1.2">subscript</csymbol><ci id="S5.SSx2.SSSx3.p2.1.m1.1.2.2.2.cmml" xref="S5.SSx2.SSSx3.p2.1.m1.1.2.2.2">𝑥</ci><cn id="S5.SSx2.SSSx3.p2.1.m1.1.2.2.3.cmml" type="integer" xref="S5.SSx2.SSSx3.p2.1.m1.1.2.2.3">0</cn></apply><ci id="S5.SSx2.SSSx3.p2.1.m1.1.1.1.1.cmml" xref="S5.SSx2.SSSx3.p2.1.m1.1.1.1.1">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SSx2.SSSx3.p2.1.m1.1c">x_{0}^{(j)}</annotation><annotation encoding="application/x-llamapun" id="S5.SSx2.SSSx3.p2.1.m1.1d">italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT</annotation></semantics></math> represents the <math alttext="j" class="ltx_Math" display="inline" id="S5.SSx2.SSSx3.p2.2.m2.1"><semantics id="S5.SSx2.SSSx3.p2.2.m2.1a"><mi id="S5.SSx2.SSSx3.p2.2.m2.1.1" xref="S5.SSx2.SSSx3.p2.2.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S5.SSx2.SSSx3.p2.2.m2.1b"><ci id="S5.SSx2.SSSx3.p2.2.m2.1.1.cmml" xref="S5.SSx2.SSSx3.p2.2.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SSx2.SSSx3.p2.2.m2.1c">j</annotation><annotation encoding="application/x-llamapun" id="S5.SSx2.SSSx3.p2.2.m2.1d">italic_j</annotation></semantics></math>-th bit of the ground truth fingerprint vector, and <math alttext="x_{t}^{(j)}" class="ltx_Math" display="inline" id="S5.SSx2.SSSx3.p2.3.m3.1"><semantics id="S5.SSx2.SSSx3.p2.3.m3.1a"><msubsup id="S5.SSx2.SSSx3.p2.3.m3.1.2" xref="S5.SSx2.SSSx3.p2.3.m3.1.2.cmml"><mi id="S5.SSx2.SSSx3.p2.3.m3.1.2.2.2" xref="S5.SSx2.SSSx3.p2.3.m3.1.2.2.2.cmml">x</mi><mi id="S5.SSx2.SSSx3.p2.3.m3.1.2.2.3" xref="S5.SSx2.SSSx3.p2.3.m3.1.2.2.3.cmml">t</mi><mrow id="S5.SSx2.SSSx3.p2.3.m3.1.1.1.3" xref="S5.SSx2.SSSx3.p2.3.m3.1.2.cmml"><mo id="S5.SSx2.SSSx3.p2.3.m3.1.1.1.3.1" stretchy="false" xref="S5.SSx2.SSSx3.p2.3.m3.1.2.cmml">(</mo><mi id="S5.SSx2.SSSx3.p2.3.m3.1.1.1.1" xref="S5.SSx2.SSSx3.p2.3.m3.1.1.1.1.cmml">j</mi><mo id="S5.SSx2.SSSx3.p2.3.m3.1.1.1.3.2" stretchy="false" xref="S5.SSx2.SSSx3.p2.3.m3.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S5.SSx2.SSSx3.p2.3.m3.1b"><apply id="S5.SSx2.SSSx3.p2.3.m3.1.2.cmml" xref="S5.SSx2.SSSx3.p2.3.m3.1.2"><csymbol cd="ambiguous" id="S5.SSx2.SSSx3.p2.3.m3.1.2.1.cmml" xref="S5.SSx2.SSSx3.p2.3.m3.1.2">superscript</csymbol><apply id="S5.SSx2.SSSx3.p2.3.m3.1.2.2.cmml" xref="S5.SSx2.SSSx3.p2.3.m3.1.2"><csymbol cd="ambiguous" id="S5.SSx2.SSSx3.p2.3.m3.1.2.2.1.cmml" xref="S5.SSx2.SSSx3.p2.3.m3.1.2">subscript</csymbol><ci id="S5.SSx2.SSSx3.p2.3.m3.1.2.2.2.cmml" xref="S5.SSx2.SSSx3.p2.3.m3.1.2.2.2">𝑥</ci><ci id="S5.SSx2.SSSx3.p2.3.m3.1.2.2.3.cmml" xref="S5.SSx2.SSSx3.p2.3.m3.1.2.2.3">𝑡</ci></apply><ci id="S5.SSx2.SSSx3.p2.3.m3.1.1.1.1.cmml" xref="S5.SSx2.SSSx3.p2.3.m3.1.1.1.1">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SSx2.SSSx3.p2.3.m3.1c">x_{t}^{(j)}</annotation><annotation encoding="application/x-llamapun" id="S5.SSx2.SSSx3.p2.3.m3.1d">italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT</annotation></semantics></math> represents the perturbed bit.
Here, <math alttext="\bar{\alpha_{t}}" class="ltx_Math" display="inline" id="S5.SSx2.SSSx3.p2.4.m4.1"><semantics id="S5.SSx2.SSSx3.p2.4.m4.1a"><mover accent="true" id="S5.SSx2.SSSx3.p2.4.m4.1.1" xref="S5.SSx2.SSSx3.p2.4.m4.1.1.cmml"><msub id="S5.SSx2.SSSx3.p2.4.m4.1.1.2" xref="S5.SSx2.SSSx3.p2.4.m4.1.1.2.cmml"><mi id="S5.SSx2.SSSx3.p2.4.m4.1.1.2.2" xref="S5.SSx2.SSSx3.p2.4.m4.1.1.2.2.cmml">α</mi><mi id="S5.SSx2.SSSx3.p2.4.m4.1.1.2.3" xref="S5.SSx2.SSSx3.p2.4.m4.1.1.2.3.cmml">t</mi></msub><mo id="S5.SSx2.SSSx3.p2.4.m4.1.1.1" xref="S5.SSx2.SSSx3.p2.4.m4.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S5.SSx2.SSSx3.p2.4.m4.1b"><apply id="S5.SSx2.SSSx3.p2.4.m4.1.1.cmml" xref="S5.SSx2.SSSx3.p2.4.m4.1.1"><ci id="S5.SSx2.SSSx3.p2.4.m4.1.1.1.cmml" xref="S5.SSx2.SSSx3.p2.4.m4.1.1.1">¯</ci><apply id="S5.SSx2.SSSx3.p2.4.m4.1.1.2.cmml" xref="S5.SSx2.SSSx3.p2.4.m4.1.1.2"><csymbol cd="ambiguous" id="S5.SSx2.SSSx3.p2.4.m4.1.1.2.1.cmml" xref="S5.SSx2.SSSx3.p2.4.m4.1.1.2">subscript</csymbol><ci id="S5.SSx2.SSSx3.p2.4.m4.1.1.2.2.cmml" xref="S5.SSx2.SSSx3.p2.4.m4.1.1.2.2">𝛼</ci><ci id="S5.SSx2.SSSx3.p2.4.m4.1.1.2.3.cmml" xref="S5.SSx2.SSSx3.p2.4.m4.1.1.2.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SSx2.SSSx3.p2.4.m4.1c">\bar{\alpha_{t}}</annotation><annotation encoding="application/x-llamapun" id="S5.SSx2.SSSx3.p2.4.m4.1d">over¯ start_ARG italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG</annotation></semantics></math> is a value that controls the noise level, which we define using a formulation similar to multinomial diffusion <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib70" title="">70</a>]</cite>.
<math alttext="\bar{\alpha_{t}}" class="ltx_Math" display="inline" id="S5.SSx2.SSSx3.p2.5.m5.1"><semantics id="S5.SSx2.SSSx3.p2.5.m5.1a"><mover accent="true" id="S5.SSx2.SSSx3.p2.5.m5.1.1" xref="S5.SSx2.SSSx3.p2.5.m5.1.1.cmml"><msub id="S5.SSx2.SSSx3.p2.5.m5.1.1.2" xref="S5.SSx2.SSSx3.p2.5.m5.1.1.2.cmml"><mi id="S5.SSx2.SSSx3.p2.5.m5.1.1.2.2" xref="S5.SSx2.SSSx3.p2.5.m5.1.1.2.2.cmml">α</mi><mi id="S5.SSx2.SSSx3.p2.5.m5.1.1.2.3" xref="S5.SSx2.SSSx3.p2.5.m5.1.1.2.3.cmml">t</mi></msub><mo id="S5.SSx2.SSSx3.p2.5.m5.1.1.1" xref="S5.SSx2.SSSx3.p2.5.m5.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S5.SSx2.SSSx3.p2.5.m5.1b"><apply id="S5.SSx2.SSSx3.p2.5.m5.1.1.cmml" xref="S5.SSx2.SSSx3.p2.5.m5.1.1"><ci id="S5.SSx2.SSSx3.p2.5.m5.1.1.1.cmml" xref="S5.SSx2.SSSx3.p2.5.m5.1.1.1">¯</ci><apply id="S5.SSx2.SSSx3.p2.5.m5.1.1.2.cmml" xref="S5.SSx2.SSSx3.p2.5.m5.1.1.2"><csymbol cd="ambiguous" id="S5.SSx2.SSSx3.p2.5.m5.1.1.2.1.cmml" xref="S5.SSx2.SSSx3.p2.5.m5.1.1.2">subscript</csymbol><ci id="S5.SSx2.SSSx3.p2.5.m5.1.1.2.2.cmml" xref="S5.SSx2.SSSx3.p2.5.m5.1.1.2.2">𝛼</ci><ci id="S5.SSx2.SSSx3.p2.5.m5.1.1.2.3.cmml" xref="S5.SSx2.SSSx3.p2.5.m5.1.1.2.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SSx2.SSSx3.p2.5.m5.1c">\bar{\alpha_{t}}</annotation><annotation encoding="application/x-llamapun" id="S5.SSx2.SSSx3.p2.5.m5.1d">over¯ start_ARG italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG</annotation></semantics></math> starts at 1 and monotonically decreases to 0.
When <math alttext="\bar{\alpha_{t}}=0" class="ltx_Math" display="inline" id="S5.SSx2.SSSx3.p2.6.m6.1"><semantics id="S5.SSx2.SSSx3.p2.6.m6.1a"><mrow id="S5.SSx2.SSSx3.p2.6.m6.1.1" xref="S5.SSx2.SSSx3.p2.6.m6.1.1.cmml"><mover accent="true" id="S5.SSx2.SSSx3.p2.6.m6.1.1.2" xref="S5.SSx2.SSSx3.p2.6.m6.1.1.2.cmml"><msub id="S5.SSx2.SSSx3.p2.6.m6.1.1.2.2" xref="S5.SSx2.SSSx3.p2.6.m6.1.1.2.2.cmml"><mi id="S5.SSx2.SSSx3.p2.6.m6.1.1.2.2.2" xref="S5.SSx2.SSSx3.p2.6.m6.1.1.2.2.2.cmml">α</mi><mi id="S5.SSx2.SSSx3.p2.6.m6.1.1.2.2.3" xref="S5.SSx2.SSSx3.p2.6.m6.1.1.2.2.3.cmml">t</mi></msub><mo id="S5.SSx2.SSSx3.p2.6.m6.1.1.2.1" xref="S5.SSx2.SSSx3.p2.6.m6.1.1.2.1.cmml">¯</mo></mover><mo id="S5.SSx2.SSSx3.p2.6.m6.1.1.1" xref="S5.SSx2.SSSx3.p2.6.m6.1.1.1.cmml">=</mo><mn id="S5.SSx2.SSSx3.p2.6.m6.1.1.3" xref="S5.SSx2.SSSx3.p2.6.m6.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SSx2.SSSx3.p2.6.m6.1b"><apply id="S5.SSx2.SSSx3.p2.6.m6.1.1.cmml" xref="S5.SSx2.SSSx3.p2.6.m6.1.1"><eq id="S5.SSx2.SSSx3.p2.6.m6.1.1.1.cmml" xref="S5.SSx2.SSSx3.p2.6.m6.1.1.1"></eq><apply id="S5.SSx2.SSSx3.p2.6.m6.1.1.2.cmml" xref="S5.SSx2.SSSx3.p2.6.m6.1.1.2"><ci id="S5.SSx2.SSSx3.p2.6.m6.1.1.2.1.cmml" xref="S5.SSx2.SSSx3.p2.6.m6.1.1.2.1">¯</ci><apply id="S5.SSx2.SSSx3.p2.6.m6.1.1.2.2.cmml" xref="S5.SSx2.SSSx3.p2.6.m6.1.1.2.2"><csymbol cd="ambiguous" id="S5.SSx2.SSSx3.p2.6.m6.1.1.2.2.1.cmml" xref="S5.SSx2.SSSx3.p2.6.m6.1.1.2.2">subscript</csymbol><ci id="S5.SSx2.SSSx3.p2.6.m6.1.1.2.2.2.cmml" xref="S5.SSx2.SSSx3.p2.6.m6.1.1.2.2.2">𝛼</ci><ci id="S5.SSx2.SSSx3.p2.6.m6.1.1.2.2.3.cmml" xref="S5.SSx2.SSSx3.p2.6.m6.1.1.2.2.3">𝑡</ci></apply></apply><cn id="S5.SSx2.SSSx3.p2.6.m6.1.1.3.cmml" type="integer" xref="S5.SSx2.SSSx3.p2.6.m6.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SSx2.SSSx3.p2.6.m6.1c">\bar{\alpha_{t}}=0</annotation><annotation encoding="application/x-llamapun" id="S5.SSx2.SSSx3.p2.6.m6.1d">over¯ start_ARG italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG = 0</annotation></semantics></math>, the distribution <math alttext="q" class="ltx_Math" display="inline" id="S5.SSx2.SSSx3.p2.7.m7.1"><semantics id="S5.SSx2.SSSx3.p2.7.m7.1a"><mi id="S5.SSx2.SSSx3.p2.7.m7.1.1" xref="S5.SSx2.SSSx3.p2.7.m7.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S5.SSx2.SSSx3.p2.7.m7.1b"><ci id="S5.SSx2.SSSx3.p2.7.m7.1.1.cmml" xref="S5.SSx2.SSSx3.p2.7.m7.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SSx2.SSSx3.p2.7.m7.1c">q</annotation><annotation encoding="application/x-llamapun" id="S5.SSx2.SSSx3.p2.7.m7.1d">italic_q</annotation></semantics></math> becomes the uniform Bernoulli distribution, where the noise level reaches the maximum.
The denoiser network learns the bitwise Bernoulli distribution of ground truth fingerprints conditioned on the perturb fingerprint and the embeddings from the transformer decoder.
It is trained by minimizing the binary cross entropy loss that measures the discrepancy between the distribution and the ground truth fingerprint.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SSx2.SSSx3.p3">
<p class="ltx_p" id="S5.SSx2.SSSx3.p3.1">The inference process is known as the reverse diffusion process, where we start with a random bit vector drawn from the uniform Bernoulli distribution, and denoise it iteratively with the denoiser network.
Finally, the denoised bit vector is used as a fingerprint to retrieve building block molecules from the database.
</p>
</div>
</section>
<section class="ltx_subsubsection" id="S5.SSx2.SSSx4">
<h4 class="ltx_title ltx_title_subsubsection">Reinforcement learning fine-tuning</h4>
<div class="ltx_para ltx_noindent" id="S5.SSx2.SSSx4.p1">
<p class="ltx_p" id="S5.SSx2.SSSx4.p1.14">For global optimization tasks, SynFormer-D was fine-tuned using a variant of the REINVENT algorithm <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib19" title="">19</a>]</cite> based on REINFORCE <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib94" title="">94</a>]</cite>, a type of reinforcement learning (RL). Our RL setup was designed to minimize the following loss function, which incentivizes the model to bring the pseudo-log-likelihood (PLL) of generating a synthetic pathway closer to the objective score of the product molecules:</p>
<table class="ltx_equation ltx_eqn_table" id="S5.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="L(\theta)=\mathbb{E}\left[\left(\text{PLL}_{\theta}(p,m)-\sigma\cdot S(m)%
\right)^{2}\right]," class="ltx_Math" display="block" id="S5.E2.m1.5"><semantics id="S5.E2.m1.5a"><mrow id="S5.E2.m1.5.5.1" xref="S5.E2.m1.5.5.1.1.cmml"><mrow id="S5.E2.m1.5.5.1.1" xref="S5.E2.m1.5.5.1.1.cmml"><mrow id="S5.E2.m1.5.5.1.1.3" xref="S5.E2.m1.5.5.1.1.3.cmml"><mi id="S5.E2.m1.5.5.1.1.3.2" xref="S5.E2.m1.5.5.1.1.3.2.cmml">L</mi><mo id="S5.E2.m1.5.5.1.1.3.1" xref="S5.E2.m1.5.5.1.1.3.1.cmml">⁢</mo><mrow id="S5.E2.m1.5.5.1.1.3.3.2" xref="S5.E2.m1.5.5.1.1.3.cmml"><mo id="S5.E2.m1.5.5.1.1.3.3.2.1" stretchy="false" xref="S5.E2.m1.5.5.1.1.3.cmml">(</mo><mi id="S5.E2.m1.1.1" xref="S5.E2.m1.1.1.cmml">θ</mi><mo id="S5.E2.m1.5.5.1.1.3.3.2.2" stretchy="false" xref="S5.E2.m1.5.5.1.1.3.cmml">)</mo></mrow></mrow><mo id="S5.E2.m1.5.5.1.1.2" xref="S5.E2.m1.5.5.1.1.2.cmml">=</mo><mrow id="S5.E2.m1.5.5.1.1.1" xref="S5.E2.m1.5.5.1.1.1.cmml"><mi id="S5.E2.m1.5.5.1.1.1.3" xref="S5.E2.m1.5.5.1.1.1.3.cmml">𝔼</mi><mo id="S5.E2.m1.5.5.1.1.1.2" xref="S5.E2.m1.5.5.1.1.1.2.cmml">⁢</mo><mrow id="S5.E2.m1.5.5.1.1.1.1.1" xref="S5.E2.m1.5.5.1.1.1.1.2.cmml"><mo id="S5.E2.m1.5.5.1.1.1.1.1.2" xref="S5.E2.m1.5.5.1.1.1.1.2.1.cmml">[</mo><msup id="S5.E2.m1.5.5.1.1.1.1.1.1" xref="S5.E2.m1.5.5.1.1.1.1.1.1.cmml"><mrow id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.cmml"><mo id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.2" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml"><msub id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.cmml"><mtext id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2a.cmml">PLL</mtext><mi id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.3" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.3.cmml">θ</mi></msub><mo id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.1" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.2" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.1.cmml"><mo id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.2.1" stretchy="false" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.1.cmml">(</mo><mi id="S5.E2.m1.2.2" xref="S5.E2.m1.2.2.cmml">p</mi><mo id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.2.2" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.1.cmml">,</mo><mi id="S5.E2.m1.3.3" xref="S5.E2.m1.3.3.cmml">m</mi><mo id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.2.3" stretchy="false" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.3" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml"><mrow id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.3.2" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.2" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.2.cmml">σ</mi><mo id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.1.cmml">⋅</mo><mi id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.3" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.3.cmml">S</mi></mrow><mo id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.3.1" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.2" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml"><mo id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.2.1" stretchy="false" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml">(</mo><mi id="S5.E2.m1.4.4" xref="S5.E2.m1.4.4.cmml">m</mi><mo id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.2.2" stretchy="false" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.3" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S5.E2.m1.5.5.1.1.1.1.1.1.3" xref="S5.E2.m1.5.5.1.1.1.1.1.1.3.cmml">2</mn></msup><mo id="S5.E2.m1.5.5.1.1.1.1.1.3" xref="S5.E2.m1.5.5.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S5.E2.m1.5.5.1.2" xref="S5.E2.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E2.m1.5b"><apply id="S5.E2.m1.5.5.1.1.cmml" xref="S5.E2.m1.5.5.1"><eq id="S5.E2.m1.5.5.1.1.2.cmml" xref="S5.E2.m1.5.5.1.1.2"></eq><apply id="S5.E2.m1.5.5.1.1.3.cmml" xref="S5.E2.m1.5.5.1.1.3"><times id="S5.E2.m1.5.5.1.1.3.1.cmml" xref="S5.E2.m1.5.5.1.1.3.1"></times><ci id="S5.E2.m1.5.5.1.1.3.2.cmml" xref="S5.E2.m1.5.5.1.1.3.2">𝐿</ci><ci id="S5.E2.m1.1.1.cmml" xref="S5.E2.m1.1.1">𝜃</ci></apply><apply id="S5.E2.m1.5.5.1.1.1.cmml" xref="S5.E2.m1.5.5.1.1.1"><times id="S5.E2.m1.5.5.1.1.1.2.cmml" xref="S5.E2.m1.5.5.1.1.1.2"></times><ci id="S5.E2.m1.5.5.1.1.1.3.cmml" xref="S5.E2.m1.5.5.1.1.1.3">𝔼</ci><apply id="S5.E2.m1.5.5.1.1.1.1.2.cmml" xref="S5.E2.m1.5.5.1.1.1.1.1"><csymbol cd="latexml" id="S5.E2.m1.5.5.1.1.1.1.2.1.cmml" xref="S5.E2.m1.5.5.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S5.E2.m1.5.5.1.1.1.1.1.1.cmml" xref="S5.E2.m1.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.E2.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S5.E2.m1.5.5.1.1.1.1.1.1">superscript</csymbol><apply id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1"><minus id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1"></minus><apply id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2"><times id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.1"></times><apply id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2a.cmml" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2"><mtext id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2">PLL</mtext></ci><ci id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.3">𝜃</ci></apply><interval closure="open" id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.2"><ci id="S5.E2.m1.2.2.cmml" xref="S5.E2.m1.2.2">𝑝</ci><ci id="S5.E2.m1.3.3.cmml" xref="S5.E2.m1.3.3">𝑚</ci></interval></apply><apply id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.3"><times id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.3.1"></times><apply id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.3.2"><ci id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.1">⋅</ci><ci id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.2">𝜎</ci><ci id="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S5.E2.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.3">𝑆</ci></apply><ci id="S5.E2.m1.4.4.cmml" xref="S5.E2.m1.4.4">𝑚</ci></apply></apply><cn id="S5.E2.m1.5.5.1.1.1.1.1.1.3.cmml" type="integer" xref="S5.E2.m1.5.5.1.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E2.m1.5c">L(\theta)=\mathbb{E}\left[\left(\text{PLL}_{\theta}(p,m)-\sigma\cdot S(m)%
\right)^{2}\right],</annotation><annotation encoding="application/x-llamapun" id="S5.E2.m1.5d">italic_L ( italic_θ ) = blackboard_E [ ( PLL start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_p , italic_m ) - italic_σ ⋅ italic_S ( italic_m ) ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S5.SSx2.SSSx4.p1.10">where <math alttext="\theta" class="ltx_Math" display="inline" id="S5.SSx2.SSSx4.p1.1.m1.1"><semantics id="S5.SSx2.SSSx4.p1.1.m1.1a"><mi id="S5.SSx2.SSSx4.p1.1.m1.1.1" xref="S5.SSx2.SSSx4.p1.1.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S5.SSx2.SSSx4.p1.1.m1.1b"><ci id="S5.SSx2.SSSx4.p1.1.m1.1.1.cmml" xref="S5.SSx2.SSSx4.p1.1.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SSx2.SSSx4.p1.1.m1.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S5.SSx2.SSSx4.p1.1.m1.1d">italic_θ</annotation></semantics></math> represents the trainable network parameters, <math alttext="p" class="ltx_Math" display="inline" id="S5.SSx2.SSSx4.p1.2.m2.1"><semantics id="S5.SSx2.SSSx4.p1.2.m2.1a"><mi id="S5.SSx2.SSSx4.p1.2.m2.1.1" xref="S5.SSx2.SSSx4.p1.2.m2.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S5.SSx2.SSSx4.p1.2.m2.1b"><ci id="S5.SSx2.SSSx4.p1.2.m2.1.1.cmml" xref="S5.SSx2.SSSx4.p1.2.m2.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SSx2.SSSx4.p1.2.m2.1c">p</annotation><annotation encoding="application/x-llamapun" id="S5.SSx2.SSSx4.p1.2.m2.1d">italic_p</annotation></semantics></math> is the synthetic pathway, <math alttext="m" class="ltx_Math" display="inline" id="S5.SSx2.SSSx4.p1.3.m3.1"><semantics id="S5.SSx2.SSSx4.p1.3.m3.1a"><mi id="S5.SSx2.SSSx4.p1.3.m3.1.1" xref="S5.SSx2.SSSx4.p1.3.m3.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S5.SSx2.SSSx4.p1.3.m3.1b"><ci id="S5.SSx2.SSSx4.p1.3.m3.1.1.cmml" xref="S5.SSx2.SSSx4.p1.3.m3.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SSx2.SSSx4.p1.3.m3.1c">m</annotation><annotation encoding="application/x-llamapun" id="S5.SSx2.SSSx4.p1.3.m3.1d">italic_m</annotation></semantics></math> is the product molecule, <math alttext="S(m)" class="ltx_Math" display="inline" id="S5.SSx2.SSSx4.p1.4.m4.1"><semantics id="S5.SSx2.SSSx4.p1.4.m4.1a"><mrow id="S5.SSx2.SSSx4.p1.4.m4.1.2" xref="S5.SSx2.SSSx4.p1.4.m4.1.2.cmml"><mi id="S5.SSx2.SSSx4.p1.4.m4.1.2.2" xref="S5.SSx2.SSSx4.p1.4.m4.1.2.2.cmml">S</mi><mo id="S5.SSx2.SSSx4.p1.4.m4.1.2.1" xref="S5.SSx2.SSSx4.p1.4.m4.1.2.1.cmml">⁢</mo><mrow id="S5.SSx2.SSSx4.p1.4.m4.1.2.3.2" xref="S5.SSx2.SSSx4.p1.4.m4.1.2.cmml"><mo id="S5.SSx2.SSSx4.p1.4.m4.1.2.3.2.1" stretchy="false" xref="S5.SSx2.SSSx4.p1.4.m4.1.2.cmml">(</mo><mi id="S5.SSx2.SSSx4.p1.4.m4.1.1" xref="S5.SSx2.SSSx4.p1.4.m4.1.1.cmml">m</mi><mo id="S5.SSx2.SSSx4.p1.4.m4.1.2.3.2.2" stretchy="false" xref="S5.SSx2.SSSx4.p1.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SSx2.SSSx4.p1.4.m4.1b"><apply id="S5.SSx2.SSSx4.p1.4.m4.1.2.cmml" xref="S5.SSx2.SSSx4.p1.4.m4.1.2"><times id="S5.SSx2.SSSx4.p1.4.m4.1.2.1.cmml" xref="S5.SSx2.SSSx4.p1.4.m4.1.2.1"></times><ci id="S5.SSx2.SSSx4.p1.4.m4.1.2.2.cmml" xref="S5.SSx2.SSSx4.p1.4.m4.1.2.2">𝑆</ci><ci id="S5.SSx2.SSSx4.p1.4.m4.1.1.cmml" xref="S5.SSx2.SSSx4.p1.4.m4.1.1">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SSx2.SSSx4.p1.4.m4.1c">S(m)</annotation><annotation encoding="application/x-llamapun" id="S5.SSx2.SSSx4.p1.4.m4.1d">italic_S ( italic_m )</annotation></semantics></math> is the objective score of molecule <math alttext="m" class="ltx_Math" display="inline" id="S5.SSx2.SSSx4.p1.5.m5.1"><semantics id="S5.SSx2.SSSx4.p1.5.m5.1a"><mi id="S5.SSx2.SSSx4.p1.5.m5.1.1" xref="S5.SSx2.SSSx4.p1.5.m5.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S5.SSx2.SSSx4.p1.5.m5.1b"><ci id="S5.SSx2.SSSx4.p1.5.m5.1.1.cmml" xref="S5.SSx2.SSSx4.p1.5.m5.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SSx2.SSSx4.p1.5.m5.1c">m</annotation><annotation encoding="application/x-llamapun" id="S5.SSx2.SSSx4.p1.5.m5.1d">italic_m</annotation></semantics></math>, typically scaled between 0 and 1 (the higher, the better), <math alttext="\sigma" class="ltx_Math" display="inline" id="S5.SSx2.SSSx4.p1.6.m6.1"><semantics id="S5.SSx2.SSSx4.p1.6.m6.1a"><mi id="S5.SSx2.SSSx4.p1.6.m6.1.1" xref="S5.SSx2.SSSx4.p1.6.m6.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S5.SSx2.SSSx4.p1.6.m6.1b"><ci id="S5.SSx2.SSSx4.p1.6.m6.1.1.cmml" xref="S5.SSx2.SSSx4.p1.6.m6.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SSx2.SSSx4.p1.6.m6.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S5.SSx2.SSSx4.p1.6.m6.1d">italic_σ</annotation></semantics></math> is a constant scaling factor, <math alttext="\text{PLL}_{\theta}(p,m)" class="ltx_Math" display="inline" id="S5.SSx2.SSSx4.p1.7.m7.2"><semantics id="S5.SSx2.SSSx4.p1.7.m7.2a"><mrow id="S5.SSx2.SSSx4.p1.7.m7.2.3" xref="S5.SSx2.SSSx4.p1.7.m7.2.3.cmml"><msub id="S5.SSx2.SSSx4.p1.7.m7.2.3.2" xref="S5.SSx2.SSSx4.p1.7.m7.2.3.2.cmml"><mtext id="S5.SSx2.SSSx4.p1.7.m7.2.3.2.2" xref="S5.SSx2.SSSx4.p1.7.m7.2.3.2.2a.cmml">PLL</mtext><mi id="S5.SSx2.SSSx4.p1.7.m7.2.3.2.3" xref="S5.SSx2.SSSx4.p1.7.m7.2.3.2.3.cmml">θ</mi></msub><mo id="S5.SSx2.SSSx4.p1.7.m7.2.3.1" xref="S5.SSx2.SSSx4.p1.7.m7.2.3.1.cmml">⁢</mo><mrow id="S5.SSx2.SSSx4.p1.7.m7.2.3.3.2" xref="S5.SSx2.SSSx4.p1.7.m7.2.3.3.1.cmml"><mo id="S5.SSx2.SSSx4.p1.7.m7.2.3.3.2.1" stretchy="false" xref="S5.SSx2.SSSx4.p1.7.m7.2.3.3.1.cmml">(</mo><mi id="S5.SSx2.SSSx4.p1.7.m7.1.1" xref="S5.SSx2.SSSx4.p1.7.m7.1.1.cmml">p</mi><mo id="S5.SSx2.SSSx4.p1.7.m7.2.3.3.2.2" xref="S5.SSx2.SSSx4.p1.7.m7.2.3.3.1.cmml">,</mo><mi id="S5.SSx2.SSSx4.p1.7.m7.2.2" xref="S5.SSx2.SSSx4.p1.7.m7.2.2.cmml">m</mi><mo id="S5.SSx2.SSSx4.p1.7.m7.2.3.3.2.3" stretchy="false" xref="S5.SSx2.SSSx4.p1.7.m7.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SSx2.SSSx4.p1.7.m7.2b"><apply id="S5.SSx2.SSSx4.p1.7.m7.2.3.cmml" xref="S5.SSx2.SSSx4.p1.7.m7.2.3"><times id="S5.SSx2.SSSx4.p1.7.m7.2.3.1.cmml" xref="S5.SSx2.SSSx4.p1.7.m7.2.3.1"></times><apply id="S5.SSx2.SSSx4.p1.7.m7.2.3.2.cmml" xref="S5.SSx2.SSSx4.p1.7.m7.2.3.2"><csymbol cd="ambiguous" id="S5.SSx2.SSSx4.p1.7.m7.2.3.2.1.cmml" xref="S5.SSx2.SSSx4.p1.7.m7.2.3.2">subscript</csymbol><ci id="S5.SSx2.SSSx4.p1.7.m7.2.3.2.2a.cmml" xref="S5.SSx2.SSSx4.p1.7.m7.2.3.2.2"><mtext id="S5.SSx2.SSSx4.p1.7.m7.2.3.2.2.cmml" xref="S5.SSx2.SSSx4.p1.7.m7.2.3.2.2">PLL</mtext></ci><ci id="S5.SSx2.SSSx4.p1.7.m7.2.3.2.3.cmml" xref="S5.SSx2.SSSx4.p1.7.m7.2.3.2.3">𝜃</ci></apply><interval closure="open" id="S5.SSx2.SSSx4.p1.7.m7.2.3.3.1.cmml" xref="S5.SSx2.SSSx4.p1.7.m7.2.3.3.2"><ci id="S5.SSx2.SSSx4.p1.7.m7.1.1.cmml" xref="S5.SSx2.SSSx4.p1.7.m7.1.1">𝑝</ci><ci id="S5.SSx2.SSSx4.p1.7.m7.2.2.cmml" xref="S5.SSx2.SSSx4.p1.7.m7.2.2">𝑚</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SSx2.SSSx4.p1.7.m7.2c">\text{PLL}_{\theta}(p,m)</annotation><annotation encoding="application/x-llamapun" id="S5.SSx2.SSSx4.p1.7.m7.2d">PLL start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_p , italic_m )</annotation></semantics></math> is the pseudo-log-likelihood of generating the pathway <math alttext="p" class="ltx_Math" display="inline" id="S5.SSx2.SSSx4.p1.8.m8.1"><semantics id="S5.SSx2.SSSx4.p1.8.m8.1a"><mi id="S5.SSx2.SSSx4.p1.8.m8.1.1" xref="S5.SSx2.SSSx4.p1.8.m8.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S5.SSx2.SSSx4.p1.8.m8.1b"><ci id="S5.SSx2.SSSx4.p1.8.m8.1.1.cmml" xref="S5.SSx2.SSSx4.p1.8.m8.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SSx2.SSSx4.p1.8.m8.1c">p</annotation><annotation encoding="application/x-llamapun" id="S5.SSx2.SSSx4.p1.8.m8.1d">italic_p</annotation></semantics></math> leading to molecule <math alttext="m" class="ltx_Math" display="inline" id="S5.SSx2.SSSx4.p1.9.m9.1"><semantics id="S5.SSx2.SSSx4.p1.9.m9.1a"><mi id="S5.SSx2.SSSx4.p1.9.m9.1.1" xref="S5.SSx2.SSSx4.p1.9.m9.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S5.SSx2.SSSx4.p1.9.m9.1b"><ci id="S5.SSx2.SSSx4.p1.9.m9.1.1.cmml" xref="S5.SSx2.SSSx4.p1.9.m9.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SSx2.SSSx4.p1.9.m9.1c">m</annotation><annotation encoding="application/x-llamapun" id="S5.SSx2.SSSx4.p1.9.m9.1d">italic_m</annotation></semantics></math>. The pseudo-log-likelihood, <math alttext="\text{PLL}_{\theta}(p,m)" class="ltx_Math" display="inline" id="S5.SSx2.SSSx4.p1.10.m10.2"><semantics id="S5.SSx2.SSSx4.p1.10.m10.2a"><mrow id="S5.SSx2.SSSx4.p1.10.m10.2.3" xref="S5.SSx2.SSSx4.p1.10.m10.2.3.cmml"><msub id="S5.SSx2.SSSx4.p1.10.m10.2.3.2" xref="S5.SSx2.SSSx4.p1.10.m10.2.3.2.cmml"><mtext id="S5.SSx2.SSSx4.p1.10.m10.2.3.2.2" xref="S5.SSx2.SSSx4.p1.10.m10.2.3.2.2a.cmml">PLL</mtext><mi id="S5.SSx2.SSSx4.p1.10.m10.2.3.2.3" xref="S5.SSx2.SSSx4.p1.10.m10.2.3.2.3.cmml">θ</mi></msub><mo id="S5.SSx2.SSSx4.p1.10.m10.2.3.1" xref="S5.SSx2.SSSx4.p1.10.m10.2.3.1.cmml">⁢</mo><mrow id="S5.SSx2.SSSx4.p1.10.m10.2.3.3.2" xref="S5.SSx2.SSSx4.p1.10.m10.2.3.3.1.cmml"><mo id="S5.SSx2.SSSx4.p1.10.m10.2.3.3.2.1" stretchy="false" xref="S5.SSx2.SSSx4.p1.10.m10.2.3.3.1.cmml">(</mo><mi id="S5.SSx2.SSSx4.p1.10.m10.1.1" xref="S5.SSx2.SSSx4.p1.10.m10.1.1.cmml">p</mi><mo id="S5.SSx2.SSSx4.p1.10.m10.2.3.3.2.2" xref="S5.SSx2.SSSx4.p1.10.m10.2.3.3.1.cmml">,</mo><mi id="S5.SSx2.SSSx4.p1.10.m10.2.2" xref="S5.SSx2.SSSx4.p1.10.m10.2.2.cmml">m</mi><mo id="S5.SSx2.SSSx4.p1.10.m10.2.3.3.2.3" stretchy="false" xref="S5.SSx2.SSSx4.p1.10.m10.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SSx2.SSSx4.p1.10.m10.2b"><apply id="S5.SSx2.SSSx4.p1.10.m10.2.3.cmml" xref="S5.SSx2.SSSx4.p1.10.m10.2.3"><times id="S5.SSx2.SSSx4.p1.10.m10.2.3.1.cmml" xref="S5.SSx2.SSSx4.p1.10.m10.2.3.1"></times><apply id="S5.SSx2.SSSx4.p1.10.m10.2.3.2.cmml" xref="S5.SSx2.SSSx4.p1.10.m10.2.3.2"><csymbol cd="ambiguous" id="S5.SSx2.SSSx4.p1.10.m10.2.3.2.1.cmml" xref="S5.SSx2.SSSx4.p1.10.m10.2.3.2">subscript</csymbol><ci id="S5.SSx2.SSSx4.p1.10.m10.2.3.2.2a.cmml" xref="S5.SSx2.SSSx4.p1.10.m10.2.3.2.2"><mtext id="S5.SSx2.SSSx4.p1.10.m10.2.3.2.2.cmml" xref="S5.SSx2.SSSx4.p1.10.m10.2.3.2.2">PLL</mtext></ci><ci id="S5.SSx2.SSSx4.p1.10.m10.2.3.2.3.cmml" xref="S5.SSx2.SSSx4.p1.10.m10.2.3.2.3">𝜃</ci></apply><interval closure="open" id="S5.SSx2.SSSx4.p1.10.m10.2.3.3.1.cmml" xref="S5.SSx2.SSSx4.p1.10.m10.2.3.3.2"><ci id="S5.SSx2.SSSx4.p1.10.m10.1.1.cmml" xref="S5.SSx2.SSSx4.p1.10.m10.1.1">𝑝</ci><ci id="S5.SSx2.SSSx4.p1.10.m10.2.2.cmml" xref="S5.SSx2.SSSx4.p1.10.m10.2.2">𝑚</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SSx2.SSSx4.p1.10.m10.2c">\text{PLL}_{\theta}(p,m)</annotation><annotation encoding="application/x-llamapun" id="S5.SSx2.SSSx4.p1.10.m10.2d">PLL start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_p , italic_m )</annotation></semantics></math>, is computed as the sum of three terms: the log-likelihood of selecting each token (reaction step or building block), the log-likelihood of selecting each reaction type, and the empirical log-likelihood value of the building block fingerprints:</p>
<table class="ltx_equation ltx_eqn_table" id="S5.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{PLL}_{\theta}(p)=\sum_{i}\log P_{\theta}(x_{i})+\log\hat{P}_{\theta}(x_{%
\text{building block}})," class="ltx_Math" display="block" id="S5.E3.m1.2"><semantics id="S5.E3.m1.2a"><mrow id="S5.E3.m1.2.2.1" xref="S5.E3.m1.2.2.1.1.cmml"><mrow id="S5.E3.m1.2.2.1.1" xref="S5.E3.m1.2.2.1.1.cmml"><mrow id="S5.E3.m1.2.2.1.1.4" xref="S5.E3.m1.2.2.1.1.4.cmml"><msub id="S5.E3.m1.2.2.1.1.4.2" xref="S5.E3.m1.2.2.1.1.4.2.cmml"><mtext id="S5.E3.m1.2.2.1.1.4.2.2" xref="S5.E3.m1.2.2.1.1.4.2.2a.cmml">PLL</mtext><mi id="S5.E3.m1.2.2.1.1.4.2.3" xref="S5.E3.m1.2.2.1.1.4.2.3.cmml">θ</mi></msub><mo id="S5.E3.m1.2.2.1.1.4.1" xref="S5.E3.m1.2.2.1.1.4.1.cmml">⁢</mo><mrow id="S5.E3.m1.2.2.1.1.4.3.2" xref="S5.E3.m1.2.2.1.1.4.cmml"><mo id="S5.E3.m1.2.2.1.1.4.3.2.1" stretchy="false" xref="S5.E3.m1.2.2.1.1.4.cmml">(</mo><mi id="S5.E3.m1.1.1" xref="S5.E3.m1.1.1.cmml">p</mi><mo id="S5.E3.m1.2.2.1.1.4.3.2.2" stretchy="false" xref="S5.E3.m1.2.2.1.1.4.cmml">)</mo></mrow></mrow><mo id="S5.E3.m1.2.2.1.1.3" rspace="0.111em" xref="S5.E3.m1.2.2.1.1.3.cmml">=</mo><mrow id="S5.E3.m1.2.2.1.1.2" xref="S5.E3.m1.2.2.1.1.2.cmml"><mrow id="S5.E3.m1.2.2.1.1.1.1" xref="S5.E3.m1.2.2.1.1.1.1.cmml"><munder id="S5.E3.m1.2.2.1.1.1.1.2" xref="S5.E3.m1.2.2.1.1.1.1.2.cmml"><mo id="S5.E3.m1.2.2.1.1.1.1.2.2" movablelimits="false" xref="S5.E3.m1.2.2.1.1.1.1.2.2.cmml">∑</mo><mi id="S5.E3.m1.2.2.1.1.1.1.2.3" xref="S5.E3.m1.2.2.1.1.1.1.2.3.cmml">i</mi></munder><mrow id="S5.E3.m1.2.2.1.1.1.1.1" xref="S5.E3.m1.2.2.1.1.1.1.1.cmml"><mrow id="S5.E3.m1.2.2.1.1.1.1.1.3" xref="S5.E3.m1.2.2.1.1.1.1.1.3.cmml"><mi id="S5.E3.m1.2.2.1.1.1.1.1.3.1" xref="S5.E3.m1.2.2.1.1.1.1.1.3.1.cmml">log</mi><mo id="S5.E3.m1.2.2.1.1.1.1.1.3a" lspace="0.167em" xref="S5.E3.m1.2.2.1.1.1.1.1.3.cmml">⁡</mo><msub id="S5.E3.m1.2.2.1.1.1.1.1.3.2" xref="S5.E3.m1.2.2.1.1.1.1.1.3.2.cmml"><mi id="S5.E3.m1.2.2.1.1.1.1.1.3.2.2" xref="S5.E3.m1.2.2.1.1.1.1.1.3.2.2.cmml">P</mi><mi id="S5.E3.m1.2.2.1.1.1.1.1.3.2.3" xref="S5.E3.m1.2.2.1.1.1.1.1.3.2.3.cmml">θ</mi></msub></mrow><mo id="S5.E3.m1.2.2.1.1.1.1.1.2" xref="S5.E3.m1.2.2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S5.E3.m1.2.2.1.1.1.1.1.1.1" xref="S5.E3.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mo id="S5.E3.m1.2.2.1.1.1.1.1.1.1.2" stretchy="false" xref="S5.E3.m1.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S5.E3.m1.2.2.1.1.1.1.1.1.1.1" xref="S5.E3.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="S5.E3.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S5.E3.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S5.E3.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S5.E3.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S5.E3.m1.2.2.1.1.1.1.1.1.1.3" stretchy="false" xref="S5.E3.m1.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S5.E3.m1.2.2.1.1.2.3" xref="S5.E3.m1.2.2.1.1.2.3.cmml">+</mo><mrow id="S5.E3.m1.2.2.1.1.2.2" xref="S5.E3.m1.2.2.1.1.2.2.cmml"><mrow id="S5.E3.m1.2.2.1.1.2.2.3" xref="S5.E3.m1.2.2.1.1.2.2.3.cmml"><mi id="S5.E3.m1.2.2.1.1.2.2.3.1" xref="S5.E3.m1.2.2.1.1.2.2.3.1.cmml">log</mi><mo id="S5.E3.m1.2.2.1.1.2.2.3a" lspace="0.167em" xref="S5.E3.m1.2.2.1.1.2.2.3.cmml">⁡</mo><msub id="S5.E3.m1.2.2.1.1.2.2.3.2" xref="S5.E3.m1.2.2.1.1.2.2.3.2.cmml"><mover accent="true" id="S5.E3.m1.2.2.1.1.2.2.3.2.2" xref="S5.E3.m1.2.2.1.1.2.2.3.2.2.cmml"><mi id="S5.E3.m1.2.2.1.1.2.2.3.2.2.2" xref="S5.E3.m1.2.2.1.1.2.2.3.2.2.2.cmml">P</mi><mo id="S5.E3.m1.2.2.1.1.2.2.3.2.2.1" xref="S5.E3.m1.2.2.1.1.2.2.3.2.2.1.cmml">^</mo></mover><mi id="S5.E3.m1.2.2.1.1.2.2.3.2.3" xref="S5.E3.m1.2.2.1.1.2.2.3.2.3.cmml">θ</mi></msub></mrow><mo id="S5.E3.m1.2.2.1.1.2.2.2" xref="S5.E3.m1.2.2.1.1.2.2.2.cmml">⁢</mo><mrow id="S5.E3.m1.2.2.1.1.2.2.1.1" xref="S5.E3.m1.2.2.1.1.2.2.1.1.1.cmml"><mo id="S5.E3.m1.2.2.1.1.2.2.1.1.2" stretchy="false" xref="S5.E3.m1.2.2.1.1.2.2.1.1.1.cmml">(</mo><msub id="S5.E3.m1.2.2.1.1.2.2.1.1.1" xref="S5.E3.m1.2.2.1.1.2.2.1.1.1.cmml"><mi id="S5.E3.m1.2.2.1.1.2.2.1.1.1.2" xref="S5.E3.m1.2.2.1.1.2.2.1.1.1.2.cmml">x</mi><mtext id="S5.E3.m1.2.2.1.1.2.2.1.1.1.3" xref="S5.E3.m1.2.2.1.1.2.2.1.1.1.3a.cmml">building block</mtext></msub><mo id="S5.E3.m1.2.2.1.1.2.2.1.1.3" stretchy="false" xref="S5.E3.m1.2.2.1.1.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S5.E3.m1.2.2.1.2" xref="S5.E3.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E3.m1.2b"><apply id="S5.E3.m1.2.2.1.1.cmml" xref="S5.E3.m1.2.2.1"><eq id="S5.E3.m1.2.2.1.1.3.cmml" xref="S5.E3.m1.2.2.1.1.3"></eq><apply id="S5.E3.m1.2.2.1.1.4.cmml" xref="S5.E3.m1.2.2.1.1.4"><times id="S5.E3.m1.2.2.1.1.4.1.cmml" xref="S5.E3.m1.2.2.1.1.4.1"></times><apply id="S5.E3.m1.2.2.1.1.4.2.cmml" xref="S5.E3.m1.2.2.1.1.4.2"><csymbol cd="ambiguous" id="S5.E3.m1.2.2.1.1.4.2.1.cmml" xref="S5.E3.m1.2.2.1.1.4.2">subscript</csymbol><ci id="S5.E3.m1.2.2.1.1.4.2.2a.cmml" xref="S5.E3.m1.2.2.1.1.4.2.2"><mtext id="S5.E3.m1.2.2.1.1.4.2.2.cmml" xref="S5.E3.m1.2.2.1.1.4.2.2">PLL</mtext></ci><ci id="S5.E3.m1.2.2.1.1.4.2.3.cmml" xref="S5.E3.m1.2.2.1.1.4.2.3">𝜃</ci></apply><ci id="S5.E3.m1.1.1.cmml" xref="S5.E3.m1.1.1">𝑝</ci></apply><apply id="S5.E3.m1.2.2.1.1.2.cmml" xref="S5.E3.m1.2.2.1.1.2"><plus id="S5.E3.m1.2.2.1.1.2.3.cmml" xref="S5.E3.m1.2.2.1.1.2.3"></plus><apply id="S5.E3.m1.2.2.1.1.1.1.cmml" xref="S5.E3.m1.2.2.1.1.1.1"><apply id="S5.E3.m1.2.2.1.1.1.1.2.cmml" xref="S5.E3.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.E3.m1.2.2.1.1.1.1.2.1.cmml" xref="S5.E3.m1.2.2.1.1.1.1.2">subscript</csymbol><sum id="S5.E3.m1.2.2.1.1.1.1.2.2.cmml" xref="S5.E3.m1.2.2.1.1.1.1.2.2"></sum><ci id="S5.E3.m1.2.2.1.1.1.1.2.3.cmml" xref="S5.E3.m1.2.2.1.1.1.1.2.3">𝑖</ci></apply><apply id="S5.E3.m1.2.2.1.1.1.1.1.cmml" xref="S5.E3.m1.2.2.1.1.1.1.1"><times id="S5.E3.m1.2.2.1.1.1.1.1.2.cmml" xref="S5.E3.m1.2.2.1.1.1.1.1.2"></times><apply id="S5.E3.m1.2.2.1.1.1.1.1.3.cmml" xref="S5.E3.m1.2.2.1.1.1.1.1.3"><log id="S5.E3.m1.2.2.1.1.1.1.1.3.1.cmml" xref="S5.E3.m1.2.2.1.1.1.1.1.3.1"></log><apply id="S5.E3.m1.2.2.1.1.1.1.1.3.2.cmml" xref="S5.E3.m1.2.2.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S5.E3.m1.2.2.1.1.1.1.1.3.2.1.cmml" xref="S5.E3.m1.2.2.1.1.1.1.1.3.2">subscript</csymbol><ci id="S5.E3.m1.2.2.1.1.1.1.1.3.2.2.cmml" xref="S5.E3.m1.2.2.1.1.1.1.1.3.2.2">𝑃</ci><ci id="S5.E3.m1.2.2.1.1.1.1.1.3.2.3.cmml" xref="S5.E3.m1.2.2.1.1.1.1.1.3.2.3">𝜃</ci></apply></apply><apply id="S5.E3.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S5.E3.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.E3.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S5.E3.m1.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S5.E3.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S5.E3.m1.2.2.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S5.E3.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S5.E3.m1.2.2.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="S5.E3.m1.2.2.1.1.2.2.cmml" xref="S5.E3.m1.2.2.1.1.2.2"><times id="S5.E3.m1.2.2.1.1.2.2.2.cmml" xref="S5.E3.m1.2.2.1.1.2.2.2"></times><apply id="S5.E3.m1.2.2.1.1.2.2.3.cmml" xref="S5.E3.m1.2.2.1.1.2.2.3"><log id="S5.E3.m1.2.2.1.1.2.2.3.1.cmml" xref="S5.E3.m1.2.2.1.1.2.2.3.1"></log><apply id="S5.E3.m1.2.2.1.1.2.2.3.2.cmml" xref="S5.E3.m1.2.2.1.1.2.2.3.2"><csymbol cd="ambiguous" id="S5.E3.m1.2.2.1.1.2.2.3.2.1.cmml" xref="S5.E3.m1.2.2.1.1.2.2.3.2">subscript</csymbol><apply id="S5.E3.m1.2.2.1.1.2.2.3.2.2.cmml" xref="S5.E3.m1.2.2.1.1.2.2.3.2.2"><ci id="S5.E3.m1.2.2.1.1.2.2.3.2.2.1.cmml" xref="S5.E3.m1.2.2.1.1.2.2.3.2.2.1">^</ci><ci id="S5.E3.m1.2.2.1.1.2.2.3.2.2.2.cmml" xref="S5.E3.m1.2.2.1.1.2.2.3.2.2.2">𝑃</ci></apply><ci id="S5.E3.m1.2.2.1.1.2.2.3.2.3.cmml" xref="S5.E3.m1.2.2.1.1.2.2.3.2.3">𝜃</ci></apply></apply><apply id="S5.E3.m1.2.2.1.1.2.2.1.1.1.cmml" xref="S5.E3.m1.2.2.1.1.2.2.1.1"><csymbol cd="ambiguous" id="S5.E3.m1.2.2.1.1.2.2.1.1.1.1.cmml" xref="S5.E3.m1.2.2.1.1.2.2.1.1">subscript</csymbol><ci id="S5.E3.m1.2.2.1.1.2.2.1.1.1.2.cmml" xref="S5.E3.m1.2.2.1.1.2.2.1.1.1.2">𝑥</ci><ci id="S5.E3.m1.2.2.1.1.2.2.1.1.1.3a.cmml" xref="S5.E3.m1.2.2.1.1.2.2.1.1.1.3"><mtext id="S5.E3.m1.2.2.1.1.2.2.1.1.1.3.cmml" mathsize="70%" xref="S5.E3.m1.2.2.1.1.2.2.1.1.1.3">building block</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E3.m1.2c">\text{PLL}_{\theta}(p)=\sum_{i}\log P_{\theta}(x_{i})+\log\hat{P}_{\theta}(x_{%
\text{building block}}),</annotation><annotation encoding="application/x-llamapun" id="S5.E3.m1.2d">PLL start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_p ) = ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT roman_log italic_P start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) + roman_log over^ start_ARG italic_P end_ARG start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT building block end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S5.SSx2.SSSx4.p1.11">where <math alttext="x_{i}" class="ltx_Math" display="inline" id="S5.SSx2.SSSx4.p1.11.m1.1"><semantics id="S5.SSx2.SSSx4.p1.11.m1.1a"><msub id="S5.SSx2.SSSx4.p1.11.m1.1.1" xref="S5.SSx2.SSSx4.p1.11.m1.1.1.cmml"><mi id="S5.SSx2.SSSx4.p1.11.m1.1.1.2" xref="S5.SSx2.SSSx4.p1.11.m1.1.1.2.cmml">x</mi><mi id="S5.SSx2.SSSx4.p1.11.m1.1.1.3" xref="S5.SSx2.SSSx4.p1.11.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SSx2.SSSx4.p1.11.m1.1b"><apply id="S5.SSx2.SSSx4.p1.11.m1.1.1.cmml" xref="S5.SSx2.SSSx4.p1.11.m1.1.1"><csymbol cd="ambiguous" id="S5.SSx2.SSSx4.p1.11.m1.1.1.1.cmml" xref="S5.SSx2.SSSx4.p1.11.m1.1.1">subscript</csymbol><ci id="S5.SSx2.SSSx4.p1.11.m1.1.1.2.cmml" xref="S5.SSx2.SSSx4.p1.11.m1.1.1.2">𝑥</ci><ci id="S5.SSx2.SSSx4.p1.11.m1.1.1.3.cmml" xref="S5.SSx2.SSSx4.p1.11.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SSx2.SSSx4.p1.11.m1.1c">x_{i}</annotation><annotation encoding="application/x-llamapun" id="S5.SSx2.SSSx4.p1.11.m1.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> represents each component of a synthetic path (token, reaction). The empirical likelihood of the building block fingerprints is approximated by:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A2.EGx1">
<tbody id="S5.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\hat{P}_{\theta}(x_{\text{building block}})" class="ltx_Math" display="inline" id="S5.Ex1.m1.1"><semantics id="S5.Ex1.m1.1a"><mrow id="S5.Ex1.m1.1.1" xref="S5.Ex1.m1.1.1.cmml"><msub id="S5.Ex1.m1.1.1.3" xref="S5.Ex1.m1.1.1.3.cmml"><mover accent="true" id="S5.Ex1.m1.1.1.3.2" xref="S5.Ex1.m1.1.1.3.2.cmml"><mi id="S5.Ex1.m1.1.1.3.2.2" xref="S5.Ex1.m1.1.1.3.2.2.cmml">P</mi><mo id="S5.Ex1.m1.1.1.3.2.1" xref="S5.Ex1.m1.1.1.3.2.1.cmml">^</mo></mover><mi id="S5.Ex1.m1.1.1.3.3" xref="S5.Ex1.m1.1.1.3.3.cmml">θ</mi></msub><mo id="S5.Ex1.m1.1.1.2" xref="S5.Ex1.m1.1.1.2.cmml">⁢</mo><mrow id="S5.Ex1.m1.1.1.1.1" xref="S5.Ex1.m1.1.1.1.1.1.cmml"><mo id="S5.Ex1.m1.1.1.1.1.2" stretchy="false" xref="S5.Ex1.m1.1.1.1.1.1.cmml">(</mo><msub id="S5.Ex1.m1.1.1.1.1.1" xref="S5.Ex1.m1.1.1.1.1.1.cmml"><mi id="S5.Ex1.m1.1.1.1.1.1.2" xref="S5.Ex1.m1.1.1.1.1.1.2.cmml">x</mi><mtext id="S5.Ex1.m1.1.1.1.1.1.3" xref="S5.Ex1.m1.1.1.1.1.1.3a.cmml">building block</mtext></msub><mo id="S5.Ex1.m1.1.1.1.1.3" stretchy="false" xref="S5.Ex1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.Ex1.m1.1b"><apply id="S5.Ex1.m1.1.1.cmml" xref="S5.Ex1.m1.1.1"><times id="S5.Ex1.m1.1.1.2.cmml" xref="S5.Ex1.m1.1.1.2"></times><apply id="S5.Ex1.m1.1.1.3.cmml" xref="S5.Ex1.m1.1.1.3"><csymbol cd="ambiguous" id="S5.Ex1.m1.1.1.3.1.cmml" xref="S5.Ex1.m1.1.1.3">subscript</csymbol><apply id="S5.Ex1.m1.1.1.3.2.cmml" xref="S5.Ex1.m1.1.1.3.2"><ci id="S5.Ex1.m1.1.1.3.2.1.cmml" xref="S5.Ex1.m1.1.1.3.2.1">^</ci><ci id="S5.Ex1.m1.1.1.3.2.2.cmml" xref="S5.Ex1.m1.1.1.3.2.2">𝑃</ci></apply><ci id="S5.Ex1.m1.1.1.3.3.cmml" xref="S5.Ex1.m1.1.1.3.3">𝜃</ci></apply><apply id="S5.Ex1.m1.1.1.1.1.1.cmml" xref="S5.Ex1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S5.Ex1.m1.1.1.1.1.1.1.cmml" xref="S5.Ex1.m1.1.1.1.1">subscript</csymbol><ci id="S5.Ex1.m1.1.1.1.1.1.2.cmml" xref="S5.Ex1.m1.1.1.1.1.1.2">𝑥</ci><ci id="S5.Ex1.m1.1.1.1.1.1.3a.cmml" xref="S5.Ex1.m1.1.1.1.1.1.3"><mtext id="S5.Ex1.m1.1.1.1.1.1.3.cmml" mathsize="70%" xref="S5.Ex1.m1.1.1.1.1.1.3">building block</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.Ex1.m1.1c">\displaystyle\hat{P}_{\theta}(x_{\text{building block}})</annotation><annotation encoding="application/x-llamapun" id="S5.Ex1.m1.1d">over^ start_ARG italic_P end_ARG start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT building block end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=x_{\text{denoised}}\cdot x_{\text{target}}" class="ltx_Math" display="inline" id="S5.Ex1.m2.1"><semantics id="S5.Ex1.m2.1a"><mrow id="S5.Ex1.m2.1.1" xref="S5.Ex1.m2.1.1.cmml"><mi id="S5.Ex1.m2.1.1.2" xref="S5.Ex1.m2.1.1.2.cmml"></mi><mo id="S5.Ex1.m2.1.1.1" xref="S5.Ex1.m2.1.1.1.cmml">=</mo><mrow id="S5.Ex1.m2.1.1.3" xref="S5.Ex1.m2.1.1.3.cmml"><msub id="S5.Ex1.m2.1.1.3.2" xref="S5.Ex1.m2.1.1.3.2.cmml"><mi id="S5.Ex1.m2.1.1.3.2.2" xref="S5.Ex1.m2.1.1.3.2.2.cmml">x</mi><mtext id="S5.Ex1.m2.1.1.3.2.3" xref="S5.Ex1.m2.1.1.3.2.3a.cmml">denoised</mtext></msub><mo id="S5.Ex1.m2.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S5.Ex1.m2.1.1.3.1.cmml">⋅</mo><msub id="S5.Ex1.m2.1.1.3.3" xref="S5.Ex1.m2.1.1.3.3.cmml"><mi id="S5.Ex1.m2.1.1.3.3.2" xref="S5.Ex1.m2.1.1.3.3.2.cmml">x</mi><mtext id="S5.Ex1.m2.1.1.3.3.3" xref="S5.Ex1.m2.1.1.3.3.3a.cmml">target</mtext></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.Ex1.m2.1b"><apply id="S5.Ex1.m2.1.1.cmml" xref="S5.Ex1.m2.1.1"><eq id="S5.Ex1.m2.1.1.1.cmml" xref="S5.Ex1.m2.1.1.1"></eq><csymbol cd="latexml" id="S5.Ex1.m2.1.1.2.cmml" xref="S5.Ex1.m2.1.1.2">absent</csymbol><apply id="S5.Ex1.m2.1.1.3.cmml" xref="S5.Ex1.m2.1.1.3"><ci id="S5.Ex1.m2.1.1.3.1.cmml" xref="S5.Ex1.m2.1.1.3.1">⋅</ci><apply id="S5.Ex1.m2.1.1.3.2.cmml" xref="S5.Ex1.m2.1.1.3.2"><csymbol cd="ambiguous" id="S5.Ex1.m2.1.1.3.2.1.cmml" xref="S5.Ex1.m2.1.1.3.2">subscript</csymbol><ci id="S5.Ex1.m2.1.1.3.2.2.cmml" xref="S5.Ex1.m2.1.1.3.2.2">𝑥</ci><ci id="S5.Ex1.m2.1.1.3.2.3a.cmml" xref="S5.Ex1.m2.1.1.3.2.3"><mtext id="S5.Ex1.m2.1.1.3.2.3.cmml" mathsize="70%" xref="S5.Ex1.m2.1.1.3.2.3">denoised</mtext></ci></apply><apply id="S5.Ex1.m2.1.1.3.3.cmml" xref="S5.Ex1.m2.1.1.3.3"><csymbol cd="ambiguous" id="S5.Ex1.m2.1.1.3.3.1.cmml" xref="S5.Ex1.m2.1.1.3.3">subscript</csymbol><ci id="S5.Ex1.m2.1.1.3.3.2.cmml" xref="S5.Ex1.m2.1.1.3.3.2">𝑥</ci><ci id="S5.Ex1.m2.1.1.3.3.3a.cmml" xref="S5.Ex1.m2.1.1.3.3.3"><mtext id="S5.Ex1.m2.1.1.3.3.3.cmml" mathsize="70%" xref="S5.Ex1.m2.1.1.3.3.3">target</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.Ex1.m2.1c">\displaystyle=x_{\text{denoised}}\cdot x_{\text{target}}</annotation><annotation encoding="application/x-llamapun" id="S5.Ex1.m2.1d">= italic_x start_POSTSUBSCRIPT denoised end_POSTSUBSCRIPT ⋅ italic_x start_POSTSUBSCRIPT target end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S5.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\quad+(1-x_{\text{denoised}})\cdot(1-x_{\text{target}})," class="ltx_Math" display="inline" id="S5.E4.m1.1"><semantics id="S5.E4.m1.1a"><mrow id="S5.E4.m1.1.1.1" xref="S5.E4.m1.1.1.1.1.cmml"><mrow id="S5.E4.m1.1.1.1.1" xref="S5.E4.m1.1.1.1.1.cmml"><mo id="S5.E4.m1.1.1.1.1a" xref="S5.E4.m1.1.1.1.1.cmml">+</mo><mrow id="S5.E4.m1.1.1.1.1.2" xref="S5.E4.m1.1.1.1.1.2.cmml"><mrow id="S5.E4.m1.1.1.1.1.1.1.1" xref="S5.E4.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S5.E4.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S5.E4.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S5.E4.m1.1.1.1.1.1.1.1.1" xref="S5.E4.m1.1.1.1.1.1.1.1.1.cmml"><mn id="S5.E4.m1.1.1.1.1.1.1.1.1.2" xref="S5.E4.m1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S5.E4.m1.1.1.1.1.1.1.1.1.1" xref="S5.E4.m1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S5.E4.m1.1.1.1.1.1.1.1.1.3" xref="S5.E4.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S5.E4.m1.1.1.1.1.1.1.1.1.3.2" xref="S5.E4.m1.1.1.1.1.1.1.1.1.3.2.cmml">x</mi><mtext id="S5.E4.m1.1.1.1.1.1.1.1.1.3.3" xref="S5.E4.m1.1.1.1.1.1.1.1.1.3.3a.cmml">denoised</mtext></msub></mrow><mo id="S5.E4.m1.1.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S5.E4.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S5.E4.m1.1.1.1.1.2.3" rspace="0.222em" xref="S5.E4.m1.1.1.1.1.2.3.cmml">⋅</mo><mrow id="S5.E4.m1.1.1.1.1.2.2.1" xref="S5.E4.m1.1.1.1.1.2.2.1.1.cmml"><mo id="S5.E4.m1.1.1.1.1.2.2.1.2" stretchy="false" xref="S5.E4.m1.1.1.1.1.2.2.1.1.cmml">(</mo><mrow id="S5.E4.m1.1.1.1.1.2.2.1.1" xref="S5.E4.m1.1.1.1.1.2.2.1.1.cmml"><mn id="S5.E4.m1.1.1.1.1.2.2.1.1.2" xref="S5.E4.m1.1.1.1.1.2.2.1.1.2.cmml">1</mn><mo id="S5.E4.m1.1.1.1.1.2.2.1.1.1" xref="S5.E4.m1.1.1.1.1.2.2.1.1.1.cmml">−</mo><msub id="S5.E4.m1.1.1.1.1.2.2.1.1.3" xref="S5.E4.m1.1.1.1.1.2.2.1.1.3.cmml"><mi id="S5.E4.m1.1.1.1.1.2.2.1.1.3.2" xref="S5.E4.m1.1.1.1.1.2.2.1.1.3.2.cmml">x</mi><mtext id="S5.E4.m1.1.1.1.1.2.2.1.1.3.3" xref="S5.E4.m1.1.1.1.1.2.2.1.1.3.3a.cmml">target</mtext></msub></mrow><mo id="S5.E4.m1.1.1.1.1.2.2.1.3" stretchy="false" xref="S5.E4.m1.1.1.1.1.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S5.E4.m1.1.1.1.2" xref="S5.E4.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E4.m1.1b"><apply id="S5.E4.m1.1.1.1.1.cmml" xref="S5.E4.m1.1.1.1"><plus id="S5.E4.m1.1.1.1.1.3.cmml" xref="S5.E4.m1.1.1.1"></plus><apply id="S5.E4.m1.1.1.1.1.2.cmml" xref="S5.E4.m1.1.1.1.1.2"><ci id="S5.E4.m1.1.1.1.1.2.3.cmml" xref="S5.E4.m1.1.1.1.1.2.3">⋅</ci><apply id="S5.E4.m1.1.1.1.1.1.1.1.1.cmml" xref="S5.E4.m1.1.1.1.1.1.1.1"><minus id="S5.E4.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S5.E4.m1.1.1.1.1.1.1.1.1.1"></minus><cn id="S5.E4.m1.1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="S5.E4.m1.1.1.1.1.1.1.1.1.2">1</cn><apply id="S5.E4.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S5.E4.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.E4.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S5.E4.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S5.E4.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S5.E4.m1.1.1.1.1.1.1.1.1.3.2">𝑥</ci><ci id="S5.E4.m1.1.1.1.1.1.1.1.1.3.3a.cmml" xref="S5.E4.m1.1.1.1.1.1.1.1.1.3.3"><mtext id="S5.E4.m1.1.1.1.1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S5.E4.m1.1.1.1.1.1.1.1.1.3.3">denoised</mtext></ci></apply></apply><apply id="S5.E4.m1.1.1.1.1.2.2.1.1.cmml" xref="S5.E4.m1.1.1.1.1.2.2.1"><minus id="S5.E4.m1.1.1.1.1.2.2.1.1.1.cmml" xref="S5.E4.m1.1.1.1.1.2.2.1.1.1"></minus><cn id="S5.E4.m1.1.1.1.1.2.2.1.1.2.cmml" type="integer" xref="S5.E4.m1.1.1.1.1.2.2.1.1.2">1</cn><apply id="S5.E4.m1.1.1.1.1.2.2.1.1.3.cmml" xref="S5.E4.m1.1.1.1.1.2.2.1.1.3"><csymbol cd="ambiguous" id="S5.E4.m1.1.1.1.1.2.2.1.1.3.1.cmml" xref="S5.E4.m1.1.1.1.1.2.2.1.1.3">subscript</csymbol><ci id="S5.E4.m1.1.1.1.1.2.2.1.1.3.2.cmml" xref="S5.E4.m1.1.1.1.1.2.2.1.1.3.2">𝑥</ci><ci id="S5.E4.m1.1.1.1.1.2.2.1.1.3.3a.cmml" xref="S5.E4.m1.1.1.1.1.2.2.1.1.3.3"><mtext id="S5.E4.m1.1.1.1.1.2.2.1.1.3.3.cmml" mathsize="70%" xref="S5.E4.m1.1.1.1.1.2.2.1.1.3.3">target</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E4.m1.1c">\displaystyle\quad+(1-x_{\text{denoised}})\cdot(1-x_{\text{target}}),</annotation><annotation encoding="application/x-llamapun" id="S5.E4.m1.1d">+ ( 1 - italic_x start_POSTSUBSCRIPT denoised end_POSTSUBSCRIPT ) ⋅ ( 1 - italic_x start_POSTSUBSCRIPT target end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S5.SSx2.SSSx4.p1.13">where <math alttext="x_{\text{denoised}}" class="ltx_Math" display="inline" id="S5.SSx2.SSSx4.p1.12.m1.1"><semantics id="S5.SSx2.SSSx4.p1.12.m1.1a"><msub id="S5.SSx2.SSSx4.p1.12.m1.1.1" xref="S5.SSx2.SSSx4.p1.12.m1.1.1.cmml"><mi id="S5.SSx2.SSSx4.p1.12.m1.1.1.2" xref="S5.SSx2.SSSx4.p1.12.m1.1.1.2.cmml">x</mi><mtext id="S5.SSx2.SSSx4.p1.12.m1.1.1.3" xref="S5.SSx2.SSSx4.p1.12.m1.1.1.3a.cmml">denoised</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.SSx2.SSSx4.p1.12.m1.1b"><apply id="S5.SSx2.SSSx4.p1.12.m1.1.1.cmml" xref="S5.SSx2.SSSx4.p1.12.m1.1.1"><csymbol cd="ambiguous" id="S5.SSx2.SSSx4.p1.12.m1.1.1.1.cmml" xref="S5.SSx2.SSSx4.p1.12.m1.1.1">subscript</csymbol><ci id="S5.SSx2.SSSx4.p1.12.m1.1.1.2.cmml" xref="S5.SSx2.SSSx4.p1.12.m1.1.1.2">𝑥</ci><ci id="S5.SSx2.SSSx4.p1.12.m1.1.1.3a.cmml" xref="S5.SSx2.SSSx4.p1.12.m1.1.1.3"><mtext id="S5.SSx2.SSSx4.p1.12.m1.1.1.3.cmml" mathsize="70%" xref="S5.SSx2.SSSx4.p1.12.m1.1.1.3">denoised</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SSx2.SSSx4.p1.12.m1.1c">x_{\text{denoised}}</annotation><annotation encoding="application/x-llamapun" id="S5.SSx2.SSSx4.p1.12.m1.1d">italic_x start_POSTSUBSCRIPT denoised end_POSTSUBSCRIPT</annotation></semantics></math> is the denoised fingerprint vector, <math alttext="x_{\text{target}}" class="ltx_Math" display="inline" id="S5.SSx2.SSSx4.p1.13.m2.1"><semantics id="S5.SSx2.SSSx4.p1.13.m2.1a"><msub id="S5.SSx2.SSSx4.p1.13.m2.1.1" xref="S5.SSx2.SSSx4.p1.13.m2.1.1.cmml"><mi id="S5.SSx2.SSSx4.p1.13.m2.1.1.2" xref="S5.SSx2.SSSx4.p1.13.m2.1.1.2.cmml">x</mi><mtext id="S5.SSx2.SSSx4.p1.13.m2.1.1.3" xref="S5.SSx2.SSSx4.p1.13.m2.1.1.3a.cmml">target</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.SSx2.SSSx4.p1.13.m2.1b"><apply id="S5.SSx2.SSSx4.p1.13.m2.1.1.cmml" xref="S5.SSx2.SSSx4.p1.13.m2.1.1"><csymbol cd="ambiguous" id="S5.SSx2.SSSx4.p1.13.m2.1.1.1.cmml" xref="S5.SSx2.SSSx4.p1.13.m2.1.1">subscript</csymbol><ci id="S5.SSx2.SSSx4.p1.13.m2.1.1.2.cmml" xref="S5.SSx2.SSSx4.p1.13.m2.1.1.2">𝑥</ci><ci id="S5.SSx2.SSSx4.p1.13.m2.1.1.3a.cmml" xref="S5.SSx2.SSSx4.p1.13.m2.1.1.3"><mtext id="S5.SSx2.SSSx4.p1.13.m2.1.1.3.cmml" mathsize="70%" xref="S5.SSx2.SSSx4.p1.13.m2.1.1.3">target</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SSx2.SSSx4.p1.13.m2.1c">x_{\text{target}}</annotation><annotation encoding="application/x-llamapun" id="S5.SSx2.SSSx4.p1.13.m2.1d">italic_x start_POSTSUBSCRIPT target end_POSTSUBSCRIPT</annotation></semantics></math> is the ground truth fingerprint.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S5.SSx2.SSSx5">
<h4 class="ltx_title ltx_title_subsubsection">Genetic algorithm with SynFormer-ED as a mutation operator</h4>
<div class="ltx_para ltx_noindent" id="S5.SSx2.SSSx5.p1">
<p class="ltx_p" id="S5.SSx2.SSSx5.p1.1">We integrated SynFormer-ED as a mutation step into an evolutionary framework for global chemical space exploration and optimization. The genetic algorithm follows a standard workflow: starting with a pool of candidates randomly sampled from the ZINC database, pairs of molecules are selected to undergo crossover, producing an offspring pool. Mutation is then applied to each offspring with a specific probability, followed by an additional mutation step where SynFormer-ED projects all offspring into synthesizable space. This step ensures that unsynthesizable fragments are corrected and adds additional diversity to the candidate pool. The offspring pool will be evaluated, and the highest-scored ones will form the next generation for the next iteration. The crossover and mutation rules were adopted from the GraphGA <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib29" title="">29</a>]</cite> algorithm; specifically, crossover involves graph matching and exchanging molecular halves, while mutation employs a set of hand-coded rules including both atom- and fragment-level modifications. We adopted the hyperparameters from <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib98" title="">98</a>]</cite>.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S5.SSx3">
<h3 class="ltx_title ltx_title_subsection">Evaluation Details</h3>
<div class="ltx_para ltx_noindent" id="S5.SSx3.p1">
<p class="ltx_p" id="S5.SSx3.p1.1">This section describes the precise settings used in the evaluation of SynFormer-ED and SynFormer-D.</p>
</div>
<section class="ltx_subsubsection" id="S5.SSx3.SSSx1">
<h4 class="ltx_title ltx_title_subsubsection">Reconstruction and local chemical space exploration</h4>
<div class="ltx_para ltx_noindent" id="S5.SSx3.SSSx1.p1">
<p class="ltx_p" id="S5.SSx3.SSSx1.p1.1">SynFormer-ED was employed for reconstruction, analog generation, and hit expansion. The workflows for these tasks are similar: SynFormer-ED encodes the input molecule and decodes it into synthetic pathways, using a search width of 24 and an exhaustiveness of 64 during decoding. For reconstruction and analog generation, Tanimoto (Jaccard) similarity <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib105" title="">105</a>]</cite> to the input molecule based on Morgan fingerprints <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib106" title="">106</a>]</cite> was evaluated for each generated molecule, with the most similar molecule selected as the output. In hit expansion, generated molecules were evaluated based on both the design objective score and Tanimoto similarity.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SSx3.SSSx1.p2">
<p class="ltx_p" id="S5.SSx3.SSSx1.p2.1">We tested the reconstruction performance on a random sample of 1,000 molecules from Enamine’s REAL Space <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib50" title="">50</a>]</cite> and the ChEMBL database <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib107" title="">107</a>]</cite>. Molecules were sampled from the REAL Diversity Set, which includes 48.2 million molecules and maximizes diversity to represent the broader REAL Space. These molecules comply with the Rule of 5 (Ro5) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib108" title="">108</a>]</cite> and Veber criteria <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib109" title="">109</a>]</cite>, making them suitable for drug-like properties. ChEMBL samples were taken from version 29 of the database, released in 2021.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SSx3.SSSx1.p3">
<p class="ltx_p" id="S5.SSx3.SSSx1.p3.1">The Synthetic Accessibility (SA) Score <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib42" title="">42</a>]</cite>, a heuristic measure evaluating structural complexity based on fragment frequency in PubChem <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib110" title="">110</a>]</cite>, was used to assess the synthesizability of the generated molecules. For synthesizable analog generation, 10 objective scores from the GuacaMol benchmark <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib76" title="">76</a>]</cite> were used, which involve optimizing various physicochemical properties, similarities or dissimilarities to known drugs, and specific structural motifs.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SSx3.SSSx1.p4">
<p class="ltx_p" id="S5.SSx3.SSSx1.p4.1">In hit expansion, we also used a predictive model <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib90" title="">90</a>]</cite> to assess inhibition against c-Jun N-terminal Kinase-3 (JNK3), a member of the mitogen-activated protein kinase family. This model is a random forest classifier utilizing ECFP6 fingerprints trained on the ExCAPE-DB dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib89" title="">89</a>]</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SSx3.SSSx1.p5">
<p class="ltx_p" id="S5.SSx3.SSSx1.p5.1">AutoDock Vina <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib84" title="">84</a>]</cite> was employed to evaluate binding affinities against protein targets in both structure-based drug design and hit expansion tasks. Protein structures and pocket information were sourced from the LIT-PCBA dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib83" title="">83</a>]</cite>, and an exhaustiveness setting of 16 was used for most calculations.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SSx3.SSSx1.p6">
<p class="ltx_p" id="S5.SSx3.SSSx1.p6.1">For baseline comparisons in analog finding, we conducted a nearest neighbor search within Enamine REAL. This was done by accessing the Enamine website (https://new.enaminestore.com/draw-search) and downloading approximately 100 nearest neighbors by adjusting the similarity threshold value.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S5.SSx3.SSSx2">
<h4 class="ltx_title ltx_title_subsubsection">Global chemical space exploration</h4>
<div class="ltx_para ltx_noindent" id="S5.SSx3.SSSx2.p1">
<p class="ltx_p" id="S5.SSx3.SSSx2.p1.2">For both SF-RL and GraphGA-SF, we employed these models to solve molecular optimization problems without predefined starting points <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib45" title="">45</a>]</cite>. In each experiment, we assumed the presence of an oracle, i.e., a function that evaluates the desired property of a molecule, providing the ground truth value. As property evaluation is often time- and resource-intensive in real-world scenarios, each experiment was limited to 10,000 oracle calls, meaning up to 10,000 molecules could be evaluated. During optimization, all evaluated molecules were recorded, and the primary performance metric was the area under the curve (AUC) of the top-<math alttext="K" class="ltx_Math" display="inline" id="S5.SSx3.SSSx2.p1.1.m1.1"><semantics id="S5.SSx3.SSSx2.p1.1.m1.1a"><mi id="S5.SSx3.SSSx2.p1.1.m1.1.1" xref="S5.SSx3.SSSx2.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.SSx3.SSSx2.p1.1.m1.1b"><ci id="S5.SSx3.SSSx2.p1.1.m1.1.1.cmml" xref="S5.SSx3.SSSx2.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SSx3.SSSx2.p1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S5.SSx3.SSSx2.p1.1.m1.1d">italic_K</annotation></semantics></math> average property value versus the number of oracle calls (<span class="ltx_text ltx_font_italic" id="S5.SSx3.SSSx2.p1.2.1">AUC top-<math alttext="K" class="ltx_Math" display="inline" id="S5.SSx3.SSSx2.p1.2.1.m1.1"><semantics id="S5.SSx3.SSSx2.p1.2.1.m1.1a"><mi id="S5.SSx3.SSSx2.p1.2.1.m1.1.1" xref="S5.SSx3.SSSx2.p1.2.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.SSx3.SSSx2.p1.2.1.m1.1b"><ci id="S5.SSx3.SSSx2.p1.2.1.m1.1.1.cmml" xref="S5.SSx3.SSSx2.p1.2.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SSx3.SSSx2.p1.2.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S5.SSx3.SSSx2.p1.2.1.m1.1d">italic_K</annotation></semantics></math></span>). The reported AUC values were min-max scaled to the range [0, 1].</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SSx3.SSSx2.p2">
<p class="ltx_p" id="S5.SSx3.SSSx2.p2.1">We evaluated the global chemical space optimization capabilities of SF-RL and GraphGA-SF on optimizing DRD2 inhibition <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib111" title="">111</a>]</cite> and four multi-objective properties from the GuacaMol benchmark <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib76" title="">76</a>]</cite>: Sitagliptin MPO, Scaffold Hop, Perindopril MPO, and Ranolazine MPO. DRD2 inhibition was assessed using a classifier trained on the ExCAPE-DB dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib89" title="">89</a>]</cite>, employing a support vector machine (SVM) with a Gaussian kernel and ECFP6 fingerprints to distinguish active from inactive compounds for the Dopamine Receptor D2 (DRD2) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib111" title="">111</a>]</cite>. The multi-objective tasks from the GuacaMol benchmark are described above <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib76" title="">76</a>]</cite>. All oracle functions were accessed through the Therapeutic Data Commons (TDC) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib112" title="">112</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib113" title="">113</a>]</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SSx3.SSSx2.p3">
<p class="ltx_p" id="S5.SSx3.SSSx2.p3.1">The baseline methods compared in this study include:</p>
<ul class="ltx_itemize" id="S5.I2">
<li class="ltx_item" id="S5.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I2.i1.p1">
<p class="ltx_p" id="S5.I2.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I2.i1.p1.1.1">GraphGA</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib29" title="">29</a>]</cite> is a popular heuristic algorithm inspired by natural evolutionary processes, featuring crossover rules derived from graph matching and mutations applied at both the atom- and fragment-level.</p>
</div>
</li>
<li class="ltx_item" id="S5.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I2.i2.p1">
<p class="ltx_p" id="S5.I2.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I2.i2.p1.1.1">Graph MCTS</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib29" title="">29</a>]</cite> uses Monte Carlo Tree Search to explore molecular structures by locally searching each branch of the current state (molecule or partial molecule) and selecting the most promising candidates based on property scores for subsequent iterations.</p>
</div>
</li>
<li class="ltx_item" id="S5.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I2.i3.p1">
<p class="ltx_p" id="S5.I2.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I2.i3.p1.1.1">REINVENT</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib19" title="">19</a>]</cite> utilizes a policy-based reinforcement learning (RL) approach where agents take actions in an environment to maximize cumulative rewards, tuning recurrent neural networks (RNNs) to generate SMILES strings.</p>
</div>
</li>
<li class="ltx_item" id="S5.I2.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I2.i4.p1">
<p class="ltx_p" id="S5.I2.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I2.i4.p1.1.1">Augmented Memory (AugMem)</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib97" title="">97</a>]</cite> integrates SMILES-based reinforcement learning with augmented training through experience replay and selective memory purge to prevent model collapse. This approach achieves state-of-the-art sample efficiency, demonstrating the highest reported performance in the PMO benchmark.</p>
</div>
</li>
<li class="ltx_item" id="S5.I2.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I2.i5.p1">
<p class="ltx_p" id="S5.I2.i5.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I2.i5.p1.1.1">GFlowNet</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib96" title="">96</a>]</cite> is a generative AI model that treats the generative process as a flow network and trains it with a temporal difference-like loss function, aligning the generation process with the target property distribution by matching the property of interest to the flow volume.</p>
</div>
</li>
<li class="ltx_item" id="S5.I2.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I2.i6.p1">
<p class="ltx_p" id="S5.I2.i6.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I2.i6.p1.1.1">DoG-Gen</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib64" title="">64</a>]</cite> models synthetic pathways as Directed Acyclic Graphs (DAGs) and uses an RNN-based generator, optimizing via an iterative learning method that incorporates high-scoring molecules into the training data for successive fine-tuning of the generative model.</p>
</div>
</li>
<li class="ltx_item" id="S5.I2.i7" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S5.I2.i7.p1">
<p class="ltx_p" id="S5.I2.i7.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I2.i7.p1.1.1">SynNet</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib65" title="">65</a>]</cite> is a synthesis-based method that applies a genetic algorithm to molecular fingerprints, decoding them into synthetic pathways using trained neural networks.</p>
</div>
</li>
</ul>
<p class="ltx_p" id="S5.SSx3.SSSx2.p3.2">The implementations of these methods were adapted from their original publications with minor modifications, and hyperparameters were set according to the specifications in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib45" title="">45</a>]</cite>, except AugMem which is from the original publication.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_title_section">Acknowledgments</h2>
<div class="ltx_para ltx_noindent" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1">This research was supported by the Office of Naval Research under grant number N00014-21-1-2195 and the AI2050 program at Schmidt Futures under grant number G-22-64475. Any opinions, findings, and conclusions or recommendations expressed in this material are those of the author(s) and do not necessarily reflect the views of the Office of Naval Research. W.G. received additional funding from the Google Ph.D. fellowship. We thank Kaiming He and Yurii Moroz for their helpful discussions and comments on the manuscript.</p>
</div>
</section>
<section class="ltx_section" id="Sx2">
<h2 class="ltx_title ltx_title_section">Reproducibility Statement</h2>
<div class="ltx_para ltx_noindent" id="Sx2.p1">
<p class="ltx_p" id="Sx2.p1.1">All code and releasable data can be found at <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/wenhao-gao/synformer" title="">https://github.com/wenhao-gao/synformer</a>, including instructions in a README file. The model weights can be accessed on <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://huggingface.co/whgao/synformer" title="">https://huggingface.co/whgao/synformer</a>. Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#A1" title="Appendix A Additional method details ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_tag">A</span></a> provides more details about the experimental setup and implementation details.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
W Patrick Walters, Jeremy Green, Jonathan R Weiss, and Mark A Murcko.

</span>
<span class="ltx_bibblock">What do medicinal chemists actually make? a 50-year retrospective.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib1.1.1">Journal of medicinal chemistry</span>, 54(19):6405–6416, 2011.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Peng Wu, Thomas E Nielsen, and Mads H Clausen.

</span>
<span class="ltx_bibblock">Small-molecule kinase inhibitors: an analysis of fda-approved drugs.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib2.1.1">Drug discovery today</span>, 21(1):5–10, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Jiankun Lyu, Sheng Wang, Trent E Balius, Isha Singh, Anat Levit, Yurii S Moroz, Matthew J O’Meara, Tao Che, Enkhjargal Algaa, Kateryna Tolmachova, et al.

</span>
<span class="ltx_bibblock">Ultra-large library docking for discovering new chemotypes.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib3.1.1">Nature</span>, 566(7743):224–229, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Zhiao Yu, Hansen Wang, Xian Kong, William Huang, Yuchi Tsao, David G Mackanic, Kecheng Wang, Xinchang Wang, Wenxiao Huang, Snehashis Choudhury, et al.

</span>
<span class="ltx_bibblock">Molecular design for electrolyte solvents enabling energy-dense and long-cycling lithium metal batteries.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib4.1.1">Nature Energy</span>, 5(7):526–533, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Johannes Hachmann, Roberto Olivares-Amaya, Sule Atahan-Evrenk, Carlos Amador-Bedolla, Roel S Sánchez-Carrera, Aryeh Gold-Parker, Leslie Vogt, Anna M Brockway, and Alán Aspuru-Guzik.

</span>
<span class="ltx_bibblock">The harvard clean energy project: large-scale computational screening and design of organic photovoltaics on the world community grid.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib5.1.1">The Journal of Physical Chemistry Letters</span>, 2(17):2241–2251, 2011.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Pawankumar Rai, Srishti Mehrotra, Smriti Priya, Edgard Gnansounou, and Sandeep K Sharma.

</span>
<span class="ltx_bibblock">Recent advances in the sustainable design and applications of biodegradable polymers.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib6.1.1">Bioresource technology</span>, 325:124739, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Kyle M Diederichsen, Rezvan Sharifian, Jin Soo Kang, Yayuan Liu, Seoni Kim, Betar M Gallant, David Vermaas, and T Alan Hatton.

</span>
<span class="ltx_bibblock">Electrochemical methods for carbon dioxide separations.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib7.1.1">Nature Reviews Methods Primers</span>, 2(1):68, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Jiayu Peng, Daniel Schwalbe-Koda, Karthik Akkiraju, Tian Xie, Livia Giordano, Yang Yu, C John Eom, Jaclyn R Lunger, Daniel J Zheng, Reshma R Rao, et al.

</span>
<span class="ltx_bibblock">Human-and machine-centred designs of molecules and materials for sustainability and decarbonization.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib8.1.1">Nature Reviews Materials</span>, 7(12):991–1009, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Edward O Pyzer-Knapp, Changwon Suh, Rafael Gómez-Bombarelli, Jorge Aguilera-Iparraguirre, and Alán Aspuru-Guzik.

</span>
<span class="ltx_bibblock">What is high-throughput virtual screening? a perspective from organic materials discovery.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib9.1.1">Annual Review of Materials Research</span>, 45(1):195–216, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Katarzyna Smietana, Marcin Siatkowski, and Martin Møller.

</span>
<span class="ltx_bibblock">Trends in clinical success rates.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib10.1.1">Nat Rev Drug Discov</span>, 15(6):379–80, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Sudeep Pushpakom, Francesco Iorio, Patrick A Eyers, K Jane Escott, Shirley Hopper, Andrew Wells, Andrew Doig, Tim Guilliams, Joanna Latimer, Christine McNamee, et al.

</span>
<span class="ltx_bibblock">Drug repurposing: progress, challenges and recommendations.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib11.1.1">Nature reviews Drug discovery</span>, 18(1):41–58, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Yann LeCun, Yoshua Bengio, and Geoffrey Hinton.

</span>
<span class="ltx_bibblock">Deep learning.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib12.1.1">nature</span>, 521(7553):436–444, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Yixin Wang and David Blei.

</span>
<span class="ltx_bibblock">Variational bayes under model misspecification.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib13.1.1">Advances in Neural Information Processing Systems</span>, 32, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan N Gomez, Lukasz Kaiser, and Illia Polosukhin.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib14.1.1">Advances in Neural Information Processing Systems</span>, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Jonathan Ho, Ajay Jain, and Pieter Abbeel.

</span>
<span class="ltx_bibblock">Denoising diffusion probabilistic models.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib15.1.1">Advances in neural information processing systems</span>, 33:6840–6851, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Benjamin Sanchez-Lengeling and Alán Aspuru-Guzik.

</span>
<span class="ltx_bibblock">Inverse molecular design using machine learning: Generative models for matter engineering.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib16.1.1">Science</span>, 361(6400):360–365, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Rafael Gómez-Bombarelli, Jennifer N Wei, David Duvenaud, José Miguel Hernández-Lobato, Benjamín Sánchez-Lengeling, Dennis Sheberla, Jorge Aguilera-Iparraguirre, Timothy D Hirzel, Ryan P Adams, and Alán Aspuru-Guzik.

</span>
<span class="ltx_bibblock">Automatic chemical design using a data-driven continuous representation of molecules.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib17.1.1">ACS central science</span>, 4(2):268–276, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Wengong Jin, Regina Barzilay, and Tommi Jaakkola.

</span>
<span class="ltx_bibblock">Junction tree variational autoencoder for molecular graph generation.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib18.1.1">International conference on machine learning</span>, pages 2323–2332. PMLR, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Thomas Blaschke, Josep Arús-Pous, Hongming Chen, Christian Margreitter, Christian Tyrchan, Ola Engkvist, Kostas Papadopoulos, and Atanas Patronov.

</span>
<span class="ltx_bibblock">Reinvent 2.0: an ai tool for de novo drug design.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib19.1.1">Journal of chemical information and modeling</span>, 60(12):5918–5922, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Tianfan Fu, Wenhao Gao, Cao Xiao, Jacob Yasonik, Connor W Coley, and Jimeng Sun.

</span>
<span class="ltx_bibblock">Differentiable scaffolding tree for molecular optimization.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib20.1.1">International Conference on Learning Representations</span>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Joshua Meyers, Benedek Fabian, and Nathan Brown.

</span>
<span class="ltx_bibblock">De novo molecular design and generative models.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib21.1.1">Drug discovery today</span>, 26(11):2707–2715, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Dylan M Anstine and Olexandr Isayev.

</span>
<span class="ltx_bibblock">Generative models as an emerging paradigm in the chemical sciences.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib22.1.1">Journal of the American Chemical Society</span>, 145(16):8736–8750, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Akshay Subramanian, Wenhao Gao, Regina Barzilay, Jeffrey C Grossman, Tommi Jaakkola, Stefanie Jegelka, Mingda Li, Ju Li, Wojciech Matusik, Elsa Olivetti, et al.

</span>
<span class="ltx_bibblock">Closing the execution gap in generative ai for chemicals and materials: Freeways or safeguards.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib23.1.1">An MIT Exploration of Generative AI</span>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Adam Paszke, Sam Gross, Soumith Chintala, Gregory Chanan, Edward Yang, Zachary DeVito, Zeming Lin, Alban Desmaison, Luca Antiga, and Adam Lerer.

</span>
<span class="ltx_bibblock">Automatic differentiation in pytorch.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib24.1.1">Conference on Neural Information Processing Systems</span>, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
W Patrick Walters, Matthew T Stahl, and Mark A Murcko.

</span>
<span class="ltx_bibblock">Virtual screening—an overview.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib25.1.1">Drug discovery today</span>, 3(4):160–178, 1998.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Brian K Shoichet.

</span>
<span class="ltx_bibblock">Virtual screening of chemical libraries.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib26.1.1">Nature</span>, 432(7019):862–865, 2004.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
W Patrick Walters.

</span>
<span class="ltx_bibblock">Virtual chemical libraries: miniperspective.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib27.1.1">Journal of medicinal chemistry</span>, 62(3):1116–1124, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Venkat Venkatasubramanian, King Chan, and James M Caruthers.

</span>
<span class="ltx_bibblock">Evolutionary design of molecules with desired properties using the genetic algorithm.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib28.1.1">Journal of Chemical Information and Computer Sciences</span>, 35(2):188–195, 1995.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
Jan H Jensen.

</span>
<span class="ltx_bibblock">A graph-based genetic algorithm and generative model/monte carlo tree search for the exploration of chemical space.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib29.1.1">Chemical science</span>, 10(12):3567–3572, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Wenhao Gao and Connor W Coley.

</span>
<span class="ltx_bibblock">The synthesizability of molecules proposed by generative models.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib30.1.1">Journal of chemical information and modeling</span>, 60(12):5714–5723, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Philipp Renz, Dries Van Rompaey, Jörg Kurt Wegner, Sepp Hochreiter, and Günter Klambauer.

</span>
<span class="ltx_bibblock">On failure modes in molecule generation and optimization.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib31.1.1">Drug Discovery Today: Technologies</span>, 32:55–63, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
W Patrick Walters and Regina Barzilay.

</span>
<span class="ltx_bibblock">Critical assessment of ai in drug discovery.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib32.1.1">Expert opinion on drug discovery</span>, 16(9):937–947, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Megan Stanley and Marwin Segler.

</span>
<span class="ltx_bibblock">Fake it until you make it? generative de novo design and virtual screening of synthesizable molecules.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib33.1.1">Current Opinion in Structural Biology</span>, 82:102658, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
Christos A Nicolaou, Christine Humblet, Hong Hu, Eva M Martin, Frank C Dorsey, Thomas M Castle, Keith Ian Burton, Haitao Hu, Jorg Hendle, Michael J Hickey, et al.

</span>
<span class="ltx_bibblock">Idea2data: toward a new paradigm for drug discovery.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib34.1.1">ACS medicinal chemistry letters</span>, 10(3):278–286, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
Cara E Brocklehurst, Eva Altmann, Corentin Bon, Holly Davis, David Dunstan, Peter Ertl, Carol Ginsburg-Moraff, Jonathan Grob, Daniel J Gosling, Guillaume Lapointe, et al.

</span>
<span class="ltx_bibblock">Microcycle: An integrated and automated platform to accelerate drug discovery.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib35.1.1">Journal of medicinal chemistry</span>, 67(3):2118–2128, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
Gisbert Schneider.

</span>
<span class="ltx_bibblock">Automating drug discovery.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib36.1.1">Nature reviews drug discovery</span>, 17(2):97–113, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
Connor W Coley, Natalie S Eyke, and Klavs F Jensen.

</span>
<span class="ltx_bibblock">Autonomous discovery in the chemical sciences part i: Progress.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib37.1.1">Angewandte Chemie International Edition</span>, 59(51):22858–22893, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
Connor W Coley, Natalie S Eyke, and Klavs F Jensen.

</span>
<span class="ltx_bibblock">Autonomous discovery in the chemical sciences part ii: outlook.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib38.1.1">Angewandte Chemie International Edition</span>, 59(52):23414–23436, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
Brent A Koscher, Richard B Canty, Matthew A McDonald, Kevin P Greenman, Charles J McGill, Camille L Bilodeau, Wengong Jin, Haoyang Wu, Florence H Vermeire, Brooke Jin, et al.

</span>
<span class="ltx_bibblock">Autonomous, multiproperty-driven molecular discovery: From predictions to measurements and back.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib39.1.1">Science</span>, 382(6677):eadi1407, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
Felix Strieth-Kalthoff, Han Hao, Vandana Rathore, Joshua Derasp, Théophile Gaudin, Nicholas H Angello, Martin Seifrid, Ekaterina Trushina, Mason Guy, Junliang Liu, et al.

</span>
<span class="ltx_bibblock">Delocalized, asynchronous, closed-loop discovery of organic laser emitters.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib40.1.1">Science</span>, 384(6697):eadk9227, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
Julius Seumer, Jonathan Kirschner Solberg Hansen, Mogens Brøndsted Nielsen, and Jan H Jensen.

</span>
<span class="ltx_bibblock">Computational evolution of new catalysts for the morita–baylis–hillman reaction.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib41.1.1">Angewandte Chemie International Edition</span>, 62(18):e202218565, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
Peter Ertl and Ansgar Schuffenhauer.

</span>
<span class="ltx_bibblock">Estimation of synthetic accessibility score of drug-like molecules based on molecular complexity and fragment contributions.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib42.1.1">Journal of cheminformatics</span>, 1:1–11, 2009.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
Amol Thakkar, Veronika Chadimová, Esben Jannik Bjerrum, Ola Engkvist, and Jean-Louis Reymond.

</span>
<span class="ltx_bibblock">Retrosynthetic accessibility score (rascore)–rapid machine learned synthesizability classification from ai driven retrosynthetic planning.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib43.1.1">Chemical science</span>, 12(9):3339–3349, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock">
Cheng-Hao Liu, Maksym Korablyov, Stanisław Jastrzebski, Paweł Włodarczyk-Pruszynski, Yoshua Bengio, and Marwin Segler.

</span>
<span class="ltx_bibblock">Retrognn: fast estimation of synthesizability for virtual screening and de novo design by learning from slow retrosynthesis software.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib44.1.1">Journal of Chemical Information and Modeling</span>, 62(10):2293–2300, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock">
Wenhao Gao, Tianfan Fu, Jimeng Sun, and Connor Coley.

</span>
<span class="ltx_bibblock">Sample efficiency matters: a benchmark for practical molecular optimization.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib45.1.1">Advances in neural information processing systems</span>, 35:21342–21357, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock">
Jeff Guo and Philippe Schwaller.

</span>
<span class="ltx_bibblock">Saturn: Sample-efficient generative molecular design using memory manipulation.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib46.1.1">arXiv preprint arXiv:2405.17066</span>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock">
Jeff Guo and Philippe Schwaller.

</span>
<span class="ltx_bibblock">Directly optimizing for synthesizability in generative molecular design using retrosynthesis models.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib47.1.1">arXiv preprint arXiv:2407.12186</span>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock">
Torsten Hoffmann and Marcus Gastreich.

</span>
<span class="ltx_bibblock">The next level in chemical space navigation: going far beyond enumerable compound libraries.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib48.1.1">Drug discovery today</span>, 24(5):1148–1156, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock">
Hitesh Patel, Wolf-Dietrich Ihlenfeldt, Philip N Judson, Yurii S Moroz, Yuri Pevzner, Megan L Peach, Victorien Delannée, Nadya I Tarasova, and Marc C Nicklaus.

</span>
<span class="ltx_bibblock">Savi, in silico generation of billions of easily synthesizable compounds through expert-system type rules.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib49.1.1">Scientific data</span>, 7(1):384, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock">
Oleksandr O Grygorenko, Dmytro S Radchenko, Igor Dziuba, Alexander Chuprina, Kateryna E Gubina, and Yurii S Moroz.

</span>
<span class="ltx_bibblock">Generating multibillion chemical space of readily accessible screening compounds.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib50.1.1">Iscience</span>, 23(11), 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_tag_bibitem">[51]</span>
<span class="ltx_bibblock">
WuXi AppTec.

</span>
<span class="ltx_bibblock">Virtual screening - hit finding and screening services, September 2024.

</span>
<span class="ltx_bibblock">Accessed: 2022-12-08.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_tag_bibitem">[52]</span>
<span class="ltx_bibblock">
Alexander Neumann, Lester Marrison, and Raphael Klein.

</span>
<span class="ltx_bibblock">Relevance of the trillion-sized chemical space “explore” as a source for drug discovery.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib52.1.1">ACS Medicinal Chemistry Letters</span>, 14(4):466–472, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_tag_bibitem">[53]</span>
<span class="ltx_bibblock">
Corentin Bedart, Grace Shimokura, Frederick G West, Tabitha E Wood, Robert A Batey, John J Irwin, and Matthieu Schapira.

</span>
<span class="ltx_bibblock">The pan-canadian chemical library: A mechanism to open academic chemistry to high-throughput virtual screening.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib53.1.1">Scientific Data</span>, 11(1):597, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_tag_bibitem">[54]</span>
<span class="ltx_bibblock">
H Maarten Vinkers, Marc R de Jonge, Frederik FD Daeyaert, Jan Heeres, Lucien MH Koymans, Joop H van Lenthe, Paul J Lewi, Henk Timmerman, Koen Van Aken, and Paul AJ Janssen.

</span>
<span class="ltx_bibblock">Synopsis: synthesize and optimize system in silico.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib54.1.1">Journal of medicinal chemistry</span>, 46(13):2765–2773, 2003.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_tag_bibitem">[55]</span>
<span class="ltx_bibblock">
Markus Hartenfeller, Heiko Zettl, Miriam Walter, Matthias Rupp, Felix Reisen, Ewgenij Proschak, Sascha Weggen, Holger Stark, and Gisbert Schneider.

</span>
<span class="ltx_bibblock">Dogs: reaction-driven de novo design of bioactive compounds.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib55.1.1">PLoS computational biology</span>, 8(2):e1002380, 2012.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_tag_bibitem">[56]</span>
<span class="ltx_bibblock">
Ksenia Korovina, Sailun Xu, Kirthevasan Kandasamy, Willie Neiswanger, Barnabas Poczos, Jeff Schneider, and Eric Xing.

</span>
<span class="ltx_bibblock">Chembo: Bayesian optimization of small organic molecules with synthesizable recommendations.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib56.1.1">International Conference on Artificial Intelligence and Statistics</span>, pages 3393–3403. PMLR, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib57">
<span class="ltx_tag ltx_tag_bibitem">[57]</span>
<span class="ltx_bibblock">
Dai Hai Nguyen and Koji Tsuda.

</span>
<span class="ltx_bibblock">A generative model for molecule generation based on chemical reaction trees.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib57.1.1">arXiv preprint arXiv:2106.03394</span>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib58">
<span class="ltx_tag ltx_tag_bibitem">[58]</span>
<span class="ltx_bibblock">
Arman A Sadybekov, Anastasiia V Sadybekov, Yongfeng Liu, Christos Iliopoulos-Tsoutsouvas, Xi-Ping Huang, Julie Pickett, Blake Houser, Nilkanth Patel, Ngan K Tran, Fei Tong, et al.

</span>
<span class="ltx_bibblock">Synthon-based ligand discovery in virtual libraries of over 11 billion compounds.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib58.1.1">Nature</span>, 601(7893):452–459, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib59">
<span class="ltx_tag ltx_tag_bibitem">[59]</span>
<span class="ltx_bibblock">
Kyle Swanson, Gary Liu, Denise B Catacutan, Autumn Arnold, James Zou, and Jonathan M Stokes.

</span>
<span class="ltx_bibblock">Generative ai for designing and validating easily synthesizable and structurally novel antibiotics.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib59.1.1">Nature Machine Intelligence</span>, 6(3):338–353, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib60">
<span class="ltx_tag ltx_tag_bibitem">[60]</span>
<span class="ltx_bibblock">
Michael Sun, Alston Lo, Wenhao Gao, Minghao Guo, Veronika Thost, Jie Chen, Connor Coley, and Wojciech Matusik.

</span>
<span class="ltx_bibblock">Syntax-guided procedural synthesis of molecules.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib60.1.1">arXiv preprint arXiv:2409.05873</span>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib61">
<span class="ltx_tag ltx_tag_bibitem">[61]</span>
<span class="ltx_bibblock">
John Bradshaw, Brooks Paige, Matt J Kusner, Marwin Segler, and José Miguel Hernández-Lobato.

</span>
<span class="ltx_bibblock">A model to search for synthesizable molecules.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib61.1.1">Advances in Neural Information Processing Systems</span>, 32, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib62">
<span class="ltx_tag ltx_tag_bibitem">[62]</span>
<span class="ltx_bibblock">
Sai Krishna Gottipati, Boris Sattarov, Sufeng Niu, Yashaswi Pathak, Haoran Wei, Shengchao Liu, Simon Blackburn, Karam Thomas, Connor Coley, Jian Tang, et al.

</span>
<span class="ltx_bibblock">Learning to navigate the synthetically accessible chemical space using reinforcement learning.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib62.1.1">International conference on machine learning</span>, pages 3668–3679. PMLR, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib63">
<span class="ltx_tag ltx_tag_bibitem">[63]</span>
<span class="ltx_bibblock">
Julien Horwood and Emmanuel Noutahi.

</span>
<span class="ltx_bibblock">Molecular design in synthetically accessible chemical space via deep reinforcement learning.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib63.1.1">ACS omega</span>, 5(51):32984–32994, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib64">
<span class="ltx_tag ltx_tag_bibitem">[64]</span>
<span class="ltx_bibblock">
John Bradshaw, Brooks Paige, Matt J Kusner, Marwin Segler, and José Miguel Hernández-Lobato.

</span>
<span class="ltx_bibblock">Barking up the right tree: an approach to search over molecule synthesis dags.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib64.1.1">Advances in neural information processing systems</span>, 33:6852–6866, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib65">
<span class="ltx_tag ltx_tag_bibitem">[65]</span>
<span class="ltx_bibblock">
Wenhao Gao, Rocío Mercado, and Connor W Coley.

</span>
<span class="ltx_bibblock">Amortized tree generation for bottom-up synthesis planning and synthesizable molecular design.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib65.1.1">International Conference on Learning Representations</span>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib66">
<span class="ltx_tag ltx_tag_bibitem">[66]</span>
<span class="ltx_bibblock">
Michał Koziarski, Andrei Rekesh, Dmytro Shevchuk, Almer van der Sloot, Piotr Gaiński, Yoshua Bengio, Cheng-Hao Liu, Mike Tyers, and Robert A Batey.

</span>
<span class="ltx_bibblock">Rgfn: Synthesizable molecular generation using gflownets.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib66.1.1">arXiv preprint arXiv:2406.08506</span>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib67">
<span class="ltx_tag ltx_tag_bibitem">[67]</span>
<span class="ltx_bibblock">
Shitong Luo, Wenhao Gao, Zuofan Wu, Jian Peng, Connor W Coley, and Jianzhu Ma.

</span>
<span class="ltx_bibblock">Projecting molecules into synthesizable chemical spaces.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib67.1.1">International Conference on Machine Learning</span>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib68">
<span class="ltx_tag ltx_tag_bibitem">[68]</span>
<span class="ltx_bibblock">
David Mendez, Anna Gaulton, A Patrícia Bento, Jon Chambers, Marleen De Veij, Eloy Félix, María Paula Magariños, Juan F Mosquera, Prudence Mutowo, Michał Nowotka, et al.

</span>
<span class="ltx_bibblock">Chembl: towards direct deposition of bioassay data.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib68.1.1">Nucleic acids research</span>, 47(D1):D930–D940, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib69">
<span class="ltx_tag ltx_tag_bibitem">[69]</span>
<span class="ltx_bibblock">
Harry L Morgan.

</span>
<span class="ltx_bibblock">The generation of a unique machine description for chemical structures-a technique developed at chemical abstracts service.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib69.1.1">Journal of chemical documentation</span>, 5(2):107–113, 1965.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib70">
<span class="ltx_tag ltx_tag_bibitem">[70]</span>
<span class="ltx_bibblock">
Emiel Hoogeboom, Didrik Nielsen, Priyank Jaini, Patrick Forré, and Max Welling.

</span>
<span class="ltx_bibblock">Argmax flows and multinomial diffusion: Learning categorical distributions.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib70.1.1">Advances in Neural Information Processing Systems</span>, 34:12454–12465, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib71">
<span class="ltx_tag ltx_tag_bibitem">[71]</span>
<span class="ltx_bibblock">
David Weininger.

</span>
<span class="ltx_bibblock">Smiles, a chemical language and information system. 1. introduction to methodology and encoding rules.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib71.1.1">Journal of chemical information and computer sciences</span>, 28(1):31–36, 1988.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib72">
<span class="ltx_tag ltx_tag_bibitem">[72]</span>
<span class="ltx_bibblock">
Jie Zhang, Rocío Mercado, Ola Engkvist, and Hongming Chen.

</span>
<span class="ltx_bibblock">Comparative study of deep generative models on chemical space coverage.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib72.1.1">Journal of Chemical Information and Modeling</span>, 61(6):2572–2581, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib73">
<span class="ltx_tag ltx_tag_bibitem">[73]</span>
<span class="ltx_bibblock">
Nathan C Frey, Ryan Soklaski, Simon Axelrod, Siddharth Samsi, Rafael Gomez-Bombarelli, Connor W Coley, and Vijay Gadepally.

</span>
<span class="ltx_bibblock">Neural scaling of deep chemical models.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib73.1.1">Nature Machine Intelligence</span>, 5(11):1297–1305, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib74">
<span class="ltx_tag ltx_tag_bibitem">[74]</span>
<span class="ltx_bibblock">
Jared Kaplan, Sam McCandlish, Tom Henighan, Tom B Brown, Benjamin Chess, Rewon Child, Scott Gray, Alec Radford, Jeffrey Wu, and Dario Amodei.

</span>
<span class="ltx_bibblock">Scaling laws for neural language models.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib74.1.1">arXiv preprint arXiv:2001.08361</span>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib75">
<span class="ltx_tag ltx_tag_bibitem">[75]</span>
<span class="ltx_bibblock">
ASKCOS Project.

</span>
<span class="ltx_bibblock">Askcos: Ai-driven synthesis planning.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib75.1.1">https://askcos.mit.edu/</span>.

</span>
<span class="ltx_bibblock">Accessed: 2024-09-16.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib76">
<span class="ltx_tag ltx_tag_bibitem">[76]</span>
<span class="ltx_bibblock">
Nathan Brown, Marco Fiscato, Marwin HS Segler, and Alain C Vaucher.

</span>
<span class="ltx_bibblock">Guacamol: benchmarking models for de novo molecular design.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib76.1.1">Journal of chemical information and modeling</span>, 59(3):1096–1108, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib77">
<span class="ltx_tag ltx_tag_bibitem">[77]</span>
<span class="ltx_bibblock">
Valerie J Gillet, William Newell, Paulina Mata, Glenn Myatt, Sandor Sike, Zsolt Zsoldos, and A Peter Johnson.

</span>
<span class="ltx_bibblock">Sprout: recent developments in the de novo design of molecules.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib77.1.1">Journal of chemical information and computer sciences</span>, 34(1):207–217, 1994.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib78">
<span class="ltx_tag ltx_tag_bibitem">[78]</span>
<span class="ltx_bibblock">
Regine S Bohacek, Colin McMartin, and Wayne C Guida.

</span>
<span class="ltx_bibblock">The art and practice of structure-based drug design: a molecular modeling perspective.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib78.1.1">Medicinal research reviews</span>, 16(1):3–50, 1996.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib79">
<span class="ltx_tag ltx_tag_bibitem">[79]</span>
<span class="ltx_bibblock">
Renxiao Wang, Ying Gao, and Luhua Lai.

</span>
<span class="ltx_bibblock">Ligbuilder: a multi-purpose program for structure-based drug design.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib79.1.1">Molecular modeling annual</span>, 6:498–516, 2000.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib80">
<span class="ltx_tag ltx_tag_bibitem">[80]</span>
<span class="ltx_bibblock">
Valerie J Gillet, Glenn Myatt, Zsolt Zsoldos, and A Peter Johnson.

</span>
<span class="ltx_bibblock">Sprout, hippo and caesa: Tools for de novo structure generation and estimation of synthetic accessibility.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib80.1.1">Perspectives in Drug Discovery and Design</span>, 3:34–50, 1995.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib81">
<span class="ltx_tag ltx_tag_bibitem">[81]</span>
<span class="ltx_bibblock">
Charles Harris, Kieran Didi, Arian R Jamasb, Chaitanya K Joshi, Simon V Mathis, Pietro Lio, and Tom Blundell.

</span>
<span class="ltx_bibblock">Benchmarking generated poses: How rational is structure-based drug design with generative models?

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib81.1.1">arXiv preprint arXiv:2308.07413</span>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib82">
<span class="ltx_tag ltx_tag_bibitem">[82]</span>
<span class="ltx_bibblock">
Shitong Luo, Jiaqi Guan, Jianzhu Ma, and Jian Peng.

</span>
<span class="ltx_bibblock">A 3d generative model for structure-based drug design.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib82.1.1">Advances in Neural Information Processing Systems</span>, 34:6229–6239, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib83">
<span class="ltx_tag ltx_tag_bibitem">[83]</span>
<span class="ltx_bibblock">
Viet-Khoa Tran-Nguyen, Célien Jacquemard, and Didier Rognan.

</span>
<span class="ltx_bibblock">Lit-pcba: an unbiased data set for machine learning and virtual screening.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib83.1.1">Journal of chemical information and modeling</span>, 60(9):4263–4273, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib84">
<span class="ltx_tag ltx_tag_bibitem">[84]</span>
<span class="ltx_bibblock">
Oleg Trott and Arthur J Olson.

</span>
<span class="ltx_bibblock">Autodock vina: improving the speed and accuracy of docking with a new scoring function, efficient optimization, and multithreading.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib84.1.1">Journal of computational chemistry</span>, 31(2):455–461, 2010.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib85">
<span class="ltx_tag ltx_tag_bibitem">[85]</span>
<span class="ltx_bibblock">
Itai Levin, Michael E Fortunato, Kian L Tan, and Connor W Coley.

</span>
<span class="ltx_bibblock">Computer-aided evaluation and exploration of chemical spaces constrained by reaction pathways.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib85.1.1">AIChE journal</span>, 69(12):e18234, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib86">
<span class="ltx_tag ltx_tag_bibitem">[86]</span>
<span class="ltx_bibblock">
Matt J Kusner, Brooks Paige, and José Miguel Hernández-Lobato.

</span>
<span class="ltx_bibblock">Grammar variational autoencoder.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib86.1.1">International conference on machine learning</span>, pages 1945–1954. PMLR, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib87">
<span class="ltx_tag ltx_tag_bibitem">[87]</span>
<span class="ltx_bibblock">
Teague Sterling and John J Irwin.

</span>
<span class="ltx_bibblock">Zinc 15–ligand discovery for everyone.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib87.1.1">Journal of chemical information and modeling</span>, 55(11):2324–2337, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib88">
<span class="ltx_tag ltx_tag_bibitem">[88]</span>
<span class="ltx_bibblock">
Chia-Yi Kuan, Alan J Whitmarsh, Derek D Yang, Guanghong Liao, Aryn J Schloemer, Chen Dong, Jue Bao, Kenneth J Banasiak, Gabriel G Haddad, Richard A Flavell, et al.

</span>
<span class="ltx_bibblock">A critical role of neural-specific jnk3 for ischemic apoptosis.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib88.1.1">Proceedings of the National Academy of Sciences</span>, 100(25):15184–15189, 2003.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib89">
<span class="ltx_tag ltx_tag_bibitem">[89]</span>
<span class="ltx_bibblock">
Jiangming Sun, Nina Jeliazkova, Vladimir Chupakhin, Jose-Felipe Golib-Dzib, Ola Engkvist, Lars Carlsson, Jörg Wegner, Hugo Ceulemans, Ivan Georgiev, Vedrin Jeliazkov, et al.

</span>
<span class="ltx_bibblock">Excape-db: an integrated large scale dataset facilitating big data analysis in chemogenomics.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib89.1.1">Journal of cheminformatics</span>, 9:1–9, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib90">
<span class="ltx_tag ltx_tag_bibitem">[90]</span>
<span class="ltx_bibblock">
Yibo Li, Liangren Zhang, and Zhenming Liu.

</span>
<span class="ltx_bibblock">Multi-objective de novo drug design with conditional graph generative model.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib90.1.1">Journal of cheminformatics</span>, 10:1–24, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib91">
<span class="ltx_tag ltx_tag_bibitem">[91]</span>
<span class="ltx_bibblock">
Dimitrios Anastasiou, Yimin Yu, William J Israelsen, Jian-Kang Jiang, Matthew B Boxer, Bum Soo Hong, Wolfram Tempel, Svetoslav Dimov, Min Shen, Abhishek Jha, et al.

</span>
<span class="ltx_bibblock">Pyruvate kinase m2 activators promote tetramer formation and suppress tumorigenesis.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib91.1.1">Nature chemical biology</span>, 8(10):839–847, 2012.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib92">
<span class="ltx_tag ltx_tag_bibitem">[92]</span>
<span class="ltx_bibblock">
Philip G Humphreys, Paul Bamborough, Chun-wa Chung, Peter D Craggs, Laurie Gordon, Paola Grandi, Thomas G Hayhow, Jameed Hussain, Katherine L Jones, Matthew Lindon, et al.

</span>
<span class="ltx_bibblock">Discovery of a potent, cell penetrant, and selective p300/cbp-associated factor (pcaf)/general control nonderepressible 5 (gcn5) bromodomain chemical probe.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib92.1.1">Journal of medicinal chemistry</span>, 60(2):695–709, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib93">
<span class="ltx_tag ltx_tag_bibitem">[93]</span>
<span class="ltx_bibblock">
Uschi Dolfus, Hans Briem, and Matthias Rarey.

</span>
<span class="ltx_bibblock">Synthesis-aware generation of structural analogues.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib93.1.1">Journal of Chemical Information and Modeling</span>, 62(15):3565–3576, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib94">
<span class="ltx_tag ltx_tag_bibitem">[94]</span>
<span class="ltx_bibblock">
Ronald J Williams.

</span>
<span class="ltx_bibblock">Simple statistical gradient-following algorithms for connectionist reinforcement learning.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib94.1.1">Machine learning</span>, 8:229–256, 1992.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib95">
<span class="ltx_tag ltx_tag_bibitem">[95]</span>
<span class="ltx_bibblock">
Lucia Vallar and Jacopo Meldolesi.

</span>
<span class="ltx_bibblock">Mechanisms of signal transduction at the dopamine d2 receptor.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib95.1.1">Trends in pharmacological sciences</span>, 10(2):74–77, 1989.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib96">
<span class="ltx_tag ltx_tag_bibitem">[96]</span>
<span class="ltx_bibblock">
Emmanuel Bengio, Moksh Jain, Maksym Korablyov, Doina Precup, and Yoshua Bengio.

</span>
<span class="ltx_bibblock">Flow network based generative models for non-iterative diverse candidate generation.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib96.1.1">Advances in Neural Information Processing Systems</span>, 34:27381–27394, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib97">
<span class="ltx_tag ltx_tag_bibitem">[97]</span>
<span class="ltx_bibblock">
Jeff Guo and Philippe Schwaller.

</span>
<span class="ltx_bibblock">Augmented memory: Sample-efficient generative molecular design with reinforcement learning.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib97.1.1">Jacs Au</span>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib98">
<span class="ltx_tag ltx_tag_bibitem">[98]</span>
<span class="ltx_bibblock">
Austin Tripp and José Miguel Hernández-Lobato.

</span>
<span class="ltx_bibblock">Genetic algorithms are strong baselines for molecule generation.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib98.1.1">arXiv preprint arXiv:2310.09267</span>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib99">
<span class="ltx_tag ltx_tag_bibitem">[99]</span>
<span class="ltx_bibblock">
Michael W Mullowney, Katherine R Duncan, Somayah S Elsayed, Neha Garg, Justin JJ van der Hooft, Nathaniel I Martin, David Meijer, Barbara R Terlouw, Friederike Biermann, Kai Blin, et al.

</span>
<span class="ltx_bibblock">Artificial intelligence for natural product drug discovery.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib99.1.1">Nature Reviews Drug Discovery</span>, 22(11):895–916, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib100">
<span class="ltx_tag ltx_tag_bibitem">[100]</span>
<span class="ltx_bibblock">
Inc. Daylight Chemical Information Systems.

</span>
<span class="ltx_bibblock">Daylight theory: Smarts.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.daylight.com/dayhtml/doc/theory/theory.smarts.html" title="">https://www.daylight.com/dayhtml/doc/theory/theory.smarts.html</a>, 2024.

</span>
<span class="ltx_bibblock">Accessed: 2024-09-05.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib101">
<span class="ltx_tag ltx_tag_bibitem">[101]</span>
<span class="ltx_bibblock">
Markus Hartenfeller, Martin Eberle, Peter Meier, Cristina Nieto-Oberhuber, Karl-Heinz Altmann, Gisbert Schneider, Edgar Jacoby, and Steffen Renner.

</span>
<span class="ltx_bibblock">A collection of robust organic synthesis reactions for in silico molecule design.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib101.1.1">Journal of chemical information and modeling</span>, 51(12):3093–3098, 2011.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib102">
<span class="ltx_tag ltx_tag_bibitem">[102]</span>
<span class="ltx_bibblock">
Alexander Button, Daniel Merk, Jan A Hiss, and Gisbert Schneider.

</span>
<span class="ltx_bibblock">Automated de novo molecular design by hybrid machine intelligence and rule-driven chemical synthesis.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib102.1.1">Nature machine intelligence</span>, 1(7):307–315, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib103">
<span class="ltx_tag ltx_tag_bibitem">[103]</span>
<span class="ltx_bibblock">
Georg Wittig and Georg Geissler.

</span>
<span class="ltx_bibblock">Zur reaktionsweise des pentaphenyl-phosphors und einiger derivate.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib103.1.1">Justus Liebigs Annalen der Chemie</span>, 580(1):44–57, 1953.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib104">
<span class="ltx_tag ltx_tag_bibitem">[104]</span>
<span class="ltx_bibblock">
John F Hartwig.

</span>
<span class="ltx_bibblock">Transition metal catalyzed synthesis of arylamines and aryl ethers from aryl halides and triflates: Scope and mechanism.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib104.1.1">Angewandte Chemie International Edition</span>, 37(15):2046–2067, 1998.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib105">
<span class="ltx_tag ltx_tag_bibitem">[105]</span>
<span class="ltx_bibblock">
Paul Jaccard.

</span>
<span class="ltx_bibblock">Étude comparative de la distribution florale dans une portion des alpes et des jura.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib105.1.1">Bull Soc Vaudoise Sci Nat</span>, 37:547–579, 1901.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib106">
<span class="ltx_tag ltx_tag_bibitem">[106]</span>
<span class="ltx_bibblock">
David Rogers and Mathew Hahn.

</span>
<span class="ltx_bibblock">Extended-connectivity fingerprints.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib106.1.1">Journal of chemical information and modeling</span>, 50(5):742–754, 2010.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib107">
<span class="ltx_tag ltx_tag_bibitem">[107]</span>
<span class="ltx_bibblock">
Barbara Zdrazil, Eloy Felix, Fiona Hunter, Emma J Manners, James Blackshaw, Sybilla Corbett, Marleen de Veij, Harris Ioannidis, David Mendez Lopez, Juan F Mosquera, et al.

</span>
<span class="ltx_bibblock">The chembl database in 2023: a drug discovery platform spanning multiple bioactivity data types and time periods.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib107.1.1">Nucleic acids research</span>, 52(D1):D1180–D1192, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib108">
<span class="ltx_tag ltx_tag_bibitem">[108]</span>
<span class="ltx_bibblock">
Christopher A Lipinski, Franco Lombardo, Beryl W Dominy, and Paul J Feeney.

</span>
<span class="ltx_bibblock">Experimental and computational approaches to estimate solubility and permeability in drug discovery and development settings.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib108.1.1">Advanced drug delivery reviews</span>, 23(1-3):3–25, 1997.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib109">
<span class="ltx_tag ltx_tag_bibitem">[109]</span>
<span class="ltx_bibblock">
Daniel F Veber, Stephen R Johnson, Hung-Yuan Cheng, Brian R Smith, Keith W Ward, and Kenneth D Kopple.

</span>
<span class="ltx_bibblock">Molecular properties that influence the oral bioavailability of drug candidates.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib109.1.1">Journal of medicinal chemistry</span>, 45(12):2615–2623, 2002.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib110">
<span class="ltx_tag ltx_tag_bibitem">[110]</span>
<span class="ltx_bibblock">
Sunghwan Kim, Paul A Thiessen, Evan E Bolton, Jie Chen, Gang Fu, Asta Gindulyte, Lianyi Han, Jane He, Siqian He, Benjamin A Shoemaker, et al.

</span>
<span class="ltx_bibblock">Pubchem substance and compound databases.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib110.1.1">Nucleic acids research</span>, 44(D1):D1202–D1213, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib111">
<span class="ltx_tag ltx_tag_bibitem">[111]</span>
<span class="ltx_bibblock">
Marcus Olivecrona, Thomas Blaschke, Ola Engkvist, and Hongming Chen.

</span>
<span class="ltx_bibblock">Molecular de-novo design through deep reinforcement learning.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib111.1.1">Journal of cheminformatics</span>, 9:1–14, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib112">
<span class="ltx_tag ltx_tag_bibitem">[112]</span>
<span class="ltx_bibblock">
Kexin Huang, Tianfan Fu, Wenhao Gao, Yue Zhao, Yusuf Roohani, Jure Leskovec, Connor W Coley, Cao Xiao, Jimeng Sun, and Marinka Zitnik.

</span>
<span class="ltx_bibblock">Therapeutics data commons: Machine learning datasets and tasks for drug discovery and development.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib112.1.1">Conference on Neural Information Processing Systems Datasets and Benchmarks Track</span>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib113">
<span class="ltx_tag ltx_tag_bibitem">[113]</span>
<span class="ltx_bibblock">
Kexin Huang, Tianfan Fu, Wenhao Gao, Yue Zhao, Yusuf Roohani, Jure Leskovec, Connor W Coley, Cao Xiao, Jimeng Sun, and Marinka Zitnik.

</span>
<span class="ltx_bibblock">Artificial intelligence foundation for therapeutic science.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib113.1.1">Nature chemical biology</span>, 18(10):1033–1036, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib114">
<span class="ltx_tag ltx_tag_bibitem">[114]</span>
<span class="ltx_bibblock">
Alexander Quinn Nichol and Prafulla Dhariwal.

</span>
<span class="ltx_bibblock">Improved denoising diffusion probabilistic models.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib114.1.1">International conference on machine learning</span>, pages 8162–8171. PMLR, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib115">
<span class="ltx_tag ltx_tag_bibitem">[115]</span>
<span class="ltx_bibblock">
Greg Landrum.

</span>
<span class="ltx_bibblock">Colliding bits.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://rdkit.blogspot.com/2014/02/colliding-bits.html" title="">https://rdkit.blogspot.com/2014/02/colliding-bits.html</a>, 2014.

</span>
<span class="ltx_bibblock">Accessed: 2024-09-24.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Additional method details</h2>
<section class="ltx_subsection" id="A1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Model architectures</h3>
<section class="ltx_subsubsection" id="A1.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.1.1 </span>Transformer decoder</h4>
<div class="ltx_para ltx_noindent" id="A1.SS1.SSS1.p1">
<p class="ltx_p" id="A1.SS1.SSS1.p1.1">SynFormer adopts the standard Transformer decoder architecture <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib14" title="">14</a>]</cite> to generate postfix notation of synthesis in an auto-regressive manner.
A postfix notation of synthesis may contain four types of tokens: a [START] token, [END] token, reaction token, and building block token.
Each token, regardless of its type, is represented as a 768-dimensional embedding vector that is differentiable during training.
Specifically, the embedding vectors of start token, end token, and reaction tokens are stored in a look-up table implemented by PyTorch’s <span class="ltx_text ltx_font_typewriter" id="A1.SS1.SSS1.p1.1.1">nn.Embedding</span> layer.
Note that, as we use a fixed set of reactions consisting of only 169 reaction templates, it is practical to store the embedding vectors for each of them.
However, the building block database, containing more than 200k molecules, is too large to assign embedding vectors to each building block separately.
Thus, we use a multi-layer perceptron (MLP), to convert 2048-bit Morgan fingerprints of building blocks into 768-dimensional continuous vectors.
This MLP consists of three layers, with hidden dimensions of 1,536 and ReLU activation.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS1.SSS1.p2">
<p class="ltx_p" id="A1.SS1.SSS1.p2.4">To inform the model with the location of each token, we add sinusoidal positional encoding <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib14" title="">14</a>]</cite> to embedding vectors:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{p}_{i}=\begin{cases}\sin\left(\frac{j}{10000^{\frac{2i}{d}}}\right),&amp;i%
=0,2,\ldots,766\\
\cos\left(\frac{j}{10000^{\frac{2i}{d}}}\right),&amp;i=1,3,\ldots,767\\
\end{cases}\ ," class="ltx_Math" display="block" id="A1.E5.m1.5"><semantics id="A1.E5.m1.5a"><mrow id="A1.E5.m1.5.5.1" xref="A1.E5.m1.5.5.1.1.cmml"><mrow id="A1.E5.m1.5.5.1.1" xref="A1.E5.m1.5.5.1.1.cmml"><msub id="A1.E5.m1.5.5.1.1.2" xref="A1.E5.m1.5.5.1.1.2.cmml"><mi id="A1.E5.m1.5.5.1.1.2.2" xref="A1.E5.m1.5.5.1.1.2.2.cmml">𝐩</mi><mi id="A1.E5.m1.5.5.1.1.2.3" xref="A1.E5.m1.5.5.1.1.2.3.cmml">i</mi></msub><mo id="A1.E5.m1.5.5.1.1.1" xref="A1.E5.m1.5.5.1.1.1.cmml">=</mo><mrow id="A1.E5.m1.4.4" xref="A1.E5.m1.5.5.1.1.3.1.cmml"><mo id="A1.E5.m1.4.4.5" xref="A1.E5.m1.5.5.1.1.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" id="A1.E5.m1.4.4.4" rowspacing="0pt" xref="A1.E5.m1.5.5.1.1.3.1.cmml"><mtr id="A1.E5.m1.4.4.4a" xref="A1.E5.m1.5.5.1.1.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="A1.E5.m1.4.4.4b" xref="A1.E5.m1.5.5.1.1.3.1.cmml"><mrow id="A1.E5.m1.1.1.1.1.1.1.3" xref="A1.E5.m1.5.5.1.1.3.1.cmml"><mrow id="A1.E5.m1.1.1.1.1.1.1.3.1.2" xref="A1.E5.m1.1.1.1.1.1.1.3.1.1.cmml"><mi id="A1.E5.m1.1.1.1.1.1.1.1" xref="A1.E5.m1.1.1.1.1.1.1.1.cmml">sin</mi><mo id="A1.E5.m1.1.1.1.1.1.1.3.1.2a" xref="A1.E5.m1.1.1.1.1.1.1.3.1.1.cmml">⁡</mo><mrow id="A1.E5.m1.1.1.1.1.1.1.3.1.2.1" xref="A1.E5.m1.1.1.1.1.1.1.3.1.1.cmml"><mo id="A1.E5.m1.1.1.1.1.1.1.3.1.2.1.1" xref="A1.E5.m1.1.1.1.1.1.1.3.1.1.cmml">(</mo><mstyle displaystyle="false" id="A1.E5.m1.1.1.1.1.1.1.2" xref="A1.E5.m1.1.1.1.1.1.1.2.cmml"><mfrac id="A1.E5.m1.1.1.1.1.1.1.2a" xref="A1.E5.m1.1.1.1.1.1.1.2.cmml"><mi id="A1.E5.m1.1.1.1.1.1.1.2.2" xref="A1.E5.m1.1.1.1.1.1.1.2.2.cmml">j</mi><msup id="A1.E5.m1.1.1.1.1.1.1.2.3" xref="A1.E5.m1.1.1.1.1.1.1.2.3.cmml"><mn id="A1.E5.m1.1.1.1.1.1.1.2.3.2" xref="A1.E5.m1.1.1.1.1.1.1.2.3.2.cmml">10000</mn><mfrac id="A1.E5.m1.1.1.1.1.1.1.2.3.3" xref="A1.E5.m1.1.1.1.1.1.1.2.3.3.cmml"><mrow id="A1.E5.m1.1.1.1.1.1.1.2.3.3.2" xref="A1.E5.m1.1.1.1.1.1.1.2.3.3.2.cmml"><mn id="A1.E5.m1.1.1.1.1.1.1.2.3.3.2.2" xref="A1.E5.m1.1.1.1.1.1.1.2.3.3.2.2.cmml">2</mn><mo id="A1.E5.m1.1.1.1.1.1.1.2.3.3.2.1" xref="A1.E5.m1.1.1.1.1.1.1.2.3.3.2.1.cmml">⁢</mo><mi id="A1.E5.m1.1.1.1.1.1.1.2.3.3.2.3" xref="A1.E5.m1.1.1.1.1.1.1.2.3.3.2.3.cmml">i</mi></mrow><mi id="A1.E5.m1.1.1.1.1.1.1.2.3.3.3" xref="A1.E5.m1.1.1.1.1.1.1.2.3.3.3.cmml">d</mi></mfrac></msup></mfrac></mstyle><mo id="A1.E5.m1.1.1.1.1.1.1.3.1.2.1.2" xref="A1.E5.m1.1.1.1.1.1.1.3.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E5.m1.1.1.1.1.1.1.3.2" xref="A1.E5.m1.5.5.1.1.3.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="A1.E5.m1.4.4.4c" xref="A1.E5.m1.5.5.1.1.3.1.cmml"><mrow id="A1.E5.m1.2.2.2.2.2.1" xref="A1.E5.m1.2.2.2.2.2.1.cmml"><mi id="A1.E5.m1.2.2.2.2.2.1.6" xref="A1.E5.m1.2.2.2.2.2.1.6.cmml">i</mi><mo id="A1.E5.m1.2.2.2.2.2.1.5" xref="A1.E5.m1.2.2.2.2.2.1.5.cmml">=</mo><mrow id="A1.E5.m1.2.2.2.2.2.1.7.2" xref="A1.E5.m1.2.2.2.2.2.1.7.1.cmml"><mn id="A1.E5.m1.2.2.2.2.2.1.1" xref="A1.E5.m1.2.2.2.2.2.1.1.cmml">0</mn><mo id="A1.E5.m1.2.2.2.2.2.1.7.2.1" xref="A1.E5.m1.2.2.2.2.2.1.7.1.cmml">,</mo><mn id="A1.E5.m1.2.2.2.2.2.1.2" xref="A1.E5.m1.2.2.2.2.2.1.2.cmml">2</mn><mo id="A1.E5.m1.2.2.2.2.2.1.7.2.2" xref="A1.E5.m1.2.2.2.2.2.1.7.1.cmml">,</mo><mi id="A1.E5.m1.2.2.2.2.2.1.3" mathvariant="normal" xref="A1.E5.m1.2.2.2.2.2.1.3.cmml">…</mi><mo id="A1.E5.m1.2.2.2.2.2.1.7.2.3" xref="A1.E5.m1.2.2.2.2.2.1.7.1.cmml">,</mo><mn id="A1.E5.m1.2.2.2.2.2.1.4" xref="A1.E5.m1.2.2.2.2.2.1.4.cmml">766</mn></mrow></mrow></mtd></mtr><mtr id="A1.E5.m1.4.4.4d" xref="A1.E5.m1.5.5.1.1.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="A1.E5.m1.4.4.4e" xref="A1.E5.m1.5.5.1.1.3.1.cmml"><mrow id="A1.E5.m1.3.3.3.3.1.1.3" xref="A1.E5.m1.5.5.1.1.3.1.cmml"><mrow id="A1.E5.m1.3.3.3.3.1.1.3.1.2" xref="A1.E5.m1.3.3.3.3.1.1.3.1.1.cmml"><mi id="A1.E5.m1.3.3.3.3.1.1.1" xref="A1.E5.m1.3.3.3.3.1.1.1.cmml">cos</mi><mo id="A1.E5.m1.3.3.3.3.1.1.3.1.2a" xref="A1.E5.m1.3.3.3.3.1.1.3.1.1.cmml">⁡</mo><mrow id="A1.E5.m1.3.3.3.3.1.1.3.1.2.1" xref="A1.E5.m1.3.3.3.3.1.1.3.1.1.cmml"><mo id="A1.E5.m1.3.3.3.3.1.1.3.1.2.1.1" xref="A1.E5.m1.3.3.3.3.1.1.3.1.1.cmml">(</mo><mstyle displaystyle="false" id="A1.E5.m1.3.3.3.3.1.1.2" xref="A1.E5.m1.3.3.3.3.1.1.2.cmml"><mfrac id="A1.E5.m1.3.3.3.3.1.1.2a" xref="A1.E5.m1.3.3.3.3.1.1.2.cmml"><mi id="A1.E5.m1.3.3.3.3.1.1.2.2" xref="A1.E5.m1.3.3.3.3.1.1.2.2.cmml">j</mi><msup id="A1.E5.m1.3.3.3.3.1.1.2.3" xref="A1.E5.m1.3.3.3.3.1.1.2.3.cmml"><mn id="A1.E5.m1.3.3.3.3.1.1.2.3.2" xref="A1.E5.m1.3.3.3.3.1.1.2.3.2.cmml">10000</mn><mfrac id="A1.E5.m1.3.3.3.3.1.1.2.3.3" xref="A1.E5.m1.3.3.3.3.1.1.2.3.3.cmml"><mrow id="A1.E5.m1.3.3.3.3.1.1.2.3.3.2" xref="A1.E5.m1.3.3.3.3.1.1.2.3.3.2.cmml"><mn id="A1.E5.m1.3.3.3.3.1.1.2.3.3.2.2" xref="A1.E5.m1.3.3.3.3.1.1.2.3.3.2.2.cmml">2</mn><mo id="A1.E5.m1.3.3.3.3.1.1.2.3.3.2.1" xref="A1.E5.m1.3.3.3.3.1.1.2.3.3.2.1.cmml">⁢</mo><mi id="A1.E5.m1.3.3.3.3.1.1.2.3.3.2.3" xref="A1.E5.m1.3.3.3.3.1.1.2.3.3.2.3.cmml">i</mi></mrow><mi id="A1.E5.m1.3.3.3.3.1.1.2.3.3.3" xref="A1.E5.m1.3.3.3.3.1.1.2.3.3.3.cmml">d</mi></mfrac></msup></mfrac></mstyle><mo id="A1.E5.m1.3.3.3.3.1.1.3.1.2.1.2" xref="A1.E5.m1.3.3.3.3.1.1.3.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E5.m1.3.3.3.3.1.1.3.2" xref="A1.E5.m1.5.5.1.1.3.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="A1.E5.m1.4.4.4f" xref="A1.E5.m1.5.5.1.1.3.1.cmml"><mrow id="A1.E5.m1.4.4.4.4.2.1" xref="A1.E5.m1.4.4.4.4.2.1.cmml"><mi id="A1.E5.m1.4.4.4.4.2.1.6" xref="A1.E5.m1.4.4.4.4.2.1.6.cmml">i</mi><mo id="A1.E5.m1.4.4.4.4.2.1.5" xref="A1.E5.m1.4.4.4.4.2.1.5.cmml">=</mo><mrow id="A1.E5.m1.4.4.4.4.2.1.7.2" xref="A1.E5.m1.4.4.4.4.2.1.7.1.cmml"><mn id="A1.E5.m1.4.4.4.4.2.1.1" xref="A1.E5.m1.4.4.4.4.2.1.1.cmml">1</mn><mo id="A1.E5.m1.4.4.4.4.2.1.7.2.1" xref="A1.E5.m1.4.4.4.4.2.1.7.1.cmml">,</mo><mn id="A1.E5.m1.4.4.4.4.2.1.2" xref="A1.E5.m1.4.4.4.4.2.1.2.cmml">3</mn><mo id="A1.E5.m1.4.4.4.4.2.1.7.2.2" xref="A1.E5.m1.4.4.4.4.2.1.7.1.cmml">,</mo><mi id="A1.E5.m1.4.4.4.4.2.1.3" mathvariant="normal" xref="A1.E5.m1.4.4.4.4.2.1.3.cmml">…</mi><mo id="A1.E5.m1.4.4.4.4.2.1.7.2.3" xref="A1.E5.m1.4.4.4.4.2.1.7.1.cmml">,</mo><mn id="A1.E5.m1.4.4.4.4.2.1.4" xref="A1.E5.m1.4.4.4.4.2.1.4.cmml">767</mn></mrow></mrow></mtd></mtr></mtable></mrow></mrow><mo id="A1.E5.m1.5.5.1.2" xref="A1.E5.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E5.m1.5b"><apply id="A1.E5.m1.5.5.1.1.cmml" xref="A1.E5.m1.5.5.1"><eq id="A1.E5.m1.5.5.1.1.1.cmml" xref="A1.E5.m1.5.5.1.1.1"></eq><apply id="A1.E5.m1.5.5.1.1.2.cmml" xref="A1.E5.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="A1.E5.m1.5.5.1.1.2.1.cmml" xref="A1.E5.m1.5.5.1.1.2">subscript</csymbol><ci id="A1.E5.m1.5.5.1.1.2.2.cmml" xref="A1.E5.m1.5.5.1.1.2.2">𝐩</ci><ci id="A1.E5.m1.5.5.1.1.2.3.cmml" xref="A1.E5.m1.5.5.1.1.2.3">𝑖</ci></apply><apply id="A1.E5.m1.5.5.1.1.3.1.cmml" xref="A1.E5.m1.4.4"><csymbol cd="latexml" id="A1.E5.m1.5.5.1.1.3.1.1.cmml" xref="A1.E5.m1.4.4.5">cases</csymbol><apply id="A1.E5.m1.1.1.1.1.1.1.3.1.1.cmml" xref="A1.E5.m1.1.1.1.1.1.1.3.1.2"><sin id="A1.E5.m1.1.1.1.1.1.1.1.cmml" xref="A1.E5.m1.1.1.1.1.1.1.1"></sin><apply id="A1.E5.m1.1.1.1.1.1.1.2.cmml" xref="A1.E5.m1.1.1.1.1.1.1.2"><divide id="A1.E5.m1.1.1.1.1.1.1.2.1.cmml" xref="A1.E5.m1.1.1.1.1.1.1.2"></divide><ci id="A1.E5.m1.1.1.1.1.1.1.2.2.cmml" xref="A1.E5.m1.1.1.1.1.1.1.2.2">𝑗</ci><apply id="A1.E5.m1.1.1.1.1.1.1.2.3.cmml" xref="A1.E5.m1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A1.E5.m1.1.1.1.1.1.1.2.3.1.cmml" xref="A1.E5.m1.1.1.1.1.1.1.2.3">superscript</csymbol><cn id="A1.E5.m1.1.1.1.1.1.1.2.3.2.cmml" type="integer" xref="A1.E5.m1.1.1.1.1.1.1.2.3.2">10000</cn><apply id="A1.E5.m1.1.1.1.1.1.1.2.3.3.cmml" xref="A1.E5.m1.1.1.1.1.1.1.2.3.3"><divide id="A1.E5.m1.1.1.1.1.1.1.2.3.3.1.cmml" xref="A1.E5.m1.1.1.1.1.1.1.2.3.3"></divide><apply id="A1.E5.m1.1.1.1.1.1.1.2.3.3.2.cmml" xref="A1.E5.m1.1.1.1.1.1.1.2.3.3.2"><times id="A1.E5.m1.1.1.1.1.1.1.2.3.3.2.1.cmml" xref="A1.E5.m1.1.1.1.1.1.1.2.3.3.2.1"></times><cn id="A1.E5.m1.1.1.1.1.1.1.2.3.3.2.2.cmml" type="integer" xref="A1.E5.m1.1.1.1.1.1.1.2.3.3.2.2">2</cn><ci id="A1.E5.m1.1.1.1.1.1.1.2.3.3.2.3.cmml" xref="A1.E5.m1.1.1.1.1.1.1.2.3.3.2.3">𝑖</ci></apply><ci id="A1.E5.m1.1.1.1.1.1.1.2.3.3.3.cmml" xref="A1.E5.m1.1.1.1.1.1.1.2.3.3.3">𝑑</ci></apply></apply></apply></apply><apply id="A1.E5.m1.2.2.2.2.2.1.cmml" xref="A1.E5.m1.2.2.2.2.2.1"><eq id="A1.E5.m1.2.2.2.2.2.1.5.cmml" xref="A1.E5.m1.2.2.2.2.2.1.5"></eq><ci id="A1.E5.m1.2.2.2.2.2.1.6.cmml" xref="A1.E5.m1.2.2.2.2.2.1.6">𝑖</ci><list id="A1.E5.m1.2.2.2.2.2.1.7.1.cmml" xref="A1.E5.m1.2.2.2.2.2.1.7.2"><cn id="A1.E5.m1.2.2.2.2.2.1.1.cmml" type="integer" xref="A1.E5.m1.2.2.2.2.2.1.1">0</cn><cn id="A1.E5.m1.2.2.2.2.2.1.2.cmml" type="integer" xref="A1.E5.m1.2.2.2.2.2.1.2">2</cn><ci id="A1.E5.m1.2.2.2.2.2.1.3.cmml" xref="A1.E5.m1.2.2.2.2.2.1.3">…</ci><cn id="A1.E5.m1.2.2.2.2.2.1.4.cmml" type="integer" xref="A1.E5.m1.2.2.2.2.2.1.4">766</cn></list></apply><apply id="A1.E5.m1.3.3.3.3.1.1.3.1.1.cmml" xref="A1.E5.m1.3.3.3.3.1.1.3.1.2"><cos id="A1.E5.m1.3.3.3.3.1.1.1.cmml" xref="A1.E5.m1.3.3.3.3.1.1.1"></cos><apply id="A1.E5.m1.3.3.3.3.1.1.2.cmml" xref="A1.E5.m1.3.3.3.3.1.1.2"><divide id="A1.E5.m1.3.3.3.3.1.1.2.1.cmml" xref="A1.E5.m1.3.3.3.3.1.1.2"></divide><ci id="A1.E5.m1.3.3.3.3.1.1.2.2.cmml" xref="A1.E5.m1.3.3.3.3.1.1.2.2">𝑗</ci><apply id="A1.E5.m1.3.3.3.3.1.1.2.3.cmml" xref="A1.E5.m1.3.3.3.3.1.1.2.3"><csymbol cd="ambiguous" id="A1.E5.m1.3.3.3.3.1.1.2.3.1.cmml" xref="A1.E5.m1.3.3.3.3.1.1.2.3">superscript</csymbol><cn id="A1.E5.m1.3.3.3.3.1.1.2.3.2.cmml" type="integer" xref="A1.E5.m1.3.3.3.3.1.1.2.3.2">10000</cn><apply id="A1.E5.m1.3.3.3.3.1.1.2.3.3.cmml" xref="A1.E5.m1.3.3.3.3.1.1.2.3.3"><divide id="A1.E5.m1.3.3.3.3.1.1.2.3.3.1.cmml" xref="A1.E5.m1.3.3.3.3.1.1.2.3.3"></divide><apply id="A1.E5.m1.3.3.3.3.1.1.2.3.3.2.cmml" xref="A1.E5.m1.3.3.3.3.1.1.2.3.3.2"><times id="A1.E5.m1.3.3.3.3.1.1.2.3.3.2.1.cmml" xref="A1.E5.m1.3.3.3.3.1.1.2.3.3.2.1"></times><cn id="A1.E5.m1.3.3.3.3.1.1.2.3.3.2.2.cmml" type="integer" xref="A1.E5.m1.3.3.3.3.1.1.2.3.3.2.2">2</cn><ci id="A1.E5.m1.3.3.3.3.1.1.2.3.3.2.3.cmml" xref="A1.E5.m1.3.3.3.3.1.1.2.3.3.2.3">𝑖</ci></apply><ci id="A1.E5.m1.3.3.3.3.1.1.2.3.3.3.cmml" xref="A1.E5.m1.3.3.3.3.1.1.2.3.3.3">𝑑</ci></apply></apply></apply></apply><apply id="A1.E5.m1.4.4.4.4.2.1.cmml" xref="A1.E5.m1.4.4.4.4.2.1"><eq id="A1.E5.m1.4.4.4.4.2.1.5.cmml" xref="A1.E5.m1.4.4.4.4.2.1.5"></eq><ci id="A1.E5.m1.4.4.4.4.2.1.6.cmml" xref="A1.E5.m1.4.4.4.4.2.1.6">𝑖</ci><list id="A1.E5.m1.4.4.4.4.2.1.7.1.cmml" xref="A1.E5.m1.4.4.4.4.2.1.7.2"><cn id="A1.E5.m1.4.4.4.4.2.1.1.cmml" type="integer" xref="A1.E5.m1.4.4.4.4.2.1.1">1</cn><cn id="A1.E5.m1.4.4.4.4.2.1.2.cmml" type="integer" xref="A1.E5.m1.4.4.4.4.2.1.2">3</cn><ci id="A1.E5.m1.4.4.4.4.2.1.3.cmml" xref="A1.E5.m1.4.4.4.4.2.1.3">…</ci><cn id="A1.E5.m1.4.4.4.4.2.1.4.cmml" type="integer" xref="A1.E5.m1.4.4.4.4.2.1.4">767</cn></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E5.m1.5c">\mathbf{p}_{i}=\begin{cases}\sin\left(\frac{j}{10000^{\frac{2i}{d}}}\right),&amp;i%
=0,2,\ldots,766\\
\cos\left(\frac{j}{10000^{\frac{2i}{d}}}\right),&amp;i=1,3,\ldots,767\\
\end{cases}\ ,</annotation><annotation encoding="application/x-llamapun" id="A1.E5.m1.5d">bold_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = { start_ROW start_CELL roman_sin ( divide start_ARG italic_j end_ARG start_ARG 10000 start_POSTSUPERSCRIPT divide start_ARG 2 italic_i end_ARG start_ARG italic_d end_ARG end_POSTSUPERSCRIPT end_ARG ) , end_CELL start_CELL italic_i = 0 , 2 , … , 766 end_CELL end_ROW start_ROW start_CELL roman_cos ( divide start_ARG italic_j end_ARG start_ARG 10000 start_POSTSUPERSCRIPT divide start_ARG 2 italic_i end_ARG start_ARG italic_d end_ARG end_POSTSUPERSCRIPT end_ARG ) , end_CELL start_CELL italic_i = 1 , 3 , … , 767 end_CELL end_ROW ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS1.SSS1.p2.3">where <math alttext="i" class="ltx_Math" display="inline" id="A1.SS1.SSS1.p2.1.m1.1"><semantics id="A1.SS1.SSS1.p2.1.m1.1a"><mi id="A1.SS1.SSS1.p2.1.m1.1.1" xref="A1.SS1.SSS1.p2.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS1.p2.1.m1.1b"><ci id="A1.SS1.SSS1.p2.1.m1.1.1.cmml" xref="A1.SS1.SSS1.p2.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS1.p2.1.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS1.p2.1.m1.1d">italic_i</annotation></semantics></math> denotes the dimension index, <math alttext="d=768" class="ltx_Math" display="inline" id="A1.SS1.SSS1.p2.2.m2.1"><semantics id="A1.SS1.SSS1.p2.2.m2.1a"><mrow id="A1.SS1.SSS1.p2.2.m2.1.1" xref="A1.SS1.SSS1.p2.2.m2.1.1.cmml"><mi id="A1.SS1.SSS1.p2.2.m2.1.1.2" xref="A1.SS1.SSS1.p2.2.m2.1.1.2.cmml">d</mi><mo id="A1.SS1.SSS1.p2.2.m2.1.1.1" xref="A1.SS1.SSS1.p2.2.m2.1.1.1.cmml">=</mo><mn id="A1.SS1.SSS1.p2.2.m2.1.1.3" xref="A1.SS1.SSS1.p2.2.m2.1.1.3.cmml">768</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS1.p2.2.m2.1b"><apply id="A1.SS1.SSS1.p2.2.m2.1.1.cmml" xref="A1.SS1.SSS1.p2.2.m2.1.1"><eq id="A1.SS1.SSS1.p2.2.m2.1.1.1.cmml" xref="A1.SS1.SSS1.p2.2.m2.1.1.1"></eq><ci id="A1.SS1.SSS1.p2.2.m2.1.1.2.cmml" xref="A1.SS1.SSS1.p2.2.m2.1.1.2">𝑑</ci><cn id="A1.SS1.SSS1.p2.2.m2.1.1.3.cmml" type="integer" xref="A1.SS1.SSS1.p2.2.m2.1.1.3">768</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS1.p2.2.m2.1c">d=768</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS1.p2.2.m2.1d">italic_d = 768</annotation></semantics></math> denotes the embedding dimension, and <math alttext="j" class="ltx_Math" display="inline" id="A1.SS1.SSS1.p2.3.m3.1"><semantics id="A1.SS1.SSS1.p2.3.m3.1a"><mi id="A1.SS1.SSS1.p2.3.m3.1.1" xref="A1.SS1.SSS1.p2.3.m3.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS1.p2.3.m3.1b"><ci id="A1.SS1.SSS1.p2.3.m3.1.1.cmml" xref="A1.SS1.SSS1.p2.3.m3.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS1.p2.3.m3.1c">j</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS1.p2.3.m3.1d">italic_j</annotation></semantics></math> denotes the token position within the sequence.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS1.SSS1.p3">
<p class="ltx_p" id="A1.SS1.SSS1.p3.1">The Transformer decoder network operates on the token embedding vectors.
It consists of 10 attention layers with residual connection and layer normalization in between.
In SynFormer-ED, the attention layer contains both self-attention and cross-attention that gathers information from the encoder, while in SynFormer-D, only self-attention is used.
Each attention layer contains 16 attention heads. Each head projects the feature vectors into 256-dimensional query, key, and value vectors, which are then transformed into output vectors via the attention mechanism.
Output vectors from different attention heads are concatenated into a 2,048-dimensional vector, which is then mapped into a 768-dimensional vector used to update the token embedding via residual connection and layer normalization.</p>
</div>
</section>
<section class="ltx_subsubsection" id="A1.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.1.2 </span>Transformer encoder</h4>
<div class="ltx_para ltx_noindent" id="A1.SS1.SSS2.p1">
<p class="ltx_p" id="A1.SS1.SSS2.p1.1">SynFormer-ED contains a Transformer-based encoder network that conditions the decoder with a given SMILES string.
The input SMILES string is split in to a list of tokens according to the following vocabulary:</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS1.SSS2.p2">
<p class="ltx_p" id="A1.SS1.SSS2.p2.1"><span class="ltx_text ltx_font_typewriter" id="A1.SS1.SSS2.p2.1.1">H, He, Li, Be, B, C, N, O, F, Ne, Na, Mg, Al, Si, P, S, Cl, Ar, K, Ca, Sc, Ti, V, Cr, Mn, Fe, Co, Ni, Cu, Zn, Ga, Ge, As, Se, Br, Kr, Rb, Sr, Y, Zr, Nb, Mo, Tc, Ru, Rh, Pd, Ag, Cd, In, Sn, Sb, Te, I, Xe, Cs, Ba, La, Ce, Pr, Nd, Pm, Sm, Eu, Gd, Tb, Dy, Ho, Er, Tm, Yb, Lu, Hf, Ta, W, Re, Os, Ir, Pt, Au, Hg, Tl, Pb, Bi, Po, At, Rn, Fr, Ra, Ac, Th, Pa, U, Np, Pu, Am, Cm, Bk, Cf, Es, Fm, Md, No, Lr, Rf, Db, Sg, Bh, Hs, Mt, Ds, Rg, Cn, Nh, Fl, Mc, Lv, Ts, Og, b, c, n, o, s, p, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, [, ], (, ), ., =, #, -, +, <math alttext="\backslash" class="ltx_Math" display="inline" id="A1.SS1.SSS2.p2.1.1.m1.1"><semantics id="A1.SS1.SSS2.p2.1.1.m1.1a"><mo id="A1.SS1.SSS2.p2.1.1.m1.1.1" xref="A1.SS1.SSS2.p2.1.1.m1.1.1.cmml">\</mo><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS2.p2.1.1.m1.1b"><ci id="A1.SS1.SSS2.p2.1.1.m1.1.1.cmml" xref="A1.SS1.SSS2.p2.1.1.m1.1.1">\</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS2.p2.1.1.m1.1c">\backslash</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS2.p2.1.1.m1.1d">\</annotation></semantics></math>, /, :,  , @, ?, &gt;, *, $, %</span></p>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS1.SSS2.p3">
<p class="ltx_p" id="A1.SS1.SSS2.p3.1">Each token in the list is represented by a 768-dimensional embedding vector, and position encodings (Eq. <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#A1.E5" title="In A.1.1 Transformer decoder ‣ A.1 Model architectures ‣ Appendix A Additional method details ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_tag">5</span></a>) are added to the embedding vector.
The Transformer encoder contains 6 layers, each of which has 16 attention heads with 256-dimensional query, key, and value vectors.</p>
</div>
</section>
<section class="ltx_subsubsection" id="A1.SS1.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.1.3 </span>Scaling of model size</h4>
<div class="ltx_para ltx_noindent" id="A1.SS1.SSS3.p1">
<p class="ltx_p" id="A1.SS1.SSS3.p1.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#A1.T1" title="Table 1 ‣ A.1.3 Scaling of model size ‣ A.1 Model architectures ‣ Appendix A Additional method details ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_tag">1</span></a> below shows the hyper-parameters for SynFormer-ED of different sizes measured by the number of trainable parameters.
These hyper-parameter sets are used to investigate the scaling of model performance. For the remaining experiments, we use the model with 229M parameters.</p>
</div>
<figure class="ltx_table" id="A1.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Specific model hyper-parameters used in the scaling experiments.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A1.T1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A1.T1.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A1.T1.1.1.1.1">Model Size</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T1.1.1.1.2"><span class="ltx_text ltx_font_bold" id="A1.T1.1.1.1.2.1">229M</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T1.1.1.1.3">68M</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T1.1.1.1.4">17.5M</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T1.1.1.1.5">3.7M</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A1.T1.1.2.1">
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T1.1.2.1.1"># Feature Dimensions</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T1.1.2.1.2">768</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T1.1.2.1.3">512</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T1.1.2.1.4">256</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T1.1.2.1.5">128</td>
</tr>
<tr class="ltx_tr" id="A1.T1.1.3.2">
<td class="ltx_td ltx_align_left" id="A1.T1.1.3.2.1"># Encoder Layers</td>
<td class="ltx_td ltx_align_center" id="A1.T1.1.3.2.2">8</td>
<td class="ltx_td ltx_align_center" id="A1.T1.1.3.2.3">6</td>
<td class="ltx_td ltx_align_center" id="A1.T1.1.3.2.4">6</td>
<td class="ltx_td ltx_align_center" id="A1.T1.1.3.2.5">4</td>
</tr>
<tr class="ltx_tr" id="A1.T1.1.4.3">
<td class="ltx_td ltx_align_left" id="A1.T1.1.4.3.1"># Encoder Attn. Heads</td>
<td class="ltx_td ltx_align_center" id="A1.T1.1.4.3.2">16</td>
<td class="ltx_td ltx_align_center" id="A1.T1.1.4.3.3">16</td>
<td class="ltx_td ltx_align_center" id="A1.T1.1.4.3.4">8</td>
<td class="ltx_td ltx_align_center" id="A1.T1.1.4.3.5">4</td>
</tr>
<tr class="ltx_tr" id="A1.T1.1.5.4">
<td class="ltx_td ltx_align_left" id="A1.T1.1.5.4.1"># Encoder Feed-forward Dimensions</td>
<td class="ltx_td ltx_align_center" id="A1.T1.1.5.4.2">4096</td>
<td class="ltx_td ltx_align_center" id="A1.T1.1.5.4.3">2048</td>
<td class="ltx_td ltx_align_center" id="A1.T1.1.5.4.4">1024</td>
<td class="ltx_td ltx_align_center" id="A1.T1.1.5.4.5">512</td>
</tr>
<tr class="ltx_tr" id="A1.T1.1.6.5">
<td class="ltx_td ltx_align_left" id="A1.T1.1.6.5.1"># Decoder Layers</td>
<td class="ltx_td ltx_align_center" id="A1.T1.1.6.5.2">10</td>
<td class="ltx_td ltx_align_center" id="A1.T1.1.6.5.3">8</td>
<td class="ltx_td ltx_align_center" id="A1.T1.1.6.5.4">8</td>
<td class="ltx_td ltx_align_center" id="A1.T1.1.6.5.5">6</td>
</tr>
<tr class="ltx_tr" id="A1.T1.1.7.6">
<td class="ltx_td ltx_align_left" id="A1.T1.1.7.6.1"># Decoder Attn. Heads</td>
<td class="ltx_td ltx_align_center" id="A1.T1.1.7.6.2">16</td>
<td class="ltx_td ltx_align_center" id="A1.T1.1.7.6.3">16</td>
<td class="ltx_td ltx_align_center" id="A1.T1.1.7.6.4">8</td>
<td class="ltx_td ltx_align_center" id="A1.T1.1.7.6.5">4</td>
</tr>
<tr class="ltx_tr" id="A1.T1.1.8.7">
<td class="ltx_td ltx_align_left ltx_border_bb" id="A1.T1.1.8.7.1"># Decoder Feed-forward Dimensions</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T1.1.8.7.2">4096</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T1.1.8.7.3">2048</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T1.1.8.7.4">1024</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T1.1.8.7.5">512</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_subsubsection" id="A1.SS1.SSS4">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.1.4 </span>Diffusion fingerprint head</h4>
<div class="ltx_para ltx_noindent" id="A1.SS1.SSS4.p1">
<p class="ltx_p" id="A1.SS1.SSS4.p1.1">The fingerprint of a building block token are modeled by an <math alttext="n" class="ltx_Math" display="inline" id="A1.SS1.SSS4.p1.1.m1.1"><semantics id="A1.SS1.SSS4.p1.1.m1.1a"><mi id="A1.SS1.SSS4.p1.1.m1.1.1" xref="A1.SS1.SSS4.p1.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS4.p1.1.m1.1b"><ci id="A1.SS1.SSS4.p1.1.m1.1.1.cmml" xref="A1.SS1.SSS4.p1.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS4.p1.1.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS4.p1.1.m1.1d">italic_n</annotation></semantics></math>-dimensional Bernoulli distribution. We use the denoising diffusion probabilistic model <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib15" title="">15</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib114" title="">114</a>]</cite> to model this distribution.
The denoising diffusion probabilistic model generates data by iterative denoising an initial sample drawn from a simple prior distribution.
To train a neural network capable of denoising, noisy samples based on ground truth data must be constructed via the forward diffusion process.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS1.SSS4.p2">
<p class="ltx_p" id="A1.SS1.SSS4.p2.1">In SynFormer, we define the bit-wise forward diffusion process for fingerprint <math alttext="\mathbf{x}=[x^{(1)},\ldots,x^{(n)}]\in\{0,1\}^{n}" class="ltx_Math" display="inline" id="A1.SS1.SSS4.p2.1.m1.7"><semantics id="A1.SS1.SSS4.p2.1.m1.7a"><mrow id="A1.SS1.SSS4.p2.1.m1.7.7" xref="A1.SS1.SSS4.p2.1.m1.7.7.cmml"><mi id="A1.SS1.SSS4.p2.1.m1.7.7.4" xref="A1.SS1.SSS4.p2.1.m1.7.7.4.cmml">𝐱</mi><mo id="A1.SS1.SSS4.p2.1.m1.7.7.5" xref="A1.SS1.SSS4.p2.1.m1.7.7.5.cmml">=</mo><mrow id="A1.SS1.SSS4.p2.1.m1.7.7.2.2" xref="A1.SS1.SSS4.p2.1.m1.7.7.2.3.cmml"><mo id="A1.SS1.SSS4.p2.1.m1.7.7.2.2.3" stretchy="false" xref="A1.SS1.SSS4.p2.1.m1.7.7.2.3.cmml">[</mo><msup id="A1.SS1.SSS4.p2.1.m1.6.6.1.1.1" xref="A1.SS1.SSS4.p2.1.m1.6.6.1.1.1.cmml"><mi id="A1.SS1.SSS4.p2.1.m1.6.6.1.1.1.2" xref="A1.SS1.SSS4.p2.1.m1.6.6.1.1.1.2.cmml">x</mi><mrow id="A1.SS1.SSS4.p2.1.m1.1.1.1.3" xref="A1.SS1.SSS4.p2.1.m1.6.6.1.1.1.cmml"><mo id="A1.SS1.SSS4.p2.1.m1.1.1.1.3.1" stretchy="false" xref="A1.SS1.SSS4.p2.1.m1.6.6.1.1.1.cmml">(</mo><mn id="A1.SS1.SSS4.p2.1.m1.1.1.1.1" xref="A1.SS1.SSS4.p2.1.m1.1.1.1.1.cmml">1</mn><mo id="A1.SS1.SSS4.p2.1.m1.1.1.1.3.2" stretchy="false" xref="A1.SS1.SSS4.p2.1.m1.6.6.1.1.1.cmml">)</mo></mrow></msup><mo id="A1.SS1.SSS4.p2.1.m1.7.7.2.2.4" xref="A1.SS1.SSS4.p2.1.m1.7.7.2.3.cmml">,</mo><mi id="A1.SS1.SSS4.p2.1.m1.3.3" mathvariant="normal" xref="A1.SS1.SSS4.p2.1.m1.3.3.cmml">…</mi><mo id="A1.SS1.SSS4.p2.1.m1.7.7.2.2.5" xref="A1.SS1.SSS4.p2.1.m1.7.7.2.3.cmml">,</mo><msup id="A1.SS1.SSS4.p2.1.m1.7.7.2.2.2" xref="A1.SS1.SSS4.p2.1.m1.7.7.2.2.2.cmml"><mi id="A1.SS1.SSS4.p2.1.m1.7.7.2.2.2.2" xref="A1.SS1.SSS4.p2.1.m1.7.7.2.2.2.2.cmml">x</mi><mrow id="A1.SS1.SSS4.p2.1.m1.2.2.1.3" xref="A1.SS1.SSS4.p2.1.m1.7.7.2.2.2.cmml"><mo id="A1.SS1.SSS4.p2.1.m1.2.2.1.3.1" stretchy="false" xref="A1.SS1.SSS4.p2.1.m1.7.7.2.2.2.cmml">(</mo><mi id="A1.SS1.SSS4.p2.1.m1.2.2.1.1" xref="A1.SS1.SSS4.p2.1.m1.2.2.1.1.cmml">n</mi><mo id="A1.SS1.SSS4.p2.1.m1.2.2.1.3.2" stretchy="false" xref="A1.SS1.SSS4.p2.1.m1.7.7.2.2.2.cmml">)</mo></mrow></msup><mo id="A1.SS1.SSS4.p2.1.m1.7.7.2.2.6" stretchy="false" xref="A1.SS1.SSS4.p2.1.m1.7.7.2.3.cmml">]</mo></mrow><mo id="A1.SS1.SSS4.p2.1.m1.7.7.6" xref="A1.SS1.SSS4.p2.1.m1.7.7.6.cmml">∈</mo><msup id="A1.SS1.SSS4.p2.1.m1.7.7.7" xref="A1.SS1.SSS4.p2.1.m1.7.7.7.cmml"><mrow id="A1.SS1.SSS4.p2.1.m1.7.7.7.2.2" xref="A1.SS1.SSS4.p2.1.m1.7.7.7.2.1.cmml"><mo id="A1.SS1.SSS4.p2.1.m1.7.7.7.2.2.1" stretchy="false" xref="A1.SS1.SSS4.p2.1.m1.7.7.7.2.1.cmml">{</mo><mn id="A1.SS1.SSS4.p2.1.m1.4.4" xref="A1.SS1.SSS4.p2.1.m1.4.4.cmml">0</mn><mo id="A1.SS1.SSS4.p2.1.m1.7.7.7.2.2.2" xref="A1.SS1.SSS4.p2.1.m1.7.7.7.2.1.cmml">,</mo><mn id="A1.SS1.SSS4.p2.1.m1.5.5" xref="A1.SS1.SSS4.p2.1.m1.5.5.cmml">1</mn><mo id="A1.SS1.SSS4.p2.1.m1.7.7.7.2.2.3" stretchy="false" xref="A1.SS1.SSS4.p2.1.m1.7.7.7.2.1.cmml">}</mo></mrow><mi id="A1.SS1.SSS4.p2.1.m1.7.7.7.3" xref="A1.SS1.SSS4.p2.1.m1.7.7.7.3.cmml">n</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS4.p2.1.m1.7b"><apply id="A1.SS1.SSS4.p2.1.m1.7.7.cmml" xref="A1.SS1.SSS4.p2.1.m1.7.7"><and id="A1.SS1.SSS4.p2.1.m1.7.7a.cmml" xref="A1.SS1.SSS4.p2.1.m1.7.7"></and><apply id="A1.SS1.SSS4.p2.1.m1.7.7b.cmml" xref="A1.SS1.SSS4.p2.1.m1.7.7"><eq id="A1.SS1.SSS4.p2.1.m1.7.7.5.cmml" xref="A1.SS1.SSS4.p2.1.m1.7.7.5"></eq><ci id="A1.SS1.SSS4.p2.1.m1.7.7.4.cmml" xref="A1.SS1.SSS4.p2.1.m1.7.7.4">𝐱</ci><list id="A1.SS1.SSS4.p2.1.m1.7.7.2.3.cmml" xref="A1.SS1.SSS4.p2.1.m1.7.7.2.2"><apply id="A1.SS1.SSS4.p2.1.m1.6.6.1.1.1.cmml" xref="A1.SS1.SSS4.p2.1.m1.6.6.1.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS4.p2.1.m1.6.6.1.1.1.1.cmml" xref="A1.SS1.SSS4.p2.1.m1.6.6.1.1.1">superscript</csymbol><ci id="A1.SS1.SSS4.p2.1.m1.6.6.1.1.1.2.cmml" xref="A1.SS1.SSS4.p2.1.m1.6.6.1.1.1.2">𝑥</ci><cn id="A1.SS1.SSS4.p2.1.m1.1.1.1.1.cmml" type="integer" xref="A1.SS1.SSS4.p2.1.m1.1.1.1.1">1</cn></apply><ci id="A1.SS1.SSS4.p2.1.m1.3.3.cmml" xref="A1.SS1.SSS4.p2.1.m1.3.3">…</ci><apply id="A1.SS1.SSS4.p2.1.m1.7.7.2.2.2.cmml" xref="A1.SS1.SSS4.p2.1.m1.7.7.2.2.2"><csymbol cd="ambiguous" id="A1.SS1.SSS4.p2.1.m1.7.7.2.2.2.1.cmml" xref="A1.SS1.SSS4.p2.1.m1.7.7.2.2.2">superscript</csymbol><ci id="A1.SS1.SSS4.p2.1.m1.7.7.2.2.2.2.cmml" xref="A1.SS1.SSS4.p2.1.m1.7.7.2.2.2.2">𝑥</ci><ci id="A1.SS1.SSS4.p2.1.m1.2.2.1.1.cmml" xref="A1.SS1.SSS4.p2.1.m1.2.2.1.1">𝑛</ci></apply></list></apply><apply id="A1.SS1.SSS4.p2.1.m1.7.7c.cmml" xref="A1.SS1.SSS4.p2.1.m1.7.7"><in id="A1.SS1.SSS4.p2.1.m1.7.7.6.cmml" xref="A1.SS1.SSS4.p2.1.m1.7.7.6"></in><share href="https://arxiv.org/html/2410.03494v1#A1.SS1.SSS4.p2.1.m1.7.7.2.cmml" id="A1.SS1.SSS4.p2.1.m1.7.7d.cmml" xref="A1.SS1.SSS4.p2.1.m1.7.7"></share><apply id="A1.SS1.SSS4.p2.1.m1.7.7.7.cmml" xref="A1.SS1.SSS4.p2.1.m1.7.7.7"><csymbol cd="ambiguous" id="A1.SS1.SSS4.p2.1.m1.7.7.7.1.cmml" xref="A1.SS1.SSS4.p2.1.m1.7.7.7">superscript</csymbol><set id="A1.SS1.SSS4.p2.1.m1.7.7.7.2.1.cmml" xref="A1.SS1.SSS4.p2.1.m1.7.7.7.2.2"><cn id="A1.SS1.SSS4.p2.1.m1.4.4.cmml" type="integer" xref="A1.SS1.SSS4.p2.1.m1.4.4">0</cn><cn id="A1.SS1.SSS4.p2.1.m1.5.5.cmml" type="integer" xref="A1.SS1.SSS4.p2.1.m1.5.5">1</cn></set><ci id="A1.SS1.SSS4.p2.1.m1.7.7.7.3.cmml" xref="A1.SS1.SSS4.p2.1.m1.7.7.7.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS4.p2.1.m1.7c">\mathbf{x}=[x^{(1)},\ldots,x^{(n)}]\in\{0,1\}^{n}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS4.p2.1.m1.7d">bold_x = [ italic_x start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT , … , italic_x start_POSTSUPERSCRIPT ( italic_n ) end_POSTSUPERSCRIPT ] ∈ { 0 , 1 } start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT</annotation></semantics></math> as, following the formulation of multinomial diffusion <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib70" title="">70</a>]</cite>:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="q(\mathbf{x}_{t}|\mathbf{x}_{t-1})=\prod_{j=1}^{n}q(x_{t}^{(j)}|x_{t-1}^{(j)})%
\quad\text{where}\quad q(x_{t}^{(j)}|x_{t-1}^{(j)})=\operatorname{Bernoulli}(x%
_{t}^{(j)}\mid(1-\beta_{t})x_{t-1}^{(j)}+\beta_{t}\cdot\frac{1}{2}),\quad j=1%
\ldots n." class="ltx_Math" display="block" id="A1.E6.m1.9"><semantics id="A1.E6.m1.9a"><mrow id="A1.E6.m1.9.9.1"><mrow id="A1.E6.m1.9.9.1.1.2" xref="A1.E6.m1.9.9.1.1.3.cmml"><mrow id="A1.E6.m1.9.9.1.1.1.1" xref="A1.E6.m1.9.9.1.1.1.1.cmml"><mrow id="A1.E6.m1.9.9.1.1.1.1.1" xref="A1.E6.m1.9.9.1.1.1.1.1.cmml"><mi id="A1.E6.m1.9.9.1.1.1.1.1.3" xref="A1.E6.m1.9.9.1.1.1.1.1.3.cmml">q</mi><mo id="A1.E6.m1.9.9.1.1.1.1.1.2" xref="A1.E6.m1.9.9.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E6.m1.9.9.1.1.1.1.1.1.1" xref="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E6.m1.9.9.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E6.m1.9.9.1.1.1.1.1.1.1.1" xref="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.cmml"><msub id="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.2" xref="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.2.cmml"><mi id="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.2.2" xref="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.2.2.cmml">𝐱</mi><mi id="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.2.3" xref="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.1" xref="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.3" xref="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.3.2" xref="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.3.2.cmml">𝐱</mi><mrow id="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.3.3" xref="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.3.3.2" xref="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.3.3.1" xref="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.3.3.3" xref="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="A1.E6.m1.9.9.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E6.m1.9.9.1.1.1.1.3" rspace="0.111em" xref="A1.E6.m1.9.9.1.1.1.1.3.cmml">=</mo><mrow id="A1.E6.m1.9.9.1.1.1.1.2.1" xref="A1.E6.m1.9.9.1.1.1.1.2.2.cmml"><mrow id="A1.E6.m1.9.9.1.1.1.1.2.1.1" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.cmml"><munderover id="A1.E6.m1.9.9.1.1.1.1.2.1.1.2" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.2.cmml"><mo id="A1.E6.m1.9.9.1.1.1.1.2.1.1.2.2.2" movablelimits="false" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.2.2.2.cmml">∏</mo><mrow id="A1.E6.m1.9.9.1.1.1.1.2.1.1.2.2.3" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.2.2.3.cmml"><mi id="A1.E6.m1.9.9.1.1.1.1.2.1.1.2.2.3.2" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.2.2.3.2.cmml">j</mi><mo id="A1.E6.m1.9.9.1.1.1.1.2.1.1.2.2.3.1" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.2.2.3.1.cmml">=</mo><mn id="A1.E6.m1.9.9.1.1.1.1.2.1.1.2.2.3.3" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="A1.E6.m1.9.9.1.1.1.1.2.1.1.2.3" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.2.3.cmml">n</mi></munderover><mrow id="A1.E6.m1.9.9.1.1.1.1.2.1.1.1" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.cmml"><mi id="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.3" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.3.cmml">q</mi><mo id="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.2" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.2.cmml">⁢</mo><mrow id="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.cmml"><mo id="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.2" stretchy="false" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.cmml"><msubsup id="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2.cmml"><mi id="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2.2.2" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2.2.2.cmml">x</mi><mi id="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2.2.3" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2.2.3.cmml">t</mi><mrow id="A1.E6.m1.1.1.1.3" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2.cmml"><mo id="A1.E6.m1.1.1.1.3.1" stretchy="false" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2.cmml">(</mo><mi id="A1.E6.m1.1.1.1.1" xref="A1.E6.m1.1.1.1.1.cmml">j</mi><mo id="A1.E6.m1.1.1.1.3.2" stretchy="false" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2.cmml">)</mo></mrow></msubsup><mo fence="false" id="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.1" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.1.cmml">|</mo><msubsup id="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3.cmml"><mi id="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3.2.2" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3.2.2.cmml">x</mi><mrow id="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3.2.3" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3.2.3.cmml"><mi id="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3.2.3.2" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3.2.3.2.cmml">t</mi><mo id="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3.2.3.1" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3.2.3.1.cmml">−</mo><mn id="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3.2.3.3" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3.2.3.3.cmml">1</mn></mrow><mrow id="A1.E6.m1.2.2.1.3" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3.cmml"><mo id="A1.E6.m1.2.2.1.3.1" stretchy="false" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3.cmml">(</mo><mi id="A1.E6.m1.2.2.1.1" xref="A1.E6.m1.2.2.1.1.cmml">j</mi><mo id="A1.E6.m1.2.2.1.3.2" stretchy="false" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo id="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.3" stretchy="false" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mspace id="A1.E6.m1.9.9.1.1.1.1.2.1.2" width="1em" xref="A1.E6.m1.9.9.1.1.1.1.2.2.cmml"></mspace><mtext id="A1.E6.m1.8.8" xref="A1.E6.m1.8.8a.cmml">where</mtext></mrow></mrow><mspace id="A1.E6.m1.9.9.1.1.2.3" width="1em" xref="A1.E6.m1.9.9.1.1.3a.cmml"></mspace><mrow id="A1.E6.m1.9.9.1.1.2.2.2" xref="A1.E6.m1.9.9.1.1.2.2.3.cmml"><mrow id="A1.E6.m1.9.9.1.1.2.2.1.1" xref="A1.E6.m1.9.9.1.1.2.2.1.1.cmml"><mrow id="A1.E6.m1.9.9.1.1.2.2.1.1.1" xref="A1.E6.m1.9.9.1.1.2.2.1.1.1.cmml"><mi id="A1.E6.m1.9.9.1.1.2.2.1.1.1.3" xref="A1.E6.m1.9.9.1.1.2.2.1.1.1.3.cmml">q</mi><mo id="A1.E6.m1.9.9.1.1.2.2.1.1.1.2" xref="A1.E6.m1.9.9.1.1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1" xref="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.cmml"><mo id="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.2" stretchy="false" xref="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1" xref="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.cmml"><msubsup id="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.2" xref="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.2.cmml"><mi id="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.2.2.2" xref="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.2.2.2.cmml">x</mi><mi id="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.2.2.3" xref="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.2.2.3.cmml">t</mi><mrow id="A1.E6.m1.3.3.1.3" xref="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.2.cmml"><mo id="A1.E6.m1.3.3.1.3.1" stretchy="false" xref="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.2.cmml">(</mo><mi id="A1.E6.m1.3.3.1.1" xref="A1.E6.m1.3.3.1.1.cmml">j</mi><mo id="A1.E6.m1.3.3.1.3.2" stretchy="false" xref="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.2.cmml">)</mo></mrow></msubsup><mo fence="false" id="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.1" xref="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.1.cmml">|</mo><msubsup id="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.3" xref="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.3.cmml"><mi id="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.3.2.2" xref="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.3.2.2.cmml">x</mi><mrow id="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.3.2.3" xref="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.3.2.3.cmml"><mi id="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.3.2.3.2" xref="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.3.2.3.2.cmml">t</mi><mo id="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.3.2.3.1" xref="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.3.2.3.1.cmml">−</mo><mn id="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.3.2.3.3" xref="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.3.2.3.3.cmml">1</mn></mrow><mrow id="A1.E6.m1.4.4.1.3" xref="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.3.cmml"><mo id="A1.E6.m1.4.4.1.3.1" stretchy="false" xref="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.3.cmml">(</mo><mi id="A1.E6.m1.4.4.1.1" xref="A1.E6.m1.4.4.1.1.cmml">j</mi><mo id="A1.E6.m1.4.4.1.3.2" stretchy="false" xref="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo id="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.3" stretchy="false" xref="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E6.m1.9.9.1.1.2.2.1.1.3" xref="A1.E6.m1.9.9.1.1.2.2.1.1.3.cmml">=</mo><mrow id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.2.cmml"><mi id="A1.E6.m1.7.7" xref="A1.E6.m1.7.7.cmml">Bernoulli</mi><mo id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1a" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.2.cmml">⁡</mo><mrow id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.2.cmml"><mo id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.2" stretchy="false" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.2.cmml">(</mo><mrow id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.cmml"><msubsup id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.3" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.3.cmml"><mi id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.3.2.2" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.3.2.2.cmml">x</mi><mi id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.3.2.3" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.3.2.3.cmml">t</mi><mrow id="A1.E6.m1.5.5.1.3" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.3.cmml"><mo id="A1.E6.m1.5.5.1.3.1" stretchy="false" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.3.cmml">(</mo><mi id="A1.E6.m1.5.5.1.1" xref="A1.E6.m1.5.5.1.1.cmml">j</mi><mo id="A1.E6.m1.5.5.1.3.2" stretchy="false" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.3.cmml">)</mo></mrow></msubsup><mo id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.2" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.2.cmml">∣</mo><mrow id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.cmml"><mrow id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.cmml"><mrow id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.cmml"><mn id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.2" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.1" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.3" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.2" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.2.cmml">β</mi><mi id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.3" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.2" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.2.cmml">⁢</mo><msubsup id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.3" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.3.cmml"><mi id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.3.2.2" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.3.2.2.cmml">x</mi><mrow id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.3.2.3" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.3.2.3.cmml"><mi id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.3.2.3.2" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.3.2.3.2.cmml">t</mi><mo id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.3.2.3.1" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.3.2.3.1.cmml">−</mo><mn id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.3.2.3.3" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.3.2.3.3.cmml">1</mn></mrow><mrow id="A1.E6.m1.6.6.1.3" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.3.cmml"><mo id="A1.E6.m1.6.6.1.3.1" stretchy="false" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.3.cmml">(</mo><mi id="A1.E6.m1.6.6.1.1" xref="A1.E6.m1.6.6.1.1.cmml">j</mi><mo id="A1.E6.m1.6.6.1.3.2" stretchy="false" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.2" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.2.cmml">+</mo><mrow id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.cmml"><msub id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.2" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.2.cmml"><mi id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.2.2" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.2.2.cmml">β</mi><mi id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.2.3" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.2.3.cmml">t</mi></msub><mo id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.1.cmml">⋅</mo><mfrac id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.3" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.3.cmml"><mn id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.3.2" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.3.2.cmml">1</mn><mn id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.3.3" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.3.3.cmml">2</mn></mfrac></mrow></mrow></mrow><mo id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.3" stretchy="false" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.2.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E6.m1.9.9.1.1.2.2.2.3" rspace="1.167em" xref="A1.E6.m1.9.9.1.1.2.2.3a.cmml">,</mo><mrow id="A1.E6.m1.9.9.1.1.2.2.2.2" xref="A1.E6.m1.9.9.1.1.2.2.2.2.cmml"><mi id="A1.E6.m1.9.9.1.1.2.2.2.2.2" xref="A1.E6.m1.9.9.1.1.2.2.2.2.2.cmml">j</mi><mo id="A1.E6.m1.9.9.1.1.2.2.2.2.1" xref="A1.E6.m1.9.9.1.1.2.2.2.2.1.cmml">=</mo><mrow id="A1.E6.m1.9.9.1.1.2.2.2.2.3" xref="A1.E6.m1.9.9.1.1.2.2.2.2.3.cmml"><mn id="A1.E6.m1.9.9.1.1.2.2.2.2.3.2" xref="A1.E6.m1.9.9.1.1.2.2.2.2.3.2.cmml">1</mn><mo id="A1.E6.m1.9.9.1.1.2.2.2.2.3.1" xref="A1.E6.m1.9.9.1.1.2.2.2.2.3.1.cmml">⁢</mo><mi id="A1.E6.m1.9.9.1.1.2.2.2.2.3.3" mathvariant="normal" xref="A1.E6.m1.9.9.1.1.2.2.2.2.3.3.cmml">…</mi><mo id="A1.E6.m1.9.9.1.1.2.2.2.2.3.1a" xref="A1.E6.m1.9.9.1.1.2.2.2.2.3.1.cmml">⁢</mo><mi id="A1.E6.m1.9.9.1.1.2.2.2.2.3.4" xref="A1.E6.m1.9.9.1.1.2.2.2.2.3.4.cmml">n</mi></mrow></mrow></mrow></mrow><mo id="A1.E6.m1.9.9.1.2" lspace="0em">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E6.m1.9b"><apply id="A1.E6.m1.9.9.1.1.3.cmml" xref="A1.E6.m1.9.9.1.1.2"><csymbol cd="ambiguous" id="A1.E6.m1.9.9.1.1.3a.cmml" xref="A1.E6.m1.9.9.1.1.2.3">formulae-sequence</csymbol><apply id="A1.E6.m1.9.9.1.1.1.1.cmml" xref="A1.E6.m1.9.9.1.1.1.1"><eq id="A1.E6.m1.9.9.1.1.1.1.3.cmml" xref="A1.E6.m1.9.9.1.1.1.1.3"></eq><apply id="A1.E6.m1.9.9.1.1.1.1.1.cmml" xref="A1.E6.m1.9.9.1.1.1.1.1"><times id="A1.E6.m1.9.9.1.1.1.1.1.2.cmml" xref="A1.E6.m1.9.9.1.1.1.1.1.2"></times><ci id="A1.E6.m1.9.9.1.1.1.1.1.3.cmml" xref="A1.E6.m1.9.9.1.1.1.1.1.3">𝑞</ci><apply id="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.cmml" xref="A1.E6.m1.9.9.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.2.2">𝐱</ci><ci id="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.3.2">𝐱</ci><apply id="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.3.3.cmml" xref="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.3.3"><minus id="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.3.3.1"></minus><ci id="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.3.3.2">𝑡</ci><cn id="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="A1.E6.m1.9.9.1.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply><list id="A1.E6.m1.9.9.1.1.1.1.2.2.cmml" xref="A1.E6.m1.9.9.1.1.1.1.2.1"><apply id="A1.E6.m1.9.9.1.1.1.1.2.1.1.cmml" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1"><apply id="A1.E6.m1.9.9.1.1.1.1.2.1.1.2.cmml" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.2"><csymbol cd="ambiguous" id="A1.E6.m1.9.9.1.1.1.1.2.1.1.2.1.cmml" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.2">superscript</csymbol><apply id="A1.E6.m1.9.9.1.1.1.1.2.1.1.2.2.cmml" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.2"><csymbol cd="ambiguous" id="A1.E6.m1.9.9.1.1.1.1.2.1.1.2.2.1.cmml" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.2">subscript</csymbol><csymbol cd="latexml" id="A1.E6.m1.9.9.1.1.1.1.2.1.1.2.2.2.cmml" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.2.2.2">product</csymbol><apply id="A1.E6.m1.9.9.1.1.1.1.2.1.1.2.2.3.cmml" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.2.2.3"><eq id="A1.E6.m1.9.9.1.1.1.1.2.1.1.2.2.3.1.cmml" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.2.2.3.1"></eq><ci id="A1.E6.m1.9.9.1.1.1.1.2.1.1.2.2.3.2.cmml" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.2.2.3.2">𝑗</ci><cn id="A1.E6.m1.9.9.1.1.1.1.2.1.1.2.2.3.3.cmml" type="integer" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.2.2.3.3">1</cn></apply></apply><ci id="A1.E6.m1.9.9.1.1.1.1.2.1.1.2.3.cmml" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.2.3">𝑛</ci></apply><apply id="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.cmml" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.1"><times id="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.2.cmml" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.2"></times><ci id="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.3.cmml" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.3">𝑞</ci><apply id="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1"><csymbol cd="latexml" id="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.1">conditional</csymbol><apply id="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2.cmml" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2.1.cmml" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2">superscript</csymbol><apply id="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2.2.cmml" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2.2.1.cmml" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2">subscript</csymbol><ci id="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2.2.2.cmml" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2.2.2">𝑥</ci><ci id="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2.2.3.cmml" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2.2.3">𝑡</ci></apply><ci id="A1.E6.m1.1.1.1.1.cmml" xref="A1.E6.m1.1.1.1.1">𝑗</ci></apply><apply id="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3.cmml" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3.1.cmml" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3">superscript</csymbol><apply id="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3.2.cmml" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3.2.1.cmml" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3.2.2.cmml" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3.2.2">𝑥</ci><apply id="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3.2.3.cmml" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3.2.3"><minus id="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3.2.3.1.cmml" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3.2.3.1"></minus><ci id="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3.2.3.2.cmml" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3.2.3.2">𝑡</ci><cn id="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3.2.3.3.cmml" type="integer" xref="A1.E6.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3.2.3.3">1</cn></apply></apply><ci id="A1.E6.m1.2.2.1.1.cmml" xref="A1.E6.m1.2.2.1.1">𝑗</ci></apply></apply></apply></apply><ci id="A1.E6.m1.8.8a.cmml" xref="A1.E6.m1.8.8"><mtext id="A1.E6.m1.8.8.cmml" xref="A1.E6.m1.8.8">where</mtext></ci></list></apply><apply id="A1.E6.m1.9.9.1.1.2.2.3.cmml" xref="A1.E6.m1.9.9.1.1.2.2.2"><csymbol cd="ambiguous" id="A1.E6.m1.9.9.1.1.2.2.3a.cmml" xref="A1.E6.m1.9.9.1.1.2.2.2.3">formulae-sequence</csymbol><apply id="A1.E6.m1.9.9.1.1.2.2.1.1.cmml" xref="A1.E6.m1.9.9.1.1.2.2.1.1"><eq id="A1.E6.m1.9.9.1.1.2.2.1.1.3.cmml" xref="A1.E6.m1.9.9.1.1.2.2.1.1.3"></eq><apply id="A1.E6.m1.9.9.1.1.2.2.1.1.1.cmml" xref="A1.E6.m1.9.9.1.1.2.2.1.1.1"><times id="A1.E6.m1.9.9.1.1.2.2.1.1.1.2.cmml" xref="A1.E6.m1.9.9.1.1.2.2.1.1.1.2"></times><ci id="A1.E6.m1.9.9.1.1.2.2.1.1.1.3.cmml" xref="A1.E6.m1.9.9.1.1.2.2.1.1.1.3">𝑞</ci><apply id="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.cmml" xref="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1"><csymbol cd="latexml" id="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.1.cmml" xref="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.1">conditional</csymbol><apply id="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.2.cmml" xref="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.2.1.cmml" xref="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.2">superscript</csymbol><apply id="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.2.2.cmml" xref="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.2.2.1.cmml" xref="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.2">subscript</csymbol><ci id="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.2.2.2.cmml" xref="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.2.2.2">𝑥</ci><ci id="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.2.2.3.cmml" xref="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.2.2.3">𝑡</ci></apply><ci id="A1.E6.m1.3.3.1.1.cmml" xref="A1.E6.m1.3.3.1.1">𝑗</ci></apply><apply id="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.3.cmml" xref="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.3.1.cmml" xref="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.3">superscript</csymbol><apply id="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.3.2.cmml" xref="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.3.2.1.cmml" xref="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.3.2.2.cmml" xref="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.3.2.2">𝑥</ci><apply id="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.3.2.3.cmml" xref="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.3.2.3"><minus id="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.3.2.3.1.cmml" xref="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.3.2.3.1"></minus><ci id="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.3.2.3.2.cmml" xref="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.3.2.3.2">𝑡</ci><cn id="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.3.2.3.3.cmml" type="integer" xref="A1.E6.m1.9.9.1.1.2.2.1.1.1.1.1.1.3.2.3.3">1</cn></apply></apply><ci id="A1.E6.m1.4.4.1.1.cmml" xref="A1.E6.m1.4.4.1.1">𝑗</ci></apply></apply></apply><apply id="A1.E6.m1.9.9.1.1.2.2.1.1.2.2.cmml" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1"><ci id="A1.E6.m1.7.7.cmml" xref="A1.E6.m1.7.7">Bernoulli</ci><apply id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.cmml" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1"><csymbol cd="latexml" id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.2.cmml" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.2">conditional</csymbol><apply id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.3.cmml" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.3.1.cmml" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.3">superscript</csymbol><apply id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.3.2.cmml" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.3.2.1.cmml" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.3">subscript</csymbol><ci id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.3.2.2.cmml" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.3.2.2">𝑥</ci><ci id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.3.2.3.cmml" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.3.2.3">𝑡</ci></apply><ci id="A1.E6.m1.5.5.1.1.cmml" xref="A1.E6.m1.5.5.1.1">𝑗</ci></apply><apply id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.cmml" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1"><plus id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.2.cmml" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.2"></plus><apply id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.cmml" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1"><times id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.2.cmml" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.2"></times><apply id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1"><minus id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.1"></minus><cn id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.2">1</cn><apply id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.2">𝛽</ci><ci id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply><apply id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.3.cmml" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.3.1.cmml" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.3">superscript</csymbol><apply id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.3.2.cmml" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.3.2.1.cmml" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.3.2.2.cmml" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.3.2.2">𝑥</ci><apply id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.3.2.3.cmml" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.3.2.3"><minus id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.3.2.3.1.cmml" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.3.2.3.1"></minus><ci id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.3.2.3.2.cmml" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.3.2.3.2">𝑡</ci><cn id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.3.2.3.3.cmml" type="integer" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.3.2.3.3">1</cn></apply></apply><ci id="A1.E6.m1.6.6.1.1.cmml" xref="A1.E6.m1.6.6.1.1">𝑗</ci></apply></apply><apply id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.cmml" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3"><ci id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.1.cmml" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.1">⋅</ci><apply id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.2.cmml" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.2.1.cmml" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.2">subscript</csymbol><ci id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.2.2.cmml" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.2.2">𝛽</ci><ci id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.2.3.cmml" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.2.3">𝑡</ci></apply><apply id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.3.cmml" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.3"><divide id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.3.1.cmml" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.3"></divide><cn id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.3.2.cmml" type="integer" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.3.2">1</cn><cn id="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.3.3.cmml" type="integer" xref="A1.E6.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.3.3">2</cn></apply></apply></apply></apply></apply></apply><apply id="A1.E6.m1.9.9.1.1.2.2.2.2.cmml" xref="A1.E6.m1.9.9.1.1.2.2.2.2"><eq id="A1.E6.m1.9.9.1.1.2.2.2.2.1.cmml" xref="A1.E6.m1.9.9.1.1.2.2.2.2.1"></eq><ci id="A1.E6.m1.9.9.1.1.2.2.2.2.2.cmml" xref="A1.E6.m1.9.9.1.1.2.2.2.2.2">𝑗</ci><apply id="A1.E6.m1.9.9.1.1.2.2.2.2.3.cmml" xref="A1.E6.m1.9.9.1.1.2.2.2.2.3"><times id="A1.E6.m1.9.9.1.1.2.2.2.2.3.1.cmml" xref="A1.E6.m1.9.9.1.1.2.2.2.2.3.1"></times><cn id="A1.E6.m1.9.9.1.1.2.2.2.2.3.2.cmml" type="integer" xref="A1.E6.m1.9.9.1.1.2.2.2.2.3.2">1</cn><ci id="A1.E6.m1.9.9.1.1.2.2.2.2.3.3.cmml" xref="A1.E6.m1.9.9.1.1.2.2.2.2.3.3">…</ci><ci id="A1.E6.m1.9.9.1.1.2.2.2.2.3.4.cmml" xref="A1.E6.m1.9.9.1.1.2.2.2.2.3.4">𝑛</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E6.m1.9c">q(\mathbf{x}_{t}|\mathbf{x}_{t-1})=\prod_{j=1}^{n}q(x_{t}^{(j)}|x_{t-1}^{(j)})%
\quad\text{where}\quad q(x_{t}^{(j)}|x_{t-1}^{(j)})=\operatorname{Bernoulli}(x%
_{t}^{(j)}\mid(1-\beta_{t})x_{t-1}^{(j)}+\beta_{t}\cdot\frac{1}{2}),\quad j=1%
\ldots n.</annotation><annotation encoding="application/x-llamapun" id="A1.E6.m1.9d">italic_q ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | bold_x start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT ) = ∏ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT italic_q ( italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT | italic_x start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT ) where italic_q ( italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT | italic_x start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT ) = roman_Bernoulli ( italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT ∣ ( 1 - italic_β start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) italic_x start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT + italic_β start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ⋅ divide start_ARG 1 end_ARG start_ARG 2 end_ARG ) , italic_j = 1 … italic_n .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS1.SSS4.p2.3">Since the forward diffusion process is Markovian, it is possible to express the bit-wise distribution of <math alttext="\mathbf{x}_{t}" class="ltx_Math" display="inline" id="A1.SS1.SSS4.p2.2.m1.1"><semantics id="A1.SS1.SSS4.p2.2.m1.1a"><msub id="A1.SS1.SSS4.p2.2.m1.1.1" xref="A1.SS1.SSS4.p2.2.m1.1.1.cmml"><mi id="A1.SS1.SSS4.p2.2.m1.1.1.2" xref="A1.SS1.SSS4.p2.2.m1.1.1.2.cmml">𝐱</mi><mi id="A1.SS1.SSS4.p2.2.m1.1.1.3" xref="A1.SS1.SSS4.p2.2.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS4.p2.2.m1.1b"><apply id="A1.SS1.SSS4.p2.2.m1.1.1.cmml" xref="A1.SS1.SSS4.p2.2.m1.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS4.p2.2.m1.1.1.1.cmml" xref="A1.SS1.SSS4.p2.2.m1.1.1">subscript</csymbol><ci id="A1.SS1.SSS4.p2.2.m1.1.1.2.cmml" xref="A1.SS1.SSS4.p2.2.m1.1.1.2">𝐱</ci><ci id="A1.SS1.SSS4.p2.2.m1.1.1.3.cmml" xref="A1.SS1.SSS4.p2.2.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS4.p2.2.m1.1c">\mathbf{x}_{t}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS4.p2.2.m1.1d">bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> directly with the ground truth fingerprint <math alttext="\mathbf{x}_{0}" class="ltx_Math" display="inline" id="A1.SS1.SSS4.p2.3.m2.1"><semantics id="A1.SS1.SSS4.p2.3.m2.1a"><msub id="A1.SS1.SSS4.p2.3.m2.1.1" xref="A1.SS1.SSS4.p2.3.m2.1.1.cmml"><mi id="A1.SS1.SSS4.p2.3.m2.1.1.2" xref="A1.SS1.SSS4.p2.3.m2.1.1.2.cmml">𝐱</mi><mn id="A1.SS1.SSS4.p2.3.m2.1.1.3" xref="A1.SS1.SSS4.p2.3.m2.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS4.p2.3.m2.1b"><apply id="A1.SS1.SSS4.p2.3.m2.1.1.cmml" xref="A1.SS1.SSS4.p2.3.m2.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS4.p2.3.m2.1.1.1.cmml" xref="A1.SS1.SSS4.p2.3.m2.1.1">subscript</csymbol><ci id="A1.SS1.SSS4.p2.3.m2.1.1.2.cmml" xref="A1.SS1.SSS4.p2.3.m2.1.1.2">𝐱</ci><cn id="A1.SS1.SSS4.p2.3.m2.1.1.3.cmml" type="integer" xref="A1.SS1.SSS4.p2.3.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS4.p2.3.m2.1c">\mathbf{x}_{0}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS4.p2.3.m2.1d">bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="q(\mathbf{x}_{t}|\mathbf{x}_{0})=\prod_{j=1}^{n}q(x_{t}^{(j)}|x_{0}^{(j)})%
\quad\text{where}\quad q(x_{t}^{(j)}|x_{0}^{(j)})=\operatorname{Bernoulli}(x_{%
t}^{(j)}\mid\bar{\alpha_{t}}x_{0}^{(j)}+(1-\bar{\alpha_{t}})\cdot\frac{1}{2}),%
\quad j=1\ldots n." class="ltx_Math" display="block" id="A1.E7.m1.9"><semantics id="A1.E7.m1.9a"><mrow id="A1.E7.m1.9.9.1"><mrow id="A1.E7.m1.9.9.1.1.2" xref="A1.E7.m1.9.9.1.1.3.cmml"><mrow id="A1.E7.m1.9.9.1.1.1.1" xref="A1.E7.m1.9.9.1.1.1.1.cmml"><mrow id="A1.E7.m1.9.9.1.1.1.1.1" xref="A1.E7.m1.9.9.1.1.1.1.1.cmml"><mi id="A1.E7.m1.9.9.1.1.1.1.1.3" xref="A1.E7.m1.9.9.1.1.1.1.1.3.cmml">q</mi><mo id="A1.E7.m1.9.9.1.1.1.1.1.2" xref="A1.E7.m1.9.9.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E7.m1.9.9.1.1.1.1.1.1.1" xref="A1.E7.m1.9.9.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E7.m1.9.9.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E7.m1.9.9.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E7.m1.9.9.1.1.1.1.1.1.1.1" xref="A1.E7.m1.9.9.1.1.1.1.1.1.1.1.cmml"><msub id="A1.E7.m1.9.9.1.1.1.1.1.1.1.1.2" xref="A1.E7.m1.9.9.1.1.1.1.1.1.1.1.2.cmml"><mi id="A1.E7.m1.9.9.1.1.1.1.1.1.1.1.2.2" xref="A1.E7.m1.9.9.1.1.1.1.1.1.1.1.2.2.cmml">𝐱</mi><mi id="A1.E7.m1.9.9.1.1.1.1.1.1.1.1.2.3" xref="A1.E7.m1.9.9.1.1.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="A1.E7.m1.9.9.1.1.1.1.1.1.1.1.1" xref="A1.E7.m1.9.9.1.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="A1.E7.m1.9.9.1.1.1.1.1.1.1.1.3" xref="A1.E7.m1.9.9.1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.E7.m1.9.9.1.1.1.1.1.1.1.1.3.2" xref="A1.E7.m1.9.9.1.1.1.1.1.1.1.1.3.2.cmml">𝐱</mi><mn id="A1.E7.m1.9.9.1.1.1.1.1.1.1.1.3.3" xref="A1.E7.m1.9.9.1.1.1.1.1.1.1.1.3.3.cmml">0</mn></msub></mrow><mo id="A1.E7.m1.9.9.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E7.m1.9.9.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E7.m1.9.9.1.1.1.1.3" rspace="0.111em" xref="A1.E7.m1.9.9.1.1.1.1.3.cmml">=</mo><mrow id="A1.E7.m1.9.9.1.1.1.1.2.1" xref="A1.E7.m1.9.9.1.1.1.1.2.2.cmml"><mrow id="A1.E7.m1.9.9.1.1.1.1.2.1.1" xref="A1.E7.m1.9.9.1.1.1.1.2.1.1.cmml"><munderover id="A1.E7.m1.9.9.1.1.1.1.2.1.1.2" xref="A1.E7.m1.9.9.1.1.1.1.2.1.1.2.cmml"><mo id="A1.E7.m1.9.9.1.1.1.1.2.1.1.2.2.2" movablelimits="false" xref="A1.E7.m1.9.9.1.1.1.1.2.1.1.2.2.2.cmml">∏</mo><mrow id="A1.E7.m1.9.9.1.1.1.1.2.1.1.2.2.3" xref="A1.E7.m1.9.9.1.1.1.1.2.1.1.2.2.3.cmml"><mi id="A1.E7.m1.9.9.1.1.1.1.2.1.1.2.2.3.2" xref="A1.E7.m1.9.9.1.1.1.1.2.1.1.2.2.3.2.cmml">j</mi><mo id="A1.E7.m1.9.9.1.1.1.1.2.1.1.2.2.3.1" xref="A1.E7.m1.9.9.1.1.1.1.2.1.1.2.2.3.1.cmml">=</mo><mn id="A1.E7.m1.9.9.1.1.1.1.2.1.1.2.2.3.3" xref="A1.E7.m1.9.9.1.1.1.1.2.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="A1.E7.m1.9.9.1.1.1.1.2.1.1.2.3" xref="A1.E7.m1.9.9.1.1.1.1.2.1.1.2.3.cmml">n</mi></munderover><mrow id="A1.E7.m1.9.9.1.1.1.1.2.1.1.1" xref="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.cmml"><mi id="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.3" xref="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.3.cmml">q</mi><mo id="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.2" xref="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.2.cmml">⁢</mo><mrow id="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.1.1" xref="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.cmml"><mo id="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.1.1.2" stretchy="false" xref="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.1.1.1" xref="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.cmml"><msubsup id="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2" xref="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2.cmml"><mi id="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2.2.2" xref="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2.2.2.cmml">x</mi><mi id="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2.2.3" xref="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2.2.3.cmml">t</mi><mrow id="A1.E7.m1.1.1.1.3" xref="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2.cmml"><mo id="A1.E7.m1.1.1.1.3.1" stretchy="false" xref="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2.cmml">(</mo><mi id="A1.E7.m1.1.1.1.1" xref="A1.E7.m1.1.1.1.1.cmml">j</mi><mo id="A1.E7.m1.1.1.1.3.2" stretchy="false" xref="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2.cmml">)</mo></mrow></msubsup><mo fence="false" id="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.1" xref="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.1.cmml">|</mo><msubsup id="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3" xref="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3.cmml"><mi id="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3.2.2" xref="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3.2.2.cmml">x</mi><mn id="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3.2.3" xref="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3.2.3.cmml">0</mn><mrow id="A1.E7.m1.2.2.1.3" xref="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3.cmml"><mo id="A1.E7.m1.2.2.1.3.1" stretchy="false" xref="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3.cmml">(</mo><mi id="A1.E7.m1.2.2.1.1" xref="A1.E7.m1.2.2.1.1.cmml">j</mi><mo id="A1.E7.m1.2.2.1.3.2" stretchy="false" xref="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo id="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.1.1.3" stretchy="false" xref="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mspace id="A1.E7.m1.9.9.1.1.1.1.2.1.2" width="1em" xref="A1.E7.m1.9.9.1.1.1.1.2.2.cmml"></mspace><mtext id="A1.E7.m1.8.8" xref="A1.E7.m1.8.8a.cmml">where</mtext></mrow></mrow><mspace id="A1.E7.m1.9.9.1.1.2.3" width="1em" xref="A1.E7.m1.9.9.1.1.3a.cmml"></mspace><mrow id="A1.E7.m1.9.9.1.1.2.2.2" xref="A1.E7.m1.9.9.1.1.2.2.3.cmml"><mrow id="A1.E7.m1.9.9.1.1.2.2.1.1" xref="A1.E7.m1.9.9.1.1.2.2.1.1.cmml"><mrow id="A1.E7.m1.9.9.1.1.2.2.1.1.1" xref="A1.E7.m1.9.9.1.1.2.2.1.1.1.cmml"><mi id="A1.E7.m1.9.9.1.1.2.2.1.1.1.3" xref="A1.E7.m1.9.9.1.1.2.2.1.1.1.3.cmml">q</mi><mo id="A1.E7.m1.9.9.1.1.2.2.1.1.1.2" xref="A1.E7.m1.9.9.1.1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="A1.E7.m1.9.9.1.1.2.2.1.1.1.1.1" xref="A1.E7.m1.9.9.1.1.2.2.1.1.1.1.1.1.cmml"><mo id="A1.E7.m1.9.9.1.1.2.2.1.1.1.1.1.2" stretchy="false" xref="A1.E7.m1.9.9.1.1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E7.m1.9.9.1.1.2.2.1.1.1.1.1.1" xref="A1.E7.m1.9.9.1.1.2.2.1.1.1.1.1.1.cmml"><msubsup id="A1.E7.m1.9.9.1.1.2.2.1.1.1.1.1.1.2" xref="A1.E7.m1.9.9.1.1.2.2.1.1.1.1.1.1.2.cmml"><mi id="A1.E7.m1.9.9.1.1.2.2.1.1.1.1.1.1.2.2.2" xref="A1.E7.m1.9.9.1.1.2.2.1.1.1.1.1.1.2.2.2.cmml">x</mi><mi id="A1.E7.m1.9.9.1.1.2.2.1.1.1.1.1.1.2.2.3" xref="A1.E7.m1.9.9.1.1.2.2.1.1.1.1.1.1.2.2.3.cmml">t</mi><mrow id="A1.E7.m1.3.3.1.3" xref="A1.E7.m1.9.9.1.1.2.2.1.1.1.1.1.1.2.cmml"><mo id="A1.E7.m1.3.3.1.3.1" stretchy="false" xref="A1.E7.m1.9.9.1.1.2.2.1.1.1.1.1.1.2.cmml">(</mo><mi id="A1.E7.m1.3.3.1.1" xref="A1.E7.m1.3.3.1.1.cmml">j</mi><mo id="A1.E7.m1.3.3.1.3.2" stretchy="false" xref="A1.E7.m1.9.9.1.1.2.2.1.1.1.1.1.1.2.cmml">)</mo></mrow></msubsup><mo fence="false" id="A1.E7.m1.9.9.1.1.2.2.1.1.1.1.1.1.1" xref="A1.E7.m1.9.9.1.1.2.2.1.1.1.1.1.1.1.cmml">|</mo><msubsup id="A1.E7.m1.9.9.1.1.2.2.1.1.1.1.1.1.3" xref="A1.E7.m1.9.9.1.1.2.2.1.1.1.1.1.1.3.cmml"><mi id="A1.E7.m1.9.9.1.1.2.2.1.1.1.1.1.1.3.2.2" xref="A1.E7.m1.9.9.1.1.2.2.1.1.1.1.1.1.3.2.2.cmml">x</mi><mn id="A1.E7.m1.9.9.1.1.2.2.1.1.1.1.1.1.3.2.3" xref="A1.E7.m1.9.9.1.1.2.2.1.1.1.1.1.1.3.2.3.cmml">0</mn><mrow id="A1.E7.m1.4.4.1.3" xref="A1.E7.m1.9.9.1.1.2.2.1.1.1.1.1.1.3.cmml"><mo id="A1.E7.m1.4.4.1.3.1" stretchy="false" xref="A1.E7.m1.9.9.1.1.2.2.1.1.1.1.1.1.3.cmml">(</mo><mi id="A1.E7.m1.4.4.1.1" xref="A1.E7.m1.4.4.1.1.cmml">j</mi><mo id="A1.E7.m1.4.4.1.3.2" stretchy="false" xref="A1.E7.m1.9.9.1.1.2.2.1.1.1.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo id="A1.E7.m1.9.9.1.1.2.2.1.1.1.1.1.3" stretchy="false" xref="A1.E7.m1.9.9.1.1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E7.m1.9.9.1.1.2.2.1.1.3" xref="A1.E7.m1.9.9.1.1.2.2.1.1.3.cmml">=</mo><mrow id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.2.cmml"><mi id="A1.E7.m1.7.7" xref="A1.E7.m1.7.7.cmml">Bernoulli</mi><mo id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1a" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.2.cmml">⁡</mo><mrow id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.2.cmml"><mo id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.2" stretchy="false" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.2.cmml">(</mo><mrow id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.cmml"><msubsup id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.3" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.3.cmml"><mi id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.3.2.2" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.3.2.2.cmml">x</mi><mi id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.3.2.3" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.3.2.3.cmml">t</mi><mrow id="A1.E7.m1.5.5.1.3" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.3.cmml"><mo id="A1.E7.m1.5.5.1.3.1" stretchy="false" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.3.cmml">(</mo><mi id="A1.E7.m1.5.5.1.1" xref="A1.E7.m1.5.5.1.1.cmml">j</mi><mo id="A1.E7.m1.5.5.1.3.2" stretchy="false" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.3.cmml">)</mo></mrow></msubsup><mo id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.2" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.2.cmml">∣</mo><mrow id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.cmml"><mrow id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.cmml"><mover accent="true" id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.2" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.2.cmml"><msub id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.2.2" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.2.2.cmml"><mi id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.2.2.2" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.2.2.2.cmml">α</mi><mi id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.2.2.3" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.2.2.3.cmml">t</mi></msub><mo id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.2.1" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.2.1.cmml">¯</mo></mover><mo id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.1" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.1.cmml">⁢</mo><msubsup id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.3" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.3.cmml"><mi id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.3.2.2" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.3.2.2.cmml">x</mi><mn id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.3.2.3" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.3.2.3.cmml">0</mn><mrow id="A1.E7.m1.6.6.1.3" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.3.cmml"><mo id="A1.E7.m1.6.6.1.3.1" stretchy="false" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.3.cmml">(</mo><mi id="A1.E7.m1.6.6.1.1" xref="A1.E7.m1.6.6.1.1.cmml">j</mi><mo id="A1.E7.m1.6.6.1.3.2" stretchy="false" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.3.cmml">)</mo></mrow></msubsup></mrow><mo id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.2" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.2.cmml">+</mo><mrow id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.cmml"><mrow id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.cmml"><mn id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.2" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.1" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.cmml">−</mo><mover accent="true" id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.3" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.cmml"><msub id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.2" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.2.2" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.2.2.cmml">α</mi><mi id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.2.3" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.2.3.cmml">t</mi></msub><mo id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.1" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.1.cmml">¯</mo></mover></mrow><mo id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.2" rspace="0.222em" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.2.cmml">⋅</mo><mfrac id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.3" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.3.cmml"><mn id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.3.2" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.3.2.cmml">1</mn><mn id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.3.3" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.3.3.cmml">2</mn></mfrac></mrow></mrow></mrow><mo id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.3" stretchy="false" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.2.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E7.m1.9.9.1.1.2.2.2.3" rspace="1.167em" xref="A1.E7.m1.9.9.1.1.2.2.3a.cmml">,</mo><mrow id="A1.E7.m1.9.9.1.1.2.2.2.2" xref="A1.E7.m1.9.9.1.1.2.2.2.2.cmml"><mi id="A1.E7.m1.9.9.1.1.2.2.2.2.2" xref="A1.E7.m1.9.9.1.1.2.2.2.2.2.cmml">j</mi><mo id="A1.E7.m1.9.9.1.1.2.2.2.2.1" xref="A1.E7.m1.9.9.1.1.2.2.2.2.1.cmml">=</mo><mrow id="A1.E7.m1.9.9.1.1.2.2.2.2.3" xref="A1.E7.m1.9.9.1.1.2.2.2.2.3.cmml"><mn id="A1.E7.m1.9.9.1.1.2.2.2.2.3.2" xref="A1.E7.m1.9.9.1.1.2.2.2.2.3.2.cmml">1</mn><mo id="A1.E7.m1.9.9.1.1.2.2.2.2.3.1" xref="A1.E7.m1.9.9.1.1.2.2.2.2.3.1.cmml">⁢</mo><mi id="A1.E7.m1.9.9.1.1.2.2.2.2.3.3" mathvariant="normal" xref="A1.E7.m1.9.9.1.1.2.2.2.2.3.3.cmml">…</mi><mo id="A1.E7.m1.9.9.1.1.2.2.2.2.3.1a" xref="A1.E7.m1.9.9.1.1.2.2.2.2.3.1.cmml">⁢</mo><mi id="A1.E7.m1.9.9.1.1.2.2.2.2.3.4" xref="A1.E7.m1.9.9.1.1.2.2.2.2.3.4.cmml">n</mi></mrow></mrow></mrow></mrow><mo id="A1.E7.m1.9.9.1.2" lspace="0em">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E7.m1.9b"><apply id="A1.E7.m1.9.9.1.1.3.cmml" xref="A1.E7.m1.9.9.1.1.2"><csymbol cd="ambiguous" id="A1.E7.m1.9.9.1.1.3a.cmml" xref="A1.E7.m1.9.9.1.1.2.3">formulae-sequence</csymbol><apply id="A1.E7.m1.9.9.1.1.1.1.cmml" xref="A1.E7.m1.9.9.1.1.1.1"><eq id="A1.E7.m1.9.9.1.1.1.1.3.cmml" xref="A1.E7.m1.9.9.1.1.1.1.3"></eq><apply id="A1.E7.m1.9.9.1.1.1.1.1.cmml" xref="A1.E7.m1.9.9.1.1.1.1.1"><times id="A1.E7.m1.9.9.1.1.1.1.1.2.cmml" xref="A1.E7.m1.9.9.1.1.1.1.1.2"></times><ci id="A1.E7.m1.9.9.1.1.1.1.1.3.cmml" xref="A1.E7.m1.9.9.1.1.1.1.1.3">𝑞</ci><apply id="A1.E7.m1.9.9.1.1.1.1.1.1.1.1.cmml" xref="A1.E7.m1.9.9.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E7.m1.9.9.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E7.m1.9.9.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="A1.E7.m1.9.9.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E7.m1.9.9.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E7.m1.9.9.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E7.m1.9.9.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A1.E7.m1.9.9.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E7.m1.9.9.1.1.1.1.1.1.1.1.2.2">𝐱</ci><ci id="A1.E7.m1.9.9.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.E7.m1.9.9.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="A1.E7.m1.9.9.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E7.m1.9.9.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E7.m1.9.9.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E7.m1.9.9.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E7.m1.9.9.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E7.m1.9.9.1.1.1.1.1.1.1.1.3.2">𝐱</ci><cn id="A1.E7.m1.9.9.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="A1.E7.m1.9.9.1.1.1.1.1.1.1.1.3.3">0</cn></apply></apply></apply><list id="A1.E7.m1.9.9.1.1.1.1.2.2.cmml" xref="A1.E7.m1.9.9.1.1.1.1.2.1"><apply id="A1.E7.m1.9.9.1.1.1.1.2.1.1.cmml" xref="A1.E7.m1.9.9.1.1.1.1.2.1.1"><apply id="A1.E7.m1.9.9.1.1.1.1.2.1.1.2.cmml" xref="A1.E7.m1.9.9.1.1.1.1.2.1.1.2"><csymbol cd="ambiguous" id="A1.E7.m1.9.9.1.1.1.1.2.1.1.2.1.cmml" xref="A1.E7.m1.9.9.1.1.1.1.2.1.1.2">superscript</csymbol><apply id="A1.E7.m1.9.9.1.1.1.1.2.1.1.2.2.cmml" xref="A1.E7.m1.9.9.1.1.1.1.2.1.1.2"><csymbol cd="ambiguous" id="A1.E7.m1.9.9.1.1.1.1.2.1.1.2.2.1.cmml" xref="A1.E7.m1.9.9.1.1.1.1.2.1.1.2">subscript</csymbol><csymbol cd="latexml" id="A1.E7.m1.9.9.1.1.1.1.2.1.1.2.2.2.cmml" xref="A1.E7.m1.9.9.1.1.1.1.2.1.1.2.2.2">product</csymbol><apply id="A1.E7.m1.9.9.1.1.1.1.2.1.1.2.2.3.cmml" xref="A1.E7.m1.9.9.1.1.1.1.2.1.1.2.2.3"><eq id="A1.E7.m1.9.9.1.1.1.1.2.1.1.2.2.3.1.cmml" xref="A1.E7.m1.9.9.1.1.1.1.2.1.1.2.2.3.1"></eq><ci id="A1.E7.m1.9.9.1.1.1.1.2.1.1.2.2.3.2.cmml" xref="A1.E7.m1.9.9.1.1.1.1.2.1.1.2.2.3.2">𝑗</ci><cn id="A1.E7.m1.9.9.1.1.1.1.2.1.1.2.2.3.3.cmml" type="integer" xref="A1.E7.m1.9.9.1.1.1.1.2.1.1.2.2.3.3">1</cn></apply></apply><ci id="A1.E7.m1.9.9.1.1.1.1.2.1.1.2.3.cmml" xref="A1.E7.m1.9.9.1.1.1.1.2.1.1.2.3">𝑛</ci></apply><apply id="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.cmml" xref="A1.E7.m1.9.9.1.1.1.1.2.1.1.1"><times id="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.2.cmml" xref="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.2"></times><ci id="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.3.cmml" xref="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.3">𝑞</ci><apply id="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.1.1"><csymbol cd="latexml" id="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.1">conditional</csymbol><apply id="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2.cmml" xref="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2.1.cmml" xref="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2">superscript</csymbol><apply id="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2.2.cmml" xref="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2.2.1.cmml" xref="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2">subscript</csymbol><ci id="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2.2.2.cmml" xref="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2.2.2">𝑥</ci><ci id="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2.2.3.cmml" xref="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.2.2.3">𝑡</ci></apply><ci id="A1.E7.m1.1.1.1.1.cmml" xref="A1.E7.m1.1.1.1.1">𝑗</ci></apply><apply id="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3.cmml" xref="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3.1.cmml" xref="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3">superscript</csymbol><apply id="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3.2.cmml" xref="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3.2.1.cmml" xref="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3.2.2.cmml" xref="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3.2.2">𝑥</ci><cn id="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3.2.3.cmml" type="integer" xref="A1.E7.m1.9.9.1.1.1.1.2.1.1.1.1.1.1.3.2.3">0</cn></apply><ci id="A1.E7.m1.2.2.1.1.cmml" xref="A1.E7.m1.2.2.1.1">𝑗</ci></apply></apply></apply></apply><ci id="A1.E7.m1.8.8a.cmml" xref="A1.E7.m1.8.8"><mtext id="A1.E7.m1.8.8.cmml" xref="A1.E7.m1.8.8">where</mtext></ci></list></apply><apply id="A1.E7.m1.9.9.1.1.2.2.3.cmml" xref="A1.E7.m1.9.9.1.1.2.2.2"><csymbol cd="ambiguous" id="A1.E7.m1.9.9.1.1.2.2.3a.cmml" xref="A1.E7.m1.9.9.1.1.2.2.2.3">formulae-sequence</csymbol><apply id="A1.E7.m1.9.9.1.1.2.2.1.1.cmml" xref="A1.E7.m1.9.9.1.1.2.2.1.1"><eq id="A1.E7.m1.9.9.1.1.2.2.1.1.3.cmml" xref="A1.E7.m1.9.9.1.1.2.2.1.1.3"></eq><apply id="A1.E7.m1.9.9.1.1.2.2.1.1.1.cmml" xref="A1.E7.m1.9.9.1.1.2.2.1.1.1"><times id="A1.E7.m1.9.9.1.1.2.2.1.1.1.2.cmml" xref="A1.E7.m1.9.9.1.1.2.2.1.1.1.2"></times><ci id="A1.E7.m1.9.9.1.1.2.2.1.1.1.3.cmml" xref="A1.E7.m1.9.9.1.1.2.2.1.1.1.3">𝑞</ci><apply id="A1.E7.m1.9.9.1.1.2.2.1.1.1.1.1.1.cmml" xref="A1.E7.m1.9.9.1.1.2.2.1.1.1.1.1"><csymbol cd="latexml" id="A1.E7.m1.9.9.1.1.2.2.1.1.1.1.1.1.1.cmml" xref="A1.E7.m1.9.9.1.1.2.2.1.1.1.1.1.1.1">conditional</csymbol><apply id="A1.E7.m1.9.9.1.1.2.2.1.1.1.1.1.1.2.cmml" xref="A1.E7.m1.9.9.1.1.2.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E7.m1.9.9.1.1.2.2.1.1.1.1.1.1.2.1.cmml" xref="A1.E7.m1.9.9.1.1.2.2.1.1.1.1.1.1.2">superscript</csymbol><apply id="A1.E7.m1.9.9.1.1.2.2.1.1.1.1.1.1.2.2.cmml" xref="A1.E7.m1.9.9.1.1.2.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E7.m1.9.9.1.1.2.2.1.1.1.1.1.1.2.2.1.cmml" xref="A1.E7.m1.9.9.1.1.2.2.1.1.1.1.1.1.2">subscript</csymbol><ci id="A1.E7.m1.9.9.1.1.2.2.1.1.1.1.1.1.2.2.2.cmml" xref="A1.E7.m1.9.9.1.1.2.2.1.1.1.1.1.1.2.2.2">𝑥</ci><ci id="A1.E7.m1.9.9.1.1.2.2.1.1.1.1.1.1.2.2.3.cmml" xref="A1.E7.m1.9.9.1.1.2.2.1.1.1.1.1.1.2.2.3">𝑡</ci></apply><ci id="A1.E7.m1.3.3.1.1.cmml" xref="A1.E7.m1.3.3.1.1">𝑗</ci></apply><apply id="A1.E7.m1.9.9.1.1.2.2.1.1.1.1.1.1.3.cmml" xref="A1.E7.m1.9.9.1.1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E7.m1.9.9.1.1.2.2.1.1.1.1.1.1.3.1.cmml" xref="A1.E7.m1.9.9.1.1.2.2.1.1.1.1.1.1.3">superscript</csymbol><apply id="A1.E7.m1.9.9.1.1.2.2.1.1.1.1.1.1.3.2.cmml" xref="A1.E7.m1.9.9.1.1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E7.m1.9.9.1.1.2.2.1.1.1.1.1.1.3.2.1.cmml" xref="A1.E7.m1.9.9.1.1.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E7.m1.9.9.1.1.2.2.1.1.1.1.1.1.3.2.2.cmml" xref="A1.E7.m1.9.9.1.1.2.2.1.1.1.1.1.1.3.2.2">𝑥</ci><cn id="A1.E7.m1.9.9.1.1.2.2.1.1.1.1.1.1.3.2.3.cmml" type="integer" xref="A1.E7.m1.9.9.1.1.2.2.1.1.1.1.1.1.3.2.3">0</cn></apply><ci id="A1.E7.m1.4.4.1.1.cmml" xref="A1.E7.m1.4.4.1.1">𝑗</ci></apply></apply></apply><apply id="A1.E7.m1.9.9.1.1.2.2.1.1.2.2.cmml" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1"><ci id="A1.E7.m1.7.7.cmml" xref="A1.E7.m1.7.7">Bernoulli</ci><apply id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.cmml" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1"><csymbol cd="latexml" id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.2.cmml" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.2">conditional</csymbol><apply id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.3.cmml" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.3.1.cmml" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.3">superscript</csymbol><apply id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.3.2.cmml" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.3.2.1.cmml" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.3">subscript</csymbol><ci id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.3.2.2.cmml" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.3.2.2">𝑥</ci><ci id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.3.2.3.cmml" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.3.2.3">𝑡</ci></apply><ci id="A1.E7.m1.5.5.1.1.cmml" xref="A1.E7.m1.5.5.1.1">𝑗</ci></apply><apply id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.cmml" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1"><plus id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.2.cmml" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.2"></plus><apply id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.cmml" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3"><times id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.1.cmml" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.1"></times><apply id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.2.cmml" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.2"><ci id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.2.1.cmml" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.2.1">¯</ci><apply id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.2.2.cmml" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.2.2.1.cmml" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.2.2">subscript</csymbol><ci id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.2.2.2.cmml" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.2.2.2">𝛼</ci><ci id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.2.2.3.cmml" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.2.2.3">𝑡</ci></apply></apply><apply id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.3.cmml" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.3.1.cmml" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.3">superscript</csymbol><apply id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.3.2.cmml" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.3.2.1.cmml" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.3">subscript</csymbol><ci id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.3.2.2.cmml" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.3.2.2">𝑥</ci><cn id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.3.2.3.cmml" type="integer" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.3.3.2.3">0</cn></apply><ci id="A1.E7.m1.6.6.1.1.cmml" xref="A1.E7.m1.6.6.1.1">𝑗</ci></apply></apply><apply id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.cmml" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1"><ci id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.2.cmml" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.2">⋅</ci><apply id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1"><minus id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.1"></minus><cn id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.2">1</cn><apply id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.3"><ci id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.1">¯</ci><apply id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.2.2">𝛼</ci><ci id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.2.3">𝑡</ci></apply></apply></apply><apply id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.3.cmml" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.3"><divide id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.3.1.cmml" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.3"></divide><cn id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.3.2.cmml" type="integer" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.3.2">1</cn><cn id="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.3.3.cmml" type="integer" xref="A1.E7.m1.9.9.1.1.2.2.1.1.2.1.1.1.1.1.3.3">2</cn></apply></apply></apply></apply></apply></apply><apply id="A1.E7.m1.9.9.1.1.2.2.2.2.cmml" xref="A1.E7.m1.9.9.1.1.2.2.2.2"><eq id="A1.E7.m1.9.9.1.1.2.2.2.2.1.cmml" xref="A1.E7.m1.9.9.1.1.2.2.2.2.1"></eq><ci id="A1.E7.m1.9.9.1.1.2.2.2.2.2.cmml" xref="A1.E7.m1.9.9.1.1.2.2.2.2.2">𝑗</ci><apply id="A1.E7.m1.9.9.1.1.2.2.2.2.3.cmml" xref="A1.E7.m1.9.9.1.1.2.2.2.2.3"><times id="A1.E7.m1.9.9.1.1.2.2.2.2.3.1.cmml" xref="A1.E7.m1.9.9.1.1.2.2.2.2.3.1"></times><cn id="A1.E7.m1.9.9.1.1.2.2.2.2.3.2.cmml" type="integer" xref="A1.E7.m1.9.9.1.1.2.2.2.2.3.2">1</cn><ci id="A1.E7.m1.9.9.1.1.2.2.2.2.3.3.cmml" xref="A1.E7.m1.9.9.1.1.2.2.2.2.3.3">…</ci><ci id="A1.E7.m1.9.9.1.1.2.2.2.2.3.4.cmml" xref="A1.E7.m1.9.9.1.1.2.2.2.2.3.4">𝑛</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E7.m1.9c">q(\mathbf{x}_{t}|\mathbf{x}_{0})=\prod_{j=1}^{n}q(x_{t}^{(j)}|x_{0}^{(j)})%
\quad\text{where}\quad q(x_{t}^{(j)}|x_{0}^{(j)})=\operatorname{Bernoulli}(x_{%
t}^{(j)}\mid\bar{\alpha_{t}}x_{0}^{(j)}+(1-\bar{\alpha_{t}})\cdot\frac{1}{2}),%
\quad j=1\ldots n.</annotation><annotation encoding="application/x-llamapun" id="A1.E7.m1.9d">italic_q ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) = ∏ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT italic_q ( italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT | italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT ) where italic_q ( italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT | italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT ) = roman_Bernoulli ( italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT ∣ over¯ start_ARG italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT + ( 1 - over¯ start_ARG italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG ) ⋅ divide start_ARG 1 end_ARG start_ARG 2 end_ARG ) , italic_j = 1 … italic_n .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS1.SSS4.p2.13">where <math alttext="\alpha_{t}=1-\beta_{t}" class="ltx_Math" display="inline" id="A1.SS1.SSS4.p2.4.m1.1"><semantics id="A1.SS1.SSS4.p2.4.m1.1a"><mrow id="A1.SS1.SSS4.p2.4.m1.1.1" xref="A1.SS1.SSS4.p2.4.m1.1.1.cmml"><msub id="A1.SS1.SSS4.p2.4.m1.1.1.2" xref="A1.SS1.SSS4.p2.4.m1.1.1.2.cmml"><mi id="A1.SS1.SSS4.p2.4.m1.1.1.2.2" xref="A1.SS1.SSS4.p2.4.m1.1.1.2.2.cmml">α</mi><mi id="A1.SS1.SSS4.p2.4.m1.1.1.2.3" xref="A1.SS1.SSS4.p2.4.m1.1.1.2.3.cmml">t</mi></msub><mo id="A1.SS1.SSS4.p2.4.m1.1.1.1" xref="A1.SS1.SSS4.p2.4.m1.1.1.1.cmml">=</mo><mrow id="A1.SS1.SSS4.p2.4.m1.1.1.3" xref="A1.SS1.SSS4.p2.4.m1.1.1.3.cmml"><mn id="A1.SS1.SSS4.p2.4.m1.1.1.3.2" xref="A1.SS1.SSS4.p2.4.m1.1.1.3.2.cmml">1</mn><mo id="A1.SS1.SSS4.p2.4.m1.1.1.3.1" xref="A1.SS1.SSS4.p2.4.m1.1.1.3.1.cmml">−</mo><msub id="A1.SS1.SSS4.p2.4.m1.1.1.3.3" xref="A1.SS1.SSS4.p2.4.m1.1.1.3.3.cmml"><mi id="A1.SS1.SSS4.p2.4.m1.1.1.3.3.2" xref="A1.SS1.SSS4.p2.4.m1.1.1.3.3.2.cmml">β</mi><mi id="A1.SS1.SSS4.p2.4.m1.1.1.3.3.3" xref="A1.SS1.SSS4.p2.4.m1.1.1.3.3.3.cmml">t</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS4.p2.4.m1.1b"><apply id="A1.SS1.SSS4.p2.4.m1.1.1.cmml" xref="A1.SS1.SSS4.p2.4.m1.1.1"><eq id="A1.SS1.SSS4.p2.4.m1.1.1.1.cmml" xref="A1.SS1.SSS4.p2.4.m1.1.1.1"></eq><apply id="A1.SS1.SSS4.p2.4.m1.1.1.2.cmml" xref="A1.SS1.SSS4.p2.4.m1.1.1.2"><csymbol cd="ambiguous" id="A1.SS1.SSS4.p2.4.m1.1.1.2.1.cmml" xref="A1.SS1.SSS4.p2.4.m1.1.1.2">subscript</csymbol><ci id="A1.SS1.SSS4.p2.4.m1.1.1.2.2.cmml" xref="A1.SS1.SSS4.p2.4.m1.1.1.2.2">𝛼</ci><ci id="A1.SS1.SSS4.p2.4.m1.1.1.2.3.cmml" xref="A1.SS1.SSS4.p2.4.m1.1.1.2.3">𝑡</ci></apply><apply id="A1.SS1.SSS4.p2.4.m1.1.1.3.cmml" xref="A1.SS1.SSS4.p2.4.m1.1.1.3"><minus id="A1.SS1.SSS4.p2.4.m1.1.1.3.1.cmml" xref="A1.SS1.SSS4.p2.4.m1.1.1.3.1"></minus><cn id="A1.SS1.SSS4.p2.4.m1.1.1.3.2.cmml" type="integer" xref="A1.SS1.SSS4.p2.4.m1.1.1.3.2">1</cn><apply id="A1.SS1.SSS4.p2.4.m1.1.1.3.3.cmml" xref="A1.SS1.SSS4.p2.4.m1.1.1.3.3"><csymbol cd="ambiguous" id="A1.SS1.SSS4.p2.4.m1.1.1.3.3.1.cmml" xref="A1.SS1.SSS4.p2.4.m1.1.1.3.3">subscript</csymbol><ci id="A1.SS1.SSS4.p2.4.m1.1.1.3.3.2.cmml" xref="A1.SS1.SSS4.p2.4.m1.1.1.3.3.2">𝛽</ci><ci id="A1.SS1.SSS4.p2.4.m1.1.1.3.3.3.cmml" xref="A1.SS1.SSS4.p2.4.m1.1.1.3.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS4.p2.4.m1.1c">\alpha_{t}=1-\beta_{t}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS4.p2.4.m1.1d">italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = 1 - italic_β start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\bar{\alpha_{t}}=\prod_{\tau=1}^{t}\alpha_{\tau}" class="ltx_Math" display="inline" id="A1.SS1.SSS4.p2.5.m2.1"><semantics id="A1.SS1.SSS4.p2.5.m2.1a"><mrow id="A1.SS1.SSS4.p2.5.m2.1.1" xref="A1.SS1.SSS4.p2.5.m2.1.1.cmml"><mover accent="true" id="A1.SS1.SSS4.p2.5.m2.1.1.2" xref="A1.SS1.SSS4.p2.5.m2.1.1.2.cmml"><msub id="A1.SS1.SSS4.p2.5.m2.1.1.2.2" xref="A1.SS1.SSS4.p2.5.m2.1.1.2.2.cmml"><mi id="A1.SS1.SSS4.p2.5.m2.1.1.2.2.2" xref="A1.SS1.SSS4.p2.5.m2.1.1.2.2.2.cmml">α</mi><mi id="A1.SS1.SSS4.p2.5.m2.1.1.2.2.3" xref="A1.SS1.SSS4.p2.5.m2.1.1.2.2.3.cmml">t</mi></msub><mo id="A1.SS1.SSS4.p2.5.m2.1.1.2.1" xref="A1.SS1.SSS4.p2.5.m2.1.1.2.1.cmml">¯</mo></mover><mo id="A1.SS1.SSS4.p2.5.m2.1.1.1" rspace="0.111em" xref="A1.SS1.SSS4.p2.5.m2.1.1.1.cmml">=</mo><mrow id="A1.SS1.SSS4.p2.5.m2.1.1.3" xref="A1.SS1.SSS4.p2.5.m2.1.1.3.cmml"><msubsup id="A1.SS1.SSS4.p2.5.m2.1.1.3.1" xref="A1.SS1.SSS4.p2.5.m2.1.1.3.1.cmml"><mo id="A1.SS1.SSS4.p2.5.m2.1.1.3.1.2.2" xref="A1.SS1.SSS4.p2.5.m2.1.1.3.1.2.2.cmml">∏</mo><mrow id="A1.SS1.SSS4.p2.5.m2.1.1.3.1.2.3" xref="A1.SS1.SSS4.p2.5.m2.1.1.3.1.2.3.cmml"><mi id="A1.SS1.SSS4.p2.5.m2.1.1.3.1.2.3.2" xref="A1.SS1.SSS4.p2.5.m2.1.1.3.1.2.3.2.cmml">τ</mi><mo id="A1.SS1.SSS4.p2.5.m2.1.1.3.1.2.3.1" xref="A1.SS1.SSS4.p2.5.m2.1.1.3.1.2.3.1.cmml">=</mo><mn id="A1.SS1.SSS4.p2.5.m2.1.1.3.1.2.3.3" xref="A1.SS1.SSS4.p2.5.m2.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="A1.SS1.SSS4.p2.5.m2.1.1.3.1.3" xref="A1.SS1.SSS4.p2.5.m2.1.1.3.1.3.cmml">t</mi></msubsup><msub id="A1.SS1.SSS4.p2.5.m2.1.1.3.2" xref="A1.SS1.SSS4.p2.5.m2.1.1.3.2.cmml"><mi id="A1.SS1.SSS4.p2.5.m2.1.1.3.2.2" xref="A1.SS1.SSS4.p2.5.m2.1.1.3.2.2.cmml">α</mi><mi id="A1.SS1.SSS4.p2.5.m2.1.1.3.2.3" xref="A1.SS1.SSS4.p2.5.m2.1.1.3.2.3.cmml">τ</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS4.p2.5.m2.1b"><apply id="A1.SS1.SSS4.p2.5.m2.1.1.cmml" xref="A1.SS1.SSS4.p2.5.m2.1.1"><eq id="A1.SS1.SSS4.p2.5.m2.1.1.1.cmml" xref="A1.SS1.SSS4.p2.5.m2.1.1.1"></eq><apply id="A1.SS1.SSS4.p2.5.m2.1.1.2.cmml" xref="A1.SS1.SSS4.p2.5.m2.1.1.2"><ci id="A1.SS1.SSS4.p2.5.m2.1.1.2.1.cmml" xref="A1.SS1.SSS4.p2.5.m2.1.1.2.1">¯</ci><apply id="A1.SS1.SSS4.p2.5.m2.1.1.2.2.cmml" xref="A1.SS1.SSS4.p2.5.m2.1.1.2.2"><csymbol cd="ambiguous" id="A1.SS1.SSS4.p2.5.m2.1.1.2.2.1.cmml" xref="A1.SS1.SSS4.p2.5.m2.1.1.2.2">subscript</csymbol><ci id="A1.SS1.SSS4.p2.5.m2.1.1.2.2.2.cmml" xref="A1.SS1.SSS4.p2.5.m2.1.1.2.2.2">𝛼</ci><ci id="A1.SS1.SSS4.p2.5.m2.1.1.2.2.3.cmml" xref="A1.SS1.SSS4.p2.5.m2.1.1.2.2.3">𝑡</ci></apply></apply><apply id="A1.SS1.SSS4.p2.5.m2.1.1.3.cmml" xref="A1.SS1.SSS4.p2.5.m2.1.1.3"><apply id="A1.SS1.SSS4.p2.5.m2.1.1.3.1.cmml" xref="A1.SS1.SSS4.p2.5.m2.1.1.3.1"><csymbol cd="ambiguous" id="A1.SS1.SSS4.p2.5.m2.1.1.3.1.1.cmml" xref="A1.SS1.SSS4.p2.5.m2.1.1.3.1">superscript</csymbol><apply id="A1.SS1.SSS4.p2.5.m2.1.1.3.1.2.cmml" xref="A1.SS1.SSS4.p2.5.m2.1.1.3.1"><csymbol cd="ambiguous" id="A1.SS1.SSS4.p2.5.m2.1.1.3.1.2.1.cmml" xref="A1.SS1.SSS4.p2.5.m2.1.1.3.1">subscript</csymbol><csymbol cd="latexml" id="A1.SS1.SSS4.p2.5.m2.1.1.3.1.2.2.cmml" xref="A1.SS1.SSS4.p2.5.m2.1.1.3.1.2.2">product</csymbol><apply id="A1.SS1.SSS4.p2.5.m2.1.1.3.1.2.3.cmml" xref="A1.SS1.SSS4.p2.5.m2.1.1.3.1.2.3"><eq id="A1.SS1.SSS4.p2.5.m2.1.1.3.1.2.3.1.cmml" xref="A1.SS1.SSS4.p2.5.m2.1.1.3.1.2.3.1"></eq><ci id="A1.SS1.SSS4.p2.5.m2.1.1.3.1.2.3.2.cmml" xref="A1.SS1.SSS4.p2.5.m2.1.1.3.1.2.3.2">𝜏</ci><cn id="A1.SS1.SSS4.p2.5.m2.1.1.3.1.2.3.3.cmml" type="integer" xref="A1.SS1.SSS4.p2.5.m2.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="A1.SS1.SSS4.p2.5.m2.1.1.3.1.3.cmml" xref="A1.SS1.SSS4.p2.5.m2.1.1.3.1.3">𝑡</ci></apply><apply id="A1.SS1.SSS4.p2.5.m2.1.1.3.2.cmml" xref="A1.SS1.SSS4.p2.5.m2.1.1.3.2"><csymbol cd="ambiguous" id="A1.SS1.SSS4.p2.5.m2.1.1.3.2.1.cmml" xref="A1.SS1.SSS4.p2.5.m2.1.1.3.2">subscript</csymbol><ci id="A1.SS1.SSS4.p2.5.m2.1.1.3.2.2.cmml" xref="A1.SS1.SSS4.p2.5.m2.1.1.3.2.2">𝛼</ci><ci id="A1.SS1.SSS4.p2.5.m2.1.1.3.2.3.cmml" xref="A1.SS1.SSS4.p2.5.m2.1.1.3.2.3">𝜏</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS4.p2.5.m2.1c">\bar{\alpha_{t}}=\prod_{\tau=1}^{t}\alpha_{\tau}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS4.p2.5.m2.1d">over¯ start_ARG italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG = ∏ start_POSTSUBSCRIPT italic_τ = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT italic_α start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT</annotation></semantics></math>.
This expression enables efficient one-step generation of <math alttext="\mathbf{x}_{t}" class="ltx_Math" display="inline" id="A1.SS1.SSS4.p2.6.m3.1"><semantics id="A1.SS1.SSS4.p2.6.m3.1a"><msub id="A1.SS1.SSS4.p2.6.m3.1.1" xref="A1.SS1.SSS4.p2.6.m3.1.1.cmml"><mi id="A1.SS1.SSS4.p2.6.m3.1.1.2" xref="A1.SS1.SSS4.p2.6.m3.1.1.2.cmml">𝐱</mi><mi id="A1.SS1.SSS4.p2.6.m3.1.1.3" xref="A1.SS1.SSS4.p2.6.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS4.p2.6.m3.1b"><apply id="A1.SS1.SSS4.p2.6.m3.1.1.cmml" xref="A1.SS1.SSS4.p2.6.m3.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS4.p2.6.m3.1.1.1.cmml" xref="A1.SS1.SSS4.p2.6.m3.1.1">subscript</csymbol><ci id="A1.SS1.SSS4.p2.6.m3.1.1.2.cmml" xref="A1.SS1.SSS4.p2.6.m3.1.1.2">𝐱</ci><ci id="A1.SS1.SSS4.p2.6.m3.1.1.3.cmml" xref="A1.SS1.SSS4.p2.6.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS4.p2.6.m3.1c">\mathbf{x}_{t}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS4.p2.6.m3.1d">bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> given <math alttext="\mathbf{x}_{0}" class="ltx_Math" display="inline" id="A1.SS1.SSS4.p2.7.m4.1"><semantics id="A1.SS1.SSS4.p2.7.m4.1a"><msub id="A1.SS1.SSS4.p2.7.m4.1.1" xref="A1.SS1.SSS4.p2.7.m4.1.1.cmml"><mi id="A1.SS1.SSS4.p2.7.m4.1.1.2" xref="A1.SS1.SSS4.p2.7.m4.1.1.2.cmml">𝐱</mi><mn id="A1.SS1.SSS4.p2.7.m4.1.1.3" xref="A1.SS1.SSS4.p2.7.m4.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS4.p2.7.m4.1b"><apply id="A1.SS1.SSS4.p2.7.m4.1.1.cmml" xref="A1.SS1.SSS4.p2.7.m4.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS4.p2.7.m4.1.1.1.cmml" xref="A1.SS1.SSS4.p2.7.m4.1.1">subscript</csymbol><ci id="A1.SS1.SSS4.p2.7.m4.1.1.2.cmml" xref="A1.SS1.SSS4.p2.7.m4.1.1.2">𝐱</ci><cn id="A1.SS1.SSS4.p2.7.m4.1.1.3.cmml" type="integer" xref="A1.SS1.SSS4.p2.7.m4.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS4.p2.7.m4.1c">\mathbf{x}_{0}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS4.p2.7.m4.1d">bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> at training time, while it requires <math alttext="t" class="ltx_Math" display="inline" id="A1.SS1.SSS4.p2.8.m5.1"><semantics id="A1.SS1.SSS4.p2.8.m5.1a"><mi id="A1.SS1.SSS4.p2.8.m5.1.1" xref="A1.SS1.SSS4.p2.8.m5.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS4.p2.8.m5.1b"><ci id="A1.SS1.SSS4.p2.8.m5.1.1.cmml" xref="A1.SS1.SSS4.p2.8.m5.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS4.p2.8.m5.1c">t</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS4.p2.8.m5.1d">italic_t</annotation></semantics></math> steps if we follow Eq. <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#A1.E6" title="In A.1.4 Diffusion fingerprint head ‣ A.1 Model architectures ‣ Appendix A Additional method details ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_tag">6</span></a>.
Intuitvely, <math alttext="1-\bar{\alpha_{t}}" class="ltx_Math" display="inline" id="A1.SS1.SSS4.p2.9.m6.1"><semantics id="A1.SS1.SSS4.p2.9.m6.1a"><mrow id="A1.SS1.SSS4.p2.9.m6.1.1" xref="A1.SS1.SSS4.p2.9.m6.1.1.cmml"><mn id="A1.SS1.SSS4.p2.9.m6.1.1.2" xref="A1.SS1.SSS4.p2.9.m6.1.1.2.cmml">1</mn><mo id="A1.SS1.SSS4.p2.9.m6.1.1.1" xref="A1.SS1.SSS4.p2.9.m6.1.1.1.cmml">−</mo><mover accent="true" id="A1.SS1.SSS4.p2.9.m6.1.1.3" xref="A1.SS1.SSS4.p2.9.m6.1.1.3.cmml"><msub id="A1.SS1.SSS4.p2.9.m6.1.1.3.2" xref="A1.SS1.SSS4.p2.9.m6.1.1.3.2.cmml"><mi id="A1.SS1.SSS4.p2.9.m6.1.1.3.2.2" xref="A1.SS1.SSS4.p2.9.m6.1.1.3.2.2.cmml">α</mi><mi id="A1.SS1.SSS4.p2.9.m6.1.1.3.2.3" xref="A1.SS1.SSS4.p2.9.m6.1.1.3.2.3.cmml">t</mi></msub><mo id="A1.SS1.SSS4.p2.9.m6.1.1.3.1" xref="A1.SS1.SSS4.p2.9.m6.1.1.3.1.cmml">¯</mo></mover></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS4.p2.9.m6.1b"><apply id="A1.SS1.SSS4.p2.9.m6.1.1.cmml" xref="A1.SS1.SSS4.p2.9.m6.1.1"><minus id="A1.SS1.SSS4.p2.9.m6.1.1.1.cmml" xref="A1.SS1.SSS4.p2.9.m6.1.1.1"></minus><cn id="A1.SS1.SSS4.p2.9.m6.1.1.2.cmml" type="integer" xref="A1.SS1.SSS4.p2.9.m6.1.1.2">1</cn><apply id="A1.SS1.SSS4.p2.9.m6.1.1.3.cmml" xref="A1.SS1.SSS4.p2.9.m6.1.1.3"><ci id="A1.SS1.SSS4.p2.9.m6.1.1.3.1.cmml" xref="A1.SS1.SSS4.p2.9.m6.1.1.3.1">¯</ci><apply id="A1.SS1.SSS4.p2.9.m6.1.1.3.2.cmml" xref="A1.SS1.SSS4.p2.9.m6.1.1.3.2"><csymbol cd="ambiguous" id="A1.SS1.SSS4.p2.9.m6.1.1.3.2.1.cmml" xref="A1.SS1.SSS4.p2.9.m6.1.1.3.2">subscript</csymbol><ci id="A1.SS1.SSS4.p2.9.m6.1.1.3.2.2.cmml" xref="A1.SS1.SSS4.p2.9.m6.1.1.3.2.2">𝛼</ci><ci id="A1.SS1.SSS4.p2.9.m6.1.1.3.2.3.cmml" xref="A1.SS1.SSS4.p2.9.m6.1.1.3.2.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS4.p2.9.m6.1c">1-\bar{\alpha_{t}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS4.p2.9.m6.1d">1 - over¯ start_ARG italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG</annotation></semantics></math> determines the chance of the fingerprint bit being resampled uniformly at timestep <math alttext="t" class="ltx_Math" display="inline" id="A1.SS1.SSS4.p2.10.m7.1"><semantics id="A1.SS1.SSS4.p2.10.m7.1a"><mi id="A1.SS1.SSS4.p2.10.m7.1.1" xref="A1.SS1.SSS4.p2.10.m7.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS4.p2.10.m7.1b"><ci id="A1.SS1.SSS4.p2.10.m7.1.1.cmml" xref="A1.SS1.SSS4.p2.10.m7.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS4.p2.10.m7.1c">t</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS4.p2.10.m7.1d">italic_t</annotation></semantics></math>, and it should increase monotonically from <math alttext="t=0" class="ltx_Math" display="inline" id="A1.SS1.SSS4.p2.11.m8.1"><semantics id="A1.SS1.SSS4.p2.11.m8.1a"><mrow id="A1.SS1.SSS4.p2.11.m8.1.1" xref="A1.SS1.SSS4.p2.11.m8.1.1.cmml"><mi id="A1.SS1.SSS4.p2.11.m8.1.1.2" xref="A1.SS1.SSS4.p2.11.m8.1.1.2.cmml">t</mi><mo id="A1.SS1.SSS4.p2.11.m8.1.1.1" xref="A1.SS1.SSS4.p2.11.m8.1.1.1.cmml">=</mo><mn id="A1.SS1.SSS4.p2.11.m8.1.1.3" xref="A1.SS1.SSS4.p2.11.m8.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS4.p2.11.m8.1b"><apply id="A1.SS1.SSS4.p2.11.m8.1.1.cmml" xref="A1.SS1.SSS4.p2.11.m8.1.1"><eq id="A1.SS1.SSS4.p2.11.m8.1.1.1.cmml" xref="A1.SS1.SSS4.p2.11.m8.1.1.1"></eq><ci id="A1.SS1.SSS4.p2.11.m8.1.1.2.cmml" xref="A1.SS1.SSS4.p2.11.m8.1.1.2">𝑡</ci><cn id="A1.SS1.SSS4.p2.11.m8.1.1.3.cmml" type="integer" xref="A1.SS1.SSS4.p2.11.m8.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS4.p2.11.m8.1c">t=0</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS4.p2.11.m8.1d">italic_t = 0</annotation></semantics></math> to <math alttext="T" class="ltx_Math" display="inline" id="A1.SS1.SSS4.p2.12.m9.1"><semantics id="A1.SS1.SSS4.p2.12.m9.1a"><mi id="A1.SS1.SSS4.p2.12.m9.1.1" xref="A1.SS1.SSS4.p2.12.m9.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS4.p2.12.m9.1b"><ci id="A1.SS1.SSS4.p2.12.m9.1.1.cmml" xref="A1.SS1.SSS4.p2.12.m9.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS4.p2.12.m9.1c">T</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS4.p2.12.m9.1d">italic_T</annotation></semantics></math>.
We adopt the noise schedule in terms of <math alttext="\bar{\alpha_{t}}" class="ltx_Math" display="inline" id="A1.SS1.SSS4.p2.13.m10.1"><semantics id="A1.SS1.SSS4.p2.13.m10.1a"><mover accent="true" id="A1.SS1.SSS4.p2.13.m10.1.1" xref="A1.SS1.SSS4.p2.13.m10.1.1.cmml"><msub id="A1.SS1.SSS4.p2.13.m10.1.1.2" xref="A1.SS1.SSS4.p2.13.m10.1.1.2.cmml"><mi id="A1.SS1.SSS4.p2.13.m10.1.1.2.2" xref="A1.SS1.SSS4.p2.13.m10.1.1.2.2.cmml">α</mi><mi id="A1.SS1.SSS4.p2.13.m10.1.1.2.3" xref="A1.SS1.SSS4.p2.13.m10.1.1.2.3.cmml">t</mi></msub><mo id="A1.SS1.SSS4.p2.13.m10.1.1.1" xref="A1.SS1.SSS4.p2.13.m10.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS4.p2.13.m10.1b"><apply id="A1.SS1.SSS4.p2.13.m10.1.1.cmml" xref="A1.SS1.SSS4.p2.13.m10.1.1"><ci id="A1.SS1.SSS4.p2.13.m10.1.1.1.cmml" xref="A1.SS1.SSS4.p2.13.m10.1.1.1">¯</ci><apply id="A1.SS1.SSS4.p2.13.m10.1.1.2.cmml" xref="A1.SS1.SSS4.p2.13.m10.1.1.2"><csymbol cd="ambiguous" id="A1.SS1.SSS4.p2.13.m10.1.1.2.1.cmml" xref="A1.SS1.SSS4.p2.13.m10.1.1.2">subscript</csymbol><ci id="A1.SS1.SSS4.p2.13.m10.1.1.2.2.cmml" xref="A1.SS1.SSS4.p2.13.m10.1.1.2.2">𝛼</ci><ci id="A1.SS1.SSS4.p2.13.m10.1.1.2.3.cmml" xref="A1.SS1.SSS4.p2.13.m10.1.1.2.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS4.p2.13.m10.1c">\bar{\alpha_{t}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS4.p2.13.m10.1d">over¯ start_ARG italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG</annotation></semantics></math> proposed by Nichol and Dhariwal <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib114" title="">114</a>]</cite>:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\bar{\alpha_{t}}=\frac{f(t)}{f(0)},\ f(t)=\cos\left(\frac{\frac{t}{T}+s}{1+s}%
\cdot\frac{\pi}{2}\right)^{2}." class="ltx_math_unparsed" display="block" id="A1.E8.m1.4"><semantics id="A1.E8.m1.4a"><mrow id="A1.E8.m1.4b"><mover accent="true" id="A1.E8.m1.4.5"><msub id="A1.E8.m1.4.5.2"><mi id="A1.E8.m1.4.5.2.2">α</mi><mi id="A1.E8.m1.4.5.2.3">t</mi></msub><mo id="A1.E8.m1.4.5.1">¯</mo></mover><mo id="A1.E8.m1.4.6">=</mo><mfrac id="A1.E8.m1.2.2"><mrow id="A1.E8.m1.1.1.1"><mi id="A1.E8.m1.1.1.1.3">f</mi><mo id="A1.E8.m1.1.1.1.2">⁢</mo><mrow id="A1.E8.m1.1.1.1.4.2"><mo id="A1.E8.m1.1.1.1.4.2.1" stretchy="false">(</mo><mi id="A1.E8.m1.1.1.1.1">t</mi><mo id="A1.E8.m1.1.1.1.4.2.2" stretchy="false">)</mo></mrow></mrow><mrow id="A1.E8.m1.2.2.2"><mi id="A1.E8.m1.2.2.2.3">f</mi><mo id="A1.E8.m1.2.2.2.2">⁢</mo><mrow id="A1.E8.m1.2.2.2.4.2"><mo id="A1.E8.m1.2.2.2.4.2.1" stretchy="false">(</mo><mn id="A1.E8.m1.2.2.2.1">0</mn><mo id="A1.E8.m1.2.2.2.4.2.2" stretchy="false">)</mo></mrow></mrow></mfrac><mo id="A1.E8.m1.4.7" rspace="0.667em">,</mo><mi id="A1.E8.m1.4.8">f</mi><mrow id="A1.E8.m1.4.9"><mo id="A1.E8.m1.4.9.1" stretchy="false">(</mo><mi id="A1.E8.m1.3.3">t</mi><mo id="A1.E8.m1.4.9.2" stretchy="false">)</mo></mrow><mo id="A1.E8.m1.4.10">=</mo><mi id="A1.E8.m1.4.4">cos</mi><msup id="A1.E8.m1.4.11"><mrow id="A1.E8.m1.4.11.2"><mo id="A1.E8.m1.4.11.2.1">(</mo><mfrac id="A1.E8.m1.4.11.2.2"><mrow id="A1.E8.m1.4.11.2.2.2"><mfrac id="A1.E8.m1.4.11.2.2.2.2"><mi id="A1.E8.m1.4.11.2.2.2.2.2">t</mi><mi id="A1.E8.m1.4.11.2.2.2.2.3">T</mi></mfrac><mo id="A1.E8.m1.4.11.2.2.2.1">+</mo><mi id="A1.E8.m1.4.11.2.2.2.3">s</mi></mrow><mrow id="A1.E8.m1.4.11.2.2.3"><mn id="A1.E8.m1.4.11.2.2.3.2">1</mn><mo id="A1.E8.m1.4.11.2.2.3.1">+</mo><mi id="A1.E8.m1.4.11.2.2.3.3">s</mi></mrow></mfrac><mo id="A1.E8.m1.4.11.2.3" lspace="0.222em" rspace="0.222em">⋅</mo><mfrac id="A1.E8.m1.4.11.2.4"><mi id="A1.E8.m1.4.11.2.4.2">π</mi><mn id="A1.E8.m1.4.11.2.4.3">2</mn></mfrac><mo id="A1.E8.m1.4.11.2.5">)</mo></mrow><mn id="A1.E8.m1.4.11.3">2</mn></msup><mo id="A1.E8.m1.4.12" lspace="0em">.</mo></mrow><annotation encoding="application/x-tex" id="A1.E8.m1.4c">\bar{\alpha_{t}}=\frac{f(t)}{f(0)},\ f(t)=\cos\left(\frac{\frac{t}{T}+s}{1+s}%
\cdot\frac{\pi}{2}\right)^{2}.</annotation><annotation encoding="application/x-llamapun" id="A1.E8.m1.4d">over¯ start_ARG italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG = divide start_ARG italic_f ( italic_t ) end_ARG start_ARG italic_f ( 0 ) end_ARG , italic_f ( italic_t ) = roman_cos ( divide start_ARG divide start_ARG italic_t end_ARG start_ARG italic_T end_ARG + italic_s end_ARG start_ARG 1 + italic_s end_ARG ⋅ divide start_ARG italic_π end_ARG start_ARG 2 end_ARG ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS1.SSS4.p2.18">From this definition, <math alttext="\beta_{t}" class="ltx_Math" display="inline" id="A1.SS1.SSS4.p2.14.m1.1"><semantics id="A1.SS1.SSS4.p2.14.m1.1a"><msub id="A1.SS1.SSS4.p2.14.m1.1.1" xref="A1.SS1.SSS4.p2.14.m1.1.1.cmml"><mi id="A1.SS1.SSS4.p2.14.m1.1.1.2" xref="A1.SS1.SSS4.p2.14.m1.1.1.2.cmml">β</mi><mi id="A1.SS1.SSS4.p2.14.m1.1.1.3" xref="A1.SS1.SSS4.p2.14.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS4.p2.14.m1.1b"><apply id="A1.SS1.SSS4.p2.14.m1.1.1.cmml" xref="A1.SS1.SSS4.p2.14.m1.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS4.p2.14.m1.1.1.1.cmml" xref="A1.SS1.SSS4.p2.14.m1.1.1">subscript</csymbol><ci id="A1.SS1.SSS4.p2.14.m1.1.1.2.cmml" xref="A1.SS1.SSS4.p2.14.m1.1.1.2">𝛽</ci><ci id="A1.SS1.SSS4.p2.14.m1.1.1.3.cmml" xref="A1.SS1.SSS4.p2.14.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS4.p2.14.m1.1c">\beta_{t}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS4.p2.14.m1.1d">italic_β start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\alpha_{t}" class="ltx_Math" display="inline" id="A1.SS1.SSS4.p2.15.m2.1"><semantics id="A1.SS1.SSS4.p2.15.m2.1a"><msub id="A1.SS1.SSS4.p2.15.m2.1.1" xref="A1.SS1.SSS4.p2.15.m2.1.1.cmml"><mi id="A1.SS1.SSS4.p2.15.m2.1.1.2" xref="A1.SS1.SSS4.p2.15.m2.1.1.2.cmml">α</mi><mi id="A1.SS1.SSS4.p2.15.m2.1.1.3" xref="A1.SS1.SSS4.p2.15.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS4.p2.15.m2.1b"><apply id="A1.SS1.SSS4.p2.15.m2.1.1.cmml" xref="A1.SS1.SSS4.p2.15.m2.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS4.p2.15.m2.1.1.1.cmml" xref="A1.SS1.SSS4.p2.15.m2.1.1">subscript</csymbol><ci id="A1.SS1.SSS4.p2.15.m2.1.1.2.cmml" xref="A1.SS1.SSS4.p2.15.m2.1.1.2">𝛼</ci><ci id="A1.SS1.SSS4.p2.15.m2.1.1.3.cmml" xref="A1.SS1.SSS4.p2.15.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS4.p2.15.m2.1c">\alpha_{t}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS4.p2.15.m2.1d">italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> can be obtained by <math alttext="\beta_{t}=1-\frac{\bar{\alpha_{t}}}{\bar{\alpha_{t-1}}}" class="ltx_Math" display="inline" id="A1.SS1.SSS4.p2.16.m3.1"><semantics id="A1.SS1.SSS4.p2.16.m3.1a"><mrow id="A1.SS1.SSS4.p2.16.m3.1.1" xref="A1.SS1.SSS4.p2.16.m3.1.1.cmml"><msub id="A1.SS1.SSS4.p2.16.m3.1.1.2" xref="A1.SS1.SSS4.p2.16.m3.1.1.2.cmml"><mi id="A1.SS1.SSS4.p2.16.m3.1.1.2.2" xref="A1.SS1.SSS4.p2.16.m3.1.1.2.2.cmml">β</mi><mi id="A1.SS1.SSS4.p2.16.m3.1.1.2.3" xref="A1.SS1.SSS4.p2.16.m3.1.1.2.3.cmml">t</mi></msub><mo id="A1.SS1.SSS4.p2.16.m3.1.1.1" xref="A1.SS1.SSS4.p2.16.m3.1.1.1.cmml">=</mo><mrow id="A1.SS1.SSS4.p2.16.m3.1.1.3" xref="A1.SS1.SSS4.p2.16.m3.1.1.3.cmml"><mn id="A1.SS1.SSS4.p2.16.m3.1.1.3.2" xref="A1.SS1.SSS4.p2.16.m3.1.1.3.2.cmml">1</mn><mo id="A1.SS1.SSS4.p2.16.m3.1.1.3.1" xref="A1.SS1.SSS4.p2.16.m3.1.1.3.1.cmml">−</mo><mfrac id="A1.SS1.SSS4.p2.16.m3.1.1.3.3" xref="A1.SS1.SSS4.p2.16.m3.1.1.3.3.cmml"><mover accent="true" id="A1.SS1.SSS4.p2.16.m3.1.1.3.3.2" xref="A1.SS1.SSS4.p2.16.m3.1.1.3.3.2.cmml"><msub id="A1.SS1.SSS4.p2.16.m3.1.1.3.3.2.2" xref="A1.SS1.SSS4.p2.16.m3.1.1.3.3.2.2.cmml"><mi id="A1.SS1.SSS4.p2.16.m3.1.1.3.3.2.2.2" xref="A1.SS1.SSS4.p2.16.m3.1.1.3.3.2.2.2.cmml">α</mi><mi id="A1.SS1.SSS4.p2.16.m3.1.1.3.3.2.2.3" xref="A1.SS1.SSS4.p2.16.m3.1.1.3.3.2.2.3.cmml">t</mi></msub><mo id="A1.SS1.SSS4.p2.16.m3.1.1.3.3.2.1" xref="A1.SS1.SSS4.p2.16.m3.1.1.3.3.2.1.cmml">¯</mo></mover><mover accent="true" id="A1.SS1.SSS4.p2.16.m3.1.1.3.3.3" xref="A1.SS1.SSS4.p2.16.m3.1.1.3.3.3.cmml"><msub id="A1.SS1.SSS4.p2.16.m3.1.1.3.3.3.2" xref="A1.SS1.SSS4.p2.16.m3.1.1.3.3.3.2.cmml"><mi id="A1.SS1.SSS4.p2.16.m3.1.1.3.3.3.2.2" xref="A1.SS1.SSS4.p2.16.m3.1.1.3.3.3.2.2.cmml">α</mi><mrow id="A1.SS1.SSS4.p2.16.m3.1.1.3.3.3.2.3" xref="A1.SS1.SSS4.p2.16.m3.1.1.3.3.3.2.3.cmml"><mi id="A1.SS1.SSS4.p2.16.m3.1.1.3.3.3.2.3.2" xref="A1.SS1.SSS4.p2.16.m3.1.1.3.3.3.2.3.2.cmml">t</mi><mo id="A1.SS1.SSS4.p2.16.m3.1.1.3.3.3.2.3.1" xref="A1.SS1.SSS4.p2.16.m3.1.1.3.3.3.2.3.1.cmml">−</mo><mn id="A1.SS1.SSS4.p2.16.m3.1.1.3.3.3.2.3.3" xref="A1.SS1.SSS4.p2.16.m3.1.1.3.3.3.2.3.3.cmml">1</mn></mrow></msub><mo id="A1.SS1.SSS4.p2.16.m3.1.1.3.3.3.1" xref="A1.SS1.SSS4.p2.16.m3.1.1.3.3.3.1.cmml">¯</mo></mover></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS4.p2.16.m3.1b"><apply id="A1.SS1.SSS4.p2.16.m3.1.1.cmml" xref="A1.SS1.SSS4.p2.16.m3.1.1"><eq id="A1.SS1.SSS4.p2.16.m3.1.1.1.cmml" xref="A1.SS1.SSS4.p2.16.m3.1.1.1"></eq><apply id="A1.SS1.SSS4.p2.16.m3.1.1.2.cmml" xref="A1.SS1.SSS4.p2.16.m3.1.1.2"><csymbol cd="ambiguous" id="A1.SS1.SSS4.p2.16.m3.1.1.2.1.cmml" xref="A1.SS1.SSS4.p2.16.m3.1.1.2">subscript</csymbol><ci id="A1.SS1.SSS4.p2.16.m3.1.1.2.2.cmml" xref="A1.SS1.SSS4.p2.16.m3.1.1.2.2">𝛽</ci><ci id="A1.SS1.SSS4.p2.16.m3.1.1.2.3.cmml" xref="A1.SS1.SSS4.p2.16.m3.1.1.2.3">𝑡</ci></apply><apply id="A1.SS1.SSS4.p2.16.m3.1.1.3.cmml" xref="A1.SS1.SSS4.p2.16.m3.1.1.3"><minus id="A1.SS1.SSS4.p2.16.m3.1.1.3.1.cmml" xref="A1.SS1.SSS4.p2.16.m3.1.1.3.1"></minus><cn id="A1.SS1.SSS4.p2.16.m3.1.1.3.2.cmml" type="integer" xref="A1.SS1.SSS4.p2.16.m3.1.1.3.2">1</cn><apply id="A1.SS1.SSS4.p2.16.m3.1.1.3.3.cmml" xref="A1.SS1.SSS4.p2.16.m3.1.1.3.3"><divide id="A1.SS1.SSS4.p2.16.m3.1.1.3.3.1.cmml" xref="A1.SS1.SSS4.p2.16.m3.1.1.3.3"></divide><apply id="A1.SS1.SSS4.p2.16.m3.1.1.3.3.2.cmml" xref="A1.SS1.SSS4.p2.16.m3.1.1.3.3.2"><ci id="A1.SS1.SSS4.p2.16.m3.1.1.3.3.2.1.cmml" xref="A1.SS1.SSS4.p2.16.m3.1.1.3.3.2.1">¯</ci><apply id="A1.SS1.SSS4.p2.16.m3.1.1.3.3.2.2.cmml" xref="A1.SS1.SSS4.p2.16.m3.1.1.3.3.2.2"><csymbol cd="ambiguous" id="A1.SS1.SSS4.p2.16.m3.1.1.3.3.2.2.1.cmml" xref="A1.SS1.SSS4.p2.16.m3.1.1.3.3.2.2">subscript</csymbol><ci id="A1.SS1.SSS4.p2.16.m3.1.1.3.3.2.2.2.cmml" xref="A1.SS1.SSS4.p2.16.m3.1.1.3.3.2.2.2">𝛼</ci><ci id="A1.SS1.SSS4.p2.16.m3.1.1.3.3.2.2.3.cmml" xref="A1.SS1.SSS4.p2.16.m3.1.1.3.3.2.2.3">𝑡</ci></apply></apply><apply id="A1.SS1.SSS4.p2.16.m3.1.1.3.3.3.cmml" xref="A1.SS1.SSS4.p2.16.m3.1.1.3.3.3"><ci id="A1.SS1.SSS4.p2.16.m3.1.1.3.3.3.1.cmml" xref="A1.SS1.SSS4.p2.16.m3.1.1.3.3.3.1">¯</ci><apply id="A1.SS1.SSS4.p2.16.m3.1.1.3.3.3.2.cmml" xref="A1.SS1.SSS4.p2.16.m3.1.1.3.3.3.2"><csymbol cd="ambiguous" id="A1.SS1.SSS4.p2.16.m3.1.1.3.3.3.2.1.cmml" xref="A1.SS1.SSS4.p2.16.m3.1.1.3.3.3.2">subscript</csymbol><ci id="A1.SS1.SSS4.p2.16.m3.1.1.3.3.3.2.2.cmml" xref="A1.SS1.SSS4.p2.16.m3.1.1.3.3.3.2.2">𝛼</ci><apply id="A1.SS1.SSS4.p2.16.m3.1.1.3.3.3.2.3.cmml" xref="A1.SS1.SSS4.p2.16.m3.1.1.3.3.3.2.3"><minus id="A1.SS1.SSS4.p2.16.m3.1.1.3.3.3.2.3.1.cmml" xref="A1.SS1.SSS4.p2.16.m3.1.1.3.3.3.2.3.1"></minus><ci id="A1.SS1.SSS4.p2.16.m3.1.1.3.3.3.2.3.2.cmml" xref="A1.SS1.SSS4.p2.16.m3.1.1.3.3.3.2.3.2">𝑡</ci><cn id="A1.SS1.SSS4.p2.16.m3.1.1.3.3.3.2.3.3.cmml" type="integer" xref="A1.SS1.SSS4.p2.16.m3.1.1.3.3.3.2.3.3">1</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS4.p2.16.m3.1c">\beta_{t}=1-\frac{\bar{\alpha_{t}}}{\bar{\alpha_{t-1}}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS4.p2.16.m3.1d">italic_β start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = 1 - divide start_ARG over¯ start_ARG italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG end_ARG start_ARG over¯ start_ARG italic_α start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT end_ARG end_ARG</annotation></semantics></math> and <math alttext="\alpha_{t}=1-\beta_{t}" class="ltx_Math" display="inline" id="A1.SS1.SSS4.p2.17.m4.1"><semantics id="A1.SS1.SSS4.p2.17.m4.1a"><mrow id="A1.SS1.SSS4.p2.17.m4.1.1" xref="A1.SS1.SSS4.p2.17.m4.1.1.cmml"><msub id="A1.SS1.SSS4.p2.17.m4.1.1.2" xref="A1.SS1.SSS4.p2.17.m4.1.1.2.cmml"><mi id="A1.SS1.SSS4.p2.17.m4.1.1.2.2" xref="A1.SS1.SSS4.p2.17.m4.1.1.2.2.cmml">α</mi><mi id="A1.SS1.SSS4.p2.17.m4.1.1.2.3" xref="A1.SS1.SSS4.p2.17.m4.1.1.2.3.cmml">t</mi></msub><mo id="A1.SS1.SSS4.p2.17.m4.1.1.1" xref="A1.SS1.SSS4.p2.17.m4.1.1.1.cmml">=</mo><mrow id="A1.SS1.SSS4.p2.17.m4.1.1.3" xref="A1.SS1.SSS4.p2.17.m4.1.1.3.cmml"><mn id="A1.SS1.SSS4.p2.17.m4.1.1.3.2" xref="A1.SS1.SSS4.p2.17.m4.1.1.3.2.cmml">1</mn><mo id="A1.SS1.SSS4.p2.17.m4.1.1.3.1" xref="A1.SS1.SSS4.p2.17.m4.1.1.3.1.cmml">−</mo><msub id="A1.SS1.SSS4.p2.17.m4.1.1.3.3" xref="A1.SS1.SSS4.p2.17.m4.1.1.3.3.cmml"><mi id="A1.SS1.SSS4.p2.17.m4.1.1.3.3.2" xref="A1.SS1.SSS4.p2.17.m4.1.1.3.3.2.cmml">β</mi><mi id="A1.SS1.SSS4.p2.17.m4.1.1.3.3.3" xref="A1.SS1.SSS4.p2.17.m4.1.1.3.3.3.cmml">t</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS4.p2.17.m4.1b"><apply id="A1.SS1.SSS4.p2.17.m4.1.1.cmml" xref="A1.SS1.SSS4.p2.17.m4.1.1"><eq id="A1.SS1.SSS4.p2.17.m4.1.1.1.cmml" xref="A1.SS1.SSS4.p2.17.m4.1.1.1"></eq><apply id="A1.SS1.SSS4.p2.17.m4.1.1.2.cmml" xref="A1.SS1.SSS4.p2.17.m4.1.1.2"><csymbol cd="ambiguous" id="A1.SS1.SSS4.p2.17.m4.1.1.2.1.cmml" xref="A1.SS1.SSS4.p2.17.m4.1.1.2">subscript</csymbol><ci id="A1.SS1.SSS4.p2.17.m4.1.1.2.2.cmml" xref="A1.SS1.SSS4.p2.17.m4.1.1.2.2">𝛼</ci><ci id="A1.SS1.SSS4.p2.17.m4.1.1.2.3.cmml" xref="A1.SS1.SSS4.p2.17.m4.1.1.2.3">𝑡</ci></apply><apply id="A1.SS1.SSS4.p2.17.m4.1.1.3.cmml" xref="A1.SS1.SSS4.p2.17.m4.1.1.3"><minus id="A1.SS1.SSS4.p2.17.m4.1.1.3.1.cmml" xref="A1.SS1.SSS4.p2.17.m4.1.1.3.1"></minus><cn id="A1.SS1.SSS4.p2.17.m4.1.1.3.2.cmml" type="integer" xref="A1.SS1.SSS4.p2.17.m4.1.1.3.2">1</cn><apply id="A1.SS1.SSS4.p2.17.m4.1.1.3.3.cmml" xref="A1.SS1.SSS4.p2.17.m4.1.1.3.3"><csymbol cd="ambiguous" id="A1.SS1.SSS4.p2.17.m4.1.1.3.3.1.cmml" xref="A1.SS1.SSS4.p2.17.m4.1.1.3.3">subscript</csymbol><ci id="A1.SS1.SSS4.p2.17.m4.1.1.3.3.2.cmml" xref="A1.SS1.SSS4.p2.17.m4.1.1.3.3.2">𝛽</ci><ci id="A1.SS1.SSS4.p2.17.m4.1.1.3.3.3.cmml" xref="A1.SS1.SSS4.p2.17.m4.1.1.3.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS4.p2.17.m4.1c">\alpha_{t}=1-\beta_{t}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS4.p2.17.m4.1d">italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = 1 - italic_β start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> respectively. In practice, <math alttext="\beta_{t}" class="ltx_Math" display="inline" id="A1.SS1.SSS4.p2.18.m5.1"><semantics id="A1.SS1.SSS4.p2.18.m5.1a"><msub id="A1.SS1.SSS4.p2.18.m5.1.1" xref="A1.SS1.SSS4.p2.18.m5.1.1.cmml"><mi id="A1.SS1.SSS4.p2.18.m5.1.1.2" xref="A1.SS1.SSS4.p2.18.m5.1.1.2.cmml">β</mi><mi id="A1.SS1.SSS4.p2.18.m5.1.1.3" xref="A1.SS1.SSS4.p2.18.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS4.p2.18.m5.1b"><apply id="A1.SS1.SSS4.p2.18.m5.1.1.cmml" xref="A1.SS1.SSS4.p2.18.m5.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS4.p2.18.m5.1.1.1.cmml" xref="A1.SS1.SSS4.p2.18.m5.1.1">subscript</csymbol><ci id="A1.SS1.SSS4.p2.18.m5.1.1.2.cmml" xref="A1.SS1.SSS4.p2.18.m5.1.1.2">𝛽</ci><ci id="A1.SS1.SSS4.p2.18.m5.1.1.3.cmml" xref="A1.SS1.SSS4.p2.18.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS4.p2.18.m5.1c">\beta_{t}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS4.p2.18.m5.1d">italic_β start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is clipped to be no larger than 0.999 to prevent instability.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS1.SSS4.p3">
<p class="ltx_p" id="A1.SS1.SSS4.p3.3">To denoise a noisy fingerprint <math alttext="\mathbf{x}_{t}" class="ltx_Math" display="inline" id="A1.SS1.SSS4.p3.1.m1.1"><semantics id="A1.SS1.SSS4.p3.1.m1.1a"><msub id="A1.SS1.SSS4.p3.1.m1.1.1" xref="A1.SS1.SSS4.p3.1.m1.1.1.cmml"><mi id="A1.SS1.SSS4.p3.1.m1.1.1.2" xref="A1.SS1.SSS4.p3.1.m1.1.1.2.cmml">𝐱</mi><mi id="A1.SS1.SSS4.p3.1.m1.1.1.3" xref="A1.SS1.SSS4.p3.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS4.p3.1.m1.1b"><apply id="A1.SS1.SSS4.p3.1.m1.1.1.cmml" xref="A1.SS1.SSS4.p3.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS4.p3.1.m1.1.1.1.cmml" xref="A1.SS1.SSS4.p3.1.m1.1.1">subscript</csymbol><ci id="A1.SS1.SSS4.p3.1.m1.1.1.2.cmml" xref="A1.SS1.SSS4.p3.1.m1.1.1.2">𝐱</ci><ci id="A1.SS1.SSS4.p3.1.m1.1.1.3.cmml" xref="A1.SS1.SSS4.p3.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS4.p3.1.m1.1c">\mathbf{x}_{t}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS4.p3.1.m1.1d">bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> into the less noisy <math alttext="\mathbf{x}_{t-1}" class="ltx_Math" display="inline" id="A1.SS1.SSS4.p3.2.m2.1"><semantics id="A1.SS1.SSS4.p3.2.m2.1a"><msub id="A1.SS1.SSS4.p3.2.m2.1.1" xref="A1.SS1.SSS4.p3.2.m2.1.1.cmml"><mi id="A1.SS1.SSS4.p3.2.m2.1.1.2" xref="A1.SS1.SSS4.p3.2.m2.1.1.2.cmml">𝐱</mi><mrow id="A1.SS1.SSS4.p3.2.m2.1.1.3" xref="A1.SS1.SSS4.p3.2.m2.1.1.3.cmml"><mi id="A1.SS1.SSS4.p3.2.m2.1.1.3.2" xref="A1.SS1.SSS4.p3.2.m2.1.1.3.2.cmml">t</mi><mo id="A1.SS1.SSS4.p3.2.m2.1.1.3.1" xref="A1.SS1.SSS4.p3.2.m2.1.1.3.1.cmml">−</mo><mn id="A1.SS1.SSS4.p3.2.m2.1.1.3.3" xref="A1.SS1.SSS4.p3.2.m2.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS4.p3.2.m2.1b"><apply id="A1.SS1.SSS4.p3.2.m2.1.1.cmml" xref="A1.SS1.SSS4.p3.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS4.p3.2.m2.1.1.1.cmml" xref="A1.SS1.SSS4.p3.2.m2.1.1">subscript</csymbol><ci id="A1.SS1.SSS4.p3.2.m2.1.1.2.cmml" xref="A1.SS1.SSS4.p3.2.m2.1.1.2">𝐱</ci><apply id="A1.SS1.SSS4.p3.2.m2.1.1.3.cmml" xref="A1.SS1.SSS4.p3.2.m2.1.1.3"><minus id="A1.SS1.SSS4.p3.2.m2.1.1.3.1.cmml" xref="A1.SS1.SSS4.p3.2.m2.1.1.3.1"></minus><ci id="A1.SS1.SSS4.p3.2.m2.1.1.3.2.cmml" xref="A1.SS1.SSS4.p3.2.m2.1.1.3.2">𝑡</ci><cn id="A1.SS1.SSS4.p3.2.m2.1.1.3.3.cmml" type="integer" xref="A1.SS1.SSS4.p3.2.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS4.p3.2.m2.1c">\mathbf{x}_{t-1}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS4.p3.2.m2.1d">bold_x start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT</annotation></semantics></math> which eventually leads to <math alttext="\mathbf{x}_{0}" class="ltx_Math" display="inline" id="A1.SS1.SSS4.p3.3.m3.1"><semantics id="A1.SS1.SSS4.p3.3.m3.1a"><msub id="A1.SS1.SSS4.p3.3.m3.1.1" xref="A1.SS1.SSS4.p3.3.m3.1.1.cmml"><mi id="A1.SS1.SSS4.p3.3.m3.1.1.2" xref="A1.SS1.SSS4.p3.3.m3.1.1.2.cmml">𝐱</mi><mn id="A1.SS1.SSS4.p3.3.m3.1.1.3" xref="A1.SS1.SSS4.p3.3.m3.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS4.p3.3.m3.1b"><apply id="A1.SS1.SSS4.p3.3.m3.1.1.cmml" xref="A1.SS1.SSS4.p3.3.m3.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS4.p3.3.m3.1.1.1.cmml" xref="A1.SS1.SSS4.p3.3.m3.1.1">subscript</csymbol><ci id="A1.SS1.SSS4.p3.3.m3.1.1.2.cmml" xref="A1.SS1.SSS4.p3.3.m3.1.1.2">𝐱</ci><cn id="A1.SS1.SSS4.p3.3.m3.1.1.3.cmml" type="integer" xref="A1.SS1.SSS4.p3.3.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS4.p3.3.m3.1c">\mathbf{x}_{0}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS4.p3.3.m3.1d">bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>, the denoiser network should learn the following posterior distribution derived from Eq.<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#A1.E6" title="In A.1.4 Diffusion fingerprint head ‣ A.1 Model architectures ‣ Appendix A Additional method details ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_tag">6</span></a> and Eq.<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#A1.E7" title="In A.1.4 Diffusion fingerprint head ‣ A.1 Model architectures ‣ Appendix A Additional method details ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_tag">7</span></a>:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="q(\mathbf{x}_{t-1}|\mathbf{x}_{t},\mathbf{x}_{0})=\prod_{j=1}^{n}q(x_{t-1}^{(j%
)}|x_{t}^{(j)},x_{0}^{(j)})\quad\text{where}\quad q(x_{t-1}^{(j)}|x_{t}^{(j)},%
x_{0}^{(j)})=\operatorname{Bernoulli}\left(x_{t-1}^{(j)}\middle|\frac{\theta_{%
1}(x_{t}^{(j)},x_{0}^{(j)})}{\theta_{1}(x_{t}^{(j)},x_{0}^{(j)})+\theta_{0}(x_%
{t}^{(j)},x_{0}^{(j)})}\right)," class="ltx_Math" display="block" id="A1.E9.m1.22"><semantics id="A1.E9.m1.22a"><mrow id="A1.E9.m1.22.22.1"><mrow id="A1.E9.m1.22.22.1.1.2" xref="A1.E9.m1.22.22.1.1.3.cmml"><mrow id="A1.E9.m1.22.22.1.1.1.1" xref="A1.E9.m1.22.22.1.1.1.1.cmml"><mrow id="A1.E9.m1.22.22.1.1.1.1.1" xref="A1.E9.m1.22.22.1.1.1.1.1.cmml"><mi id="A1.E9.m1.22.22.1.1.1.1.1.3" xref="A1.E9.m1.22.22.1.1.1.1.1.3.cmml">q</mi><mo id="A1.E9.m1.22.22.1.1.1.1.1.2" xref="A1.E9.m1.22.22.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E9.m1.22.22.1.1.1.1.1.1.1" xref="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E9.m1.22.22.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E9.m1.22.22.1.1.1.1.1.1.1.1" xref="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.cmml"><msub id="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.4" xref="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.4.cmml"><mi id="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.4.2" xref="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.4.2.cmml">𝐱</mi><mrow id="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.4.3" xref="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.4.3.cmml"><mi id="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.4.3.2" xref="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.4.3.2.cmml">t</mi><mo id="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.4.3.1" xref="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.4.3.1.cmml">−</mo><mn id="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.4.3.3" xref="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.4.3.3.cmml">1</mn></mrow></msub><mo fence="false" id="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.3" xref="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.3.cmml">|</mo><mrow id="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.2.2" xref="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.2.3.cmml"><msub id="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.1.1.1.2" xref="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.2.2.3" xref="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.2.2.2" xref="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.2.2.2.2" xref="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.2.2.2.2.cmml">𝐱</mi><mn id="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.2.2.2.3" xref="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.2.2.2.3.cmml">0</mn></msub></mrow></mrow><mo id="A1.E9.m1.22.22.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E9.m1.22.22.1.1.1.1.3" rspace="0.111em" xref="A1.E9.m1.22.22.1.1.1.1.3.cmml">=</mo><mrow id="A1.E9.m1.22.22.1.1.1.1.2.1" xref="A1.E9.m1.22.22.1.1.1.1.2.2.cmml"><mrow id="A1.E9.m1.22.22.1.1.1.1.2.1.1" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.cmml"><munderover id="A1.E9.m1.22.22.1.1.1.1.2.1.1.2" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.2.cmml"><mo id="A1.E9.m1.22.22.1.1.1.1.2.1.1.2.2.2" movablelimits="false" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.2.2.2.cmml">∏</mo><mrow id="A1.E9.m1.22.22.1.1.1.1.2.1.1.2.2.3" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.2.2.3.cmml"><mi id="A1.E9.m1.22.22.1.1.1.1.2.1.1.2.2.3.2" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.2.2.3.2.cmml">j</mi><mo id="A1.E9.m1.22.22.1.1.1.1.2.1.1.2.2.3.1" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.2.2.3.1.cmml">=</mo><mn id="A1.E9.m1.22.22.1.1.1.1.2.1.1.2.2.3.3" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="A1.E9.m1.22.22.1.1.1.1.2.1.1.2.3" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.2.3.cmml">n</mi></munderover><mrow id="A1.E9.m1.22.22.1.1.1.1.2.1.1.1" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.cmml"><mi id="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.3" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.3.cmml">q</mi><mo id="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.2" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.2.cmml">⁢</mo><mrow id="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.cmml"><mo id="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.2" stretchy="false" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.cmml"><msubsup id="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.4" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.4.cmml"><mi id="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.4.2.2" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.4.2.2.cmml">x</mi><mrow id="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.4.2.3" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.4.2.3.cmml"><mi id="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.4.2.3.2" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.4.2.3.2.cmml">t</mi><mo id="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.4.2.3.1" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.4.2.3.1.cmml">−</mo><mn id="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.4.2.3.3" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.4.2.3.3.cmml">1</mn></mrow><mrow id="A1.E9.m1.1.1.1.3" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.4.cmml"><mo id="A1.E9.m1.1.1.1.3.1" stretchy="false" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.4.cmml">(</mo><mi id="A1.E9.m1.1.1.1.1" xref="A1.E9.m1.1.1.1.1.cmml">j</mi><mo id="A1.E9.m1.1.1.1.3.2" stretchy="false" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.4.cmml">)</mo></mrow></msubsup><mo fence="false" id="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.3" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.3.cmml">|</mo><mrow id="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.2.2" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.2.3.cmml"><msubsup id="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.1.1.1" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.1.1.1.2.2" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.1.1.1.2.3" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.1.1.1.2.3.cmml">t</mi><mrow id="A1.E9.m1.2.2.1.3" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E9.m1.2.2.1.3.1" stretchy="false" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="A1.E9.m1.2.2.1.1" xref="A1.E9.m1.2.2.1.1.cmml">j</mi><mo id="A1.E9.m1.2.2.1.3.2" stretchy="false" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.2.2.3" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.2.3.cmml">,</mo><msubsup id="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.2.2.2" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.2.2.2.cmml"><mi id="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.2.2.2.2.2" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.2.2.2.2.2.cmml">x</mi><mn id="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.2.2.2.2.3" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.2.2.2.2.3.cmml">0</mn><mrow id="A1.E9.m1.3.3.1.3" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.2.2.2.cmml"><mo id="A1.E9.m1.3.3.1.3.1" stretchy="false" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.2.2.2.cmml">(</mo><mi id="A1.E9.m1.3.3.1.1" xref="A1.E9.m1.3.3.1.1.cmml">j</mi><mo id="A1.E9.m1.3.3.1.3.2" stretchy="false" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.2.2.2.cmml">)</mo></mrow></msubsup></mrow></mrow><mo id="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.3" stretchy="false" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mspace id="A1.E9.m1.22.22.1.1.1.1.2.1.2" width="1em" xref="A1.E9.m1.22.22.1.1.1.1.2.2.cmml"></mspace><mtext id="A1.E9.m1.21.21" xref="A1.E9.m1.21.21a.cmml">where</mtext></mrow></mrow><mspace id="A1.E9.m1.22.22.1.1.2.3" width="1em" xref="A1.E9.m1.22.22.1.1.3a.cmml"></mspace><mrow id="A1.E9.m1.22.22.1.1.2.2" xref="A1.E9.m1.22.22.1.1.2.2.cmml"><mrow id="A1.E9.m1.22.22.1.1.2.2.1" xref="A1.E9.m1.22.22.1.1.2.2.1.cmml"><mi id="A1.E9.m1.22.22.1.1.2.2.1.3" xref="A1.E9.m1.22.22.1.1.2.2.1.3.cmml">q</mi><mo id="A1.E9.m1.22.22.1.1.2.2.1.2" xref="A1.E9.m1.22.22.1.1.2.2.1.2.cmml">⁢</mo><mrow id="A1.E9.m1.22.22.1.1.2.2.1.1.1" xref="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.cmml"><mo id="A1.E9.m1.22.22.1.1.2.2.1.1.1.2" stretchy="false" xref="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.cmml">(</mo><mrow id="A1.E9.m1.22.22.1.1.2.2.1.1.1.1" xref="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.cmml"><msubsup id="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.4" xref="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.4.cmml"><mi id="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.4.2.2" xref="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.4.2.2.cmml">x</mi><mrow id="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.4.2.3" xref="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.4.2.3.cmml"><mi id="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.4.2.3.2" xref="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.4.2.3.2.cmml">t</mi><mo id="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.4.2.3.1" xref="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.4.2.3.1.cmml">−</mo><mn id="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.4.2.3.3" xref="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.4.2.3.3.cmml">1</mn></mrow><mrow id="A1.E9.m1.4.4.1.3" xref="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.4.cmml"><mo id="A1.E9.m1.4.4.1.3.1" stretchy="false" xref="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.4.cmml">(</mo><mi id="A1.E9.m1.4.4.1.1" xref="A1.E9.m1.4.4.1.1.cmml">j</mi><mo id="A1.E9.m1.4.4.1.3.2" stretchy="false" xref="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.4.cmml">)</mo></mrow></msubsup><mo fence="false" id="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.3" xref="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.3.cmml">|</mo><mrow id="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.2.2" xref="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.2.3.cmml"><msubsup id="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.1.1.1" xref="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.1.1.1.cmml"><mi id="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.1.1.1.2.2" xref="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.1.1.1.2.3" xref="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.1.1.1.2.3.cmml">t</mi><mrow id="A1.E9.m1.5.5.1.3" xref="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.1.1.1.cmml"><mo id="A1.E9.m1.5.5.1.3.1" stretchy="false" xref="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.1.1.1.cmml">(</mo><mi id="A1.E9.m1.5.5.1.1" xref="A1.E9.m1.5.5.1.1.cmml">j</mi><mo id="A1.E9.m1.5.5.1.3.2" stretchy="false" xref="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.2.2.3" xref="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.2.3.cmml">,</mo><msubsup id="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.2.2.2" xref="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.2.2.2.cmml"><mi id="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.2.2.2.2.2" xref="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.2.2.2.2.2.cmml">x</mi><mn id="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.2.2.2.2.3" xref="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.2.2.2.2.3.cmml">0</mn><mrow id="A1.E9.m1.6.6.1.3" xref="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.2.2.2.cmml"><mo id="A1.E9.m1.6.6.1.3.1" stretchy="false" xref="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.2.2.2.cmml">(</mo><mi id="A1.E9.m1.6.6.1.1" xref="A1.E9.m1.6.6.1.1.cmml">j</mi><mo id="A1.E9.m1.6.6.1.3.2" stretchy="false" xref="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.2.2.2.cmml">)</mo></mrow></msubsup></mrow></mrow><mo id="A1.E9.m1.22.22.1.1.2.2.1.1.1.3" stretchy="false" xref="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E9.m1.22.22.1.1.2.2.3" xref="A1.E9.m1.22.22.1.1.2.2.3.cmml">=</mo><mrow id="A1.E9.m1.22.22.1.1.2.2.2.1" xref="A1.E9.m1.22.22.1.1.2.2.2.2.cmml"><mi id="A1.E9.m1.20.20" xref="A1.E9.m1.20.20.cmml">Bernoulli</mi><mo id="A1.E9.m1.22.22.1.1.2.2.2.1a" xref="A1.E9.m1.22.22.1.1.2.2.2.2.cmml">⁡</mo><mrow id="A1.E9.m1.22.22.1.1.2.2.2.1.1" xref="A1.E9.m1.22.22.1.1.2.2.2.2.cmml"><mo id="A1.E9.m1.22.22.1.1.2.2.2.1.1.2" xref="A1.E9.m1.22.22.1.1.2.2.2.2.cmml">(</mo><msubsup id="A1.E9.m1.22.22.1.1.2.2.2.1.1.1" xref="A1.E9.m1.22.22.1.1.2.2.2.1.1.1.cmml"><mi id="A1.E9.m1.22.22.1.1.2.2.2.1.1.1.2.2" xref="A1.E9.m1.22.22.1.1.2.2.2.1.1.1.2.2.cmml">x</mi><mrow id="A1.E9.m1.22.22.1.1.2.2.2.1.1.1.2.3" xref="A1.E9.m1.22.22.1.1.2.2.2.1.1.1.2.3.cmml"><mi id="A1.E9.m1.22.22.1.1.2.2.2.1.1.1.2.3.2" xref="A1.E9.m1.22.22.1.1.2.2.2.1.1.1.2.3.2.cmml">t</mi><mo id="A1.E9.m1.22.22.1.1.2.2.2.1.1.1.2.3.1" xref="A1.E9.m1.22.22.1.1.2.2.2.1.1.1.2.3.1.cmml">−</mo><mn id="A1.E9.m1.22.22.1.1.2.2.2.1.1.1.2.3.3" xref="A1.E9.m1.22.22.1.1.2.2.2.1.1.1.2.3.3.cmml">1</mn></mrow><mrow id="A1.E9.m1.7.7.1.3" xref="A1.E9.m1.22.22.1.1.2.2.2.1.1.1.cmml"><mo id="A1.E9.m1.7.7.1.3.1" stretchy="false" xref="A1.E9.m1.22.22.1.1.2.2.2.1.1.1.cmml">(</mo><mi id="A1.E9.m1.7.7.1.1" xref="A1.E9.m1.7.7.1.1.cmml">j</mi><mo id="A1.E9.m1.7.7.1.3.2" stretchy="false" xref="A1.E9.m1.22.22.1.1.2.2.2.1.1.1.cmml">)</mo></mrow></msubsup><mo id="A1.E9.m1.22.22.1.1.2.2.2.1.1.3" lspace="0em" rspace="0em" stretchy="true" xref="A1.E9.m1.22.22.1.1.2.2.2.2.cmml">|</mo><mfrac id="A1.E9.m1.19.19" xref="A1.E9.m1.19.19.cmml"><mrow id="A1.E9.m1.11.11.4" xref="A1.E9.m1.11.11.4.cmml"><msub id="A1.E9.m1.11.11.4.6" xref="A1.E9.m1.11.11.4.6.cmml"><mi id="A1.E9.m1.11.11.4.6.2" xref="A1.E9.m1.11.11.4.6.2.cmml">θ</mi><mn id="A1.E9.m1.11.11.4.6.3" xref="A1.E9.m1.11.11.4.6.3.cmml">1</mn></msub><mo id="A1.E9.m1.11.11.4.5" xref="A1.E9.m1.11.11.4.5.cmml">⁢</mo><mrow id="A1.E9.m1.11.11.4.4.2" xref="A1.E9.m1.11.11.4.4.3.cmml"><mo id="A1.E9.m1.11.11.4.4.2.3" stretchy="false" xref="A1.E9.m1.11.11.4.4.3.cmml">(</mo><msubsup id="A1.E9.m1.10.10.3.3.1.1" xref="A1.E9.m1.10.10.3.3.1.1.cmml"><mi id="A1.E9.m1.10.10.3.3.1.1.2.2" xref="A1.E9.m1.10.10.3.3.1.1.2.2.cmml">x</mi><mi id="A1.E9.m1.10.10.3.3.1.1.2.3" xref="A1.E9.m1.10.10.3.3.1.1.2.3.cmml">t</mi><mrow id="A1.E9.m1.8.8.1.1.1.3" xref="A1.E9.m1.10.10.3.3.1.1.cmml"><mo id="A1.E9.m1.8.8.1.1.1.3.1" stretchy="false" xref="A1.E9.m1.10.10.3.3.1.1.cmml">(</mo><mi id="A1.E9.m1.8.8.1.1.1.1" xref="A1.E9.m1.8.8.1.1.1.1.cmml">j</mi><mo id="A1.E9.m1.8.8.1.1.1.3.2" stretchy="false" xref="A1.E9.m1.10.10.3.3.1.1.cmml">)</mo></mrow></msubsup><mo id="A1.E9.m1.11.11.4.4.2.4" xref="A1.E9.m1.11.11.4.4.3.cmml">,</mo><msubsup id="A1.E9.m1.11.11.4.4.2.2" xref="A1.E9.m1.11.11.4.4.2.2.cmml"><mi id="A1.E9.m1.11.11.4.4.2.2.2.2" xref="A1.E9.m1.11.11.4.4.2.2.2.2.cmml">x</mi><mn id="A1.E9.m1.11.11.4.4.2.2.2.3" xref="A1.E9.m1.11.11.4.4.2.2.2.3.cmml">0</mn><mrow id="A1.E9.m1.9.9.2.2.1.3" xref="A1.E9.m1.11.11.4.4.2.2.cmml"><mo id="A1.E9.m1.9.9.2.2.1.3.1" stretchy="false" xref="A1.E9.m1.11.11.4.4.2.2.cmml">(</mo><mi id="A1.E9.m1.9.9.2.2.1.1" xref="A1.E9.m1.9.9.2.2.1.1.cmml">j</mi><mo id="A1.E9.m1.9.9.2.2.1.3.2" stretchy="false" xref="A1.E9.m1.11.11.4.4.2.2.cmml">)</mo></mrow></msubsup><mo id="A1.E9.m1.11.11.4.4.2.5" stretchy="false" xref="A1.E9.m1.11.11.4.4.3.cmml">)</mo></mrow></mrow><mrow id="A1.E9.m1.19.19.12" xref="A1.E9.m1.19.19.12.cmml"><mrow id="A1.E9.m1.17.17.10.6" xref="A1.E9.m1.17.17.10.6.cmml"><msub id="A1.E9.m1.17.17.10.6.4" xref="A1.E9.m1.17.17.10.6.4.cmml"><mi id="A1.E9.m1.17.17.10.6.4.2" xref="A1.E9.m1.17.17.10.6.4.2.cmml">θ</mi><mn id="A1.E9.m1.17.17.10.6.4.3" xref="A1.E9.m1.17.17.10.6.4.3.cmml">1</mn></msub><mo id="A1.E9.m1.17.17.10.6.3" xref="A1.E9.m1.17.17.10.6.3.cmml">⁢</mo><mrow id="A1.E9.m1.17.17.10.6.2.2" xref="A1.E9.m1.17.17.10.6.2.3.cmml"><mo id="A1.E9.m1.17.17.10.6.2.2.3" stretchy="false" xref="A1.E9.m1.17.17.10.6.2.3.cmml">(</mo><msubsup id="A1.E9.m1.16.16.9.5.1.1.1" xref="A1.E9.m1.16.16.9.5.1.1.1.cmml"><mi id="A1.E9.m1.16.16.9.5.1.1.1.2.2" xref="A1.E9.m1.16.16.9.5.1.1.1.2.2.cmml">x</mi><mi id="A1.E9.m1.16.16.9.5.1.1.1.2.3" xref="A1.E9.m1.16.16.9.5.1.1.1.2.3.cmml">t</mi><mrow id="A1.E9.m1.12.12.5.1.1.3" xref="A1.E9.m1.16.16.9.5.1.1.1.cmml"><mo id="A1.E9.m1.12.12.5.1.1.3.1" stretchy="false" xref="A1.E9.m1.16.16.9.5.1.1.1.cmml">(</mo><mi id="A1.E9.m1.12.12.5.1.1.1" xref="A1.E9.m1.12.12.5.1.1.1.cmml">j</mi><mo id="A1.E9.m1.12.12.5.1.1.3.2" stretchy="false" xref="A1.E9.m1.16.16.9.5.1.1.1.cmml">)</mo></mrow></msubsup><mo id="A1.E9.m1.17.17.10.6.2.2.4" xref="A1.E9.m1.17.17.10.6.2.3.cmml">,</mo><msubsup id="A1.E9.m1.17.17.10.6.2.2.2" xref="A1.E9.m1.17.17.10.6.2.2.2.cmml"><mi id="A1.E9.m1.17.17.10.6.2.2.2.2.2" xref="A1.E9.m1.17.17.10.6.2.2.2.2.2.cmml">x</mi><mn id="A1.E9.m1.17.17.10.6.2.2.2.2.3" xref="A1.E9.m1.17.17.10.6.2.2.2.2.3.cmml">0</mn><mrow id="A1.E9.m1.13.13.6.2.1.3" xref="A1.E9.m1.17.17.10.6.2.2.2.cmml"><mo id="A1.E9.m1.13.13.6.2.1.3.1" stretchy="false" xref="A1.E9.m1.17.17.10.6.2.2.2.cmml">(</mo><mi id="A1.E9.m1.13.13.6.2.1.1" xref="A1.E9.m1.13.13.6.2.1.1.cmml">j</mi><mo id="A1.E9.m1.13.13.6.2.1.3.2" stretchy="false" xref="A1.E9.m1.17.17.10.6.2.2.2.cmml">)</mo></mrow></msubsup><mo id="A1.E9.m1.17.17.10.6.2.2.5" stretchy="false" xref="A1.E9.m1.17.17.10.6.2.3.cmml">)</mo></mrow></mrow><mo id="A1.E9.m1.19.19.12.9" xref="A1.E9.m1.19.19.12.9.cmml">+</mo><mrow id="A1.E9.m1.19.19.12.8" xref="A1.E9.m1.19.19.12.8.cmml"><msub id="A1.E9.m1.19.19.12.8.4" xref="A1.E9.m1.19.19.12.8.4.cmml"><mi id="A1.E9.m1.19.19.12.8.4.2" xref="A1.E9.m1.19.19.12.8.4.2.cmml">θ</mi><mn id="A1.E9.m1.19.19.12.8.4.3" xref="A1.E9.m1.19.19.12.8.4.3.cmml">0</mn></msub><mo id="A1.E9.m1.19.19.12.8.3" xref="A1.E9.m1.19.19.12.8.3.cmml">⁢</mo><mrow id="A1.E9.m1.19.19.12.8.2.2" xref="A1.E9.m1.19.19.12.8.2.3.cmml"><mo id="A1.E9.m1.19.19.12.8.2.2.3" stretchy="false" xref="A1.E9.m1.19.19.12.8.2.3.cmml">(</mo><msubsup id="A1.E9.m1.18.18.11.7.1.1.1" xref="A1.E9.m1.18.18.11.7.1.1.1.cmml"><mi id="A1.E9.m1.18.18.11.7.1.1.1.2.2" xref="A1.E9.m1.18.18.11.7.1.1.1.2.2.cmml">x</mi><mi id="A1.E9.m1.18.18.11.7.1.1.1.2.3" xref="A1.E9.m1.18.18.11.7.1.1.1.2.3.cmml">t</mi><mrow id="A1.E9.m1.14.14.7.3.1.3" xref="A1.E9.m1.18.18.11.7.1.1.1.cmml"><mo id="A1.E9.m1.14.14.7.3.1.3.1" stretchy="false" xref="A1.E9.m1.18.18.11.7.1.1.1.cmml">(</mo><mi id="A1.E9.m1.14.14.7.3.1.1" xref="A1.E9.m1.14.14.7.3.1.1.cmml">j</mi><mo id="A1.E9.m1.14.14.7.3.1.3.2" stretchy="false" xref="A1.E9.m1.18.18.11.7.1.1.1.cmml">)</mo></mrow></msubsup><mo id="A1.E9.m1.19.19.12.8.2.2.4" xref="A1.E9.m1.19.19.12.8.2.3.cmml">,</mo><msubsup id="A1.E9.m1.19.19.12.8.2.2.2" xref="A1.E9.m1.19.19.12.8.2.2.2.cmml"><mi id="A1.E9.m1.19.19.12.8.2.2.2.2.2" xref="A1.E9.m1.19.19.12.8.2.2.2.2.2.cmml">x</mi><mn id="A1.E9.m1.19.19.12.8.2.2.2.2.3" xref="A1.E9.m1.19.19.12.8.2.2.2.2.3.cmml">0</mn><mrow id="A1.E9.m1.15.15.8.4.1.3" xref="A1.E9.m1.19.19.12.8.2.2.2.cmml"><mo id="A1.E9.m1.15.15.8.4.1.3.1" stretchy="false" xref="A1.E9.m1.19.19.12.8.2.2.2.cmml">(</mo><mi id="A1.E9.m1.15.15.8.4.1.1" xref="A1.E9.m1.15.15.8.4.1.1.cmml">j</mi><mo id="A1.E9.m1.15.15.8.4.1.3.2" stretchy="false" xref="A1.E9.m1.19.19.12.8.2.2.2.cmml">)</mo></mrow></msubsup><mo id="A1.E9.m1.19.19.12.8.2.2.5" stretchy="false" xref="A1.E9.m1.19.19.12.8.2.3.cmml">)</mo></mrow></mrow></mrow></mfrac><mo id="A1.E9.m1.22.22.1.1.2.2.2.1.1.4" xref="A1.E9.m1.22.22.1.1.2.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A1.E9.m1.22.22.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E9.m1.22b"><apply id="A1.E9.m1.22.22.1.1.3.cmml" xref="A1.E9.m1.22.22.1.1.2"><csymbol cd="ambiguous" id="A1.E9.m1.22.22.1.1.3a.cmml" xref="A1.E9.m1.22.22.1.1.2.3">formulae-sequence</csymbol><apply id="A1.E9.m1.22.22.1.1.1.1.cmml" xref="A1.E9.m1.22.22.1.1.1.1"><eq id="A1.E9.m1.22.22.1.1.1.1.3.cmml" xref="A1.E9.m1.22.22.1.1.1.1.3"></eq><apply id="A1.E9.m1.22.22.1.1.1.1.1.cmml" xref="A1.E9.m1.22.22.1.1.1.1.1"><times id="A1.E9.m1.22.22.1.1.1.1.1.2.cmml" xref="A1.E9.m1.22.22.1.1.1.1.1.2"></times><ci id="A1.E9.m1.22.22.1.1.1.1.1.3.cmml" xref="A1.E9.m1.22.22.1.1.1.1.1.3">𝑞</ci><apply id="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.cmml" xref="A1.E9.m1.22.22.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.3">conditional</csymbol><apply id="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.4.cmml" xref="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.4.1.cmml" xref="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.4.2.cmml" xref="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.4.2">𝐱</ci><apply id="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.4.3.cmml" xref="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.4.3"><minus id="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.4.3.1.cmml" xref="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.4.3.1"></minus><ci id="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.4.3.2.cmml" xref="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.4.3.2">𝑡</ci><cn id="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.4.3.3.cmml" type="integer" xref="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.4.3.3">1</cn></apply></apply><list id="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.2.2"><apply id="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.1.1.1.2">𝐱</ci><ci id="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.2.2.2.2">𝐱</ci><cn id="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.2.2.2.3.cmml" type="integer" xref="A1.E9.m1.22.22.1.1.1.1.1.1.1.1.2.2.2.3">0</cn></apply></list></apply></apply><list id="A1.E9.m1.22.22.1.1.1.1.2.2.cmml" xref="A1.E9.m1.22.22.1.1.1.1.2.1"><apply id="A1.E9.m1.22.22.1.1.1.1.2.1.1.cmml" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1"><apply id="A1.E9.m1.22.22.1.1.1.1.2.1.1.2.cmml" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.2"><csymbol cd="ambiguous" id="A1.E9.m1.22.22.1.1.1.1.2.1.1.2.1.cmml" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.2">superscript</csymbol><apply id="A1.E9.m1.22.22.1.1.1.1.2.1.1.2.2.cmml" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.2"><csymbol cd="ambiguous" id="A1.E9.m1.22.22.1.1.1.1.2.1.1.2.2.1.cmml" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.2">subscript</csymbol><csymbol cd="latexml" id="A1.E9.m1.22.22.1.1.1.1.2.1.1.2.2.2.cmml" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.2.2.2">product</csymbol><apply id="A1.E9.m1.22.22.1.1.1.1.2.1.1.2.2.3.cmml" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.2.2.3"><eq id="A1.E9.m1.22.22.1.1.1.1.2.1.1.2.2.3.1.cmml" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.2.2.3.1"></eq><ci id="A1.E9.m1.22.22.1.1.1.1.2.1.1.2.2.3.2.cmml" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.2.2.3.2">𝑗</ci><cn id="A1.E9.m1.22.22.1.1.1.1.2.1.1.2.2.3.3.cmml" type="integer" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.2.2.3.3">1</cn></apply></apply><ci id="A1.E9.m1.22.22.1.1.1.1.2.1.1.2.3.cmml" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.2.3">𝑛</ci></apply><apply id="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.cmml" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1"><times id="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.2.cmml" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.2"></times><ci id="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.3.cmml" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.3">𝑞</ci><apply id="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1"><csymbol cd="latexml" id="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.3.cmml" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.3">conditional</csymbol><apply id="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.4.cmml" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.4.1.cmml" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.4">superscript</csymbol><apply id="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.4.2.cmml" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.4.2.1.cmml" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.4">subscript</csymbol><ci id="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.4.2.2.cmml" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.4.2.2">𝑥</ci><apply id="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.4.2.3.cmml" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.4.2.3"><minus id="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.4.2.3.1.cmml" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.4.2.3.1"></minus><ci id="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.4.2.3.2.cmml" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.4.2.3.2">𝑡</ci><cn id="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.4.2.3.3.cmml" type="integer" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.4.2.3.3">1</cn></apply></apply><ci id="A1.E9.m1.1.1.1.1.cmml" xref="A1.E9.m1.1.1.1.1">𝑗</ci></apply><list id="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.2.3.cmml" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.2.2"><apply id="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.1.1.1.2.2">𝑥</ci><ci id="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="A1.E9.m1.2.2.1.1.cmml" xref="A1.E9.m1.2.2.1.1">𝑗</ci></apply><apply id="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.2.2.2.cmml" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.2.2.2.1.cmml" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.2.2.2">superscript</csymbol><apply id="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.2.2.2.2.cmml" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.2.2.2.2.2">𝑥</ci><cn id="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.2.2.2.2.3.cmml" type="integer" xref="A1.E9.m1.22.22.1.1.1.1.2.1.1.1.1.1.1.2.2.2.2.3">0</cn></apply><ci id="A1.E9.m1.3.3.1.1.cmml" xref="A1.E9.m1.3.3.1.1">𝑗</ci></apply></list></apply></apply></apply><ci id="A1.E9.m1.21.21a.cmml" xref="A1.E9.m1.21.21"><mtext id="A1.E9.m1.21.21.cmml" xref="A1.E9.m1.21.21">where</mtext></ci></list></apply><apply id="A1.E9.m1.22.22.1.1.2.2.cmml" xref="A1.E9.m1.22.22.1.1.2.2"><eq id="A1.E9.m1.22.22.1.1.2.2.3.cmml" xref="A1.E9.m1.22.22.1.1.2.2.3"></eq><apply id="A1.E9.m1.22.22.1.1.2.2.1.cmml" xref="A1.E9.m1.22.22.1.1.2.2.1"><times id="A1.E9.m1.22.22.1.1.2.2.1.2.cmml" xref="A1.E9.m1.22.22.1.1.2.2.1.2"></times><ci id="A1.E9.m1.22.22.1.1.2.2.1.3.cmml" xref="A1.E9.m1.22.22.1.1.2.2.1.3">𝑞</ci><apply id="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.cmml" xref="A1.E9.m1.22.22.1.1.2.2.1.1.1"><csymbol cd="latexml" id="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.3.cmml" xref="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.3">conditional</csymbol><apply id="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.4.cmml" xref="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.4"><csymbol cd="ambiguous" id="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.4.1.cmml" xref="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.4">superscript</csymbol><apply id="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.4.2.cmml" xref="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.4"><csymbol cd="ambiguous" id="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.4.2.1.cmml" xref="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.4">subscript</csymbol><ci id="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.4.2.2.cmml" xref="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.4.2.2">𝑥</ci><apply id="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.4.2.3.cmml" xref="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.4.2.3"><minus id="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.4.2.3.1.cmml" xref="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.4.2.3.1"></minus><ci id="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.4.2.3.2.cmml" xref="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.4.2.3.2">𝑡</ci><cn id="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.4.2.3.3.cmml" type="integer" xref="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.4.2.3.3">1</cn></apply></apply><ci id="A1.E9.m1.4.4.1.1.cmml" xref="A1.E9.m1.4.4.1.1">𝑗</ci></apply><list id="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.2.3.cmml" xref="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.2.2"><apply id="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.1.1.1.cmml" xref="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.1.1.1.1.cmml" xref="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.1.1.1">superscript</csymbol><apply id="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.1.1.1.2.cmml" xref="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.1.1.1.2.2">𝑥</ci><ci id="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="A1.E9.m1.5.5.1.1.cmml" xref="A1.E9.m1.5.5.1.1">𝑗</ci></apply><apply id="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.2.2.2.cmml" xref="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.2.2.2.1.cmml" xref="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.2.2.2">superscript</csymbol><apply id="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.2.2.2.2.cmml" xref="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.2.2.2.2.1.cmml" xref="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.2.2.2">subscript</csymbol><ci id="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.2.2.2.2.2.cmml" xref="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.2.2.2.2.2">𝑥</ci><cn id="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.2.2.2.2.3.cmml" type="integer" xref="A1.E9.m1.22.22.1.1.2.2.1.1.1.1.2.2.2.2.3">0</cn></apply><ci id="A1.E9.m1.6.6.1.1.cmml" xref="A1.E9.m1.6.6.1.1">𝑗</ci></apply></list></apply></apply><apply id="A1.E9.m1.22.22.1.1.2.2.2.2.cmml" xref="A1.E9.m1.22.22.1.1.2.2.2.1"><ci id="A1.E9.m1.20.20.cmml" xref="A1.E9.m1.20.20">Bernoulli</ci><apply id="A1.E9.m1.22.22.1.1.2.2.2.1.1.1.cmml" xref="A1.E9.m1.22.22.1.1.2.2.2.1.1.1"><csymbol cd="ambiguous" id="A1.E9.m1.22.22.1.1.2.2.2.1.1.1.1.cmml" xref="A1.E9.m1.22.22.1.1.2.2.2.1.1.1">superscript</csymbol><apply id="A1.E9.m1.22.22.1.1.2.2.2.1.1.1.2.cmml" xref="A1.E9.m1.22.22.1.1.2.2.2.1.1.1"><csymbol cd="ambiguous" id="A1.E9.m1.22.22.1.1.2.2.2.1.1.1.2.1.cmml" xref="A1.E9.m1.22.22.1.1.2.2.2.1.1.1">subscript</csymbol><ci id="A1.E9.m1.22.22.1.1.2.2.2.1.1.1.2.2.cmml" xref="A1.E9.m1.22.22.1.1.2.2.2.1.1.1.2.2">𝑥</ci><apply id="A1.E9.m1.22.22.1.1.2.2.2.1.1.1.2.3.cmml" xref="A1.E9.m1.22.22.1.1.2.2.2.1.1.1.2.3"><minus id="A1.E9.m1.22.22.1.1.2.2.2.1.1.1.2.3.1.cmml" xref="A1.E9.m1.22.22.1.1.2.2.2.1.1.1.2.3.1"></minus><ci id="A1.E9.m1.22.22.1.1.2.2.2.1.1.1.2.3.2.cmml" xref="A1.E9.m1.22.22.1.1.2.2.2.1.1.1.2.3.2">𝑡</ci><cn id="A1.E9.m1.22.22.1.1.2.2.2.1.1.1.2.3.3.cmml" type="integer" xref="A1.E9.m1.22.22.1.1.2.2.2.1.1.1.2.3.3">1</cn></apply></apply><ci id="A1.E9.m1.7.7.1.1.cmml" xref="A1.E9.m1.7.7.1.1">𝑗</ci></apply><apply id="A1.E9.m1.19.19.cmml" xref="A1.E9.m1.19.19"><divide id="A1.E9.m1.19.19.13.cmml" xref="A1.E9.m1.19.19"></divide><apply id="A1.E9.m1.11.11.4.cmml" xref="A1.E9.m1.11.11.4"><times id="A1.E9.m1.11.11.4.5.cmml" xref="A1.E9.m1.11.11.4.5"></times><apply id="A1.E9.m1.11.11.4.6.cmml" xref="A1.E9.m1.11.11.4.6"><csymbol cd="ambiguous" id="A1.E9.m1.11.11.4.6.1.cmml" xref="A1.E9.m1.11.11.4.6">subscript</csymbol><ci id="A1.E9.m1.11.11.4.6.2.cmml" xref="A1.E9.m1.11.11.4.6.2">𝜃</ci><cn id="A1.E9.m1.11.11.4.6.3.cmml" type="integer" xref="A1.E9.m1.11.11.4.6.3">1</cn></apply><interval closure="open" id="A1.E9.m1.11.11.4.4.3.cmml" xref="A1.E9.m1.11.11.4.4.2"><apply id="A1.E9.m1.10.10.3.3.1.1.cmml" xref="A1.E9.m1.10.10.3.3.1.1"><csymbol cd="ambiguous" id="A1.E9.m1.10.10.3.3.1.1.1.cmml" xref="A1.E9.m1.10.10.3.3.1.1">superscript</csymbol><apply id="A1.E9.m1.10.10.3.3.1.1.2.cmml" xref="A1.E9.m1.10.10.3.3.1.1"><csymbol cd="ambiguous" id="A1.E9.m1.10.10.3.3.1.1.2.1.cmml" xref="A1.E9.m1.10.10.3.3.1.1">subscript</csymbol><ci id="A1.E9.m1.10.10.3.3.1.1.2.2.cmml" xref="A1.E9.m1.10.10.3.3.1.1.2.2">𝑥</ci><ci id="A1.E9.m1.10.10.3.3.1.1.2.3.cmml" xref="A1.E9.m1.10.10.3.3.1.1.2.3">𝑡</ci></apply><ci id="A1.E9.m1.8.8.1.1.1.1.cmml" xref="A1.E9.m1.8.8.1.1.1.1">𝑗</ci></apply><apply id="A1.E9.m1.11.11.4.4.2.2.cmml" xref="A1.E9.m1.11.11.4.4.2.2"><csymbol cd="ambiguous" id="A1.E9.m1.11.11.4.4.2.2.1.cmml" xref="A1.E9.m1.11.11.4.4.2.2">superscript</csymbol><apply id="A1.E9.m1.11.11.4.4.2.2.2.cmml" xref="A1.E9.m1.11.11.4.4.2.2"><csymbol cd="ambiguous" id="A1.E9.m1.11.11.4.4.2.2.2.1.cmml" xref="A1.E9.m1.11.11.4.4.2.2">subscript</csymbol><ci id="A1.E9.m1.11.11.4.4.2.2.2.2.cmml" xref="A1.E9.m1.11.11.4.4.2.2.2.2">𝑥</ci><cn id="A1.E9.m1.11.11.4.4.2.2.2.3.cmml" type="integer" xref="A1.E9.m1.11.11.4.4.2.2.2.3">0</cn></apply><ci id="A1.E9.m1.9.9.2.2.1.1.cmml" xref="A1.E9.m1.9.9.2.2.1.1">𝑗</ci></apply></interval></apply><apply id="A1.E9.m1.19.19.12.cmml" xref="A1.E9.m1.19.19.12"><plus id="A1.E9.m1.19.19.12.9.cmml" xref="A1.E9.m1.19.19.12.9"></plus><apply id="A1.E9.m1.17.17.10.6.cmml" xref="A1.E9.m1.17.17.10.6"><times id="A1.E9.m1.17.17.10.6.3.cmml" xref="A1.E9.m1.17.17.10.6.3"></times><apply id="A1.E9.m1.17.17.10.6.4.cmml" xref="A1.E9.m1.17.17.10.6.4"><csymbol cd="ambiguous" id="A1.E9.m1.17.17.10.6.4.1.cmml" xref="A1.E9.m1.17.17.10.6.4">subscript</csymbol><ci id="A1.E9.m1.17.17.10.6.4.2.cmml" xref="A1.E9.m1.17.17.10.6.4.2">𝜃</ci><cn id="A1.E9.m1.17.17.10.6.4.3.cmml" type="integer" xref="A1.E9.m1.17.17.10.6.4.3">1</cn></apply><interval closure="open" id="A1.E9.m1.17.17.10.6.2.3.cmml" xref="A1.E9.m1.17.17.10.6.2.2"><apply id="A1.E9.m1.16.16.9.5.1.1.1.cmml" xref="A1.E9.m1.16.16.9.5.1.1.1"><csymbol cd="ambiguous" id="A1.E9.m1.16.16.9.5.1.1.1.1.cmml" xref="A1.E9.m1.16.16.9.5.1.1.1">superscript</csymbol><apply id="A1.E9.m1.16.16.9.5.1.1.1.2.cmml" xref="A1.E9.m1.16.16.9.5.1.1.1"><csymbol cd="ambiguous" id="A1.E9.m1.16.16.9.5.1.1.1.2.1.cmml" xref="A1.E9.m1.16.16.9.5.1.1.1">subscript</csymbol><ci id="A1.E9.m1.16.16.9.5.1.1.1.2.2.cmml" xref="A1.E9.m1.16.16.9.5.1.1.1.2.2">𝑥</ci><ci id="A1.E9.m1.16.16.9.5.1.1.1.2.3.cmml" xref="A1.E9.m1.16.16.9.5.1.1.1.2.3">𝑡</ci></apply><ci id="A1.E9.m1.12.12.5.1.1.1.cmml" xref="A1.E9.m1.12.12.5.1.1.1">𝑗</ci></apply><apply id="A1.E9.m1.17.17.10.6.2.2.2.cmml" xref="A1.E9.m1.17.17.10.6.2.2.2"><csymbol cd="ambiguous" id="A1.E9.m1.17.17.10.6.2.2.2.1.cmml" xref="A1.E9.m1.17.17.10.6.2.2.2">superscript</csymbol><apply id="A1.E9.m1.17.17.10.6.2.2.2.2.cmml" xref="A1.E9.m1.17.17.10.6.2.2.2"><csymbol cd="ambiguous" id="A1.E9.m1.17.17.10.6.2.2.2.2.1.cmml" xref="A1.E9.m1.17.17.10.6.2.2.2">subscript</csymbol><ci id="A1.E9.m1.17.17.10.6.2.2.2.2.2.cmml" xref="A1.E9.m1.17.17.10.6.2.2.2.2.2">𝑥</ci><cn id="A1.E9.m1.17.17.10.6.2.2.2.2.3.cmml" type="integer" xref="A1.E9.m1.17.17.10.6.2.2.2.2.3">0</cn></apply><ci id="A1.E9.m1.13.13.6.2.1.1.cmml" xref="A1.E9.m1.13.13.6.2.1.1">𝑗</ci></apply></interval></apply><apply id="A1.E9.m1.19.19.12.8.cmml" xref="A1.E9.m1.19.19.12.8"><times id="A1.E9.m1.19.19.12.8.3.cmml" xref="A1.E9.m1.19.19.12.8.3"></times><apply id="A1.E9.m1.19.19.12.8.4.cmml" xref="A1.E9.m1.19.19.12.8.4"><csymbol cd="ambiguous" id="A1.E9.m1.19.19.12.8.4.1.cmml" xref="A1.E9.m1.19.19.12.8.4">subscript</csymbol><ci id="A1.E9.m1.19.19.12.8.4.2.cmml" xref="A1.E9.m1.19.19.12.8.4.2">𝜃</ci><cn id="A1.E9.m1.19.19.12.8.4.3.cmml" type="integer" xref="A1.E9.m1.19.19.12.8.4.3">0</cn></apply><interval closure="open" id="A1.E9.m1.19.19.12.8.2.3.cmml" xref="A1.E9.m1.19.19.12.8.2.2"><apply id="A1.E9.m1.18.18.11.7.1.1.1.cmml" xref="A1.E9.m1.18.18.11.7.1.1.1"><csymbol cd="ambiguous" id="A1.E9.m1.18.18.11.7.1.1.1.1.cmml" xref="A1.E9.m1.18.18.11.7.1.1.1">superscript</csymbol><apply id="A1.E9.m1.18.18.11.7.1.1.1.2.cmml" xref="A1.E9.m1.18.18.11.7.1.1.1"><csymbol cd="ambiguous" id="A1.E9.m1.18.18.11.7.1.1.1.2.1.cmml" xref="A1.E9.m1.18.18.11.7.1.1.1">subscript</csymbol><ci id="A1.E9.m1.18.18.11.7.1.1.1.2.2.cmml" xref="A1.E9.m1.18.18.11.7.1.1.1.2.2">𝑥</ci><ci id="A1.E9.m1.18.18.11.7.1.1.1.2.3.cmml" xref="A1.E9.m1.18.18.11.7.1.1.1.2.3">𝑡</ci></apply><ci id="A1.E9.m1.14.14.7.3.1.1.cmml" xref="A1.E9.m1.14.14.7.3.1.1">𝑗</ci></apply><apply id="A1.E9.m1.19.19.12.8.2.2.2.cmml" xref="A1.E9.m1.19.19.12.8.2.2.2"><csymbol cd="ambiguous" id="A1.E9.m1.19.19.12.8.2.2.2.1.cmml" xref="A1.E9.m1.19.19.12.8.2.2.2">superscript</csymbol><apply id="A1.E9.m1.19.19.12.8.2.2.2.2.cmml" xref="A1.E9.m1.19.19.12.8.2.2.2"><csymbol cd="ambiguous" id="A1.E9.m1.19.19.12.8.2.2.2.2.1.cmml" xref="A1.E9.m1.19.19.12.8.2.2.2">subscript</csymbol><ci id="A1.E9.m1.19.19.12.8.2.2.2.2.2.cmml" xref="A1.E9.m1.19.19.12.8.2.2.2.2.2">𝑥</ci><cn id="A1.E9.m1.19.19.12.8.2.2.2.2.3.cmml" type="integer" xref="A1.E9.m1.19.19.12.8.2.2.2.2.3">0</cn></apply><ci id="A1.E9.m1.15.15.8.4.1.1.cmml" xref="A1.E9.m1.15.15.8.4.1.1">𝑗</ci></apply></interval></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E9.m1.22c">q(\mathbf{x}_{t-1}|\mathbf{x}_{t},\mathbf{x}_{0})=\prod_{j=1}^{n}q(x_{t-1}^{(j%
)}|x_{t}^{(j)},x_{0}^{(j)})\quad\text{where}\quad q(x_{t-1}^{(j)}|x_{t}^{(j)},%
x_{0}^{(j)})=\operatorname{Bernoulli}\left(x_{t-1}^{(j)}\middle|\frac{\theta_{%
1}(x_{t}^{(j)},x_{0}^{(j)})}{\theta_{1}(x_{t}^{(j)},x_{0}^{(j)})+\theta_{0}(x_%
{t}^{(j)},x_{0}^{(j)})}\right),</annotation><annotation encoding="application/x-llamapun" id="A1.E9.m1.22d">italic_q ( bold_x start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT | bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) = ∏ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT italic_q ( italic_x start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT | italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT , italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT ) where italic_q ( italic_x start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT | italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT , italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT ) = roman_Bernoulli ( italic_x start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT | divide start_ARG italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT , italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT ) end_ARG start_ARG italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT , italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT ) + italic_θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT , italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT ) end_ARG ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS1.SSS4.p3.7">where</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A2.EGx2">
<tbody id="A1.E10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\theta_{1}(x_{t}^{(j)},x_{0}^{(j)})" class="ltx_Math" display="inline" id="A1.E10.m1.4"><semantics id="A1.E10.m1.4a"><mrow id="A1.E10.m1.4.4" xref="A1.E10.m1.4.4.cmml"><msub id="A1.E10.m1.4.4.4" xref="A1.E10.m1.4.4.4.cmml"><mi id="A1.E10.m1.4.4.4.2" xref="A1.E10.m1.4.4.4.2.cmml">θ</mi><mn id="A1.E10.m1.4.4.4.3" xref="A1.E10.m1.4.4.4.3.cmml">1</mn></msub><mo id="A1.E10.m1.4.4.3" xref="A1.E10.m1.4.4.3.cmml">⁢</mo><mrow id="A1.E10.m1.4.4.2.2" xref="A1.E10.m1.4.4.2.3.cmml"><mo id="A1.E10.m1.4.4.2.2.3" stretchy="false" xref="A1.E10.m1.4.4.2.3.cmml">(</mo><msubsup id="A1.E10.m1.3.3.1.1.1" xref="A1.E10.m1.3.3.1.1.1.cmml"><mi id="A1.E10.m1.3.3.1.1.1.2.2" xref="A1.E10.m1.3.3.1.1.1.2.2.cmml">x</mi><mi id="A1.E10.m1.3.3.1.1.1.2.3" xref="A1.E10.m1.3.3.1.1.1.2.3.cmml">t</mi><mrow id="A1.E10.m1.1.1.1.3" xref="A1.E10.m1.3.3.1.1.1.cmml"><mo id="A1.E10.m1.1.1.1.3.1" stretchy="false" xref="A1.E10.m1.3.3.1.1.1.cmml">(</mo><mi id="A1.E10.m1.1.1.1.1" xref="A1.E10.m1.1.1.1.1.cmml">j</mi><mo id="A1.E10.m1.1.1.1.3.2" stretchy="false" xref="A1.E10.m1.3.3.1.1.1.cmml">)</mo></mrow></msubsup><mo id="A1.E10.m1.4.4.2.2.4" xref="A1.E10.m1.4.4.2.3.cmml">,</mo><msubsup id="A1.E10.m1.4.4.2.2.2" xref="A1.E10.m1.4.4.2.2.2.cmml"><mi id="A1.E10.m1.4.4.2.2.2.2.2" xref="A1.E10.m1.4.4.2.2.2.2.2.cmml">x</mi><mn id="A1.E10.m1.4.4.2.2.2.2.3" xref="A1.E10.m1.4.4.2.2.2.2.3.cmml">0</mn><mrow id="A1.E10.m1.2.2.1.3" xref="A1.E10.m1.4.4.2.2.2.cmml"><mo id="A1.E10.m1.2.2.1.3.1" stretchy="false" xref="A1.E10.m1.4.4.2.2.2.cmml">(</mo><mi id="A1.E10.m1.2.2.1.1" xref="A1.E10.m1.2.2.1.1.cmml">j</mi><mo id="A1.E10.m1.2.2.1.3.2" stretchy="false" xref="A1.E10.m1.4.4.2.2.2.cmml">)</mo></mrow></msubsup><mo id="A1.E10.m1.4.4.2.2.5" stretchy="false" xref="A1.E10.m1.4.4.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E10.m1.4b"><apply id="A1.E10.m1.4.4.cmml" xref="A1.E10.m1.4.4"><times id="A1.E10.m1.4.4.3.cmml" xref="A1.E10.m1.4.4.3"></times><apply id="A1.E10.m1.4.4.4.cmml" xref="A1.E10.m1.4.4.4"><csymbol cd="ambiguous" id="A1.E10.m1.4.4.4.1.cmml" xref="A1.E10.m1.4.4.4">subscript</csymbol><ci id="A1.E10.m1.4.4.4.2.cmml" xref="A1.E10.m1.4.4.4.2">𝜃</ci><cn id="A1.E10.m1.4.4.4.3.cmml" type="integer" xref="A1.E10.m1.4.4.4.3">1</cn></apply><interval closure="open" id="A1.E10.m1.4.4.2.3.cmml" xref="A1.E10.m1.4.4.2.2"><apply id="A1.E10.m1.3.3.1.1.1.cmml" xref="A1.E10.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="A1.E10.m1.3.3.1.1.1.1.cmml" xref="A1.E10.m1.3.3.1.1.1">superscript</csymbol><apply id="A1.E10.m1.3.3.1.1.1.2.cmml" xref="A1.E10.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="A1.E10.m1.3.3.1.1.1.2.1.cmml" xref="A1.E10.m1.3.3.1.1.1">subscript</csymbol><ci id="A1.E10.m1.3.3.1.1.1.2.2.cmml" xref="A1.E10.m1.3.3.1.1.1.2.2">𝑥</ci><ci id="A1.E10.m1.3.3.1.1.1.2.3.cmml" xref="A1.E10.m1.3.3.1.1.1.2.3">𝑡</ci></apply><ci id="A1.E10.m1.1.1.1.1.cmml" xref="A1.E10.m1.1.1.1.1">𝑗</ci></apply><apply id="A1.E10.m1.4.4.2.2.2.cmml" xref="A1.E10.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="A1.E10.m1.4.4.2.2.2.1.cmml" xref="A1.E10.m1.4.4.2.2.2">superscript</csymbol><apply id="A1.E10.m1.4.4.2.2.2.2.cmml" xref="A1.E10.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="A1.E10.m1.4.4.2.2.2.2.1.cmml" xref="A1.E10.m1.4.4.2.2.2">subscript</csymbol><ci id="A1.E10.m1.4.4.2.2.2.2.2.cmml" xref="A1.E10.m1.4.4.2.2.2.2.2">𝑥</ci><cn id="A1.E10.m1.4.4.2.2.2.2.3.cmml" type="integer" xref="A1.E10.m1.4.4.2.2.2.2.3">0</cn></apply><ci id="A1.E10.m1.2.2.1.1.cmml" xref="A1.E10.m1.2.2.1.1">𝑗</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E10.m1.4c">\displaystyle\theta_{1}(x_{t}^{(j)},x_{0}^{(j)})</annotation><annotation encoding="application/x-llamapun" id="A1.E10.m1.4d">italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT , italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\left(\alpha_{t}x_{t}^{(j)}+(1-\alpha_{t})\cdot\frac{1}{2}\right%
)\cdot\left(\bar{\alpha}_{t-1}x_{0}^{(j)}+(1-\bar{\alpha}_{t-1})\cdot\frac{1}{%
2}\right)" class="ltx_Math" display="inline" id="A1.E10.m2.4"><semantics id="A1.E10.m2.4a"><mrow id="A1.E10.m2.4.4" xref="A1.E10.m2.4.4.cmml"><mi id="A1.E10.m2.4.4.4" xref="A1.E10.m2.4.4.4.cmml"></mi><mo id="A1.E10.m2.4.4.3" xref="A1.E10.m2.4.4.3.cmml">=</mo><mrow id="A1.E10.m2.4.4.2" xref="A1.E10.m2.4.4.2.cmml"><mrow id="A1.E10.m2.3.3.1.1.1" xref="A1.E10.m2.3.3.1.1.1.1.cmml"><mo id="A1.E10.m2.3.3.1.1.1.2" xref="A1.E10.m2.3.3.1.1.1.1.cmml">(</mo><mrow id="A1.E10.m2.3.3.1.1.1.1" xref="A1.E10.m2.3.3.1.1.1.1.cmml"><mrow id="A1.E10.m2.3.3.1.1.1.1.3" xref="A1.E10.m2.3.3.1.1.1.1.3.cmml"><msub id="A1.E10.m2.3.3.1.1.1.1.3.2" xref="A1.E10.m2.3.3.1.1.1.1.3.2.cmml"><mi id="A1.E10.m2.3.3.1.1.1.1.3.2.2" xref="A1.E10.m2.3.3.1.1.1.1.3.2.2.cmml">α</mi><mi id="A1.E10.m2.3.3.1.1.1.1.3.2.3" xref="A1.E10.m2.3.3.1.1.1.1.3.2.3.cmml">t</mi></msub><mo id="A1.E10.m2.3.3.1.1.1.1.3.1" xref="A1.E10.m2.3.3.1.1.1.1.3.1.cmml">⁢</mo><msubsup id="A1.E10.m2.3.3.1.1.1.1.3.3" xref="A1.E10.m2.3.3.1.1.1.1.3.3.cmml"><mi id="A1.E10.m2.3.3.1.1.1.1.3.3.2.2" xref="A1.E10.m2.3.3.1.1.1.1.3.3.2.2.cmml">x</mi><mi id="A1.E10.m2.3.3.1.1.1.1.3.3.2.3" xref="A1.E10.m2.3.3.1.1.1.1.3.3.2.3.cmml">t</mi><mrow id="A1.E10.m2.1.1.1.3" xref="A1.E10.m2.3.3.1.1.1.1.3.3.cmml"><mo id="A1.E10.m2.1.1.1.3.1" stretchy="false" xref="A1.E10.m2.3.3.1.1.1.1.3.3.cmml">(</mo><mi id="A1.E10.m2.1.1.1.1" xref="A1.E10.m2.1.1.1.1.cmml">j</mi><mo id="A1.E10.m2.1.1.1.3.2" stretchy="false" xref="A1.E10.m2.3.3.1.1.1.1.3.3.cmml">)</mo></mrow></msubsup></mrow><mo id="A1.E10.m2.3.3.1.1.1.1.2" xref="A1.E10.m2.3.3.1.1.1.1.2.cmml">+</mo><mrow id="A1.E10.m2.3.3.1.1.1.1.1" xref="A1.E10.m2.3.3.1.1.1.1.1.cmml"><mrow id="A1.E10.m2.3.3.1.1.1.1.1.1.1" xref="A1.E10.m2.3.3.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E10.m2.3.3.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E10.m2.3.3.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E10.m2.3.3.1.1.1.1.1.1.1.1" xref="A1.E10.m2.3.3.1.1.1.1.1.1.1.1.cmml"><mn id="A1.E10.m2.3.3.1.1.1.1.1.1.1.1.2" xref="A1.E10.m2.3.3.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="A1.E10.m2.3.3.1.1.1.1.1.1.1.1.1" xref="A1.E10.m2.3.3.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="A1.E10.m2.3.3.1.1.1.1.1.1.1.1.3" xref="A1.E10.m2.3.3.1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.E10.m2.3.3.1.1.1.1.1.1.1.1.3.2" xref="A1.E10.m2.3.3.1.1.1.1.1.1.1.1.3.2.cmml">α</mi><mi id="A1.E10.m2.3.3.1.1.1.1.1.1.1.1.3.3" xref="A1.E10.m2.3.3.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="A1.E10.m2.3.3.1.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="A1.E10.m2.3.3.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A1.E10.m2.3.3.1.1.1.1.1.2" rspace="0.222em" xref="A1.E10.m2.3.3.1.1.1.1.1.2.cmml">⋅</mo><mstyle displaystyle="true" id="A1.E10.m2.3.3.1.1.1.1.1.3" xref="A1.E10.m2.3.3.1.1.1.1.1.3.cmml"><mfrac id="A1.E10.m2.3.3.1.1.1.1.1.3a" xref="A1.E10.m2.3.3.1.1.1.1.1.3.cmml"><mn id="A1.E10.m2.3.3.1.1.1.1.1.3.2" xref="A1.E10.m2.3.3.1.1.1.1.1.3.2.cmml">1</mn><mn id="A1.E10.m2.3.3.1.1.1.1.1.3.3" xref="A1.E10.m2.3.3.1.1.1.1.1.3.3.cmml">2</mn></mfrac></mstyle></mrow></mrow><mo id="A1.E10.m2.3.3.1.1.1.3" rspace="0.055em" xref="A1.E10.m2.3.3.1.1.1.1.cmml">)</mo></mrow><mo id="A1.E10.m2.4.4.2.3" rspace="0.222em" xref="A1.E10.m2.4.4.2.3.cmml">⋅</mo><mrow id="A1.E10.m2.4.4.2.2.1" xref="A1.E10.m2.4.4.2.2.1.1.cmml"><mo id="A1.E10.m2.4.4.2.2.1.2" xref="A1.E10.m2.4.4.2.2.1.1.cmml">(</mo><mrow id="A1.E10.m2.4.4.2.2.1.1" xref="A1.E10.m2.4.4.2.2.1.1.cmml"><mrow id="A1.E10.m2.4.4.2.2.1.1.3" xref="A1.E10.m2.4.4.2.2.1.1.3.cmml"><msub id="A1.E10.m2.4.4.2.2.1.1.3.2" xref="A1.E10.m2.4.4.2.2.1.1.3.2.cmml"><mover accent="true" id="A1.E10.m2.4.4.2.2.1.1.3.2.2" xref="A1.E10.m2.4.4.2.2.1.1.3.2.2.cmml"><mi id="A1.E10.m2.4.4.2.2.1.1.3.2.2.2" xref="A1.E10.m2.4.4.2.2.1.1.3.2.2.2.cmml">α</mi><mo id="A1.E10.m2.4.4.2.2.1.1.3.2.2.1" xref="A1.E10.m2.4.4.2.2.1.1.3.2.2.1.cmml">¯</mo></mover><mrow id="A1.E10.m2.4.4.2.2.1.1.3.2.3" xref="A1.E10.m2.4.4.2.2.1.1.3.2.3.cmml"><mi id="A1.E10.m2.4.4.2.2.1.1.3.2.3.2" xref="A1.E10.m2.4.4.2.2.1.1.3.2.3.2.cmml">t</mi><mo id="A1.E10.m2.4.4.2.2.1.1.3.2.3.1" xref="A1.E10.m2.4.4.2.2.1.1.3.2.3.1.cmml">−</mo><mn id="A1.E10.m2.4.4.2.2.1.1.3.2.3.3" xref="A1.E10.m2.4.4.2.2.1.1.3.2.3.3.cmml">1</mn></mrow></msub><mo id="A1.E10.m2.4.4.2.2.1.1.3.1" xref="A1.E10.m2.4.4.2.2.1.1.3.1.cmml">⁢</mo><msubsup id="A1.E10.m2.4.4.2.2.1.1.3.3" xref="A1.E10.m2.4.4.2.2.1.1.3.3.cmml"><mi id="A1.E10.m2.4.4.2.2.1.1.3.3.2.2" xref="A1.E10.m2.4.4.2.2.1.1.3.3.2.2.cmml">x</mi><mn id="A1.E10.m2.4.4.2.2.1.1.3.3.2.3" xref="A1.E10.m2.4.4.2.2.1.1.3.3.2.3.cmml">0</mn><mrow id="A1.E10.m2.2.2.1.3" xref="A1.E10.m2.4.4.2.2.1.1.3.3.cmml"><mo id="A1.E10.m2.2.2.1.3.1" stretchy="false" xref="A1.E10.m2.4.4.2.2.1.1.3.3.cmml">(</mo><mi id="A1.E10.m2.2.2.1.1" xref="A1.E10.m2.2.2.1.1.cmml">j</mi><mo id="A1.E10.m2.2.2.1.3.2" stretchy="false" xref="A1.E10.m2.4.4.2.2.1.1.3.3.cmml">)</mo></mrow></msubsup></mrow><mo id="A1.E10.m2.4.4.2.2.1.1.2" xref="A1.E10.m2.4.4.2.2.1.1.2.cmml">+</mo><mrow id="A1.E10.m2.4.4.2.2.1.1.1" xref="A1.E10.m2.4.4.2.2.1.1.1.cmml"><mrow id="A1.E10.m2.4.4.2.2.1.1.1.1.1" xref="A1.E10.m2.4.4.2.2.1.1.1.1.1.1.cmml"><mo id="A1.E10.m2.4.4.2.2.1.1.1.1.1.2" stretchy="false" xref="A1.E10.m2.4.4.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E10.m2.4.4.2.2.1.1.1.1.1.1" xref="A1.E10.m2.4.4.2.2.1.1.1.1.1.1.cmml"><mn id="A1.E10.m2.4.4.2.2.1.1.1.1.1.1.2" xref="A1.E10.m2.4.4.2.2.1.1.1.1.1.1.2.cmml">1</mn><mo id="A1.E10.m2.4.4.2.2.1.1.1.1.1.1.1" xref="A1.E10.m2.4.4.2.2.1.1.1.1.1.1.1.cmml">−</mo><msub id="A1.E10.m2.4.4.2.2.1.1.1.1.1.1.3" xref="A1.E10.m2.4.4.2.2.1.1.1.1.1.1.3.cmml"><mover accent="true" id="A1.E10.m2.4.4.2.2.1.1.1.1.1.1.3.2" xref="A1.E10.m2.4.4.2.2.1.1.1.1.1.1.3.2.cmml"><mi id="A1.E10.m2.4.4.2.2.1.1.1.1.1.1.3.2.2" xref="A1.E10.m2.4.4.2.2.1.1.1.1.1.1.3.2.2.cmml">α</mi><mo id="A1.E10.m2.4.4.2.2.1.1.1.1.1.1.3.2.1" xref="A1.E10.m2.4.4.2.2.1.1.1.1.1.1.3.2.1.cmml">¯</mo></mover><mrow id="A1.E10.m2.4.4.2.2.1.1.1.1.1.1.3.3" xref="A1.E10.m2.4.4.2.2.1.1.1.1.1.1.3.3.cmml"><mi id="A1.E10.m2.4.4.2.2.1.1.1.1.1.1.3.3.2" xref="A1.E10.m2.4.4.2.2.1.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="A1.E10.m2.4.4.2.2.1.1.1.1.1.1.3.3.1" xref="A1.E10.m2.4.4.2.2.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="A1.E10.m2.4.4.2.2.1.1.1.1.1.1.3.3.3" xref="A1.E10.m2.4.4.2.2.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="A1.E10.m2.4.4.2.2.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="A1.E10.m2.4.4.2.2.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A1.E10.m2.4.4.2.2.1.1.1.2" rspace="0.222em" xref="A1.E10.m2.4.4.2.2.1.1.1.2.cmml">⋅</mo><mstyle displaystyle="true" id="A1.E10.m2.4.4.2.2.1.1.1.3" xref="A1.E10.m2.4.4.2.2.1.1.1.3.cmml"><mfrac id="A1.E10.m2.4.4.2.2.1.1.1.3a" xref="A1.E10.m2.4.4.2.2.1.1.1.3.cmml"><mn id="A1.E10.m2.4.4.2.2.1.1.1.3.2" xref="A1.E10.m2.4.4.2.2.1.1.1.3.2.cmml">1</mn><mn id="A1.E10.m2.4.4.2.2.1.1.1.3.3" xref="A1.E10.m2.4.4.2.2.1.1.1.3.3.cmml">2</mn></mfrac></mstyle></mrow></mrow><mo id="A1.E10.m2.4.4.2.2.1.3" xref="A1.E10.m2.4.4.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E10.m2.4b"><apply id="A1.E10.m2.4.4.cmml" xref="A1.E10.m2.4.4"><eq id="A1.E10.m2.4.4.3.cmml" xref="A1.E10.m2.4.4.3"></eq><csymbol cd="latexml" id="A1.E10.m2.4.4.4.cmml" xref="A1.E10.m2.4.4.4">absent</csymbol><apply id="A1.E10.m2.4.4.2.cmml" xref="A1.E10.m2.4.4.2"><ci id="A1.E10.m2.4.4.2.3.cmml" xref="A1.E10.m2.4.4.2.3">⋅</ci><apply id="A1.E10.m2.3.3.1.1.1.1.cmml" xref="A1.E10.m2.3.3.1.1.1"><plus id="A1.E10.m2.3.3.1.1.1.1.2.cmml" xref="A1.E10.m2.3.3.1.1.1.1.2"></plus><apply id="A1.E10.m2.3.3.1.1.1.1.3.cmml" xref="A1.E10.m2.3.3.1.1.1.1.3"><times id="A1.E10.m2.3.3.1.1.1.1.3.1.cmml" xref="A1.E10.m2.3.3.1.1.1.1.3.1"></times><apply id="A1.E10.m2.3.3.1.1.1.1.3.2.cmml" xref="A1.E10.m2.3.3.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.E10.m2.3.3.1.1.1.1.3.2.1.cmml" xref="A1.E10.m2.3.3.1.1.1.1.3.2">subscript</csymbol><ci id="A1.E10.m2.3.3.1.1.1.1.3.2.2.cmml" xref="A1.E10.m2.3.3.1.1.1.1.3.2.2">𝛼</ci><ci id="A1.E10.m2.3.3.1.1.1.1.3.2.3.cmml" xref="A1.E10.m2.3.3.1.1.1.1.3.2.3">𝑡</ci></apply><apply id="A1.E10.m2.3.3.1.1.1.1.3.3.cmml" xref="A1.E10.m2.3.3.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.E10.m2.3.3.1.1.1.1.3.3.1.cmml" xref="A1.E10.m2.3.3.1.1.1.1.3.3">superscript</csymbol><apply id="A1.E10.m2.3.3.1.1.1.1.3.3.2.cmml" xref="A1.E10.m2.3.3.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.E10.m2.3.3.1.1.1.1.3.3.2.1.cmml" xref="A1.E10.m2.3.3.1.1.1.1.3.3">subscript</csymbol><ci id="A1.E10.m2.3.3.1.1.1.1.3.3.2.2.cmml" xref="A1.E10.m2.3.3.1.1.1.1.3.3.2.2">𝑥</ci><ci id="A1.E10.m2.3.3.1.1.1.1.3.3.2.3.cmml" xref="A1.E10.m2.3.3.1.1.1.1.3.3.2.3">𝑡</ci></apply><ci id="A1.E10.m2.1.1.1.1.cmml" xref="A1.E10.m2.1.1.1.1">𝑗</ci></apply></apply><apply id="A1.E10.m2.3.3.1.1.1.1.1.cmml" xref="A1.E10.m2.3.3.1.1.1.1.1"><ci id="A1.E10.m2.3.3.1.1.1.1.1.2.cmml" xref="A1.E10.m2.3.3.1.1.1.1.1.2">⋅</ci><apply id="A1.E10.m2.3.3.1.1.1.1.1.1.1.1.cmml" xref="A1.E10.m2.3.3.1.1.1.1.1.1.1"><minus id="A1.E10.m2.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E10.m2.3.3.1.1.1.1.1.1.1.1.1"></minus><cn id="A1.E10.m2.3.3.1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="A1.E10.m2.3.3.1.1.1.1.1.1.1.1.2">1</cn><apply id="A1.E10.m2.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E10.m2.3.3.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E10.m2.3.3.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E10.m2.3.3.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E10.m2.3.3.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E10.m2.3.3.1.1.1.1.1.1.1.1.3.2">𝛼</ci><ci id="A1.E10.m2.3.3.1.1.1.1.1.1.1.1.3.3.cmml" xref="A1.E10.m2.3.3.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply><apply id="A1.E10.m2.3.3.1.1.1.1.1.3.cmml" xref="A1.E10.m2.3.3.1.1.1.1.1.3"><divide id="A1.E10.m2.3.3.1.1.1.1.1.3.1.cmml" xref="A1.E10.m2.3.3.1.1.1.1.1.3"></divide><cn id="A1.E10.m2.3.3.1.1.1.1.1.3.2.cmml" type="integer" xref="A1.E10.m2.3.3.1.1.1.1.1.3.2">1</cn><cn id="A1.E10.m2.3.3.1.1.1.1.1.3.3.cmml" type="integer" xref="A1.E10.m2.3.3.1.1.1.1.1.3.3">2</cn></apply></apply></apply><apply id="A1.E10.m2.4.4.2.2.1.1.cmml" xref="A1.E10.m2.4.4.2.2.1"><plus id="A1.E10.m2.4.4.2.2.1.1.2.cmml" xref="A1.E10.m2.4.4.2.2.1.1.2"></plus><apply id="A1.E10.m2.4.4.2.2.1.1.3.cmml" xref="A1.E10.m2.4.4.2.2.1.1.3"><times id="A1.E10.m2.4.4.2.2.1.1.3.1.cmml" xref="A1.E10.m2.4.4.2.2.1.1.3.1"></times><apply id="A1.E10.m2.4.4.2.2.1.1.3.2.cmml" xref="A1.E10.m2.4.4.2.2.1.1.3.2"><csymbol cd="ambiguous" id="A1.E10.m2.4.4.2.2.1.1.3.2.1.cmml" xref="A1.E10.m2.4.4.2.2.1.1.3.2">subscript</csymbol><apply id="A1.E10.m2.4.4.2.2.1.1.3.2.2.cmml" xref="A1.E10.m2.4.4.2.2.1.1.3.2.2"><ci id="A1.E10.m2.4.4.2.2.1.1.3.2.2.1.cmml" xref="A1.E10.m2.4.4.2.2.1.1.3.2.2.1">¯</ci><ci id="A1.E10.m2.4.4.2.2.1.1.3.2.2.2.cmml" xref="A1.E10.m2.4.4.2.2.1.1.3.2.2.2">𝛼</ci></apply><apply id="A1.E10.m2.4.4.2.2.1.1.3.2.3.cmml" xref="A1.E10.m2.4.4.2.2.1.1.3.2.3"><minus id="A1.E10.m2.4.4.2.2.1.1.3.2.3.1.cmml" xref="A1.E10.m2.4.4.2.2.1.1.3.2.3.1"></minus><ci id="A1.E10.m2.4.4.2.2.1.1.3.2.3.2.cmml" xref="A1.E10.m2.4.4.2.2.1.1.3.2.3.2">𝑡</ci><cn id="A1.E10.m2.4.4.2.2.1.1.3.2.3.3.cmml" type="integer" xref="A1.E10.m2.4.4.2.2.1.1.3.2.3.3">1</cn></apply></apply><apply id="A1.E10.m2.4.4.2.2.1.1.3.3.cmml" xref="A1.E10.m2.4.4.2.2.1.1.3.3"><csymbol cd="ambiguous" id="A1.E10.m2.4.4.2.2.1.1.3.3.1.cmml" xref="A1.E10.m2.4.4.2.2.1.1.3.3">superscript</csymbol><apply id="A1.E10.m2.4.4.2.2.1.1.3.3.2.cmml" xref="A1.E10.m2.4.4.2.2.1.1.3.3"><csymbol cd="ambiguous" id="A1.E10.m2.4.4.2.2.1.1.3.3.2.1.cmml" xref="A1.E10.m2.4.4.2.2.1.1.3.3">subscript</csymbol><ci id="A1.E10.m2.4.4.2.2.1.1.3.3.2.2.cmml" xref="A1.E10.m2.4.4.2.2.1.1.3.3.2.2">𝑥</ci><cn id="A1.E10.m2.4.4.2.2.1.1.3.3.2.3.cmml" type="integer" xref="A1.E10.m2.4.4.2.2.1.1.3.3.2.3">0</cn></apply><ci id="A1.E10.m2.2.2.1.1.cmml" xref="A1.E10.m2.2.2.1.1">𝑗</ci></apply></apply><apply id="A1.E10.m2.4.4.2.2.1.1.1.cmml" xref="A1.E10.m2.4.4.2.2.1.1.1"><ci id="A1.E10.m2.4.4.2.2.1.1.1.2.cmml" xref="A1.E10.m2.4.4.2.2.1.1.1.2">⋅</ci><apply id="A1.E10.m2.4.4.2.2.1.1.1.1.1.1.cmml" xref="A1.E10.m2.4.4.2.2.1.1.1.1.1"><minus id="A1.E10.m2.4.4.2.2.1.1.1.1.1.1.1.cmml" xref="A1.E10.m2.4.4.2.2.1.1.1.1.1.1.1"></minus><cn id="A1.E10.m2.4.4.2.2.1.1.1.1.1.1.2.cmml" type="integer" xref="A1.E10.m2.4.4.2.2.1.1.1.1.1.1.2">1</cn><apply id="A1.E10.m2.4.4.2.2.1.1.1.1.1.1.3.cmml" xref="A1.E10.m2.4.4.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E10.m2.4.4.2.2.1.1.1.1.1.1.3.1.cmml" xref="A1.E10.m2.4.4.2.2.1.1.1.1.1.1.3">subscript</csymbol><apply id="A1.E10.m2.4.4.2.2.1.1.1.1.1.1.3.2.cmml" xref="A1.E10.m2.4.4.2.2.1.1.1.1.1.1.3.2"><ci id="A1.E10.m2.4.4.2.2.1.1.1.1.1.1.3.2.1.cmml" xref="A1.E10.m2.4.4.2.2.1.1.1.1.1.1.3.2.1">¯</ci><ci id="A1.E10.m2.4.4.2.2.1.1.1.1.1.1.3.2.2.cmml" xref="A1.E10.m2.4.4.2.2.1.1.1.1.1.1.3.2.2">𝛼</ci></apply><apply id="A1.E10.m2.4.4.2.2.1.1.1.1.1.1.3.3.cmml" xref="A1.E10.m2.4.4.2.2.1.1.1.1.1.1.3.3"><minus id="A1.E10.m2.4.4.2.2.1.1.1.1.1.1.3.3.1.cmml" xref="A1.E10.m2.4.4.2.2.1.1.1.1.1.1.3.3.1"></minus><ci id="A1.E10.m2.4.4.2.2.1.1.1.1.1.1.3.3.2.cmml" xref="A1.E10.m2.4.4.2.2.1.1.1.1.1.1.3.3.2">𝑡</ci><cn id="A1.E10.m2.4.4.2.2.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="A1.E10.m2.4.4.2.2.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply><apply id="A1.E10.m2.4.4.2.2.1.1.1.3.cmml" xref="A1.E10.m2.4.4.2.2.1.1.1.3"><divide id="A1.E10.m2.4.4.2.2.1.1.1.3.1.cmml" xref="A1.E10.m2.4.4.2.2.1.1.1.3"></divide><cn id="A1.E10.m2.4.4.2.2.1.1.1.3.2.cmml" type="integer" xref="A1.E10.m2.4.4.2.2.1.1.1.3.2">1</cn><cn id="A1.E10.m2.4.4.2.2.1.1.1.3.3.cmml" type="integer" xref="A1.E10.m2.4.4.2.2.1.1.1.3.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E10.m2.4c">\displaystyle=\left(\alpha_{t}x_{t}^{(j)}+(1-\alpha_{t})\cdot\frac{1}{2}\right%
)\cdot\left(\bar{\alpha}_{t-1}x_{0}^{(j)}+(1-\bar{\alpha}_{t-1})\cdot\frac{1}{%
2}\right)</annotation><annotation encoding="application/x-llamapun" id="A1.E10.m2.4d">= ( italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT + ( 1 - italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ⋅ divide start_ARG 1 end_ARG start_ARG 2 end_ARG ) ⋅ ( over¯ start_ARG italic_α end_ARG start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT + ( 1 - over¯ start_ARG italic_α end_ARG start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT ) ⋅ divide start_ARG 1 end_ARG start_ARG 2 end_ARG )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
<tbody id="A1.E11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\theta_{0}(x_{t}^{(j)},x_{0}^{(j)})" class="ltx_Math" display="inline" id="A1.E11.m1.4"><semantics id="A1.E11.m1.4a"><mrow id="A1.E11.m1.4.4" xref="A1.E11.m1.4.4.cmml"><msub id="A1.E11.m1.4.4.4" xref="A1.E11.m1.4.4.4.cmml"><mi id="A1.E11.m1.4.4.4.2" xref="A1.E11.m1.4.4.4.2.cmml">θ</mi><mn id="A1.E11.m1.4.4.4.3" xref="A1.E11.m1.4.4.4.3.cmml">0</mn></msub><mo id="A1.E11.m1.4.4.3" xref="A1.E11.m1.4.4.3.cmml">⁢</mo><mrow id="A1.E11.m1.4.4.2.2" xref="A1.E11.m1.4.4.2.3.cmml"><mo id="A1.E11.m1.4.4.2.2.3" stretchy="false" xref="A1.E11.m1.4.4.2.3.cmml">(</mo><msubsup id="A1.E11.m1.3.3.1.1.1" xref="A1.E11.m1.3.3.1.1.1.cmml"><mi id="A1.E11.m1.3.3.1.1.1.2.2" xref="A1.E11.m1.3.3.1.1.1.2.2.cmml">x</mi><mi id="A1.E11.m1.3.3.1.1.1.2.3" xref="A1.E11.m1.3.3.1.1.1.2.3.cmml">t</mi><mrow id="A1.E11.m1.1.1.1.3" xref="A1.E11.m1.3.3.1.1.1.cmml"><mo id="A1.E11.m1.1.1.1.3.1" stretchy="false" xref="A1.E11.m1.3.3.1.1.1.cmml">(</mo><mi id="A1.E11.m1.1.1.1.1" xref="A1.E11.m1.1.1.1.1.cmml">j</mi><mo id="A1.E11.m1.1.1.1.3.2" stretchy="false" xref="A1.E11.m1.3.3.1.1.1.cmml">)</mo></mrow></msubsup><mo id="A1.E11.m1.4.4.2.2.4" xref="A1.E11.m1.4.4.2.3.cmml">,</mo><msubsup id="A1.E11.m1.4.4.2.2.2" xref="A1.E11.m1.4.4.2.2.2.cmml"><mi id="A1.E11.m1.4.4.2.2.2.2.2" xref="A1.E11.m1.4.4.2.2.2.2.2.cmml">x</mi><mn id="A1.E11.m1.4.4.2.2.2.2.3" xref="A1.E11.m1.4.4.2.2.2.2.3.cmml">0</mn><mrow id="A1.E11.m1.2.2.1.3" xref="A1.E11.m1.4.4.2.2.2.cmml"><mo id="A1.E11.m1.2.2.1.3.1" stretchy="false" xref="A1.E11.m1.4.4.2.2.2.cmml">(</mo><mi id="A1.E11.m1.2.2.1.1" xref="A1.E11.m1.2.2.1.1.cmml">j</mi><mo id="A1.E11.m1.2.2.1.3.2" stretchy="false" xref="A1.E11.m1.4.4.2.2.2.cmml">)</mo></mrow></msubsup><mo id="A1.E11.m1.4.4.2.2.5" stretchy="false" xref="A1.E11.m1.4.4.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E11.m1.4b"><apply id="A1.E11.m1.4.4.cmml" xref="A1.E11.m1.4.4"><times id="A1.E11.m1.4.4.3.cmml" xref="A1.E11.m1.4.4.3"></times><apply id="A1.E11.m1.4.4.4.cmml" xref="A1.E11.m1.4.4.4"><csymbol cd="ambiguous" id="A1.E11.m1.4.4.4.1.cmml" xref="A1.E11.m1.4.4.4">subscript</csymbol><ci id="A1.E11.m1.4.4.4.2.cmml" xref="A1.E11.m1.4.4.4.2">𝜃</ci><cn id="A1.E11.m1.4.4.4.3.cmml" type="integer" xref="A1.E11.m1.4.4.4.3">0</cn></apply><interval closure="open" id="A1.E11.m1.4.4.2.3.cmml" xref="A1.E11.m1.4.4.2.2"><apply id="A1.E11.m1.3.3.1.1.1.cmml" xref="A1.E11.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="A1.E11.m1.3.3.1.1.1.1.cmml" xref="A1.E11.m1.3.3.1.1.1">superscript</csymbol><apply id="A1.E11.m1.3.3.1.1.1.2.cmml" xref="A1.E11.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="A1.E11.m1.3.3.1.1.1.2.1.cmml" xref="A1.E11.m1.3.3.1.1.1">subscript</csymbol><ci id="A1.E11.m1.3.3.1.1.1.2.2.cmml" xref="A1.E11.m1.3.3.1.1.1.2.2">𝑥</ci><ci id="A1.E11.m1.3.3.1.1.1.2.3.cmml" xref="A1.E11.m1.3.3.1.1.1.2.3">𝑡</ci></apply><ci id="A1.E11.m1.1.1.1.1.cmml" xref="A1.E11.m1.1.1.1.1">𝑗</ci></apply><apply id="A1.E11.m1.4.4.2.2.2.cmml" xref="A1.E11.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="A1.E11.m1.4.4.2.2.2.1.cmml" xref="A1.E11.m1.4.4.2.2.2">superscript</csymbol><apply id="A1.E11.m1.4.4.2.2.2.2.cmml" xref="A1.E11.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="A1.E11.m1.4.4.2.2.2.2.1.cmml" xref="A1.E11.m1.4.4.2.2.2">subscript</csymbol><ci id="A1.E11.m1.4.4.2.2.2.2.2.cmml" xref="A1.E11.m1.4.4.2.2.2.2.2">𝑥</ci><cn id="A1.E11.m1.4.4.2.2.2.2.3.cmml" type="integer" xref="A1.E11.m1.4.4.2.2.2.2.3">0</cn></apply><ci id="A1.E11.m1.2.2.1.1.cmml" xref="A1.E11.m1.2.2.1.1">𝑗</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E11.m1.4c">\displaystyle\theta_{0}(x_{t}^{(j)},x_{0}^{(j)})</annotation><annotation encoding="application/x-llamapun" id="A1.E11.m1.4d">italic_θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT , italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\left(\alpha_{t}(1-x_{t}^{(j)})+(1-\alpha_{t})\cdot\frac{1}{2}%
\right)\cdot\left(\bar{\alpha}_{t-1}(1-x_{0}^{(j)})+(1-\bar{\alpha}_{t-1})%
\cdot\frac{1}{2}\right)." class="ltx_Math" display="inline" id="A1.E11.m2.3"><semantics id="A1.E11.m2.3a"><mrow id="A1.E11.m2.3.3.1" xref="A1.E11.m2.3.3.1.1.cmml"><mrow id="A1.E11.m2.3.3.1.1" xref="A1.E11.m2.3.3.1.1.cmml"><mi id="A1.E11.m2.3.3.1.1.4" xref="A1.E11.m2.3.3.1.1.4.cmml"></mi><mo id="A1.E11.m2.3.3.1.1.3" xref="A1.E11.m2.3.3.1.1.3.cmml">=</mo><mrow id="A1.E11.m2.3.3.1.1.2" xref="A1.E11.m2.3.3.1.1.2.cmml"><mrow id="A1.E11.m2.3.3.1.1.1.1.1" xref="A1.E11.m2.3.3.1.1.1.1.1.1.cmml"><mo id="A1.E11.m2.3.3.1.1.1.1.1.2" xref="A1.E11.m2.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E11.m2.3.3.1.1.1.1.1.1" xref="A1.E11.m2.3.3.1.1.1.1.1.1.cmml"><mrow id="A1.E11.m2.3.3.1.1.1.1.1.1.1" xref="A1.E11.m2.3.3.1.1.1.1.1.1.1.cmml"><msub id="A1.E11.m2.3.3.1.1.1.1.1.1.1.3" xref="A1.E11.m2.3.3.1.1.1.1.1.1.1.3.cmml"><mi id="A1.E11.m2.3.3.1.1.1.1.1.1.1.3.2" xref="A1.E11.m2.3.3.1.1.1.1.1.1.1.3.2.cmml">α</mi><mi id="A1.E11.m2.3.3.1.1.1.1.1.1.1.3.3" xref="A1.E11.m2.3.3.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub><mo id="A1.E11.m2.3.3.1.1.1.1.1.1.1.2" xref="A1.E11.m2.3.3.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E11.m2.3.3.1.1.1.1.1.1.1.1.1" xref="A1.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E11.m2.3.3.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1" xref="A1.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mn id="A1.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="A1.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="A1.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msubsup id="A1.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="A1.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">x</mi><mi id="A1.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="A1.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">t</mi><mrow id="A1.E11.m2.1.1.1.3" xref="A1.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml"><mo id="A1.E11.m2.1.1.1.3.1" stretchy="false" xref="A1.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml">(</mo><mi id="A1.E11.m2.1.1.1.1" xref="A1.E11.m2.1.1.1.1.cmml">j</mi><mo id="A1.E11.m2.1.1.1.3.2" stretchy="false" xref="A1.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo id="A1.E11.m2.3.3.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E11.m2.3.3.1.1.1.1.1.1.3" xref="A1.E11.m2.3.3.1.1.1.1.1.1.3.cmml">+</mo><mrow id="A1.E11.m2.3.3.1.1.1.1.1.1.2" xref="A1.E11.m2.3.3.1.1.1.1.1.1.2.cmml"><mrow id="A1.E11.m2.3.3.1.1.1.1.1.1.2.1.1" xref="A1.E11.m2.3.3.1.1.1.1.1.1.2.1.1.1.cmml"><mo id="A1.E11.m2.3.3.1.1.1.1.1.1.2.1.1.2" stretchy="false" xref="A1.E11.m2.3.3.1.1.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="A1.E11.m2.3.3.1.1.1.1.1.1.2.1.1.1" xref="A1.E11.m2.3.3.1.1.1.1.1.1.2.1.1.1.cmml"><mn id="A1.E11.m2.3.3.1.1.1.1.1.1.2.1.1.1.2" xref="A1.E11.m2.3.3.1.1.1.1.1.1.2.1.1.1.2.cmml">1</mn><mo id="A1.E11.m2.3.3.1.1.1.1.1.1.2.1.1.1.1" xref="A1.E11.m2.3.3.1.1.1.1.1.1.2.1.1.1.1.cmml">−</mo><msub id="A1.E11.m2.3.3.1.1.1.1.1.1.2.1.1.1.3" xref="A1.E11.m2.3.3.1.1.1.1.1.1.2.1.1.1.3.cmml"><mi id="A1.E11.m2.3.3.1.1.1.1.1.1.2.1.1.1.3.2" xref="A1.E11.m2.3.3.1.1.1.1.1.1.2.1.1.1.3.2.cmml">α</mi><mi id="A1.E11.m2.3.3.1.1.1.1.1.1.2.1.1.1.3.3" xref="A1.E11.m2.3.3.1.1.1.1.1.1.2.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="A1.E11.m2.3.3.1.1.1.1.1.1.2.1.1.3" rspace="0.055em" stretchy="false" xref="A1.E11.m2.3.3.1.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow><mo id="A1.E11.m2.3.3.1.1.1.1.1.1.2.2" rspace="0.222em" xref="A1.E11.m2.3.3.1.1.1.1.1.1.2.2.cmml">⋅</mo><mstyle displaystyle="true" id="A1.E11.m2.3.3.1.1.1.1.1.1.2.3" xref="A1.E11.m2.3.3.1.1.1.1.1.1.2.3.cmml"><mfrac id="A1.E11.m2.3.3.1.1.1.1.1.1.2.3a" xref="A1.E11.m2.3.3.1.1.1.1.1.1.2.3.cmml"><mn id="A1.E11.m2.3.3.1.1.1.1.1.1.2.3.2" xref="A1.E11.m2.3.3.1.1.1.1.1.1.2.3.2.cmml">1</mn><mn id="A1.E11.m2.3.3.1.1.1.1.1.1.2.3.3" xref="A1.E11.m2.3.3.1.1.1.1.1.1.2.3.3.cmml">2</mn></mfrac></mstyle></mrow></mrow><mo id="A1.E11.m2.3.3.1.1.1.1.1.3" rspace="0.055em" xref="A1.E11.m2.3.3.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A1.E11.m2.3.3.1.1.2.3" rspace="0.222em" xref="A1.E11.m2.3.3.1.1.2.3.cmml">⋅</mo><mrow id="A1.E11.m2.3.3.1.1.2.2.1" xref="A1.E11.m2.3.3.1.1.2.2.1.1.cmml"><mo id="A1.E11.m2.3.3.1.1.2.2.1.2" xref="A1.E11.m2.3.3.1.1.2.2.1.1.cmml">(</mo><mrow id="A1.E11.m2.3.3.1.1.2.2.1.1" xref="A1.E11.m2.3.3.1.1.2.2.1.1.cmml"><mrow id="A1.E11.m2.3.3.1.1.2.2.1.1.1" xref="A1.E11.m2.3.3.1.1.2.2.1.1.1.cmml"><msub id="A1.E11.m2.3.3.1.1.2.2.1.1.1.3" xref="A1.E11.m2.3.3.1.1.2.2.1.1.1.3.cmml"><mover accent="true" id="A1.E11.m2.3.3.1.1.2.2.1.1.1.3.2" xref="A1.E11.m2.3.3.1.1.2.2.1.1.1.3.2.cmml"><mi id="A1.E11.m2.3.3.1.1.2.2.1.1.1.3.2.2" xref="A1.E11.m2.3.3.1.1.2.2.1.1.1.3.2.2.cmml">α</mi><mo id="A1.E11.m2.3.3.1.1.2.2.1.1.1.3.2.1" xref="A1.E11.m2.3.3.1.1.2.2.1.1.1.3.2.1.cmml">¯</mo></mover><mrow id="A1.E11.m2.3.3.1.1.2.2.1.1.1.3.3" xref="A1.E11.m2.3.3.1.1.2.2.1.1.1.3.3.cmml"><mi id="A1.E11.m2.3.3.1.1.2.2.1.1.1.3.3.2" xref="A1.E11.m2.3.3.1.1.2.2.1.1.1.3.3.2.cmml">t</mi><mo id="A1.E11.m2.3.3.1.1.2.2.1.1.1.3.3.1" xref="A1.E11.m2.3.3.1.1.2.2.1.1.1.3.3.1.cmml">−</mo><mn id="A1.E11.m2.3.3.1.1.2.2.1.1.1.3.3.3" xref="A1.E11.m2.3.3.1.1.2.2.1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo id="A1.E11.m2.3.3.1.1.2.2.1.1.1.2" xref="A1.E11.m2.3.3.1.1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="A1.E11.m2.3.3.1.1.2.2.1.1.1.1.1" xref="A1.E11.m2.3.3.1.1.2.2.1.1.1.1.1.1.cmml"><mo id="A1.E11.m2.3.3.1.1.2.2.1.1.1.1.1.2" stretchy="false" xref="A1.E11.m2.3.3.1.1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E11.m2.3.3.1.1.2.2.1.1.1.1.1.1" xref="A1.E11.m2.3.3.1.1.2.2.1.1.1.1.1.1.cmml"><mn id="A1.E11.m2.3.3.1.1.2.2.1.1.1.1.1.1.2" xref="A1.E11.m2.3.3.1.1.2.2.1.1.1.1.1.1.2.cmml">1</mn><mo id="A1.E11.m2.3.3.1.1.2.2.1.1.1.1.1.1.1" xref="A1.E11.m2.3.3.1.1.2.2.1.1.1.1.1.1.1.cmml">−</mo><msubsup id="A1.E11.m2.3.3.1.1.2.2.1.1.1.1.1.1.3" xref="A1.E11.m2.3.3.1.1.2.2.1.1.1.1.1.1.3.cmml"><mi id="A1.E11.m2.3.3.1.1.2.2.1.1.1.1.1.1.3.2.2" xref="A1.E11.m2.3.3.1.1.2.2.1.1.1.1.1.1.3.2.2.cmml">x</mi><mn id="A1.E11.m2.3.3.1.1.2.2.1.1.1.1.1.1.3.2.3" xref="A1.E11.m2.3.3.1.1.2.2.1.1.1.1.1.1.3.2.3.cmml">0</mn><mrow id="A1.E11.m2.2.2.1.3" xref="A1.E11.m2.3.3.1.1.2.2.1.1.1.1.1.1.3.cmml"><mo id="A1.E11.m2.2.2.1.3.1" stretchy="false" xref="A1.E11.m2.3.3.1.1.2.2.1.1.1.1.1.1.3.cmml">(</mo><mi id="A1.E11.m2.2.2.1.1" xref="A1.E11.m2.2.2.1.1.cmml">j</mi><mo id="A1.E11.m2.2.2.1.3.2" stretchy="false" xref="A1.E11.m2.3.3.1.1.2.2.1.1.1.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo id="A1.E11.m2.3.3.1.1.2.2.1.1.1.1.1.3" stretchy="false" xref="A1.E11.m2.3.3.1.1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E11.m2.3.3.1.1.2.2.1.1.3" xref="A1.E11.m2.3.3.1.1.2.2.1.1.3.cmml">+</mo><mrow id="A1.E11.m2.3.3.1.1.2.2.1.1.2" xref="A1.E11.m2.3.3.1.1.2.2.1.1.2.cmml"><mrow id="A1.E11.m2.3.3.1.1.2.2.1.1.2.1.1" xref="A1.E11.m2.3.3.1.1.2.2.1.1.2.1.1.1.cmml"><mo id="A1.E11.m2.3.3.1.1.2.2.1.1.2.1.1.2" stretchy="false" xref="A1.E11.m2.3.3.1.1.2.2.1.1.2.1.1.1.cmml">(</mo><mrow id="A1.E11.m2.3.3.1.1.2.2.1.1.2.1.1.1" xref="A1.E11.m2.3.3.1.1.2.2.1.1.2.1.1.1.cmml"><mn id="A1.E11.m2.3.3.1.1.2.2.1.1.2.1.1.1.2" xref="A1.E11.m2.3.3.1.1.2.2.1.1.2.1.1.1.2.cmml">1</mn><mo id="A1.E11.m2.3.3.1.1.2.2.1.1.2.1.1.1.1" xref="A1.E11.m2.3.3.1.1.2.2.1.1.2.1.1.1.1.cmml">−</mo><msub id="A1.E11.m2.3.3.1.1.2.2.1.1.2.1.1.1.3" xref="A1.E11.m2.3.3.1.1.2.2.1.1.2.1.1.1.3.cmml"><mover accent="true" id="A1.E11.m2.3.3.1.1.2.2.1.1.2.1.1.1.3.2" xref="A1.E11.m2.3.3.1.1.2.2.1.1.2.1.1.1.3.2.cmml"><mi id="A1.E11.m2.3.3.1.1.2.2.1.1.2.1.1.1.3.2.2" xref="A1.E11.m2.3.3.1.1.2.2.1.1.2.1.1.1.3.2.2.cmml">α</mi><mo id="A1.E11.m2.3.3.1.1.2.2.1.1.2.1.1.1.3.2.1" xref="A1.E11.m2.3.3.1.1.2.2.1.1.2.1.1.1.3.2.1.cmml">¯</mo></mover><mrow id="A1.E11.m2.3.3.1.1.2.2.1.1.2.1.1.1.3.3" xref="A1.E11.m2.3.3.1.1.2.2.1.1.2.1.1.1.3.3.cmml"><mi id="A1.E11.m2.3.3.1.1.2.2.1.1.2.1.1.1.3.3.2" xref="A1.E11.m2.3.3.1.1.2.2.1.1.2.1.1.1.3.3.2.cmml">t</mi><mo id="A1.E11.m2.3.3.1.1.2.2.1.1.2.1.1.1.3.3.1" xref="A1.E11.m2.3.3.1.1.2.2.1.1.2.1.1.1.3.3.1.cmml">−</mo><mn id="A1.E11.m2.3.3.1.1.2.2.1.1.2.1.1.1.3.3.3" xref="A1.E11.m2.3.3.1.1.2.2.1.1.2.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="A1.E11.m2.3.3.1.1.2.2.1.1.2.1.1.3" rspace="0.055em" stretchy="false" xref="A1.E11.m2.3.3.1.1.2.2.1.1.2.1.1.1.cmml">)</mo></mrow><mo id="A1.E11.m2.3.3.1.1.2.2.1.1.2.2" rspace="0.222em" xref="A1.E11.m2.3.3.1.1.2.2.1.1.2.2.cmml">⋅</mo><mstyle displaystyle="true" id="A1.E11.m2.3.3.1.1.2.2.1.1.2.3" xref="A1.E11.m2.3.3.1.1.2.2.1.1.2.3.cmml"><mfrac id="A1.E11.m2.3.3.1.1.2.2.1.1.2.3a" xref="A1.E11.m2.3.3.1.1.2.2.1.1.2.3.cmml"><mn id="A1.E11.m2.3.3.1.1.2.2.1.1.2.3.2" xref="A1.E11.m2.3.3.1.1.2.2.1.1.2.3.2.cmml">1</mn><mn id="A1.E11.m2.3.3.1.1.2.2.1.1.2.3.3" xref="A1.E11.m2.3.3.1.1.2.2.1.1.2.3.3.cmml">2</mn></mfrac></mstyle></mrow></mrow><mo id="A1.E11.m2.3.3.1.1.2.2.1.3" xref="A1.E11.m2.3.3.1.1.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E11.m2.3.3.1.2" lspace="0em" xref="A1.E11.m2.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E11.m2.3b"><apply id="A1.E11.m2.3.3.1.1.cmml" xref="A1.E11.m2.3.3.1"><eq id="A1.E11.m2.3.3.1.1.3.cmml" xref="A1.E11.m2.3.3.1.1.3"></eq><csymbol cd="latexml" id="A1.E11.m2.3.3.1.1.4.cmml" xref="A1.E11.m2.3.3.1.1.4">absent</csymbol><apply id="A1.E11.m2.3.3.1.1.2.cmml" xref="A1.E11.m2.3.3.1.1.2"><ci id="A1.E11.m2.3.3.1.1.2.3.cmml" xref="A1.E11.m2.3.3.1.1.2.3">⋅</ci><apply id="A1.E11.m2.3.3.1.1.1.1.1.1.cmml" xref="A1.E11.m2.3.3.1.1.1.1.1"><plus id="A1.E11.m2.3.3.1.1.1.1.1.1.3.cmml" xref="A1.E11.m2.3.3.1.1.1.1.1.1.3"></plus><apply id="A1.E11.m2.3.3.1.1.1.1.1.1.1.cmml" xref="A1.E11.m2.3.3.1.1.1.1.1.1.1"><times id="A1.E11.m2.3.3.1.1.1.1.1.1.1.2.cmml" xref="A1.E11.m2.3.3.1.1.1.1.1.1.1.2"></times><apply id="A1.E11.m2.3.3.1.1.1.1.1.1.1.3.cmml" xref="A1.E11.m2.3.3.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E11.m2.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E11.m2.3.3.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E11.m2.3.3.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E11.m2.3.3.1.1.1.1.1.1.1.3.2">𝛼</ci><ci id="A1.E11.m2.3.3.1.1.1.1.1.1.1.3.3.cmml" xref="A1.E11.m2.3.3.1.1.1.1.1.1.1.3.3">𝑡</ci></apply><apply id="A1.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E11.m2.3.3.1.1.1.1.1.1.1.1.1"><minus id="A1.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.1"></minus><cn id="A1.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="A1.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.2">1</cn><apply id="A1.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="A1.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="A1.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="A1.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.2.2">𝑥</ci><ci id="A1.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="A1.E11.m2.3.3.1.1.1.1.1.1.1.1.1.1.3.2.3">𝑡</ci></apply><ci id="A1.E11.m2.1.1.1.1.cmml" xref="A1.E11.m2.1.1.1.1">𝑗</ci></apply></apply></apply><apply id="A1.E11.m2.3.3.1.1.1.1.1.1.2.cmml" xref="A1.E11.m2.3.3.1.1.1.1.1.1.2"><ci id="A1.E11.m2.3.3.1.1.1.1.1.1.2.2.cmml" xref="A1.E11.m2.3.3.1.1.1.1.1.1.2.2">⋅</ci><apply id="A1.E11.m2.3.3.1.1.1.1.1.1.2.1.1.1.cmml" xref="A1.E11.m2.3.3.1.1.1.1.1.1.2.1.1"><minus id="A1.E11.m2.3.3.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="A1.E11.m2.3.3.1.1.1.1.1.1.2.1.1.1.1"></minus><cn id="A1.E11.m2.3.3.1.1.1.1.1.1.2.1.1.1.2.cmml" type="integer" xref="A1.E11.m2.3.3.1.1.1.1.1.1.2.1.1.1.2">1</cn><apply id="A1.E11.m2.3.3.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="A1.E11.m2.3.3.1.1.1.1.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="A1.E11.m2.3.3.1.1.1.1.1.1.2.1.1.1.3.1.cmml" xref="A1.E11.m2.3.3.1.1.1.1.1.1.2.1.1.1.3">subscript</csymbol><ci id="A1.E11.m2.3.3.1.1.1.1.1.1.2.1.1.1.3.2.cmml" xref="A1.E11.m2.3.3.1.1.1.1.1.1.2.1.1.1.3.2">𝛼</ci><ci id="A1.E11.m2.3.3.1.1.1.1.1.1.2.1.1.1.3.3.cmml" xref="A1.E11.m2.3.3.1.1.1.1.1.1.2.1.1.1.3.3">𝑡</ci></apply></apply><apply id="A1.E11.m2.3.3.1.1.1.1.1.1.2.3.cmml" xref="A1.E11.m2.3.3.1.1.1.1.1.1.2.3"><divide id="A1.E11.m2.3.3.1.1.1.1.1.1.2.3.1.cmml" xref="A1.E11.m2.3.3.1.1.1.1.1.1.2.3"></divide><cn id="A1.E11.m2.3.3.1.1.1.1.1.1.2.3.2.cmml" type="integer" xref="A1.E11.m2.3.3.1.1.1.1.1.1.2.3.2">1</cn><cn id="A1.E11.m2.3.3.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="A1.E11.m2.3.3.1.1.1.1.1.1.2.3.3">2</cn></apply></apply></apply><apply id="A1.E11.m2.3.3.1.1.2.2.1.1.cmml" xref="A1.E11.m2.3.3.1.1.2.2.1"><plus id="A1.E11.m2.3.3.1.1.2.2.1.1.3.cmml" xref="A1.E11.m2.3.3.1.1.2.2.1.1.3"></plus><apply id="A1.E11.m2.3.3.1.1.2.2.1.1.1.cmml" xref="A1.E11.m2.3.3.1.1.2.2.1.1.1"><times id="A1.E11.m2.3.3.1.1.2.2.1.1.1.2.cmml" xref="A1.E11.m2.3.3.1.1.2.2.1.1.1.2"></times><apply id="A1.E11.m2.3.3.1.1.2.2.1.1.1.3.cmml" xref="A1.E11.m2.3.3.1.1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="A1.E11.m2.3.3.1.1.2.2.1.1.1.3.1.cmml" xref="A1.E11.m2.3.3.1.1.2.2.1.1.1.3">subscript</csymbol><apply id="A1.E11.m2.3.3.1.1.2.2.1.1.1.3.2.cmml" xref="A1.E11.m2.3.3.1.1.2.2.1.1.1.3.2"><ci id="A1.E11.m2.3.3.1.1.2.2.1.1.1.3.2.1.cmml" xref="A1.E11.m2.3.3.1.1.2.2.1.1.1.3.2.1">¯</ci><ci id="A1.E11.m2.3.3.1.1.2.2.1.1.1.3.2.2.cmml" xref="A1.E11.m2.3.3.1.1.2.2.1.1.1.3.2.2">𝛼</ci></apply><apply id="A1.E11.m2.3.3.1.1.2.2.1.1.1.3.3.cmml" xref="A1.E11.m2.3.3.1.1.2.2.1.1.1.3.3"><minus id="A1.E11.m2.3.3.1.1.2.2.1.1.1.3.3.1.cmml" xref="A1.E11.m2.3.3.1.1.2.2.1.1.1.3.3.1"></minus><ci id="A1.E11.m2.3.3.1.1.2.2.1.1.1.3.3.2.cmml" xref="A1.E11.m2.3.3.1.1.2.2.1.1.1.3.3.2">𝑡</ci><cn id="A1.E11.m2.3.3.1.1.2.2.1.1.1.3.3.3.cmml" type="integer" xref="A1.E11.m2.3.3.1.1.2.2.1.1.1.3.3.3">1</cn></apply></apply><apply id="A1.E11.m2.3.3.1.1.2.2.1.1.1.1.1.1.cmml" xref="A1.E11.m2.3.3.1.1.2.2.1.1.1.1.1"><minus id="A1.E11.m2.3.3.1.1.2.2.1.1.1.1.1.1.1.cmml" xref="A1.E11.m2.3.3.1.1.2.2.1.1.1.1.1.1.1"></minus><cn id="A1.E11.m2.3.3.1.1.2.2.1.1.1.1.1.1.2.cmml" type="integer" xref="A1.E11.m2.3.3.1.1.2.2.1.1.1.1.1.1.2">1</cn><apply id="A1.E11.m2.3.3.1.1.2.2.1.1.1.1.1.1.3.cmml" xref="A1.E11.m2.3.3.1.1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E11.m2.3.3.1.1.2.2.1.1.1.1.1.1.3.1.cmml" xref="A1.E11.m2.3.3.1.1.2.2.1.1.1.1.1.1.3">superscript</csymbol><apply id="A1.E11.m2.3.3.1.1.2.2.1.1.1.1.1.1.3.2.cmml" xref="A1.E11.m2.3.3.1.1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E11.m2.3.3.1.1.2.2.1.1.1.1.1.1.3.2.1.cmml" xref="A1.E11.m2.3.3.1.1.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E11.m2.3.3.1.1.2.2.1.1.1.1.1.1.3.2.2.cmml" xref="A1.E11.m2.3.3.1.1.2.2.1.1.1.1.1.1.3.2.2">𝑥</ci><cn id="A1.E11.m2.3.3.1.1.2.2.1.1.1.1.1.1.3.2.3.cmml" type="integer" xref="A1.E11.m2.3.3.1.1.2.2.1.1.1.1.1.1.3.2.3">0</cn></apply><ci id="A1.E11.m2.2.2.1.1.cmml" xref="A1.E11.m2.2.2.1.1">𝑗</ci></apply></apply></apply><apply id="A1.E11.m2.3.3.1.1.2.2.1.1.2.cmml" xref="A1.E11.m2.3.3.1.1.2.2.1.1.2"><ci id="A1.E11.m2.3.3.1.1.2.2.1.1.2.2.cmml" xref="A1.E11.m2.3.3.1.1.2.2.1.1.2.2">⋅</ci><apply id="A1.E11.m2.3.3.1.1.2.2.1.1.2.1.1.1.cmml" xref="A1.E11.m2.3.3.1.1.2.2.1.1.2.1.1"><minus id="A1.E11.m2.3.3.1.1.2.2.1.1.2.1.1.1.1.cmml" xref="A1.E11.m2.3.3.1.1.2.2.1.1.2.1.1.1.1"></minus><cn id="A1.E11.m2.3.3.1.1.2.2.1.1.2.1.1.1.2.cmml" type="integer" xref="A1.E11.m2.3.3.1.1.2.2.1.1.2.1.1.1.2">1</cn><apply id="A1.E11.m2.3.3.1.1.2.2.1.1.2.1.1.1.3.cmml" xref="A1.E11.m2.3.3.1.1.2.2.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="A1.E11.m2.3.3.1.1.2.2.1.1.2.1.1.1.3.1.cmml" xref="A1.E11.m2.3.3.1.1.2.2.1.1.2.1.1.1.3">subscript</csymbol><apply id="A1.E11.m2.3.3.1.1.2.2.1.1.2.1.1.1.3.2.cmml" xref="A1.E11.m2.3.3.1.1.2.2.1.1.2.1.1.1.3.2"><ci id="A1.E11.m2.3.3.1.1.2.2.1.1.2.1.1.1.3.2.1.cmml" xref="A1.E11.m2.3.3.1.1.2.2.1.1.2.1.1.1.3.2.1">¯</ci><ci id="A1.E11.m2.3.3.1.1.2.2.1.1.2.1.1.1.3.2.2.cmml" xref="A1.E11.m2.3.3.1.1.2.2.1.1.2.1.1.1.3.2.2">𝛼</ci></apply><apply id="A1.E11.m2.3.3.1.1.2.2.1.1.2.1.1.1.3.3.cmml" xref="A1.E11.m2.3.3.1.1.2.2.1.1.2.1.1.1.3.3"><minus id="A1.E11.m2.3.3.1.1.2.2.1.1.2.1.1.1.3.3.1.cmml" xref="A1.E11.m2.3.3.1.1.2.2.1.1.2.1.1.1.3.3.1"></minus><ci id="A1.E11.m2.3.3.1.1.2.2.1.1.2.1.1.1.3.3.2.cmml" xref="A1.E11.m2.3.3.1.1.2.2.1.1.2.1.1.1.3.3.2">𝑡</ci><cn id="A1.E11.m2.3.3.1.1.2.2.1.1.2.1.1.1.3.3.3.cmml" type="integer" xref="A1.E11.m2.3.3.1.1.2.2.1.1.2.1.1.1.3.3.3">1</cn></apply></apply></apply><apply id="A1.E11.m2.3.3.1.1.2.2.1.1.2.3.cmml" xref="A1.E11.m2.3.3.1.1.2.2.1.1.2.3"><divide id="A1.E11.m2.3.3.1.1.2.2.1.1.2.3.1.cmml" xref="A1.E11.m2.3.3.1.1.2.2.1.1.2.3"></divide><cn id="A1.E11.m2.3.3.1.1.2.2.1.1.2.3.2.cmml" type="integer" xref="A1.E11.m2.3.3.1.1.2.2.1.1.2.3.2">1</cn><cn id="A1.E11.m2.3.3.1.1.2.2.1.1.2.3.3.cmml" type="integer" xref="A1.E11.m2.3.3.1.1.2.2.1.1.2.3.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E11.m2.3c">\displaystyle=\left(\alpha_{t}(1-x_{t}^{(j)})+(1-\alpha_{t})\cdot\frac{1}{2}%
\right)\cdot\left(\bar{\alpha}_{t-1}(1-x_{0}^{(j)})+(1-\bar{\alpha}_{t-1})%
\cdot\frac{1}{2}\right).</annotation><annotation encoding="application/x-llamapun" id="A1.E11.m2.3d">= ( italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( 1 - italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT ) + ( 1 - italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ⋅ divide start_ARG 1 end_ARG start_ARG 2 end_ARG ) ⋅ ( over¯ start_ARG italic_α end_ARG start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT ( 1 - italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT ) + ( 1 - over¯ start_ARG italic_α end_ARG start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT ) ⋅ divide start_ARG 1 end_ARG start_ARG 2 end_ARG ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS1.SSS4.p3.6">In this posterior distribution, <math alttext="\mathbf{x}_{0}" class="ltx_Math" display="inline" id="A1.SS1.SSS4.p3.4.m1.1"><semantics id="A1.SS1.SSS4.p3.4.m1.1a"><msub id="A1.SS1.SSS4.p3.4.m1.1.1" xref="A1.SS1.SSS4.p3.4.m1.1.1.cmml"><mi id="A1.SS1.SSS4.p3.4.m1.1.1.2" xref="A1.SS1.SSS4.p3.4.m1.1.1.2.cmml">𝐱</mi><mn id="A1.SS1.SSS4.p3.4.m1.1.1.3" xref="A1.SS1.SSS4.p3.4.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS4.p3.4.m1.1b"><apply id="A1.SS1.SSS4.p3.4.m1.1.1.cmml" xref="A1.SS1.SSS4.p3.4.m1.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS4.p3.4.m1.1.1.1.cmml" xref="A1.SS1.SSS4.p3.4.m1.1.1">subscript</csymbol><ci id="A1.SS1.SSS4.p3.4.m1.1.1.2.cmml" xref="A1.SS1.SSS4.p3.4.m1.1.1.2">𝐱</ci><cn id="A1.SS1.SSS4.p3.4.m1.1.1.3.cmml" type="integer" xref="A1.SS1.SSS4.p3.4.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS4.p3.4.m1.1c">\mathbf{x}_{0}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS4.p3.4.m1.1d">bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> is the unknown variable to be predicted, which we parameterize with a neural network conditional on both the current noisy fingerprint <math alttext="\mathbf{x}_{t}" class="ltx_Math" display="inline" id="A1.SS1.SSS4.p3.5.m2.1"><semantics id="A1.SS1.SSS4.p3.5.m2.1a"><msub id="A1.SS1.SSS4.p3.5.m2.1.1" xref="A1.SS1.SSS4.p3.5.m2.1.1.cmml"><mi id="A1.SS1.SSS4.p3.5.m2.1.1.2" xref="A1.SS1.SSS4.p3.5.m2.1.1.2.cmml">𝐱</mi><mi id="A1.SS1.SSS4.p3.5.m2.1.1.3" xref="A1.SS1.SSS4.p3.5.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS4.p3.5.m2.1b"><apply id="A1.SS1.SSS4.p3.5.m2.1.1.cmml" xref="A1.SS1.SSS4.p3.5.m2.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS4.p3.5.m2.1.1.1.cmml" xref="A1.SS1.SSS4.p3.5.m2.1.1">subscript</csymbol><ci id="A1.SS1.SSS4.p3.5.m2.1.1.2.cmml" xref="A1.SS1.SSS4.p3.5.m2.1.1.2">𝐱</ci><ci id="A1.SS1.SSS4.p3.5.m2.1.1.3.cmml" xref="A1.SS1.SSS4.p3.5.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS4.p3.5.m2.1c">\mathbf{x}_{t}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS4.p3.5.m2.1d">bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and the embedding vector from the Transformer decoder <math alttext="\mathbf{h}" class="ltx_Math" display="inline" id="A1.SS1.SSS4.p3.6.m3.1"><semantics id="A1.SS1.SSS4.p3.6.m3.1a"><mi id="A1.SS1.SSS4.p3.6.m3.1.1" xref="A1.SS1.SSS4.p3.6.m3.1.1.cmml">𝐡</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS4.p3.6.m3.1b"><ci id="A1.SS1.SSS4.p3.6.m3.1.1.cmml" xref="A1.SS1.SSS4.p3.6.m3.1.1">𝐡</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS4.p3.6.m3.1c">\mathbf{h}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS4.p3.6.m3.1d">bold_h</annotation></semantics></math>, leading to the following reverse diffusion process:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="p(\mathbf{x}_{t-1}|\mathbf{x}_{t})=\prod_{j=1}^{n}\operatorname{Bernoulli}%
\left(x_{t-1}^{(j)}\middle|\frac{\theta_{1}(x_{t}^{(j)},p_{0}^{(j)})}{\theta_{%
1}(x_{t}^{(j)},p_{0}^{(j)})+\theta_{0}(x_{t}^{(j)},p_{0}^{(j)})}\right)\quad%
\text{where}\quad p_{0}^{(j)}=\operatorname{sigmoid}(\operatorname{DenoiserNet%
}(\mathbf{x}_{t},\mathbf{h})[j])." class="ltx_Math" display="block" id="A1.E12.m1.21"><semantics id="A1.E12.m1.21a"><mrow id="A1.E12.m1.21.21.1"><mrow id="A1.E12.m1.21.21.1.1.2" xref="A1.E12.m1.21.21.1.1.3.cmml"><mrow id="A1.E12.m1.21.21.1.1.1.1" xref="A1.E12.m1.21.21.1.1.1.1.cmml"><mrow id="A1.E12.m1.21.21.1.1.1.1.1" xref="A1.E12.m1.21.21.1.1.1.1.1.cmml"><mi id="A1.E12.m1.21.21.1.1.1.1.1.3" xref="A1.E12.m1.21.21.1.1.1.1.1.3.cmml">p</mi><mo id="A1.E12.m1.21.21.1.1.1.1.1.2" xref="A1.E12.m1.21.21.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E12.m1.21.21.1.1.1.1.1.1.1" xref="A1.E12.m1.21.21.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E12.m1.21.21.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E12.m1.21.21.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E12.m1.21.21.1.1.1.1.1.1.1.1" xref="A1.E12.m1.21.21.1.1.1.1.1.1.1.1.cmml"><msub id="A1.E12.m1.21.21.1.1.1.1.1.1.1.1.2" xref="A1.E12.m1.21.21.1.1.1.1.1.1.1.1.2.cmml"><mi id="A1.E12.m1.21.21.1.1.1.1.1.1.1.1.2.2" xref="A1.E12.m1.21.21.1.1.1.1.1.1.1.1.2.2.cmml">𝐱</mi><mrow id="A1.E12.m1.21.21.1.1.1.1.1.1.1.1.2.3" xref="A1.E12.m1.21.21.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="A1.E12.m1.21.21.1.1.1.1.1.1.1.1.2.3.2" xref="A1.E12.m1.21.21.1.1.1.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="A1.E12.m1.21.21.1.1.1.1.1.1.1.1.2.3.1" xref="A1.E12.m1.21.21.1.1.1.1.1.1.1.1.2.3.1.cmml">−</mo><mn id="A1.E12.m1.21.21.1.1.1.1.1.1.1.1.2.3.3" xref="A1.E12.m1.21.21.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo fence="false" id="A1.E12.m1.21.21.1.1.1.1.1.1.1.1.1" xref="A1.E12.m1.21.21.1.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="A1.E12.m1.21.21.1.1.1.1.1.1.1.1.3" xref="A1.E12.m1.21.21.1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.E12.m1.21.21.1.1.1.1.1.1.1.1.3.2" xref="A1.E12.m1.21.21.1.1.1.1.1.1.1.1.3.2.cmml">𝐱</mi><mi id="A1.E12.m1.21.21.1.1.1.1.1.1.1.1.3.3" xref="A1.E12.m1.21.21.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="A1.E12.m1.21.21.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E12.m1.21.21.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E12.m1.21.21.1.1.1.1.3" rspace="0.111em" xref="A1.E12.m1.21.21.1.1.1.1.3.cmml">=</mo><mrow id="A1.E12.m1.21.21.1.1.1.1.2.1" xref="A1.E12.m1.21.21.1.1.1.1.2.2.cmml"><mrow id="A1.E12.m1.21.21.1.1.1.1.2.1.1" xref="A1.E12.m1.21.21.1.1.1.1.2.1.1.cmml"><munderover id="A1.E12.m1.21.21.1.1.1.1.2.1.1.2" xref="A1.E12.m1.21.21.1.1.1.1.2.1.1.2.cmml"><mo id="A1.E12.m1.21.21.1.1.1.1.2.1.1.2.2.2" movablelimits="false" xref="A1.E12.m1.21.21.1.1.1.1.2.1.1.2.2.2.cmml">∏</mo><mrow id="A1.E12.m1.21.21.1.1.1.1.2.1.1.2.2.3" xref="A1.E12.m1.21.21.1.1.1.1.2.1.1.2.2.3.cmml"><mi id="A1.E12.m1.21.21.1.1.1.1.2.1.1.2.2.3.2" xref="A1.E12.m1.21.21.1.1.1.1.2.1.1.2.2.3.2.cmml">j</mi><mo id="A1.E12.m1.21.21.1.1.1.1.2.1.1.2.2.3.1" xref="A1.E12.m1.21.21.1.1.1.1.2.1.1.2.2.3.1.cmml">=</mo><mn id="A1.E12.m1.21.21.1.1.1.1.2.1.1.2.2.3.3" xref="A1.E12.m1.21.21.1.1.1.1.2.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="A1.E12.m1.21.21.1.1.1.1.2.1.1.2.3" xref="A1.E12.m1.21.21.1.1.1.1.2.1.1.2.3.cmml">n</mi></munderover><mrow id="A1.E12.m1.21.21.1.1.1.1.2.1.1.1.1" xref="A1.E12.m1.21.21.1.1.1.1.2.1.1.1.2.cmml"><mi id="A1.E12.m1.15.15" xref="A1.E12.m1.15.15.cmml">Bernoulli</mi><mo id="A1.E12.m1.21.21.1.1.1.1.2.1.1.1.1a" xref="A1.E12.m1.21.21.1.1.1.1.2.1.1.1.2.cmml">⁡</mo><mrow id="A1.E12.m1.21.21.1.1.1.1.2.1.1.1.1.1" xref="A1.E12.m1.21.21.1.1.1.1.2.1.1.1.2.cmml"><mo id="A1.E12.m1.21.21.1.1.1.1.2.1.1.1.1.1.2" xref="A1.E12.m1.21.21.1.1.1.1.2.1.1.1.2.cmml">(</mo><msubsup id="A1.E12.m1.21.21.1.1.1.1.2.1.1.1.1.1.1" xref="A1.E12.m1.21.21.1.1.1.1.2.1.1.1.1.1.1.cmml"><mi id="A1.E12.m1.21.21.1.1.1.1.2.1.1.1.1.1.1.2.2" xref="A1.E12.m1.21.21.1.1.1.1.2.1.1.1.1.1.1.2.2.cmml">x</mi><mrow id="A1.E12.m1.21.21.1.1.1.1.2.1.1.1.1.1.1.2.3" xref="A1.E12.m1.21.21.1.1.1.1.2.1.1.1.1.1.1.2.3.cmml"><mi id="A1.E12.m1.21.21.1.1.1.1.2.1.1.1.1.1.1.2.3.2" xref="A1.E12.m1.21.21.1.1.1.1.2.1.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="A1.E12.m1.21.21.1.1.1.1.2.1.1.1.1.1.1.2.3.1" xref="A1.E12.m1.21.21.1.1.1.1.2.1.1.1.1.1.1.2.3.1.cmml">−</mo><mn id="A1.E12.m1.21.21.1.1.1.1.2.1.1.1.1.1.1.2.3.3" xref="A1.E12.m1.21.21.1.1.1.1.2.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mrow id="A1.E12.m1.1.1.1.3" xref="A1.E12.m1.21.21.1.1.1.1.2.1.1.1.1.1.1.cmml"><mo id="A1.E12.m1.1.1.1.3.1" stretchy="false" xref="A1.E12.m1.21.21.1.1.1.1.2.1.1.1.1.1.1.cmml">(</mo><mi id="A1.E12.m1.1.1.1.1" xref="A1.E12.m1.1.1.1.1.cmml">j</mi><mo id="A1.E12.m1.1.1.1.3.2" stretchy="false" xref="A1.E12.m1.21.21.1.1.1.1.2.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="A1.E12.m1.21.21.1.1.1.1.2.1.1.1.1.1.3" lspace="0em" rspace="0em" stretchy="true" xref="A1.E12.m1.21.21.1.1.1.1.2.1.1.1.2.cmml">|</mo><mfrac id="A1.E12.m1.13.13" xref="A1.E12.m1.13.13.cmml"><mrow id="A1.E12.m1.5.5.4" xref="A1.E12.m1.5.5.4.cmml"><msub id="A1.E12.m1.5.5.4.6" xref="A1.E12.m1.5.5.4.6.cmml"><mi id="A1.E12.m1.5.5.4.6.2" xref="A1.E12.m1.5.5.4.6.2.cmml">θ</mi><mn id="A1.E12.m1.5.5.4.6.3" xref="A1.E12.m1.5.5.4.6.3.cmml">1</mn></msub><mo id="A1.E12.m1.5.5.4.5" xref="A1.E12.m1.5.5.4.5.cmml">⁢</mo><mrow id="A1.E12.m1.5.5.4.4.2" xref="A1.E12.m1.5.5.4.4.3.cmml"><mo id="A1.E12.m1.5.5.4.4.2.3" stretchy="false" xref="A1.E12.m1.5.5.4.4.3.cmml">(</mo><msubsup id="A1.E12.m1.4.4.3.3.1.1" xref="A1.E12.m1.4.4.3.3.1.1.cmml"><mi id="A1.E12.m1.4.4.3.3.1.1.2.2" xref="A1.E12.m1.4.4.3.3.1.1.2.2.cmml">x</mi><mi id="A1.E12.m1.4.4.3.3.1.1.2.3" xref="A1.E12.m1.4.4.3.3.1.1.2.3.cmml">t</mi><mrow id="A1.E12.m1.2.2.1.1.1.3" xref="A1.E12.m1.4.4.3.3.1.1.cmml"><mo id="A1.E12.m1.2.2.1.1.1.3.1" stretchy="false" xref="A1.E12.m1.4.4.3.3.1.1.cmml">(</mo><mi id="A1.E12.m1.2.2.1.1.1.1" xref="A1.E12.m1.2.2.1.1.1.1.cmml">j</mi><mo id="A1.E12.m1.2.2.1.1.1.3.2" stretchy="false" xref="A1.E12.m1.4.4.3.3.1.1.cmml">)</mo></mrow></msubsup><mo id="A1.E12.m1.5.5.4.4.2.4" xref="A1.E12.m1.5.5.4.4.3.cmml">,</mo><msubsup id="A1.E12.m1.5.5.4.4.2.2" xref="A1.E12.m1.5.5.4.4.2.2.cmml"><mi id="A1.E12.m1.5.5.4.4.2.2.2.2" xref="A1.E12.m1.5.5.4.4.2.2.2.2.cmml">p</mi><mn id="A1.E12.m1.5.5.4.4.2.2.2.3" xref="A1.E12.m1.5.5.4.4.2.2.2.3.cmml">0</mn><mrow id="A1.E12.m1.3.3.2.2.1.3" xref="A1.E12.m1.5.5.4.4.2.2.cmml"><mo id="A1.E12.m1.3.3.2.2.1.3.1" stretchy="false" xref="A1.E12.m1.5.5.4.4.2.2.cmml">(</mo><mi id="A1.E12.m1.3.3.2.2.1.1" xref="A1.E12.m1.3.3.2.2.1.1.cmml">j</mi><mo id="A1.E12.m1.3.3.2.2.1.3.2" stretchy="false" xref="A1.E12.m1.5.5.4.4.2.2.cmml">)</mo></mrow></msubsup><mo id="A1.E12.m1.5.5.4.4.2.5" stretchy="false" xref="A1.E12.m1.5.5.4.4.3.cmml">)</mo></mrow></mrow><mrow id="A1.E12.m1.13.13.12" xref="A1.E12.m1.13.13.12.cmml"><mrow id="A1.E12.m1.11.11.10.6" xref="A1.E12.m1.11.11.10.6.cmml"><msub id="A1.E12.m1.11.11.10.6.4" xref="A1.E12.m1.11.11.10.6.4.cmml"><mi id="A1.E12.m1.11.11.10.6.4.2" xref="A1.E12.m1.11.11.10.6.4.2.cmml">θ</mi><mn id="A1.E12.m1.11.11.10.6.4.3" xref="A1.E12.m1.11.11.10.6.4.3.cmml">1</mn></msub><mo id="A1.E12.m1.11.11.10.6.3" xref="A1.E12.m1.11.11.10.6.3.cmml">⁢</mo><mrow id="A1.E12.m1.11.11.10.6.2.2" xref="A1.E12.m1.11.11.10.6.2.3.cmml"><mo id="A1.E12.m1.11.11.10.6.2.2.3" stretchy="false" xref="A1.E12.m1.11.11.10.6.2.3.cmml">(</mo><msubsup id="A1.E12.m1.10.10.9.5.1.1.1" xref="A1.E12.m1.10.10.9.5.1.1.1.cmml"><mi id="A1.E12.m1.10.10.9.5.1.1.1.2.2" xref="A1.E12.m1.10.10.9.5.1.1.1.2.2.cmml">x</mi><mi id="A1.E12.m1.10.10.9.5.1.1.1.2.3" xref="A1.E12.m1.10.10.9.5.1.1.1.2.3.cmml">t</mi><mrow id="A1.E12.m1.6.6.5.1.1.3" xref="A1.E12.m1.10.10.9.5.1.1.1.cmml"><mo id="A1.E12.m1.6.6.5.1.1.3.1" stretchy="false" xref="A1.E12.m1.10.10.9.5.1.1.1.cmml">(</mo><mi id="A1.E12.m1.6.6.5.1.1.1" xref="A1.E12.m1.6.6.5.1.1.1.cmml">j</mi><mo id="A1.E12.m1.6.6.5.1.1.3.2" stretchy="false" xref="A1.E12.m1.10.10.9.5.1.1.1.cmml">)</mo></mrow></msubsup><mo id="A1.E12.m1.11.11.10.6.2.2.4" xref="A1.E12.m1.11.11.10.6.2.3.cmml">,</mo><msubsup id="A1.E12.m1.11.11.10.6.2.2.2" xref="A1.E12.m1.11.11.10.6.2.2.2.cmml"><mi id="A1.E12.m1.11.11.10.6.2.2.2.2.2" xref="A1.E12.m1.11.11.10.6.2.2.2.2.2.cmml">p</mi><mn id="A1.E12.m1.11.11.10.6.2.2.2.2.3" xref="A1.E12.m1.11.11.10.6.2.2.2.2.3.cmml">0</mn><mrow id="A1.E12.m1.7.7.6.2.1.3" xref="A1.E12.m1.11.11.10.6.2.2.2.cmml"><mo id="A1.E12.m1.7.7.6.2.1.3.1" stretchy="false" xref="A1.E12.m1.11.11.10.6.2.2.2.cmml">(</mo><mi id="A1.E12.m1.7.7.6.2.1.1" xref="A1.E12.m1.7.7.6.2.1.1.cmml">j</mi><mo id="A1.E12.m1.7.7.6.2.1.3.2" stretchy="false" xref="A1.E12.m1.11.11.10.6.2.2.2.cmml">)</mo></mrow></msubsup><mo id="A1.E12.m1.11.11.10.6.2.2.5" stretchy="false" xref="A1.E12.m1.11.11.10.6.2.3.cmml">)</mo></mrow></mrow><mo id="A1.E12.m1.13.13.12.9" xref="A1.E12.m1.13.13.12.9.cmml">+</mo><mrow id="A1.E12.m1.13.13.12.8" xref="A1.E12.m1.13.13.12.8.cmml"><msub id="A1.E12.m1.13.13.12.8.4" xref="A1.E12.m1.13.13.12.8.4.cmml"><mi id="A1.E12.m1.13.13.12.8.4.2" xref="A1.E12.m1.13.13.12.8.4.2.cmml">θ</mi><mn id="A1.E12.m1.13.13.12.8.4.3" xref="A1.E12.m1.13.13.12.8.4.3.cmml">0</mn></msub><mo id="A1.E12.m1.13.13.12.8.3" xref="A1.E12.m1.13.13.12.8.3.cmml">⁢</mo><mrow id="A1.E12.m1.13.13.12.8.2.2" xref="A1.E12.m1.13.13.12.8.2.3.cmml"><mo id="A1.E12.m1.13.13.12.8.2.2.3" stretchy="false" xref="A1.E12.m1.13.13.12.8.2.3.cmml">(</mo><msubsup id="A1.E12.m1.12.12.11.7.1.1.1" xref="A1.E12.m1.12.12.11.7.1.1.1.cmml"><mi id="A1.E12.m1.12.12.11.7.1.1.1.2.2" xref="A1.E12.m1.12.12.11.7.1.1.1.2.2.cmml">x</mi><mi id="A1.E12.m1.12.12.11.7.1.1.1.2.3" xref="A1.E12.m1.12.12.11.7.1.1.1.2.3.cmml">t</mi><mrow id="A1.E12.m1.8.8.7.3.1.3" xref="A1.E12.m1.12.12.11.7.1.1.1.cmml"><mo id="A1.E12.m1.8.8.7.3.1.3.1" stretchy="false" xref="A1.E12.m1.12.12.11.7.1.1.1.cmml">(</mo><mi id="A1.E12.m1.8.8.7.3.1.1" xref="A1.E12.m1.8.8.7.3.1.1.cmml">j</mi><mo id="A1.E12.m1.8.8.7.3.1.3.2" stretchy="false" xref="A1.E12.m1.12.12.11.7.1.1.1.cmml">)</mo></mrow></msubsup><mo id="A1.E12.m1.13.13.12.8.2.2.4" xref="A1.E12.m1.13.13.12.8.2.3.cmml">,</mo><msubsup id="A1.E12.m1.13.13.12.8.2.2.2" xref="A1.E12.m1.13.13.12.8.2.2.2.cmml"><mi id="A1.E12.m1.13.13.12.8.2.2.2.2.2" xref="A1.E12.m1.13.13.12.8.2.2.2.2.2.cmml">p</mi><mn id="A1.E12.m1.13.13.12.8.2.2.2.2.3" xref="A1.E12.m1.13.13.12.8.2.2.2.2.3.cmml">0</mn><mrow id="A1.E12.m1.9.9.8.4.1.3" xref="A1.E12.m1.13.13.12.8.2.2.2.cmml"><mo id="A1.E12.m1.9.9.8.4.1.3.1" stretchy="false" xref="A1.E12.m1.13.13.12.8.2.2.2.cmml">(</mo><mi id="A1.E12.m1.9.9.8.4.1.1" xref="A1.E12.m1.9.9.8.4.1.1.cmml">j</mi><mo id="A1.E12.m1.9.9.8.4.1.3.2" stretchy="false" xref="A1.E12.m1.13.13.12.8.2.2.2.cmml">)</mo></mrow></msubsup><mo id="A1.E12.m1.13.13.12.8.2.2.5" stretchy="false" xref="A1.E12.m1.13.13.12.8.2.3.cmml">)</mo></mrow></mrow></mrow></mfrac><mo id="A1.E12.m1.21.21.1.1.1.1.2.1.1.1.1.1.4" xref="A1.E12.m1.21.21.1.1.1.1.2.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mspace id="A1.E12.m1.21.21.1.1.1.1.2.1.2" width="1em" xref="A1.E12.m1.21.21.1.1.1.1.2.2.cmml"></mspace><mtext id="A1.E12.m1.20.20" xref="A1.E12.m1.20.20a.cmml">where</mtext></mrow></mrow><mspace id="A1.E12.m1.21.21.1.1.2.3" width="1em" xref="A1.E12.m1.21.21.1.1.3a.cmml"></mspace><mrow id="A1.E12.m1.21.21.1.1.2.2" xref="A1.E12.m1.21.21.1.1.2.2.cmml"><msubsup id="A1.E12.m1.21.21.1.1.2.2.3" xref="A1.E12.m1.21.21.1.1.2.2.3.cmml"><mi id="A1.E12.m1.21.21.1.1.2.2.3.2.2" xref="A1.E12.m1.21.21.1.1.2.2.3.2.2.cmml">p</mi><mn id="A1.E12.m1.21.21.1.1.2.2.3.2.3" xref="A1.E12.m1.21.21.1.1.2.2.3.2.3.cmml">0</mn><mrow id="A1.E12.m1.14.14.1.3" xref="A1.E12.m1.21.21.1.1.2.2.3.cmml"><mo id="A1.E12.m1.14.14.1.3.1" stretchy="false" xref="A1.E12.m1.21.21.1.1.2.2.3.cmml">(</mo><mi id="A1.E12.m1.14.14.1.1" xref="A1.E12.m1.14.14.1.1.cmml">j</mi><mo id="A1.E12.m1.14.14.1.3.2" stretchy="false" xref="A1.E12.m1.21.21.1.1.2.2.3.cmml">)</mo></mrow></msubsup><mo id="A1.E12.m1.21.21.1.1.2.2.2" xref="A1.E12.m1.21.21.1.1.2.2.2.cmml">=</mo><mrow id="A1.E12.m1.21.21.1.1.2.2.1.1" xref="A1.E12.m1.21.21.1.1.2.2.1.2.cmml"><mi id="A1.E12.m1.19.19" xref="A1.E12.m1.19.19.cmml">sigmoid</mi><mo id="A1.E12.m1.21.21.1.1.2.2.1.1a" xref="A1.E12.m1.21.21.1.1.2.2.1.2.cmml">⁡</mo><mrow id="A1.E12.m1.21.21.1.1.2.2.1.1.1" xref="A1.E12.m1.21.21.1.1.2.2.1.2.cmml"><mo id="A1.E12.m1.21.21.1.1.2.2.1.1.1.2" stretchy="false" xref="A1.E12.m1.21.21.1.1.2.2.1.2.cmml">(</mo><mrow id="A1.E12.m1.21.21.1.1.2.2.1.1.1.1" xref="A1.E12.m1.21.21.1.1.2.2.1.1.1.1.cmml"><mrow id="A1.E12.m1.21.21.1.1.2.2.1.1.1.1.1.1" xref="A1.E12.m1.21.21.1.1.2.2.1.1.1.1.1.2.cmml"><mi id="A1.E12.m1.16.16" xref="A1.E12.m1.16.16.cmml">DenoiserNet</mi><mo id="A1.E12.m1.21.21.1.1.2.2.1.1.1.1.1.1a" xref="A1.E12.m1.21.21.1.1.2.2.1.1.1.1.1.2.cmml">⁡</mo><mrow id="A1.E12.m1.21.21.1.1.2.2.1.1.1.1.1.1.1" xref="A1.E12.m1.21.21.1.1.2.2.1.1.1.1.1.2.cmml"><mo id="A1.E12.m1.21.21.1.1.2.2.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E12.m1.21.21.1.1.2.2.1.1.1.1.1.2.cmml">(</mo><msub id="A1.E12.m1.21.21.1.1.2.2.1.1.1.1.1.1.1.1" xref="A1.E12.m1.21.21.1.1.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E12.m1.21.21.1.1.2.2.1.1.1.1.1.1.1.1.2" xref="A1.E12.m1.21.21.1.1.2.2.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="A1.E12.m1.21.21.1.1.2.2.1.1.1.1.1.1.1.1.3" xref="A1.E12.m1.21.21.1.1.2.2.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="A1.E12.m1.21.21.1.1.2.2.1.1.1.1.1.1.1.3" xref="A1.E12.m1.21.21.1.1.2.2.1.1.1.1.1.2.cmml">,</mo><mi id="A1.E12.m1.17.17" xref="A1.E12.m1.17.17.cmml">𝐡</mi><mo id="A1.E12.m1.21.21.1.1.2.2.1.1.1.1.1.1.1.4" stretchy="false" xref="A1.E12.m1.21.21.1.1.2.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.E12.m1.21.21.1.1.2.2.1.1.1.1.2" xref="A1.E12.m1.21.21.1.1.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E12.m1.21.21.1.1.2.2.1.1.1.1.3.2" xref="A1.E12.m1.21.21.1.1.2.2.1.1.1.1.3.1.cmml"><mo id="A1.E12.m1.21.21.1.1.2.2.1.1.1.1.3.2.1" stretchy="false" xref="A1.E12.m1.21.21.1.1.2.2.1.1.1.1.3.1.1.cmml">[</mo><mi id="A1.E12.m1.18.18" xref="A1.E12.m1.18.18.cmml">j</mi><mo id="A1.E12.m1.21.21.1.1.2.2.1.1.1.1.3.2.2" stretchy="false" xref="A1.E12.m1.21.21.1.1.2.2.1.1.1.1.3.1.1.cmml">]</mo></mrow></mrow><mo id="A1.E12.m1.21.21.1.1.2.2.1.1.1.3" stretchy="false" xref="A1.E12.m1.21.21.1.1.2.2.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A1.E12.m1.21.21.1.2" lspace="0em">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E12.m1.21b"><apply id="A1.E12.m1.21.21.1.1.3.cmml" xref="A1.E12.m1.21.21.1.1.2"><csymbol cd="ambiguous" id="A1.E12.m1.21.21.1.1.3a.cmml" xref="A1.E12.m1.21.21.1.1.2.3">formulae-sequence</csymbol><apply id="A1.E12.m1.21.21.1.1.1.1.cmml" xref="A1.E12.m1.21.21.1.1.1.1"><eq id="A1.E12.m1.21.21.1.1.1.1.3.cmml" xref="A1.E12.m1.21.21.1.1.1.1.3"></eq><apply id="A1.E12.m1.21.21.1.1.1.1.1.cmml" xref="A1.E12.m1.21.21.1.1.1.1.1"><times id="A1.E12.m1.21.21.1.1.1.1.1.2.cmml" xref="A1.E12.m1.21.21.1.1.1.1.1.2"></times><ci id="A1.E12.m1.21.21.1.1.1.1.1.3.cmml" xref="A1.E12.m1.21.21.1.1.1.1.1.3">𝑝</ci><apply id="A1.E12.m1.21.21.1.1.1.1.1.1.1.1.cmml" xref="A1.E12.m1.21.21.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E12.m1.21.21.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E12.m1.21.21.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="A1.E12.m1.21.21.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E12.m1.21.21.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E12.m1.21.21.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E12.m1.21.21.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A1.E12.m1.21.21.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E12.m1.21.21.1.1.1.1.1.1.1.1.2.2">𝐱</ci><apply id="A1.E12.m1.21.21.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.E12.m1.21.21.1.1.1.1.1.1.1.1.2.3"><minus id="A1.E12.m1.21.21.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="A1.E12.m1.21.21.1.1.1.1.1.1.1.1.2.3.1"></minus><ci id="A1.E12.m1.21.21.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="A1.E12.m1.21.21.1.1.1.1.1.1.1.1.2.3.2">𝑡</ci><cn id="A1.E12.m1.21.21.1.1.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="A1.E12.m1.21.21.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="A1.E12.m1.21.21.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E12.m1.21.21.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E12.m1.21.21.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E12.m1.21.21.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E12.m1.21.21.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E12.m1.21.21.1.1.1.1.1.1.1.1.3.2">𝐱</ci><ci id="A1.E12.m1.21.21.1.1.1.1.1.1.1.1.3.3.cmml" xref="A1.E12.m1.21.21.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply><list id="A1.E12.m1.21.21.1.1.1.1.2.2.cmml" xref="A1.E12.m1.21.21.1.1.1.1.2.1"><apply id="A1.E12.m1.21.21.1.1.1.1.2.1.1.cmml" xref="A1.E12.m1.21.21.1.1.1.1.2.1.1"><apply id="A1.E12.m1.21.21.1.1.1.1.2.1.1.2.cmml" xref="A1.E12.m1.21.21.1.1.1.1.2.1.1.2"><csymbol cd="ambiguous" id="A1.E12.m1.21.21.1.1.1.1.2.1.1.2.1.cmml" xref="A1.E12.m1.21.21.1.1.1.1.2.1.1.2">superscript</csymbol><apply id="A1.E12.m1.21.21.1.1.1.1.2.1.1.2.2.cmml" xref="A1.E12.m1.21.21.1.1.1.1.2.1.1.2"><csymbol cd="ambiguous" id="A1.E12.m1.21.21.1.1.1.1.2.1.1.2.2.1.cmml" xref="A1.E12.m1.21.21.1.1.1.1.2.1.1.2">subscript</csymbol><csymbol cd="latexml" id="A1.E12.m1.21.21.1.1.1.1.2.1.1.2.2.2.cmml" xref="A1.E12.m1.21.21.1.1.1.1.2.1.1.2.2.2">product</csymbol><apply id="A1.E12.m1.21.21.1.1.1.1.2.1.1.2.2.3.cmml" xref="A1.E12.m1.21.21.1.1.1.1.2.1.1.2.2.3"><eq id="A1.E12.m1.21.21.1.1.1.1.2.1.1.2.2.3.1.cmml" xref="A1.E12.m1.21.21.1.1.1.1.2.1.1.2.2.3.1"></eq><ci id="A1.E12.m1.21.21.1.1.1.1.2.1.1.2.2.3.2.cmml" xref="A1.E12.m1.21.21.1.1.1.1.2.1.1.2.2.3.2">𝑗</ci><cn id="A1.E12.m1.21.21.1.1.1.1.2.1.1.2.2.3.3.cmml" type="integer" xref="A1.E12.m1.21.21.1.1.1.1.2.1.1.2.2.3.3">1</cn></apply></apply><ci id="A1.E12.m1.21.21.1.1.1.1.2.1.1.2.3.cmml" xref="A1.E12.m1.21.21.1.1.1.1.2.1.1.2.3">𝑛</ci></apply><apply id="A1.E12.m1.21.21.1.1.1.1.2.1.1.1.2.cmml" xref="A1.E12.m1.21.21.1.1.1.1.2.1.1.1.1"><ci id="A1.E12.m1.15.15.cmml" xref="A1.E12.m1.15.15">Bernoulli</ci><apply id="A1.E12.m1.21.21.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="A1.E12.m1.21.21.1.1.1.1.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E12.m1.21.21.1.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="A1.E12.m1.21.21.1.1.1.1.2.1.1.1.1.1.1">superscript</csymbol><apply id="A1.E12.m1.21.21.1.1.1.1.2.1.1.1.1.1.1.2.cmml" xref="A1.E12.m1.21.21.1.1.1.1.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E12.m1.21.21.1.1.1.1.2.1.1.1.1.1.1.2.1.cmml" xref="A1.E12.m1.21.21.1.1.1.1.2.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E12.m1.21.21.1.1.1.1.2.1.1.1.1.1.1.2.2.cmml" xref="A1.E12.m1.21.21.1.1.1.1.2.1.1.1.1.1.1.2.2">𝑥</ci><apply id="A1.E12.m1.21.21.1.1.1.1.2.1.1.1.1.1.1.2.3.cmml" xref="A1.E12.m1.21.21.1.1.1.1.2.1.1.1.1.1.1.2.3"><minus id="A1.E12.m1.21.21.1.1.1.1.2.1.1.1.1.1.1.2.3.1.cmml" xref="A1.E12.m1.21.21.1.1.1.1.2.1.1.1.1.1.1.2.3.1"></minus><ci id="A1.E12.m1.21.21.1.1.1.1.2.1.1.1.1.1.1.2.3.2.cmml" xref="A1.E12.m1.21.21.1.1.1.1.2.1.1.1.1.1.1.2.3.2">𝑡</ci><cn id="A1.E12.m1.21.21.1.1.1.1.2.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="A1.E12.m1.21.21.1.1.1.1.2.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="A1.E12.m1.1.1.1.1.cmml" xref="A1.E12.m1.1.1.1.1">𝑗</ci></apply><apply id="A1.E12.m1.13.13.cmml" xref="A1.E12.m1.13.13"><divide id="A1.E12.m1.13.13.13.cmml" xref="A1.E12.m1.13.13"></divide><apply id="A1.E12.m1.5.5.4.cmml" xref="A1.E12.m1.5.5.4"><times id="A1.E12.m1.5.5.4.5.cmml" xref="A1.E12.m1.5.5.4.5"></times><apply id="A1.E12.m1.5.5.4.6.cmml" xref="A1.E12.m1.5.5.4.6"><csymbol cd="ambiguous" id="A1.E12.m1.5.5.4.6.1.cmml" xref="A1.E12.m1.5.5.4.6">subscript</csymbol><ci id="A1.E12.m1.5.5.4.6.2.cmml" xref="A1.E12.m1.5.5.4.6.2">𝜃</ci><cn id="A1.E12.m1.5.5.4.6.3.cmml" type="integer" xref="A1.E12.m1.5.5.4.6.3">1</cn></apply><interval closure="open" id="A1.E12.m1.5.5.4.4.3.cmml" xref="A1.E12.m1.5.5.4.4.2"><apply id="A1.E12.m1.4.4.3.3.1.1.cmml" xref="A1.E12.m1.4.4.3.3.1.1"><csymbol cd="ambiguous" id="A1.E12.m1.4.4.3.3.1.1.1.cmml" xref="A1.E12.m1.4.4.3.3.1.1">superscript</csymbol><apply id="A1.E12.m1.4.4.3.3.1.1.2.cmml" xref="A1.E12.m1.4.4.3.3.1.1"><csymbol cd="ambiguous" id="A1.E12.m1.4.4.3.3.1.1.2.1.cmml" xref="A1.E12.m1.4.4.3.3.1.1">subscript</csymbol><ci id="A1.E12.m1.4.4.3.3.1.1.2.2.cmml" xref="A1.E12.m1.4.4.3.3.1.1.2.2">𝑥</ci><ci id="A1.E12.m1.4.4.3.3.1.1.2.3.cmml" xref="A1.E12.m1.4.4.3.3.1.1.2.3">𝑡</ci></apply><ci id="A1.E12.m1.2.2.1.1.1.1.cmml" xref="A1.E12.m1.2.2.1.1.1.1">𝑗</ci></apply><apply id="A1.E12.m1.5.5.4.4.2.2.cmml" xref="A1.E12.m1.5.5.4.4.2.2"><csymbol cd="ambiguous" id="A1.E12.m1.5.5.4.4.2.2.1.cmml" xref="A1.E12.m1.5.5.4.4.2.2">superscript</csymbol><apply id="A1.E12.m1.5.5.4.4.2.2.2.cmml" xref="A1.E12.m1.5.5.4.4.2.2"><csymbol cd="ambiguous" id="A1.E12.m1.5.5.4.4.2.2.2.1.cmml" xref="A1.E12.m1.5.5.4.4.2.2">subscript</csymbol><ci id="A1.E12.m1.5.5.4.4.2.2.2.2.cmml" xref="A1.E12.m1.5.5.4.4.2.2.2.2">𝑝</ci><cn id="A1.E12.m1.5.5.4.4.2.2.2.3.cmml" type="integer" xref="A1.E12.m1.5.5.4.4.2.2.2.3">0</cn></apply><ci id="A1.E12.m1.3.3.2.2.1.1.cmml" xref="A1.E12.m1.3.3.2.2.1.1">𝑗</ci></apply></interval></apply><apply id="A1.E12.m1.13.13.12.cmml" xref="A1.E12.m1.13.13.12"><plus id="A1.E12.m1.13.13.12.9.cmml" xref="A1.E12.m1.13.13.12.9"></plus><apply id="A1.E12.m1.11.11.10.6.cmml" xref="A1.E12.m1.11.11.10.6"><times id="A1.E12.m1.11.11.10.6.3.cmml" xref="A1.E12.m1.11.11.10.6.3"></times><apply id="A1.E12.m1.11.11.10.6.4.cmml" xref="A1.E12.m1.11.11.10.6.4"><csymbol cd="ambiguous" id="A1.E12.m1.11.11.10.6.4.1.cmml" xref="A1.E12.m1.11.11.10.6.4">subscript</csymbol><ci id="A1.E12.m1.11.11.10.6.4.2.cmml" xref="A1.E12.m1.11.11.10.6.4.2">𝜃</ci><cn id="A1.E12.m1.11.11.10.6.4.3.cmml" type="integer" xref="A1.E12.m1.11.11.10.6.4.3">1</cn></apply><interval closure="open" id="A1.E12.m1.11.11.10.6.2.3.cmml" xref="A1.E12.m1.11.11.10.6.2.2"><apply id="A1.E12.m1.10.10.9.5.1.1.1.cmml" xref="A1.E12.m1.10.10.9.5.1.1.1"><csymbol cd="ambiguous" id="A1.E12.m1.10.10.9.5.1.1.1.1.cmml" xref="A1.E12.m1.10.10.9.5.1.1.1">superscript</csymbol><apply id="A1.E12.m1.10.10.9.5.1.1.1.2.cmml" xref="A1.E12.m1.10.10.9.5.1.1.1"><csymbol cd="ambiguous" id="A1.E12.m1.10.10.9.5.1.1.1.2.1.cmml" xref="A1.E12.m1.10.10.9.5.1.1.1">subscript</csymbol><ci id="A1.E12.m1.10.10.9.5.1.1.1.2.2.cmml" xref="A1.E12.m1.10.10.9.5.1.1.1.2.2">𝑥</ci><ci id="A1.E12.m1.10.10.9.5.1.1.1.2.3.cmml" xref="A1.E12.m1.10.10.9.5.1.1.1.2.3">𝑡</ci></apply><ci id="A1.E12.m1.6.6.5.1.1.1.cmml" xref="A1.E12.m1.6.6.5.1.1.1">𝑗</ci></apply><apply id="A1.E12.m1.11.11.10.6.2.2.2.cmml" xref="A1.E12.m1.11.11.10.6.2.2.2"><csymbol cd="ambiguous" id="A1.E12.m1.11.11.10.6.2.2.2.1.cmml" xref="A1.E12.m1.11.11.10.6.2.2.2">superscript</csymbol><apply id="A1.E12.m1.11.11.10.6.2.2.2.2.cmml" xref="A1.E12.m1.11.11.10.6.2.2.2"><csymbol cd="ambiguous" id="A1.E12.m1.11.11.10.6.2.2.2.2.1.cmml" xref="A1.E12.m1.11.11.10.6.2.2.2">subscript</csymbol><ci id="A1.E12.m1.11.11.10.6.2.2.2.2.2.cmml" xref="A1.E12.m1.11.11.10.6.2.2.2.2.2">𝑝</ci><cn id="A1.E12.m1.11.11.10.6.2.2.2.2.3.cmml" type="integer" xref="A1.E12.m1.11.11.10.6.2.2.2.2.3">0</cn></apply><ci id="A1.E12.m1.7.7.6.2.1.1.cmml" xref="A1.E12.m1.7.7.6.2.1.1">𝑗</ci></apply></interval></apply><apply id="A1.E12.m1.13.13.12.8.cmml" xref="A1.E12.m1.13.13.12.8"><times id="A1.E12.m1.13.13.12.8.3.cmml" xref="A1.E12.m1.13.13.12.8.3"></times><apply id="A1.E12.m1.13.13.12.8.4.cmml" xref="A1.E12.m1.13.13.12.8.4"><csymbol cd="ambiguous" id="A1.E12.m1.13.13.12.8.4.1.cmml" xref="A1.E12.m1.13.13.12.8.4">subscript</csymbol><ci id="A1.E12.m1.13.13.12.8.4.2.cmml" xref="A1.E12.m1.13.13.12.8.4.2">𝜃</ci><cn id="A1.E12.m1.13.13.12.8.4.3.cmml" type="integer" xref="A1.E12.m1.13.13.12.8.4.3">0</cn></apply><interval closure="open" id="A1.E12.m1.13.13.12.8.2.3.cmml" xref="A1.E12.m1.13.13.12.8.2.2"><apply id="A1.E12.m1.12.12.11.7.1.1.1.cmml" xref="A1.E12.m1.12.12.11.7.1.1.1"><csymbol cd="ambiguous" id="A1.E12.m1.12.12.11.7.1.1.1.1.cmml" xref="A1.E12.m1.12.12.11.7.1.1.1">superscript</csymbol><apply id="A1.E12.m1.12.12.11.7.1.1.1.2.cmml" xref="A1.E12.m1.12.12.11.7.1.1.1"><csymbol cd="ambiguous" id="A1.E12.m1.12.12.11.7.1.1.1.2.1.cmml" xref="A1.E12.m1.12.12.11.7.1.1.1">subscript</csymbol><ci id="A1.E12.m1.12.12.11.7.1.1.1.2.2.cmml" xref="A1.E12.m1.12.12.11.7.1.1.1.2.2">𝑥</ci><ci id="A1.E12.m1.12.12.11.7.1.1.1.2.3.cmml" xref="A1.E12.m1.12.12.11.7.1.1.1.2.3">𝑡</ci></apply><ci id="A1.E12.m1.8.8.7.3.1.1.cmml" xref="A1.E12.m1.8.8.7.3.1.1">𝑗</ci></apply><apply id="A1.E12.m1.13.13.12.8.2.2.2.cmml" xref="A1.E12.m1.13.13.12.8.2.2.2"><csymbol cd="ambiguous" id="A1.E12.m1.13.13.12.8.2.2.2.1.cmml" xref="A1.E12.m1.13.13.12.8.2.2.2">superscript</csymbol><apply id="A1.E12.m1.13.13.12.8.2.2.2.2.cmml" xref="A1.E12.m1.13.13.12.8.2.2.2"><csymbol cd="ambiguous" id="A1.E12.m1.13.13.12.8.2.2.2.2.1.cmml" xref="A1.E12.m1.13.13.12.8.2.2.2">subscript</csymbol><ci id="A1.E12.m1.13.13.12.8.2.2.2.2.2.cmml" xref="A1.E12.m1.13.13.12.8.2.2.2.2.2">𝑝</ci><cn id="A1.E12.m1.13.13.12.8.2.2.2.2.3.cmml" type="integer" xref="A1.E12.m1.13.13.12.8.2.2.2.2.3">0</cn></apply><ci id="A1.E12.m1.9.9.8.4.1.1.cmml" xref="A1.E12.m1.9.9.8.4.1.1">𝑗</ci></apply></interval></apply></apply></apply></apply></apply><ci id="A1.E12.m1.20.20a.cmml" xref="A1.E12.m1.20.20"><mtext id="A1.E12.m1.20.20.cmml" xref="A1.E12.m1.20.20">where</mtext></ci></list></apply><apply id="A1.E12.m1.21.21.1.1.2.2.cmml" xref="A1.E12.m1.21.21.1.1.2.2"><eq id="A1.E12.m1.21.21.1.1.2.2.2.cmml" xref="A1.E12.m1.21.21.1.1.2.2.2"></eq><apply id="A1.E12.m1.21.21.1.1.2.2.3.cmml" xref="A1.E12.m1.21.21.1.1.2.2.3"><csymbol cd="ambiguous" id="A1.E12.m1.21.21.1.1.2.2.3.1.cmml" xref="A1.E12.m1.21.21.1.1.2.2.3">superscript</csymbol><apply id="A1.E12.m1.21.21.1.1.2.2.3.2.cmml" xref="A1.E12.m1.21.21.1.1.2.2.3"><csymbol cd="ambiguous" id="A1.E12.m1.21.21.1.1.2.2.3.2.1.cmml" xref="A1.E12.m1.21.21.1.1.2.2.3">subscript</csymbol><ci id="A1.E12.m1.21.21.1.1.2.2.3.2.2.cmml" xref="A1.E12.m1.21.21.1.1.2.2.3.2.2">𝑝</ci><cn id="A1.E12.m1.21.21.1.1.2.2.3.2.3.cmml" type="integer" xref="A1.E12.m1.21.21.1.1.2.2.3.2.3">0</cn></apply><ci id="A1.E12.m1.14.14.1.1.cmml" xref="A1.E12.m1.14.14.1.1">𝑗</ci></apply><apply id="A1.E12.m1.21.21.1.1.2.2.1.2.cmml" xref="A1.E12.m1.21.21.1.1.2.2.1.1"><ci id="A1.E12.m1.19.19.cmml" xref="A1.E12.m1.19.19">sigmoid</ci><apply id="A1.E12.m1.21.21.1.1.2.2.1.1.1.1.cmml" xref="A1.E12.m1.21.21.1.1.2.2.1.1.1.1"><times id="A1.E12.m1.21.21.1.1.2.2.1.1.1.1.2.cmml" xref="A1.E12.m1.21.21.1.1.2.2.1.1.1.1.2"></times><apply id="A1.E12.m1.21.21.1.1.2.2.1.1.1.1.1.2.cmml" xref="A1.E12.m1.21.21.1.1.2.2.1.1.1.1.1.1"><ci id="A1.E12.m1.16.16.cmml" xref="A1.E12.m1.16.16">DenoiserNet</ci><apply id="A1.E12.m1.21.21.1.1.2.2.1.1.1.1.1.1.1.1.cmml" xref="A1.E12.m1.21.21.1.1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E12.m1.21.21.1.1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E12.m1.21.21.1.1.2.2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E12.m1.21.21.1.1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E12.m1.21.21.1.1.2.2.1.1.1.1.1.1.1.1.2">𝐱</ci><ci id="A1.E12.m1.21.21.1.1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E12.m1.21.21.1.1.2.2.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><ci id="A1.E12.m1.17.17.cmml" xref="A1.E12.m1.17.17">𝐡</ci></apply><apply id="A1.E12.m1.21.21.1.1.2.2.1.1.1.1.3.1.cmml" xref="A1.E12.m1.21.21.1.1.2.2.1.1.1.1.3.2"><csymbol cd="latexml" id="A1.E12.m1.21.21.1.1.2.2.1.1.1.1.3.1.1.cmml" xref="A1.E12.m1.21.21.1.1.2.2.1.1.1.1.3.2.1">delimited-[]</csymbol><ci id="A1.E12.m1.18.18.cmml" xref="A1.E12.m1.18.18">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E12.m1.21c">p(\mathbf{x}_{t-1}|\mathbf{x}_{t})=\prod_{j=1}^{n}\operatorname{Bernoulli}%
\left(x_{t-1}^{(j)}\middle|\frac{\theta_{1}(x_{t}^{(j)},p_{0}^{(j)})}{\theta_{%
1}(x_{t}^{(j)},p_{0}^{(j)})+\theta_{0}(x_{t}^{(j)},p_{0}^{(j)})}\right)\quad%
\text{where}\quad p_{0}^{(j)}=\operatorname{sigmoid}(\operatorname{DenoiserNet%
}(\mathbf{x}_{t},\mathbf{h})[j]).</annotation><annotation encoding="application/x-llamapun" id="A1.E12.m1.21d">italic_p ( bold_x start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT | bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) = ∏ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT roman_Bernoulli ( italic_x start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT | divide start_ARG italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT , italic_p start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT ) end_ARG start_ARG italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT , italic_p start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT ) + italic_θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT , italic_p start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT ) end_ARG ) where italic_p start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT = roman_sigmoid ( roman_DenoiserNet ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , bold_h ) [ italic_j ] ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS1.SSS4.p4">
<p class="ltx_p" id="A1.SS1.SSS4.p4.2">At training time, we randomly sample a step index <math alttext="t" class="ltx_Math" display="inline" id="A1.SS1.SSS4.p4.1.m1.1"><semantics id="A1.SS1.SSS4.p4.1.m1.1a"><mi id="A1.SS1.SSS4.p4.1.m1.1.1" xref="A1.SS1.SSS4.p4.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS4.p4.1.m1.1b"><ci id="A1.SS1.SSS4.p4.1.m1.1.1.cmml" xref="A1.SS1.SSS4.p4.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS4.p4.1.m1.1c">t</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS4.p4.1.m1.1d">italic_t</annotation></semantics></math> from <math alttext="\mathcal{U}\{1,T\}" class="ltx_Math" display="inline" id="A1.SS1.SSS4.p4.2.m2.2"><semantics id="A1.SS1.SSS4.p4.2.m2.2a"><mrow id="A1.SS1.SSS4.p4.2.m2.2.3" xref="A1.SS1.SSS4.p4.2.m2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS1.SSS4.p4.2.m2.2.3.2" xref="A1.SS1.SSS4.p4.2.m2.2.3.2.cmml">𝒰</mi><mo id="A1.SS1.SSS4.p4.2.m2.2.3.1" xref="A1.SS1.SSS4.p4.2.m2.2.3.1.cmml">⁢</mo><mrow id="A1.SS1.SSS4.p4.2.m2.2.3.3.2" xref="A1.SS1.SSS4.p4.2.m2.2.3.3.1.cmml"><mo id="A1.SS1.SSS4.p4.2.m2.2.3.3.2.1" stretchy="false" xref="A1.SS1.SSS4.p4.2.m2.2.3.3.1.cmml">{</mo><mn id="A1.SS1.SSS4.p4.2.m2.1.1" xref="A1.SS1.SSS4.p4.2.m2.1.1.cmml">1</mn><mo id="A1.SS1.SSS4.p4.2.m2.2.3.3.2.2" xref="A1.SS1.SSS4.p4.2.m2.2.3.3.1.cmml">,</mo><mi id="A1.SS1.SSS4.p4.2.m2.2.2" xref="A1.SS1.SSS4.p4.2.m2.2.2.cmml">T</mi><mo id="A1.SS1.SSS4.p4.2.m2.2.3.3.2.3" stretchy="false" xref="A1.SS1.SSS4.p4.2.m2.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS4.p4.2.m2.2b"><apply id="A1.SS1.SSS4.p4.2.m2.2.3.cmml" xref="A1.SS1.SSS4.p4.2.m2.2.3"><times id="A1.SS1.SSS4.p4.2.m2.2.3.1.cmml" xref="A1.SS1.SSS4.p4.2.m2.2.3.1"></times><ci id="A1.SS1.SSS4.p4.2.m2.2.3.2.cmml" xref="A1.SS1.SSS4.p4.2.m2.2.3.2">𝒰</ci><set id="A1.SS1.SSS4.p4.2.m2.2.3.3.1.cmml" xref="A1.SS1.SSS4.p4.2.m2.2.3.3.2"><cn id="A1.SS1.SSS4.p4.2.m2.1.1.cmml" type="integer" xref="A1.SS1.SSS4.p4.2.m2.1.1">1</cn><ci id="A1.SS1.SSS4.p4.2.m2.2.2.cmml" xref="A1.SS1.SSS4.p4.2.m2.2.2">𝑇</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS4.p4.2.m2.2c">\mathcal{U}\{1,T\}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS4.p4.2.m2.2d">caligraphic_U { 1 , italic_T }</annotation></semantics></math>, perturb the ground truth fingerprint according to Eq. <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#A1.E7" title="In A.1.4 Diffusion fingerprint head ‣ A.1 Model architectures ‣ Appendix A Additional method details ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_tag">7</span></a>, and finally compute and back-propagate through the following training loss to align the predicted distribution to the ground truth posterior:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="L_{\text{fingerprint}}=\mathbb{E}_{t\sim\mathcal{U}\{1,T\},q(\mathbf{x}_{t}|%
\mathbf{x}_{0})}\left[\operatorname{KL}\left(q(\mathbf{x}_{t-1}|\mathbf{x}_{t}%
,\mathbf{x}_{0}),p(\mathbf{x}_{t-1}|\mathbf{x}_{t})\right)\right]." class="ltx_Math" display="block" id="A1.E13.m1.6"><semantics id="A1.E13.m1.6a"><mrow id="A1.E13.m1.6.6.1" xref="A1.E13.m1.6.6.1.1.cmml"><mrow id="A1.E13.m1.6.6.1.1" xref="A1.E13.m1.6.6.1.1.cmml"><msub id="A1.E13.m1.6.6.1.1.3" xref="A1.E13.m1.6.6.1.1.3.cmml"><mi id="A1.E13.m1.6.6.1.1.3.2" xref="A1.E13.m1.6.6.1.1.3.2.cmml">L</mi><mtext id="A1.E13.m1.6.6.1.1.3.3" xref="A1.E13.m1.6.6.1.1.3.3a.cmml">fingerprint</mtext></msub><mo id="A1.E13.m1.6.6.1.1.2" xref="A1.E13.m1.6.6.1.1.2.cmml">=</mo><mrow id="A1.E13.m1.6.6.1.1.1" xref="A1.E13.m1.6.6.1.1.1.cmml"><msub id="A1.E13.m1.6.6.1.1.1.3" xref="A1.E13.m1.6.6.1.1.1.3.cmml"><mi id="A1.E13.m1.6.6.1.1.1.3.2" xref="A1.E13.m1.6.6.1.1.1.3.2.cmml">𝔼</mi><mrow id="A1.E13.m1.4.4.4" xref="A1.E13.m1.4.4.4.cmml"><mi id="A1.E13.m1.4.4.4.6" xref="A1.E13.m1.4.4.4.6.cmml">t</mi><mo id="A1.E13.m1.4.4.4.5" xref="A1.E13.m1.4.4.4.5.cmml">∼</mo><mrow id="A1.E13.m1.4.4.4.4.2" xref="A1.E13.m1.4.4.4.4.3.cmml"><mrow id="A1.E13.m1.3.3.3.3.1.1" xref="A1.E13.m1.3.3.3.3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E13.m1.3.3.3.3.1.1.2" xref="A1.E13.m1.3.3.3.3.1.1.2.cmml">𝒰</mi><mo id="A1.E13.m1.3.3.3.3.1.1.1" xref="A1.E13.m1.3.3.3.3.1.1.1.cmml">⁢</mo><mrow id="A1.E13.m1.3.3.3.3.1.1.3.2" xref="A1.E13.m1.3.3.3.3.1.1.3.1.cmml"><mo id="A1.E13.m1.3.3.3.3.1.1.3.2.1" stretchy="false" xref="A1.E13.m1.3.3.3.3.1.1.3.1.cmml">{</mo><mn id="A1.E13.m1.1.1.1.1" xref="A1.E13.m1.1.1.1.1.cmml">1</mn><mo id="A1.E13.m1.3.3.3.3.1.1.3.2.2" xref="A1.E13.m1.3.3.3.3.1.1.3.1.cmml">,</mo><mi id="A1.E13.m1.2.2.2.2" xref="A1.E13.m1.2.2.2.2.cmml">T</mi><mo id="A1.E13.m1.3.3.3.3.1.1.3.2.3" stretchy="false" xref="A1.E13.m1.3.3.3.3.1.1.3.1.cmml">}</mo></mrow></mrow><mo id="A1.E13.m1.4.4.4.4.2.3" xref="A1.E13.m1.4.4.4.4.3.cmml">,</mo><mrow id="A1.E13.m1.4.4.4.4.2.2" xref="A1.E13.m1.4.4.4.4.2.2.cmml"><mi id="A1.E13.m1.4.4.4.4.2.2.3" xref="A1.E13.m1.4.4.4.4.2.2.3.cmml">q</mi><mo id="A1.E13.m1.4.4.4.4.2.2.2" xref="A1.E13.m1.4.4.4.4.2.2.2.cmml">⁢</mo><mrow id="A1.E13.m1.4.4.4.4.2.2.1.1" xref="A1.E13.m1.4.4.4.4.2.2.1.1.1.cmml"><mo id="A1.E13.m1.4.4.4.4.2.2.1.1.2" stretchy="false" xref="A1.E13.m1.4.4.4.4.2.2.1.1.1.cmml">(</mo><mrow id="A1.E13.m1.4.4.4.4.2.2.1.1.1" xref="A1.E13.m1.4.4.4.4.2.2.1.1.1.cmml"><msub id="A1.E13.m1.4.4.4.4.2.2.1.1.1.2" xref="A1.E13.m1.4.4.4.4.2.2.1.1.1.2.cmml"><mi id="A1.E13.m1.4.4.4.4.2.2.1.1.1.2.2" xref="A1.E13.m1.4.4.4.4.2.2.1.1.1.2.2.cmml">𝐱</mi><mi id="A1.E13.m1.4.4.4.4.2.2.1.1.1.2.3" xref="A1.E13.m1.4.4.4.4.2.2.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="A1.E13.m1.4.4.4.4.2.2.1.1.1.1" xref="A1.E13.m1.4.4.4.4.2.2.1.1.1.1.cmml">|</mo><msub id="A1.E13.m1.4.4.4.4.2.2.1.1.1.3" xref="A1.E13.m1.4.4.4.4.2.2.1.1.1.3.cmml"><mi id="A1.E13.m1.4.4.4.4.2.2.1.1.1.3.2" xref="A1.E13.m1.4.4.4.4.2.2.1.1.1.3.2.cmml">𝐱</mi><mn id="A1.E13.m1.4.4.4.4.2.2.1.1.1.3.3" xref="A1.E13.m1.4.4.4.4.2.2.1.1.1.3.3.cmml">0</mn></msub></mrow><mo id="A1.E13.m1.4.4.4.4.2.2.1.1.3" stretchy="false" xref="A1.E13.m1.4.4.4.4.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></msub><mo id="A1.E13.m1.6.6.1.1.1.2" xref="A1.E13.m1.6.6.1.1.1.2.cmml">⁢</mo><mrow id="A1.E13.m1.6.6.1.1.1.1.1" xref="A1.E13.m1.6.6.1.1.1.1.2.cmml"><mo id="A1.E13.m1.6.6.1.1.1.1.1.2" xref="A1.E13.m1.6.6.1.1.1.1.2.1.cmml">[</mo><mrow id="A1.E13.m1.6.6.1.1.1.1.1.1.2" xref="A1.E13.m1.6.6.1.1.1.1.1.1.3.cmml"><mi id="A1.E13.m1.5.5" xref="A1.E13.m1.5.5.cmml">KL</mi><mo id="A1.E13.m1.6.6.1.1.1.1.1.1.2a" xref="A1.E13.m1.6.6.1.1.1.1.1.1.3.cmml">⁡</mo><mrow id="A1.E13.m1.6.6.1.1.1.1.1.1.2.2" xref="A1.E13.m1.6.6.1.1.1.1.1.1.3.cmml"><mo id="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.3" xref="A1.E13.m1.6.6.1.1.1.1.1.1.3.cmml">(</mo><mrow id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.3" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.3.cmml">q</mi><mo id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.2" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.4" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.4.cmml"><mi id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.4.2" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.4.2.cmml">𝐱</mi><mrow id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.4.3" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.4.3.cmml"><mi id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.4.3.2" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.4.3.2.cmml">t</mi><mo id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.4.3.1" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.4.3.1.cmml">−</mo><mn id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.4.3.3" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.4.3.3.cmml">1</mn></mrow></msub><mo fence="false" id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">|</mo><mrow id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><msub id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">𝐱</mi><mn id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">0</mn></msub></mrow></mrow><mo id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.4" xref="A1.E13.m1.6.6.1.1.1.1.1.1.3.cmml">,</mo><mrow id="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2" xref="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.cmml"><mi id="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.3" xref="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.3.cmml">p</mi><mo id="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.2" xref="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.2.cmml">⁢</mo><mrow id="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.1.1" xref="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.1.1.1.cmml"><mo id="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.1.1.2" stretchy="false" xref="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.1.1.1.cmml">(</mo><mrow id="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.1.1.1" xref="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.1.1.1.cmml"><msub id="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.1.1.1.2" xref="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.1.1.1.2.cmml"><mi id="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.1.1.1.2.2" xref="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.1.1.1.2.2.cmml">𝐱</mi><mrow id="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.1.1.1.2.3" xref="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.1.1.1.2.3.cmml"><mi id="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.1.1.1.2.3.2" xref="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.1.1.1.2.3.2.cmml">t</mi><mo id="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.1.1.1.2.3.1" xref="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.1.1.1.2.3.1.cmml">−</mo><mn id="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.1.1.1.2.3.3" xref="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo fence="false" id="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.1.1.1.1" xref="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.1.1.1.1.cmml">|</mo><msub id="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.1.1.1.3" xref="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.1.1.1.3.cmml"><mi id="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.1.1.1.3.2" xref="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.1.1.1.3.2.cmml">𝐱</mi><mi id="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.1.1.1.3.3" xref="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.1.1.3" stretchy="false" xref="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.5" xref="A1.E13.m1.6.6.1.1.1.1.1.1.3.cmml">)</mo></mrow></mrow><mo id="A1.E13.m1.6.6.1.1.1.1.1.3" xref="A1.E13.m1.6.6.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="A1.E13.m1.6.6.1.2" lspace="0em" xref="A1.E13.m1.6.6.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E13.m1.6b"><apply id="A1.E13.m1.6.6.1.1.cmml" xref="A1.E13.m1.6.6.1"><eq id="A1.E13.m1.6.6.1.1.2.cmml" xref="A1.E13.m1.6.6.1.1.2"></eq><apply id="A1.E13.m1.6.6.1.1.3.cmml" xref="A1.E13.m1.6.6.1.1.3"><csymbol cd="ambiguous" id="A1.E13.m1.6.6.1.1.3.1.cmml" xref="A1.E13.m1.6.6.1.1.3">subscript</csymbol><ci id="A1.E13.m1.6.6.1.1.3.2.cmml" xref="A1.E13.m1.6.6.1.1.3.2">𝐿</ci><ci id="A1.E13.m1.6.6.1.1.3.3a.cmml" xref="A1.E13.m1.6.6.1.1.3.3"><mtext id="A1.E13.m1.6.6.1.1.3.3.cmml" mathsize="70%" xref="A1.E13.m1.6.6.1.1.3.3">fingerprint</mtext></ci></apply><apply id="A1.E13.m1.6.6.1.1.1.cmml" xref="A1.E13.m1.6.6.1.1.1"><times id="A1.E13.m1.6.6.1.1.1.2.cmml" xref="A1.E13.m1.6.6.1.1.1.2"></times><apply id="A1.E13.m1.6.6.1.1.1.3.cmml" xref="A1.E13.m1.6.6.1.1.1.3"><csymbol cd="ambiguous" id="A1.E13.m1.6.6.1.1.1.3.1.cmml" xref="A1.E13.m1.6.6.1.1.1.3">subscript</csymbol><ci id="A1.E13.m1.6.6.1.1.1.3.2.cmml" xref="A1.E13.m1.6.6.1.1.1.3.2">𝔼</ci><apply id="A1.E13.m1.4.4.4.cmml" xref="A1.E13.m1.4.4.4"><csymbol cd="latexml" id="A1.E13.m1.4.4.4.5.cmml" xref="A1.E13.m1.4.4.4.5">similar-to</csymbol><ci id="A1.E13.m1.4.4.4.6.cmml" xref="A1.E13.m1.4.4.4.6">𝑡</ci><list id="A1.E13.m1.4.4.4.4.3.cmml" xref="A1.E13.m1.4.4.4.4.2"><apply id="A1.E13.m1.3.3.3.3.1.1.cmml" xref="A1.E13.m1.3.3.3.3.1.1"><times id="A1.E13.m1.3.3.3.3.1.1.1.cmml" xref="A1.E13.m1.3.3.3.3.1.1.1"></times><ci id="A1.E13.m1.3.3.3.3.1.1.2.cmml" xref="A1.E13.m1.3.3.3.3.1.1.2">𝒰</ci><set id="A1.E13.m1.3.3.3.3.1.1.3.1.cmml" xref="A1.E13.m1.3.3.3.3.1.1.3.2"><cn id="A1.E13.m1.1.1.1.1.cmml" type="integer" xref="A1.E13.m1.1.1.1.1">1</cn><ci id="A1.E13.m1.2.2.2.2.cmml" xref="A1.E13.m1.2.2.2.2">𝑇</ci></set></apply><apply id="A1.E13.m1.4.4.4.4.2.2.cmml" xref="A1.E13.m1.4.4.4.4.2.2"><times id="A1.E13.m1.4.4.4.4.2.2.2.cmml" xref="A1.E13.m1.4.4.4.4.2.2.2"></times><ci id="A1.E13.m1.4.4.4.4.2.2.3.cmml" xref="A1.E13.m1.4.4.4.4.2.2.3">𝑞</ci><apply id="A1.E13.m1.4.4.4.4.2.2.1.1.1.cmml" xref="A1.E13.m1.4.4.4.4.2.2.1.1"><csymbol cd="latexml" id="A1.E13.m1.4.4.4.4.2.2.1.1.1.1.cmml" xref="A1.E13.m1.4.4.4.4.2.2.1.1.1.1">conditional</csymbol><apply id="A1.E13.m1.4.4.4.4.2.2.1.1.1.2.cmml" xref="A1.E13.m1.4.4.4.4.2.2.1.1.1.2"><csymbol cd="ambiguous" id="A1.E13.m1.4.4.4.4.2.2.1.1.1.2.1.cmml" xref="A1.E13.m1.4.4.4.4.2.2.1.1.1.2">subscript</csymbol><ci id="A1.E13.m1.4.4.4.4.2.2.1.1.1.2.2.cmml" xref="A1.E13.m1.4.4.4.4.2.2.1.1.1.2.2">𝐱</ci><ci id="A1.E13.m1.4.4.4.4.2.2.1.1.1.2.3.cmml" xref="A1.E13.m1.4.4.4.4.2.2.1.1.1.2.3">𝑡</ci></apply><apply id="A1.E13.m1.4.4.4.4.2.2.1.1.1.3.cmml" xref="A1.E13.m1.4.4.4.4.2.2.1.1.1.3"><csymbol cd="ambiguous" id="A1.E13.m1.4.4.4.4.2.2.1.1.1.3.1.cmml" xref="A1.E13.m1.4.4.4.4.2.2.1.1.1.3">subscript</csymbol><ci id="A1.E13.m1.4.4.4.4.2.2.1.1.1.3.2.cmml" xref="A1.E13.m1.4.4.4.4.2.2.1.1.1.3.2">𝐱</ci><cn id="A1.E13.m1.4.4.4.4.2.2.1.1.1.3.3.cmml" type="integer" xref="A1.E13.m1.4.4.4.4.2.2.1.1.1.3.3">0</cn></apply></apply></apply></list></apply></apply><apply id="A1.E13.m1.6.6.1.1.1.1.2.cmml" xref="A1.E13.m1.6.6.1.1.1.1.1"><csymbol cd="latexml" id="A1.E13.m1.6.6.1.1.1.1.2.1.cmml" xref="A1.E13.m1.6.6.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A1.E13.m1.6.6.1.1.1.1.1.1.3.cmml" xref="A1.E13.m1.6.6.1.1.1.1.1.1.2"><ci id="A1.E13.m1.5.5.cmml" xref="A1.E13.m1.5.5">KL</ci><apply id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1"><times id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.2"></times><ci id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.3">𝑞</ci><apply id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.3">conditional</csymbol><apply id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.4.2.cmml" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.4.2">𝐱</ci><apply id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.4.3.cmml" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.4.3"><minus id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.4.3.1.cmml" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.4.3.1"></minus><ci id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.4.3.2.cmml" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.4.3.2">𝑡</ci><cn id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.4.3.3.cmml" type="integer" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.4.3.3">1</cn></apply></apply><list id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.2"><apply id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐱</ci><ci id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2">𝐱</ci><cn id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" type="integer" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3">0</cn></apply></list></apply></apply><apply id="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.cmml" xref="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2"><times id="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.2.cmml" xref="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.2"></times><ci id="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.3.cmml" xref="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.3">𝑝</ci><apply id="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.1.1.1.cmml" xref="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.1.1"><csymbol cd="latexml" id="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.1.1.1.1.cmml" xref="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.1.1.1.1">conditional</csymbol><apply id="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.1.1.1.2.cmml" xref="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.1.1.1.2.1.cmml" xref="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.1.1.1.2">subscript</csymbol><ci id="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.1.1.1.2.2.cmml" xref="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.1.1.1.2.2">𝐱</ci><apply id="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.1.1.1.2.3.cmml" xref="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.1.1.1.2.3"><minus id="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.1.1.1.2.3.1.cmml" xref="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.1.1.1.2.3.1"></minus><ci id="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.1.1.1.2.3.2.cmml" xref="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.1.1.1.2.3.2">𝑡</ci><cn id="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.1.1.1.2.3.3.cmml" type="integer" xref="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.1.1.1.2.3.3">1</cn></apply></apply><apply id="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.1.1.1.3.cmml" xref="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.1.1.1.3.1.cmml" xref="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.1.1.1.3">subscript</csymbol><ci id="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.1.1.1.3.2.cmml" xref="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.1.1.1.3.2">𝐱</ci><ci id="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.1.1.1.3.3.cmml" xref="A1.E13.m1.6.6.1.1.1.1.1.1.2.2.2.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E13.m1.6c">L_{\text{fingerprint}}=\mathbb{E}_{t\sim\mathcal{U}\{1,T\},q(\mathbf{x}_{t}|%
\mathbf{x}_{0})}\left[\operatorname{KL}\left(q(\mathbf{x}_{t-1}|\mathbf{x}_{t}%
,\mathbf{x}_{0}),p(\mathbf{x}_{t-1}|\mathbf{x}_{t})\right)\right].</annotation><annotation encoding="application/x-llamapun" id="A1.E13.m1.6d">italic_L start_POSTSUBSCRIPT fingerprint end_POSTSUBSCRIPT = blackboard_E start_POSTSUBSCRIPT italic_t ∼ caligraphic_U { 1 , italic_T } , italic_q ( bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) end_POSTSUBSCRIPT [ roman_KL ( italic_q ( bold_x start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT | bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) , italic_p ( bold_x start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT | bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ) ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS1.SSS4.p4.5">During inference, we start with a random bit vector <math alttext="\mathbf{x}_{T}" class="ltx_Math" display="inline" id="A1.SS1.SSS4.p4.3.m1.1"><semantics id="A1.SS1.SSS4.p4.3.m1.1a"><msub id="A1.SS1.SSS4.p4.3.m1.1.1" xref="A1.SS1.SSS4.p4.3.m1.1.1.cmml"><mi id="A1.SS1.SSS4.p4.3.m1.1.1.2" xref="A1.SS1.SSS4.p4.3.m1.1.1.2.cmml">𝐱</mi><mi id="A1.SS1.SSS4.p4.3.m1.1.1.3" xref="A1.SS1.SSS4.p4.3.m1.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS4.p4.3.m1.1b"><apply id="A1.SS1.SSS4.p4.3.m1.1.1.cmml" xref="A1.SS1.SSS4.p4.3.m1.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS4.p4.3.m1.1.1.1.cmml" xref="A1.SS1.SSS4.p4.3.m1.1.1">subscript</csymbol><ci id="A1.SS1.SSS4.p4.3.m1.1.1.2.cmml" xref="A1.SS1.SSS4.p4.3.m1.1.1.2">𝐱</ci><ci id="A1.SS1.SSS4.p4.3.m1.1.1.3.cmml" xref="A1.SS1.SSS4.p4.3.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS4.p4.3.m1.1c">\mathbf{x}_{T}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS4.p4.3.m1.1d">bold_x start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT</annotation></semantics></math> sampled from uniform Bernoulli distribution, and resample it following <math alttext="p(\mathbf{x}_{t-1}|\mathbf{x}_{t})" class="ltx_Math" display="inline" id="A1.SS1.SSS4.p4.4.m2.1"><semantics id="A1.SS1.SSS4.p4.4.m2.1a"><mrow id="A1.SS1.SSS4.p4.4.m2.1.1" xref="A1.SS1.SSS4.p4.4.m2.1.1.cmml"><mi id="A1.SS1.SSS4.p4.4.m2.1.1.3" xref="A1.SS1.SSS4.p4.4.m2.1.1.3.cmml">p</mi><mo id="A1.SS1.SSS4.p4.4.m2.1.1.2" xref="A1.SS1.SSS4.p4.4.m2.1.1.2.cmml">⁢</mo><mrow id="A1.SS1.SSS4.p4.4.m2.1.1.1.1" xref="A1.SS1.SSS4.p4.4.m2.1.1.1.1.1.cmml"><mo id="A1.SS1.SSS4.p4.4.m2.1.1.1.1.2" stretchy="false" xref="A1.SS1.SSS4.p4.4.m2.1.1.1.1.1.cmml">(</mo><mrow id="A1.SS1.SSS4.p4.4.m2.1.1.1.1.1" xref="A1.SS1.SSS4.p4.4.m2.1.1.1.1.1.cmml"><msub id="A1.SS1.SSS4.p4.4.m2.1.1.1.1.1.2" xref="A1.SS1.SSS4.p4.4.m2.1.1.1.1.1.2.cmml"><mi id="A1.SS1.SSS4.p4.4.m2.1.1.1.1.1.2.2" xref="A1.SS1.SSS4.p4.4.m2.1.1.1.1.1.2.2.cmml">𝐱</mi><mrow id="A1.SS1.SSS4.p4.4.m2.1.1.1.1.1.2.3" xref="A1.SS1.SSS4.p4.4.m2.1.1.1.1.1.2.3.cmml"><mi id="A1.SS1.SSS4.p4.4.m2.1.1.1.1.1.2.3.2" xref="A1.SS1.SSS4.p4.4.m2.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="A1.SS1.SSS4.p4.4.m2.1.1.1.1.1.2.3.1" xref="A1.SS1.SSS4.p4.4.m2.1.1.1.1.1.2.3.1.cmml">−</mo><mn id="A1.SS1.SSS4.p4.4.m2.1.1.1.1.1.2.3.3" xref="A1.SS1.SSS4.p4.4.m2.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo fence="false" id="A1.SS1.SSS4.p4.4.m2.1.1.1.1.1.1" xref="A1.SS1.SSS4.p4.4.m2.1.1.1.1.1.1.cmml">|</mo><msub id="A1.SS1.SSS4.p4.4.m2.1.1.1.1.1.3" xref="A1.SS1.SSS4.p4.4.m2.1.1.1.1.1.3.cmml"><mi id="A1.SS1.SSS4.p4.4.m2.1.1.1.1.1.3.2" xref="A1.SS1.SSS4.p4.4.m2.1.1.1.1.1.3.2.cmml">𝐱</mi><mi id="A1.SS1.SSS4.p4.4.m2.1.1.1.1.1.3.3" xref="A1.SS1.SSS4.p4.4.m2.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="A1.SS1.SSS4.p4.4.m2.1.1.1.1.3" stretchy="false" xref="A1.SS1.SSS4.p4.4.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS4.p4.4.m2.1b"><apply id="A1.SS1.SSS4.p4.4.m2.1.1.cmml" xref="A1.SS1.SSS4.p4.4.m2.1.1"><times id="A1.SS1.SSS4.p4.4.m2.1.1.2.cmml" xref="A1.SS1.SSS4.p4.4.m2.1.1.2"></times><ci id="A1.SS1.SSS4.p4.4.m2.1.1.3.cmml" xref="A1.SS1.SSS4.p4.4.m2.1.1.3">𝑝</ci><apply id="A1.SS1.SSS4.p4.4.m2.1.1.1.1.1.cmml" xref="A1.SS1.SSS4.p4.4.m2.1.1.1.1"><csymbol cd="latexml" id="A1.SS1.SSS4.p4.4.m2.1.1.1.1.1.1.cmml" xref="A1.SS1.SSS4.p4.4.m2.1.1.1.1.1.1">conditional</csymbol><apply id="A1.SS1.SSS4.p4.4.m2.1.1.1.1.1.2.cmml" xref="A1.SS1.SSS4.p4.4.m2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.SS1.SSS4.p4.4.m2.1.1.1.1.1.2.1.cmml" xref="A1.SS1.SSS4.p4.4.m2.1.1.1.1.1.2">subscript</csymbol><ci id="A1.SS1.SSS4.p4.4.m2.1.1.1.1.1.2.2.cmml" xref="A1.SS1.SSS4.p4.4.m2.1.1.1.1.1.2.2">𝐱</ci><apply id="A1.SS1.SSS4.p4.4.m2.1.1.1.1.1.2.3.cmml" xref="A1.SS1.SSS4.p4.4.m2.1.1.1.1.1.2.3"><minus id="A1.SS1.SSS4.p4.4.m2.1.1.1.1.1.2.3.1.cmml" xref="A1.SS1.SSS4.p4.4.m2.1.1.1.1.1.2.3.1"></minus><ci id="A1.SS1.SSS4.p4.4.m2.1.1.1.1.1.2.3.2.cmml" xref="A1.SS1.SSS4.p4.4.m2.1.1.1.1.1.2.3.2">𝑡</ci><cn id="A1.SS1.SSS4.p4.4.m2.1.1.1.1.1.2.3.3.cmml" type="integer" xref="A1.SS1.SSS4.p4.4.m2.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="A1.SS1.SSS4.p4.4.m2.1.1.1.1.1.3.cmml" xref="A1.SS1.SSS4.p4.4.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.SS1.SSS4.p4.4.m2.1.1.1.1.1.3.1.cmml" xref="A1.SS1.SSS4.p4.4.m2.1.1.1.1.1.3">subscript</csymbol><ci id="A1.SS1.SSS4.p4.4.m2.1.1.1.1.1.3.2.cmml" xref="A1.SS1.SSS4.p4.4.m2.1.1.1.1.1.3.2">𝐱</ci><ci id="A1.SS1.SSS4.p4.4.m2.1.1.1.1.1.3.3.cmml" xref="A1.SS1.SSS4.p4.4.m2.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS4.p4.4.m2.1c">p(\mathbf{x}_{t-1}|\mathbf{x}_{t})</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS4.p4.4.m2.1d">italic_p ( bold_x start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT | bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> for <math alttext="T" class="ltx_Math" display="inline" id="A1.SS1.SSS4.p4.5.m3.1"><semantics id="A1.SS1.SSS4.p4.5.m3.1a"><mi id="A1.SS1.SSS4.p4.5.m3.1.1" xref="A1.SS1.SSS4.p4.5.m3.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS4.p4.5.m3.1b"><ci id="A1.SS1.SSS4.p4.5.m3.1.1.cmml" xref="A1.SS1.SSS4.p4.5.m3.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS4.p4.5.m3.1c">T</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS4.p4.5.m3.1d">italic_T</annotation></semantics></math> steps.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS1.SSS4.p5">
<p class="ltx_p" id="A1.SS1.SSS4.p5.3">SynFormer’s diffusion module has <math alttext="T=100" class="ltx_Math" display="inline" id="A1.SS1.SSS4.p5.1.m1.1"><semantics id="A1.SS1.SSS4.p5.1.m1.1a"><mrow id="A1.SS1.SSS4.p5.1.m1.1.1" xref="A1.SS1.SSS4.p5.1.m1.1.1.cmml"><mi id="A1.SS1.SSS4.p5.1.m1.1.1.2" xref="A1.SS1.SSS4.p5.1.m1.1.1.2.cmml">T</mi><mo id="A1.SS1.SSS4.p5.1.m1.1.1.1" xref="A1.SS1.SSS4.p5.1.m1.1.1.1.cmml">=</mo><mn id="A1.SS1.SSS4.p5.1.m1.1.1.3" xref="A1.SS1.SSS4.p5.1.m1.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS4.p5.1.m1.1b"><apply id="A1.SS1.SSS4.p5.1.m1.1.1.cmml" xref="A1.SS1.SSS4.p5.1.m1.1.1"><eq id="A1.SS1.SSS4.p5.1.m1.1.1.1.cmml" xref="A1.SS1.SSS4.p5.1.m1.1.1.1"></eq><ci id="A1.SS1.SSS4.p5.1.m1.1.1.2.cmml" xref="A1.SS1.SSS4.p5.1.m1.1.1.2">𝑇</ci><cn id="A1.SS1.SSS4.p5.1.m1.1.1.3.cmml" type="integer" xref="A1.SS1.SSS4.p5.1.m1.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS4.p5.1.m1.1c">T=100</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS4.p5.1.m1.1d">italic_T = 100</annotation></semantics></math> timesteps and the hyper-parameter <math alttext="s" class="ltx_Math" display="inline" id="A1.SS1.SSS4.p5.2.m2.1"><semantics id="A1.SS1.SSS4.p5.2.m2.1a"><mi id="A1.SS1.SSS4.p5.2.m2.1.1" xref="A1.SS1.SSS4.p5.2.m2.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS4.p5.2.m2.1b"><ci id="A1.SS1.SSS4.p5.2.m2.1.1.cmml" xref="A1.SS1.SSS4.p5.2.m2.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS4.p5.2.m2.1c">s</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS4.p5.2.m2.1d">italic_s</annotation></semantics></math> controlling the noise schedule is set to 0.01.
The DenoiserNet is a multi-layer perceptron, with input dimension 2,816 (<math alttext="\dim(\mathbf{h})+\dim(\mathbf{x})" class="ltx_Math" display="inline" id="A1.SS1.SSS4.p5.3.m3.2"><semantics id="A1.SS1.SSS4.p5.3.m3.2a"><mrow id="A1.SS1.SSS4.p5.3.m3.2.3" xref="A1.SS1.SSS4.p5.3.m3.2.3.cmml"><mrow id="A1.SS1.SSS4.p5.3.m3.2.3.2" xref="A1.SS1.SSS4.p5.3.m3.2.3.2.cmml"><mo id="A1.SS1.SSS4.p5.3.m3.2.3.2.1" rspace="0em" xref="A1.SS1.SSS4.p5.3.m3.2.3.2.1.cmml">dim</mo><mrow id="A1.SS1.SSS4.p5.3.m3.2.3.2.2.2" xref="A1.SS1.SSS4.p5.3.m3.2.3.2.cmml"><mo id="A1.SS1.SSS4.p5.3.m3.2.3.2.2.2.1" stretchy="false" xref="A1.SS1.SSS4.p5.3.m3.2.3.2.cmml">(</mo><mi id="A1.SS1.SSS4.p5.3.m3.1.1" xref="A1.SS1.SSS4.p5.3.m3.1.1.cmml">𝐡</mi><mo id="A1.SS1.SSS4.p5.3.m3.2.3.2.2.2.2" stretchy="false" xref="A1.SS1.SSS4.p5.3.m3.2.3.2.cmml">)</mo></mrow></mrow><mo id="A1.SS1.SSS4.p5.3.m3.2.3.1" xref="A1.SS1.SSS4.p5.3.m3.2.3.1.cmml">+</mo><mrow id="A1.SS1.SSS4.p5.3.m3.2.3.3" xref="A1.SS1.SSS4.p5.3.m3.2.3.3.cmml"><mo id="A1.SS1.SSS4.p5.3.m3.2.3.3.1" lspace="0em" rspace="0em" xref="A1.SS1.SSS4.p5.3.m3.2.3.3.1.cmml">dim</mo><mrow id="A1.SS1.SSS4.p5.3.m3.2.3.3.2.2" xref="A1.SS1.SSS4.p5.3.m3.2.3.3.cmml"><mo id="A1.SS1.SSS4.p5.3.m3.2.3.3.2.2.1" stretchy="false" xref="A1.SS1.SSS4.p5.3.m3.2.3.3.cmml">(</mo><mi id="A1.SS1.SSS4.p5.3.m3.2.2" xref="A1.SS1.SSS4.p5.3.m3.2.2.cmml">𝐱</mi><mo id="A1.SS1.SSS4.p5.3.m3.2.3.3.2.2.2" stretchy="false" xref="A1.SS1.SSS4.p5.3.m3.2.3.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS4.p5.3.m3.2b"><apply id="A1.SS1.SSS4.p5.3.m3.2.3.cmml" xref="A1.SS1.SSS4.p5.3.m3.2.3"><plus id="A1.SS1.SSS4.p5.3.m3.2.3.1.cmml" xref="A1.SS1.SSS4.p5.3.m3.2.3.1"></plus><apply id="A1.SS1.SSS4.p5.3.m3.2.3.2.cmml" xref="A1.SS1.SSS4.p5.3.m3.2.3.2"><csymbol cd="latexml" id="A1.SS1.SSS4.p5.3.m3.2.3.2.1.cmml" xref="A1.SS1.SSS4.p5.3.m3.2.3.2.1">dimension</csymbol><ci id="A1.SS1.SSS4.p5.3.m3.1.1.cmml" xref="A1.SS1.SSS4.p5.3.m3.1.1">𝐡</ci></apply><apply id="A1.SS1.SSS4.p5.3.m3.2.3.3.cmml" xref="A1.SS1.SSS4.p5.3.m3.2.3.3"><csymbol cd="latexml" id="A1.SS1.SSS4.p5.3.m3.2.3.3.1.cmml" xref="A1.SS1.SSS4.p5.3.m3.2.3.3.1">dimension</csymbol><ci id="A1.SS1.SSS4.p5.3.m3.2.2.cmml" xref="A1.SS1.SSS4.p5.3.m3.2.2">𝐱</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS4.p5.3.m3.2c">\dim(\mathbf{h})+\dim(\mathbf{x})</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS4.p5.3.m3.2d">roman_dim ( bold_h ) + roman_dim ( bold_x )</annotation></semantics></math>), hidden dimension 4096, output dimension 2,048 (fingerprint size), and ReLU activation in between.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="A1.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Training details</h3>
<section class="ltx_subsubsection" id="A1.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.2.1 </span>Training data generation</h4>
<div class="ltx_para ltx_noindent" id="A1.SS2.SSS1.p1">
<p class="ltx_p" id="A1.SS2.SSS1.p1.1">We generate random postfix notations of synthesis using the building blocks and reaction templates from the database to train SynFormer.
To ensure the validity of generated postfix notations, we leverage the <span class="ltx_text ltx_font_italic" id="A1.SS2.SSS1.p1.1.1">synthesis stack</span> data structure introduced in our previous model <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib67" title="">67</a>]</cite> to store intermediate reaction products during synthesis.
When training SynFormer-ED, the generated postfix notation is used to supervised the decoder part and the SMILES string of the final product is used as the input to the encoder part.
For SynFormer-D, only postfix notations are used to train the model.
The detail of this data generation procedure is described in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#alg1" title="In A.2.1 Training data generation ‣ A.2 Training details ‣ Appendix A Additional method details ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure class="ltx_float ltx_algorithm" id="alg1">
<div class="ltx_listing ltx_lst_numbers_left ltx_listing" id="alg1.40">
<div class="ltx_listingline" id="alg1.1.1">
<span class="ltx_text" id="alg1.1.1.1"><span class="ltx_text ltx_font_bold" id="alg1.1.1.1.1">Input:</span> </span><math alttext="m_{r}" class="ltx_Math" display="inline" id="alg1.1.1.m1.1"><semantics id="alg1.1.1.m1.1a"><msub id="alg1.1.1.m1.1.1" xref="alg1.1.1.m1.1.1.cmml"><mi id="alg1.1.1.m1.1.1.2" xref="alg1.1.1.m1.1.1.2.cmml">m</mi><mi id="alg1.1.1.m1.1.1.3" xref="alg1.1.1.m1.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.1.1.m1.1b"><apply id="alg1.1.1.m1.1.1.cmml" xref="alg1.1.1.m1.1.1"><csymbol cd="ambiguous" id="alg1.1.1.m1.1.1.1.cmml" xref="alg1.1.1.m1.1.1">subscript</csymbol><ci id="alg1.1.1.m1.1.1.2.cmml" xref="alg1.1.1.m1.1.1.2">𝑚</ci><ci id="alg1.1.1.m1.1.1.3.cmml" xref="alg1.1.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.1.1.m1.1c">m_{r}</annotation><annotation encoding="application/x-llamapun" id="alg1.1.1.m1.1d">italic_m start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math>, maximum number of reactions
</div>
<div class="ltx_listingline" id="alg1.2.2">
<span class="ltx_text" id="alg1.2.2.1"><span class="ltx_text ltx_font_bold" id="alg1.2.2.1.1">Input:</span> </span><math alttext="m_{a}" class="ltx_Math" display="inline" id="alg1.2.2.m1.1"><semantics id="alg1.2.2.m1.1a"><msub id="alg1.2.2.m1.1.1" xref="alg1.2.2.m1.1.1.cmml"><mi id="alg1.2.2.m1.1.1.2" xref="alg1.2.2.m1.1.1.2.cmml">m</mi><mi id="alg1.2.2.m1.1.1.3" xref="alg1.2.2.m1.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.2.2.m1.1b"><apply id="alg1.2.2.m1.1.1.cmml" xref="alg1.2.2.m1.1.1"><csymbol cd="ambiguous" id="alg1.2.2.m1.1.1.1.cmml" xref="alg1.2.2.m1.1.1">subscript</csymbol><ci id="alg1.2.2.m1.1.1.2.cmml" xref="alg1.2.2.m1.1.1.2">𝑚</ci><ci id="alg1.2.2.m1.1.1.3.cmml" xref="alg1.2.2.m1.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.2.2.m1.1c">m_{a}</annotation><annotation encoding="application/x-llamapun" id="alg1.2.2.m1.1d">italic_m start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math>, maximum number of atoms in the final product molecule
</div>
<div class="ltx_listingline" id="alg1.4.4">
<span class="ltx_text" id="alg1.4.4.1"><span class="ltx_text ltx_font_bold" id="alg1.4.4.1.1">Input:</span> </span><math alttext="\mathcal{F}:M\mapsto\{R\}" class="ltx_Math" display="inline" id="alg1.3.3.m1.1"><semantics id="alg1.3.3.m1.1a"><mrow id="alg1.3.3.m1.1.2" xref="alg1.3.3.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.3.3.m1.1.2.2" xref="alg1.3.3.m1.1.2.2.cmml">ℱ</mi><mo id="alg1.3.3.m1.1.2.1" lspace="0.278em" rspace="0.278em" xref="alg1.3.3.m1.1.2.1.cmml">:</mo><mrow id="alg1.3.3.m1.1.2.3" xref="alg1.3.3.m1.1.2.3.cmml"><mi id="alg1.3.3.m1.1.2.3.2" xref="alg1.3.3.m1.1.2.3.2.cmml">M</mi><mo id="alg1.3.3.m1.1.2.3.1" stretchy="false" xref="alg1.3.3.m1.1.2.3.1.cmml">↦</mo><mrow id="alg1.3.3.m1.1.2.3.3.2" xref="alg1.3.3.m1.1.2.3.3.1.cmml"><mo id="alg1.3.3.m1.1.2.3.3.2.1" stretchy="false" xref="alg1.3.3.m1.1.2.3.3.1.cmml">{</mo><mi id="alg1.3.3.m1.1.1" xref="alg1.3.3.m1.1.1.cmml">R</mi><mo id="alg1.3.3.m1.1.2.3.3.2.2" stretchy="false" xref="alg1.3.3.m1.1.2.3.3.1.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.3.3.m1.1b"><apply id="alg1.3.3.m1.1.2.cmml" xref="alg1.3.3.m1.1.2"><ci id="alg1.3.3.m1.1.2.1.cmml" xref="alg1.3.3.m1.1.2.1">:</ci><ci id="alg1.3.3.m1.1.2.2.cmml" xref="alg1.3.3.m1.1.2.2">ℱ</ci><apply id="alg1.3.3.m1.1.2.3.cmml" xref="alg1.3.3.m1.1.2.3"><csymbol cd="latexml" id="alg1.3.3.m1.1.2.3.1.cmml" xref="alg1.3.3.m1.1.2.3.1">maps-to</csymbol><ci id="alg1.3.3.m1.1.2.3.2.cmml" xref="alg1.3.3.m1.1.2.3.2">𝑀</ci><set id="alg1.3.3.m1.1.2.3.3.1.cmml" xref="alg1.3.3.m1.1.2.3.3.2"><ci id="alg1.3.3.m1.1.1.cmml" xref="alg1.3.3.m1.1.1">𝑅</ci></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.3.3.m1.1c">\mathcal{F}:M\mapsto\{R\}</annotation><annotation encoding="application/x-llamapun" id="alg1.3.3.m1.1d">caligraphic_F : italic_M ↦ { italic_R }</annotation></semantics></math>, a function that returns available reactions for molecule <math alttext="M" class="ltx_Math" display="inline" id="alg1.4.4.m2.1"><semantics id="alg1.4.4.m2.1a"><mi id="alg1.4.4.m2.1.1" xref="alg1.4.4.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="alg1.4.4.m2.1b"><ci id="alg1.4.4.m2.1.1.cmml" xref="alg1.4.4.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.4.4.m2.1c">M</annotation><annotation encoding="application/x-llamapun" id="alg1.4.4.m2.1d">italic_M</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.5.5">
<span class="ltx_text" id="alg1.5.5.1"><span class="ltx_text ltx_font_bold" id="alg1.5.5.1.1">Input:</span> </span><math alttext="\mathcal{H}:R\mapsto\{M\}" class="ltx_Math" display="inline" id="alg1.5.5.m1.1"><semantics id="alg1.5.5.m1.1a"><mrow id="alg1.5.5.m1.1.2" xref="alg1.5.5.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.5.5.m1.1.2.2" xref="alg1.5.5.m1.1.2.2.cmml">ℋ</mi><mo id="alg1.5.5.m1.1.2.1" lspace="0.278em" rspace="0.278em" xref="alg1.5.5.m1.1.2.1.cmml">:</mo><mrow id="alg1.5.5.m1.1.2.3" xref="alg1.5.5.m1.1.2.3.cmml"><mi id="alg1.5.5.m1.1.2.3.2" xref="alg1.5.5.m1.1.2.3.2.cmml">R</mi><mo id="alg1.5.5.m1.1.2.3.1" stretchy="false" xref="alg1.5.5.m1.1.2.3.1.cmml">↦</mo><mrow id="alg1.5.5.m1.1.2.3.3.2" xref="alg1.5.5.m1.1.2.3.3.1.cmml"><mo id="alg1.5.5.m1.1.2.3.3.2.1" stretchy="false" xref="alg1.5.5.m1.1.2.3.3.1.cmml">{</mo><mi id="alg1.5.5.m1.1.1" xref="alg1.5.5.m1.1.1.cmml">M</mi><mo id="alg1.5.5.m1.1.2.3.3.2.2" stretchy="false" xref="alg1.5.5.m1.1.2.3.3.1.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.5.5.m1.1b"><apply id="alg1.5.5.m1.1.2.cmml" xref="alg1.5.5.m1.1.2"><ci id="alg1.5.5.m1.1.2.1.cmml" xref="alg1.5.5.m1.1.2.1">:</ci><ci id="alg1.5.5.m1.1.2.2.cmml" xref="alg1.5.5.m1.1.2.2">ℋ</ci><apply id="alg1.5.5.m1.1.2.3.cmml" xref="alg1.5.5.m1.1.2.3"><csymbol cd="latexml" id="alg1.5.5.m1.1.2.3.1.cmml" xref="alg1.5.5.m1.1.2.3.1">maps-to</csymbol><ci id="alg1.5.5.m1.1.2.3.2.cmml" xref="alg1.5.5.m1.1.2.3.2">𝑅</ci><set id="alg1.5.5.m1.1.2.3.3.1.cmml" xref="alg1.5.5.m1.1.2.3.3.2"><ci id="alg1.5.5.m1.1.1.cmml" xref="alg1.5.5.m1.1.1">𝑀</ci></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.5.5.m1.1c">\mathcal{H}:R\mapsto\{M\}</annotation><annotation encoding="application/x-llamapun" id="alg1.5.5.m1.1d">caligraphic_H : italic_R ↦ { italic_M }</annotation></semantics></math>, a hash map that stores eligible molecules for each reaction
</div>
<div class="ltx_listingline" id="alg1.6.6">
<span class="ltx_text" id="alg1.6.6.1"><span class="ltx_text ltx_font_bold" id="alg1.6.6.1.1">Output:</span> </span>an iterator of postfix notation and product molecule tuples <math alttext="(P,S.\operatorname{top}())" class="ltx_Math" display="inline" id="alg1.6.6.m1.3"><semantics id="alg1.6.6.m1.3a"><mrow id="alg1.6.6.m1.3.3.1"><mo id="alg1.6.6.m1.3.3.1.2" stretchy="false">(</mo><mrow id="alg1.6.6.m1.3.3.1.1.2" xref="alg1.6.6.m1.3.3.1.1.3.cmml"><mrow id="alg1.6.6.m1.3.3.1.1.1.1.2" xref="alg1.6.6.m1.3.3.1.1.1.1.1.cmml"><mi id="alg1.6.6.m1.1.1" xref="alg1.6.6.m1.1.1.cmml">P</mi><mo id="alg1.6.6.m1.3.3.1.1.1.1.2.1" xref="alg1.6.6.m1.3.3.1.1.1.1.1.cmml">,</mo><mi id="alg1.6.6.m1.2.2" xref="alg1.6.6.m1.2.2.cmml">S</mi></mrow><mo id="alg1.6.6.m1.3.3.1.1.2.3" lspace="0em" rspace="0.167em" xref="alg1.6.6.m1.3.3.1.1.3a.cmml">.</mo><mrow id="alg1.6.6.m1.3.3.1.1.2.2" xref="alg1.6.6.m1.3.3.1.1.2.2.cmml"><mi id="alg1.6.6.m1.3.3.1.1.2.2.2" xref="alg1.6.6.m1.3.3.1.1.2.2.2.cmml">top</mi><mo id="alg1.6.6.m1.3.3.1.1.2.2.1" xref="alg1.6.6.m1.3.3.1.1.2.2.1.cmml">⁢</mo><mrow id="alg1.6.6.m1.3.3.1.1.2.2.3.2" xref="alg1.6.6.m1.3.3.1.1.2.2.cmml"><mo id="alg1.6.6.m1.3.3.1.1.2.2.3.2.1" stretchy="false" xref="alg1.6.6.m1.3.3.1.1.2.2.3.1.cmml">(</mo><mo id="alg1.6.6.m1.3.3.1.1.2.2.3.2.2" stretchy="false" xref="alg1.6.6.m1.3.3.1.1.2.2.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="alg1.6.6.m1.3.3.1.3" stretchy="false">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.6.6.m1.3b"><apply id="alg1.6.6.m1.3.3.1.1.3.cmml" xref="alg1.6.6.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="alg1.6.6.m1.3.3.1.1.3a.cmml" xref="alg1.6.6.m1.3.3.1.1.2.3">formulae-sequence</csymbol><list id="alg1.6.6.m1.3.3.1.1.1.1.1.cmml" xref="alg1.6.6.m1.3.3.1.1.1.1.2"><ci id="alg1.6.6.m1.1.1.cmml" xref="alg1.6.6.m1.1.1">𝑃</ci><ci id="alg1.6.6.m1.2.2.cmml" xref="alg1.6.6.m1.2.2">𝑆</ci></list><apply id="alg1.6.6.m1.3.3.1.1.2.2.cmml" xref="alg1.6.6.m1.3.3.1.1.2.2"><times id="alg1.6.6.m1.3.3.1.1.2.2.1.cmml" xref="alg1.6.6.m1.3.3.1.1.2.2.1"></times><ci id="alg1.6.6.m1.3.3.1.1.2.2.2.cmml" xref="alg1.6.6.m1.3.3.1.1.2.2.2">top</ci><list id="alg1.6.6.m1.3.3.1.1.2.2.3.1.cmml" xref="alg1.6.6.m1.3.3.1.1.2.2.3.2.1"></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.6.6.m1.3c">(P,S.\operatorname{top}())</annotation><annotation encoding="application/x-llamapun" id="alg1.6.6.m1.3d">( italic_P , italic_S . roman_top ( ) )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.40.41">
<span class="ltx_tag ltx_tag_listingline">1</span>
</div>
<div class="ltx_listingline" id="alg1.40.42">
<span class="ltx_tag ltx_tag_listingline">2</span>
</div>
<div class="ltx_listingline" id="alg1.7.7">
<math alttext="S\leftarrow[]" class="ltx_Math" display="inline" id="alg1.7.7.m1.1"><semantics id="alg1.7.7.m1.1a"><mrow id="alg1.7.7.m1.1.1" xref="alg1.7.7.m1.1.1.cmml"><mi id="alg1.7.7.m1.1.1.2" xref="alg1.7.7.m1.1.1.2.cmml">S</mi><mo id="alg1.7.7.m1.1.1.1" stretchy="false" xref="alg1.7.7.m1.1.1.1.cmml">←</mo><mrow id="alg1.7.7.m1.1.1.3.2" xref="alg1.7.7.m1.1.1.cmml"><mo id="alg1.7.7.m1.1.1.3.2.1" stretchy="false" xref="alg1.7.7.m1.1.1.3.1.cmml">[</mo><mo id="alg1.7.7.m1.1.1.3.2.2" stretchy="false" xref="alg1.7.7.m1.1.1.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.7.7.m1.1b"><apply id="alg1.7.7.m1.1.1.cmml" xref="alg1.7.7.m1.1.1"><ci id="alg1.7.7.m1.1.1.1.cmml" xref="alg1.7.7.m1.1.1.1">←</ci><ci id="alg1.7.7.m1.1.1.2.cmml" xref="alg1.7.7.m1.1.1.2">𝑆</ci><list id="alg1.7.7.m1.1.1.3.1.cmml" xref="alg1.7.7.m1.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.7.7.m1.1c">S\leftarrow[]</annotation><annotation encoding="application/x-llamapun" id="alg1.7.7.m1.1d">italic_S ← [ ]</annotation></semantics></math> ;
</div>
<div class="ltx_listingline" id="alg1.40.43">  <span class="ltx_text ltx_font_typewriter" id="alg1.40.43.1">// </span><span class="ltx_text ltx_font_typewriter" id="alg1.40.43.2">Initialize empty stack</span>
</div>
<div class="ltx_listingline" id="alg1.8.8">
<math alttext="P\leftarrow[]" class="ltx_Math" display="inline" id="alg1.8.8.m1.1"><semantics id="alg1.8.8.m1.1a"><mrow id="alg1.8.8.m1.1.1" xref="alg1.8.8.m1.1.1.cmml"><mi id="alg1.8.8.m1.1.1.2" xref="alg1.8.8.m1.1.1.2.cmml">P</mi><mo id="alg1.8.8.m1.1.1.1" stretchy="false" xref="alg1.8.8.m1.1.1.1.cmml">←</mo><mrow id="alg1.8.8.m1.1.1.3.2" xref="alg1.8.8.m1.1.1.cmml"><mo id="alg1.8.8.m1.1.1.3.2.1" stretchy="false" xref="alg1.8.8.m1.1.1.3.1.cmml">[</mo><mo id="alg1.8.8.m1.1.1.3.2.2" stretchy="false" xref="alg1.8.8.m1.1.1.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.8.8.m1.1b"><apply id="alg1.8.8.m1.1.1.cmml" xref="alg1.8.8.m1.1.1"><ci id="alg1.8.8.m1.1.1.1.cmml" xref="alg1.8.8.m1.1.1.1">←</ci><ci id="alg1.8.8.m1.1.1.2.cmml" xref="alg1.8.8.m1.1.1.2">𝑃</ci><list id="alg1.8.8.m1.1.1.3.1.cmml" xref="alg1.8.8.m1.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.8.8.m1.1c">P\leftarrow[]</annotation><annotation encoding="application/x-llamapun" id="alg1.8.8.m1.1d">italic_P ← [ ]</annotation></semantics></math> ;
</div>
<div class="ltx_listingline" id="alg1.40.44">  <span class="ltx_text ltx_font_typewriter" id="alg1.40.44.1">// </span><span class="ltx_text ltx_font_typewriter" id="alg1.40.44.2">Initialize empty postfix notation</span>
</div>
<div class="ltx_listingline" id="alg1.40.45">
<span class="ltx_tag ltx_tag_listingline">3</span>
</div>
<div class="ltx_listingline" id="alg1.9.9">
<span class="ltx_tag ltx_tag_listingline">4</span><math alttext="B_{0}\leftarrow" class="ltx_Math" display="inline" id="alg1.9.9.m1.1"><semantics id="alg1.9.9.m1.1a"><mrow id="alg1.9.9.m1.1.1" xref="alg1.9.9.m1.1.1.cmml"><msub id="alg1.9.9.m1.1.1.2" xref="alg1.9.9.m1.1.1.2.cmml"><mi id="alg1.9.9.m1.1.1.2.2" xref="alg1.9.9.m1.1.1.2.2.cmml">B</mi><mn id="alg1.9.9.m1.1.1.2.3" xref="alg1.9.9.m1.1.1.2.3.cmml">0</mn></msub><mo id="alg1.9.9.m1.1.1.1" stretchy="false" xref="alg1.9.9.m1.1.1.1.cmml">←</mo><mi id="alg1.9.9.m1.1.1.3" xref="alg1.9.9.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.9.9.m1.1b"><apply id="alg1.9.9.m1.1.1.cmml" xref="alg1.9.9.m1.1.1"><ci id="alg1.9.9.m1.1.1.1.cmml" xref="alg1.9.9.m1.1.1.1">←</ci><apply id="alg1.9.9.m1.1.1.2.cmml" xref="alg1.9.9.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.9.9.m1.1.1.2.1.cmml" xref="alg1.9.9.m1.1.1.2">subscript</csymbol><ci id="alg1.9.9.m1.1.1.2.2.cmml" xref="alg1.9.9.m1.1.1.2.2">𝐵</ci><cn id="alg1.9.9.m1.1.1.2.3.cmml" type="integer" xref="alg1.9.9.m1.1.1.2.3">0</cn></apply><csymbol cd="latexml" id="alg1.9.9.m1.1.1.3.cmml" xref="alg1.9.9.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.9.9.m1.1c">B_{0}\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg1.9.9.m1.1d">italic_B start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ←</annotation></semantics></math> a random building block;
</div>
<div class="ltx_listingline" id="alg1.11.11">
<span class="ltx_tag ltx_tag_listingline">5</span>
<span class="ltx_text ltx_font_typewriter" id="alg1.11.11.2">Push(<em class="ltx_emph ltx_font_serif ltx_font_italic" id="alg1.11.11.2.2"><math alttext="B_{0}" class="ltx_Math" display="inline" id="alg1.10.10.1.1.m1.1"><semantics id="alg1.10.10.1.1.m1.1a"><msub id="alg1.10.10.1.1.m1.1.1" xref="alg1.10.10.1.1.m1.1.1.cmml"><mi id="alg1.10.10.1.1.m1.1.1.2" xref="alg1.10.10.1.1.m1.1.1.2.cmml">B</mi><mn id="alg1.10.10.1.1.m1.1.1.3" xref="alg1.10.10.1.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="alg1.10.10.1.1.m1.1b"><apply id="alg1.10.10.1.1.m1.1.1.cmml" xref="alg1.10.10.1.1.m1.1.1"><csymbol cd="ambiguous" id="alg1.10.10.1.1.m1.1.1.1.cmml" xref="alg1.10.10.1.1.m1.1.1">subscript</csymbol><ci id="alg1.10.10.1.1.m1.1.1.2.cmml" xref="alg1.10.10.1.1.m1.1.1.2">𝐵</ci><cn id="alg1.10.10.1.1.m1.1.1.3.cmml" type="integer" xref="alg1.10.10.1.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.10.10.1.1.m1.1c">B_{0}</annotation><annotation encoding="application/x-llamapun" id="alg1.10.10.1.1.m1.1d">italic_B start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> onto <math alttext="S" class="ltx_Math" display="inline" id="alg1.11.11.2.2.m2.1"><semantics id="alg1.11.11.2.2.m2.1a"><mi id="alg1.11.11.2.2.m2.1.1" xref="alg1.11.11.2.2.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="alg1.11.11.2.2.m2.1b"><ci id="alg1.11.11.2.2.m2.1.1.cmml" xref="alg1.11.11.2.2.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.11.11.2.2.m2.1c">S</annotation><annotation encoding="application/x-llamapun" id="alg1.11.11.2.2.m2.1d">italic_S</annotation></semantics></math></em>)</span>;
</div>
<div class="ltx_listingline" id="alg1.13.13">
<span class="ltx_tag ltx_tag_listingline">6</span>
<span class="ltx_text ltx_font_typewriter" id="alg1.13.13.2">Append(<em class="ltx_emph ltx_font_serif ltx_font_italic" id="alg1.13.13.2.2"><math alttext="B_{0}" class="ltx_Math" display="inline" id="alg1.12.12.1.1.m1.1"><semantics id="alg1.12.12.1.1.m1.1a"><msub id="alg1.12.12.1.1.m1.1.1" xref="alg1.12.12.1.1.m1.1.1.cmml"><mi id="alg1.12.12.1.1.m1.1.1.2" xref="alg1.12.12.1.1.m1.1.1.2.cmml">B</mi><mn id="alg1.12.12.1.1.m1.1.1.3" xref="alg1.12.12.1.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="alg1.12.12.1.1.m1.1b"><apply id="alg1.12.12.1.1.m1.1.1.cmml" xref="alg1.12.12.1.1.m1.1.1"><csymbol cd="ambiguous" id="alg1.12.12.1.1.m1.1.1.1.cmml" xref="alg1.12.12.1.1.m1.1.1">subscript</csymbol><ci id="alg1.12.12.1.1.m1.1.1.2.cmml" xref="alg1.12.12.1.1.m1.1.1.2">𝐵</ci><cn id="alg1.12.12.1.1.m1.1.1.3.cmml" type="integer" xref="alg1.12.12.1.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.12.12.1.1.m1.1c">B_{0}</annotation><annotation encoding="application/x-llamapun" id="alg1.12.12.1.1.m1.1d">italic_B start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> to <math alttext="P" class="ltx_Math" display="inline" id="alg1.13.13.2.2.m2.1"><semantics id="alg1.13.13.2.2.m2.1a"><mi id="alg1.13.13.2.2.m2.1.1" xref="alg1.13.13.2.2.m2.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="alg1.13.13.2.2.m2.1b"><ci id="alg1.13.13.2.2.m2.1.1.cmml" xref="alg1.13.13.2.2.m2.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.13.13.2.2.m2.1c">P</annotation><annotation encoding="application/x-llamapun" id="alg1.13.13.2.2.m2.1d">italic_P</annotation></semantics></math></em>)</span>;
</div>
<div class="ltx_listingline" id="alg1.15.15">
<span class="ltx_tag ltx_tag_listingline">7</span>
<span class="ltx_text ltx_font_typewriter" id="alg1.15.15.2">Yield(<em class="ltx_emph ltx_font_serif ltx_font_italic" id="alg1.15.15.2.2"><math alttext="P" class="ltx_Math" display="inline" id="alg1.14.14.1.1.m1.1"><semantics id="alg1.14.14.1.1.m1.1a"><mi id="alg1.14.14.1.1.m1.1.1" xref="alg1.14.14.1.1.m1.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="alg1.14.14.1.1.m1.1b"><ci id="alg1.14.14.1.1.m1.1.1.cmml" xref="alg1.14.14.1.1.m1.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.14.14.1.1.m1.1c">P</annotation><annotation encoding="application/x-llamapun" id="alg1.14.14.1.1.m1.1d">italic_P</annotation></semantics></math>, <math alttext="S.\operatorname{top}()" class="ltx_Math" display="inline" id="alg1.15.15.2.2.m2.2"><semantics id="alg1.15.15.2.2.m2.2a"><mrow id="alg1.15.15.2.2.m2.2.2.1" xref="alg1.15.15.2.2.m2.2.2.2.cmml"><mi id="alg1.15.15.2.2.m2.1.1" xref="alg1.15.15.2.2.m2.1.1.cmml">S</mi><mo id="alg1.15.15.2.2.m2.2.2.1.2" lspace="0em" rspace="0.167em" xref="alg1.15.15.2.2.m2.2.2.2a.cmml">.</mo><mrow id="alg1.15.15.2.2.m2.2.2.1.1" xref="alg1.15.15.2.2.m2.2.2.1.1.cmml"><mi id="alg1.15.15.2.2.m2.2.2.1.1.2" xref="alg1.15.15.2.2.m2.2.2.1.1.2.cmml">top</mi><mo id="alg1.15.15.2.2.m2.2.2.1.1.1" xref="alg1.15.15.2.2.m2.2.2.1.1.1.cmml">⁢</mo><mrow id="alg1.15.15.2.2.m2.2.2.1.1.3.2" xref="alg1.15.15.2.2.m2.2.2.1.1.cmml"><mo id="alg1.15.15.2.2.m2.2.2.1.1.3.2.1" stretchy="false" xref="alg1.15.15.2.2.m2.2.2.1.1.3.1.cmml">(</mo><mo id="alg1.15.15.2.2.m2.2.2.1.1.3.2.2" stretchy="false" xref="alg1.15.15.2.2.m2.2.2.1.1.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.15.15.2.2.m2.2b"><apply id="alg1.15.15.2.2.m2.2.2.2.cmml" xref="alg1.15.15.2.2.m2.2.2.1"><csymbol cd="ambiguous" id="alg1.15.15.2.2.m2.2.2.2a.cmml" xref="alg1.15.15.2.2.m2.2.2.1.2">formulae-sequence</csymbol><ci id="alg1.15.15.2.2.m2.1.1.cmml" xref="alg1.15.15.2.2.m2.1.1">𝑆</ci><apply id="alg1.15.15.2.2.m2.2.2.1.1.cmml" xref="alg1.15.15.2.2.m2.2.2.1.1"><times id="alg1.15.15.2.2.m2.2.2.1.1.1.cmml" xref="alg1.15.15.2.2.m2.2.2.1.1.1"></times><ci id="alg1.15.15.2.2.m2.2.2.1.1.2.cmml" xref="alg1.15.15.2.2.m2.2.2.1.1.2">top</ci><list id="alg1.15.15.2.2.m2.2.2.1.1.3.1.cmml" xref="alg1.15.15.2.2.m2.2.2.1.1.3.2.1"></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.15.15.2.2.m2.2c">S.\operatorname{top}()</annotation><annotation encoding="application/x-llamapun" id="alg1.15.15.2.2.m2.2d">italic_S . roman_top ( )</annotation></semantics></math></em>)</span>;
</div>
<div class="ltx_listingline" id="alg1.40.46">
<span class="ltx_tag ltx_tag_listingline">8</span>
</div>
<div class="ltx_listingline" id="alg1.17.17">
<span class="ltx_tag ltx_tag_listingline">9</span><span class="ltx_text ltx_font_bold" id="alg1.17.17.3">while</span> <em class="ltx_emph ltx_font_italic" id="alg1.17.17.2"><math alttext="P.\operatorname{countReactions}()&lt;m_{r}" class="ltx_Math" display="inline" id="alg1.16.16.1.m1.2"><semantics id="alg1.16.16.1.m1.2a"><mrow id="alg1.16.16.1.m1.2.2.1" xref="alg1.16.16.1.m1.2.2.2.cmml"><mi id="alg1.16.16.1.m1.1.1" xref="alg1.16.16.1.m1.1.1.cmml">P</mi><mo id="alg1.16.16.1.m1.2.2.1.2" lspace="0em" rspace="0.167em" xref="alg1.16.16.1.m1.2.2.2a.cmml">.</mo><mrow id="alg1.16.16.1.m1.2.2.1.1" xref="alg1.16.16.1.m1.2.2.1.1.cmml"><mrow id="alg1.16.16.1.m1.2.2.1.1.2" xref="alg1.16.16.1.m1.2.2.1.1.2.cmml"><mi id="alg1.16.16.1.m1.2.2.1.1.2.2" xref="alg1.16.16.1.m1.2.2.1.1.2.2.cmml">countReactions</mi><mo id="alg1.16.16.1.m1.2.2.1.1.2.1" xref="alg1.16.16.1.m1.2.2.1.1.2.1.cmml">⁢</mo><mrow id="alg1.16.16.1.m1.2.2.1.1.2.3.2" xref="alg1.16.16.1.m1.2.2.1.1.2.cmml"><mo id="alg1.16.16.1.m1.2.2.1.1.2.3.2.1" stretchy="false" xref="alg1.16.16.1.m1.2.2.1.1.2.3.1.cmml">(</mo><mo id="alg1.16.16.1.m1.2.2.1.1.2.3.2.2" stretchy="false" xref="alg1.16.16.1.m1.2.2.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="alg1.16.16.1.m1.2.2.1.1.1" xref="alg1.16.16.1.m1.2.2.1.1.1.cmml">&lt;</mo><msub id="alg1.16.16.1.m1.2.2.1.1.3" xref="alg1.16.16.1.m1.2.2.1.1.3.cmml"><mi id="alg1.16.16.1.m1.2.2.1.1.3.2" xref="alg1.16.16.1.m1.2.2.1.1.3.2.cmml">m</mi><mi id="alg1.16.16.1.m1.2.2.1.1.3.3" xref="alg1.16.16.1.m1.2.2.1.1.3.3.cmml">r</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.16.16.1.m1.2b"><apply id="alg1.16.16.1.m1.2.2.2.cmml" xref="alg1.16.16.1.m1.2.2.1"><csymbol cd="ambiguous" id="alg1.16.16.1.m1.2.2.2a.cmml" xref="alg1.16.16.1.m1.2.2.1.2">formulae-sequence</csymbol><ci id="alg1.16.16.1.m1.1.1.cmml" xref="alg1.16.16.1.m1.1.1">𝑃</ci><apply id="alg1.16.16.1.m1.2.2.1.1.cmml" xref="alg1.16.16.1.m1.2.2.1.1"><lt id="alg1.16.16.1.m1.2.2.1.1.1.cmml" xref="alg1.16.16.1.m1.2.2.1.1.1"></lt><apply id="alg1.16.16.1.m1.2.2.1.1.2.cmml" xref="alg1.16.16.1.m1.2.2.1.1.2"><times id="alg1.16.16.1.m1.2.2.1.1.2.1.cmml" xref="alg1.16.16.1.m1.2.2.1.1.2.1"></times><ci id="alg1.16.16.1.m1.2.2.1.1.2.2.cmml" xref="alg1.16.16.1.m1.2.2.1.1.2.2">countReactions</ci><list id="alg1.16.16.1.m1.2.2.1.1.2.3.1.cmml" xref="alg1.16.16.1.m1.2.2.1.1.2.3.2.1"></list></apply><apply id="alg1.16.16.1.m1.2.2.1.1.3.cmml" xref="alg1.16.16.1.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="alg1.16.16.1.m1.2.2.1.1.3.1.cmml" xref="alg1.16.16.1.m1.2.2.1.1.3">subscript</csymbol><ci id="alg1.16.16.1.m1.2.2.1.1.3.2.cmml" xref="alg1.16.16.1.m1.2.2.1.1.3.2">𝑚</ci><ci id="alg1.16.16.1.m1.2.2.1.1.3.3.cmml" xref="alg1.16.16.1.m1.2.2.1.1.3.3">𝑟</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.16.16.1.m1.2c">P.\operatorname{countReactions}()&lt;m_{r}</annotation><annotation encoding="application/x-llamapun" id="alg1.16.16.1.m1.2d">italic_P . roman_countReactions ( ) &lt; italic_m start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.17.17.2.1">and</span> <math alttext="S.\operatorname{top}().\operatorname{countAtoms}()&lt;m_{a}" class="ltx_Math" display="inline" id="alg1.17.17.2.m2.3"><semantics id="alg1.17.17.2.m2.3a"><mrow id="alg1.17.17.2.m2.3.3.2" xref="alg1.17.17.2.m2.3.3.3.cmml"><mi id="alg1.17.17.2.m2.1.1" xref="alg1.17.17.2.m2.1.1.cmml">S</mi><mo id="alg1.17.17.2.m2.3.3.2.3" lspace="0em" rspace="0.167em" xref="alg1.17.17.2.m2.3.3.3a.cmml">.</mo><mrow id="alg1.17.17.2.m2.2.2.1.1" xref="alg1.17.17.2.m2.2.2.1.1.cmml"><mi id="alg1.17.17.2.m2.2.2.1.1.2" xref="alg1.17.17.2.m2.2.2.1.1.2.cmml">top</mi><mo id="alg1.17.17.2.m2.2.2.1.1.1" xref="alg1.17.17.2.m2.2.2.1.1.1.cmml">⁢</mo><mrow id="alg1.17.17.2.m2.2.2.1.1.3.2" xref="alg1.17.17.2.m2.2.2.1.1.cmml"><mo id="alg1.17.17.2.m2.2.2.1.1.3.2.1" stretchy="false" xref="alg1.17.17.2.m2.2.2.1.1.3.1.cmml">(</mo><mo id="alg1.17.17.2.m2.2.2.1.1.3.2.2" stretchy="false" xref="alg1.17.17.2.m2.2.2.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="alg1.17.17.2.m2.3.3.2.4" lspace="0em" rspace="0.167em" xref="alg1.17.17.2.m2.3.3.3a.cmml">.</mo><mrow id="alg1.17.17.2.m2.3.3.2.2" xref="alg1.17.17.2.m2.3.3.2.2.cmml"><mrow id="alg1.17.17.2.m2.3.3.2.2.2" xref="alg1.17.17.2.m2.3.3.2.2.2.cmml"><mi id="alg1.17.17.2.m2.3.3.2.2.2.2" xref="alg1.17.17.2.m2.3.3.2.2.2.2.cmml">countAtoms</mi><mo id="alg1.17.17.2.m2.3.3.2.2.2.1" xref="alg1.17.17.2.m2.3.3.2.2.2.1.cmml">⁢</mo><mrow id="alg1.17.17.2.m2.3.3.2.2.2.3.2" xref="alg1.17.17.2.m2.3.3.2.2.2.cmml"><mo id="alg1.17.17.2.m2.3.3.2.2.2.3.2.1" stretchy="false" xref="alg1.17.17.2.m2.3.3.2.2.2.3.1.cmml">(</mo><mo id="alg1.17.17.2.m2.3.3.2.2.2.3.2.2" stretchy="false" xref="alg1.17.17.2.m2.3.3.2.2.2.3.1.cmml">)</mo></mrow></mrow><mo id="alg1.17.17.2.m2.3.3.2.2.1" xref="alg1.17.17.2.m2.3.3.2.2.1.cmml">&lt;</mo><msub id="alg1.17.17.2.m2.3.3.2.2.3" xref="alg1.17.17.2.m2.3.3.2.2.3.cmml"><mi id="alg1.17.17.2.m2.3.3.2.2.3.2" xref="alg1.17.17.2.m2.3.3.2.2.3.2.cmml">m</mi><mi id="alg1.17.17.2.m2.3.3.2.2.3.3" xref="alg1.17.17.2.m2.3.3.2.2.3.3.cmml">a</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.17.17.2.m2.3b"><apply id="alg1.17.17.2.m2.3.3.3.cmml" xref="alg1.17.17.2.m2.3.3.2"><csymbol cd="ambiguous" id="alg1.17.17.2.m2.3.3.3a.cmml" xref="alg1.17.17.2.m2.3.3.2.3">formulae-sequence</csymbol><ci id="alg1.17.17.2.m2.1.1.cmml" xref="alg1.17.17.2.m2.1.1">𝑆</ci><apply id="alg1.17.17.2.m2.2.2.1.1.cmml" xref="alg1.17.17.2.m2.2.2.1.1"><times id="alg1.17.17.2.m2.2.2.1.1.1.cmml" xref="alg1.17.17.2.m2.2.2.1.1.1"></times><ci id="alg1.17.17.2.m2.2.2.1.1.2.cmml" xref="alg1.17.17.2.m2.2.2.1.1.2">top</ci><list id="alg1.17.17.2.m2.2.2.1.1.3.1.cmml" xref="alg1.17.17.2.m2.2.2.1.1.3.2.1"></list></apply><apply id="alg1.17.17.2.m2.3.3.2.2.cmml" xref="alg1.17.17.2.m2.3.3.2.2"><lt id="alg1.17.17.2.m2.3.3.2.2.1.cmml" xref="alg1.17.17.2.m2.3.3.2.2.1"></lt><apply id="alg1.17.17.2.m2.3.3.2.2.2.cmml" xref="alg1.17.17.2.m2.3.3.2.2.2"><times id="alg1.17.17.2.m2.3.3.2.2.2.1.cmml" xref="alg1.17.17.2.m2.3.3.2.2.2.1"></times><ci id="alg1.17.17.2.m2.3.3.2.2.2.2.cmml" xref="alg1.17.17.2.m2.3.3.2.2.2.2">countAtoms</ci><list id="alg1.17.17.2.m2.3.3.2.2.2.3.1.cmml" xref="alg1.17.17.2.m2.3.3.2.2.2.3.2.1"></list></apply><apply id="alg1.17.17.2.m2.3.3.2.2.3.cmml" xref="alg1.17.17.2.m2.3.3.2.2.3"><csymbol cd="ambiguous" id="alg1.17.17.2.m2.3.3.2.2.3.1.cmml" xref="alg1.17.17.2.m2.3.3.2.2.3">subscript</csymbol><ci id="alg1.17.17.2.m2.3.3.2.2.3.2.cmml" xref="alg1.17.17.2.m2.3.3.2.2.3.2">𝑚</ci><ci id="alg1.17.17.2.m2.3.3.2.2.3.3.cmml" xref="alg1.17.17.2.m2.3.3.2.2.3.3">𝑎</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.17.17.2.m2.3c">S.\operatorname{top}().\operatorname{countAtoms}()&lt;m_{a}</annotation><annotation encoding="application/x-llamapun" id="alg1.17.17.2.m2.3d">italic_S . roman_top ( ) . roman_countAtoms ( ) &lt; italic_m start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="alg1.17.17.4">do</span>
</div>
<div class="ltx_listingline" id="alg1.40.47">
<span class="ltx_tag ltx_tag_listingline">10</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div class="ltx_listingline" id="alg1.18.18">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math alttext="R\sim\mathcal{R}(S.\operatorname{top}())" class="ltx_math_unparsed" display="inline" id="alg1.18.18.m1.1"><semantics id="alg1.18.18.m1.1a"><mrow id="alg1.18.18.m1.1b"><mi id="alg1.18.18.m1.1.1">R</mi><mo id="alg1.18.18.m1.1.2">∼</mo><mi class="ltx_font_mathcaligraphic" id="alg1.18.18.m1.1.3">ℛ</mi><mrow id="alg1.18.18.m1.1.4"><mo id="alg1.18.18.m1.1.4.1" stretchy="false">(</mo><mi id="alg1.18.18.m1.1.4.2">S</mi><mo id="alg1.18.18.m1.1.4.3" lspace="0em" rspace="0.167em">.</mo><mi id="alg1.18.18.m1.1.4.4">top</mi><mrow id="alg1.18.18.m1.1.4.5"><mo id="alg1.18.18.m1.1.4.5.1" stretchy="false">(</mo><mo id="alg1.18.18.m1.1.4.5.2" stretchy="false">)</mo></mrow><mo id="alg1.18.18.m1.1.4.6" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="alg1.18.18.m1.1c">R\sim\mathcal{R}(S.\operatorname{top}())</annotation><annotation encoding="application/x-llamapun" id="alg1.18.18.m1.1d">italic_R ∼ caligraphic_R ( italic_S . roman_top ( ) )</annotation></semantics></math> ;
</div>
<div class="ltx_listingline" id="alg1.40.48">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_text ltx_font_typewriter" id="alg1.40.48.1">// </span><span class="ltx_text ltx_font_typewriter" id="alg1.40.48.2">Randomly choose a reaction according to the molecule on the stack top</span>
</div>
<div class="ltx_listingline" id="alg1.40.49">
<span class="ltx_tag ltx_tag_listingline">11</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div class="ltx_listingline" id="alg1.20.20">
<span class="ltx_tag ltx_tag_listingline">12</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span class="ltx_text ltx_font_bold" id="alg1.20.20.3">for</span> <em class="ltx_emph ltx_font_italic" id="alg1.20.20.2"><math alttext="i=1" class="ltx_Math" display="inline" id="alg1.19.19.1.m1.1"><semantics id="alg1.19.19.1.m1.1a"><mrow id="alg1.19.19.1.m1.1.1" xref="alg1.19.19.1.m1.1.1.cmml"><mi id="alg1.19.19.1.m1.1.1.2" xref="alg1.19.19.1.m1.1.1.2.cmml">i</mi><mo id="alg1.19.19.1.m1.1.1.1" xref="alg1.19.19.1.m1.1.1.1.cmml">=</mo><mn id="alg1.19.19.1.m1.1.1.3" xref="alg1.19.19.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.19.19.1.m1.1b"><apply id="alg1.19.19.1.m1.1.1.cmml" xref="alg1.19.19.1.m1.1.1"><eq id="alg1.19.19.1.m1.1.1.1.cmml" xref="alg1.19.19.1.m1.1.1.1"></eq><ci id="alg1.19.19.1.m1.1.1.2.cmml" xref="alg1.19.19.1.m1.1.1.2">𝑖</ci><cn id="alg1.19.19.1.m1.1.1.3.cmml" type="integer" xref="alg1.19.19.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.19.19.1.m1.1c">i=1</annotation><annotation encoding="application/x-llamapun" id="alg1.19.19.1.m1.1d">italic_i = 1</annotation></semantics></math> <span class="ltx_text ltx_font_bold ltx_font_upright" id="alg1.20.20.2.1">to</span> <math alttext="R.\operatorname{numReactants}-S.\operatorname{length}()" class="ltx_Math" display="inline" id="alg1.20.20.2.m2.3"><semantics id="alg1.20.20.2.m2.3a"><mrow id="alg1.20.20.2.m2.3.3.2" xref="alg1.20.20.2.m2.3.3.3.cmml"><mi id="alg1.20.20.2.m2.1.1" xref="alg1.20.20.2.m2.1.1.cmml">R</mi><mo id="alg1.20.20.2.m2.3.3.2.3" lspace="0em" rspace="0.167em" xref="alg1.20.20.2.m2.3.3.3a.cmml">.</mo><mrow id="alg1.20.20.2.m2.2.2.1.1" xref="alg1.20.20.2.m2.2.2.1.1.cmml"><mi id="alg1.20.20.2.m2.2.2.1.1.2" xref="alg1.20.20.2.m2.2.2.1.1.2.cmml">numReactants</mi><mo id="alg1.20.20.2.m2.2.2.1.1.1" lspace="0em" xref="alg1.20.20.2.m2.2.2.1.1.1.cmml">−</mo><mi id="alg1.20.20.2.m2.2.2.1.1.3" xref="alg1.20.20.2.m2.2.2.1.1.3.cmml">S</mi></mrow><mo id="alg1.20.20.2.m2.3.3.2.4" lspace="0em" rspace="0.167em" xref="alg1.20.20.2.m2.3.3.3a.cmml">.</mo><mrow id="alg1.20.20.2.m2.3.3.2.2" xref="alg1.20.20.2.m2.3.3.2.2.cmml"><mi id="alg1.20.20.2.m2.3.3.2.2.2" xref="alg1.20.20.2.m2.3.3.2.2.2.cmml">length</mi><mo id="alg1.20.20.2.m2.3.3.2.2.1" xref="alg1.20.20.2.m2.3.3.2.2.1.cmml">⁢</mo><mrow id="alg1.20.20.2.m2.3.3.2.2.3.2" xref="alg1.20.20.2.m2.3.3.2.2.cmml"><mo id="alg1.20.20.2.m2.3.3.2.2.3.2.1" stretchy="false" xref="alg1.20.20.2.m2.3.3.2.2.3.1.cmml">(</mo><mo id="alg1.20.20.2.m2.3.3.2.2.3.2.2" stretchy="false" xref="alg1.20.20.2.m2.3.3.2.2.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.20.20.2.m2.3b"><apply id="alg1.20.20.2.m2.3.3.3.cmml" xref="alg1.20.20.2.m2.3.3.2"><csymbol cd="ambiguous" id="alg1.20.20.2.m2.3.3.3a.cmml" xref="alg1.20.20.2.m2.3.3.2.3">formulae-sequence</csymbol><ci id="alg1.20.20.2.m2.1.1.cmml" xref="alg1.20.20.2.m2.1.1">𝑅</ci><apply id="alg1.20.20.2.m2.2.2.1.1.cmml" xref="alg1.20.20.2.m2.2.2.1.1"><minus id="alg1.20.20.2.m2.2.2.1.1.1.cmml" xref="alg1.20.20.2.m2.2.2.1.1.1"></minus><ci id="alg1.20.20.2.m2.2.2.1.1.2.cmml" xref="alg1.20.20.2.m2.2.2.1.1.2">numReactants</ci><ci id="alg1.20.20.2.m2.2.2.1.1.3.cmml" xref="alg1.20.20.2.m2.2.2.1.1.3">𝑆</ci></apply><apply id="alg1.20.20.2.m2.3.3.2.2.cmml" xref="alg1.20.20.2.m2.3.3.2.2"><times id="alg1.20.20.2.m2.3.3.2.2.1.cmml" xref="alg1.20.20.2.m2.3.3.2.2.1"></times><ci id="alg1.20.20.2.m2.3.3.2.2.2.cmml" xref="alg1.20.20.2.m2.3.3.2.2.2">length</ci><list id="alg1.20.20.2.m2.3.3.2.2.3.1.cmml" xref="alg1.20.20.2.m2.3.3.2.2.3.2.1"></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.20.20.2.m2.3c">R.\operatorname{numReactants}-S.\operatorname{length}()</annotation><annotation encoding="application/x-llamapun" id="alg1.20.20.2.m2.3d">italic_R . roman_numReactants - italic_S . roman_length ( )</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="alg1.20.20.4">do</span>
</div>
<div class="ltx_listingline" id="alg1.24.24">
<span class="ltx_tag ltx_tag_listingline">13</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="B_{i}\sim\mathcal{H}(R)" class="ltx_Math" display="inline" id="alg1.21.21.m1.1"><semantics id="alg1.21.21.m1.1a"><mrow id="alg1.21.21.m1.1.2" xref="alg1.21.21.m1.1.2.cmml"><msub id="alg1.21.21.m1.1.2.2" xref="alg1.21.21.m1.1.2.2.cmml"><mi id="alg1.21.21.m1.1.2.2.2" xref="alg1.21.21.m1.1.2.2.2.cmml">B</mi><mi id="alg1.21.21.m1.1.2.2.3" xref="alg1.21.21.m1.1.2.2.3.cmml">i</mi></msub><mo id="alg1.21.21.m1.1.2.1" xref="alg1.21.21.m1.1.2.1.cmml">∼</mo><mrow id="alg1.21.21.m1.1.2.3" xref="alg1.21.21.m1.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.21.21.m1.1.2.3.2" xref="alg1.21.21.m1.1.2.3.2.cmml">ℋ</mi><mo id="alg1.21.21.m1.1.2.3.1" xref="alg1.21.21.m1.1.2.3.1.cmml">⁢</mo><mrow id="alg1.21.21.m1.1.2.3.3.2" xref="alg1.21.21.m1.1.2.3.cmml"><mo id="alg1.21.21.m1.1.2.3.3.2.1" stretchy="false" xref="alg1.21.21.m1.1.2.3.cmml">(</mo><mi id="alg1.21.21.m1.1.1" xref="alg1.21.21.m1.1.1.cmml">R</mi><mo id="alg1.21.21.m1.1.2.3.3.2.2" stretchy="false" xref="alg1.21.21.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.21.21.m1.1b"><apply id="alg1.21.21.m1.1.2.cmml" xref="alg1.21.21.m1.1.2"><csymbol cd="latexml" id="alg1.21.21.m1.1.2.1.cmml" xref="alg1.21.21.m1.1.2.1">similar-to</csymbol><apply id="alg1.21.21.m1.1.2.2.cmml" xref="alg1.21.21.m1.1.2.2"><csymbol cd="ambiguous" id="alg1.21.21.m1.1.2.2.1.cmml" xref="alg1.21.21.m1.1.2.2">subscript</csymbol><ci id="alg1.21.21.m1.1.2.2.2.cmml" xref="alg1.21.21.m1.1.2.2.2">𝐵</ci><ci id="alg1.21.21.m1.1.2.2.3.cmml" xref="alg1.21.21.m1.1.2.2.3">𝑖</ci></apply><apply id="alg1.21.21.m1.1.2.3.cmml" xref="alg1.21.21.m1.1.2.3"><times id="alg1.21.21.m1.1.2.3.1.cmml" xref="alg1.21.21.m1.1.2.3.1"></times><ci id="alg1.21.21.m1.1.2.3.2.cmml" xref="alg1.21.21.m1.1.2.3.2">ℋ</ci><ci id="alg1.21.21.m1.1.1.cmml" xref="alg1.21.21.m1.1.1">𝑅</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.21.21.m1.1c">B_{i}\sim\mathcal{H}(R)</annotation><annotation encoding="application/x-llamapun" id="alg1.21.21.m1.1d">italic_B start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∼ caligraphic_H ( italic_R )</annotation></semantics></math> subject to <math alttext="B_{i}" class="ltx_Math" display="inline" id="alg1.22.22.m2.1"><semantics id="alg1.22.22.m2.1a"><msub id="alg1.22.22.m2.1.1" xref="alg1.22.22.m2.1.1.cmml"><mi id="alg1.22.22.m2.1.1.2" xref="alg1.22.22.m2.1.1.2.cmml">B</mi><mi id="alg1.22.22.m2.1.1.3" xref="alg1.22.22.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.22.22.m2.1b"><apply id="alg1.22.22.m2.1.1.cmml" xref="alg1.22.22.m2.1.1"><csymbol cd="ambiguous" id="alg1.22.22.m2.1.1.1.cmml" xref="alg1.22.22.m2.1.1">subscript</csymbol><ci id="alg1.22.22.m2.1.1.2.cmml" xref="alg1.22.22.m2.1.1.2">𝐵</ci><ci id="alg1.22.22.m2.1.1.3.cmml" xref="alg1.22.22.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.22.22.m2.1c">B_{i}</annotation><annotation encoding="application/x-llamapun" id="alg1.22.22.m2.1d">italic_B start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and the molecules in <math alttext="S" class="ltx_Math" display="inline" id="alg1.23.23.m3.1"><semantics id="alg1.23.23.m3.1a"><mi id="alg1.23.23.m3.1.1" xref="alg1.23.23.m3.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="alg1.23.23.m3.1b"><ci id="alg1.23.23.m3.1.1.cmml" xref="alg1.23.23.m3.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.23.23.m3.1c">S</annotation><annotation encoding="application/x-llamapun" id="alg1.23.23.m3.1d">italic_S</annotation></semantics></math> can react via <math alttext="R" class="ltx_Math" display="inline" id="alg1.24.24.m4.1"><semantics id="alg1.24.24.m4.1a"><mi id="alg1.24.24.m4.1.1" xref="alg1.24.24.m4.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="alg1.24.24.m4.1b"><ci id="alg1.24.24.m4.1.1.cmml" xref="alg1.24.24.m4.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.24.24.m4.1c">R</annotation><annotation encoding="application/x-llamapun" id="alg1.24.24.m4.1d">italic_R</annotation></semantics></math>;
</div>
<div class="ltx_listingline" id="alg1.26.26">
<span class="ltx_tag ltx_tag_listingline">14</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span class="ltx_text ltx_font_typewriter" id="alg1.26.26.2">Push(<em class="ltx_emph ltx_font_serif ltx_font_italic" id="alg1.26.26.2.2"><math alttext="B_{i}" class="ltx_Math" display="inline" id="alg1.25.25.1.1.m1.1"><semantics id="alg1.25.25.1.1.m1.1a"><msub id="alg1.25.25.1.1.m1.1.1" xref="alg1.25.25.1.1.m1.1.1.cmml"><mi id="alg1.25.25.1.1.m1.1.1.2" xref="alg1.25.25.1.1.m1.1.1.2.cmml">B</mi><mi id="alg1.25.25.1.1.m1.1.1.3" xref="alg1.25.25.1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.25.25.1.1.m1.1b"><apply id="alg1.25.25.1.1.m1.1.1.cmml" xref="alg1.25.25.1.1.m1.1.1"><csymbol cd="ambiguous" id="alg1.25.25.1.1.m1.1.1.1.cmml" xref="alg1.25.25.1.1.m1.1.1">subscript</csymbol><ci id="alg1.25.25.1.1.m1.1.1.2.cmml" xref="alg1.25.25.1.1.m1.1.1.2">𝐵</ci><ci id="alg1.25.25.1.1.m1.1.1.3.cmml" xref="alg1.25.25.1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.25.25.1.1.m1.1c">B_{i}</annotation><annotation encoding="application/x-llamapun" id="alg1.25.25.1.1.m1.1d">italic_B start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> onto <math alttext="S" class="ltx_Math" display="inline" id="alg1.26.26.2.2.m2.1"><semantics id="alg1.26.26.2.2.m2.1a"><mi id="alg1.26.26.2.2.m2.1.1" xref="alg1.26.26.2.2.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="alg1.26.26.2.2.m2.1b"><ci id="alg1.26.26.2.2.m2.1.1.cmml" xref="alg1.26.26.2.2.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.26.26.2.2.m2.1c">S</annotation><annotation encoding="application/x-llamapun" id="alg1.26.26.2.2.m2.1d">italic_S</annotation></semantics></math></em>)</span>;
</div>
<div class="ltx_listingline" id="alg1.28.28">
<span class="ltx_tag ltx_tag_listingline">15</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span class="ltx_text ltx_font_typewriter" id="alg1.28.28.2">Append(<em class="ltx_emph ltx_font_serif ltx_font_italic" id="alg1.28.28.2.2"><math alttext="B_{i}" class="ltx_Math" display="inline" id="alg1.27.27.1.1.m1.1"><semantics id="alg1.27.27.1.1.m1.1a"><msub id="alg1.27.27.1.1.m1.1.1" xref="alg1.27.27.1.1.m1.1.1.cmml"><mi id="alg1.27.27.1.1.m1.1.1.2" xref="alg1.27.27.1.1.m1.1.1.2.cmml">B</mi><mi id="alg1.27.27.1.1.m1.1.1.3" xref="alg1.27.27.1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.27.27.1.1.m1.1b"><apply id="alg1.27.27.1.1.m1.1.1.cmml" xref="alg1.27.27.1.1.m1.1.1"><csymbol cd="ambiguous" id="alg1.27.27.1.1.m1.1.1.1.cmml" xref="alg1.27.27.1.1.m1.1.1">subscript</csymbol><ci id="alg1.27.27.1.1.m1.1.1.2.cmml" xref="alg1.27.27.1.1.m1.1.1.2">𝐵</ci><ci id="alg1.27.27.1.1.m1.1.1.3.cmml" xref="alg1.27.27.1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.27.27.1.1.m1.1c">B_{i}</annotation><annotation encoding="application/x-llamapun" id="alg1.27.27.1.1.m1.1d">italic_B start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> to <math alttext="P" class="ltx_Math" display="inline" id="alg1.28.28.2.2.m2.1"><semantics id="alg1.28.28.2.2.m2.1a"><mi id="alg1.28.28.2.2.m2.1.1" xref="alg1.28.28.2.2.m2.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="alg1.28.28.2.2.m2.1b"><ci id="alg1.28.28.2.2.m2.1.1.cmml" xref="alg1.28.28.2.2.m2.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.28.28.2.2.m2.1c">P</annotation><annotation encoding="application/x-llamapun" id="alg1.28.28.2.2.m2.1d">italic_P</annotation></semantics></math></em>)</span>;
</div>
<div class="ltx_listingline" id="alg1.40.50">
<span class="ltx_tag ltx_tag_listingline">16</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div class="ltx_listingline" id="alg1.40.51">
<span class="ltx_tag ltx_tag_listingline">17</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div class="ltx_listingline" id="alg1.31.31">
<span class="ltx_tag ltx_tag_listingline">18</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math alttext="\{X_{i}\}\leftarrow" class="ltx_Math" display="inline" id="alg1.29.29.m1.1"><semantics id="alg1.29.29.m1.1a"><mrow id="alg1.29.29.m1.1.1" xref="alg1.29.29.m1.1.1.cmml"><mrow id="alg1.29.29.m1.1.1.1.1" xref="alg1.29.29.m1.1.1.1.2.cmml"><mo id="alg1.29.29.m1.1.1.1.1.2" stretchy="false" xref="alg1.29.29.m1.1.1.1.2.cmml">{</mo><msub id="alg1.29.29.m1.1.1.1.1.1" xref="alg1.29.29.m1.1.1.1.1.1.cmml"><mi id="alg1.29.29.m1.1.1.1.1.1.2" xref="alg1.29.29.m1.1.1.1.1.1.2.cmml">X</mi><mi id="alg1.29.29.m1.1.1.1.1.1.3" xref="alg1.29.29.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg1.29.29.m1.1.1.1.1.3" stretchy="false" xref="alg1.29.29.m1.1.1.1.2.cmml">}</mo></mrow><mo id="alg1.29.29.m1.1.1.2" stretchy="false" xref="alg1.29.29.m1.1.1.2.cmml">←</mo><mi id="alg1.29.29.m1.1.1.3" xref="alg1.29.29.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.29.29.m1.1b"><apply id="alg1.29.29.m1.1.1.cmml" xref="alg1.29.29.m1.1.1"><ci id="alg1.29.29.m1.1.1.2.cmml" xref="alg1.29.29.m1.1.1.2">←</ci><set id="alg1.29.29.m1.1.1.1.2.cmml" xref="alg1.29.29.m1.1.1.1.1"><apply id="alg1.29.29.m1.1.1.1.1.1.cmml" xref="alg1.29.29.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.29.29.m1.1.1.1.1.1.1.cmml" xref="alg1.29.29.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.29.29.m1.1.1.1.1.1.2.cmml" xref="alg1.29.29.m1.1.1.1.1.1.2">𝑋</ci><ci id="alg1.29.29.m1.1.1.1.1.1.3.cmml" xref="alg1.29.29.m1.1.1.1.1.1.3">𝑖</ci></apply></set><csymbol cd="latexml" id="alg1.29.29.m1.1.1.3.cmml" xref="alg1.29.29.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.29.29.m1.1c">\{X_{i}\}\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg1.29.29.m1.1d">{ italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } ←</annotation></semantics></math> <span class="ltx_text ltx_font_typewriter" id="alg1.31.31.2">Pop(<em class="ltx_emph ltx_font_serif ltx_font_italic" id="alg1.31.31.2.2"><math alttext="R.\operatorname{numReactants}" class="ltx_Math" display="inline" id="alg1.30.30.1.1.m1.2"><semantics id="alg1.30.30.1.1.m1.2a"><mrow id="alg1.30.30.1.1.m1.2.3.2" xref="alg1.30.30.1.1.m1.2.3.1.cmml"><mi id="alg1.30.30.1.1.m1.1.1" xref="alg1.30.30.1.1.m1.1.1.cmml">R</mi><mo id="alg1.30.30.1.1.m1.2.3.2.1" lspace="0em" rspace="0.167em" xref="alg1.30.30.1.1.m1.2.3.1a.cmml">.</mo><mi id="alg1.30.30.1.1.m1.2.2" xref="alg1.30.30.1.1.m1.2.2.cmml">numReactants</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.30.30.1.1.m1.2b"><apply id="alg1.30.30.1.1.m1.2.3.1.cmml" xref="alg1.30.30.1.1.m1.2.3.2"><csymbol cd="ambiguous" id="alg1.30.30.1.1.m1.2.3.1a.cmml" xref="alg1.30.30.1.1.m1.2.3.2.1">formulae-sequence</csymbol><ci id="alg1.30.30.1.1.m1.1.1.cmml" xref="alg1.30.30.1.1.m1.1.1">𝑅</ci><ci id="alg1.30.30.1.1.m1.2.2.cmml" xref="alg1.30.30.1.1.m1.2.2">numReactants</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.30.30.1.1.m1.2c">R.\operatorname{numReactants}</annotation><annotation encoding="application/x-llamapun" id="alg1.30.30.1.1.m1.2d">italic_R . roman_numReactants</annotation></semantics></math> elements from <math alttext="S" class="ltx_Math" display="inline" id="alg1.31.31.2.2.m2.1"><semantics id="alg1.31.31.2.2.m2.1a"><mi id="alg1.31.31.2.2.m2.1.1" xref="alg1.31.31.2.2.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="alg1.31.31.2.2.m2.1b"><ci id="alg1.31.31.2.2.m2.1.1.cmml" xref="alg1.31.31.2.2.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.31.31.2.2.m2.1c">S</annotation><annotation encoding="application/x-llamapun" id="alg1.31.31.2.2.m2.1d">italic_S</annotation></semantics></math></em>)</span>;
</div>
<div class="ltx_listingline" id="alg1.33.33">
<span class="ltx_tag ltx_tag_listingline">19</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="Y\leftarrow" class="ltx_Math" display="inline" id="alg1.32.32.m1.1"><semantics id="alg1.32.32.m1.1a"><mrow id="alg1.32.32.m1.1.1" xref="alg1.32.32.m1.1.1.cmml"><mi id="alg1.32.32.m1.1.1.2" xref="alg1.32.32.m1.1.1.2.cmml">Y</mi><mo id="alg1.32.32.m1.1.1.1" stretchy="false" xref="alg1.32.32.m1.1.1.1.cmml">←</mo><mi id="alg1.32.32.m1.1.1.3" xref="alg1.32.32.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.32.32.m1.1b"><apply id="alg1.32.32.m1.1.1.cmml" xref="alg1.32.32.m1.1.1"><ci id="alg1.32.32.m1.1.1.1.cmml" xref="alg1.32.32.m1.1.1.1">←</ci><ci id="alg1.32.32.m1.1.1.2.cmml" xref="alg1.32.32.m1.1.1.2">𝑌</ci><csymbol cd="latexml" id="alg1.32.32.m1.1.1.3.cmml" xref="alg1.32.32.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.32.32.m1.1c">Y\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg1.32.32.m1.1d">italic_Y ←</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.33.33.1">Call</span> <math alttext="R(\{X_{i}\})" class="ltx_Math" display="inline" id="alg1.33.33.m2.1"><semantics id="alg1.33.33.m2.1a"><mrow id="alg1.33.33.m2.1.1" xref="alg1.33.33.m2.1.1.cmml"><mi id="alg1.33.33.m2.1.1.3" xref="alg1.33.33.m2.1.1.3.cmml">R</mi><mo id="alg1.33.33.m2.1.1.2" xref="alg1.33.33.m2.1.1.2.cmml">⁢</mo><mrow id="alg1.33.33.m2.1.1.1.1" xref="alg1.33.33.m2.1.1.cmml"><mo id="alg1.33.33.m2.1.1.1.1.2" stretchy="false" xref="alg1.33.33.m2.1.1.cmml">(</mo><mrow id="alg1.33.33.m2.1.1.1.1.1.1" xref="alg1.33.33.m2.1.1.1.1.1.2.cmml"><mo id="alg1.33.33.m2.1.1.1.1.1.1.2" stretchy="false" xref="alg1.33.33.m2.1.1.1.1.1.2.cmml">{</mo><msub id="alg1.33.33.m2.1.1.1.1.1.1.1" xref="alg1.33.33.m2.1.1.1.1.1.1.1.cmml"><mi id="alg1.33.33.m2.1.1.1.1.1.1.1.2" xref="alg1.33.33.m2.1.1.1.1.1.1.1.2.cmml">X</mi><mi id="alg1.33.33.m2.1.1.1.1.1.1.1.3" xref="alg1.33.33.m2.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg1.33.33.m2.1.1.1.1.1.1.3" stretchy="false" xref="alg1.33.33.m2.1.1.1.1.1.2.cmml">}</mo></mrow><mo id="alg1.33.33.m2.1.1.1.1.3" stretchy="false" xref="alg1.33.33.m2.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.33.33.m2.1b"><apply id="alg1.33.33.m2.1.1.cmml" xref="alg1.33.33.m2.1.1"><times id="alg1.33.33.m2.1.1.2.cmml" xref="alg1.33.33.m2.1.1.2"></times><ci id="alg1.33.33.m2.1.1.3.cmml" xref="alg1.33.33.m2.1.1.3">𝑅</ci><set id="alg1.33.33.m2.1.1.1.1.1.2.cmml" xref="alg1.33.33.m2.1.1.1.1.1.1"><apply id="alg1.33.33.m2.1.1.1.1.1.1.1.cmml" xref="alg1.33.33.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.33.33.m2.1.1.1.1.1.1.1.1.cmml" xref="alg1.33.33.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.33.33.m2.1.1.1.1.1.1.1.2.cmml" xref="alg1.33.33.m2.1.1.1.1.1.1.1.2">𝑋</ci><ci id="alg1.33.33.m2.1.1.1.1.1.1.1.3.cmml" xref="alg1.33.33.m2.1.1.1.1.1.1.1.3">𝑖</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.33.33.m2.1c">R(\{X_{i}\})</annotation><annotation encoding="application/x-llamapun" id="alg1.33.33.m2.1d">italic_R ( { italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } )</annotation></semantics></math>;
</div>
<div class="ltx_listingline" id="alg1.35.35">
<span class="ltx_tag ltx_tag_listingline">20</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span class="ltx_text ltx_font_typewriter" id="alg1.35.35.2">Push(<em class="ltx_emph ltx_font_serif ltx_font_italic" id="alg1.35.35.2.2"><math alttext="Y" class="ltx_Math" display="inline" id="alg1.34.34.1.1.m1.1"><semantics id="alg1.34.34.1.1.m1.1a"><mi id="alg1.34.34.1.1.m1.1.1" xref="alg1.34.34.1.1.m1.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="alg1.34.34.1.1.m1.1b"><ci id="alg1.34.34.1.1.m1.1.1.cmml" xref="alg1.34.34.1.1.m1.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.34.34.1.1.m1.1c">Y</annotation><annotation encoding="application/x-llamapun" id="alg1.34.34.1.1.m1.1d">italic_Y</annotation></semantics></math> onto <math alttext="S" class="ltx_Math" display="inline" id="alg1.35.35.2.2.m2.1"><semantics id="alg1.35.35.2.2.m2.1a"><mi id="alg1.35.35.2.2.m2.1.1" xref="alg1.35.35.2.2.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="alg1.35.35.2.2.m2.1b"><ci id="alg1.35.35.2.2.m2.1.1.cmml" xref="alg1.35.35.2.2.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.35.35.2.2.m2.1c">S</annotation><annotation encoding="application/x-llamapun" id="alg1.35.35.2.2.m2.1d">italic_S</annotation></semantics></math></em>)</span>;
</div>
<div class="ltx_listingline" id="alg1.37.37">
<span class="ltx_tag ltx_tag_listingline">21</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span class="ltx_text ltx_font_typewriter" id="alg1.37.37.2">Append(<em class="ltx_emph ltx_font_serif ltx_font_italic" id="alg1.37.37.2.2"><math alttext="R" class="ltx_Math" display="inline" id="alg1.36.36.1.1.m1.1"><semantics id="alg1.36.36.1.1.m1.1a"><mi id="alg1.36.36.1.1.m1.1.1" xref="alg1.36.36.1.1.m1.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="alg1.36.36.1.1.m1.1b"><ci id="alg1.36.36.1.1.m1.1.1.cmml" xref="alg1.36.36.1.1.m1.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.36.36.1.1.m1.1c">R</annotation><annotation encoding="application/x-llamapun" id="alg1.36.36.1.1.m1.1d">italic_R</annotation></semantics></math> to <math alttext="P" class="ltx_Math" display="inline" id="alg1.37.37.2.2.m2.1"><semantics id="alg1.37.37.2.2.m2.1a"><mi id="alg1.37.37.2.2.m2.1.1" xref="alg1.37.37.2.2.m2.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="alg1.37.37.2.2.m2.1b"><ci id="alg1.37.37.2.2.m2.1.1.cmml" xref="alg1.37.37.2.2.m2.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.37.37.2.2.m2.1c">P</annotation><annotation encoding="application/x-llamapun" id="alg1.37.37.2.2.m2.1d">italic_P</annotation></semantics></math></em>)</span>;
</div>
<div class="ltx_listingline" id="alg1.40.52">
<span class="ltx_tag ltx_tag_listingline">22</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div class="ltx_listingline" id="alg1.38.38">
<span class="ltx_tag ltx_tag_listingline">23</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span class="ltx_text ltx_font_bold" id="alg1.38.38.2">if</span> <em class="ltx_emph ltx_font_italic" id="alg1.38.38.1"><math alttext="S.\operatorname{length}()=1" class="ltx_Math" display="inline" id="alg1.38.38.1.m1.2"><semantics id="alg1.38.38.1.m1.2a"><mrow id="alg1.38.38.1.m1.2.2.1" xref="alg1.38.38.1.m1.2.2.2.cmml"><mi id="alg1.38.38.1.m1.1.1" xref="alg1.38.38.1.m1.1.1.cmml">S</mi><mo id="alg1.38.38.1.m1.2.2.1.2" lspace="0em" rspace="0.167em" xref="alg1.38.38.1.m1.2.2.2a.cmml">.</mo><mrow id="alg1.38.38.1.m1.2.2.1.1" xref="alg1.38.38.1.m1.2.2.1.1.cmml"><mrow id="alg1.38.38.1.m1.2.2.1.1.2" xref="alg1.38.38.1.m1.2.2.1.1.2.cmml"><mi id="alg1.38.38.1.m1.2.2.1.1.2.2" xref="alg1.38.38.1.m1.2.2.1.1.2.2.cmml">length</mi><mo id="alg1.38.38.1.m1.2.2.1.1.2.1" xref="alg1.38.38.1.m1.2.2.1.1.2.1.cmml">⁢</mo><mrow id="alg1.38.38.1.m1.2.2.1.1.2.3.2" xref="alg1.38.38.1.m1.2.2.1.1.2.cmml"><mo id="alg1.38.38.1.m1.2.2.1.1.2.3.2.1" stretchy="false" xref="alg1.38.38.1.m1.2.2.1.1.2.3.1.cmml">(</mo><mo id="alg1.38.38.1.m1.2.2.1.1.2.3.2.2" stretchy="false" xref="alg1.38.38.1.m1.2.2.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="alg1.38.38.1.m1.2.2.1.1.1" xref="alg1.38.38.1.m1.2.2.1.1.1.cmml">=</mo><mn id="alg1.38.38.1.m1.2.2.1.1.3" xref="alg1.38.38.1.m1.2.2.1.1.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.38.38.1.m1.2b"><apply id="alg1.38.38.1.m1.2.2.2.cmml" xref="alg1.38.38.1.m1.2.2.1"><csymbol cd="ambiguous" id="alg1.38.38.1.m1.2.2.2a.cmml" xref="alg1.38.38.1.m1.2.2.1.2">formulae-sequence</csymbol><ci id="alg1.38.38.1.m1.1.1.cmml" xref="alg1.38.38.1.m1.1.1">𝑆</ci><apply id="alg1.38.38.1.m1.2.2.1.1.cmml" xref="alg1.38.38.1.m1.2.2.1.1"><eq id="alg1.38.38.1.m1.2.2.1.1.1.cmml" xref="alg1.38.38.1.m1.2.2.1.1.1"></eq><apply id="alg1.38.38.1.m1.2.2.1.1.2.cmml" xref="alg1.38.38.1.m1.2.2.1.1.2"><times id="alg1.38.38.1.m1.2.2.1.1.2.1.cmml" xref="alg1.38.38.1.m1.2.2.1.1.2.1"></times><ci id="alg1.38.38.1.m1.2.2.1.1.2.2.cmml" xref="alg1.38.38.1.m1.2.2.1.1.2.2">length</ci><list id="alg1.38.38.1.m1.2.2.1.1.2.3.1.cmml" xref="alg1.38.38.1.m1.2.2.1.1.2.3.2.1"></list></apply><cn id="alg1.38.38.1.m1.2.2.1.1.3.cmml" type="integer" xref="alg1.38.38.1.m1.2.2.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.38.38.1.m1.2c">S.\operatorname{length}()=1</annotation><annotation encoding="application/x-llamapun" id="alg1.38.38.1.m1.2d">italic_S . roman_length ( ) = 1</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="alg1.38.38.3">then</span>
</div>
<div class="ltx_listingline" id="alg1.40.40">
<span class="ltx_tag ltx_tag_listingline">24</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span class="ltx_text ltx_font_typewriter" id="alg1.40.40.2">Yield(<em class="ltx_emph ltx_font_serif ltx_font_italic" id="alg1.40.40.2.2"><math alttext="P" class="ltx_Math" display="inline" id="alg1.39.39.1.1.m1.1"><semantics id="alg1.39.39.1.1.m1.1a"><mi id="alg1.39.39.1.1.m1.1.1" xref="alg1.39.39.1.1.m1.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="alg1.39.39.1.1.m1.1b"><ci id="alg1.39.39.1.1.m1.1.1.cmml" xref="alg1.39.39.1.1.m1.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.39.39.1.1.m1.1c">P</annotation><annotation encoding="application/x-llamapun" id="alg1.39.39.1.1.m1.1d">italic_P</annotation></semantics></math>, <math alttext="S.\operatorname{top}()" class="ltx_Math" display="inline" id="alg1.40.40.2.2.m2.2"><semantics id="alg1.40.40.2.2.m2.2a"><mrow id="alg1.40.40.2.2.m2.2.2.1" xref="alg1.40.40.2.2.m2.2.2.2.cmml"><mi id="alg1.40.40.2.2.m2.1.1" xref="alg1.40.40.2.2.m2.1.1.cmml">S</mi><mo id="alg1.40.40.2.2.m2.2.2.1.2" lspace="0em" rspace="0.167em" xref="alg1.40.40.2.2.m2.2.2.2a.cmml">.</mo><mrow id="alg1.40.40.2.2.m2.2.2.1.1" xref="alg1.40.40.2.2.m2.2.2.1.1.cmml"><mi id="alg1.40.40.2.2.m2.2.2.1.1.2" xref="alg1.40.40.2.2.m2.2.2.1.1.2.cmml">top</mi><mo id="alg1.40.40.2.2.m2.2.2.1.1.1" xref="alg1.40.40.2.2.m2.2.2.1.1.1.cmml">⁢</mo><mrow id="alg1.40.40.2.2.m2.2.2.1.1.3.2" xref="alg1.40.40.2.2.m2.2.2.1.1.cmml"><mo id="alg1.40.40.2.2.m2.2.2.1.1.3.2.1" stretchy="false" xref="alg1.40.40.2.2.m2.2.2.1.1.3.1.cmml">(</mo><mo id="alg1.40.40.2.2.m2.2.2.1.1.3.2.2" stretchy="false" xref="alg1.40.40.2.2.m2.2.2.1.1.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.40.40.2.2.m2.2b"><apply id="alg1.40.40.2.2.m2.2.2.2.cmml" xref="alg1.40.40.2.2.m2.2.2.1"><csymbol cd="ambiguous" id="alg1.40.40.2.2.m2.2.2.2a.cmml" xref="alg1.40.40.2.2.m2.2.2.1.2">formulae-sequence</csymbol><ci id="alg1.40.40.2.2.m2.1.1.cmml" xref="alg1.40.40.2.2.m2.1.1">𝑆</ci><apply id="alg1.40.40.2.2.m2.2.2.1.1.cmml" xref="alg1.40.40.2.2.m2.2.2.1.1"><times id="alg1.40.40.2.2.m2.2.2.1.1.1.cmml" xref="alg1.40.40.2.2.m2.2.2.1.1.1"></times><ci id="alg1.40.40.2.2.m2.2.2.1.1.2.cmml" xref="alg1.40.40.2.2.m2.2.2.1.1.2">top</ci><list id="alg1.40.40.2.2.m2.2.2.1.1.3.1.cmml" xref="alg1.40.40.2.2.m2.2.2.1.1.3.2.1"></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.40.40.2.2.m2.2c">S.\operatorname{top}()</annotation><annotation encoding="application/x-llamapun" id="alg1.40.40.2.2.m2.2d">italic_S . roman_top ( )</annotation></semantics></math></em>)</span>;
</div>
<div class="ltx_listingline" id="alg1.40.53">
<span class="ltx_tag ltx_tag_listingline">25</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div class="ltx_listingline" id="alg1.40.54">
<span class="ltx_tag ltx_tag_listingline">26</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div class="ltx_listingline" id="alg1.40.55">
<span class="ltx_tag ltx_tag_listingline">27</span>
</div>
<div class="ltx_listingline" id="alg1.40.56">
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.42.1.1">Algorithm 1</span> </span>Training data generation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib67" title="">67</a>]</cite></figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="A1.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.2.2 </span>Hyper-parameters</h4>
<div class="ltx_para ltx_noindent" id="A1.SS2.SSS2.p1">
<p class="ltx_p" id="A1.SS2.SSS2.p1.1">The SynFormer models are trained using the AdamW optimizer with a learning rate of <math alttext="3\times 10^{-4}" class="ltx_Math" display="inline" id="A1.SS2.SSS2.p1.1.m1.1"><semantics id="A1.SS2.SSS2.p1.1.m1.1a"><mrow id="A1.SS2.SSS2.p1.1.m1.1.1" xref="A1.SS2.SSS2.p1.1.m1.1.1.cmml"><mn id="A1.SS2.SSS2.p1.1.m1.1.1.2" xref="A1.SS2.SSS2.p1.1.m1.1.1.2.cmml">3</mn><mo id="A1.SS2.SSS2.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A1.SS2.SSS2.p1.1.m1.1.1.1.cmml">×</mo><msup id="A1.SS2.SSS2.p1.1.m1.1.1.3" xref="A1.SS2.SSS2.p1.1.m1.1.1.3.cmml"><mn id="A1.SS2.SSS2.p1.1.m1.1.1.3.2" xref="A1.SS2.SSS2.p1.1.m1.1.1.3.2.cmml">10</mn><mrow id="A1.SS2.SSS2.p1.1.m1.1.1.3.3" xref="A1.SS2.SSS2.p1.1.m1.1.1.3.3.cmml"><mo id="A1.SS2.SSS2.p1.1.m1.1.1.3.3a" xref="A1.SS2.SSS2.p1.1.m1.1.1.3.3.cmml">−</mo><mn id="A1.SS2.SSS2.p1.1.m1.1.1.3.3.2" xref="A1.SS2.SSS2.p1.1.m1.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS2.p1.1.m1.1b"><apply id="A1.SS2.SSS2.p1.1.m1.1.1.cmml" xref="A1.SS2.SSS2.p1.1.m1.1.1"><times id="A1.SS2.SSS2.p1.1.m1.1.1.1.cmml" xref="A1.SS2.SSS2.p1.1.m1.1.1.1"></times><cn id="A1.SS2.SSS2.p1.1.m1.1.1.2.cmml" type="integer" xref="A1.SS2.SSS2.p1.1.m1.1.1.2">3</cn><apply id="A1.SS2.SSS2.p1.1.m1.1.1.3.cmml" xref="A1.SS2.SSS2.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.SSS2.p1.1.m1.1.1.3.1.cmml" xref="A1.SS2.SSS2.p1.1.m1.1.1.3">superscript</csymbol><cn id="A1.SS2.SSS2.p1.1.m1.1.1.3.2.cmml" type="integer" xref="A1.SS2.SSS2.p1.1.m1.1.1.3.2">10</cn><apply id="A1.SS2.SSS2.p1.1.m1.1.1.3.3.cmml" xref="A1.SS2.SSS2.p1.1.m1.1.1.3.3"><minus id="A1.SS2.SSS2.p1.1.m1.1.1.3.3.1.cmml" xref="A1.SS2.SSS2.p1.1.m1.1.1.3.3"></minus><cn id="A1.SS2.SSS2.p1.1.m1.1.1.3.3.2.cmml" type="integer" xref="A1.SS2.SSS2.p1.1.m1.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS2.p1.1.m1.1c">3\times 10^{-4}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS2.p1.1.m1.1d">3 × 10 start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math> and a batch size of 1,024.
The training process spans approximately 730,000 steps, equivalent to a total of 742M data points.
Validation is performed every 5,000 steps.
A ReduceLROnPlateau scheduler is applied, reducing the learning rate by 20% if the validation loss does not improve over the last 10 validation runs.
The models are trained on 8 A100 GPUs, and the total training time is about 6 days and 1 hours.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="A1.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.3 </span>Inference details</h3>
<section class="ltx_subsubsection" id="A1.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.3.1 </span>Sampling algorithm</h4>
<div class="ltx_para ltx_noindent" id="A1.SS3.SSS1.p1">
<p class="ltx_p" id="A1.SS3.SSS1.p1.1">The sampling process starts with an empty stack and an empty postfix notation.
The stack and the postfix notation are updated iteratively as described in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#alg2" title="In A.3.2 Branched sampling ‣ A.3 Inference details ‣ Appendix A Additional method details ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_tag">2</span></a>.
Specifically, the SynFormer decoder first outputs the embedding vector and predicts the type for the next token based on the current postfix notation.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS3.SSS1.p2">
<p class="ltx_p" id="A1.SS3.SSS1.p2.3">If the next token is predicted to be a building block, the diffusion module will generate a set of <math alttext="k_{\text{fingerprint}}" class="ltx_Math" display="inline" id="A1.SS3.SSS1.p2.1.m1.1"><semantics id="A1.SS3.SSS1.p2.1.m1.1a"><msub id="A1.SS3.SSS1.p2.1.m1.1.1" xref="A1.SS3.SSS1.p2.1.m1.1.1.cmml"><mi id="A1.SS3.SSS1.p2.1.m1.1.1.2" xref="A1.SS3.SSS1.p2.1.m1.1.1.2.cmml">k</mi><mtext id="A1.SS3.SSS1.p2.1.m1.1.1.3" xref="A1.SS3.SSS1.p2.1.m1.1.1.3a.cmml">fingerprint</mtext></msub><annotation-xml encoding="MathML-Content" id="A1.SS3.SSS1.p2.1.m1.1b"><apply id="A1.SS3.SSS1.p2.1.m1.1.1.cmml" xref="A1.SS3.SSS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS3.SSS1.p2.1.m1.1.1.1.cmml" xref="A1.SS3.SSS1.p2.1.m1.1.1">subscript</csymbol><ci id="A1.SS3.SSS1.p2.1.m1.1.1.2.cmml" xref="A1.SS3.SSS1.p2.1.m1.1.1.2">𝑘</ci><ci id="A1.SS3.SSS1.p2.1.m1.1.1.3a.cmml" xref="A1.SS3.SSS1.p2.1.m1.1.1.3"><mtext id="A1.SS3.SSS1.p2.1.m1.1.1.3.cmml" mathsize="70%" xref="A1.SS3.SSS1.p2.1.m1.1.1.3">fingerprint</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.SSS1.p2.1.m1.1c">k_{\text{fingerprint}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.SSS1.p2.1.m1.1d">italic_k start_POSTSUBSCRIPT fingerprint end_POSTSUBSCRIPT</annotation></semantics></math> fingerprints.
For each fingerprint, the building block molecule with the most similar fingerprint measured by L2 distance is retrieved from the database.
<math alttext="k_{\text{fingerprint}}" class="ltx_Math" display="inline" id="A1.SS3.SSS1.p2.2.m2.1"><semantics id="A1.SS3.SSS1.p2.2.m2.1a"><msub id="A1.SS3.SSS1.p2.2.m2.1.1" xref="A1.SS3.SSS1.p2.2.m2.1.1.cmml"><mi id="A1.SS3.SSS1.p2.2.m2.1.1.2" xref="A1.SS3.SSS1.p2.2.m2.1.1.2.cmml">k</mi><mtext id="A1.SS3.SSS1.p2.2.m2.1.1.3" xref="A1.SS3.SSS1.p2.2.m2.1.1.3a.cmml">fingerprint</mtext></msub><annotation-xml encoding="MathML-Content" id="A1.SS3.SSS1.p2.2.m2.1b"><apply id="A1.SS3.SSS1.p2.2.m2.1.1.cmml" xref="A1.SS3.SSS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS3.SSS1.p2.2.m2.1.1.1.cmml" xref="A1.SS3.SSS1.p2.2.m2.1.1">subscript</csymbol><ci id="A1.SS3.SSS1.p2.2.m2.1.1.2.cmml" xref="A1.SS3.SSS1.p2.2.m2.1.1.2">𝑘</ci><ci id="A1.SS3.SSS1.p2.2.m2.1.1.3a.cmml" xref="A1.SS3.SSS1.p2.2.m2.1.1.3"><mtext id="A1.SS3.SSS1.p2.2.m2.1.1.3.cmml" mathsize="70%" xref="A1.SS3.SSS1.p2.2.m2.1.1.3">fingerprint</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.SSS1.p2.2.m2.1c">k_{\text{fingerprint}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.SSS1.p2.2.m2.1d">italic_k start_POSTSUBSCRIPT fingerprint end_POSTSUBSCRIPT</annotation></semantics></math> copies of the previous stack and postfix notation are made and each building block is added to the stack and the notation of each copy, leading to <math alttext="k_{\text{fingerprint}}" class="ltx_Math" display="inline" id="A1.SS3.SSS1.p2.3.m3.1"><semantics id="A1.SS3.SSS1.p2.3.m3.1a"><msub id="A1.SS3.SSS1.p2.3.m3.1.1" xref="A1.SS3.SSS1.p2.3.m3.1.1.cmml"><mi id="A1.SS3.SSS1.p2.3.m3.1.1.2" xref="A1.SS3.SSS1.p2.3.m3.1.1.2.cmml">k</mi><mtext id="A1.SS3.SSS1.p2.3.m3.1.1.3" xref="A1.SS3.SSS1.p2.3.m3.1.1.3a.cmml">fingerprint</mtext></msub><annotation-xml encoding="MathML-Content" id="A1.SS3.SSS1.p2.3.m3.1b"><apply id="A1.SS3.SSS1.p2.3.m3.1.1.cmml" xref="A1.SS3.SSS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="A1.SS3.SSS1.p2.3.m3.1.1.1.cmml" xref="A1.SS3.SSS1.p2.3.m3.1.1">subscript</csymbol><ci id="A1.SS3.SSS1.p2.3.m3.1.1.2.cmml" xref="A1.SS3.SSS1.p2.3.m3.1.1.2">𝑘</ci><ci id="A1.SS3.SSS1.p2.3.m3.1.1.3a.cmml" xref="A1.SS3.SSS1.p2.3.m3.1.1.3"><mtext id="A1.SS3.SSS1.p2.3.m3.1.1.3.cmml" mathsize="70%" xref="A1.SS3.SSS1.p2.3.m3.1.1.3">fingerprint</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.SSS1.p2.3.m3.1c">k_{\text{fingerprint}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.SSS1.p2.3.m3.1d">italic_k start_POSTSUBSCRIPT fingerprint end_POSTSUBSCRIPT</annotation></semantics></math> different next states.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS3.SSS1.p3">
<p class="ltx_p" id="A1.SS3.SSS1.p3.1">If the next token is predicted to be a reaction, <math alttext="k_{\text{reaction}}" class="ltx_Math" display="inline" id="A1.SS3.SSS1.p3.1.m1.1"><semantics id="A1.SS3.SSS1.p3.1.m1.1a"><msub id="A1.SS3.SSS1.p3.1.m1.1.1" xref="A1.SS3.SSS1.p3.1.m1.1.1.cmml"><mi id="A1.SS3.SSS1.p3.1.m1.1.1.2" xref="A1.SS3.SSS1.p3.1.m1.1.1.2.cmml">k</mi><mtext id="A1.SS3.SSS1.p3.1.m1.1.1.3" xref="A1.SS3.SSS1.p3.1.m1.1.1.3a.cmml">reaction</mtext></msub><annotation-xml encoding="MathML-Content" id="A1.SS3.SSS1.p3.1.m1.1b"><apply id="A1.SS3.SSS1.p3.1.m1.1.1.cmml" xref="A1.SS3.SSS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS3.SSS1.p3.1.m1.1.1.1.cmml" xref="A1.SS3.SSS1.p3.1.m1.1.1">subscript</csymbol><ci id="A1.SS3.SSS1.p3.1.m1.1.1.2.cmml" xref="A1.SS3.SSS1.p3.1.m1.1.1.2">𝑘</ci><ci id="A1.SS3.SSS1.p3.1.m1.1.1.3a.cmml" xref="A1.SS3.SSS1.p3.1.m1.1.1.3"><mtext id="A1.SS3.SSS1.p3.1.m1.1.1.3.cmml" mathsize="70%" xref="A1.SS3.SSS1.p3.1.m1.1.1.3">reaction</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.SSS1.p3.1.m1.1c">k_{\text{reaction}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.SSS1.p3.1.m1.1d">italic_k start_POSTSUBSCRIPT reaction end_POSTSUBSCRIPT</annotation></semantics></math> reactions with the highest probability are selected.
For each selected reaction, the required number of reactants are popped out of the stack. If there are too few molecules in the stack, the reaction is considered inapplicable.
Then, the reactants are input to the reaction template to predict the product. If the reaction runs successfully, the reaction product will be pushed onto the stack and the reaction itself will be appended to the postfix notation to form a next state. Otherwise, the reaction will be ignored and no next state for this reaction is produced.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS3.SSS1.p4">
<p class="ltx_p" id="A1.SS3.SSS1.p4.1">Finally, if the next token is an [END] token, we will check if the stack contains exactly one molecule. If it does, the sampling process is considered successful and the only molecule on the stack is the final product.
Otherwise, more than one molecule in the stack means the synthesis process is incomplete and thus is considered failed.</p>
</div>
</section>
<section class="ltx_subsubsection" id="A1.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.3.2 </span>Branched sampling</h4>
<div class="ltx_para ltx_noindent" id="A1.SS3.SSS2.p1">
<p class="ltx_p" id="A1.SS3.SSS2.p1.1">The sampling algorithm can lead to branched synthesis pathways at each building block and reaction step. This capability is particularly useful when a specific objective, for example similarity to a given molecule in analog generation, is set.
We leverage this capability by formulating a beam-search-like algorithm as described in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#alg3" title="In A.3.2 Branched sampling ‣ A.3 Inference details ‣ Appendix A Additional method details ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_tag">3</span></a>.
Specifically, we maintain a pool of states and each state is a tuple of synthesis stack and postfix notation.
In the beginning, the pool contains only one empty state.
At each state, we run the sampling step (Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#alg2" title="In A.3.2 Branched sampling ‣ A.3 Inference details ‣ Appendix A Additional method details ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_tag">2</span></a>) for each state in the pool, remove the existing state, and add the set of next generated states back to the pool.
If the pool size exceeds the limit, we sort the state according to the some given metric and then keep only the top-ranked states.
If a state is marked successful, it will be moved out of the pool and added to the result buffer.</p>
</div>
<figure class="ltx_float ltx_algorithm" id="alg2">
<div class="ltx_listing ltx_lst_numbers_left ltx_listing" id="alg2.41">
<div class="ltx_listingline" id="alg2.1.1">
<span class="ltx_text" id="alg2.1.1.1"><span class="ltx_text ltx_font_bold" id="alg2.1.1.1.1">Input:</span> </span><math alttext="P_{\text{prev}}" class="ltx_Math" display="inline" id="alg2.1.1.m1.1"><semantics id="alg2.1.1.m1.1a"><msub id="alg2.1.1.m1.1.1" xref="alg2.1.1.m1.1.1.cmml"><mi id="alg2.1.1.m1.1.1.2" xref="alg2.1.1.m1.1.1.2.cmml">P</mi><mtext id="alg2.1.1.m1.1.1.3" xref="alg2.1.1.m1.1.1.3a.cmml">prev</mtext></msub><annotation-xml encoding="MathML-Content" id="alg2.1.1.m1.1b"><apply id="alg2.1.1.m1.1.1.cmml" xref="alg2.1.1.m1.1.1"><csymbol cd="ambiguous" id="alg2.1.1.m1.1.1.1.cmml" xref="alg2.1.1.m1.1.1">subscript</csymbol><ci id="alg2.1.1.m1.1.1.2.cmml" xref="alg2.1.1.m1.1.1.2">𝑃</ci><ci id="alg2.1.1.m1.1.1.3a.cmml" xref="alg2.1.1.m1.1.1.3"><mtext id="alg2.1.1.m1.1.1.3.cmml" mathsize="70%" xref="alg2.1.1.m1.1.1.3">prev</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.1.1.m1.1c">P_{\text{prev}}</annotation><annotation encoding="application/x-llamapun" id="alg2.1.1.m1.1d">italic_P start_POSTSUBSCRIPT prev end_POSTSUBSCRIPT</annotation></semantics></math>, previous postfix notation of synthesis
</div>
<div class="ltx_listingline" id="alg2.2.2">
<span class="ltx_text" id="alg2.2.2.1"><span class="ltx_text ltx_font_bold" id="alg2.2.2.1.1">Input:</span> </span><math alttext="S_{\text{prev}}" class="ltx_Math" display="inline" id="alg2.2.2.m1.1"><semantics id="alg2.2.2.m1.1a"><msub id="alg2.2.2.m1.1.1" xref="alg2.2.2.m1.1.1.cmml"><mi id="alg2.2.2.m1.1.1.2" xref="alg2.2.2.m1.1.1.2.cmml">S</mi><mtext id="alg2.2.2.m1.1.1.3" xref="alg2.2.2.m1.1.1.3a.cmml">prev</mtext></msub><annotation-xml encoding="MathML-Content" id="alg2.2.2.m1.1b"><apply id="alg2.2.2.m1.1.1.cmml" xref="alg2.2.2.m1.1.1"><csymbol cd="ambiguous" id="alg2.2.2.m1.1.1.1.cmml" xref="alg2.2.2.m1.1.1">subscript</csymbol><ci id="alg2.2.2.m1.1.1.2.cmml" xref="alg2.2.2.m1.1.1.2">𝑆</ci><ci id="alg2.2.2.m1.1.1.3a.cmml" xref="alg2.2.2.m1.1.1.3"><mtext id="alg2.2.2.m1.1.1.3.cmml" mathsize="70%" xref="alg2.2.2.m1.1.1.3">prev</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.2.2.m1.1c">S_{\text{prev}}</annotation><annotation encoding="application/x-llamapun" id="alg2.2.2.m1.1d">italic_S start_POSTSUBSCRIPT prev end_POSTSUBSCRIPT</annotation></semantics></math>, previous synthesis stack
</div>
<div class="ltx_listingline" id="alg2.3.3">
<span class="ltx_text" id="alg2.3.3.1"><span class="ltx_text ltx_font_bold" id="alg2.3.3.1.1">Input:</span> </span><math alttext="\mathbf{c}" class="ltx_Math" display="inline" id="alg2.3.3.m1.1"><semantics id="alg2.3.3.m1.1a"><mi id="alg2.3.3.m1.1.1" xref="alg2.3.3.m1.1.1.cmml">𝐜</mi><annotation-xml encoding="MathML-Content" id="alg2.3.3.m1.1b"><ci id="alg2.3.3.m1.1.1.cmml" xref="alg2.3.3.m1.1.1">𝐜</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.3.3.m1.1c">\mathbf{c}</annotation><annotation encoding="application/x-llamapun" id="alg2.3.3.m1.1d">bold_c</annotation></semantics></math>, features from the encoder part of SynFormer, optional
</div>
<div class="ltx_listingline" id="alg2.4.4">
<span class="ltx_text" id="alg2.4.4.1"><span class="ltx_text ltx_font_bold" id="alg2.4.4.1.1">Input:</span> </span><math alttext="k_{\text{reaction}}" class="ltx_Math" display="inline" id="alg2.4.4.m1.1"><semantics id="alg2.4.4.m1.1a"><msub id="alg2.4.4.m1.1.1" xref="alg2.4.4.m1.1.1.cmml"><mi id="alg2.4.4.m1.1.1.2" xref="alg2.4.4.m1.1.1.2.cmml">k</mi><mtext id="alg2.4.4.m1.1.1.3" xref="alg2.4.4.m1.1.1.3a.cmml">reaction</mtext></msub><annotation-xml encoding="MathML-Content" id="alg2.4.4.m1.1b"><apply id="alg2.4.4.m1.1.1.cmml" xref="alg2.4.4.m1.1.1"><csymbol cd="ambiguous" id="alg2.4.4.m1.1.1.1.cmml" xref="alg2.4.4.m1.1.1">subscript</csymbol><ci id="alg2.4.4.m1.1.1.2.cmml" xref="alg2.4.4.m1.1.1.2">𝑘</ci><ci id="alg2.4.4.m1.1.1.3a.cmml" xref="alg2.4.4.m1.1.1.3"><mtext id="alg2.4.4.m1.1.1.3.cmml" mathsize="70%" xref="alg2.4.4.m1.1.1.3">reaction</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.4.4.m1.1c">k_{\text{reaction}}</annotation><annotation encoding="application/x-llamapun" id="alg2.4.4.m1.1d">italic_k start_POSTSUBSCRIPT reaction end_POSTSUBSCRIPT</annotation></semantics></math>, branching factor of reaction
</div>
<div class="ltx_listingline" id="alg2.5.5">
<span class="ltx_text" id="alg2.5.5.1"><span class="ltx_text ltx_font_bold" id="alg2.5.5.1.1">Input:</span> </span><math alttext="k_{\text{fingerprint}}" class="ltx_Math" display="inline" id="alg2.5.5.m1.1"><semantics id="alg2.5.5.m1.1a"><msub id="alg2.5.5.m1.1.1" xref="alg2.5.5.m1.1.1.cmml"><mi id="alg2.5.5.m1.1.1.2" xref="alg2.5.5.m1.1.1.2.cmml">k</mi><mtext id="alg2.5.5.m1.1.1.3" xref="alg2.5.5.m1.1.1.3a.cmml">fingerprint</mtext></msub><annotation-xml encoding="MathML-Content" id="alg2.5.5.m1.1b"><apply id="alg2.5.5.m1.1.1.cmml" xref="alg2.5.5.m1.1.1"><csymbol cd="ambiguous" id="alg2.5.5.m1.1.1.1.cmml" xref="alg2.5.5.m1.1.1">subscript</csymbol><ci id="alg2.5.5.m1.1.1.2.cmml" xref="alg2.5.5.m1.1.1.2">𝑘</ci><ci id="alg2.5.5.m1.1.1.3a.cmml" xref="alg2.5.5.m1.1.1.3"><mtext id="alg2.5.5.m1.1.1.3.cmml" mathsize="70%" xref="alg2.5.5.m1.1.1.3">fingerprint</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.5.5.m1.1c">k_{\text{fingerprint}}</annotation><annotation encoding="application/x-llamapun" id="alg2.5.5.m1.1d">italic_k start_POSTSUBSCRIPT fingerprint end_POSTSUBSCRIPT</annotation></semantics></math>, branching factor of building block fingerprint
</div>
<div class="ltx_listingline" id="alg2.41.42">
<span class="ltx_tag ltx_tag_listingline">1</span>
</div>
<div class="ltx_listingline" id="alg2.7.7">
<span class="ltx_text ltx_font_typewriter" id="alg2.7.7.3">// </span><span class="ltx_text ltx_font_typewriter" id="alg2.7.7.2">Global variables: <math alttext="\operatorname{SynFormer}" class="ltx_Math" display="inline" id="alg2.6.6.1.m1.1"><semantics id="alg2.6.6.1.m1.1a"><mi id="alg2.6.6.1.m1.1.1" xref="alg2.6.6.1.m1.1.1.cmml">SynFormer</mi><annotation-xml encoding="MathML-Content" id="alg2.6.6.1.m1.1b"><ci id="alg2.6.6.1.m1.1.1.cmml" xref="alg2.6.6.1.m1.1.1">SynFormer</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.6.6.1.m1.1c">\operatorname{SynFormer}</annotation><annotation encoding="application/x-llamapun" id="alg2.6.6.1.m1.1d">roman_SynFormer</annotation></semantics></math>, <math alttext="\operatorname{BuildingBlockDatabase}" class="ltx_Math" display="inline" id="alg2.7.7.2.m2.1"><semantics id="alg2.7.7.2.m2.1a"><mi id="alg2.7.7.2.m2.1.1" xref="alg2.7.7.2.m2.1.1.cmml">BuildingBlockDatabase</mi><annotation-xml encoding="MathML-Content" id="alg2.7.7.2.m2.1b"><ci id="alg2.7.7.2.m2.1.1.cmml" xref="alg2.7.7.2.m2.1.1">BuildingBlockDatabase</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.7.7.2.m2.1c">\operatorname{BuildingBlockDatabase}</annotation><annotation encoding="application/x-llamapun" id="alg2.7.7.2.m2.1d">roman_BuildingBlockDatabase</annotation></semantics></math> </span>
</div>
<div class="ltx_listingline" id="alg2.41.43">
<span class="ltx_tag ltx_tag_listingline">2</span>
</div>
<div class="ltx_listingline" id="alg2.8.8">
<span class="ltx_text" id="alg2.8.8.1"><span class="ltx_text ltx_font_bold" id="alg2.8.8.1.1">Output:</span> </span>an iterator of next states in the form of postfix notation and stack tuple <math alttext="(P,S)" class="ltx_Math" display="inline" id="alg2.8.8.m1.2"><semantics id="alg2.8.8.m1.2a"><mrow id="alg2.8.8.m1.2.3.2" xref="alg2.8.8.m1.2.3.1.cmml"><mo id="alg2.8.8.m1.2.3.2.1" stretchy="false" xref="alg2.8.8.m1.2.3.1.cmml">(</mo><mi id="alg2.8.8.m1.1.1" xref="alg2.8.8.m1.1.1.cmml">P</mi><mo id="alg2.8.8.m1.2.3.2.2" xref="alg2.8.8.m1.2.3.1.cmml">,</mo><mi id="alg2.8.8.m1.2.2" xref="alg2.8.8.m1.2.2.cmml">S</mi><mo id="alg2.8.8.m1.2.3.2.3" stretchy="false" xref="alg2.8.8.m1.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.8.8.m1.2b"><interval closure="open" id="alg2.8.8.m1.2.3.1.cmml" xref="alg2.8.8.m1.2.3.2"><ci id="alg2.8.8.m1.1.1.cmml" xref="alg2.8.8.m1.1.1">𝑃</ci><ci id="alg2.8.8.m1.2.2.cmml" xref="alg2.8.8.m1.2.2">𝑆</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="alg2.8.8.m1.2c">(P,S)</annotation><annotation encoding="application/x-llamapun" id="alg2.8.8.m1.2d">( italic_P , italic_S )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.41.44">
<span class="ltx_tag ltx_tag_listingline">3</span>
</div>
<div class="ltx_listingline" id="alg2.9.9">
<math alttext="\mathbf{h}\leftarrow\operatorname{SynFormer.decoder}(\operatorname{embed}(P_{%
\text{prev}}),\mathbf{c})" class="ltx_Math" display="inline" id="alg2.9.9.m1.5"><semantics id="alg2.9.9.m1.5a"><mrow id="alg2.9.9.m1.5.5" xref="alg2.9.9.m1.5.5.cmml"><mi id="alg2.9.9.m1.5.5.3" xref="alg2.9.9.m1.5.5.3.cmml">𝐡</mi><mo id="alg2.9.9.m1.5.5.2" stretchy="false" xref="alg2.9.9.m1.5.5.2.cmml">←</mo><mrow id="alg2.9.9.m1.5.5.1.1" xref="alg2.9.9.m1.5.5.1.2.cmml"><mrow id="alg2.9.9.m1.2.2.4" xref="alg2.9.9.m1.2.2.3.cmml"><mi id="alg2.9.9.m1.1.1.1" xref="alg2.9.9.m1.1.1.1.cmml">SynFormer</mi><mo id="alg2.9.9.m1.2.2.4.1" lspace="0em" rspace="0.167em" xref="alg2.9.9.m1.2.2.3a.cmml">.</mo><mi id="alg2.9.9.m1.2.2.2" xref="alg2.9.9.m1.2.2.2.cmml">decoder</mi></mrow><mo id="alg2.9.9.m1.5.5.1.1a" xref="alg2.9.9.m1.5.5.1.2.cmml">⁡</mo><mrow id="alg2.9.9.m1.5.5.1.1.1" xref="alg2.9.9.m1.5.5.1.2.cmml"><mo id="alg2.9.9.m1.5.5.1.1.1.2" stretchy="false" xref="alg2.9.9.m1.5.5.1.2.cmml">(</mo><mrow id="alg2.9.9.m1.5.5.1.1.1.1.1" xref="alg2.9.9.m1.5.5.1.1.1.1.2.cmml"><mi id="alg2.9.9.m1.3.3" xref="alg2.9.9.m1.3.3.cmml">embed</mi><mo id="alg2.9.9.m1.5.5.1.1.1.1.1a" xref="alg2.9.9.m1.5.5.1.1.1.1.2.cmml">⁡</mo><mrow id="alg2.9.9.m1.5.5.1.1.1.1.1.1" xref="alg2.9.9.m1.5.5.1.1.1.1.2.cmml"><mo id="alg2.9.9.m1.5.5.1.1.1.1.1.1.2" stretchy="false" xref="alg2.9.9.m1.5.5.1.1.1.1.2.cmml">(</mo><msub id="alg2.9.9.m1.5.5.1.1.1.1.1.1.1" xref="alg2.9.9.m1.5.5.1.1.1.1.1.1.1.cmml"><mi id="alg2.9.9.m1.5.5.1.1.1.1.1.1.1.2" xref="alg2.9.9.m1.5.5.1.1.1.1.1.1.1.2.cmml">P</mi><mtext id="alg2.9.9.m1.5.5.1.1.1.1.1.1.1.3" xref="alg2.9.9.m1.5.5.1.1.1.1.1.1.1.3a.cmml">prev</mtext></msub><mo id="alg2.9.9.m1.5.5.1.1.1.1.1.1.3" stretchy="false" xref="alg2.9.9.m1.5.5.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="alg2.9.9.m1.5.5.1.1.1.3" xref="alg2.9.9.m1.5.5.1.2.cmml">,</mo><mi id="alg2.9.9.m1.4.4" xref="alg2.9.9.m1.4.4.cmml">𝐜</mi><mo id="alg2.9.9.m1.5.5.1.1.1.4" stretchy="false" xref="alg2.9.9.m1.5.5.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.9.9.m1.5b"><apply id="alg2.9.9.m1.5.5.cmml" xref="alg2.9.9.m1.5.5"><ci id="alg2.9.9.m1.5.5.2.cmml" xref="alg2.9.9.m1.5.5.2">←</ci><ci id="alg2.9.9.m1.5.5.3.cmml" xref="alg2.9.9.m1.5.5.3">𝐡</ci><apply id="alg2.9.9.m1.5.5.1.2.cmml" xref="alg2.9.9.m1.5.5.1.1"><apply id="alg2.9.9.m1.2.2.3.cmml" xref="alg2.9.9.m1.2.2.4"><csymbol cd="ambiguous" id="alg2.9.9.m1.2.2.3a.cmml" xref="alg2.9.9.m1.2.2.4.1">formulae-sequence</csymbol><ci id="alg2.9.9.m1.1.1.1.cmml" xref="alg2.9.9.m1.1.1.1">SynFormer</ci><ci id="alg2.9.9.m1.2.2.2.cmml" xref="alg2.9.9.m1.2.2.2">decoder</ci></apply><apply id="alg2.9.9.m1.5.5.1.1.1.1.2.cmml" xref="alg2.9.9.m1.5.5.1.1.1.1.1"><ci id="alg2.9.9.m1.3.3.cmml" xref="alg2.9.9.m1.3.3">embed</ci><apply id="alg2.9.9.m1.5.5.1.1.1.1.1.1.1.cmml" xref="alg2.9.9.m1.5.5.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.9.9.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="alg2.9.9.m1.5.5.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.9.9.m1.5.5.1.1.1.1.1.1.1.2.cmml" xref="alg2.9.9.m1.5.5.1.1.1.1.1.1.1.2">𝑃</ci><ci id="alg2.9.9.m1.5.5.1.1.1.1.1.1.1.3a.cmml" xref="alg2.9.9.m1.5.5.1.1.1.1.1.1.1.3"><mtext id="alg2.9.9.m1.5.5.1.1.1.1.1.1.1.3.cmml" mathsize="70%" xref="alg2.9.9.m1.5.5.1.1.1.1.1.1.1.3">prev</mtext></ci></apply></apply><ci id="alg2.9.9.m1.4.4.cmml" xref="alg2.9.9.m1.4.4">𝐜</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.9.9.m1.5c">\mathbf{h}\leftarrow\operatorname{SynFormer.decoder}(\operatorname{embed}(P_{%
\text{prev}}),\mathbf{c})</annotation><annotation encoding="application/x-llamapun" id="alg2.9.9.m1.5d">bold_h ← start_OPFUNCTION roman_SynFormer . roman_decoder end_OPFUNCTION ( roman_embed ( italic_P start_POSTSUBSCRIPT prev end_POSTSUBSCRIPT ) , bold_c )</annotation></semantics></math> ;
</div>
<div class="ltx_listingline" id="alg2.41.45">  <span class="ltx_text ltx_font_typewriter" id="alg2.41.45.1">// </span><span class="ltx_text ltx_font_typewriter" id="alg2.41.45.2">Get the embedding for the next token</span>
</div>
<div class="ltx_listingline" id="alg2.10.10">
<math alttext="t\leftarrow\operatorname{SynFormer.predictNextType}(\mathbf{h})" class="ltx_Math" display="inline" id="alg2.10.10.m1.3"><semantics id="alg2.10.10.m1.3a"><mrow id="alg2.10.10.m1.3.4" xref="alg2.10.10.m1.3.4.cmml"><mi id="alg2.10.10.m1.3.4.2" xref="alg2.10.10.m1.3.4.2.cmml">t</mi><mo id="alg2.10.10.m1.3.4.1" stretchy="false" xref="alg2.10.10.m1.3.4.1.cmml">←</mo><mrow id="alg2.10.10.m1.3.4.3.2" xref="alg2.10.10.m1.3.4.3.1.cmml"><mrow id="alg2.10.10.m1.2.2.4" xref="alg2.10.10.m1.2.2.3.cmml"><mi id="alg2.10.10.m1.1.1.1" xref="alg2.10.10.m1.1.1.1.cmml">SynFormer</mi><mo id="alg2.10.10.m1.2.2.4.1" lspace="0em" rspace="0.167em" xref="alg2.10.10.m1.2.2.3a.cmml">.</mo><mi id="alg2.10.10.m1.2.2.2" xref="alg2.10.10.m1.2.2.2.cmml">predictNextType</mi></mrow><mo id="alg2.10.10.m1.3.4.3.2a" xref="alg2.10.10.m1.3.4.3.1.cmml">⁡</mo><mrow id="alg2.10.10.m1.3.4.3.2.1" xref="alg2.10.10.m1.3.4.3.1.cmml"><mo id="alg2.10.10.m1.3.4.3.2.1.1" stretchy="false" xref="alg2.10.10.m1.3.4.3.1.cmml">(</mo><mi id="alg2.10.10.m1.3.3" xref="alg2.10.10.m1.3.3.cmml">𝐡</mi><mo id="alg2.10.10.m1.3.4.3.2.1.2" stretchy="false" xref="alg2.10.10.m1.3.4.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.10.10.m1.3b"><apply id="alg2.10.10.m1.3.4.cmml" xref="alg2.10.10.m1.3.4"><ci id="alg2.10.10.m1.3.4.1.cmml" xref="alg2.10.10.m1.3.4.1">←</ci><ci id="alg2.10.10.m1.3.4.2.cmml" xref="alg2.10.10.m1.3.4.2">𝑡</ci><apply id="alg2.10.10.m1.3.4.3.1.cmml" xref="alg2.10.10.m1.3.4.3.2"><apply id="alg2.10.10.m1.2.2.3.cmml" xref="alg2.10.10.m1.2.2.4"><csymbol cd="ambiguous" id="alg2.10.10.m1.2.2.3a.cmml" xref="alg2.10.10.m1.2.2.4.1">formulae-sequence</csymbol><ci id="alg2.10.10.m1.1.1.1.cmml" xref="alg2.10.10.m1.1.1.1">SynFormer</ci><ci id="alg2.10.10.m1.2.2.2.cmml" xref="alg2.10.10.m1.2.2.2">predictNextType</ci></apply><ci id="alg2.10.10.m1.3.3.cmml" xref="alg2.10.10.m1.3.3">𝐡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.10.10.m1.3c">t\leftarrow\operatorname{SynFormer.predictNextType}(\mathbf{h})</annotation><annotation encoding="application/x-llamapun" id="alg2.10.10.m1.3d">italic_t ← start_OPFUNCTION roman_SynFormer . roman_predictNextType end_OPFUNCTION ( bold_h )</annotation></semantics></math> ;
</div>
<div class="ltx_listingline" id="alg2.41.46">  <span class="ltx_text ltx_font_typewriter" id="alg2.41.46.1">// </span><span class="ltx_text ltx_font_typewriter" id="alg2.41.46.2">Predict the type of the next token</span>
</div>
<div class="ltx_listingline" id="alg2.41.47">
<span class="ltx_tag ltx_tag_listingline">4</span>
</div>
<div class="ltx_listingline" id="alg2.11.11">
<span class="ltx_tag ltx_tag_listingline">5</span><span class="ltx_text ltx_font_bold" id="alg2.11.11.2">if</span> <em class="ltx_emph ltx_font_italic" id="alg2.11.11.1"><math alttext="t=\text{BuildingBlock}" class="ltx_Math" display="inline" id="alg2.11.11.1.m1.1"><semantics id="alg2.11.11.1.m1.1a"><mrow id="alg2.11.11.1.m1.1.1" xref="alg2.11.11.1.m1.1.1.cmml"><mi id="alg2.11.11.1.m1.1.1.2" xref="alg2.11.11.1.m1.1.1.2.cmml">t</mi><mo id="alg2.11.11.1.m1.1.1.1" xref="alg2.11.11.1.m1.1.1.1.cmml">=</mo><mtext class="ltx_mathvariant_italic" id="alg2.11.11.1.m1.1.1.3" xref="alg2.11.11.1.m1.1.1.3a.cmml">BuildingBlock</mtext></mrow><annotation-xml encoding="MathML-Content" id="alg2.11.11.1.m1.1b"><apply id="alg2.11.11.1.m1.1.1.cmml" xref="alg2.11.11.1.m1.1.1"><eq id="alg2.11.11.1.m1.1.1.1.cmml" xref="alg2.11.11.1.m1.1.1.1"></eq><ci id="alg2.11.11.1.m1.1.1.2.cmml" xref="alg2.11.11.1.m1.1.1.2">𝑡</ci><ci id="alg2.11.11.1.m1.1.1.3a.cmml" xref="alg2.11.11.1.m1.1.1.3"><mtext class="ltx_mathvariant_italic" id="alg2.11.11.1.m1.1.1.3.cmml" xref="alg2.11.11.1.m1.1.1.3">BuildingBlock</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.11.11.1.m1.1c">t=\text{BuildingBlock}</annotation><annotation encoding="application/x-llamapun" id="alg2.11.11.1.m1.1d">italic_t = BuildingBlock</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="alg2.11.11.3">then</span>
</div>
<div class="ltx_listingline" id="alg2.13.13">
<span class="ltx_tag ltx_tag_listingline">6</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span class="ltx_text ltx_font_bold" id="alg2.13.13.3">foreach</span> <em class="ltx_emph ltx_font_italic" id="alg2.13.13.2"><math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="alg2.12.12.1.m1.1"><semantics id="alg2.12.12.1.m1.1a"><mi id="alg2.12.12.1.m1.1.1" xref="alg2.12.12.1.m1.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="alg2.12.12.1.m1.1b"><ci id="alg2.12.12.1.m1.1.1.cmml" xref="alg2.12.12.1.m1.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.12.12.1.m1.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="alg2.12.12.1.m1.1d">bold_x</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg2.13.13.2.1">in</span> <math alttext="\operatorname{SynFormer.generateFingerprints}(\mathbf{h},k_{\text{fingerprint}})" class="ltx_Math" display="inline" id="alg2.13.13.2.m2.4"><semantics id="alg2.13.13.2.m2.4a"><mrow id="alg2.13.13.2.m2.4.4.1" xref="alg2.13.13.2.m2.4.4.2.cmml"><mrow id="alg2.13.13.2.m2.2.2.4" xref="alg2.13.13.2.m2.2.2.3.cmml"><mi id="alg2.13.13.2.m2.1.1.1" xref="alg2.13.13.2.m2.1.1.1.cmml">SynFormer</mi><mo id="alg2.13.13.2.m2.2.2.4.1" lspace="0em" rspace="0.167em" xref="alg2.13.13.2.m2.2.2.3a.cmml">.</mo><mi id="alg2.13.13.2.m2.2.2.2" xref="alg2.13.13.2.m2.2.2.2.cmml">generateFingerprints</mi></mrow><mo id="alg2.13.13.2.m2.4.4.1a" xref="alg2.13.13.2.m2.4.4.2.cmml">⁡</mo><mrow id="alg2.13.13.2.m2.4.4.1.1" xref="alg2.13.13.2.m2.4.4.2.cmml"><mo id="alg2.13.13.2.m2.4.4.1.1.2" stretchy="false" xref="alg2.13.13.2.m2.4.4.2.cmml">(</mo><mi id="alg2.13.13.2.m2.3.3" xref="alg2.13.13.2.m2.3.3.cmml">𝐡</mi><mo id="alg2.13.13.2.m2.4.4.1.1.3" xref="alg2.13.13.2.m2.4.4.2.cmml">,</mo><msub id="alg2.13.13.2.m2.4.4.1.1.1" xref="alg2.13.13.2.m2.4.4.1.1.1.cmml"><mi id="alg2.13.13.2.m2.4.4.1.1.1.2" xref="alg2.13.13.2.m2.4.4.1.1.1.2.cmml">k</mi><mtext class="ltx_mathvariant_italic" id="alg2.13.13.2.m2.4.4.1.1.1.3" xref="alg2.13.13.2.m2.4.4.1.1.1.3b.cmml"><em class="ltx_emph" id="alg2.13.13.2.m2.4.4.1.1.1.3.1nest" style="font-size:70%;">fingerprint</em></mtext></msub><mo id="alg2.13.13.2.m2.4.4.1.1.4" stretchy="false" xref="alg2.13.13.2.m2.4.4.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.13.13.2.m2.4b"><apply id="alg2.13.13.2.m2.4.4.2.cmml" xref="alg2.13.13.2.m2.4.4.1"><apply id="alg2.13.13.2.m2.2.2.3.cmml" xref="alg2.13.13.2.m2.2.2.4"><csymbol cd="ambiguous" id="alg2.13.13.2.m2.2.2.3a.cmml" xref="alg2.13.13.2.m2.2.2.4.1">formulae-sequence</csymbol><ci id="alg2.13.13.2.m2.1.1.1.cmml" xref="alg2.13.13.2.m2.1.1.1">SynFormer</ci><ci id="alg2.13.13.2.m2.2.2.2.cmml" xref="alg2.13.13.2.m2.2.2.2">generateFingerprints</ci></apply><ci id="alg2.13.13.2.m2.3.3.cmml" xref="alg2.13.13.2.m2.3.3">𝐡</ci><apply id="alg2.13.13.2.m2.4.4.1.1.1.cmml" xref="alg2.13.13.2.m2.4.4.1.1.1"><csymbol cd="ambiguous" id="alg2.13.13.2.m2.4.4.1.1.1.1.cmml" xref="alg2.13.13.2.m2.4.4.1.1.1">subscript</csymbol><ci id="alg2.13.13.2.m2.4.4.1.1.1.2.cmml" xref="alg2.13.13.2.m2.4.4.1.1.1.2">𝑘</ci><ci id="alg2.13.13.2.m2.4.4.1.1.1.3b.cmml" xref="alg2.13.13.2.m2.4.4.1.1.1.3"><mtext class="ltx_mathvariant_italic" id="alg2.13.13.2.m2.4.4.1.1.1.3.cmml" mathsize="70%" xref="alg2.13.13.2.m2.4.4.1.1.1.3"><em class="ltx_emph" id="alg2.13.13.2.m2.4.4.1.1.1.3.1anest" style="font-size:70%;">fingerprint</em></mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.13.13.2.m2.4c">\operatorname{SynFormer.generateFingerprints}(\mathbf{h},k_{\text{fingerprint}})</annotation><annotation encoding="application/x-llamapun" id="alg2.13.13.2.m2.4d">start_OPFUNCTION roman_SynFormer . roman_generateFingerprints end_OPFUNCTION ( bold_h , italic_k start_POSTSUBSCRIPT fingerprint end_POSTSUBSCRIPT )</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="alg2.13.13.4">do</span>
</div>
<div class="ltx_listingline" id="alg2.14.14">
<span class="ltx_tag ltx_tag_listingline">7</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="P,S\leftarrow\operatorname{copy}(P_{\text{prev}},S_{\text{prev}})" class="ltx_Math" display="inline" id="alg2.14.14.m1.5"><semantics id="alg2.14.14.m1.5a"><mrow id="alg2.14.14.m1.5.5" xref="alg2.14.14.m1.5.5.cmml"><mrow id="alg2.14.14.m1.5.5.4.2" xref="alg2.14.14.m1.5.5.4.1.cmml"><mi id="alg2.14.14.m1.2.2" xref="alg2.14.14.m1.2.2.cmml">P</mi><mo id="alg2.14.14.m1.5.5.4.2.1" xref="alg2.14.14.m1.5.5.4.1.cmml">,</mo><mi id="alg2.14.14.m1.3.3" xref="alg2.14.14.m1.3.3.cmml">S</mi></mrow><mo id="alg2.14.14.m1.5.5.3" stretchy="false" xref="alg2.14.14.m1.5.5.3.cmml">←</mo><mrow id="alg2.14.14.m1.5.5.2.2" xref="alg2.14.14.m1.5.5.2.3.cmml"><mi id="alg2.14.14.m1.1.1" xref="alg2.14.14.m1.1.1.cmml">copy</mi><mo id="alg2.14.14.m1.5.5.2.2a" xref="alg2.14.14.m1.5.5.2.3.cmml">⁡</mo><mrow id="alg2.14.14.m1.5.5.2.2.2" xref="alg2.14.14.m1.5.5.2.3.cmml"><mo id="alg2.14.14.m1.5.5.2.2.2.3" stretchy="false" xref="alg2.14.14.m1.5.5.2.3.cmml">(</mo><msub id="alg2.14.14.m1.4.4.1.1.1.1" xref="alg2.14.14.m1.4.4.1.1.1.1.cmml"><mi id="alg2.14.14.m1.4.4.1.1.1.1.2" xref="alg2.14.14.m1.4.4.1.1.1.1.2.cmml">P</mi><mtext id="alg2.14.14.m1.4.4.1.1.1.1.3" xref="alg2.14.14.m1.4.4.1.1.1.1.3a.cmml">prev</mtext></msub><mo id="alg2.14.14.m1.5.5.2.2.2.4" xref="alg2.14.14.m1.5.5.2.3.cmml">,</mo><msub id="alg2.14.14.m1.5.5.2.2.2.2" xref="alg2.14.14.m1.5.5.2.2.2.2.cmml"><mi id="alg2.14.14.m1.5.5.2.2.2.2.2" xref="alg2.14.14.m1.5.5.2.2.2.2.2.cmml">S</mi><mtext id="alg2.14.14.m1.5.5.2.2.2.2.3" xref="alg2.14.14.m1.5.5.2.2.2.2.3a.cmml">prev</mtext></msub><mo id="alg2.14.14.m1.5.5.2.2.2.5" stretchy="false" xref="alg2.14.14.m1.5.5.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.14.14.m1.5b"><apply id="alg2.14.14.m1.5.5.cmml" xref="alg2.14.14.m1.5.5"><ci id="alg2.14.14.m1.5.5.3.cmml" xref="alg2.14.14.m1.5.5.3">←</ci><list id="alg2.14.14.m1.5.5.4.1.cmml" xref="alg2.14.14.m1.5.5.4.2"><ci id="alg2.14.14.m1.2.2.cmml" xref="alg2.14.14.m1.2.2">𝑃</ci><ci id="alg2.14.14.m1.3.3.cmml" xref="alg2.14.14.m1.3.3">𝑆</ci></list><apply id="alg2.14.14.m1.5.5.2.3.cmml" xref="alg2.14.14.m1.5.5.2.2"><ci id="alg2.14.14.m1.1.1.cmml" xref="alg2.14.14.m1.1.1">copy</ci><apply id="alg2.14.14.m1.4.4.1.1.1.1.cmml" xref="alg2.14.14.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="alg2.14.14.m1.4.4.1.1.1.1.1.cmml" xref="alg2.14.14.m1.4.4.1.1.1.1">subscript</csymbol><ci id="alg2.14.14.m1.4.4.1.1.1.1.2.cmml" xref="alg2.14.14.m1.4.4.1.1.1.1.2">𝑃</ci><ci id="alg2.14.14.m1.4.4.1.1.1.1.3a.cmml" xref="alg2.14.14.m1.4.4.1.1.1.1.3"><mtext id="alg2.14.14.m1.4.4.1.1.1.1.3.cmml" mathsize="70%" xref="alg2.14.14.m1.4.4.1.1.1.1.3">prev</mtext></ci></apply><apply id="alg2.14.14.m1.5.5.2.2.2.2.cmml" xref="alg2.14.14.m1.5.5.2.2.2.2"><csymbol cd="ambiguous" id="alg2.14.14.m1.5.5.2.2.2.2.1.cmml" xref="alg2.14.14.m1.5.5.2.2.2.2">subscript</csymbol><ci id="alg2.14.14.m1.5.5.2.2.2.2.2.cmml" xref="alg2.14.14.m1.5.5.2.2.2.2.2">𝑆</ci><ci id="alg2.14.14.m1.5.5.2.2.2.2.3a.cmml" xref="alg2.14.14.m1.5.5.2.2.2.2.3"><mtext id="alg2.14.14.m1.5.5.2.2.2.2.3.cmml" mathsize="70%" xref="alg2.14.14.m1.5.5.2.2.2.2.3">prev</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.14.14.m1.5c">P,S\leftarrow\operatorname{copy}(P_{\text{prev}},S_{\text{prev}})</annotation><annotation encoding="application/x-llamapun" id="alg2.14.14.m1.5d">italic_P , italic_S ← roman_copy ( italic_P start_POSTSUBSCRIPT prev end_POSTSUBSCRIPT , italic_S start_POSTSUBSCRIPT prev end_POSTSUBSCRIPT )</annotation></semantics></math>;
</div>
<div class="ltx_listingline" id="alg2.15.15">
<span class="ltx_tag ltx_tag_listingline">8</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="X\leftarrow\operatorname{BuildingBlockDatabase.retrieve}(\mathbf{x})" class="ltx_Math" display="inline" id="alg2.15.15.m1.3"><semantics id="alg2.15.15.m1.3a"><mrow id="alg2.15.15.m1.3.4" xref="alg2.15.15.m1.3.4.cmml"><mi id="alg2.15.15.m1.3.4.2" xref="alg2.15.15.m1.3.4.2.cmml">X</mi><mo id="alg2.15.15.m1.3.4.1" stretchy="false" xref="alg2.15.15.m1.3.4.1.cmml">←</mo><mrow id="alg2.15.15.m1.3.4.3.2" xref="alg2.15.15.m1.3.4.3.1.cmml"><mrow id="alg2.15.15.m1.2.2.4" xref="alg2.15.15.m1.2.2.3.cmml"><mi id="alg2.15.15.m1.1.1.1" xref="alg2.15.15.m1.1.1.1.cmml">BuildingBlockDatabase</mi><mo id="alg2.15.15.m1.2.2.4.1" lspace="0em" rspace="0.167em" xref="alg2.15.15.m1.2.2.3a.cmml">.</mo><mi id="alg2.15.15.m1.2.2.2" xref="alg2.15.15.m1.2.2.2.cmml">retrieve</mi></mrow><mo id="alg2.15.15.m1.3.4.3.2a" xref="alg2.15.15.m1.3.4.3.1.cmml">⁡</mo><mrow id="alg2.15.15.m1.3.4.3.2.1" xref="alg2.15.15.m1.3.4.3.1.cmml"><mo id="alg2.15.15.m1.3.4.3.2.1.1" stretchy="false" xref="alg2.15.15.m1.3.4.3.1.cmml">(</mo><mi id="alg2.15.15.m1.3.3" xref="alg2.15.15.m1.3.3.cmml">𝐱</mi><mo id="alg2.15.15.m1.3.4.3.2.1.2" stretchy="false" xref="alg2.15.15.m1.3.4.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.15.15.m1.3b"><apply id="alg2.15.15.m1.3.4.cmml" xref="alg2.15.15.m1.3.4"><ci id="alg2.15.15.m1.3.4.1.cmml" xref="alg2.15.15.m1.3.4.1">←</ci><ci id="alg2.15.15.m1.3.4.2.cmml" xref="alg2.15.15.m1.3.4.2">𝑋</ci><apply id="alg2.15.15.m1.3.4.3.1.cmml" xref="alg2.15.15.m1.3.4.3.2"><apply id="alg2.15.15.m1.2.2.3.cmml" xref="alg2.15.15.m1.2.2.4"><csymbol cd="ambiguous" id="alg2.15.15.m1.2.2.3a.cmml" xref="alg2.15.15.m1.2.2.4.1">formulae-sequence</csymbol><ci id="alg2.15.15.m1.1.1.1.cmml" xref="alg2.15.15.m1.1.1.1">BuildingBlockDatabase</ci><ci id="alg2.15.15.m1.2.2.2.cmml" xref="alg2.15.15.m1.2.2.2">retrieve</ci></apply><ci id="alg2.15.15.m1.3.3.cmml" xref="alg2.15.15.m1.3.3">𝐱</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.15.15.m1.3c">X\leftarrow\operatorname{BuildingBlockDatabase.retrieve}(\mathbf{x})</annotation><annotation encoding="application/x-llamapun" id="alg2.15.15.m1.3d">italic_X ← start_OPFUNCTION roman_BuildingBlockDatabase . roman_retrieve end_OPFUNCTION ( bold_x )</annotation></semantics></math>;
</div>
<div class="ltx_listingline" id="alg2.17.17">
<span class="ltx_tag ltx_tag_listingline">9</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span class="ltx_text ltx_font_typewriter" id="alg2.17.17.2">Push(<em class="ltx_emph ltx_font_serif ltx_font_italic" id="alg2.17.17.2.2"><math alttext="X" class="ltx_Math" display="inline" id="alg2.16.16.1.1.m1.1"><semantics id="alg2.16.16.1.1.m1.1a"><mi id="alg2.16.16.1.1.m1.1.1" xref="alg2.16.16.1.1.m1.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="alg2.16.16.1.1.m1.1b"><ci id="alg2.16.16.1.1.m1.1.1.cmml" xref="alg2.16.16.1.1.m1.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.16.16.1.1.m1.1c">X</annotation><annotation encoding="application/x-llamapun" id="alg2.16.16.1.1.m1.1d">italic_X</annotation></semantics></math> onto <math alttext="S" class="ltx_Math" display="inline" id="alg2.17.17.2.2.m2.1"><semantics id="alg2.17.17.2.2.m2.1a"><mi id="alg2.17.17.2.2.m2.1.1" xref="alg2.17.17.2.2.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="alg2.17.17.2.2.m2.1b"><ci id="alg2.17.17.2.2.m2.1.1.cmml" xref="alg2.17.17.2.2.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.17.17.2.2.m2.1c">S</annotation><annotation encoding="application/x-llamapun" id="alg2.17.17.2.2.m2.1d">italic_S</annotation></semantics></math></em>)</span>;
</div>
<div class="ltx_listingline" id="alg2.19.19">
<span class="ltx_tag ltx_tag_listingline">10</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span class="ltx_text ltx_font_typewriter" id="alg2.19.19.2">Append(<em class="ltx_emph ltx_font_serif ltx_font_italic" id="alg2.19.19.2.2"><math alttext="X" class="ltx_Math" display="inline" id="alg2.18.18.1.1.m1.1"><semantics id="alg2.18.18.1.1.m1.1a"><mi id="alg2.18.18.1.1.m1.1.1" xref="alg2.18.18.1.1.m1.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="alg2.18.18.1.1.m1.1b"><ci id="alg2.18.18.1.1.m1.1.1.cmml" xref="alg2.18.18.1.1.m1.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.18.18.1.1.m1.1c">X</annotation><annotation encoding="application/x-llamapun" id="alg2.18.18.1.1.m1.1d">italic_X</annotation></semantics></math> to <math alttext="P" class="ltx_Math" display="inline" id="alg2.19.19.2.2.m2.1"><semantics id="alg2.19.19.2.2.m2.1a"><mi id="alg2.19.19.2.2.m2.1.1" xref="alg2.19.19.2.2.m2.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="alg2.19.19.2.2.m2.1b"><ci id="alg2.19.19.2.2.m2.1.1.cmml" xref="alg2.19.19.2.2.m2.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.19.19.2.2.m2.1c">P</annotation><annotation encoding="application/x-llamapun" id="alg2.19.19.2.2.m2.1d">italic_P</annotation></semantics></math></em>)</span>;
</div>
<div class="ltx_listingline" id="alg2.21.21">
<span class="ltx_tag ltx_tag_listingline">11</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span class="ltx_text ltx_font_typewriter" id="alg2.21.21.2">Yield(<em class="ltx_emph ltx_font_serif ltx_font_italic" id="alg2.21.21.2.2"><math alttext="P" class="ltx_Math" display="inline" id="alg2.20.20.1.1.m1.1"><semantics id="alg2.20.20.1.1.m1.1a"><mi id="alg2.20.20.1.1.m1.1.1" xref="alg2.20.20.1.1.m1.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="alg2.20.20.1.1.m1.1b"><ci id="alg2.20.20.1.1.m1.1.1.cmml" xref="alg2.20.20.1.1.m1.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.20.20.1.1.m1.1c">P</annotation><annotation encoding="application/x-llamapun" id="alg2.20.20.1.1.m1.1d">italic_P</annotation></semantics></math>, <math alttext="S" class="ltx_Math" display="inline" id="alg2.21.21.2.2.m2.1"><semantics id="alg2.21.21.2.2.m2.1a"><mi id="alg2.21.21.2.2.m2.1.1" xref="alg2.21.21.2.2.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="alg2.21.21.2.2.m2.1b"><ci id="alg2.21.21.2.2.m2.1.1.cmml" xref="alg2.21.21.2.2.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.21.21.2.2.m2.1c">S</annotation><annotation encoding="application/x-llamapun" id="alg2.21.21.2.2.m2.1d">italic_S</annotation></semantics></math></em>)</span>;
</div>
<div class="ltx_listingline" id="alg2.41.48">
<span class="ltx_tag ltx_tag_listingline">12</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div class="ltx_listingline" id="alg2.41.49">
<span class="ltx_tag ltx_tag_listingline">13</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div class="ltx_listingline" id="alg2.22.22">
<span class="ltx_tag ltx_tag_listingline">14</span><span class="ltx_text ltx_font_bold" id="alg2.22.22.2">else if</span> <em class="ltx_emph ltx_font_italic" id="alg2.22.22.1"><math alttext="t=\text{Reaction}" class="ltx_Math" display="inline" id="alg2.22.22.1.m1.1"><semantics id="alg2.22.22.1.m1.1a"><mrow id="alg2.22.22.1.m1.1.1" xref="alg2.22.22.1.m1.1.1.cmml"><mi id="alg2.22.22.1.m1.1.1.2" xref="alg2.22.22.1.m1.1.1.2.cmml">t</mi><mo id="alg2.22.22.1.m1.1.1.1" xref="alg2.22.22.1.m1.1.1.1.cmml">=</mo><mtext class="ltx_mathvariant_italic" id="alg2.22.22.1.m1.1.1.3" xref="alg2.22.22.1.m1.1.1.3a.cmml">Reaction</mtext></mrow><annotation-xml encoding="MathML-Content" id="alg2.22.22.1.m1.1b"><apply id="alg2.22.22.1.m1.1.1.cmml" xref="alg2.22.22.1.m1.1.1"><eq id="alg2.22.22.1.m1.1.1.1.cmml" xref="alg2.22.22.1.m1.1.1.1"></eq><ci id="alg2.22.22.1.m1.1.1.2.cmml" xref="alg2.22.22.1.m1.1.1.2">𝑡</ci><ci id="alg2.22.22.1.m1.1.1.3a.cmml" xref="alg2.22.22.1.m1.1.1.3"><mtext class="ltx_mathvariant_italic" id="alg2.22.22.1.m1.1.1.3.cmml" xref="alg2.22.22.1.m1.1.1.3">Reaction</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.22.22.1.m1.1c">t=\text{Reaction}</annotation><annotation encoding="application/x-llamapun" id="alg2.22.22.1.m1.1d">italic_t = Reaction</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="alg2.22.22.3">then</span>
</div>
<div class="ltx_listingline" id="alg2.25.25">
<span class="ltx_tag ltx_tag_listingline">15</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span class="ltx_text ltx_font_bold" id="alg2.25.25.4">foreach</span> <em class="ltx_emph ltx_font_italic" id="alg2.25.25.3"><math alttext="R" class="ltx_Math" display="inline" id="alg2.23.23.1.m1.1"><semantics id="alg2.23.23.1.m1.1a"><mi id="alg2.23.23.1.m1.1.1" xref="alg2.23.23.1.m1.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="alg2.23.23.1.m1.1b"><ci id="alg2.23.23.1.m1.1.1.cmml" xref="alg2.23.23.1.m1.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.23.23.1.m1.1c">R</annotation><annotation encoding="application/x-llamapun" id="alg2.23.23.1.m1.1d">italic_R</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg2.25.25.3.1">in</span> top <math alttext="k_{\text{reaction}}" class="ltx_Math" display="inline" id="alg2.24.24.2.m2.1"><semantics id="alg2.24.24.2.m2.1a"><msub id="alg2.24.24.2.m2.1.1" xref="alg2.24.24.2.m2.1.1.cmml"><mi id="alg2.24.24.2.m2.1.1.2" xref="alg2.24.24.2.m2.1.1.2.cmml">k</mi><mtext class="ltx_mathvariant_italic" id="alg2.24.24.2.m2.1.1.3" xref="alg2.24.24.2.m2.1.1.3b.cmml"><em class="ltx_emph" id="alg2.24.24.2.m2.1.1.3.1nest" style="font-size:70%;">reaction</em></mtext></msub><annotation-xml encoding="MathML-Content" id="alg2.24.24.2.m2.1b"><apply id="alg2.24.24.2.m2.1.1.cmml" xref="alg2.24.24.2.m2.1.1"><csymbol cd="ambiguous" id="alg2.24.24.2.m2.1.1.1.cmml" xref="alg2.24.24.2.m2.1.1">subscript</csymbol><ci id="alg2.24.24.2.m2.1.1.2.cmml" xref="alg2.24.24.2.m2.1.1.2">𝑘</ci><ci id="alg2.24.24.2.m2.1.1.3b.cmml" xref="alg2.24.24.2.m2.1.1.3"><mtext class="ltx_mathvariant_italic" id="alg2.24.24.2.m2.1.1.3.cmml" mathsize="70%" xref="alg2.24.24.2.m2.1.1.3"><em class="ltx_emph" id="alg2.24.24.2.m2.1.1.3.1anest" style="font-size:70%;">reaction</em></mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.24.24.2.m2.1c">k_{\text{reaction}}</annotation><annotation encoding="application/x-llamapun" id="alg2.24.24.2.m2.1d">italic_k start_POSTSUBSCRIPT reaction end_POSTSUBSCRIPT</annotation></semantics></math> of <math alttext="\operatorname{SynFormer.predictNextReaction}(\mathbf{h})" class="ltx_Math" display="inline" id="alg2.25.25.3.m3.3"><semantics id="alg2.25.25.3.m3.3a"><mrow id="alg2.25.25.3.m3.3.4.2" xref="alg2.25.25.3.m3.3.4.1.cmml"><mrow id="alg2.25.25.3.m3.2.2.4" xref="alg2.25.25.3.m3.2.2.3.cmml"><mi id="alg2.25.25.3.m3.1.1.1" xref="alg2.25.25.3.m3.1.1.1.cmml">SynFormer</mi><mo id="alg2.25.25.3.m3.2.2.4.1" lspace="0em" rspace="0.167em" xref="alg2.25.25.3.m3.2.2.3a.cmml">.</mo><mi id="alg2.25.25.3.m3.2.2.2" xref="alg2.25.25.3.m3.2.2.2.cmml">predictNextReaction</mi></mrow><mo id="alg2.25.25.3.m3.3.4.2a" xref="alg2.25.25.3.m3.3.4.1.cmml">⁡</mo><mrow id="alg2.25.25.3.m3.3.4.2.1" xref="alg2.25.25.3.m3.3.4.1.cmml"><mo id="alg2.25.25.3.m3.3.4.2.1.1" stretchy="false" xref="alg2.25.25.3.m3.3.4.1.cmml">(</mo><mi id="alg2.25.25.3.m3.3.3" xref="alg2.25.25.3.m3.3.3.cmml">𝐡</mi><mo id="alg2.25.25.3.m3.3.4.2.1.2" stretchy="false" xref="alg2.25.25.3.m3.3.4.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.25.25.3.m3.3b"><apply id="alg2.25.25.3.m3.3.4.1.cmml" xref="alg2.25.25.3.m3.3.4.2"><apply id="alg2.25.25.3.m3.2.2.3.cmml" xref="alg2.25.25.3.m3.2.2.4"><csymbol cd="ambiguous" id="alg2.25.25.3.m3.2.2.3a.cmml" xref="alg2.25.25.3.m3.2.2.4.1">formulae-sequence</csymbol><ci id="alg2.25.25.3.m3.1.1.1.cmml" xref="alg2.25.25.3.m3.1.1.1">SynFormer</ci><ci id="alg2.25.25.3.m3.2.2.2.cmml" xref="alg2.25.25.3.m3.2.2.2">predictNextReaction</ci></apply><ci id="alg2.25.25.3.m3.3.3.cmml" xref="alg2.25.25.3.m3.3.3">𝐡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.25.25.3.m3.3c">\operatorname{SynFormer.predictNextReaction}(\mathbf{h})</annotation><annotation encoding="application/x-llamapun" id="alg2.25.25.3.m3.3d">start_OPFUNCTION roman_SynFormer . roman_predictNextReaction end_OPFUNCTION ( bold_h )</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="alg2.25.25.5">do</span>
</div>
<div class="ltx_listingline" id="alg2.26.26">
<span class="ltx_tag ltx_tag_listingline">16</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="P,S\leftarrow\operatorname{copy}(P_{\text{prev}},S_{\text{prev}})" class="ltx_Math" display="inline" id="alg2.26.26.m1.5"><semantics id="alg2.26.26.m1.5a"><mrow id="alg2.26.26.m1.5.5" xref="alg2.26.26.m1.5.5.cmml"><mrow id="alg2.26.26.m1.5.5.4.2" xref="alg2.26.26.m1.5.5.4.1.cmml"><mi id="alg2.26.26.m1.2.2" xref="alg2.26.26.m1.2.2.cmml">P</mi><mo id="alg2.26.26.m1.5.5.4.2.1" xref="alg2.26.26.m1.5.5.4.1.cmml">,</mo><mi id="alg2.26.26.m1.3.3" xref="alg2.26.26.m1.3.3.cmml">S</mi></mrow><mo id="alg2.26.26.m1.5.5.3" stretchy="false" xref="alg2.26.26.m1.5.5.3.cmml">←</mo><mrow id="alg2.26.26.m1.5.5.2.2" xref="alg2.26.26.m1.5.5.2.3.cmml"><mi id="alg2.26.26.m1.1.1" xref="alg2.26.26.m1.1.1.cmml">copy</mi><mo id="alg2.26.26.m1.5.5.2.2a" xref="alg2.26.26.m1.5.5.2.3.cmml">⁡</mo><mrow id="alg2.26.26.m1.5.5.2.2.2" xref="alg2.26.26.m1.5.5.2.3.cmml"><mo id="alg2.26.26.m1.5.5.2.2.2.3" stretchy="false" xref="alg2.26.26.m1.5.5.2.3.cmml">(</mo><msub id="alg2.26.26.m1.4.4.1.1.1.1" xref="alg2.26.26.m1.4.4.1.1.1.1.cmml"><mi id="alg2.26.26.m1.4.4.1.1.1.1.2" xref="alg2.26.26.m1.4.4.1.1.1.1.2.cmml">P</mi><mtext id="alg2.26.26.m1.4.4.1.1.1.1.3" xref="alg2.26.26.m1.4.4.1.1.1.1.3a.cmml">prev</mtext></msub><mo id="alg2.26.26.m1.5.5.2.2.2.4" xref="alg2.26.26.m1.5.5.2.3.cmml">,</mo><msub id="alg2.26.26.m1.5.5.2.2.2.2" xref="alg2.26.26.m1.5.5.2.2.2.2.cmml"><mi id="alg2.26.26.m1.5.5.2.2.2.2.2" xref="alg2.26.26.m1.5.5.2.2.2.2.2.cmml">S</mi><mtext id="alg2.26.26.m1.5.5.2.2.2.2.3" xref="alg2.26.26.m1.5.5.2.2.2.2.3a.cmml">prev</mtext></msub><mo id="alg2.26.26.m1.5.5.2.2.2.5" stretchy="false" xref="alg2.26.26.m1.5.5.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.26.26.m1.5b"><apply id="alg2.26.26.m1.5.5.cmml" xref="alg2.26.26.m1.5.5"><ci id="alg2.26.26.m1.5.5.3.cmml" xref="alg2.26.26.m1.5.5.3">←</ci><list id="alg2.26.26.m1.5.5.4.1.cmml" xref="alg2.26.26.m1.5.5.4.2"><ci id="alg2.26.26.m1.2.2.cmml" xref="alg2.26.26.m1.2.2">𝑃</ci><ci id="alg2.26.26.m1.3.3.cmml" xref="alg2.26.26.m1.3.3">𝑆</ci></list><apply id="alg2.26.26.m1.5.5.2.3.cmml" xref="alg2.26.26.m1.5.5.2.2"><ci id="alg2.26.26.m1.1.1.cmml" xref="alg2.26.26.m1.1.1">copy</ci><apply id="alg2.26.26.m1.4.4.1.1.1.1.cmml" xref="alg2.26.26.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="alg2.26.26.m1.4.4.1.1.1.1.1.cmml" xref="alg2.26.26.m1.4.4.1.1.1.1">subscript</csymbol><ci id="alg2.26.26.m1.4.4.1.1.1.1.2.cmml" xref="alg2.26.26.m1.4.4.1.1.1.1.2">𝑃</ci><ci id="alg2.26.26.m1.4.4.1.1.1.1.3a.cmml" xref="alg2.26.26.m1.4.4.1.1.1.1.3"><mtext id="alg2.26.26.m1.4.4.1.1.1.1.3.cmml" mathsize="70%" xref="alg2.26.26.m1.4.4.1.1.1.1.3">prev</mtext></ci></apply><apply id="alg2.26.26.m1.5.5.2.2.2.2.cmml" xref="alg2.26.26.m1.5.5.2.2.2.2"><csymbol cd="ambiguous" id="alg2.26.26.m1.5.5.2.2.2.2.1.cmml" xref="alg2.26.26.m1.5.5.2.2.2.2">subscript</csymbol><ci id="alg2.26.26.m1.5.5.2.2.2.2.2.cmml" xref="alg2.26.26.m1.5.5.2.2.2.2.2">𝑆</ci><ci id="alg2.26.26.m1.5.5.2.2.2.2.3a.cmml" xref="alg2.26.26.m1.5.5.2.2.2.2.3"><mtext id="alg2.26.26.m1.5.5.2.2.2.2.3.cmml" mathsize="70%" xref="alg2.26.26.m1.5.5.2.2.2.2.3">prev</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.26.26.m1.5c">P,S\leftarrow\operatorname{copy}(P_{\text{prev}},S_{\text{prev}})</annotation><annotation encoding="application/x-llamapun" id="alg2.26.26.m1.5d">italic_P , italic_S ← roman_copy ( italic_P start_POSTSUBSCRIPT prev end_POSTSUBSCRIPT , italic_S start_POSTSUBSCRIPT prev end_POSTSUBSCRIPT )</annotation></semantics></math>;
</div>
<div class="ltx_listingline" id="alg2.29.29">
<span class="ltx_tag ltx_tag_listingline">17</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="\{X_{i}\}\leftarrow" class="ltx_Math" display="inline" id="alg2.27.27.m1.1"><semantics id="alg2.27.27.m1.1a"><mrow id="alg2.27.27.m1.1.1" xref="alg2.27.27.m1.1.1.cmml"><mrow id="alg2.27.27.m1.1.1.1.1" xref="alg2.27.27.m1.1.1.1.2.cmml"><mo id="alg2.27.27.m1.1.1.1.1.2" stretchy="false" xref="alg2.27.27.m1.1.1.1.2.cmml">{</mo><msub id="alg2.27.27.m1.1.1.1.1.1" xref="alg2.27.27.m1.1.1.1.1.1.cmml"><mi id="alg2.27.27.m1.1.1.1.1.1.2" xref="alg2.27.27.m1.1.1.1.1.1.2.cmml">X</mi><mi id="alg2.27.27.m1.1.1.1.1.1.3" xref="alg2.27.27.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg2.27.27.m1.1.1.1.1.3" stretchy="false" xref="alg2.27.27.m1.1.1.1.2.cmml">}</mo></mrow><mo id="alg2.27.27.m1.1.1.2" stretchy="false" xref="alg2.27.27.m1.1.1.2.cmml">←</mo><mi id="alg2.27.27.m1.1.1.3" xref="alg2.27.27.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.27.27.m1.1b"><apply id="alg2.27.27.m1.1.1.cmml" xref="alg2.27.27.m1.1.1"><ci id="alg2.27.27.m1.1.1.2.cmml" xref="alg2.27.27.m1.1.1.2">←</ci><set id="alg2.27.27.m1.1.1.1.2.cmml" xref="alg2.27.27.m1.1.1.1.1"><apply id="alg2.27.27.m1.1.1.1.1.1.cmml" xref="alg2.27.27.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.27.27.m1.1.1.1.1.1.1.cmml" xref="alg2.27.27.m1.1.1.1.1.1">subscript</csymbol><ci id="alg2.27.27.m1.1.1.1.1.1.2.cmml" xref="alg2.27.27.m1.1.1.1.1.1.2">𝑋</ci><ci id="alg2.27.27.m1.1.1.1.1.1.3.cmml" xref="alg2.27.27.m1.1.1.1.1.1.3">𝑖</ci></apply></set><csymbol cd="latexml" id="alg2.27.27.m1.1.1.3.cmml" xref="alg2.27.27.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.27.27.m1.1c">\{X_{i}\}\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg2.27.27.m1.1d">{ italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } ←</annotation></semantics></math> <span class="ltx_text ltx_font_typewriter" id="alg2.29.29.2">Pop(<em class="ltx_emph ltx_font_serif ltx_font_italic" id="alg2.29.29.2.2"><math alttext="R.\operatorname{numReactants}" class="ltx_Math" display="inline" id="alg2.28.28.1.1.m1.2"><semantics id="alg2.28.28.1.1.m1.2a"><mrow id="alg2.28.28.1.1.m1.2.3.2" xref="alg2.28.28.1.1.m1.2.3.1.cmml"><mi id="alg2.28.28.1.1.m1.1.1" xref="alg2.28.28.1.1.m1.1.1.cmml">R</mi><mo id="alg2.28.28.1.1.m1.2.3.2.1" lspace="0em" rspace="0.167em" xref="alg2.28.28.1.1.m1.2.3.1a.cmml">.</mo><mi id="alg2.28.28.1.1.m1.2.2" xref="alg2.28.28.1.1.m1.2.2.cmml">numReactants</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.28.28.1.1.m1.2b"><apply id="alg2.28.28.1.1.m1.2.3.1.cmml" xref="alg2.28.28.1.1.m1.2.3.2"><csymbol cd="ambiguous" id="alg2.28.28.1.1.m1.2.3.1a.cmml" xref="alg2.28.28.1.1.m1.2.3.2.1">formulae-sequence</csymbol><ci id="alg2.28.28.1.1.m1.1.1.cmml" xref="alg2.28.28.1.1.m1.1.1">𝑅</ci><ci id="alg2.28.28.1.1.m1.2.2.cmml" xref="alg2.28.28.1.1.m1.2.2">numReactants</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.28.28.1.1.m1.2c">R.\operatorname{numReactants}</annotation><annotation encoding="application/x-llamapun" id="alg2.28.28.1.1.m1.2d">italic_R . roman_numReactants</annotation></semantics></math> elements from <math alttext="S" class="ltx_Math" display="inline" id="alg2.29.29.2.2.m2.1"><semantics id="alg2.29.29.2.2.m2.1a"><mi id="alg2.29.29.2.2.m2.1.1" xref="alg2.29.29.2.2.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="alg2.29.29.2.2.m2.1b"><ci id="alg2.29.29.2.2.m2.1.1.cmml" xref="alg2.29.29.2.2.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.29.29.2.2.m2.1c">S</annotation><annotation encoding="application/x-llamapun" id="alg2.29.29.2.2.m2.1d">italic_S</annotation></semantics></math></em>)</span>;
</div>
<div class="ltx_listingline" id="alg2.31.31">
<span class="ltx_tag ltx_tag_listingline">18</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="Y\leftarrow" class="ltx_Math" display="inline" id="alg2.30.30.m1.1"><semantics id="alg2.30.30.m1.1a"><mrow id="alg2.30.30.m1.1.1" xref="alg2.30.30.m1.1.1.cmml"><mi id="alg2.30.30.m1.1.1.2" xref="alg2.30.30.m1.1.1.2.cmml">Y</mi><mo id="alg2.30.30.m1.1.1.1" stretchy="false" xref="alg2.30.30.m1.1.1.1.cmml">←</mo><mi id="alg2.30.30.m1.1.1.3" xref="alg2.30.30.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.30.30.m1.1b"><apply id="alg2.30.30.m1.1.1.cmml" xref="alg2.30.30.m1.1.1"><ci id="alg2.30.30.m1.1.1.1.cmml" xref="alg2.30.30.m1.1.1.1">←</ci><ci id="alg2.30.30.m1.1.1.2.cmml" xref="alg2.30.30.m1.1.1.2">𝑌</ci><csymbol cd="latexml" id="alg2.30.30.m1.1.1.3.cmml" xref="alg2.30.30.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.30.30.m1.1c">Y\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg2.30.30.m1.1d">italic_Y ←</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg2.31.31.1">Call</span> <math alttext="R(\{X_{i}\})" class="ltx_Math" display="inline" id="alg2.31.31.m2.1"><semantics id="alg2.31.31.m2.1a"><mrow id="alg2.31.31.m2.1.1" xref="alg2.31.31.m2.1.1.cmml"><mi id="alg2.31.31.m2.1.1.3" xref="alg2.31.31.m2.1.1.3.cmml">R</mi><mo id="alg2.31.31.m2.1.1.2" xref="alg2.31.31.m2.1.1.2.cmml">⁢</mo><mrow id="alg2.31.31.m2.1.1.1.1" xref="alg2.31.31.m2.1.1.cmml"><mo id="alg2.31.31.m2.1.1.1.1.2" stretchy="false" xref="alg2.31.31.m2.1.1.cmml">(</mo><mrow id="alg2.31.31.m2.1.1.1.1.1.1" xref="alg2.31.31.m2.1.1.1.1.1.2.cmml"><mo id="alg2.31.31.m2.1.1.1.1.1.1.2" stretchy="false" xref="alg2.31.31.m2.1.1.1.1.1.2.cmml">{</mo><msub id="alg2.31.31.m2.1.1.1.1.1.1.1" xref="alg2.31.31.m2.1.1.1.1.1.1.1.cmml"><mi id="alg2.31.31.m2.1.1.1.1.1.1.1.2" xref="alg2.31.31.m2.1.1.1.1.1.1.1.2.cmml">X</mi><mi id="alg2.31.31.m2.1.1.1.1.1.1.1.3" xref="alg2.31.31.m2.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg2.31.31.m2.1.1.1.1.1.1.3" stretchy="false" xref="alg2.31.31.m2.1.1.1.1.1.2.cmml">}</mo></mrow><mo id="alg2.31.31.m2.1.1.1.1.3" stretchy="false" xref="alg2.31.31.m2.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.31.31.m2.1b"><apply id="alg2.31.31.m2.1.1.cmml" xref="alg2.31.31.m2.1.1"><times id="alg2.31.31.m2.1.1.2.cmml" xref="alg2.31.31.m2.1.1.2"></times><ci id="alg2.31.31.m2.1.1.3.cmml" xref="alg2.31.31.m2.1.1.3">𝑅</ci><set id="alg2.31.31.m2.1.1.1.1.1.2.cmml" xref="alg2.31.31.m2.1.1.1.1.1.1"><apply id="alg2.31.31.m2.1.1.1.1.1.1.1.cmml" xref="alg2.31.31.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.31.31.m2.1.1.1.1.1.1.1.1.cmml" xref="alg2.31.31.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.31.31.m2.1.1.1.1.1.1.1.2.cmml" xref="alg2.31.31.m2.1.1.1.1.1.1.1.2">𝑋</ci><ci id="alg2.31.31.m2.1.1.1.1.1.1.1.3.cmml" xref="alg2.31.31.m2.1.1.1.1.1.1.1.3">𝑖</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.31.31.m2.1c">R(\{X_{i}\})</annotation><annotation encoding="application/x-llamapun" id="alg2.31.31.m2.1d">italic_R ( { italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } )</annotation></semantics></math>;
</div>
<div class="ltx_listingline" id="alg2.41.50">
<span class="ltx_tag ltx_tag_listingline">19</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span class="ltx_text ltx_font_bold" id="alg2.41.50.1">if</span> <em class="ltx_emph ltx_font_italic" id="alg2.41.50.2">there are sufficient reactants in the stack and the reaction applied successfully</em> <span class="ltx_text ltx_font_bold" id="alg2.41.50.3">then</span>
</div>
<div class="ltx_listingline" id="alg2.33.33">
<span class="ltx_tag ltx_tag_listingline">20</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span class="ltx_text ltx_font_typewriter" id="alg2.33.33.2">Push(<em class="ltx_emph ltx_font_serif ltx_font_italic" id="alg2.33.33.2.2"><math alttext="Y" class="ltx_Math" display="inline" id="alg2.32.32.1.1.m1.1"><semantics id="alg2.32.32.1.1.m1.1a"><mi id="alg2.32.32.1.1.m1.1.1" xref="alg2.32.32.1.1.m1.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="alg2.32.32.1.1.m1.1b"><ci id="alg2.32.32.1.1.m1.1.1.cmml" xref="alg2.32.32.1.1.m1.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.32.32.1.1.m1.1c">Y</annotation><annotation encoding="application/x-llamapun" id="alg2.32.32.1.1.m1.1d">italic_Y</annotation></semantics></math> onto <math alttext="S" class="ltx_Math" display="inline" id="alg2.33.33.2.2.m2.1"><semantics id="alg2.33.33.2.2.m2.1a"><mi id="alg2.33.33.2.2.m2.1.1" xref="alg2.33.33.2.2.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="alg2.33.33.2.2.m2.1b"><ci id="alg2.33.33.2.2.m2.1.1.cmml" xref="alg2.33.33.2.2.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.33.33.2.2.m2.1c">S</annotation><annotation encoding="application/x-llamapun" id="alg2.33.33.2.2.m2.1d">italic_S</annotation></semantics></math></em>)</span>;
</div>
<div class="ltx_listingline" id="alg2.35.35">
<span class="ltx_tag ltx_tag_listingline">21</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span class="ltx_text ltx_font_typewriter" id="alg2.35.35.2">Append(<em class="ltx_emph ltx_font_serif ltx_font_italic" id="alg2.35.35.2.2"><math alttext="R" class="ltx_Math" display="inline" id="alg2.34.34.1.1.m1.1"><semantics id="alg2.34.34.1.1.m1.1a"><mi id="alg2.34.34.1.1.m1.1.1" xref="alg2.34.34.1.1.m1.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="alg2.34.34.1.1.m1.1b"><ci id="alg2.34.34.1.1.m1.1.1.cmml" xref="alg2.34.34.1.1.m1.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.34.34.1.1.m1.1c">R</annotation><annotation encoding="application/x-llamapun" id="alg2.34.34.1.1.m1.1d">italic_R</annotation></semantics></math> to <math alttext="P" class="ltx_Math" display="inline" id="alg2.35.35.2.2.m2.1"><semantics id="alg2.35.35.2.2.m2.1a"><mi id="alg2.35.35.2.2.m2.1.1" xref="alg2.35.35.2.2.m2.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="alg2.35.35.2.2.m2.1b"><ci id="alg2.35.35.2.2.m2.1.1.cmml" xref="alg2.35.35.2.2.m2.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.35.35.2.2.m2.1c">P</annotation><annotation encoding="application/x-llamapun" id="alg2.35.35.2.2.m2.1d">italic_P</annotation></semantics></math></em>)</span>;
</div>
<div class="ltx_listingline" id="alg2.37.37">
<span class="ltx_tag ltx_tag_listingline">22</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span class="ltx_text ltx_font_typewriter" id="alg2.37.37.2">Yield(<em class="ltx_emph ltx_font_serif ltx_font_italic" id="alg2.37.37.2.2"><math alttext="P" class="ltx_Math" display="inline" id="alg2.36.36.1.1.m1.1"><semantics id="alg2.36.36.1.1.m1.1a"><mi id="alg2.36.36.1.1.m1.1.1" xref="alg2.36.36.1.1.m1.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="alg2.36.36.1.1.m1.1b"><ci id="alg2.36.36.1.1.m1.1.1.cmml" xref="alg2.36.36.1.1.m1.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.36.36.1.1.m1.1c">P</annotation><annotation encoding="application/x-llamapun" id="alg2.36.36.1.1.m1.1d">italic_P</annotation></semantics></math>, <math alttext="S" class="ltx_Math" display="inline" id="alg2.37.37.2.2.m2.1"><semantics id="alg2.37.37.2.2.m2.1a"><mi id="alg2.37.37.2.2.m2.1.1" xref="alg2.37.37.2.2.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="alg2.37.37.2.2.m2.1b"><ci id="alg2.37.37.2.2.m2.1.1.cmml" xref="alg2.37.37.2.2.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.37.37.2.2.m2.1c">S</annotation><annotation encoding="application/x-llamapun" id="alg2.37.37.2.2.m2.1d">italic_S</annotation></semantics></math></em>)</span>;
</div>
<div class="ltx_listingline" id="alg2.41.51">
<span class="ltx_tag ltx_tag_listingline">23</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div class="ltx_listingline" id="alg2.41.52">
<span class="ltx_tag ltx_tag_listingline">24</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div class="ltx_listingline" id="alg2.41.53">
<span class="ltx_tag ltx_tag_listingline">25</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div class="ltx_listingline" id="alg2.38.38">
<span class="ltx_tag ltx_tag_listingline">26</span><span class="ltx_text ltx_font_bold" id="alg2.38.38.2">else if</span> <em class="ltx_emph ltx_font_italic" id="alg2.38.38.1"><math alttext="t=\text{[END]}" class="ltx_Math" display="inline" id="alg2.38.38.1.m1.1"><semantics id="alg2.38.38.1.m1.1a"><mrow id="alg2.38.38.1.m1.1.1" xref="alg2.38.38.1.m1.1.1.cmml"><mi id="alg2.38.38.1.m1.1.1.2" xref="alg2.38.38.1.m1.1.1.2.cmml">t</mi><mo id="alg2.38.38.1.m1.1.1.1" xref="alg2.38.38.1.m1.1.1.1.cmml">=</mo><mtext class="ltx_mathvariant_italic" id="alg2.38.38.1.m1.1.1.3" xref="alg2.38.38.1.m1.1.1.3a.cmml">[END]</mtext></mrow><annotation-xml encoding="MathML-Content" id="alg2.38.38.1.m1.1b"><apply id="alg2.38.38.1.m1.1.1.cmml" xref="alg2.38.38.1.m1.1.1"><eq id="alg2.38.38.1.m1.1.1.1.cmml" xref="alg2.38.38.1.m1.1.1.1"></eq><ci id="alg2.38.38.1.m1.1.1.2.cmml" xref="alg2.38.38.1.m1.1.1.2">𝑡</ci><ci id="alg2.38.38.1.m1.1.1.3a.cmml" xref="alg2.38.38.1.m1.1.1.3"><mtext class="ltx_mathvariant_italic" id="alg2.38.38.1.m1.1.1.3.cmml" xref="alg2.38.38.1.m1.1.1.3">[END]</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.38.38.1.m1.1c">t=\text{[END]}</annotation><annotation encoding="application/x-llamapun" id="alg2.38.38.1.m1.1d">italic_t = [END]</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="alg2.38.38.3">then</span>
</div>
<div class="ltx_listingline" id="alg2.39.39">
<span class="ltx_tag ltx_tag_listingline">27</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span class="ltx_text ltx_font_bold" id="alg2.39.39.2">if</span> <em class="ltx_emph ltx_font_italic" id="alg2.39.39.1"><math alttext="S_{\text{prev}}.\operatorname{length}()=1" class="ltx_Math" display="inline" id="alg2.39.39.1.m1.2"><semantics id="alg2.39.39.1.m1.2a"><mrow id="alg2.39.39.1.m1.2.2.2" xref="alg2.39.39.1.m1.2.2.3.cmml"><msub id="alg2.39.39.1.m1.1.1.1.1" xref="alg2.39.39.1.m1.1.1.1.1.cmml"><mi id="alg2.39.39.1.m1.1.1.1.1.2" xref="alg2.39.39.1.m1.1.1.1.1.2.cmml">S</mi><mtext class="ltx_mathvariant_italic" id="alg2.39.39.1.m1.1.1.1.1.3" xref="alg2.39.39.1.m1.1.1.1.1.3b.cmml"><em class="ltx_emph" id="alg2.39.39.1.m1.1.1.1.1.3.1nest" style="font-size:70%;">prev</em></mtext></msub><mo id="alg2.39.39.1.m1.2.2.2.3" lspace="0em" rspace="0.167em" xref="alg2.39.39.1.m1.2.2.3a.cmml">.</mo><mrow id="alg2.39.39.1.m1.2.2.2.2" xref="alg2.39.39.1.m1.2.2.2.2.cmml"><mrow id="alg2.39.39.1.m1.2.2.2.2.2" xref="alg2.39.39.1.m1.2.2.2.2.2.cmml"><mi id="alg2.39.39.1.m1.2.2.2.2.2.2" xref="alg2.39.39.1.m1.2.2.2.2.2.2.cmml">length</mi><mo id="alg2.39.39.1.m1.2.2.2.2.2.1" xref="alg2.39.39.1.m1.2.2.2.2.2.1.cmml">⁢</mo><mrow id="alg2.39.39.1.m1.2.2.2.2.2.3.2" xref="alg2.39.39.1.m1.2.2.2.2.2.cmml"><mo id="alg2.39.39.1.m1.2.2.2.2.2.3.2.1" stretchy="false" xref="alg2.39.39.1.m1.2.2.2.2.2.3.1.cmml">(</mo><mo id="alg2.39.39.1.m1.2.2.2.2.2.3.2.2" stretchy="false" xref="alg2.39.39.1.m1.2.2.2.2.2.3.1.cmml">)</mo></mrow></mrow><mo id="alg2.39.39.1.m1.2.2.2.2.1" xref="alg2.39.39.1.m1.2.2.2.2.1.cmml">=</mo><mn id="alg2.39.39.1.m1.2.2.2.2.3" xref="alg2.39.39.1.m1.2.2.2.2.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.39.39.1.m1.2b"><apply id="alg2.39.39.1.m1.2.2.3.cmml" xref="alg2.39.39.1.m1.2.2.2"><csymbol cd="ambiguous" id="alg2.39.39.1.m1.2.2.3a.cmml" xref="alg2.39.39.1.m1.2.2.2.3">formulae-sequence</csymbol><apply id="alg2.39.39.1.m1.1.1.1.1.cmml" xref="alg2.39.39.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.39.39.1.m1.1.1.1.1.1.cmml" xref="alg2.39.39.1.m1.1.1.1.1">subscript</csymbol><ci id="alg2.39.39.1.m1.1.1.1.1.2.cmml" xref="alg2.39.39.1.m1.1.1.1.1.2">𝑆</ci><ci id="alg2.39.39.1.m1.1.1.1.1.3b.cmml" xref="alg2.39.39.1.m1.1.1.1.1.3"><mtext class="ltx_mathvariant_italic" id="alg2.39.39.1.m1.1.1.1.1.3.cmml" mathsize="70%" xref="alg2.39.39.1.m1.1.1.1.1.3"><em class="ltx_emph" id="alg2.39.39.1.m1.1.1.1.1.3.1anest" style="font-size:70%;">prev</em></mtext></ci></apply><apply id="alg2.39.39.1.m1.2.2.2.2.cmml" xref="alg2.39.39.1.m1.2.2.2.2"><eq id="alg2.39.39.1.m1.2.2.2.2.1.cmml" xref="alg2.39.39.1.m1.2.2.2.2.1"></eq><apply id="alg2.39.39.1.m1.2.2.2.2.2.cmml" xref="alg2.39.39.1.m1.2.2.2.2.2"><times id="alg2.39.39.1.m1.2.2.2.2.2.1.cmml" xref="alg2.39.39.1.m1.2.2.2.2.2.1"></times><ci id="alg2.39.39.1.m1.2.2.2.2.2.2.cmml" xref="alg2.39.39.1.m1.2.2.2.2.2.2">length</ci><list id="alg2.39.39.1.m1.2.2.2.2.2.3.1.cmml" xref="alg2.39.39.1.m1.2.2.2.2.2.3.2.1"></list></apply><cn id="alg2.39.39.1.m1.2.2.2.2.3.cmml" type="integer" xref="alg2.39.39.1.m1.2.2.2.2.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.39.39.1.m1.2c">S_{\text{prev}}.\operatorname{length}()=1</annotation><annotation encoding="application/x-llamapun" id="alg2.39.39.1.m1.2d">italic_S start_POSTSUBSCRIPT prev end_POSTSUBSCRIPT . roman_length ( ) = 1</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="alg2.39.39.3">then</span>
</div>
<div class="ltx_listingline" id="alg2.41.41">
<span class="ltx_tag ltx_tag_listingline">28</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span class="ltx_text ltx_font_typewriter" id="alg2.41.41.2">Yield(<em class="ltx_emph ltx_font_serif ltx_font_italic" id="alg2.41.41.2.2"><math alttext="P_{\text{prev}}" class="ltx_Math" display="inline" id="alg2.40.40.1.1.m1.1"><semantics id="alg2.40.40.1.1.m1.1a"><msub id="alg2.40.40.1.1.m1.1.1" xref="alg2.40.40.1.1.m1.1.1.cmml"><mi id="alg2.40.40.1.1.m1.1.1.2" xref="alg2.40.40.1.1.m1.1.1.2.cmml">P</mi><mtext class="ltx_mathvariant_italic" id="alg2.40.40.1.1.m1.1.1.3" xref="alg2.40.40.1.1.m1.1.1.3b.cmml"><em class="ltx_emph" id="alg2.40.40.1.1.m1.1.1.3.1nest" style="font-size:70%;">prev</em></mtext></msub><annotation-xml encoding="MathML-Content" id="alg2.40.40.1.1.m1.1b"><apply id="alg2.40.40.1.1.m1.1.1.cmml" xref="alg2.40.40.1.1.m1.1.1"><csymbol cd="ambiguous" id="alg2.40.40.1.1.m1.1.1.1.cmml" xref="alg2.40.40.1.1.m1.1.1">subscript</csymbol><ci id="alg2.40.40.1.1.m1.1.1.2.cmml" xref="alg2.40.40.1.1.m1.1.1.2">𝑃</ci><ci id="alg2.40.40.1.1.m1.1.1.3b.cmml" xref="alg2.40.40.1.1.m1.1.1.3"><mtext class="ltx_mathvariant_italic" id="alg2.40.40.1.1.m1.1.1.3.cmml" mathsize="70%" xref="alg2.40.40.1.1.m1.1.1.3"><em class="ltx_emph" id="alg2.40.40.1.1.m1.1.1.3.1anest" style="font-size:70%;">prev</em></mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.40.40.1.1.m1.1c">P_{\text{prev}}</annotation><annotation encoding="application/x-llamapun" id="alg2.40.40.1.1.m1.1d">italic_P start_POSTSUBSCRIPT prev end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="S_{\text{prev}}" class="ltx_Math" display="inline" id="alg2.41.41.2.2.m2.1"><semantics id="alg2.41.41.2.2.m2.1a"><msub id="alg2.41.41.2.2.m2.1.1" xref="alg2.41.41.2.2.m2.1.1.cmml"><mi id="alg2.41.41.2.2.m2.1.1.2" xref="alg2.41.41.2.2.m2.1.1.2.cmml">S</mi><mtext class="ltx_mathvariant_italic" id="alg2.41.41.2.2.m2.1.1.3" xref="alg2.41.41.2.2.m2.1.1.3b.cmml"><em class="ltx_emph" id="alg2.41.41.2.2.m2.1.1.3.1nest" style="font-size:70%;">prev</em></mtext></msub><annotation-xml encoding="MathML-Content" id="alg2.41.41.2.2.m2.1b"><apply id="alg2.41.41.2.2.m2.1.1.cmml" xref="alg2.41.41.2.2.m2.1.1"><csymbol cd="ambiguous" id="alg2.41.41.2.2.m2.1.1.1.cmml" xref="alg2.41.41.2.2.m2.1.1">subscript</csymbol><ci id="alg2.41.41.2.2.m2.1.1.2.cmml" xref="alg2.41.41.2.2.m2.1.1.2">𝑆</ci><ci id="alg2.41.41.2.2.m2.1.1.3b.cmml" xref="alg2.41.41.2.2.m2.1.1.3"><mtext class="ltx_mathvariant_italic" id="alg2.41.41.2.2.m2.1.1.3.cmml" mathsize="70%" xref="alg2.41.41.2.2.m2.1.1.3"><em class="ltx_emph" id="alg2.41.41.2.2.m2.1.1.3.1anest" style="font-size:70%;">prev</em></mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.41.41.2.2.m2.1c">S_{\text{prev}}</annotation><annotation encoding="application/x-llamapun" id="alg2.41.41.2.2.m2.1d">italic_S start_POSTSUBSCRIPT prev end_POSTSUBSCRIPT</annotation></semantics></math>, EndFlag</em>)</span>;
</div>
<div class="ltx_listingline" id="alg2.41.54">
<span class="ltx_tag ltx_tag_listingline">29</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div class="ltx_listingline" id="alg2.41.55">
<span class="ltx_tag ltx_tag_listingline">30</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div class="ltx_listingline" id="alg2.41.56">
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg2.43.1.1">Algorithm 2</span> </span>Sampling step</figcaption>
</figure>
<figure class="ltx_float ltx_algorithm" id="alg3">
<div class="ltx_listing ltx_lst_numbers_left ltx_listing" id="alg3.24">
<div class="ltx_listingline" id="alg3.1.1">
<span class="ltx_text" id="alg3.1.1.1"><span class="ltx_text ltx_font_bold" id="alg3.1.1.1.1">Input:</span> </span><math alttext="k_{\text{reaction}}" class="ltx_Math" display="inline" id="alg3.1.1.m1.1"><semantics id="alg3.1.1.m1.1a"><msub id="alg3.1.1.m1.1.1" xref="alg3.1.1.m1.1.1.cmml"><mi id="alg3.1.1.m1.1.1.2" xref="alg3.1.1.m1.1.1.2.cmml">k</mi><mtext id="alg3.1.1.m1.1.1.3" xref="alg3.1.1.m1.1.1.3a.cmml">reaction</mtext></msub><annotation-xml encoding="MathML-Content" id="alg3.1.1.m1.1b"><apply id="alg3.1.1.m1.1.1.cmml" xref="alg3.1.1.m1.1.1"><csymbol cd="ambiguous" id="alg3.1.1.m1.1.1.1.cmml" xref="alg3.1.1.m1.1.1">subscript</csymbol><ci id="alg3.1.1.m1.1.1.2.cmml" xref="alg3.1.1.m1.1.1.2">𝑘</ci><ci id="alg3.1.1.m1.1.1.3a.cmml" xref="alg3.1.1.m1.1.1.3"><mtext id="alg3.1.1.m1.1.1.3.cmml" mathsize="70%" xref="alg3.1.1.m1.1.1.3">reaction</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.1.1.m1.1c">k_{\text{reaction}}</annotation><annotation encoding="application/x-llamapun" id="alg3.1.1.m1.1d">italic_k start_POSTSUBSCRIPT reaction end_POSTSUBSCRIPT</annotation></semantics></math>, branching factor of reaction
</div>
<div class="ltx_listingline" id="alg3.2.2">
<span class="ltx_text" id="alg3.2.2.1"><span class="ltx_text ltx_font_bold" id="alg3.2.2.1.1">Input:</span> </span><math alttext="k_{\text{fingerprint}}" class="ltx_Math" display="inline" id="alg3.2.2.m1.1"><semantics id="alg3.2.2.m1.1a"><msub id="alg3.2.2.m1.1.1" xref="alg3.2.2.m1.1.1.cmml"><mi id="alg3.2.2.m1.1.1.2" xref="alg3.2.2.m1.1.1.2.cmml">k</mi><mtext id="alg3.2.2.m1.1.1.3" xref="alg3.2.2.m1.1.1.3a.cmml">fingerprint</mtext></msub><annotation-xml encoding="MathML-Content" id="alg3.2.2.m1.1b"><apply id="alg3.2.2.m1.1.1.cmml" xref="alg3.2.2.m1.1.1"><csymbol cd="ambiguous" id="alg3.2.2.m1.1.1.1.cmml" xref="alg3.2.2.m1.1.1">subscript</csymbol><ci id="alg3.2.2.m1.1.1.2.cmml" xref="alg3.2.2.m1.1.1.2">𝑘</ci><ci id="alg3.2.2.m1.1.1.3a.cmml" xref="alg3.2.2.m1.1.1.3"><mtext id="alg3.2.2.m1.1.1.3.cmml" mathsize="70%" xref="alg3.2.2.m1.1.1.3">fingerprint</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.2.2.m1.1c">k_{\text{fingerprint}}</annotation><annotation encoding="application/x-llamapun" id="alg3.2.2.m1.1d">italic_k start_POSTSUBSCRIPT fingerprint end_POSTSUBSCRIPT</annotation></semantics></math>, branching factor of building block fingerprint
</div>
<div class="ltx_listingline" id="alg3.3.3">
<span class="ltx_text" id="alg3.3.3.1"><span class="ltx_text ltx_font_bold" id="alg3.3.3.1.1">Input:</span> </span><math alttext="m" class="ltx_Math" display="inline" id="alg3.3.3.m1.1"><semantics id="alg3.3.3.m1.1a"><mi id="alg3.3.3.m1.1.1" xref="alg3.3.3.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="alg3.3.3.m1.1b"><ci id="alg3.3.3.m1.1.1.cmml" xref="alg3.3.3.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.3.3.m1.1c">m</annotation><annotation encoding="application/x-llamapun" id="alg3.3.3.m1.1d">italic_m</annotation></semantics></math>, size limit of the state pool
</div>
<div class="ltx_listingline" id="alg3.4.4">
<span class="ltx_text" id="alg3.4.4.1"><span class="ltx_text ltx_font_bold" id="alg3.4.4.1.1">Input:</span> </span><math alttext="n" class="ltx_Math" display="inline" id="alg3.4.4.m1.1"><semantics id="alg3.4.4.m1.1a"><mi id="alg3.4.4.m1.1.1" xref="alg3.4.4.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="alg3.4.4.m1.1b"><ci id="alg3.4.4.m1.1.1.cmml" xref="alg3.4.4.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.4.4.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="alg3.4.4.m1.1d">italic_n</annotation></semantics></math>, expected number of outputs
</div>
<div class="ltx_listingline" id="alg3.5.5">
<span class="ltx_text" id="alg3.5.5.1"><span class="ltx_text ltx_font_bold" id="alg3.5.5.1.1">Input:</span> </span><math alttext="f(\cdot)" class="ltx_Math" display="inline" id="alg3.5.5.m1.1"><semantics id="alg3.5.5.m1.1a"><mrow id="alg3.5.5.m1.1.2" xref="alg3.5.5.m1.1.2.cmml"><mi id="alg3.5.5.m1.1.2.2" xref="alg3.5.5.m1.1.2.2.cmml">f</mi><mo id="alg3.5.5.m1.1.2.1" xref="alg3.5.5.m1.1.2.1.cmml">⁢</mo><mrow id="alg3.5.5.m1.1.2.3.2" xref="alg3.5.5.m1.1.2.cmml"><mo id="alg3.5.5.m1.1.2.3.2.1" stretchy="false" xref="alg3.5.5.m1.1.2.cmml">(</mo><mo id="alg3.5.5.m1.1.1" lspace="0em" rspace="0em" xref="alg3.5.5.m1.1.1.cmml">⋅</mo><mo id="alg3.5.5.m1.1.2.3.2.2" stretchy="false" xref="alg3.5.5.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.5.5.m1.1b"><apply id="alg3.5.5.m1.1.2.cmml" xref="alg3.5.5.m1.1.2"><times id="alg3.5.5.m1.1.2.1.cmml" xref="alg3.5.5.m1.1.2.1"></times><ci id="alg3.5.5.m1.1.2.2.cmml" xref="alg3.5.5.m1.1.2.2">𝑓</ci><ci id="alg3.5.5.m1.1.1.cmml" xref="alg3.5.5.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.5.5.m1.1c">f(\cdot)</annotation><annotation encoding="application/x-llamapun" id="alg3.5.5.m1.1d">italic_f ( ⋅ )</annotation></semantics></math>, scoring function
</div>
<div class="ltx_listingline" id="alg3.24.25">
<span class="ltx_tag ltx_tag_listingline">1</span>
</div>
<div class="ltx_listingline" id="alg3.8.8">
<span class="ltx_text" id="alg3.8.8.1"><span class="ltx_text ltx_font_bold" id="alg3.8.8.1.1">Data:</span> </span><math alttext="\mathcal{M}\leftarrow\{(P_{0},S_{0})\}" class="ltx_Math" display="inline" id="alg3.6.6.m1.1"><semantics id="alg3.6.6.m1.1a"><mrow id="alg3.6.6.m1.1.1" xref="alg3.6.6.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.6.6.m1.1.1.3" xref="alg3.6.6.m1.1.1.3.cmml">ℳ</mi><mo id="alg3.6.6.m1.1.1.2" stretchy="false" xref="alg3.6.6.m1.1.1.2.cmml">←</mo><mrow id="alg3.6.6.m1.1.1.1.1" xref="alg3.6.6.m1.1.1.1.2.cmml"><mo id="alg3.6.6.m1.1.1.1.1.2" stretchy="false" xref="alg3.6.6.m1.1.1.1.2.cmml">{</mo><mrow id="alg3.6.6.m1.1.1.1.1.1.2" xref="alg3.6.6.m1.1.1.1.1.1.3.cmml"><mo id="alg3.6.6.m1.1.1.1.1.1.2.3" stretchy="false" xref="alg3.6.6.m1.1.1.1.1.1.3.cmml">(</mo><msub id="alg3.6.6.m1.1.1.1.1.1.1.1" xref="alg3.6.6.m1.1.1.1.1.1.1.1.cmml"><mi id="alg3.6.6.m1.1.1.1.1.1.1.1.2" xref="alg3.6.6.m1.1.1.1.1.1.1.1.2.cmml">P</mi><mn id="alg3.6.6.m1.1.1.1.1.1.1.1.3" xref="alg3.6.6.m1.1.1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="alg3.6.6.m1.1.1.1.1.1.2.4" xref="alg3.6.6.m1.1.1.1.1.1.3.cmml">,</mo><msub id="alg3.6.6.m1.1.1.1.1.1.2.2" xref="alg3.6.6.m1.1.1.1.1.1.2.2.cmml"><mi id="alg3.6.6.m1.1.1.1.1.1.2.2.2" xref="alg3.6.6.m1.1.1.1.1.1.2.2.2.cmml">S</mi><mn id="alg3.6.6.m1.1.1.1.1.1.2.2.3" xref="alg3.6.6.m1.1.1.1.1.1.2.2.3.cmml">0</mn></msub><mo id="alg3.6.6.m1.1.1.1.1.1.2.5" stretchy="false" xref="alg3.6.6.m1.1.1.1.1.1.3.cmml">)</mo></mrow><mo id="alg3.6.6.m1.1.1.1.1.3" stretchy="false" xref="alg3.6.6.m1.1.1.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.6.6.m1.1b"><apply id="alg3.6.6.m1.1.1.cmml" xref="alg3.6.6.m1.1.1"><ci id="alg3.6.6.m1.1.1.2.cmml" xref="alg3.6.6.m1.1.1.2">←</ci><ci id="alg3.6.6.m1.1.1.3.cmml" xref="alg3.6.6.m1.1.1.3">ℳ</ci><set id="alg3.6.6.m1.1.1.1.2.cmml" xref="alg3.6.6.m1.1.1.1.1"><interval closure="open" id="alg3.6.6.m1.1.1.1.1.1.3.cmml" xref="alg3.6.6.m1.1.1.1.1.1.2"><apply id="alg3.6.6.m1.1.1.1.1.1.1.1.cmml" xref="alg3.6.6.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg3.6.6.m1.1.1.1.1.1.1.1.1.cmml" xref="alg3.6.6.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg3.6.6.m1.1.1.1.1.1.1.1.2.cmml" xref="alg3.6.6.m1.1.1.1.1.1.1.1.2">𝑃</ci><cn id="alg3.6.6.m1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="alg3.6.6.m1.1.1.1.1.1.1.1.3">0</cn></apply><apply id="alg3.6.6.m1.1.1.1.1.1.2.2.cmml" xref="alg3.6.6.m1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="alg3.6.6.m1.1.1.1.1.1.2.2.1.cmml" xref="alg3.6.6.m1.1.1.1.1.1.2.2">subscript</csymbol><ci id="alg3.6.6.m1.1.1.1.1.1.2.2.2.cmml" xref="alg3.6.6.m1.1.1.1.1.1.2.2.2">𝑆</ci><cn id="alg3.6.6.m1.1.1.1.1.1.2.2.3.cmml" type="integer" xref="alg3.6.6.m1.1.1.1.1.1.2.2.3">0</cn></apply></interval></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.6.6.m1.1c">\mathcal{M}\leftarrow\{(P_{0},S_{0})\}</annotation><annotation encoding="application/x-llamapun" id="alg3.6.6.m1.1d">caligraphic_M ← { ( italic_P start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_S start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) }</annotation></semantics></math> where <math alttext="P_{0}=\varnothing" class="ltx_Math" display="inline" id="alg3.7.7.m2.1"><semantics id="alg3.7.7.m2.1a"><mrow id="alg3.7.7.m2.1.1" xref="alg3.7.7.m2.1.1.cmml"><msub id="alg3.7.7.m2.1.1.2" xref="alg3.7.7.m2.1.1.2.cmml"><mi id="alg3.7.7.m2.1.1.2.2" xref="alg3.7.7.m2.1.1.2.2.cmml">P</mi><mn id="alg3.7.7.m2.1.1.2.3" xref="alg3.7.7.m2.1.1.2.3.cmml">0</mn></msub><mo id="alg3.7.7.m2.1.1.1" xref="alg3.7.7.m2.1.1.1.cmml">=</mo><mi id="alg3.7.7.m2.1.1.3" mathvariant="normal" xref="alg3.7.7.m2.1.1.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="alg3.7.7.m2.1b"><apply id="alg3.7.7.m2.1.1.cmml" xref="alg3.7.7.m2.1.1"><eq id="alg3.7.7.m2.1.1.1.cmml" xref="alg3.7.7.m2.1.1.1"></eq><apply id="alg3.7.7.m2.1.1.2.cmml" xref="alg3.7.7.m2.1.1.2"><csymbol cd="ambiguous" id="alg3.7.7.m2.1.1.2.1.cmml" xref="alg3.7.7.m2.1.1.2">subscript</csymbol><ci id="alg3.7.7.m2.1.1.2.2.cmml" xref="alg3.7.7.m2.1.1.2.2">𝑃</ci><cn id="alg3.7.7.m2.1.1.2.3.cmml" type="integer" xref="alg3.7.7.m2.1.1.2.3">0</cn></apply><emptyset id="alg3.7.7.m2.1.1.3.cmml" xref="alg3.7.7.m2.1.1.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.7.7.m2.1c">P_{0}=\varnothing</annotation><annotation encoding="application/x-llamapun" id="alg3.7.7.m2.1d">italic_P start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = ∅</annotation></semantics></math> and <math alttext="S_{0}=\varnothing" class="ltx_Math" display="inline" id="alg3.8.8.m3.1"><semantics id="alg3.8.8.m3.1a"><mrow id="alg3.8.8.m3.1.1" xref="alg3.8.8.m3.1.1.cmml"><msub id="alg3.8.8.m3.1.1.2" xref="alg3.8.8.m3.1.1.2.cmml"><mi id="alg3.8.8.m3.1.1.2.2" xref="alg3.8.8.m3.1.1.2.2.cmml">S</mi><mn id="alg3.8.8.m3.1.1.2.3" xref="alg3.8.8.m3.1.1.2.3.cmml">0</mn></msub><mo id="alg3.8.8.m3.1.1.1" xref="alg3.8.8.m3.1.1.1.cmml">=</mo><mi id="alg3.8.8.m3.1.1.3" mathvariant="normal" xref="alg3.8.8.m3.1.1.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="alg3.8.8.m3.1b"><apply id="alg3.8.8.m3.1.1.cmml" xref="alg3.8.8.m3.1.1"><eq id="alg3.8.8.m3.1.1.1.cmml" xref="alg3.8.8.m3.1.1.1"></eq><apply id="alg3.8.8.m3.1.1.2.cmml" xref="alg3.8.8.m3.1.1.2"><csymbol cd="ambiguous" id="alg3.8.8.m3.1.1.2.1.cmml" xref="alg3.8.8.m3.1.1.2">subscript</csymbol><ci id="alg3.8.8.m3.1.1.2.2.cmml" xref="alg3.8.8.m3.1.1.2.2">𝑆</ci><cn id="alg3.8.8.m3.1.1.2.3.cmml" type="integer" xref="alg3.8.8.m3.1.1.2.3">0</cn></apply><emptyset id="alg3.8.8.m3.1.1.3.cmml" xref="alg3.8.8.m3.1.1.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.8.8.m3.1c">S_{0}=\varnothing</annotation><annotation encoding="application/x-llamapun" id="alg3.8.8.m3.1d">italic_S start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = ∅</annotation></semantics></math>, initial state pool
</div>
<div class="ltx_listingline" id="alg3.9.9">
<span class="ltx_text" id="alg3.9.9.1"><span class="ltx_text ltx_font_bold" id="alg3.9.9.1.1">Data:</span> </span><math alttext="\mathcal{N}\leftarrow\{\}" class="ltx_Math" display="inline" id="alg3.9.9.m1.1"><semantics id="alg3.9.9.m1.1a"><mrow id="alg3.9.9.m1.1.1" xref="alg3.9.9.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.9.9.m1.1.1.2" xref="alg3.9.9.m1.1.1.2.cmml">𝒩</mi><mo id="alg3.9.9.m1.1.1.1" stretchy="false" xref="alg3.9.9.m1.1.1.1.cmml">←</mo><mrow id="alg3.9.9.m1.1.1.3.2" xref="alg3.9.9.m1.1.1.cmml"><mo id="alg3.9.9.m1.1.1.3.2.1" stretchy="false" xref="alg3.9.9.m1.1.1.3.1.cmml">{</mo><mo id="alg3.9.9.m1.1.1.3.2.2" stretchy="false" xref="alg3.9.9.m1.1.1.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.9.9.m1.1b"><apply id="alg3.9.9.m1.1.1.cmml" xref="alg3.9.9.m1.1.1"><ci id="alg3.9.9.m1.1.1.1.cmml" xref="alg3.9.9.m1.1.1.1">←</ci><ci id="alg3.9.9.m1.1.1.2.cmml" xref="alg3.9.9.m1.1.1.2">𝒩</ci><list id="alg3.9.9.m1.1.1.3.1.cmml" xref="alg3.9.9.m1.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.9.9.m1.1c">\mathcal{N}\leftarrow\{\}</annotation><annotation encoding="application/x-llamapun" id="alg3.9.9.m1.1d">caligraphic_N ← { }</annotation></semantics></math>, output buffer
</div>
<div class="ltx_listingline" id="alg3.24.26">
<span class="ltx_tag ltx_tag_listingline">2</span>
</div>
<div class="ltx_listingline" id="alg3.10.10">
<span class="ltx_tag ltx_tag_listingline">3</span><span class="ltx_text ltx_font_bold" id="alg3.10.10.2">while</span> <em class="ltx_emph ltx_font_italic" id="alg3.10.10.1"><math alttext="|\mathcal{N}|&lt;n" class="ltx_Math" display="inline" id="alg3.10.10.1.m1.1"><semantics id="alg3.10.10.1.m1.1a"><mrow id="alg3.10.10.1.m1.1.2" xref="alg3.10.10.1.m1.1.2.cmml"><mrow id="alg3.10.10.1.m1.1.2.2.2" xref="alg3.10.10.1.m1.1.2.2.1.cmml"><mo id="alg3.10.10.1.m1.1.2.2.2.1" stretchy="false" xref="alg3.10.10.1.m1.1.2.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="alg3.10.10.1.m1.1.1" xref="alg3.10.10.1.m1.1.1.cmml">𝒩</mi><mo id="alg3.10.10.1.m1.1.2.2.2.2" stretchy="false" xref="alg3.10.10.1.m1.1.2.2.1.1.cmml">|</mo></mrow><mo id="alg3.10.10.1.m1.1.2.1" xref="alg3.10.10.1.m1.1.2.1.cmml">&lt;</mo><mi id="alg3.10.10.1.m1.1.2.3" xref="alg3.10.10.1.m1.1.2.3.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="alg3.10.10.1.m1.1b"><apply id="alg3.10.10.1.m1.1.2.cmml" xref="alg3.10.10.1.m1.1.2"><lt id="alg3.10.10.1.m1.1.2.1.cmml" xref="alg3.10.10.1.m1.1.2.1"></lt><apply id="alg3.10.10.1.m1.1.2.2.1.cmml" xref="alg3.10.10.1.m1.1.2.2.2"><abs id="alg3.10.10.1.m1.1.2.2.1.1.cmml" xref="alg3.10.10.1.m1.1.2.2.2.1"></abs><ci id="alg3.10.10.1.m1.1.1.cmml" xref="alg3.10.10.1.m1.1.1">𝒩</ci></apply><ci id="alg3.10.10.1.m1.1.2.3.cmml" xref="alg3.10.10.1.m1.1.2.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.10.10.1.m1.1c">|\mathcal{N}|&lt;n</annotation><annotation encoding="application/x-llamapun" id="alg3.10.10.1.m1.1d">| caligraphic_N | &lt; italic_n</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="alg3.10.10.3">do</span>
</div>
<div class="ltx_listingline" id="alg3.12.12">
<span class="ltx_tag ltx_tag_listingline">4</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span class="ltx_text ltx_font_bold" id="alg3.12.12.3">foreach</span> <em class="ltx_emph ltx_font_italic" id="alg3.12.12.2"><math alttext="(P,S)" class="ltx_Math" display="inline" id="alg3.11.11.1.m1.2"><semantics id="alg3.11.11.1.m1.2a"><mrow id="alg3.11.11.1.m1.2.3.2" xref="alg3.11.11.1.m1.2.3.1.cmml"><mo id="alg3.11.11.1.m1.2.3.2.1" stretchy="false" xref="alg3.11.11.1.m1.2.3.1.cmml">(</mo><mi id="alg3.11.11.1.m1.1.1" xref="alg3.11.11.1.m1.1.1.cmml">P</mi><mo id="alg3.11.11.1.m1.2.3.2.2" xref="alg3.11.11.1.m1.2.3.1.cmml">,</mo><mi id="alg3.11.11.1.m1.2.2" xref="alg3.11.11.1.m1.2.2.cmml">S</mi><mo id="alg3.11.11.1.m1.2.3.2.3" stretchy="false" xref="alg3.11.11.1.m1.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg3.11.11.1.m1.2b"><interval closure="open" id="alg3.11.11.1.m1.2.3.1.cmml" xref="alg3.11.11.1.m1.2.3.2"><ci id="alg3.11.11.1.m1.1.1.cmml" xref="alg3.11.11.1.m1.1.1">𝑃</ci><ci id="alg3.11.11.1.m1.2.2.cmml" xref="alg3.11.11.1.m1.2.2">𝑆</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="alg3.11.11.1.m1.2c">(P,S)</annotation><annotation encoding="application/x-llamapun" id="alg3.11.11.1.m1.2d">( italic_P , italic_S )</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg3.12.12.2.1">in</span> <math alttext="\mathcal{M}" class="ltx_Math" display="inline" id="alg3.12.12.2.m2.1"><semantics id="alg3.12.12.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="alg3.12.12.2.m2.1.1" xref="alg3.12.12.2.m2.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="alg3.12.12.2.m2.1b"><ci id="alg3.12.12.2.m2.1.1.cmml" xref="alg3.12.12.2.m2.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.12.12.2.m2.1c">\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="alg3.12.12.2.m2.1d">caligraphic_M</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="alg3.12.12.4">do</span>
</div>
<div class="ltx_listingline" id="alg3.14.14">
<span class="ltx_tag ltx_tag_listingline">5</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span class="ltx_text ltx_font_typewriter" id="alg3.14.14.2">Remove(<em class="ltx_emph ltx_font_serif ltx_font_italic" id="alg3.14.14.2.2"><math alttext="(P,S)" class="ltx_Math" display="inline" id="alg3.13.13.1.1.m1.2"><semantics id="alg3.13.13.1.1.m1.2a"><mrow id="alg3.13.13.1.1.m1.2.3.2" xref="alg3.13.13.1.1.m1.2.3.1.cmml"><mo id="alg3.13.13.1.1.m1.2.3.2.1" stretchy="false" xref="alg3.13.13.1.1.m1.2.3.1.cmml">(</mo><mi id="alg3.13.13.1.1.m1.1.1" xref="alg3.13.13.1.1.m1.1.1.cmml">P</mi><mo id="alg3.13.13.1.1.m1.2.3.2.2" xref="alg3.13.13.1.1.m1.2.3.1.cmml">,</mo><mi id="alg3.13.13.1.1.m1.2.2" xref="alg3.13.13.1.1.m1.2.2.cmml">S</mi><mo id="alg3.13.13.1.1.m1.2.3.2.3" stretchy="false" xref="alg3.13.13.1.1.m1.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg3.13.13.1.1.m1.2b"><interval closure="open" id="alg3.13.13.1.1.m1.2.3.1.cmml" xref="alg3.13.13.1.1.m1.2.3.2"><ci id="alg3.13.13.1.1.m1.1.1.cmml" xref="alg3.13.13.1.1.m1.1.1">𝑃</ci><ci id="alg3.13.13.1.1.m1.2.2.cmml" xref="alg3.13.13.1.1.m1.2.2">𝑆</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="alg3.13.13.1.1.m1.2c">(P,S)</annotation><annotation encoding="application/x-llamapun" id="alg3.13.13.1.1.m1.2d">( italic_P , italic_S )</annotation></semantics></math> from <math alttext="\mathcal{M}" class="ltx_Math" display="inline" id="alg3.14.14.2.2.m2.1"><semantics id="alg3.14.14.2.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="alg3.14.14.2.2.m2.1.1" xref="alg3.14.14.2.2.m2.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="alg3.14.14.2.2.m2.1b"><ci id="alg3.14.14.2.2.m2.1.1.cmml" xref="alg3.14.14.2.2.m2.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.14.14.2.2.m2.1c">\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="alg3.14.14.2.2.m2.1d">caligraphic_M</annotation></semantics></math></em>)</span>;
</div>
<div class="ltx_listingline" id="alg3.16.16">
<span class="ltx_tag ltx_tag_listingline">6</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span class="ltx_text ltx_font_bold" id="alg3.16.16.3">foreach</span> <em class="ltx_emph ltx_font_italic" id="alg3.16.16.2"><math alttext="(P_{\text{next}},S_{\text{next}},\text{hasEndFlag})" class="ltx_Math" display="inline" id="alg3.15.15.1.m1.3"><semantics id="alg3.15.15.1.m1.3a"><mrow id="alg3.15.15.1.m1.3.3.2" xref="alg3.15.15.1.m1.3.3.3.cmml"><mo id="alg3.15.15.1.m1.3.3.2.3" stretchy="false" xref="alg3.15.15.1.m1.3.3.3.cmml">(</mo><msub id="alg3.15.15.1.m1.2.2.1.1" xref="alg3.15.15.1.m1.2.2.1.1.cmml"><mi id="alg3.15.15.1.m1.2.2.1.1.2" xref="alg3.15.15.1.m1.2.2.1.1.2.cmml">P</mi><mtext class="ltx_mathvariant_italic" id="alg3.15.15.1.m1.2.2.1.1.3" xref="alg3.15.15.1.m1.2.2.1.1.3b.cmml"><em class="ltx_emph" id="alg3.15.15.1.m1.2.2.1.1.3.1nest" style="font-size:70%;">next</em></mtext></msub><mo id="alg3.15.15.1.m1.3.3.2.4" xref="alg3.15.15.1.m1.3.3.3.cmml">,</mo><msub id="alg3.15.15.1.m1.3.3.2.2" xref="alg3.15.15.1.m1.3.3.2.2.cmml"><mi id="alg3.15.15.1.m1.3.3.2.2.2" xref="alg3.15.15.1.m1.3.3.2.2.2.cmml">S</mi><mtext class="ltx_mathvariant_italic" id="alg3.15.15.1.m1.3.3.2.2.3" xref="alg3.15.15.1.m1.3.3.2.2.3b.cmml"><em class="ltx_emph" id="alg3.15.15.1.m1.3.3.2.2.3.1nest" style="font-size:70%;">next</em></mtext></msub><mo id="alg3.15.15.1.m1.3.3.2.5" xref="alg3.15.15.1.m1.3.3.3.cmml">,</mo><mtext class="ltx_mathvariant_italic" id="alg3.15.15.1.m1.1.1" xref="alg3.15.15.1.m1.1.1a.cmml">hasEndFlag</mtext><mo id="alg3.15.15.1.m1.3.3.2.6" stretchy="false" xref="alg3.15.15.1.m1.3.3.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg3.15.15.1.m1.3b"><vector id="alg3.15.15.1.m1.3.3.3.cmml" xref="alg3.15.15.1.m1.3.3.2"><apply id="alg3.15.15.1.m1.2.2.1.1.cmml" xref="alg3.15.15.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="alg3.15.15.1.m1.2.2.1.1.1.cmml" xref="alg3.15.15.1.m1.2.2.1.1">subscript</csymbol><ci id="alg3.15.15.1.m1.2.2.1.1.2.cmml" xref="alg3.15.15.1.m1.2.2.1.1.2">𝑃</ci><ci id="alg3.15.15.1.m1.2.2.1.1.3b.cmml" xref="alg3.15.15.1.m1.2.2.1.1.3"><mtext class="ltx_mathvariant_italic" id="alg3.15.15.1.m1.2.2.1.1.3.cmml" mathsize="70%" xref="alg3.15.15.1.m1.2.2.1.1.3"><em class="ltx_emph" id="alg3.15.15.1.m1.2.2.1.1.3.1anest" style="font-size:70%;">next</em></mtext></ci></apply><apply id="alg3.15.15.1.m1.3.3.2.2.cmml" xref="alg3.15.15.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="alg3.15.15.1.m1.3.3.2.2.1.cmml" xref="alg3.15.15.1.m1.3.3.2.2">subscript</csymbol><ci id="alg3.15.15.1.m1.3.3.2.2.2.cmml" xref="alg3.15.15.1.m1.3.3.2.2.2">𝑆</ci><ci id="alg3.15.15.1.m1.3.3.2.2.3b.cmml" xref="alg3.15.15.1.m1.3.3.2.2.3"><mtext class="ltx_mathvariant_italic" id="alg3.15.15.1.m1.3.3.2.2.3.cmml" mathsize="70%" xref="alg3.15.15.1.m1.3.3.2.2.3"><em class="ltx_emph" id="alg3.15.15.1.m1.3.3.2.2.3.1anest" style="font-size:70%;">next</em></mtext></ci></apply><ci id="alg3.15.15.1.m1.1.1a.cmml" xref="alg3.15.15.1.m1.1.1"><mtext class="ltx_mathvariant_italic" id="alg3.15.15.1.m1.1.1.cmml" xref="alg3.15.15.1.m1.1.1">hasEndFlag</mtext></ci></vector></annotation-xml><annotation encoding="application/x-tex" id="alg3.15.15.1.m1.3c">(P_{\text{next}},S_{\text{next}},\text{hasEndFlag})</annotation><annotation encoding="application/x-llamapun" id="alg3.15.15.1.m1.3d">( italic_P start_POSTSUBSCRIPT next end_POSTSUBSCRIPT , italic_S start_POSTSUBSCRIPT next end_POSTSUBSCRIPT , hasEndFlag )</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg3.16.16.2.1">in</span> <math alttext="\operatorname{SamplingStep}(P,S,\mathbf{c},k_{\text{reaction}},k_{\text{%
fingerprint}})" class="ltx_Math" display="inline" id="alg3.16.16.2.m2.6"><semantics id="alg3.16.16.2.m2.6a"><mrow id="alg3.16.16.2.m2.6.6.2" xref="alg3.16.16.2.m2.6.6.3.cmml"><mi id="alg3.16.16.2.m2.1.1" xref="alg3.16.16.2.m2.1.1.cmml">SamplingStep</mi><mo id="alg3.16.16.2.m2.6.6.2a" xref="alg3.16.16.2.m2.6.6.3.cmml">⁡</mo><mrow id="alg3.16.16.2.m2.6.6.2.2" xref="alg3.16.16.2.m2.6.6.3.cmml"><mo id="alg3.16.16.2.m2.6.6.2.2.3" stretchy="false" xref="alg3.16.16.2.m2.6.6.3.cmml">(</mo><mi id="alg3.16.16.2.m2.2.2" xref="alg3.16.16.2.m2.2.2.cmml">P</mi><mo id="alg3.16.16.2.m2.6.6.2.2.4" xref="alg3.16.16.2.m2.6.6.3.cmml">,</mo><mi id="alg3.16.16.2.m2.3.3" xref="alg3.16.16.2.m2.3.3.cmml">S</mi><mo id="alg3.16.16.2.m2.6.6.2.2.5" xref="alg3.16.16.2.m2.6.6.3.cmml">,</mo><mi id="alg3.16.16.2.m2.4.4" xref="alg3.16.16.2.m2.4.4.cmml">𝐜</mi><mo id="alg3.16.16.2.m2.6.6.2.2.6" xref="alg3.16.16.2.m2.6.6.3.cmml">,</mo><msub id="alg3.16.16.2.m2.5.5.1.1.1" xref="alg3.16.16.2.m2.5.5.1.1.1.cmml"><mi id="alg3.16.16.2.m2.5.5.1.1.1.2" xref="alg3.16.16.2.m2.5.5.1.1.1.2.cmml">k</mi><mtext class="ltx_mathvariant_italic" id="alg3.16.16.2.m2.5.5.1.1.1.3" xref="alg3.16.16.2.m2.5.5.1.1.1.3b.cmml"><em class="ltx_emph" id="alg3.16.16.2.m2.5.5.1.1.1.3.1nest" style="font-size:70%;">reaction</em></mtext></msub><mo id="alg3.16.16.2.m2.6.6.2.2.7" xref="alg3.16.16.2.m2.6.6.3.cmml">,</mo><msub id="alg3.16.16.2.m2.6.6.2.2.2" xref="alg3.16.16.2.m2.6.6.2.2.2.cmml"><mi id="alg3.16.16.2.m2.6.6.2.2.2.2" xref="alg3.16.16.2.m2.6.6.2.2.2.2.cmml">k</mi><mtext class="ltx_mathvariant_italic" id="alg3.16.16.2.m2.6.6.2.2.2.3" xref="alg3.16.16.2.m2.6.6.2.2.2.3b.cmml"><em class="ltx_emph" id="alg3.16.16.2.m2.6.6.2.2.2.3.1nest" style="font-size:70%;">fingerprint</em></mtext></msub><mo id="alg3.16.16.2.m2.6.6.2.2.8" stretchy="false" xref="alg3.16.16.2.m2.6.6.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.16.16.2.m2.6b"><apply id="alg3.16.16.2.m2.6.6.3.cmml" xref="alg3.16.16.2.m2.6.6.2"><ci id="alg3.16.16.2.m2.1.1.cmml" xref="alg3.16.16.2.m2.1.1">SamplingStep</ci><ci id="alg3.16.16.2.m2.2.2.cmml" xref="alg3.16.16.2.m2.2.2">𝑃</ci><ci id="alg3.16.16.2.m2.3.3.cmml" xref="alg3.16.16.2.m2.3.3">𝑆</ci><ci id="alg3.16.16.2.m2.4.4.cmml" xref="alg3.16.16.2.m2.4.4">𝐜</ci><apply id="alg3.16.16.2.m2.5.5.1.1.1.cmml" xref="alg3.16.16.2.m2.5.5.1.1.1"><csymbol cd="ambiguous" id="alg3.16.16.2.m2.5.5.1.1.1.1.cmml" xref="alg3.16.16.2.m2.5.5.1.1.1">subscript</csymbol><ci id="alg3.16.16.2.m2.5.5.1.1.1.2.cmml" xref="alg3.16.16.2.m2.5.5.1.1.1.2">𝑘</ci><ci id="alg3.16.16.2.m2.5.5.1.1.1.3b.cmml" xref="alg3.16.16.2.m2.5.5.1.1.1.3"><mtext class="ltx_mathvariant_italic" id="alg3.16.16.2.m2.5.5.1.1.1.3.cmml" mathsize="70%" xref="alg3.16.16.2.m2.5.5.1.1.1.3"><em class="ltx_emph" id="alg3.16.16.2.m2.5.5.1.1.1.3.1anest" style="font-size:70%;">reaction</em></mtext></ci></apply><apply id="alg3.16.16.2.m2.6.6.2.2.2.cmml" xref="alg3.16.16.2.m2.6.6.2.2.2"><csymbol cd="ambiguous" id="alg3.16.16.2.m2.6.6.2.2.2.1.cmml" xref="alg3.16.16.2.m2.6.6.2.2.2">subscript</csymbol><ci id="alg3.16.16.2.m2.6.6.2.2.2.2.cmml" xref="alg3.16.16.2.m2.6.6.2.2.2.2">𝑘</ci><ci id="alg3.16.16.2.m2.6.6.2.2.2.3b.cmml" xref="alg3.16.16.2.m2.6.6.2.2.2.3"><mtext class="ltx_mathvariant_italic" id="alg3.16.16.2.m2.6.6.2.2.2.3.cmml" mathsize="70%" xref="alg3.16.16.2.m2.6.6.2.2.2.3"><em class="ltx_emph" id="alg3.16.16.2.m2.6.6.2.2.2.3.1anest" style="font-size:70%;">fingerprint</em></mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.16.16.2.m2.6c">\operatorname{SamplingStep}(P,S,\mathbf{c},k_{\text{reaction}},k_{\text{%
fingerprint}})</annotation><annotation encoding="application/x-llamapun" id="alg3.16.16.2.m2.6d">roman_SamplingStep ( italic_P , italic_S , bold_c , italic_k start_POSTSUBSCRIPT reaction end_POSTSUBSCRIPT , italic_k start_POSTSUBSCRIPT fingerprint end_POSTSUBSCRIPT )</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="alg3.16.16.4">do</span>
</div>
<div class="ltx_listingline" id="alg3.24.27">
<span class="ltx_tag ltx_tag_listingline">7</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span class="ltx_text ltx_font_bold" id="alg3.24.27.1">if</span> <em class="ltx_emph ltx_font_italic" id="alg3.24.27.2">hasEndFlag</em> <span class="ltx_text ltx_font_bold" id="alg3.24.27.3">then</span>
</div>
<div class="ltx_listingline" id="alg3.18.18">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span class="ltx_text ltx_font_typewriter" id="alg3.18.18.2">Add(<em class="ltx_emph ltx_font_serif ltx_font_italic" id="alg3.18.18.2.2"><math alttext="(P_{\text{next}},S_{\text{next}})" class="ltx_Math" display="inline" id="alg3.17.17.1.1.m1.2"><semantics id="alg3.17.17.1.1.m1.2a"><mrow id="alg3.17.17.1.1.m1.2.2.2" xref="alg3.17.17.1.1.m1.2.2.3.cmml"><mo id="alg3.17.17.1.1.m1.2.2.2.3" stretchy="false" xref="alg3.17.17.1.1.m1.2.2.3.cmml">(</mo><msub id="alg3.17.17.1.1.m1.1.1.1.1" xref="alg3.17.17.1.1.m1.1.1.1.1.cmml"><mi id="alg3.17.17.1.1.m1.1.1.1.1.2" xref="alg3.17.17.1.1.m1.1.1.1.1.2.cmml">P</mi><mtext class="ltx_mathvariant_italic" id="alg3.17.17.1.1.m1.1.1.1.1.3" xref="alg3.17.17.1.1.m1.1.1.1.1.3b.cmml"><em class="ltx_emph" id="alg3.17.17.1.1.m1.1.1.1.1.3.1nest" style="font-size:70%;">next</em></mtext></msub><mo id="alg3.17.17.1.1.m1.2.2.2.4" xref="alg3.17.17.1.1.m1.2.2.3.cmml">,</mo><msub id="alg3.17.17.1.1.m1.2.2.2.2" xref="alg3.17.17.1.1.m1.2.2.2.2.cmml"><mi id="alg3.17.17.1.1.m1.2.2.2.2.2" xref="alg3.17.17.1.1.m1.2.2.2.2.2.cmml">S</mi><mtext class="ltx_mathvariant_italic" id="alg3.17.17.1.1.m1.2.2.2.2.3" xref="alg3.17.17.1.1.m1.2.2.2.2.3b.cmml"><em class="ltx_emph" id="alg3.17.17.1.1.m1.2.2.2.2.3.1nest" style="font-size:70%;">next</em></mtext></msub><mo id="alg3.17.17.1.1.m1.2.2.2.5" stretchy="false" xref="alg3.17.17.1.1.m1.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg3.17.17.1.1.m1.2b"><interval closure="open" id="alg3.17.17.1.1.m1.2.2.3.cmml" xref="alg3.17.17.1.1.m1.2.2.2"><apply id="alg3.17.17.1.1.m1.1.1.1.1.cmml" xref="alg3.17.17.1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg3.17.17.1.1.m1.1.1.1.1.1.cmml" xref="alg3.17.17.1.1.m1.1.1.1.1">subscript</csymbol><ci id="alg3.17.17.1.1.m1.1.1.1.1.2.cmml" xref="alg3.17.17.1.1.m1.1.1.1.1.2">𝑃</ci><ci id="alg3.17.17.1.1.m1.1.1.1.1.3b.cmml" xref="alg3.17.17.1.1.m1.1.1.1.1.3"><mtext class="ltx_mathvariant_italic" id="alg3.17.17.1.1.m1.1.1.1.1.3.cmml" mathsize="70%" xref="alg3.17.17.1.1.m1.1.1.1.1.3"><em class="ltx_emph" id="alg3.17.17.1.1.m1.1.1.1.1.3.1anest" style="font-size:70%;">next</em></mtext></ci></apply><apply id="alg3.17.17.1.1.m1.2.2.2.2.cmml" xref="alg3.17.17.1.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg3.17.17.1.1.m1.2.2.2.2.1.cmml" xref="alg3.17.17.1.1.m1.2.2.2.2">subscript</csymbol><ci id="alg3.17.17.1.1.m1.2.2.2.2.2.cmml" xref="alg3.17.17.1.1.m1.2.2.2.2.2">𝑆</ci><ci id="alg3.17.17.1.1.m1.2.2.2.2.3b.cmml" xref="alg3.17.17.1.1.m1.2.2.2.2.3"><mtext class="ltx_mathvariant_italic" id="alg3.17.17.1.1.m1.2.2.2.2.3.cmml" mathsize="70%" xref="alg3.17.17.1.1.m1.2.2.2.2.3"><em class="ltx_emph" id="alg3.17.17.1.1.m1.2.2.2.2.3.1anest" style="font-size:70%;">next</em></mtext></ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="alg3.17.17.1.1.m1.2c">(P_{\text{next}},S_{\text{next}})</annotation><annotation encoding="application/x-llamapun" id="alg3.17.17.1.1.m1.2d">( italic_P start_POSTSUBSCRIPT next end_POSTSUBSCRIPT , italic_S start_POSTSUBSCRIPT next end_POSTSUBSCRIPT )</annotation></semantics></math> to <math alttext="\mathcal{N}" class="ltx_Math" display="inline" id="alg3.18.18.2.2.m2.1"><semantics id="alg3.18.18.2.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="alg3.18.18.2.2.m2.1.1" xref="alg3.18.18.2.2.m2.1.1.cmml">𝒩</mi><annotation-xml encoding="MathML-Content" id="alg3.18.18.2.2.m2.1b"><ci id="alg3.18.18.2.2.m2.1.1.cmml" xref="alg3.18.18.2.2.m2.1.1">𝒩</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.18.18.2.2.m2.1c">\mathcal{N}</annotation><annotation encoding="application/x-llamapun" id="alg3.18.18.2.2.m2.1d">caligraphic_N</annotation></semantics></math></em>)</span> ;
</div>
<div class="ltx_listingline" id="alg3.24.28">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_text ltx_font_typewriter" id="alg3.24.28.1">// </span><span class="ltx_text ltx_font_typewriter" id="alg3.24.28.2">Save to output buffer</span>
</div>
<div class="ltx_listingline" id="alg3.24.29">
<span class="ltx_tag ltx_tag_listingline">8</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div class="ltx_listingline" id="alg3.24.30">
<span class="ltx_tag ltx_tag_listingline">9</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span class="ltx_text ltx_font_bold" id="alg3.24.30.1">else</span>
</div>
<div class="ltx_listingline" id="alg3.20.20">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span class="ltx_text ltx_font_typewriter" id="alg3.20.20.2">Add(<em class="ltx_emph ltx_font_serif ltx_font_italic" id="alg3.20.20.2.2"><math alttext="(P_{\text{next}},S_{\text{next}})" class="ltx_Math" display="inline" id="alg3.19.19.1.1.m1.2"><semantics id="alg3.19.19.1.1.m1.2a"><mrow id="alg3.19.19.1.1.m1.2.2.2" xref="alg3.19.19.1.1.m1.2.2.3.cmml"><mo id="alg3.19.19.1.1.m1.2.2.2.3" stretchy="false" xref="alg3.19.19.1.1.m1.2.2.3.cmml">(</mo><msub id="alg3.19.19.1.1.m1.1.1.1.1" xref="alg3.19.19.1.1.m1.1.1.1.1.cmml"><mi id="alg3.19.19.1.1.m1.1.1.1.1.2" xref="alg3.19.19.1.1.m1.1.1.1.1.2.cmml">P</mi><mtext class="ltx_mathvariant_italic" id="alg3.19.19.1.1.m1.1.1.1.1.3" xref="alg3.19.19.1.1.m1.1.1.1.1.3b.cmml"><em class="ltx_emph" id="alg3.19.19.1.1.m1.1.1.1.1.3.1nest" style="font-size:70%;">next</em></mtext></msub><mo id="alg3.19.19.1.1.m1.2.2.2.4" xref="alg3.19.19.1.1.m1.2.2.3.cmml">,</mo><msub id="alg3.19.19.1.1.m1.2.2.2.2" xref="alg3.19.19.1.1.m1.2.2.2.2.cmml"><mi id="alg3.19.19.1.1.m1.2.2.2.2.2" xref="alg3.19.19.1.1.m1.2.2.2.2.2.cmml">S</mi><mtext class="ltx_mathvariant_italic" id="alg3.19.19.1.1.m1.2.2.2.2.3" xref="alg3.19.19.1.1.m1.2.2.2.2.3b.cmml"><em class="ltx_emph" id="alg3.19.19.1.1.m1.2.2.2.2.3.1nest" style="font-size:70%;">next</em></mtext></msub><mo id="alg3.19.19.1.1.m1.2.2.2.5" stretchy="false" xref="alg3.19.19.1.1.m1.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg3.19.19.1.1.m1.2b"><interval closure="open" id="alg3.19.19.1.1.m1.2.2.3.cmml" xref="alg3.19.19.1.1.m1.2.2.2"><apply id="alg3.19.19.1.1.m1.1.1.1.1.cmml" xref="alg3.19.19.1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg3.19.19.1.1.m1.1.1.1.1.1.cmml" xref="alg3.19.19.1.1.m1.1.1.1.1">subscript</csymbol><ci id="alg3.19.19.1.1.m1.1.1.1.1.2.cmml" xref="alg3.19.19.1.1.m1.1.1.1.1.2">𝑃</ci><ci id="alg3.19.19.1.1.m1.1.1.1.1.3b.cmml" xref="alg3.19.19.1.1.m1.1.1.1.1.3"><mtext class="ltx_mathvariant_italic" id="alg3.19.19.1.1.m1.1.1.1.1.3.cmml" mathsize="70%" xref="alg3.19.19.1.1.m1.1.1.1.1.3"><em class="ltx_emph" id="alg3.19.19.1.1.m1.1.1.1.1.3.1anest" style="font-size:70%;">next</em></mtext></ci></apply><apply id="alg3.19.19.1.1.m1.2.2.2.2.cmml" xref="alg3.19.19.1.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg3.19.19.1.1.m1.2.2.2.2.1.cmml" xref="alg3.19.19.1.1.m1.2.2.2.2">subscript</csymbol><ci id="alg3.19.19.1.1.m1.2.2.2.2.2.cmml" xref="alg3.19.19.1.1.m1.2.2.2.2.2">𝑆</ci><ci id="alg3.19.19.1.1.m1.2.2.2.2.3b.cmml" xref="alg3.19.19.1.1.m1.2.2.2.2.3"><mtext class="ltx_mathvariant_italic" id="alg3.19.19.1.1.m1.2.2.2.2.3.cmml" mathsize="70%" xref="alg3.19.19.1.1.m1.2.2.2.2.3"><em class="ltx_emph" id="alg3.19.19.1.1.m1.2.2.2.2.3.1anest" style="font-size:70%;">next</em></mtext></ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="alg3.19.19.1.1.m1.2c">(P_{\text{next}},S_{\text{next}})</annotation><annotation encoding="application/x-llamapun" id="alg3.19.19.1.1.m1.2d">( italic_P start_POSTSUBSCRIPT next end_POSTSUBSCRIPT , italic_S start_POSTSUBSCRIPT next end_POSTSUBSCRIPT )</annotation></semantics></math> to <math alttext="\mathcal{M}" class="ltx_Math" display="inline" id="alg3.20.20.2.2.m2.1"><semantics id="alg3.20.20.2.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="alg3.20.20.2.2.m2.1.1" xref="alg3.20.20.2.2.m2.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="alg3.20.20.2.2.m2.1b"><ci id="alg3.20.20.2.2.m2.1.1.cmml" xref="alg3.20.20.2.2.m2.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.20.20.2.2.m2.1c">\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="alg3.20.20.2.2.m2.1d">caligraphic_M</annotation></semantics></math></em>)</span> ;
</div>
<div class="ltx_listingline" id="alg3.24.31">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_text ltx_font_typewriter" id="alg3.24.31.1">// </span><span class="ltx_text ltx_font_typewriter" id="alg3.24.31.2">Add to the state pool</span>
</div>
<div class="ltx_listingline" id="alg3.24.32">
<span class="ltx_tag ltx_tag_listingline">10</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div class="ltx_listingline" id="alg3.24.33">
<span class="ltx_tag ltx_tag_listingline">11</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div class="ltx_listingline" id="alg3.24.34">
<span class="ltx_tag ltx_tag_listingline">12</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div class="ltx_listingline" id="alg3.22.22">
<span class="ltx_tag ltx_tag_listingline">13</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span class="ltx_text ltx_font_typewriter" id="alg3.22.22.2">Sort(<em class="ltx_emph ltx_font_serif ltx_font_italic" id="alg3.22.22.2.2"><math alttext="\mathcal{M}" class="ltx_Math" display="inline" id="alg3.21.21.1.1.m1.1"><semantics id="alg3.21.21.1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg3.21.21.1.1.m1.1.1" xref="alg3.21.21.1.1.m1.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="alg3.21.21.1.1.m1.1b"><ci id="alg3.21.21.1.1.m1.1.1.cmml" xref="alg3.21.21.1.1.m1.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.21.21.1.1.m1.1c">\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="alg3.21.21.1.1.m1.1d">caligraphic_M</annotation></semantics></math> according to the scoring function <math alttext="f(S)" class="ltx_Math" display="inline" id="alg3.22.22.2.2.m2.1"><semantics id="alg3.22.22.2.2.m2.1a"><mrow id="alg3.22.22.2.2.m2.1.2" xref="alg3.22.22.2.2.m2.1.2.cmml"><mi id="alg3.22.22.2.2.m2.1.2.2" xref="alg3.22.22.2.2.m2.1.2.2.cmml">f</mi><mo id="alg3.22.22.2.2.m2.1.2.1" xref="alg3.22.22.2.2.m2.1.2.1.cmml">⁢</mo><mrow id="alg3.22.22.2.2.m2.1.2.3.2" xref="alg3.22.22.2.2.m2.1.2.cmml"><mo id="alg3.22.22.2.2.m2.1.2.3.2.1" stretchy="false" xref="alg3.22.22.2.2.m2.1.2.cmml">(</mo><mi id="alg3.22.22.2.2.m2.1.1" xref="alg3.22.22.2.2.m2.1.1.cmml">S</mi><mo id="alg3.22.22.2.2.m2.1.2.3.2.2" stretchy="false" xref="alg3.22.22.2.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.22.22.2.2.m2.1b"><apply id="alg3.22.22.2.2.m2.1.2.cmml" xref="alg3.22.22.2.2.m2.1.2"><times id="alg3.22.22.2.2.m2.1.2.1.cmml" xref="alg3.22.22.2.2.m2.1.2.1"></times><ci id="alg3.22.22.2.2.m2.1.2.2.cmml" xref="alg3.22.22.2.2.m2.1.2.2">𝑓</ci><ci id="alg3.22.22.2.2.m2.1.1.cmml" xref="alg3.22.22.2.2.m2.1.1">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.22.22.2.2.m2.1c">f(S)</annotation><annotation encoding="application/x-llamapun" id="alg3.22.22.2.2.m2.1d">italic_f ( italic_S )</annotation></semantics></math></em>)</span>;
</div>
<div class="ltx_listingline" id="alg3.23.23">
<span class="ltx_tag ltx_tag_listingline">14</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="\mathcal{M}\leftarrow\mathcal{M}[1\ldots m]" class="ltx_Math" display="inline" id="alg3.23.23.m1.1"><semantics id="alg3.23.23.m1.1a"><mrow id="alg3.23.23.m1.1.1" xref="alg3.23.23.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.23.23.m1.1.1.3" xref="alg3.23.23.m1.1.1.3.cmml">ℳ</mi><mo id="alg3.23.23.m1.1.1.2" stretchy="false" xref="alg3.23.23.m1.1.1.2.cmml">←</mo><mrow id="alg3.23.23.m1.1.1.1" xref="alg3.23.23.m1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.23.23.m1.1.1.1.3" xref="alg3.23.23.m1.1.1.1.3.cmml">ℳ</mi><mo id="alg3.23.23.m1.1.1.1.2" xref="alg3.23.23.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg3.23.23.m1.1.1.1.1.1" xref="alg3.23.23.m1.1.1.1.1.2.cmml"><mo id="alg3.23.23.m1.1.1.1.1.1.2" stretchy="false" xref="alg3.23.23.m1.1.1.1.1.2.1.cmml">[</mo><mrow id="alg3.23.23.m1.1.1.1.1.1.1" xref="alg3.23.23.m1.1.1.1.1.1.1.cmml"><mn id="alg3.23.23.m1.1.1.1.1.1.1.2" xref="alg3.23.23.m1.1.1.1.1.1.1.2.cmml">1</mn><mo id="alg3.23.23.m1.1.1.1.1.1.1.1" xref="alg3.23.23.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg3.23.23.m1.1.1.1.1.1.1.3" mathvariant="normal" xref="alg3.23.23.m1.1.1.1.1.1.1.3.cmml">…</mi><mo id="alg3.23.23.m1.1.1.1.1.1.1.1a" xref="alg3.23.23.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg3.23.23.m1.1.1.1.1.1.1.4" xref="alg3.23.23.m1.1.1.1.1.1.1.4.cmml">m</mi></mrow><mo id="alg3.23.23.m1.1.1.1.1.1.3" stretchy="false" xref="alg3.23.23.m1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.23.23.m1.1b"><apply id="alg3.23.23.m1.1.1.cmml" xref="alg3.23.23.m1.1.1"><ci id="alg3.23.23.m1.1.1.2.cmml" xref="alg3.23.23.m1.1.1.2">←</ci><ci id="alg3.23.23.m1.1.1.3.cmml" xref="alg3.23.23.m1.1.1.3">ℳ</ci><apply id="alg3.23.23.m1.1.1.1.cmml" xref="alg3.23.23.m1.1.1.1"><times id="alg3.23.23.m1.1.1.1.2.cmml" xref="alg3.23.23.m1.1.1.1.2"></times><ci id="alg3.23.23.m1.1.1.1.3.cmml" xref="alg3.23.23.m1.1.1.1.3">ℳ</ci><apply id="alg3.23.23.m1.1.1.1.1.2.cmml" xref="alg3.23.23.m1.1.1.1.1.1"><csymbol cd="latexml" id="alg3.23.23.m1.1.1.1.1.2.1.cmml" xref="alg3.23.23.m1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="alg3.23.23.m1.1.1.1.1.1.1.cmml" xref="alg3.23.23.m1.1.1.1.1.1.1"><times id="alg3.23.23.m1.1.1.1.1.1.1.1.cmml" xref="alg3.23.23.m1.1.1.1.1.1.1.1"></times><cn id="alg3.23.23.m1.1.1.1.1.1.1.2.cmml" type="integer" xref="alg3.23.23.m1.1.1.1.1.1.1.2">1</cn><ci id="alg3.23.23.m1.1.1.1.1.1.1.3.cmml" xref="alg3.23.23.m1.1.1.1.1.1.1.3">…</ci><ci id="alg3.23.23.m1.1.1.1.1.1.1.4.cmml" xref="alg3.23.23.m1.1.1.1.1.1.1.4">𝑚</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.23.23.m1.1c">\mathcal{M}\leftarrow\mathcal{M}[1\ldots m]</annotation><annotation encoding="application/x-llamapun" id="alg3.23.23.m1.1d">caligraphic_M ← caligraphic_M [ 1 … italic_m ]</annotation></semantics></math>;
</div>
<div class="ltx_listingline" id="alg3.24.35">
<span class="ltx_tag ltx_tag_listingline">15</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div class="ltx_listingline" id="alg3.24.24">
<span class="ltx_tag ltx_tag_listingline">16</span><span class="ltx_text ltx_font_typewriter" id="alg3.24.24.1">Return(<em class="ltx_emph ltx_font_serif ltx_font_italic" id="alg3.24.24.1.1"><math alttext="\mathcal{N}" class="ltx_Math" display="inline" id="alg3.24.24.1.1.m1.1"><semantics id="alg3.24.24.1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg3.24.24.1.1.m1.1.1" xref="alg3.24.24.1.1.m1.1.1.cmml">𝒩</mi><annotation-xml encoding="MathML-Content" id="alg3.24.24.1.1.m1.1b"><ci id="alg3.24.24.1.1.m1.1.1.cmml" xref="alg3.24.24.1.1.m1.1.1">𝒩</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.24.24.1.1.m1.1c">\mathcal{N}</annotation><annotation encoding="application/x-llamapun" id="alg3.24.24.1.1.m1.1d">caligraphic_N</annotation></semantics></math></em>)</span>
</div>
<div class="ltx_listingline" id="alg3.24.36">
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg3.26.1.1">Algorithm 3</span> </span>Branched sampling</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Additional results</h2>
<section class="ltx_subsection" id="A2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.1 </span>Impact of enlarged fingerprint length on performance</h3>
<div class="ltx_para ltx_noindent" id="A2.SS1.p1">
<p class="ltx_p" id="A2.SS1.p1.1">The length of Morgan fingerprints is a critical parameter that determines the resolution of molecular fingerprinting. Shorter fingerprint lengths can lead to bit collisions, where two similar molecules become indistinguishable due to the limited bit space <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib115" title="">115</a>]</cite>. However, directly predicting larger fingerprint lengths has proven challenging to scale (see Figure 14 in the SI of <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib65" title="">65</a>]</cite>), often necessitating a compromise at shorter lengths, such as 256 bits.</p>
</div>
<figure class="ltx_figure" id="A2.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="196" id="A2.F6.g1" src="x1.png" width="623"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Effect of fingerprint length (256, 512, 1024, and 2048) on reconstruction performance on molecules sampled from ChEMBL. The left panel shows the Reconstruction Rate, while the right panel displays the Average Similarity. Both metrics indicate that longer fingerprints enhance model performance. All models were trained for an identical wall time of 24 hours and used the same hyperparameters, except for the varying fingerprint lengths and the corresponding network widths.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="A2.SS1.p2">
<p class="ltx_p" id="A2.SS1.p2.1">The introduction of the diffusion module offers greater flexibility in handling longer fingerprint lengths. We trained models with varied fingerprint lengths (256, 512, 1024, and 2048 bits), all under identical conditions: a fixed training duration of 24 hours and consistent hyperparameters, except for adjustments in fingerprint length and the corresponding network widths. The models were evaluated on their reconstruction performance using ChEMBL samples, as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#A2.F6" title="Figure 6 ‣ B.1 Impact of enlarged fingerprint length on performance ‣ Appendix B Additional results ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_tag">6</span></a>. The results demonstrate that increasing the fingerprint length significantly enhances model performance, with a shift from 256 bits to 2048 bits resulting in an increase in the reconstruction rate from 8% to 12%, representing a 50% improvement. These findings indicate that the diffusion module not only strengthens the modeling of molecular fingerprints but also scales effectively to longer fingerprints, enabling more precise nearest neighbor searches with higher resolution.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_subsection" id="A2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.2 </span>Synthesizable analog generation</h3>
<div class="ltx_para ltx_noindent" id="A2.SS2.p1">
<p class="ltx_p" id="A2.SS2.p1.1">This section provides additional results for synthesizable analog generation, focusing on two sets of experiments: (1) finding synthesizable analogs for <span class="ltx_text ltx_font_italic" id="A2.SS2.p1.1.1">de novo</span> design efforts using the GuacaMol benchmark <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib76" title="">76</a>]</cite> (where scores range from 0 to 1, with higher scores indicating better performance), and (2) generating molecules with Pocket2Mol <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib82" title="">82</a>]</cite>, a structure-based design algorithm.</p>
</div>
<figure class="ltx_figure" id="A2.F7"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="311" id="A2.F7.g1" src="x2.png" width="623"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Relationship between similarity to the target molecule and the change in objective value. The contour plot shows the density of data points, indicating that higher similarity to the target molecule is generally associated with neutral changes in the objective value. This suggests that closer matches to the target tend to maintain the main objective score. The distribution highlights that a significant fraction of outputs exhibit neutral changes in objective scores.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="A2.SS2.p2">
<p class="ltx_p" id="A2.SS2.p2.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#A2.F7" title="Figure 7 ‣ B.2 Synthesizable analog generation ‣ Appendix B Additional results ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_tag">7</span></a> presents the density plot of all molecules generated for unsynthesizable designs within the GuacaMol benchmark, plotted along the similarity to the target axis and the change in the main objective score axis. The results indicate that a substantial fraction of generated molecules exhibit relatively neutral changes in the main objective score, suggesting that the primary design objectives are largely preserved during analog generation. This is particularly evident for molecules with higher similarity to the target, which are clustered around zero change in the objective value, demonstrating that structurally similar analogs tend to retain their original objective scores.</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS2.p3">
<p class="ltx_p" id="A2.SS2.p3.1">However, the distribution also reveals a region characterized by low similarity and significant negative changes in objective scores, indicating instances where the model fails to generate meaningful analogs. These cases often result in outputs resembling random generation, highlighting the model’s limitations in some regions of the chemical space. This failure is partly due to the limited coverage of the explored chemical space compared to the theoretical coverage and partly due to the unsynthesizable input molecule being too distant from the synthesizable chemical space, making the “projection” unrealistic or irrelevant.</p>
</div>
<figure class="ltx_figure" id="A2.F8"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="267" id="A2.F8.g1" src="x3.png" width="623"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Distribution of SA Scores for molecules designed using Pocket2Mol (denoted as Target) and their corresponding analogs (denoted as Analog). The shift of the Analog distribution towards lower SA Scores indicates that the generated analog molecules are generally easier to synthesize compared to the original designs from Pocket2Mol.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="A2.SS2.p4">
<p class="ltx_p" id="A2.SS2.p4.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#A2.F8" title="Figure 8 ‣ B.2 Synthesizable analog generation ‣ Appendix B Additional results ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_tag">8</span></a> illustrates the distribution of Synthetic Accessibility (SA) Scores for molecules designed using Pocket2Mol (labeled as Target) and their corresponding generated analogs (labeled as Analog). The plot reveals a noticeable shift in the Analog distribution towards lower SA Scores, suggesting that the analog molecules are generally easier to synthesize compared to the original Pocket2Mol designs.</p>
</div>
<figure class="ltx_figure" id="A2.F9"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="543" id="A2.F9.g1" src="extracted/5901987/figures/unsyn_additional1.png" width="509"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>Synthetic pathways for Perindopril MPO optimization examples as shown in the main text.</figcaption>
</figure>
<figure class="ltx_figure" id="A2.F10"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_portrait" height="633" id="A2.F10.g1" src="extracted/5901987/figures/unsyn_additional2.png" width="509"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span>Additional examples of synthesizable analog generation for previously unsynthesizable designs. Each panel shows the transformation from the target molecule (left) to the product molecule (right), with objective scores indicating the performance of each molecule in the optimization task. The synthetic routes for the synthesizable analogs are shown below each panel, demonstrating the practical feasibility of the proposed transformations.</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_subsection" id="A2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.3 </span>Hit expansion</h3>
<div class="ltx_para ltx_noindent" id="A2.SS3.p1">
<p class="ltx_p" id="A2.SS3.p1.1">This section provides additional results for hit expansion experiments, including (1) expanding hits from screening ZINC250k with activity predictors and (2) expanding from experimentally verified binders of disease targets.</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS3.p2">
<p class="ltx_p" id="A2.SS3.p2.2">In addition to JNK3, which is discussed in the main text, we also evaluated SynFormer on GSK3<math alttext="\beta" class="ltx_Math" display="inline" id="A2.SS3.p2.1.m1.1"><semantics id="A2.SS3.p2.1.m1.1a"><mi id="A2.SS3.p2.1.m1.1.1" xref="A2.SS3.p2.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="A2.SS3.p2.1.m1.1b"><ci id="A2.SS3.p2.1.m1.1.1.cmml" xref="A2.SS3.p2.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS3.p2.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="A2.SS3.p2.1.m1.1d">italic_β</annotation></semantics></math>. Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#A2.F11" title="Figure 11 ‣ B.3 Hit expansion ‣ Appendix B Additional results ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_tag">11</span></a> displays contour plots comparing the density of molecules generated by SynFormer with those identified by the nearest neighbor approach for both JNK3 and GSK3<math alttext="\beta" class="ltx_Math" display="inline" id="A2.SS3.p2.2.m2.1"><semantics id="A2.SS3.p2.2.m2.1a"><mi id="A2.SS3.p2.2.m2.1.1" xref="A2.SS3.p2.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="A2.SS3.p2.2.m2.1b"><ci id="A2.SS3.p2.2.m2.1.1.cmml" xref="A2.SS3.p2.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS3.p2.2.m2.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="A2.SS3.p2.2.m2.1d">italic_β</annotation></semantics></math>. These plots illustrate the performance differences between the two methods in lead expansion. Additionally, Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#A2.F12" title="Figure 12 ‣ B.3 Hit expansion ‣ Appendix B Additional results ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_tag">12</span></a> presents the top-10 molecules identified from screening the ZINC250k database using each activity predictor.</p>
</div>
<figure class="ltx_figure" id="A2.F11">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F11.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="593" id="A2.F11.1.g1" src="x4.png" width="830"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F11.2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="593" id="A2.F11.2.g1" src="x5.png" width="830"/>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 11: </span>Comparison of hit expansion performance between SynFormer (red contours) and Nearest Neighbor (blue contours) approaches for JNK3 (left) and GSK3<math alttext="\beta" class="ltx_Math" display="inline" id="A2.F11.4.m1.1"><semantics id="A2.F11.4.m1.1b"><mi id="A2.F11.4.m1.1.1" xref="A2.F11.4.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="A2.F11.4.m1.1c"><ci id="A2.F11.4.m1.1.1.cmml" xref="A2.F11.4.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.F11.4.m1.1d">\beta</annotation><annotation encoding="application/x-llamapun" id="A2.F11.4.m1.1e">italic_β</annotation></semantics></math> (right). The contour plots show inhibition scores versus Tanimoto similarity to the input hit compound. The dashed line represents the inhibition level of the best hit compound.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="A2.SS3.p3">
<p class="ltx_p" id="A2.SS3.p3.1">The density plots comparing analog discovery by nearest neighbor and SynFormer highlight that SynFormer consistently outperforms the nearest neighbor approach in identifying higher-scoring molecules in both tasks. As discussed in the main text, both SynFormer and nearest neighbor search identified molecules with predicted JNK3 inhibition scores higher than the best hits from initial screening, and SynFormer successfully found molecules with higher score than the highest one from the nearest neighbor search. For GSK3<math alttext="\beta" class="ltx_Math" display="inline" id="A2.SS3.p3.1.m1.1"><semantics id="A2.SS3.p3.1.m1.1a"><mi id="A2.SS3.p3.1.m1.1.1" xref="A2.SS3.p3.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="A2.SS3.p3.1.m1.1b"><ci id="A2.SS3.p3.1.m1.1.1.cmml" xref="A2.SS3.p3.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS3.p3.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="A2.SS3.p3.1.m1.1d">italic_β</annotation></semantics></math>, the nearest neighbor approach failed to find molecules approaching the highest inhibition values of the original hits, whereas SynFormer succeeded. This is also demonstrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#A2.F13" title="Figure 13 ‣ B.3 Hit expansion ‣ Appendix B Additional results ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_tag">13</span></a>. Although nearest neighbor search showed enrichment in regions of higher similarity to the input references, molecules with scores exceeding those of the input references were often found at moderate similarity levels, ranging from 0.5 to 0.8. This observation suggests that SynFormer’s ability to explore beyond close structural analogs allows it to identify more potent molecules while maintaining a reasonable balance between structural similarity and enhanced activity.</p>
</div>
<figure class="ltx_figure" id="A2.F12">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F12.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="240" id="A2.F12.sf1.g1" src="extracted/5901987/figures/hits_jnk.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span>Hits for JNK3 identified from screening the ZINC250k database, with the predicted probability of being active labeled above each hit.</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F12.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="240" id="A2.F12.sf2.g1" src="extracted/5901987/figures/hits_gsk.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span>Hits for GSK3<math alttext="\beta" class="ltx_Math" display="inline" id="A2.F12.sf2.2.m1.1"><semantics id="A2.F12.sf2.2.m1.1b"><mi id="A2.F12.sf2.2.m1.1.1" xref="A2.F12.sf2.2.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="A2.F12.sf2.2.m1.1c"><ci id="A2.F12.sf2.2.m1.1.1.cmml" xref="A2.F12.sf2.2.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.F12.sf2.2.m1.1d">\beta</annotation><annotation encoding="application/x-llamapun" id="A2.F12.sf2.2.m1.1e">italic_β</annotation></semantics></math> identified from screening the ZINC250k database, with the predicted probability of being active labeled above each hit.</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 12: </span>Hits identified from screening the ZINC250k database, which are subsequently used as inputs to the SynFormer for hit expansion.</figcaption>
</figure>
<figure class="ltx_figure" id="A2.F13"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="356" id="A2.F13.g1" src="x6.png" width="415"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 13: </span>Normalized density plots of inhibition scores for JNK3 (top) and GSK3<math alttext="\beta" class="ltx_Math" display="inline" id="A2.F13.2.m1.1"><semantics id="A2.F13.2.m1.1b"><mi id="A2.F13.2.m1.1.1" xref="A2.F13.2.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="A2.F13.2.m1.1c"><ci id="A2.F13.2.m1.1.1.cmml" xref="A2.F13.2.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.F13.2.m1.1d">\beta</annotation><annotation encoding="application/x-llamapun" id="A2.F13.2.m1.1e">italic_β</annotation></semantics></math> (bottom) showing the performance of SynFormer (red), nearest neighbor search (blue), and the initial ZINC250k screening (green). SynFormer consistently generates molecules with higher inhibition scores compared to the nearest neighbor and ZINC250k hits, demonstrating its superior capability in identifying potent analogs for both targets.</figcaption>
</figure>
<figure class="ltx_figure" id="A2.F14"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="413" id="A2.F14.g1" src="extracted/5901987/figures/jnk_analogs_si.png" width="509"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 14: </span>Additional examples of molecules generated from the hit against JNK3, along with their predicted inhibition scores between 0 and 1 and corresponding synthetic pathways.</figcaption>
</figure>
<figure class="ltx_figure" id="A2.F15"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="370" id="A2.F15.g1" src="extracted/5901987/figures/gsk_analogs_si.png" width="509"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 15: </span>Additional examples of molecules generated from the hit against GSK3<math alttext="\beta" class="ltx_Math" display="inline" id="A2.F15.2.m1.1"><semantics id="A2.F15.2.m1.1b"><mi id="A2.F15.2.m1.1.1" xref="A2.F15.2.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="A2.F15.2.m1.1c"><ci id="A2.F15.2.m1.1.1.cmml" xref="A2.F15.2.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.F15.2.m1.1d">\beta</annotation><annotation encoding="application/x-llamapun" id="A2.F15.2.m1.1e">italic_β</annotation></semantics></math>, along with their predicted inhibition scores between 0 and 1 and corresponding synthetic pathways.</figcaption>
</figure>
<figure class="ltx_figure" id="A2.F16"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="718" id="A2.F16.g1" src="extracted/5901987/figures/hit_exp_3me3.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 16: </span>Additional examples of molecules generated from the hit against PKM2.</figcaption>
</figure>
<figure class="ltx_figure" id="A2.F17"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="718" id="A2.F17.g1" src="extracted/5901987/figures/hit_exp_5mlj.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 17: </span>Additional examples of molecules generated from the hit against KAT2A.</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_subsection" id="A2.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.4 </span>Global chemical space exploration by <span class="ltx_text ltx_font_italic" id="A2.SS4.1.1">de novo</span> molecular optimization</h3>
<section class="ltx_subsubsection" id="A2.SS4.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">B.4.1 </span>Molecular optimization using reinforcement learning</h4>
<div class="ltx_para ltx_noindent" id="A2.SS4.SSS1.p1">
<p class="ltx_p" id="A2.SS4.SSS1.p1.1">This section describes additional results for using reinforcement learning to bias the generation of SynFormer-D toward high-scored molecules.</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS4.SSS1.p2">
<p class="ltx_p" id="A2.SS4.SSS1.p2.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#A2.F18.sf1" title="In Figure 18 ‣ B.4.1 Molecular optimization using reinforcement learning ‣ B.4 Global chemical space exploration by de novo molecular optimization ‣ Appendix B Additional results ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_tag">18(a)</span></a> presents the score distribution of molecules generated by the SynFormer model after exposure to 5,000, 10,000, 15,000, 20,000, 25,000, and 30,000 labeled molecules and their corresponding scores. As the model processes more score-labeled data, the generation progressively shifts toward higher-scoring regions, demonstrating the effectiveness of the reinforcement learning (RL) algorithm in guiding the model toward optimized outputs. Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#A2.F18.sf2" title="In Figure 18 ‣ B.4.1 Molecular optimization using reinforcement learning ‣ B.4 Global chemical space exploration by de novo molecular optimization ‣ Appendix B Additional results ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_tag">18(b)</span></a> shows the accumulation of the top-100 molecules throughout the optimization process. The results indicate that the model’s performance saturates at the maximum score of around 1.0 after approximately 18,000 oracle evaluations, confirming the RL approach’s ability to consistently identify top-performing molecules.</p>
</div>
<figure class="ltx_figure" id="A2.F18">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F18.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="249" id="A2.F18.sf1.g1" src="x7.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span>Score distribution of 200 molecules generated by SynFormer at different optimization steps, demonstrating that reinforcement learning effectively biases the generation distribution towards higher-scoring molecules.</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F18.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="249" id="A2.F18.sf2.g1" src="x8.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span>Score distribution of the accumulated top-100 molecules at various optimization steps, highlighting the progression and refinement of high-scoring molecules throughout the optimization process.</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 18: </span>Additional results for SF-RL, the fine-tuned version of SynFormer-D using an approach adapted from REINVENT.</figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="A2.SS4.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">B.4.2 </span>Molecular optimization using genetic algorithm</h4>
<div class="ltx_para ltx_noindent" id="A2.SS4.SSS2.p1">
<p class="ltx_p" id="A2.SS4.SSS2.p1.1">This section describes additional results for using a genetic algorithm with SynFormer-ED as a mutation.</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS4.SSS2.p2">
<p class="ltx_p" id="A2.SS4.SSS2.p2.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#A2.F19" title="Figure 19 ‣ B.4.2 Molecular optimization using genetic algorithm ‣ B.4 Global chemical space exploration by de novo molecular optimization ‣ Appendix B Additional results ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_tag">19</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#A2.F20" title="Figure 20 ‣ B.4.2 Molecular optimization using genetic algorithm ‣ B.4 Global chemical space exploration by de novo molecular optimization ‣ Appendix B Additional results ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_tag">20</span></a>, and <a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#A2.F21" title="Figure 21 ‣ B.4.2 Molecular optimization using genetic algorithm ‣ B.4 Global chemical space exploration by de novo molecular optimization ‣ Appendix B Additional results ‣ Generative artificial intelligence for navigating synthesizable chemical space"><span class="ltx_text ltx_ref_tag">21</span></a> display the distribution of SA Scores <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib42" title="">42</a>]</cite> for the top 25 molecules at various optimization steps during the optimization of Perindopril MPO, Ranolazine MPO, and Scaffold Hop, respectively. In these tasks, since the main objective functions do not penalize synthetic accessibility, the differences between the standard GraphGA and GraphGA-SF are less pronounced compared to those observed in the Sitagliptin MPO task discussed in the main text.</p>
</div>
<figure class="ltx_figure" id="A2.F19"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="385" id="A2.F19.g1" src="x9.png" width="540"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 19: </span>Distribution of SA Scores <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib42" title="">42</a>]</cite> for the top 25 molecules at various optimization steps, with colors representing objective scores.</figcaption>
</figure>
<figure class="ltx_figure" id="A2.F20"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="385" id="A2.F20.g1" src="x10.png" width="540"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 20: </span>Distribution of SA Scores <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib42" title="">42</a>]</cite> for the top 25 molecules at various optimization steps, with colors representing objective scores.</figcaption>
</figure>
<figure class="ltx_figure" id="A2.F21"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="385" id="A2.F21.g1" src="x11.png" width="540"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 21: </span>Distribution of SA Scores <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.03494v1#bib.bib42" title="">42</a>]</cite> for the top 25 molecules at various optimization steps, with colors representing objective scores.</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Fri Oct  4 15:05:19 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
