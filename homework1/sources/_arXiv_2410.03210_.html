<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness</title>
<!--Generated on Fri Oct  4 07:49:17 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="Machine learning,  Polyhedral compilation,  Code tansformation,  Correctness,  Compositionality,  Source to source" lang="en" name="keywords"/>
<base href="/html/2410.03210v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#S1" title="In Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#S2" title="In Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Background and Motivation</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#S2.SS1" title="In 2. Background and Motivation ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Correctness in ML-Based Code Auto-Generation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#S2.SS2" title="In 2. Background and Motivation ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>The Polyhedral Model</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#S2.SS3" title="In 2. Background and Motivation ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>Constraints of the Polyhedral Model</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#S3" title="In Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span><span class="ltx_text ltx_font_smallcaps">Tadashi</span>: A Library to Sample Legal Polyhedral Transformations</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#S3.SS1" title="In 3. Tadashi: A Library to Sample Legal Polyhedral Transformations ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Python Front-End: Polyhedral Made Easy</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#S3.SS1.SSS1" title="In 3.1. Python Front-End: Polyhedral Made Easy ‣ 3. Tadashi: A Library to Sample Legal Polyhedral Transformations ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1.1 </span>Sampling Strategies</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#S3.SS2" title="In 3. Tadashi: A Library to Sample Legal Polyhedral Transformations ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Using Different ML Methods With <span class="ltx_text ltx_font_smallcaps">Tadashi</span></span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#S3.SS2.SSS1" title="In 3.2. Using Different ML Methods With Tadashi ‣ 3. Tadashi: A Library to Sample Legal Polyhedral Transformations ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.1 </span>Reinforcement Learning (RL)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#S3.SS2.SSS2" title="In 3.2. Using Different ML Methods With Tadashi ‣ 3. Tadashi: A Library to Sample Legal Polyhedral Transformations ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.2 </span>Supervised Learning</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#S3.SS2.SSS3" title="In 3.2. Using Different ML Methods With Tadashi ‣ 3. Tadashi: A Library to Sample Legal Polyhedral Transformations ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.3 </span>Evolutionary Algorithms</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#S3.SS2.SSS4" title="In 3.2. Using Different ML Methods With Tadashi ‣ 3. Tadashi: A Library to Sample Legal Polyhedral Transformations ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.4 </span>With LLM Agents</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#S3.SS2.SSS5" title="In 3.2. Using Different ML Methods With Tadashi ‣ 3. Tadashi: A Library to Sample Legal Polyhedral Transformations ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.5 </span>Auto-Tuning</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#S3.SS2.SSS6" title="In 3.2. Using Different ML Methods With Tadashi ‣ 3. Tadashi: A Library to Sample Legal Polyhedral Transformations ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.6 </span>ML-driven deployment of applications on new hardware</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#S3.SS3" title="In 3. Tadashi: A Library to Sample Legal Polyhedral Transformations ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Extensibility of <span class="ltx_text ltx_font_smallcaps">Tadashi</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#S4" title="In Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Implementation of <span class="ltx_text ltx_font_smallcaps">Tadashi</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#S4.SS1" title="In 4. Implementation of Tadashi ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>The App Class</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#S4.SS2" title="In 4. Implementation of Tadashi ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>SCoPs</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#S4.SS3" title="In 4. Implementation of Tadashi ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Schedule Tree and Navigation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#S4.SS4" title="In 4. Implementation of Tadashi ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Transformations</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#S4.SS4.SSS1" title="In 4.4. Transformations ‣ 4. Implementation of Tadashi ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4.1 </span>Implementation Details of Individual Transformations</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#S4.SS4.SSS2" title="In 4.4. Transformations ‣ 4. Implementation of Tadashi ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4.2 </span>Extending <span class="ltx_text ltx_font_smallcaps">Tadashi</span> With New Transformations</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#S4.SS5" title="In 4. Implementation of Tadashi ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.5 </span>Legality Checking</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#S4.SS6" title="In 4. Implementation of Tadashi ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.6 </span>Code Generation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#S5" title="In Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Evaluation</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#S5.SS1" title="In 5. Evaluation ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Random-RL</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#S5.SS2" title="In 5. Evaluation ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Verification</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#S5.SS3" title="In 5. Evaluation ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>Performance</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#S6" title="In Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusion</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<div class="ltx_para" id="p1">
<p class="ltx_p" id="p1.1">1






</p>
</div>
<h1 class="ltx_title ltx_title_document">
<span class="ltx_text ltx_font_smallcaps" id="id1.id1">Tadashi</span>: Enabling AI-Based Automated Code Generation With Guaranteed Correctness</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Emil Vatai
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:emil.vatai@riken.jp">emil.vatai@riken.jp</a>
</span>
<span class="ltx_contact ltx_role_orcid"><a class="ltx_ref" href="https://orcid.org/0000-0001-7494-5048" title="ORCID identifier">0000-0001-7494-5048</a></span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id2.1.id1">RIKEN Center for Computational Science</span><span class="ltx_text ltx_affiliation_city" id="id3.2.id2">Kobe</span><span class="ltx_text ltx_affiliation_state" id="id4.3.id3">Hyogo</span><span class="ltx_text ltx_affiliation_country" id="id5.4.id4">Japan</span>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Aleksandr Drozd
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:aleksandr.drozd@riken.jp">aleksandr.drozd@riken.jp</a>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id6.1.id1">RIKEN Center for Computational Science</span><span class="ltx_text ltx_affiliation_city" id="id7.2.id2">Kobe</span><span class="ltx_text ltx_affiliation_state" id="id8.3.id3">Hyogo</span><span class="ltx_text ltx_affiliation_country" id="id9.4.id4">Japan</span>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Ivan R. Ivanov
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:ivanov.i.aa@m.titech.ac.jp">ivanov.i.aa@m.titech.ac.jp</a>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id10.1.id1">Tokyo Institute of Technology / RIKEN Center for Computational Science</span><span class="ltx_text ltx_affiliation_city" id="id11.2.id2">Kobe</span><span class="ltx_text ltx_affiliation_state" id="id12.3.id3">Hyogo</span><span class="ltx_text ltx_affiliation_country" id="id13.4.id4">Japan</span>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yinghao Ren
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:yinghaoren.cs@gmail.com">yinghaoren.cs@gmail.com</a>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id14.1.id1">SenseTime Research and PowerTensors.AI</span><span class="ltx_text ltx_affiliation_city" id="id15.2.id2">Shanghai</span><span class="ltx_text ltx_affiliation_country" id="id16.3.id3">China</span>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Mohamed Wahib
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:mohamed.attia@riken.jp">mohamed.attia@riken.jp</a>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id17.1.id1">RIKEN Center for Computational Science</span><span class="ltx_text ltx_affiliation_city" id="id18.2.id2">Kobe</span><span class="ltx_text ltx_affiliation_state" id="id19.3.id3">Hyogo</span><span class="ltx_text ltx_affiliation_country" id="id20.4.id4">Japan</span>
</span></span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p class="ltx_p" id="id21.id1">Frameworks and DSLs auto-generating code have traditionally relied on human experts developing them to have in place rigorous methods to assure the legality of the applied code transformations. Machine Learning (ML) is gaining wider adoption as a means to auto-generate code optimised for the hardware target. However, ML solutions, and in particular black-box DNNs, provide no such guarantees on legality. In this paper we propose a library, <span class="ltx_text ltx_font_smallcaps" id="id21.id1.1">Tadashi</span>, which leverages the polyhedral model to empower researchers seeking to curate datasets crucial for applying ML in code-generation. <span class="ltx_text ltx_font_smallcaps" id="id21.id1.2">Tadashi</span> provides the ability to reliably and practically check the legality of candidate transformations on polyhedral schedules applied on a baseline reference code. We provide a proof that our library guarantees the legality of generated transformations, and demonstrate its lightweight practical cost. <span class="ltx_text ltx_font_smallcaps" id="id21.id1.3">Tadashi</span> is available at <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/vatai/tadashi/" title="">https://github.com/vatai/tadashi/</a>.</p>
</div>
<div class="ltx_keywords">Machine learning, Polyhedral compilation, Code tansformation, Correctness, Compositionality, Source to source
</div>
<span class="ltx_note ltx_note_frontmatter ltx_role_conference" id="id1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">conference: </span>ACM The International Symposium on Code Generation and Optimization; March 01–05, 2024; Las Vegas, NV, USA</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_journalyear" id="id2"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journalyear: </span>2025</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_doi" id="id3"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">doi: </span></span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_copyright" id="id4"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>none</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id5"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Software and its engineering Source code generation</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id6"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Software and its engineering Correctness</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id7"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Software and its engineering Software performance</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id8"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Computer systems organization Embedded systems</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id9"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Computer systems organization Redundancy</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id10"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Computer systems organization Robotics</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id11"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Networks Network reliability</span></span></span>
<figure class="ltx_figure ltx_teaserfigure" id="S0.F1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="390" id="S0.F1.g1" src="x1.png" width="696"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S0.F1.5.1.1" style="font-size:90%;">Figure 1</span>. </span><span class="ltx_text ltx_font_smallcaps" id="S0.F1.6.2" style="font-size:90%;">Tadashi</span><span class="ltx_text" id="S0.F1.7.3" style="font-size:90%;"> provides a simple interface to allow different ML methods to sample from the massive combinatorial space of possible loop transformations, with assurance that the sampled transformation is <em class="ltx_emph ltx_font_italic" id="S0.F1.7.3.1">legal</em> (i.e., functionally correct). Using the polyhedral model, <span class="ltx_text ltx_font_smallcaps" id="S0.F1.7.3.2">Tadashi</span> is able to verify whether a transformation is legal or not, and generate the code with the legal transformations.</span></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="S0.F1.8">\Description</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S0.F1.9">Tadashi sampling the space of transformations</p>
</div>
</div>
</figure>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Machine learning (ML) is disrupting all forms of digital media, and the creation of computer programs is no exception.
ML can be and has been applied in various ways with the aim of making the work of programmers <cite class="ltx_cite ltx_citemacro_citep">(Dehaerne et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib16" title="">2022a</a>)</cite> easier: generating code from “natural languages” <cite class="ltx_cite ltx_citemacro_citep">(Phan, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib33" title="">2019</a>)</cite>, write a summary (e.g., write commit messages) of a piece of code <cite class="ltx_cite ltx_citemacro_citep">(Shido et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib37" title="">2019</a>)</cite>, auto-complete code on-the-fly while it’s being written <cite class="ltx_cite ltx_citemacro_citep">(Github, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib22" title="">[n. d.]</a>)</cite> etc.
In this paper, we consider the task of optimising code to a hardware target, i.e., using ML to transform the hotspots in the code, i.e., loops, in a way that improves performance.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Checking if the program generated by the ML model is faster then the baseline is just the matter of running it, then comparing against the run-time of the original code. However, it is a major challenge to get formal guarantees that the transformed code produces the same output as the original <cite class="ltx_cite ltx_citemacro_citep">(Dehaerne et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib17" title="">2022b</a>; Munoz et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib31" title="">2024</a>; Jiang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib25" title="">2024</a>)</cite>. This impedes the adoption of ML for code generation and transformation in mission critical scientific/engineering codes, or codes that come with high liability, such as in the financial, legal, and corporate sectors. Additionally, there is a lack of tooling for generating and sharing parameterised datasets comprised of legal auto-generated code, which further constraints progress in the field since, to date, ML-based solutions have to curate their datasets.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">To this end, we developed <span class="ltx_text ltx_font_smallcaps" id="S1.p3.1.1">Tadashi</span>, a Python library for sampling the search space of possible loops transformations, with the capability to verify the legality (i.e., correctness) of the sampled transformations. <span class="ltx_text ltx_font_smallcaps" id="S1.p3.1.2">Tadashi</span> allows the user to programmatically specify the pattern for sampling legal individual or combinations of transformations, based on the preference of the ML method that would be used to explore the search space of transformations. Through the use of the polyhedral model, <span class="ltx_text ltx_font_smallcaps" id="S1.p3.1.3">Tadashi</span> is capable of enabling ML engineers to explore novel and more aggressive methods of code optimisation in the datasets they curate, while guaranteeing that the results of the generated code are functionally identical to the original program. <span class="ltx_text ltx_font_smallcaps" id="S1.p3.1.4">Tadashi</span> key point is the ease-of-use for ML practitioners; <span class="ltx_text ltx_font_smallcaps" id="S1.p3.1.5">Tadashi</span> aims to provide a simple Python interface, which can be used to curate datasets or perform direct code-generation to be used with different ML approaches.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">In this paper, we make the following contributions:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We introduce <span class="ltx_text ltx_font_smallcaps" id="S1.I1.i1.p1.1.1">Tadashi</span>, a Python library designed for ML practitioners seeking to design tools for code auto generation with correctness guarantees. <span class="ltx_text ltx_font_smallcaps" id="S1.I1.i1.p1.1.2">Tadashi</span> lowers the barrier to entry of polyhedral loop transformations; a model that can give mathematically provable guarantees on the correctness (i.e., legality) of the transformed code.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">We demonstrate how <span class="ltx_text ltx_font_smallcaps" id="S1.I1.i2.p1.1.1">Tadashi</span> can be used by an ML system by implementing an end-to-end stub reinforcement learning system.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">We evaluate performance to confirm it is not an obstacle in <span class="ltx_text ltx_font_smallcaps" id="S1.I1.i3.p1.1.1">Tadashi</span>’s adoption. We observe throughput measurements above 32 transformations and legality checks per second, going up to 781 for some benchmarks. The overheads of parsing and generating code is negligible in comparison to compiling and running the generated code.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Background and Motivation</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">In this section we discuss the motivation for designing a library that leverages the polyhedral model as bases for guaranteeing correctness of ML-driven code generation.</p>
</div>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1. </span>Correctness in ML-Based Code Auto-Generation</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">ML is being increasingly used in code auto-generation, at different levels of abstraction, e.g., source code <cite class="ltx_cite ltx_citemacro_citep">(Stein et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib39" title="">2020</a>)</cite>, abstract syntax tree (AST) <cite class="ltx_cite ltx_citemacro_citep">(Shido et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib37" title="">2019</a>)</cite>, polyhedral <cite class="ltx_cite ltx_citemacro_citep">(Baghdadi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib5" title="">2021</a>)</cite>, dependency graphs <cite class="ltx_cite ltx_citemacro_citep">(Cummins et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib13" title="">2020</a>)</cite>, intermediate Representations (IR) <cite class="ltx_cite ltx_citemacro_citep">(Ben-Nun et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib7" title="">2018</a>)</cite>, and assembly instructions <cite class="ltx_cite ltx_citemacro_citep">(Mankowitz et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib29" title="">2023</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S2.SS1.p2">
<p class="ltx_p" id="S2.SS1.p2.1">For guarantees on correctness, existing approaches for using ML in code generation or transformation rely on one of the following approaches:</p>
<ul class="ltx_itemize" id="S2.I1">
<li class="ltx_item" id="S2.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S2.I1.i1.p1">
<p class="ltx_p" id="S2.I1.i1.p1.1">Extensive unit testing: for this, widely used, approach, a suite of unit tests is used to validate correctness <cite class="ltx_cite ltx_citemacro_citep">(Cummins et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib15" title="">2024</a>; Beer et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib6" title="">2024</a>; Du et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib18" title="">2024</a>; Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib10" title="">2021</a>)</cite>. While unit testing can be effective, it provides no guarantees on correctness<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>”<span class="ltx_text ltx_font_italic" id="footnote1.1">Program testing can be used to show the presence of bugs, but never to show their absence!</span>”– Edsger W. Dijkstra</span></span></span>.</p>
</div>
</li>
<li class="ltx_item" id="S2.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S2.I1.i2.p1">
<p class="ltx_p" id="S2.I1.i2.p1.1">Training a surrogate model to predict correctness: this involves training a model or developing an empirical cost model to predict the correctness <cite class="ltx_cite ltx_citemacro_citep">(Mankowitz et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib29" title="">2023</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib48" title="">2024</a>)</cite>.</p>
</div>
</li>
<li class="ltx_item" id="S2.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S2.I1.i3.p1">
<p class="ltx_p" id="S2.I1.i3.p1.1">Limit the use of ML to small affine sequence of operations that could be validated by comparing the generated output to the canonical output <cite class="ltx_cite ltx_citemacro_citep">(Liang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib28" title="">2023</a>; Cummins et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib14" title="">2023</a>)</cite></p>
</div>
</li>
<li class="ltx_item" id="S2.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S2.I1.i4.p1">
<p class="ltx_p" id="S2.I1.i4.p1.1">Limit the use of ML to generating code based on pre-determined target-specific optimizations used in code of similar compute profile <cite class="ltx_cite ltx_citemacro_citep">(Trümper et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib41" title="">2023</a>)</cite>, or pre-determined optimizations in code manuals <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib51" title="">2023</a>)</cite>.</p>
</div>
</li>
<li class="ltx_item" id="S2.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S2.I1.i5.p1">
<p class="ltx_p" id="S2.I1.i5.p1.1">use symbolic execution <cite class="ltx_cite ltx_citemacro_citep">(Cotroneo et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib12" title="">2024</a>)</cite> or round-trip execution <cite class="ltx_cite ltx_citemacro_citep">(Allamanis et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib3" title="">2024</a>)</cite> to assess whether the AI-generated code behaves as a reference implementation.</p>
</div>
</li>
</ul>
<p class="ltx_p" id="S2.SS1.p2.2">In summary, the approaches above either provide no formal guarantee on functional correctness, or confine the user to a very constrained form of code generation. In addition, we observed that for the above approaches, it was the burden of the researchers to implement a sampling strategy and curate the dataset. Solving those two problems, correctness and agency, is the motivation for <span class="ltx_text ltx_font_smallcaps" id="S2.SS1.p2.2.1">Tadashi</span>.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2. </span>The Polyhedral Model</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">Polyhedral techniques have a long history with one of the seminal papers dating back to 1996 <cite class="ltx_cite ltx_citemacro_citep">(Feautrier, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib20" title="">1996</a>)</cite> and are well established and used in compilers <cite class="ltx_cite ltx_citemacro_citep">(Aho et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib2" title="">2007</a>)</cite>. The polyhedral model is a very efficient way to manipulate and reason about nested loops, including the capability to check the <em class="ltx_emph ltx_font_italic" id="S2.SS2.p1.1.1">legality</em><span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>Legality is the technical term, used in the polyhedral literature with a precise definition which translates to the transformed code calculating the same results as the original, i.e., functional correctness.</span></span></span> of the transformations. It has been used in optimization pass of compilers <cite class="ltx_cite ltx_citemacro_citep">(Grosser et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib23" title="">2012</a>)</cite>, as well as standalone source-to-source optimization tools <cite class="ltx_cite ltx_citemacro_citep">(Bondhugula et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib8" title="">2008</a>; Verdoolaege et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib44" title="">2013</a>)</cite> relying on integer linear programming with some optimization heuristic.</p>
</div>
<figure class="ltx_float ltx_lstlisting" id="LST1">
<div class="ltx_listing ltx_lst_language_C ltx_lst_numbers_left ltx_lstlisting ltx_framed ltx_framed_topbottom ltx_listing" id="LST1.7">
<div class="ltx_listing_data"><a download="" href="data:text/plain;base64,Zm9yKGludCBpID0gMDsgaSA8IE47IGkrKykKICBmb3IoaW50IGogPSAxOyBqIDwgTTsgaisrKQogICAgQVtpLCBqXSArPSBBW2ksIGotMV07IC8qQCBcbGFiZWx7bGluZTpzdG10fSBAKi8=">⬇</a></div>
<div class="ltx_listingline" id="lstnumberx1">
<span class="ltx_tag ltx_tag_listingline">1</span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter ltx_font_bold" id="lstnumberx1.1" style="font-size:90%;">for</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx1.2" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter ltx_font_bold" id="lstnumberx1.3" style="font-size:90%;">int</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx1.4" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx1.5" style="font-size:90%;">i</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx1.6" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx1.7" style="font-size:90%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx1.8" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx1.9" style="font-size:90%;">0;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx1.10" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx1.11" style="font-size:90%;">i</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx1.12" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx1.13" style="font-size:90%;">&lt;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx1.14" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx1.15" style="font-size:90%;">N</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx1.16" style="font-size:90%;">;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx1.17" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx1.18" style="font-size:90%;">i</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx1.19" style="font-size:90%;">++)</span>
</div>
<div class="ltx_listingline" id="lstnumberx2">
<span class="ltx_tag ltx_tag_listingline">2</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx2.1" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter ltx_font_bold" id="lstnumberx2.2" style="font-size:90%;">for</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx2.3" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter ltx_font_bold" id="lstnumberx2.4" style="font-size:90%;">int</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx2.5" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx2.6" style="font-size:90%;">j</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx2.7" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx2.8" style="font-size:90%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx2.9" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx2.10" style="font-size:90%;">1;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx2.11" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx2.12" style="font-size:90%;">j</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx2.13" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx2.14" style="font-size:90%;">&lt;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx2.15" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx2.16" style="font-size:90%;">M</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx2.17" style="font-size:90%;">;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx2.18" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx2.19" style="font-size:90%;">j</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx2.20" style="font-size:90%;">++)</span>
</div>
<div class="ltx_listingline" id="lstnumberx3">
<span class="ltx_tag ltx_tag_listingline">3</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx3.1" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx3.2" style="font-size:90%;">A</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx3.3" style="font-size:90%;">[</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx3.4" style="font-size:90%;">i</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx3.5" style="font-size:90%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx3.6" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx3.7" style="font-size:90%;">j</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx3.8" style="font-size:90%;">]</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx3.9" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx3.10" style="font-size:90%;">+=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx3.11" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx3.12" style="font-size:90%;">A</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx3.13" style="font-size:90%;">[</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx3.14" style="font-size:90%;">i</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx3.15" style="font-size:90%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx3.16" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx3.17" style="font-size:90%;">j</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx3.18" style="font-size:90%;">-1];</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx3.19" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_comment ltx_font_typewriter ltx_font_italic" id="lstnumberx3.20" style="font-size:90%;">/*@<span class="ltx_text ltx_lst_space" id="lstnumberx3.20.1"> </span>\label{line:stmt}<span class="ltx_text ltx_lst_space" id="lstnumberx3.20.2"> </span>@*/</span>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float">Listing 1: </span>
A simple SCoP example with a single statement on line <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:line:stmt</span>, The statement ha <math alttext="N\times(M-1)" class="ltx_Math" display="inline" id="LST1.4.m1.1"><semantics id="LST1.4.m1.1b"><mrow id="LST1.4.m1.1.1" xref="LST1.4.m1.1.1.cmml"><mi id="LST1.4.m1.1.1.3" xref="LST1.4.m1.1.1.3.cmml">N</mi><mo id="LST1.4.m1.1.1.2" lspace="0.222em" rspace="0.222em" xref="LST1.4.m1.1.1.2.cmml">×</mo><mrow id="LST1.4.m1.1.1.1.1" xref="LST1.4.m1.1.1.1.1.1.cmml"><mo id="LST1.4.m1.1.1.1.1.2" stretchy="false" xref="LST1.4.m1.1.1.1.1.1.cmml">(</mo><mrow id="LST1.4.m1.1.1.1.1.1" xref="LST1.4.m1.1.1.1.1.1.cmml"><mi id="LST1.4.m1.1.1.1.1.1.2" xref="LST1.4.m1.1.1.1.1.1.2.cmml">M</mi><mo id="LST1.4.m1.1.1.1.1.1.1" xref="LST1.4.m1.1.1.1.1.1.1.cmml">−</mo><mn id="LST1.4.m1.1.1.1.1.1.3" xref="LST1.4.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="LST1.4.m1.1.1.1.1.3" stretchy="false" xref="LST1.4.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="LST1.4.m1.1c"><apply id="LST1.4.m1.1.1.cmml" xref="LST1.4.m1.1.1"><times id="LST1.4.m1.1.1.2.cmml" xref="LST1.4.m1.1.1.2"></times><ci id="LST1.4.m1.1.1.3.cmml" xref="LST1.4.m1.1.1.3">𝑁</ci><apply id="LST1.4.m1.1.1.1.1.1.cmml" xref="LST1.4.m1.1.1.1.1"><minus id="LST1.4.m1.1.1.1.1.1.1.cmml" xref="LST1.4.m1.1.1.1.1.1.1"></minus><ci id="LST1.4.m1.1.1.1.1.1.2.cmml" xref="LST1.4.m1.1.1.1.1.1.2">𝑀</ci><cn id="LST1.4.m1.1.1.1.1.1.3.cmml" type="integer" xref="LST1.4.m1.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="LST1.4.m1.1d">N\times(M-1)</annotation><annotation encoding="application/x-llamapun" id="LST1.4.m1.1e">italic_N × ( italic_M - 1 )</annotation></semantics></math> instances identified by the iterator vector <math alttext="(i,j)" class="ltx_Math" display="inline" id="LST1.5.m2.2"><semantics id="LST1.5.m2.2b"><mrow id="LST1.5.m2.2.3.2" xref="LST1.5.m2.2.3.1.cmml"><mo id="LST1.5.m2.2.3.2.1" stretchy="false" xref="LST1.5.m2.2.3.1.cmml">(</mo><mi id="LST1.5.m2.1.1" xref="LST1.5.m2.1.1.cmml">i</mi><mo id="LST1.5.m2.2.3.2.2" xref="LST1.5.m2.2.3.1.cmml">,</mo><mi id="LST1.5.m2.2.2" xref="LST1.5.m2.2.2.cmml">j</mi><mo id="LST1.5.m2.2.3.2.3" stretchy="false" xref="LST1.5.m2.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="LST1.5.m2.2c"><interval closure="open" id="LST1.5.m2.2.3.1.cmml" xref="LST1.5.m2.2.3.2"><ci id="LST1.5.m2.1.1.cmml" xref="LST1.5.m2.1.1">𝑖</ci><ci id="LST1.5.m2.2.2.cmml" xref="LST1.5.m2.2.2">𝑗</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="LST1.5.m2.2d">(i,j)</annotation><annotation encoding="application/x-llamapun" id="LST1.5.m2.2e">( italic_i , italic_j )</annotation></semantics></math>, in general denoted as the integer vector <math alttext="\vec{i}" class="ltx_Math" display="inline" id="LST1.6.m3.1"><semantics id="LST1.6.m3.1b"><mover accent="true" id="LST1.6.m3.1.1" xref="LST1.6.m3.1.1.cmml"><mi id="LST1.6.m3.1.1.2" xref="LST1.6.m3.1.1.2.cmml">i</mi><mo id="LST1.6.m3.1.1.1" stretchy="false" xref="LST1.6.m3.1.1.1.cmml">→</mo></mover><annotation-xml encoding="MathML-Content" id="LST1.6.m3.1c"><apply id="LST1.6.m3.1.1.cmml" xref="LST1.6.m3.1.1"><ci id="LST1.6.m3.1.1.1.cmml" xref="LST1.6.m3.1.1.1">→</ci><ci id="LST1.6.m3.1.1.2.cmml" xref="LST1.6.m3.1.1.2">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="LST1.6.m3.1d">\vec{i}</annotation><annotation encoding="application/x-llamapun" id="LST1.6.m3.1e">over→ start_ARG italic_i end_ARG</annotation></semantics></math>.
</figcaption>
</figure>
<div class="ltx_para" id="S2.SS2.p2">
<p class="ltx_p" id="S2.SS2.p2.3">The polyhedral model is a representation for loop nests with regular boundaries and memory accesses, know as <em class="ltx_emph ltx_font_italic" id="S2.SS2.p2.3.1">static control parts</em> (see Listing <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#LST1" title="Listing 1 ‣ 2.2. The Polyhedral Model ‣ 2. Background and Motivation ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">1</span></a> an example and Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#S2.SS3" title="2.3. Constraints of the Polyhedral Model ‣ 2. Background and Motivation ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">2.3</span></a> for a description). The polyhedral representation separates the statement instances from the order in which they are executed: Each of these instances is then mapped to an integer tuple, a timestamp, and then the statement instances are ordered according the lexicographical order of their timestamps. For a given statement <math alttext="S" class="ltx_Math" display="inline" id="S2.SS2.p2.1.m1.1"><semantics id="S2.SS2.p2.1.m1.1a"><mi id="S2.SS2.p2.1.m1.1.1" xref="S2.SS2.p2.1.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.m1.1b"><ci id="S2.SS2.p2.1.m1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.1.m1.1c">S</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.1.m1.1d">italic_S</annotation></semantics></math>, the set of statement instances is called the <em class="ltx_emph ltx_font_italic" id="S2.SS2.p2.3.2">domain</em> and is denoted as <math alttext="\mathcal{D}_{S}" class="ltx_Math" display="inline" id="S2.SS2.p2.2.m2.1"><semantics id="S2.SS2.p2.2.m2.1a"><msub id="S2.SS2.p2.2.m2.1.1" xref="S2.SS2.p2.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p2.2.m2.1.1.2" xref="S2.SS2.p2.2.m2.1.1.2.cmml">𝒟</mi><mi id="S2.SS2.p2.2.m2.1.1.3" xref="S2.SS2.p2.2.m2.1.1.3.cmml">S</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.2.m2.1b"><apply id="S2.SS2.p2.2.m2.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.2.m2.1.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S2.SS2.p2.2.m2.1.1.2.cmml" xref="S2.SS2.p2.2.m2.1.1.2">𝒟</ci><ci id="S2.SS2.p2.2.m2.1.1.3.cmml" xref="S2.SS2.p2.2.m2.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.2.m2.1c">\mathcal{D}_{S}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.2.m2.1d">caligraphic_D start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT</annotation></semantics></math>; while the mapping which determines their order is the <em class="ltx_emph ltx_font_italic" id="S2.SS2.p2.3.3">schedule</em>, which is denoted by <math alttext="\theta_{S}" class="ltx_Math" display="inline" id="S2.SS2.p2.3.m3.1"><semantics id="S2.SS2.p2.3.m3.1a"><msub id="S2.SS2.p2.3.m3.1.1" xref="S2.SS2.p2.3.m3.1.1.cmml"><mi id="S2.SS2.p2.3.m3.1.1.2" xref="S2.SS2.p2.3.m3.1.1.2.cmml">θ</mi><mi id="S2.SS2.p2.3.m3.1.1.3" xref="S2.SS2.p2.3.m3.1.1.3.cmml">S</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.3.m3.1b"><apply id="S2.SS2.p2.3.m3.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.3.m3.1.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1">subscript</csymbol><ci id="S2.SS2.p2.3.m3.1.1.2.cmml" xref="S2.SS2.p2.3.m3.1.1.2">𝜃</ci><ci id="S2.SS2.p2.3.m3.1.1.3.cmml" xref="S2.SS2.p2.3.m3.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.3.m3.1c">\theta_{S}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.3.m3.1d">italic_θ start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT</annotation></semantics></math>. Listing <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#LST1" title="Listing 1 ‣ 2.2. The Polyhedral Model ‣ 2. Background and Motivation ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">1</span></a> and Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#S2.F2.sf4" title="In Figure 2 ‣ 2.2. The Polyhedral Model ‣ 2. Background and Motivation ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">2(d)</span></a> give a simple example of a SCoP and possible schedules.</p>
</div>
<div class="ltx_para" id="S2.SS2.p3">
<p class="ltx_p" id="S2.SS2.p3.2">The main idea of polyhedral optimization is to transform the schedule (or create a new one from scratch) which reorders the statement instances so they are executed more efficiently on a given hardware (e.g., by increasing memory locality).
As one could expect, not all schedule transformations are legal, however checking legality is very convenient in the polyhedral model.
Dependency analysis <cite class="ltx_cite ltx_citemacro_citep">(Feautrier, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib19" title="">1991</a>)</cite> yields a directed <em class="ltx_emph ltx_font_italic" id="S2.SS2.p3.2.1">dependecy graph</em> <math alttext="G" class="ltx_Math" display="inline" id="S2.SS2.p3.1.m1.1"><semantics id="S2.SS2.p3.1.m1.1a"><mi id="S2.SS2.p3.1.m1.1.1" xref="S2.SS2.p3.1.m1.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.1.m1.1b"><ci id="S2.SS2.p3.1.m1.1.1.cmml" xref="S2.SS2.p3.1.m1.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.1.m1.1c">G</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p3.1.m1.1d">italic_G</annotation></semantics></math>.
The vertices of <math alttext="G" class="ltx_Math" display="inline" id="S2.SS2.p3.2.m2.1"><semantics id="S2.SS2.p3.2.m2.1a"><mi id="S2.SS2.p3.2.m2.1.1" xref="S2.SS2.p3.2.m2.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.2.m2.1b"><ci id="S2.SS2.p3.2.m2.1.1.cmml" xref="S2.SS2.p3.2.m2.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.2.m2.1c">G</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p3.2.m2.1d">italic_G</annotation></semantics></math> are statements (or equivalently their domains), and the edges are labelled with maps which describe the dependencies on the level of statement instances such as</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(1)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="S_{i}[\vec{d}]\mapsto S_{j}[\vec{r}]" class="ltx_Math" display="block" id="S2.E1.m1.2"><semantics id="S2.E1.m1.2a"><mrow id="S2.E1.m1.2.3" xref="S2.E1.m1.2.3.cmml"><mrow id="S2.E1.m1.2.3.2" xref="S2.E1.m1.2.3.2.cmml"><msub id="S2.E1.m1.2.3.2.2" xref="S2.E1.m1.2.3.2.2.cmml"><mi id="S2.E1.m1.2.3.2.2.2" xref="S2.E1.m1.2.3.2.2.2.cmml">S</mi><mi id="S2.E1.m1.2.3.2.2.3" xref="S2.E1.m1.2.3.2.2.3.cmml">i</mi></msub><mo id="S2.E1.m1.2.3.2.1" xref="S2.E1.m1.2.3.2.1.cmml">⁢</mo><mrow id="S2.E1.m1.2.3.2.3.2" xref="S2.E1.m1.2.3.2.3.1.cmml"><mo id="S2.E1.m1.2.3.2.3.2.1" stretchy="false" xref="S2.E1.m1.2.3.2.3.1.1.cmml">[</mo><mover accent="true" id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml"><mi id="S2.E1.m1.1.1.2" xref="S2.E1.m1.1.1.2.cmml">d</mi><mo id="S2.E1.m1.1.1.1" stretchy="false" xref="S2.E1.m1.1.1.1.cmml">→</mo></mover><mo id="S2.E1.m1.2.3.2.3.2.2" stretchy="false" xref="S2.E1.m1.2.3.2.3.1.1.cmml">]</mo></mrow></mrow><mo id="S2.E1.m1.2.3.1" stretchy="false" xref="S2.E1.m1.2.3.1.cmml">↦</mo><mrow id="S2.E1.m1.2.3.3" xref="S2.E1.m1.2.3.3.cmml"><msub id="S2.E1.m1.2.3.3.2" xref="S2.E1.m1.2.3.3.2.cmml"><mi id="S2.E1.m1.2.3.3.2.2" xref="S2.E1.m1.2.3.3.2.2.cmml">S</mi><mi id="S2.E1.m1.2.3.3.2.3" xref="S2.E1.m1.2.3.3.2.3.cmml">j</mi></msub><mo id="S2.E1.m1.2.3.3.1" xref="S2.E1.m1.2.3.3.1.cmml">⁢</mo><mrow id="S2.E1.m1.2.3.3.3.2" xref="S2.E1.m1.2.3.3.3.1.cmml"><mo id="S2.E1.m1.2.3.3.3.2.1" stretchy="false" xref="S2.E1.m1.2.3.3.3.1.1.cmml">[</mo><mover accent="true" id="S2.E1.m1.2.2" xref="S2.E1.m1.2.2.cmml"><mi id="S2.E1.m1.2.2.2" xref="S2.E1.m1.2.2.2.cmml">r</mi><mo id="S2.E1.m1.2.2.1" stretchy="false" xref="S2.E1.m1.2.2.1.cmml">→</mo></mover><mo id="S2.E1.m1.2.3.3.3.2.2" stretchy="false" xref="S2.E1.m1.2.3.3.3.1.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.2b"><apply id="S2.E1.m1.2.3.cmml" xref="S2.E1.m1.2.3"><csymbol cd="latexml" id="S2.E1.m1.2.3.1.cmml" xref="S2.E1.m1.2.3.1">maps-to</csymbol><apply id="S2.E1.m1.2.3.2.cmml" xref="S2.E1.m1.2.3.2"><times id="S2.E1.m1.2.3.2.1.cmml" xref="S2.E1.m1.2.3.2.1"></times><apply id="S2.E1.m1.2.3.2.2.cmml" xref="S2.E1.m1.2.3.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.2.3.2.2.1.cmml" xref="S2.E1.m1.2.3.2.2">subscript</csymbol><ci id="S2.E1.m1.2.3.2.2.2.cmml" xref="S2.E1.m1.2.3.2.2.2">𝑆</ci><ci id="S2.E1.m1.2.3.2.2.3.cmml" xref="S2.E1.m1.2.3.2.2.3">𝑖</ci></apply><apply id="S2.E1.m1.2.3.2.3.1.cmml" xref="S2.E1.m1.2.3.2.3.2"><csymbol cd="latexml" id="S2.E1.m1.2.3.2.3.1.1.cmml" xref="S2.E1.m1.2.3.2.3.2.1">delimited-[]</csymbol><apply id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1"><ci id="S2.E1.m1.1.1.1.cmml" xref="S2.E1.m1.1.1.1">→</ci><ci id="S2.E1.m1.1.1.2.cmml" xref="S2.E1.m1.1.1.2">𝑑</ci></apply></apply></apply><apply id="S2.E1.m1.2.3.3.cmml" xref="S2.E1.m1.2.3.3"><times id="S2.E1.m1.2.3.3.1.cmml" xref="S2.E1.m1.2.3.3.1"></times><apply id="S2.E1.m1.2.3.3.2.cmml" xref="S2.E1.m1.2.3.3.2"><csymbol cd="ambiguous" id="S2.E1.m1.2.3.3.2.1.cmml" xref="S2.E1.m1.2.3.3.2">subscript</csymbol><ci id="S2.E1.m1.2.3.3.2.2.cmml" xref="S2.E1.m1.2.3.3.2.2">𝑆</ci><ci id="S2.E1.m1.2.3.3.2.3.cmml" xref="S2.E1.m1.2.3.3.2.3">𝑗</ci></apply><apply id="S2.E1.m1.2.3.3.3.1.cmml" xref="S2.E1.m1.2.3.3.3.2"><csymbol cd="latexml" id="S2.E1.m1.2.3.3.3.1.1.cmml" xref="S2.E1.m1.2.3.3.3.2.1">delimited-[]</csymbol><apply id="S2.E1.m1.2.2.cmml" xref="S2.E1.m1.2.2"><ci id="S2.E1.m1.2.2.1.cmml" xref="S2.E1.m1.2.2.1">→</ci><ci id="S2.E1.m1.2.2.2.cmml" xref="S2.E1.m1.2.2.2">𝑟</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.2c">S_{i}[\vec{d}]\mapsto S_{j}[\vec{r}]</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.2d">italic_S start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT [ over→ start_ARG italic_d end_ARG ] ↦ italic_S start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT [ over→ start_ARG italic_r end_ARG ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.p3.10">Applying the schedule <math alttext="\theta" class="ltx_Math" display="inline" id="S2.SS2.p3.3.m1.1"><semantics id="S2.SS2.p3.3.m1.1a"><mi id="S2.SS2.p3.3.m1.1.1" xref="S2.SS2.p3.3.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.3.m1.1b"><ci id="S2.SS2.p3.3.m1.1.1.cmml" xref="S2.SS2.p3.3.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.3.m1.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p3.3.m1.1d">italic_θ</annotation></semantics></math> to the dependee <math alttext="S_{i}[\vec{d}]" class="ltx_Math" display="inline" id="S2.SS2.p3.4.m2.1"><semantics id="S2.SS2.p3.4.m2.1a"><mrow id="S2.SS2.p3.4.m2.1.2" xref="S2.SS2.p3.4.m2.1.2.cmml"><msub id="S2.SS2.p3.4.m2.1.2.2" xref="S2.SS2.p3.4.m2.1.2.2.cmml"><mi id="S2.SS2.p3.4.m2.1.2.2.2" xref="S2.SS2.p3.4.m2.1.2.2.2.cmml">S</mi><mi id="S2.SS2.p3.4.m2.1.2.2.3" xref="S2.SS2.p3.4.m2.1.2.2.3.cmml">i</mi></msub><mo id="S2.SS2.p3.4.m2.1.2.1" xref="S2.SS2.p3.4.m2.1.2.1.cmml">⁢</mo><mrow id="S2.SS2.p3.4.m2.1.2.3.2" xref="S2.SS2.p3.4.m2.1.2.3.1.cmml"><mo id="S2.SS2.p3.4.m2.1.2.3.2.1" stretchy="false" xref="S2.SS2.p3.4.m2.1.2.3.1.1.cmml">[</mo><mover accent="true" id="S2.SS2.p3.4.m2.1.1" xref="S2.SS2.p3.4.m2.1.1.cmml"><mi id="S2.SS2.p3.4.m2.1.1.2" xref="S2.SS2.p3.4.m2.1.1.2.cmml">d</mi><mo id="S2.SS2.p3.4.m2.1.1.1" stretchy="false" xref="S2.SS2.p3.4.m2.1.1.1.cmml">→</mo></mover><mo id="S2.SS2.p3.4.m2.1.2.3.2.2" stretchy="false" xref="S2.SS2.p3.4.m2.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.4.m2.1b"><apply id="S2.SS2.p3.4.m2.1.2.cmml" xref="S2.SS2.p3.4.m2.1.2"><times id="S2.SS2.p3.4.m2.1.2.1.cmml" xref="S2.SS2.p3.4.m2.1.2.1"></times><apply id="S2.SS2.p3.4.m2.1.2.2.cmml" xref="S2.SS2.p3.4.m2.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.p3.4.m2.1.2.2.1.cmml" xref="S2.SS2.p3.4.m2.1.2.2">subscript</csymbol><ci id="S2.SS2.p3.4.m2.1.2.2.2.cmml" xref="S2.SS2.p3.4.m2.1.2.2.2">𝑆</ci><ci id="S2.SS2.p3.4.m2.1.2.2.3.cmml" xref="S2.SS2.p3.4.m2.1.2.2.3">𝑖</ci></apply><apply id="S2.SS2.p3.4.m2.1.2.3.1.cmml" xref="S2.SS2.p3.4.m2.1.2.3.2"><csymbol cd="latexml" id="S2.SS2.p3.4.m2.1.2.3.1.1.cmml" xref="S2.SS2.p3.4.m2.1.2.3.2.1">delimited-[]</csymbol><apply id="S2.SS2.p3.4.m2.1.1.cmml" xref="S2.SS2.p3.4.m2.1.1"><ci id="S2.SS2.p3.4.m2.1.1.1.cmml" xref="S2.SS2.p3.4.m2.1.1.1">→</ci><ci id="S2.SS2.p3.4.m2.1.1.2.cmml" xref="S2.SS2.p3.4.m2.1.1.2">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.4.m2.1c">S_{i}[\vec{d}]</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p3.4.m2.1d">italic_S start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT [ over→ start_ARG italic_d end_ARG ]</annotation></semantics></math> and dependent <math alttext="S_{j}[\vec{r}]" class="ltx_Math" display="inline" id="S2.SS2.p3.5.m3.1"><semantics id="S2.SS2.p3.5.m3.1a"><mrow id="S2.SS2.p3.5.m3.1.2" xref="S2.SS2.p3.5.m3.1.2.cmml"><msub id="S2.SS2.p3.5.m3.1.2.2" xref="S2.SS2.p3.5.m3.1.2.2.cmml"><mi id="S2.SS2.p3.5.m3.1.2.2.2" xref="S2.SS2.p3.5.m3.1.2.2.2.cmml">S</mi><mi id="S2.SS2.p3.5.m3.1.2.2.3" xref="S2.SS2.p3.5.m3.1.2.2.3.cmml">j</mi></msub><mo id="S2.SS2.p3.5.m3.1.2.1" xref="S2.SS2.p3.5.m3.1.2.1.cmml">⁢</mo><mrow id="S2.SS2.p3.5.m3.1.2.3.2" xref="S2.SS2.p3.5.m3.1.2.3.1.cmml"><mo id="S2.SS2.p3.5.m3.1.2.3.2.1" stretchy="false" xref="S2.SS2.p3.5.m3.1.2.3.1.1.cmml">[</mo><mover accent="true" id="S2.SS2.p3.5.m3.1.1" xref="S2.SS2.p3.5.m3.1.1.cmml"><mi id="S2.SS2.p3.5.m3.1.1.2" xref="S2.SS2.p3.5.m3.1.1.2.cmml">r</mi><mo id="S2.SS2.p3.5.m3.1.1.1" stretchy="false" xref="S2.SS2.p3.5.m3.1.1.1.cmml">→</mo></mover><mo id="S2.SS2.p3.5.m3.1.2.3.2.2" stretchy="false" xref="S2.SS2.p3.5.m3.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.5.m3.1b"><apply id="S2.SS2.p3.5.m3.1.2.cmml" xref="S2.SS2.p3.5.m3.1.2"><times id="S2.SS2.p3.5.m3.1.2.1.cmml" xref="S2.SS2.p3.5.m3.1.2.1"></times><apply id="S2.SS2.p3.5.m3.1.2.2.cmml" xref="S2.SS2.p3.5.m3.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.p3.5.m3.1.2.2.1.cmml" xref="S2.SS2.p3.5.m3.1.2.2">subscript</csymbol><ci id="S2.SS2.p3.5.m3.1.2.2.2.cmml" xref="S2.SS2.p3.5.m3.1.2.2.2">𝑆</ci><ci id="S2.SS2.p3.5.m3.1.2.2.3.cmml" xref="S2.SS2.p3.5.m3.1.2.2.3">𝑗</ci></apply><apply id="S2.SS2.p3.5.m3.1.2.3.1.cmml" xref="S2.SS2.p3.5.m3.1.2.3.2"><csymbol cd="latexml" id="S2.SS2.p3.5.m3.1.2.3.1.1.cmml" xref="S2.SS2.p3.5.m3.1.2.3.2.1">delimited-[]</csymbol><apply id="S2.SS2.p3.5.m3.1.1.cmml" xref="S2.SS2.p3.5.m3.1.1"><ci id="S2.SS2.p3.5.m3.1.1.1.cmml" xref="S2.SS2.p3.5.m3.1.1.1">→</ci><ci id="S2.SS2.p3.5.m3.1.1.2.cmml" xref="S2.SS2.p3.5.m3.1.1.2">𝑟</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.5.m3.1c">S_{j}[\vec{r}]</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p3.5.m3.1d">italic_S start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT [ over→ start_ARG italic_r end_ARG ]</annotation></semantics></math> of these maps takes them into the time domain, and (<a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#S2.E1" title="In 2.2. The Polyhedral Model ‣ 2. Background and Motivation ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">1</span></a>) becomes <math alttext="t_{d}\mapsto t_{r}" class="ltx_Math" display="inline" id="S2.SS2.p3.6.m4.1"><semantics id="S2.SS2.p3.6.m4.1a"><mrow id="S2.SS2.p3.6.m4.1.1" xref="S2.SS2.p3.6.m4.1.1.cmml"><msub id="S2.SS2.p3.6.m4.1.1.2" xref="S2.SS2.p3.6.m4.1.1.2.cmml"><mi id="S2.SS2.p3.6.m4.1.1.2.2" xref="S2.SS2.p3.6.m4.1.1.2.2.cmml">t</mi><mi id="S2.SS2.p3.6.m4.1.1.2.3" xref="S2.SS2.p3.6.m4.1.1.2.3.cmml">d</mi></msub><mo id="S2.SS2.p3.6.m4.1.1.1" stretchy="false" xref="S2.SS2.p3.6.m4.1.1.1.cmml">↦</mo><msub id="S2.SS2.p3.6.m4.1.1.3" xref="S2.SS2.p3.6.m4.1.1.3.cmml"><mi id="S2.SS2.p3.6.m4.1.1.3.2" xref="S2.SS2.p3.6.m4.1.1.3.2.cmml">t</mi><mi id="S2.SS2.p3.6.m4.1.1.3.3" xref="S2.SS2.p3.6.m4.1.1.3.3.cmml">r</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.6.m4.1b"><apply id="S2.SS2.p3.6.m4.1.1.cmml" xref="S2.SS2.p3.6.m4.1.1"><csymbol cd="latexml" id="S2.SS2.p3.6.m4.1.1.1.cmml" xref="S2.SS2.p3.6.m4.1.1.1">maps-to</csymbol><apply id="S2.SS2.p3.6.m4.1.1.2.cmml" xref="S2.SS2.p3.6.m4.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p3.6.m4.1.1.2.1.cmml" xref="S2.SS2.p3.6.m4.1.1.2">subscript</csymbol><ci id="S2.SS2.p3.6.m4.1.1.2.2.cmml" xref="S2.SS2.p3.6.m4.1.1.2.2">𝑡</ci><ci id="S2.SS2.p3.6.m4.1.1.2.3.cmml" xref="S2.SS2.p3.6.m4.1.1.2.3">𝑑</ci></apply><apply id="S2.SS2.p3.6.m4.1.1.3.cmml" xref="S2.SS2.p3.6.m4.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p3.6.m4.1.1.3.1.cmml" xref="S2.SS2.p3.6.m4.1.1.3">subscript</csymbol><ci id="S2.SS2.p3.6.m4.1.1.3.2.cmml" xref="S2.SS2.p3.6.m4.1.1.3.2">𝑡</ci><ci id="S2.SS2.p3.6.m4.1.1.3.3.cmml" xref="S2.SS2.p3.6.m4.1.1.3.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.6.m4.1c">t_{d}\mapsto t_{r}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p3.6.m4.1d">italic_t start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT ↦ italic_t start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math> (<math alttext="t_{d}" class="ltx_Math" display="inline" id="S2.SS2.p3.7.m5.1"><semantics id="S2.SS2.p3.7.m5.1a"><msub id="S2.SS2.p3.7.m5.1.1" xref="S2.SS2.p3.7.m5.1.1.cmml"><mi id="S2.SS2.p3.7.m5.1.1.2" xref="S2.SS2.p3.7.m5.1.1.2.cmml">t</mi><mi id="S2.SS2.p3.7.m5.1.1.3" xref="S2.SS2.p3.7.m5.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.7.m5.1b"><apply id="S2.SS2.p3.7.m5.1.1.cmml" xref="S2.SS2.p3.7.m5.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.7.m5.1.1.1.cmml" xref="S2.SS2.p3.7.m5.1.1">subscript</csymbol><ci id="S2.SS2.p3.7.m5.1.1.2.cmml" xref="S2.SS2.p3.7.m5.1.1.2">𝑡</ci><ci id="S2.SS2.p3.7.m5.1.1.3.cmml" xref="S2.SS2.p3.7.m5.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.7.m5.1c">t_{d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p3.7.m5.1d">italic_t start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="t_{r}" class="ltx_Math" display="inline" id="S2.SS2.p3.8.m6.1"><semantics id="S2.SS2.p3.8.m6.1a"><msub id="S2.SS2.p3.8.m6.1.1" xref="S2.SS2.p3.8.m6.1.1.cmml"><mi id="S2.SS2.p3.8.m6.1.1.2" xref="S2.SS2.p3.8.m6.1.1.2.cmml">t</mi><mi id="S2.SS2.p3.8.m6.1.1.3" xref="S2.SS2.p3.8.m6.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.8.m6.1b"><apply id="S2.SS2.p3.8.m6.1.1.cmml" xref="S2.SS2.p3.8.m6.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.8.m6.1.1.1.cmml" xref="S2.SS2.p3.8.m6.1.1">subscript</csymbol><ci id="S2.SS2.p3.8.m6.1.1.2.cmml" xref="S2.SS2.p3.8.m6.1.1.2">𝑡</ci><ci id="S2.SS2.p3.8.m6.1.1.3.cmml" xref="S2.SS2.p3.8.m6.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.8.m6.1c">t_{r}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p3.8.m6.1d">italic_t start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math> are timestamps). If <math alttext="t_{d}" class="ltx_Math" display="inline" id="S2.SS2.p3.9.m7.1"><semantics id="S2.SS2.p3.9.m7.1a"><msub id="S2.SS2.p3.9.m7.1.1" xref="S2.SS2.p3.9.m7.1.1.cmml"><mi id="S2.SS2.p3.9.m7.1.1.2" xref="S2.SS2.p3.9.m7.1.1.2.cmml">t</mi><mi id="S2.SS2.p3.9.m7.1.1.3" xref="S2.SS2.p3.9.m7.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.9.m7.1b"><apply id="S2.SS2.p3.9.m7.1.1.cmml" xref="S2.SS2.p3.9.m7.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.9.m7.1.1.1.cmml" xref="S2.SS2.p3.9.m7.1.1">subscript</csymbol><ci id="S2.SS2.p3.9.m7.1.1.2.cmml" xref="S2.SS2.p3.9.m7.1.1.2">𝑡</ci><ci id="S2.SS2.p3.9.m7.1.1.3.cmml" xref="S2.SS2.p3.9.m7.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.9.m7.1c">t_{d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p3.9.m7.1d">italic_t start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT</annotation></semantics></math> lexicographically precedes <math alttext="t_{r}" class="ltx_Math" display="inline" id="S2.SS2.p3.10.m8.1"><semantics id="S2.SS2.p3.10.m8.1a"><msub id="S2.SS2.p3.10.m8.1.1" xref="S2.SS2.p3.10.m8.1.1.cmml"><mi id="S2.SS2.p3.10.m8.1.1.2" xref="S2.SS2.p3.10.m8.1.1.2.cmml">t</mi><mi id="S2.SS2.p3.10.m8.1.1.3" xref="S2.SS2.p3.10.m8.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.10.m8.1b"><apply id="S2.SS2.p3.10.m8.1.1.cmml" xref="S2.SS2.p3.10.m8.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.10.m8.1.1.1.cmml" xref="S2.SS2.p3.10.m8.1.1">subscript</csymbol><ci id="S2.SS2.p3.10.m8.1.1.2.cmml" xref="S2.SS2.p3.10.m8.1.1.2">𝑡</ci><ci id="S2.SS2.p3.10.m8.1.1.3.cmml" xref="S2.SS2.p3.10.m8.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.10.m8.1c">t_{r}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p3.10.m8.1d">italic_t start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math>, i.e.,</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(2)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="t_{d}&lt;_{\text{LEX}}t_{r}" class="ltx_Math" display="block" id="S2.E2.m1.1"><semantics id="S2.E2.m1.1a"><mrow id="S2.E2.m1.1.1" xref="S2.E2.m1.1.1.cmml"><msub id="S2.E2.m1.1.1.2" xref="S2.E2.m1.1.1.2.cmml"><mi id="S2.E2.m1.1.1.2.2" xref="S2.E2.m1.1.1.2.2.cmml">t</mi><mi id="S2.E2.m1.1.1.2.3" xref="S2.E2.m1.1.1.2.3.cmml">d</mi></msub><msub id="S2.E2.m1.1.1.1" xref="S2.E2.m1.1.1.1.cmml"><mo id="S2.E2.m1.1.1.1.2" xref="S2.E2.m1.1.1.1.2.cmml">&lt;</mo><mtext id="S2.E2.m1.1.1.1.3" xref="S2.E2.m1.1.1.1.3a.cmml">LEX</mtext></msub><msub id="S2.E2.m1.1.1.3" xref="S2.E2.m1.1.1.3.cmml"><mi id="S2.E2.m1.1.1.3.2" xref="S2.E2.m1.1.1.3.2.cmml">t</mi><mi id="S2.E2.m1.1.1.3.3" xref="S2.E2.m1.1.1.3.3.cmml">r</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.1b"><apply id="S2.E2.m1.1.1.cmml" xref="S2.E2.m1.1.1"><apply id="S2.E2.m1.1.1.1.cmml" xref="S2.E2.m1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1">subscript</csymbol><lt id="S2.E2.m1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.2"></lt><ci id="S2.E2.m1.1.1.1.3a.cmml" xref="S2.E2.m1.1.1.1.3"><mtext id="S2.E2.m1.1.1.1.3.cmml" mathsize="70%" xref="S2.E2.m1.1.1.1.3">LEX</mtext></ci></apply><apply id="S2.E2.m1.1.1.2.cmml" xref="S2.E2.m1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.2.1.cmml" xref="S2.E2.m1.1.1.2">subscript</csymbol><ci id="S2.E2.m1.1.1.2.2.cmml" xref="S2.E2.m1.1.1.2.2">𝑡</ci><ci id="S2.E2.m1.1.1.2.3.cmml" xref="S2.E2.m1.1.1.2.3">𝑑</ci></apply><apply id="S2.E2.m1.1.1.3.cmml" xref="S2.E2.m1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.3.1.cmml" xref="S2.E2.m1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.1.1.3.2.cmml" xref="S2.E2.m1.1.1.3.2">𝑡</ci><ci id="S2.E2.m1.1.1.3.3.cmml" xref="S2.E2.m1.1.1.3.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.1c">t_{d}&lt;_{\text{LEX}}t_{r}</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.1d">italic_t start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT &lt; start_POSTSUBSCRIPT LEX end_POSTSUBSCRIPT italic_t start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.p3.15">then the schedule is legal, because it maps the dependent to a later time then the timestep of the dependee. Because (<a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#S2.E2" title="In 2.2. The Polyhedral Model ‣ 2. Background and Motivation ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">2</span></a>) is equivalent to <math alttext="0&lt;_{\text{LEX}}t_{r}-t_{d}" class="ltx_Math" display="inline" id="S2.SS2.p3.11.m1.1"><semantics id="S2.SS2.p3.11.m1.1a"><mrow id="S2.SS2.p3.11.m1.1.1" xref="S2.SS2.p3.11.m1.1.1.cmml"><mn id="S2.SS2.p3.11.m1.1.1.2" xref="S2.SS2.p3.11.m1.1.1.2.cmml">0</mn><msub id="S2.SS2.p3.11.m1.1.1.1" xref="S2.SS2.p3.11.m1.1.1.1.cmml"><mo id="S2.SS2.p3.11.m1.1.1.1.2" xref="S2.SS2.p3.11.m1.1.1.1.2.cmml">&lt;</mo><mtext id="S2.SS2.p3.11.m1.1.1.1.3" xref="S2.SS2.p3.11.m1.1.1.1.3a.cmml">LEX</mtext></msub><mrow id="S2.SS2.p3.11.m1.1.1.3" xref="S2.SS2.p3.11.m1.1.1.3.cmml"><msub id="S2.SS2.p3.11.m1.1.1.3.2" xref="S2.SS2.p3.11.m1.1.1.3.2.cmml"><mi id="S2.SS2.p3.11.m1.1.1.3.2.2" xref="S2.SS2.p3.11.m1.1.1.3.2.2.cmml">t</mi><mi id="S2.SS2.p3.11.m1.1.1.3.2.3" xref="S2.SS2.p3.11.m1.1.1.3.2.3.cmml">r</mi></msub><mo id="S2.SS2.p3.11.m1.1.1.3.1" xref="S2.SS2.p3.11.m1.1.1.3.1.cmml">−</mo><msub id="S2.SS2.p3.11.m1.1.1.3.3" xref="S2.SS2.p3.11.m1.1.1.3.3.cmml"><mi id="S2.SS2.p3.11.m1.1.1.3.3.2" xref="S2.SS2.p3.11.m1.1.1.3.3.2.cmml">t</mi><mi id="S2.SS2.p3.11.m1.1.1.3.3.3" xref="S2.SS2.p3.11.m1.1.1.3.3.3.cmml">d</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.11.m1.1b"><apply id="S2.SS2.p3.11.m1.1.1.cmml" xref="S2.SS2.p3.11.m1.1.1"><apply id="S2.SS2.p3.11.m1.1.1.1.cmml" xref="S2.SS2.p3.11.m1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.11.m1.1.1.1.1.cmml" xref="S2.SS2.p3.11.m1.1.1.1">subscript</csymbol><lt id="S2.SS2.p3.11.m1.1.1.1.2.cmml" xref="S2.SS2.p3.11.m1.1.1.1.2"></lt><ci id="S2.SS2.p3.11.m1.1.1.1.3a.cmml" xref="S2.SS2.p3.11.m1.1.1.1.3"><mtext id="S2.SS2.p3.11.m1.1.1.1.3.cmml" mathsize="70%" xref="S2.SS2.p3.11.m1.1.1.1.3">LEX</mtext></ci></apply><cn id="S2.SS2.p3.11.m1.1.1.2.cmml" type="integer" xref="S2.SS2.p3.11.m1.1.1.2">0</cn><apply id="S2.SS2.p3.11.m1.1.1.3.cmml" xref="S2.SS2.p3.11.m1.1.1.3"><minus id="S2.SS2.p3.11.m1.1.1.3.1.cmml" xref="S2.SS2.p3.11.m1.1.1.3.1"></minus><apply id="S2.SS2.p3.11.m1.1.1.3.2.cmml" xref="S2.SS2.p3.11.m1.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS2.p3.11.m1.1.1.3.2.1.cmml" xref="S2.SS2.p3.11.m1.1.1.3.2">subscript</csymbol><ci id="S2.SS2.p3.11.m1.1.1.3.2.2.cmml" xref="S2.SS2.p3.11.m1.1.1.3.2.2">𝑡</ci><ci id="S2.SS2.p3.11.m1.1.1.3.2.3.cmml" xref="S2.SS2.p3.11.m1.1.1.3.2.3">𝑟</ci></apply><apply id="S2.SS2.p3.11.m1.1.1.3.3.cmml" xref="S2.SS2.p3.11.m1.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS2.p3.11.m1.1.1.3.3.1.cmml" xref="S2.SS2.p3.11.m1.1.1.3.3">subscript</csymbol><ci id="S2.SS2.p3.11.m1.1.1.3.3.2.cmml" xref="S2.SS2.p3.11.m1.1.1.3.3.2">𝑡</ci><ci id="S2.SS2.p3.11.m1.1.1.3.3.3.cmml" xref="S2.SS2.p3.11.m1.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.11.m1.1c">0&lt;_{\text{LEX}}t_{r}-t_{d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p3.11.m1.1d">0 &lt; start_POSTSUBSCRIPT LEX end_POSTSUBSCRIPT italic_t start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT - italic_t start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT</annotation></semantics></math>, we can (symbolically) compute <math alttext="\delta=t_{r}-t_{d}" class="ltx_Math" display="inline" id="S2.SS2.p3.12.m2.1"><semantics id="S2.SS2.p3.12.m2.1a"><mrow id="S2.SS2.p3.12.m2.1.1" xref="S2.SS2.p3.12.m2.1.1.cmml"><mi id="S2.SS2.p3.12.m2.1.1.2" xref="S2.SS2.p3.12.m2.1.1.2.cmml">δ</mi><mo id="S2.SS2.p3.12.m2.1.1.1" xref="S2.SS2.p3.12.m2.1.1.1.cmml">=</mo><mrow id="S2.SS2.p3.12.m2.1.1.3" xref="S2.SS2.p3.12.m2.1.1.3.cmml"><msub id="S2.SS2.p3.12.m2.1.1.3.2" xref="S2.SS2.p3.12.m2.1.1.3.2.cmml"><mi id="S2.SS2.p3.12.m2.1.1.3.2.2" xref="S2.SS2.p3.12.m2.1.1.3.2.2.cmml">t</mi><mi id="S2.SS2.p3.12.m2.1.1.3.2.3" xref="S2.SS2.p3.12.m2.1.1.3.2.3.cmml">r</mi></msub><mo id="S2.SS2.p3.12.m2.1.1.3.1" xref="S2.SS2.p3.12.m2.1.1.3.1.cmml">−</mo><msub id="S2.SS2.p3.12.m2.1.1.3.3" xref="S2.SS2.p3.12.m2.1.1.3.3.cmml"><mi id="S2.SS2.p3.12.m2.1.1.3.3.2" xref="S2.SS2.p3.12.m2.1.1.3.3.2.cmml">t</mi><mi id="S2.SS2.p3.12.m2.1.1.3.3.3" xref="S2.SS2.p3.12.m2.1.1.3.3.3.cmml">d</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.12.m2.1b"><apply id="S2.SS2.p3.12.m2.1.1.cmml" xref="S2.SS2.p3.12.m2.1.1"><eq id="S2.SS2.p3.12.m2.1.1.1.cmml" xref="S2.SS2.p3.12.m2.1.1.1"></eq><ci id="S2.SS2.p3.12.m2.1.1.2.cmml" xref="S2.SS2.p3.12.m2.1.1.2">𝛿</ci><apply id="S2.SS2.p3.12.m2.1.1.3.cmml" xref="S2.SS2.p3.12.m2.1.1.3"><minus id="S2.SS2.p3.12.m2.1.1.3.1.cmml" xref="S2.SS2.p3.12.m2.1.1.3.1"></minus><apply id="S2.SS2.p3.12.m2.1.1.3.2.cmml" xref="S2.SS2.p3.12.m2.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS2.p3.12.m2.1.1.3.2.1.cmml" xref="S2.SS2.p3.12.m2.1.1.3.2">subscript</csymbol><ci id="S2.SS2.p3.12.m2.1.1.3.2.2.cmml" xref="S2.SS2.p3.12.m2.1.1.3.2.2">𝑡</ci><ci id="S2.SS2.p3.12.m2.1.1.3.2.3.cmml" xref="S2.SS2.p3.12.m2.1.1.3.2.3">𝑟</ci></apply><apply id="S2.SS2.p3.12.m2.1.1.3.3.cmml" xref="S2.SS2.p3.12.m2.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS2.p3.12.m2.1.1.3.3.1.cmml" xref="S2.SS2.p3.12.m2.1.1.3.3">subscript</csymbol><ci id="S2.SS2.p3.12.m2.1.1.3.3.2.cmml" xref="S2.SS2.p3.12.m2.1.1.3.3.2">𝑡</ci><ci id="S2.SS2.p3.12.m2.1.1.3.3.3.cmml" xref="S2.SS2.p3.12.m2.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.12.m2.1c">\delta=t_{r}-t_{d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p3.12.m2.1d">italic_δ = italic_t start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT - italic_t start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT</annotation></semantics></math> and if <math alttext="\delta" class="ltx_Math" display="inline" id="S2.SS2.p3.13.m3.1"><semantics id="S2.SS2.p3.13.m3.1a"><mi id="S2.SS2.p3.13.m3.1.1" xref="S2.SS2.p3.13.m3.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.13.m3.1b"><ci id="S2.SS2.p3.13.m3.1.1.cmml" xref="S2.SS2.p3.13.m3.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.13.m3.1c">\delta</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p3.13.m3.1d">italic_δ</annotation></semantics></math> is lexicographically positive, the schedule is legal. Computing <math alttext="\delta" class="ltx_Math" display="inline" id="S2.SS2.p3.14.m4.1"><semantics id="S2.SS2.p3.14.m4.1a"><mi id="S2.SS2.p3.14.m4.1.1" xref="S2.SS2.p3.14.m4.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.14.m4.1b"><ci id="S2.SS2.p3.14.m4.1.1.cmml" xref="S2.SS2.p3.14.m4.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.14.m4.1c">\delta</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p3.14.m4.1d">italic_δ</annotation></semantics></math> is useful because it provides us with even more useful information: if an entry in <math alttext="\delta" class="ltx_Math" display="inline" id="S2.SS2.p3.15.m5.1"><semantics id="S2.SS2.p3.15.m5.1a"><mi id="S2.SS2.p3.15.m5.1.1" xref="S2.SS2.p3.15.m5.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.15.m5.1b"><ci id="S2.SS2.p3.15.m5.1.1.cmml" xref="S2.SS2.p3.15.m5.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.15.m5.1c">\delta</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p3.15.m5.1d">italic_δ</annotation></semantics></math> is zero,
it means there are no dependencies along the corresponding dimension of the schedule, and consequently the generated loop for that dimension can be parallelised.</p>
</div>
<figure class="ltx_figure" id="S2.F2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<div class="ltx_block ltx_figure_panel" id="S2.F2.2">
<figure class="ltx_figure ltx_align_center" id="S2.F2.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="142" id="S2.F2.sf1.g1" src="x2.png" width="134"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S2.F2.sf1.4.1.1" style="font-size:90%;">(a)</span> </span><math alttext="\theta(S[i,j])=(i,j)" class="ltx_Math" display="inline" id="S2.F2.sf1.2.m1.5"><semantics id="S2.F2.sf1.2.m1.5b"><mrow id="S2.F2.sf1.2.m1.5.5" xref="S2.F2.sf1.2.m1.5.5.cmml"><mrow id="S2.F2.sf1.2.m1.5.5.1" xref="S2.F2.sf1.2.m1.5.5.1.cmml"><mi id="S2.F2.sf1.2.m1.5.5.1.3" mathsize="90%" xref="S2.F2.sf1.2.m1.5.5.1.3.cmml">θ</mi><mo id="S2.F2.sf1.2.m1.5.5.1.2" xref="S2.F2.sf1.2.m1.5.5.1.2.cmml">⁢</mo><mrow id="S2.F2.sf1.2.m1.5.5.1.1.1" xref="S2.F2.sf1.2.m1.5.5.1.1.1.1.cmml"><mo id="S2.F2.sf1.2.m1.5.5.1.1.1.2" maxsize="90%" minsize="90%" xref="S2.F2.sf1.2.m1.5.5.1.1.1.1.cmml">(</mo><mrow id="S2.F2.sf1.2.m1.5.5.1.1.1.1" xref="S2.F2.sf1.2.m1.5.5.1.1.1.1.cmml"><mi id="S2.F2.sf1.2.m1.5.5.1.1.1.1.2" mathsize="90%" xref="S2.F2.sf1.2.m1.5.5.1.1.1.1.2.cmml">S</mi><mo id="S2.F2.sf1.2.m1.5.5.1.1.1.1.1" xref="S2.F2.sf1.2.m1.5.5.1.1.1.1.1.cmml">⁢</mo><mrow id="S2.F2.sf1.2.m1.5.5.1.1.1.1.3.2" xref="S2.F2.sf1.2.m1.5.5.1.1.1.1.3.1.cmml"><mo id="S2.F2.sf1.2.m1.5.5.1.1.1.1.3.2.1" maxsize="90%" minsize="90%" xref="S2.F2.sf1.2.m1.5.5.1.1.1.1.3.1.cmml">[</mo><mi id="S2.F2.sf1.2.m1.1.1" mathsize="90%" xref="S2.F2.sf1.2.m1.1.1.cmml">i</mi><mo id="S2.F2.sf1.2.m1.5.5.1.1.1.1.3.2.2" mathsize="90%" xref="S2.F2.sf1.2.m1.5.5.1.1.1.1.3.1.cmml">,</mo><mi id="S2.F2.sf1.2.m1.2.2" mathsize="90%" xref="S2.F2.sf1.2.m1.2.2.cmml">j</mi><mo id="S2.F2.sf1.2.m1.5.5.1.1.1.1.3.2.3" maxsize="90%" minsize="90%" xref="S2.F2.sf1.2.m1.5.5.1.1.1.1.3.1.cmml">]</mo></mrow></mrow><mo id="S2.F2.sf1.2.m1.5.5.1.1.1.3" maxsize="90%" minsize="90%" xref="S2.F2.sf1.2.m1.5.5.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.F2.sf1.2.m1.5.5.2" mathsize="90%" xref="S2.F2.sf1.2.m1.5.5.2.cmml">=</mo><mrow id="S2.F2.sf1.2.m1.5.5.3.2" xref="S2.F2.sf1.2.m1.5.5.3.1.cmml"><mo id="S2.F2.sf1.2.m1.5.5.3.2.1" maxsize="90%" minsize="90%" xref="S2.F2.sf1.2.m1.5.5.3.1.cmml">(</mo><mi id="S2.F2.sf1.2.m1.3.3" mathsize="90%" xref="S2.F2.sf1.2.m1.3.3.cmml">i</mi><mo id="S2.F2.sf1.2.m1.5.5.3.2.2" mathsize="90%" xref="S2.F2.sf1.2.m1.5.5.3.1.cmml">,</mo><mi id="S2.F2.sf1.2.m1.4.4" mathsize="90%" xref="S2.F2.sf1.2.m1.4.4.cmml">j</mi><mo id="S2.F2.sf1.2.m1.5.5.3.2.3" maxsize="90%" minsize="90%" xref="S2.F2.sf1.2.m1.5.5.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.F2.sf1.2.m1.5c"><apply id="S2.F2.sf1.2.m1.5.5.cmml" xref="S2.F2.sf1.2.m1.5.5"><eq id="S2.F2.sf1.2.m1.5.5.2.cmml" xref="S2.F2.sf1.2.m1.5.5.2"></eq><apply id="S2.F2.sf1.2.m1.5.5.1.cmml" xref="S2.F2.sf1.2.m1.5.5.1"><times id="S2.F2.sf1.2.m1.5.5.1.2.cmml" xref="S2.F2.sf1.2.m1.5.5.1.2"></times><ci id="S2.F2.sf1.2.m1.5.5.1.3.cmml" xref="S2.F2.sf1.2.m1.5.5.1.3">𝜃</ci><apply id="S2.F2.sf1.2.m1.5.5.1.1.1.1.cmml" xref="S2.F2.sf1.2.m1.5.5.1.1.1"><times id="S2.F2.sf1.2.m1.5.5.1.1.1.1.1.cmml" xref="S2.F2.sf1.2.m1.5.5.1.1.1.1.1"></times><ci id="S2.F2.sf1.2.m1.5.5.1.1.1.1.2.cmml" xref="S2.F2.sf1.2.m1.5.5.1.1.1.1.2">𝑆</ci><interval closure="closed" id="S2.F2.sf1.2.m1.5.5.1.1.1.1.3.1.cmml" xref="S2.F2.sf1.2.m1.5.5.1.1.1.1.3.2"><ci id="S2.F2.sf1.2.m1.1.1.cmml" xref="S2.F2.sf1.2.m1.1.1">𝑖</ci><ci id="S2.F2.sf1.2.m1.2.2.cmml" xref="S2.F2.sf1.2.m1.2.2">𝑗</ci></interval></apply></apply><interval closure="open" id="S2.F2.sf1.2.m1.5.5.3.1.cmml" xref="S2.F2.sf1.2.m1.5.5.3.2"><ci id="S2.F2.sf1.2.m1.3.3.cmml" xref="S2.F2.sf1.2.m1.3.3">𝑖</ci><ci id="S2.F2.sf1.2.m1.4.4.cmml" xref="S2.F2.sf1.2.m1.4.4">𝑗</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.sf1.2.m1.5d">\theta(S[i,j])=(i,j)</annotation><annotation encoding="application/x-llamapun" id="S2.F2.sf1.2.m1.5e">italic_θ ( italic_S [ italic_i , italic_j ] ) = ( italic_i , italic_j )</annotation></semantics></math><span class="ltx_text" id="S2.F2.sf1.5.2" style="font-size:90%;"> </span></figcaption>
</figure>
<figure class="ltx_figure ltx_align_center" id="S2.F2.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="142" id="S2.F2.sf2.g1" src="x3.png" width="134"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S2.F2.sf2.4.1.1" style="font-size:90%;">(b)</span> </span><math alttext="\theta(S[i,j])=(j,i)" class="ltx_Math" display="inline" id="S2.F2.sf2.2.m1.5"><semantics id="S2.F2.sf2.2.m1.5b"><mrow id="S2.F2.sf2.2.m1.5.5" xref="S2.F2.sf2.2.m1.5.5.cmml"><mrow id="S2.F2.sf2.2.m1.5.5.1" xref="S2.F2.sf2.2.m1.5.5.1.cmml"><mi id="S2.F2.sf2.2.m1.5.5.1.3" mathsize="90%" xref="S2.F2.sf2.2.m1.5.5.1.3.cmml">θ</mi><mo id="S2.F2.sf2.2.m1.5.5.1.2" xref="S2.F2.sf2.2.m1.5.5.1.2.cmml">⁢</mo><mrow id="S2.F2.sf2.2.m1.5.5.1.1.1" xref="S2.F2.sf2.2.m1.5.5.1.1.1.1.cmml"><mo id="S2.F2.sf2.2.m1.5.5.1.1.1.2" maxsize="90%" minsize="90%" xref="S2.F2.sf2.2.m1.5.5.1.1.1.1.cmml">(</mo><mrow id="S2.F2.sf2.2.m1.5.5.1.1.1.1" xref="S2.F2.sf2.2.m1.5.5.1.1.1.1.cmml"><mi id="S2.F2.sf2.2.m1.5.5.1.1.1.1.2" mathsize="90%" xref="S2.F2.sf2.2.m1.5.5.1.1.1.1.2.cmml">S</mi><mo id="S2.F2.sf2.2.m1.5.5.1.1.1.1.1" xref="S2.F2.sf2.2.m1.5.5.1.1.1.1.1.cmml">⁢</mo><mrow id="S2.F2.sf2.2.m1.5.5.1.1.1.1.3.2" xref="S2.F2.sf2.2.m1.5.5.1.1.1.1.3.1.cmml"><mo id="S2.F2.sf2.2.m1.5.5.1.1.1.1.3.2.1" maxsize="90%" minsize="90%" xref="S2.F2.sf2.2.m1.5.5.1.1.1.1.3.1.cmml">[</mo><mi id="S2.F2.sf2.2.m1.1.1" mathsize="90%" xref="S2.F2.sf2.2.m1.1.1.cmml">i</mi><mo id="S2.F2.sf2.2.m1.5.5.1.1.1.1.3.2.2" mathsize="90%" xref="S2.F2.sf2.2.m1.5.5.1.1.1.1.3.1.cmml">,</mo><mi id="S2.F2.sf2.2.m1.2.2" mathsize="90%" xref="S2.F2.sf2.2.m1.2.2.cmml">j</mi><mo id="S2.F2.sf2.2.m1.5.5.1.1.1.1.3.2.3" maxsize="90%" minsize="90%" xref="S2.F2.sf2.2.m1.5.5.1.1.1.1.3.1.cmml">]</mo></mrow></mrow><mo id="S2.F2.sf2.2.m1.5.5.1.1.1.3" maxsize="90%" minsize="90%" xref="S2.F2.sf2.2.m1.5.5.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.F2.sf2.2.m1.5.5.2" mathsize="90%" xref="S2.F2.sf2.2.m1.5.5.2.cmml">=</mo><mrow id="S2.F2.sf2.2.m1.5.5.3.2" xref="S2.F2.sf2.2.m1.5.5.3.1.cmml"><mo id="S2.F2.sf2.2.m1.5.5.3.2.1" maxsize="90%" minsize="90%" xref="S2.F2.sf2.2.m1.5.5.3.1.cmml">(</mo><mi id="S2.F2.sf2.2.m1.3.3" mathsize="90%" xref="S2.F2.sf2.2.m1.3.3.cmml">j</mi><mo id="S2.F2.sf2.2.m1.5.5.3.2.2" mathsize="90%" xref="S2.F2.sf2.2.m1.5.5.3.1.cmml">,</mo><mi id="S2.F2.sf2.2.m1.4.4" mathsize="90%" xref="S2.F2.sf2.2.m1.4.4.cmml">i</mi><mo id="S2.F2.sf2.2.m1.5.5.3.2.3" maxsize="90%" minsize="90%" xref="S2.F2.sf2.2.m1.5.5.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.F2.sf2.2.m1.5c"><apply id="S2.F2.sf2.2.m1.5.5.cmml" xref="S2.F2.sf2.2.m1.5.5"><eq id="S2.F2.sf2.2.m1.5.5.2.cmml" xref="S2.F2.sf2.2.m1.5.5.2"></eq><apply id="S2.F2.sf2.2.m1.5.5.1.cmml" xref="S2.F2.sf2.2.m1.5.5.1"><times id="S2.F2.sf2.2.m1.5.5.1.2.cmml" xref="S2.F2.sf2.2.m1.5.5.1.2"></times><ci id="S2.F2.sf2.2.m1.5.5.1.3.cmml" xref="S2.F2.sf2.2.m1.5.5.1.3">𝜃</ci><apply id="S2.F2.sf2.2.m1.5.5.1.1.1.1.cmml" xref="S2.F2.sf2.2.m1.5.5.1.1.1"><times id="S2.F2.sf2.2.m1.5.5.1.1.1.1.1.cmml" xref="S2.F2.sf2.2.m1.5.5.1.1.1.1.1"></times><ci id="S2.F2.sf2.2.m1.5.5.1.1.1.1.2.cmml" xref="S2.F2.sf2.2.m1.5.5.1.1.1.1.2">𝑆</ci><interval closure="closed" id="S2.F2.sf2.2.m1.5.5.1.1.1.1.3.1.cmml" xref="S2.F2.sf2.2.m1.5.5.1.1.1.1.3.2"><ci id="S2.F2.sf2.2.m1.1.1.cmml" xref="S2.F2.sf2.2.m1.1.1">𝑖</ci><ci id="S2.F2.sf2.2.m1.2.2.cmml" xref="S2.F2.sf2.2.m1.2.2">𝑗</ci></interval></apply></apply><interval closure="open" id="S2.F2.sf2.2.m1.5.5.3.1.cmml" xref="S2.F2.sf2.2.m1.5.5.3.2"><ci id="S2.F2.sf2.2.m1.3.3.cmml" xref="S2.F2.sf2.2.m1.3.3">𝑗</ci><ci id="S2.F2.sf2.2.m1.4.4.cmml" xref="S2.F2.sf2.2.m1.4.4">𝑖</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.sf2.2.m1.5d">\theta(S[i,j])=(j,i)</annotation><annotation encoding="application/x-llamapun" id="S2.F2.sf2.2.m1.5e">italic_θ ( italic_S [ italic_i , italic_j ] ) = ( italic_j , italic_i )</annotation></semantics></math><span class="ltx_text" id="S2.F2.sf2.5.2" style="font-size:90%;"> </span></figcaption>
</figure>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div class="ltx_block ltx_figure_panel" id="S2.F2.3">
<figure class="ltx_figure ltx_align_center" id="S2.F2.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="142" id="S2.F2.sf3.g1" src="x4.png" width="134"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S2.F2.sf3.4.1.1" style="font-size:90%;">(c)</span> </span><math alttext="\theta(S[i,j])=(i+j,j)" class="ltx_Math" display="inline" id="S2.F2.sf3.2.m1.5"><semantics id="S2.F2.sf3.2.m1.5b"><mrow id="S2.F2.sf3.2.m1.5.5" xref="S2.F2.sf3.2.m1.5.5.cmml"><mrow id="S2.F2.sf3.2.m1.4.4.1" xref="S2.F2.sf3.2.m1.4.4.1.cmml"><mi id="S2.F2.sf3.2.m1.4.4.1.3" mathsize="90%" xref="S2.F2.sf3.2.m1.4.4.1.3.cmml">θ</mi><mo id="S2.F2.sf3.2.m1.4.4.1.2" xref="S2.F2.sf3.2.m1.4.4.1.2.cmml">⁢</mo><mrow id="S2.F2.sf3.2.m1.4.4.1.1.1" xref="S2.F2.sf3.2.m1.4.4.1.1.1.1.cmml"><mo id="S2.F2.sf3.2.m1.4.4.1.1.1.2" maxsize="90%" minsize="90%" xref="S2.F2.sf3.2.m1.4.4.1.1.1.1.cmml">(</mo><mrow id="S2.F2.sf3.2.m1.4.4.1.1.1.1" xref="S2.F2.sf3.2.m1.4.4.1.1.1.1.cmml"><mi id="S2.F2.sf3.2.m1.4.4.1.1.1.1.2" mathsize="90%" xref="S2.F2.sf3.2.m1.4.4.1.1.1.1.2.cmml">S</mi><mo id="S2.F2.sf3.2.m1.4.4.1.1.1.1.1" xref="S2.F2.sf3.2.m1.4.4.1.1.1.1.1.cmml">⁢</mo><mrow id="S2.F2.sf3.2.m1.4.4.1.1.1.1.3.2" xref="S2.F2.sf3.2.m1.4.4.1.1.1.1.3.1.cmml"><mo id="S2.F2.sf3.2.m1.4.4.1.1.1.1.3.2.1" maxsize="90%" minsize="90%" xref="S2.F2.sf3.2.m1.4.4.1.1.1.1.3.1.cmml">[</mo><mi id="S2.F2.sf3.2.m1.1.1" mathsize="90%" xref="S2.F2.sf3.2.m1.1.1.cmml">i</mi><mo id="S2.F2.sf3.2.m1.4.4.1.1.1.1.3.2.2" mathsize="90%" xref="S2.F2.sf3.2.m1.4.4.1.1.1.1.3.1.cmml">,</mo><mi id="S2.F2.sf3.2.m1.2.2" mathsize="90%" xref="S2.F2.sf3.2.m1.2.2.cmml">j</mi><mo id="S2.F2.sf3.2.m1.4.4.1.1.1.1.3.2.3" maxsize="90%" minsize="90%" xref="S2.F2.sf3.2.m1.4.4.1.1.1.1.3.1.cmml">]</mo></mrow></mrow><mo id="S2.F2.sf3.2.m1.4.4.1.1.1.3" maxsize="90%" minsize="90%" xref="S2.F2.sf3.2.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.F2.sf3.2.m1.5.5.3" mathsize="90%" xref="S2.F2.sf3.2.m1.5.5.3.cmml">=</mo><mrow id="S2.F2.sf3.2.m1.5.5.2.1" xref="S2.F2.sf3.2.m1.5.5.2.2.cmml"><mo id="S2.F2.sf3.2.m1.5.5.2.1.2" maxsize="90%" minsize="90%" xref="S2.F2.sf3.2.m1.5.5.2.2.cmml">(</mo><mrow id="S2.F2.sf3.2.m1.5.5.2.1.1" xref="S2.F2.sf3.2.m1.5.5.2.1.1.cmml"><mi id="S2.F2.sf3.2.m1.5.5.2.1.1.2" mathsize="90%" xref="S2.F2.sf3.2.m1.5.5.2.1.1.2.cmml">i</mi><mo id="S2.F2.sf3.2.m1.5.5.2.1.1.1" mathsize="90%" xref="S2.F2.sf3.2.m1.5.5.2.1.1.1.cmml">+</mo><mi id="S2.F2.sf3.2.m1.5.5.2.1.1.3" mathsize="90%" xref="S2.F2.sf3.2.m1.5.5.2.1.1.3.cmml">j</mi></mrow><mo id="S2.F2.sf3.2.m1.5.5.2.1.3" mathsize="90%" xref="S2.F2.sf3.2.m1.5.5.2.2.cmml">,</mo><mi id="S2.F2.sf3.2.m1.3.3" mathsize="90%" xref="S2.F2.sf3.2.m1.3.3.cmml">j</mi><mo id="S2.F2.sf3.2.m1.5.5.2.1.4" maxsize="90%" minsize="90%" xref="S2.F2.sf3.2.m1.5.5.2.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.F2.sf3.2.m1.5c"><apply id="S2.F2.sf3.2.m1.5.5.cmml" xref="S2.F2.sf3.2.m1.5.5"><eq id="S2.F2.sf3.2.m1.5.5.3.cmml" xref="S2.F2.sf3.2.m1.5.5.3"></eq><apply id="S2.F2.sf3.2.m1.4.4.1.cmml" xref="S2.F2.sf3.2.m1.4.4.1"><times id="S2.F2.sf3.2.m1.4.4.1.2.cmml" xref="S2.F2.sf3.2.m1.4.4.1.2"></times><ci id="S2.F2.sf3.2.m1.4.4.1.3.cmml" xref="S2.F2.sf3.2.m1.4.4.1.3">𝜃</ci><apply id="S2.F2.sf3.2.m1.4.4.1.1.1.1.cmml" xref="S2.F2.sf3.2.m1.4.4.1.1.1"><times id="S2.F2.sf3.2.m1.4.4.1.1.1.1.1.cmml" xref="S2.F2.sf3.2.m1.4.4.1.1.1.1.1"></times><ci id="S2.F2.sf3.2.m1.4.4.1.1.1.1.2.cmml" xref="S2.F2.sf3.2.m1.4.4.1.1.1.1.2">𝑆</ci><interval closure="closed" id="S2.F2.sf3.2.m1.4.4.1.1.1.1.3.1.cmml" xref="S2.F2.sf3.2.m1.4.4.1.1.1.1.3.2"><ci id="S2.F2.sf3.2.m1.1.1.cmml" xref="S2.F2.sf3.2.m1.1.1">𝑖</ci><ci id="S2.F2.sf3.2.m1.2.2.cmml" xref="S2.F2.sf3.2.m1.2.2">𝑗</ci></interval></apply></apply><interval closure="open" id="S2.F2.sf3.2.m1.5.5.2.2.cmml" xref="S2.F2.sf3.2.m1.5.5.2.1"><apply id="S2.F2.sf3.2.m1.5.5.2.1.1.cmml" xref="S2.F2.sf3.2.m1.5.5.2.1.1"><plus id="S2.F2.sf3.2.m1.5.5.2.1.1.1.cmml" xref="S2.F2.sf3.2.m1.5.5.2.1.1.1"></plus><ci id="S2.F2.sf3.2.m1.5.5.2.1.1.2.cmml" xref="S2.F2.sf3.2.m1.5.5.2.1.1.2">𝑖</ci><ci id="S2.F2.sf3.2.m1.5.5.2.1.1.3.cmml" xref="S2.F2.sf3.2.m1.5.5.2.1.1.3">𝑗</ci></apply><ci id="S2.F2.sf3.2.m1.3.3.cmml" xref="S2.F2.sf3.2.m1.3.3">𝑗</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.sf3.2.m1.5d">\theta(S[i,j])=(i+j,j)</annotation><annotation encoding="application/x-llamapun" id="S2.F2.sf3.2.m1.5e">italic_θ ( italic_S [ italic_i , italic_j ] ) = ( italic_i + italic_j , italic_j )</annotation></semantics></math></figcaption>
</figure>
<figure class="ltx_figure ltx_align_center" id="S2.F2.sf4"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="142" id="S2.F2.sf4.g1" src="x5.png" width="134"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S2.F2.sf4.4.1.1" style="font-size:90%;">(d)</span> </span><math alttext="\theta(S[i,j])=(i,-j)" class="ltx_Math" display="inline" id="S2.F2.sf4.2.m1.5"><semantics id="S2.F2.sf4.2.m1.5b"><mrow id="S2.F2.sf4.2.m1.5.5" xref="S2.F2.sf4.2.m1.5.5.cmml"><mrow id="S2.F2.sf4.2.m1.4.4.1" xref="S2.F2.sf4.2.m1.4.4.1.cmml"><mi id="S2.F2.sf4.2.m1.4.4.1.3" mathsize="90%" xref="S2.F2.sf4.2.m1.4.4.1.3.cmml">θ</mi><mo id="S2.F2.sf4.2.m1.4.4.1.2" xref="S2.F2.sf4.2.m1.4.4.1.2.cmml">⁢</mo><mrow id="S2.F2.sf4.2.m1.4.4.1.1.1" xref="S2.F2.sf4.2.m1.4.4.1.1.1.1.cmml"><mo id="S2.F2.sf4.2.m1.4.4.1.1.1.2" maxsize="90%" minsize="90%" xref="S2.F2.sf4.2.m1.4.4.1.1.1.1.cmml">(</mo><mrow id="S2.F2.sf4.2.m1.4.4.1.1.1.1" xref="S2.F2.sf4.2.m1.4.4.1.1.1.1.cmml"><mi id="S2.F2.sf4.2.m1.4.4.1.1.1.1.2" mathsize="90%" xref="S2.F2.sf4.2.m1.4.4.1.1.1.1.2.cmml">S</mi><mo id="S2.F2.sf4.2.m1.4.4.1.1.1.1.1" xref="S2.F2.sf4.2.m1.4.4.1.1.1.1.1.cmml">⁢</mo><mrow id="S2.F2.sf4.2.m1.4.4.1.1.1.1.3.2" xref="S2.F2.sf4.2.m1.4.4.1.1.1.1.3.1.cmml"><mo id="S2.F2.sf4.2.m1.4.4.1.1.1.1.3.2.1" maxsize="90%" minsize="90%" xref="S2.F2.sf4.2.m1.4.4.1.1.1.1.3.1.cmml">[</mo><mi id="S2.F2.sf4.2.m1.1.1" mathsize="90%" xref="S2.F2.sf4.2.m1.1.1.cmml">i</mi><mo id="S2.F2.sf4.2.m1.4.4.1.1.1.1.3.2.2" mathsize="90%" xref="S2.F2.sf4.2.m1.4.4.1.1.1.1.3.1.cmml">,</mo><mi id="S2.F2.sf4.2.m1.2.2" mathsize="90%" xref="S2.F2.sf4.2.m1.2.2.cmml">j</mi><mo id="S2.F2.sf4.2.m1.4.4.1.1.1.1.3.2.3" maxsize="90%" minsize="90%" xref="S2.F2.sf4.2.m1.4.4.1.1.1.1.3.1.cmml">]</mo></mrow></mrow><mo id="S2.F2.sf4.2.m1.4.4.1.1.1.3" maxsize="90%" minsize="90%" xref="S2.F2.sf4.2.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.F2.sf4.2.m1.5.5.3" mathsize="90%" xref="S2.F2.sf4.2.m1.5.5.3.cmml">=</mo><mrow id="S2.F2.sf4.2.m1.5.5.2.1" xref="S2.F2.sf4.2.m1.5.5.2.2.cmml"><mo id="S2.F2.sf4.2.m1.5.5.2.1.2" maxsize="90%" minsize="90%" xref="S2.F2.sf4.2.m1.5.5.2.2.cmml">(</mo><mi id="S2.F2.sf4.2.m1.3.3" mathsize="90%" xref="S2.F2.sf4.2.m1.3.3.cmml">i</mi><mo id="S2.F2.sf4.2.m1.5.5.2.1.3" mathsize="90%" xref="S2.F2.sf4.2.m1.5.5.2.2.cmml">,</mo><mrow id="S2.F2.sf4.2.m1.5.5.2.1.1" xref="S2.F2.sf4.2.m1.5.5.2.1.1.cmml"><mo id="S2.F2.sf4.2.m1.5.5.2.1.1b" mathsize="90%" xref="S2.F2.sf4.2.m1.5.5.2.1.1.cmml">−</mo><mi id="S2.F2.sf4.2.m1.5.5.2.1.1.2" mathsize="90%" xref="S2.F2.sf4.2.m1.5.5.2.1.1.2.cmml">j</mi></mrow><mo id="S2.F2.sf4.2.m1.5.5.2.1.4" maxsize="90%" minsize="90%" xref="S2.F2.sf4.2.m1.5.5.2.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.F2.sf4.2.m1.5c"><apply id="S2.F2.sf4.2.m1.5.5.cmml" xref="S2.F2.sf4.2.m1.5.5"><eq id="S2.F2.sf4.2.m1.5.5.3.cmml" xref="S2.F2.sf4.2.m1.5.5.3"></eq><apply id="S2.F2.sf4.2.m1.4.4.1.cmml" xref="S2.F2.sf4.2.m1.4.4.1"><times id="S2.F2.sf4.2.m1.4.4.1.2.cmml" xref="S2.F2.sf4.2.m1.4.4.1.2"></times><ci id="S2.F2.sf4.2.m1.4.4.1.3.cmml" xref="S2.F2.sf4.2.m1.4.4.1.3">𝜃</ci><apply id="S2.F2.sf4.2.m1.4.4.1.1.1.1.cmml" xref="S2.F2.sf4.2.m1.4.4.1.1.1"><times id="S2.F2.sf4.2.m1.4.4.1.1.1.1.1.cmml" xref="S2.F2.sf4.2.m1.4.4.1.1.1.1.1"></times><ci id="S2.F2.sf4.2.m1.4.4.1.1.1.1.2.cmml" xref="S2.F2.sf4.2.m1.4.4.1.1.1.1.2">𝑆</ci><interval closure="closed" id="S2.F2.sf4.2.m1.4.4.1.1.1.1.3.1.cmml" xref="S2.F2.sf4.2.m1.4.4.1.1.1.1.3.2"><ci id="S2.F2.sf4.2.m1.1.1.cmml" xref="S2.F2.sf4.2.m1.1.1">𝑖</ci><ci id="S2.F2.sf4.2.m1.2.2.cmml" xref="S2.F2.sf4.2.m1.2.2">𝑗</ci></interval></apply></apply><interval closure="open" id="S2.F2.sf4.2.m1.5.5.2.2.cmml" xref="S2.F2.sf4.2.m1.5.5.2.1"><ci id="S2.F2.sf4.2.m1.3.3.cmml" xref="S2.F2.sf4.2.m1.3.3">𝑖</ci><apply id="S2.F2.sf4.2.m1.5.5.2.1.1.cmml" xref="S2.F2.sf4.2.m1.5.5.2.1.1"><minus id="S2.F2.sf4.2.m1.5.5.2.1.1.1.cmml" xref="S2.F2.sf4.2.m1.5.5.2.1.1"></minus><ci id="S2.F2.sf4.2.m1.5.5.2.1.1.2.cmml" xref="S2.F2.sf4.2.m1.5.5.2.1.1.2">𝑗</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.sf4.2.m1.5d">\theta(S[i,j])=(i,-j)</annotation><annotation encoding="application/x-llamapun" id="S2.F2.sf4.2.m1.5e">italic_θ ( italic_S [ italic_i , italic_j ] ) = ( italic_i , - italic_j )</annotation></semantics></math><span class="ltx_text" id="S2.F2.sf4.5.2" style="font-size:90%;"> </span></figcaption>
</figure>
</div>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S2.F2.4.1.1" style="font-size:90%;">Figure 2</span>. </span><span class="ltx_text" id="S2.F2.5.2" style="font-size:90%;">
Example schedules for the example in Listing <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#LST1" title="Listing 1 ‣ 2.2. The Polyhedral Model ‣ 2. Background and Motivation ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">1</span></a>. The schedules are given in the sub-captions. The thick (and dashed) arrows show the execution order of the instructions. The bent dotted arrows show the dependencies. Schedule (<a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#S2.F2.sf1" title="In Figure 2 ‣ 2.2. The Polyhedral Model ‣ 2. Background and Motivation ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">2(a)</span></a>) is the original schedule, and all schedules other than (<a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#S2.F2.sf4" title="In Figure 2 ‣ 2.2. The Polyhedral Model ‣ 2. Background and Motivation ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">2(d)</span></a>) is legal.
</span></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="S2.F2.6">\Description</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S2.F2.7">Example schedules</p>
</div>
</div>
</figure>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3. </span>Constraints of the Polyhedral Model</h3>
<div class="ltx_para" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.2">To be able to represent the domain, schedule, and dependencies efficiently, the source codes represented by the polyhedral model are restricted to <em class="ltx_emph ltx_font_italic" id="S2.SS3.p1.2.1">Static Control Parts</em>, or <em class="ltx_emph ltx_font_italic" id="S2.SS3.p1.2.2">SCoP</em>s for short (Listing <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#LST1" title="Listing 1 ‣ 2.2. The Polyhedral Model ‣ 2. Background and Motivation ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">1</span></a> is a simple example). While these restrictions are not negligible, most of high performance and science codes do not violate them. The main restrictions of SCoPs are the following:

<span class="ltx_inline-enumerate" id="S2.I2">
<span class="ltx_inline-item" id="S2.I2.i1"><span class="ltx_tag ltx_tag_inline-item">(1)</span> <span class="ltx_text" id="S2.I2.i1.1">The control-flow must be static, which means it does not depend on the input, other than <em class="ltx_emph ltx_font_italic" id="S2.I2.i1.1.1">parameters</em> (such as loop boundaries) which remain constant during execution,
</span></span>
<span class="ltx_inline-item" id="S2.I2.i2"><span class="ltx_tag ltx_tag_inline-item">(2)</span> <span class="ltx_text" id="S2.I2.i2.1">there is no memory aliasing, no pointer manipulation, and
</span></span>
<span class="ltx_inline-item" id="S2.I2.i3"><span class="ltx_tag ltx_tag_inline-item">(3)</span> <span class="ltx_text" id="S2.I2.i3.3">the symbolic expressions and formulas, used throughout the model, need to be expressed using a matrix <math alttext="\mathbf{A}" class="ltx_Math" display="inline" id="S2.I2.i3.1.m1.1"><semantics id="S2.I2.i3.1.m1.1a"><mi id="S2.I2.i3.1.m1.1.1" xref="S2.I2.i3.1.m1.1.1.cmml">𝐀</mi><annotation-xml encoding="MathML-Content" id="S2.I2.i3.1.m1.1b"><ci id="S2.I2.i3.1.m1.1.1.cmml" xref="S2.I2.i3.1.m1.1.1">𝐀</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I2.i3.1.m1.1c">\mathbf{A}</annotation><annotation encoding="application/x-llamapun" id="S2.I2.i3.1.m1.1d">bold_A</annotation></semantics></math> and a vector <math alttext="\mathbf{b}" class="ltx_Math" display="inline" id="S2.I2.i3.2.m2.1"><semantics id="S2.I2.i3.2.m2.1a"><mi id="S2.I2.i3.2.m2.1.1" xref="S2.I2.i3.2.m2.1.1.cmml">𝐛</mi><annotation-xml encoding="MathML-Content" id="S2.I2.i3.2.m2.1b"><ci id="S2.I2.i3.2.m2.1.1.cmml" xref="S2.I2.i3.2.m2.1.1">𝐛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I2.i3.2.m2.1c">\mathbf{b}</annotation><annotation encoding="application/x-llamapun" id="S2.I2.i3.2.m2.1d">bold_b</annotation></semantics></math> as a (quasi-)affine expression, i.e., <math alttext="\mathbf{A}\vec{i}+\mathbf{b}" class="ltx_Math" display="inline" id="S2.I2.i3.3.m3.1"><semantics id="S2.I2.i3.3.m3.1a"><mrow id="S2.I2.i3.3.m3.1.1" xref="S2.I2.i3.3.m3.1.1.cmml"><mrow id="S2.I2.i3.3.m3.1.1.2" xref="S2.I2.i3.3.m3.1.1.2.cmml"><mi id="S2.I2.i3.3.m3.1.1.2.2" xref="S2.I2.i3.3.m3.1.1.2.2.cmml">𝐀</mi><mo id="S2.I2.i3.3.m3.1.1.2.1" xref="S2.I2.i3.3.m3.1.1.2.1.cmml">⁢</mo><mover accent="true" id="S2.I2.i3.3.m3.1.1.2.3" xref="S2.I2.i3.3.m3.1.1.2.3.cmml"><mi id="S2.I2.i3.3.m3.1.1.2.3.2" xref="S2.I2.i3.3.m3.1.1.2.3.2.cmml">i</mi><mo id="S2.I2.i3.3.m3.1.1.2.3.1" stretchy="false" xref="S2.I2.i3.3.m3.1.1.2.3.1.cmml">→</mo></mover></mrow><mo id="S2.I2.i3.3.m3.1.1.1" xref="S2.I2.i3.3.m3.1.1.1.cmml">+</mo><mi id="S2.I2.i3.3.m3.1.1.3" xref="S2.I2.i3.3.m3.1.1.3.cmml">𝐛</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.I2.i3.3.m3.1b"><apply id="S2.I2.i3.3.m3.1.1.cmml" xref="S2.I2.i3.3.m3.1.1"><plus id="S2.I2.i3.3.m3.1.1.1.cmml" xref="S2.I2.i3.3.m3.1.1.1"></plus><apply id="S2.I2.i3.3.m3.1.1.2.cmml" xref="S2.I2.i3.3.m3.1.1.2"><times id="S2.I2.i3.3.m3.1.1.2.1.cmml" xref="S2.I2.i3.3.m3.1.1.2.1"></times><ci id="S2.I2.i3.3.m3.1.1.2.2.cmml" xref="S2.I2.i3.3.m3.1.1.2.2">𝐀</ci><apply id="S2.I2.i3.3.m3.1.1.2.3.cmml" xref="S2.I2.i3.3.m3.1.1.2.3"><ci id="S2.I2.i3.3.m3.1.1.2.3.1.cmml" xref="S2.I2.i3.3.m3.1.1.2.3.1">→</ci><ci id="S2.I2.i3.3.m3.1.1.2.3.2.cmml" xref="S2.I2.i3.3.m3.1.1.2.3.2">𝑖</ci></apply></apply><ci id="S2.I2.i3.3.m3.1.1.3.cmml" xref="S2.I2.i3.3.m3.1.1.3">𝐛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I2.i3.3.m3.1c">\mathbf{A}\vec{i}+\mathbf{b}</annotation><annotation encoding="application/x-llamapun" id="S2.I2.i3.3.m3.1d">bold_A over→ start_ARG italic_i end_ARG + bold_b</annotation></semantics></math> (sometimes referred to as Presburger formulas <cite class="ltx_cite ltx_citemacro_citep">(Verdoolaege et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib47" title="">[n. d.]</a>)</cite>).
</span></span>
</span>
For example, the domains are expressed as <math alttext="\mathcal{D_{S}}=\bigl{\{}S[\vec{i}]\in\mathbb{Z}^{n}:\mathbf{A}\vec{i}+\mathbf%
{b}\leq\mathbf{0}\bigr{\}}" class="ltx_Math" display="inline" id="S2.SS3.p1.1.m1.3"><semantics id="S2.SS3.p1.1.m1.3a"><mrow id="S2.SS3.p1.1.m1.3.3" xref="S2.SS3.p1.1.m1.3.3.cmml"><msub id="S2.SS3.p1.1.m1.3.3.4" xref="S2.SS3.p1.1.m1.3.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.p1.1.m1.3.3.4.2" xref="S2.SS3.p1.1.m1.3.3.4.2.cmml">𝒟</mi><mi class="ltx_font_mathcaligraphic" id="S2.SS3.p1.1.m1.3.3.4.3" xref="S2.SS3.p1.1.m1.3.3.4.3.cmml">𝒮</mi></msub><mo id="S2.SS3.p1.1.m1.3.3.3" xref="S2.SS3.p1.1.m1.3.3.3.cmml">=</mo><mrow id="S2.SS3.p1.1.m1.3.3.2.2" xref="S2.SS3.p1.1.m1.3.3.2.3.cmml"><mo id="S2.SS3.p1.1.m1.3.3.2.2.3" maxsize="120%" minsize="120%" xref="S2.SS3.p1.1.m1.3.3.2.3.1.cmml">{</mo><mrow id="S2.SS3.p1.1.m1.2.2.1.1.1" xref="S2.SS3.p1.1.m1.2.2.1.1.1.cmml"><mrow id="S2.SS3.p1.1.m1.2.2.1.1.1.2" xref="S2.SS3.p1.1.m1.2.2.1.1.1.2.cmml"><mi id="S2.SS3.p1.1.m1.2.2.1.1.1.2.2" xref="S2.SS3.p1.1.m1.2.2.1.1.1.2.2.cmml">S</mi><mo id="S2.SS3.p1.1.m1.2.2.1.1.1.2.1" xref="S2.SS3.p1.1.m1.2.2.1.1.1.2.1.cmml">⁢</mo><mrow id="S2.SS3.p1.1.m1.2.2.1.1.1.2.3.2" xref="S2.SS3.p1.1.m1.2.2.1.1.1.2.3.1.cmml"><mo id="S2.SS3.p1.1.m1.2.2.1.1.1.2.3.2.1" stretchy="false" xref="S2.SS3.p1.1.m1.2.2.1.1.1.2.3.1.1.cmml">[</mo><mover accent="true" id="S2.SS3.p1.1.m1.1.1" xref="S2.SS3.p1.1.m1.1.1.cmml"><mi id="S2.SS3.p1.1.m1.1.1.2" xref="S2.SS3.p1.1.m1.1.1.2.cmml">i</mi><mo id="S2.SS3.p1.1.m1.1.1.1" stretchy="false" xref="S2.SS3.p1.1.m1.1.1.1.cmml">→</mo></mover><mo id="S2.SS3.p1.1.m1.2.2.1.1.1.2.3.2.2" stretchy="false" xref="S2.SS3.p1.1.m1.2.2.1.1.1.2.3.1.1.cmml">]</mo></mrow></mrow><mo id="S2.SS3.p1.1.m1.2.2.1.1.1.1" xref="S2.SS3.p1.1.m1.2.2.1.1.1.1.cmml">∈</mo><msup id="S2.SS3.p1.1.m1.2.2.1.1.1.3" xref="S2.SS3.p1.1.m1.2.2.1.1.1.3.cmml"><mi id="S2.SS3.p1.1.m1.2.2.1.1.1.3.2" xref="S2.SS3.p1.1.m1.2.2.1.1.1.3.2.cmml">ℤ</mi><mi id="S2.SS3.p1.1.m1.2.2.1.1.1.3.3" xref="S2.SS3.p1.1.m1.2.2.1.1.1.3.3.cmml">n</mi></msup></mrow><mo id="S2.SS3.p1.1.m1.3.3.2.2.4" lspace="0.278em" rspace="0.278em" xref="S2.SS3.p1.1.m1.3.3.2.3.1.cmml">:</mo><mrow id="S2.SS3.p1.1.m1.3.3.2.2.2" xref="S2.SS3.p1.1.m1.3.3.2.2.2.cmml"><mrow id="S2.SS3.p1.1.m1.3.3.2.2.2.2" xref="S2.SS3.p1.1.m1.3.3.2.2.2.2.cmml"><mrow id="S2.SS3.p1.1.m1.3.3.2.2.2.2.2" xref="S2.SS3.p1.1.m1.3.3.2.2.2.2.2.cmml"><mi id="S2.SS3.p1.1.m1.3.3.2.2.2.2.2.2" xref="S2.SS3.p1.1.m1.3.3.2.2.2.2.2.2.cmml">𝐀</mi><mo id="S2.SS3.p1.1.m1.3.3.2.2.2.2.2.1" xref="S2.SS3.p1.1.m1.3.3.2.2.2.2.2.1.cmml">⁢</mo><mover accent="true" id="S2.SS3.p1.1.m1.3.3.2.2.2.2.2.3" xref="S2.SS3.p1.1.m1.3.3.2.2.2.2.2.3.cmml"><mi id="S2.SS3.p1.1.m1.3.3.2.2.2.2.2.3.2" xref="S2.SS3.p1.1.m1.3.3.2.2.2.2.2.3.2.cmml">i</mi><mo id="S2.SS3.p1.1.m1.3.3.2.2.2.2.2.3.1" stretchy="false" xref="S2.SS3.p1.1.m1.3.3.2.2.2.2.2.3.1.cmml">→</mo></mover></mrow><mo id="S2.SS3.p1.1.m1.3.3.2.2.2.2.1" xref="S2.SS3.p1.1.m1.3.3.2.2.2.2.1.cmml">+</mo><mi id="S2.SS3.p1.1.m1.3.3.2.2.2.2.3" xref="S2.SS3.p1.1.m1.3.3.2.2.2.2.3.cmml">𝐛</mi></mrow><mo id="S2.SS3.p1.1.m1.3.3.2.2.2.1" xref="S2.SS3.p1.1.m1.3.3.2.2.2.1.cmml">≤</mo><mn id="S2.SS3.p1.1.m1.3.3.2.2.2.3" xref="S2.SS3.p1.1.m1.3.3.2.2.2.3.cmml">𝟎</mn></mrow><mo id="S2.SS3.p1.1.m1.3.3.2.2.5" maxsize="120%" minsize="120%" xref="S2.SS3.p1.1.m1.3.3.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.1.m1.3b"><apply id="S2.SS3.p1.1.m1.3.3.cmml" xref="S2.SS3.p1.1.m1.3.3"><eq id="S2.SS3.p1.1.m1.3.3.3.cmml" xref="S2.SS3.p1.1.m1.3.3.3"></eq><apply id="S2.SS3.p1.1.m1.3.3.4.cmml" xref="S2.SS3.p1.1.m1.3.3.4"><csymbol cd="ambiguous" id="S2.SS3.p1.1.m1.3.3.4.1.cmml" xref="S2.SS3.p1.1.m1.3.3.4">subscript</csymbol><ci id="S2.SS3.p1.1.m1.3.3.4.2.cmml" xref="S2.SS3.p1.1.m1.3.3.4.2">𝒟</ci><ci id="S2.SS3.p1.1.m1.3.3.4.3.cmml" xref="S2.SS3.p1.1.m1.3.3.4.3">𝒮</ci></apply><apply id="S2.SS3.p1.1.m1.3.3.2.3.cmml" xref="S2.SS3.p1.1.m1.3.3.2.2"><csymbol cd="latexml" id="S2.SS3.p1.1.m1.3.3.2.3.1.cmml" xref="S2.SS3.p1.1.m1.3.3.2.2.3">conditional-set</csymbol><apply id="S2.SS3.p1.1.m1.2.2.1.1.1.cmml" xref="S2.SS3.p1.1.m1.2.2.1.1.1"><in id="S2.SS3.p1.1.m1.2.2.1.1.1.1.cmml" xref="S2.SS3.p1.1.m1.2.2.1.1.1.1"></in><apply id="S2.SS3.p1.1.m1.2.2.1.1.1.2.cmml" xref="S2.SS3.p1.1.m1.2.2.1.1.1.2"><times id="S2.SS3.p1.1.m1.2.2.1.1.1.2.1.cmml" xref="S2.SS3.p1.1.m1.2.2.1.1.1.2.1"></times><ci id="S2.SS3.p1.1.m1.2.2.1.1.1.2.2.cmml" xref="S2.SS3.p1.1.m1.2.2.1.1.1.2.2">𝑆</ci><apply id="S2.SS3.p1.1.m1.2.2.1.1.1.2.3.1.cmml" xref="S2.SS3.p1.1.m1.2.2.1.1.1.2.3.2"><csymbol cd="latexml" id="S2.SS3.p1.1.m1.2.2.1.1.1.2.3.1.1.cmml" xref="S2.SS3.p1.1.m1.2.2.1.1.1.2.3.2.1">delimited-[]</csymbol><apply id="S2.SS3.p1.1.m1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1"><ci id="S2.SS3.p1.1.m1.1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1.1">→</ci><ci id="S2.SS3.p1.1.m1.1.1.2.cmml" xref="S2.SS3.p1.1.m1.1.1.2">𝑖</ci></apply></apply></apply><apply id="S2.SS3.p1.1.m1.2.2.1.1.1.3.cmml" xref="S2.SS3.p1.1.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.p1.1.m1.2.2.1.1.1.3.1.cmml" xref="S2.SS3.p1.1.m1.2.2.1.1.1.3">superscript</csymbol><ci id="S2.SS3.p1.1.m1.2.2.1.1.1.3.2.cmml" xref="S2.SS3.p1.1.m1.2.2.1.1.1.3.2">ℤ</ci><ci id="S2.SS3.p1.1.m1.2.2.1.1.1.3.3.cmml" xref="S2.SS3.p1.1.m1.2.2.1.1.1.3.3">𝑛</ci></apply></apply><apply id="S2.SS3.p1.1.m1.3.3.2.2.2.cmml" xref="S2.SS3.p1.1.m1.3.3.2.2.2"><leq id="S2.SS3.p1.1.m1.3.3.2.2.2.1.cmml" xref="S2.SS3.p1.1.m1.3.3.2.2.2.1"></leq><apply id="S2.SS3.p1.1.m1.3.3.2.2.2.2.cmml" xref="S2.SS3.p1.1.m1.3.3.2.2.2.2"><plus id="S2.SS3.p1.1.m1.3.3.2.2.2.2.1.cmml" xref="S2.SS3.p1.1.m1.3.3.2.2.2.2.1"></plus><apply id="S2.SS3.p1.1.m1.3.3.2.2.2.2.2.cmml" xref="S2.SS3.p1.1.m1.3.3.2.2.2.2.2"><times id="S2.SS3.p1.1.m1.3.3.2.2.2.2.2.1.cmml" xref="S2.SS3.p1.1.m1.3.3.2.2.2.2.2.1"></times><ci id="S2.SS3.p1.1.m1.3.3.2.2.2.2.2.2.cmml" xref="S2.SS3.p1.1.m1.3.3.2.2.2.2.2.2">𝐀</ci><apply id="S2.SS3.p1.1.m1.3.3.2.2.2.2.2.3.cmml" xref="S2.SS3.p1.1.m1.3.3.2.2.2.2.2.3"><ci id="S2.SS3.p1.1.m1.3.3.2.2.2.2.2.3.1.cmml" xref="S2.SS3.p1.1.m1.3.3.2.2.2.2.2.3.1">→</ci><ci id="S2.SS3.p1.1.m1.3.3.2.2.2.2.2.3.2.cmml" xref="S2.SS3.p1.1.m1.3.3.2.2.2.2.2.3.2">𝑖</ci></apply></apply><ci id="S2.SS3.p1.1.m1.3.3.2.2.2.2.3.cmml" xref="S2.SS3.p1.1.m1.3.3.2.2.2.2.3">𝐛</ci></apply><cn id="S2.SS3.p1.1.m1.3.3.2.2.2.3.cmml" type="integer" xref="S2.SS3.p1.1.m1.3.3.2.2.2.3">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.1.m1.3c">\mathcal{D_{S}}=\bigl{\{}S[\vec{i}]\in\mathbb{Z}^{n}:\mathbf{A}\vec{i}+\mathbf%
{b}\leq\mathbf{0}\bigr{\}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.1.m1.3d">caligraphic_D start_POSTSUBSCRIPT caligraphic_S end_POSTSUBSCRIPT = { italic_S [ over→ start_ARG italic_i end_ARG ] ∈ blackboard_Z start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT : bold_A over→ start_ARG italic_i end_ARG + bold_b ≤ bold_0 }</annotation></semantics></math>; schedules are (quasi-)affine functions <math alttext="\theta(S[\vec{i}])=\mathbf{A}\vec{i}+\mathbf{b}" class="ltx_Math" display="inline" id="S2.SS3.p1.2.m2.2"><semantics id="S2.SS3.p1.2.m2.2a"><mrow id="S2.SS3.p1.2.m2.2.2" xref="S2.SS3.p1.2.m2.2.2.cmml"><mrow id="S2.SS3.p1.2.m2.2.2.1" xref="S2.SS3.p1.2.m2.2.2.1.cmml"><mi id="S2.SS3.p1.2.m2.2.2.1.3" xref="S2.SS3.p1.2.m2.2.2.1.3.cmml">θ</mi><mo id="S2.SS3.p1.2.m2.2.2.1.2" xref="S2.SS3.p1.2.m2.2.2.1.2.cmml">⁢</mo><mrow id="S2.SS3.p1.2.m2.2.2.1.1.1" xref="S2.SS3.p1.2.m2.2.2.1.1.1.1.cmml"><mo id="S2.SS3.p1.2.m2.2.2.1.1.1.2" stretchy="false" xref="S2.SS3.p1.2.m2.2.2.1.1.1.1.cmml">(</mo><mrow id="S2.SS3.p1.2.m2.2.2.1.1.1.1" xref="S2.SS3.p1.2.m2.2.2.1.1.1.1.cmml"><mi id="S2.SS3.p1.2.m2.2.2.1.1.1.1.2" xref="S2.SS3.p1.2.m2.2.2.1.1.1.1.2.cmml">S</mi><mo id="S2.SS3.p1.2.m2.2.2.1.1.1.1.1" xref="S2.SS3.p1.2.m2.2.2.1.1.1.1.1.cmml">⁢</mo><mrow id="S2.SS3.p1.2.m2.2.2.1.1.1.1.3.2" xref="S2.SS3.p1.2.m2.2.2.1.1.1.1.3.1.cmml"><mo id="S2.SS3.p1.2.m2.2.2.1.1.1.1.3.2.1" stretchy="false" xref="S2.SS3.p1.2.m2.2.2.1.1.1.1.3.1.1.cmml">[</mo><mover accent="true" id="S2.SS3.p1.2.m2.1.1" xref="S2.SS3.p1.2.m2.1.1.cmml"><mi id="S2.SS3.p1.2.m2.1.1.2" xref="S2.SS3.p1.2.m2.1.1.2.cmml">i</mi><mo id="S2.SS3.p1.2.m2.1.1.1" stretchy="false" xref="S2.SS3.p1.2.m2.1.1.1.cmml">→</mo></mover><mo id="S2.SS3.p1.2.m2.2.2.1.1.1.1.3.2.2" stretchy="false" xref="S2.SS3.p1.2.m2.2.2.1.1.1.1.3.1.1.cmml">]</mo></mrow></mrow><mo id="S2.SS3.p1.2.m2.2.2.1.1.1.3" stretchy="false" xref="S2.SS3.p1.2.m2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.SS3.p1.2.m2.2.2.2" xref="S2.SS3.p1.2.m2.2.2.2.cmml">=</mo><mrow id="S2.SS3.p1.2.m2.2.2.3" xref="S2.SS3.p1.2.m2.2.2.3.cmml"><mrow id="S2.SS3.p1.2.m2.2.2.3.2" xref="S2.SS3.p1.2.m2.2.2.3.2.cmml"><mi id="S2.SS3.p1.2.m2.2.2.3.2.2" xref="S2.SS3.p1.2.m2.2.2.3.2.2.cmml">𝐀</mi><mo id="S2.SS3.p1.2.m2.2.2.3.2.1" xref="S2.SS3.p1.2.m2.2.2.3.2.1.cmml">⁢</mo><mover accent="true" id="S2.SS3.p1.2.m2.2.2.3.2.3" xref="S2.SS3.p1.2.m2.2.2.3.2.3.cmml"><mi id="S2.SS3.p1.2.m2.2.2.3.2.3.2" xref="S2.SS3.p1.2.m2.2.2.3.2.3.2.cmml">i</mi><mo id="S2.SS3.p1.2.m2.2.2.3.2.3.1" stretchy="false" xref="S2.SS3.p1.2.m2.2.2.3.2.3.1.cmml">→</mo></mover></mrow><mo id="S2.SS3.p1.2.m2.2.2.3.1" xref="S2.SS3.p1.2.m2.2.2.3.1.cmml">+</mo><mi id="S2.SS3.p1.2.m2.2.2.3.3" xref="S2.SS3.p1.2.m2.2.2.3.3.cmml">𝐛</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.2.m2.2b"><apply id="S2.SS3.p1.2.m2.2.2.cmml" xref="S2.SS3.p1.2.m2.2.2"><eq id="S2.SS3.p1.2.m2.2.2.2.cmml" xref="S2.SS3.p1.2.m2.2.2.2"></eq><apply id="S2.SS3.p1.2.m2.2.2.1.cmml" xref="S2.SS3.p1.2.m2.2.2.1"><times id="S2.SS3.p1.2.m2.2.2.1.2.cmml" xref="S2.SS3.p1.2.m2.2.2.1.2"></times><ci id="S2.SS3.p1.2.m2.2.2.1.3.cmml" xref="S2.SS3.p1.2.m2.2.2.1.3">𝜃</ci><apply id="S2.SS3.p1.2.m2.2.2.1.1.1.1.cmml" xref="S2.SS3.p1.2.m2.2.2.1.1.1"><times id="S2.SS3.p1.2.m2.2.2.1.1.1.1.1.cmml" xref="S2.SS3.p1.2.m2.2.2.1.1.1.1.1"></times><ci id="S2.SS3.p1.2.m2.2.2.1.1.1.1.2.cmml" xref="S2.SS3.p1.2.m2.2.2.1.1.1.1.2">𝑆</ci><apply id="S2.SS3.p1.2.m2.2.2.1.1.1.1.3.1.cmml" xref="S2.SS3.p1.2.m2.2.2.1.1.1.1.3.2"><csymbol cd="latexml" id="S2.SS3.p1.2.m2.2.2.1.1.1.1.3.1.1.cmml" xref="S2.SS3.p1.2.m2.2.2.1.1.1.1.3.2.1">delimited-[]</csymbol><apply id="S2.SS3.p1.2.m2.1.1.cmml" xref="S2.SS3.p1.2.m2.1.1"><ci id="S2.SS3.p1.2.m2.1.1.1.cmml" xref="S2.SS3.p1.2.m2.1.1.1">→</ci><ci id="S2.SS3.p1.2.m2.1.1.2.cmml" xref="S2.SS3.p1.2.m2.1.1.2">𝑖</ci></apply></apply></apply></apply><apply id="S2.SS3.p1.2.m2.2.2.3.cmml" xref="S2.SS3.p1.2.m2.2.2.3"><plus id="S2.SS3.p1.2.m2.2.2.3.1.cmml" xref="S2.SS3.p1.2.m2.2.2.3.1"></plus><apply id="S2.SS3.p1.2.m2.2.2.3.2.cmml" xref="S2.SS3.p1.2.m2.2.2.3.2"><times id="S2.SS3.p1.2.m2.2.2.3.2.1.cmml" xref="S2.SS3.p1.2.m2.2.2.3.2.1"></times><ci id="S2.SS3.p1.2.m2.2.2.3.2.2.cmml" xref="S2.SS3.p1.2.m2.2.2.3.2.2">𝐀</ci><apply id="S2.SS3.p1.2.m2.2.2.3.2.3.cmml" xref="S2.SS3.p1.2.m2.2.2.3.2.3"><ci id="S2.SS3.p1.2.m2.2.2.3.2.3.1.cmml" xref="S2.SS3.p1.2.m2.2.2.3.2.3.1">→</ci><ci id="S2.SS3.p1.2.m2.2.2.3.2.3.2.cmml" xref="S2.SS3.p1.2.m2.2.2.3.2.3.2">𝑖</ci></apply></apply><ci id="S2.SS3.p1.2.m2.2.2.3.3.cmml" xref="S2.SS3.p1.2.m2.2.2.3.3">𝐛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.2.m2.2c">\theta(S[\vec{i}])=\mathbf{A}\vec{i}+\mathbf{b}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.2.m2.2d">italic_θ ( italic_S [ over→ start_ARG italic_i end_ARG ] ) = bold_A over→ start_ARG italic_i end_ARG + bold_b</annotation></semantics></math>.
The polyhedral model can also handle tiling, so the formulas include integer division with a constant as well, and this is what the “quasi-” prefix refers to. However, for brevity and clarity, we omit discussion of these details and for a more comprehensive description of the polyhedral model we recommend <cite class="ltx_cite ltx_citemacro_citep">(Feautrier, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib20" title="">1996</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib21" title="">1997</a>; Verdoolaege et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib47" title="">[n. d.]</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S2.SS3.p2">
<p class="ltx_p" id="S2.SS3.p2.1">Abiding by those restrictions, which is reasonably possible in a wide range of high performance science and engineering applications, enables ML systems that use <span class="ltx_text ltx_font_smallcaps" id="S2.SS3.p2.1.1">Tadashi</span> to guarantee correct and legal output at a scale, unlike most other existing solutions.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span><span class="ltx_text ltx_font_smallcaps" id="S3.1.1">Tadashi</span>: A Library to Sample Legal Polyhedral Transformations</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1"><span class="ltx_text ltx_font_smallcaps" id="S3.p1.1.1">Tadashi</span> is a library that provide the means for ML practitioners to sample the space of legal polyhedral loop transformations. The user can use <span class="ltx_text ltx_font_smallcaps" id="S3.p1.1.2">Tadashi</span> to describe a sampling strategy that is suited for the ML approach, e.g. uniform sampling to curate datasets vs. guided exploration of the space of legal transformations. Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#S0.F1" title="Figure 1 ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">1</span></a> gives an overview of <span class="ltx_text ltx_font_smallcaps" id="S3.p1.1.3">Tadashi</span>. At an architectural level, <span class="ltx_text ltx_font_smallcaps" id="S3.p1.1.4">Tadashi</span> consists of a Python front-end and a C/C++ back-end (aptly named <code class="ltx_verbatim ltx_font_typewriter" id="S3.p1.1.5">ctadashi</code>). The front-end provides a minimal and easy-to-use interface to sample from the space of possible transformations, check their legality, and generate the transformed code. More importantly, the front-end being in Python encourages fast adoption by ML practitioners since Python is the de facto language used in AI/ML frameworks. The back-end implements this functionality, using the Integer Set Library (ISL) <cite class="ltx_cite ltx_citemacro_citep">(Verdoolaege, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib43" title="">2010</a>)</cite> and Polyhedral Extract Tool (PET) <cite class="ltx_cite ltx_citemacro_citep">(Verdoolaege and Grosser, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib45" title="">2012</a>)</cite> polyhedral libraries.</p>
</div>
<div class="ltx_para" id="S3.p2">
<p class="ltx_p" id="S3.p2.1">Existing ISL wrapper libraries for Python expose the full API of the library, which can be daunting for users not versed in the concepts of polyhedral compilation.
The goal of <span class="ltx_text ltx_font_smallcaps" id="S3.p2.1.1">Tadashi</span> is to lower this barrier to entry for ML engineers and researchers by providing out-of-the-box implementations of transformations, legality check and code generation.
Moreover, the functionality is exposed in a more idiomatically Pythonic way. For example, a tree of nested loops is presented is a hierarchy of nested objects similar to how HTML parse trees are used in Python libraries, i.e., a transformation on a given node can be done by calling an appropriate method of a given object, while hiding all bookkeeping necessary for interacting with ISL and PET libraries.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1. </span>Python Front-End: Polyhedral Made Easy</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">To demonstrate the ease of use of <span class="ltx_text ltx_font_smallcaps" id="S3.SS1.p1.1.1">Tadashi</span>, Listing <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#LST2" title="Listing 2 ‣ 3.1. Python Front-End: Polyhedral Made Easy ‣ 3. Tadashi: A Library to Sample Legal Polyhedral Transformations ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">2</span></a> performs a tiling transformation, checks legality, and generates new code in less than 10 lines of a fully functional Python example. Line <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#lstnumberx5" title="line 2 ‣ Listing 2 ‣ 3.1. Python Front-End: Polyhedral Made Easy ‣ 3. Tadashi: A Library to Sample Legal Polyhedral Transformations ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">2</span></a> creates the <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.p1.1.2">app</code> object, which stores the information required by <span class="ltx_text ltx_font_smallcaps" id="S3.SS1.p1.1.3">Tadashi</span> to load the input file. The <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.p1.1.4">scops</code> object in line <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#lstnumberx6" title="line 3 ‣ Listing 2 ‣ 3.1. Python Front-End: Polyhedral Made Easy ‣ 3. Tadashi: A Library to Sample Legal Polyhedral Transformations ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">3</span></a> stores the polyhedral representations of the loop nests. The <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.p1.1.5">node</code> object on line <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#lstnumberx7" title="line 4 ‣ Listing 2 ‣ 3.1. Python Front-End: Polyhedral Made Easy ‣ 3. Tadashi: A Library to Sample Legal Polyhedral Transformations ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">4</span></a> specifies the loop inside the first SCoP, and a tiling transformation (with tile size 16) is performed on line <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#lstnumberx8" title="line 5 ‣ Listing 2 ‣ 3.1. Python Front-End: Polyhedral Made Easy ‣ 3. Tadashi: A Library to Sample Legal Polyhedral Transformations ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">5</span></a>. The legality of the tiling is checked together with the transformation, and the result is stored in the <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.p1.1.6">legal</code> variable. If the transformation is legal, the new code is generated in line <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#lstnumberx10" title="line 7 ‣ Listing 2 ‣ 3.1. Python Front-End: Polyhedral Made Easy ‣ 3. Tadashi: A Library to Sample Legal Polyhedral Transformations ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">7</span></a>.</p>
</div>
<figure class="ltx_float ltx_lstlisting" id="LST2">
<div class="ltx_listing ltx_lst_language_Python ltx_lst_numbers_left ltx_lstlisting ltx_framed ltx_framed_topbottom ltx_listing" id="LST2.1">
<div class="ltx_listing_data"><a download="" href="data:text/plain;base64,aW1wb3J0IHRhZGFzaGkKYXBwID0gdGFkYWhpcy5TaW1wbGUoImlucHV0LmMiKSAvKkBcbGFiZWx7bG46YXBwfUAqLwpzY29wcyA9IHRhZGFoaS5TY29wcyhhcHApIC8qQFxsYWJlbHtsbjpzY29wc31AKi8Kbm9kZSA9IHNjb3BzWzBdLnNjaGVkdWxlX3RyZWVbMV0gLypAXGxhYmVse2xuOm5vZGV9QCovCmxlZ2FsID0gbm9kZS50cmFuc2Zvcm0odGFkYXNoaS5UckVudW0uVElMRSwgMTYpIC8qQFxsYWJlbHtsbjp0cmFuc2Zvcm19QCovCmlmIGxlZ2FsOgogICAgc2NvcHMuZ2VuZXJhdGVfY29kZShvdXRwdXRfcGF0aD0ib3V0cHV0LmMiKSAvKkBcbGFiZWx7bG46Y29kZWdlbn1AKi8=">⬇</a></div>
<div class="ltx_listingline" id="lstnumberx4">
<span class="ltx_tag ltx_tag_listingline">1</span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter ltx_font_bold" id="lstnumberx4.1" style="font-size:90%;">import</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx4.2" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx4.3" style="font-size:90%;">tadashi</span>
</div>
<div class="ltx_listingline" id="lstnumberx5">
<span class="ltx_tag ltx_tag_listingline">2</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx5.1" style="font-size:90%;">app</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx5.2" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx5.3" style="font-size:90%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx5.4" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx5.5" style="font-size:90%;">tadahis</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx5.6" style="font-size:90%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx5.7" style="font-size:90%;">Simple</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx5.8" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx5.9" style="font-size:90%;">"input.c"</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx5.10" style="font-size:90%;">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx5.11" style="font-size:90%;"> </span><span class="ltx_text" id="lstnumberx5.12"></span>
</div>
<div class="ltx_listingline" id="lstnumberx6">
<span class="ltx_tag ltx_tag_listingline">3</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx6.1" style="font-size:90%;">scops</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx6.2" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx6.3" style="font-size:90%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx6.4" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx6.5" style="font-size:90%;">tadahi</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx6.6" style="font-size:90%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx6.7" style="font-size:90%;">Scops</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx6.8" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx6.9" style="font-size:90%;">app</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx6.10" style="font-size:90%;">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx6.11" style="font-size:90%;"> </span><span class="ltx_text" id="lstnumberx6.12"></span>
</div>
<div class="ltx_listingline" id="lstnumberx7">
<span class="ltx_tag ltx_tag_listingline">4</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx7.1" style="font-size:90%;">node</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx7.2" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx7.3" style="font-size:90%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx7.4" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx7.5" style="font-size:90%;">scops</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx7.6" style="font-size:90%;">[0].</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx7.7" style="font-size:90%;">schedule_tree</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx7.8" style="font-size:90%;">[1]</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx7.9" style="font-size:90%;"> </span><span class="ltx_text" id="lstnumberx7.10"></span>
</div>
<div class="ltx_listingline" id="lstnumberx8">
<span class="ltx_tag ltx_tag_listingline">5</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx8.1" style="font-size:90%;">legal</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx8.2" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx8.3" style="font-size:90%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx8.4" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx8.5" style="font-size:90%;">node</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx8.6" style="font-size:90%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx8.7" style="font-size:90%;">transform</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx8.8" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx8.9" style="font-size:90%;">tadashi</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx8.10" style="font-size:90%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx8.11" style="font-size:90%;">TrEnum</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx8.12" style="font-size:90%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx8.13" style="font-size:90%;">TILE</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx8.14" style="font-size:90%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx8.15" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx8.16" style="font-size:90%;">16)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx8.17" style="font-size:90%;"> </span><span class="ltx_text" id="lstnumberx8.18"></span>
</div>
<div class="ltx_listingline" id="lstnumberx9">
<span class="ltx_tag ltx_tag_listingline">6</span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter ltx_font_bold" id="lstnumberx9.1" style="font-size:90%;">if</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx9.2" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx9.3" style="font-size:90%;">legal</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx9.4" style="font-size:90%;">:</span>
</div>
<div class="ltx_listingline" id="lstnumberx10">
<span class="ltx_tag ltx_tag_listingline">7</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx10.1" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx10.2" style="font-size:90%;">scops</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx10.3" style="font-size:90%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx10.4" style="font-size:90%;">generate_code</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx10.5" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx10.6" style="font-size:90%;">output_path</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx10.7" style="font-size:90%;">=</span><span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx10.8" style="font-size:90%;">"output.c"</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx10.9" style="font-size:90%;">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx10.10" style="font-size:90%;"> </span><span class="ltx_text" id="lstnumberx10.11"></span>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float">Listing 2: </span>
End-to-end demonstration of the use of <span class="ltx_text ltx_font_smallcaps" id="LST2.3.1">Tadashi</span>, including transforming the code, checking the legality, and generating the new code.
</figcaption>
</figure>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.1">To pass an input file to <span class="ltx_text ltx_font_smallcaps" id="S3.SS1.p2.1.1">Tadashi</span>, it must be stored in an instance of the <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.p2.1.2">App</code> abstract base class. Currently <span class="ltx_text ltx_font_smallcaps" id="S3.SS1.p2.1.3">Tadashi</span> provides two implementations of <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.p2.1.4">App</code>: the <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.p2.1.5">Simple</code> class (used in line <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#lstnumberx5" title="line 2 ‣ Listing 2 ‣ 3.1. Python Front-End: Polyhedral Made Easy ‣ 3. Tadashi: A Library to Sample Legal Polyhedral Transformations ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">2</span></a>) which can be used for simple single-file programs and <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.p2.1.6"> Polybench</code> (used later in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#S5" title="5. Evaluation ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">5</span></a>) to load Polybench apps <cite class="ltx_cite ltx_citemacro_citep">(Reisinger, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib35" title="">2024</a>)</cite>. The classes derived from <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.p2.1.7">App</code> store the input filename to <span class="ltx_text ltx_font_smallcaps" id="S3.SS1.p2.1.8">Tadashi</span> and additionally include directories are also needed by <span class="ltx_text ltx_font_smallcaps" id="S3.SS1.p2.1.9">Tadashi</span> when parsing the file. For convenience, <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.p2.1.10">App</code> also defines <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.p2.1.11">compile()</code> and <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.p2.1.12">measure()</code> methods.</p>
</div>
<div class="ltx_para" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.1">The polyhedral representation of all loop nests (SCoPs) are implemented as an array-like <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.p3.1.1">scops</code> object (line <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#lstnumberx6" title="line 3 ‣ Listing 2 ‣ 3.1. Python Front-End: Polyhedral Made Easy ‣ 3. Tadashi: A Library to Sample Legal Polyhedral Transformations ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">3</span></a>), and from the first SCoP (<code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.p3.1.2">scops[0]</code>) a <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.p3.1.3">node</code> of the <em class="ltx_emph ltx_font_italic" id="S3.SS1.p3.1.4">schedule trees</em> <cite class="ltx_cite ltx_citemacro_citep">(Verdoolaege et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib46" title="">2014</a>)</cite> is selected (line <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#lstnumberx7" title="line 4 ‣ Listing 2 ‣ 3.1. Python Front-End: Polyhedral Made Easy ‣ 3. Tadashi: A Library to Sample Legal Polyhedral Transformations ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">4</span></a>). For a user not familiar with the polyhedral model and schedule trees, a <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.p3.1.5">node</code> is “an entity that can be transformed”, which usually means a loop in the loop nest (a discussion of schedule trees can be found in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#S4" title="4. Implementation of Tadashi ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">4</span></a>). Since some transformations are not available for certain loops, the <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.p3.1.6">Node</code> class provides <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.p3.1.7">valid()</code> and <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.p3.1.8">valid_args()</code> methods to check availability. The <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.p3.1.9">node</code>s of a <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.p3.1.10">scop</code> can be accessed through the (dynamic) <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.p3.1.11">scop.schedule_tree[]</code> as a list, or as a tree using the <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.p3.1.12">goto_child(child_idx)</code> and <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.p3.1.13">goto_parent()</code> methods of <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.p3.1.14">node</code>s.<span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>The root is <code class="ltx_verbatim" id="footnote3.1"></code>scop.schedule_tree[0]!.</span></span></span></p>
</div>
<div class="ltx_para" id="S3.SS1.p4">
<p class="ltx_p" id="S3.SS1.p4.1">A code transformation is performed by passing a <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.p4.1.1">TrEnum</code> (an <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.p4.1.2">Enum</code> type enumerating all transformations) object to <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.p4.1.3">node.transform()</code> (with the transformation-specific argument). A list of transformations with a short description of their arguments can be found in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#S3.T1" title="Table 1 ‣ 3.1. Python Front-End: Polyhedral Made Easy ‣ 3. Tadashi: A Library to Sample Legal Polyhedral Transformations ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">1</span></a>.
These are primitive transformations, in the sense that they are <em class="ltx_emph ltx_font_italic" id="S3.SS1.p4.1.4">composable</em>, so we can apply a sequence of transformations on the same SCoP. In the current version of <span class="ltx_text ltx_font_smallcaps" id="S3.SS1.p4.1.5">Tadashi</span>, we prioritised the the implementation of loop transformations that have high impact on performance <cite class="ltx_cite ltx_citemacro_citep">(Pouchet et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib34" title="">2011</a>)</cite></p>
</div>
<div class="ltx_para" id="S3.SS1.p5">
<p class="ltx_p" id="S3.SS1.p5.1">The return value of the <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.p5.1.1">transform()</code> method is the result of the legality check and, based on it, the users can decide what they want to do. In case of a legal transformation, one likely action would be generating the C code (line <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#lstnumberx10" title="line 7 ‣ Listing 2 ‣ 3.1. Python Front-End: Polyhedral Made Easy ‣ 3. Tadashi: A Library to Sample Legal Polyhedral Transformations ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">7</span></a>), compiling it and measuring the execution time, while for an illegal transformation one could invoke the <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.p5.1.2">rollback()</code> method of the node, to return the polyhedral representation to legal state.</p>
</div>
<figure class="ltx_table" id="S3.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S3.T1.15.1.1" style="font-size:90%;">Table 1</span>. </span><span class="ltx_text" id="S3.T1.16.2" style="font-size:90%;">
Transformations (primitives) implemented in <span class="ltx_text ltx_font_smallcaps" id="S3.T1.16.2.1">Tadashi</span>: <span class="ltx_text ltx_font_typewriter" id="S3.T1.16.2.2">TILE</span> implements 1D tiling (note: ND tiling can be expressed in <span class="ltx_text ltx_font_smallcaps" id="S3.T1.16.2.3">Tadashi</span> as sweeps of Nx 1D tiling). <span class="ltx_text ltx_font_typewriter" id="S3.T1.16.2.4">INTERCHANGE</span> switches an outer loop with the loop directly under it. For <span class="ltx_text ltx_font_typewriter" id="S3.T1.16.2.5">PARTIAL</span> shift transformations, the statement index (stmt idx) selects only one statement to be shifted, while the <span class="ltx_text ltx_font_typewriter" id="S3.T1.16.2.6">FULL</span> versions shift all statements. The <span class="ltx_text ltx_font_typewriter" id="S3.T1.16.2.7">VAL</span> shift transformation shift the schedule by a constant, the <span class="ltx_text ltx_font_typewriter" id="S3.T1.16.2.8">VAR</span> and <span class="ltx_text ltx_font_typewriter" id="S3.T1.16.2.9">PARAM</span> versions shift by an iterator (iter idx) of an outer loop or a parameter (param idx), multiplied by a coefficient (coeff).
<span class="ltx_text ltx_font_typewriter" id="S3.T1.16.2.10">FULL_FUSE</span> fuses all loops in a sequence, while <span class="ltx_text ltx_font_typewriter" id="S3.T1.16.2.11">FUSE</span> fuses two selected loops. <span class="ltx_text ltx_font_typewriter" id="S3.T1.16.2.12">SET_PARALLEL</span> and <span class="ltx_text ltx_font_typewriter" id="S3.T1.16.2.13">SET_LOOP_OPT</span> modify how code of a loop is generated.
</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T1.17">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T1.17.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="S3.T1.17.1.1.1"><code class="ltx_verbatim ltx_font_typewriter" id="S3.T1.17.1.1.1.1">TrEnum</code></th>
<td class="ltx_td ltx_align_left ltx_border_tt" id="S3.T1.17.1.1.2">Args</td>
</tr>
<tr class="ltx_tr" id="S3.T1.17.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T1.17.2.2.1"><code class="ltx_verbatim ltx_font_typewriter" id="S3.T1.17.2.2.1.1">TILE</code></th>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T1.17.2.2.2">tile size</td>
</tr>
<tr class="ltx_tr" id="S3.T1.17.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.17.3.3.1"><code class="ltx_verbatim ltx_font_typewriter" id="S3.T1.17.3.3.1.1">INTERCHANGE</code></th>
<td class="ltx_td ltx_align_left" id="S3.T1.17.3.3.2">–</td>
</tr>
<tr class="ltx_tr" id="S3.T1.17.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.17.4.4.1"><code class="ltx_verbatim ltx_font_typewriter" id="S3.T1.17.4.4.1.1">FULL_FUSE</code></th>
<td class="ltx_td ltx_align_left" id="S3.T1.17.4.4.2">–</td>
</tr>
<tr class="ltx_tr" id="S3.T1.17.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.17.5.5.1"><code class="ltx_verbatim ltx_font_typewriter" id="S3.T1.17.5.5.1.1">FUSE</code></th>
<td class="ltx_td ltx_align_left" id="S3.T1.17.5.5.2">2 loop indices</td>
</tr>
<tr class="ltx_tr" id="S3.T1.17.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.17.6.6.1"><code class="ltx_verbatim ltx_font_typewriter" id="S3.T1.17.6.6.1.1">FULL_SHIFT_VAL</code></th>
<td class="ltx_td ltx_align_left" id="S3.T1.17.6.6.2">const shift value</td>
</tr>
<tr class="ltx_tr" id="S3.T1.17.7.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.17.7.7.1"><code class="ltx_verbatim ltx_font_typewriter" id="S3.T1.17.7.7.1.1">PARTIAL_SHIFT_VAL</code></th>
<td class="ltx_td ltx_align_left" id="S3.T1.17.7.7.2">stmt idx, const shift value</td>
</tr>
<tr class="ltx_tr" id="S3.T1.17.8.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.17.8.8.1"><code class="ltx_verbatim ltx_font_typewriter" id="S3.T1.17.8.8.1.1">FULL_SHIFT_VAR</code></th>
<td class="ltx_td ltx_align_left" id="S3.T1.17.8.8.2">coeff, shift iter idx</td>
</tr>
<tr class="ltx_tr" id="S3.T1.17.9.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.17.9.9.1"><code class="ltx_verbatim ltx_font_typewriter" id="S3.T1.17.9.9.1.1">PARTIAL_SHIFT_VAR</code></th>
<td class="ltx_td ltx_align_left" id="S3.T1.17.9.9.2">stmt idx, coeff, shift iter idx</td>
</tr>
<tr class="ltx_tr" id="S3.T1.17.10.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.17.10.10.1"><code class="ltx_verbatim ltx_font_typewriter" id="S3.T1.17.10.10.1.1">FULL_SHIFT_PARAM</code></th>
<td class="ltx_td ltx_align_left" id="S3.T1.17.10.10.2">coeff, shift param idx</td>
</tr>
<tr class="ltx_tr" id="S3.T1.17.11.11">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.17.11.11.1"><code class="ltx_verbatim ltx_font_typewriter" id="S3.T1.17.11.11.1.1">PARTIAL_SHIFT_PARAM</code></th>
<td class="ltx_td ltx_align_left" id="S3.T1.17.11.11.2">stmt idx, coeff, shift param idx</td>
</tr>
<tr class="ltx_tr" id="S3.T1.17.12.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.17.12.12.1"><code class="ltx_verbatim ltx_font_typewriter" id="S3.T1.17.12.12.1.1">SCALE</code></th>
<td class="ltx_td ltx_align_left" id="S3.T1.17.12.12.2">coeff</td>
</tr>
<tr class="ltx_tr" id="S3.T1.17.13.13">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.17.13.13.1"><code class="ltx_verbatim ltx_font_typewriter" id="S3.T1.17.13.13.1.1">SET_PARALLEL</code></th>
<td class="ltx_td ltx_align_left" id="S3.T1.17.13.13.2">–</td>
</tr>
<tr class="ltx_tr" id="S3.T1.17.14.14">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S3.T1.17.14.14.1"><code class="ltx_verbatim ltx_font_typewriter" id="S3.T1.17.14.14.1.1">SET_LOOP_OPT</code></th>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S3.T1.17.14.14.2">
<code class="ltx_verbatim ltx_font_typewriter" id="S3.T1.17.14.14.2.1">AstLoopType</code> enum</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="S3.SS1.p6">
<p class="ltx_p" id="S3.SS1.p6.1">The Python front-end, aims to hide the details of the polyhedral model. To this end, <span class="ltx_text ltx_font_smallcaps" id="S3.SS1.p6.1.1">Tadashi</span> provides aliases to class and variable names which might be daunting or confusing to a user unfamiliar with polyhedral concepts (see Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#S3.T2" title="Table 2 ‣ 3.1.1. Sampling Strategies ‣ 3.1. Python Front-End: Polyhedral Made Easy ‣ 3. Tadashi: A Library to Sample Legal Polyhedral Transformations ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">2</span></a>). This way, <span class="ltx_text ltx_font_smallcaps" id="S3.SS1.p6.1.2">Tadashi</span> can hide the details of what is happening under the hood, which we describe in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#S4" title="4. Implementation of Tadashi ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<section class="ltx_subsubsection" id="S3.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.1. </span>Sampling Strategies</h4>
<div class="ltx_para" id="S3.SS1.SSS1.p1">
<p class="ltx_p" id="S3.SS1.SSS1.p1.1">Listing <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#LST2" title="Listing 2 ‣ 3.1. Python Front-End: Polyhedral Made Easy ‣ 3. Tadashi: A Library to Sample Legal Polyhedral Transformations ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">2</span></a> demonstrates the application of a single primitive transformation. However, in consequence of the compositionality of polyhedral transformations, the user can apply a sequence of transformations and legality checks to a SCoP (before generating the code) and hence obtain a different <em class="ltx_emph ltx_font_italic" id="S3.SS1.SSS1.p1.1.1">composite</em> transformation. This is a <em class="ltx_emph ltx_font_italic" id="S3.SS1.SSS1.p1.1.2">new</em> sample from the space of polyhedral transformations, different from its component primitive transformations. Put differently, sampling the space of polyhedral transformations with <span class="ltx_text ltx_font_smallcaps" id="S3.SS1.SSS1.p1.1.3">Tadashi</span> consists of applying a sequence of transformations to a SCoP, where each entry consists of specifying a location (a node in the schedule tree), the transformation (<code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.SSS1.p1.1.4">TrEnum</code>) and a set of arguments. A location can be selected using the <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.SSS1.p1.1.5">schedule_tree[]</code> member or with a combination of <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.SSS1.p1.1.6">goto_*</code> methods of the <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.SSS1.p1.1.7">Node</code> class. The transformation can be selected from the possible values <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.SSS1.p1.1.8">TrEnum</code> values and checked if it is available on the selected node. Finally, selecting an argument is somewhat convoluted, since the available values depend not only on the selected transformation, but also on the concrete properties of the selected schedule node (such as its partial schedule, type and number of children etc.). <span class="ltx_text ltx_font_smallcaps" id="S3.SS1.SSS1.p1.1.9">Tadashi</span> exposes the necessary information for random argument selection by providing the list of available values or the lower and upper bounds for integer arguments.</p>
</div>
<div class="ltx_para" id="S3.SS1.SSS1.p2">
<p class="ltx_p" id="S3.SS1.SSS1.p2.4">For example, if we intend to narrow the search space by iterating over combinations of shifts and tiles, shifting by single increments of surrounding iteration variables and tile sizes of powers of <math alttext="2" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p2.1.m1.1"><semantics id="S3.SS1.SSS1.p2.1.m1.1a"><mn id="S3.SS1.SSS1.p2.1.m1.1.1" xref="S3.SS1.SSS1.p2.1.m1.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p2.1.m1.1b"><cn id="S3.SS1.SSS1.p2.1.m1.1.1.cmml" type="integer" xref="S3.SS1.SSS1.p2.1.m1.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p2.1.m1.1c">2</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p2.1.m1.1d">2</annotation></semantics></math> starting from <math alttext="8" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p2.2.m2.1"><semantics id="S3.SS1.SSS1.p2.2.m2.1a"><mn id="S3.SS1.SSS1.p2.2.m2.1.1" xref="S3.SS1.SSS1.p2.2.m2.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p2.2.m2.1b"><cn id="S3.SS1.SSS1.p2.2.m2.1.1.cmml" type="integer" xref="S3.SS1.SSS1.p2.2.m2.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p2.2.m2.1c">8</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p2.2.m2.1d">8</annotation></semantics></math> to <math alttext="1024" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p2.3.m3.1"><semantics id="S3.SS1.SSS1.p2.3.m3.1a"><mn id="S3.SS1.SSS1.p2.3.m3.1.1" xref="S3.SS1.SSS1.p2.3.m3.1.1.cmml">1024</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p2.3.m3.1b"><cn id="S3.SS1.SSS1.p2.3.m3.1.1.cmml" type="integer" xref="S3.SS1.SSS1.p2.3.m3.1.1">1024</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p2.3.m3.1c">1024</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p2.3.m3.1d">1024</annotation></semantics></math>, the following steps need to be taken. The desired loop is saved as a <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.SSS1.p2.4.1">node</code>, and each transformation is combined with its arguments. For tiling, this can easily be accomplished using list comprehension, by gathering <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.SSS1.p2.4.2">(TrEnum.TILE, 2**i)</code> pairs where <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.SSS1.p2.4.3">i</code> iterates over <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.SSS1.p2.4.4">range(3, 11)</code>. To create the argument list of the shift transformation, the user obtains the lower and upper bounds of all arguments for <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.SSS1.p2.4.5">FULL_SHIFT_VAR</code> on <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.SSS1.p2.4.6">node</code>. The first argument, the coefficient, is set to <math alttext="1" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p2.4.m4.1"><semantics id="S3.SS1.SSS1.p2.4.m4.1a"><mn id="S3.SS1.SSS1.p2.4.m4.1.1" xref="S3.SS1.SSS1.p2.4.m4.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p2.4.m4.1b"><cn id="S3.SS1.SSS1.p2.4.m4.1.1.cmml" type="integer" xref="S3.SS1.SSS1.p2.4.m4.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p2.4.m4.1c">1</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p2.4.m4.1d">1</annotation></semantics></math> since we want single increments but the second argument, the iterator index is varied, i.e., list of triplets is created containing <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.SSS1.p2.4.7">FULL_SHIFT_VAR</code>, <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.SSS1.p2.4.8">1</code> and <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.SSS1.p2.4.9">iter_idx</code>, where <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.SSS1.p2.4.10">iter_idx</code> iterater over the <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.SSS1.p2.4.11">range</code> between the lower and upper bound of the second argument. Using the <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.SSS1.p2.4.12">product()</code> function from Python’s <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.SSS1.p2.4.13">itertools</code> package, these two lists are combined into a list of <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.SSS1.p2.4.14">(tile, shift)</code> pairs. Then by iterating through these pairs in a loop, we can call the <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.SSS1.p2.4.15">node</code>’s <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.SSS1.p2.4.16">transform()</code> method, first with <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.SSS1.p2.4.17">*tile</code>, then with <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS1.SSS1.p2.4.18">*shift</code>, followed by a checking the legality and generating code.</p>
</div>
<figure class="ltx_table" id="S3.T2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S3.T2.2.1.1" style="font-size:90%;">Table 2</span>. </span><span class="ltx_text" id="S3.T2.3.2" style="font-size:90%;">Aliases to class names and member variables to hide polyhedral concepts.</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T2.4">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T2.4.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S3.T2.4.1.1.1">Polyhedral</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S3.T2.4.1.1.2">Simplified</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T2.4.2.1">
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.4.2.1.1"><code class="ltx_verbatim ltx_font_typewriter" id="S3.T2.4.2.1.1.1">Scops</code></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.4.2.1.2"><code class="ltx_verbatim ltx_font_typewriter" id="S3.T2.4.2.1.2.1">LoopNests</code></td>
</tr>
<tr class="ltx_tr" id="S3.T2.4.3.2">
<td class="ltx_td ltx_align_left" id="S3.T2.4.3.2.1"><code class="ltx_verbatim ltx_font_typewriter" id="S3.T2.4.3.2.1.1">Scop</code></td>
<td class="ltx_td ltx_align_left" id="S3.T2.4.3.2.2"><code class="ltx_verbatim ltx_font_typewriter" id="S3.T2.4.3.2.2.1">LoopNest</code></td>
</tr>
<tr class="ltx_tr" id="S3.T2.4.4.3">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S3.T2.4.4.3.1"><code class="ltx_verbatim ltx_font_typewriter" id="S3.T2.4.4.3.1.1">scop.schedule_tree[]</code></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S3.T2.4.4.3.2"><code class="ltx_verbatim ltx_font_typewriter" id="S3.T2.4.4.3.2.1">loop_nest.nodes[]</code></td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2. </span>Using Different ML Methods With <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.1.1">Tadashi</span>
</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">The goal of <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p1.1.1">Tadashi</span> is to lower the barrier to entry for user-guided sampling of legal loop transformations. <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p1.1.2">Tadashi</span> does not in itself implement any type of ML; we do however design <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p1.1.3">Tadashi</span> with considerations to how various ML approaches can use it. The design of <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p1.1.4">Tadashi</span> supports the following ML search space exploration approaches:</p>
</div>
<section class="ltx_subsubsection" id="S3.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.1. </span>Reinforcement Learning (RL)</h4>
<div class="ltx_para" id="S3.SS2.SSS1.p1">
<p class="ltx_p" id="S3.SS2.SSS1.p1.1">RL <cite class="ltx_cite ltx_citemacro_citep">(Sutton and Barto, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib40" title="">2018</a>)</cite> is a prime candidate to use <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.SSS1.p1.1.1">Tadashi</span>, since <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.SSS1.p1.1.2">Tadashi</span>’s interface maps naturally to RL concepts.
Similar to choosing winning moves in a game, an RL agent chooses promising transformations.
The transformed code is executed by the runtime and speedup over the original version serves a the reward signal. Sequences of transformations can be sampled by using approaches such as Monte Carlo tree search (MCTS), where a neural network model gives scores to possible choices - an approach similar to Alpha Go<cite class="ltx_cite ltx_citemacro_citep">(Silver et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib38" title="">2016</a>)</cite> system.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.2. </span>Supervised Learning</h4>
<div class="ltx_para" id="S3.SS2.SSS2.p1">
<p class="ltx_p" id="S3.SS2.SSS2.p1.1">Different versions of transformed source codes and corresponding speedups can be saved in a database.
A model to predict speedups from transformations
can be trained in supervised fashion to be used as a value model in an off-policy reinforcement learning setup or in other applications.</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS2.p2">
<p class="ltx_p" id="S3.SS2.SSS2.p2.1">Such approach is especially valuable, because evaluation of transformed code takes significantly more time, compared to selecting and performing transformations (see sec. <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#S5" title="5. Evaluation ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">5</span></a>)</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS2.p3">
<p class="ltx_p" id="S3.SS2.SSS2.p3.1">The choice of transformations can be done in random or by grid search.
Many transformations require additional corresponding parameters, e.g. choosing to tile a loop requires choosing a tile size.
These arguments (second column in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#S3.T1" title="Table 1 ‣ 3.1. Python Front-End: Polyhedral Made Easy ‣ 3. Tadashi: A Library to Sample Legal Polyhedral Transformations ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">1</span></a>)
allow the user to combinatorially increase the coverage of the search space to consequently increase the coverage of the curated dataset. For example, starting with a limited set of input C source files containing loop nests, one could run <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.SSS2.p3.1.1">Tadashi</span> to select random transformations (on a random input file, on random nodes of the schedule tree, with random parameters), then store the new code with the result of the legality check and the measured execution time. The dataset generated this way would consist of (input, output) pairs, where the input is (the name of) a C source file, and the output consists of:

<span class="ltx_inline-enumerate" id="S3.I1">
<span class="ltx_inline-item" id="S3.I1.i1"><span class="ltx_tag ltx_tag_inline-item">(1)</span> <span class="ltx_text" id="S3.I1.i1.1">the transformation,
</span></span>
<span class="ltx_inline-item" id="S3.I1.i2"><span class="ltx_tag ltx_tag_inline-item">(2)</span> <span class="ltx_text" id="S3.I1.i2.1">transformed code,
</span></span>
<span class="ltx_inline-item" id="S3.I1.i3"><span class="ltx_tag ltx_tag_inline-item">(3)</span> <span class="ltx_text" id="S3.I1.i3.1">legality of the transformation,
</span></span>
<span class="ltx_inline-item" id="S3.I1.i4"><span class="ltx_tag ltx_tag_inline-item">(4)</span> <span class="ltx_text" id="S3.I1.i4.1">execution time of the transformed program.
</span></span>
</span></p>
</div>
<div class="ltx_para" id="S3.SS2.SSS2.p4">
<p class="ltx_p" id="S3.SS2.SSS2.p4.1">In the case of legal transformations, the transformed code can be added to the pool of input files, expanding the number of different input files <em class="ltx_emph ltx_font_italic" id="S3.SS2.SSS2.p4.1.1">ad infinitum</em>.</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS2.p5">
<p class="ltx_p" id="S3.SS2.SSS2.p5.1">Another, approach is to sample sequences of transformations, i.e., generate a sequence (of a random length) of random transformations, where the individual transformations are sampled similarly as described in the previous paragraph. The legality check, code generation and performance measurement are performed only at the end of the sequence.</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS2.p6">
<p class="ltx_p" id="S3.SS2.SSS2.p6.1">With basic Python programming, e.g., using the <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS2.SSS2.p6.1.1">itertools</code> package, one can easily generate a regular “grid” of transformations, which is adequate for scenarios similar to auto-tuning.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS2.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.3. </span>Evolutionary Algorithms</h4>
<div class="ltx_para" id="S3.SS2.SSS3.p1">
<p class="ltx_p" id="S3.SS2.SSS3.p1.1">Similar to RL, evolutionary algorithms use a mix of exploration and exploitation to traverse the search space, however without relying on on learnable parameters and performing search using more direct heuristics <cite class="ltx_cite ltx_citemacro_citep">(Cai et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib9" title="">2023</a>)</cite>. Exploration refers to searching for new, diverse solutions by exploring a wide range of the solution space, while exploitation focuses on refining and improving existing solutions by intensively searching around the best solutions found so far. As mentioned above in other ML approaches, <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.SSS3.p1.1.1">Tadashi</span>’s sampling of the search space can be parameterised by the user to explore a wide range of the search space (exploration) or intensive search in a narrow region of the search space (exploitation). The runtime of the transformed code variants would be used as the objective function.</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS3.p2">
<p class="ltx_p" id="S3.SS2.SSS3.p2.1">The exploration capability of evolutionary algorithms can in some instances improve if infeasible solutions appear in the population <cite class="ltx_cite ltx_citemacro_citep">(While and Hingston, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib50" title="">2013</a>)</cite>, and then later be penalised to disappear over time from the population <cite class="ltx_cite ltx_citemacro_citep">(Coello, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib11" title="">2022</a>)</cite>. <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.SSS3.p2.1.1">Tadashi</span> internally manipulates the schedule to generate both legal and illegal transformations, where we then filter out the illegal transformations. Since illegal transformations can be of value for the exploration capability of evolutionary algorithms, we allow the user to sample illegal transformations simply by not rolling them back and generating code disregarding the result of the legality check.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS2.SSS4">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.4. </span>With LLM Agents</h4>
<div class="ltx_para" id="S3.SS2.SSS4.p1">
<p class="ltx_p" id="S3.SS2.SSS4.p1.1">The most performant transformations identified by any of the aforementioned methods can be used as training data for Large Language Models for better end-to-end code generation or as additional signal to improve overall capacity of the model <cite class="ltx_cite ltx_citemacro_citep">(Du et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib18" title="">2024</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS4.p2">
<p class="ltx_p" id="S3.SS2.SSS4.p2.1">However, in line with the motivation for this paper, an even more promising application of <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.SSS4.p2.1.1">Tadashi</span> would be to be called directly by an LLM agent in a “tool calling” paradigm <cite class="ltx_cite ltx_citemacro_citep">(Schick et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib36" title="">2023</a>)</cite>, similar to Retrieval Augmented Generation (RAG) systems <cite class="ltx_cite ltx_citemacro_citep">(Lewis et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib27" title="">2020</a>)</cite> or Chain of Thought approach <cite class="ltx_cite ltx_citemacro_citep">(Wei et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib49" title="">2024</a>)</cite>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS2.SSS5">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.5. </span>Auto-Tuning</h4>
<div class="ltx_para" id="S3.SS2.SSS5.p1">
<p class="ltx_p" id="S3.SS2.SSS5.p1.1">For practical reasons, ML approaches used in auto-tuning <cite class="ltx_cite ltx_citemacro_citep">(Mustafa, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib32" title="">2022</a>; Ashouri et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib4" title="">2018</a>)</cite> mostly rely on local search methods with focused search around particular regions in the search space, after aggressively pruning the search space. Similar to the exploitation in evolutionary algorithms, <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.SSS5.p1.1.1">Tadashi</span> can be setup to narrow down the search around the region for auto-tuning, based on the post-pruning range of interest.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS2.SSS6">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.6. </span>ML-driven deployment of applications on new hardware</h4>
<div class="ltx_para" id="S3.SS2.SSS6.p1">
<p class="ltx_p" id="S3.SS2.SSS6.p1.1">In addition to supporting the usage patterns of the ML approaches listed above, <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.SSS6.p1.1.1">Tadashi</span> can drive an ML approach to learnhardware specific optimisations on new hardware. After the training phase, applications ported to the new hardware can do inference on the ML model, leveraging <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.SSS6.p1.1.2">Tadashi</span>, to optimise the applications for the new hardware.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3. </span>Extensibility of <span class="ltx_text ltx_font_smallcaps" id="S3.SS3.1.1">Tadashi</span>
</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1"><span class="ltx_text ltx_font_smallcaps" id="S3.SS3.p1.1.1">Tadashi</span> is designed to be extensible w.r.t. the supported transformations, programming languages, and target hardware.</p>
</div>
<div class="ltx_para" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.1">We implemented the set of transformations listed in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#S3.T1" title="Table 1 ‣ 3.1. Python Front-End: Polyhedral Made Easy ‣ 3. Tadashi: A Library to Sample Legal Polyhedral Transformations ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">1</span></a>. To achieve a larger coverage, further transformations (e.g. loop fission) could be added. This requires implementing a function which takes a schedule node as a parameter, performs the desired transformation and returns the transformed node (for details see Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#S4.SS4.SSS2" title="4.4.2. Extending Tadashi With New Transformations ‣ 4.4. Transformations ‣ 4. Implementation of Tadashi ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">4.4.2</span></a>). There are also features of ISL we did not explore yet, such as, expansion and extension nodes. A promising direction is to generate arbitrary partial schedules (which can be virtually any quasi-affine map<span class="ltx_note ltx_role_footnote" id="footnote4"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span>Namely <code class="ltx_verbatim" id="footnote4.1"></code>isl_multi_union_pw_aff!.</span></span></span>) for the band nodes in the schedule tree, providing access to space of all polyhedral transformations.</p>
</div>
<div class="ltx_para" id="S3.SS3.p3">
<p class="ltx_p" id="S3.SS3.p3.1">In essence, <span class="ltx_text ltx_font_smallcaps" id="S3.SS3.p3.1.1">Tadashi</span>’s core capabilities involve operating on ISL schedules, and it is not of importance what tool was used to generate them (the frontend) or how the output code is generated (the code generation backend). This means that while we currently use PET and ISL for those stages, which enables us to target C code, in the future we can integrate with compiler solutions such as Polly <cite class="ltx_cite ltx_citemacro_citep">(Grosser et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib23" title="">2012</a>)</cite> and Polygeist <cite class="ltx_cite ltx_citemacro_citep">(Moses et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib30" title="">2021</a>)</cite> to tap into their respective LLVM and MLIR ecosystems, or other tools which use ISL schedules as an intermediate representation <cite class="ltx_cite ltx_citemacro_citep">(Vasilache et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib42" title="">2018</a>; Verdoolaege et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib44" title="">2013</a>)</cite> to gain additional capabilities w.r.t input languages or target hardware.</p>
</div>
<div class="ltx_para" id="S3.SS3.p4">
<p class="ltx_p" id="S3.SS3.p4.1">One potential scalability issue in utilising <span class="ltx_text ltx_font_smallcaps" id="S3.SS3.p4.1.1">Tadashi</span> for generating a large amount of runtime measurements is the availability of a wide range of inputs to run the generated code with. Benchmarks usually contain a small set of inputs for running the application, however, needing to run the entire application in order to time only specific small portions of it (<code class="ltx_verbatim ltx_font_typewriter" id="S3.SS3.p4.1.2">scops</code>) is wasteful. Since we already isolate these points of interest (<code class="ltx_verbatim ltx_font_typewriter" id="S3.SS3.p4.1.3">scops</code>), existing frameworks for automatic input generation <cite class="ltx_cite ltx_citemacro_citep">(Ivanov et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib24" title="">2024</a>; Kind et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib26" title="">2022</a>)</cite> can be utilised to synthesise inputs which can be used to execute and time only the code in the <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS3.p4.1.4">scop</code>.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Implementation of <span class="ltx_text ltx_font_smallcaps" id="S4.1.1">Tadashi</span>
</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">We now revisit the end-to-end example of Listing <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#LST2" title="Listing 2 ‣ 3.1. Python Front-End: Polyhedral Made Easy ‣ 3. Tadashi: A Library to Sample Legal Polyhedral Transformations ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">2</span></a>, but with our attention directed to implementation details and what is happening under the hood, in the <code class="ltx_verbatim ltx_font_typewriter" id="S4.p1.1.1">ctadashi</code> back-end depicted in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#S4.F3" title="Figure 3 ‣ 4. Implementation of Tadashi ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<figure class="ltx_figure" id="S4.F3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" height="801" id="S4.F3.g1" src="x6.png" width="829"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F3.3.1.1" style="font-size:90%;">Figure 3</span>. </span><span class="ltx_text" id="S4.F3.4.2" style="font-size:90%;">Visual representation of the <span class="ltx_text ltx_font_typewriter" id="S4.F3.4.2.1">ctadashi</span> back-end. The labels in the small circles refer to the line numbers in Listing <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#LST2" title="Listing 2 ‣ 3.1. Python Front-End: Polyhedral Made Easy ‣ 3. Tadashi: A Library to Sample Legal Polyhedral Transformations ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">2</span></a>.</span></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="S4.F3.5">\Description</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S4.F3.6">Overview of the ctadashi back-end.</p>
</div>
</div>
</figure>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1. </span>The App Class</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">The <code class="ltx_verbatim ltx_font_typewriter" id="S4.SS1.p1.1.1">App</code> class (Listing <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#LST2" title="Listing 2 ‣ 3.1. Python Front-End: Polyhedral Made Easy ‣ 3. Tadashi: A Library to Sample Legal Polyhedral Transformations ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">2</span></a> line <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#lstnumberx5" title="line 2 ‣ Listing 2 ‣ 3.1. Python Front-End: Polyhedral Made Easy ‣ 3. Tadashi: A Library to Sample Legal Polyhedral Transformations ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">2</span></a>) is completely written in Python and provided mostly for convenience. It’s main functions are to provide the <code class="ltx_verbatim ltx_font_typewriter" id="S4.SS1.p1.1.2">source_path</code> and <code class="ltx_verbatim ltx_font_typewriter" id="S4.SS1.p1.1.3">include_paths</code> properties, the former being the C source file which will be transformed, and the later a list of paths used to set the required environment variable,<span class="ltx_note ltx_role_footnote" id="footnote5"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_tag ltx_tag_note">5</span>Namely <code class="ltx_verbatim" id="footnote5.1"></code>C_INCLUDE_PATH!.</span></span></span> which is necessary, because when PET runs a compiler pass on the input file, it will throw an error if it cannot find an included header file.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2. </span>SCoPs</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">The creation of the <code class="ltx_verbatim ltx_font_typewriter" id="S4.SS2.p1.1.1">Scops</code> object (line <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#lstnumberx6" title="line 3 ‣ Listing 2 ‣ 3.1. Python Front-End: Polyhedral Made Easy ‣ 3. Tadashi: A Library to Sample Legal Polyhedral Transformations ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">3</span></a>) sets things in motion in the C/C++ back-end of <span class="ltx_text ltx_font_smallcaps" id="S4.SS2.p1.1.2">Tadashi</span>. The input file is passed through PET’s C source transformations function<span class="ltx_note ltx_role_footnote" id="footnote6"><sup class="ltx_note_mark">6</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">6</sup><span class="ltx_tag ltx_tag_note">6</span>Namely <code class="ltx_verbatim" id="footnote6.1"></code>pet_transform_C_source!.</span></span></span> which detects all the SCoPs in the file, but instead of doing any transformations, the <code class="ltx_verbatim ltx_font_typewriter" id="S4.SS2.p1.1.3">pet_scop</code> objects passed to the callback are used to populate the global <code class="ltx_verbatim ltx_font_typewriter" id="S4.SS2.p1.1.4">SCOP_INFO</code> vector. Each entry in this vector is a <code class="ltx_verbatim ltx_font_typewriter" id="S4.SS2.p1.1.5">scop_info_t</code> struct, and stores the pointer to the <code class="ltx_verbatim ltx_font_typewriter" id="S4.SS2.p1.1.6">pet_scop</code>, the dependencies computed by ISL according to the instruction found in <cite class="ltx_cite ltx_citemacro_citep">(Verdoolaege et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib47" title="">[n. d.]</a>)</cite> and using the stricter “may” dependencies,<span class="ltx_note ltx_role_footnote" id="footnote7"><sup class="ltx_note_mark">7</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">7</sup><span class="ltx_tag ltx_tag_note">7</span>Using <code class="ltx_verbatim" id="footnote7.1"></code>isl_union_flow_get_may_dependence!.</span></span></span> and pointer to the “current node”<span class="ltx_note ltx_role_footnote" id="footnote8"><sup class="ltx_note_mark">8</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">8</sup><span class="ltx_tag ltx_tag_note">8</span>Of type <code class="ltx_verbatim" id="footnote8.1"></code>isl_schedule_node!</span></span></span> in the schedule tree.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3. </span>Schedule Tree and Navigation</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">Transformations in <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.p1.1.1">Tadashi</span> are performed on schedule trees, which are alternative ways to represent the domains and schedules in a SCoP (see Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#S2.SS2" title="2.2. The Polyhedral Model ‣ 2. Background and Motivation ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">2.2</span></a>). The leaves of the schedule tree are the statements, the root is the union of their domains. The loops surrounding a statement (in the source code) correspond to <em class="ltx_emph ltx_font_italic" id="S4.SS3.p1.1.2">band nodes</em> in the tree. On the path from the root to the leaf, each band node has a partial schedule and the complete schedule of the statement (i.e., leaf) can be constructed by concatenating the partial schedules. Other nodes in the schedule tree are sequence and filter nodes. Each <em class="ltx_emph ltx_font_italic" id="S4.SS3.p1.1.3">sequence node</em> has multiple <em class="ltx_emph ltx_font_italic" id="S4.SS3.p1.1.4">filter nodes</em> as children and together they represent a sequence of statements and/or nested loops. The sequence node is the placeholder node for the entire sequence, while its children act as roots, i.e., domains for the sub-schedule trees.</p>
</div>
<div class="ltx_para" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.1">Each transformation in <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.p2.1.1">Tadashi</span> is defined on a node of a schedule tree, so line <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#lstnumberx7" title="line 4 ‣ Listing 2 ‣ 3.1. Python Front-End: Polyhedral Made Easy ‣ 3. Tadashi: A Library to Sample Legal Polyhedral Transformations ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">4</span></a> in Listing <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#LST2" title="Listing 2 ‣ 3.1. Python Front-End: Polyhedral Made Easy ‣ 3. Tadashi: A Library to Sample Legal Polyhedral Transformations ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">2</span></a> involves the following mechanism. First, <code class="ltx_verbatim ltx_font_typewriter" id="S4.SS3.p2.1.2">scops[i]</code> returns a Python <code class="ltx_verbatim ltx_font_typewriter" id="S4.SS3.p2.1.3">Scop</code> object which stores the index of the corresponding in <code class="ltx_verbatim ltx_font_typewriter" id="S4.SS3.p2.1.4">SCOP_INFO</code> entry on the C++ side. This <code class="ltx_verbatim ltx_font_typewriter" id="S4.SS3.p2.1.5">Scop</code> object wraps all the C++ functions exposed to Python by calling them with a <code class="ltx_verbatim ltx_font_typewriter" id="S4.SS3.p2.1.6">scop_idx</code> parameter from an object method with same name. These functions include navigation operations<span class="ltx_note ltx_role_footnote" id="footnote9"><sup class="ltx_note_mark">9</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">9</sup><span class="ltx_tag ltx_tag_note">9</span>Namely <code class="ltx_verbatim" id="footnote9.1"></code>goto_root()!, <code class="ltx_verbatim" id="footnote9.2"></code>goto_parent()!, and <code class="ltx_verbatim" id="footnote9.3"></code>goto_child(idx)!.</span></span></span> to update the current node to point to its parent, its child, or to the root of the schedule tree (for the selected <code class="ltx_verbatim ltx_font_typewriter" id="S4.SS3.p2.1.7">scop_info_t</code> object). The <code class="ltx_verbatim ltx_font_typewriter" id="S4.SS3.p2.1.8">schedule_tree</code> property on line <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#lstnumberx7" title="line 4 ‣ Listing 2 ‣ 3.1. Python Front-End: Polyhedral Made Easy ‣ 3. Tadashi: A Library to Sample Legal Polyhedral Transformations ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">4</span></a> is dynamically generated, and exposes the schedule tree as a list of nodes by doing a depth-first traversal. During the traversal, we build a list of child indexes which enables <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.p2.1.9">Tadashi</span> to locate any node by calling <code class="ltx_verbatim ltx_font_typewriter" id="S4.SS3.p2.1.10">goto_child</code> for each element in the list (implemented as the <code class="ltx_verbatim ltx_font_typewriter" id="S4.SS3.p2.1.11">locate</code> method of a <code class="ltx_verbatim ltx_font_typewriter" id="S4.SS3.p2.1.12">Node</code>). In addition to the navigation methods, <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.p2.1.13">Tadashi</span> exposes wrappers to query properties of nodes, (such as node type, number of children, partial schedule, parameters, enclosing iterator variables etc.), and so enables the Python <code class="ltx_verbatim ltx_font_typewriter" id="S4.SS3.p2.1.14">Node</code> object to emulate the ISL schedule tree and its nodes in C++.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4. </span>Transformations</h3>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.1">After updating the current node to point to the desired location, invoking <code class="ltx_verbatim ltx_font_typewriter" id="S4.SS4.p1.1.1">node.transform()</code> calls the C++ function implementing the corresponding transformation. The transformation is performed on the current node of the SCoP specified by the index obtained from the <code class="ltx_verbatim ltx_font_typewriter" id="S4.SS4.p1.1.2">node</code> (similar to the navigation and query functions from the previous paragraph). To be able to rollback the transformation, the current node is copied, and restored if the user calls the <code class="ltx_verbatim ltx_font_typewriter" id="S4.SS4.p1.1.3">rollback</code> method (usually after the transformation turns out to be illegal).</p>
</div>
<section class="ltx_subsubsection" id="S4.SS4.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.4.1. </span>Implementation Details of Individual Transformations</h4>
<div class="ltx_para" id="S4.SS4.SSS1.p1">
<p class="ltx_p" id="S4.SS4.SSS1.p1.1">Multi dimensional tiling is already implemented in ISL, and to expose a simple 1D tiling (with a single integer as its argument) we convert the tile size into the a single valued ISL <code class="ltx_verbatim ltx_font_typewriter" id="S4.SS4.SSS1.p1.1.1">isl_multi_val</code> object.</p>
</div>
<div class="ltx_para" id="S4.SS4.SSS1.p2">
<p class="ltx_p" id="S4.SS4.SSS1.p2.1">Loop interchange is can easily be implemented by:

<span class="ltx_inline-enumerate" id="S4.I1">
<span class="ltx_inline-item" id="S4.I1.i1"><span class="ltx_tag ltx_tag_inline-item">(1)</span> <span class="ltx_text" id="S4.I1.i1.1">saving the partial schedule of the current node,
</span></span>
<span class="ltx_inline-item" id="S4.I1.i2"><span class="ltx_tag ltx_tag_inline-item">(2)</span> <span class="ltx_text" id="S4.I1.i2.1">deleting the current node, and
</span></span>
<span class="ltx_inline-item" id="S4.I1.i3"><span class="ltx_tag ltx_tag_inline-item">(3)</span> <span class="ltx_text" id="S4.I1.i3.1">inserting a new node with the saved schedule below the remaining node.
</span></span>
</span></p>
</div>
<div class="ltx_para" id="S4.SS4.SSS1.p3">
<p class="ltx_p" id="S4.SS4.SSS1.p3.1">Fusing of two loops in a sequence (<code class="ltx_verbatim ltx_font_typewriter" id="S4.SS4.SSS1.p3.1.1">FUSE</code>) is achieved by collecting the two filters (the children of the original sequence node) in an <code class="ltx_verbatim ltx_font_typewriter" id="S4.SS4.SSS1.p3.1.2">isl_union_set_list</code>, then replacing the filters
of the two nodes by a single (union) filter, and finally inserting a new sequence node on top of the original sequence node.</p>
</div>
<div class="ltx_para" id="S4.SS4.SSS1.p4">
<p class="ltx_p" id="S4.SS4.SSS1.p4.1">To merge all band node under a sequence (<code class="ltx_verbatim ltx_font_typewriter" id="S4.SS4.SSS1.p4.1.1">FULL_FUSE</code>), we take their partial schedules, intersect them with the corresponding filters and take the union. Then we introduce a new band node on top of the sequence<span class="ltx_note ltx_role_footnote" id="footnote10"><sup class="ltx_note_mark">10</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">10</sup><span class="ltx_tag ltx_tag_note">10</span>Using  <code class="ltx_verbatim" id="footnote10.1"></code>isl_schedule_insert_partial_schedule!.</span></span></span> and delete the original band nodes.</p>
</div>
<div class="ltx_para" id="S4.SS4.SSS1.p5">
<p class="ltx_p" id="S4.SS4.SSS1.p5.1">The 6 different <code class="ltx_verbatim ltx_font_typewriter" id="S4.SS4.SSS1.p5.1.1">SHIFT</code> transformations, while simple on the surface, involve a tedious process involving the unpacking of the partial schedule, iterating through the sets of its domain and (re)constructing the adequate <code class="ltx_verbatim ltx_font_typewriter" id="S4.SS4.SSS1.p5.1.2">mupa</code><span class="ltx_note ltx_role_footnote" id="footnote11"><sup class="ltx_note_mark">11</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">11</sup><span class="ltx_tag ltx_tag_note">11</span>Short for <code class="ltx_verbatim" id="footnote11.1"></code>isl_multi_union_pw_aff!.</span></span></span> object.</p>
</div>
<div class="ltx_para" id="S4.SS4.SSS1.p6">
<p class="ltx_p" id="S4.SS4.SSS1.p6.1">The <code class="ltx_verbatim ltx_font_typewriter" id="S4.SS4.SSS1.p6.1.1">SET_PARALLEL</code> transformation simply insert a “mark” node, with an <code class="ltx_verbatim ltx_font_typewriter" id="S4.SS4.SSS1.p6.1.2">isl_id</code> name <code class="ltx_verbatim ltx_font_typewriter" id="S4.SS4.SSS1.p6.1.3">"parallel"</code> and the code generatation handles the rest.</p>
</div>
<div class="ltx_para" id="S4.SS4.SSS1.p7">
<p class="ltx_p" id="S4.SS4.SSS1.p7.1">Similarly to <code class="ltx_verbatim ltx_font_typewriter" id="S4.SS4.SSS1.p7.1.1">SET_PARALLEL</code>, <code class="ltx_verbatim ltx_font_typewriter" id="S4.SS4.SSS1.p7.1.2">SET_LOOP_OPT</code> is not strictly speaking a (polyhedral) transformation. It is implemented by simply calling the corresponding ISL function, and influences how code ISL generates code.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS4.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.4.2. </span>Extending <span class="ltx_text ltx_font_smallcaps" id="S4.SS4.SSS2.1.1">Tadashi</span> With New Transformations</h4>
<div class="ltx_para" id="S4.SS4.SSS2.p1">
<p class="ltx_p" id="S4.SS4.SSS2.p1.1">The entry point of a transformation is a function with a SCoP index<span class="ltx_note ltx_role_footnote" id="footnote12"><sup class="ltx_note_mark">12</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">12</sup><span class="ltx_tag ltx_tag_note">12</span>By convention <code class="ltx_verbatim" id="footnote12.1"></code>size_t scop_idx!.</span></span></span> as its first argument (potentially followed by other arguments) in <code class="ltx_verbatim ltx_font_typewriter" id="S4.SS4.SSS2.p1.1.1">ctadashi.cc</code>. Unless the transformation is trivial, the main implementation is added to <code class="ltx_verbatim ltx_font_typewriter" id="S4.SS4.SSS2.p1.1.2">transformations.c</code> as a function which takes a schedule node (with the rest of the arguments) and returns the transformed schedule node. This function is then called from the entry-point function with the current node of the SCoP specified by the SCoP index. The call needs to be prefixed a pre- and followed by a post-transform (convenience) functions, which take care of some bookkeeping to be able to rollback properly. On the Python side, a class derived from <code class="ltx_verbatim ltx_font_typewriter" id="S4.SS4.SSS2.p1.1.3">TranfromInfo</code> stores the name of the entry-point and implements methods which check and provide information for the availability of the transformation on a given node. Finally the <code class="ltx_verbatim ltx_font_typewriter" id="S4.SS4.SSS2.p1.1.4">TrEnum</code> and global <code class="ltx_verbatim ltx_font_typewriter" id="S4.SS4.SSS2.p1.1.5">TRANSFORMATION</code> dictionary connect the <code class="ltx_verbatim ltx_font_typewriter" id="S4.SS4.SSS2.p1.1.6">TransformInfo</code> into the mechanism implemented by the <code class="ltx_verbatim ltx_font_typewriter" id="S4.SS4.SSS2.p1.1.7">Node</code>’s <code class="ltx_verbatim ltx_font_typewriter" id="S4.SS4.SSS2.p1.1.8">transform</code> method.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5. </span>Legality Checking</h3>
<figure class="ltx_figure" id="S4.F4">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="473" id="S4.F4.g1" src="x7.png" width="831"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F4.18.9.1" style="font-size:90%;">Figure 4</span>. </span><span class="ltx_text" id="S4.F4.16.8" style="font-size:90%;">
Checking legality starts with the dependency graph <math alttext="G" class="ltx_Math" display="inline" id="S4.F4.9.1.m1.1"><semantics id="S4.F4.9.1.m1.1b"><mi id="S4.F4.9.1.m1.1.1" xref="S4.F4.9.1.m1.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.F4.9.1.m1.1c"><ci id="S4.F4.9.1.m1.1.1.cmml" xref="S4.F4.9.1.m1.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.9.1.m1.1d">G</annotation><annotation encoding="application/x-llamapun" id="S4.F4.9.1.m1.1e">italic_G</annotation></semantics></math> at the top, which, in case of Listing <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#LST1" title="Listing 1 ‣ 2.2. The Polyhedral Model ‣ 2. Background and Motivation ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">1</span></a>, is one vertex with a loop edge.
The domain and range of the map (below <math alttext="G" class="ltx_Math" display="inline" id="S4.F4.10.2.m2.1"><semantics id="S4.F4.10.2.m2.1b"><mi id="S4.F4.10.2.m2.1.1" xref="S4.F4.10.2.m2.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.F4.10.2.m2.1c"><ci id="S4.F4.10.2.m2.1.1.cmml" xref="S4.F4.10.2.m2.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.10.2.m2.1d">G</annotation><annotation encoding="application/x-llamapun" id="S4.F4.10.2.m2.1e">italic_G</annotation></semantics></math>), which indicates that statement instance <math alttext="S[i,j]" class="ltx_Math" display="inline" id="S4.F4.11.3.m3.2"><semantics id="S4.F4.11.3.m3.2b"><mrow id="S4.F4.11.3.m3.2.3" xref="S4.F4.11.3.m3.2.3.cmml"><mi id="S4.F4.11.3.m3.2.3.2" xref="S4.F4.11.3.m3.2.3.2.cmml">S</mi><mo id="S4.F4.11.3.m3.2.3.1" xref="S4.F4.11.3.m3.2.3.1.cmml">⁢</mo><mrow id="S4.F4.11.3.m3.2.3.3.2" xref="S4.F4.11.3.m3.2.3.3.1.cmml"><mo id="S4.F4.11.3.m3.2.3.3.2.1" stretchy="false" xref="S4.F4.11.3.m3.2.3.3.1.cmml">[</mo><mi id="S4.F4.11.3.m3.1.1" xref="S4.F4.11.3.m3.1.1.cmml">i</mi><mo id="S4.F4.11.3.m3.2.3.3.2.2" xref="S4.F4.11.3.m3.2.3.3.1.cmml">,</mo><mi id="S4.F4.11.3.m3.2.2" xref="S4.F4.11.3.m3.2.2.cmml">j</mi><mo id="S4.F4.11.3.m3.2.3.3.2.3" stretchy="false" xref="S4.F4.11.3.m3.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.F4.11.3.m3.2c"><apply id="S4.F4.11.3.m3.2.3.cmml" xref="S4.F4.11.3.m3.2.3"><times id="S4.F4.11.3.m3.2.3.1.cmml" xref="S4.F4.11.3.m3.2.3.1"></times><ci id="S4.F4.11.3.m3.2.3.2.cmml" xref="S4.F4.11.3.m3.2.3.2">𝑆</ci><interval closure="closed" id="S4.F4.11.3.m3.2.3.3.1.cmml" xref="S4.F4.11.3.m3.2.3.3.2"><ci id="S4.F4.11.3.m3.1.1.cmml" xref="S4.F4.11.3.m3.1.1">𝑖</ci><ci id="S4.F4.11.3.m3.2.2.cmml" xref="S4.F4.11.3.m3.2.2">𝑗</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.11.3.m3.2d">S[i,j]</annotation><annotation encoding="application/x-llamapun" id="S4.F4.11.3.m3.2e">italic_S [ italic_i , italic_j ]</annotation></semantics></math> depends on <math alttext="S[i,j-1]" class="ltx_Math" display="inline" id="S4.F4.12.4.m4.2"><semantics id="S4.F4.12.4.m4.2b"><mrow id="S4.F4.12.4.m4.2.2" xref="S4.F4.12.4.m4.2.2.cmml"><mi id="S4.F4.12.4.m4.2.2.3" xref="S4.F4.12.4.m4.2.2.3.cmml">S</mi><mo id="S4.F4.12.4.m4.2.2.2" xref="S4.F4.12.4.m4.2.2.2.cmml">⁢</mo><mrow id="S4.F4.12.4.m4.2.2.1.1" xref="S4.F4.12.4.m4.2.2.1.2.cmml"><mo id="S4.F4.12.4.m4.2.2.1.1.2" stretchy="false" xref="S4.F4.12.4.m4.2.2.1.2.cmml">[</mo><mi id="S4.F4.12.4.m4.1.1" xref="S4.F4.12.4.m4.1.1.cmml">i</mi><mo id="S4.F4.12.4.m4.2.2.1.1.3" xref="S4.F4.12.4.m4.2.2.1.2.cmml">,</mo><mrow id="S4.F4.12.4.m4.2.2.1.1.1" xref="S4.F4.12.4.m4.2.2.1.1.1.cmml"><mi id="S4.F4.12.4.m4.2.2.1.1.1.2" xref="S4.F4.12.4.m4.2.2.1.1.1.2.cmml">j</mi><mo id="S4.F4.12.4.m4.2.2.1.1.1.1" xref="S4.F4.12.4.m4.2.2.1.1.1.1.cmml">−</mo><mn id="S4.F4.12.4.m4.2.2.1.1.1.3" xref="S4.F4.12.4.m4.2.2.1.1.1.3.cmml">1</mn></mrow><mo id="S4.F4.12.4.m4.2.2.1.1.4" stretchy="false" xref="S4.F4.12.4.m4.2.2.1.2.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.F4.12.4.m4.2c"><apply id="S4.F4.12.4.m4.2.2.cmml" xref="S4.F4.12.4.m4.2.2"><times id="S4.F4.12.4.m4.2.2.2.cmml" xref="S4.F4.12.4.m4.2.2.2"></times><ci id="S4.F4.12.4.m4.2.2.3.cmml" xref="S4.F4.12.4.m4.2.2.3">𝑆</ci><interval closure="closed" id="S4.F4.12.4.m4.2.2.1.2.cmml" xref="S4.F4.12.4.m4.2.2.1.1"><ci id="S4.F4.12.4.m4.1.1.cmml" xref="S4.F4.12.4.m4.1.1">𝑖</ci><apply id="S4.F4.12.4.m4.2.2.1.1.1.cmml" xref="S4.F4.12.4.m4.2.2.1.1.1"><minus id="S4.F4.12.4.m4.2.2.1.1.1.1.cmml" xref="S4.F4.12.4.m4.2.2.1.1.1.1"></minus><ci id="S4.F4.12.4.m4.2.2.1.1.1.2.cmml" xref="S4.F4.12.4.m4.2.2.1.1.1.2">𝑗</ci><cn id="S4.F4.12.4.m4.2.2.1.1.1.3.cmml" type="integer" xref="S4.F4.12.4.m4.2.2.1.1.1.3">1</cn></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.12.4.m4.2d">S[i,j-1]</annotation><annotation encoding="application/x-llamapun" id="S4.F4.12.4.m4.2e">italic_S [ italic_i , italic_j - 1 ]</annotation></semantics></math>, are transformed according to the schedule <math alttext="\theta" class="ltx_Math" display="inline" id="S4.F4.13.5.m5.1"><semantics id="S4.F4.13.5.m5.1b"><mi id="S4.F4.13.5.m5.1.1" xref="S4.F4.13.5.m5.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S4.F4.13.5.m5.1c"><ci id="S4.F4.13.5.m5.1.1.cmml" xref="S4.F4.13.5.m5.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.13.5.m5.1d">\theta</annotation><annotation encoding="application/x-llamapun" id="S4.F4.13.5.m5.1e">italic_θ</annotation></semantics></math>.
The resulting transformed map is shown below (dotted rectangle).
If the difference between the (transformed) domain and the (transformed) range, denoted by <math alttext="\delta" class="ltx_Math" display="inline" id="S4.F4.14.6.m6.1"><semantics id="S4.F4.14.6.m6.1b"><mi id="S4.F4.14.6.m6.1.1" xref="S4.F4.14.6.m6.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="S4.F4.14.6.m6.1c"><ci id="S4.F4.14.6.m6.1.1.cmml" xref="S4.F4.14.6.m6.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.14.6.m6.1d">\delta</annotation><annotation encoding="application/x-llamapun" id="S4.F4.14.6.m6.1e">italic_δ</annotation></semantics></math>, is lexicographicaly positive, the schedule is legal (left side, the <math alttext="\theta" class="ltx_Math" display="inline" id="S4.F4.15.7.m7.1"><semantics id="S4.F4.15.7.m7.1b"><mi id="S4.F4.15.7.m7.1.1" xref="S4.F4.15.7.m7.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S4.F4.15.7.m7.1c"><ci id="S4.F4.15.7.m7.1.1.cmml" xref="S4.F4.15.7.m7.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.15.7.m7.1d">\theta</annotation><annotation encoding="application/x-llamapun" id="S4.F4.15.7.m7.1e">italic_θ</annotation></semantics></math> from Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#S2.F2.sf3" title="In Figure 2 ‣ 2.2. The Polyhedral Model ‣ 2. Background and Motivation ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">2(c)</span></a>), otherwise the schedule is not legal (right side, the <math alttext="\theta" class="ltx_Math" display="inline" id="S4.F4.16.8.m8.1"><semantics id="S4.F4.16.8.m8.1b"><mi id="S4.F4.16.8.m8.1.1" xref="S4.F4.16.8.m8.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S4.F4.16.8.m8.1c"><ci id="S4.F4.16.8.m8.1.1.cmml" xref="S4.F4.16.8.m8.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.16.8.m8.1d">\theta</annotation><annotation encoding="application/x-llamapun" id="S4.F4.16.8.m8.1e">italic_θ</annotation></semantics></math> from Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#S2.F2.sf4" title="In Figure 2 ‣ 2.2. The Polyhedral Model ‣ 2. Background and Motivation ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">2(d)</span></a>).
</span></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="S4.F4.19">\Description</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S4.F4.20">Flow of legality check for two examples.</p>
</div>
</div>
</figure>
<div class="ltx_para" id="S4.SS5.p1">
<p class="ltx_p" id="S4.SS5.p1.4">After a transformation concludes, the legality check is invoked on the same node. The legality check implements the principles described in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#S2.SS2" title="2.2. The Polyhedral Model ‣ 2. Background and Motivation ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">2.2</span></a>. Each step of the legality check in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#alg1" title="Algorithm 1 ‣ 4.5. Legality Checking ‣ 4. Implementation of Tadashi ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">1</span></a> can be implemented with a single ISL function. Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#alg1" title="Algorithm 1 ‣ 4.5. Legality Checking ‣ 4. Implementation of Tadashi ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">1</span></a> is applied after every transformation with the exception of <code class="ltx_verbatim ltx_font_typewriter" id="S4.SS5.p1.4.1">SET_PARALLEL</code>. For the legality of parallel loops the entry in <math alttext="\delta" class="ltx_Math" display="inline" id="S4.SS5.p1.1.m1.1"><semantics id="S4.SS5.p1.1.m1.1a"><mi id="S4.SS5.p1.1.m1.1.1" xref="S4.SS5.p1.1.m1.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.1.m1.1b"><ci id="S4.SS5.p1.1.m1.1.1.cmml" xref="S4.SS5.p1.1.m1.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.1.m1.1c">\delta</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p1.1.m1.1d">italic_δ</annotation></semantics></math> corresponding to the loop should be <math alttext="0" class="ltx_Math" display="inline" id="S4.SS5.p1.2.m2.1"><semantics id="S4.SS5.p1.2.m2.1a"><mn id="S4.SS5.p1.2.m2.1.1" xref="S4.SS5.p1.2.m2.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.2.m2.1b"><cn id="S4.SS5.p1.2.m2.1.1.cmml" type="integer" xref="S4.SS5.p1.2.m2.1.1">0</cn></annotation-xml></semantics></math>, and this can be achieved with a slight modification to Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#alg1" title="Algorithm 1 ‣ 4.5. Legality Checking ‣ 4. Implementation of Tadashi ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">1</span></a>: we use the <em class="ltx_emph ltx_font_italic" id="S4.SS5.p1.4.2">partial</em> schedule instead of the complete schedule in steps <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#alg1.l1" title="In Algorithm 1 ‣ 4.5. Legality Checking ‣ 4. Implementation of Tadashi ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">1</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#alg1.l2" title="In Algorithm 1 ‣ 4.5. Legality Checking ‣ 4. Implementation of Tadashi ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">2</span></a>, and in step <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#alg1.l4" title="In Algorithm 1 ‣ 4.5. Legality Checking ‣ 4. Implementation of Tadashi ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">4</span></a> we compute <math alttext="M_{&lt;}=\{\vec{d}\to\vec{0}:\vec{d}\in\delta\land\vec{d}&lt;_{\text{LEX}}\vec{0}\}" class="ltx_Math" display="inline" id="S4.SS5.p1.3.m3.2"><semantics id="S4.SS5.p1.3.m3.2a"><mrow id="S4.SS5.p1.3.m3.2.2" xref="S4.SS5.p1.3.m3.2.2.cmml"><msub id="S4.SS5.p1.3.m3.2.2.4" xref="S4.SS5.p1.3.m3.2.2.4.cmml"><mi id="S4.SS5.p1.3.m3.2.2.4.2" xref="S4.SS5.p1.3.m3.2.2.4.2.cmml">M</mi><mo id="S4.SS5.p1.3.m3.2.2.4.3" xref="S4.SS5.p1.3.m3.2.2.4.3.cmml">&lt;</mo></msub><mo id="S4.SS5.p1.3.m3.2.2.3" xref="S4.SS5.p1.3.m3.2.2.3.cmml">=</mo><mrow id="S4.SS5.p1.3.m3.2.2.2.2" xref="S4.SS5.p1.3.m3.2.2.2.3.cmml"><mo id="S4.SS5.p1.3.m3.2.2.2.2.3" stretchy="false" xref="S4.SS5.p1.3.m3.2.2.2.3.1.cmml">{</mo><mrow id="S4.SS5.p1.3.m3.1.1.1.1.1" xref="S4.SS5.p1.3.m3.1.1.1.1.1.cmml"><mover accent="true" id="S4.SS5.p1.3.m3.1.1.1.1.1.2" xref="S4.SS5.p1.3.m3.1.1.1.1.1.2.cmml"><mi id="S4.SS5.p1.3.m3.1.1.1.1.1.2.2" xref="S4.SS5.p1.3.m3.1.1.1.1.1.2.2.cmml">d</mi><mo id="S4.SS5.p1.3.m3.1.1.1.1.1.2.1" stretchy="false" xref="S4.SS5.p1.3.m3.1.1.1.1.1.2.1.cmml">→</mo></mover><mo id="S4.SS5.p1.3.m3.1.1.1.1.1.1" stretchy="false" xref="S4.SS5.p1.3.m3.1.1.1.1.1.1.cmml">→</mo><mover accent="true" id="S4.SS5.p1.3.m3.1.1.1.1.1.3" xref="S4.SS5.p1.3.m3.1.1.1.1.1.3.cmml"><mn id="S4.SS5.p1.3.m3.1.1.1.1.1.3.2" xref="S4.SS5.p1.3.m3.1.1.1.1.1.3.2.cmml">0</mn><mo id="S4.SS5.p1.3.m3.1.1.1.1.1.3.1" stretchy="false" xref="S4.SS5.p1.3.m3.1.1.1.1.1.3.1.cmml">→</mo></mover></mrow><mo id="S4.SS5.p1.3.m3.2.2.2.2.4" lspace="0.278em" rspace="0.278em" xref="S4.SS5.p1.3.m3.2.2.2.3.1.cmml">:</mo><mrow id="S4.SS5.p1.3.m3.2.2.2.2.2" xref="S4.SS5.p1.3.m3.2.2.2.2.2.cmml"><mover accent="true" id="S4.SS5.p1.3.m3.2.2.2.2.2.2" xref="S4.SS5.p1.3.m3.2.2.2.2.2.2.cmml"><mi id="S4.SS5.p1.3.m3.2.2.2.2.2.2.2" xref="S4.SS5.p1.3.m3.2.2.2.2.2.2.2.cmml">d</mi><mo id="S4.SS5.p1.3.m3.2.2.2.2.2.2.1" stretchy="false" xref="S4.SS5.p1.3.m3.2.2.2.2.2.2.1.cmml">→</mo></mover><mo id="S4.SS5.p1.3.m3.2.2.2.2.2.3" xref="S4.SS5.p1.3.m3.2.2.2.2.2.3.cmml">∈</mo><mrow id="S4.SS5.p1.3.m3.2.2.2.2.2.4" xref="S4.SS5.p1.3.m3.2.2.2.2.2.4.cmml"><mi id="S4.SS5.p1.3.m3.2.2.2.2.2.4.2" xref="S4.SS5.p1.3.m3.2.2.2.2.2.4.2.cmml">δ</mi><mo id="S4.SS5.p1.3.m3.2.2.2.2.2.4.1" xref="S4.SS5.p1.3.m3.2.2.2.2.2.4.1.cmml">∧</mo><mover accent="true" id="S4.SS5.p1.3.m3.2.2.2.2.2.4.3" xref="S4.SS5.p1.3.m3.2.2.2.2.2.4.3.cmml"><mi id="S4.SS5.p1.3.m3.2.2.2.2.2.4.3.2" xref="S4.SS5.p1.3.m3.2.2.2.2.2.4.3.2.cmml">d</mi><mo id="S4.SS5.p1.3.m3.2.2.2.2.2.4.3.1" stretchy="false" xref="S4.SS5.p1.3.m3.2.2.2.2.2.4.3.1.cmml">→</mo></mover></mrow><msub id="S4.SS5.p1.3.m3.2.2.2.2.2.5" xref="S4.SS5.p1.3.m3.2.2.2.2.2.5.cmml"><mo id="S4.SS5.p1.3.m3.2.2.2.2.2.5.2" xref="S4.SS5.p1.3.m3.2.2.2.2.2.5.2.cmml">&lt;</mo><mtext id="S4.SS5.p1.3.m3.2.2.2.2.2.5.3" xref="S4.SS5.p1.3.m3.2.2.2.2.2.5.3a.cmml">LEX</mtext></msub><mover accent="true" id="S4.SS5.p1.3.m3.2.2.2.2.2.6" xref="S4.SS5.p1.3.m3.2.2.2.2.2.6.cmml"><mn id="S4.SS5.p1.3.m3.2.2.2.2.2.6.2" xref="S4.SS5.p1.3.m3.2.2.2.2.2.6.2.cmml">0</mn><mo id="S4.SS5.p1.3.m3.2.2.2.2.2.6.1" stretchy="false" xref="S4.SS5.p1.3.m3.2.2.2.2.2.6.1.cmml">→</mo></mover></mrow><mo id="S4.SS5.p1.3.m3.2.2.2.2.5" stretchy="false" xref="S4.SS5.p1.3.m3.2.2.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.3.m3.2b"><apply id="S4.SS5.p1.3.m3.2.2.cmml" xref="S4.SS5.p1.3.m3.2.2"><eq id="S4.SS5.p1.3.m3.2.2.3.cmml" xref="S4.SS5.p1.3.m3.2.2.3"></eq><apply id="S4.SS5.p1.3.m3.2.2.4.cmml" xref="S4.SS5.p1.3.m3.2.2.4"><csymbol cd="ambiguous" id="S4.SS5.p1.3.m3.2.2.4.1.cmml" xref="S4.SS5.p1.3.m3.2.2.4">subscript</csymbol><ci id="S4.SS5.p1.3.m3.2.2.4.2.cmml" xref="S4.SS5.p1.3.m3.2.2.4.2">𝑀</ci><lt id="S4.SS5.p1.3.m3.2.2.4.3.cmml" xref="S4.SS5.p1.3.m3.2.2.4.3"></lt></apply><apply id="S4.SS5.p1.3.m3.2.2.2.3.cmml" xref="S4.SS5.p1.3.m3.2.2.2.2"><csymbol cd="latexml" id="S4.SS5.p1.3.m3.2.2.2.3.1.cmml" xref="S4.SS5.p1.3.m3.2.2.2.2.3">conditional-set</csymbol><apply id="S4.SS5.p1.3.m3.1.1.1.1.1.cmml" xref="S4.SS5.p1.3.m3.1.1.1.1.1"><ci id="S4.SS5.p1.3.m3.1.1.1.1.1.1.cmml" xref="S4.SS5.p1.3.m3.1.1.1.1.1.1">→</ci><apply id="S4.SS5.p1.3.m3.1.1.1.1.1.2.cmml" xref="S4.SS5.p1.3.m3.1.1.1.1.1.2"><ci id="S4.SS5.p1.3.m3.1.1.1.1.1.2.1.cmml" xref="S4.SS5.p1.3.m3.1.1.1.1.1.2.1">→</ci><ci id="S4.SS5.p1.3.m3.1.1.1.1.1.2.2.cmml" xref="S4.SS5.p1.3.m3.1.1.1.1.1.2.2">𝑑</ci></apply><apply id="S4.SS5.p1.3.m3.1.1.1.1.1.3.cmml" xref="S4.SS5.p1.3.m3.1.1.1.1.1.3"><ci id="S4.SS5.p1.3.m3.1.1.1.1.1.3.1.cmml" xref="S4.SS5.p1.3.m3.1.1.1.1.1.3.1">→</ci><cn id="S4.SS5.p1.3.m3.1.1.1.1.1.3.2.cmml" type="integer" xref="S4.SS5.p1.3.m3.1.1.1.1.1.3.2">0</cn></apply></apply><apply id="S4.SS5.p1.3.m3.2.2.2.2.2.cmml" xref="S4.SS5.p1.3.m3.2.2.2.2.2"><and id="S4.SS5.p1.3.m3.2.2.2.2.2a.cmml" xref="S4.SS5.p1.3.m3.2.2.2.2.2"></and><apply id="S4.SS5.p1.3.m3.2.2.2.2.2b.cmml" xref="S4.SS5.p1.3.m3.2.2.2.2.2"><in id="S4.SS5.p1.3.m3.2.2.2.2.2.3.cmml" xref="S4.SS5.p1.3.m3.2.2.2.2.2.3"></in><apply id="S4.SS5.p1.3.m3.2.2.2.2.2.2.cmml" xref="S4.SS5.p1.3.m3.2.2.2.2.2.2"><ci id="S4.SS5.p1.3.m3.2.2.2.2.2.2.1.cmml" xref="S4.SS5.p1.3.m3.2.2.2.2.2.2.1">→</ci><ci id="S4.SS5.p1.3.m3.2.2.2.2.2.2.2.cmml" xref="S4.SS5.p1.3.m3.2.2.2.2.2.2.2">𝑑</ci></apply><apply id="S4.SS5.p1.3.m3.2.2.2.2.2.4.cmml" xref="S4.SS5.p1.3.m3.2.2.2.2.2.4"><and id="S4.SS5.p1.3.m3.2.2.2.2.2.4.1.cmml" xref="S4.SS5.p1.3.m3.2.2.2.2.2.4.1"></and><ci id="S4.SS5.p1.3.m3.2.2.2.2.2.4.2.cmml" xref="S4.SS5.p1.3.m3.2.2.2.2.2.4.2">𝛿</ci><apply id="S4.SS5.p1.3.m3.2.2.2.2.2.4.3.cmml" xref="S4.SS5.p1.3.m3.2.2.2.2.2.4.3"><ci id="S4.SS5.p1.3.m3.2.2.2.2.2.4.3.1.cmml" xref="S4.SS5.p1.3.m3.2.2.2.2.2.4.3.1">→</ci><ci id="S4.SS5.p1.3.m3.2.2.2.2.2.4.3.2.cmml" xref="S4.SS5.p1.3.m3.2.2.2.2.2.4.3.2">𝑑</ci></apply></apply></apply><apply id="S4.SS5.p1.3.m3.2.2.2.2.2c.cmml" xref="S4.SS5.p1.3.m3.2.2.2.2.2"><apply id="S4.SS5.p1.3.m3.2.2.2.2.2.5.cmml" xref="S4.SS5.p1.3.m3.2.2.2.2.2.5"><csymbol cd="ambiguous" id="S4.SS5.p1.3.m3.2.2.2.2.2.5.1.cmml" xref="S4.SS5.p1.3.m3.2.2.2.2.2.5">subscript</csymbol><lt id="S4.SS5.p1.3.m3.2.2.2.2.2.5.2.cmml" xref="S4.SS5.p1.3.m3.2.2.2.2.2.5.2"></lt><ci id="S4.SS5.p1.3.m3.2.2.2.2.2.5.3a.cmml" xref="S4.SS5.p1.3.m3.2.2.2.2.2.5.3"><mtext id="S4.SS5.p1.3.m3.2.2.2.2.2.5.3.cmml" mathsize="70%" xref="S4.SS5.p1.3.m3.2.2.2.2.2.5.3">LEX</mtext></ci></apply><share href="https://arxiv.org/html/2410.03210v1#S4.SS5.p1.3.m3.2.2.2.2.2.4.cmml" id="S4.SS5.p1.3.m3.2.2.2.2.2d.cmml" xref="S4.SS5.p1.3.m3.2.2.2.2.2"></share><apply id="S4.SS5.p1.3.m3.2.2.2.2.2.6.cmml" xref="S4.SS5.p1.3.m3.2.2.2.2.2.6"><ci id="S4.SS5.p1.3.m3.2.2.2.2.2.6.1.cmml" xref="S4.SS5.p1.3.m3.2.2.2.2.2.6.1">→</ci><cn id="S4.SS5.p1.3.m3.2.2.2.2.2.6.2.cmml" type="integer" xref="S4.SS5.p1.3.m3.2.2.2.2.2.6.2">0</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.3.m3.2c">M_{&lt;}=\{\vec{d}\to\vec{0}:\vec{d}\in\delta\land\vec{d}&lt;_{\text{LEX}}\vec{0}\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p1.3.m3.2d">italic_M start_POSTSUBSCRIPT &lt; end_POSTSUBSCRIPT = { over→ start_ARG italic_d end_ARG → over→ start_ARG 0 end_ARG : over→ start_ARG italic_d end_ARG ∈ italic_δ ∧ over→ start_ARG italic_d end_ARG &lt; start_POSTSUBSCRIPT LEX end_POSTSUBSCRIPT over→ start_ARG 0 end_ARG }</annotation></semantics></math> and <math alttext="M_{&gt;}=\{\vec{d}\to\vec{0}:\vec{d}\in\delta\land\vec{d}&gt;_{\text{LEX}}\vec{0}\}" class="ltx_Math" display="inline" id="S4.SS5.p1.4.m4.2"><semantics id="S4.SS5.p1.4.m4.2a"><mrow id="S4.SS5.p1.4.m4.2.2" xref="S4.SS5.p1.4.m4.2.2.cmml"><msub id="S4.SS5.p1.4.m4.2.2.4" xref="S4.SS5.p1.4.m4.2.2.4.cmml"><mi id="S4.SS5.p1.4.m4.2.2.4.2" xref="S4.SS5.p1.4.m4.2.2.4.2.cmml">M</mi><mo id="S4.SS5.p1.4.m4.2.2.4.3" xref="S4.SS5.p1.4.m4.2.2.4.3.cmml">&gt;</mo></msub><mo id="S4.SS5.p1.4.m4.2.2.3" xref="S4.SS5.p1.4.m4.2.2.3.cmml">=</mo><mrow id="S4.SS5.p1.4.m4.2.2.2.2" xref="S4.SS5.p1.4.m4.2.2.2.3.cmml"><mo id="S4.SS5.p1.4.m4.2.2.2.2.3" stretchy="false" xref="S4.SS5.p1.4.m4.2.2.2.3.1.cmml">{</mo><mrow id="S4.SS5.p1.4.m4.1.1.1.1.1" xref="S4.SS5.p1.4.m4.1.1.1.1.1.cmml"><mover accent="true" id="S4.SS5.p1.4.m4.1.1.1.1.1.2" xref="S4.SS5.p1.4.m4.1.1.1.1.1.2.cmml"><mi id="S4.SS5.p1.4.m4.1.1.1.1.1.2.2" xref="S4.SS5.p1.4.m4.1.1.1.1.1.2.2.cmml">d</mi><mo id="S4.SS5.p1.4.m4.1.1.1.1.1.2.1" stretchy="false" xref="S4.SS5.p1.4.m4.1.1.1.1.1.2.1.cmml">→</mo></mover><mo id="S4.SS5.p1.4.m4.1.1.1.1.1.1" stretchy="false" xref="S4.SS5.p1.4.m4.1.1.1.1.1.1.cmml">→</mo><mover accent="true" id="S4.SS5.p1.4.m4.1.1.1.1.1.3" xref="S4.SS5.p1.4.m4.1.1.1.1.1.3.cmml"><mn id="S4.SS5.p1.4.m4.1.1.1.1.1.3.2" xref="S4.SS5.p1.4.m4.1.1.1.1.1.3.2.cmml">0</mn><mo id="S4.SS5.p1.4.m4.1.1.1.1.1.3.1" stretchy="false" xref="S4.SS5.p1.4.m4.1.1.1.1.1.3.1.cmml">→</mo></mover></mrow><mo id="S4.SS5.p1.4.m4.2.2.2.2.4" lspace="0.278em" rspace="0.278em" xref="S4.SS5.p1.4.m4.2.2.2.3.1.cmml">:</mo><mrow id="S4.SS5.p1.4.m4.2.2.2.2.2" xref="S4.SS5.p1.4.m4.2.2.2.2.2.cmml"><mover accent="true" id="S4.SS5.p1.4.m4.2.2.2.2.2.2" xref="S4.SS5.p1.4.m4.2.2.2.2.2.2.cmml"><mi id="S4.SS5.p1.4.m4.2.2.2.2.2.2.2" xref="S4.SS5.p1.4.m4.2.2.2.2.2.2.2.cmml">d</mi><mo id="S4.SS5.p1.4.m4.2.2.2.2.2.2.1" stretchy="false" xref="S4.SS5.p1.4.m4.2.2.2.2.2.2.1.cmml">→</mo></mover><mo id="S4.SS5.p1.4.m4.2.2.2.2.2.3" xref="S4.SS5.p1.4.m4.2.2.2.2.2.3.cmml">∈</mo><mrow id="S4.SS5.p1.4.m4.2.2.2.2.2.4" xref="S4.SS5.p1.4.m4.2.2.2.2.2.4.cmml"><mi id="S4.SS5.p1.4.m4.2.2.2.2.2.4.2" xref="S4.SS5.p1.4.m4.2.2.2.2.2.4.2.cmml">δ</mi><mo id="S4.SS5.p1.4.m4.2.2.2.2.2.4.1" xref="S4.SS5.p1.4.m4.2.2.2.2.2.4.1.cmml">∧</mo><mover accent="true" id="S4.SS5.p1.4.m4.2.2.2.2.2.4.3" xref="S4.SS5.p1.4.m4.2.2.2.2.2.4.3.cmml"><mi id="S4.SS5.p1.4.m4.2.2.2.2.2.4.3.2" xref="S4.SS5.p1.4.m4.2.2.2.2.2.4.3.2.cmml">d</mi><mo id="S4.SS5.p1.4.m4.2.2.2.2.2.4.3.1" stretchy="false" xref="S4.SS5.p1.4.m4.2.2.2.2.2.4.3.1.cmml">→</mo></mover></mrow><msub id="S4.SS5.p1.4.m4.2.2.2.2.2.5" xref="S4.SS5.p1.4.m4.2.2.2.2.2.5.cmml"><mo id="S4.SS5.p1.4.m4.2.2.2.2.2.5.2" xref="S4.SS5.p1.4.m4.2.2.2.2.2.5.2.cmml">&gt;</mo><mtext id="S4.SS5.p1.4.m4.2.2.2.2.2.5.3" xref="S4.SS5.p1.4.m4.2.2.2.2.2.5.3a.cmml">LEX</mtext></msub><mover accent="true" id="S4.SS5.p1.4.m4.2.2.2.2.2.6" xref="S4.SS5.p1.4.m4.2.2.2.2.2.6.cmml"><mn id="S4.SS5.p1.4.m4.2.2.2.2.2.6.2" xref="S4.SS5.p1.4.m4.2.2.2.2.2.6.2.cmml">0</mn><mo id="S4.SS5.p1.4.m4.2.2.2.2.2.6.1" stretchy="false" xref="S4.SS5.p1.4.m4.2.2.2.2.2.6.1.cmml">→</mo></mover></mrow><mo id="S4.SS5.p1.4.m4.2.2.2.2.5" stretchy="false" xref="S4.SS5.p1.4.m4.2.2.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.4.m4.2b"><apply id="S4.SS5.p1.4.m4.2.2.cmml" xref="S4.SS5.p1.4.m4.2.2"><eq id="S4.SS5.p1.4.m4.2.2.3.cmml" xref="S4.SS5.p1.4.m4.2.2.3"></eq><apply id="S4.SS5.p1.4.m4.2.2.4.cmml" xref="S4.SS5.p1.4.m4.2.2.4"><csymbol cd="ambiguous" id="S4.SS5.p1.4.m4.2.2.4.1.cmml" xref="S4.SS5.p1.4.m4.2.2.4">subscript</csymbol><ci id="S4.SS5.p1.4.m4.2.2.4.2.cmml" xref="S4.SS5.p1.4.m4.2.2.4.2">𝑀</ci><gt id="S4.SS5.p1.4.m4.2.2.4.3.cmml" xref="S4.SS5.p1.4.m4.2.2.4.3"></gt></apply><apply id="S4.SS5.p1.4.m4.2.2.2.3.cmml" xref="S4.SS5.p1.4.m4.2.2.2.2"><csymbol cd="latexml" id="S4.SS5.p1.4.m4.2.2.2.3.1.cmml" xref="S4.SS5.p1.4.m4.2.2.2.2.3">conditional-set</csymbol><apply id="S4.SS5.p1.4.m4.1.1.1.1.1.cmml" xref="S4.SS5.p1.4.m4.1.1.1.1.1"><ci id="S4.SS5.p1.4.m4.1.1.1.1.1.1.cmml" xref="S4.SS5.p1.4.m4.1.1.1.1.1.1">→</ci><apply id="S4.SS5.p1.4.m4.1.1.1.1.1.2.cmml" xref="S4.SS5.p1.4.m4.1.1.1.1.1.2"><ci id="S4.SS5.p1.4.m4.1.1.1.1.1.2.1.cmml" xref="S4.SS5.p1.4.m4.1.1.1.1.1.2.1">→</ci><ci id="S4.SS5.p1.4.m4.1.1.1.1.1.2.2.cmml" xref="S4.SS5.p1.4.m4.1.1.1.1.1.2.2">𝑑</ci></apply><apply id="S4.SS5.p1.4.m4.1.1.1.1.1.3.cmml" xref="S4.SS5.p1.4.m4.1.1.1.1.1.3"><ci id="S4.SS5.p1.4.m4.1.1.1.1.1.3.1.cmml" xref="S4.SS5.p1.4.m4.1.1.1.1.1.3.1">→</ci><cn id="S4.SS5.p1.4.m4.1.1.1.1.1.3.2.cmml" type="integer" xref="S4.SS5.p1.4.m4.1.1.1.1.1.3.2">0</cn></apply></apply><apply id="S4.SS5.p1.4.m4.2.2.2.2.2.cmml" xref="S4.SS5.p1.4.m4.2.2.2.2.2"><and id="S4.SS5.p1.4.m4.2.2.2.2.2a.cmml" xref="S4.SS5.p1.4.m4.2.2.2.2.2"></and><apply id="S4.SS5.p1.4.m4.2.2.2.2.2b.cmml" xref="S4.SS5.p1.4.m4.2.2.2.2.2"><in id="S4.SS5.p1.4.m4.2.2.2.2.2.3.cmml" xref="S4.SS5.p1.4.m4.2.2.2.2.2.3"></in><apply id="S4.SS5.p1.4.m4.2.2.2.2.2.2.cmml" xref="S4.SS5.p1.4.m4.2.2.2.2.2.2"><ci id="S4.SS5.p1.4.m4.2.2.2.2.2.2.1.cmml" xref="S4.SS5.p1.4.m4.2.2.2.2.2.2.1">→</ci><ci id="S4.SS5.p1.4.m4.2.2.2.2.2.2.2.cmml" xref="S4.SS5.p1.4.m4.2.2.2.2.2.2.2">𝑑</ci></apply><apply id="S4.SS5.p1.4.m4.2.2.2.2.2.4.cmml" xref="S4.SS5.p1.4.m4.2.2.2.2.2.4"><and id="S4.SS5.p1.4.m4.2.2.2.2.2.4.1.cmml" xref="S4.SS5.p1.4.m4.2.2.2.2.2.4.1"></and><ci id="S4.SS5.p1.4.m4.2.2.2.2.2.4.2.cmml" xref="S4.SS5.p1.4.m4.2.2.2.2.2.4.2">𝛿</ci><apply id="S4.SS5.p1.4.m4.2.2.2.2.2.4.3.cmml" xref="S4.SS5.p1.4.m4.2.2.2.2.2.4.3"><ci id="S4.SS5.p1.4.m4.2.2.2.2.2.4.3.1.cmml" xref="S4.SS5.p1.4.m4.2.2.2.2.2.4.3.1">→</ci><ci id="S4.SS5.p1.4.m4.2.2.2.2.2.4.3.2.cmml" xref="S4.SS5.p1.4.m4.2.2.2.2.2.4.3.2">𝑑</ci></apply></apply></apply><apply id="S4.SS5.p1.4.m4.2.2.2.2.2c.cmml" xref="S4.SS5.p1.4.m4.2.2.2.2.2"><apply id="S4.SS5.p1.4.m4.2.2.2.2.2.5.cmml" xref="S4.SS5.p1.4.m4.2.2.2.2.2.5"><csymbol cd="ambiguous" id="S4.SS5.p1.4.m4.2.2.2.2.2.5.1.cmml" xref="S4.SS5.p1.4.m4.2.2.2.2.2.5">subscript</csymbol><gt id="S4.SS5.p1.4.m4.2.2.2.2.2.5.2.cmml" xref="S4.SS5.p1.4.m4.2.2.2.2.2.5.2"></gt><ci id="S4.SS5.p1.4.m4.2.2.2.2.2.5.3a.cmml" xref="S4.SS5.p1.4.m4.2.2.2.2.2.5.3"><mtext id="S4.SS5.p1.4.m4.2.2.2.2.2.5.3.cmml" mathsize="70%" xref="S4.SS5.p1.4.m4.2.2.2.2.2.5.3">LEX</mtext></ci></apply><share href="https://arxiv.org/html/2410.03210v1#S4.SS5.p1.4.m4.2.2.2.2.2.4.cmml" id="S4.SS5.p1.4.m4.2.2.2.2.2d.cmml" xref="S4.SS5.p1.4.m4.2.2.2.2.2"></share><apply id="S4.SS5.p1.4.m4.2.2.2.2.2.6.cmml" xref="S4.SS5.p1.4.m4.2.2.2.2.2.6"><ci id="S4.SS5.p1.4.m4.2.2.2.2.2.6.1.cmml" xref="S4.SS5.p1.4.m4.2.2.2.2.2.6.1">→</ci><cn id="S4.SS5.p1.4.m4.2.2.2.2.2.6.2.cmml" type="integer" xref="S4.SS5.p1.4.m4.2.2.2.2.2.6.2">0</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.4.m4.2c">M_{&gt;}=\{\vec{d}\to\vec{0}:\vec{d}\in\delta\land\vec{d}&gt;_{\text{LEX}}\vec{0}\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p1.4.m4.2d">italic_M start_POSTSUBSCRIPT &gt; end_POSTSUBSCRIPT = { over→ start_ARG italic_d end_ARG → over→ start_ARG 0 end_ARG : over→ start_ARG italic_d end_ARG ∈ italic_δ ∧ over→ start_ARG italic_d end_ARG &gt; start_POSTSUBSCRIPT LEX end_POSTSUBSCRIPT over→ start_ARG 0 end_ARG }</annotation></semantics></math> and check if they are both empty in step <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#alg1.l5" title="In Algorithm 1 ‣ 4.5. Legality Checking ‣ 4. Implementation of Tadashi ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">5</span></a>. Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#S4.F4" title="Figure 4 ‣ 4.5. Legality Checking ‣ 4. Implementation of Tadashi ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">4</span></a> shows two examples of the process of checking legality.</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.3.1.1">Algorithm 1</span> </span> 
Legality check (The modifications used for <span class="ltx_text ltx_font_typewriter" id="alg1.4.2">SET_PARALLEL</span> are described in the main text.)
</figcaption>
<div class="ltx_listing ltx_listing" id="alg1.5">
<div class="ltx_listingline" id="alg1.l0">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l0.1.1.1" style="font-size:80%;">0:</span></span>  <math alttext="G" class="ltx_Math" display="inline" id="alg1.l0.m1.1"><semantics id="alg1.l0.m1.1a"><mi id="alg1.l0.m1.1.1" xref="alg1.l0.m1.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m1.1b"><ci id="alg1.l0.m1.1.1.cmml" xref="alg1.l0.m1.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m1.1c">G</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m1.1d">italic_G</annotation></semantics></math>: The dependencies (stored as <code class="ltx_verbatim ltx_font_typewriter" id="alg1.l0.2">isl_union_map</code>) from <code class="ltx_verbatim ltx_font_typewriter" id="alg1.l0.3">scop_info_t</code>
</div>
<div class="ltx_listingline" id="alg1.l0a">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l0a.1.1.1" style="font-size:80%;">0:</span></span>  <math alttext="\theta" class="ltx_Math" display="inline" id="alg1.l0a.m1.1"><semantics id="alg1.l0a.m1.1a"><mi id="alg1.l0a.m1.1.1" xref="alg1.l0a.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="alg1.l0a.m1.1b"><ci id="alg1.l0a.m1.1.1.cmml" xref="alg1.l0a.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0a.m1.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="alg1.l0a.m1.1d">italic_θ</annotation></semantics></math>: The schedule associated with the current node from <code class="ltx_verbatim ltx_font_typewriter" id="alg1.l0a.2">scop_info_t</code>
</div>
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l1.1.1.1" style="font-size:80%;">1:</span></span>  Apply <math alttext="\theta" class="ltx_Math" display="inline" id="alg1.l1.m1.1"><semantics id="alg1.l1.m1.1a"><mi id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m1.1d">italic_θ</annotation></semantics></math> to the domain of the dependencies map 

</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l2.1.1.1" style="font-size:80%;">2:</span></span>  Apply <math alttext="\theta" class="ltx_Math" display="inline" id="alg1.l2.m1.1"><semantics id="alg1.l2.m1.1a"><mi id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><ci id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.1d">italic_θ</annotation></semantics></math> to the range of the dependencies map 

</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l3.1.1.1" style="font-size:80%;">3:</span></span>  Calculate their <math alttext="\delta" class="ltx_Math" display="inline" id="alg1.l3.m1.1"><semantics id="alg1.l3.m1.1a"><mi id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><ci id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">\delta</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m1.1d">italic_δ</annotation></semantics></math> (i.e., the difference of the two previous results)

</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l4.1.1.1" style="font-size:80%;">4:</span></span>  Compute the map <math alttext="M_{\leq}=\{\vec{d}\to\vec{0}:\vec{d}\in\delta\land\vec{d}\leq_{\text{LEX}}\vec%
{0}\}" class="ltx_Math" display="inline" id="alg1.l4.m1.2"><semantics id="alg1.l4.m1.2a"><mrow id="alg1.l4.m1.2.2" xref="alg1.l4.m1.2.2.cmml"><msub id="alg1.l4.m1.2.2.4" xref="alg1.l4.m1.2.2.4.cmml"><mi id="alg1.l4.m1.2.2.4.2" xref="alg1.l4.m1.2.2.4.2.cmml">M</mi><mo id="alg1.l4.m1.2.2.4.3" xref="alg1.l4.m1.2.2.4.3.cmml">≤</mo></msub><mo id="alg1.l4.m1.2.2.3" xref="alg1.l4.m1.2.2.3.cmml">=</mo><mrow id="alg1.l4.m1.2.2.2.2" xref="alg1.l4.m1.2.2.2.3.cmml"><mo id="alg1.l4.m1.2.2.2.2.3" stretchy="false" xref="alg1.l4.m1.2.2.2.3.1.cmml">{</mo><mrow id="alg1.l4.m1.1.1.1.1.1" xref="alg1.l4.m1.1.1.1.1.1.cmml"><mover accent="true" id="alg1.l4.m1.1.1.1.1.1.2" xref="alg1.l4.m1.1.1.1.1.1.2.cmml"><mi id="alg1.l4.m1.1.1.1.1.1.2.2" xref="alg1.l4.m1.1.1.1.1.1.2.2.cmml">d</mi><mo id="alg1.l4.m1.1.1.1.1.1.2.1" stretchy="false" xref="alg1.l4.m1.1.1.1.1.1.2.1.cmml">→</mo></mover><mo id="alg1.l4.m1.1.1.1.1.1.1" stretchy="false" xref="alg1.l4.m1.1.1.1.1.1.1.cmml">→</mo><mover accent="true" id="alg1.l4.m1.1.1.1.1.1.3" xref="alg1.l4.m1.1.1.1.1.1.3.cmml"><mn id="alg1.l4.m1.1.1.1.1.1.3.2" xref="alg1.l4.m1.1.1.1.1.1.3.2.cmml">0</mn><mo id="alg1.l4.m1.1.1.1.1.1.3.1" stretchy="false" xref="alg1.l4.m1.1.1.1.1.1.3.1.cmml">→</mo></mover></mrow><mo id="alg1.l4.m1.2.2.2.2.4" lspace="0.278em" rspace="0.278em" xref="alg1.l4.m1.2.2.2.3.1.cmml">:</mo><mrow id="alg1.l4.m1.2.2.2.2.2" xref="alg1.l4.m1.2.2.2.2.2.cmml"><mover accent="true" id="alg1.l4.m1.2.2.2.2.2.2" xref="alg1.l4.m1.2.2.2.2.2.2.cmml"><mi id="alg1.l4.m1.2.2.2.2.2.2.2" xref="alg1.l4.m1.2.2.2.2.2.2.2.cmml">d</mi><mo id="alg1.l4.m1.2.2.2.2.2.2.1" stretchy="false" xref="alg1.l4.m1.2.2.2.2.2.2.1.cmml">→</mo></mover><mo id="alg1.l4.m1.2.2.2.2.2.3" xref="alg1.l4.m1.2.2.2.2.2.3.cmml">∈</mo><mrow id="alg1.l4.m1.2.2.2.2.2.4" xref="alg1.l4.m1.2.2.2.2.2.4.cmml"><mi id="alg1.l4.m1.2.2.2.2.2.4.2" xref="alg1.l4.m1.2.2.2.2.2.4.2.cmml">δ</mi><mo id="alg1.l4.m1.2.2.2.2.2.4.1" xref="alg1.l4.m1.2.2.2.2.2.4.1.cmml">∧</mo><mover accent="true" id="alg1.l4.m1.2.2.2.2.2.4.3" xref="alg1.l4.m1.2.2.2.2.2.4.3.cmml"><mi id="alg1.l4.m1.2.2.2.2.2.4.3.2" xref="alg1.l4.m1.2.2.2.2.2.4.3.2.cmml">d</mi><mo id="alg1.l4.m1.2.2.2.2.2.4.3.1" stretchy="false" xref="alg1.l4.m1.2.2.2.2.2.4.3.1.cmml">→</mo></mover></mrow><msub id="alg1.l4.m1.2.2.2.2.2.5" xref="alg1.l4.m1.2.2.2.2.2.5.cmml"><mo id="alg1.l4.m1.2.2.2.2.2.5.2" xref="alg1.l4.m1.2.2.2.2.2.5.2.cmml">≤</mo><mtext id="alg1.l4.m1.2.2.2.2.2.5.3" xref="alg1.l4.m1.2.2.2.2.2.5.3a.cmml">LEX</mtext></msub><mover accent="true" id="alg1.l4.m1.2.2.2.2.2.6" xref="alg1.l4.m1.2.2.2.2.2.6.cmml"><mn id="alg1.l4.m1.2.2.2.2.2.6.2" xref="alg1.l4.m1.2.2.2.2.2.6.2.cmml">0</mn><mo id="alg1.l4.m1.2.2.2.2.2.6.1" stretchy="false" xref="alg1.l4.m1.2.2.2.2.2.6.1.cmml">→</mo></mover></mrow><mo id="alg1.l4.m1.2.2.2.2.5" stretchy="false" xref="alg1.l4.m1.2.2.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.2b"><apply id="alg1.l4.m1.2.2.cmml" xref="alg1.l4.m1.2.2"><eq id="alg1.l4.m1.2.2.3.cmml" xref="alg1.l4.m1.2.2.3"></eq><apply id="alg1.l4.m1.2.2.4.cmml" xref="alg1.l4.m1.2.2.4"><csymbol cd="ambiguous" id="alg1.l4.m1.2.2.4.1.cmml" xref="alg1.l4.m1.2.2.4">subscript</csymbol><ci id="alg1.l4.m1.2.2.4.2.cmml" xref="alg1.l4.m1.2.2.4.2">𝑀</ci><leq id="alg1.l4.m1.2.2.4.3.cmml" xref="alg1.l4.m1.2.2.4.3"></leq></apply><apply id="alg1.l4.m1.2.2.2.3.cmml" xref="alg1.l4.m1.2.2.2.2"><csymbol cd="latexml" id="alg1.l4.m1.2.2.2.3.1.cmml" xref="alg1.l4.m1.2.2.2.2.3">conditional-set</csymbol><apply id="alg1.l4.m1.1.1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1.1.1"><ci id="alg1.l4.m1.1.1.1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1.1.1.1">→</ci><apply id="alg1.l4.m1.1.1.1.1.1.2.cmml" xref="alg1.l4.m1.1.1.1.1.1.2"><ci id="alg1.l4.m1.1.1.1.1.1.2.1.cmml" xref="alg1.l4.m1.1.1.1.1.1.2.1">→</ci><ci id="alg1.l4.m1.1.1.1.1.1.2.2.cmml" xref="alg1.l4.m1.1.1.1.1.1.2.2">𝑑</ci></apply><apply id="alg1.l4.m1.1.1.1.1.1.3.cmml" xref="alg1.l4.m1.1.1.1.1.1.3"><ci id="alg1.l4.m1.1.1.1.1.1.3.1.cmml" xref="alg1.l4.m1.1.1.1.1.1.3.1">→</ci><cn id="alg1.l4.m1.1.1.1.1.1.3.2.cmml" type="integer" xref="alg1.l4.m1.1.1.1.1.1.3.2">0</cn></apply></apply><apply id="alg1.l4.m1.2.2.2.2.2.cmml" xref="alg1.l4.m1.2.2.2.2.2"><and id="alg1.l4.m1.2.2.2.2.2a.cmml" xref="alg1.l4.m1.2.2.2.2.2"></and><apply id="alg1.l4.m1.2.2.2.2.2b.cmml" xref="alg1.l4.m1.2.2.2.2.2"><in id="alg1.l4.m1.2.2.2.2.2.3.cmml" xref="alg1.l4.m1.2.2.2.2.2.3"></in><apply id="alg1.l4.m1.2.2.2.2.2.2.cmml" xref="alg1.l4.m1.2.2.2.2.2.2"><ci id="alg1.l4.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l4.m1.2.2.2.2.2.2.1">→</ci><ci id="alg1.l4.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l4.m1.2.2.2.2.2.2.2">𝑑</ci></apply><apply id="alg1.l4.m1.2.2.2.2.2.4.cmml" xref="alg1.l4.m1.2.2.2.2.2.4"><and id="alg1.l4.m1.2.2.2.2.2.4.1.cmml" xref="alg1.l4.m1.2.2.2.2.2.4.1"></and><ci id="alg1.l4.m1.2.2.2.2.2.4.2.cmml" xref="alg1.l4.m1.2.2.2.2.2.4.2">𝛿</ci><apply id="alg1.l4.m1.2.2.2.2.2.4.3.cmml" xref="alg1.l4.m1.2.2.2.2.2.4.3"><ci id="alg1.l4.m1.2.2.2.2.2.4.3.1.cmml" xref="alg1.l4.m1.2.2.2.2.2.4.3.1">→</ci><ci id="alg1.l4.m1.2.2.2.2.2.4.3.2.cmml" xref="alg1.l4.m1.2.2.2.2.2.4.3.2">𝑑</ci></apply></apply></apply><apply id="alg1.l4.m1.2.2.2.2.2c.cmml" xref="alg1.l4.m1.2.2.2.2.2"><apply id="alg1.l4.m1.2.2.2.2.2.5.cmml" xref="alg1.l4.m1.2.2.2.2.2.5"><csymbol cd="ambiguous" id="alg1.l4.m1.2.2.2.2.2.5.1.cmml" xref="alg1.l4.m1.2.2.2.2.2.5">subscript</csymbol><leq id="alg1.l4.m1.2.2.2.2.2.5.2.cmml" xref="alg1.l4.m1.2.2.2.2.2.5.2"></leq><ci id="alg1.l4.m1.2.2.2.2.2.5.3a.cmml" xref="alg1.l4.m1.2.2.2.2.2.5.3"><mtext id="alg1.l4.m1.2.2.2.2.2.5.3.cmml" mathsize="70%" xref="alg1.l4.m1.2.2.2.2.2.5.3">LEX</mtext></ci></apply><share href="https://arxiv.org/html/2410.03210v1#alg1.l4.m1.2.2.2.2.2.4.cmml" id="alg1.l4.m1.2.2.2.2.2d.cmml" xref="alg1.l4.m1.2.2.2.2.2"></share><apply id="alg1.l4.m1.2.2.2.2.2.6.cmml" xref="alg1.l4.m1.2.2.2.2.2.6"><ci id="alg1.l4.m1.2.2.2.2.2.6.1.cmml" xref="alg1.l4.m1.2.2.2.2.2.6.1">→</ci><cn id="alg1.l4.m1.2.2.2.2.2.6.2.cmml" type="integer" xref="alg1.l4.m1.2.2.2.2.2.6.2">0</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.2c">M_{\leq}=\{\vec{d}\to\vec{0}:\vec{d}\in\delta\land\vec{d}\leq_{\text{LEX}}\vec%
{0}\}</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m1.2d">italic_M start_POSTSUBSCRIPT ≤ end_POSTSUBSCRIPT = { over→ start_ARG italic_d end_ARG → over→ start_ARG 0 end_ARG : over→ start_ARG italic_d end_ARG ∈ italic_δ ∧ over→ start_ARG italic_d end_ARG ≤ start_POSTSUBSCRIPT LEX end_POSTSUBSCRIPT over→ start_ARG 0 end_ARG }</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l5">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l5.1.1.1" style="font-size:80%;">5:</span></span>  <span class="ltx_text ltx_font_bold" id="alg1.l5.2">if</span> <math alttext="M_{\leq}" class="ltx_Math" display="inline" id="alg1.l5.m1.1"><semantics id="alg1.l5.m1.1a"><msub id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><mi id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml">M</mi><mo id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml">≤</mo></msub><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1">subscript</csymbol><ci id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2">𝑀</ci><leq id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3"></leq></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">M_{\leq}</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.1d">italic_M start_POSTSUBSCRIPT ≤ end_POSTSUBSCRIPT</annotation></semantics></math> is empty <span class="ltx_text ltx_font_bold" id="alg1.l5.3">then</span>
</div>
<div class="ltx_listingline" id="alg1.l6">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l6.1.1.1" style="font-size:80%;">6:</span></span>     the schedule is <em class="ltx_emph ltx_font_italic" id="alg1.l6.2">legal</em>
</div>
<div class="ltx_listingline" id="alg1.l7">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l7.1.1.1" style="font-size:80%;">7:</span></span>  <span class="ltx_text ltx_font_bold" id="alg1.l7.2">else</span>
</div>
<div class="ltx_listingline" id="alg1.l8">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l8.1.1.1" style="font-size:80%;">8:</span></span>     the schedule is <em class="ltx_emph ltx_font_italic" id="alg1.l8.2">not legal</em>
</div>
<div class="ltx_listingline" id="alg1.l9">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l9.1.1.1" style="font-size:80%;">9:</span></span>  <span class="ltx_text ltx_font_bold" id="alg1.l9.2">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l9.3">if</span>
</div>
</div>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.6. </span>Code Generation</h3>
<div class="ltx_para" id="S4.SS6.p1">
<p class="ltx_p" id="S4.SS6.p1.1">Code generation is based on the <code class="ltx_verbatim ltx_font_typewriter" id="S4.SS6.p1.1.1">pet_loopback.c</code> file from the PET repository, which extracts the polyhedral representation from an input C file, and generates the “same” code using the original schedule.
Apart from the obvious tweaking to use the modified schedule instead of the original one, and to make it cooperate with the bookkeeping setup we use in <span class="ltx_text ltx_font_smallcaps" id="S4.SS6.p1.1.2">Tadashi</span>’s back-end, the <code class="ltx_verbatim ltx_font_typewriter" id="S4.SS6.p1.1.3">SET_PARALLEL</code> transformation required additional modifications to the core code generation. Parallel loops are implemented as OpenMP parallel for loops, so the relevant pragma needs to be inserted. This is achieved by properly setting up the <code class="ltx_verbatim ltx_font_typewriter" id="S4.SS6.p1.1.4">isl_ast_build</code> and <code class="ltx_verbatim ltx_font_typewriter" id="S4.SS6.p1.1.5">isl_ast_print_options</code> objects, i.e., specifying custom <code class="ltx_verbatim ltx_font_typewriter" id="S4.SS6.p1.1.6">after_each_mark</code> and <code class="ltx_verbatim ltx_font_typewriter" id="S4.SS6.p1.1.7">print_for</code> callbacks for the AST build and print options object respectively.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Evaluation</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">We evaluate <span class="ltx_text ltx_font_smallcaps" id="S5.p1.1.1">Tadashi</span> using Random-RL, a mock ML model, verify the implementation and measure performace. All the measurements are done on a regular desktop with a 12 core AMD Ryzen 5 5600X 6-Core Processor and 64GiB of memory, running Arch Linux, with python 3.12.5-1, libisl 0.27-1, llvm 18.1.8-4 system packages, and <span class="ltx_text ltx_font_smallcaps" id="S5.p1.1.2">Tadashi</span>’s CMake script using the current master branch<span class="ltx_note ltx_role_footnote" id="footnote13"><sup class="ltx_note_mark">13</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">13</sup><span class="ltx_tag ltx_tag_note">13</span>Git hash <code class="ltx_verbatim" id="footnote13.1"></code>824ab35b60bab089fb699e521e2e3bc6c07ce95a!.</span></span></span> of PET<span class="ltx_note ltx_role_footnote" id="footnote14"><sup class="ltx_note_mark">14</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">14</sup><span class="ltx_tag ltx_tag_note">14</span>From <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://repo.or.cz/pet.git" title="">https://repo.or.cz/pet.git</a>.</span></span></span> tagged as pet 0.11.8.</p>
</div>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1. </span>Random-RL</h3>
<div class="ltx_para" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.1">To demonstrate the ease of use and performance of <span class="ltx_text ltx_font_smallcaps" id="S5.SS1.p1.1.1">Tadashi</span>, we show an example case of how <span class="ltx_text ltx_font_smallcaps" id="S5.SS1.p1.1.2">Tadashi</span> can be used in ML in an end-to-end fashion. We implement a mock RL script, <span class="ltx_text ltx_font_italic" id="S5.SS1.p1.1.3">Random-RL</span>, described in Listings <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#LST3" title="Listing 3 ‣ 5.1. Random-RL ‣ 5. Evaluation ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">3</span></a>, with the agent randomly picking actions, which we evaluate on the Polybench <cite class="ltx_cite ltx_citemacro_citep">(Reisinger, <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#bib.bib35" title="">2024</a>)</cite> benchmark suit. Choosing a random action, consists of selecting a node in the schedule tree, a transformation, and parameters for that transformation. Technically, a random SCoP should also be chosen, but for simplicity, we assume that there is only one SCoP, which is conveniently true for the Polybench apps. The Random-RL agent keeps track of the last chosen node in the schedule tree, and the new node is selected by choosing randomly from its parent or one of it’s children (initially starting from the root). This is followed by a random sampling of all implemented transformations. The transformation might not be available for the selected node, so this process of picking random transformations and schedule nodes is repeated until a valid transformation-node pair is found. Finally, a valid set of transformation arguments is randomly picked, as described in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#S3.SS1.SSS1" title="3.1.1. Sampling Strategies ‣ 3.1. Python Front-End: Polyhedral Made Easy ‣ 3. Tadashi: A Library to Sample Legal Polyhedral Transformations ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">3.1.1</span></a>.</p>
</div>
<figure class="ltx_float ltx_lstlisting" id="LST3">
<div class="ltx_listing ltx_lst_language_Python ltx_lst_numbers_left ltx_lstlisting ltx_framed ltx_framed_topbottom ltx_listing" id="LST3.1">
<div class="ltx_listing_data"><a download="" href="data:text/plain;base64,ZGVmIHRyYWluX21vZGVsKGFwcCwgbnVtX2l0ZXI9MywgbmV0PU1vZGVsKCkpOgogIGxvb3BfbmVzdHMgPSBMb29wTmVzdHMoYXBwKQogIGxuID0gbG9vcF9uZXN0c1swXQogIGZvciBpIGluIHJhbmdlKG51bV9pdGVyKToKICAgIGxvb3BfaWR4LCB0ciwgYXJncyA9IG5ldC50cmFuc2Zvcm0obG4pIC8qQFxsYWJlbHtsbjpybmR0cmFufUAqLwogICAgbG9vcCA9IGxuLnNjaGVkdWxlX3RyZWVbbG9vcF9pZHhdCiAgICBsZWdhbCA9IGxvb3AudHJhbnNmb3JtKHRyLCAqYXJncykKICAgIGlmIG5vdCBsZWdhbDoKICAgICAgbm9kZS5yb2xsYmFjaygpCiAgICAgIGNvbnRpbnVlCiAgICBsb29wX25lc3RzLmdlbmVyYXRlX2NvZGUoIm91dHB1dC5jIikKICAgIGFwcC5jb21waWxlKCkKICAgIHQgPSBhcHAubWVhc3VyZSgpCiAgICAjIG5ldC51cGRhdGUobG9vcF9pZHgsIHRyLCBhcmdzLCBsZWdhbCwgdCkgLypAXGxhYmVse2xuOnVwZGF0ZX1AKi8=">⬇</a></div>
<div class="ltx_listingline" id="lstnumberx11">
<span class="ltx_tag ltx_tag_listingline">1</span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter ltx_font_bold" id="lstnumberx11.1" style="font-size:90%;">def</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx11.2" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx11.3" style="font-size:90%;">train_model</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx11.4" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx11.5" style="font-size:90%;">app</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx11.6" style="font-size:90%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx11.7" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx11.8" style="font-size:90%;">num_iter</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx11.9" style="font-size:90%;">=3,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx11.10" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx11.11" style="font-size:90%;">net</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx11.12" style="font-size:90%;">=</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx11.13" style="font-size:90%;">Model</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx11.14" style="font-size:90%;">()):</span>
</div>
<div class="ltx_listingline" id="lstnumberx12">
<span class="ltx_tag ltx_tag_listingline">2</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx12.1" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx12.2" style="font-size:90%;">loop_nests</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx12.3" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx12.4" style="font-size:90%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx12.5" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx12.6" style="font-size:90%;">LoopNests</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx12.7" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx12.8" style="font-size:90%;">app</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx12.9" style="font-size:90%;">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx13">
<span class="ltx_tag ltx_tag_listingline">3</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx13.1" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx13.2" style="font-size:90%;">ln</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx13.3" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx13.4" style="font-size:90%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx13.5" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx13.6" style="font-size:90%;">loop_nests</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx13.7" style="font-size:90%;">[0]</span>
</div>
<div class="ltx_listingline" id="lstnumberx14">
<span class="ltx_tag ltx_tag_listingline">4</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx14.1" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter ltx_font_bold" id="lstnumberx14.2" style="font-size:90%;">for</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx14.3" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx14.4" style="font-size:90%;">i</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx14.5" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter ltx_font_bold" id="lstnumberx14.6" style="font-size:90%;">in</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx14.7" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keyword ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" id="lstnumberx14.8" style="font-size:90%;">range</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx14.9" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx14.10" style="font-size:90%;">num_iter</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx14.11" style="font-size:90%;">):</span>
</div>
<div class="ltx_listingline" id="lstnumberx15">
<span class="ltx_tag ltx_tag_listingline">5</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.1" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.2" style="font-size:90%;">loop_idx</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx15.3" style="font-size:90%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.4" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.5" style="font-size:90%;">tr</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx15.6" style="font-size:90%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.7" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.8" style="font-size:90%;">args</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.9" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx15.10" style="font-size:90%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.11" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.12" style="font-size:90%;">net</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx15.13" style="font-size:90%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.14" style="font-size:90%;">transform</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx15.15" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.16" style="font-size:90%;">ln</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx15.17" style="font-size:90%;">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.18" style="font-size:90%;"> </span><span class="ltx_text" id="lstnumberx15.19"></span>
</div>
<div class="ltx_listingline" id="lstnumberx16">
<span class="ltx_tag ltx_tag_listingline">6</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx16.1" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx16.2" style="font-size:90%;">loop</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx16.3" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx16.4" style="font-size:90%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx16.5" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx16.6" style="font-size:90%;">ln</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx16.7" style="font-size:90%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx16.8" style="font-size:90%;">schedule_tree</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx16.9" style="font-size:90%;">[</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx16.10" style="font-size:90%;">loop_idx</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx16.11" style="font-size:90%;">]</span>
</div>
<div class="ltx_listingline" id="lstnumberx17">
<span class="ltx_tag ltx_tag_listingline">7</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.1" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.2" style="font-size:90%;">legal</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.3" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx17.4" style="font-size:90%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.5" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.6" style="font-size:90%;">loop</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx17.7" style="font-size:90%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.8" style="font-size:90%;">transform</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx17.9" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.10" style="font-size:90%;">tr</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx17.11" style="font-size:90%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.12" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx17.13" style="font-size:90%;">*</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.14" style="font-size:90%;">args</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx17.15" style="font-size:90%;">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx18">
<span class="ltx_tag ltx_tag_listingline">8</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx18.1" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter ltx_font_bold" id="lstnumberx18.2" style="font-size:90%;">if</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx18.3" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter ltx_font_bold" id="lstnumberx18.4" style="font-size:90%;">not</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx18.5" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx18.6" style="font-size:90%;">legal</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx18.7" style="font-size:90%;">:</span>
</div>
<div class="ltx_listingline" id="lstnumberx19">
<span class="ltx_tag ltx_tag_listingline">9</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx19.1" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx19.2" style="font-size:90%;">node</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx19.3" style="font-size:90%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx19.4" style="font-size:90%;">rollback</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx19.5" style="font-size:90%;">()</span>
</div>
<div class="ltx_listingline" id="lstnumberx20">
<span class="ltx_tag ltx_tag_listingline">10</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx20.1" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keyword ltx_font_typewriter ltx_font_bold" id="lstnumberx20.2" style="font-size:90%;">continue</span>
</div>
<div class="ltx_listingline" id="lstnumberx21">
<span class="ltx_tag ltx_tag_listingline">11</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx21.1" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx21.2" style="font-size:90%;">loop_nests</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx21.3" style="font-size:90%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx21.4" style="font-size:90%;">generate_code</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx21.5" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_string ltx_font_typewriter" id="lstnumberx21.6" style="font-size:90%;">"output.c"</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx21.7" style="font-size:90%;">)</span>
</div>
<div class="ltx_listingline" id="lstnumberx22">
<span class="ltx_tag ltx_tag_listingline">12</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx22.1" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx22.2" style="font-size:90%;">app</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx22.3" style="font-size:90%;">.</span><span class="ltx_text ltx_lst_keyword ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" id="lstnumberx22.4" style="font-size:90%;">compile</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx22.5" style="font-size:90%;">()</span>
</div>
<div class="ltx_listingline" id="lstnumberx23">
<span class="ltx_tag ltx_tag_listingline">13</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx23.1" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx23.2" style="font-size:90%;">t</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx23.3" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" id="lstnumberx23.4" style="font-size:90%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx23.5" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx23.6" style="font-size:90%;">app</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx23.7" style="font-size:90%;">.</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx23.8" style="font-size:90%;">measure</span><span class="ltx_text ltx_font_typewriter" id="lstnumberx23.9" style="font-size:90%;">()</span>
</div>
<div class="ltx_listingline" id="lstnumberx24">
<span class="ltx_tag ltx_tag_listingline">14</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx24.1" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_comment ltx_font_typewriter ltx_font_italic" id="lstnumberx24.2" style="font-size:90%;">#<span class="ltx_text ltx_lst_space" id="lstnumberx24.2.1"> </span>net.update(loop_idx,<span class="ltx_text ltx_lst_space" id="lstnumberx24.2.2"> </span>tr,<span class="ltx_text ltx_lst_space" id="lstnumberx24.2.3"> </span>args,<span class="ltx_text ltx_lst_space" id="lstnumberx24.2.4"> </span>legal,<span class="ltx_text ltx_lst_space" id="lstnumberx24.2.5"> </span>t)<span class="ltx_text ltx_lst_space" id="lstnumberx24.2.6"> </span><span class="ltx_text" id="lstnumberx24.2.7"></span></span>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float">Listing 3: </span>
A stripped-down version of the Random-RL Python script. The random agent (<span class="ltx_text ltx_font_typewriter" id="LST3.3.1">net</span> object) selects a random transformation (including the loop/node index, and transformation arguments) in line <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#lstnumberx15" title="line 5 ‣ Listing 3 ‣ 5.1. Random-RL ‣ 5. Evaluation ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">5</span></a>. If the script were not a mock, the commented out line <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#lstnumberx24" title="line 14 ‣ Listing 3 ‣ 5.1. Random-RL ‣ 5. Evaluation ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">14</span></a> would be where the weights of the model are updated.
</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2. </span>Verification</h3>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1">With the Random-RL agent successfully sampling the transformations, we verify the correct implementation of <span class="ltx_text ltx_font_smallcaps" id="S5.SS2.p1.1.1">Tadashi</span>. First, all Polybench benchmarks are compiled and executed with the small dataset<span class="ltx_note ltx_role_footnote" id="footnote15"><sup class="ltx_note_mark">15</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">15</sup><span class="ltx_tag ltx_tag_note">15</span>Using <code class="ltx_verbatim" id="footnote15.1"></code>-DSMALL_DATASET!.</span></span></span> and with the output saved.<span class="ltx_note ltx_role_footnote" id="footnote16"><sup class="ltx_note_mark">16</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">16</sup><span class="ltx_tag ltx_tag_note">16</span>Using <code class="ltx_verbatim" id="footnote16.1"></code>-DPOLYBENCH_DUMP_ARRAYS!.</span></span></span> In an entirely automated manner, we generate 3 random transformations using the Random-RL’s agent (as described above), rollback the illegal ones, compile, run, and compare the output of the transformed program to the original. Post-inspect confirmed the outputs to be identical.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3. </span>Performance</h3>
<figure class="ltx_figure" id="S5.F5">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="622" id="S5.F5.g1" src="x8.png" width="830"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="622" id="S5.F5.g2" src="x9.png" width="830"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F5.3.1.1" style="font-size:90%;">Figure 5</span>. </span><span class="ltx_text" id="S5.F5.4.2" style="font-size:90%;">
Breakdown of execution times of <span class="ltx_text ltx_font_smallcaps" id="S5.F5.4.2.1">Tadashi</span>’s functions which includes extracting the for a single transformation and 10-long sequence of transformations (Polybench).
</span></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="S5.F5.5">\Description</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S5.F5.6">Breakdown of the results</p>
</div>
</div>
</figure>
<figure class="ltx_figure" id="S5.F6">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="622" id="S5.F6.g1" src="x10.png" width="830"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F6.2.1.1" style="font-size:90%;">Figure 6</span>. </span><span class="ltx_text" id="S5.F6.3.2" style="font-size:90%;">
Throughput of transformations (and legality checks) for all Polybench apps. Each iteration consists of a SCoP transformation and a legality check.
</span></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="S5.F6.4">\Description</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S5.F6.5">Throughput</p>
</div>
</div>
</figure>
<div class="ltx_para" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.1">ML training algorithms need a vast number of code transformations, including the legality check and code generation, it would be informative to see how fast <span class="ltx_text ltx_font_smallcaps" id="S5.SS3.p1.1.1">Tadashi</span> performs these functions. With this in mind, we devise two experiments to measure a typical training cycle: one which involves a single polyhedral transformation and another with a sequence of 10 transformations (and legality checks), with a code generation at the end. A typical training cycle would cover functions performed by <span class="ltx_text ltx_font_smallcaps" id="S5.SS3.p1.1.2">Tadashi</span>, such as, extracting the polyhedral representation of the SCoPs, performing the transformation, checking the legality, generating code, as well as, compiling and running the program; steps with execution times which neither the user nor <span class="ltx_text ltx_font_smallcaps" id="S5.SS3.p1.1.3">Tadashi</span> can influence or circumvent. For both experiments, we use Polybench with the default dataset size, based on the reasoning that a smaller dataset would fit into cache memory and shrink the runtime to an extent where optimization would not be required.</p>
</div>
<div class="ltx_para" id="S5.SS3.p2">
<p class="ltx_p" id="S5.SS3.p2.1">The breakdown of the results can be found in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#S5.F5" title="Figure 5 ‣ 5.3. Performance ‣ 5. Evaluation ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">5</span></a>. The dominance of the runtime of the programs is obvious in more then half of the apps. As for the other benchmarks, with miniscule runtimes, we found that the functions performed by <span class="ltx_text ltx_font_smallcaps" id="S5.SS3.p2.1.1">Tadashi</span> always occupied less then half of the breakdown. Based on these numbers, using <span class="ltx_text ltx_font_smallcaps" id="S5.SS3.p2.1.2">Tadashi</span> should not be considerably more prohibitive than any other workflow which involves compiling and/or running the program.</p>
</div>
<div class="ltx_para" id="S5.SS3.p3">
<p class="ltx_p" id="S5.SS3.p3.1">To provide a better insight into <span class="ltx_text ltx_font_smallcaps" id="S5.SS3.p3.1.1">Tadashi</span>’s performance, we also calculate throughput from the breakdown data, which is shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#S5.F6" title="Figure 6 ‣ 5.3. Performance ‣ 5. Evaluation ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">6</span></a>. Only the number of transformations and legality checks are counted, since it can happen more often than SCoP extraction and code generation, and the latter two would also be accompanied by compilation and program execution, which, as we saw in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03210v1#S5.F5" title="Figure 5 ‣ 5.3. Performance ‣ 5. Evaluation ‣ Tadashi: Enabling AI-Based Automated Code Generation With Guaranteed Correctness"><span class="ltx_text ltx_ref_tag">5</span></a>, would dominate the runtime. The results show <span class="ltx_text ltx_font_smallcaps" id="S5.SS3.p3.1.2">Tadashi</span> capability of sustaining 100s of iterations per second, which would be very practical for production ML solutions where 100,000s <math alttext="\sim" class="ltx_Math" display="inline" id="S5.SS3.p3.1.m1.1"><semantics id="S5.SS3.p3.1.m1.1a"><mo id="S5.SS3.p3.1.m1.1.1" xref="S5.SS3.p3.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.1.m1.1b"><csymbol cd="latexml" id="S5.SS3.p3.1.m1.1.1.cmml" xref="S5.SS3.p3.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.1.m1.1c">\sim</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p3.1.m1.1d">∼</annotation></semantics></math> 100,000,000s of training examples or direct evaluations in RL would be the norm.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6. </span>Conclusion</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">In this work we aim to lower the barrier for using ML in code auto generation, with guarantees on correctness. We rely on the polyhedral methods to generate code based on compositional loop transformations with mathematically proven guarantee of functional correctness.
To this end we introduce <span class="ltx_text ltx_font_smallcaps" id="S6.p1.1.1">Tadashi</span>, a library which exposes an API simplified to the polyhedral methods, targeting the ML engineers and researchers not familiar with it. By using <span class="ltx_text ltx_font_smallcaps" id="S6.p1.1.2">Tadashi</span>, ML practitioners can design ML-driven methods based on the capability of <span class="ltx_text ltx_font_smallcaps" id="S6.p1.1.3">Tadashi</span> in sampling of the space of legal loop transformations.</p>
</div>
<div class="ltx_acknowledgements">
<h6 class="ltx_title ltx_title_acknowledgements">Acknowledgements.</h6>
We are eternally grateful to Sven (skimo) Verdoolaege for his invaluable help by replying to our (often silly) questions on the ISL mailing list.

</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Aho et al<span class="ltx_text" id="bib.bib2.2.2.1">.</span> (2007)</span>
<span class="ltx_bibblock">
Alfred V. Aho, Monica S.
Lam, Ravi Sethi, and Jeffrey D.
Ullman. 2007.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib2.3.1">Compilers: Principles, Techniques, &amp;
Tools</em> (second edition ed.).

</span>
<span class="ltx_bibblock">Pearson/Addison Wesley,
Boston.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="http://catdir.loc.gov/catdir/toc/ecip0618/2006024333.html" title="">http://catdir.loc.gov/catdir/toc/ecip0618/2006024333.html</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Allamanis et al<span class="ltx_text" id="bib.bib3.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Miltiadis Allamanis,
Sheena Panthaplackel, and Pengcheng
Yin. 2024.

</span>
<span class="ltx_bibblock">Unsupervised Evaluation of Code LLMs with
Round-Trip Correctness. In <em class="ltx_emph ltx_font_italic" id="bib.bib3.3.1">ICML</em>.
OpenReview.net.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ashouri et al<span class="ltx_text" id="bib.bib4.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Amir H. Ashouri, William
Killian, John Cavazos, Gianluca Palermo,
and Cristina Silvano. 2018.

</span>
<span class="ltx_bibblock">A Survey on Compiler Autotuning using Machine
Learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.3.1">ACM Comput. Surv.</em> 51,
5, Article 96 (sep
2018), 42 pages.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3197978" title="">https://doi.org/10.1145/3197978</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Baghdadi et al<span class="ltx_text" id="bib.bib5.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Riyadh Baghdadi,
Massinissa Merouani, Mohamed-Hicham
Leghettas, Kamel Abdous, Taha Arbaoui,
Karima Benatchba, and Saman P.
Amarasinghe. 2021.

</span>
<span class="ltx_bibblock">A Deep Learning Based Cost Model for
Automatic Code Optimization. In <em class="ltx_emph ltx_font_italic" id="bib.bib5.3.1">Proceedings of
the Fourth Conference on Machine Learning and Systems, MLSys
2021, Virtual, April 5-9, 2021</em>, Alex
Smola, Alex Dimakis, and Ion Stoica
(Eds.). mlsys.org.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://proceedings.mlsys.org/paper_files/paper/2021/hash/d9387b6d643efb25132be36f7b908d96-Abstract.html" title="">https://proceedings.mlsys.org/paper_files/paper/2021/hash/d9387b6d643efb25132be36f7b908d96-Abstract.html</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Beer et al<span class="ltx_text" id="bib.bib6.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Robin Beer, Alexander
Feix, Tim Guttzeit, Tamara Muras,
Vincent Müller, Maurice Rauscher,
Florian Schäffler, and Welf Löwe.
2024.

</span>
<span class="ltx_bibblock">Examination of Code generated by Large Language
Models.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2408.16601 [cs.SE]

<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2408.16601" title="">https://arxiv.org/abs/2408.16601</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ben-Nun et al<span class="ltx_text" id="bib.bib7.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Tal Ben-Nun,
Alice Shoshana Jakobovits, and Torsten
Hoefler. 2018.

</span>
<span class="ltx_bibblock">Neural Code Comprehension: A Learnable
Representation of Code Semantics. In <em class="ltx_emph ltx_font_italic" id="bib.bib7.3.1">Proceedings
of the 32nd International Conference on Neural Information Processing
Systems</em> <em class="ltx_emph ltx_font_italic" id="bib.bib7.4.2">(NIPS’18)</em>.
Curran Associates Inc., Red Hook, NY,
USA, 3589–3601.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bondhugula et al<span class="ltx_text" id="bib.bib8.2.2.1">.</span> (2008)</span>
<span class="ltx_bibblock">
Uday Bondhugula, Albert
Hartono, J Ramanujam, and P
Sadayappan. 2008.

</span>
<span class="ltx_bibblock">A Practical Automatic Polyhedral Parallelizer
and Locality Optimizer.

</span>
<span class="ltx_bibblock">(2008), 13.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cai et al<span class="ltx_text" id="bib.bib9.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Zonghui Cai, Xiao Yang,
MengChu Zhou, Zhi-Hui Zhan, and
Shangce Gao. 2023.

</span>
<span class="ltx_bibblock">Toward explicit control between exploration and
exploitation in evolutionary algorithms: A case study of differential
evolution.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.3.1">Information Sciences</em> 649
(2023), 119656.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1016/j.ins.2023.119656" title="">https://doi.org/10.1016/j.ins.2023.119656</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span class="ltx_text" id="bib.bib10.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Mark Chen, Jerry Tworek,
Heewoo Jun, Qiming Yuan,
Henrique Ponde de Oliveira Pinto, Jared
Kaplan, Harri Edwards, Yuri Burda,
Nicholas Joseph, Greg Brockman,
Alex Ray, Raul Puri,
Gretchen Krueger, Michael Petrov,
Heidy Khlaaf, Girish Sastry,
Pamela Mishkin, Brooke Chan,
Scott Gray, Nick Ryder,
Mikhail Pavlov, Alethea Power,
Lukasz Kaiser, Mohammad Bavarian,
Clemens Winter, Philippe Tillet,
Felipe Petroski Such, Dave Cummings,
Matthias Plappert, Fotios Chantzis,
Elizabeth Barnes, Ariel Herbert-Voss,
William Hebgen Guss, Alex Nichol,
Alex Paino, Nikolas Tezak,
Jie Tang, Igor Babuschkin,
Suchir Balaji, Shantanu Jain,
William Saunders, Christopher Hesse,
Andrew N. Carr, Jan Leike,
Josh Achiam, Vedant Misra,
Evan Morikawa, Alec Radford,
Matthew Knight, Miles Brundage,
Mira Murati, Katie Mayer,
Peter Welinder, Bob McGrew,
Dario Amodei, Sam McCandlish,
Ilya Sutskever, and Wojciech Zaremba.
2021.

</span>
<span class="ltx_bibblock">Evaluating Large Language Models Trained on Code.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.3.1">arXiv</em> (2021).

</span>
<span class="ltx_bibblock">arXiv:2107.03374 [cs.LG]

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Coello (2022)</span>
<span class="ltx_bibblock">
Carlos A. Coello Coello.
2022.

</span>
<span class="ltx_bibblock">Constraint-handling techniques used with
evolutionary algorithms. In <em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">Proceedings of the
Genetic and Evolutionary Computation Conference Companion</em> (Boston,
Massachusetts) <em class="ltx_emph ltx_font_italic" id="bib.bib11.2.2">(GECCO ’22)</em>.
Association for Computing Machinery,
New York, NY, USA, 1310–1333.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3520304.3533640" title="">https://doi.org/10.1145/3520304.3533640</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cotroneo et al<span class="ltx_text" id="bib.bib12.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Domenico Cotroneo, Alessio
Foggia, Cristina Improta, Pietro
Liguori, and Roberto Natella.
2024.

</span>
<span class="ltx_bibblock">Automating the correctness assessment of
AI-generated code for security contexts.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.3.1">Journal of Systems and Software</em>
216 (2024), 112113.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1016/j.jss.2024.112113" title="">https://doi.org/10.1016/j.jss.2024.112113</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cummins et al<span class="ltx_text" id="bib.bib13.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Chris Cummins,
Zacharias V. Fisches, Tal Ben-Nun,
Torsten Hoefler, and Hugh Leather.
2020.

</span>
<span class="ltx_bibblock">ProGraML: Graph-based Deep Learning for
Program Optimization and Analysis.

</span>
<span class="ltx_bibblock">(March 2020).

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/arXiv.2003.10536" title="">https://doi.org/10.48550/arXiv.2003.10536</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cummins et al<span class="ltx_text" id="bib.bib14.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Chris Cummins, Volker
Seeker, Dejan Grubisic, Mostafa
Elhoushi, Youwei Liang, Baptiste
Roziere, Jonas Gehring, Fabian Gloeckle,
Kim Hazelwood, Gabriel Synnaeve, and
Hugh Leather. 2023.

</span>
<span class="ltx_bibblock">Large Language Models for Compiler Optimization.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2309.07062 [cs.PL]

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cummins et al<span class="ltx_text" id="bib.bib15.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Chris Cummins, Volker
Seeker, Dejan Grubisic, Baptiste
Roziere, Jonas Gehring, Gabriel
Synnaeve, and Hugh Leather.
2024.

</span>
<span class="ltx_bibblock">Meta Large Language Model Compiler: Foundation
Models of Compiler Optimization.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/arXiv.2407.02524" title="">https://doi.org/10.48550/arXiv.2407.02524</a>
arXiv:2407.02524 [cs]

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dehaerne et al<span class="ltx_text" id="bib.bib16.2.2.1">.</span> (2022a)</span>
<span class="ltx_bibblock">
Enrique Dehaerne,
Bappaditya Dey, Sandip Halder,
Stefan De Gendt, and Wannes Meert.
2022a.

</span>
<span class="ltx_bibblock">Code Generation Using Machine Learning: A
Systematic Review.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib16.3.1">IEEE Access</em> 10
(2022), 82434–82455.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1109/ACCESS.2022.3196347" title="">https://doi.org/10.1109/ACCESS.2022.3196347</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dehaerne et al<span class="ltx_text" id="bib.bib17.2.2.1">.</span> (2022b)</span>
<span class="ltx_bibblock">
Enrique Dehaerne,
Bappaditya Dey, Sandip Halder,
Stefan De Gendt, and Wannes Meert.
2022b.

</span>
<span class="ltx_bibblock">Code Generation Using Machine Learning: A
Systematic Review.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.3.1">IEEE Access</em> 10
(2022), 82434–82455.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1109/ACCESS.2022.3196347" title="">https://doi.org/10.1109/ACCESS.2022.3196347</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Du et al<span class="ltx_text" id="bib.bib18.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Xueying Du, Mingwei Liu,
Kaixin Wang, Hanlin Wang,
Junwei Liu, Yixuan Chen,
Jiayi Feng, Chaofeng Sha,
Xin Peng, and Yiling Lou.
2024.

</span>
<span class="ltx_bibblock">Evaluating Large Language Models in Class-Level
Code Generation. In <em class="ltx_emph ltx_font_italic" id="bib.bib18.3.1">Proceedings of the IEEE/ACM
46th International Conference on Software Engineering</em> (Lisbon, Portugal)
<em class="ltx_emph ltx_font_italic" id="bib.bib18.4.2">(ICSE ’24)</em>. Association for
Computing Machinery, New York, NY, USA, Article
81, 13 pages.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3597503.3639219" title="">https://doi.org/10.1145/3597503.3639219</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Feautrier (1991)</span>
<span class="ltx_bibblock">
Paul Feautrier.
1991.

</span>
<span class="ltx_bibblock">Dataflow Analysis of Array and Scalar
References.

</span>
<span class="ltx_bibblock">(1991), 37.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">Introduction of SCoP.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Feautrier (1996)</span>
<span class="ltx_bibblock">
Paul Feautrier.
1996.

</span>
<span class="ltx_bibblock">Some Efficient Solutions to the Affine Scheduling
Problem Part I One-dimensional Time.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">International Journal of Parallel
Programming</em> 21 (Aug.
1996).

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1007/BF01407835" title="">https://doi.org/10.1007/BF01407835</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Feautrier (1997)</span>
<span class="ltx_bibblock">
Paul Feautrier.
1997.

</span>
<span class="ltx_bibblock">Some Efficient Solutions to the Affine Scheduling
Problem Part II Multidimensional Time.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">International Journal of Parallel
Programming</em> 21 (Jan.
1997).

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1007/BF01379404" title="">https://doi.org/10.1007/BF01379404</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Github ([n. d.])</span>
<span class="ltx_bibblock">
Github.
[n. d.].

</span>
<span class="ltx_bibblock">GitHub Copilot <math alttext="\cdot" class="ltx_Math" display="inline" id="bib.bib22.1.m1.1"><semantics id="bib.bib22.1.m1.1a"><mo id="bib.bib22.1.m1.1.1" xref="bib.bib22.1.m1.1.1.cmml">⋅</mo><annotation-xml encoding="MathML-Content" id="bib.bib22.1.m1.1b"><ci id="bib.bib22.1.m1.1.1.cmml" xref="bib.bib22.1.m1.1.1">⋅</ci></annotation-xml><annotation encoding="application/x-tex" id="bib.bib22.1.m1.1c">\cdot</annotation><annotation encoding="application/x-llamapun" id="bib.bib22.1.m1.1d">⋅</annotation></semantics></math> Your AI Pair
Programmer.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/features/copilot" title="">https://github.com/features/copilot</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Grosser et al<span class="ltx_text" id="bib.bib23.2.2.1">.</span> (2012)</span>
<span class="ltx_bibblock">
Tobias Grosser, Armin
Groesslinger, and Christian Lengauer.
2012.

</span>
<span class="ltx_bibblock">Polly - Performing Polyhedral Optimizations on
a Low-Level Intermediate Representation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.3.1">Parallel Process. Lett.</em>
22, 04 (Dec.
2012), 1250010.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1142/S0129626412500107" title="">https://doi.org/10.1142/S0129626412500107</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ivanov et al<span class="ltx_text" id="bib.bib24.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Ivan R. Ivanov, Joachim
Meyer, Aiden Grossman, William S. Moses,
and Johannes Doerfert. 2024.

</span>
<span class="ltx_bibblock">Input-Gen: Guided Generation of Stateful Inputs for
Testing, Tuning, and Training.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2406.08843 [cs.SE]

<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2406.08843" title="">https://arxiv.org/abs/2406.08843</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et al<span class="ltx_text" id="bib.bib25.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Juyong Jiang, Fan Wang,
Jiasi Shen, Sungju Kim, and
Sunghun Kim. 2024.

</span>
<span class="ltx_bibblock">A Survey on Large Language Models for Code
Generation.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2406.00515 [cs.CL]

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kind et al<span class="ltx_text" id="bib.bib26.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Cecilia Conde Kind,
Michael Canesche, and Fernando
Magno Quintao Pereira. 2022.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib26.3.1">Jotai: a Methodology for the Generation of
Executable C Benchmarks</em>.

</span>
<span class="ltx_bibblock">Technical Report. Technical
Report 02-2022. Universidade Federal de Minas Gerais.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lewis et al<span class="ltx_text" id="bib.bib27.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Patrick Lewis, Ethan
Perez, Aleksandra Piktus, Fabio Petroni,
Vladimir Karpukhin, Naman Goyal,
Heinrich Küttler, Mike Lewis,
Wen-tau Yih, Tim Rocktäschel,
Sebastian Riedel, and Douwe Kiela.
2020.

</span>
<span class="ltx_bibblock">Retrieval-Augmented Generation for
Knowledge-Intensive NLP Tasks. In <em class="ltx_emph ltx_font_italic" id="bib.bib27.3.1">Proceedings
of the 34th International Conference on Neural Information Processing
Systems</em> <em class="ltx_emph ltx_font_italic" id="bib.bib27.4.2">(NIPS ’20)</em>.
Curran Associates Inc., Red Hook, NY,
USA, 9459–9474.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liang et al<span class="ltx_text" id="bib.bib28.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Youwei Liang, Kevin
Stone, Ali Shameli, Chris Cummins,
Mostafa Elhoushi, Jiadong Guo,
Benoit Steiner, Xiaomeng Yang,
Pengtao Xie, Hugh Leather, and
Yuandong Tian. 2023.

</span>
<span class="ltx_bibblock">Learning compiler pass orders using coreset and
normalized value prediction. In <em class="ltx_emph ltx_font_italic" id="bib.bib28.3.1">Proceedings of the
40th International Conference on Machine Learning</em> (Honolulu, Hawaii, USA)
<em class="ltx_emph ltx_font_italic" id="bib.bib28.4.2">(ICML’23)</em>. JMLR.org, Article
855, 17 pages.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mankowitz et al<span class="ltx_text" id="bib.bib29.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Daniel J. Mankowitz,
Andrea Michi, Anton Zhernov,
Marco Gelmi, Marco Selvi,
Cosmin Paduraru, Edouard Leurent,
Shariq Iqbal, Jean-Baptiste Lespiau,
Alex Ahern, Thomas Köppe,
Kevin Millikin, Stephen Gaffney,
Sophie Elster, Jackson Broshear,
Chris Gamble, Kieran Milan,
Robert Tung, Minjae Hwang,
Taylan Cemgil, Mohammadamin Barekatain,
Yujia Li, Amol Mandhane,
Thomas Hubert, Julian Schrittwieser,
Demis Hassabis, Pushmeet Kohli,
Martin Riedmiller, Oriol Vinyals, and
David Silver. 2023.

</span>
<span class="ltx_bibblock">Faster Sorting Algorithms Discovered Using Deep
Reinforcement Learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib29.3.1">Nature</em> 618,
7964 (June 2023),
257–263.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1038/s41586-023-06004-9" title="">https://doi.org/10.1038/s41586-023-06004-9</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Moses et al<span class="ltx_text" id="bib.bib30.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
William S Moses, Ruizhe
Zhao, Lorenzo Chelini, and Oleksandr
Zinenko. 2021.

</span>
<span class="ltx_bibblock">Polygeist: Affine C in MLIR.

</span>
<span class="ltx_bibblock">(2021), 12.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Munoz et al<span class="ltx_text" id="bib.bib31.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Michael Munoz, Juan
Torre, Stefany Lopez, Stiven Herrera,
and Christian Uribe. 2024.

</span>
<span class="ltx_bibblock">Comparative Study of AI Code Generation Tools:
Quality Assessment and Performance Analysis.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib31.3.1">LatIA</em> 2
(07 2024), 104.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.62486/latia2024104" title="">https://doi.org/10.62486/latia2024104</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mustafa (2022)</span>
<span class="ltx_bibblock">
Dheya Mustafa.
2022.

</span>
<span class="ltx_bibblock">A Survey of Performance Tuning Techniques and Tools
for Parallel Applications.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">IEEE Access</em> 10
(2022), 15036–15055.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1109/ACCESS.2022.3147846" title="">https://doi.org/10.1109/ACCESS.2022.3147846</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Phan (2019)</span>
<span class="ltx_bibblock">
Hung Phan.
2019.

</span>
<span class="ltx_bibblock">Self Learning from Large Scale Code Corpus to
Infer Structure of Method Invocations.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/1909.03147v1" title="">https://arxiv.org/abs/1909.03147v1</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pouchet et al<span class="ltx_text" id="bib.bib34.2.2.1">.</span> (2011)</span>
<span class="ltx_bibblock">
Louis-Noël Pouchet,
Uday Bondhugula, Cédric Bastoul,
Albert Cohen, J. Ramanujam,
P. Sadayappan, and Nicolas Vasilache.
2011.

</span>
<span class="ltx_bibblock">Loop transformations: convexity, pruning and
optimization. In <em class="ltx_emph ltx_font_italic" id="bib.bib34.3.1">Proceedings of the 38th Annual
ACM SIGPLAN-SIGACT Symposium on Principles of Programming Languages</em>
(Austin, Texas, USA) <em class="ltx_emph ltx_font_italic" id="bib.bib34.4.2">(POPL ’11)</em>.
Association for Computing Machinery,
New York, NY, USA, 549–562.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/1926385.1926449" title="">https://doi.org/10.1145/1926385.1926449</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Reisinger (2024)</span>
<span class="ltx_bibblock">
Matthias Reisinger.
2024.

</span>
<span class="ltx_bibblock">MatthiasJReisinger/PolyBenchC-4.2.1.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/MatthiasJReisinger/PolyBenchC-4.2.1" title="">https://github.com/MatthiasJReisinger/PolyBenchC-4.2.1</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schick et al<span class="ltx_text" id="bib.bib36.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Timo Schick, Jane
Dwivedi-Yu, Roberto Dessi, Roberta
Raileanu, Maria Lomeli, Eric Hambro,
Luke Zettlemoyer, Nicola Cancedda, and
Thomas Scialom. 2023.

</span>
<span class="ltx_bibblock">Toolformer: Language Models Can Teach Themselves to
Use Tools. In <em class="ltx_emph ltx_font_italic" id="bib.bib36.3.1">Advances in Neural Information
Processing Systems</em>, A. Oh,
T. Naumann, A. Globerson,
K. Saenko, M. Hardt, and
S. Levine (Eds.), Vol. 36.
Curran Associates, Inc., 68539–68551.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://proceedings.neurips.cc/paper_files/paper/2023/file/d842425e4bf79ba039352da0f658a906-Paper-Conference.pdf" title="">https://proceedings.neurips.cc/paper_files/paper/2023/file/d842425e4bf79ba039352da0f658a906-Paper-Conference.pdf</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shido et al<span class="ltx_text" id="bib.bib37.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Yusuke Shido, Yasuaki
Kobayashi, Akihiro Yamamoto, Atsushi
Miyamoto, and Tadayuki Matsumura.
2019.

</span>
<span class="ltx_bibblock">Automatic Source Code Summarization with
Extended Tree-LSTM. In <em class="ltx_emph ltx_font_italic" id="bib.bib37.3.1">2019 International
Joint Conference on Neural Networks (IJCNN)</em>.
1–8.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1109/IJCNN.2019.8851751" title="">https://doi.org/10.1109/IJCNN.2019.8851751</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Silver et al<span class="ltx_text" id="bib.bib38.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
David Silver, Aja Huang,
Chris J. Maddison, Arthur Guez,
Laurent Sifre, George van den Driessche,
Julian Schrittwieser, Ioannis Antonoglou,
Veda Panneershelvam, Marc Lanctot,
Sander Dieleman, Dominik Grewe,
John Nham, Nal Kalchbrenner,
Ilya Sutskever, Timothy Lillicrap,
Madeleine Leach, Koray Kavukcuoglu,
Thore Graepel, and Demis Hassabis.
2016.

</span>
<span class="ltx_bibblock">Mastering the game of Go with deep neural networks
and tree search.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib38.3.1">Nature</em> 529,
7587 (01 Jan 2016),
484–489.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1038/nature16961" title="">https://doi.org/10.1038/nature16961</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Stein et al<span class="ltx_text" id="bib.bib39.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Aviel J. Stein, Levi
Kapllani, Spiros Mancoridis, and Rachel
Greenstadt. 2020.

</span>
<span class="ltx_bibblock">Exploring Paraphrasing Techniques on Formal
Language for Generating Semantics Preserving Source Code
Transformations. In <em class="ltx_emph ltx_font_italic" id="bib.bib39.3.1">2020 IEEE 14th
International Conference on Semantic Computing (ICSC)</em>.
242–248.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1109/ICSC.2020.00051" title="">https://doi.org/10.1109/ICSC.2020.00051</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sutton and Barto (2018)</span>
<span class="ltx_bibblock">
Richard S Sutton and
Andrew G Barto. 2018.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">Reinforcement Learning: An Introduction</em>.

</span>
<span class="ltx_bibblock">MIT press.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Trümper et al<span class="ltx_text" id="bib.bib41.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Lukas Trümper, Tal
Ben-Nun, Philipp Schaad, Alexandru
Calotoiu, and Torsten Hoefler.
2023.

</span>
<span class="ltx_bibblock">Performance Embeddings: A Similarity-Based Transfer
Tuning Approach to Performance Optimization. In
<em class="ltx_emph ltx_font_italic" id="bib.bib41.3.1">Proceedings of the 37th ACM International
Conference on Supercomputing</em> (Orlando, FL, USA) <em class="ltx_emph ltx_font_italic" id="bib.bib41.4.2">(ICS
’23)</em>. Association for Computing Machinery,
New York, NY, USA, 50–62.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3577193.3593714" title="">https://doi.org/10.1145/3577193.3593714</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vasilache et al<span class="ltx_text" id="bib.bib42.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Nicolas Vasilache,
Oleksandr Zinenko, Theodoros Theodoridis,
Priya Goyal, Zachary DeVito,
William S. Moses, Sven Verdoolaege,
Andrew Adams, and Albert Cohen.
2018.

</span>
<span class="ltx_bibblock">Tensor Comprehensions: Framework-Agnostic
High-Performance Machine Learning Abstractions.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib42.3.1">CoRR</em> abs/1802.04730
(2018).

</span>
<span class="ltx_bibblock">arXiv:1802.04730

<a class="ltx_ref ltx_url ltx_font_typewriter" href="http://arxiv.org/abs/1802.04730" title="">http://arxiv.org/abs/1802.04730</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Verdoolaege (2010)</span>
<span class="ltx_bibblock">
Sven Verdoolaege.
2010.

</span>
<span class="ltx_bibblock">Isl: An Integer Set Library for the
Polyhedral Model. In <em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">Mathematical Software
– ICMS 2010</em>, Komei Fukuda,
Joris van der Hoeven, Michael Joswig,
and Nobuki Takayama (Eds.).
Springer, Berlin, Heidelberg,
299–302.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1007/978-3-642-15582-6_49" title="">https://doi.org/10.1007/978-3-642-15582-6_49</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Verdoolaege et al<span class="ltx_text" id="bib.bib44.2.2.1">.</span> (2013)</span>
<span class="ltx_bibblock">
Sven Verdoolaege, Juan
Carlos Juega, Albert Cohen, José
Ignacio Gómez, Christian Tenllado, and
Francky Catthoor. 2013.

</span>
<span class="ltx_bibblock">Polyhedral Parallel Code Generation for CUDA.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib44.3.1">ACM Trans. Archit. Code Optim.</em>
9, 4 (Jan.
2013), 54:1–54:23.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/2400682.2400713" title="">https://doi.org/10.1145/2400682.2400713</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Verdoolaege and Grosser (2012)</span>
<span class="ltx_bibblock">
Sven Verdoolaege and
Tobias Grosser. 2012.

</span>
<span class="ltx_bibblock">Polyhedral Extraction Tool.

</span>
<span class="ltx_bibblock">(2012), 8.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Verdoolaege et al<span class="ltx_text" id="bib.bib46.2.2.1">.</span> (2014)</span>
<span class="ltx_bibblock">
Sven Verdoolaege, Serge
Guelton, Tobias Grosser, and Albert
Cohen. 2014.

</span>
<span class="ltx_bibblock">Schedule Trees. In
<em class="ltx_emph ltx_font_italic" id="bib.bib46.3.1">International Workshop on Polyhedral
Compilation Techniques</em>. Vienna, Austria.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://lirias.kuleuven.be/1656334" title="">https://lirias.kuleuven.be/1656334</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Verdoolaege et al<span class="ltx_text" id="bib.bib47.2.2.1">.</span> ([n. d.])</span>
<span class="ltx_bibblock">
Sven Verdoolaege, Polly
Labs, and KU Leuven.
[n. d.].

</span>
<span class="ltx_bibblock">Presburger Formulas and Polyhedral
Compilation.

</span>
<span class="ltx_bibblock">([n. d.]), 174.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib48.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Ruotong Wang, Ruijia
Cheng, Denae Ford, and Thomas
Zimmermann. 2024.

</span>
<span class="ltx_bibblock">Investigating and Designing for Trust in AI-powered
Code Generation Tools. In <em class="ltx_emph ltx_font_italic" id="bib.bib48.3.1">Proceedings of the 2024
ACM Conference on Fairness, Accountability, and Transparency</em> (Rio de
Janeiro, Brazil) <em class="ltx_emph ltx_font_italic" id="bib.bib48.4.2">(FAccT ’24)</em>.
Association for Computing Machinery,
New York, NY, USA, 1475–1493.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3630106.3658984" title="">https://doi.org/10.1145/3630106.3658984</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wei et al<span class="ltx_text" id="bib.bib49.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Jason Wei, Xuezhi Wang,
Dale Schuurmans, Maarten Bosma,
Brian Ichter, Fei Xia,
Ed H. Chi, Quoc V. Le, and
Denny Zhou. 2024.

</span>
<span class="ltx_bibblock">Chain-of-thought prompting elicits reasoning in
large language models. In <em class="ltx_emph ltx_font_italic" id="bib.bib49.3.1">Proceedings of the 36th
International Conference on Neural Information Processing Systems</em> (New
Orleans, LA, USA) <em class="ltx_emph ltx_font_italic" id="bib.bib49.4.2">(NIPS ’22)</em>.
Curran Associates Inc., Red Hook, NY,
USA, Article 1800, 14 pages.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">While and Hingston (2013)</span>
<span class="ltx_bibblock">
Lyndon While and Philip
Hingston. 2013.

</span>
<span class="ltx_bibblock">Usefulness of infeasible solutions in evolutionary
search: An empirical and mathematical study. In
<em class="ltx_emph ltx_font_italic" id="bib.bib50.1.1">2013 IEEE Congress on Evolutionary Computation</em>.
1363–1370.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1109/CEC.2013.6557723" title="">https://doi.org/10.1109/CEC.2013.6557723</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al<span class="ltx_text" id="bib.bib51.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Shuyan Zhou, Uri Alon,
Frank F. Xu, Zhengbao Jiang, and
Graham Neubig. 2023.

</span>
<span class="ltx_bibblock">DocPrompting: Generating Code by Retrieving the
Docs. In <em class="ltx_emph ltx_font_italic" id="bib.bib51.3.1">ICLR</em>.
OpenReview.net.

</span>
<span class="ltx_bibblock">
</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Fri Oct  4 07:49:17 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
